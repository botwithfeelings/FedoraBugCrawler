<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1" urlbase="https://bugzilla.redhat.com/" maintainer="bugzilla-error-list@redhat.com">

  <bug>
    <bug_id>1310467</bug_id>

    <creation_ts>2016-02-21 17:54:00 -0500</creation_ts>
    <short_desc>CORD__next() miscompiled on s390(x)</short_desc>
    <delta_ts>2016-03-03 04:15:02 -0500</delta_ts>
    <reporter_accessible>1</reporter_accessible>
    <cclist_accessible>1</cclist_accessible>
    <classification_id>2</classification_id>
    <classification>Fedora</classification>
    <product>Fedora</product>
    <component>gcc</component>
    <version>24</version>
    <rep_platform>s390x</rep_platform>
    <op_sys>Unspecified</op_sys>
    <bug_status>CLOSED</bug_status>
    <resolution>RAWHIDE</resolution>

    <bug_file_loc></bug_file_loc>
    <status_whiteboard></status_whiteboard>
    <keywords></keywords>
    <priority>high</priority>
    <bug_severity>high</bug_severity>
    <target_milestone>---</target_milestone>

    <blocked>467765</blocked>
    <everconfirmed>1</everconfirmed>
    <reporter name="Dan Hor치k">dan</reporter>
    <assigned_to name="Jakub Jelinek">jakub</assigned_to>
    <cc>davejohansen</cc>

    <cc>jakub</cc>

    <cc>jwakely</cc>

    <cc>law</cc>

    <cc>mpolacek</cc>
    <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>

    <cf_fixed_in>gcc-6.0.0-0.14.fc24</cf_fixed_in>
  <cf_doc_type>Bug Fix</cf_doc_type>
<cf_release_notes></cf_release_notes>
<cf_story_points>---</cf_story_points>

<cf_environment></cf_environment>
<cf_last_closed>2016-03-03 04:15:02</cf_last_closed>
<cf_type>Bug</cf_type>
<cf_regression_status>---</cf_regression_status>
<cf_mount_type>---</cf_mount_type>
<cf_documentation_action>---</cf_documentation_action>
<cf_crm></cf_crm>
<cf_verified_branch></cf_verified_branch>
<cf_category>---</cf_category>
<cf_ovirt_team>---</cf_ovirt_team>

<cf_cloudforms_team>---</cf_cloudforms_team>
<external_bugs name="GNU Compiler Collection">70025</external_bugs>

<target_release>---</target_release>

<votes>0</votes>

<comment_sort_order>oldest_to_newest</comment_sort_order>
<long_desc isprivate="0">
<commentid>9081988</commentid>
<comment_count>0</comment_count>
<who name="Dan Hor치k">dan</who>
<bug_when>2016-02-21 17:54:35 -0500</bug_when>
<thetext>gc-7.4.2-5.fc24 fails to build with f24 gcc because one test (cordtest) doesn&apos;t pass. I have identified void CORD__next(register CORD_pos p) from cord/cordbscs.c as being possibly miscompiled (many register variables?), because adding
__attribute__((optimize((&quot;O1&quot;)))) to this function makes the test to pass. some details about the failed test: [sharkcz@devel10 gc]$ coredumpctl gdb 37090 PID: 37090 (lt-cordtest) UID: 1000 (sharkcz) GID: 1000 (sharkcz) Signal: 6 (ABRT)
Timestamp: Sun 2016-02-21 17:51:58 EST (25s ago) Command Line: /home/sharkcz/gc/gc-7.4.2/.libs/lt-cordtest Executable: /home/sharkcz/gc/gc-7.4.2/.libs/lt-cordtest Control Group: /user.slice/user-0.slice/session-3.scope Unit: session-3.scope Slice:
user-0.slice Session: 3 Owner UID: 0 (root) Boot ID: 770d208119c1493aa558d7c4dfd84244 Machine ID: 4973d5bbe8e94395bdca6c6d5116d0f6 Hostname: devel10.s390.bos.redhat.com Coredump:
/var/lib/systemd/coredump/core.lt-cordtest.1000.770d208119c1493aa558d7c4dfd84244.37090.1456095118000000.lz4 Message: Process 37090 (lt-cordtest) of user 1000 dumped core. Stack trace of thread 37090: #0 0x000003fffcecc37a __GI_raise (libc.so.6) #1
0x000003fffcecddfa __GI_abort (libc.so.6) #2 0x000002aa0066d8f0 test_basics (lt-cordtest) #3 0x000002aa0066d400 main (lt-cordtest) #4 0x000003fffceb278e __libc_start_main (libc.so.6) #5 0x000002aa0066d484 _start (lt-cordtest) GNU gdb (GDB) Fedora
7.10.50.20160131-50.fc24 Copyright (C) 2016 Free Software Foundation, Inc. License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt; This is free software: you are free to change and redistribute it. There is NO WARRANTY, to
the extent permitted by law. Type &quot;show copying&quot; and &quot;show warranty&quot; for details. This GDB was configured as &quot;s390x-redhat-linux-gnu&quot;. Type &quot;show configuration&quot; for configuration details. For bug reporting
instructions, please see: &lt;http://www.gnu.org/software/gdb/bugs/&gt;. Find the GDB manual and other documentation resources online at: &lt;http://www.gnu.org/software/gdb/documentation/&gt;. For help, type &quot;help&quot;. Type &quot;apropos
word&quot; to search for commands related to &quot;word&quot;... Reading symbols from /home/sharkcz/gc/gc-7.4.2/.libs/lt-cordtest...done. [New LWP 37090] warning: Could not load shared library symbols for linux-vdso64.so.1. Do you need &quot;set
solib-search-path&quot; or &quot;set sysroot&quot;? [Thread debugging using libthread_db enabled] Using host libthread_db library &quot;/lib64/libthread_db.so.1&quot;. Core was generated by `/home/sharkcz/gc/gc-7.4.2/.libs/lt-cordtest&apos;. Program
terminated with signal SIGABRT, Aborted. #0 0x000003fffcecc37a in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:54 54 return INLINE_SYSCALL (tgkill, 3, pid, selftid, sig); (gdb) where #0 0x000003fffcecc37a in __GI_raise
(sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:54 #1 0x000003fffcecddfa in __GI_abort () at abort.c:89 #2 0x000002aa0066d8f0 in test_basics () at cord/tests/cordtest.c:62 #3 0x000002aa0066d400 in main () at cord/tests/cordtest.c:241 (gdb) up
#1 0x000003fffcecddfa in __GI_abort () at abort.c:89 89 raise (SIGABRT); (gdb) up #2 0x000002aa0066d8f0 in test_basics () at cord/tests/cordtest.c:62 62 if (!CORD_IS_STRING(x)) ABORT(&quot;short cord should usually be a string&quot;); (gdb) l 57 CORD
y; 58 CORD_pos p; 59 60 x = CORD_cat(x,x); 61 if (x == CORD_EMPTY) ABORT(&quot;CORD_cat(x,x) returned empty cord&quot;); 62 if (!CORD_IS_STRING(x)) ABORT(&quot;short cord should usually be a string&quot;); 63 if (strcmp(x, &quot;abab&quot;) != 0)
ABORT(&quot;bad CORD_cat result&quot;); 64 65 for (i = 1; i &lt; 16; i++) { 66 x = CORD_cat(x,x); Version-Release number of selected component (if applicable): gcc-6.0.0-0.12.fc24.s390x</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9094540</commentid>
<comment_count>1</comment_count>
<who name="Jan Kurik">jkurik</who>
<bug_when>2016-02-24 10:47:26 -0500</bug_when>
<thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 24 development cycle. Changing version to &apos;24&apos;. More information and reason for this action is here:
https://fedoraproject.org/wiki/Fedora_Program_Management/HouseKeeping/Fedora24#Rawhide_Rebase</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9100055</commentid>
<comment_count>2</comment_count>
<attachid>1130804</attachid>
<who name="Dan Hor치k">dan</who>
<bug_when>2016-02-26 04:42:39 -0500</bug_when>
<thetext>Created attachment 1130804 preprocessed source file gcc -DHAVE_CONFIG_H -I./include -I./include -DUSE_GET_STACKBASE_FOR_MAIN -fexceptions -DGC_VISIBILITY_HIDDEN_SET -fvisibility=hidden -Wall -Wextra -O2 -g -pipe -Wall -Werror=format-security
-Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -m64 -march=z9-109 -mtune=z10 -fno-strict-aliasing -E cord/cordbscs.c -fPIC -DPIC -o
cord/cordbscs.i</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9100283</commentid>
<comment_count>3</comment_count>
<who name="Jakub Jelinek">jakub</who>
<bug_when>2016-02-26 06:42:05 -0500</bug_when>
<thetext>I&apos;m afraid that is not enough for a wrong-code, I&apos;d need to know how exactly it is called and how to recognize good vs. bad. Does it keep failing with O2 and working with O1 if you add __attribute__((noinline, noclone)) to
CORD__next? What about CORD__extend_path, does it have to be inlined for the wrong behavior? Can you cook up a minimal main that will just call __attribute__((noinline, noclone)) to CORD__next with the right arguments on which it reproduces (of
course it is not just the argument structure itself, but whatever other points it uses, just malloc them or set pointers to automatic variables in main also initialized with right values. Can you add code to main (or to CORD__extend_path if it
doesn&apos;t have to be inlined) to detect the wrong vs. good behavior and __builtin_abort () if it is wrong?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9102138</commentid>
<comment_count>4</comment_count>
<who name="Dan Hor치k">dan</who>
<bug_when>2016-02-26 17:34:35 -0500</bug_when>
<thetext>(In reply to Jakub Jelinek from comment #3) &gt; I&apos;m afraid that is not enough for a wrong-code, I&apos;d need to know how exactly &gt; it is called and how to recognize good vs. bad. I know, still working on better test case &gt; Does
it keep failing with O2 and working with O1 if you add &gt; __attribute__((noinline, noclone)) to CORD__next? What about &gt; CORD__extend_path, does it have to be inlined for the wrong behavior? behaves incorrectly with -O2 even with
__attribute__((noinline, noclone)) for both functions &gt; Can you cook up a minimal main that will just call __attribute__((noinline, &gt; noclone)) to CORD__next with the right arguments on which it reproduces (of &gt; course it is not just the
argument structure itself, but whatever other &gt; points it uses, just malloc them or set pointers to automatic variables in &gt; main also initialized with right values. Can you add code to main (or to &gt; CORD__extend_path if it doesn&apos;t have
to be inlined) to detect the wrong vs. &gt; good behavior and __builtin_abort () if it is wrong? the &quot;main&quot; looks like this (reduced from cord/tests/cordtest.c after realizing gdb is lying about the lines), reproduceable also with upstream
(https://github.com/ivmai/bdwgc) char id_cord_fn(size_t i, void * client_data) { if (client_data != 0) ABORT(&quot;id_cord_fn: bad client data&quot;); return((char)i); } void test_basics(void) { register int i; char c; CORD y; CORD_pos p; y =
CORD_from_fn(id_cord_fn, 0, 13); i = 0; CORD_set_pos(p, y, i); while(CORD_pos_valid(p)) { c = CORD_pos_fetch(p); if(c != i) ABORT(&quot;Traversal of function node failed&quot;); CORD_next(p); i++; } if (i != 13) ABORT(&quot;Bad apparent length for
function node&quot;); } int main(void) { GC_INIT(); test_basics(); CORD_fprintf(stdout, &quot;SUCCEEDED\n&quot;); return(0); } result is [sharkcz@devel10 bdwgc]$ ./cordtest FAILED: Traversal of function node failed Aborted (core dumped)</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9109516</commentid>
<comment_count>5</comment_count>
<who name="Jakub Jelinek">jakub</who>
<bug_when>2016-03-01 05:07:51 -0500</bug_when>
<thetext>Managed to create small self-contained testcase and bisect, tracking upstream in PR70025.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9117112</commentid>
<comment_count>6</comment_count>
<who name="Dan Hor치k">dan</who>
<bug_when>2016-03-03 04:07:15 -0500</bug_when>
<thetext>I can confirm that using gcc-6.0.0-0.14.fc24 the test-suite passes.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9117153</commentid>
<comment_count>7</comment_count>
<who name="Jakub Jelinek">jakub</who>
<bug_when>2016-03-03 04:15:02 -0500</bug_when>
<thetext>Fixed then.</thetext>
</long_desc>

<attachment isobsolete="0" ispatch="0" isprivate="0">
<attachid>1130804</attachid>
<date>2016-02-26 04:42:00 -0500</date>
<delta_ts>2016-02-26 04:42:39 -0500</delta_ts>
<desc>preprocessed source file</desc>
<filename>cordbscs.i</filename>
<type>text/plain</type>
<size>175242</size>
<attacher name="Dan Hor치k">dan</attacher>

<data encoding="base64">IyAxICJjb3JkL2NvcmRic2NzLmMiCiMgMSAiL2hvbWUvc2hhcmtjei9nYy9nYy03LjQuMi8vIgoj IDEgIjxidWlsdC1pbj4iCiMgMSAiPGNvbW1hbmQtbGluZT4iCiMgMSAiL3Vzci9pbmNsdWRlL3N0
ZGMtcHJlZGVmLmgiIDEgMyA0CiMgMSAiPGNvbW1hbmQtbGluZT4iIDIKIyAxICJjb3JkL2NvcmRi c2NzLmMiCiMgMTUgImNvcmQvY29yZGJzY3MuYyIKIyAxICIuL2luY2x1ZGUvY29uZmlnLmgiIDEK IyAxNiAiY29yZC9jb3JkYnNjcy5jIiAyCgoKCgoKIyAxICIuL2luY2x1ZGUvZ2MuaCIgMQojIDM0
ICIuL2luY2x1ZGUvZ2MuaCIKIyAxICIuL2luY2x1ZGUvZ2NfdmVyc2lvbi5oIiAxCiMgMzUgIi4v aW5jbHVkZS9nYy5oIiAyCgoKCgoKCiMgMSAiLi9pbmNsdWRlL2djX2NvbmZpZ19tYWNyb3MuaCIg MQojIDE0OSAiLi9pbmNsdWRlL2djX2NvbmZpZ19tYWNyb3MuaCIKIyAxICIvdXNyL2xpYi9nY2Mv
czM5MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDEgMyA0CiMgMTQ5ICIv dXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDMg NAoKIyAxNDkgIi91c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVkZS9z
dGRkZWYuaCIgMyA0CnR5cGVkZWYgbG9uZyBpbnQgcHRyZGlmZl90OwojIDIxNiAiL3Vzci9saWIv Z2NjL3MzOTB4LXJlZGhhdC1saW51eC82LjAuMC9pbmNsdWRlL3N0ZGRlZi5oIiAzIDQKdHlwZWRl ZiBsb25nIHVuc2lnbmVkIGludCBzaXplX3Q7CiMgMzI4ICIvdXNyL2xpYi9nY2MvczM5MHgtcmVk
aGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDMgNAp0eXBlZGVmIGludCB3Y2hhcl90 OwojIDQyNiAiL3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51eC82LjAuMC9pbmNsdWRlL3N0 ZGRlZi5oIiAzIDQKdHlwZWRlZiBzdHJ1Y3QgewogIGxvbmcgbG9uZyBfX21heF9hbGlnbl9sbCBf
X2F0dHJpYnV0ZV9fKChfX2FsaWduZWRfXyhfX2FsaWdub2ZfXyhsb25nIGxvbmcpKSkpOwogIGxv bmcgZG91YmxlIF9fbWF4X2FsaWduX2xkIF9fYXR0cmlidXRlX18oKF9fYWxpZ25lZF9fKF9fYWxp Z25vZl9fKGxvbmcgZG91YmxlKSkpKTsKfSBtYXhfYWxpZ25fdDsKIyAxNTAgIi4vaW5jbHVkZS9n
Y19jb25maWdfbWFjcm9zLmgiIDIKIyAyODMgIi4vaW5jbHVkZS9nY19jb25maWdfbWFjcm9zLmgi CiMgMSAiL3Vzci9pbmNsdWRlL2ZlYXR1cmVzLmgiIDEgMyA0CiMgMzY4ICIvdXNyL2luY2x1ZGUv ZmVhdHVyZXMuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL3N5cy9jZGVmcy5oIiAxIDMgNAojIDQx
MCAiL3Vzci9pbmNsdWRlL3N5cy9jZGVmcy5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy93 b3Jkc2l6ZS5oIiAxIDMgNAojIDQxMSAiL3Vzci9pbmNsdWRlL3N5cy9jZGVmcy5oIiAyIDMgNAoj IDM2OSAiL3Vzci9pbmNsdWRlL2ZlYXR1cmVzLmgiIDIgMyA0CiMgMzkyICIvdXNyL2luY2x1ZGUv
ZmVhdHVyZXMuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2dudS9zdHVicy5oIiAxIDMgNAoKCgoK IyAxICIvdXNyL2luY2x1ZGUvYml0cy93b3Jkc2l6ZS5oIiAxIDMgNAojIDYgIi91c3IvaW5jbHVk ZS9nbnUvc3R1YnMuaCIgMiAzIDQKCgoKCgojIDEgIi91c3IvaW5jbHVkZS9nbnUvc3R1YnMtNjQu
aCIgMSAzIDQKIyAxMiAiL3Vzci9pbmNsdWRlL2dudS9zdHVicy5oIiAyIDMgNAojIDM5MyAiL3Vz ci9pbmNsdWRlL2ZlYXR1cmVzLmgiIDIgMyA0CiMgMjg0ICIuL2luY2x1ZGUvZ2NfY29uZmlnX21h Y3Jvcy5oIiAyCiMgNDIgIi4vaW5jbHVkZS9nYy5oIiAyCgoKCgoKCiMgNDcgIi4vaW5jbHVkZS9n
Yy5oIgp0eXBlZGVmIHZvaWQgKiBHQ19QVFI7CiMgNjUgIi4vaW5jbHVkZS9nYy5oIgogIHR5cGVk ZWYgdW5zaWduZWQgbG9uZyBHQ193b3JkOwogIHR5cGVkZWYgbG9uZyBHQ19zaWduZWRfd29yZDsK CgoKCmV4dGVybiB1bnNpZ25lZCBHQ19nZXRfdmVyc2lvbih2b2lkKTsKCgoKCmV4dGVybiBfX2F0
dHJpYnV0ZV9fKChfX2RlcHJlY2F0ZWRfXykpIEdDX3dvcmQgR0NfZ2Nfbm87CgoKZXh0ZXJuIEdD X3dvcmQgR0NfZ2V0X2djX25vKHZvaWQpOwoKCgoKCiAgZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9f ZGVwcmVjYXRlZF9fKSkgaW50IEdDX3BhcmFsbGVsOwojIDEwMSAiLi9pbmNsdWRlL2djLmgiCiAg
ZXh0ZXJuIGludCBHQ19nZXRfcGFyYWxsZWwodm9pZCk7CgoKCgoKCnR5cGVkZWYgdm9pZCAqICgg KiBHQ19vb21fZnVuYykoc2l6ZV90ICk7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2RlcHJlY2F0 ZWRfXykpIEdDX29vbV9mdW5jIEdDX29vbV9mbjsKIyAxMTkgIi4vaW5jbHVkZS9nYy5oIgpleHRl
cm4gdm9pZCBHQ19zZXRfb29tX2ZuKEdDX29vbV9mdW5jKSBfX2F0dHJpYnV0ZV9fKChfX25vbm51 bGxfXygxKSkpOwpleHRlcm4gR0Nfb29tX2Z1bmMgR0NfZ2V0X29vbV9mbih2b2lkKTsKCnR5cGVk ZWYgdm9pZCAoICogR0Nfb25faGVhcF9yZXNpemVfcHJvYykoR0Nfd29yZCApOwpleHRlcm4gX19h
dHRyaWJ1dGVfXygoX19kZXByZWNhdGVkX18pKSBHQ19vbl9oZWFwX3Jlc2l6ZV9wcm9jIEdDX29u X2hlYXBfcmVzaXplOwoKCgpleHRlcm4gdm9pZCBHQ19zZXRfb25faGVhcF9yZXNpemUoR0Nfb25f aGVhcF9yZXNpemVfcHJvYyk7CmV4dGVybiBHQ19vbl9oZWFwX3Jlc2l6ZV9wcm9jIEdDX2dldF9v
bl9oZWFwX3Jlc2l6ZSh2b2lkKTsKCgoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fZGVwcmVjYXRl ZF9fKSkgaW50IEdDX2ZpbmRfbGVhazsKCgoKCgoKCmV4dGVybiB2b2lkIEdDX3NldF9maW5kX2xl YWsoaW50KTsKZXh0ZXJuIGludCBHQ19nZXRfZmluZF9sZWFrKHZvaWQpOwoKZXh0ZXJuIF9fYXR0
cmlidXRlX18oKF9fZGVwcmVjYXRlZF9fKSkgaW50IEdDX2FsbF9pbnRlcmlvcl9wb2ludGVyczsK IyAxNTYgIi4vaW5jbHVkZS9nYy5oIgpleHRlcm4gdm9pZCBHQ19zZXRfYWxsX2ludGVyaW9yX3Bv aW50ZXJzKGludCk7CmV4dGVybiBpbnQgR0NfZ2V0X2FsbF9pbnRlcmlvcl9wb2ludGVycyh2b2lk
KTsKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2RlcHJlY2F0ZWRfXykpIGludCBHQ19maW5hbGl6 ZV9vbl9kZW1hbmQ7CgoKCgoKCmV4dGVybiB2b2lkIEdDX3NldF9maW5hbGl6ZV9vbl9kZW1hbmQo aW50KTsKZXh0ZXJuIGludCBHQ19nZXRfZmluYWxpemVfb25fZGVtYW5kKHZvaWQpOwoKZXh0ZXJu
IF9fYXR0cmlidXRlX18oKF9fZGVwcmVjYXRlZF9fKSkgaW50IEdDX2phdmFfZmluYWxpemF0aW9u OwojIDE3OCAiLi9pbmNsdWRlL2djLmgiCmV4dGVybiB2b2lkIEdDX3NldF9qYXZhX2ZpbmFsaXph dGlvbihpbnQpOwpleHRlcm4gaW50IEdDX2dldF9qYXZhX2ZpbmFsaXphdGlvbih2b2lkKTsKCnR5
cGVkZWYgdm9pZCAoICogR0NfZmluYWxpemVyX25vdGlmaWVyX3Byb2MpKHZvaWQpOwpleHRlcm4g X19hdHRyaWJ1dGVfXygoX19kZXByZWNhdGVkX18pKSBHQ19maW5hbGl6ZXJfbm90aWZpZXJfcHJv YyBHQ19maW5hbGl6ZXJfbm90aWZpZXI7CiMgMTkyICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIHZv
aWQgR0Nfc2V0X2ZpbmFsaXplcl9ub3RpZmllcihHQ19maW5hbGl6ZXJfbm90aWZpZXJfcHJvYyk7 CmV4dGVybiBHQ19maW5hbGl6ZXJfbm90aWZpZXJfcHJvYyBHQ19nZXRfZmluYWxpemVyX25vdGlm aWVyKHZvaWQpOwoKZXh0ZXJuCgogICAgX19hdHRyaWJ1dGVfXygoX19kZXByZWNhdGVkX18pKQoK
ICBpbnQgR0NfZG9udF9nYzsKIyAyMDkgIi4vaW5jbHVkZS9nYy5oIgpleHRlcm4gX19hdHRyaWJ1 dGVfXygoX19kZXByZWNhdGVkX18pKSBpbnQgR0NfZG9udF9leHBhbmQ7CgoKCmV4dGVybiB2b2lk IEdDX3NldF9kb250X2V4cGFuZChpbnQpOwpleHRlcm4gaW50IEdDX2dldF9kb250X2V4cGFuZCh2
b2lkKTsKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2RlcHJlY2F0ZWRfXykpIGludCBHQ191c2Vf ZW50aXJlX2hlYXA7CiMgMjI3ICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIF9fYXR0cmlidXRlX18o KF9fZGVwcmVjYXRlZF9fKSkgaW50IEdDX2Z1bGxfZnJlcTsKIyAyNDEgIi4vaW5jbHVkZS9nYy5o
IgpleHRlcm4gdm9pZCBHQ19zZXRfZnVsbF9mcmVxKGludCk7CmV4dGVybiBpbnQgR0NfZ2V0X2Z1 bGxfZnJlcSh2b2lkKTsKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2RlcHJlY2F0ZWRfXykpIEdD X3dvcmQgR0Nfbm9uX2djX2J5dGVzOwojIDI1NCAiLi9pbmNsdWRlL2djLmgiCmV4dGVybiB2b2lk
IEdDX3NldF9ub25fZ2NfYnl0ZXMoR0Nfd29yZCk7CmV4dGVybiBHQ193b3JkIEdDX2dldF9ub25f Z2NfYnl0ZXModm9pZCk7CgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19kZXByZWNhdGVkX18pKSBp bnQgR0Nfbm9fZGxzOwojIDI2NiAiLi9pbmNsdWRlL2djLmgiCmV4dGVybiB2b2lkIEdDX3NldF9u
b19kbHMoaW50KTsKZXh0ZXJuIGludCBHQ19nZXRfbm9fZGxzKHZvaWQpOwoKZXh0ZXJuIF9fYXR0 cmlidXRlX18oKF9fZGVwcmVjYXRlZF9fKSkgR0Nfd29yZCBHQ19mcmVlX3NwYWNlX2Rpdmlzb3I7 CiMgMjg2ICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIHZvaWQgR0Nfc2V0X2ZyZWVfc3BhY2VfZGl2
aXNvcihHQ193b3JkKTsKZXh0ZXJuIEdDX3dvcmQgR0NfZ2V0X2ZyZWVfc3BhY2VfZGl2aXNvcih2 b2lkKTsKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX2RlcHJlY2F0ZWRfXykpIEdDX3dvcmQgR0Nf bWF4X3JldHJpZXM7CgoKCgoKCgpleHRlcm4gdm9pZCBHQ19zZXRfbWF4X3JldHJpZXMoR0Nfd29y
ZCk7CmV4dGVybiBHQ193b3JkIEdDX2dldF9tYXhfcmV0cmllcyh2b2lkKTsKCgpleHRlcm4gX19h dHRyaWJ1dGVfXygoX19kZXByZWNhdGVkX18pKSBjaGFyICpHQ19zdGFja2JvdHRvbTsKIyAzMTcg Ii4vaW5jbHVkZS9nYy5oIgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19kZXByZWNhdGVkX18pKSBp
bnQgR0NfZG9udF9wcmVjb2xsZWN0OwojIDMyOCAiLi9pbmNsdWRlL2djLmgiCmV4dGVybiB2b2lk IEdDX3NldF9kb250X3ByZWNvbGxlY3QoaW50KTsKZXh0ZXJuIGludCBHQ19nZXRfZG9udF9wcmVj b2xsZWN0KHZvaWQpOwoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fZGVwcmVjYXRlZF9fKSkgdW5z
aWduZWQgbG9uZyBHQ190aW1lX2xpbWl0OwojIDM0OCAiLi9pbmNsdWRlL2djLmgiCmV4dGVybiB2 b2lkIEdDX3NldF90aW1lX2xpbWl0KHVuc2lnbmVkIGxvbmcpOwpleHRlcm4gdW5zaWduZWQgbG9u ZyBHQ19nZXRfdGltZV9saW1pdCh2b2lkKTsKIyAzNjEgIi4vaW5jbHVkZS9nYy5oIgpleHRlcm4g
dm9pZCBHQ19zZXRfcGFnZXNfZXhlY3V0YWJsZShpbnQpOwoKCgoKCmV4dGVybiBpbnQgR0NfZ2V0 X3BhZ2VzX2V4ZWN1dGFibGUodm9pZCk7CiMgMzgxICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIHZv aWQgR0Nfc2V0X2hhbmRsZV9mb3JrKGludCk7CiMgMzkwICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJu
IHZvaWQgR0NfYXRmb3JrX3ByZXBhcmUodm9pZCk7CmV4dGVybiB2b2lkIEdDX2F0Zm9ya19wYXJl bnQodm9pZCk7CmV4dGVybiB2b2lkIEdDX2F0Zm9ya19jaGlsZCh2b2lkKTsKCgoKZXh0ZXJuIHZv aWQgR0NfaW5pdCh2b2lkKTsKIyA0MTEgIi4vaW5jbHVkZS9nYy5oIgpleHRlcm4gX19hdHRyaWJ1
dGVfXygoX19tYWxsb2NfXykpIF9fYXR0cmlidXRlX18oKF9fYWxsb2Nfc2l6ZV9fKDEpKSkgdm9p ZCAqCiAgICAgICAgR0NfbWFsbG9jKHNpemVfdCApOwpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19t YWxsb2NfXykpIF9fYXR0cmlidXRlX18oKF9fYWxsb2Nfc2l6ZV9fKDEpKSkgdm9pZCAqCiAgICAg
ICAgR0NfbWFsbG9jX2F0b21pYyhzaXplX3QgKTsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fbWFs bG9jX18pKSBjaGFyICogR0Nfc3RyZHVwKGNvbnN0IGNoYXIgKik7CmV4dGVybiBfX2F0dHJpYnV0 ZV9fKChfX21hbGxvY19fKSkgY2hhciAqCiAgICAgICAgR0Nfc3RybmR1cChjb25zdCBjaGFyICos
IHNpemVfdCkgX19hdHRyaWJ1dGVfXygoX19ub25udWxsX18oMSkpKTsKZXh0ZXJuIF9fYXR0cmli dXRlX18oKF9fbWFsbG9jX18pKSBfX2F0dHJpYnV0ZV9fKChfX2FsbG9jX3NpemVfXygxKSkpIHZv aWQgKgogICAgICAgIEdDX21hbGxvY191bmNvbGxlY3RhYmxlKHNpemVfdCApOwpleHRlcm4gX19h
dHRyaWJ1dGVfXygoX19tYWxsb2NfXykpIF9fYXR0cmlidXRlX18oKF9fYWxsb2Nfc2l6ZV9fKDEp KSkgdm9pZCAqCiAgICAgICAgR0NfbWFsbG9jX3N0dWJib3JuKHNpemVfdCApOwoKCmV4dGVybiBf X2F0dHJpYnV0ZV9fKChfX21hbGxvY19fKSkgX19hdHRyaWJ1dGVfXygoX19hbGxvY19zaXplX18o
MikpKSB2b2lkICoKICAgICAgICBHQ19tZW1hbGlnbihzaXplX3QgLCBzaXplX3QgKTsKZXh0ZXJu IGludCBHQ19wb3NpeF9tZW1hbGlnbih2b2lkICoqICwgc2l6ZV90ICwKICAgICAgICAgICAgICAg ICAgICAgICAgc2l6ZV90ICkgX19hdHRyaWJ1dGVfXygoX19ub25udWxsX18oMSkpKTsKCgoKCgoK
CmV4dGVybiB2b2lkIEdDX2ZyZWUodm9pZCAqKTsKIyA0NTAgIi4vaW5jbHVkZS9nYy5oIgpleHRl cm4gdm9pZCBHQ19jaGFuZ2Vfc3R1YmJvcm4oY29uc3Qgdm9pZCAqKSBfX2F0dHJpYnV0ZV9fKChf X25vbm51bGxfXygxKSkpOwpleHRlcm4gdm9pZCBHQ19lbmRfc3R1YmJvcm5fY2hhbmdlKGNvbnN0
IHZvaWQgKikgX19hdHRyaWJ1dGVfXygoX19ub25udWxsX18oMSkpKTsKIyA0NjQgIi4vaW5jbHVk ZS9nYy5oIgpleHRlcm4gdm9pZCAqIEdDX2Jhc2Uodm9pZCAqICk7CgoKCgoKZXh0ZXJuIGludCBH Q19pc19oZWFwX3B0cihjb25zdCB2b2lkICopOwoKCgoKZXh0ZXJuIHNpemVfdCBHQ19zaXplKGNv
bnN0IHZvaWQgKiApIF9fYXR0cmlidXRlX18oKF9fbm9ubnVsbF9fKDEpKSk7CiMgNDg1ICIuL2lu Y2x1ZGUvZ2MuaCIKZXh0ZXJuIHZvaWQgKiBHQ19yZWFsbG9jKHZvaWQgKiAsCiAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgIHNpemVfdCApCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIF9fYXR0cmlidXRlX18oKF9fYWxsb2Nfc2l6ZV9fKDIpKSk7CgoK CmV4dGVybiBpbnQgR0NfZXhwYW5kX2hwKHNpemVfdCApOwoKCgoKCgpleHRlcm4gdm9pZCBHQ19z ZXRfbWF4X2hlYXBfc2l6ZShHQ193b3JkICk7CgoKCgoKCgpleHRlcm4gdm9pZCBHQ19leGNsdWRl
X3N0YXRpY19yb290cyh2b2lkICogLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgIHZvaWQgKiApOwoKCmV4dGVybiB2b2lkIEdDX2NsZWFyX3Jvb3RzKHZvaWQpOwoK CgoKZXh0ZXJuIHZvaWQgR0NfYWRkX3Jvb3RzKHZvaWQgKiAsCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHZvaWQgKiApOwoKCgpleHRlcm4gdm9pZCBHQ19yZW1vdmVfcm9vdHModm9p ZCAqICwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqICk7CiMgNTM1 ICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIHZvaWQgR0NfcmVnaXN0ZXJfZGlzcGxhY2VtZW50KHNp
emVfdCApOwoKCgpleHRlcm4gdm9pZCBHQ19kZWJ1Z19yZWdpc3Rlcl9kaXNwbGFjZW1lbnQoc2l6 ZV90ICk7CgoKZXh0ZXJuIHZvaWQgR0NfZ2NvbGxlY3Qodm9pZCk7CgoKCgoKCmV4dGVybiB2b2lk IEdDX2djb2xsZWN0X2FuZF91bm1hcCh2b2lkKTsKIyA1NjQgIi4vaW5jbHVkZS9nYy5oIgp0eXBl
ZGVmIGludCAoICogR0Nfc3RvcF9mdW5jKSh2b2lkKTsKZXh0ZXJuIGludCBHQ190cnlfdG9fY29s bGVjdChHQ19zdG9wX2Z1bmMgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgIF9fYXR0cmlidXRlX18oKF9fbm9ubnVsbF9fKDEpKSk7CgoKCgoK
ZXh0ZXJuIHZvaWQgR0Nfc2V0X3N0b3BfZnVuYyhHQ19zdG9wX2Z1bmMgKQogICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fYXR0cmlidXRlX18o KF9fbm9ubnVsbF9fKDEpKSk7CmV4dGVybiBHQ19zdG9wX2Z1bmMgR0NfZ2V0X3N0b3BfZnVuYyh2
b2lkKTsKIyA1ODkgIi4vaW5jbHVkZS9nYy5oIgpleHRlcm4gc2l6ZV90IEdDX2dldF9oZWFwX3Np emUodm9pZCk7CgoKCgpleHRlcm4gc2l6ZV90IEdDX2dldF9mcmVlX2J5dGVzKHZvaWQpOwoKCgoK CmV4dGVybiBzaXplX3QgR0NfZ2V0X3VubWFwcGVkX2J5dGVzKHZvaWQpOwoKCgoKZXh0ZXJuIHNp
emVfdCBHQ19nZXRfYnl0ZXNfc2luY2VfZ2Modm9pZCk7CgoKCgpleHRlcm4gc2l6ZV90IEdDX2dl dF90b3RhbF9ieXRlcyh2b2lkKTsKIyA2MTkgIi4vaW5jbHVkZS9nYy5oIgpleHRlcm4gdm9pZCBH Q19nZXRfaGVhcF91c2FnZV9zYWZlKEdDX3dvcmQgKiAsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBHQ193b3JkICogLAogICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgR0Nfd29yZCAqICwKICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgIEdDX3dvcmQgKiAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBHQ193b3JkICogKTsKCgoKCgpzdHJ1Y3QgR0NfcHJvZl9zdGF0c19zIHsK ICBHQ193b3JkIGhlYXBzaXplX2Z1bGw7CgoKICBHQ193b3JkIGZyZWVfYnl0ZXNfZnVsbDsKCgog IEdDX3dvcmQgdW5tYXBwZWRfYnl0ZXM7CgoKICBHQ193b3JkIGJ5dGVzX2FsbG9jZF9zaW5jZV9n
YzsKCgogIEdDX3dvcmQgYWxsb2NkX2J5dGVzX2JlZm9yZV9nYzsKCgoKICBHQ193b3JkIG5vbl9n Y19ieXRlczsKCgogIEdDX3dvcmQgZ2Nfbm87CgoKICBHQ193b3JkIG1hcmtlcnNfbTE7CgoKCiAg R0Nfd29yZCBieXRlc19yZWNsYWltZWRfc2luY2VfZ2M7CgogIEdDX3dvcmQgcmVjbGFpbWVkX2J5
dGVzX2JlZm9yZV9nYzsKCgp9OwojIDY3MiAiLi9pbmNsdWRlL2djLmgiCmV4dGVybiBzaXplX3Qg R0NfZ2V0X3Byb2Zfc3RhdHMoc3RydWN0IEdDX3Byb2Zfc3RhdHNfcyAqLAogICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90ICk7CgoKCgogIGV4dGVybiBzaXplX3Qg
R0NfZ2V0X3Byb2Zfc3RhdHNfdW5zYWZlKHN0cnVjdCBHQ19wcm9mX3N0YXRzX3MgKiwKICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVfdCApOwoKCgoK ZXh0ZXJuIHZvaWQgR0NfZGlzYWJsZSh2b2lkKTsKCgoKZXh0ZXJuIGludCBHQ19pc19kaXNhYmxl
ZCh2b2lkKTsKCgoKCmV4dGVybiB2b2lkIEdDX2VuYWJsZSh2b2lkKTsKIyA3MDYgIi4vaW5jbHVk ZS9nYy5oIgpleHRlcm4gdm9pZCBHQ19lbmFibGVfaW5jcmVtZW50YWwodm9pZCk7CiMgNzE3ICIu L2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIGludCBHQ19pbmNyZW1lbnRhbF9wcm90ZWN0aW9uX25lZWRz
KHZvaWQpOwojIDcyNiAiLi9pbmNsdWRlL2djLmgiCmV4dGVybiBpbnQgR0NfY29sbGVjdF9hX2xp dHRsZSh2b2lkKTsKIyA3NDIgIi4vaW5jbHVkZS9nYy5oIgpleHRlcm4gX19hdHRyaWJ1dGVfXygo X19tYWxsb2NfXykpIF9fYXR0cmlidXRlX18oKF9fYWxsb2Nfc2l6ZV9fKDEpKSkgdm9pZCAqCiAg
ICAgICAgR0NfbWFsbG9jX2lnbm9yZV9vZmZfcGFnZShzaXplX3QgKTsKZXh0ZXJuIF9fYXR0cmli dXRlX18oKF9fbWFsbG9jX18pKSBfX2F0dHJpYnV0ZV9fKChfX2FsbG9jX3NpemVfXygxKSkpIHZv aWQgKgogICAgICAgIEdDX21hbGxvY19hdG9taWNfaWdub3JlX29mZl9wYWdlKHNpemVfdCApOwoj
IDc1NyAiLi9pbmNsdWRlL2djLmgiCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX21hbGxvY19fKSkg X19hdHRyaWJ1dGVfXygoX19hbGxvY19zaXplX18oMSkpKSB2b2lkICoKICAgICAgICBHQ19tYWxs b2NfYXRvbWljX3VuY29sbGVjdGFibGUoc2l6ZV90ICk7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChf
X21hbGxvY19fKSkgX19hdHRyaWJ1dGVfXygoX19hbGxvY19zaXplX18oMSkpKSB2b2lkICoKICAg ICAgICBHQ19kZWJ1Z19tYWxsb2NfYXRvbWljX3VuY29sbGVjdGFibGUoc2l6ZV90LCBjb25zdCBj aGFyICogcywgaW50IGkpOwoKCgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19tYWxsb2NfXykpIF9f
YXR0cmlidXRlX18oKF9fYWxsb2Nfc2l6ZV9fKDEpKSkgdm9pZCAqCiAgICAgICAgR0NfZGVidWdf bWFsbG9jKHNpemVfdCAsIGNvbnN0IGNoYXIgKiBzLCBpbnQgaSk7CmV4dGVybiBfX2F0dHJpYnV0 ZV9fKChfX21hbGxvY19fKSkgX19hdHRyaWJ1dGVfXygoX19hbGxvY19zaXplX18oMSkpKSB2b2lk
ICoKICAgICAgICBHQ19kZWJ1Z19tYWxsb2NfYXRvbWljKHNpemVfdCAsIGNvbnN0IGNoYXIgKiBz LCBpbnQgaSk7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX21hbGxvY19fKSkgY2hhciAqCiAgICAg ICAgR0NfZGVidWdfc3RyZHVwKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqIHMsIGludCBpKTsK
ZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fbWFsbG9jX18pKSBjaGFyICoKICAgICAgICBHQ19kZWJ1 Z19zdHJuZHVwKGNvbnN0IGNoYXIgKiwgc2l6ZV90LCBjb25zdCBjaGFyICogcywgaW50IGkpCiAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19h
dHRyaWJ1dGVfXygoX19ub25udWxsX18oMSkpKTsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fbWFs bG9jX18pKSBfX2F0dHJpYnV0ZV9fKChfX2FsbG9jX3NpemVfXygxKSkpIHZvaWQgKgogICAgICAg IEdDX2RlYnVnX21hbGxvY191bmNvbGxlY3RhYmxlKHNpemVfdCAsCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqIHMsIGludCBpKTsKZXh0ZXJuIF9fYXR0 cmlidXRlX18oKF9fbWFsbG9jX18pKSBfX2F0dHJpYnV0ZV9fKChfX2FsbG9jX3NpemVfXygxKSkp IHZvaWQgKgogICAgICAgIEdDX2RlYnVnX21hbGxvY19zdHViYm9ybihzaXplX3QgLCBjb25zdCBj
aGFyICogcywgaW50IGkpOwpleHRlcm4gX19hdHRyaWJ1dGVfXygoX19tYWxsb2NfXykpIF9fYXR0 cmlidXRlX18oKF9fYWxsb2Nfc2l6ZV9fKDEpKSkgdm9pZCAqCiAgICAgICAgR0NfZGVidWdfbWFs bG9jX2lnbm9yZV9vZmZfcGFnZShzaXplX3QgLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgY2hhciAqIHMsIGludCBpKTsKZXh0ZXJuIF9fYXR0cmlidXRlX18o KF9fbWFsbG9jX18pKSBfX2F0dHJpYnV0ZV9fKChfX2FsbG9jX3NpemVfXygxKSkpIHZvaWQgKgog ICAgICAgIEdDX2RlYnVnX21hbGxvY19hdG9taWNfaWdub3JlX29mZl9wYWdlKHNpemVfdCAsCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICogcywgaW50 IGkpOwpleHRlcm4gdm9pZCBHQ19kZWJ1Z19mcmVlKHZvaWQgKik7CmV4dGVybiB2b2lkICogR0Nf ZGVidWdfcmVhbGxvYyh2b2lkICogLAogICAgICAgICAgICAgICAgICAgICAgICBzaXplX3QgLCBj
b25zdCBjaGFyICogcywgaW50IGkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgIF9fYXR0cmlidXRlX18oKF9fYWxsb2Nfc2l6ZV9fKDIpKSk7CmV4dGVybiB2b2lk IEdDX2RlYnVnX2NoYW5nZV9zdHViYm9ybihjb25zdCB2b2lkICopIF9fYXR0cmlidXRlX18oKF9f
bm9ubnVsbF9fKDEpKSk7CmV4dGVybiB2b2lkIEdDX2RlYnVnX2VuZF9zdHViYm9ybl9jaGFuZ2Uo Y29uc3Qgdm9pZCAqKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgIF9fYXR0cmlidXRlX18oKF9fbm9ubnVsbF9fKDEpKSk7CiMgODA0ICIuL2lu
Y2x1ZGUvZ2MuaCIKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fbWFsbG9jX18pKSBfX2F0dHJpYnV0 ZV9fKChfX2FsbG9jX3NpemVfXygxKSkpIHZvaWQgKgogICAgICAgIEdDX2RlYnVnX21hbGxvY19y ZXBsYWNlbWVudChzaXplX3QgKTsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fYWxsb2Nfc2l6ZV9f
KDIpKSkgdm9pZCAqCiAgICAgICAgR0NfZGVidWdfcmVhbGxvY19yZXBsYWNlbWVudCh2b2lkICog LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90ICk7CiMgOTExICIu L2luY2x1ZGUvZ2MuaCIKdHlwZWRlZiB2b2lkICggKiBHQ19maW5hbGl6YXRpb25fcHJvYykodm9p
ZCAqICwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2 b2lkICogKTsKCmV4dGVybiB2b2lkIEdDX3JlZ2lzdGVyX2ZpbmFsaXplcih2b2lkICogLAogICAg ICAgICAgICAgICAgICAgICAgICBHQ19maW5hbGl6YXRpb25fcHJvYyAsIHZvaWQgKiAsCiAgICAg
ICAgICAgICAgICAgICAgICAgIEdDX2ZpbmFsaXphdGlvbl9wcm9jICogLCB2b2lkICoqICkKICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19hdHRyaWJ1dGVf XygoX19ub25udWxsX18oMSkpKTsKZXh0ZXJuIHZvaWQgR0NfZGVidWdfcmVnaXN0ZXJfZmluYWxp
emVyKHZvaWQgKiAsCiAgICAgICAgICAgICAgICAgICAgICAgIEdDX2ZpbmFsaXphdGlvbl9wcm9j ICwgdm9pZCAqICwKICAgICAgICAgICAgICAgICAgICAgICAgR0NfZmluYWxpemF0aW9uX3Byb2Mg KiAsIHZvaWQgKiogKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBfX2F0dHJpYnV0ZV9fKChfX25vbm51bGxfXygxKSkpOwojIDk3MCAiLi9pbmNsdWRlL2dj LmgiCmV4dGVybiB2b2lkIEdDX3JlZ2lzdGVyX2ZpbmFsaXplcl9pZ25vcmVfc2VsZih2b2lkICog LAogICAgICAgICAgICAgICAgICAgICAgICBHQ19maW5hbGl6YXRpb25fcHJvYyAsIHZvaWQgKiAs
CiAgICAgICAgICAgICAgICAgICAgICAgIEdDX2ZpbmFsaXphdGlvbl9wcm9jICogLCB2b2lkICoq ICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19hdHRy aWJ1dGVfXygoX19ub25udWxsX18oMSkpKTsKZXh0ZXJuIHZvaWQgR0NfZGVidWdfcmVnaXN0ZXJf
ZmluYWxpemVyX2lnbm9yZV9zZWxmKHZvaWQgKiAsCiAgICAgICAgICAgICAgICAgICAgICAgIEdD X2ZpbmFsaXphdGlvbl9wcm9jICwgdm9pZCAqICwKICAgICAgICAgICAgICAgICAgICAgICAgR0Nf ZmluYWxpemF0aW9uX3Byb2MgKiAsIHZvaWQgKiogKQogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBfX2F0dHJpYnV0ZV9fKChfX25vbm51bGxfXygxKSkpOwoK CgoKCmV4dGVybiB2b2lkIEdDX3JlZ2lzdGVyX2ZpbmFsaXplcl9ub19vcmRlcih2b2lkICogLAog ICAgICAgICAgICAgICAgICAgICAgICBHQ19maW5hbGl6YXRpb25fcHJvYyAsIHZvaWQgKiAsCiAg
ICAgICAgICAgICAgICAgICAgICAgIEdDX2ZpbmFsaXphdGlvbl9wcm9jICogLCB2b2lkICoqICkK ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19hdHRyaWJ1 dGVfXygoX19ub25udWxsX18oMSkpKTsKZXh0ZXJuIHZvaWQgR0NfZGVidWdfcmVnaXN0ZXJfZmlu
YWxpemVyX25vX29yZGVyKHZvaWQgKiAsCiAgICAgICAgICAgICAgICAgICAgICAgIEdDX2ZpbmFs aXphdGlvbl9wcm9jICwgdm9pZCAqICwKICAgICAgICAgICAgICAgICAgICAgICAgR0NfZmluYWxp emF0aW9uX3Byb2MgKiAsIHZvaWQgKiogKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBfX2F0dHJpYnV0ZV9fKChfX25vbm51bGxfXygxKSkpOwojIDEwMDgg Ii4vaW5jbHVkZS9nYy5oIgpleHRlcm4gdm9pZCBHQ19yZWdpc3Rlcl9maW5hbGl6ZXJfdW5yZWFj aGFibGUodm9pZCAqICwKICAgICAgICAgICAgICAgICAgICAgICAgR0NfZmluYWxpemF0aW9uX3By
b2MgLCB2b2lkICogLAogICAgICAgICAgICAgICAgICAgICAgICBHQ19maW5hbGl6YXRpb25fcHJv YyAqICwgdm9pZCAqKiApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgIF9fYXR0cmlidXRlX18oKF9fbm9ubnVsbF9fKDEpKSk7CmV4dGVybiB2b2lkIEdDX2Rl
YnVnX3JlZ2lzdGVyX2ZpbmFsaXplcl91bnJlYWNoYWJsZSh2b2lkICogLAogICAgICAgICAgICAg ICAgICAgICAgICBHQ19maW5hbGl6YXRpb25fcHJvYyAsIHZvaWQgKiAsCiAgICAgICAgICAgICAg ICAgICAgICAgIEdDX2ZpbmFsaXphdGlvbl9wcm9jICogLCB2b2lkICoqICkKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19hdHRyaWJ1dGVfXygoX19ub25u dWxsX18oMSkpKTsKIyAxMDI2ICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIGludCBHQ19yZWdpc3Rl cl9kaXNhcHBlYXJpbmdfbGluayh2b2lkICoqICkKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgX19hdHRyaWJ1dGVfXygoX19ub25udWxsX18oMSkpKTsKIyAx MDQ4ICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIGludCBHQ19nZW5lcmFsX3JlZ2lzdGVyX2Rpc2Fw cGVhcmluZ19saW5rKHZvaWQgKiogLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgY29uc3Qgdm9pZCAqICkKICAgICAgICAgICAgICAgICAgICAgICAg X19hdHRyaWJ1dGVfXygoX19ub25udWxsX18oMSkpKSBfX2F0dHJpYnV0ZV9fKChfX25vbm51bGxf XygyKSkpOwojIDEwODIgIi4vaW5jbHVkZS9nYy5oIgpleHRlcm4gaW50IEdDX21vdmVfZGlzYXBw
ZWFyaW5nX2xpbmsodm9pZCAqKiAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgIHZvaWQgKiogKQogICAgICAgICAgICAgICAgICAgICAgICBfX2F0dHJpYnV0ZV9f KChfX25vbm51bGxfXygyKSkpOwojIDEwOTcgIi4vaW5jbHVkZS9nYy5oIgpleHRlcm4gaW50IEdD
X3VucmVnaXN0ZXJfZGlzYXBwZWFyaW5nX2xpbmsodm9pZCAqKiApOwoKCgoKZXh0ZXJuIGludCBH Q19yZWdpc3Rlcl9sb25nX2xpbmsodm9pZCAqKiAsCiAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgIGNvbnN0IHZvaWQgKiApCiAgICAgICAgICAgICAgICAgICAgICAgIF9fYXR0cmli
dXRlX18oKF9fbm9ubnVsbF9fKDEpKSkgX19hdHRyaWJ1dGVfXygoX19ub25udWxsX18oMikpKTsK IyAxMTEzICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIGludCBHQ19tb3ZlX2xvbmdfbGluayh2b2lk ICoqICwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKiogKQogICAg
ICAgICAgICAgICAgICAgICAgICBfX2F0dHJpYnV0ZV9fKChfX25vbm51bGxfXygyKSkpOwoKCgpl eHRlcm4gaW50IEdDX3VucmVnaXN0ZXJfbG9uZ19saW5rKHZvaWQgKiogKTsKCgoKCmV4dGVybiBp bnQgR0Nfc2hvdWxkX2ludm9rZV9maW5hbGl6ZXJzKHZvaWQpOwoKZXh0ZXJuIGludCBHQ19pbnZv
a2VfZmluYWxpemVycyh2b2lkKTsKIyAxMTU1ICIuL2luY2x1ZGUvZ2MuaCIKdHlwZWRlZiB2b2lk ICggKiBHQ193YXJuX3Byb2MpKGNoYXIgKiAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgIEdDX3dvcmQgKTsKZXh0ZXJuIHZvaWQgR0Nfc2V0X3dhcm5fcHJvYyhHQ193
YXJuX3Byb2MgKSBfX2F0dHJpYnV0ZV9fKChfX25vbm51bGxfXygxKSkpOwoKZXh0ZXJuIEdDX3dh cm5fcHJvYyBHQ19nZXRfd2Fybl9wcm9jKHZvaWQpOwoKCgpleHRlcm4gdm9pZCBHQ19pZ25vcmVf d2Fybl9wcm9jKGNoYXIgKiwgR0Nfd29yZCk7CiMgMTE3MiAiLi9pbmNsdWRlL2djLmgiCnR5cGVk
ZWYgdm9pZCAoICogR0NfYWJvcnRfZnVuYykoY29uc3QgY2hhciAqICk7CmV4dGVybiB2b2lkIEdD X3NldF9hYm9ydF9mdW5jKEdDX2Fib3J0X2Z1bmMpIF9fYXR0cmlidXRlX18oKF9fbm9ubnVsbF9f KDEpKSk7CmV4dGVybiBHQ19hYm9ydF9mdW5jIEdDX2dldF9hYm9ydF9mdW5jKHZvaWQpOwojIDEx
ODQgIi4vaW5jbHVkZS9nYy5oIgp0eXBlZGVmIEdDX3dvcmQgR0NfaGlkZGVuX3BvaW50ZXI7CiMg MTE5OCAiLi9pbmNsdWRlL2djLmgiCnR5cGVkZWYgdm9pZCAqICggKiBHQ19mbl90eXBlKSh2b2lk ICogKTsKZXh0ZXJuIHZvaWQgKiBHQ19jYWxsX3dpdGhfYWxsb2NfbG9jayhHQ19mbl90eXBlICwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICogKSBfX2F0dHJpYnV0ZV9fKChf X25vbm51bGxfXygxKSkpOwojIDEyMTQgIi4vaW5jbHVkZS9nYy5oIgpzdHJ1Y3QgR0Nfc3RhY2tf YmFzZSB7CiAgdm9pZCAqIG1lbV9iYXNlOwoKCgp9OwoKdHlwZWRlZiB2b2lkICogKCAqIEdDX3N0
YWNrX2Jhc2VfZnVuYykoCiAgICAgICAgICAgICAgICBzdHJ1Y3QgR0Nfc3RhY2tfYmFzZSAqICwg dm9pZCAqICk7CgoKCgoKZXh0ZXJuIHZvaWQgKiBHQ19jYWxsX3dpdGhfc3RhY2tfYmFzZShHQ19z dGFja19iYXNlX2Z1bmMgLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dm9pZCAqICkgX19hdHRyaWJ1dGVfXygoX19ub25udWxsX18oMSkpKTsKIyAxMjUxICIuL2luY2x1 ZGUvZ2MuaCIKICBleHRlcm4gdm9pZCBHQ19zZXRfc3VzcGVuZF9zaWduYWwoaW50KTsKCgoKICBl eHRlcm4gdm9pZCBHQ19zZXRfdGhyX3Jlc3RhcnRfc2lnbmFsKGludCk7CgoKCiAgZXh0ZXJuIGlu
dCBHQ19nZXRfc3VzcGVuZF9zaWduYWwodm9pZCk7CgoKCgogIGV4dGVybiBpbnQgR0NfZ2V0X3Ro cl9yZXN0YXJ0X3NpZ25hbCh2b2lkKTsKCgoKICBleHRlcm4gdm9pZCBHQ19zdGFydF9tYXJrX3Ro cmVhZHModm9pZCk7CgoKCgoKCgogIGV4dGVybiB2b2lkIEdDX2FsbG93X3JlZ2lzdGVyX3RocmVh
ZHModm9pZCk7CiMgMTI5OCAiLi9pbmNsdWRlL2djLmgiCiAgZXh0ZXJuIGludCBHQ19yZWdpc3Rl cl9teV90aHJlYWQoY29uc3Qgc3RydWN0IEdDX3N0YWNrX2Jhc2UgKikKICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2F0dHJpYnV0ZV9fKChf
X25vbm51bGxfXygxKSkpOwoKCgogIGV4dGVybiBpbnQgR0NfdGhyZWFkX2lzX3JlZ2lzdGVyZWQo dm9pZCk7CiMgMTMxNyAiLi9pbmNsdWRlL2djLmgiCiAgZXh0ZXJuIGludCBHQ191bnJlZ2lzdGVy X215X3RocmVhZCh2b2lkKTsKIyAxMzI5ICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIHZvaWQgKiBH
Q19kb19ibG9ja2luZyhHQ19mbl90eXBlICwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICB2b2lkICogKSBfX2F0dHJpYnV0ZV9fKChfX25vbm51bGxfXygxKSkpOwojIDEzNDEgIi4vaW5j bHVkZS9nYy5oIgpleHRlcm4gdm9pZCAqIEdDX2NhbGxfd2l0aF9nY19hY3RpdmUoR0NfZm5fdHlw
ZSAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqICkgX19hdHRyaWJ1dGVf XygoX19ub25udWxsX18oMSkpKTsKIyAxMzUxICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIGludCBH Q19nZXRfc3RhY2tfYmFzZShzdHJ1Y3QgR0Nfc3RhY2tfYmFzZSAqKQogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fYXR0cmlidXRlX18oKF9f bm9ubnVsbF9fKDEpKSk7CiMgMTM2MyAiLi9pbmNsdWRlL2djLmgiCmV4dGVybiB2b2lkICogR0Nf c2FtZV9vYmoodm9pZCAqICwgdm9pZCAqICk7CgoKCgoKZXh0ZXJuIHZvaWQgKiBHQ19wcmVfaW5j
cih2b2lkICoqLCBwdHJkaWZmX3QgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgIF9fYXR0cmlidXRlX18oKF9fbm9ubnVsbF9fKDEpKSk7CmV4 dGVybiB2b2lkICogR0NfcG9zdF9pbmNyKHZvaWQgKiosIHB0cmRpZmZfdCApCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19hdHRyaWJ1dGVf XygoX19ub25udWxsX18oMSkpKTsKIyAxMzgyICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIHZvaWQg KiBHQ19pc192aXNpYmxlKHZvaWQgKiApOwoKCgoKCgpleHRlcm4gdm9pZCAqIEdDX2lzX3ZhbGlk
X2Rpc3BsYWNlbWVudCh2b2lkICogKTsKCgoKCgpleHRlcm4gdm9pZCBHQ19kdW1wKHZvaWQpOwoj IDE0MzUgIi4vaW5jbHVkZS9nYy5oIgpleHRlcm4gdm9pZCAoICogR0Nfc2FtZV9vYmpfcHJpbnRf cHJvYykodm9pZCAqICwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdm9pZCAqICk7CmV4dGVybiB2b2lkICggKiBHQ19pc192YWxpZF9kaXNwbGFjZW1l bnRfcHJpbnRfcHJvYykodm9pZCAqKTsKZXh0ZXJuIHZvaWQgKCAqIEdDX2lzX3Zpc2libGVfcHJp bnRfcHJvYykodm9pZCAqKTsKCgoKCiMgMSAiLi9pbmNsdWRlL2djX3B0aHJlYWRfcmVkaXJlY3Rz
LmgiIDEKIyAzNCAiLi9pbmNsdWRlL2djX3B0aHJlYWRfcmVkaXJlY3RzLmgiCiMgMSAiL3Vzci9p bmNsdWRlL3B0aHJlYWQuaCIgMSAzIDQKIyAyMiAiL3Vzci9pbmNsdWRlL3B0aHJlYWQuaCIgMyA0 CiMgMSAiL3Vzci9pbmNsdWRlL2VuZGlhbi5oIiAxIDMgNAojIDM2ICIvdXNyL2luY2x1ZGUvZW5k
aWFuLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL2VuZGlhbi5oIiAxIDMgNAojIDM3ICIv dXNyL2luY2x1ZGUvZW5kaWFuLmgiIDIgMyA0CiMgNjAgIi91c3IvaW5jbHVkZS9lbmRpYW4uaCIg MyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvYnl0ZXN3YXAuaCIgMSAzIDQKIyAyNCAiL3Vzci9p
bmNsdWRlL2JpdHMvYnl0ZXN3YXAuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvd29yZHNp emUuaCIgMSAzIDQKIyAyNSAiL3Vzci9pbmNsdWRlL2JpdHMvYnl0ZXN3YXAuaCIgMiAzIDQKIyAz MyAiL3Vzci9pbmNsdWRlL2JpdHMvYnl0ZXN3YXAuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2Jp
dHMvYnl0ZXN3YXAtMTYuaCIgMSAzIDQKIyAyNCAiL3Vzci9pbmNsdWRlL2JpdHMvYnl0ZXN3YXAt MTYuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvd29yZHNpemUuaCIgMSAzIDQKIyAyNSAi L3Vzci9pbmNsdWRlL2JpdHMvYnl0ZXN3YXAtMTYuaCIgMiAzIDQKIyAzNCAiL3Vzci9pbmNsdWRl
L2JpdHMvYnl0ZXN3YXAuaCIgMiAzIDQKIyA2MSAiL3Vzci9pbmNsdWRlL2VuZGlhbi5oIiAyIDMg NAojIDIzICIvdXNyL2luY2x1ZGUvcHRocmVhZC5oIiAyIDMgNAojIDEgIi91c3IvaW5jbHVkZS9z Y2hlZC5oIiAxIDMgNAojIDI1ICIvdXNyL2luY2x1ZGUvc2NoZWQuaCIgMyA0CiMgMSAiL3Vzci9p
bmNsdWRlL2JpdHMvdHlwZXMuaCIgMSAzIDQKIyAyNyAiL3Vzci9pbmNsdWRlL2JpdHMvdHlwZXMu aCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvd29yZHNpemUuaCIgMSAzIDQKIyAyOCAiL3Vz ci9pbmNsdWRlL2JpdHMvdHlwZXMuaCIgMiAzIDQKCgoKIyAzMCAiL3Vzci9pbmNsdWRlL2JpdHMv
dHlwZXMuaCIgMyA0CnR5cGVkZWYgdW5zaWduZWQgY2hhciBfX3VfY2hhcjsKdHlwZWRlZiB1bnNp Z25lZCBzaG9ydCBpbnQgX191X3Nob3J0Owp0eXBlZGVmIHVuc2lnbmVkIGludCBfX3VfaW50Owp0 eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fdV9sb25nOwoKCnR5cGVkZWYgc2lnbmVkIGNoYXIg
X19pbnQ4X3Q7CnR5cGVkZWYgdW5zaWduZWQgY2hhciBfX3VpbnQ4X3Q7CnR5cGVkZWYgc2lnbmVk IHNob3J0IGludCBfX2ludDE2X3Q7CnR5cGVkZWYgdW5zaWduZWQgc2hvcnQgaW50IF9fdWludDE2 X3Q7CnR5cGVkZWYgc2lnbmVkIGludCBfX2ludDMyX3Q7CnR5cGVkZWYgdW5zaWduZWQgaW50IF9f
dWludDMyX3Q7Cgp0eXBlZGVmIHNpZ25lZCBsb25nIGludCBfX2ludDY0X3Q7CnR5cGVkZWYgdW5z aWduZWQgbG9uZyBpbnQgX191aW50NjRfdDsKCgoKCgoKCnR5cGVkZWYgbG9uZyBpbnQgX19xdWFk X3Q7CnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQgX191X3F1YWRfdDsKIyAxMjEgIi91c3IvaW5j
bHVkZS9iaXRzL3R5cGVzLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3R5cGVzaXplcy5o IiAxIDMgNAojIDEyMiAiL3Vzci9pbmNsdWRlL2JpdHMvdHlwZXMuaCIgMiAzIDQKCgp0eXBlZGVm IHVuc2lnbmVkIGxvbmcgaW50IF9fZGV2X3Q7CnR5cGVkZWYgdW5zaWduZWQgaW50IF9fdWlkX3Q7
CnR5cGVkZWYgdW5zaWduZWQgaW50IF9fZ2lkX3Q7CnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQg X19pbm9fdDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIGludCBfX2lubzY0X3Q7CnR5cGVkZWYgdW5z aWduZWQgaW50IF9fbW9kZV90Owp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fbmxpbmtfdDsK
dHlwZWRlZiBsb25nIGludCBfX29mZl90Owp0eXBlZGVmIGxvbmcgaW50IF9fb2ZmNjRfdDsKdHlw ZWRlZiBpbnQgX19waWRfdDsKdHlwZWRlZiBzdHJ1Y3QgeyBpbnQgX192YWxbMl07IH0gX19mc2lk X3Q7CnR5cGVkZWYgbG9uZyBpbnQgX19jbG9ja190Owp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50
IF9fcmxpbV90Owp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fcmxpbTY0X3Q7CnR5cGVkZWYg dW5zaWduZWQgaW50IF9faWRfdDsKdHlwZWRlZiBsb25nIGludCBfX3RpbWVfdDsKdHlwZWRlZiB1 bnNpZ25lZCBpbnQgX191c2Vjb25kc190Owp0eXBlZGVmIGxvbmcgaW50IF9fc3VzZWNvbmRzX3Q7
Cgp0eXBlZGVmIGludCBfX2RhZGRyX3Q7CnR5cGVkZWYgaW50IF9fa2V5X3Q7CgoKdHlwZWRlZiBp bnQgX19jbG9ja2lkX3Q7CgoKdHlwZWRlZiB2b2lkICogX190aW1lcl90OwoKCnR5cGVkZWYgbG9u ZyBpbnQgX19ibGtzaXplX3Q7CgoKCgp0eXBlZGVmIGxvbmcgaW50IF9fYmxrY250X3Q7CnR5cGVk
ZWYgbG9uZyBpbnQgX19ibGtjbnQ2NF90OwoKCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQgX19m c2Jsa2NudF90Owp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fZnNibGtjbnQ2NF90OwoKCnR5 cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQgX19mc2ZpbGNudF90Owp0eXBlZGVmIHVuc2lnbmVkIGxv
bmcgaW50IF9fZnNmaWxjbnQ2NF90OwoKCnR5cGVkZWYgbG9uZyBpbnQgX19mc3dvcmRfdDsKCnR5 cGVkZWYgbG9uZyBpbnQgX19zc2l6ZV90OwoKCnR5cGVkZWYgbG9uZyBpbnQgX19zeXNjYWxsX3Ns b25nX3Q7Cgp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fc3lzY2FsbF91bG9uZ190OwoKCgp0
eXBlZGVmIF9fb2ZmNjRfdCBfX2xvZmZfdDsKdHlwZWRlZiBfX3F1YWRfdCAqX19xYWRkcl90Owp0 eXBlZGVmIGNoYXIgKl9fY2FkZHJfdDsKCgp0eXBlZGVmIGxvbmcgaW50IF9faW50cHRyX3Q7CgoK dHlwZWRlZiB1bnNpZ25lZCBpbnQgX19zb2NrbGVuX3Q7CiMgMjYgIi91c3IvaW5jbHVkZS9zY2hl
ZC5oIiAyIDMgNAoKCiMgMSAiL3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51eC82LjAuMC9p bmNsdWRlL3N0ZGRlZi5oIiAxIDMgNAojIDI5ICIvdXNyL2luY2x1ZGUvc2NoZWQuaCIgMiAzIDQK CgoKCgojIDEgIi91c3IvaW5jbHVkZS90aW1lLmgiIDEgMyA0CiMgNzMgIi91c3IvaW5jbHVkZS90
aW1lLmgiIDMgNAoKCnR5cGVkZWYgX190aW1lX3QgdGltZV90OwoKCgojIDEyMCAiL3Vzci9pbmNs dWRlL3RpbWUuaCIgMyA0CnN0cnVjdCB0aW1lc3BlYwogIHsKICAgIF9fdGltZV90IHR2X3NlYzsK ICAgIF9fc3lzY2FsbF9zbG9uZ190IHR2X25zZWM7CiAgfTsKIyAzNSAiL3Vzci9pbmNsdWRlL3Nj
aGVkLmgiIDIgMyA0CgoKdHlwZWRlZiBfX3BpZF90IHBpZF90OwoKCgoKCiMgMSAiL3Vzci9pbmNs dWRlL2JpdHMvc2NoZWQuaCIgMSAzIDQKIyA3MiAiL3Vzci9pbmNsdWRlL2JpdHMvc2NoZWQuaCIg MyA0CnN0cnVjdCBzY2hlZF9wYXJhbQogIHsKICAgIGludCBfX3NjaGVkX3ByaW9yaXR5OwogIH07
CgoKIyA5NSAiL3Vzci9pbmNsdWRlL2JpdHMvc2NoZWQuaCIgMyA0CgoKCgoKCgoKc3RydWN0IF9f c2NoZWRfcGFyYW0KICB7CiAgICBpbnQgX19zY2hlZF9wcmlvcml0eTsKICB9OwojIDExOCAiL3Vz ci9pbmNsdWRlL2JpdHMvc2NoZWQuaCIgMyA0CnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQgX19j
cHVfbWFzazsKCgoKCgoKdHlwZWRlZiBzdHJ1Y3QKewogIF9fY3B1X21hc2sgX19iaXRzWzEwMjQg LyAoOCAqIHNpemVvZiAoX19jcHVfbWFzaykpXTsKfSBjcHVfc2V0X3Q7CiMgMjAxICIvdXNyL2lu Y2x1ZGUvYml0cy9zY2hlZC5oIiAzIDQKCgpleHRlcm4gaW50IF9fc2NoZWRfY3B1Y291bnQgKHNp
emVfdCBfX3NldHNpemUsIGNvbnN0IGNwdV9zZXRfdCAqX19zZXRwKQogIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CmV4dGVybiBjcHVfc2V0X3QgKl9fc2NoZWRfY3B1 YWxsb2MgKHNpemVfdCBfX2NvdW50KSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl
YWZfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiB2 b2lkIF9fc2NoZWRfY3B1ZnJlZSAoY3B1X3NldF90ICpfX3NldCkgX19hdHRyaWJ1dGVfXyAoKF9f bm90aHJvd19fICwgX19sZWFmX18pKTsKCgojIDQ0ICIvdXNyL2luY2x1ZGUvc2NoZWQuaCIgMiAz
IDQKCgoKCgoKCmV4dGVybiBpbnQgc2NoZWRfc2V0cGFyYW0gKF9fcGlkX3QgX19waWQsIGNvbnN0 IHN0cnVjdCBzY2hlZF9wYXJhbSAqX19wYXJhbSkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro cm93X18gLCBfX2xlYWZfXykpOwoKCmV4dGVybiBpbnQgc2NoZWRfZ2V0cGFyYW0gKF9fcGlkX3Qg
X19waWQsIHN0cnVjdCBzY2hlZF9wYXJhbSAqX19wYXJhbSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90 aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRlcm4gaW50IHNjaGVkX3NldHNjaGVkdWxlciAoX19w aWRfdCBfX3BpZCwgaW50IF9fcG9saWN5LAogICAgICAgICAgY29uc3Qgc3RydWN0IHNjaGVkX3Bh
cmFtICpfX3BhcmFtKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoK CmV4dGVybiBpbnQgc2NoZWRfZ2V0c2NoZWR1bGVyIChfX3BpZF90IF9fcGlkKSBfX2F0dHJpYnV0 ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCmV4dGVybiBpbnQgc2NoZWRfeWllbGQg
KHZvaWQpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJu IGludCBzY2hlZF9nZXRfcHJpb3JpdHlfbWF4IChpbnQgX19hbGdvcml0aG0pIF9fYXR0cmlidXRl X18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGludCBzY2hlZF9nZXRfcHJp
b3JpdHlfbWluIChpbnQgX19hbGdvcml0aG0pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs IF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGludCBzY2hlZF9ycl9nZXRfaW50ZXJ2YWwgKF9fcGlkX3Qg X19waWQsIHN0cnVjdCB0aW1lc3BlYyAqX190KSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18g
LCBfX2xlYWZfXykpOwojIDEyNiAiL3Vzci9pbmNsdWRlL3NjaGVkLmgiIDMgNAoKIyAyNCAiL3Vz ci9pbmNsdWRlL3B0aHJlYWQuaCIgMiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvdGltZS5oIiAxIDMg NAojIDI5ICIvdXNyL2luY2x1ZGUvdGltZS5oIiAzIDQKCgoKCgoKCgojIDEgIi91c3IvbGliL2dj
Yy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVkZS9zdGRkZWYuaCIgMSAzIDQKIyAzOCAi L3Vzci9pbmNsdWRlL3RpbWUuaCIgMiAzIDQKCgoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy90aW1l LmgiIDEgMyA0CiMgNDIgIi91c3IvaW5jbHVkZS90aW1lLmgiIDIgMyA0CiMgNTcgIi91c3IvaW5j
bHVkZS90aW1lLmgiIDMgNAoKCnR5cGVkZWYgX19jbG9ja190IGNsb2NrX3Q7CgoKCiMgOTEgIi91 c3IvaW5jbHVkZS90aW1lLmgiIDMgNAp0eXBlZGVmIF9fY2xvY2tpZF90IGNsb2NraWRfdDsKIyAx MDMgIi91c3IvaW5jbHVkZS90aW1lLmgiIDMgNAp0eXBlZGVmIF9fdGltZXJfdCB0aW1lcl90Owoj
IDEzMSAiL3Vzci9pbmNsdWRlL3RpbWUuaCIgMyA0CgoKc3RydWN0IHRtCnsKICBpbnQgdG1fc2Vj OwogIGludCB0bV9taW47CiAgaW50IHRtX2hvdXI7CiAgaW50IHRtX21kYXk7CiAgaW50IHRtX21v bjsKICBpbnQgdG1feWVhcjsKICBpbnQgdG1fd2RheTsKICBpbnQgdG1feWRheTsKICBpbnQgdG1f
aXNkc3Q7CgoKICBsb25nIGludCB0bV9nbXRvZmY7CiAgY29uc3QgY2hhciAqdG1fem9uZTsKCgoK Cn07CgoKCgoKCgoKc3RydWN0IGl0aW1lcnNwZWMKICB7CiAgICBzdHJ1Y3QgdGltZXNwZWMgaXRf aW50ZXJ2YWw7CiAgICBzdHJ1Y3QgdGltZXNwZWMgaXRfdmFsdWU7CiAgfTsKCgpzdHJ1Y3Qgc2ln
ZXZlbnQ7CiMgMTg2ICIvdXNyL2luY2x1ZGUvdGltZS5oIiAzIDQKCgoKZXh0ZXJuIGNsb2NrX3Qg Y2xvY2sgKHZvaWQpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoK ZXh0ZXJuIHRpbWVfdCB0aW1lICh0aW1lX3QgKl9fdGltZXIpIF9fYXR0cmlidXRlX18gKChfX25v
dGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGRvdWJsZSBkaWZmdGltZSAodGltZV90IF9f dGltZTEsIHRpbWVfdCBfX3RpbWUwKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs IF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fY29uc3RfXykpOwoKCmV4dGVybiB0aW1lX3Qg
bWt0aW1lIChzdHJ1Y3QgdG0gKl9fdHApIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f bGVhZl9fKSk7CgoKCgoKZXh0ZXJuIHNpemVfdCBzdHJmdGltZSAoY2hhciAqX19yZXN0cmljdCBf X3MsIHNpemVfdCBfX21heHNpemUsCiAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQs
CiAgIGNvbnN0IHN0cnVjdCB0bSAqX19yZXN0cmljdCBfX3RwKSBfX2F0dHJpYnV0ZV9fICgoX19u b3Rocm93X18gLCBfX2xlYWZfXykpOwoKIyAyMjEgIi91c3IvaW5jbHVkZS90aW1lLmgiIDMgNAoj IDEgIi91c3IvaW5jbHVkZS94bG9jYWxlLmgiIDEgMyA0CiMgMjcgIi91c3IvaW5jbHVkZS94bG9j
YWxlLmgiIDMgNAp0eXBlZGVmIHN0cnVjdCBfX2xvY2FsZV9zdHJ1Y3QKewoKICBzdHJ1Y3QgX19s b2NhbGVfZGF0YSAqX19sb2NhbGVzWzEzXTsKCgogIGNvbnN0IHVuc2lnbmVkIHNob3J0IGludCAq X19jdHlwZV9iOwogIGNvbnN0IGludCAqX19jdHlwZV90b2xvd2VyOwogIGNvbnN0IGludCAqX19j
dHlwZV90b3VwcGVyOwoKCiAgY29uc3QgY2hhciAqX19uYW1lc1sxM107Cn0gKl9fbG9jYWxlX3Q7 CgoKdHlwZWRlZiBfX2xvY2FsZV90IGxvY2FsZV90OwojIDIyMiAiL3Vzci9pbmNsdWRlL3RpbWUu aCIgMiAzIDQKCmV4dGVybiBzaXplX3Qgc3RyZnRpbWVfbCAoY2hhciAqX19yZXN0cmljdCBfX3Ms
IHNpemVfdCBfX21heHNpemUsCiAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwK ICAgICBjb25zdCBzdHJ1Y3QgdG0gKl9fcmVzdHJpY3QgX190cCwKICAgICBfX2xvY2FsZV90IF9f bG9jKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwojIDIzNiAiL3Vz
ci9pbmNsdWRlL3RpbWUuaCIgMyA0CgoKCmV4dGVybiBzdHJ1Y3QgdG0gKmdtdGltZSAoY29uc3Qg dGltZV90ICpfX3RpbWVyKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykp OwoKCgpleHRlcm4gc3RydWN0IHRtICpsb2NhbHRpbWUgKGNvbnN0IHRpbWVfdCAqX190aW1lcikg
X19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCgpleHRlcm4gc3Ry dWN0IHRtICpnbXRpbWVfciAoY29uc3QgdGltZV90ICpfX3Jlc3RyaWN0IF9fdGltZXIsCiAgICAg ICBzdHJ1Y3QgdG0gKl9fcmVzdHJpY3QgX190cCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19f
ICwgX19sZWFmX18pKTsKCgoKZXh0ZXJuIHN0cnVjdCB0bSAqbG9jYWx0aW1lX3IgKGNvbnN0IHRp bWVfdCAqX19yZXN0cmljdCBfX3RpbWVyLAogICAgICAgICAgc3RydWN0IHRtICpfX3Jlc3RyaWN0 IF9fdHApIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgoKZXh0
ZXJuIGNoYXIgKmFzY3RpbWUgKGNvbnN0IHN0cnVjdCB0bSAqX190cCkgX19hdHRyaWJ1dGVfXyAo KF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRlcm4gY2hhciAqY3RpbWUgKGNvbnN0IHRp bWVfdCAqX190aW1lcikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsK
CgoKCgoKCmV4dGVybiBjaGFyICphc2N0aW1lX3IgKGNvbnN0IHN0cnVjdCB0bSAqX19yZXN0cmlj dCBfX3RwLAogICBjaGFyICpfX3Jlc3RyaWN0IF9fYnVmKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro cm93X18gLCBfX2xlYWZfXykpOwoKCmV4dGVybiBjaGFyICpjdGltZV9yIChjb25zdCB0aW1lX3Qg
Kl9fcmVzdHJpY3QgX190aW1lciwKICAgICAgICBjaGFyICpfX3Jlc3RyaWN0IF9fYnVmKSBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKZXh0ZXJuIGNoYXIgKl9f dHpuYW1lWzJdOwpleHRlcm4gaW50IF9fZGF5bGlnaHQ7CmV4dGVybiBsb25nIGludCBfX3RpbWV6
b25lOwoKCgoKZXh0ZXJuIGNoYXIgKnR6bmFtZVsyXTsKCgoKZXh0ZXJuIHZvaWQgdHpzZXQgKHZv aWQpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCmV4dGVybiBp bnQgZGF5bGlnaHQ7CmV4dGVybiBsb25nIGludCB0aW1lem9uZTsKCgoKCgpleHRlcm4gaW50IHN0
aW1lIChjb25zdCB0aW1lX3QgKl9fd2hlbikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg X19sZWFmX18pKTsKIyAzMTkgIi91c3IvaW5jbHVkZS90aW1lLmgiIDMgNApleHRlcm4gdGltZV90 IHRpbWVnbSAoc3RydWN0IHRtICpfX3RwKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBf
X2xlYWZfXykpOwoKCmV4dGVybiB0aW1lX3QgdGltZWxvY2FsIChzdHJ1Y3QgdG0gKl9fdHApIF9f YXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGludCBkeXNp emUgKGludCBfX3llYXIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkg
X19hdHRyaWJ1dGVfXyAoKF9fY29uc3RfXykpOwojIDMzNCAiL3Vzci9pbmNsdWRlL3RpbWUuaCIg MyA0CmV4dGVybiBpbnQgbmFub3NsZWVwIChjb25zdCBzdHJ1Y3QgdGltZXNwZWMgKl9fcmVxdWVz dGVkX3RpbWUsCiAgICAgICAgc3RydWN0IHRpbWVzcGVjICpfX3JlbWFpbmluZyk7CgoKCmV4dGVy
biBpbnQgY2xvY2tfZ2V0cmVzIChjbG9ja2lkX3QgX19jbG9ja19pZCwgc3RydWN0IHRpbWVzcGVj ICpfX3JlcykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRl cm4gaW50IGNsb2NrX2dldHRpbWUgKGNsb2NraWRfdCBfX2Nsb2NrX2lkLCBzdHJ1Y3QgdGltZXNw
ZWMgKl9fdHApIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0 ZXJuIGludCBjbG9ja19zZXR0aW1lIChjbG9ja2lkX3QgX19jbG9ja19pZCwgY29uc3Qgc3RydWN0 IHRpbWVzcGVjICpfX3RwKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh
Zl9fKSk7CgoKCgoKCmV4dGVybiBpbnQgY2xvY2tfbmFub3NsZWVwIChjbG9ja2lkX3QgX19jbG9j a19pZCwgaW50IF9fZmxhZ3MsCiAgICAgICBjb25zdCBzdHJ1Y3QgdGltZXNwZWMgKl9fcmVxLAog ICAgICAgc3RydWN0IHRpbWVzcGVjICpfX3JlbSk7CgoKZXh0ZXJuIGludCBjbG9ja19nZXRjcHVj
bG9ja2lkIChwaWRfdCBfX3BpZCwgY2xvY2tpZF90ICpfX2Nsb2NrX2lkKSBfX2F0dHJpYnV0ZV9f ICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKZXh0ZXJuIGludCB0aW1lcl9jcmVhdGUg KGNsb2NraWRfdCBfX2Nsb2NrX2lkLAogICAgc3RydWN0IHNpZ2V2ZW50ICpfX3Jlc3RyaWN0IF9f
ZXZwLAogICAgdGltZXJfdCAqX19yZXN0cmljdCBfX3RpbWVyaWQpIF9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGludCB0aW1lcl9kZWxldGUgKHRpbWVy X3QgX190aW1lcmlkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoK
CmV4dGVybiBpbnQgdGltZXJfc2V0dGltZSAodGltZXJfdCBfX3RpbWVyaWQsIGludCBfX2ZsYWdz LAogICAgIGNvbnN0IHN0cnVjdCBpdGltZXJzcGVjICpfX3Jlc3RyaWN0IF9fdmFsdWUsCiAgICAg c3RydWN0IGl0aW1lcnNwZWMgKl9fcmVzdHJpY3QgX19vdmFsdWUpIF9fYXR0cmlidXRlX18gKChf
X25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGludCB0aW1lcl9nZXR0aW1lICh0aW1l cl90IF9fdGltZXJpZCwgc3RydWN0IGl0aW1lcnNwZWMgKl9fdmFsdWUpCiAgICAgX19hdHRyaWJ1 dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRlcm4gaW50IHRpbWVyX2dldG92
ZXJydW4gKHRpbWVyX3QgX190aW1lcmlkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBf X2xlYWZfXykpOwoKCgoKCmV4dGVybiBpbnQgdGltZXNwZWNfZ2V0IChzdHJ1Y3QgdGltZXNwZWMg Kl9fdHMsIGludCBfX2Jhc2UpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19s
ZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CiMgNDMwICIvdXNyL2lu Y2x1ZGUvdGltZS5oIiAzIDQKCiMgMjUgIi91c3IvaW5jbHVkZS9wdGhyZWFkLmgiIDIgMyA0Cgoj IDEgIi91c3IvaW5jbHVkZS9iaXRzL3B0aHJlYWR0eXBlcy5oIiAxIDMgNAojIDIxICIvdXNyL2lu
Y2x1ZGUvYml0cy9wdGhyZWFkdHlwZXMuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvd29y ZHNpemUuaCIgMSAzIDQKIyAyMiAiL3Vzci9pbmNsdWRlL2JpdHMvcHRocmVhZHR5cGVzLmgiIDIg MyA0CiMgNDggIi91c3IvaW5jbHVkZS9iaXRzL3B0aHJlYWR0eXBlcy5oIiAzIDQKdHlwZWRlZiB1
bnNpZ25lZCBsb25nIGludCBwdGhyZWFkX3Q7CgoKdW5pb24gcHRocmVhZF9hdHRyX3QKewogIGNo YXIgX19zaXplWzU2XTsKICBsb25nIGludCBfX2FsaWduOwp9OwoKdHlwZWRlZiB1bmlvbiBwdGhy ZWFkX2F0dHJfdCBwdGhyZWFkX2F0dHJfdDsKCgoKCgp0eXBlZGVmIHN0cnVjdCBfX3B0aHJlYWRf
aW50ZXJuYWxfbGlzdAp7CiAgc3RydWN0IF9fcHRocmVhZF9pbnRlcm5hbF9saXN0ICpfX3ByZXY7 CiAgc3RydWN0IF9fcHRocmVhZF9pbnRlcm5hbF9saXN0ICpfX25leHQ7Cn0gX19wdGhyZWFkX2xp c3RfdDsKIyA3OCAiL3Vzci9pbmNsdWRlL2JpdHMvcHRocmVhZHR5cGVzLmgiIDMgNAp0eXBlZGVm
IHVuaW9uCnsKICBzdHJ1Y3QgX19wdGhyZWFkX211dGV4X3MKICB7CiAgICBpbnQgX19sb2NrOwog ICAgdW5zaWduZWQgaW50IF9fY291bnQ7CiAgICBpbnQgX19vd25lcjsKCiAgICB1bnNpZ25lZCBp bnQgX19udXNlcnM7CgoKCiAgICBpbnQgX19raW5kOwoKCgoKCgoKICAgIGludCBfX3NwaW5zOwoK
CgogICAgX19wdGhyZWFkX2xpc3RfdCBfX2xpc3Q7CiMgMTI2ICIvdXNyL2luY2x1ZGUvYml0cy9w dGhyZWFkdHlwZXMuaCIgMyA0CiAgfSBfX2RhdGE7CiAgY2hhciBfX3NpemVbNDBdOwogIGxvbmcg aW50IF9fYWxpZ247Cn0gcHRocmVhZF9tdXRleF90OwoKCnR5cGVkZWYgdW5pb24KewogIGNoYXIg
X19zaXplWzRdOwogIGludCBfX2FsaWduOwp9IHB0aHJlYWRfbXV0ZXhhdHRyX3Q7CgoKCgp0eXBl ZGVmIHVuaW9uCnsKICBzdHJ1Y3QKICB7CiAgICBpbnQgX19sb2NrOwogICAgdW5zaWduZWQgaW50 IF9fZnV0ZXg7CiAgICBfX2V4dGVuc2lvbl9fIHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgX190b3Rh
bF9zZXE7CiAgICBfX2V4dGVuc2lvbl9fIHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgX193YWtldXBf c2VxOwogICAgX19leHRlbnNpb25fXyB1bnNpZ25lZCBsb25nIGxvbmcgaW50IF9fd29rZW5fc2Vx OwogICAgdm9pZCAqX19tdXRleDsKICAgIHVuc2lnbmVkIGludCBfX253YWl0ZXJzOwogICAgdW5z
aWduZWQgaW50IF9fYnJvYWRjYXN0X3NlcTsKICB9IF9fZGF0YTsKICBjaGFyIF9fc2l6ZVs0OF07 CiAgX19leHRlbnNpb25fXyBsb25nIGxvbmcgaW50IF9fYWxpZ247Cn0gcHRocmVhZF9jb25kX3Q7 Cgp0eXBlZGVmIHVuaW9uCnsKICBjaGFyIF9fc2l6ZVs0XTsKICBpbnQgX19hbGlnbjsKfSBwdGhy
ZWFkX2NvbmRhdHRyX3Q7CgoKCnR5cGVkZWYgdW5zaWduZWQgaW50IHB0aHJlYWRfa2V5X3Q7CgoK CnR5cGVkZWYgaW50IHB0aHJlYWRfb25jZV90OwoKCgoKCnR5cGVkZWYgdW5pb24KewoKICBzdHJ1 Y3QKICB7CiAgICBpbnQgX19sb2NrOwogICAgdW5zaWduZWQgaW50IF9fbnJfcmVhZGVyczsKICAg
IHVuc2lnbmVkIGludCBfX3JlYWRlcnNfd2FrZXVwOwogICAgdW5zaWduZWQgaW50IF9fd3JpdGVy X3dha2V1cDsKICAgIHVuc2lnbmVkIGludCBfX25yX3JlYWRlcnNfcXVldWVkOwogICAgdW5zaWdu ZWQgaW50IF9fbnJfd3JpdGVyc19xdWV1ZWQ7CiAgICBpbnQgX193cml0ZXI7CiAgICBpbnQgX19z
aGFyZWQ7CiAgICB1bnNpZ25lZCBsb25nIGludCBfX3BhZDE7CiAgICB1bnNpZ25lZCBsb25nIGlu dCBfX3BhZDI7CgoKICAgIHVuc2lnbmVkIGludCBfX2ZsYWdzOwogIH0gX19kYXRhOwojIDIxMyAi L3Vzci9pbmNsdWRlL2JpdHMvcHRocmVhZHR5cGVzLmgiIDMgNAogIGNoYXIgX19zaXplWzU2XTsK
ICBsb25nIGludCBfX2FsaWduOwp9IHB0aHJlYWRfcndsb2NrX3Q7CgoKCnR5cGVkZWYgdW5pb24K ewogIGNoYXIgX19zaXplWzhdOwogIGxvbmcgaW50IF9fYWxpZ247Cn0gcHRocmVhZF9yd2xvY2th dHRyX3Q7CgoKCgoKdHlwZWRlZiB2b2xhdGlsZSBpbnQgcHRocmVhZF9zcGlubG9ja190OwoKCgoK
dHlwZWRlZiB1bmlvbgp7CiAgY2hhciBfX3NpemVbMzJdOwogIGxvbmcgaW50IF9fYWxpZ247Cn0g cHRocmVhZF9iYXJyaWVyX3Q7Cgp0eXBlZGVmIHVuaW9uCnsKICBjaGFyIF9fc2l6ZVs0XTsKICBp bnQgX19hbGlnbjsKfSBwdGhyZWFkX2JhcnJpZXJhdHRyX3Q7CiMgMjcgIi91c3IvaW5jbHVkZS9w
dGhyZWFkLmgiIDIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvc2V0am1wLmgiIDEgMyA0CiMg MjcgIi91c3IvaW5jbHVkZS9iaXRzL3NldGptcC5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0 cy93b3Jkc2l6ZS5oIiAxIDMgNAojIDI4ICIvdXNyL2luY2x1ZGUvYml0cy9zZXRqbXAuaCIgMiAz
IDQKCgoKdHlwZWRlZiBzdHJ1Y3QgX19zMzkwX2ptcF9idWYKewoKICBsb25nIGludCBfX2dyZWdz WzEwXTsKCgoKICBsb25nIF9fZnByZWdzWzhdOwoKCgoKfSBfX2ptcF9idWZbMV07CiMgMjggIi91 c3IvaW5jbHVkZS9wdGhyZWFkLmgiIDIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvd29yZHNp
emUuaCIgMSAzIDQKIyAyOSAiL3Vzci9pbmNsdWRlL3B0aHJlYWQuaCIgMiAzIDQKCgoKZW51bQp7 CiAgUFRIUkVBRF9DUkVBVEVfSk9JTkFCTEUsCgogIFBUSFJFQURfQ1JFQVRFX0RFVEFDSEVECgp9 OwoKCgplbnVtCnsKICBQVEhSRUFEX01VVEVYX1RJTUVEX05QLAogIFBUSFJFQURfTVVURVhfUkVD
VVJTSVZFX05QLAogIFBUSFJFQURfTVVURVhfRVJST1JDSEVDS19OUCwKICBQVEhSRUFEX01VVEVY X0FEQVBUSVZFX05QCgogICwKICBQVEhSRUFEX01VVEVYX05PUk1BTCA9IFBUSFJFQURfTVVURVhf VElNRURfTlAsCiAgUFRIUkVBRF9NVVRFWF9SRUNVUlNJVkUgPSBQVEhSRUFEX01VVEVYX1JFQ1VS
U0lWRV9OUCwKICBQVEhSRUFEX01VVEVYX0VSUk9SQ0hFQ0sgPSBQVEhSRUFEX01VVEVYX0VSUk9S Q0hFQ0tfTlAsCiAgUFRIUkVBRF9NVVRFWF9ERUZBVUxUID0gUFRIUkVBRF9NVVRFWF9OT1JNQUwK CgoKCgp9OwoKCgoKZW51bQp7CiAgUFRIUkVBRF9NVVRFWF9TVEFMTEVELAogIFBUSFJFQURfTVVU
RVhfU1RBTExFRF9OUCA9IFBUSFJFQURfTVVURVhfU1RBTExFRCwKICBQVEhSRUFEX01VVEVYX1JP QlVTVCwKICBQVEhSRUFEX01VVEVYX1JPQlVTVF9OUCA9IFBUSFJFQURfTVVURVhfUk9CVVNUCn07 CgoKCgoKZW51bQp7CiAgUFRIUkVBRF9QUklPX05PTkUsCiAgUFRIUkVBRF9QUklPX0lOSEVSSVQs
CiAgUFRIUkVBRF9QUklPX1BST1RFQ1QKfTsKIyAxMTQgIi91c3IvaW5jbHVkZS9wdGhyZWFkLmgi IDMgNAplbnVtCnsKICBQVEhSRUFEX1JXTE9DS19QUkVGRVJfUkVBREVSX05QLAogIFBUSFJFQURf UldMT0NLX1BSRUZFUl9XUklURVJfTlAsCiAgUFRIUkVBRF9SV0xPQ0tfUFJFRkVSX1dSSVRFUl9O
T05SRUNVUlNJVkVfTlAsCiAgUFRIUkVBRF9SV0xPQ0tfREVGQVVMVF9OUCA9IFBUSFJFQURfUldM T0NLX1BSRUZFUl9SRUFERVJfTlAKfTsKIyAxNTUgIi91c3IvaW5jbHVkZS9wdGhyZWFkLmgiIDMg NAplbnVtCnsKICBQVEhSRUFEX0lOSEVSSVRfU0NIRUQsCgogIFBUSFJFQURfRVhQTElDSVRfU0NI
RUQKCn07CgoKCmVudW0KewogIFBUSFJFQURfU0NPUEVfU1lTVEVNLAoKICBQVEhSRUFEX1NDT1BF X1BST0NFU1MKCn07CgoKCmVudW0KewogIFBUSFJFQURfUFJPQ0VTU19QUklWQVRFLAoKICBQVEhS RUFEX1BST0NFU1NfU0hBUkVECgp9OwojIDE5MCAiL3Vzci9pbmNsdWRlL3B0aHJlYWQuaCIgMyA0
CnN0cnVjdCBfcHRocmVhZF9jbGVhbnVwX2J1ZmZlcgp7CiAgdm9pZCAoKl9fcm91dGluZSkgKHZv aWQgKik7CiAgdm9pZCAqX19hcmc7CiAgaW50IF9fY2FuY2VsdHlwZTsKICBzdHJ1Y3QgX3B0aHJl YWRfY2xlYW51cF9idWZmZXIgKl9fcHJldjsKfTsKCgplbnVtCnsKICBQVEhSRUFEX0NBTkNFTF9F
TkFCTEUsCgogIFBUSFJFQURfQ0FOQ0VMX0RJU0FCTEUKCn07CmVudW0KewogIFBUSFJFQURfQ0FO Q0VMX0RFRkVSUkVELAoKICBQVEhSRUFEX0NBTkNFTF9BU1lOQ0hST05PVVMKCn07CiMgMjI4ICIv dXNyL2luY2x1ZGUvcHRocmVhZC5oIiAzIDQKCgoKCgpleHRlcm4gaW50IHB0aHJlYWRfY3JlYXRl
IChwdGhyZWFkX3QgKl9fcmVzdHJpY3QgX19uZXd0aHJlYWQsCiAgICAgIGNvbnN0IHB0aHJlYWRf YXR0cl90ICpfX3Jlc3RyaWN0IF9fYXR0ciwKICAgICAgdm9pZCAqKCpfX3N0YXJ0X3JvdXRpbmUp ICh2b2lkICopLAogICAgICB2b2lkICpfX3Jlc3RyaWN0IF9fYXJnKSBfX2F0dHJpYnV0ZV9fICgo
X19ub3Rocm93X18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDMpKSk7CgoKCgoK ZXh0ZXJuIHZvaWQgcHRocmVhZF9leGl0ICh2b2lkICpfX3JldHZhbCkgX19hdHRyaWJ1dGVfXyAo KF9fbm9yZXR1cm5fXykpOwoKCgoKCgoKZXh0ZXJuIGludCBwdGhyZWFkX2pvaW4gKHB0aHJlYWRf
dCBfX3RoLCB2b2lkICoqX190aHJlYWRfcmV0dXJuKTsKIyAyNzEgIi91c3IvaW5jbHVkZS9wdGhy ZWFkLmgiIDMgNApleHRlcm4gaW50IHB0aHJlYWRfZGV0YWNoIChwdGhyZWFkX3QgX190aCkgX19h dHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKZXh0ZXJuIHB0aHJlYWRf
dCBwdGhyZWFkX3NlbGYgKHZvaWQpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh Zl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fY29uc3RfXykpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9l cXVhbCAocHRocmVhZF90IF9fdGhyZWFkMSwgcHRocmVhZF90IF9fdGhyZWFkMikKICBfX2F0dHJp
YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0 X18pKTsKCgoKCgoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX2luaXQgKHB0aHJlYWRfYXR0cl90 ICpfX2F0dHIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRy
aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX2Rl c3Ryb3kgKHB0aHJlYWRfYXR0cl90ICpfX2F0dHIpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90 aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoK
ZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfZ2V0ZGV0YWNoc3RhdGUgKGNvbnN0IHB0aHJlYWRfYXR0 cl90ICpfX2F0dHIsCiAgICAgaW50ICpfX2RldGFjaHN0YXRlKQogICAgIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx
LCAyKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX3NldGRldGFjaHN0YXRlIChwdGhyZWFk X2F0dHJfdCAqX19hdHRyLAogICAgIGludCBfX2RldGFjaHN0YXRlKQogICAgIF9fYXR0cmlidXRl X18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgxKSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRfYXR0cl9nZXRndWFyZHNpemUgKGNvbnN0IHB0 aHJlYWRfYXR0cl90ICpfX2F0dHIsCiAgICAgICAgICBzaXplX3QgKl9fZ3VhcmRzaXplKQogICAg IF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAo
KF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX3NldGd1YXJk c2l6ZSAocHRocmVhZF9hdHRyX3QgKl9fYXR0ciwKICAgICAgICAgIHNpemVfdCBfX2d1YXJkc2l6 ZSkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmli
dXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoKZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfZ2V0 c2NoZWRwYXJhbSAoY29uc3QgcHRocmVhZF9hdHRyX3QgKl9fcmVzdHJpY3QgX19hdHRyLAogICAg ICAgICAgIHN0cnVjdCBzY2hlZF9wYXJhbSAqX19yZXN0cmljdCBfX3BhcmFtKQogICAgIF9fYXR0
cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u bnVsbF9fICgxLCAyKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX3NldHNjaGVkcGFyYW0g KHB0aHJlYWRfYXR0cl90ICpfX3Jlc3RyaWN0IF9fYXR0ciwKICAgICAgICAgICBjb25zdCBzdHJ1
Y3Qgc2NoZWRfcGFyYW0gKl9fcmVzdHJpY3QKICAgICAgICAgICBfX3BhcmFtKSBfX2F0dHJpYnV0 ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxf XyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfYXR0cl9nZXRzY2hlZHBvbGljeSAoY29u
c3QgcHRocmVhZF9hdHRyX3QgKl9fcmVzdHJpY3QKICAgICBfX2F0dHIsIGludCAqX19yZXN0cmlj dCBfX3BvbGljeSkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykp IF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHB0aHJl
YWRfYXR0cl9zZXRzY2hlZHBvbGljeSAocHRocmVhZF9hdHRyX3QgKl9fYXR0ciwgaW50IF9fcG9s aWN5KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRy aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX2dl
dGluaGVyaXRzY2hlZCAoY29uc3QgcHRocmVhZF9hdHRyX3QgKl9fcmVzdHJpY3QKICAgICAgX19h dHRyLCBpbnQgKl9fcmVzdHJpY3QgX19pbmhlcml0KQogICAgIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkp
OwoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX3NldGluaGVyaXRzY2hlZCAocHRocmVhZF9hdHRy X3QgKl9fYXR0ciwKICAgICAgaW50IF9faW5oZXJpdCkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19u b3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsK
CgoKZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfZ2V0c2NvcGUgKGNvbnN0IHB0aHJlYWRfYXR0cl90 ICpfX3Jlc3RyaWN0IF9fYXR0ciwKICAgICAgaW50ICpfX3Jlc3RyaWN0IF9fc2NvcGUpCiAgICAg X19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgo
X19ub25udWxsX18gKDEsIDIpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfc2V0c2NvcGUg KHB0aHJlYWRfYXR0cl90ICpfX2F0dHIsIGludCBfX3Njb3BlKQogICAgIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx
KSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX2dldHN0YWNrYWRkciAoY29uc3QgcHRocmVh ZF9hdHRyX3QgKl9fcmVzdHJpY3QKICAgICAgICAgIF9fYXR0ciwgdm9pZCAqKl9fcmVzdHJpY3Qg X19zdGFja2FkZHIpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18p
KSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSkgX19hdHRyaWJ1dGVfXyAoKF9f ZGVwcmVjYXRlZF9fKSk7CgoKCgoKZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfc2V0c3RhY2thZGRy IChwdGhyZWFkX2F0dHJfdCAqX19hdHRyLAogICAgICAgICAgdm9pZCAqX19zdGFja2FkZHIpCiAg
ICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9f ICgoX19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVfXyAoKF9fZGVwcmVjYXRlZF9fKSk7CgoK ZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfZ2V0c3RhY2tzaXplIChjb25zdCBwdGhyZWFkX2F0dHJf
dCAqX19yZXN0cmljdAogICAgICAgICAgX19hdHRyLCBzaXplX3QgKl9fcmVzdHJpY3QgX19zdGFj a3NpemUpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0 dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKCgpleHRlcm4gaW50IHB0aHJlYWRf
YXR0cl9zZXRzdGFja3NpemUgKHB0aHJlYWRfYXR0cl90ICpfX2F0dHIsCiAgICAgICAgICBzaXpl X3QgX19zdGFja3NpemUpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFm X18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCmV4dGVybiBpbnQgcHRo
cmVhZF9hdHRyX2dldHN0YWNrIChjb25zdCBwdGhyZWFkX2F0dHJfdCAqX19yZXN0cmljdCBfX2F0 dHIsCiAgICAgIHZvaWQgKipfX3Jlc3RyaWN0IF9fc3RhY2thZGRyLAogICAgICBzaXplX3QgKl9f cmVzdHJpY3QgX19zdGFja3NpemUpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg
X19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIsIDMpKSk7CgoKCgpl eHRlcm4gaW50IHB0aHJlYWRfYXR0cl9zZXRzdGFjayAocHRocmVhZF9hdHRyX3QgKl9fYXR0ciwg dm9pZCAqX19zdGFja2FkZHIsCiAgICAgIHNpemVfdCBfX3N0YWNrc2l6ZSkgX19hdHRyaWJ1dGVf
XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g KDEpKSk7CiMgNDI5ICIvdXNyL2luY2x1ZGUvcHRocmVhZC5oIiAzIDQKZXh0ZXJuIGludCBwdGhy ZWFkX3NldHNjaGVkcGFyYW0gKHB0aHJlYWRfdCBfX3RhcmdldF90aHJlYWQsIGludCBfX3BvbGlj
eSwKICAgICAgY29uc3Qgc3RydWN0IHNjaGVkX3BhcmFtICpfX3BhcmFtKQogICAgIF9fYXR0cmli dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs bF9fICgzKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9nZXRzY2hlZHBhcmFtIChwdGhyZWFkX3Qg
X190YXJnZXRfdGhyZWFkLAogICAgICBpbnQgKl9fcmVzdHJpY3QgX19wb2xpY3ksCiAgICAgIHN0 cnVjdCBzY2hlZF9wYXJhbSAqX19yZXN0cmljdCBfX3BhcmFtKQogICAgIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgy
LCAzKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9zZXRzY2hlZHByaW8gKHB0aHJlYWRfdCBfX3Rh cmdldF90aHJlYWQsIGludCBfX3ByaW8pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19f ICwgX19sZWFmX18pKTsKIyA0OTQgIi91c3IvaW5jbHVkZS9wdGhyZWFkLmgiIDMgNApleHRlcm4g
aW50IHB0aHJlYWRfb25jZSAocHRocmVhZF9vbmNlX3QgKl9fb25jZV9jb250cm9sLAogICAgdm9p ZCAoKl9faW5pdF9yb3V0aW5lKSAodm9pZCkpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo MSwgMikpKTsKIyA1MDYgIi91c3IvaW5jbHVkZS9wdGhyZWFkLmgiIDMgNApleHRlcm4gaW50IHB0
aHJlYWRfc2V0Y2FuY2Vsc3RhdGUgKGludCBfX3N0YXRlLCBpbnQgKl9fb2xkc3RhdGUpOwoKCgpl eHRlcm4gaW50IHB0aHJlYWRfc2V0Y2FuY2VsdHlwZSAoaW50IF9fdHlwZSwgaW50ICpfX29sZHR5 cGUpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9jYW5jZWwgKHB0aHJlYWRfdCBfX3RoKTsKCgoKCmV4
dGVybiB2b2lkIHB0aHJlYWRfdGVzdGNhbmNlbCAodm9pZCk7CgoKCgp0eXBlZGVmIHN0cnVjdAp7 CiAgc3RydWN0CiAgewogICAgX19qbXBfYnVmIF9fY2FuY2VsX2ptcF9idWY7CiAgICBpbnQgX19t YXNrX3dhc19zYXZlZDsKICB9IF9fY2FuY2VsX2ptcF9idWZbMV07CiAgdm9pZCAqX19wYWRbNF07
Cn0gX19wdGhyZWFkX3Vud2luZF9idWZfdCBfX2F0dHJpYnV0ZV9fICgoX19hbGlnbmVkX18pKTsK IyA1NDAgIi91c3IvaW5jbHVkZS9wdGhyZWFkLmgiIDMgNApzdHJ1Y3QgX19wdGhyZWFkX2NsZWFu dXBfZnJhbWUKewogIHZvaWQgKCpfX2NhbmNlbF9yb3V0aW5lKSAodm9pZCAqKTsKICB2b2lkICpf
X2NhbmNlbF9hcmc7CiAgaW50IF9fZG9faXQ7CiAgaW50IF9fY2FuY2VsX3R5cGU7Cn07CiMgNjA3 ICIvdXNyL2luY2x1ZGUvcHRocmVhZC5oIiAzIDQKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRl X18gKChfX2dudV9pbmxpbmVfXykpIHZvaWQKX19wdGhyZWFkX2NsZWFudXBfcm91dGluZSAoc3Ry
dWN0IF9fcHRocmVhZF9jbGVhbnVwX2ZyYW1lICpfX2ZyYW1lKQp7CiAgaWYgKF9fZnJhbWUtPl9f ZG9faXQpCiAgICBfX2ZyYW1lLT5fX2NhbmNlbF9yb3V0aW5lIChfX2ZyYW1lLT5fX2NhbmNlbF9h cmcpOwp9CiMgNzQyICIvdXNyL2luY2x1ZGUvcHRocmVhZC5oIiAzIDQKc3RydWN0IF9fam1wX2J1
Zl90YWc7CmV4dGVybiBpbnQgX19zaWdzZXRqbXAgKHN0cnVjdCBfX2ptcF9idWZfdGFnICpfX2Vu diwgaW50IF9fc2F2ZW1hc2spIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXykpOwoKCgoKCmV4 dGVybiBpbnQgcHRocmVhZF9tdXRleF9pbml0IChwdGhyZWFkX211dGV4X3QgKl9fbXV0ZXgsCiAg
ICAgICAgICBjb25zdCBwdGhyZWFkX211dGV4YXR0cl90ICpfX211dGV4YXR0cikKICAgICBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25v bm51bGxfXyAoMSkpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfbXV0ZXhfZGVzdHJveSAocHRocmVh
ZF9tdXRleF90ICpfX211dGV4KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f bGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQg cHRocmVhZF9tdXRleF90cnlsb2NrIChwdGhyZWFkX211dGV4X3QgKl9fbXV0ZXgpCiAgICAgX19h
dHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx KSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9tdXRleF9sb2NrIChwdGhyZWFkX211dGV4X3QgKl9f bXV0ZXgpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fKSkgX19hdHRyaWJ1dGVfXyAo
KF9fbm9ubnVsbF9fICgxKSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRfbXV0ZXhfdGltZWRsb2Nr IChwdGhyZWFkX211dGV4X3QgKl9fcmVzdHJpY3QgX19tdXRleCwKICAgICAgICBjb25zdCBzdHJ1 Y3QgdGltZXNwZWMgKl9fcmVzdHJpY3QKICAgICAgICBfX2Fic3RpbWUpIF9fYXR0cmlidXRlX18g
KChfX25vdGhyb3dfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgoK ZXh0ZXJuIGludCBwdGhyZWFkX211dGV4X3VubG9jayAocHRocmVhZF9tdXRleF90ICpfX211dGV4 KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXykpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMSkpKTsKCgoKZXh0ZXJuIGludCBwdGhyZWFkX211dGV4X2dldHByaW9jZWlsaW5n IChjb25zdCBwdGhyZWFkX211dGV4X3QgKgogICAgICBfX3Jlc3RyaWN0IF9fbXV0ZXgsCiAgICAg IGludCAqX19yZXN0cmljdCBfX3ByaW9jZWlsaW5nKQogICAgIF9fYXR0cmlidXRlX18gKChfX25v
dGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkp OwoKCgpleHRlcm4gaW50IHB0aHJlYWRfbXV0ZXhfc2V0cHJpb2NlaWxpbmcgKHB0aHJlYWRfbXV0 ZXhfdCAqX19yZXN0cmljdCBfX211dGV4LAogICAgICBpbnQgX19wcmlvY2VpbGluZywKICAgICAg
aW50ICpfX3Jlc3RyaWN0IF9fb2xkX2NlaWxpbmcpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90 aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDMpKSk7 CgoKCgpleHRlcm4gaW50IHB0aHJlYWRfbXV0ZXhfY29uc2lzdGVudCAocHRocmVhZF9tdXRleF90
ICpfX211dGV4KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkg X19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwojIDgwNiAiL3Vzci9pbmNsdWRlL3B0 aHJlYWQuaCIgMyA0CmV4dGVybiBpbnQgcHRocmVhZF9tdXRleGF0dHJfaW5pdCAocHRocmVhZF9t
dXRleGF0dHJfdCAqX19hdHRyKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f bGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQg cHRocmVhZF9tdXRleGF0dHJfZGVzdHJveSAocHRocmVhZF9tdXRleGF0dHJfdCAqX19hdHRyKQog
ICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVf XyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9tdXRleGF0dHJfZ2V0 cHNoYXJlZCAoY29uc3QgcHRocmVhZF9tdXRleGF0dHJfdCAqCiAgICAgIF9fcmVzdHJpY3QgX19h
dHRyLAogICAgICBpbnQgKl9fcmVzdHJpY3QgX19wc2hhcmVkKQogICAgIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx LCAyKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9tdXRleGF0dHJfc2V0cHNoYXJlZCAocHRocmVh
ZF9tdXRleGF0dHJfdCAqX19hdHRyLAogICAgICBpbnQgX19wc2hhcmVkKQogICAgIF9fYXR0cmli dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs bF9fICgxKSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRfbXV0ZXhhdHRyX2dldHR5cGUgKGNvbnN0
IHB0aHJlYWRfbXV0ZXhhdHRyX3QgKl9fcmVzdHJpY3QKICAgICAgICAgIF9fYXR0ciwgaW50ICpf X3Jlc3RyaWN0IF9fa2luZCkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl YWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgoKCmV4dGVybiBp
bnQgcHRocmVhZF9tdXRleGF0dHJfc2V0dHlwZSAocHRocmVhZF9tdXRleGF0dHJfdCAqX19hdHRy LCBpbnQgX19raW5kKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9f KSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgpleHRlcm4gaW50IHB0aHJl
YWRfbXV0ZXhhdHRyX2dldHByb3RvY29sIChjb25zdCBwdGhyZWFkX211dGV4YXR0cl90ICoKICAg ICAgIF9fcmVzdHJpY3QgX19hdHRyLAogICAgICAgaW50ICpfX3Jlc3RyaWN0IF9fcHJvdG9jb2wp CiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0
ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKCmV4dGVybiBpbnQgcHRocmVhZF9tdXRleGF0 dHJfc2V0cHJvdG9jb2wgKHB0aHJlYWRfbXV0ZXhhdHRyX3QgKl9fYXR0ciwKICAgICAgIGludCBf X3Byb3RvY29sKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkg
X19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9t dXRleGF0dHJfZ2V0cHJpb2NlaWxpbmcgKGNvbnN0IHB0aHJlYWRfbXV0ZXhhdHRyX3QgKgogICAg ICAgICAgX19yZXN0cmljdCBfX2F0dHIsCiAgICAgICAgICBpbnQgKl9fcmVzdHJpY3QgX19wcmlv
Y2VpbGluZykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9f YXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRf bXV0ZXhhdHRyX3NldHByaW9jZWlsaW5nIChwdGhyZWFkX211dGV4YXR0cl90ICpfX2F0dHIsCiAg
ICAgICAgICBpbnQgX19wcmlvY2VpbGluZykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93 X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoKZXh0 ZXJuIGludCBwdGhyZWFkX211dGV4YXR0cl9nZXRyb2J1c3QgKGNvbnN0IHB0aHJlYWRfbXV0ZXhh
dHRyX3QgKl9fYXR0ciwKICAgICBpbnQgKl9fcm9idXN0bmVzcykKICAgICBfX2F0dHJpYnV0ZV9f ICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo MSwgMikpKTsKCgoKCgoKCmV4dGVybiBpbnQgcHRocmVhZF9tdXRleGF0dHJfc2V0cm9idXN0IChw
dGhyZWFkX211dGV4YXR0cl90ICpfX2F0dHIsCiAgICAgaW50IF9fcm9idXN0bmVzcykKICAgICBf X2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChf X25vbm51bGxfXyAoMSkpKTsKIyA4ODggIi91c3IvaW5jbHVkZS9wdGhyZWFkLmgiIDMgNApleHRl
cm4gaW50IHB0aHJlYWRfcndsb2NrX2luaXQgKHB0aHJlYWRfcndsb2NrX3QgKl9fcmVzdHJpY3Qg X19yd2xvY2ssCiAgICBjb25zdCBwdGhyZWFkX3J3bG9ja2F0dHJfdCAqX19yZXN0cmljdAogICAg X19hdHRyKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmli
dXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfcndsb2NrX2Rl c3Ryb3kgKHB0aHJlYWRfcndsb2NrX3QgKl9fcndsb2NrKQogICAgIF9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkp
OwoKCmV4dGVybiBpbnQgcHRocmVhZF9yd2xvY2tfcmRsb2NrIChwdGhyZWFkX3J3bG9ja190ICpf X3J3bG9jaykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18pKSBfX2F0dHJpYnV0ZV9f ICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX3J3bG9ja190cnlyZGxv
Y2sgKHB0aHJlYWRfcndsb2NrX3QgKl9fcndsb2NrKQogIF9fYXR0cmlidXRlX18gKChfX25vdGhy b3dfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoKZXh0ZXJuIGludCBw dGhyZWFkX3J3bG9ja190aW1lZHJkbG9jayAocHRocmVhZF9yd2xvY2tfdCAqX19yZXN0cmljdCBf
X3J3bG9jaywKICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdGltZXNwZWMgKl9fcmVzdHJpY3QKICAg ICAgICAgICBfX2Fic3RpbWUpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXykpIF9fYXR0cmli dXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgoKZXh0ZXJuIGludCBwdGhyZWFkX3J3bG9j
a193cmxvY2sgKHB0aHJlYWRfcndsb2NrX3QgKl9fcndsb2NrKQogICAgIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRl cm4gaW50IHB0aHJlYWRfcndsb2NrX3RyeXdybG9jayAocHRocmVhZF9yd2xvY2tfdCAqX19yd2xv
Y2spCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fKSkgX19hdHRyaWJ1dGVfXyAoKF9f bm9ubnVsbF9fICgxKSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRfcndsb2NrX3RpbWVkd3Jsb2Nr IChwdGhyZWFkX3J3bG9ja190ICpfX3Jlc3RyaWN0IF9fcndsb2NrLAogICAgICAgICAgIGNvbnN0
IHN0cnVjdCB0aW1lc3BlYyAqX19yZXN0cmljdAogICAgICAgICAgIF9fYWJzdGltZSkgX19hdHRy aWJ1dGVfXyAoKF9fbm90aHJvd19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAy KSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRfcndsb2NrX3VubG9jayAocHRocmVhZF9yd2xvY2tf
dCAqX19yd2xvY2spCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fKSkgX19hdHRyaWJ1 dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKCmV4dGVybiBpbnQgcHRocmVhZF9yd2xvY2th dHRyX2luaXQgKHB0aHJlYWRfcndsb2NrYXR0cl90ICpfX2F0dHIpCiAgICAgX19hdHRyaWJ1dGVf
XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g KDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX3J3bG9ja2F0dHJfZGVzdHJveSAocHRocmVhZF9y d2xvY2thdHRyX3QgKl9fYXR0cikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBf
X2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4gaW50 IHB0aHJlYWRfcndsb2NrYXR0cl9nZXRwc2hhcmVkIChjb25zdCBwdGhyZWFkX3J3bG9ja2F0dHJf dCAqCiAgICAgICBfX3Jlc3RyaWN0IF9fYXR0ciwKICAgICAgIGludCAqX19yZXN0cmljdCBfX3Bz
aGFyZWQpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0 dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX3J3 bG9ja2F0dHJfc2V0cHNoYXJlZCAocHRocmVhZF9yd2xvY2thdHRyX3QgKl9fYXR0ciwKICAgICAg
IGludCBfX3BzaGFyZWQpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFm X18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhy ZWFkX3J3bG9ja2F0dHJfZ2V0a2luZF9ucCAoY29uc3QgcHRocmVhZF9yd2xvY2thdHRyX3QgKgog
ICAgICAgX19yZXN0cmljdCBfX2F0dHIsCiAgICAgICBpbnQgKl9fcmVzdHJpY3QgX19wcmVmKQog ICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVf XyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9yd2xvY2thdHRy
X3NldGtpbmRfbnAgKHB0aHJlYWRfcndsb2NrYXR0cl90ICpfX2F0dHIsCiAgICAgICBpbnQgX19w cmVmKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRl X18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoKCgoKCmV4dGVybiBpbnQgcHRocmVhZF9jb25kX2lu
aXQgKHB0aHJlYWRfY29uZF90ICpfX3Jlc3RyaWN0IF9fY29uZCwKICAgICAgICAgY29uc3QgcHRo cmVhZF9jb25kYXR0cl90ICpfX3Jlc3RyaWN0IF9fY29uZF9hdHRyKQogICAgIF9fYXR0cmlidXRl X18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgxKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9jb25kX2Rlc3Ryb3kgKHB0aHJlYWRfY29uZF90 ICpfX2NvbmQpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBf X2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX2Nv
bmRfc2lnbmFsIChwdGhyZWFkX2NvbmRfdCAqX19jb25kKQogICAgIF9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4g aW50IHB0aHJlYWRfY29uZF9icm9hZGNhc3QgKHB0aHJlYWRfY29uZF90ICpfX2NvbmQpCiAgICAg
X19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f ICgxKSkpOwoKCgoKCgpleHRlcm4gaW50IHB0aHJlYWRfY29uZF93YWl0IChwdGhyZWFkX2NvbmRf dCAqX19yZXN0cmljdCBfX2NvbmQsCiAgICAgICAgIHB0aHJlYWRfbXV0ZXhfdCAqX19yZXN0cmlj
dCBfX211dGV4KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKIyAx MDAwICIvdXNyL2luY2x1ZGUvcHRocmVhZC5oIiAzIDQKZXh0ZXJuIGludCBwdGhyZWFkX2NvbmRf dGltZWR3YWl0IChwdGhyZWFkX2NvbmRfdCAqX19yZXN0cmljdCBfX2NvbmQsCiAgICAgICBwdGhy
ZWFkX211dGV4X3QgKl9fcmVzdHJpY3QgX19tdXRleCwKICAgICAgIGNvbnN0IHN0cnVjdCB0aW1l c3BlYyAqX19yZXN0cmljdCBfX2Fic3RpbWUpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs bF9fICgxLCAyLCAzKSkpOwoKCgoKZXh0ZXJuIGludCBwdGhyZWFkX2NvbmRhdHRyX2luaXQgKHB0
aHJlYWRfY29uZGF0dHJfdCAqX19hdHRyKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df XyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVy biBpbnQgcHRocmVhZF9jb25kYXR0cl9kZXN0cm95IChwdGhyZWFkX2NvbmRhdHRyX3QgKl9fYXR0
cikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmli dXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfY29uZGF0dHJf Z2V0cHNoYXJlZCAoY29uc3QgcHRocmVhZF9jb25kYXR0cl90ICoKICAgICBfX3Jlc3RyaWN0IF9f
YXR0ciwKICAgICBpbnQgKl9fcmVzdHJpY3QgX19wc2hhcmVkKQogICAgIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx LCAyKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9jb25kYXR0cl9zZXRwc2hhcmVkIChwdGhyZWFk
X2NvbmRhdHRyX3QgKl9fYXR0ciwKICAgICBpbnQgX19wc2hhcmVkKSBfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkp KTsKCgoKZXh0ZXJuIGludCBwdGhyZWFkX2NvbmRhdHRyX2dldGNsb2NrIChjb25zdCBwdGhyZWFk
X2NvbmRhdHRyX3QgKgogICAgICAgICAgX19yZXN0cmljdCBfX2F0dHIsCiAgICAgICAgICBfX2Ns b2NraWRfdCAqX19yZXN0cmljdCBfX2Nsb2NrX2lkKQogICAgIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkp
OwoKCmV4dGVybiBpbnQgcHRocmVhZF9jb25kYXR0cl9zZXRjbG9jayAocHRocmVhZF9jb25kYXR0 cl90ICpfX2F0dHIsCiAgICAgICAgICBfX2Nsb2NraWRfdCBfX2Nsb2NrX2lkKQogICAgIF9fYXR0 cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgxKSkpOwojIDEwNDQgIi91c3IvaW5jbHVkZS9wdGhyZWFkLmgiIDMgNApleHRlcm4g aW50IHB0aHJlYWRfc3Bpbl9pbml0IChwdGhyZWFkX3NwaW5sb2NrX3QgKl9fbG9jaywgaW50IF9f cHNoYXJlZCkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9f
YXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfc3Bp bl9kZXN0cm95IChwdGhyZWFkX3NwaW5sb2NrX3QgKl9fbG9jaykKICAgICBfX2F0dHJpYnV0ZV9f ICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo
MSkpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfc3Bpbl9sb2NrIChwdGhyZWFkX3NwaW5sb2NrX3Qg Kl9fbG9jaykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18pKSBfX2F0dHJpYnV0ZV9f ICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX3NwaW5fdHJ5bG9jayAo
cHRocmVhZF9zcGlubG9ja190ICpfX2xvY2spCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv d19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQgcHRo cmVhZF9zcGluX3VubG9jayAocHRocmVhZF9zcGlubG9ja190ICpfX2xvY2spCiAgICAgX19hdHRy
aWJ1dGVfXyAoKF9fbm90aHJvd19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkp OwoKCgoKCgpleHRlcm4gaW50IHB0aHJlYWRfYmFycmllcl9pbml0IChwdGhyZWFkX2JhcnJpZXJf dCAqX19yZXN0cmljdCBfX2JhcnJpZXIsCiAgICAgY29uc3QgcHRocmVhZF9iYXJyaWVyYXR0cl90
ICpfX3Jlc3RyaWN0CiAgICAgX19hdHRyLCB1bnNpZ25lZCBpbnQgX19jb3VudCkKICAgICBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25v bm51bGxfXyAoMSkpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfYmFycmllcl9kZXN0cm95IChwdGhy
ZWFkX2JhcnJpZXJfdCAqX19iYXJyaWVyKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df XyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVy biBpbnQgcHRocmVhZF9iYXJyaWVyX3dhaXQgKHB0aHJlYWRfYmFycmllcl90ICpfX2JhcnJpZXIp
CiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u bnVsbF9fICgxKSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRfYmFycmllcmF0dHJfaW5pdCAocHRo cmVhZF9iYXJyaWVyYXR0cl90ICpfX2F0dHIpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv
d19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0 ZXJuIGludCBwdGhyZWFkX2JhcnJpZXJhdHRyX2Rlc3Ryb3kgKHB0aHJlYWRfYmFycmllcmF0dHJf dCAqX19hdHRyKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkg
X19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9i YXJyaWVyYXR0cl9nZXRwc2hhcmVkIChjb25zdCBwdGhyZWFkX2JhcnJpZXJhdHRyX3QgKgogICAg ICAgIF9fcmVzdHJpY3QgX19hdHRyLAogICAgICAgIGludCAqX19yZXN0cmljdCBfX3BzaGFyZWQp
CiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0 ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX2JhcnJpZXJh dHRyX3NldHBzaGFyZWQgKHB0aHJlYWRfYmFycmllcmF0dHJfdCAqX19hdHRyLAogICAgICAgIGlu
dCBfX3BzaGFyZWQpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18p KSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CiMgMTExMSAiL3Vzci9pbmNsdWRl L3B0aHJlYWQuaCIgMyA0CmV4dGVybiBpbnQgcHRocmVhZF9rZXlfY3JlYXRlIChwdGhyZWFkX2tl
eV90ICpfX2tleSwKICAgICAgICAgIHZvaWQgKCpfX2Rlc3RyX2Z1bmN0aW9uKSAodm9pZCAqKSkK ICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRl X18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfa2V5X2RlbGV0ZSAo
cHRocmVhZF9rZXlfdCBfX2tleSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFm X18pKTsKCgpleHRlcm4gdm9pZCAqcHRocmVhZF9nZXRzcGVjaWZpYyAocHRocmVhZF9rZXlfdCBf X2tleSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRlcm4g
aW50IHB0aHJlYWRfc2V0c3BlY2lmaWMgKHB0aHJlYWRfa2V5X3QgX19rZXksCiAgICBjb25zdCB2 b2lkICpfX3BvaW50ZXIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkg OwoKCgoKZXh0ZXJuIGludCBwdGhyZWFkX2dldGNwdWNsb2NraWQgKHB0aHJlYWRfdCBfX3RocmVh
ZF9pZCwKICAgICAgX19jbG9ja2lkX3QgKl9fY2xvY2tfaWQpCiAgICAgX19hdHRyaWJ1dGVfXyAo KF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIp KSk7CiMgMTE0NSAiL3Vzci9pbmNsdWRlL3B0aHJlYWQuaCIgMyA0CmV4dGVybiBpbnQgcHRocmVh
ZF9hdGZvcmsgKHZvaWQgKCpfX3ByZXBhcmUpICh2b2lkKSwKICAgICAgdm9pZCAoKl9fcGFyZW50 KSAodm9pZCksCiAgICAgIHZvaWQgKCpfX2NoaWxkKSAodm9pZCkpIF9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVf
XyAoKF9fZ251X2lubGluZV9fKSkgaW50Cl9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f bGVhZl9fKSkgcHRocmVhZF9lcXVhbCAocHRocmVhZF90IF9fdGhyZWFkMSwgcHRocmVhZF90IF9f dGhyZWFkMikKewogIHJldHVybiBfX3RocmVhZDEgPT0gX190aHJlYWQyOwp9CgoKCiMgMzUgIi4v
aW5jbHVkZS9nY19wdGhyZWFkX3JlZGlyZWN0cy5oIiAyCgoKIyAxICIvdXNyL2luY2x1ZGUvZGxm Y24uaCIgMSAzIDQKIyAyNCAiL3Vzci9pbmNsdWRlL2RsZmNuLmgiIDMgNAojIDEgIi91c3IvbGli L2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVkZS9zdGRkZWYuaCIgMSAzIDQKIyAy
NSAiL3Vzci9pbmNsdWRlL2RsZmNuLmgiIDIgMyA0CgoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9k bGZjbi5oIiAxIDMgNAojIDI4ICIvdXNyL2luY2x1ZGUvZGxmY24uaCIgMiAzIDQKIyA1MiAiL3Vz ci9pbmNsdWRlL2RsZmNuLmgiIDMgNAoKCgoKZXh0ZXJuIHZvaWQgKmRsb3BlbiAoY29uc3QgY2hh
ciAqX19maWxlLCBpbnQgX19tb2RlKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18pKTsKCgoK ZXh0ZXJuIGludCBkbGNsb3NlICh2b2lkICpfX2hhbmRsZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90 aHJvd19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgpleHRlcm4gdm9p
ZCAqZGxzeW0gKHZvaWQgKl9fcmVzdHJpY3QgX19oYW5kbGUsCiAgICAgIGNvbnN0IGNoYXIgKl9f cmVzdHJpY3QgX19uYW1lKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykp IF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMikpKTsKIyA4MiAiL3Vzci9pbmNsdWRlL2Rs
ZmNuLmgiIDMgNApleHRlcm4gY2hhciAqZGxlcnJvciAodm9pZCkgX19hdHRyaWJ1dGVfXyAoKF9f bm90aHJvd19fICwgX19sZWFmX18pKTsKIyAxODggIi91c3IvaW5jbHVkZS9kbGZjbi5oIiAzIDQK CiMgMzggIi4vaW5jbHVkZS9nY19wdGhyZWFkX3JlZGlyZWN0cy5oIiAyCiAgICAKIyAzOCAiLi9p
bmNsdWRlL2djX3B0aHJlYWRfcmVkaXJlY3RzLmgiCiAgIGV4dGVybiB2b2lkICpHQ19kbG9wZW4o Y29uc3QgY2hhciAqICwgaW50ICk7CgoKCiMgMSAiL3Vzci9pbmNsdWRlL3NpZ25hbC5oIiAxIDMg NAojIDMwICIvdXNyL2luY2x1ZGUvc2lnbmFsLmgiIDMgNAoKCiMgMSAiL3Vzci9pbmNsdWRlL2Jp
dHMvc2lnc2V0LmgiIDEgMyA0CiMgMjIgIi91c3IvaW5jbHVkZS9iaXRzL3NpZ3NldC5oIiAzIDQK CiMgMjIgIi91c3IvaW5jbHVkZS9iaXRzL3NpZ3NldC5oIiAzIDQKdHlwZWRlZiBpbnQgX19zaWdf YXRvbWljX3Q7CgoKCgp0eXBlZGVmIHN0cnVjdAogIHsKICAgIHVuc2lnbmVkIGxvbmcgaW50IF9f
dmFsWygxMDI0IC8gKDggKiBzaXplb2YgKHVuc2lnbmVkIGxvbmcgaW50KSkpXTsKICB9IF9fc2ln c2V0X3Q7CiMgMTAyICIvdXNyL2luY2x1ZGUvYml0cy9zaWdzZXQuaCIgMyA0CmV4dGVybiBpbnQg X19zaWdpc21lbWJlciAoY29uc3QgX19zaWdzZXRfdCAqLCBpbnQpOwpleHRlcm4gaW50IF9fc2ln
YWRkc2V0IChfX3NpZ3NldF90ICosIGludCk7CmV4dGVybiBpbnQgX19zaWdkZWxzZXQgKF9fc2ln c2V0X3QgKiwgaW50KTsKIyAxMTYgIi91c3IvaW5jbHVkZS9iaXRzL3NpZ3NldC5oIiAzIDQKZXh0 ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGludCBfX3NpZ2lz
bWVtYmVyIChjb25zdCBfX3NpZ3NldF90ICpfX3NldCwgaW50IF9fc2lnKSB7IHVuc2lnbmVkIGxv bmcgaW50IF9fbWFzayA9ICgoKHVuc2lnbmVkIGxvbmcgaW50KSAxKSA8PCAoKChfX3NpZykgLSAx KSAlICg4ICogc2l6ZW9mICh1bnNpZ25lZCBsb25nIGludCkpKSk7IHVuc2lnbmVkIGxvbmcgaW50
IF9fd29yZCA9ICgoKF9fc2lnKSAtIDEpIC8gKDggKiBzaXplb2YgKHVuc2lnbmVkIGxvbmcgaW50 KSkpOyByZXR1cm4gKF9fc2V0LT5fX3ZhbFtfX3dvcmRdICYgX19tYXNrKSA/IDEgOiAwOyB9CmV4 dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBpbnQgX19zaWdh
ZGRzZXQgKCBfX3NpZ3NldF90ICpfX3NldCwgaW50IF9fc2lnKSB7IHVuc2lnbmVkIGxvbmcgaW50 IF9fbWFzayA9ICgoKHVuc2lnbmVkIGxvbmcgaW50KSAxKSA8PCAoKChfX3NpZykgLSAxKSAlICg4 ICogc2l6ZW9mICh1bnNpZ25lZCBsb25nIGludCkpKSk7IHVuc2lnbmVkIGxvbmcgaW50IF9fd29y
ZCA9ICgoKF9fc2lnKSAtIDEpIC8gKDggKiBzaXplb2YgKHVuc2lnbmVkIGxvbmcgaW50KSkpOyBy ZXR1cm4gKChfX3NldC0+X192YWxbX193b3JkXSB8PSBfX21hc2spLCAwKTsgfQpleHRlcm4gX19p bmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgaW50IF9fc2lnZGVsc2V0ICgg
X19zaWdzZXRfdCAqX19zZXQsIGludCBfX3NpZykgeyB1bnNpZ25lZCBsb25nIGludCBfX21hc2sg PSAoKCh1bnNpZ25lZCBsb25nIGludCkgMSkgPDwgKCgoX19zaWcpIC0gMSkgJSAoOCAqIHNpemVv ZiAodW5zaWduZWQgbG9uZyBpbnQpKSkpOyB1bnNpZ25lZCBsb25nIGludCBfX3dvcmQgPSAoKChf
X3NpZykgLSAxKSAvICg4ICogc2l6ZW9mICh1bnNpZ25lZCBsb25nIGludCkpKTsgcmV0dXJuICgo X19zZXQtPl9fdmFsW19fd29yZF0gJj0gfl9fbWFzayksIDApOyB9CiMgMzMgIi91c3IvaW5jbHVk ZS9zaWduYWwuaCIgMiAzIDQKCgoKCgoKCnR5cGVkZWYgX19zaWdfYXRvbWljX3Qgc2lnX2F0b21p
Y190OwoKCgoKCgoKCnR5cGVkZWYgX19zaWdzZXRfdCBzaWdzZXRfdDsKCgoKCgoKCiMgMSAiL3Vz ci9pbmNsdWRlL2JpdHMvc2lnbnVtLmgiIDEgMyA0CiMgNTggIi91c3IvaW5jbHVkZS9zaWduYWwu aCIgMiAzIDQKIyA2NyAiL3Vzci9pbmNsdWRlL3NpZ25hbC5oIiAzIDQKdHlwZWRlZiBfX3VpZF90
IHVpZF90OwojIDgwICIvdXNyL2luY2x1ZGUvc2lnbmFsLmgiIDMgNAojIDEgIi91c3IvaW5jbHVk ZS9iaXRzL3NpZ2luZm8uaCIgMSAzIDQKIyAyNCAiL3Vzci9pbmNsdWRlL2JpdHMvc2lnaW5mby5o IiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy93b3Jkc2l6ZS5oIiAxIDMgNAojIDI1ICIvdXNy
L2luY2x1ZGUvYml0cy9zaWdpbmZvLmgiIDIgMyA0CgoKCgoKCgp0eXBlZGVmIHVuaW9uIHNpZ3Zh bAogIHsKICAgIGludCBzaXZhbF9pbnQ7CiAgICB2b2lkICpzaXZhbF9wdHI7CiAgfSBzaWd2YWxf dDsKIyA1MCAiL3Vzci9pbmNsdWRlL2JpdHMvc2lnaW5mby5oIiAzIDQKdHlwZWRlZiBzdHJ1Y3QK
ICB7CiAgICBpbnQgc2lfc2lnbm87CiAgICBpbnQgc2lfZXJybm87CgogICAgaW50IHNpX2NvZGU7 CgogICAgdW5pb24KICAgICAgewogaW50IF9wYWRbKCgxMjggLyBzaXplb2YgKGludCkpIC0gNCld OwoKCiBzdHJ1Y3QKICAgewogICAgIF9fcGlkX3Qgc2lfcGlkOwogICAgIF9fdWlkX3Qgc2lfdWlk
OwogICB9IF9raWxsOwoKCiBzdHJ1Y3QKICAgewogICAgIGludCBzaV90aWQ7CiAgICAgaW50IHNp X292ZXJydW47CiAgICAgc2lndmFsX3Qgc2lfc2lndmFsOwogICB9IF90aW1lcjsKCgogc3RydWN0 CiAgIHsKICAgICBfX3BpZF90IHNpX3BpZDsKICAgICBfX3VpZF90IHNpX3VpZDsKICAgICBzaWd2
YWxfdCBzaV9zaWd2YWw7CiAgIH0gX3J0OwoKCiBzdHJ1Y3QKICAgewogICAgIF9fcGlkX3Qgc2lf cGlkOwogICAgIF9fdWlkX3Qgc2lfdWlkOwogICAgIGludCBzaV9zdGF0dXM7CiAgICAgX19jbG9j a190IHNpX3V0aW1lOwogICAgIF9fY2xvY2tfdCBzaV9zdGltZTsKICAgfSBfc2lnY2hsZDsKCgog
c3RydWN0CiAgIHsKICAgICB2b2lkICpzaV9hZGRyOwogICAgIHNob3J0IHNpX2FkZHJfbHNiOwog ICB9IF9zaWdmYXVsdDsKCgogc3RydWN0CiAgIHsKICAgICBsb25nIGludCBzaV9iYW5kOwogICAg IGludCBzaV9mZDsKICAgfSBfc2lncG9sbDsKCgogc3RydWN0CiAgIHsKICAgICB2b2lkICpfY2Fs
bF9hZGRyOwogICAgIGludCBfc3lzY2FsbDsKICAgICB1bnNpZ25lZCBpbnQgX2FyY2g7CiAgIH0g X3NpZ3N5czsKICAgICAgfSBfc2lmaWVsZHM7CiAgfSBzaWdpbmZvX3Q7CiMgMTQxICIvdXNyL2lu Y2x1ZGUvYml0cy9zaWdpbmZvLmgiIDMgNAplbnVtCnsKICBTSV9BU1lOQ05MID0gLTYwLAoKICBT
SV9US0lMTCA9IC02LAoKICBTSV9TSUdJTywKCiAgU0lfQVNZTkNJTywKCiAgU0lfTUVTR1EsCgog IFNJX1RJTUVSLAoKICBTSV9RVUVVRSwKCiAgU0lfVVNFUiwKCiAgU0lfS0VSTkVMID0gMHg4MAoK fTsKCgoKCmVudW0KewogIElMTF9JTExPUEMgPSAxLAoKICBJTExfSUxMT1BOLAoKICBJTExfSUxM
QURSLAoKICBJTExfSUxMVFJQLAoKICBJTExfUFJWT1BDLAoKICBJTExfUFJWUkVHLAoKICBJTExf Q09QUk9DLAoKICBJTExfQkFEU1RLCgp9OwoKCmVudW0KewogIEZQRV9JTlRESVYgPSAxLAoKICBG UEVfSU5UT1ZGLAoKICBGUEVfRkxURElWLAoKICBGUEVfRkxUT1ZGLAoKICBGUEVfRkxUVU5ELAoK
ICBGUEVfRkxUUkVTLAoKICBGUEVfRkxUSU5WLAoKICBGUEVfRkxUU1VCCgp9OwoKCmVudW0Kewog IFNFR1ZfTUFQRVJSID0gMSwKCiAgU0VHVl9BQ0NFUlIKCn07CgoKZW51bQp7CiAgQlVTX0FEUkFM TiA9IDEsCgogIEJVU19BRFJFUlIsCgogIEJVU19PQkpFUlIsCgogIEJVU19NQ0VFUlJfQVIsCgog
IEJVU19NQ0VFUlJfQU8KCn07CiMgMjQ1ICIvdXNyL2luY2x1ZGUvYml0cy9zaWdpbmZvLmgiIDMg NAplbnVtCnsKICBDTERfRVhJVEVEID0gMSwKCiAgQ0xEX0tJTExFRCwKCiAgQ0xEX0RVTVBFRCwK CiAgQ0xEX1RSQVBQRUQsCgogIENMRF9TVE9QUEVELAoKICBDTERfQ09OVElOVUVECgp9OwoKCmVu
dW0KewogIFBPTExfSU4gPSAxLAoKICBQT0xMX09VVCwKCiAgUE9MTF9NU0csCgogIFBPTExfRVJS LAoKICBQT0xMX1BSSSwKCiAgUE9MTF9IVVAKCn07CiMgMzAxICIvdXNyL2luY2x1ZGUvYml0cy9z aWdpbmZvLmgiIDMgNAp0eXBlZGVmIHN0cnVjdCBzaWdldmVudAogIHsKICAgIHNpZ3ZhbF90IHNp
Z2V2X3ZhbHVlOwogICAgaW50IHNpZ2V2X3NpZ25vOwogICAgaW50IHNpZ2V2X25vdGlmeTsKCiAg ICB1bmlvbgogICAgICB7CiBpbnQgX3BhZFsoKDY0IC8gc2l6ZW9mIChpbnQpKSAtIDQpXTsKCgoK IF9fcGlkX3QgX3RpZDsKCiBzdHJ1Y3QKICAgewogICAgIHZvaWQgKCpfZnVuY3Rpb24pIChzaWd2
YWxfdCk7CiAgICAgcHRocmVhZF9hdHRyX3QgKl9hdHRyaWJ1dGU7CiAgIH0gX3NpZ2V2X3RocmVh ZDsKICAgICAgfSBfc2lnZXZfdW47CiAgfSBzaWdldmVudF90OwoKCgoKCgplbnVtCnsKICBTSUdF Vl9TSUdOQUwgPSAwLAoKICBTSUdFVl9OT05FLAoKICBTSUdFVl9USFJFQUQsCgoKICBTSUdFVl9U
SFJFQURfSUQgPSA0Cgp9OwojIDgxICIvdXNyL2luY2x1ZGUvc2lnbmFsLmgiIDIgMyA0CgoKCgp0 eXBlZGVmIHZvaWQgKCpfX3NpZ2hhbmRsZXJfdCkgKGludCk7CgoKCgpleHRlcm4gX19zaWdoYW5k bGVyX3QgX19zeXN2X3NpZ25hbCAoaW50IF9fc2lnLCBfX3NpZ2hhbmRsZXJfdCBfX2hhbmRsZXIp
CiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKIyAxMDAgIi91 c3IvaW5jbHVkZS9zaWduYWwuaCIgMyA0CgoKZXh0ZXJuIF9fc2lnaGFuZGxlcl90IHNpZ25hbCAo aW50IF9fc2lnLCBfX3NpZ2hhbmRsZXJfdCBfX2hhbmRsZXIpCiAgICAgX19hdHRyaWJ1dGVfXyAo
KF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKIyAxMTQgIi91c3IvaW5jbHVkZS9zaWduYWwuaCIg MyA0CgojIDEyNyAiL3Vzci9pbmNsdWRlL3NpZ25hbC5oIiAzIDQKZXh0ZXJuIGludCBraWxsIChf X3BpZF90IF9fcGlkLCBpbnQgX19zaWcpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f
bGVhZl9fKSk7CgoKCgoKCmV4dGVybiBpbnQga2lsbHBnIChfX3BpZF90IF9fcGdycCwgaW50IF9f c2lnKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKZXh0ZXJu IGludCByYWlzZSAoaW50IF9fc2lnKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl
YWZfXykpOwoKCgoKZXh0ZXJuIF9fc2lnaGFuZGxlcl90IHNzaWduYWwgKGludCBfX3NpZywgX19z aWdoYW5kbGVyX3QgX19oYW5kbGVyKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs IF9fbGVhZl9fKSk7CmV4dGVybiBpbnQgZ3NpZ25hbCAoaW50IF9fc2lnKSBfX2F0dHJpYnV0ZV9f
ICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKZXh0ZXJuIHZvaWQgcHNpZ25hbCAoaW50 IF9fc2lnLCBjb25zdCBjaGFyICpfX3MpOwoKCmV4dGVybiB2b2lkIHBzaWdpbmZvIChjb25zdCBz aWdpbmZvX3QgKl9fcGluZm8sIGNvbnN0IGNoYXIgKl9fcyk7CiMgMTg3ICIvdXNyL2luY2x1ZGUv
c2lnbmFsLmgiIDMgNApleHRlcm4gaW50IHNpZ2Jsb2NrIChpbnQgX19tYXNrKSBfX2F0dHJpYnV0 ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX2RlcHJlY2F0 ZWRfXykpOwoKCmV4dGVybiBpbnQgc2lnc2V0bWFzayAoaW50IF9fbWFzaykgX19hdHRyaWJ1dGVf
XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19kZXByZWNhdGVk X18pKTsKCgpleHRlcm4gaW50IHNpZ2dldG1hc2sgKHZvaWQpIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZGVwcmVjYXRlZF9fKSk7CiMg
MjA3ICIvdXNyL2luY2x1ZGUvc2lnbmFsLmgiIDMgNAp0eXBlZGVmIF9fc2lnaGFuZGxlcl90IHNp Z190OwoKCgoKCmV4dGVybiBpbnQgc2lnZW1wdHlzZXQgKHNpZ3NldF90ICpfX3NldCkgX19hdHRy aWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25u
dWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBzaWdmaWxsc2V0IChzaWdzZXRfdCAqX19zZXQpIF9f YXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f bm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQgc2lnYWRkc2V0IChzaWdzZXRfdCAqX19zZXQs
IGludCBfX3NpZ25vKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9f YXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4gaW50IHNpZ2RlbHNldCAo c2lnc2V0X3QgKl9fc2V0LCBpbnQgX19zaWdubykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19f
ICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJu IGludCBzaWdpc21lbWJlciAoY29uc3Qgc2lnc2V0X3QgKl9fc2V0LCBpbnQgX19zaWdubykKICAg ICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18g
KChfX25vbm51bGxfXyAoMSkpKTsKIyAyNDMgIi91c3IvaW5jbHVkZS9zaWduYWwuaCIgMyA0CiMg MSAiL3Vzci9pbmNsdWRlL2JpdHMvc2lnYWN0aW9uLmgiIDEgMyA0CiMgMjMgIi91c3IvaW5jbHVk ZS9iaXRzL3NpZ2FjdGlvbi5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy93b3Jkc2l6ZS5o
IiAxIDMgNAojIDI0ICIvdXNyL2luY2x1ZGUvYml0cy9zaWdhY3Rpb24uaCIgMiAzIDQKCgoKc3Ry dWN0IHNpZ2FjdGlvbgogIHsKCgogICAgdW5pb24KICAgICAgewoKIF9fc2lnaGFuZGxlcl90IHNh X2hhbmRsZXI7Cgogdm9pZCAoKnNhX3NpZ2FjdGlvbikgKGludCwgc2lnaW5mb190ICosIHZvaWQg
Kik7CiAgICAgIH0KICAgIF9fc2lnYWN0aW9uX2hhbmRsZXI7CgoKCgoKCgogICAgaW50IF9fZ2xp YmNfcmVzZXJ2ZWQwOwogICAgaW50IHNhX2ZsYWdzOwoKCiAgICB2b2lkICgqc2FfcmVzdG9yZXIp ICh2b2lkKTsKCgogICAgX19zaWdzZXRfdCBzYV9tYXNrOwogIH07CiMgMjQ0ICIvdXNyL2luY2x1
ZGUvc2lnbmFsLmgiIDIgMyA0CgoKZXh0ZXJuIGludCBzaWdwcm9jbWFzayAoaW50IF9faG93LCBj b25zdCBzaWdzZXRfdCAqX19yZXN0cmljdCBfX3NldCwKICAgc2lnc2V0X3QgKl9fcmVzdHJpY3Qg X19vc2V0KSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKCgpl
eHRlcm4gaW50IHNpZ3N1c3BlbmQgKGNvbnN0IHNpZ3NldF90ICpfX3NldCkgX19hdHRyaWJ1dGVf XyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQgc2lnYWN0aW9uIChpbnQgX19zaWcs IGNvbnN0IHN0cnVjdCBzaWdhY3Rpb24gKl9fcmVzdHJpY3QgX19hY3QsCiAgICAgICAgc3RydWN0
IHNpZ2FjdGlvbiAqX19yZXN0cmljdCBfX29hY3QpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df XyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGludCBzaWdwZW5kaW5nIChzaWdzZXRfdCAqX19zZXQp IF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAo
KF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKCgpleHRlcm4gaW50IHNpZ3dhaXQgKGNvbnN0IHNpZ3Nl dF90ICpfX3Jlc3RyaWN0IF9fc2V0LCBpbnQgKl9fcmVzdHJpY3QgX19zaWcpCiAgICAgX19hdHRy aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCgoKCgpleHRlcm4gaW50IHNpZ3dhaXRp
bmZvIChjb25zdCBzaWdzZXRfdCAqX19yZXN0cmljdCBfX3NldCwKICAgc2lnaW5mb190ICpfX3Jl c3RyaWN0IF9faW5mbykgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKCgpl eHRlcm4gaW50IHNpZ3RpbWVkd2FpdCAoY29uc3Qgc2lnc2V0X3QgKl9fcmVzdHJpY3QgX19zZXQs
CiAgICBzaWdpbmZvX3QgKl9fcmVzdHJpY3QgX19pbmZvLAogICAgY29uc3Qgc3RydWN0IHRpbWVz cGVjICpfX3Jlc3RyaWN0IF9fdGltZW91dCkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxs X18gKDEpKSk7CgoKCmV4dGVybiBpbnQgc2lncXVldWUgKF9fcGlkX3QgX19waWQsIGludCBfX3Np
ZywgY29uc3QgdW5pb24gc2lndmFsIF9fdmFsKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhy b3dfXyAsIF9fbGVhZl9fKSk7CiMgMzAxICIvdXNyL2luY2x1ZGUvc2lnbmFsLmgiIDMgNApleHRl cm4gY29uc3QgY2hhciAqY29uc3QgX3N5c19zaWdsaXN0WzY1XTsKZXh0ZXJuIGNvbnN0IGNoYXIg
KmNvbnN0IHN5c19zaWdsaXN0WzY1XTsKCgoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9zaWdjb250 ZXh0LmgiIDEgMyA0CiMgMjcgIi91c3IvaW5jbHVkZS9iaXRzL3NpZ2NvbnRleHQuaCIgMyA0CiMg MSAiL3Vzci9pbmNsdWRlL2FzbS9zaWdjb250ZXh0LmgiIDEgMyA0CiMgMTAgIi91c3IvaW5jbHVk
ZS9hc20vc2lnY29udGV4dC5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvbGludXgvdHlwZXMuaCIg MSAzIDQKCgoKIyAxICIvdXNyL2luY2x1ZGUvYXNtL3R5cGVzLmgiIDEgMyA0CiMgMTAgIi91c3Iv aW5jbHVkZS9hc20vdHlwZXMuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2FzbS1nZW5lcmljL2lu
dC1sbDY0LmgiIDEgMyA0CiMgMTEgIi91c3IvaW5jbHVkZS9hc20tZ2VuZXJpYy9pbnQtbGw2NC5o IiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYXNtL2JpdHNwZXJsb25nLmgiIDEgMyA0CiMgMTAgIi91 c3IvaW5jbHVkZS9hc20vYml0c3BlcmxvbmcuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2FzbS1n
ZW5lcmljL2JpdHNwZXJsb25nLmgiIDEgMyA0CiMgMTEgIi91c3IvaW5jbHVkZS9hc20vYml0c3Bl cmxvbmcuaCIgMiAzIDQKIyAxMiAiL3Vzci9pbmNsdWRlL2FzbS1nZW5lcmljL2ludC1sbDY0Lmgi IDIgMyA0CgoKCgoKCgp0eXBlZGVmIF9fc2lnbmVkX18gY2hhciBfX3M4Owp0eXBlZGVmIHVuc2ln
bmVkIGNoYXIgX191ODsKCnR5cGVkZWYgX19zaWduZWRfXyBzaG9ydCBfX3MxNjsKdHlwZWRlZiB1 bnNpZ25lZCBzaG9ydCBfX3UxNjsKCnR5cGVkZWYgX19zaWduZWRfXyBpbnQgX19zMzI7CnR5cGVk ZWYgdW5zaWduZWQgaW50IF9fdTMyOwoKCl9fZXh0ZW5zaW9uX18gdHlwZWRlZiBfX3NpZ25lZF9f
IGxvbmcgbG9uZyBfX3M2NDsKX19leHRlbnNpb25fXyB0eXBlZGVmIHVuc2lnbmVkIGxvbmcgbG9u ZyBfX3U2NDsKIyAxMSAiL3Vzci9pbmNsdWRlL2FzbS90eXBlcy5oIiAyIDMgNAoKCgoKCgp0eXBl ZGVmIHVuc2lnbmVkIGxvbmcgYWRkcl90Owp0eXBlZGVmIF9fc2lnbmVkX18gbG9uZyBzYWRkcl90
OwoKdHlwZWRlZiBzdHJ1Y3QgewogX191MzIgdVs0XTsKfSBfX3ZlY3RvcjEyODsKIyA1ICIvdXNy L2luY2x1ZGUvbGludXgvdHlwZXMuaCIgMiAzIDQKCgoKIyAxICIvdXNyL2luY2x1ZGUvbGludXgv cG9zaXhfdHlwZXMuaCIgMSAzIDQKCgoKIyAxICIvdXNyL2luY2x1ZGUvbGludXgvc3RkZGVmLmgi
IDEgMyA0CiMgNSAiL3Vzci9pbmNsdWRlL2xpbnV4L3Bvc2l4X3R5cGVzLmgiIDIgMyA0CiMgMjQg Ii91c3IvaW5jbHVkZS9saW51eC9wb3NpeF90eXBlcy5oIiAzIDQKdHlwZWRlZiBzdHJ1Y3Qgewog dW5zaWduZWQgbG9uZyBmZHNfYml0c1sxMDI0IC8gKDggKiBzaXplb2YobG9uZykpXTsKfSBfX2tl
cm5lbF9mZF9zZXQ7CgoKdHlwZWRlZiB2b2lkICgqX19rZXJuZWxfc2lnaGFuZGxlcl90KShpbnQp OwoKCnR5cGVkZWYgaW50IF9fa2VybmVsX2tleV90Owp0eXBlZGVmIGludCBfX2tlcm5lbF9tcWRf dDsKCiMgMSAiL3Vzci9pbmNsdWRlL2FzbS9wb3NpeF90eXBlcy5oIiAxIDMgNAojIDE1ICIvdXNy
L2luY2x1ZGUvYXNtL3Bvc2l4X3R5cGVzLmgiIDMgNAp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgX19r ZXJuZWxfc2l6ZV90Owp0eXBlZGVmIGxvbmcgX19rZXJuZWxfc3NpemVfdDsKCgp0eXBlZGVmIHVu c2lnbmVkIHNob3J0IF9fa2VybmVsX29sZF9kZXZfdDsKIyAzMyAiL3Vzci9pbmNsdWRlL2FzbS9w
b3NpeF90eXBlcy5oIiAzIDQKdHlwZWRlZiB1bnNpZ25lZCBpbnQgX19rZXJuZWxfaW5vX3Q7CnR5 cGVkZWYgdW5zaWduZWQgaW50IF9fa2VybmVsX21vZGVfdDsKdHlwZWRlZiBpbnQgX19rZXJuZWxf aXBjX3BpZF90Owp0eXBlZGVmIHVuc2lnbmVkIGludCBfX2tlcm5lbF91aWRfdDsKdHlwZWRlZiB1
bnNpZ25lZCBpbnQgX19rZXJuZWxfZ2lkX3Q7CnR5cGVkZWYgbG9uZyBfX2tlcm5lbF9wdHJkaWZm X3Q7CnR5cGVkZWYgdW5zaWduZWQgbG9uZyBfX2tlcm5lbF9zaWdzZXRfdDsKIyA0OSAiL3Vzci9p bmNsdWRlL2FzbS9wb3NpeF90eXBlcy5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYXNtLWdlbmVy
aWMvcG9zaXhfdHlwZXMuaCIgMSAzIDQKIyAxNCAiL3Vzci9pbmNsdWRlL2FzbS1nZW5lcmljL3Bv c2l4X3R5cGVzLmgiIDMgNAp0eXBlZGVmIGxvbmcgX19rZXJuZWxfbG9uZ190Owp0eXBlZGVmIHVu c2lnbmVkIGxvbmcgX19rZXJuZWxfdWxvbmdfdDsKIyAyNyAiL3Vzci9pbmNsdWRlL2FzbS1nZW5l
cmljL3Bvc2l4X3R5cGVzLmgiIDMgNAp0eXBlZGVmIGludCBfX2tlcm5lbF9waWRfdDsKIyA0MCAi L3Vzci9pbmNsdWRlL2FzbS1nZW5lcmljL3Bvc2l4X3R5cGVzLmgiIDMgNAp0eXBlZGVmIF9fa2Vy bmVsX2xvbmdfdCBfX2tlcm5lbF9zdXNlY29uZHNfdDsKCgoKdHlwZWRlZiBpbnQgX19rZXJuZWxf
ZGFkZHJfdDsKCgoKdHlwZWRlZiB1bnNpZ25lZCBpbnQgX19rZXJuZWxfdWlkMzJfdDsKdHlwZWRl ZiB1bnNpZ25lZCBpbnQgX19rZXJuZWxfZ2lkMzJfdDsKCgoKdHlwZWRlZiBfX2tlcm5lbF91aWRf dCBfX2tlcm5lbF9vbGRfdWlkX3Q7CnR5cGVkZWYgX19rZXJuZWxfZ2lkX3QgX19rZXJuZWxfb2xk
X2dpZF90OwojIDc4ICIvdXNyL2luY2x1ZGUvYXNtLWdlbmVyaWMvcG9zaXhfdHlwZXMuaCIgMyA0 CnR5cGVkZWYgc3RydWN0IHsKIGludCB2YWxbMl07Cn0gX19rZXJuZWxfZnNpZF90OwoKCgoKCnR5 cGVkZWYgX19rZXJuZWxfbG9uZ190IF9fa2VybmVsX29mZl90Owp0eXBlZGVmIGxvbmcgbG9uZyBf
X2tlcm5lbF9sb2ZmX3Q7CnR5cGVkZWYgX19rZXJuZWxfbG9uZ190IF9fa2VybmVsX3RpbWVfdDsK dHlwZWRlZiBfX2tlcm5lbF9sb25nX3QgX19rZXJuZWxfY2xvY2tfdDsKdHlwZWRlZiBpbnQgX19r ZXJuZWxfdGltZXJfdDsKdHlwZWRlZiBpbnQgX19rZXJuZWxfY2xvY2tpZF90Owp0eXBlZGVmIGNo
YXIgKiBfX2tlcm5lbF9jYWRkcl90Owp0eXBlZGVmIHVuc2lnbmVkIHNob3J0IF9fa2VybmVsX3Vp ZDE2X3Q7CnR5cGVkZWYgdW5zaWduZWQgc2hvcnQgX19rZXJuZWxfZ2lkMTZfdDsKIyA1MCAiL3Vz ci9pbmNsdWRlL2FzbS9wb3NpeF90eXBlcy5oIiAyIDMgNAojIDM2ICIvdXNyL2luY2x1ZGUvbGlu
dXgvcG9zaXhfdHlwZXMuaCIgMiAzIDQKIyA5ICIvdXNyL2luY2x1ZGUvbGludXgvdHlwZXMuaCIg MiAzIDQKIyAyNyAiL3Vzci9pbmNsdWRlL2xpbnV4L3R5cGVzLmgiIDMgNAp0eXBlZGVmIF9fdTE2 IF9fbGUxNjsKdHlwZWRlZiBfX3UxNiBfX2JlMTY7CnR5cGVkZWYgX191MzIgX19sZTMyOwp0eXBl
ZGVmIF9fdTMyIF9fYmUzMjsKdHlwZWRlZiBfX3U2NCBfX2xlNjQ7CnR5cGVkZWYgX191NjQgX19i ZTY0OwoKdHlwZWRlZiBfX3UxNiBfX3N1bTE2Owp0eXBlZGVmIF9fdTMyIF9fd3N1bTsKIyAxMSAi L3Vzci9pbmNsdWRlL2FzbS9zaWdjb250ZXh0LmgiIDIgMyA0CiMgNDAgIi91c3IvaW5jbHVkZS9h
c20vc2lnY29udGV4dC5oIiAzIDQKdHlwZWRlZiBzdHJ1Y3QKewogICAgICAgIHVuc2lnbmVkIGxv bmcgbWFzazsKICAgICAgICB1bnNpZ25lZCBsb25nIGFkZHI7Cn0gX19hdHRyaWJ1dGVfXyAoKGFs aWduZWQoOCkpKSBfcHN3X3Q7Cgp0eXBlZGVmIHN0cnVjdAp7CiBfcHN3X3QgcHN3OwogdW5zaWdu
ZWQgbG9uZyBncHJzWzE2XTsKIHVuc2lnbmVkIGludCBhY3JzWzE2XTsKfSBfczM5MF9yZWdzX2Nv bW1vbjsKCnR5cGVkZWYgc3RydWN0CnsKIHVuc2lnbmVkIGludCBmcGM7CiB1bnNpZ25lZCBpbnQg cGFkOwogZG91YmxlIGZwcnNbMTZdOwp9IF9zMzkwX2ZwX3JlZ3M7Cgp0eXBlZGVmIHN0cnVjdAp7
CiBfczM5MF9yZWdzX2NvbW1vbiByZWdzOwogX3MzOTBfZnBfcmVncyBmcHJlZ3M7Cn0gX3NpZ3Jl Z3M7Cgp0eXBlZGVmIHN0cnVjdAp7CgoKCiB1bnNpZ25lZCBsb25nIGxvbmcgdnhyc19sb3dbMTZd OwogX192ZWN0b3IxMjggdnhyc19oaWdoWzE2XTsKIHVuc2lnbmVkIGNoYXIgX19yZXNlcnZlZFsx
MjhdOwp9IF9zaWdyZWdzX2V4dDsKCnN0cnVjdCBzaWdjb250ZXh0CnsKIHVuc2lnbmVkIGxvbmcg b2xkbWFza1soNjQgLyA2NCldOwogX3NpZ3JlZ3MgKnNyZWdzOwp9OwojIDI4ICIvdXNyL2luY2x1 ZGUvYml0cy9zaWdjb250ZXh0LmgiIDIgMyA0CgoKCiMgMSAiL3Vzci9saWIvZ2NjL3MzOTB4LXJl
ZGhhdC1saW51eC82LjAuMC9pbmNsdWRlL3N0ZGRlZi5oIiAxIDMgNAojIDMyICIvdXNyL2luY2x1 ZGUvYml0cy9zaWdjb250ZXh0LmgiIDIgMyA0CiMgMzA3ICIvdXNyL2luY2x1ZGUvc2lnbmFsLmgi IDIgMyA0CgoKZXh0ZXJuIGludCBzaWdyZXR1cm4gKHN0cnVjdCBzaWdjb250ZXh0ICpfX3NjcCkg
X19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCgoKIyAxICIvdXNy L2xpYi9nY2MvczM5MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDEgMyA0 CiMgMzE3ICIvdXNyL2luY2x1ZGUvc2lnbmFsLmgiIDIgMyA0CgoKCgpleHRlcm4gaW50IHNpZ2lu
dGVycnVwdCAoaW50IF9fc2lnLCBpbnQgX19pbnRlcnJ1cHQpIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSk7CgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3NpZ3N0YWNrLmgi IDEgMyA0CiMgMjUgIi91c3IvaW5jbHVkZS9iaXRzL3NpZ3N0YWNrLmgiIDMgNApzdHJ1Y3Qgc2ln
c3RhY2sKICB7CiAgICB2b2lkICpzc19zcDsKICAgIGludCBzc19vbnN0YWNrOwogIH07CgoKCmVu dW0KewogIFNTX09OU1RBQ0sgPSAxLAoKICBTU19ESVNBQkxFCgp9OwojIDQ5ICIvdXNyL2luY2x1 ZGUvYml0cy9zaWdzdGFjay5oIiAzIDQKdHlwZWRlZiBzdHJ1Y3Qgc2lnYWx0c3RhY2sKICB7CiAg
ICB2b2lkICpzc19zcDsKICAgIGludCBzc19mbGFnczsKICAgIHNpemVfdCBzc19zaXplOwogIH0g c3RhY2tfdDsKIyAzMjQgIi91c3IvaW5jbHVkZS9zaWduYWwuaCIgMiAzIDQKCgojIDEgIi91c3Iv aW5jbHVkZS9zeXMvdWNvbnRleHQuaCIgMSAzIDQKIyAyMiAiL3Vzci9pbmNsdWRlL3N5cy91Y29u
dGV4dC5oIiAzIDQKc3RydWN0IHVjb250ZXh0Owp0eXBlZGVmIHN0cnVjdCB1Y29udGV4dCB1Y29u dGV4dF90OwoKIyAxICIvdXNyL2luY2x1ZGUvc2lnbmFsLmgiIDEgMyA0CiMgMjYgIi91c3IvaW5j bHVkZS9zeXMvdWNvbnRleHQuaCIgMiAzIDQKCgoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9zaWdj
b250ZXh0LmgiIDEgMyA0CiMgMzAgIi91c3IvaW5jbHVkZS9zeXMvdWNvbnRleHQuaCIgMiAzIDQK Cgp0eXBlZGVmIHN0cnVjdAp7CiAgdW5zaWduZWQgbG9uZyBtYXNrOwogIHVuc2lnbmVkIGxvbmcg YWRkcjsKfSBfX2F0dHJpYnV0ZV9fICgoX19hbGlnbmVkX18oOCkpKSBfX3Bzd190OwoKCnR5cGVk
ZWYgdW5zaWduZWQgbG9uZyBncmVnX3Q7CiMgNTIgIi91c3IvaW5jbHVkZS9zeXMvdWNvbnRleHQu aCIgMyA0CnR5cGVkZWYgZ3JlZ190IGdyZWdzZXRfdFsyN10gX19hdHRyaWJ1dGVfXyAoKF9fYWxp Z25lZF9fKDgpKSk7Cgp0eXBlZGVmIHVuaW9uCiAgewogICAgZG91YmxlIGQ7CiAgICBmbG9hdCBm
OwogIH0gZnByZWdfdDsKCgp0eXBlZGVmIHN0cnVjdAogIHsKICAgIHVuc2lnbmVkIGludCBmcGM7 CiAgICBmcHJlZ190IGZwcnNbMTZdOwogIH0gZnByZWdzZXRfdDsKCgp0eXBlZGVmIHN0cnVjdAog IHsKICAgIF9fcHN3X3QgcHN3OwogICAgdW5zaWduZWQgbG9uZyBncmVnc1sxNl07CiAgICB1bnNp
Z25lZCBpbnQgYXJlZ3NbMTZdOwogICAgZnByZWdzZXRfdCBmcHJlZ3M7CiAgfSBtY29udGV4dF90 OwoKCnN0cnVjdCB1Y29udGV4dAogIHsKICAgIHVuc2lnbmVkIGxvbmcgaW50IHVjX2ZsYWdzOwog ICAgc3RydWN0IHVjb250ZXh0ICp1Y19saW5rOwogICAgc3RhY2tfdCB1Y19zdGFjazsKICAgIG1j
b250ZXh0X3QgdWNfbWNvbnRleHQ7CiAgICBfX3NpZ3NldF90IHVjX3NpZ21hc2s7CiAgfTsKIyAz MjcgIi91c3IvaW5jbHVkZS9zaWduYWwuaCIgMiAzIDQKCgoKCgpleHRlcm4gaW50IHNpZ3N0YWNr IChzdHJ1Y3Qgc2lnc3RhY2sgKl9fc3MsIHN0cnVjdCBzaWdzdGFjayAqX19vc3MpCiAgICAgX19h
dHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19k ZXByZWNhdGVkX18pKTsKCgoKZXh0ZXJuIGludCBzaWdhbHRzdGFjayAoY29uc3Qgc3RydWN0IHNp Z2FsdHN0YWNrICpfX3Jlc3RyaWN0IF9fc3MsCiAgIHN0cnVjdCBzaWdhbHRzdGFjayAqX19yZXN0
cmljdCBfX29zcykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKIyAz NjIgIi91c3IvaW5jbHVkZS9zaWduYWwuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvc2ln dGhyZWFkLmgiIDEgMyA0CiMgMzAgIi91c3IvaW5jbHVkZS9iaXRzL3NpZ3RocmVhZC5oIiAzIDQK
ZXh0ZXJuIGludCBwdGhyZWFkX3NpZ21hc2sgKGludCBfX2hvdywKICAgICAgIGNvbnN0IF9fc2ln c2V0X3QgKl9fcmVzdHJpY3QgX19uZXdtYXNrLAogICAgICAgX19zaWdzZXRfdCAqX19yZXN0cmlj dCBfX29sZG1hc2spX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgpl
eHRlcm4gaW50IHB0aHJlYWRfa2lsbCAocHRocmVhZF90IF9fdGhyZWFkaWQsIGludCBfX3NpZ25v KSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwojIDM2MyAiL3Vzci9p bmNsdWRlL3NpZ25hbC5oIiAyIDMgNAoKCgoKCgpleHRlcm4gaW50IF9fbGliY19jdXJyZW50X3Np
Z3J0bWluICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoK ZXh0ZXJuIGludCBfX2xpYmNfY3VycmVudF9zaWdydG1heCAodm9pZCkgX19hdHRyaWJ1dGVfXyAo KF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCiMgNDMgIi4vaW5jbHVkZS9nY19wdGhyZWFk
X3JlZGlyZWN0cy5oIiAyCiAgICAKIyA0MyAiLi9pbmNsdWRlL2djX3B0aHJlYWRfcmVkaXJlY3Rz LmgiCiAgIGV4dGVybiBpbnQgR0NfcHRocmVhZF9zaWdtYXNrKGludCAsIGNvbnN0IHNpZ3NldF90 ICosCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWdzZXRfdCAqICk7CgoKCgoK
CgogIGV4dGVybiBpbnQgR0NfcHRocmVhZF9jcmVhdGUocHRocmVhZF90ICosCiAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICBjb25zdCBwdGhyZWFkX2F0dHJfdCAqLAogICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgdm9pZCAqKCopKHZvaWQgKiksIHZvaWQgKiApOwogIGV4dGVybiBp
bnQgR0NfcHRocmVhZF9qb2luKHB0aHJlYWRfdCwgdm9pZCAqKiApOwogIGV4dGVybiBpbnQgR0Nf cHRocmVhZF9kZXRhY2gocHRocmVhZF90KTsKCgogICAgZXh0ZXJuIGludCBHQ19wdGhyZWFkX2Nh bmNlbChwdGhyZWFkX3QpOwoKCgoKICAgIGV4dGVybiB2b2lkIEdDX3B0aHJlYWRfZXhpdCh2b2lk
ICopIF9fYXR0cmlidXRlX18oKF9fbm9yZXR1cm5fXykpOwojIDE0NDQgIi4vaW5jbHVkZS9nYy5o IiAyCgoKCgoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fbWFsbG9jX18pKSB2b2lkICogR0NfbWFs bG9jX21hbnkoc2l6ZV90ICk7CiMgMTQ2MSAiLi9pbmNsdWRlL2djLmgiCnR5cGVkZWYgaW50ICgg
KiBHQ19oYXNfc3RhdGljX3Jvb3RzX2Z1bmMpKAogICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgY29uc3QgY2hhciAqICwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgIHZvaWQgKiAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzaXplX3QgKTsKCgoKCgpleHRlcm4gdm9pZCBHQ19yZWdpc3Rlcl9oYXNfc3RhdGljX3Jvb3Rz X2NhbGxiYWNrKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0NfaGFz X3N0YXRpY19yb290c19mdW5jKTsKIyAxNTg0ICIuL2luY2x1ZGUvZ2MuaCIKZXh0ZXJuIHZvaWQg
R0Nfc2V0X2ZvcmNlX3VubWFwX29uX2djb2xsZWN0KGludCk7CmV4dGVybiBpbnQgR0NfZ2V0X2Zv cmNlX3VubWFwX29uX2djb2xsZWN0KHZvaWQpOwojIDE3NDIgIi4vaW5jbHVkZS9nYy5oIgpleHRl cm4gdm9pZCBHQ193aW4zMl9mcmVlX2hlYXAodm9pZCk7CiMgMjIgImNvcmQvY29yZGJzY3MuYyIg
MgojIDEgIi4vaW5jbHVkZS9jb3JkLmgiIDEKIyA1OCAiLi9pbmNsdWRlL2NvcmQuaCIKIyAxICIv dXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDEg MyA0CiMgNTkgIi4vaW5jbHVkZS9jb3JkLmgiIDIKIyAxICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIg
MSAzIDQKIyAyOSAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDMgNAoKCgoKIyAxICIvdXNyL2xpYi9n Y2MvczM5MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDEgMyA0CiMgMzQg Ii91c3IvaW5jbHVkZS9zdGRpby5oIiAyIDMgNAojIDQ0ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIg
MyA0CgojIDQ0ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CnN0cnVjdCBfSU9fRklMRTsKCgoK dHlwZWRlZiBzdHJ1Y3QgX0lPX0ZJTEUgRklMRTsKCgoKCgojIDY0ICIvdXNyL2luY2x1ZGUvc3Rk aW8uaCIgMyA0CnR5cGVkZWYgc3RydWN0IF9JT19GSUxFIF9fRklMRTsKIyA3NCAiL3Vzci9pbmNs
dWRlL3N0ZGlvLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9saWJpby5oIiAxIDMgNAojIDMxICIv dXNyL2luY2x1ZGUvbGliaW8uaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL19HX2NvbmZpZy5oIiAx IDMgNAojIDE1ICIvdXNyL2luY2x1ZGUvX0dfY29uZmlnLmgiIDMgNAojIDEgIi91c3IvbGliL2dj
Yy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVkZS9zdGRkZWYuaCIgMSAzIDQKIyAxNiAi L3Vzci9pbmNsdWRlL19HX2NvbmZpZy5oIiAyIDMgNAoKCgoKIyAxICIvdXNyL2luY2x1ZGUvd2No YXIuaCIgMSAzIDQKIyA4MiAiL3Vzci9pbmNsdWRlL3djaGFyLmgiIDMgNAp0eXBlZGVmIHN0cnVj
dAp7CiAgaW50IF9fY291bnQ7CiAgdW5pb24KICB7CgogICAgdW5zaWduZWQgaW50IF9fd2NoOwoK CgogICAgY2hhciBfX3djaGJbNF07CiAgfSBfX3ZhbHVlOwp9IF9fbWJzdGF0ZV90OwojIDIxICIv dXNyL2luY2x1ZGUvX0dfY29uZmlnLmgiIDIgMyA0CnR5cGVkZWYgc3RydWN0CnsKICBfX29mZl90
IF9fcG9zOwogIF9fbWJzdGF0ZV90IF9fc3RhdGU7Cn0gX0dfZnBvc190Owp0eXBlZGVmIHN0cnVj dAp7CiAgX19vZmY2NF90IF9fcG9zOwogIF9fbWJzdGF0ZV90IF9fc3RhdGU7Cn0gX0dfZnBvczY0 X3Q7CiMgMzIgIi91c3IvaW5jbHVkZS9saWJpby5oIiAyIDMgNAojIDQ5ICIvdXNyL2luY2x1ZGUv
bGliaW8uaCIgMyA0CiMgMSAiL3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51eC82LjAuMC9p bmNsdWRlL3N0ZGFyZy5oIiAxIDMgNAojIDQwICIvdXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0LWxp bnV4LzYuMC4wL2luY2x1ZGUvc3RkYXJnLmgiIDMgNAp0eXBlZGVmIF9fYnVpbHRpbl92YV9saXN0
IF9fZ251Y192YV9saXN0OwojIDUwICIvdXNyL2luY2x1ZGUvbGliaW8uaCIgMiAzIDQKIyAxNDQg Ii91c3IvaW5jbHVkZS9saWJpby5oIiAzIDQKc3RydWN0IF9JT19qdW1wX3Q7IHN0cnVjdCBfSU9f RklMRTsKCgoKCgp0eXBlZGVmIHZvaWQgX0lPX2xvY2tfdDsKCgoKCgpzdHJ1Y3QgX0lPX21hcmtl
ciB7CiAgc3RydWN0IF9JT19tYXJrZXIgKl9uZXh0OwogIHN0cnVjdCBfSU9fRklMRSAqX3NidWY7 CgoKCiAgaW50IF9wb3M7CiMgMTczICIvdXNyL2luY2x1ZGUvbGliaW8uaCIgMyA0Cn07CgoKZW51 bSBfX2NvZGVjdnRfcmVzdWx0CnsKICBfX2NvZGVjdnRfb2ssCiAgX19jb2RlY3Z0X3BhcnRpYWws
CiAgX19jb2RlY3Z0X2Vycm9yLAogIF9fY29kZWN2dF9ub2NvbnYKfTsKIyAyNDEgIi91c3IvaW5j bHVkZS9saWJpby5oIiAzIDQKc3RydWN0IF9JT19GSUxFIHsKICBpbnQgX2ZsYWdzOwoKCgoKICBj aGFyKiBfSU9fcmVhZF9wdHI7CiAgY2hhciogX0lPX3JlYWRfZW5kOwogIGNoYXIqIF9JT19yZWFk
X2Jhc2U7CiAgY2hhciogX0lPX3dyaXRlX2Jhc2U7CiAgY2hhciogX0lPX3dyaXRlX3B0cjsKICBj aGFyKiBfSU9fd3JpdGVfZW5kOwogIGNoYXIqIF9JT19idWZfYmFzZTsKICBjaGFyKiBfSU9fYnVm X2VuZDsKCiAgY2hhciAqX0lPX3NhdmVfYmFzZTsKICBjaGFyICpfSU9fYmFja3VwX2Jhc2U7CiAg
Y2hhciAqX0lPX3NhdmVfZW5kOwoKICBzdHJ1Y3QgX0lPX21hcmtlciAqX21hcmtlcnM7CgogIHN0 cnVjdCBfSU9fRklMRSAqX2NoYWluOwoKICBpbnQgX2ZpbGVubzsKCgoKICBpbnQgX2ZsYWdzMjsK CiAgX19vZmZfdCBfb2xkX29mZnNldDsKCgoKICB1bnNpZ25lZCBzaG9ydCBfY3VyX2NvbHVtbjsK
ICBzaWduZWQgY2hhciBfdnRhYmxlX29mZnNldDsKICBjaGFyIF9zaG9ydGJ1ZlsxXTsKCgoKICBf SU9fbG9ja190ICpfbG9jazsKIyAyODkgIi91c3IvaW5jbHVkZS9saWJpby5oIiAzIDQKICBfX29m ZjY0X3QgX29mZnNldDsKCgoKCgoKCiAgdm9pZCAqX19wYWQxOwogIHZvaWQgKl9fcGFkMjsKICB2
b2lkICpfX3BhZDM7CiAgdm9pZCAqX19wYWQ0OwoKICBzaXplX3QgX19wYWQ1OwogIGludCBfbW9k ZTsKCiAgY2hhciBfdW51c2VkMlsxNSAqIHNpemVvZiAoaW50KSAtIDQgKiBzaXplb2YgKHZvaWQg KikgLSBzaXplb2YgKHNpemVfdCldOwoKfTsKCgp0eXBlZGVmIHN0cnVjdCBfSU9fRklMRSBfSU9f
RklMRTsKCgpzdHJ1Y3QgX0lPX0ZJTEVfcGx1czsKCmV4dGVybiBzdHJ1Y3QgX0lPX0ZJTEVfcGx1 cyBfSU9fMl8xX3N0ZGluXzsKZXh0ZXJuIHN0cnVjdCBfSU9fRklMRV9wbHVzIF9JT18yXzFfc3Rk b3V0XzsKZXh0ZXJuIHN0cnVjdCBfSU9fRklMRV9wbHVzIF9JT18yXzFfc3RkZXJyXzsKIyAzMzMg
Ii91c3IvaW5jbHVkZS9saWJpby5oIiAzIDQKdHlwZWRlZiBfX3NzaXplX3QgX19pb19yZWFkX2Zu ICh2b2lkICpfX2Nvb2tpZSwgY2hhciAqX19idWYsIHNpemVfdCBfX25ieXRlcyk7CgoKCgoKCgp0 eXBlZGVmIF9fc3NpemVfdCBfX2lvX3dyaXRlX2ZuICh2b2lkICpfX2Nvb2tpZSwgY29uc3QgY2hh
ciAqX19idWYsCiAgICAgc2l6ZV90IF9fbik7CgoKCgoKCgp0eXBlZGVmIGludCBfX2lvX3NlZWtf Zm4gKHZvaWQgKl9fY29va2llLCBfX29mZjY0X3QgKl9fcG9zLCBpbnQgX193KTsKCgp0eXBlZGVm IGludCBfX2lvX2Nsb3NlX2ZuICh2b2lkICpfX2Nvb2tpZSk7CiMgMzg1ICIvdXNyL2luY2x1ZGUv
bGliaW8uaCIgMyA0CmV4dGVybiBpbnQgX191bmRlcmZsb3cgKF9JT19GSUxFICopOwpleHRlcm4g aW50IF9fdWZsb3cgKF9JT19GSUxFICopOwpleHRlcm4gaW50IF9fb3ZlcmZsb3cgKF9JT19GSUxF ICosIGludCk7CiMgNDI5ICIvdXNyL2luY2x1ZGUvbGliaW8uaCIgMyA0CmV4dGVybiBpbnQgX0lP
X2dldGMgKF9JT19GSUxFICpfX2ZwKTsKZXh0ZXJuIGludCBfSU9fcHV0YyAoaW50IF9fYywgX0lP X0ZJTEUgKl9fZnApOwpleHRlcm4gaW50IF9JT19mZW9mIChfSU9fRklMRSAqX19mcCkgX19hdHRy aWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKZXh0ZXJuIGludCBfSU9fZmVycm9y
IChfSU9fRklMRSAqX19mcCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18p KTsKCmV4dGVybiBpbnQgX0lPX3BlZWtjX2xvY2tlZCAoX0lPX0ZJTEUgKl9fZnApOwoKCgoKCmV4 dGVybiB2b2lkIF9JT19mbG9ja2ZpbGUgKF9JT19GSUxFICopIF9fYXR0cmlidXRlX18gKChfX25v
dGhyb3dfXyAsIF9fbGVhZl9fKSk7CmV4dGVybiB2b2lkIF9JT19mdW5sb2NrZmlsZSAoX0lPX0ZJ TEUgKikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKZXh0ZXJuIGlu dCBfSU9fZnRyeWxvY2tmaWxlIChfSU9fRklMRSAqKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93
X18gLCBfX2xlYWZfXykpOwojIDQ1OSAiL3Vzci9pbmNsdWRlL2xpYmlvLmgiIDMgNApleHRlcm4g aW50IF9JT192ZnNjYW5mIChfSU9fRklMRSAqIF9fcmVzdHJpY3QsIGNvbnN0IGNoYXIgKiBfX3Jl c3RyaWN0LAogICBfX2dudWNfdmFfbGlzdCwgaW50ICpfX3Jlc3RyaWN0KTsKZXh0ZXJuIGludCBf
SU9fdmZwcmludGYgKF9JT19GSUxFICpfX3Jlc3RyaWN0LCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0 LAogICAgX19nbnVjX3ZhX2xpc3QpOwpleHRlcm4gX19zc2l6ZV90IF9JT19wYWRuIChfSU9fRklM RSAqLCBpbnQsIF9fc3NpemVfdCk7CmV4dGVybiBzaXplX3QgX0lPX3NnZXRuIChfSU9fRklMRSAq
LCB2b2lkICosIHNpemVfdCk7CgpleHRlcm4gX19vZmY2NF90IF9JT19zZWVrb2ZmIChfSU9fRklM RSAqLCBfX29mZjY0X3QsIGludCwgaW50KTsKZXh0ZXJuIF9fb2ZmNjRfdCBfSU9fc2Vla3BvcyAo X0lPX0ZJTEUgKiwgX19vZmY2NF90LCBpbnQpOwoKZXh0ZXJuIHZvaWQgX0lPX2ZyZWVfYmFja3Vw
X2FyZWEgKF9JT19GSUxFICopIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9f KSk7CiMgNzUgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAyIDMgNAoKCgoKdHlwZWRlZiBfX2dudWNf dmFfbGlzdCB2YV9saXN0OwojIDkwICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CnR5cGVkZWYg
X19vZmZfdCBvZmZfdDsKIyAxMDIgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAzIDQKdHlwZWRlZiBf X3NzaXplX3Qgc3NpemVfdDsKCgoKCgoKCnR5cGVkZWYgX0dfZnBvc190IGZwb3NfdDsKCgoKCiMg MTY0ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvc3Rk
aW9fbGltLmgiIDEgMyA0CiMgMTY1ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMiAzIDQKCgoKZXh0 ZXJuIHN0cnVjdCBfSU9fRklMRSAqc3RkaW47CmV4dGVybiBzdHJ1Y3QgX0lPX0ZJTEUgKnN0ZG91 dDsKZXh0ZXJuIHN0cnVjdCBfSU9fRklMRSAqc3RkZXJyOwoKCgoKCgoKZXh0ZXJuIGludCByZW1v
dmUgKGNvbnN0IGNoYXIgKl9fZmlsZW5hbWUpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs IF9fbGVhZl9fKSk7CgpleHRlcm4gaW50IHJlbmFtZSAoY29uc3QgY2hhciAqX19vbGQsIGNvbnN0 IGNoYXIgKl9fbmV3KSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoK
CgoKZXh0ZXJuIGludCByZW5hbWVhdCAoaW50IF9fb2xkZmQsIGNvbnN0IGNoYXIgKl9fb2xkLCBp bnQgX19uZXdmZCwKICAgICAgIGNvbnN0IGNoYXIgKl9fbmV3KSBfX2F0dHJpYnV0ZV9fICgoX19u b3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKCgoKCmV4dGVybiBGSUxFICp0bXBmaWxlICh2b2lk
KSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDIwOSAiL3Vzci9p bmNsdWRlL3N0ZGlvLmgiIDMgNApleHRlcm4gY2hhciAqdG1wbmFtIChjaGFyICpfX3MpIF9fYXR0 cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCgpleHRlcm4gY2hhciAqdG1wbmFtX3IgKGNoYXIgKl9f cykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9f ICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDIyNyAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgi
IDMgNApleHRlcm4gY2hhciAqdGVtcG5hbSAoY29uc3QgY2hhciAqX19kaXIsIGNvbnN0IGNoYXIg Kl9fcGZ4KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19h dHRyaWJ1dGVfXyAoKF9fbWFsbG9jX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9y
ZXN1bHRfXykpOwoKCgoKCgoKCmV4dGVybiBpbnQgZmNsb3NlIChGSUxFICpfX3N0cmVhbSk7CgoK CgpleHRlcm4gaW50IGZmbHVzaCAoRklMRSAqX19zdHJlYW0pOwoKIyAyNTIgIi91c3IvaW5jbHVk ZS9zdGRpby5oIiAzIDQKZXh0ZXJuIGludCBmZmx1c2hfdW5sb2NrZWQgKEZJTEUgKl9fc3RyZWFt
KTsKIyAyNjYgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAzIDQKCgoKCgoKZXh0ZXJuIEZJTEUgKmZv cGVuIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZmlsZW5hbWUsCiAgICAgIGNvbnN0IGNoYXIg Kl9fcmVzdHJpY3QgX19tb2RlcykgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0
X18pKTsKCgoKCmV4dGVybiBGSUxFICpmcmVvcGVuIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9f ZmlsZW5hbWUsCiAgICAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX21vZGVzLAogICAgICAg IEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0pIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2Vk
X3Jlc3VsdF9fKSk7CiMgMjk1ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CgojIDMwNiAiL3Vz ci9pbmNsdWRlL3N0ZGlvLmgiIDMgNApleHRlcm4gRklMRSAqZmRvcGVuIChpbnQgX19mZCwgY29u c3QgY2hhciAqX19tb2RlcykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18p
KSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDMxOSAiL3Vzci9p bmNsdWRlL3N0ZGlvLmgiIDMgNApleHRlcm4gRklMRSAqZm1lbW9wZW4gKHZvaWQgKl9fcywgc2l6 ZV90IF9fbGVuLCBjb25zdCBjaGFyICpfX21vZGVzKQogIF9fYXR0cmlidXRlX18gKChfX25vdGhy
b3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18p KTsKCgoKCmV4dGVybiBGSUxFICpvcGVuX21lbXN0cmVhbSAoY2hhciAqKl9fYnVmbG9jLCBzaXpl X3QgKl9fc2l6ZWxvYykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBf
X2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKCgpleHRlcm4gdm9p ZCBzZXRidWYgKEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0sIGNoYXIgKl9fcmVzdHJpY3QgX19i dWYpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCmV4dGVybiBp
bnQgc2V0dmJ1ZiAoRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSwgY2hhciAqX19yZXN0cmljdCBf X2J1ZiwKICAgICAgaW50IF9fbW9kZXMsIHNpemVfdCBfX24pIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgoKZXh0ZXJuIHZvaWQgc2V0YnVmZmVyIChGSUxFICpf
X3Jlc3RyaWN0IF9fc3RyZWFtLCBjaGFyICpfX3Jlc3RyaWN0IF9fYnVmLAogICAgICAgICBzaXpl X3QgX19zaXplKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCmV4 dGVybiB2b2lkIHNldGxpbmVidWYgKEZJTEUgKl9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgoX19u
b3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKCgoKCmV4dGVybiBpbnQgZnByaW50ZiAoRklMRSAq X19yZXN0cmljdCBfX3N0cmVhbSwKICAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1h dCwgLi4uKTsKCgoKCmV4dGVybiBpbnQgcHJpbnRmIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9f
Zm9ybWF0LCAuLi4pOwoKZXh0ZXJuIGludCBzcHJpbnRmIChjaGFyICpfX3Jlc3RyaWN0IF9fcywK ICAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwgLi4uKSBfX2F0dHJpYnV0ZV9f ICgoX19ub3Rocm93X18pKTsKCgoKCgpleHRlcm4gaW50IHZmcHJpbnRmIChGSUxFICpfX3Jlc3Ry
aWN0IF9fcywgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwKICAgICAgIF9fZ251Y192 YV9saXN0IF9fYXJnKTsKCgoKCmV4dGVybiBpbnQgdnByaW50ZiAoY29uc3QgY2hhciAqX19yZXN0 cmljdCBfX2Zvcm1hdCwgX19nbnVjX3ZhX2xpc3QgX19hcmcpOwoKZXh0ZXJuIGludCB2c3ByaW50
ZiAoY2hhciAqX19yZXN0cmljdCBfX3MsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQs CiAgICAgICBfX2dudWNfdmFfbGlzdCBfX2FyZykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19f KSk7CgoKCgoKZXh0ZXJuIGludCBzbnByaW50ZiAoY2hhciAqX19yZXN0cmljdCBfX3MsIHNpemVf
dCBfX21heGxlbiwKICAgICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4uLikK ICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18pKSBfX2F0dHJpYnV0ZV9fICgoX19mb3Jt YXRfXyAoX19wcmludGZfXywgMywgNCkpKTsKCmV4dGVybiBpbnQgdnNucHJpbnRmIChjaGFyICpf
X3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fbWF4bGVuLAogICAgICAgIGNvbnN0IGNoYXIgKl9fcmVz dHJpY3QgX19mb3JtYXQsIF9fZ251Y192YV9saXN0IF9fYXJnKQogICAgIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXykpIF9fYXR0cmlidXRlX18gKChfX2Zvcm1hdF9fIChfX3ByaW50Zl9fLCAz
LCAwKSkpOwoKIyA0MTIgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAzIDQKZXh0ZXJuIGludCB2ZHBy aW50ZiAoaW50IF9fZmQsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mbXQsCiAgICAgICBfX2du dWNfdmFfbGlzdCBfX2FyZykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19mb3JtYXRfXyAoX19wcmlu
dGZfXywgMiwgMCkpKTsKZXh0ZXJuIGludCBkcHJpbnRmIChpbnQgX19mZCwgY29uc3QgY2hhciAq X19yZXN0cmljdCBfX2ZtdCwgLi4uKQogICAgIF9fYXR0cmlidXRlX18gKChfX2Zvcm1hdF9fIChf X3ByaW50Zl9fLCAyLCAzKSkpOwoKCgoKCgoKCmV4dGVybiBpbnQgZnNjYW5mIChGSUxFICpfX3Jl
c3RyaWN0IF9fc3RyZWFtLAogICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4u LikgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCmV4dGVybiBp bnQgc2NhbmYgKGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4uLikgX19hdHRyaWJ1
dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCmV4dGVybiBpbnQgc3NjYW5mIChjb25z dCBjaGFyICpfX3Jlc3RyaWN0IF9fcywKICAgICBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9y bWF0LCAuLi4pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CiMgNDQz
ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CmV4dGVybiBpbnQgZnNjYW5mIChGSUxFICpfX3Jl c3RyaWN0IF9fc3RyZWFtLCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCAuLi4pIF9f YXNtX18gKCIiICJfX2lzb2M5OV9mc2NhbmYiKQoKICAgICAgICAgICAgICAgICAgICAgICAgICBf
X2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gaW50IHNjYW5m IChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCAuLi4pIF9fYXNtX18gKCIiICJfX2lz b2M5OV9zY2FuZiIpCiAgICAgICAgICAgICAgICAgICAgICAgICBfX2F0dHJpYnV0ZV9fICgoX193
YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gaW50IHNzY2FuZiAoY29uc3QgY2hhciAqX19y ZXN0cmljdCBfX3MsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4uLikgX19hc21f XyAoIiIgIl9faXNvYzk5X3NzY2FuZiIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f
bGVhZl9fKSkKCiAgICAgICAgICAgICAgICAgICAgICA7CiMgNDYzICIvdXNyL2luY2x1ZGUvc3Rk aW8uaCIgMyA0CgoKCgoKCgoKZXh0ZXJuIGludCB2ZnNjYW5mIChGSUxFICpfX3Jlc3RyaWN0IF9f cywgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwKICAgICAgX19nbnVjX3ZhX2xpc3Qg
X19hcmcpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fZm9ybWF0X18gKF9fc2NhbmZfXywgMiwgMCkp KSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKCmV4dGVybiBp bnQgdnNjYW5mIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCBfX2dudWNfdmFfbGlz
dCBfX2FyZykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19mb3JtYXRfXyAoX19zY2FuZl9fLCAxLCAw KSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKZXh0ZXJuIGlu dCB2c3NjYW5mIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fcywKICAgICAgY29uc3QgY2hhciAq
X19yZXN0cmljdCBfX2Zvcm1hdCwgX19nbnVjX3ZhX2xpc3QgX19hcmcpCiAgICAgX19hdHRyaWJ1 dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19mb3JtYXRf XyAoX19zY2FuZl9fLCAyLCAwKSkpOwojIDQ5NCAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDMgNApl
eHRlcm4gaW50IHZmc2NhbmYgKEZJTEUgKl9fcmVzdHJpY3QgX19zLCBjb25zdCBjaGFyICpfX3Jl c3RyaWN0IF9fZm9ybWF0LCBfX2dudWNfdmFfbGlzdCBfX2FyZykgX19hc21fXyAoIiIgIl9faXNv Yzk5X3Zmc2NhbmYiKQoKCgogICAgIF9fYXR0cmlidXRlX18gKChfX2Zvcm1hdF9fIChfX3NjYW5m
X18sIDIsIDApKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0 ZXJuIGludCB2c2NhbmYgKGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsIF9fZ251Y192 YV9saXN0IF9fYXJnKSBfX2FzbV9fICgiIiAiX19pc29jOTlfdnNjYW5mIikKCiAgICAgX19hdHRy
aWJ1dGVfXyAoKF9fZm9ybWF0X18gKF9fc2NhbmZfXywgMSwgMCkpKSBfX2F0dHJpYnV0ZV9fICgo X193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gaW50IHZzc2NhbmYgKGNvbnN0IGNoYXIg Kl9fcmVzdHJpY3QgX19zLCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCBfX2dudWNf
dmFfbGlzdCBfX2FyZykgX19hc21fXyAoIiIgIl9faXNvYzk5X3Zzc2NhbmYiKSBfX2F0dHJpYnV0 ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpCgoKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9f Zm9ybWF0X18gKF9fc2NhbmZfXywgMiwgMCkpKTsKIyA1MjIgIi91c3IvaW5jbHVkZS9zdGRpby5o
IiAzIDQKCgoKCgoKCgoKZXh0ZXJuIGludCBmZ2V0YyAoRklMRSAqX19zdHJlYW0pOwpleHRlcm4g aW50IGdldGMgKEZJTEUgKl9fc3RyZWFtKTsKCgoKCgpleHRlcm4gaW50IGdldGNoYXIgKHZvaWQp OwoKIyA1NTAgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAzIDQKZXh0ZXJuIGludCBnZXRjX3VubG9j
a2VkIChGSUxFICpfX3N0cmVhbSk7CmV4dGVybiBpbnQgZ2V0Y2hhcl91bmxvY2tlZCAodm9pZCk7 CiMgNTYxICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CmV4dGVybiBpbnQgZmdldGNfdW5sb2Nr ZWQgKEZJTEUgKl9fc3RyZWFtKTsKCgoKCgoKCgoKCgpleHRlcm4gaW50IGZwdXRjIChpbnQgX19j
LCBGSUxFICpfX3N0cmVhbSk7CmV4dGVybiBpbnQgcHV0YyAoaW50IF9fYywgRklMRSAqX19zdHJl YW0pOwoKCgoKCmV4dGVybiBpbnQgcHV0Y2hhciAoaW50IF9fYyk7CgojIDU5NCAiL3Vzci9pbmNs dWRlL3N0ZGlvLmgiIDMgNApleHRlcm4gaW50IGZwdXRjX3VubG9ja2VkIChpbnQgX19jLCBGSUxF
ICpfX3N0cmVhbSk7CgoKCgoKCgpleHRlcm4gaW50IHB1dGNfdW5sb2NrZWQgKGludCBfX2MsIEZJ TEUgKl9fc3RyZWFtKTsKZXh0ZXJuIGludCBwdXRjaGFyX3VubG9ja2VkIChpbnQgX19jKTsKCgoK CgoKZXh0ZXJuIGludCBnZXR3IChGSUxFICpfX3N0cmVhbSk7CgoKZXh0ZXJuIGludCBwdXR3IChp
bnQgX193LCBGSUxFICpfX3N0cmVhbSk7CgoKCgoKCgoKZXh0ZXJuIGNoYXIgKmZnZXRzIChjaGFy ICpfX3Jlc3RyaWN0IF9fcywgaW50IF9fbiwgRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSkKICAg ICBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDY0MCAiL3Vzci9p
bmNsdWRlL3N0ZGlvLmgiIDMgNAoKIyA2NjUgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAzIDQKZXh0 ZXJuIF9fc3NpemVfdCBfX2dldGRlbGltIChjaGFyICoqX19yZXN0cmljdCBfX2xpbmVwdHIsCiAg ICAgICAgICBzaXplX3QgKl9fcmVzdHJpY3QgX19uLCBpbnQgX19kZWxpbWl0ZXIsCiAgICAgICAg
ICBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNl ZF9yZXN1bHRfXykpOwpleHRlcm4gX19zc2l6ZV90IGdldGRlbGltIChjaGFyICoqX19yZXN0cmlj dCBfX2xpbmVwdHIsCiAgICAgICAgc2l6ZV90ICpfX3Jlc3RyaWN0IF9fbiwgaW50IF9fZGVsaW1p
dGVyLAogICAgICAgIEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0pIF9fYXR0cmlidXRlX18gKChf X3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKCgpleHRlcm4gX19zc2l6ZV90IGdldGxpbmUg KGNoYXIgKipfX3Jlc3RyaWN0IF9fbGluZXB0ciwKICAgICAgIHNpemVfdCAqX19yZXN0cmljdCBf
X24sCiAgICAgICBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgoX193 YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKCgoKCmV4dGVybiBpbnQgZnB1dHMgKGNvbnN0IGNo YXIgKl9fcmVzdHJpY3QgX19zLCBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKTsKCgoKCgpleHRl
cm4gaW50IHB1dHMgKGNvbnN0IGNoYXIgKl9fcyk7CgoKCgoKCmV4dGVybiBpbnQgdW5nZXRjIChp bnQgX19jLCBGSUxFICpfX3N0cmVhbSk7CgoKCgoKCmV4dGVybiBzaXplX3QgZnJlYWQgKHZvaWQg Kl9fcmVzdHJpY3QgX19wdHIsIHNpemVfdCBfX3NpemUsCiAgICAgICBzaXplX3QgX19uLCBGSUxF
ICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1 bHRfXykpOwoKCgoKZXh0ZXJuIHNpemVfdCBmd3JpdGUgKGNvbnN0IHZvaWQgKl9fcmVzdHJpY3Qg X19wdHIsIHNpemVfdCBfX3NpemUsCiAgICAgICAgc2l6ZV90IF9fbiwgRklMRSAqX19yZXN0cmlj
dCBfX3MpOwoKIyA3MzcgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAzIDQKZXh0ZXJuIHNpemVfdCBm cmVhZF91bmxvY2tlZCAodm9pZCAqX19yZXN0cmljdCBfX3B0ciwgc2l6ZV90IF9fc2l6ZSwKICAg ICAgICAgc2l6ZV90IF9fbiwgRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSkgX19hdHRyaWJ1dGVf
XyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIHNpemVfdCBmd3JpdGVfdW5sb2Nr ZWQgKGNvbnN0IHZvaWQgKl9fcmVzdHJpY3QgX19wdHIsIHNpemVfdCBfX3NpemUsCiAgICAgICAg ICBzaXplX3QgX19uLCBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKTsKCgoKCgoKCgpleHRlcm4g
aW50IGZzZWVrIChGSUxFICpfX3N0cmVhbSwgbG9uZyBpbnQgX19vZmYsIGludCBfX3doZW5jZSk7 CgoKCgpleHRlcm4gbG9uZyBpbnQgZnRlbGwgKEZJTEUgKl9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9f ICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKZXh0ZXJuIHZvaWQgcmV3aW5kIChGSUxF
ICpfX3N0cmVhbSk7CgojIDc3MyAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDMgNApleHRlcm4gaW50 IGZzZWVrbyAoRklMRSAqX19zdHJlYW0sIF9fb2ZmX3QgX19vZmYsIGludCBfX3doZW5jZSk7CgoK CgpleHRlcm4gX19vZmZfdCBmdGVsbG8gKEZJTEUgKl9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgo
X193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDc5MiAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDMg NAoKCgoKCgpleHRlcm4gaW50IGZnZXRwb3MgKEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0sIGZw b3NfdCAqX19yZXN0cmljdCBfX3Bvcyk7CgoKCgpleHRlcm4gaW50IGZzZXRwb3MgKEZJTEUgKl9f
c3RyZWFtLCBjb25zdCBmcG9zX3QgKl9fcG9zKTsKIyA4MTUgIi91c3IvaW5jbHVkZS9zdGRpby5o IiAzIDQKCiMgODI0ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CgoKZXh0ZXJuIHZvaWQgY2xl YXJlcnIgKEZJTEUgKl9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl
YWZfXykpOwoKZXh0ZXJuIGludCBmZW9mIChGSUxFICpfX3N0cmVhbSkgX19hdHRyaWJ1dGVfXyAo KF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9y ZXN1bHRfXykpOwoKZXh0ZXJuIGludCBmZXJyb3IgKEZJTEUgKl9fc3RyZWFtKSBfX2F0dHJpYnV0
ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51 c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gdm9pZCBjbGVhcmVycl91bmxvY2tlZCAoRklMRSAq X19zdHJlYW0pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CmV4dGVy
biBpbnQgZmVvZl91bmxvY2tlZCAoRklMRSAqX19zdHJlYW0pIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0 X18pKTsKZXh0ZXJuIGludCBmZXJyb3JfdW5sb2NrZWQgKEZJTEUgKl9fc3RyZWFtKSBfX2F0dHJp
YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5f dW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKCgoKZXh0ZXJuIHZvaWQgcGVycm9yIChjb25zdCBjaGFy ICpfX3MpOwoKCgoKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3N5c19lcnJsaXN0LmgiIDEgMyA0
CiMgMjYgIi91c3IvaW5jbHVkZS9iaXRzL3N5c19lcnJsaXN0LmgiIDMgNApleHRlcm4gaW50IHN5 c19uZXJyOwpleHRlcm4gY29uc3QgY2hhciAqY29uc3Qgc3lzX2Vycmxpc3RbXTsKIyA4NTQgIi91 c3IvaW5jbHVkZS9zdGRpby5oIiAyIDMgNAoKCgoKZXh0ZXJuIGludCBmaWxlbm8gKEZJTEUgKl9f
c3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmli dXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gaW50IGZpbGVub191 bmxvY2tlZCAoRklMRSAqX19zdHJlYW0pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f
bGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKIyA4NzIg Ii91c3IvaW5jbHVkZS9zdGRpby5oIiAzIDQKZXh0ZXJuIEZJTEUgKnBvcGVuIChjb25zdCBjaGFy ICpfX2NvbW1hbmQsIGNvbnN0IGNoYXIgKl9fbW9kZXMpIF9fYXR0cmlidXRlX18gKChfX3dhcm5f
dW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKZXh0ZXJuIGludCBwY2xvc2UgKEZJTEUgKl9fc3RyZWFt KTsKCgoKCgpleHRlcm4gY2hhciAqY3Rlcm1pZCAoY2hhciAqX19zKSBfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpOwojIDkxMiAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDMg
NApleHRlcm4gdm9pZCBmbG9ja2ZpbGUgKEZJTEUgKl9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgpleHRlcm4gaW50IGZ0cnlsb2NrZmlsZSAoRklM RSAqX19zdHJlYW0pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19h
dHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgpleHRlcm4gdm9pZCBmdW5s b2NrZmlsZSAoRklMRSAqX19zdHJlYW0pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f bGVhZl9fKSk7CiMgOTMzICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CiMgMSAiL3Vzci9pbmNs
dWRlL2JpdHMvc3RkaW8uaCIgMSAzIDQKIyA0MyAiL3Vzci9pbmNsdWRlL2JpdHMvc3RkaW8uaCIg MyA0CmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBpbnQK Z2V0Y2hhciAodm9pZCkKewogIHJldHVybiBfSU9fZ2V0YyAoc3RkaW4pOwp9CgoKCgpleHRlcm4g
X19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgaW50CmZnZXRjX3VubG9j a2VkIChGSUxFICpfX2ZwKQp7CiAgcmV0dXJuIChfX2J1aWx0aW5fZXhwZWN0ICgoKF9fZnApLT5f SU9fcmVhZF9wdHIgPj0gKF9fZnApLT5fSU9fcmVhZF9lbmQpLCAwKSA/IF9fdWZsb3cgKF9fZnAp
IDogKih1bnNpZ25lZCBjaGFyICopIChfX2ZwKS0+X0lPX3JlYWRfcHRyKyspOwp9CgoKCgoKZXh0 ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGludApnZXRjX3Vu bG9ja2VkIChGSUxFICpfX2ZwKQp7CiAgcmV0dXJuIChfX2J1aWx0aW5fZXhwZWN0ICgoKF9fZnAp
LT5fSU9fcmVhZF9wdHIgPj0gKF9fZnApLT5fSU9fcmVhZF9lbmQpLCAwKSA/IF9fdWZsb3cgKF9f ZnApIDogKih1bnNpZ25lZCBjaGFyICopIChfX2ZwKS0+X0lPX3JlYWRfcHRyKyspOwp9CgoKZXh0 ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGludApnZXRjaGFy
X3VubG9ja2VkICh2b2lkKQp7CiAgcmV0dXJuIChfX2J1aWx0aW5fZXhwZWN0ICgoKHN0ZGluKS0+ X0lPX3JlYWRfcHRyID49IChzdGRpbiktPl9JT19yZWFkX2VuZCksIDApID8gX191ZmxvdyAoc3Rk aW4pIDogKih1bnNpZ25lZCBjaGFyICopIChzdGRpbiktPl9JT19yZWFkX3B0cisrKTsKfQoKCgoK
ZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGludApwdXRj aGFyIChpbnQgX19jKQp7CiAgcmV0dXJuIF9JT19wdXRjIChfX2MsIHN0ZG91dCk7Cn0KCgoKCmV4 dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBpbnQKZnB1dGNf
dW5sb2NrZWQgKGludCBfX2MsIEZJTEUgKl9fc3RyZWFtKQp7CiAgcmV0dXJuIChfX2J1aWx0aW5f ZXhwZWN0ICgoKF9fc3RyZWFtKS0+X0lPX3dyaXRlX3B0ciA+PSAoX19zdHJlYW0pLT5fSU9fd3Jp dGVfZW5kKSwgMCkgPyBfX292ZXJmbG93IChfX3N0cmVhbSwgKHVuc2lnbmVkIGNoYXIpIChfX2Mp
KSA6ICh1bnNpZ25lZCBjaGFyKSAoKihfX3N0cmVhbSktPl9JT193cml0ZV9wdHIrKyA9IChfX2Mp KSk7Cn0KCgoKCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9f KSkgaW50CnB1dGNfdW5sb2NrZWQgKGludCBfX2MsIEZJTEUgKl9fc3RyZWFtKQp7CiAgcmV0dXJu
IChfX2J1aWx0aW5fZXhwZWN0ICgoKF9fc3RyZWFtKS0+X0lPX3dyaXRlX3B0ciA+PSAoX19zdHJl YW0pLT5fSU9fd3JpdGVfZW5kKSwgMCkgPyBfX292ZXJmbG93IChfX3N0cmVhbSwgKHVuc2lnbmVk IGNoYXIpIChfX2MpKSA6ICh1bnNpZ25lZCBjaGFyKSAoKihfX3N0cmVhbSktPl9JT193cml0ZV9w
dHIrKyA9IChfX2MpKSk7Cn0KCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251 X2lubGluZV9fKSkgaW50CnB1dGNoYXJfdW5sb2NrZWQgKGludCBfX2MpCnsKICByZXR1cm4gKF9f YnVpbHRpbl9leHBlY3QgKCgoc3Rkb3V0KS0+X0lPX3dyaXRlX3B0ciA+PSAoc3Rkb3V0KS0+X0lP
X3dyaXRlX2VuZCksIDApID8gX19vdmVyZmxvdyAoc3Rkb3V0LCAodW5zaWduZWQgY2hhcikgKF9f YykpIDogKHVuc2lnbmVkIGNoYXIpICgqKHN0ZG91dCktPl9JT193cml0ZV9wdHIrKyA9IChfX2Mp KSk7Cn0KIyAxMjQgIi91c3IvaW5jbHVkZS9iaXRzL3N0ZGlvLmgiIDMgNApleHRlcm4gX19pbmxp
bmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgaW50Cl9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgZmVvZl91bmxvY2tlZCAoRklMRSAqX19zdHJlYW0pCnsK ICByZXR1cm4gKCgoX19zdHJlYW0pLT5fZmxhZ3MgJiAweDEwKSAhPSAwKTsKfQoKCmV4dGVybiBf
X2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBpbnQKX19hdHRyaWJ1dGVf XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBmZXJyb3JfdW5sb2NrZWQgKEZJTEUgKl9fc3Ry ZWFtKQp7CiAgcmV0dXJuICgoKF9fc3RyZWFtKS0+X2ZsYWdzICYgMHgyMCkgIT0gMCk7Cn0KIyA5
MzQgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAyIDMgNAoKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMv c3RkaW8yLmgiIDEgMyA0CiMgMjMgIi91c3IvaW5jbHVkZS9iaXRzL3N0ZGlvMi5oIiAzIDQKZXh0 ZXJuIGludCBfX3NwcmludGZfY2hrIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgaW50IF9fZmxhZywg
c2l6ZV90IF9fc2xlbiwKICAgICBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCAuLi4p IF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CmV4dGVybiBpbnQgX192 c3ByaW50Zl9jaGsgKGNoYXIgKl9fcmVzdHJpY3QgX19zLCBpbnQgX19mbGFnLCBzaXplX3QgX19z
bGVuLAogICAgICBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0LAogICAgICBfX2dudWNf dmFfbGlzdCBfX2FwKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoK CmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFs X18pKSBpbnQKX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBzcHJpbnRm IChjaGFyICpfX3Jlc3RyaWN0IF9fcywgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2ZtdCwgLi4u
KQp7CiAgcmV0dXJuIF9fYnVpbHRpbl9fX3NwcmludGZfY2hrIChfX3MsIDIgLSAxLAogICAgICBf X2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcywgMiA+IDEpLCBfX2ZtdCwgX19idWlsdGluX3ZhX2Fy Z19wYWNrICgpKTsKfQoKCgoKCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3
YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1 dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgaW50Cl9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs IF9fbGVhZl9fKSkgdnNwcmludGYgKGNoYXIgKl9fcmVzdHJpY3QgX19zLCBjb25zdCBjaGFyICpf
X3Jlc3RyaWN0IF9fZm10LCBfX2dudWNfdmFfbGlzdCBfX2FwKQoKewogIHJldHVybiBfX2J1aWx0 aW5fX192c3ByaW50Zl9jaGsgKF9fcywgMiAtIDEsCiAgICAgICBfX2J1aWx0aW5fb2JqZWN0X3Np emUgKF9fcywgMiA+IDEpLCBfX2ZtdCwgX19hcCk7Cn0KCgoKZXh0ZXJuIGludCBfX3NucHJpbnRm
X2NoayAoY2hhciAqX19yZXN0cmljdCBfX3MsIHNpemVfdCBfX24sIGludCBfX2ZsYWcsCiAgICAg IHNpemVfdCBfX3NsZW4sIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsCiAgICAgIC4u LikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKZXh0ZXJuIGludCBf
X3ZzbnByaW50Zl9jaGsgKGNoYXIgKl9fcmVzdHJpY3QgX19zLCBzaXplX3QgX19uLCBpbnQgX19m bGFnLAogICAgICAgc2l6ZV90IF9fc2xlbiwgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1h dCwKICAgICAgIF9fZ251Y192YV9saXN0IF9fYXApIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df
XyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5 c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl X18gKChfX2FydGlmaWNpYWxfXykpIGludApfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBf
X2xlYWZfXykpIHNucHJpbnRmIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fbiwgY29u c3QgY2hhciAqX19yZXN0cmljdCBfX2ZtdCwgLi4uKQoKewogIHJldHVybiBfX2J1aWx0aW5fX19z bnByaW50Zl9jaGsgKF9fcywgX19uLCAyIC0gMSwKICAgICAgIF9fYnVpbHRpbl9vYmplY3Rfc2l6
ZSAoX19zLCAyID4gMSksIF9fZm10LCBfX2J1aWx0aW5fdmFfYXJnX3BhY2sgKCkpOwp9CgoKCgoK CmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0 dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFs
X18pKSBpbnQKX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSB2c25wcmlu dGYgKGNoYXIgKl9fcmVzdHJpY3QgX19zLCBzaXplX3QgX19uLCBjb25zdCBjaGFyICpfX3Jlc3Ry aWN0IF9fZm10LCBfX2dudWNfdmFfbGlzdCBfX2FwKQoKewogIHJldHVybiBfX2J1aWx0aW5fX192
c25wcmludGZfY2hrIChfX3MsIF9fbiwgMiAtIDEsCiAgICAgICAgX19idWlsdGluX29iamVjdF9z aXplIChfX3MsIDIgPiAxKSwgX19mbXQsIF9fYXApOwp9CgoKCgoKZXh0ZXJuIGludCBfX2Zwcmlu dGZfY2hrIChGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtLCBpbnQgX19mbGFnLAogICAgIGNvbnN0
IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4uLik7CmV4dGVybiBpbnQgX19wcmludGZfY2hr IChpbnQgX19mbGFnLCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCAuLi4pOwpleHRl cm4gaW50IF9fdmZwcmludGZfY2hrIChGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtLCBpbnQgX19m
bGFnLAogICAgICBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCBfX2dudWNfdmFfbGlz dCBfX2FwKTsKZXh0ZXJuIGludCBfX3ZwcmludGZfY2hrIChpbnQgX19mbGFnLCBjb25zdCBjaGFy ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LAogICAgIF9fZ251Y192YV9saXN0IF9fYXApOwoKCmV4dGVy
biBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0 ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBp bnQKZnByaW50ZiAoRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSwgY29uc3QgY2hhciAqX19yZXN0
cmljdCBfX2ZtdCwgLi4uKQp7CiAgcmV0dXJuIF9fZnByaW50Zl9jaGsgKF9fc3RyZWFtLCAyIC0g MSwgX19mbXQsCiAgIF9fYnVpbHRpbl92YV9hcmdfcGFjayAoKSk7Cn0KCmV4dGVybiBfX2lubGlu ZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19n
bnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBpbnQKcHJpbnRm IChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm10LCAuLi4pCnsKICByZXR1cm4gX19wcmludGZf Y2hrICgyIC0gMSwgX19mbXQsIF9fYnVpbHRpbl92YV9hcmdfcGFjayAoKSk7Cn0KCgoKCgoKCmV4
dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJp YnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18p KSBpbnQKdnByaW50ZiAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2ZtdCwgX19nbnVjX3ZhX2xp
c3QgX19hcCkKewoKICByZXR1cm4gX192ZnByaW50Zl9jaGsgKHN0ZG91dCwgMiAtIDEsIF9fZm10 LCBfX2FwKTsKCgoKfQoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19p bmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18g
KChfX2FydGlmaWNpYWxfXykpIGludAp2ZnByaW50ZiAoRklMRSAqX19yZXN0cmljdCBfX3N0cmVh bSwKICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2ZtdCwgX19nbnVjX3ZhX2xpc3QgX19hcCkK ewogIHJldHVybiBfX3ZmcHJpbnRmX2NoayAoX19zdHJlYW0sIDIgLSAxLCBfX2ZtdCwgX19hcCk7
Cn0KCgpleHRlcm4gaW50IF9fZHByaW50Zl9jaGsgKGludCBfX2ZkLCBpbnQgX19mbGFnLCBjb25z dCBjaGFyICpfX3Jlc3RyaWN0IF9fZm10LAogICAgIC4uLikgX19hdHRyaWJ1dGVfXyAoKF9fZm9y bWF0X18gKF9fcHJpbnRmX18sIDMsIDQpKSk7CmV4dGVybiBpbnQgX192ZHByaW50Zl9jaGsgKGlu
dCBfX2ZkLCBpbnQgX19mbGFnLAogICAgICBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm10LCBf X2dudWNfdmFfbGlzdCBfX2FyZykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19mb3JtYXRfXyAoX19w cmludGZfXywgMywgMCkpKTsKCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3
YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1 dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgaW50CmRwcmludGYgKGludCBfX2ZkLCBjb25zdCBjaGFy ICpfX3Jlc3RyaWN0IF9fZm10LCAuLi4pCnsKICByZXR1cm4gX19kcHJpbnRmX2NoayAoX19mZCwg
MiAtIDEsIF9fZm10LAogICBfX2J1aWx0aW5fdmFfYXJnX3BhY2sgKCkpOwp9CgoKCgoKZXh0ZXJu IF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRl X18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGlu
dAp2ZHByaW50ZiAoaW50IF9fZmQsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mbXQsIF9fZ251 Y192YV9saXN0IF9fYXApCnsKICByZXR1cm4gX192ZHByaW50Zl9jaGsgKF9fZmQsIDIgLSAxLCBf X2ZtdCwgX19hcCk7Cn0KIyAyNDEgIi91c3IvaW5jbHVkZS9iaXRzL3N0ZGlvMi5oIiAzIDQKZXh0
ZXJuIGNoYXIgKl9fZmdldHNfY2hrIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fc2l6 ZSwgaW50IF9fbiwKICAgICBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9f ICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gY2hhciAqX19mZ2V0c19hbGlhcyAo
Y2hhciAqX19yZXN0cmljdCBfX3MsIGludCBfX24sIEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0p IF9fYXNtX18gKCIiICJmZ2V0cyIpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIGNo
YXIgKl9fZmdldHNfY2hrX3dhcm4gKGNoYXIgKl9fcmVzdHJpY3QgX19zLCBzaXplX3QgX19zaXpl LCBpbnQgX19uLCBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2FzbV9fICgiIiAiX19mZ2V0 c19jaGsiKQoKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBf
X2F0dHJpYnV0ZV9fKChfX3dhcm5pbmdfXyAoImZnZXRzIGNhbGxlZCB3aXRoIGJpZ2dlciBzaXpl IHRoYW4gbGVuZ3RoICIgIm9mIGRlc3RpbmF0aW9uIGJ1ZmZlciIpKSkKICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fs
d2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli dXRlX18gKChfX2FydGlmaWNpYWxfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jl c3VsdF9fKSkgY2hhciAqCmZnZXRzIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgaW50IF9fbiwgRklM
RSAqX19yZXN0cmljdCBfX3N0cmVhbSkKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9f cywgMiA+IDEpICE9IChzaXplX3QpIC0xKQogICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9jb25z dGFudF9wIChfX24pIHx8IF9fbiA8PSAwKQogcmV0dXJuIF9fZmdldHNfY2hrIChfX3MsIF9fYnVp
bHRpbl9vYmplY3Rfc2l6ZSAoX19zLCAyID4gMSksIF9fbiwgX19zdHJlYW0pOwoKICAgICAgaWYg KChzaXplX3QpIF9fbiA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19zLCAyID4gMSkpCiByZXR1 cm4gX19mZ2V0c19jaGtfd2FybiAoX19zLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcywgMiA+
IDEpLCBfX24sIF9fc3RyZWFtKTsKICAgIH0KICByZXR1cm4gX19mZ2V0c19hbGlhcyAoX19zLCBf X24sIF9fc3RyZWFtKTsKfQoKZXh0ZXJuIHNpemVfdCBfX2ZyZWFkX2NoayAodm9pZCAqX19yZXN0 cmljdCBfX3B0ciwgc2l6ZV90IF9fcHRybGVuLAogICAgICBzaXplX3QgX19zaXplLCBzaXplX3Qg
X19uLAogICAgICBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgoX193 YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gc2l6ZV90IF9fZnJlYWRfYWxpYXMgKHZvaWQg Kl9fcmVzdHJpY3QgX19wdHIsIHNpemVfdCBfX3NpemUsIHNpemVfdCBfX24sIEZJTEUgKl9fcmVz
dHJpY3QgX19zdHJlYW0pIF9fYXNtX18gKCIiICJmcmVhZCIpCgoKICAgICAgICAgICAgX19hdHRy aWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIHNpemVfdCBfX2ZyZWFk X2Noa193YXJuICh2b2lkICpfX3Jlc3RyaWN0IF9fcHRyLCBzaXplX3QgX19wdHJsZW4sIHNpemVf
dCBfX3NpemUsIHNpemVfdCBfX24sIEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0pIF9fYXNtX18g KCIiICJfX2ZyZWFkX2NoayIpCgoKCgogICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2Vk X3Jlc3VsdF9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuaW5nX18gKCJmcmVhZCBjYWxsZWQgd2l0
aCBiaWdnZXIgc2l6ZSAqIG5tZW1iIHRoYW4gbGVuZ3RoICIgIm9mIGRlc3RpbmF0aW9uIGJ1ZmZl ciIpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5l IF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIF9fYXR0cmlidXRl X18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgc2l6ZV90CmZyZWFkICh2b2lkICpfX3Jlc3Ry aWN0IF9fcHRyLCBzaXplX3QgX19zaXplLCBzaXplX3QgX19uLAogICAgICAgRklMRSAqX19yZXN0
cmljdCBfX3N0cmVhbSkKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcHRyLCAwKSAh PSAoc2l6ZV90KSAtMSkKICAgIHsKICAgICAgaWYgKCFfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19z aXplKQogICB8fCAhX19idWlsdGluX2NvbnN0YW50X3AgKF9fbikKICAgfHwgKF9fc2l6ZSB8IF9f
bikgPj0gKCgoc2l6ZV90KSAxKSA8PCAoOCAqIHNpemVvZiAoc2l6ZV90KSAvIDIpKSkKIHJldHVy biBfX2ZyZWFkX2NoayAoX19wdHIsIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19wdHIsIDApLCBf X3NpemUsIF9fbiwgX19zdHJlYW0pOwoKICAgICAgaWYgKF9fc2l6ZSAqIF9fbiA+IF9fYnVpbHRp
bl9vYmplY3Rfc2l6ZSAoX19wdHIsIDApKQogcmV0dXJuIF9fZnJlYWRfY2hrX3dhcm4gKF9fcHRy LCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcHRyLCAwKSwgX19zaXplLCBfX24sIF9fc3RyZWFt KTsKICAgIH0KICByZXR1cm4gX19mcmVhZF9hbGlhcyAoX19wdHIsIF9fc2l6ZSwgX19uLCBfX3N0
cmVhbSk7Cn0KIyAzMjcgIi91c3IvaW5jbHVkZS9iaXRzL3N0ZGlvMi5oIiAzIDQKZXh0ZXJuIHNp emVfdCBfX2ZyZWFkX3VubG9ja2VkX2NoayAodm9pZCAqX19yZXN0cmljdCBfX3B0ciwgc2l6ZV90 IF9fcHRybGVuLAogICAgICAgIHNpemVfdCBfX3NpemUsIHNpemVfdCBfX24sCiAgICAgICAgRklM
RSAqX19yZXN0cmljdCBfX3N0cmVhbSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVz dWx0X18pKTsKZXh0ZXJuIHNpemVfdCBfX2ZyZWFkX3VubG9ja2VkX2FsaWFzICh2b2lkICpfX3Jl c3RyaWN0IF9fcHRyLCBzaXplX3QgX19zaXplLCBzaXplX3QgX19uLCBGSUxFICpfX3Jlc3RyaWN0
IF9fc3RyZWFtKSBfX2FzbV9fICgiIiAiZnJlYWRfdW5sb2NrZWQiKQoKCiAgICAgICAgICAgICAg ICAgICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBz aXplX3QgX19mcmVhZF91bmxvY2tlZF9jaGtfd2FybiAodm9pZCAqX19yZXN0cmljdCBfX3B0ciwg
c2l6ZV90IF9fcHRybGVuLCBzaXplX3QgX19zaXplLCBzaXplX3QgX19uLCBGSUxFICpfX3Jlc3Ry aWN0IF9fc3RyZWFtKSBfX2FzbV9fICgiIiAiX19mcmVhZF91bmxvY2tlZF9jaGsiKQoKCgoKICAg ICBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIF9fYXR0cmlidXRlX18o
KF9fd2FybmluZ19fICgiZnJlYWRfdW5sb2NrZWQgY2FsbGVkIHdpdGggYmlnZ2VyIHNpemUgKiBu bWVtYiB0aGFuICIgImxlbmd0aCBvZiBkZXN0aW5hdGlvbiBidWZmZXIiKSkpCiAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1
dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9f KSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fy bl91bnVzZWRfcmVzdWx0X18pKSBzaXplX3QKZnJlYWRfdW5sb2NrZWQgKHZvaWQgKl9fcmVzdHJp
Y3QgX19wdHIsIHNpemVfdCBfX3NpemUsIHNpemVfdCBfX24sCiAgRklMRSAqX19yZXN0cmljdCBf X3N0cmVhbSkKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcHRyLCAwKSAhPSAoc2l6 ZV90KSAtMSkKICAgIHsKICAgICAgaWYgKCFfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19zaXplKQog
ICB8fCAhX19idWlsdGluX2NvbnN0YW50X3AgKF9fbikKICAgfHwgKF9fc2l6ZSB8IF9fbikgPj0g KCgoc2l6ZV90KSAxKSA8PCAoOCAqIHNpemVvZiAoc2l6ZV90KSAvIDIpKSkKIHJldHVybiBfX2Zy ZWFkX3VubG9ja2VkX2NoayAoX19wdHIsIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19wdHIsIDAp
LCBfX3NpemUsIF9fbiwKICAgICAgICAgX19zdHJlYW0pOwoKICAgICAgaWYgKF9fc2l6ZSAqIF9f biA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19wdHIsIDApKQogcmV0dXJuIF9fZnJlYWRfdW5s b2NrZWRfY2hrX3dhcm4gKF9fcHRyLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcHRyLCAwKSwg
X19zaXplLCBfX24sCiAgICAgICBfX3N0cmVhbSk7CiAgICB9CgoKICBpZiAoX19idWlsdGluX2Nv bnN0YW50X3AgKF9fc2l6ZSkKICAgICAgJiYgX19idWlsdGluX2NvbnN0YW50X3AgKF9fbikKICAg ICAgJiYgKF9fc2l6ZSB8IF9fbikgPCAoKChzaXplX3QpIDEpIDw8ICg4ICogc2l6ZW9mIChzaXpl
X3QpIC8gMikpCiAgICAgICYmIF9fc2l6ZSAqIF9fbiA8PSA4KQogICAgewogICAgICBzaXplX3Qg X19jbnQgPSBfX3NpemUgKiBfX247CiAgICAgIGNoYXIgKl9fY3B0ciA9IChjaGFyICopIF9fcHRy OwogICAgICBpZiAoX19jbnQgPT0gMCkKIHJldHVybiAwOwoKICAgICAgZm9yICg7IF9fY250ID4g
MDsgLS1fX2NudCkKIHsKICAgaW50IF9fYyA9IChfX2J1aWx0aW5fZXhwZWN0ICgoKF9fc3RyZWFt KS0+X0lPX3JlYWRfcHRyID49IChfX3N0cmVhbSktPl9JT19yZWFkX2VuZCksIDApID8gX191Zmxv dyAoX19zdHJlYW0pIDogKih1bnNpZ25lZCBjaGFyICopIChfX3N0cmVhbSktPl9JT19yZWFkX3B0
cisrKTsKICAgaWYgKF9fYyA9PSAoLTEpKQogICAgIGJyZWFrOwogICAqX19jcHRyKysgPSBfX2M7 CiB9CiAgICAgIHJldHVybiAoX19jcHRyIC0gKGNoYXIgKikgX19wdHIpIC8gX19zaXplOwogICAg fQoKICByZXR1cm4gX19mcmVhZF91bmxvY2tlZF9hbGlhcyAoX19wdHIsIF9fc2l6ZSwgX19uLCBf
X3N0cmVhbSk7Cn0KIyA5MzcgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAyIDMgNAoKCgoKCgojIDYw ICIuL2luY2x1ZGUvY29yZC5oIiAyCiMgOTQgIi4vaW5jbHVkZS9jb3JkLmgiCgojIDk0ICIuL2lu Y2x1ZGUvY29yZC5oIgp0eXBlZGVmIGNvbnN0IGNoYXIgKiBDT1JEOwojIDEwNCAiLi9pbmNsdWRl
L2NvcmQuaCIKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0Iikp KSBDT1JEIENPUkRfY2F0KENPUkQgeCwgQ09SRCB5KTsKCgoKCgoKZXh0ZXJuIF9fYXR0cmlidXRl X18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSBDT1JEIENPUkRfY2F0X2NoYXJfc3RhcihD
T1JEIHgsIGNvbnN0IGNoYXIgKiB5LCBzaXplX3QgbGVueSk7CgoKZXh0ZXJuIF9fYXR0cmlidXRl X18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSBzaXplX3QgQ09SRF9sZW4oQ09SRCB4KTsK Cgp0eXBlZGVmIGNoYXIgKCogQ09SRF9mbikoc2l6ZV90IGksIHZvaWQgKiBjbGllbnRfZGF0YSk7
CgoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSBDT1JE IENPUkRfZnJvbV9mbihDT1JEX2ZuIGZuLCB2b2lkICogY2xpZW50X2RhdGEsIHNpemVfdCBsZW4p OwoKCgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkpIENP
UkQgQ09SRF9zdWJzdHIoQ09SRCB4LCBzaXplX3QgaSwgc2l6ZV90IG4pOwojIDEzNCAiLi9pbmNs dWRlL2NvcmQuaCIKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0 IikpKSBDT1JEIENPUkRfYmFsYW5jZShDT1JEIHgpOwojIDE0MyAiLi9pbmNsdWRlL2NvcmQuaCIK
dHlwZWRlZiBpbnQgKCogQ09SRF9pdGVyX2ZuKShjaGFyIGMsIHZvaWQgKiBjbGllbnRfZGF0YSk7 CgoKCnR5cGVkZWYgaW50ICgqIENPUkRfYmF0Y2hlZF9pdGVyX2ZuKShjb25zdCBjaGFyICogcywg dm9pZCAqIGNsaWVudF9kYXRhKTsKIyAxNTggIi4vaW5jbHVkZS9jb3JkLmgiCmV4dGVybiBfX2F0
dHJpYnV0ZV9fKChfX3Zpc2liaWxpdHlfXygiZGVmYXVsdCIpKSkgaW50IENPUkRfaXRlcjUoQ09S RCB4LCBzaXplX3QgaSwgQ09SRF9pdGVyX2ZuIGYxLAogICAgICAgICAgICAgICAgICAgICAgICBD T1JEX2JhdGNoZWRfaXRlcl9mbiBmMiwgdm9pZCAqIGNsaWVudF9kYXRhKTsKCgpleHRlcm4gX19h
dHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkpIGludCBDT1JEX2l0ZXIoQ09S RCB4LCBDT1JEX2l0ZXJfZm4gZjEsIHZvaWQgKiBjbGllbnRfZGF0YSk7CgoKCgpleHRlcm4gX19h dHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkpIGludCBDT1JEX3JpdGVyNChD
T1JEIHgsIHNpemVfdCBpLCBDT1JEX2l0ZXJfZm4gZjEsIHZvaWQgKiBjbGllbnRfZGF0YSk7CgoK ZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSBpbnQgQ09S RF9yaXRlcihDT1JEIHgsIENPUkRfaXRlcl9mbiBmMSwgdm9pZCAqIGNsaWVudF9kYXRhKTsKIyAx
ODIgIi4vaW5jbHVkZS9jb3JkLmgiCiMgMSAiLi9pbmNsdWRlL2NvcmRfcG9zLmgiIDEKIyAyNyAi Li9pbmNsdWRlL2NvcmRfcG9zLmgiCnN0cnVjdCBDT1JEX3BlIHsKICAgIENPUkQgcGVfY29yZDsK ICAgIHNpemVfdCBwZV9zdGFydF9wb3M7Cn07CgoKCnR5cGVkZWYgc3RydWN0IENPUkRfUG9zIHsK
ICAgIHNpemVfdCBjdXJfcG9zOwogICAgaW50IHBhdGhfbGVuOwoKCiAgICBjb25zdCBjaGFyICpj dXJfbGVhZjsKCgoKCgoKICAgIHNpemVfdCBjdXJfc3RhcnQ7CiAgICBzaXplX3QgY3VyX2VuZDsK CiAgICBzdHJ1Y3QgQ09SRF9wZSBwYXRoWzQ4ICsgMV07CgoKCiAgICBjaGFyIGZ1bmN0aW9uX2J1
Zls4XTsKCn0gQ09SRF9wb3NbMV07CgoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fdmlzaWJpbGl0 eV9fKCJkZWZhdWx0IikpKSBDT1JEIENPUkRfcG9zX3RvX2NvcmQoQ09SRF9wb3MgcCk7CgoKZXh0 ZXJuIF9fYXR0cmlidXRlX18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSBzaXplX3QgQ09S
RF9wb3NfdG9faW5kZXgoQ09SRF9wb3MgcCk7CgoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fdmlz aWJpbGl0eV9fKCJkZWZhdWx0IikpKSBjaGFyIENPUkRfcG9zX2ZldGNoKENPUkRfcG9zIHApOwoK CgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkpIHZvaWQg
Q09SRF9zZXRfcG9zKENPUkRfcG9zIHAsIENPUkQgeCwgc2l6ZV90IGkpOwoKCgoKZXh0ZXJuIF9f YXR0cmlidXRlX18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSB2b2lkIENPUkRfbmV4dChD T1JEX3BvcyBwKTsKCgoKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX3Zpc2liaWxpdHlfXygiZGVm
YXVsdCIpKSkgdm9pZCBDT1JEX3ByZXYoQ09SRF9wb3MgcCk7CgoKZXh0ZXJuIF9fYXR0cmlidXRl X18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSBpbnQgQ09SRF9wb3NfdmFsaWQoQ09SRF9w b3MgcCk7CgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkp
IGNoYXIgQ09SRF9fcG9zX2ZldGNoKENPUkRfcG9zKTsKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9f dmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSB2b2lkIENPUkRfX25leHQoQ09SRF9wb3MpOwpleHRl cm4gX19hdHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkpIHZvaWQgQ09SRF9f
cHJldihDT1JEX3Bvcyk7CiMgMTgzICIuL2luY2x1ZGUvY29yZC5oIiAyCiMgMjIxICIuL2luY2x1 ZGUvY29yZC5oIgpleHRlcm4gdm9pZCAoKiBDT1JEX29vbV9mbikodm9pZCk7CgoKCmV4dGVybiBf X2F0dHJpYnV0ZV9fKChfX3Zpc2liaWxpdHlfXygiZGVmYXVsdCIpKSkgdm9pZCBDT1JEX2R1bXAo
Q09SRCB4KTsKCgoKCgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1 bHQiKSkpIENPUkQgQ09SRF9jYXRfY2hhcihDT1JEIHgsIGNoYXIgYyk7CgoKZXh0ZXJuIF9fYXR0 cmlidXRlX18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSBDT1JEIENPUkRfY2F0bihpbnQg
biwgLi4uKTsKCgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1bHQi KSkpIGNoYXIgQ09SRF9mZXRjaChDT1JEIHgsIHNpemVfdCBpKTsKCgpleHRlcm4gX19hdHRyaWJ1 dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkpIGludCBDT1JEX2NtcChDT1JEIHgsIENP
UkQgeSk7CgoKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX3Zpc2liaWxpdHlfXygiZGVmYXVsdCIp KSkgaW50IENPUkRfbmNtcChDT1JEIHgsIHNpemVfdCB4X3N0YXJ0LCBDT1JEIHksIHNpemVfdCB5 X3N0YXJ0LAogICAgICAgICAgICAgICAgICAgICAgIHNpemVfdCBsZW4pOwoKCgoKZXh0ZXJuIF9f
YXR0cmlidXRlX18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSBzaXplX3QgQ09SRF9zdHIo Q09SRCB4LCBzaXplX3Qgc3RhcnQsIENPUkQgcyk7CgoKCgpleHRlcm4gX19hdHRyaWJ1dGVfXygo X192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkpIENPUkQgQ09SRF9jaGFycyhjaGFyIGMsIHNpemVf
dCBpKTsKIyAyNzQgIi4vaW5jbHVkZS9jb3JkLmgiCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX3Zp c2liaWxpdHlfXygiZGVmYXVsdCIpKSkgQ09SRCBDT1JEX2Zyb21fZmlsZShGSUxFICogZik7CgoK CgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkpIENPUkQg
Q09SRF9mcm9tX2ZpbGVfZWFnZXIoRklMRSAqIGYpOwoKCgpleHRlcm4gX19hdHRyaWJ1dGVfXygo X192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkpIENPUkQgQ09SRF9mcm9tX2ZpbGVfbGF6eShGSUxF ICogZik7CgoKCmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX3Zpc2liaWxpdHlfXygiZGVmYXVsdCIp
KSkgY2hhciAqIENPUkRfdG9fY2hhcl9zdGFyKENPUkQgeCk7CgoKCmV4dGVybiBfX2F0dHJpYnV0 ZV9fKChfX3Zpc2liaWxpdHlfXygiZGVmYXVsdCIpKSkgQ09SRCBDT1JEX2Zyb21fY2hhcl9zdGFy KGNvbnN0IGNoYXIgKnMpOwoKCgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18o
ImRlZmF1bHQiKSkpIGNvbnN0IGNoYXIgKiBDT1JEX3RvX2NvbnN0X2NoYXJfc3RhcihDT1JEIHgp OwoKCgoKZXh0ZXJuIF9fYXR0cmlidXRlX18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSBp bnQgQ09SRF9wdXQoQ09SRCB4LCBGSUxFICogZik7CgoKCgoKCgpleHRlcm4gX19hdHRyaWJ1dGVf
XygoX192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkpIHNpemVfdCBDT1JEX2NocihDT1JEIHgsIHNp emVfdCBpLCBpbnQgYyk7CgoKCgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18o ImRlZmF1bHQiKSkpIHNpemVfdCBDT1JEX3JjaHIoQ09SRCB4LCBzaXplX3QgaSwgaW50IGMpOwoj
IDM0MyAiLi9pbmNsdWRlL2NvcmQuaCIKIyAxICIvdXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0LWxp bnV4LzYuMC4wL2luY2x1ZGUvc3RkYXJnLmgiIDEgMyA0CiMgMzQ0ICIuL2luY2x1ZGUvY29yZC5o IiAyCgpleHRlcm4gX19hdHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1bHQiKSkpIGlu
dCBDT1JEX3NwcmludGYoQ09SRCAqIG91dCwgQ09SRCBmb3JtYXQsIC4uLik7CmV4dGVybiBfX2F0 dHJpYnV0ZV9fKChfX3Zpc2liaWxpdHlfXygiZGVmYXVsdCIpKSkgaW50IENPUkRfdnNwcmludGYo Q09SRCAqIG91dCwgQ09SRCBmb3JtYXQsIHZhX2xpc3QgYXJncyk7CmV4dGVybiBfX2F0dHJpYnV0
ZV9fKChfX3Zpc2liaWxpdHlfXygiZGVmYXVsdCIpKSkgaW50IENPUkRfZnByaW50ZihGSUxFICog ZiwgQ09SRCBmb3JtYXQsIC4uLik7CmV4dGVybiBfX2F0dHJpYnV0ZV9fKChfX3Zpc2liaWxpdHlf XygiZGVmYXVsdCIpKSkgaW50IENPUkRfdmZwcmludGYoRklMRSAqIGYsIENPUkQgZm9ybWF0LCB2
YV9saXN0IGFyZ3MpOwpleHRlcm4gX19hdHRyaWJ1dGVfXygoX192aXNpYmlsaXR5X18oImRlZmF1 bHQiKSkpIGludCBDT1JEX3ByaW50ZihDT1JEIGZvcm1hdCwgLi4uKTsKZXh0ZXJuIF9fYXR0cmli dXRlX18oKF9fdmlzaWJpbGl0eV9fKCJkZWZhdWx0IikpKSBpbnQgQ09SRF92cHJpbnRmKENPUkQg
Zm9ybWF0LCB2YV9saXN0IGFyZ3MpOwojIDIzICJjb3JkL2NvcmRic2NzLmMiIDIKIyAxICIvdXNy L2luY2x1ZGUvc3RkbGliLmgiIDEgMyA0CiMgMzIgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMyA0 CiMgMSAiL3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51eC82LjAuMC9pbmNsdWRlL3N0ZGRl
Zi5oIiAxIDMgNAojIDMzICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDIgMyA0CgoKCgoKCgoKIyAx ICIvdXNyL2luY2x1ZGUvYml0cy93YWl0ZmxhZ3MuaCIgMSAzIDQKIyA0MiAiL3Vzci9pbmNsdWRl L3N0ZGxpYi5oIiAyIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3dhaXRzdGF0dXMuaCIgMSAz
IDQKIyA2NiAiL3Vzci9pbmNsdWRlL2JpdHMvd2FpdHN0YXR1cy5oIiAzIDQKCiMgNjYgIi91c3Iv aW5jbHVkZS9iaXRzL3dhaXRzdGF0dXMuaCIgMyA0CnVuaW9uIHdhaXQKICB7CiAgICBpbnQgd19z dGF0dXM7CiAgICBzdHJ1Y3QKICAgICAgewoKCgoKCgoKIHVuc2lnbmVkIGludDoxNjsKIHVuc2ln
bmVkIGludCBfX3dfcmV0Y29kZTo4OwogdW5zaWduZWQgaW50IF9fd19jb3JlZHVtcDoxOwogdW5z aWduZWQgaW50IF9fd190ZXJtc2lnOjc7CgogICAgICB9IF9fd2FpdF90ZXJtaW5hdGVkOwogICAg c3RydWN0CiAgICAgIHsKCgoKCgoKIHVuc2lnbmVkIGludDoxNjsKIHVuc2lnbmVkIGludCBfX3df
c3RvcHNpZzo4OwogdW5zaWduZWQgaW50IF9fd19zdG9wdmFsOjg7CgogICAgICB9IF9fd2FpdF9z dG9wcGVkOwogIH07CiMgNDMgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMiAzIDQKIyA2NyAiL3Vz ci9pbmNsdWRlL3N0ZGxpYi5oIiAzIDQKdHlwZWRlZiB1bmlvbgogIHsKICAgIHVuaW9uIHdhaXQg
Kl9fdXB0cjsKICAgIGludCAqX19pcHRyOwogIH0gX19XQUlUX1NUQVRVUyBfX2F0dHJpYnV0ZV9f ICgoX190cmFuc3BhcmVudF91bmlvbl9fKSk7CiMgOTUgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIg MyA0CgoKdHlwZWRlZiBzdHJ1Y3QKICB7CiAgICBpbnQgcXVvdDsKICAgIGludCByZW07CiAgfSBk
aXZfdDsKCgoKdHlwZWRlZiBzdHJ1Y3QKICB7CiAgICBsb25nIGludCBxdW90OwogICAgbG9uZyBp bnQgcmVtOwogIH0gbGRpdl90OwoKCgoKCgoKX19leHRlbnNpb25fXyB0eXBlZGVmIHN0cnVjdAog IHsKICAgIGxvbmcgbG9uZyBpbnQgcXVvdDsKICAgIGxvbmcgbG9uZyBpbnQgcmVtOwogIH0gbGxk
aXZfdDsKCgojIDEzOSAiL3Vzci9pbmNsdWRlL3N0ZGxpYi5oIiAzIDQKZXh0ZXJuIHNpemVfdCBf X2N0eXBlX2dldF9tYl9jdXJfbWF4ICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18g LCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoK
CgpleHRlcm4gZG91YmxlIGF0b2YgKGNvbnN0IGNoYXIgKl9fbnB0cikKICAgICBfX2F0dHJpYnV0 ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykp IF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJu
X3VudXNlZF9yZXN1bHRfXykpOwoKZXh0ZXJuIGludCBhdG9pIChjb25zdCBjaGFyICpfX25wdHIp CiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0 ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSkgX19hdHRy
aWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCmV4dGVybiBsb25nIGludCBhdG9s IChjb25zdCBjaGFyICpfX25wdHIpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg X19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19u
b25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsK CgoKCgpfX2V4dGVuc2lvbl9fIGV4dGVybiBsb25nIGxvbmcgaW50IGF0b2xsIChjb25zdCBjaGFy ICpfX25wdHIpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBf
X2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEp KSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCgpleHRlcm4g ZG91YmxlIHN0cnRvZCAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX25wdHIsCiAgICAgICAgY2hh
ciAqKl9fcmVzdHJpY3QgX19lbmRwdHIpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19f ICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoKZXh0 ZXJuIGZsb2F0IHN0cnRvZiAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX25wdHIsCiAgICAgICBj
aGFyICoqX19yZXN0cmljdCBfX2VuZHB0cikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg X19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgpleHRlcm4gbG9u ZyBkb3VibGUgc3RydG9sZCAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX25wdHIsCiAgICAgICBj
aGFyICoqX19yZXN0cmljdCBfX2VuZHB0cikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93 X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoKCgpl eHRlcm4gbG9uZyBpbnQgc3RydG9sIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fbnB0ciwKICAg
Y2hhciAqKl9fcmVzdHJpY3QgX19lbmRwdHIsIGludCBfX2Jhc2UpCiAgICAgX19hdHRyaWJ1dGVf XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g KDEpKSk7CgpleHRlcm4gdW5zaWduZWQgbG9uZyBpbnQgc3RydG91bCAoY29uc3QgY2hhciAqX19y
ZXN0cmljdCBfX25wdHIsCiAgICAgIGNoYXIgKipfX3Jlc3RyaWN0IF9fZW5kcHRyLCBpbnQgX19i YXNlKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRy aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKX19leHRlbnNpb25fXwpleHRlcm4gbG9u
ZyBsb25nIGludCBzdHJ0b3EgKGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19ucHRyLAogICAgICAg IGNoYXIgKipfX3Jlc3RyaWN0IF9fZW5kcHRyLCBpbnQgX19iYXNlKQogICAgIF9fYXR0cmlidXRl X18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgxKSkpOwoKX19leHRlbnNpb25fXwpleHRlcm4gdW5zaWduZWQgbG9uZyBsb25nIGludCBzdHJ0 b3VxIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fbnB0ciwKICAgICAgICAgICBjaGFyICoqX19y ZXN0cmljdCBfX2VuZHB0ciwgaW50IF9fYmFzZSkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro
cm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoK CgpfX2V4dGVuc2lvbl9fCmV4dGVybiBsb25nIGxvbmcgaW50IHN0cnRvbGwgKGNvbnN0IGNoYXIg Kl9fcmVzdHJpY3QgX19ucHRyLAogICAgICAgICBjaGFyICoqX19yZXN0cmljdCBfX2VuZHB0ciwg
aW50IF9fYmFzZSkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykp IF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCl9fZXh0ZW5zaW9uX18KZXh0ZXJu IHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgc3RydG91bGwgKGNvbnN0IGNoYXIgKl9fcmVzdHJpY3Qg
X19ucHRyLAogICAgIGNoYXIgKipfX3Jlc3RyaWN0IF9fZW5kcHRyLCBpbnQgX19iYXNlKQogICAg IF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAo KF9fbm9ubnVsbF9fICgxKSkpOwoKIyAyNzYgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMyA0Cgpl
eHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgaW50Cl9fYXR0 cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgYXRvaSAoY29uc3QgY2hhciAqX19u cHRyKQp7CiAgcmV0dXJuIChpbnQpIHN0cnRvbCAoX19ucHRyLCAoY2hhciAqKikgKCh2b2lkICop
MCksIDEwKTsKfQpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9f KSkgbG9uZyBpbnQKX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBhdG9s IChjb25zdCBjaGFyICpfX25wdHIpCnsKICByZXR1cm4gc3RydG9sIChfX25wdHIsIChjaGFyICoq
KSAoKHZvaWQgKikwKSwgMTApOwp9CgoKCgpfX2V4dGVuc2lvbl9fIGV4dGVybiBfX2lubGluZSBf X2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBsb25nIGxvbmcgaW50Cl9fYXR0cmlidXRl X18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgYXRvbGwgKGNvbnN0IGNoYXIgKl9fbnB0cikK
ewogIHJldHVybiBzdHJ0b2xsIChfX25wdHIsIChjaGFyICoqKSAoKHZvaWQgKikwKSwgMTApOwp9 CgojIDMwNSAiL3Vzci9pbmNsdWRlL3N0ZGxpYi5oIiAzIDQKZXh0ZXJuIGNoYXIgKmw2NGEgKGxv bmcgaW50IF9fbikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0
dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCmV4dGVybiBsb25nIGludCBh NjRsIChjb25zdCBjaGFyICpfX3MpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg X19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19u
b25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsK CgoKCiMgMSAiL3Vzci9pbmNsdWRlL3N5cy90eXBlcy5oIiAxIDMgNAojIDI3ICIvdXNyL2luY2x1 ZGUvc3lzL3R5cGVzLmgiIDMgNAoKCgoKCgp0eXBlZGVmIF9fdV9jaGFyIHVfY2hhcjsKdHlwZWRl
ZiBfX3Vfc2hvcnQgdV9zaG9ydDsKdHlwZWRlZiBfX3VfaW50IHVfaW50Owp0eXBlZGVmIF9fdV9s b25nIHVfbG9uZzsKdHlwZWRlZiBfX3F1YWRfdCBxdWFkX3Q7CnR5cGVkZWYgX191X3F1YWRfdCB1 X3F1YWRfdDsKdHlwZWRlZiBfX2ZzaWRfdCBmc2lkX3Q7CgoKCgp0eXBlZGVmIF9fbG9mZl90IGxv
ZmZfdDsKCgoKdHlwZWRlZiBfX2lub190IGlub190OwojIDYwICIvdXNyL2luY2x1ZGUvc3lzL3R5 cGVzLmgiIDMgNAp0eXBlZGVmIF9fZGV2X3QgZGV2X3Q7CgoKCgp0eXBlZGVmIF9fZ2lkX3QgZ2lk X3Q7CgoKCgp0eXBlZGVmIF9fbW9kZV90IG1vZGVfdDsKCgoKCnR5cGVkZWYgX19ubGlua190IG5s
aW5rX3Q7CiMgMTA0ICIvdXNyL2luY2x1ZGUvc3lzL3R5cGVzLmgiIDMgNAp0eXBlZGVmIF9faWRf dCBpZF90OwojIDExNSAiL3Vzci9pbmNsdWRlL3N5cy90eXBlcy5oIiAzIDQKdHlwZWRlZiBfX2Rh ZGRyX3QgZGFkZHJfdDsKdHlwZWRlZiBfX2NhZGRyX3QgY2FkZHJfdDsKCgoKCgp0eXBlZGVmIF9f
a2V5X3Qga2V5X3Q7CiMgMTQ2ICIvdXNyL2luY2x1ZGUvc3lzL3R5cGVzLmgiIDMgNAojIDEgIi91 c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVkZS9zdGRkZWYuaCIgMSAz IDQKIyAxNDcgIi91c3IvaW5jbHVkZS9zeXMvdHlwZXMuaCIgMiAzIDQKCgoKdHlwZWRlZiB1bnNp
Z25lZCBsb25nIGludCB1bG9uZzsKdHlwZWRlZiB1bnNpZ25lZCBzaG9ydCBpbnQgdXNob3J0Owp0 eXBlZGVmIHVuc2lnbmVkIGludCB1aW50OwojIDE5NCAiL3Vzci9pbmNsdWRlL3N5cy90eXBlcy5o IiAzIDQKdHlwZWRlZiBpbnQgaW50OF90IF9fYXR0cmlidXRlX18gKChfX21vZGVfXyAoX19RSV9f
KSkpOwp0eXBlZGVmIGludCBpbnQxNl90IF9fYXR0cmlidXRlX18gKChfX21vZGVfXyAoX19ISV9f KSkpOwp0eXBlZGVmIGludCBpbnQzMl90IF9fYXR0cmlidXRlX18gKChfX21vZGVfXyAoX19TSV9f KSkpOwp0eXBlZGVmIGludCBpbnQ2NF90IF9fYXR0cmlidXRlX18gKChfX21vZGVfXyAoX19ESV9f
KSkpOwoKCnR5cGVkZWYgdW5zaWduZWQgaW50IHVfaW50OF90IF9fYXR0cmlidXRlX18gKChfX21v ZGVfXyAoX19RSV9fKSkpOwp0eXBlZGVmIHVuc2lnbmVkIGludCB1X2ludDE2X3QgX19hdHRyaWJ1 dGVfXyAoKF9fbW9kZV9fIChfX0hJX18pKSk7CnR5cGVkZWYgdW5zaWduZWQgaW50IHVfaW50MzJf
dCBfX2F0dHJpYnV0ZV9fICgoX19tb2RlX18gKF9fU0lfXykpKTsKdHlwZWRlZiB1bnNpZ25lZCBp bnQgdV9pbnQ2NF90IF9fYXR0cmlidXRlX18gKChfX21vZGVfXyAoX19ESV9fKSkpOwoKdHlwZWRl ZiBpbnQgcmVnaXN0ZXJfdCBfX2F0dHJpYnV0ZV9fICgoX19tb2RlX18gKF9fd29yZF9fKSkpOwoj
IDIxOSAiL3Vzci9pbmNsdWRlL3N5cy90eXBlcy5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvc3lz L3NlbGVjdC5oIiAxIDMgNAojIDMwICIvdXNyL2luY2x1ZGUvc3lzL3NlbGVjdC5oIiAzIDQKIyAx ICIvdXNyL2luY2x1ZGUvYml0cy9zZWxlY3QuaCIgMSAzIDQKIyAzMSAiL3Vzci9pbmNsdWRlL3N5
cy9zZWxlY3QuaCIgMiAzIDQKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3NpZ3NldC5oIiAxIDMg NAojIDM0ICIvdXNyL2luY2x1ZGUvc3lzL3NlbGVjdC5oIiAyIDMgNAojIDQ1ICIvdXNyL2luY2x1 ZGUvc3lzL3NlbGVjdC5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy90aW1lLmgiIDEgMyA0
CiMgMzAgIi91c3IvaW5jbHVkZS9iaXRzL3RpbWUuaCIgMyA0CnN0cnVjdCB0aW1ldmFsCiAgewog ICAgX190aW1lX3QgdHZfc2VjOwogICAgX19zdXNlY29uZHNfdCB0dl91c2VjOwogIH07CiMgNDYg Ii91c3IvaW5jbHVkZS9zeXMvc2VsZWN0LmgiIDIgMyA0CgoKdHlwZWRlZiBfX3N1c2Vjb25kc190
IHN1c2Vjb25kc190OwoKCgoKCnR5cGVkZWYgbG9uZyBpbnQgX19mZF9tYXNrOwojIDY0ICIvdXNy L2luY2x1ZGUvc3lzL3NlbGVjdC5oIiAzIDQKdHlwZWRlZiBzdHJ1Y3QKICB7CgoKCgoKCiAgICBf X2ZkX21hc2sgX19mZHNfYml0c1sxMDI0IC8gKDggKiAoaW50KSBzaXplb2YgKF9fZmRfbWFzaykp
XTsKCgogIH0gZmRfc2V0OwoKCgoKCgp0eXBlZGVmIF9fZmRfbWFzayBmZF9tYXNrOwojIDk2ICIv dXNyL2luY2x1ZGUvc3lzL3NlbGVjdC5oIiAzIDQKCiMgMTA2ICIvdXNyL2luY2x1ZGUvc3lzL3Nl bGVjdC5oIiAzIDQKZXh0ZXJuIGludCBzZWxlY3QgKGludCBfX25mZHMsIGZkX3NldCAqX19yZXN0
cmljdCBfX3JlYWRmZHMsCiAgICAgZmRfc2V0ICpfX3Jlc3RyaWN0IF9fd3JpdGVmZHMsCiAgICAg ZmRfc2V0ICpfX3Jlc3RyaWN0IF9fZXhjZXB0ZmRzLAogICAgIHN0cnVjdCB0aW1ldmFsICpfX3Jl c3RyaWN0IF9fdGltZW91dCk7CiMgMTE4ICIvdXNyL2luY2x1ZGUvc3lzL3NlbGVjdC5oIiAzIDQK
ZXh0ZXJuIGludCBwc2VsZWN0IChpbnQgX19uZmRzLCBmZF9zZXQgKl9fcmVzdHJpY3QgX19yZWFk ZmRzLAogICAgICBmZF9zZXQgKl9fcmVzdHJpY3QgX193cml0ZWZkcywKICAgICAgZmRfc2V0ICpf X3Jlc3RyaWN0IF9fZXhjZXB0ZmRzLAogICAgICBjb25zdCBzdHJ1Y3QgdGltZXNwZWMgKl9fcmVz
dHJpY3QgX190aW1lb3V0LAogICAgICBjb25zdCBfX3NpZ3NldF90ICpfX3Jlc3RyaWN0IF9fc2ln bWFzayk7CgoKCgoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9zZWxlY3QyLmgiIDEgMyA0CiMgMjQg Ii91c3IvaW5jbHVkZS9iaXRzL3NlbGVjdDIuaCIgMyA0CmV4dGVybiBsb25nIGludCBfX2ZkZWx0
X2NoayAobG9uZyBpbnQgX19kKTsKZXh0ZXJuIGxvbmcgaW50IF9fZmRlbHRfd2FybiAobG9uZyBp bnQgX19kKQogIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgiYml0IG91dHNpZGUgb2YgZmRf c2V0IHNlbGVjdGVkIikpKTsKIyAxMjkgIi91c3IvaW5jbHVkZS9zeXMvc2VsZWN0LmgiIDIgMyA0
CgoKCiMgMjIwICIvdXNyL2luY2x1ZGUvc3lzL3R5cGVzLmgiIDIgMyA0CgoKIyAxICIvdXNyL2lu Y2x1ZGUvc3lzL3N5c21hY3Jvcy5oIiAxIDMgNAojIDI0ICIvdXNyL2luY2x1ZGUvc3lzL3N5c21h Y3Jvcy5oIiAzIDQKCgpfX2V4dGVuc2lvbl9fCmV4dGVybiB1bnNpZ25lZCBpbnQgZ251X2Rldl9t
YWpvciAodW5zaWduZWQgbG9uZyBsb25nIGludCBfX2RldikKICAgICBfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0X18pKTsKX19l eHRlbnNpb25fXwpleHRlcm4gdW5zaWduZWQgaW50IGdudV9kZXZfbWlub3IgKHVuc2lnbmVkIGxv
bmcgbG9uZyBpbnQgX19kZXYpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19s ZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSk7Cl9fZXh0ZW5zaW9uX18KZXh0ZXJu IHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgZ251X2Rldl9tYWtlZGV2ICh1bnNpZ25lZCBpbnQgX19t
YWpvciwKICAgICAgICAgICAgdW5zaWduZWQgaW50IF9fbWlub3IpCiAgICAgX19hdHRyaWJ1dGVf XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSk7 CgoKX19leHRlbnNpb25fXyBleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fY29uc3RfXykpIHVuc2lnbmVkIGludApfX2F0dHJp YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIGdudV9kZXZfbWFqb3IgKHVuc2lnbmVk IGxvbmcgbG9uZyBpbnQgX19kZXYpCnsKICByZXR1cm4gKChfX2RldiA+PiA4KSAmIDB4ZmZmKSB8
ICgodW5zaWduZWQgaW50KSAoX19kZXYgPj4gMzIpICYgfjB4ZmZmKTsKfQoKX19leHRlbnNpb25f XyBleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRy aWJ1dGVfXyAoKF9fY29uc3RfXykpIHVuc2lnbmVkIGludApfX2F0dHJpYnV0ZV9fICgoX19ub3Ro
cm93X18gLCBfX2xlYWZfXykpIGdudV9kZXZfbWlub3IgKHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQg X19kZXYpCnsKICByZXR1cm4gKF9fZGV2ICYgMHhmZikgfCAoKHVuc2lnbmVkIGludCkgKF9fZGV2 ID4+IDEyKSAmIH4weGZmKTsKfQoKX19leHRlbnNpb25fXyBleHRlcm4gX19pbmxpbmUgX19hdHRy
aWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fY29uc3RfXykpIHVu c2lnbmVkIGxvbmcgbG9uZyBpbnQKX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFm X18pKSBnbnVfZGV2X21ha2VkZXYgKHVuc2lnbmVkIGludCBfX21ham9yLCB1bnNpZ25lZCBpbnQg
X19taW5vcikKewogIHJldHVybiAoKF9fbWlub3IgJiAweGZmKSB8ICgoX19tYWpvciAmIDB4ZmZm KSA8PCA4KQogICB8ICgoKHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQpIChfX21pbm9yICYgfjB4ZmYp KSA8PCAxMikKICAgfCAoKCh1bnNpZ25lZCBsb25nIGxvbmcgaW50KSAoX19tYWpvciAmIH4weGZm
ZikpIDw8IDMyKSk7Cn0KCgojIDIyMyAiL3Vzci9pbmNsdWRlL3N5cy90eXBlcy5oIiAyIDMgNAoK CgoKCnR5cGVkZWYgX19ibGtzaXplX3QgYmxrc2l6ZV90OwoKCgoKCgp0eXBlZGVmIF9fYmxrY250 X3QgYmxrY250X3Q7CgoKCnR5cGVkZWYgX19mc2Jsa2NudF90IGZzYmxrY250X3Q7CgoKCnR5cGVk
ZWYgX19mc2ZpbGNudF90IGZzZmlsY250X3Q7CiMgMjczICIvdXNyL2luY2x1ZGUvc3lzL3R5cGVz LmgiIDMgNAoKIyAzMTUgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMiAzIDQKCgoKCgoKZXh0ZXJu IGxvbmcgaW50IHJhbmRvbSAodm9pZCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19s
ZWFmX18pKTsKCgpleHRlcm4gdm9pZCBzcmFuZG9tICh1bnNpZ25lZCBpbnQgX19zZWVkKSBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKCmV4dGVybiBjaGFyICpp bml0c3RhdGUgKHVuc2lnbmVkIGludCBfX3NlZWQsIGNoYXIgKl9fc3RhdGVidWYsCiAgIHNpemVf
dCBfX3N0YXRlbGVuKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9f YXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMikpKTsKCgoKZXh0ZXJuIGNoYXIgKnNldHN0YXRl IChjaGFyICpfX3N0YXRlYnVmKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZf
XykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoKCgoKCnN0cnVjdCByYW5k b21fZGF0YQogIHsKICAgIGludDMyX3QgKmZwdHI7CiAgICBpbnQzMl90ICpycHRyOwogICAgaW50 MzJfdCAqc3RhdGU7CiAgICBpbnQgcmFuZF90eXBlOwogICAgaW50IHJhbmRfZGVnOwogICAgaW50
IHJhbmRfc2VwOwogICAgaW50MzJfdCAqZW5kX3B0cjsKICB9OwoKZXh0ZXJuIGludCByYW5kb21f ciAoc3RydWN0IHJhbmRvbV9kYXRhICpfX3Jlc3RyaWN0IF9fYnVmLAogICAgICAgaW50MzJfdCAq X19yZXN0cmljdCBfX3Jlc3VsdCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFm
X18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgpleHRlcm4gaW50IHNy YW5kb21fciAodW5zaWduZWQgaW50IF9fc2VlZCwgc3RydWN0IHJhbmRvbV9kYXRhICpfX2J1ZikK ICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRl
X18gKChfX25vbm51bGxfXyAoMikpKTsKCmV4dGVybiBpbnQgaW5pdHN0YXRlX3IgKHVuc2lnbmVk IGludCBfX3NlZWQsIGNoYXIgKl9fcmVzdHJpY3QgX19zdGF0ZWJ1ZiwKICAgc2l6ZV90IF9fc3Rh dGVsZW4sCiAgIHN0cnVjdCByYW5kb21fZGF0YSAqX19yZXN0cmljdCBfX2J1ZikKICAgICBfX2F0
dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25v bm51bGxfXyAoMiwgNCkpKTsKCmV4dGVybiBpbnQgc2V0c3RhdGVfciAoY2hhciAqX19yZXN0cmlj dCBfX3N0YXRlYnVmLAogICAgICAgICBzdHJ1Y3QgcmFuZG9tX2RhdGEgKl9fcmVzdHJpY3QgX19i
dWYpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJp YnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKCgoKCmV4dGVybiBpbnQgcmFuZCAodm9p ZCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCmV4dGVybiB2b2lk
IHNyYW5kICh1bnNpZ25lZCBpbnQgX19zZWVkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18g LCBfX2xlYWZfXykpOwoKCgoKZXh0ZXJuIGludCByYW5kX3IgKHVuc2lnbmVkIGludCAqX19zZWVk KSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKCgoKZXh0ZXJu
IGRvdWJsZSBkcmFuZDQ4ICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl YWZfXykpOwpleHRlcm4gZG91YmxlIGVyYW5kNDggKHVuc2lnbmVkIHNob3J0IGludCBfX3hzdWJp WzNdKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRl
X18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4gbG9uZyBpbnQgbHJhbmQ0OCAodm9pZCkg X19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKZXh0ZXJuIGxvbmcgaW50 IG5yYW5kNDggKHVuc2lnbmVkIHNob3J0IGludCBfX3hzdWJpWzNdKQogICAgIF9fYXR0cmlidXRl
X18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f ICgxKSkpOwoKCmV4dGVybiBsb25nIGludCBtcmFuZDQ4ICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpOwpleHRlcm4gbG9uZyBpbnQganJhbmQ0OCAodW5zaWdu
ZWQgc2hvcnQgaW50IF9feHN1YmlbM10pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19f ICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJu IHZvaWQgc3JhbmQ0OCAobG9uZyBpbnQgX19zZWVkdmFsKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro
cm93X18gLCBfX2xlYWZfXykpOwpleHRlcm4gdW5zaWduZWQgc2hvcnQgaW50ICpzZWVkNDggKHVu c2lnbmVkIHNob3J0IGludCBfX3NlZWQxNnZbM10pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90 aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CmV4
dGVybiB2b2lkIGxjb25nNDggKHVuc2lnbmVkIHNob3J0IGludCBfX3BhcmFtWzddKSBfX2F0dHJp YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51 bGxfXyAoMSkpKTsKCgoKCgpzdHJ1Y3QgZHJhbmQ0OF9kYXRhCiAgewogICAgdW5zaWduZWQgc2hv
cnQgaW50IF9feFszXTsKICAgIHVuc2lnbmVkIHNob3J0IGludCBfX29sZF94WzNdOwogICAgdW5z aWduZWQgc2hvcnQgaW50IF9fYzsKICAgIHVuc2lnbmVkIHNob3J0IGludCBfX2luaXQ7CiAgICBf X2V4dGVuc2lvbl9fIHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgX19hOwoKICB9OwoKCmV4dGVybiBp
bnQgZHJhbmQ0OF9yIChzdHJ1Y3QgZHJhbmQ0OF9kYXRhICpfX3Jlc3RyaWN0IF9fYnVmZmVyLAog ICAgICAgIGRvdWJsZSAqX19yZXN0cmljdCBfX3Jlc3VsdCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90 aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7
CmV4dGVybiBpbnQgZXJhbmQ0OF9yICh1bnNpZ25lZCBzaG9ydCBpbnQgX194c3ViaVszXSwKICAg ICAgICBzdHJ1Y3QgZHJhbmQ0OF9kYXRhICpfX3Jlc3RyaWN0IF9fYnVmZmVyLAogICAgICAgIGRv dWJsZSAqX19yZXN0cmljdCBfX3Jlc3VsdCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg
X19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKZXh0ZXJu IGludCBscmFuZDQ4X3IgKHN0cnVjdCBkcmFuZDQ4X2RhdGEgKl9fcmVzdHJpY3QgX19idWZmZXIs CiAgICAgICAgbG9uZyBpbnQgKl9fcmVzdHJpY3QgX19yZXN1bHQpCiAgICAgX19hdHRyaWJ1dGVf
XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g KDEsIDIpKSk7CmV4dGVybiBpbnQgbnJhbmQ0OF9yICh1bnNpZ25lZCBzaG9ydCBpbnQgX194c3Vi aVszXSwKICAgICAgICBzdHJ1Y3QgZHJhbmQ0OF9kYXRhICpfX3Jlc3RyaWN0IF9fYnVmZmVyLAog
ICAgICAgIGxvbmcgaW50ICpfX3Jlc3RyaWN0IF9fcmVzdWx0KQogICAgIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx LCAyKSkpOwoKCmV4dGVybiBpbnQgbXJhbmQ0OF9yIChzdHJ1Y3QgZHJhbmQ0OF9kYXRhICpfX3Jl
c3RyaWN0IF9fYnVmZmVyLAogICAgICAgIGxvbmcgaW50ICpfX3Jlc3RyaWN0IF9fcmVzdWx0KQog ICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVf XyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwpleHRlcm4gaW50IGpyYW5kNDhfciAodW5zaWduZWQg
c2hvcnQgaW50IF9feHN1YmlbM10sCiAgICAgICAgc3RydWN0IGRyYW5kNDhfZGF0YSAqX19yZXN0 cmljdCBfX2J1ZmZlciwKICAgICAgICBsb25nIGludCAqX19yZXN0cmljdCBfX3Jlc3VsdCkKICAg ICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18g
KChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHNyYW5kNDhfciAobG9uZyBpbnQg X19zZWVkdmFsLCBzdHJ1Y3QgZHJhbmQ0OF9kYXRhICpfX2J1ZmZlcikKICAgICBfX2F0dHJpYnV0 ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxf
XyAoMikpKTsKCmV4dGVybiBpbnQgc2VlZDQ4X3IgKHVuc2lnbmVkIHNob3J0IGludCBfX3NlZWQx NnZbM10sCiAgICAgICBzdHJ1Y3QgZHJhbmQ0OF9kYXRhICpfX2J1ZmZlcikgX19hdHRyaWJ1dGVf XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g
KDEsIDIpKSk7CgpleHRlcm4gaW50IGxjb25nNDhfciAodW5zaWduZWQgc2hvcnQgaW50IF9fcGFy YW1bN10sCiAgICAgICAgc3RydWN0IGRyYW5kNDhfZGF0YSAqX19idWZmZXIpCiAgICAgX19hdHRy aWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25u
dWxsX18gKDEsIDIpKSk7CgoKCgoKCgoKCmV4dGVybiB2b2lkICptYWxsb2MgKHNpemVfdCBfX3Np emUpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVf XyAoKF9fbWFsbG9jX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykp
OwoKZXh0ZXJuIHZvaWQgKmNhbGxvYyAoc2l6ZV90IF9fbm1lbWIsIHNpemVfdCBfX3NpemUpCiAg ICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9f ICgoX19tYWxsb2NfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7
CgoKCgoKCgoKCgpleHRlcm4gdm9pZCAqcmVhbGxvYyAodm9pZCAqX19wdHIsIHNpemVfdCBfX3Np emUpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJp YnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKZXh0ZXJuIHZvaWQgZnJlZSAodm9p
ZCAqX19wdHIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgpl eHRlcm4gdm9pZCBjZnJlZSAodm9pZCAqX19wdHIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df XyAsIF9fbGVhZl9fKSk7CgoKCiMgMSAiL3Vzci9pbmNsdWRlL2FsbG9jYS5oIiAxIDMgNAojIDI0
ICIvdXNyL2luY2x1ZGUvYWxsb2NhLmgiIDMgNAojIDEgIi91c3IvbGliL2djYy9zMzkweC1yZWRo YXQtbGludXgvNi4wLjAvaW5jbHVkZS9zdGRkZWYuaCIgMSAzIDQKIyAyNSAiL3Vzci9pbmNsdWRl L2FsbG9jYS5oIiAyIDMgNAoKCgoKCgoKZXh0ZXJuIHZvaWQgKmFsbG9jYSAoc2l6ZV90IF9fc2l6
ZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCgoKIyA0OTMg Ii91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMiAzIDQKCgoKCgpleHRlcm4gdm9pZCAqdmFsbG9jIChz aXplX3QgX19zaXplKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9f
YXR0cmlidXRlX18gKChfX21hbGxvY19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRf cmVzdWx0X18pKTsKCgoKCmV4dGVybiBpbnQgcG9zaXhfbWVtYWxpZ24gKHZvaWQgKipfX21lbXB0 ciwgc2l6ZV90IF9fYWxpZ25tZW50LCBzaXplX3QgX19zaXplKQogICAgIF9fYXR0cmlidXRlX18g
KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx KSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4g dm9pZCAqYWxpZ25lZF9hbGxvYyAoc2l6ZV90IF9fYWxpZ25tZW50LCBzaXplX3QgX19zaXplKQog
ICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVf XyAoKF9fbWFsbG9jX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hbGxvY19zaXplX18gKDIpKSkgX19h dHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCmV4dGVybiB2b2lkIGFi
b3J0ICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0 cmlidXRlX18gKChfX25vcmV0dXJuX18pKTsKCgoKZXh0ZXJuIGludCBhdGV4aXQgKHZvaWQgKCpf X2Z1bmMpICh2b2lkKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBf
X2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoKCgpleHRlcm4gaW50IGF0X3F1 aWNrX2V4aXQgKHZvaWQgKCpfX2Z1bmMpICh2b2lkKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv d19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoK
CgpleHRlcm4gaW50IG9uX2V4aXQgKHZvaWQgKCpfX2Z1bmMpIChpbnQgX19zdGF0dXMsIHZvaWQg Kl9fYXJnKSwgdm9pZCAqX19hcmcpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg X19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoKCmV4dGVy
biB2b2lkIGV4aXQgKGludCBfX3N0YXR1cykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg X19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub3JldHVybl9fKSk7CgoKCgoKZXh0ZXJuIHZv aWQgcXVpY2tfZXhpdCAoaW50IF9fc3RhdHVzKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18g
LCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vcmV0dXJuX18pKTsKCgoKCgoKCmV4dGVy biB2b2lkIF9FeGl0IChpbnQgX19zdGF0dXMpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs IF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9yZXR1cm5fXykpOwoKCgoKCgpleHRlcm4g
Y2hhciAqZ2V0ZW52IChjb25zdCBjaGFyICpfX25hbWUpIF9fYXR0cmlidXRlX18gKChfX25vdGhy b3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0 cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgojIDU3OCAiL3Vzci9pbmNsdWRl
L3N0ZGxpYi5oIiAzIDQKZXh0ZXJuIGludCBwdXRlbnYgKGNoYXIgKl9fc3RyaW5nKSBfX2F0dHJp YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51 bGxfXyAoMSkpKTsKCgoKCgpleHRlcm4gaW50IHNldGVudiAoY29uc3QgY2hhciAqX19uYW1lLCBj
b25zdCBjaGFyICpfX3ZhbHVlLCBpbnQgX19yZXBsYWNlKQogICAgIF9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyKSkp OwoKCmV4dGVybiBpbnQgdW5zZXRlbnYgKGNvbnN0IGNoYXIgKl9fbmFtZSkgX19hdHRyaWJ1dGVf
XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g KDEpKSk7CgoKCgoKCmV4dGVybiBpbnQgY2xlYXJlbnYgKHZvaWQpIF9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CiMgNjA2ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDMg
NApleHRlcm4gY2hhciAqbWt0ZW1wIChjaGFyICpfX3RlbXBsYXRlKSBfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkp KTsKIyA2MTkgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMyA0CmV4dGVybiBpbnQgbWtzdGVtcCAo
Y2hhciAqX190ZW1wbGF0ZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0 cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CiMgNjQxICIvdXNyL2luY2x1ZGUv c3RkbGliLmgiIDMgNApleHRlcm4gaW50IG1rc3RlbXBzIChjaGFyICpfX3RlbXBsYXRlLCBpbnQg
X19zdWZmaXhsZW4pIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0 ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDY2MiAiL3Vzci9pbmNsdWRlL3N0ZGxp Yi5oIiAzIDQKZXh0ZXJuIGNoYXIgKm1rZHRlbXAgKGNoYXIgKl9fdGVtcGxhdGUpIF9fYXR0cmli
dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs bF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CiMgNzEx ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDMgNAoKCgoKCmV4dGVybiBpbnQgc3lzdGVtIChjb25z
dCBjaGFyICpfX2NvbW1hbmQpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9f KSk7CgojIDczMyAiL3Vzci9pbmNsdWRlL3N0ZGxpYi5oIiAzIDQKZXh0ZXJuIGNoYXIgKnJlYWxw YXRoIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fbmFtZSwKICAgICAgICAgY2hhciAqX19yZXN0
cmljdCBfX3Jlc29sdmVkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykp IF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKCnR5cGVkZWYg aW50ICgqX19jb21wYXJfZm5fdCkgKGNvbnN0IHZvaWQgKiwgY29uc3Qgdm9pZCAqKTsKIyA3NTEg
Ii91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMyA0CgoKCmV4dGVybiB2b2lkICpic2VhcmNoIChjb25z dCB2b2lkICpfX2tleSwgY29uc3Qgdm9pZCAqX19iYXNlLAogICAgICAgIHNpemVfdCBfX25tZW1i LCBzaXplX3QgX19zaXplLCBfX2NvbXBhcl9mbl90IF9fY29tcGFyKQogICAgIF9fYXR0cmlidXRl
X18gKChfX25vbm51bGxfXyAoMSwgMiwgNSkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNl ZF9yZXN1bHRfXykpOwoKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvc3RkbGliLWJzZWFyY2guaCIg MSAzIDQKIyAxOSAiL3Vzci9pbmNsdWRlL2JpdHMvc3RkbGliLWJzZWFyY2guaCIgMyA0CmV4dGVy
biBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSB2b2lkICoKYnNlYXJj aCAoY29uc3Qgdm9pZCAqX19rZXksIGNvbnN0IHZvaWQgKl9fYmFzZSwgc2l6ZV90IF9fbm1lbWIs IHNpemVfdCBfX3NpemUsCiAgX19jb21wYXJfZm5fdCBfX2NvbXBhcikKewogIHNpemVfdCBfX2ws
IF9fdSwgX19pZHg7CiAgY29uc3Qgdm9pZCAqX19wOwogIGludCBfX2NvbXBhcmlzb247CgogIF9f bCA9IDA7CiAgX191ID0gX19ubWVtYjsKICB3aGlsZSAoX19sIDwgX191KQogICAgewogICAgICBf X2lkeCA9IChfX2wgKyBfX3UpIC8gMjsKICAgICAgX19wID0gKHZvaWQgKikgKCgoY29uc3QgY2hh
ciAqKSBfX2Jhc2UpICsgKF9faWR4ICogX19zaXplKSk7CiAgICAgIF9fY29tcGFyaXNvbiA9ICgq X19jb21wYXIpIChfX2tleSwgX19wKTsKICAgICAgaWYgKF9fY29tcGFyaXNvbiA8IDApCiBfX3Ug PSBfX2lkeDsKICAgICAgZWxzZSBpZiAoX19jb21wYXJpc29uID4gMCkKIF9fbCA9IF9faWR4ICsg
MTsKICAgICAgZWxzZQogcmV0dXJuICh2b2lkICopIF9fcDsKICAgIH0KCiAgcmV0dXJuICgodm9p ZCAqKTApOwp9CiMgNzYwICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDIgMyA0CgoKCgpleHRlcm4g dm9pZCBxc29ydCAodm9pZCAqX19iYXNlLCBzaXplX3QgX19ubWVtYiwgc2l6ZV90IF9fc2l6ZSwK
ICAgICBfX2NvbXBhcl9mbl90IF9fY29tcGFyKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g KDEsIDQpKSk7CiMgNzc0ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDMgNApleHRlcm4gaW50IGFi cyAoaW50IF9feCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0
dHJpYnV0ZV9fICgoX19jb25zdF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVz dWx0X18pKTsKZXh0ZXJuIGxvbmcgaW50IGxhYnMgKGxvbmcgaW50IF9feCkgX19hdHRyaWJ1dGVf XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSkg
X19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKX19leHRlbnNpb25f XyBleHRlcm4gbG9uZyBsb25nIGludCBsbGFicyAobG9uZyBsb25nIGludCBfX3gpCiAgICAgX19h dHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19j
b25zdF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCgoK CmV4dGVybiBkaXZfdCBkaXYgKGludCBfX251bWVyLCBpbnQgX19kZW5vbSkKICAgICBfX2F0dHJp YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0
X18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gbGRp dl90IGxkaXYgKGxvbmcgaW50IF9fbnVtZXIsIGxvbmcgaW50IF9fZGVub20pCiAgICAgX19hdHRy aWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19jb25z
dF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCl9fZXh0 ZW5zaW9uX18gZXh0ZXJuIGxsZGl2X3QgbGxkaXYgKGxvbmcgbG9uZyBpbnQgX19udW1lciwKICAg ICAgICBsb25nIGxvbmcgaW50IF9fZGVub20pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv
d19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSkgX19hdHRyaWJ1dGVf XyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCiMgODExICIvdXNyL2luY2x1ZGUvc3RkbGli LmgiIDMgNApleHRlcm4gY2hhciAqZWN2dCAoZG91YmxlIF9fdmFsdWUsIGludCBfX25kaWdpdCwg
aW50ICpfX3Jlc3RyaWN0IF9fZGVjcHQsCiAgICAgaW50ICpfX3Jlc3RyaWN0IF9fc2lnbikgX19h dHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19u b25udWxsX18gKDMsIDQpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18p
KTsKCgoKCmV4dGVybiBjaGFyICpmY3Z0IChkb3VibGUgX192YWx1ZSwgaW50IF9fbmRpZ2l0LCBp bnQgKl9fcmVzdHJpY3QgX19kZWNwdCwKICAgICBpbnQgKl9fcmVzdHJpY3QgX19zaWduKSBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMywgNCkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykp OwoKCgoKZXh0ZXJuIGNoYXIgKmdjdnQgKGRvdWJsZSBfX3ZhbHVlLCBpbnQgX19uZGlnaXQsIGNo YXIgKl9fYnVmKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkg
X19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgzKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5f dW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gY2hhciAqcWVjdnQgKGxvbmcgZG91YmxlIF9f dmFsdWUsIGludCBfX25kaWdpdCwKICAgICAgaW50ICpfX3Jlc3RyaWN0IF9fZGVjcHQsIGludCAq
X19yZXN0cmljdCBfX3NpZ24pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19s ZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDMsIDQpKSkgX19hdHRyaWJ1dGVf XyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIGNoYXIgKnFmY3Z0IChsb25nIGRv
dWJsZSBfX3ZhbHVlLCBpbnQgX19uZGlnaXQsCiAgICAgIGludCAqX19yZXN0cmljdCBfX2RlY3B0 LCBpbnQgKl9fcmVzdHJpY3QgX19zaWduKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df XyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgzLCA0KSkpIF9fYXR0
cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBjaGFyICpxZ2N2dCAo bG9uZyBkb3VibGUgX192YWx1ZSwgaW50IF9fbmRpZ2l0LCBjaGFyICpfX2J1ZikKICAgICBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMykpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoK CgoKZXh0ZXJuIGludCBlY3Z0X3IgKGRvdWJsZSBfX3ZhbHVlLCBpbnQgX19uZGlnaXQsIGludCAq X19yZXN0cmljdCBfX2RlY3B0LAogICAgIGludCAqX19yZXN0cmljdCBfX3NpZ24sIGNoYXIgKl9f
cmVzdHJpY3QgX19idWYsCiAgICAgc2l6ZV90IF9fbGVuKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro cm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMywgNCwgNSkp KTsKZXh0ZXJuIGludCBmY3Z0X3IgKGRvdWJsZSBfX3ZhbHVlLCBpbnQgX19uZGlnaXQsIGludCAq
X19yZXN0cmljdCBfX2RlY3B0LAogICAgIGludCAqX19yZXN0cmljdCBfX3NpZ24sIGNoYXIgKl9f cmVzdHJpY3QgX19idWYsCiAgICAgc2l6ZV90IF9fbGVuKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro cm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMywgNCwgNSkp
KTsKCmV4dGVybiBpbnQgcWVjdnRfciAobG9uZyBkb3VibGUgX192YWx1ZSwgaW50IF9fbmRpZ2l0 LAogICAgICBpbnQgKl9fcmVzdHJpY3QgX19kZWNwdCwgaW50ICpfX3Jlc3RyaWN0IF9fc2lnbiwK ICAgICAgY2hhciAqX19yZXN0cmljdCBfX2J1Ziwgc2l6ZV90IF9fbGVuKQogICAgIF9fYXR0cmli
dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs bF9fICgzLCA0LCA1KSkpOwpleHRlcm4gaW50IHFmY3Z0X3IgKGxvbmcgZG91YmxlIF9fdmFsdWUs IGludCBfX25kaWdpdCwKICAgICAgaW50ICpfX3Jlc3RyaWN0IF9fZGVjcHQsIGludCAqX19yZXN0
cmljdCBfX3NpZ24sCiAgICAgIGNoYXIgKl9fcmVzdHJpY3QgX19idWYsIHNpemVfdCBfX2xlbikK ICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRl X18gKChfX25vbm51bGxfXyAoMywgNCwgNSkpKTsKCgoKCgoKZXh0ZXJuIGludCBtYmxlbiAoY29u
c3QgY2hhciAqX19zLCBzaXplX3QgX19uKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBf X2xlYWZfXykpOwoKCmV4dGVybiBpbnQgbWJ0b3djICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fcHdj LAogICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zLCBzaXplX3QgX19uKSBfX2F0dHJpYnV0
ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCmV4dGVybiBpbnQgd2N0b21iIChjaGFy ICpfX3MsIHdjaGFyX3QgX193Y2hhcikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19s ZWFmX18pKTsKCgoKZXh0ZXJuIHNpemVfdCBtYnN0b3djcyAod2NoYXJfdCAqX19yZXN0cmljdCBf
X3B3Y3MsCiAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zLCBzaXplX3QgX19uKSBfX2F0dHJp YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKZXh0ZXJuIHNpemVfdCB3Y3N0b21i cyAoY2hhciAqX19yZXN0cmljdCBfX3MsCiAgIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19w
d2NzLCBzaXplX3QgX19uKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh Zl9fKSk7CgoKCgoKCgoKZXh0ZXJuIGludCBycG1hdGNoIChjb25zdCBjaGFyICpfX3Jlc3BvbnNl KSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18g
KChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRf XykpOwojIDg5OCAiL3Vzci9pbmNsdWRlL3N0ZGxpYi5oIiAzIDQKZXh0ZXJuIGludCBnZXRzdWJv cHQgKGNoYXIgKipfX3Jlc3RyaWN0IF9fb3B0aW9ucCwKICAgICAgICBjaGFyICpjb25zdCAqX19y
ZXN0cmljdCBfX3Rva2VucywKICAgICAgICBjaGFyICoqX19yZXN0cmljdCBfX3ZhbHVlcCkKICAg ICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18g KChfX25vbm51bGxfXyAoMSwgMiwgMykpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9y
ZXN1bHRfXykpOwojIDk1MCAiL3Vzci9pbmNsdWRlL3N0ZGxpYi5oIiAzIDQKZXh0ZXJuIGludCBn ZXRsb2FkYXZnIChkb3VibGUgX19sb2FkYXZnW10sIGludCBfX25lbGVtKQogICAgIF9fYXR0cmli dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs
bF9fICgxKSkpOwoKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvc3RkbGliLWZsb2F0LmgiIDEgMyA0 CiMgMjQgIi91c3IvaW5jbHVkZS9iaXRzL3N0ZGxpYi1mbG9hdC5oIiAzIDQKCmV4dGVybiBfX2lu bGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBkb3VibGUKX19hdHRyaWJ1dGVf
XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBhdG9mIChjb25zdCBjaGFyICpfX25wdHIpCnsK ICByZXR1cm4gc3RydG9kIChfX25wdHIsIChjaGFyICoqKSAoKHZvaWQgKikwKSk7Cn0KCiMgOTU1 ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDIgMyA0CgoKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMv
c3RkbGliLmgiIDEgMyA0CiMgMjMgIi91c3IvaW5jbHVkZS9iaXRzL3N0ZGxpYi5oIiAzIDQKZXh0 ZXJuIGNoYXIgKl9fcmVhbHBhdGhfY2hrIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fbmFtZSwK ICAgICAgICBjaGFyICpfX3Jlc3RyaWN0IF9fcmVzb2x2ZWQsCiAgICAgICAgc2l6ZV90IF9fcmVz
b2x2ZWRsZW4pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRy aWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIGNoYXIgKl9fcmVhbHBh dGhfYWxpYXMgKGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19uYW1lLCBjaGFyICpfX3Jlc3RyaWN0
IF9fcmVzb2x2ZWQpIF9fYXNtX18gKCIiICJyZWFscGF0aCIpIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSkKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpl
eHRlcm4gY2hhciAqX19yZWFscGF0aF9jaGtfd2FybiAoY29uc3QgY2hhciAqX19yZXN0cmljdCBf X25hbWUsIGNoYXIgKl9fcmVzdHJpY3QgX19yZXNvbHZlZCwgc2l6ZV90IF9fcmVzb2x2ZWRsZW4p IF9fYXNtX18gKCIiICJfX3JlYWxwYXRoX2NoayIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df
XyAsIF9fbGVhZl9fKSkKCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpCiAgICAgX19h dHRyaWJ1dGVfXygoX193YXJuaW5nX18gKCJzZWNvbmQgYXJndW1lbnQgb2YgcmVhbHBhdGggbXVz
dCBiZSBlaXRoZXIgTlVMTCBvciBhdCAiICJsZWFzdCBQQVRIX01BWCBieXRlcyBsb25nIGJ1ZmZl ciIpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19p bmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAo
KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgX19hdHRy aWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBjaGFyICoKX19hdHRyaWJ1dGVfXyAo KF9fbm90aHJvd19fICwgX19sZWFmX18pKSByZWFscGF0aCAoY29uc3QgY2hhciAqX19yZXN0cmlj
dCBfX25hbWUsIGNoYXIgKl9fcmVzdHJpY3QgX19yZXNvbHZlZCkKewogIGlmIChfX2J1aWx0aW5f b2JqZWN0X3NpemUgKF9fcmVzb2x2ZWQsIDIgPiAxKSAhPSAoc2l6ZV90KSAtMSkKICAgIHsKCgoK CiAgICAgIHJldHVybiBfX3JlYWxwYXRoX2NoayAoX19uYW1lLCBfX3Jlc29sdmVkLCBfX2J1aWx0
aW5fb2JqZWN0X3NpemUgKF9fcmVzb2x2ZWQsIDIgPiAxKSk7CiAgICB9CgogIHJldHVybiBfX3Jl YWxwYXRoX2FsaWFzIChfX25hbWUsIF9fcmVzb2x2ZWQpOwp9CgoKZXh0ZXJuIGludCBfX3B0c25h bWVfcl9jaGsgKGludCBfX2ZkLCBjaGFyICpfX2J1Ziwgc2l6ZV90IF9fYnVmbGVuLAogICAgICAg
c2l6ZV90IF9fbnJlYWwpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkg X19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyKSkpOwpleHRlcm4gaW50IF9fcHRzbmFtZV9y X2FsaWFzIChpbnQgX19mZCwgY2hhciAqX19idWYsIHNpemVfdCBfX2J1ZmxlbikgX19hc21fXyAo
IiIgInB0c25hbWVfciIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkK CiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyKSkpOwpleHRlcm4gaW50IF9fcHRz bmFtZV9yX2Noa193YXJuIChpbnQgX19mZCwgY2hhciAqX19idWYsIHNpemVfdCBfX2J1Zmxlbiwg
c2l6ZV90IF9fbnJlYWwpIF9fYXNtX18gKCIiICJfX3B0c25hbWVfcl9jaGsiKSBfX2F0dHJpYnV0 ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpCgoKICAgICBfX2F0dHJpYnV0ZV9fICgoX19u b25udWxsX18gKDIpKSkgX19hdHRyaWJ1dGVfXygoX193YXJuaW5nX18gKCJwdHNuYW1lX3IgY2Fs
bGVkIHdpdGggYnVmbGVuIGJpZ2dlciB0aGFuICIgInNpemUgb2YgYnVmIikpKQogICAgICAgICAg ICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxp bmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChf
X2FydGlmaWNpYWxfXykpIGludApfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZf XykpIHB0c25hbWVfciAoaW50IF9fZmQsIGNoYXIgKl9fYnVmLCBzaXplX3QgX19idWZsZW4pCnsK ICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpICE9IChzaXplX3QpIC0x
KQogICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX2J1ZmxlbikpCiByZXR1 cm4gX19wdHNuYW1lX3JfY2hrIChfX2ZkLCBfX2J1ZiwgX19idWZsZW4sIF9fYnVpbHRpbl9vYmpl Y3Rfc2l6ZSAoX19idWYsIDIgPiAxKSk7CiAgICAgIGlmIChfX2J1ZmxlbiA+IF9fYnVpbHRpbl9v
YmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSkKIHJldHVybiBfX3B0c25hbWVfcl9jaGtfd2FybiAo X19mZCwgX19idWYsIF9fYnVmbGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4g MSkpOwogICAgfQogIHJldHVybiBfX3B0c25hbWVfcl9hbGlhcyAoX19mZCwgX19idWYsIF9fYnVm
bGVuKTsKfQoKCmV4dGVybiBpbnQgX193Y3RvbWJfY2hrIChjaGFyICpfX3MsIHdjaGFyX3QgX193 Y2hhciwgc2l6ZV90IF9fYnVmbGVuKQogIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f bGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJu
IGludCBfX3djdG9tYl9hbGlhcyAoY2hhciAqX19zLCB3Y2hhcl90IF9fd2NoYXIpIF9fYXNtX18g KCIiICJ3Y3RvbWIiKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpCiAg ICAgICAgICAgICAgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCmV4
dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJp YnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18p KSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIGludApfX2F0dHJpYnV0
ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIHdjdG9tYiAoY2hhciAqX19zLCB3Y2hhcl90 IF9fd2NoYXIpCnsKCgoKCgoKCiAgaWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19zLCAyID4g MSkgIT0gKHNpemVfdCkgLTEgJiYgMTYgPiBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcywgMiA+
IDEpKQogICAgcmV0dXJuIF9fd2N0b21iX2NoayAoX19zLCBfX3djaGFyLCBfX2J1aWx0aW5fb2Jq ZWN0X3NpemUgKF9fcywgMiA+IDEpKTsKICByZXR1cm4gX193Y3RvbWJfYWxpYXMgKF9fcywgX193 Y2hhcik7Cn0KCgpleHRlcm4gc2l6ZV90IF9fbWJzdG93Y3NfY2hrICh3Y2hhcl90ICpfX3Jlc3Ry
aWN0IF9fZHN0LAogICAgICAgICBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fc3JjLAogICAgICAg ICBzaXplX3QgX19sZW4sIHNpemVfdCBfX2RzdGxlbikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv d19fICwgX19sZWFmX18pKTsKZXh0ZXJuIHNpemVfdCBfX21ic3Rvd2NzX2FsaWFzICh3Y2hhcl90
ICpfX3Jlc3RyaWN0IF9fZHN0LCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fc3JjLCBzaXplX3Qg X19sZW4pIF9fYXNtX18gKCIiICJtYnN0b3djcyIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df XyAsIF9fbGVhZl9fKSkKCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwpleHRl
cm4gc2l6ZV90IF9fbWJzdG93Y3NfY2hrX3dhcm4gKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19kc3Qs IGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX2xlbiwgc2l6ZV90IF9fZHN0 bGVuKSBfX2FzbV9fICgiIiAiX19tYnN0b3djc19jaGsiKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro
cm93X18gLCBfX2xlYWZfXykpCgoKCiAgICAgX19hdHRyaWJ1dGVfXygoX193YXJuaW5nX18gKCJt YnN0b3djcyBjYWxsZWQgd2l0aCBkc3QgYnVmZmVyIHNtYWxsZXIgdGhhbiBsZW4gIiAiKiBzaXpl b2YgKHdjaGFyX3QpIikpKQogICAgICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxp
bmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgc2l6ZV90Cl9f YXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgbWJzdG93Y3MgKHdjaGFyX3Qg
Kl9fcmVzdHJpY3QgX19kc3QsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBf X2xlbikKCnsKICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChfX2RzdCwgMiA+IDEpICE9IChz aXplX3QpIC0xKQogICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX2xlbikp
CiByZXR1cm4gX19tYnN0b3djc19jaGsgKF9fZHN0LCBfX3NyYywgX19sZW4sCiAgICAgICAgICBf X2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fZHN0LCAyID4gMSkgLyBzaXplb2YgKHdjaGFyX3QpKTsK CiAgICAgIGlmIChfX2xlbiA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kc3QsIDIgPiAxKSAv
IHNpemVvZiAod2NoYXJfdCkpCiByZXR1cm4gX19tYnN0b3djc19jaGtfd2FybiAoX19kc3QsIF9f c3JjLCBfX2xlbiwKICAgICAgICAgX19idWlsdGluX29iamVjdF9zaXplIChfX2RzdCwgMiA+IDEp IC8gc2l6ZW9mICh3Y2hhcl90KSk7CiAgICB9CiAgcmV0dXJuIF9fbWJzdG93Y3NfYWxpYXMgKF9f
ZHN0LCBfX3NyYywgX19sZW4pOwp9CgoKZXh0ZXJuIHNpemVfdCBfX3djc3RvbWJzX2NoayAoY2hh ciAqX19yZXN0cmljdCBfX2RzdCwKICAgICAgICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBf X3NyYywKICAgICAgICAgc2l6ZV90IF9fbGVuLCBzaXplX3QgX19kc3RsZW4pIF9fYXR0cmlidXRl
X18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CmV4dGVybiBzaXplX3QgX193Y3N0b21ic19h bGlhcyAoY2hhciAqX19yZXN0cmljdCBfX2RzdCwgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBf X3NyYywgc2l6ZV90IF9fbGVuKSBfX2FzbV9fICgiIiAid2NzdG9tYnMiKSBfX2F0dHJpYnV0ZV9f
ICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpCgoKICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgIDsKZXh0ZXJuIHNpemVfdCBfX3djc3RvbWJzX2Noa193YXJuIChjaGFyICpfX3Jlc3Ry aWN0IF9fZHN0LCBjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fc3JjLCBzaXplX3QgX19sZW4s
IHNpemVfdCBfX2RzdGxlbikgX19hc21fXyAoIiIgIl9fd2NzdG9tYnNfY2hrIikgX19hdHRyaWJ1 dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKQoKCgogICAgIF9fYXR0cmlidXRlX18oKF9f d2FybmluZ19fICgid2NzdG9tYnMgY2FsbGVkIHdpdGggZHN0IGJ1ZmZlciBzbWFsbGVyIHRoYW4g
bGVuIikpKTsKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5l X18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19h cnRpZmljaWFsX18pKSBzaXplX3QKX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFm
X18pKSB3Y3N0b21icyAoY2hhciAqX19yZXN0cmljdCBfX2RzdCwgY29uc3Qgd2NoYXJfdCAqX19y ZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbGVuKQoKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3Np emUgKF9fZHN0LCAyID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICB7CiAgICAgIGlmICghX19idWls
dGluX2NvbnN0YW50X3AgKF9fbGVuKSkKIHJldHVybiBfX3djc3RvbWJzX2NoayAoX19kc3QsIF9f c3JjLCBfX2xlbiwgX19idWlsdGluX29iamVjdF9zaXplIChfX2RzdCwgMiA+IDEpKTsKICAgICAg aWYgKF9fbGVuID4gX19idWlsdGluX29iamVjdF9zaXplIChfX2RzdCwgMiA+IDEpKQogcmV0dXJu
IF9fd2NzdG9tYnNfY2hrX3dhcm4gKF9fZHN0LCBfX3NyYywgX19sZW4sIF9fYnVpbHRpbl9vYmpl Y3Rfc2l6ZSAoX19kc3QsIDIgPiAxKSk7CiAgICB9CiAgcmV0dXJuIF9fd2NzdG9tYnNfYWxpYXMg KF9fZHN0LCBfX3NyYywgX19sZW4pOwp9CiMgOTU5ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDIg
MyA0CiMgOTY3ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDMgNAoKIyAyNCAiY29yZC9jb3JkYnNj cy5jIiAyCgojIDEgIi91c3IvaW5jbHVkZS9zdHJpbmcuaCIgMSAzIDQKIyAyNyAiL3Vzci9pbmNs dWRlL3N0cmluZy5oIiAzIDQKCgoKCgojIDEgIi91c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGlu
dXgvNi4wLjAvaW5jbHVkZS9zdGRkZWYuaCIgMSAzIDQKIyAzMyAiL3Vzci9pbmNsdWRlL3N0cmlu Zy5oIiAyIDMgNAoKCgoKCgoKCgpleHRlcm4gdm9pZCAqbWVtY3B5ICh2b2lkICpfX3Jlc3RyaWN0 IF9fZGVzdCwgY29uc3Qgdm9pZCAqX19yZXN0cmljdCBfX3NyYywKICAgICAgIHNpemVfdCBfX24p
IF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAo KF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCmV4dGVybiB2b2lkICptZW1tb3ZlICh2b2lkICpfX2Rl c3QsIGNvbnN0IHZvaWQgKl9fc3JjLCBzaXplX3QgX19uKQogICAgIF9fYXR0cmlidXRlX18gKChf
X25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAy KSkpOwoKCgoKCgpleHRlcm4gdm9pZCAqbWVtY2NweSAodm9pZCAqX19yZXN0cmljdCBfX2Rlc3Qs IGNvbnN0IHZvaWQgKl9fcmVzdHJpY3QgX19zcmMsCiAgICAgICAgaW50IF9fYywgc2l6ZV90IF9f
bikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmli dXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgoKCgpleHRlcm4gdm9pZCAqbWVtc2V0ICh2 b2lkICpfX3MsIGludCBfX2MsIHNpemVfdCBfX24pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df
XyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVy biBpbnQgbWVtY21wIChjb25zdCB2b2lkICpfX3MxLCBjb25zdCB2b2lkICpfX3MyLCBzaXplX3Qg X19uKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRy
aWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkp OwojIDkyICIvdXNyL2luY2x1ZGUvc3RyaW5nLmgiIDMgNApleHRlcm4gdm9pZCAqbWVtY2hyIChj b25zdCB2b2lkICpfX3MsIGludCBfX2MsIHNpemVfdCBfX24pCiAgICAgIF9fYXR0cmlidXRlX18g
KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19h dHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCiMgMTIzICIvdXNyL2luY2x1ZGUvc3Ry aW5nLmgiIDMgNAoKCmV4dGVybiBjaGFyICpzdHJjcHkgKGNoYXIgKl9fcmVzdHJpY3QgX19kZXN0
LCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fc3JjKQogICAgIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkp OwoKZXh0ZXJuIGNoYXIgKnN0cm5jcHkgKGNoYXIgKl9fcmVzdHJpY3QgX19kZXN0LAogICAgICAg
IGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX24pCiAgICAgX19hdHRyaWJ1 dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxs X18gKDEsIDIpKSk7CgoKZXh0ZXJuIGNoYXIgKnN0cmNhdCAoY2hhciAqX19yZXN0cmljdCBfX2Rl
c3QsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zcmMpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9f bm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIp KSk7CgpleHRlcm4gY2hhciAqc3RybmNhdCAoY2hhciAqX19yZXN0cmljdCBfX2Rlc3QsIGNvbnN0
IGNoYXIgKl9fcmVzdHJpY3QgX19zcmMsCiAgICAgICAgc2l6ZV90IF9fbikgX19hdHRyaWJ1dGVf XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g KDEsIDIpKSk7CgoKZXh0ZXJuIGludCBzdHJjbXAgKGNvbnN0IGNoYXIgKl9fczEsIGNvbnN0IGNo
YXIgKl9fczIpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBf X2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEs IDIpKSk7CgpleHRlcm4gaW50IHN0cm5jbXAgKGNvbnN0IGNoYXIgKl9fczEsIGNvbnN0IGNoYXIg
Kl9fczIsIHNpemVfdCBfX24pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19s ZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25u dWxsX18gKDEsIDIpKSk7CgoKZXh0ZXJuIGludCBzdHJjb2xsIChjb25zdCBjaGFyICpfX3MxLCBj
b25zdCBjaGFyICpfX3MyKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh Zl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs bF9fICgxLCAyKSkpOwoKZXh0ZXJuIHNpemVfdCBzdHJ4ZnJtIChjaGFyICpfX3Jlc3RyaWN0IF9f
ZGVzdCwKICAgICAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbikK ICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRl X18gKChfX25vbm51bGxfXyAoMikpKTsKCiMgMTYyICIvdXNyL2luY2x1ZGUvc3RyaW5nLmgiIDMg
NApleHRlcm4gaW50IHN0cmNvbGxfbCAoY29uc3QgY2hhciAqX19zMSwgY29uc3QgY2hhciAqX19z MiwgX19sb2NhbGVfdCBfX2wpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19s ZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25u
dWxsX18gKDEsIDIsIDMpKSk7CgpleHRlcm4gc2l6ZV90IHN0cnhmcm1fbCAoY2hhciAqX19kZXN0 LCBjb25zdCBjaGFyICpfX3NyYywgc2l6ZV90IF9fbiwKICAgIF9fbG9jYWxlX3QgX19sKSBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMiwgNCkpKTsKCgoKCmV4dGVybiBjaGFyICpzdHJkdXAgKGNvbnN0IGNoYXIgKl9f cykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmli dXRlX18gKChfX21hbGxvY19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoK
CgoKCgpleHRlcm4gY2hhciAqc3RybmR1cCAoY29uc3QgY2hhciAqX19zdHJpbmcsIHNpemVfdCBf X24pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJp YnV0ZV9fICgoX19tYWxsb2NfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsK
IyAyMDYgIi91c3IvaW5jbHVkZS9zdHJpbmcuaCIgMyA0CgojIDIzMSAiL3Vzci9pbmNsdWRlL3N0 cmluZy5oIiAzIDQKZXh0ZXJuIGNoYXIgKnN0cmNociAoY29uc3QgY2hhciAqX19zLCBpbnQgX19j KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1
dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwojIDI1 OCAiL3Vzci9pbmNsdWRlL3N0cmluZy5oIiAzIDQKZXh0ZXJuIGNoYXIgKnN0cnJjaHIgKGNvbnN0 IGNoYXIgKl9fcywgaW50IF9fYykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBf
X2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25v bm51bGxfXyAoMSkpKTsKCgojIDI3NyAiL3Vzci9pbmNsdWRlL3N0cmluZy5oIiAzIDQKCgoKZXh0 ZXJuIHNpemVfdCBzdHJjc3BuIChjb25zdCBjaGFyICpfX3MsIGNvbnN0IGNoYXIgKl9fcmVqZWN0
KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1 dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoK CmV4dGVybiBzaXplX3Qgc3Ryc3BuIChjb25zdCBjaGFyICpfX3MsIGNvbnN0IGNoYXIgKl9fYWNj
ZXB0KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRy aWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkp OwojIDMxMCAiL3Vzci9pbmNsdWRlL3N0cmluZy5oIiAzIDQKZXh0ZXJuIGNoYXIgKnN0cnBicmsg
KGNvbnN0IGNoYXIgKl9fcywgY29uc3QgY2hhciAqX19hY2NlcHQpCiAgICAgX19hdHRyaWJ1dGVf XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBf X2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CiMgMzM3ICIvdXNyL2luY2x1ZGUv
c3RyaW5nLmgiIDMgNApleHRlcm4gY2hhciAqc3Ryc3RyIChjb25zdCBjaGFyICpfX2hheXN0YWNr LCBjb25zdCBjaGFyICpfX25lZWRsZSkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18g LCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChf
X25vbm51bGxfXyAoMSwgMikpKTsKCgoKCmV4dGVybiBjaGFyICpzdHJ0b2sgKGNoYXIgKl9fcmVz dHJpY3QgX19zLCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZGVsaW0pCiAgICAgX19hdHRyaWJ1 dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxs
X18gKDIpKSk7CgoKCgpleHRlcm4gY2hhciAqX19zdHJ0b2tfciAoY2hhciAqX19yZXN0cmljdCBf X3MsCiAgICBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZGVsaW0sCiAgICBjaGFyICoqX19yZXN0 cmljdCBfX3NhdmVfcHRyKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh
Zl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyLCAzKSkpOwoKZXh0ZXJuIGNoYXIg KnN0cnRva19yIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgY29uc3QgY2hhciAqX19yZXN0cmljdCBf X2RlbGltLAogICAgICAgICBjaGFyICoqX19yZXN0cmljdCBfX3NhdmVfcHRyKQogICAgIF9fYXR0
cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u bnVsbF9fICgyLCAzKSkpOwojIDM5MiAiL3Vzci9pbmNsdWRlL3N0cmluZy5oIiAzIDQKCgpleHRl cm4gc2l6ZV90IHN0cmxlbiAoY29uc3QgY2hhciAqX19zKQogICAgIF9fYXR0cmlidXRlX18gKChf
X25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRy aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKCmV4dGVybiBzaXplX3Qgc3RybmxlbiAo Y29uc3QgY2hhciAqX19zdHJpbmcsIHNpemVfdCBfX21heGxlbikKICAgICBfX2F0dHJpYnV0ZV9f
ICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9f YXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoKCgpleHRlcm4gY2hhciAqc3RyZXJy b3IgKGludCBfX2Vycm51bSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18p
KTsKCiMgNDIyICIvdXNyL2luY2x1ZGUvc3RyaW5nLmgiIDMgNApleHRlcm4gaW50IHN0cmVycm9y X3IgKGludCBfX2Vycm51bSwgY2hhciAqX19idWYsIHNpemVfdCBfX2J1ZmxlbikgX19hc21fXyAo IiIgIl9feHBnX3N0cmVycm9yX3IiKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl
YWZfXykpCgogICAgICAgICAgICAgICAgICAgICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxs X18gKDIpKSk7CiMgNDQwICIvdXNyL2luY2x1ZGUvc3RyaW5nLmgiIDMgNApleHRlcm4gY2hhciAq c3RyZXJyb3JfbCAoaW50IF9fZXJybnVtLCBfX2xvY2FsZV90IF9fbCkgX19hdHRyaWJ1dGVfXyAo
KF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCgpleHRlcm4gdm9pZCBfX2J6ZXJvICh2b2lk ICpfX3MsIHNpemVfdCBfX24pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9f KSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgpleHRlcm4gdm9pZCBiY29w
eSAoY29uc3Qgdm9pZCAqX19zcmMsIHZvaWQgKl9fZGVzdCwgc2l6ZV90IF9fbikKICAgICBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25v bm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gdm9pZCBiemVybyAodm9pZCAqX19zLCBzaXplX3Qg
X19uKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRl X18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4gaW50IGJjbXAgKGNvbnN0IHZvaWQgKl9f czEsIGNvbnN0IHZvaWQgKl9fczIsIHNpemVfdCBfX24pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9f
bm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBfX2F0dHJp YnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CiMgNDg0ICIvdXNyL2luY2x1ZGUvc3RyaW5n LmgiIDMgNApleHRlcm4gY2hhciAqaW5kZXggKGNvbnN0IGNoYXIgKl9fcywgaW50IF9fYykKICAg
ICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18g KChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKIyA1MTIgIi91 c3IvaW5jbHVkZS9zdHJpbmcuaCIgMyA0CmV4dGVybiBjaGFyICpyaW5kZXggKGNvbnN0IGNoYXIg
Kl9fcywgaW50IF9fYykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZf XykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxf XyAoMSkpKTsKCgoKCmV4dGVybiBpbnQgZmZzIChpbnQgX19pKSBfX2F0dHJpYnV0ZV9fICgoX19u
b3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0X18pKTsKIyA1Mjkg Ii91c3IvaW5jbHVkZS9zdHJpbmcuaCIgMyA0CmV4dGVybiBpbnQgc3RyY2FzZWNtcCAoY29uc3Qg Y2hhciAqX19zMSwgY29uc3QgY2hhciAqX19zMikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro
cm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRl X18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHN0cm5jYXNlY21wIChjb25z dCBjaGFyICpfX3MxLCBjb25zdCBjaGFyICpfX3MyLCBzaXplX3QgX19uKQogICAgIF9fYXR0cmli
dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9f KSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwojIDU1MiAiL3Vzci9pbmNs dWRlL3N0cmluZy5oIiAzIDQKZXh0ZXJuIGNoYXIgKnN0cnNlcCAoY2hhciAqKl9fcmVzdHJpY3Qg
X19zdHJpbmdwLAogICAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2RlbGltKQogICAgIF9f YXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f bm9ubnVsbF9fICgxLCAyKSkpOwoKCgoKZXh0ZXJuIGNoYXIgKnN0cnNpZ25hbCAoaW50IF9fc2ln
KSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCmV4dGVybiBjaGFy ICpfX3N0cGNweSAoY2hhciAqX19yZXN0cmljdCBfX2Rlc3QsIGNvbnN0IGNoYXIgKl9fcmVzdHJp Y3QgX19zcmMpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBf
X2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CmV4dGVybiBjaGFyICpzdHBjcHkg KGNoYXIgKl9fcmVzdHJpY3QgX19kZXN0LCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fc3JjKQog ICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVf
XyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCgpleHRlcm4gY2hhciAqX19zdHBuY3B5IChjaGFy ICpfX3Jlc3RyaWN0IF9fZGVzdCwKICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3NyYywgc2l6 ZV90IF9fbikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9f
YXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKZXh0ZXJuIGNoYXIgKnN0cG5jcHkg KGNoYXIgKl9fcmVzdHJpY3QgX19kZXN0LAogICAgICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3Qg X19zcmMsIHNpemVfdCBfX24pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19s
ZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CiMgNjI3ICIvdXNy L2luY2x1ZGUvc3RyaW5nLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3N0cmluZy5oIiAx IDMgNAojIDYyOCAiL3Vzci9pbmNsdWRlL3N0cmluZy5oIiAyIDMgNAoKCiMgMSAiL3Vzci9pbmNs
dWRlL2JpdHMvc3RyaW5nMi5oIiAxIDMgNAojIDM5MyAiL3Vzci9pbmNsdWRlL2JpdHMvc3RyaW5n Mi5oIiAzIDQKZXh0ZXJuIHZvaWQgKl9fcmF3bWVtY2hyIChjb25zdCB2b2lkICpfX3MsIGludCBf X2MpOwojIDk0NSAiL3Vzci9pbmNsdWRlL2JpdHMvc3RyaW5nMi5oIiAzIDQKZXh0ZXJuIF9faW5s
aW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIHNpemVfdCBfX3N0cmNzcG5fYzEg KGNvbnN0IGNoYXIgKl9fcywgaW50IF9fcmVqZWN0KTsKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmli dXRlX18gKChfX2dudV9pbmxpbmVfXykpIHNpemVfdApfX3N0cmNzcG5fYzEgKGNvbnN0IGNoYXIg
Kl9fcywgaW50IF9fcmVqZWN0KQp7CiAgc2l6ZV90IF9fcmVzdWx0ID0gMDsKICB3aGlsZSAoX19z W19fcmVzdWx0XSAhPSAnXDAnICYmIF9fc1tfX3Jlc3VsdF0gIT0gX19yZWplY3QpCiAgICArK19f cmVzdWx0OwogIHJldHVybiBfX3Jlc3VsdDsKfQoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRl
X18gKChfX2dudV9pbmxpbmVfXykpIHNpemVfdCBfX3N0cmNzcG5fYzIgKGNvbnN0IGNoYXIgKl9f cywgaW50IF9fcmVqZWN0MSwKICAgICAgICAgaW50IF9fcmVqZWN0Mik7CmV4dGVybiBfX2lubGlu ZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBzaXplX3QKX19zdHJjc3BuX2MyIChj
b25zdCBjaGFyICpfX3MsIGludCBfX3JlamVjdDEsIGludCBfX3JlamVjdDIpCnsKICBzaXplX3Qg X19yZXN1bHQgPSAwOwogIHdoaWxlIChfX3NbX19yZXN1bHRdICE9ICdcMCcgJiYgX19zW19fcmVz dWx0XSAhPSBfX3JlamVjdDEKICAmJiBfX3NbX19yZXN1bHRdICE9IF9fcmVqZWN0MikKICAgICsr
X19yZXN1bHQ7CiAgcmV0dXJuIF9fcmVzdWx0Owp9CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1 dGVfXyAoKF9fZ251X2lubGluZV9fKSkgc2l6ZV90IF9fc3RyY3Nwbl9jMyAoY29uc3QgY2hhciAq X19zLCBpbnQgX19yZWplY3QxLAogICAgICAgICBpbnQgX19yZWplY3QyLCBpbnQgX19yZWplY3Qz
KTsKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIHNpemVf dApfX3N0cmNzcG5fYzMgKGNvbnN0IGNoYXIgKl9fcywgaW50IF9fcmVqZWN0MSwgaW50IF9fcmVq ZWN0MiwKICAgICAgIGludCBfX3JlamVjdDMpCnsKICBzaXplX3QgX19yZXN1bHQgPSAwOwogIHdo
aWxlIChfX3NbX19yZXN1bHRdICE9ICdcMCcgJiYgX19zW19fcmVzdWx0XSAhPSBfX3JlamVjdDEK ICAmJiBfX3NbX19yZXN1bHRdICE9IF9fcmVqZWN0MiAmJiBfX3NbX19yZXN1bHRdICE9IF9fcmVq ZWN0MykKICAgICsrX19yZXN1bHQ7CiAgcmV0dXJuIF9fcmVzdWx0Owp9CiMgMTAyMSAiL3Vzci9p
bmNsdWRlL2JpdHMvc3RyaW5nMi5oIiAzIDQKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18g KChfX2dudV9pbmxpbmVfXykpIHNpemVfdCBfX3N0cnNwbl9jMSAoY29uc3QgY2hhciAqX19zLCBp bnQgX19hY2NlcHQpOwpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGlu
ZV9fKSkgc2l6ZV90Cl9fc3Ryc3BuX2MxIChjb25zdCBjaGFyICpfX3MsIGludCBfX2FjY2VwdCkK ewogIHNpemVfdCBfX3Jlc3VsdCA9IDA7CgogIHdoaWxlIChfX3NbX19yZXN1bHRdID09IF9fYWNj ZXB0KQogICAgKytfX3Jlc3VsdDsKICByZXR1cm4gX19yZXN1bHQ7Cn0KCmV4dGVybiBfX2lubGlu
ZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBzaXplX3QgX19zdHJzcG5fYzIgKGNv bnN0IGNoYXIgKl9fcywgaW50IF9fYWNjZXB0MSwKICAgICAgICBpbnQgX19hY2NlcHQyKTsKZXh0 ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIHNpemVfdApfX3N0
cnNwbl9jMiAoY29uc3QgY2hhciAqX19zLCBpbnQgX19hY2NlcHQxLCBpbnQgX19hY2NlcHQyKQp7 CiAgc2l6ZV90IF9fcmVzdWx0ID0gMDsKCiAgd2hpbGUgKF9fc1tfX3Jlc3VsdF0gPT0gX19hY2Nl cHQxIHx8IF9fc1tfX3Jlc3VsdF0gPT0gX19hY2NlcHQyKQogICAgKytfX3Jlc3VsdDsKICByZXR1
cm4gX19yZXN1bHQ7Cn0KCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5s aW5lX18pKSBzaXplX3QgX19zdHJzcG5fYzMgKGNvbnN0IGNoYXIgKl9fcywgaW50IF9fYWNjZXB0 MSwKICAgICAgICBpbnQgX19hY2NlcHQyLCBpbnQgX19hY2NlcHQzKTsKZXh0ZXJuIF9faW5saW5l
IF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIHNpemVfdApfX3N0cnNwbl9jMyAoY29u c3QgY2hhciAqX19zLCBpbnQgX19hY2NlcHQxLCBpbnQgX19hY2NlcHQyLCBpbnQgX19hY2NlcHQz KQp7CiAgc2l6ZV90IF9fcmVzdWx0ID0gMDsKCiAgd2hpbGUgKF9fc1tfX3Jlc3VsdF0gPT0gX19h
Y2NlcHQxIHx8IF9fc1tfX3Jlc3VsdF0gPT0gX19hY2NlcHQyCiAgfHwgX19zW19fcmVzdWx0XSA9 PSBfX2FjY2VwdDMpCiAgICArK19fcmVzdWx0OwogIHJldHVybiBfX3Jlc3VsdDsKfQojIDEwOTcg Ii91c3IvaW5jbHVkZS9iaXRzL3N0cmluZzIuaCIgMyA0CmV4dGVybiBfX2lubGluZSBfX2F0dHJp
YnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBjaGFyICpfX3N0cnBicmtfYzIgKGNvbnN0IGNoYXIg Kl9fcywgaW50IF9fYWNjZXB0MSwKICAgICAgICBpbnQgX19hY2NlcHQyKTsKZXh0ZXJuIF9faW5s aW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGNoYXIgKgpfX3N0cnBicmtfYzIg
KGNvbnN0IGNoYXIgKl9fcywgaW50IF9fYWNjZXB0MSwgaW50IF9fYWNjZXB0MikKewoKICB3aGls ZSAoKl9fcyAhPSAnXDAnICYmICpfX3MgIT0gX19hY2NlcHQxICYmICpfX3MgIT0gX19hY2NlcHQy KQogICAgKytfX3M7CiAgcmV0dXJuICpfX3MgPT0gJ1wwJyA/ICgodm9pZCAqKTApIDogKGNoYXIg
KikgKHNpemVfdCkgX19zOwp9CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251 X2lubGluZV9fKSkgY2hhciAqX19zdHJwYnJrX2MzIChjb25zdCBjaGFyICpfX3MsIGludCBfX2Fj Y2VwdDEsCiAgICAgICAgaW50IF9fYWNjZXB0MiwgaW50IF9fYWNjZXB0Myk7CmV4dGVybiBfX2lu
bGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBjaGFyICoKX19zdHJwYnJrX2Mz IChjb25zdCBjaGFyICpfX3MsIGludCBfX2FjY2VwdDEsIGludCBfX2FjY2VwdDIsIGludCBfX2Fj Y2VwdDMpCnsKCiAgd2hpbGUgKCpfX3MgIT0gJ1wwJyAmJiAqX19zICE9IF9fYWNjZXB0MSAmJiAq
X19zICE9IF9fYWNjZXB0MgogICYmICpfX3MgIT0gX19hY2NlcHQzKQogICAgKytfX3M7CiAgcmV0 dXJuICpfX3MgPT0gJ1wwJyA/ICgodm9pZCAqKTApIDogKGNoYXIgKikgKHNpemVfdCkgX19zOwp9 CiMgMTE0NyAiL3Vzci9pbmNsdWRlL2JpdHMvc3RyaW5nMi5oIiAzIDQKZXh0ZXJuIF9faW5saW5l
IF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGNoYXIgKl9fc3RydG9rX3JfMWMgKGNo YXIgKl9fcywgY2hhciBfX3NlcCwgY2hhciAqKl9fbmV4dHApOwpleHRlcm4gX19pbmxpbmUgX19h dHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgY2hhciAqCl9fc3RydG9rX3JfMWMgKGNoYXIg
Kl9fcywgY2hhciBfX3NlcCwgY2hhciAqKl9fbmV4dHApCnsKICBjaGFyICpfX3Jlc3VsdDsKICBp ZiAoX19zID09ICgodm9pZCAqKTApKQogICAgX19zID0gKl9fbmV4dHA7CiAgd2hpbGUgKCpfX3Mg PT0gX19zZXApCiAgICArK19fczsKICBfX3Jlc3VsdCA9ICgodm9pZCAqKTApOwogIGlmICgqX19z
ICE9ICdcMCcpCiAgICB7CiAgICAgIF9fcmVzdWx0ID0gX19zKys7CiAgICAgIHdoaWxlICgqX19z ICE9ICdcMCcpCiBpZiAoKl9fcysrID09IF9fc2VwKQogICB7CiAgICAgX19zWy0xXSA9ICdcMCc7 CiAgICAgYnJlYWs7CiAgIH0KICAgIH0KICAqX19uZXh0cCA9IF9fczsKICByZXR1cm4gX19yZXN1
bHQ7Cn0KIyAxMTc5ICIvdXNyL2luY2x1ZGUvYml0cy9zdHJpbmcyLmgiIDMgNApleHRlcm4gY2hh ciAqX19zdHJzZXBfZyAoY2hhciAqKl9fc3RyaW5ncCwgY29uc3QgY2hhciAqX19kZWxpbSk7CiMg MTE5NyAiL3Vzci9pbmNsdWRlL2JpdHMvc3RyaW5nMi5oIiAzIDQKZXh0ZXJuIF9faW5saW5lIF9f
YXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGNoYXIgKl9fc3Ryc2VwXzFjIChjaGFyICoq X19zLCBjaGFyIF9fcmVqZWN0KTsKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2du dV9pbmxpbmVfXykpIGNoYXIgKgpfX3N0cnNlcF8xYyAoY2hhciAqKl9fcywgY2hhciBfX3JlamVj
dCkKewogIGNoYXIgKl9fcmV0dmFsID0gKl9fczsKICBpZiAoX19yZXR2YWwgIT0gKCh2b2lkICop MCkgJiYgKCpfX3MgPSAoX19leHRlbnNpb25fXyAoX19idWlsdGluX2NvbnN0YW50X3AgKF9fcmVq ZWN0KSAmJiAhX19idWlsdGluX2NvbnN0YW50X3AgKF9fcmV0dmFsKSAmJiAoX19yZWplY3QpID09
ICdcMCcgPyAoY2hhciAqKSBfX3Jhd21lbWNociAoX19yZXR2YWwsIF9fcmVqZWN0KSA6IF9fYnVp bHRpbl9zdHJjaHIgKF9fcmV0dmFsLCBfX3JlamVjdCkpKSkgIT0gKCh2b2lkICopMCkpCiAgICAq KCpfX3MpKysgPSAnXDAnOwogIHJldHVybiBfX3JldHZhbDsKfQoKZXh0ZXJuIF9faW5saW5lIF9f
YXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGNoYXIgKl9fc3Ryc2VwXzJjIChjaGFyICoq X19zLCBjaGFyIF9fcmVqZWN0MSwgY2hhciBfX3JlamVjdDIpOwpleHRlcm4gX19pbmxpbmUgX19h dHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgY2hhciAqCl9fc3Ryc2VwXzJjIChjaGFyICoq
X19zLCBjaGFyIF9fcmVqZWN0MSwgY2hhciBfX3JlamVjdDIpCnsKICBjaGFyICpfX3JldHZhbCA9 ICpfX3M7CiAgaWYgKF9fcmV0dmFsICE9ICgodm9pZCAqKTApKQogICAgewogICAgICBjaGFyICpf X2NwID0gX19yZXR2YWw7CiAgICAgIHdoaWxlICgxKQogewogICBpZiAoKl9fY3AgPT0gJ1wwJykK
ICAgICB7CiAgICAgICBfX2NwID0gKCh2b2lkICopMCk7CiAgIGJyZWFrOwogICAgIH0KICAgaWYg KCpfX2NwID09IF9fcmVqZWN0MSB8fCAqX19jcCA9PSBfX3JlamVjdDIpCiAgICAgewogICAgICAg Kl9fY3ArKyA9ICdcMCc7CiAgICAgICBicmVhazsKICAgICB9CiAgICsrX19jcDsKIH0KICAgICAg
Kl9fcyA9IF9fY3A7CiAgICB9CiAgcmV0dXJuIF9fcmV0dmFsOwp9CgpleHRlcm4gX19pbmxpbmUg X19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgY2hhciAqX19zdHJzZXBfM2MgKGNoYXIg KipfX3MsIGNoYXIgX19yZWplY3QxLCBjaGFyIF9fcmVqZWN0MiwKICAgICAgIGNoYXIgX19yZWpl
Y3QzKTsKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGNo YXIgKgpfX3N0cnNlcF8zYyAoY2hhciAqKl9fcywgY2hhciBfX3JlamVjdDEsIGNoYXIgX19yZWpl Y3QyLCBjaGFyIF9fcmVqZWN0MykKewogIGNoYXIgKl9fcmV0dmFsID0gKl9fczsKICBpZiAoX19y
ZXR2YWwgIT0gKCh2b2lkICopMCkpCiAgICB7CiAgICAgIGNoYXIgKl9fY3AgPSBfX3JldHZhbDsK ICAgICAgd2hpbGUgKDEpCiB7CiAgIGlmICgqX19jcCA9PSAnXDAnKQogICAgIHsKICAgICAgIF9f Y3AgPSAoKHZvaWQgKikwKTsKICAgYnJlYWs7CiAgICAgfQogICBpZiAoKl9fY3AgPT0gX19yZWpl
Y3QxIHx8ICpfX2NwID09IF9fcmVqZWN0MiB8fCAqX19jcCA9PSBfX3JlamVjdDMpCiAgICAgewog ICAgICAgKl9fY3ArKyA9ICdcMCc7CiAgICAgICBicmVhazsKICAgICB9CiAgICsrX19jcDsKIH0K ICAgICAgKl9fcyA9IF9fY3A7CiAgICB9CiAgcmV0dXJuIF9fcmV0dmFsOwp9CiMgMTI3OCAiL3Vz
ci9pbmNsdWRlL2JpdHMvc3RyaW5nMi5oIiAzIDQKZXh0ZXJuIGNoYXIgKl9fc3RyZHVwIChjb25z dCBjaGFyICpfX3N0cmluZykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18p KSBfX2F0dHJpYnV0ZV9fICgoX19tYWxsb2NfXykpOwojIDEyOTcgIi91c3IvaW5jbHVkZS9iaXRz
L3N0cmluZzIuaCIgMyA0CmV4dGVybiBjaGFyICpfX3N0cm5kdXAgKGNvbnN0IGNoYXIgKl9fc3Ry aW5nLCBzaXplX3QgX19uKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh Zl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbWFsbG9jX18pKTsKIyA2MzEgIi91c3IvaW5jbHVkZS9z
dHJpbmcuaCIgMiAzIDQKCgoKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvc3RyaW5nMy5oIiAxIDMg NAojIDQ5ICIvdXNyL2luY2x1ZGUvYml0cy9zdHJpbmczLmgiIDMgNApleHRlcm4gX19pbmxpbmUg X19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgdm9pZCAqCl9fYXR0 cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgbWVtY3B5ICh2b2lkICpfX3Jlc3Ry aWN0IF9fZGVzdCwgY29uc3Qgdm9pZCAqX19yZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbGVuKQoK
ewogIHJldHVybiBfX2J1aWx0aW5fX19tZW1jcHlfY2hrIChfX2Rlc3QsIF9fc3JjLCBfX2xlbiwg X19idWlsdGluX29iamVjdF9zaXplIChfX2Rlc3QsIDApKTsKfQoKZXh0ZXJuIF9faW5saW5lIF9f YXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIHZvaWQgKgpfX2F0dHJp YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIG1lbW1vdmUgKHZvaWQgKl9fZGVzdCwg Y29uc3Qgdm9pZCAqX19zcmMsIHNpemVfdCBfX2xlbikKewogIHJldHVybiBfX2J1aWx0aW5fX19t
ZW1tb3ZlX2NoayAoX19kZXN0LCBfX3NyYywgX19sZW4sIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAo X19kZXN0LCAwKSk7Cn0KIyA3NyAiL3Vzci9pbmNsdWRlL2JpdHMvc3RyaW5nMy5oIiAzIDQKZXh0 ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykp IHZvaWQgKgpfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIG1lbXNldCAo dm9pZCAqX19kZXN0LCBpbnQgX19jaCwgc2l6ZV90IF9fbGVuKQp7CiMgOTAgIi91c3IvaW5jbHVk
ZS9iaXRzL3N0cmluZzMuaCIgMyA0CiAgcmV0dXJuIF9fYnVpbHRpbl9fX21lbXNldF9jaGsgKF9f ZGVzdCwgX19jaCwgX19sZW4sIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kZXN0LCAwKSk7Cn0K CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lh bF9fKSkgdm9pZApfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIGJjb3B5 IChjb25zdCB2b2lkICpfX3NyYywgdm9pZCAqX19kZXN0LCBzaXplX3QgX19sZW4pCnsKICAodm9p
ZCkgX19idWlsdGluX19fbWVtbW92ZV9jaGsgKF9fZGVzdCwgX19zcmMsIF9fbGVuLCBfX2J1aWx0 aW5fb2JqZWN0X3NpemUgKF9fZGVzdCwgMCkpOwp9CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1 dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgdm9pZApfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpIGJ6ZXJvICh2b2lkICpfX2Rlc3QsIHNpemVfdCBfX2xl bikKewogICh2b2lkKSBfX2J1aWx0aW5fX19tZW1zZXRfY2hrIChfX2Rlc3QsICdcMCcsIF9fbGVu
LCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fZGVzdCwgMCkpOwp9CgoKZXh0ZXJuIF9faW5saW5l IF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2du dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGNoYXIgKgpfX2F0
dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIHN0cmNweSAoY2hhciAqX19yZXN0 cmljdCBfX2Rlc3QsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zcmMpCnsKICByZXR1cm4gX19i dWlsdGluX19fc3RyY3B5X2NoayAoX19kZXN0LCBfX3NyYywgX19idWlsdGluX29iamVjdF9zaXpl
IChfX2Rlc3QsIDIgPiAxKSk7Cn0KIyAxMjIgIi91c3IvaW5jbHVkZS9iaXRzL3N0cmluZzMuaCIg MyA0CmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBf X2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmlj
aWFsX18pKSBjaGFyICoKX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBz dHJuY3B5IChjaGFyICpfX3Jlc3RyaWN0IF9fZGVzdCwgY29uc3QgY2hhciAqX19yZXN0cmljdCBf X3NyYywgc2l6ZV90IF9fbGVuKQoKewogIHJldHVybiBfX2J1aWx0aW5fX19zdHJuY3B5X2NoayAo
X19kZXN0LCBfX3NyYywgX19sZW4sIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kZXN0LCAyID4g MSkpOwp9CgoKZXh0ZXJuIGNoYXIgKl9fc3RwbmNweV9jaGsgKGNoYXIgKl9fZGVzdCwgY29uc3Qg Y2hhciAqX19zcmMsIHNpemVfdCBfX24sCiAgICAgICBzaXplX3QgX19kZXN0bGVuKSBfX2F0dHJp
YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwpleHRlcm4gY2hhciAqX19zdHBuY3B5 X2FsaWFzIChjaGFyICpfX2Rlc3QsIGNvbnN0IGNoYXIgKl9fc3JjLCBzaXplX3QgX19uKSBfX2Fz bV9fICgiIiAic3RwbmNweSIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9f
KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9f YXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9p bmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGNoYXIgKgpfX2F0dHJp
YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIHN0cG5jcHkgKGNoYXIgKl9fZGVzdCwg Y29uc3QgY2hhciAqX19zcmMsIHNpemVfdCBfX24pCnsKICBpZiAoX19idWlsdGluX29iamVjdF9z aXplIChfX2Rlc3QsIDIgPiAxKSAhPSAoc2l6ZV90KSAtMQogICAgICAmJiAoIV9fYnVpbHRpbl9j
b25zdGFudF9wIChfX24pIHx8IF9fbiA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kZXN0LCAy ID4gMSkpKQogICAgcmV0dXJuIF9fc3RwbmNweV9jaGsgKF9fZGVzdCwgX19zcmMsIF9fbiwgX19i dWlsdGluX29iamVjdF9zaXplIChfX2Rlc3QsIDIgPiAxKSk7CiAgcmV0dXJuIF9fc3RwbmNweV9h
bGlhcyAoX19kZXN0LCBfX3NyYywgX19uKTsKfQoKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0 ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18p KSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBjaGFyICoKX19hdHRyaWJ1dGVfXyAo
KF9fbm90aHJvd19fICwgX19sZWFmX18pKSBzdHJjYXQgKGNoYXIgKl9fcmVzdHJpY3QgX19kZXN0 LCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fc3JjKQp7CiAgcmV0dXJuIF9fYnVpbHRpbl9fX3N0 cmNhdF9jaGsgKF9fZGVzdCwgX19zcmMsIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kZXN0LCAy
ID4gMSkpOwp9CgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxp bmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChf X2FydGlmaWNpYWxfXykpIGNoYXIgKgpfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl
YWZfXykpIHN0cm5jYXQgKGNoYXIgKl9fcmVzdHJpY3QgX19kZXN0LCBjb25zdCBjaGFyICpfX3Jl c3RyaWN0IF9fc3JjLCBzaXplX3QgX19sZW4pCgp7CiAgcmV0dXJuIF9fYnVpbHRpbl9fX3N0cm5j YXRfY2hrIChfX2Rlc3QsIF9fc3JjLCBfX2xlbiwgX19idWlsdGluX29iamVjdF9zaXplIChfX2Rl
c3QsIDIgPiAxKSk7Cn0KIyA2MzYgIi91c3IvaW5jbHVkZS9zdHJpbmcuaCIgMiAzIDQKIyA2NTgg Ii91c3IvaW5jbHVkZS9zdHJpbmcuaCIgMyA0CgojIDI2ICJjb3JkL2NvcmRic2NzLmMiIDIKIyAz NSAiY29yZC9jb3JkYnNjcy5jIgoKIyAzNSAiY29yZC9jb3JkYnNjcy5jIgp0eXBlZGVmIHZvaWQg
KCogb29tX2ZuKSh2b2lkKTsKCm9vbV9mbiBDT1JEX29vbV9mbiA9IChvb21fZm4pIDA7CgoKCgoK dHlwZWRlZiB1bnNpZ25lZCBsb25nIHdvcmQ7Cgp0eXBlZGVmIHVuaW9uIHsKICAgIHN0cnVjdCBD b25jYXRlbmF0aW9uIHsKICAgICAgICBjaGFyIG51bGw7CiAgICAgICAgY2hhciBoZWFkZXI7CiAg
ICAgICAgY2hhciBkZXB0aDsKICAgICAgICB1bnNpZ25lZCBjaGFyIGxlZnRfbGVuOwoKCgogICAg ICAgIHdvcmQgbGVuOwogICAgICAgIENPUkQgbGVmdDsKICAgICAgICBDT1JEIHJpZ2h0OwogICAg fSBjb25jYXRlbmF0aW9uOwogICAgc3RydWN0IEZ1bmN0aW9uIHsKICAgICAgICBjaGFyIG51bGw7
CiAgICAgICAgY2hhciBoZWFkZXI7CiAgICAgICAgY2hhciBkZXB0aDsKICAgICAgICBjaGFyIGxl ZnRfbGVuOwogICAgICAgIHdvcmQgbGVuOwogICAgICAgIENPUkRfZm4gZm47CiAgICAgICAgdm9p ZCAqIGNsaWVudF9kYXRhOwogICAgfSBmdW5jdGlvbjsKICAgIHN0cnVjdCBHZW5lcmljIHsKICAg
ICAgICBjaGFyIG51bGw7CiAgICAgICAgY2hhciBoZWFkZXI7CiAgICAgICAgY2hhciBkZXB0aDsK ICAgICAgICBjaGFyIGxlZnRfbGVuOwogICAgICAgIHdvcmQgbGVuOwogICAgfSBnZW5lcmljOwog ICAgY2hhciBzdHJpbmdbMV07Cn0gQ29yZFJlcDsKIyAxMDkgImNvcmQvY29yZGJzY3MuYyIKdm9p
ZCBDT1JEX2R1bXBfaW5uZXIoQ09SRCB4LCB1bnNpZ25lZCBuKQp7CiAgICByZWdpc3RlciBzaXpl X3QgaTsKCiAgICBmb3IgKGkgPSAwOyBpIDwgKHNpemVfdCluOyBpKyspIHsKICAgICAgICBmcHV0 cygiICAiLCAKIyAxMTQgImNvcmQvY29yZGJzY3MuYyIgMyA0CiAgICAgICAgICAgICAgICAgICBz
dGRvdXQKIyAxMTQgImNvcmQvY29yZGJzY3MuYyIKICAgICAgICAgICAgICAgICAgICAgICAgICk7 CiAgICB9CiAgICBpZiAoeCA9PSAwKSB7CiAgICAgICAgZnB1dHMoIk5JTFxuIiwgCiMgMTE3ICJj b3JkL2NvcmRic2NzLmMiIDMgNAogICAgICAgICAgICAgICAgICAgICAgc3Rkb3V0CiMgMTE3ICJj
b3JkL2NvcmRic2NzLmMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgfSBlbHNl IGlmICgoKih4KSAhPSAnXDAnKSkgewogICAgICAgIGZvciAoaSA9IDA7IGkgPD0gKHNpemVvZihD b3JkUmVwKSAtIDEpOyBpKyspIHsKICAgICAgICAgICAgaWYgKHhbaV0gPT0gJ1wwJykgYnJlYWs7
CiAgICAgICAgICAgIHB1dGNoYXIoeFtpXSk7CiAgICAgICAgfQogICAgICAgIGlmICh4W2ldICE9 ICdcMCcpIGZwdXRzKCIuLi4iLCAKIyAxMjMgImNvcmQvY29yZGJzY3MuYyIgMyA0CiAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Rkb3V0CiMgMTIzICJjb3JkL2NvcmRic2Nz
LmMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAg ICBwdXRjaGFyKCdcbicpOwogICAgfSBlbHNlIGlmICgoKChDb3JkUmVwICopeCktPmdlbmVyaWMu aGVhZGVyID09IDEpKSB7CiAgICAgICAgcmVnaXN0ZXIgc3RydWN0IENvbmNhdGVuYXRpb24gKiBj
b25jID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmKCgoQ29yZFJlcCAqKXgpIC0+ IGNvbmNhdGVuYXRpb24pOwogICAgICAgIHByaW50ZigiQ29uY2F0ZW5hdGlvbjogJXAgKGxlbjog JWQsIGRlcHRoOiAlZClcbiIsCiAgICAgICAgICAgICAgIHgsIChpbnQpKGNvbmMgLT4gbGVuKSwg
KGludCkoY29uYyAtPiBkZXB0aCkpOwogICAgICAgIENPUkRfZHVtcF9pbm5lcihjb25jIC0+IGxl ZnQsIG4rMSk7CiAgICAgICAgQ09SRF9kdW1wX2lubmVyKGNvbmMgLT4gcmlnaHQsIG4rMSk7CiAg ICB9IGVsc2UgewogICAgICAgIHJlZ2lzdGVyIHN0cnVjdCBGdW5jdGlvbiAqIGZ1bmMgPQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICYoKChDb3JkUmVwICopeCkgLT4gZnVuY3Rpb24p OwogICAgICAgIGlmICgoKChDb3JkUmVwICopeCktPmdlbmVyaWMuaGVhZGVyID09IDYpKSBwcmlu dGYoIihTdWJzdHJpbmcpICIpOwogICAgICAgIHByaW50ZigiRnVuY3Rpb246ICVwIChsZW46ICVk
KTogIiwgeCwgKGludCkoZnVuYyAtPiBsZW4pKTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMjAg JiYgaSA8IGZ1bmMgLT4gbGVuOyBpKyspIHsKICAgICAgICAgICAgcHV0Y2hhcigoKihmdW5jIC0+ IGZuKSkoaSwgZnVuYyAtPiBjbGllbnRfZGF0YSkpOwogICAgICAgIH0KICAgICAgICBpZiAoaSA8
IGZ1bmMgLT4gbGVuKSBmcHV0cygiLi4uIiwgCiMgMTQwICJjb3JkL2NvcmRic2NzLmMiIDMgNAog ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZG91dAojIDE0MCAiY29y ZC9jb3JkYnNjcy5jIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICk7CiAgICAgICAgcHV0Y2hhcignXG4nKTsKICAgIH0KfQoKCnZvaWQgQ09SRF9kdW1wKENP UkQgeCkKewogICAgQ09SRF9kdW1wX2lubmVyKHgsIDApOwogICAgZmZsdXNoKAojIDE0OSAiY29y ZC9jb3JkYnNjcy5jIiAzIDQKICAgICAgICAgIHN0ZG91dAojIDE0OSAiY29yZC9jb3JkYnNjcy5j
IgogICAgICAgICAgICAgICAgKTsKfQoKQ09SRCBDT1JEX2NhdF9jaGFyX3N0YXIoQ09SRCB4LCBj b25zdCBjaGFyICogeSwgc2l6ZV90IGxlbnkpCnsKICAgIHJlZ2lzdGVyIHNpemVfdCByZXN1bHRf bGVuOwogICAgcmVnaXN0ZXIgc2l6ZV90IGxlbng7CiAgICByZWdpc3RlciBpbnQgZGVwdGg7Cgog
ICAgaWYgKHggPT0gMCkgcmV0dXJuKHkpOwogICAgaWYgKGxlbnkgPT0gMCkgcmV0dXJuKHgpOwog ICAgaWYgKCgqKHgpICE9ICdcMCcpKSB7CiAgICAgICAgbGVueCA9IHN0cmxlbih4KTsKICAgICAg ICByZXN1bHRfbGVuID0gbGVueCArIGxlbnk7CiAgICAgICAgaWYgKHJlc3VsdF9sZW4gPD0gKHNp
emVvZihDb3JkUmVwKSAtIDEpKSB7CiAgICAgICAgICAgIHJlZ2lzdGVyIGNoYXIgKiByZXN1bHQg PSBHQ19tYWxsb2NfYXRvbWljKHJlc3VsdF9sZW4rMSk7CgogICAgICAgICAgICBpZiAocmVzdWx0 ID09IDApIHsgaWYgKENPUkRfb29tX2ZuICE9IChvb21fZm4pIDApICgqQ09SRF9vb21fZm4pKCk7
IHsgZnByaW50ZigKIyAxNjYgImNvcmQvY29yZGJzY3MuYyIgMyA0CiAgICAgICAgICAgICAgICAg ICAgICAgICAgICBzdGRlcnIKIyAxNjYgImNvcmQvY29yZGJzY3MuYyIKICAgICAgICAgICAgICAg ICAgICAgICAgICAgICwgIiVzXG4iLCAiT3V0IG9mIG1lbW9yeVxuIik7IGFib3J0KCk7IH07IH07
CiAgICAgICAgICAgIG1lbWNweShyZXN1bHQsIHgsIGxlbngpOwogICAgICAgICAgICBtZW1jcHko cmVzdWx0ICsgbGVueCwgeSwgbGVueSk7CiAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRfbGVuXSA9 ICdcMCc7CiAgICAgICAgICAgIHJldHVybigoQ09SRCkgcmVzdWx0KTsKICAgICAgICB9IGVsc2Ug
ewogICAgICAgICAgICBkZXB0aCA9IDE7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBy ZWdpc3RlciBDT1JEIHJpZ2h0OwogICAgICAgIHJlZ2lzdGVyIENPUkQgbGVmdDsKICAgICAgICBy ZWdpc3RlciBjaGFyICogbmV3X3JpZ2h0OwogICAgICAgIHJlZ2lzdGVyIHNpemVfdCByaWdodF9s
ZW47CgogICAgICAgIGxlbnggPSAoKChDb3JkUmVwICopeCkgLT4gZ2VuZXJpYy5sZW4pOwoKICAg ICAgICBpZiAobGVueSA8PSAoc2l6ZW9mKENvcmRSZXApIC0gMSkvMgogICAgICAgICAgICAmJiAo KChDb3JkUmVwICopeCktPmdlbmVyaWMuaGVhZGVyID09IDEpCiAgICAgICAgICAgICYmICgqKHJp
Z2h0ID0gKChDb3JkUmVwICopeCkgLT4gY29uY2F0ZW5hdGlvbi5yaWdodCkgIT0gJ1wwJykpIHsK CiAgICAgICAgICAgIGlmICghKCoobGVmdCA9ICgoQ29yZFJlcCAqKXgpIC0+IGNvbmNhdGVuYXRp b24ubGVmdCkgIT0gJ1wwJykpIHsKICAgICAgICAgICAgICAgIHJpZ2h0X2xlbiA9IGxlbnggLSAo
KChDb3JkUmVwICopbGVmdCkgLT4gZ2VuZXJpYy5sZW4pOwogICAgICAgICAgICB9IGVsc2UgaWYg KCgoQ29yZFJlcCAqKXgpIC0+IGNvbmNhdGVuYXRpb24ubGVmdF9sZW4gIT0gMCkgewogICAgICAg ICAgICAgICAgcmlnaHRfbGVuID0gbGVueCAtICgoQ29yZFJlcCAqKXgpIC0+IGNvbmNhdGVuYXRp
b24ubGVmdF9sZW47CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByaWdodF9s ZW4gPSBzdHJsZW4ocmlnaHQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlc3VsdF9sZW4g PSByaWdodF9sZW4gKyBsZW55OwogICAgICAgICAgICBpZiAocmVzdWx0X2xlbiA8PSAoc2l6ZW9m
KENvcmRSZXApIC0gMSkpIHsKICAgICAgICAgICAgICAgIG5ld19yaWdodCA9IEdDX21hbGxvY19h dG9taWMocmVzdWx0X2xlbiArIDEpOwogICAgICAgICAgICAgICAgaWYgKG5ld19yaWdodCA9PSAw KSB7IGlmIChDT1JEX29vbV9mbiAhPSAob29tX2ZuKSAwKSAoKkNPUkRfb29tX2ZuKSgpOyB7IGZw
cmludGYoCiMgMTk2ICJjb3JkL2NvcmRic2NzLmMiIDMgNAogICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgIHN0ZGVycgojIDE5NiAiY29yZC9jb3JkYnNjcy5jIgogICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICwgIiVzXG4iLCAiT3V0IG9mIG1lbW9yeVxuIik7IGFib3J0
KCk7IH07IH07CiAgICAgICAgICAgICAgICBtZW1jcHkobmV3X3JpZ2h0LCByaWdodCwgcmlnaHRf bGVuKTsKICAgICAgICAgICAgICAgIG1lbWNweShuZXdfcmlnaHQgKyByaWdodF9sZW4sIHksIGxl bnkpOwogICAgICAgICAgICAgICAgbmV3X3JpZ2h0W3Jlc3VsdF9sZW5dID0gJ1wwJzsKICAgICAg
ICAgICAgICAgIHkgPSBuZXdfcmlnaHQ7CiAgICAgICAgICAgICAgICBsZW55ID0gcmVzdWx0X2xl bjsKICAgICAgICAgICAgICAgIHggPSBsZWZ0OwogICAgICAgICAgICAgICAgbGVueCAtPSByaWdo dF9sZW47CgogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgoKih4KSAhPSAnXDAnKSkgewog
ICAgICAgICAgICAgICAgZGVwdGggPSAxOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAg ICAgICAgZGVwdGggPSAoKChDb3JkUmVwICopeCkgLT4gZ2VuZXJpYy5kZXB0aCkgKyAxOwogICAg ICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGVwdGggPSAoKChDb3JkUmVw
ICopeCkgLT4gZ2VuZXJpYy5kZXB0aCkgKyAxOwogICAgICAgIH0KICAgICAgICByZXN1bHRfbGVu ID0gbGVueCArIGxlbnk7CiAgICB9CiAgICB7CgogICAgICAgIHJlZ2lzdGVyIHN0cnVjdCBDb25j YXRlbmF0aW9uICogcmVzdWx0OwoKICAgICAgICByZXN1bHQgPSAoKHN0cnVjdCBDb25jYXRlbmF0
aW9uKilHQ19tYWxsb2Moc2l6ZW9mKHN0cnVjdCBDb25jYXRlbmF0aW9uKSkpOwogICAgICAgIGlm IChyZXN1bHQgPT0gMCkgeyBpZiAoQ09SRF9vb21fZm4gIT0gKG9vbV9mbikgMCkgKCpDT1JEX29v bV9mbikoKTsgeyBmcHJpbnRmKAojIDIyMSAiY29yZC9jb3JkYnNjcy5jIiAzIDQKICAgICAgICAg
ICAgICAgICAgICAgICAgc3RkZXJyCiMgMjIxICJjb3JkL2NvcmRic2NzLmMiCiAgICAgICAgICAg ICAgICAgICAgICAgICwgIiVzXG4iLCAiT3V0IG9mIG1lbW9yeVxuIik7IGFib3J0KCk7IH07IH07 CiAgICAgICAgcmVzdWx0LT5oZWFkZXIgPSAxOwogICAgICAgIHJlc3VsdC0+ZGVwdGggPSBkZXB0
aDsKICAgICAgICBpZiAobGVueCA8PSAyNTUpIHJlc3VsdC0+bGVmdF9sZW4gPSBsZW54OwogICAg ICAgIHJlc3VsdC0+bGVuID0gcmVzdWx0X2xlbjsKICAgICAgICByZXN1bHQtPmxlZnQgPSB4Owog ICAgICAgIHJlc3VsdC0+cmlnaHQgPSB5OwogICAgICAgIGlmIChkZXB0aCA+PSA0OCkgewogICAg
ICAgICAgICByZXR1cm4oQ09SRF9iYWxhbmNlKChDT1JEKXJlc3VsdCkpOwogICAgICAgIH0gZWxz ZSB7CiAgICAgICAgICAgIHJldHVybigoQ09SRCkgcmVzdWx0KTsKICAgICAgICB9CiAgICB9Cn0K CgpDT1JEIENPUkRfY2F0KENPUkQgeCwgQ09SRCB5KQp7CiAgICByZWdpc3RlciBzaXplX3QgcmVz
dWx0X2xlbjsKICAgIHJlZ2lzdGVyIGludCBkZXB0aDsKICAgIHJlZ2lzdGVyIHNpemVfdCBsZW54 OwoKICAgIGlmICh4ID09IDApIHJldHVybih5KTsKICAgIGlmICh5ID09IDApIHJldHVybih4KTsK ICAgIGlmICgoKih5KSAhPSAnXDAnKSkgewogICAgICAgIHJldHVybihDT1JEX2NhdF9jaGFyX3N0
YXIoeCwgeSwgc3RybGVuKHkpKSk7CiAgICB9IGVsc2UgaWYgKCgqKHgpICE9ICdcMCcpKSB7CiAg ICAgICAgbGVueCA9IHN0cmxlbih4KTsKICAgICAgICBkZXB0aCA9ICgoKENvcmRSZXAgKil5KSAt PiBnZW5lcmljLmRlcHRoKSArIDE7CiAgICB9IGVsc2UgewogICAgICAgIHJlZ2lzdGVyIGludCBk
ZXB0aHkgPSAoKChDb3JkUmVwICopeSkgLT4gZ2VuZXJpYy5kZXB0aCk7CgogICAgICAgIGxlbngg PSAoKChDb3JkUmVwICopeCkgLT4gZ2VuZXJpYy5sZW4pOwogICAgICAgIGRlcHRoID0gKCgoQ29y ZFJlcCAqKXgpIC0+IGdlbmVyaWMuZGVwdGgpICsgMTsKICAgICAgICBpZiAoZGVwdGh5ID49IGRl
cHRoKSBkZXB0aCA9IGRlcHRoeSArIDE7CiAgICB9CiAgICByZXN1bHRfbGVuID0gbGVueCArICgo KENvcmRSZXAgKil5KSAtPiBnZW5lcmljLmxlbik7CiAgICB7CiAgICAgICAgcmVnaXN0ZXIgc3Ry dWN0IENvbmNhdGVuYXRpb24gKiByZXN1bHQ7CgogICAgICAgIHJlc3VsdCA9ICgoc3RydWN0IENv
bmNhdGVuYXRpb24qKUdDX21hbGxvYyhzaXplb2Yoc3RydWN0IENvbmNhdGVuYXRpb24pKSk7CiAg ICAgICAgaWYgKHJlc3VsdCA9PSAwKSB7IGlmIChDT1JEX29vbV9mbiAhPSAob29tX2ZuKSAwKSAo KkNPUkRfb29tX2ZuKSgpOyB7IGZwcmludGYoCiMgMjYyICJjb3JkL2NvcmRic2NzLmMiIDMgNAog
ICAgICAgICAgICAgICAgICAgICAgICBzdGRlcnIKIyAyNjIgImNvcmQvY29yZGJzY3MuYyIKICAg ICAgICAgICAgICAgICAgICAgICAgLCAiJXNcbiIsICJPdXQgb2YgbWVtb3J5XG4iKTsgYWJvcnQo KTsgfTsgfTsKICAgICAgICByZXN1bHQtPmhlYWRlciA9IDE7CiAgICAgICAgcmVzdWx0LT5kZXB0
aCA9IGRlcHRoOwogICAgICAgIGlmIChsZW54IDw9IDI1NSkgcmVzdWx0LT5sZWZ0X2xlbiA9IGxl bng7CiAgICAgICAgcmVzdWx0LT5sZW4gPSByZXN1bHRfbGVuOwogICAgICAgIHJlc3VsdC0+bGVm dCA9IHg7CiAgICAgICAgcmVzdWx0LT5yaWdodCA9IHk7CiAgICAgICAgaWYgKGRlcHRoID49IDQ4
KSB7CiAgICAgICAgICAgIHJldHVybihDT1JEX2JhbGFuY2UoKENPUkQpcmVzdWx0KSk7CiAgICAg ICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuKChDT1JEKSByZXN1bHQpOwogICAgICAgIH0K ICAgIH0KfQoKCgpDT1JEIENPUkRfZnJvbV9mbihDT1JEX2ZuIGZuLCB2b2lkICogY2xpZW50X2Rh
dGEsIHNpemVfdCBsZW4pCnsKICAgIGlmIChsZW4gPD0gMCkgcmV0dXJuKDApOwogICAgaWYgKGxl biA8PSAoc2l6ZW9mKENvcmRSZXApIC0gMSkpIHsKICAgICAgICByZWdpc3RlciBjaGFyICogcmVz dWx0OwogICAgICAgIHJlZ2lzdGVyIHNpemVfdCBpOwogICAgICAgIGNoYXIgYnVmWyhzaXplb2Yo
Q29yZFJlcCkgLSAxKSsxXTsKICAgICAgICByZWdpc3RlciBjaGFyIGM7CgogICAgICAgIGZvciAo aSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICBjID0gKCpmbikoaSwgY2xpZW50X2Rh dGEpOwogICAgICAgICAgICBpZiAoYyA9PSAnXDAnKSBnb3RvIGdlbl9jYXNlOwogICAgICAgICAg
ICBidWZbaV0gPSBjOwogICAgICAgIH0KCiAgICAgICAgcmVzdWx0ID0gR0NfbWFsbG9jX2F0b21p YyhsZW4rMSk7CiAgICAgICAgaWYgKHJlc3VsdCA9PSAwKSB7IGlmIChDT1JEX29vbV9mbiAhPSAo b29tX2ZuKSAwKSAoKkNPUkRfb29tX2ZuKSgpOyB7IGZwcmludGYoCiMgMjk1ICJjb3JkL2NvcmRi
c2NzLmMiIDMgNAogICAgICAgICAgICAgICAgICAgICAgICBzdGRlcnIKIyAyOTUgImNvcmQvY29y ZGJzY3MuYyIKICAgICAgICAgICAgICAgICAgICAgICAgLCAiJXNcbiIsICJPdXQgb2YgbWVtb3J5 XG4iKTsgYWJvcnQoKTsgfTsgfTsKICAgICAgICBtZW1jcHkocmVzdWx0LCBidWYsIGxlbik7CiAg
ICAgICAgcmVzdWx0W2xlbl0gPSAnXDAnOwogICAgICAgIHJldHVybigoQ09SRCkgcmVzdWx0KTsK ICAgIH0KICBnZW5fY2FzZToKICAgIHsKICAgICAgICByZWdpc3RlciBzdHJ1Y3QgRnVuY3Rpb24g KiByZXN1bHQ7CgogICAgICAgIHJlc3VsdCA9ICgoc3RydWN0IEZ1bmN0aW9uKilHQ19tYWxsb2Mo
c2l6ZW9mKHN0cnVjdCBGdW5jdGlvbikpKTsKICAgICAgICBpZiAocmVzdWx0ID09IDApIHsgaWYg KENPUkRfb29tX2ZuICE9IChvb21fZm4pIDApICgqQ09SRF9vb21fZm4pKCk7IHsgZnByaW50ZigK IyAzMDUgImNvcmQvY29yZGJzY3MuYyIgMyA0CiAgICAgICAgICAgICAgICAgICAgICAgIHN0ZGVy
cgojIDMwNSAiY29yZC9jb3JkYnNjcy5jIgogICAgICAgICAgICAgICAgICAgICAgICAsICIlc1xu IiwgIk91dCBvZiBtZW1vcnlcbiIpOyBhYm9ydCgpOyB9OyB9OwogICAgICAgIHJlc3VsdC0+aGVh ZGVyID0gNDsKCiAgICAgICAgcmVzdWx0LT5sZW4gPSBsZW47CiAgICAgICAgcmVzdWx0LT5mbiA9
IGZuOwogICAgICAgIHJlc3VsdC0+Y2xpZW50X2RhdGEgPSBjbGllbnRfZGF0YTsKICAgICAgICBy ZXR1cm4oKENPUkQpIHJlc3VsdCk7CiAgICB9Cn0KCnNpemVfdCBDT1JEX2xlbihDT1JEIHgpCnsK ICAgIGlmICh4ID09IDApIHsKICAgICAgICByZXR1cm4oMCk7CiAgICB9IGVsc2UgewogICAgICAg
IHJldHVybigoKCooeCkgIT0gJ1wwJykgPyBzdHJsZW4oeCkgOiAoKChDb3JkUmVwICopeCkgLT4g Z2VuZXJpYy5sZW4pKSk7CiAgICB9Cn0KCnN0cnVjdCBzdWJzdHJfYXJncyB7CiAgICBDb3JkUmVw ICogc2FfY29yZDsKICAgIHNpemVfdCBzYV9pbmRleDsKfTsKCmNoYXIgQ09SRF9pbmRleF9hY2Nl
c3NfZm4oc2l6ZV90IGksIHZvaWQgKiBjbGllbnRfZGF0YSkKewogICAgcmVnaXN0ZXIgc3RydWN0 IHN1YnN0cl9hcmdzICpkZXNjciA9IChzdHJ1Y3Qgc3Vic3RyX2FyZ3MgKiljbGllbnRfZGF0YTsK CiAgICByZXR1cm4oKChjaGFyICopKGRlc2NyLT5zYV9jb3JkKSlbaSArIGRlc2NyLT5zYV9pbmRl
eF0pOwp9CgpjaGFyIENPUkRfYXBwbHlfYWNjZXNzX2ZuKHNpemVfdCBpLCB2b2lkICogY2xpZW50 X2RhdGEpCnsKICAgIHJlZ2lzdGVyIHN0cnVjdCBzdWJzdHJfYXJncyAqZGVzY3IgPSAoc3RydWN0 IHN1YnN0cl9hcmdzICopY2xpZW50X2RhdGE7CiAgICByZWdpc3RlciBzdHJ1Y3QgRnVuY3Rpb24g
KiBmbl9jb3JkID0gJihkZXNjci0+c2FfY29yZC0+ZnVuY3Rpb24pOwoKICAgIHJldHVybigoKihm bl9jb3JkLT5mbikpKGkgKyBkZXNjci0+c2FfaW5kZXgsIGZuX2NvcmQtPmNsaWVudF9kYXRhKSk7 Cn0KCgoKCgpDT1JEIENPUkRfc3Vic3RyX2Nsb3N1cmUoQ09SRCB4LCBzaXplX3QgaSwgc2l6ZV90
IG4sIENPUkRfZm4gZikKewogICAgcmVnaXN0ZXIgc3RydWN0IHN1YnN0cl9hcmdzICogc2EgPSAo KHN0cnVjdCBzdWJzdHJfYXJncyopR0NfbWFsbG9jKHNpemVvZihzdHJ1Y3Qgc3Vic3RyX2FyZ3Mp KSk7CiAgICBDT1JEIHJlc3VsdDsKCiAgICBpZiAoc2EgPT0gMCkgeyBpZiAoQ09SRF9vb21fZm4g
IT0gKG9vbV9mbikgMCkgKCpDT1JEX29vbV9mbikoKTsgeyBmcHJpbnRmKAojIDM1MyAiY29yZC9j b3JkYnNjcy5jIiAzIDQKICAgICAgICAgICAgICAgIHN0ZGVycgojIDM1MyAiY29yZC9jb3JkYnNj cy5jIgogICAgICAgICAgICAgICAgLCAiJXNcbiIsICJPdXQgb2YgbWVtb3J5XG4iKTsgYWJvcnQo
KTsgfTsgfTsKICAgIHNhLT5zYV9jb3JkID0gKENvcmRSZXAgKil4OwogICAgc2EtPnNhX2luZGV4 ID0gaTsKICAgIHJlc3VsdCA9IENPUkRfZnJvbV9mbihmLCAodm9pZCAqKXNhLCBuKTsKICAgIGlm IChyZXN1bHQgPT0gMCkgcmV0dXJuIDA7CiAgICAoKENvcmRSZXAgKilyZXN1bHQpIC0+IGZ1bmN0
aW9uLmhlYWRlciA9IDY7CiAgICByZXR1cm4gKHJlc3VsdCk7Cn0KCgoKCgoKCkNPUkQgQ09SRF9z dWJzdHJfY2hlY2tlZChDT1JEIHgsIHNpemVfdCBpLCBzaXplX3QgbikKewogICAgaWYgKCgqKHgp ICE9ICdcMCcpKSB7CiAgICAgICAgaWYgKG4gPiAoMTAgKiAoc2l6ZW9mKENvcmRSZXApIC0gMSkp
KSB7CiAgICAgICAgICAgIHJldHVybihDT1JEX3N1YnN0cl9jbG9zdXJlKHgsIGksIG4sIENPUkRf aW5kZXhfYWNjZXNzX2ZuKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVnaXN0ZXIg Y2hhciAqIHJlc3VsdCA9IEdDX21hbGxvY19hdG9taWMobisxKTsKCiAgICAgICAgICAgIGlmIChy
ZXN1bHQgPT0gMCkgeyBpZiAoQ09SRF9vb21fZm4gIT0gKG9vbV9mbikgMCkgKCpDT1JEX29vbV9m bikoKTsgeyBmcHJpbnRmKAojIDM3NiAiY29yZC9jb3JkYnNjcy5jIiAzIDQKICAgICAgICAgICAg ICAgICAgICAgICAgICAgIHN0ZGVycgojIDM3NiAiY29yZC9jb3JkYnNjcy5jIgogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgLCAiJXNcbiIsICJPdXQgb2YgbWVtb3J5XG4iKTsgYWJvcnQoKTsg fTsgfTsKICAgICAgICAgICAgc3RybmNweShyZXN1bHQsIHgraSwgbik7CiAgICAgICAgICAgIHJl c3VsdFtuXSA9ICdcMCc7CiAgICAgICAgICAgIHJldHVybihyZXN1bHQpOwogICAgICAgIH0KICAg
IH0gZWxzZSBpZiAoKCgoQ29yZFJlcCAqKXgpLT5nZW5lcmljLmhlYWRlciA9PSAxKSkgewogICAg ICAgIHJlZ2lzdGVyIHN0cnVjdCBDb25jYXRlbmF0aW9uICogY29uYwogICAgICAgICAgICAgICAg ICAgICAgICA9ICYoKChDb3JkUmVwICopeCkgLT4gY29uY2F0ZW5hdGlvbik7CiAgICAgICAgcmVn
aXN0ZXIgc2l6ZV90IGxlZnRfbGVuOwogICAgICAgIHJlZ2lzdGVyIHNpemVfdCByaWdodF9sZW47 CgogICAgICAgIGxlZnRfbGVuID0gKChjb25jKSAtPiBsZWZ0X2xlbiAhPSAwPyAoY29uYykgLT4g bGVmdF9sZW4gOiAoKCooKGNvbmMpIC0+IGxlZnQpICE9ICdcMCcpID8gKGNvbmMpIC0+IGxlbiAt
ICgoKigoY29uYykgLT4gcmlnaHQpICE9ICdcMCcpID8gc3RybGVuKChjb25jKSAtPiByaWdodCkg OiAoKChDb3JkUmVwICopKGNvbmMpIC0+IHJpZ2h0KSAtPiBnZW5lcmljLmxlbikpIDogKCgoQ29y ZFJlcCAqKShjb25jKSAtPiBsZWZ0KSAtPiBnZW5lcmljLmxlbikpKTsKICAgICAgICByaWdodF9s
ZW4gPSBjb25jIC0+IGxlbiAtIGxlZnRfbGVuOwogICAgICAgIGlmIChpID49IGxlZnRfbGVuKSB7 CiAgICAgICAgICAgIGlmIChuID09IHJpZ2h0X2xlbikgcmV0dXJuKGNvbmMgLT4gcmlnaHQpOwog ICAgICAgICAgICByZXR1cm4oQ09SRF9zdWJzdHJfY2hlY2tlZChjb25jIC0+IHJpZ2h0LCBpIC0g
bGVmdF9sZW4sIG4pKTsKICAgICAgICB9IGVsc2UgaWYgKGkrbiA8PSBsZWZ0X2xlbikgewogICAg ICAgICAgICBpZiAobiA9PSBsZWZ0X2xlbikgcmV0dXJuKGNvbmMgLT4gbGVmdCk7CiAgICAgICAg ICAgIHJldHVybihDT1JEX3N1YnN0cl9jaGVja2VkKGNvbmMgLT4gbGVmdCwgaSwgbikpOwogICAg
ICAgIH0gZWxzZSB7CgogICAgICAgICAgICByZWdpc3RlciBDT1JEIGxlZnRfcGFydDsKICAgICAg ICAgICAgcmVnaXN0ZXIgQ09SRCByaWdodF9wYXJ0OwogICAgICAgICAgICByZWdpc3RlciBzaXpl X3QgbGVmdF9wYXJ0X2xlbiA9IGxlZnRfbGVuIC0gaTsKCiAgICAgICAgICAgIGlmIChpID09IDAp
IHsKICAgICAgICAgICAgICAgIGxlZnRfcGFydCA9IGNvbmMgLT4gbGVmdDsKICAgICAgICAgICAg fSBlbHNlIHsKICAgICAgICAgICAgICAgIGxlZnRfcGFydCA9IENPUkRfc3Vic3RyX2NoZWNrZWQo Y29uYyAtPiBsZWZ0LCBpLCBsZWZ0X3BhcnRfbGVuKTsKICAgICAgICAgICAgfQogICAgICAgICAg
ICBpZiAoaSArIG4gPT0gcmlnaHRfbGVuICsgbGVmdF9sZW4pIHsKICAgICAgICAgICAgICAgICBy aWdodF9wYXJ0ID0gY29uYyAtPiByaWdodDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAg ICAgICAgICByaWdodF9wYXJ0ID0gQ09SRF9zdWJzdHJfY2hlY2tlZChjb25jIC0+IHJpZ2h0LCAw
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gLSBs ZWZ0X3BhcnRfbGVuKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4oQ09SRF9jYXQo bGVmdF9wYXJ0LCByaWdodF9wYXJ0KSk7CiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICBp
ZiAobiA+ICgxMCAqIChzaXplb2YoQ29yZFJlcCkgLSAxKSkpIHsKICAgICAgICAgICAgaWYgKCgo KENvcmRSZXAgKil4KS0+Z2VuZXJpYy5oZWFkZXIgPT0gNikpIHsKCiAgICAgICAgICAgICAgICBy ZWdpc3RlciBzdHJ1Y3QgRnVuY3Rpb24gKiBmID0gJigoKENvcmRSZXAgKil4KSAtPiBmdW5jdGlv
bik7CiAgICAgICAgICAgICAgICByZWdpc3RlciBzdHJ1Y3Qgc3Vic3RyX2FyZ3MgKmRlc2NyID0K ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc3RydWN0IHN1YnN0cl9hcmdzICopKGYg LT4gY2xpZW50X2RhdGEpOwoKICAgICAgICAgICAgICAgIHJldHVybihDT1JEX3N1YnN0cl9jbG9z
dXJlKChDT1JEKWRlc2NyLT5zYV9jb3JkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgaSArIGRlc2NyLT5zYV9pbmRleCwKICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgIG4sIGYgLT4gZm4pKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAg
ICAgICAgICAgICAgIHJldHVybihDT1JEX3N1YnN0cl9jbG9zdXJlKHgsIGksIG4sIENPUkRfYXBw bHlfYWNjZXNzX2ZuKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAg ICBjaGFyICogcmVzdWx0OwogICAgICAgICAgICByZWdpc3RlciBzdHJ1Y3QgRnVuY3Rpb24gKiBm
ID0gJigoKENvcmRSZXAgKil4KSAtPiBmdW5jdGlvbik7CiAgICAgICAgICAgIGNoYXIgYnVmWygx MCAqIChzaXplb2YoQ29yZFJlcCkgLSAxKSkrMV07CiAgICAgICAgICAgIHJlZ2lzdGVyIGNoYXIg KiBwID0gYnVmOwogICAgICAgICAgICByZWdpc3RlciBjaGFyIGM7CiAgICAgICAgICAgIHJlZ2lz
dGVyIGludCBqOwogICAgICAgICAgICByZWdpc3RlciBpbnQgbGltID0gaSArIG47CgogICAgICAg ICAgICBmb3IgKGogPSBpOyBqIDwgbGltOyBqKyspIHsKICAgICAgICAgICAgICAgIGMgPSAoKihm IC0+IGZuKSkoaiwgZiAtPiBjbGllbnRfZGF0YSk7CiAgICAgICAgICAgICAgICBpZiAoYyA9PSAn
XDAnKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuKENPUkRfc3Vic3RyX2Nsb3N1cmUoeCwg aSwgbiwgQ09SRF9hcHBseV9hY2Nlc3NfZm4pKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAg ICAgICAgICpwKysgPSBjOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlc3VsdCA9IEdDX21h
bGxvY19hdG9taWMobisxKTsKICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSAwKSB7IGlmIChDT1JE X29vbV9mbiAhPSAob29tX2ZuKSAwKSAoKkNPUkRfb29tX2ZuKSgpOyB7IGZwcmludGYoCiMgNDQ1 ICJjb3JkL2NvcmRic2NzLmMiIDMgNAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RkZXJy
CiMgNDQ1ICJjb3JkL2NvcmRic2NzLmMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsICIl c1xuIiwgIk91dCBvZiBtZW1vcnlcbiIpOyBhYm9ydCgpOyB9OyB9OwogICAgICAgICAgICBtZW1j cHkocmVzdWx0LCBidWYsIG4pOwogICAgICAgICAgICByZXN1bHRbbl0gPSAnXDAnOwogICAgICAg
ICAgICByZXR1cm4ocmVzdWx0KTsKICAgICAgICB9CiAgICB9Cn0KCkNPUkQgQ09SRF9zdWJzdHIo Q09SRCB4LCBzaXplX3QgaSwgc2l6ZV90IG4pCnsKICAgIHJlZ2lzdGVyIHNpemVfdCBsZW4gPSBD T1JEX2xlbih4KTsKCiAgICBpZiAoaSA+PSBsZW4gfHwgbiA8PSAwKSByZXR1cm4oMCk7CgoKICAg
IGlmIChpICsgbiA+IGxlbikgbiA9IGxlbiAtIGk7CiAgICByZXR1cm4oQ09SRF9zdWJzdHJfY2hl Y2tlZCh4LCBpLCBuKSk7Cn0KCgppbnQgQ09SRF9pdGVyNShDT1JEIHgsIHNpemVfdCBpLCBDT1JE X2l0ZXJfZm4gZjEsCiAgICAgICAgICAgICAgICAgICAgICAgICBDT1JEX2JhdGNoZWRfaXRlcl9m
biBmMiwgdm9pZCAqIGNsaWVudF9kYXRhKQp7CiAgICBpZiAoeCA9PSAwKSByZXR1cm4oMCk7CiAg ICBpZiAoKCooeCkgIT0gJ1wwJykpIHsKICAgICAgICByZWdpc3RlciBjb25zdCBjaGFyICpwID0g eCtpOwoKICAgICAgICBpZiAoKnAgPT0gJ1wwJykgeyBmcHJpbnRmKAojIDQ3MiAiY29yZC9jb3Jk
YnNjcy5jIiAzIDQKICAgICAgICAgICAgICAgICAgICAgICBzdGRlcnIKIyA0NzIgImNvcmQvY29y ZGJzY3MuYyIKICAgICAgICAgICAgICAgICAgICAgICAsICIlc1xuIiwgIjJuZCBhcmcgdG8gQ09S RF9pdGVyNSB0b28gYmlnIik7IGFib3J0KCk7IH07CiAgICAgICAgaWYgKGYyICE9ICgoQ09SRF9i
YXRjaGVkX2l0ZXJfZm4pMCkpIHsKICAgICAgICAgICAgcmV0dXJuKCgqZjIpKHAsIGNsaWVudF9k YXRhKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgd2hpbGUgKCpwKSB7CiAgICAgICAg ICAgICAgICBpZiAoKCpmMSkoKnAsIGNsaWVudF9kYXRhKSkgcmV0dXJuKDEpOwogICAgICAgICAg
ICAgICAgcCsrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybigwKTsKICAgICAgICB9 CiAgICB9IGVsc2UgaWYgKCgoKENvcmRSZXAgKil4KS0+Z2VuZXJpYy5oZWFkZXIgPT0gMSkpIHsK ICAgICAgICByZWdpc3RlciBzdHJ1Y3QgQ29uY2F0ZW5hdGlvbiAqIGNvbmMKICAgICAgICAgICAg
ICAgICAgICAgICAgPSAmKCgoQ29yZFJlcCAqKXgpIC0+IGNvbmNhdGVuYXRpb24pOwoKCiAgICAg ICAgaWYgKGkgPiAwKSB7CiAgICAgICAgICAgIHJlZ2lzdGVyIHNpemVfdCBsZWZ0X2xlbiA9ICgo Y29uYykgLT4gbGVmdF9sZW4gIT0gMD8gKGNvbmMpIC0+IGxlZnRfbGVuIDogKCgqKChjb25jKSAt
PiBsZWZ0KSAhPSAnXDAnKSA/IChjb25jKSAtPiBsZW4gLSAoKCooKGNvbmMpIC0+IHJpZ2h0KSAh PSAnXDAnKSA/IHN0cmxlbigoY29uYykgLT4gcmlnaHQpIDogKCgoQ29yZFJlcCAqKShjb25jKSAt PiByaWdodCkgLT4gZ2VuZXJpYy5sZW4pKSA6ICgoKENvcmRSZXAgKikoY29uYykgLT4gbGVmdCkg
LT4gZ2VuZXJpYy5sZW4pKSk7CgogICAgICAgICAgICBpZiAoaSA+PSBsZWZ0X2xlbikgewogICAg ICAgICAgICAgICAgcmV0dXJuKENPUkRfaXRlcjUoY29uYyAtPiByaWdodCwgaSAtIGxlZnRfbGVu LCBmMSwgZjIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRfZGF0YSkp
OwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChDT1JEX2l0ZXI1KGNvbmMgLT4g bGVmdCwgaSwgZjEsIGYyLCBjbGllbnRfZGF0YSkpIHsKICAgICAgICAgICAgcmV0dXJuKDEpOwog ICAgICAgIH0KICAgICAgICByZXR1cm4oQ09SRF9pdGVyNShjb25jIC0+IHJpZ2h0LCAwLCBmMSwg
ZjIsIGNsaWVudF9kYXRhKSk7CiAgICB9IGVsc2UgewogICAgICAgIHJlZ2lzdGVyIHN0cnVjdCBG dW5jdGlvbiAqIGYgPSAmKCgoQ29yZFJlcCAqKXgpIC0+IGZ1bmN0aW9uKTsKICAgICAgICByZWdp c3RlciBzaXplX3QgajsKICAgICAgICByZWdpc3RlciBzaXplX3QgbGltID0gZiAtPiBsZW47Cgog
ICAgICAgIGZvciAoaiA9IGk7IGogPCBsaW07IGorKykgewogICAgICAgICAgICBpZiAoKCpmMSko KCooZiAtPiBmbikpKGosIGYgLT4gY2xpZW50X2RhdGEpLCBjbGllbnRfZGF0YSkpIHsKICAgICAg ICAgICAgICAgIHJldHVybigxKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1
cm4oMCk7CiAgICB9Cn0KCgppbnQgQ09SRF9pdGVyKENPUkQgeCwgQ09SRF9pdGVyX2ZuIGYxLCB2 b2lkICogY2xpZW50X2RhdGEpCnsKICAgIHJldHVybihDT1JEX2l0ZXI1KHgsIDAsIGYxLCAoKENP UkRfYmF0Y2hlZF9pdGVyX2ZuKTApLCBjbGllbnRfZGF0YSkpOwp9CgppbnQgQ09SRF9yaXRlcjQo
Q09SRCB4LCBzaXplX3QgaSwgQ09SRF9pdGVyX2ZuIGYxLCB2b2lkICogY2xpZW50X2RhdGEpCnsK ICAgIGlmICh4ID09IDApIHJldHVybigwKTsKICAgIGlmICgoKih4KSAhPSAnXDAnKSkgewogICAg ICAgIHJlZ2lzdGVyIGNvbnN0IGNoYXIgKnAgPSB4ICsgaTsKICAgICAgICByZWdpc3RlciBjaGFy
IGM7CgogICAgICAgIGZvcig7OykgewogICAgICAgICAgICBjID0gKnA7CiAgICAgICAgICAgIGlm IChjID09ICdcMCcpIHsgZnByaW50ZigKIyA1MjggImNvcmQvY29yZGJzY3MuYyIgMyA0CiAgICAg ICAgICAgICAgICAgICAgICAgICAgc3RkZXJyCiMgNTI4ICJjb3JkL2NvcmRic2NzLmMiCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgLCAiJXNcbiIsICIybmQgYXJnIHRvIENPUkRfcml0ZXI0IHRv byBiaWciKTsgYWJvcnQoKTsgfTsKICAgICAgICAgICAgaWYgKCgqZjEpKGMsIGNsaWVudF9kYXRh KSkgcmV0dXJuKDEpOwogICAgICAgICAgICBpZiAocCA9PSB4KSBicmVhazsKICAgICAgICAgICAg
cC0tOwogICAgICAgIH0KICAgICAgICByZXR1cm4oMCk7CiAgICB9IGVsc2UgaWYgKCgoKENvcmRS ZXAgKil4KS0+Z2VuZXJpYy5oZWFkZXIgPT0gMSkpIHsKICAgICAgICByZWdpc3RlciBzdHJ1Y3Qg Q29uY2F0ZW5hdGlvbiAqIGNvbmMKICAgICAgICAgICAgICAgICAgICAgICAgPSAmKCgoQ29yZFJl
cCAqKXgpIC0+IGNvbmNhdGVuYXRpb24pOwogICAgICAgIHJlZ2lzdGVyIENPUkQgbGVmdF9wYXJ0 ID0gY29uYyAtPiBsZWZ0OwogICAgICAgIHJlZ2lzdGVyIHNpemVfdCBsZWZ0X2xlbjsKCiAgICAg ICAgbGVmdF9sZW4gPSAoKGNvbmMpIC0+IGxlZnRfbGVuICE9IDA/IChjb25jKSAtPiBsZWZ0X2xl
biA6ICgoKigoY29uYykgLT4gbGVmdCkgIT0gJ1wwJykgPyAoY29uYykgLT4gbGVuIC0gKCgqKChj b25jKSAtPiByaWdodCkgIT0gJ1wwJykgPyBzdHJsZW4oKGNvbmMpIC0+IHJpZ2h0KSA6ICgoKENv cmRSZXAgKikoY29uYykgLT4gcmlnaHQpIC0+IGdlbmVyaWMubGVuKSkgOiAoKChDb3JkUmVwICop
KGNvbmMpIC0+IGxlZnQpIC0+IGdlbmVyaWMubGVuKSkpOwogICAgICAgIGlmIChpID49IGxlZnRf bGVuKSB7CiAgICAgICAgICAgIGlmIChDT1JEX3JpdGVyNChjb25jIC0+IHJpZ2h0LCBpIC0gbGVm dF9sZW4sIGYxLCBjbGllbnRfZGF0YSkpIHsKICAgICAgICAgICAgICAgIHJldHVybigxKTsKICAg
ICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4oQ09SRF9yaXRlcjQobGVmdF9wYXJ0LCBsZWZ0 X2xlbiAtIDEsIGYxLCBjbGllbnRfZGF0YSkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAg IHJldHVybihDT1JEX3JpdGVyNChsZWZ0X3BhcnQsIGksIGYxLCBjbGllbnRfZGF0YSkpOwogICAg
ICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgcmVnaXN0ZXIgc3RydWN0IEZ1bmN0aW9uICogZiA9 ICYoKChDb3JkUmVwICopeCkgLT4gZnVuY3Rpb24pOwogICAgICAgIHJlZ2lzdGVyIHNpemVfdCBq OwoKICAgICAgICBmb3IgKGogPSBpOyA7IGotLSkgewogICAgICAgICAgICBpZiAoKCpmMSkoKCoo
ZiAtPiBmbikpKGosIGYgLT4gY2xpZW50X2RhdGEpLCBjbGllbnRfZGF0YSkpIHsKICAgICAgICAg ICAgICAgIHJldHVybigxKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoaiA9PSAwKSBy ZXR1cm4oMCk7CiAgICAgICAgfQogICAgfQp9CgppbnQgQ09SRF9yaXRlcihDT1JEIHgsIENPUkRf
aXRlcl9mbiBmMSwgdm9pZCAqIGNsaWVudF9kYXRhKQp7CiAgICBzaXplX3QgbGVuID0gQ09SRF9s ZW4oeCk7CiAgICBpZiAobGVuID09IDApIHJldHVybigwKTsKICAgIHJldHVybihDT1JEX3JpdGVy NCh4LCBsZW4gLSAxLCBmMSwgY2xpZW50X2RhdGEpKTsKfQojIDU4NCAiY29yZC9jb3JkYnNjcy5j
Igp0eXBlZGVmIHN0cnVjdCB7CiAgICBDT1JEIGM7CiAgICBzaXplX3QgbGVuOwp9IEZvcmVzdEVs ZW1lbnQ7CgpzdGF0aWMgc2l6ZV90IG1pbl9sZW4gWyA0OCBdOwoKc3RhdGljIGludCBtaW5fbGVu X2luaXQgPSAwOwoKaW50IENPUkRfbWF4X2xlbjsKCnR5cGVkZWYgRm9yZXN0RWxlbWVudCBGb3Jl
c3QgWyA0OCBdOwoKCgoKCnZvaWQgQ09SRF9pbml0X21pbl9sZW4oKQp7CiAgICByZWdpc3RlciBp bnQgaTsKICAgIHJlZ2lzdGVyIHNpemVfdCBsYXN0LCBwcmV2aW91cywgY3VycmVudDsKCiAgICBt aW5fbGVuWzBdID0gcHJldmlvdXMgPSAxOwogICAgbWluX2xlblsxXSA9IGxhc3QgPSAyOwogICAg
Zm9yIChpID0gMjsgaSA8IDQ4OyBpKyspIHsKICAgICAgICBjdXJyZW50ID0gbGFzdCArIHByZXZp b3VzOwogICAgICAgIGlmIChjdXJyZW50IDwgbGFzdCkgY3VycmVudCA9IGxhc3Q7CiAgICAgICAg bWluX2xlbltpXSA9IGN1cnJlbnQ7CiAgICAgICAgcHJldmlvdXMgPSBsYXN0OwogICAgICAgIGxh
c3QgPSBjdXJyZW50OwogICAgfQogICAgQ09SRF9tYXhfbGVuID0gbGFzdCAtIDE7CiAgICBtaW5f bGVuX2luaXQgPSAxOwp9CgoKdm9pZCBDT1JEX2luaXRfZm9yZXN0KEZvcmVzdEVsZW1lbnQgKiBm b3Jlc3QsIHNpemVfdCBtYXhfbGVuKQp7CiAgICByZWdpc3RlciBpbnQgaTsKCiAgICBmb3IgKGkg
PSAwOyBpIDwgNDg7IGkrKykgewogICAgICAgIGZvcmVzdFtpXS5jID0gMDsKICAgICAgICBpZiAo bWluX2xlbltpXSA+IG1heF9sZW4pIHJldHVybjsKICAgIH0KICAgIHsgZnByaW50ZigKIyA2Mjgg ImNvcmQvY29yZGJzY3MuYyIgMyA0CiAgIHN0ZGVycgojIDYyOCAiY29yZC9jb3JkYnNjcy5jIgog
ICAsICIlc1xuIiwgIkNvcmQgdG9vIGxvbmciKTsgYWJvcnQoKTsgfTsKfQoKCgoKCgp2b2lkIENP UkRfYWRkX2ZvcmVzdChGb3Jlc3RFbGVtZW50ICogZm9yZXN0LCBDT1JEIHgsIHNpemVfdCBsZW4p CnsKICAgIHJlZ2lzdGVyIGludCBpID0gMDsKICAgIHJlZ2lzdGVyIENPUkQgc3VtID0gMDsKICAg
IHJlZ2lzdGVyIHNpemVfdCBzdW1fbGVuID0gMDsKCiAgICB3aGlsZSAobGVuID4gbWluX2xlbltp ICsgMV0pIHsKICAgICAgICBpZiAoZm9yZXN0W2ldLmMgIT0gMCkgewogICAgICAgICAgICBzdW0g PSBDT1JEX2NhdChmb3Jlc3RbaV0uYywgc3VtKTsKICAgICAgICAgICAgc3VtX2xlbiArPSBmb3Jl
c3RbaV0ubGVuOwogICAgICAgICAgICBmb3Jlc3RbaV0uYyA9IDA7CiAgICAgICAgfQogICAgICAg IGkrKzsKICAgIH0KCgogICAgc3VtID0gQ09SRF9jYXQoc3VtLCB4KTsKICAgIHN1bV9sZW4gKz0g bGVuOwoKCgogICAgd2hpbGUgKHN1bV9sZW4gPj0gbWluX2xlbltpXSkgewogICAgICAgIGlmIChm
b3Jlc3RbaV0uYyAhPSAwKSB7CiAgICAgICAgICAgIHN1bSA9IENPUkRfY2F0KGZvcmVzdFtpXS5j LCBzdW0pOwogICAgICAgICAgICBzdW1fbGVuICs9IGZvcmVzdFtpXS5sZW47CgoKICAgICAgICAg ICAgZm9yZXN0W2ldLmMgPSAwOwogICAgICAgIH0KICAgICAgICBpKys7CiAgICB9CiAgICBpLS07
CiAgICBmb3Jlc3RbaV0uYyA9IHN1bTsKICAgIGZvcmVzdFtpXS5sZW4gPSBzdW1fbGVuOwp9CgpD T1JEIENPUkRfY29uY2F0X2ZvcmVzdChGb3Jlc3RFbGVtZW50ICogZm9yZXN0LCBzaXplX3QgZXhw ZWN0ZWRfbGVuKQp7CiAgICByZWdpc3RlciBpbnQgaSA9IDA7CiAgICBDT1JEIHN1bSA9IDA7CiAg
ICBzaXplX3Qgc3VtX2xlbiA9IDA7CgogICAgd2hpbGUgKHN1bV9sZW4gIT0gZXhwZWN0ZWRfbGVu KSB7CiAgICAgICAgaWYgKGZvcmVzdFtpXS5jICE9IDApIHsKICAgICAgICAgICAgc3VtID0gQ09S RF9jYXQoZm9yZXN0W2ldLmMsIHN1bSk7CiAgICAgICAgICAgIHN1bV9sZW4gKz0gZm9yZXN0W2ld
LmxlbjsKICAgICAgICB9CiAgICAgICAgaSsrOwogICAgfQogICAgcmV0dXJuKHN1bSk7Cn0KCgoK CnZvaWQgQ09SRF9iYWxhbmNlX2luc2VydChDT1JEIHgsIHNpemVfdCBsZW4sIEZvcmVzdEVsZW1l bnQgKiBmb3Jlc3QpCnsKICAgIHJlZ2lzdGVyIGludCBkZXB0aDsKCiAgICBpZiAoKCooeCkgIT0g
J1wwJykpIHsKICAgICAgICBDT1JEX2FkZF9mb3Jlc3QoZm9yZXN0LCB4LCBsZW4pOwogICAgfSBl bHNlIGlmICgoKChDb3JkUmVwICopeCktPmdlbmVyaWMuaGVhZGVyID09IDEpCiAgICAgICAgICAg ICAgICYmICgoZGVwdGggPSAoKChDb3JkUmVwICopeCkgLT4gZ2VuZXJpYy5kZXB0aCkpID49IDQ4
CiAgICAgICAgICAgICAgICAgICB8fCBsZW4gPCBtaW5fbGVuW2RlcHRoXSkpIHsKICAgICAgICBy ZWdpc3RlciBzdHJ1Y3QgQ29uY2F0ZW5hdGlvbiAqIGNvbmMKICAgICAgICAgICAgICAgICAgICAg ICAgPSAmKCgoQ29yZFJlcCAqKXgpIC0+IGNvbmNhdGVuYXRpb24pOwogICAgICAgIHNpemVfdCBs
ZWZ0X2xlbiA9ICgoY29uYykgLT4gbGVmdF9sZW4gIT0gMD8gKGNvbmMpIC0+IGxlZnRfbGVuIDog KCgqKChjb25jKSAtPiBsZWZ0KSAhPSAnXDAnKSA/IChjb25jKSAtPiBsZW4gLSAoKCooKGNvbmMp IC0+IHJpZ2h0KSAhPSAnXDAnKSA/IHN0cmxlbigoY29uYykgLT4gcmlnaHQpIDogKCgoQ29yZFJl
cCAqKShjb25jKSAtPiByaWdodCkgLT4gZ2VuZXJpYy5sZW4pKSA6ICgoKENvcmRSZXAgKikoY29u YykgLT4gbGVmdCkgLT4gZ2VuZXJpYy5sZW4pKSk7CgogICAgICAgIENPUkRfYmFsYW5jZV9pbnNl cnQoY29uYyAtPiBsZWZ0LCBsZWZ0X2xlbiwgZm9yZXN0KTsKICAgICAgICBDT1JEX2JhbGFuY2Vf
aW5zZXJ0KGNvbmMgLT4gcmlnaHQsIGxlbiAtIGxlZnRfbGVuLCBmb3Jlc3QpOwogICAgfSBlbHNl IHsKICAgICAgICBDT1JEX2FkZF9mb3Jlc3QoZm9yZXN0LCB4LCBsZW4pOwogICAgfQp9CgoKQ09S RCBDT1JEX2JhbGFuY2UoQ09SRCB4KQp7CiAgICBGb3Jlc3QgZm9yZXN0OwogICAgcmVnaXN0ZXIg
c2l6ZV90IGxlbjsKCiAgICBpZiAoeCA9PSAwKSByZXR1cm4oMCk7CiAgICBpZiAoKCooeCkgIT0g J1wwJykpIHJldHVybih4KTsKICAgIGlmICghbWluX2xlbl9pbml0KSBDT1JEX2luaXRfbWluX2xl bigpOwogICAgbGVuID0gKCgoQ29yZFJlcCAqKXgpIC0+IGdlbmVyaWMubGVuKTsKICAgIENPUkRf
aW5pdF9mb3Jlc3QoZm9yZXN0LCBsZW4pOwogICAgQ09SRF9iYWxhbmNlX2luc2VydCh4LCBsZW4s IGZvcmVzdCk7CiAgICByZXR1cm4oQ09SRF9jb25jYXRfZm9yZXN0KGZvcmVzdCwgbGVuKSk7Cn0K IyA3MzQgImNvcmQvY29yZGJzY3MuYyIKdm9pZCBDT1JEX19leHRlbmRfcGF0aChyZWdpc3RlciBD
T1JEX3BvcyBwKQp7CiAgICAgcmVnaXN0ZXIgc3RydWN0IENPUkRfcGUgKiBjdXJyZW50X3BlID0g JihwWzBdLnBhdGhbcFswXS5wYXRoX2xlbl0pOwogICAgIHJlZ2lzdGVyIENPUkQgdG9wID0gY3Vy cmVudF9wZSAtPiBwZV9jb3JkOwogICAgIHJlZ2lzdGVyIHNpemVfdCBwb3MgPSBwWzBdLmN1cl9w
b3M7CiAgICAgcmVnaXN0ZXIgc2l6ZV90IHRvcF9wb3MgPSBjdXJyZW50X3BlIC0+IHBlX3N0YXJ0 X3BvczsKICAgICByZWdpc3RlciBzaXplX3QgdG9wX2xlbiA9ICgoKih0b3ApICE9ICdcMCcpID8g c3RybGVuKHRvcCkgOiAoKChDb3JkUmVwICopdG9wKSAtPiBnZW5lcmljLmxlbikpOwoKCiAgICAg
ICB3aGlsZSghKCoodG9wKSAhPSAnXDAnKSAmJiAoKChDb3JkUmVwICopdG9wKS0+Z2VuZXJpYy5o ZWFkZXIgPT0gMSkpIHsKICAgICAgICAgcmVnaXN0ZXIgc3RydWN0IENvbmNhdGVuYXRpb24gKiBj b25jID0KICAgICAgICAgICAgICAgICAgICAgICAgJigoKENvcmRSZXAgKil0b3ApIC0+IGNvbmNh
dGVuYXRpb24pOwogICAgICAgICByZWdpc3RlciBzaXplX3QgbGVmdF9sZW47CgogICAgICAgICBs ZWZ0X2xlbiA9ICgoY29uYykgLT4gbGVmdF9sZW4gIT0gMD8gKGNvbmMpIC0+IGxlZnRfbGVuIDog KCgqKChjb25jKSAtPiBsZWZ0KSAhPSAnXDAnKSA/IChjb25jKSAtPiBsZW4gLSAoKCooKGNvbmMp
IC0+IHJpZ2h0KSAhPSAnXDAnKSA/IHN0cmxlbigoY29uYykgLT4gcmlnaHQpIDogKCgoQ29yZFJl cCAqKShjb25jKSAtPiByaWdodCkgLT4gZ2VuZXJpYy5sZW4pKSA6ICgoKENvcmRSZXAgKikoY29u YykgLT4gbGVmdCkgLT4gZ2VuZXJpYy5sZW4pKSk7CiAgICAgICAgIGN1cnJlbnRfcGUrKzsKICAg
ICAgICAgaWYgKHBvcyA+PSB0b3BfcG9zICsgbGVmdF9sZW4pIHsKICAgICAgICAgICAgIGN1cnJl bnRfcGUgLT4gcGVfY29yZCA9IHRvcCA9IGNvbmMgLT4gcmlnaHQ7CiAgICAgICAgICAgICBjdXJy ZW50X3BlIC0+IHBlX3N0YXJ0X3BvcyA9IHRvcF9wb3MgPSB0b3BfcG9zICsgbGVmdF9sZW47CiAg
ICAgICAgICAgICB0b3BfbGVuIC09IGxlZnRfbGVuOwogICAgICAgICB9IGVsc2UgewogICAgICAg ICAgICAgY3VycmVudF9wZSAtPiBwZV9jb3JkID0gdG9wID0gY29uYyAtPiBsZWZ0OwogICAgICAg ICAgICAgY3VycmVudF9wZSAtPiBwZV9zdGFydF9wb3MgPSB0b3BfcG9zOwogICAgICAgICAgICAg
dG9wX2xlbiA9IGxlZnRfbGVuOwogICAgICAgICB9CiAgICAgICAgIHBbMF0ucGF0aF9sZW4rKzsK ICAgICAgIH0KCiAgICAgICBpZiAoKCoodG9wKSAhPSAnXDAnKSkgewogICAgICAgICBwWzBdLmN1 cl9sZWFmID0gdG9wOwogICAgICAgICBwWzBdLmN1cl9zdGFydCA9IHRvcF9wb3M7CiAgICAgICAg
IHBbMF0uY3VyX2VuZCA9IHRvcF9wb3MgKyB0b3BfbGVuOwogICAgICAgfSBlbHNlIHsKICAgICAg ICAgcFswXS5jdXJfZW5kID0gMDsKICAgICAgIH0KICAgICAgIGlmIChwb3MgPj0gdG9wX3BvcyAr IHRvcF9sZW4pIHBbMF0ucGF0aF9sZW4gPSAoMHg1NTU1NTU1NSk7Cn0KCmNoYXIgQ09SRF9fcG9z
X2ZldGNoKHJlZ2lzdGVyIENPUkRfcG9zIHApCnsKCiAgICBzdHJ1Y3QgQ09SRF9wZSAqIHBlID0g JigocClbMF0ucGF0aFsocClbMF0ucGF0aF9sZW5dKTsKICAgIENPUkQgbGVhZiA9IHBlIC0+IHBl X2NvcmQ7CiAgICByZWdpc3RlciBzdHJ1Y3QgRnVuY3Rpb24gKiBmID0gJigoKENvcmRSZXAgKils
ZWFmKSAtPiBmdW5jdGlvbik7CgogICAgaWYgKCEoKCgoQ29yZFJlcCAqKWxlYWYpLT5nZW5lcmlj LmhlYWRlciAmIDQpICE9IDApKSB7IGZwcmludGYoCiMgNzc5ICJjb3JkL2NvcmRic2NzLmMiIDMg NAogICAgICAgICAgICAgICAgICAgICAgICAgICBzdGRlcnIKIyA3NzkgImNvcmQvY29yZGJzY3Mu
YyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgLCAiJXNcbiIsICJDT1JEX3Bvc19mZXRjaDog YmFkIGxlYWYiKTsgYWJvcnQoKTsgfTsKICAgIHJldHVybiAoKCooZiAtPiBmbikpKHBbMF0uY3Vy X3BvcyAtIHBlIC0+IHBlX3N0YXJ0X3BvcywgZiAtPiBjbGllbnRfZGF0YSkpOwp9CgpfX2F0dHJp
YnV0ZV9fKChvcHRpbWl6ZSgoIk8xIikpKSkgdm9pZCBDT1JEX19uZXh0KHJlZ2lzdGVyIENPUkRf cG9zIHApCnsKICAgIHJlZ2lzdGVyIHNpemVfdCBjdXJfcG9zID0gcFswXS5jdXJfcG9zICsgMTsK ICAgIHJlZ2lzdGVyIHN0cnVjdCBDT1JEX3BlICogY3VycmVudF9wZSA9ICYoKHApWzBdLnBhdGhb
KHApWzBdLnBhdGhfbGVuXSk7CiAgICByZWdpc3RlciBDT1JEIGxlYWYgPSBjdXJyZW50X3BlIC0+ IHBlX2NvcmQ7CgoKICAgIHBbMF0uY3VyX3BvcyA9IGN1cl9wb3M7CiAgICBpZiAoISgqKGxlYWYp ICE9ICdcMCcpKSB7CgogICAgICAgIHJlZ2lzdGVyIHN0cnVjdCBGdW5jdGlvbiAqIGYgPSAmKCgo
Q29yZFJlcCAqKWxlYWYpIC0+IGZ1bmN0aW9uKTsKICAgICAgICByZWdpc3RlciBzaXplX3Qgc3Rh cnRfcG9zID0gY3VycmVudF9wZSAtPiBwZV9zdGFydF9wb3M7CiAgICAgICAgcmVnaXN0ZXIgc2l6 ZV90IGVuZF9wb3MgPSBzdGFydF9wb3MgKyBmIC0+IGxlbjsKCiAgICAgICAgaWYgKGN1cl9wb3Mg
PCBlbmRfcG9zKSB7CgogICAgICAgICAgICByZWdpc3RlciBzaXplX3QgaTsKICAgICAgICAgICAg cmVnaXN0ZXIgc2l6ZV90IGxpbWl0ID0gY3VyX3BvcyArIDg7CiAgICAgICAgICAgIHJlZ2lzdGVy IENPUkRfZm4gZm4gPSBmIC0+IGZuOwogICAgICAgICAgICByZWdpc3RlciB2b2lkICogY2xpZW50
X2RhdGEgPSBmIC0+IGNsaWVudF9kYXRhOwoKICAgICAgICAgICAgaWYgKGxpbWl0ID4gZW5kX3Bv cykgewogICAgICAgICAgICAgICAgbGltaXQgPSBlbmRfcG9zOwogICAgICAgICAgICB9CiAgICAg ICAgICAgIGZvciAoaSA9IGN1cl9wb3M7IGkgPCBsaW1pdDsgaSsrKSB7CiAgICAgICAgICAgICAg
ICBwWzBdLmZ1bmN0aW9uX2J1ZltpIC0gY3VyX3Bvc10gPQogICAgICAgICAgICAgICAgICAgICAg ICAoKmZuKShpIC0gc3RhcnRfcG9zLCBjbGllbnRfZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAg ICAgICAgcFswXS5jdXJfc3RhcnQgPSBjdXJfcG9zOwogICAgICAgICAgICBwWzBdLmN1cl9sZWFm
ID0gcFswXS5mdW5jdGlvbl9idWY7CiAgICAgICAgICAgIHBbMF0uY3VyX2VuZCA9IGxpbWl0Owog ICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgfQoKCgogICAgewogICAgICAgIHdoaWxl IChwWzBdLnBhdGhfbGVuID4gMAogICAgICAgICAgICAgICAmJiBjdXJyZW50X3BlWzBdLnBlX3N0
YXJ0X3BvcyAhPSBjdXJyZW50X3BlWy0xXS5wZV9zdGFydF9wb3MpIHsKICAgICAgICAgICAgcFsw XS5wYXRoX2xlbi0tOwogICAgICAgICAgICBjdXJyZW50X3BlLS07CiAgICAgICAgfQogICAgICAg IGlmIChwWzBdLnBhdGhfbGVuID09IDApIHsKICAgICAgICAgICAgcFswXS5wYXRoX2xlbiA9ICgw
eDU1NTU1NTU1KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KICAgIHBbMF0u cGF0aF9sZW4tLTsKICAgIENPUkRfX2V4dGVuZF9wYXRoKHApOwp9Cgp2b2lkIENPUkRfX3ByZXYo cmVnaXN0ZXIgQ09SRF9wb3MgcCkKewogICAgcmVnaXN0ZXIgc3RydWN0IENPUkRfcGUgKiBwZSA9
ICYocFswXS5wYXRoW3BbMF0ucGF0aF9sZW5dKTsKCiAgICBpZiAocFswXS5jdXJfcG9zID09IDAp IHsKICAgICAgICBwWzBdLnBhdGhfbGVuID0gKDB4NTU1NTU1NTUpOwogICAgICAgIHJldHVybjsK ICAgIH0KICAgIHBbMF0uY3VyX3Bvcy0tOwogICAgaWYgKHBbMF0uY3VyX3BvcyA+PSBwZSAtPiBw
ZV9zdGFydF9wb3MpIHJldHVybjsKCgoKCgogICAgewogICAgICAgIHJlZ2lzdGVyIHN0cnVjdCBD T1JEX3BlICogY3VycmVudF9wZSA9ICYoKHApWzBdLnBhdGhbKHApWzBdLnBhdGhfbGVuXSk7Cgog ICAgICAgIHdoaWxlIChwWzBdLnBhdGhfbGVuID4gMAogICAgICAgICAgICAgICAmJiBjdXJyZW50
X3BlWzBdLnBlX3N0YXJ0X3BvcyA9PSBjdXJyZW50X3BlWy0xXS5wZV9zdGFydF9wb3MpIHsKICAg ICAgICAgICAgcFswXS5wYXRoX2xlbi0tOwogICAgICAgICAgICBjdXJyZW50X3BlLS07CiAgICAg ICAgfQogICAgfQogICAgcFswXS5wYXRoX2xlbi0tOwogICAgQ09SRF9fZXh0ZW5kX3BhdGgocCk7
Cn0KIyA4NzAgImNvcmQvY29yZGJzY3MuYyIKY2hhciBDT1JEX3Bvc19mZXRjaChyZWdpc3RlciBD T1JEX3BvcyBwKQp7CiAgICBpZiAocFswXS5jdXJfc3RhcnQgPD0gcFswXS5jdXJfcG9zICYmIHBb MF0uY3VyX3BvcyA8IHBbMF0uY3VyX2VuZCkgewogICAgICAgIHJldHVybihwWzBdLmN1cl9sZWFm
W3BbMF0uY3VyX3BvcyAtIHBbMF0uY3VyX3N0YXJ0XSk7CiAgICB9IGVsc2UgewogICAgICAgIHJl dHVybihDT1JEX19wb3NfZmV0Y2gocCkpOwogICAgfQp9Cgp2b2lkIENPUkRfbmV4dChDT1JEX3Bv cyBwKQp7CiAgICBpZiAocFswXS5jdXJfcG9zIDwgcFswXS5jdXJfZW5kIC0gMSkgewogICAgICAg
IHBbMF0uY3VyX3BvcysrOwogICAgfSBlbHNlIHsKICAgICAgICBDT1JEX19uZXh0KHApOwogICAg fQp9Cgp2b2lkIENPUkRfcHJldihDT1JEX3BvcyBwKQp7CiAgICBpZiAocFswXS5jdXJfZW5kICE9 IDAgJiYgcFswXS5jdXJfcG9zID4gcFswXS5jdXJfc3RhcnQpIHsKICAgICAgICBwWzBdLmN1cl9w
b3MtLTsKICAgIH0gZWxzZSB7CiAgICAgICAgQ09SRF9fcHJldihwKTsKICAgIH0KfQoKc2l6ZV90 IENPUkRfcG9zX3RvX2luZGV4KENPUkRfcG9zIHApCnsKICAgIHJldHVybihwWzBdLmN1cl9wb3Mp Owp9CgpDT1JEIENPUkRfcG9zX3RvX2NvcmQoQ09SRF9wb3MgcCkKewogICAgcmV0dXJuKHBbMF0u
cGF0aFswXS5wZV9jb3JkKTsKfQoKaW50IENPUkRfcG9zX3ZhbGlkKENPUkRfcG9zIHApCnsKICAg IHJldHVybihwWzBdLnBhdGhfbGVuICE9ICgweDU1NTU1NTU1KSk7Cn0KCnZvaWQgQ09SRF9zZXRf cG9zKENPUkRfcG9zIHAsIENPUkQgeCwgc2l6ZV90IGkpCnsKICAgIGlmICh4ID09IDApIHsKICAg
ICAgICBwWzBdLnBhdGhfbGVuID0gKDB4NTU1NTU1NTUpOwogICAgICAgIHJldHVybjsKICAgIH0K ICAgIHBbMF0ucGF0aFswXS5wZV9jb3JkID0geDsKICAgIHBbMF0ucGF0aFswXS5wZV9zdGFydF9w b3MgPSAwOwogICAgcFswXS5wYXRoX2xlbiA9IDA7CiAgICBwWzBdLmN1cl9wb3MgPSBpOwogICAg
Q09SRF9fZXh0ZW5kX3BhdGgocCk7Cn0K
</data>

</attachment>

</bug>

</bugzilla>
