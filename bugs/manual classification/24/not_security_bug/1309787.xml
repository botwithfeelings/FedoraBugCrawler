<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1" urlbase="https://bugzilla.redhat.com/" maintainer="bugzilla-error-list@redhat.com">

  <bug>
    <bug_id>1309787</bug_id>

    <creation_ts>2016-02-18 12:04:00 -0500</creation_ts>
    <short_desc>groupadd segfaults in libaudit</short_desc>
    <delta_ts>2016-03-03 04:15:16 -0500</delta_ts>
    <reporter_accessible>1</reporter_accessible>
    <cclist_accessible>1</cclist_accessible>
    <classification_id>2</classification_id>
    <classification>Fedora</classification>
    <product>Fedora</product>
    <component>gcc</component>
    <version>24</version>
    <rep_platform>s390x</rep_platform>
    <op_sys>Unspecified</op_sys>
    <bug_status>CLOSED</bug_status>
    <resolution>RAWHIDE</resolution>

    <bug_file_loc></bug_file_loc>
    <status_whiteboard></status_whiteboard>
    <keywords></keywords>
    <priority>unspecified</priority>
    <bug_severity>unspecified</bug_severity>
    <target_milestone>---</target_milestone>

    <blocked>467765</blocked>
    <everconfirmed>1</everconfirmed>
    <reporter name="Dan Horák">dan</reporter>
    <assigned_to name="Jakub Jelinek">jakub</assigned_to>
    <cc>davejohansen</cc>

    <cc>jakub</cc>

    <cc>jwakely</cc>

    <cc>law</cc>

    <cc>mpolacek</cc>

    <cc>sgrubb</cc>
    <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>

    <cf_fixed_in>gcc-6.0.0-0.14.fc24</cf_fixed_in>
  <cf_doc_type>Bug Fix</cf_doc_type>
<cf_release_notes></cf_release_notes>
<cf_story_points>---</cf_story_points>

<cf_environment></cf_environment>
<cf_last_closed>2016-03-03 04:15:16</cf_last_closed>
<cf_type>Bug</cf_type>
<cf_regression_status>---</cf_regression_status>
<cf_mount_type>---</cf_mount_type>
<cf_documentation_action>---</cf_documentation_action>
<cf_crm></cf_crm>
<cf_verified_branch></cf_verified_branch>
<cf_category>---</cf_category>
<cf_ovirt_team>---</cf_ovirt_team>

<cf_cloudforms_team>---</cf_cloudforms_team>
<external_bugs name="GNU Compiler Collection">70025</external_bugs>

<target_release>---</target_release>

<votes>0</votes>

<comment_sort_order>oldest_to_newest</comment_sort_order>
<long_desc isprivate="0">
<commentid>9076435</commentid>
<comment_count>0</comment_count>
<who name="Dan Horák">dan</who>
<bug_when>2016-02-18 12:04:44 -0500</bug_when>
<thetext>groupadd segfaults in libaudit code, see below for details from F-24 mock chroot. &lt;mock-chroot&gt;sh-4.3# gdb groupadd GNU gdb (GDB) Fedora 7.10.50.20160121-46.fc24 Copyright (C) 2016 Free Software Foundation, Inc. License GPLv3+: GNU GPL
version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt; This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. Type &quot;show copying&quot; and &quot;show warranty&quot; for
details. This GDB was configured as &quot;s390x-redhat-linux-gnu&quot;. Type &quot;show configuration&quot; for configuration details. For bug reporting instructions, please see: &lt;http://www.gnu.org/software/gdb/bugs/&gt;. Find the GDB manual and
other documentation resources online at: &lt;http://www.gnu.org/software/gdb/documentation/&gt;. For help, type &quot;help&quot;. Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;... Reading symbols from
groupadd...Reading symbols from /usr/lib/debug/usr/sbin/groupadd.debug...done. done. (gdb) set args foo1 (gdb) run The program being debugged has been started already. Start it from the beginning? (y or n) y Starting program: /usr/sbin/groupadd foo1
Program received signal SIGSEGV, Segmentation fault. check_ack (seq=&lt;optimized out&gt;, fd=&lt;optimized out&gt;) at netlink.c:287 287 int error = rep.error-&gt;error; (gdb) where #0 check_ack (seq=&lt;optimized out&gt;, fd=&lt;optimized out&gt;)
at netlink.c:287 #1 audit_send_internal (fd=fd@entry=3, type=type@entry=1116, data=data@entry=0x3ffffffcfc6, size=&lt;optimized out&gt;) at netlink.c:244 #2 0x000003fffdfac592 in audit_send_user_message_internal (fd=fd@entry=3, type=type@entry=1116,
hide_error=hide_error@entry=REAL_ERR, message=message@entry=0x3ffffffcfc6 &quot;op=add-group id=1001 exe=\&quot;/usr/sbin/groupadd\&quot; hostname=? addr=? terminal=? res=success&quot;) at deprecated.c:47 #3 0x000003fffdfab874 in
audit_log_acct_message (audit_fd=&lt;optimized out&gt;, type=&lt;optimized out&gt;, pgname=&lt;optimized out&gt;, op=0x2aa0000c3ec &quot;add-group&quot;, name=0x3fffffff8ef &quot;foo1&quot;, id=1001, host=&lt;optimized out&gt;, addr=0x0,
tty=&lt;optimized out&gt;, result=1) at audit_logging.c:457 #4 0x000002aa00004d44 in audit_logger (type=&lt;optimized out&gt;, pgname=&lt;optimized out&gt;, op=&lt;optimized out&gt;, name=0x3fffffff8ef &quot;foo1&quot;, id=&lt;optimized out&gt;,
result=SHADOW_AUDIT_SUCCESS) at audit_help.c:86 #5 0x000002aa0000417c in close_files () at groupadd.c:275 #6 main (argc=&lt;optimized out&gt;, argv=&lt;optimized out&gt;) at groupadd.c:621 Version-Release number of selected component (if applicable):
audit-2.5-2.fc24 Additional info: This audit build is from the GCC6 rebuild, when audit is downgraded to audit-2.5-1.fc24 (pre-mass rebuild), everything works.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9076472</commentid>
<comment_count>1</comment_count>
<who name="Dan Horák">dan</who>
<bug_when>2016-02-18 12:18:02 -0500</bug_when>
<thetext>rebuild with -fno-delete-null-pointer-checks didn&apos;t help</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9076501</commentid>
<comment_count>2</comment_count>
<who name="Dan Horák">dan</who>
<bug_when>2016-02-18 12:33:38 -0500</bug_when>
<thetext>also using -fno-strict-aliasing doesn&apos;t help, but switching to -O1 does help, maybe a compiler error then ...</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9076521</commentid>
<comment_count>3</comment_count>
<who name="Steve Grubb">sgrubb</who>
<bug_when>2016-02-18 12:45:16 -0500</bug_when>
<thetext>I can&apos;t see how the error is occurring in the code. The code that sets things up is this: switch (rep-&gt;type) { case NLMSG_ERROR: rep-&gt;error = NLMSG_DATA(rep-&gt;nlh); break; And the dereference is: else if (rc &gt; 0 &amp;&amp;
rep.type == NLMSG_ERROR) { int error = rep.error-&gt;error; This part of the code has not changed in probably 8 years.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9076650</commentid>
<comment_count>4</comment_count>
<who name="Dan Horák">dan</who>
<bug_when>2016-02-18 13:51:29 -0500</bug_when>
<thetext>yeah, I couldn&apos;t see anything obvious as well, lets ask the gcc team for opinions</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9076659</commentid>
<comment_count>5</comment_count>
<who name="Dan Horák">dan</who>
<bug_when>2016-02-18 13:54:42 -0500</bug_when>
<thetext>compiler used was gcc-6.0.0-0.9.fc24.s390x, my test builds were with gcc-6.0.0-0.11.fc24.s390x and from what I can see both s390 and s390x are affected full logs are available at http://s390.koji.fedoraproject.org/koji/buildinfo?buildID=378112</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9094182</commentid>
<comment_count>6</comment_count>
<who name="Jan Kurik">jkurik</who>
<bug_when>2016-02-24 10:26:20 -0500</bug_when>
<thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 24 development cycle. Changing version to &apos;24&apos;. More information and reason for this action is here:
https://fedoraproject.org/wiki/Fedora_Program_Management/HouseKeeping/Fedora24#Rawhide_Rebase</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9100295</commentid>
<comment_count>7</comment_count>
<attachid>1130824</attachid>
<who name="Dan Horák">dan</who>
<bug_when>2016-02-26 06:51:33 -0500</bug_when>
<thetext>Created attachment 1130824 preprocessed source file so it&apos;s the static int adjust_reply(struct audit_reply *rep, int len) function in lib/netlink.c that requires switching to -O1 to avoid the segfaults gcc -DHAVE_CONFIG_H -I. -I.. -I.
-I.. -I../auparse -fPIC -DPIC -D_GNU_SOURCE -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -m64
-march=z9-109 -mtune=z10 -c netlink.c -o netlink.o</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9109688</commentid>
<comment_count>8</comment_count>
<who name="Dan Horák">dan</who>
<bug_when>2016-03-01 06:07:08 -0500</bug_when>
<thetext>when __attribute__((noinline, noclone)) is applied to adjust_reply(), the segfault doesn&apos;t occur with -O2</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9109818</commentid>
<comment_count>9</comment_count>
<who name="Jakub Jelinek">jakub</who>
<bug_when>2016-03-01 07:03:41 -0500</bug_when>
<thetext>This is a dup of http://gcc.gnu.org/PR70025. r227382 broke it too: --- netlink.s.227381 2016-03-01 13:00:48.321371161 +0100 +++ netlink.s.227382 2016-03-01 13:00:50.793337109 +0100 @@ -374,8 +374,8 @@ audit_get_reply_internal: .L42: .loc 1
193 0 lg %r1,176(%r15) - la %r2,32(%r1) - stg %r2,9008(%r1) + la %r1,32(%r1) + stg %r1,9008(%r1) .LVL43: .L35: .LBE28: and the bad lg %r1,176(%r15) la %r1,32(%r1) stg %r1,9008(%r1) still appears even in r233777.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9109828</commentid>
<comment_count>10</comment_count>
<who name="Jakub Jelinek">jakub</who>
<bug_when>2016-03-01 07:08:12 -0500</bug_when>
<thetext>The code also has the same pattern: rep-&gt;nlh = &amp;rep-&gt;msg.nlh; ... rep-&gt;signal_info = ((void*)(((char*) rep-&gt;nlh) + ((0) + ((int) ( ((sizeof(struct nlmsghdr))+4U -1) &amp; ~(4U -1) ))))); thus it is again *(ptr + off1) = ptr +
off2; where off1 and off2 are constants and off1 is large enough that it is not valid address offset for s390x.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9117147</commentid>
<comment_count>11</comment_count>
<who name="Dan Horák">dan</who>
<bug_when>2016-03-03 04:14:03 -0500</bug_when>
<thetext>I can confirm that using gcc-6.0.0-0.14.fc24 to build audit there is no more a segfault in libaudit when running eg. groupadd.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9117155</commentid>
<comment_count>12</comment_count>
<who name="Jakub Jelinek">jakub</who>
<bug_when>2016-03-03 04:15:16 -0500</bug_when>
<thetext>Fixed then.</thetext>
</long_desc>

<attachment isobsolete="0" ispatch="0" isprivate="0">
<attachid>1130824</attachid>
<date>2016-02-26 06:51:00 -0500</date>
<delta_ts>2016-02-26 06:51:33 -0500</delta_ts>
<desc>preprocessed source file</desc>
<filename>netlink.i</filename>
<type>text/plain</type>
<size>145639</size>
<attacher name="Dan Horák">dan</attacher>

<data encoding="base64">IyAxICJuZXRsaW5rLmMiCiMgMSAiL2hvbWUvc2hhcmtjei9hdWRpdC9hdWRpdC0yLjUvbGliLy8i CiMgMSAiPGJ1aWx0LWluPiIKIyAxICI8Y29tbWFuZC1saW5lPiIKIyAxICIvdXNyL2luY2x1ZGUv
c3RkYy1wcmVkZWYuaCIgMSAzIDQKIyAxICI8Y29tbWFuZC1saW5lPiIgMgojIDEgIm5ldGxpbmsu YyIKIyAyNiAibmV0bGluay5jIgojIDEgIi4uL2NvbmZpZy5oIiAxCiMgMjcgIm5ldGxpbmsuYyIg MgojIDEgIi91c3IvaW5jbHVkZS91bmlzdGQuaCIgMSAzIDQKIyAyNSAiL3Vzci9pbmNsdWRlL3Vu
aXN0ZC5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvZmVhdHVyZXMuaCIgMSAzIDQKIyAzNjggIi91 c3IvaW5jbHVkZS9mZWF0dXJlcy5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvc3lzL2NkZWZzLmgi IDEgMyA0CiMgNDEwICIvdXNyL2luY2x1ZGUvc3lzL2NkZWZzLmgiIDMgNAojIDEgIi91c3IvaW5j
bHVkZS9iaXRzL3dvcmRzaXplLmgiIDEgMyA0CiMgNDExICIvdXNyL2luY2x1ZGUvc3lzL2NkZWZz LmgiIDIgMyA0CiMgMzY5ICIvdXNyL2luY2x1ZGUvZmVhdHVyZXMuaCIgMiAzIDQKIyAzOTIgIi91 c3IvaW5jbHVkZS9mZWF0dXJlcy5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvZ251L3N0dWJzLmgi
IDEgMyA0CgoKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3dvcmRzaXplLmgiIDEgMyA0CiMgNiAi L3Vzci9pbmNsdWRlL2dudS9zdHVicy5oIiAyIDMgNAoKCgoKCiMgMSAiL3Vzci9pbmNsdWRlL2du dS9zdHVicy02NC5oIiAxIDMgNAojIDEyICIvdXNyL2luY2x1ZGUvZ251L3N0dWJzLmgiIDIgMyA0
CiMgMzkzICIvdXNyL2luY2x1ZGUvZmVhdHVyZXMuaCIgMiAzIDQKIyAyNiAiL3Vzci9pbmNsdWRl L3VuaXN0ZC5oIiAyIDMgNAoKCiMgMjA1ICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDMgNAojIDEg Ii91c3IvaW5jbHVkZS9iaXRzL3Bvc2l4X29wdC5oIiAxIDMgNAojIDIwNiAiL3Vzci9pbmNsdWRl
L3VuaXN0ZC5oIiAyIDMgNAoKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL2Vudmlyb25tZW50cy5o IiAxIDMgNAojIDIyICIvdXNyL2luY2x1ZGUvYml0cy9lbnZpcm9ubWVudHMuaCIgMyA0CiMgMSAi L3Vzci9pbmNsdWRlL2JpdHMvd29yZHNpemUuaCIgMSAzIDQKIyAyMyAiL3Vzci9pbmNsdWRlL2Jp
dHMvZW52aXJvbm1lbnRzLmgiIDIgMyA0CiMgMjEwICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDIg MyA0CiMgMjIwICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9i aXRzL3R5cGVzLmgiIDEgMyA0CiMgMjcgIi91c3IvaW5jbHVkZS9iaXRzL3R5cGVzLmgiIDMgNAoj
IDEgIi91c3IvaW5jbHVkZS9iaXRzL3dvcmRzaXplLmgiIDEgMyA0CiMgMjggIi91c3IvaW5jbHVk ZS9iaXRzL3R5cGVzLmgiIDIgMyA0CgoKCiMgMzAgIi91c3IvaW5jbHVkZS9iaXRzL3R5cGVzLmgi IDMgNAp0eXBlZGVmIHVuc2lnbmVkIGNoYXIgX191X2NoYXI7CnR5cGVkZWYgdW5zaWduZWQgc2hv
cnQgaW50IF9fdV9zaG9ydDsKdHlwZWRlZiB1bnNpZ25lZCBpbnQgX191X2ludDsKdHlwZWRlZiB1 bnNpZ25lZCBsb25nIGludCBfX3VfbG9uZzsKCgp0eXBlZGVmIHNpZ25lZCBjaGFyIF9faW50OF90 Owp0eXBlZGVmIHVuc2lnbmVkIGNoYXIgX191aW50OF90Owp0eXBlZGVmIHNpZ25lZCBzaG9ydCBp
bnQgX19pbnQxNl90Owp0eXBlZGVmIHVuc2lnbmVkIHNob3J0IGludCBfX3VpbnQxNl90Owp0eXBl ZGVmIHNpZ25lZCBpbnQgX19pbnQzMl90Owp0eXBlZGVmIHVuc2lnbmVkIGludCBfX3VpbnQzMl90 OwoKdHlwZWRlZiBzaWduZWQgbG9uZyBpbnQgX19pbnQ2NF90Owp0eXBlZGVmIHVuc2lnbmVkIGxv
bmcgaW50IF9fdWludDY0X3Q7CgoKCgoKCgp0eXBlZGVmIGxvbmcgaW50IF9fcXVhZF90Owp0eXBl ZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fdV9xdWFkX3Q7CiMgMTIxICIvdXNyL2luY2x1ZGUvYml0 cy90eXBlcy5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy90eXBlc2l6ZXMuaCIgMSAzIDQK
IyAxMjIgIi91c3IvaW5jbHVkZS9iaXRzL3R5cGVzLmgiIDIgMyA0CgoKdHlwZWRlZiB1bnNpZ25l ZCBsb25nIGludCBfX2Rldl90Owp0eXBlZGVmIHVuc2lnbmVkIGludCBfX3VpZF90Owp0eXBlZGVm IHVuc2lnbmVkIGludCBfX2dpZF90Owp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9faW5vX3Q7
CnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQgX19pbm82NF90Owp0eXBlZGVmIHVuc2lnbmVkIGlu dCBfX21vZGVfdDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIGludCBfX25saW5rX3Q7CnR5cGVkZWYg bG9uZyBpbnQgX19vZmZfdDsKdHlwZWRlZiBsb25nIGludCBfX29mZjY0X3Q7CnR5cGVkZWYgaW50
IF9fcGlkX3Q7CnR5cGVkZWYgc3RydWN0IHsgaW50IF9fdmFsWzJdOyB9IF9fZnNpZF90Owp0eXBl ZGVmIGxvbmcgaW50IF9fY2xvY2tfdDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIGludCBfX3JsaW1f dDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIGludCBfX3JsaW02NF90Owp0eXBlZGVmIHVuc2lnbmVk
IGludCBfX2lkX3Q7CnR5cGVkZWYgbG9uZyBpbnQgX190aW1lX3Q7CnR5cGVkZWYgdW5zaWduZWQg aW50IF9fdXNlY29uZHNfdDsKdHlwZWRlZiBsb25nIGludCBfX3N1c2Vjb25kc190OwoKdHlwZWRl ZiBpbnQgX19kYWRkcl90Owp0eXBlZGVmIGludCBfX2tleV90OwoKCnR5cGVkZWYgaW50IF9fY2xv
Y2tpZF90OwoKCnR5cGVkZWYgdm9pZCAqIF9fdGltZXJfdDsKCgp0eXBlZGVmIGxvbmcgaW50IF9f Ymxrc2l6ZV90OwoKCgoKdHlwZWRlZiBsb25nIGludCBfX2Jsa2NudF90Owp0eXBlZGVmIGxvbmcg aW50IF9fYmxrY250NjRfdDsKCgp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fZnNibGtjbnRf
dDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIGludCBfX2ZzYmxrY250NjRfdDsKCgp0eXBlZGVmIHVu c2lnbmVkIGxvbmcgaW50IF9fZnNmaWxjbnRfdDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIGludCBf X2ZzZmlsY250NjRfdDsKCgp0eXBlZGVmIGxvbmcgaW50IF9fZnN3b3JkX3Q7Cgp0eXBlZGVmIGxv
bmcgaW50IF9fc3NpemVfdDsKCgp0eXBlZGVmIGxvbmcgaW50IF9fc3lzY2FsbF9zbG9uZ190OwoK dHlwZWRlZiB1bnNpZ25lZCBsb25nIGludCBfX3N5c2NhbGxfdWxvbmdfdDsKCgoKdHlwZWRlZiBf X29mZjY0X3QgX19sb2ZmX3Q7CnR5cGVkZWYgX19xdWFkX3QgKl9fcWFkZHJfdDsKdHlwZWRlZiBj
aGFyICpfX2NhZGRyX3Q7CgoKdHlwZWRlZiBsb25nIGludCBfX2ludHB0cl90OwoKCnR5cGVkZWYg dW5zaWduZWQgaW50IF9fc29ja2xlbl90OwojIDIyMSAiL3Vzci9pbmNsdWRlL3VuaXN0ZC5oIiAy IDMgNAoKCnR5cGVkZWYgX19zc2l6ZV90IHNzaXplX3Q7CgoKCgoKIyAxICIvdXNyL2xpYi9nY2Mv
czM5MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDEgMyA0CiMgMjE2ICIv dXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDMg NAp0eXBlZGVmIGxvbmcgdW5zaWduZWQgaW50IHNpemVfdDsKIyAyMzAgIi91c3IvaW5jbHVkZS91
bmlzdGQuaCIgMiAzIDQKCgoKCgp0eXBlZGVmIF9fZ2lkX3QgZ2lkX3Q7CgoKCgp0eXBlZGVmIF9f dWlkX3QgdWlkX3Q7CgoKCgoKdHlwZWRlZiBfX29mZl90IG9mZl90OwoKCgoKCgp0eXBlZGVmIF9f b2ZmNjRfdCBvZmY2NF90OwoKCgoKdHlwZWRlZiBfX3VzZWNvbmRzX3QgdXNlY29uZHNfdDsKCgoK
CnR5cGVkZWYgX19waWRfdCBwaWRfdDsKCgoKCgoKdHlwZWRlZiBfX2ludHB0cl90IGludHB0cl90 OwoKCgoKCgp0eXBlZGVmIF9fc29ja2xlbl90IHNvY2tsZW5fdDsKIyAyOTAgIi91c3IvaW5jbHVk ZS91bmlzdGQuaCIgMyA0CmV4dGVybiBpbnQgYWNjZXNzIChjb25zdCBjaGFyICpfX25hbWUsIGlu
dCBfX3R5cGUpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRy aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKZXh0ZXJuIGludCBldWlkYWNjZXNzIChj b25zdCBjaGFyICpfX25hbWUsIGludCBfX3R5cGUpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90
aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoK ZXh0ZXJuIGludCBlYWNjZXNzIChjb25zdCBjaGFyICpfX25hbWUsIGludCBfX3R5cGUpCiAgICAg X19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgo
X19ub25udWxsX18gKDEpKSk7CgoKCgoKCmV4dGVybiBpbnQgZmFjY2Vzc2F0IChpbnQgX19mZCwg Y29uc3QgY2hhciAqX19maWxlLCBpbnQgX190eXBlLCBpbnQgX19mbGFnKQogICAgIF9fYXR0cmli dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs
bF9fICgyKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CiMgMzM3 ICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDMgNApleHRlcm4gX19vZmZfdCBsc2VlayAoaW50IF9f ZmQsIF9fb2ZmX3QgX19vZmZzZXQsIGludCBfX3doZW5jZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90
aHJvd19fICwgX19sZWFmX18pKTsKIyAzNDggIi91c3IvaW5jbHVkZS91bmlzdGQuaCIgMyA0CmV4 dGVybiBfX29mZjY0X3QgbHNlZWs2NCAoaW50IF9fZmQsIF9fb2ZmNjRfdCBfX29mZnNldCwgaW50 IF9fd2hlbmNlKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7
CgoKCgoKCmV4dGVybiBpbnQgY2xvc2UgKGludCBfX2ZkKTsKCgoKCgoKZXh0ZXJuIHNzaXplX3Qg cmVhZCAoaW50IF9fZmQsIHZvaWQgKl9fYnVmLCBzaXplX3QgX19uYnl0ZXMpIF9fYXR0cmlidXRl X18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKZXh0ZXJuIHNzaXplX3Qgd3JpdGUg
KGludCBfX2ZkLCBjb25zdCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbikgX19hdHRyaWJ1dGVfXyAo KF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKIyAzNzkgIi91c3IvaW5jbHVkZS91bmlzdGQuaCIg MyA0CmV4dGVybiBzc2l6ZV90IHByZWFkIChpbnQgX19mZCwgdm9pZCAqX19idWYsIHNpemVfdCBf
X25ieXRlcywKICAgICAgICBfX29mZl90IF9fb2Zmc2V0KSBfX2F0dHJpYnV0ZV9fICgoX193YXJu X3VudXNlZF9yZXN1bHRfXykpOwoKCgoKCgpleHRlcm4gc3NpemVfdCBwd3JpdGUgKGludCBfX2Zk LCBjb25zdCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbiwKICAgICAgICAgX19vZmZfdCBfX29mZnNl
dCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKIyA0MDcgIi91c3Iv aW5jbHVkZS91bmlzdGQuaCIgMyA0CmV4dGVybiBzc2l6ZV90IHByZWFkNjQgKGludCBfX2ZkLCB2 b2lkICpfX2J1Ziwgc2l6ZV90IF9fbmJ5dGVzLAogICBfX29mZjY0X3QgX19vZmZzZXQpIF9fYXR0
cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKZXh0ZXJuIHNzaXplX3QgcHdy aXRlNjQgKGludCBfX2ZkLCBjb25zdCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbiwKICAgIF9fb2Zm NjRfdCBfX29mZnNldCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsK
CgoKCgoKCmV4dGVybiBpbnQgcGlwZSAoaW50IF9fcGlwZWRlc1syXSkgX19hdHRyaWJ1dGVfXyAo KF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9y ZXN1bHRfXykpOwoKCgoKZXh0ZXJuIGludCBwaXBlMiAoaW50IF9fcGlwZWRlc1syXSwgaW50IF9f
ZmxhZ3MpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1 dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKIyA0MzUgIi91c3IvaW5jbHVkZS91bmlz dGQuaCIgMyA0CmV4dGVybiB1bnNpZ25lZCBpbnQgYWxhcm0gKHVuc2lnbmVkIGludCBfX3NlY29u
ZHMpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CiMgNDQ3ICIvdXNy L2luY2x1ZGUvdW5pc3RkLmgiIDMgNApleHRlcm4gdW5zaWduZWQgaW50IHNsZWVwICh1bnNpZ25l ZCBpbnQgX19zZWNvbmRzKTsKCgoKCgoKCmV4dGVybiBfX3VzZWNvbmRzX3QgdWFsYXJtIChfX3Vz
ZWNvbmRzX3QgX192YWx1ZSwgX191c2Vjb25kc190IF9faW50ZXJ2YWwpCiAgICAgX19hdHRyaWJ1 dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCgoKZXh0ZXJuIGludCB1c2xlZXAg KF9fdXNlY29uZHNfdCBfX3VzZWNvbmRzKTsKIyA0NzIgIi91c3IvaW5jbHVkZS91bmlzdGQuaCIg
MyA0CmV4dGVybiBpbnQgcGF1c2UgKHZvaWQpOwoKCgpleHRlcm4gaW50IGNob3duIChjb25zdCBj aGFyICpfX2ZpbGUsIF9fdWlkX3QgX19vd25lciwgX19naWRfdCBfX2dyb3VwKQogICAgIF9fYXR0 cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoK CmV4dGVybiBpbnQgZmNob3duIChpbnQgX19mZCwgX191aWRfdCBfX293bmVyLCBfX2dpZF90IF9f Z3JvdXApIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1
dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCmV4dGVybiBpbnQgbGNob3duIChj b25zdCBjaGFyICpfX2ZpbGUsIF9fdWlkX3QgX19vd25lciwgX19naWRfdCBfX2dyb3VwKQogICAg IF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAo
KF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9f KSk7CgoKCgoKCmV4dGVybiBpbnQgZmNob3duYXQgKGludCBfX2ZkLCBjb25zdCBjaGFyICpfX2Zp bGUsIF9fdWlkX3QgX19vd25lciwKICAgICAgIF9fZ2lkX3QgX19ncm91cCwgaW50IF9fZmxhZykK
ICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRl X18gKChfX25vbm51bGxfXyAoMikpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1 bHRfXykpOwoKCgpleHRlcm4gaW50IGNoZGlyIChjb25zdCBjaGFyICpfX3BhdGgpIF9fYXR0cmli
dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs bF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCmV4 dGVybiBpbnQgZmNoZGlyIChpbnQgX19mZCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg
X19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDUx NCAiL3Vzci9pbmNsdWRlL3VuaXN0ZC5oIiAzIDQKZXh0ZXJuIGNoYXIgKmdldGN3ZCAoY2hhciAq X19idWYsIHNpemVfdCBfX3NpemUpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh
Zl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCgpleHRl cm4gY2hhciAqZ2V0X2N1cnJlbnRfZGlyX25hbWUgKHZvaWQpIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgoKCgpleHRlcm4gY2hhciAqZ2V0d2QgKGNoYXIgKl9f
YnVmKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRy aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX2RlcHJlY2F0ZWRf XykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4g
aW50IGR1cCAoaW50IF9fZmQpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9f KSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgpleHRlcm4gaW50 IGR1cDIgKGludCBfX2ZkLCBpbnQgX19mZDIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs
IF9fbGVhZl9fKSk7CgoKCgpleHRlcm4gaW50IGR1cDMgKGludCBfX2ZkLCBpbnQgX19mZDIsIGlu dCBfX2ZsYWdzKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgpl eHRlcm4gY2hhciAqKl9fZW52aXJvbjsKCmV4dGVybiBjaGFyICoqZW52aXJvbjsKCgoKCgpleHRl
cm4gaW50IGV4ZWN2ZSAoY29uc3QgY2hhciAqX19wYXRoLCBjaGFyICpjb25zdCBfX2FyZ3ZbXSwK ICAgICBjaGFyICpjb25zdCBfX2VudnBbXSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg X19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKCgpleHRl
cm4gaW50IGZleGVjdmUgKGludCBfX2ZkLCBjaGFyICpjb25zdCBfX2FyZ3ZbXSwgY2hhciAqY29u c3QgX19lbnZwW10pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18p KSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIpKSk7CgoKCgpleHRlcm4gaW50IGV4ZWN2
IChjb25zdCBjaGFyICpfX3BhdGgsIGNoYXIgKmNvbnN0IF9fYXJndltdKQogICAgIF9fYXR0cmli dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs bF9fICgxLCAyKSkpOwoKCgpleHRlcm4gaW50IGV4ZWNsZSAoY29uc3QgY2hhciAqX19wYXRoLCBj
b25zdCBjaGFyICpfX2FyZywgLi4uKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs IF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCgpleHRl cm4gaW50IGV4ZWNsIChjb25zdCBjaGFyICpfX3BhdGgsIGNvbnN0IGNoYXIgKl9fYXJnLCAuLi4p
CiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0 ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKCmV4dGVybiBpbnQgZXhlY3ZwIChjb25zdCBj aGFyICpfX2ZpbGUsIGNoYXIgKmNvbnN0IF9fYXJndltdKQogICAgIF9fYXR0cmlidXRlX18gKChf
X25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAy KSkpOwoKCgoKZXh0ZXJuIGludCBleGVjbHAgKGNvbnN0IGNoYXIgKl9fZmlsZSwgY29uc3QgY2hh ciAqX19hcmcsIC4uLikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZf
XykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgoKCmV4dGVybiBpbnQg ZXhlY3ZwZSAoY29uc3QgY2hhciAqX19maWxlLCBjaGFyICpjb25zdCBfX2FyZ3ZbXSwKICAgICAg Y2hhciAqY29uc3QgX19lbnZwW10pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg
X19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKCgoKZXh0 ZXJuIGludCBuaWNlIChpbnQgX19pbmMpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f bGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCmV4
dGVybiB2b2lkIF9leGl0IChpbnQgX19zdGF0dXMpIF9fYXR0cmlidXRlX18gKChfX25vcmV0dXJu X18pKTsKCgoKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL2NvbmZuYW1lLmgiIDEgMyA0CiMgMjQg Ii91c3IvaW5jbHVkZS9iaXRzL2NvbmZuYW1lLmgiIDMgNAplbnVtCiAgewogICAgX1BDX0xJTktf
TUFYLAoKICAgIF9QQ19NQVhfQ0FOT04sCgogICAgX1BDX01BWF9JTlBVVCwKCiAgICBfUENfTkFN RV9NQVgsCgogICAgX1BDX1BBVEhfTUFYLAoKICAgIF9QQ19QSVBFX0JVRiwKCiAgICBfUENfQ0hP V05fUkVTVFJJQ1RFRCwKCiAgICBfUENfTk9fVFJVTkMsCgogICAgX1BDX1ZESVNBQkxFLAoKICAg
IF9QQ19TWU5DX0lPLAoKICAgIF9QQ19BU1lOQ19JTywKCiAgICBfUENfUFJJT19JTywKCiAgICBf UENfU09DS19NQVhCVUYsCgogICAgX1BDX0ZJTEVTSVpFQklUUywKCiAgICBfUENfUkVDX0lOQ1Jf WEZFUl9TSVpFLAoKICAgIF9QQ19SRUNfTUFYX1hGRVJfU0laRSwKCiAgICBfUENfUkVDX01JTl9Y
RkVSX1NJWkUsCgogICAgX1BDX1JFQ19YRkVSX0FMSUdOLAoKICAgIF9QQ19BTExPQ19TSVpFX01J TiwKCiAgICBfUENfU1lNTElOS19NQVgsCgogICAgX1BDXzJfU1lNTElOS1MKCiAgfTsKCgplbnVt CiAgewogICAgX1NDX0FSR19NQVgsCgogICAgX1NDX0NISUxEX01BWCwKCiAgICBfU0NfQ0xLX1RD
SywKCiAgICBfU0NfTkdST1VQU19NQVgsCgogICAgX1NDX09QRU5fTUFYLAoKICAgIF9TQ19TVFJF QU1fTUFYLAoKICAgIF9TQ19UWk5BTUVfTUFYLAoKICAgIF9TQ19KT0JfQ09OVFJPTCwKCiAgICBf U0NfU0FWRURfSURTLAoKICAgIF9TQ19SRUFMVElNRV9TSUdOQUxTLAoKICAgIF9TQ19QUklPUklU
WV9TQ0hFRFVMSU5HLAoKICAgIF9TQ19USU1FUlMsCgogICAgX1NDX0FTWU5DSFJPTk9VU19JTywK CiAgICBfU0NfUFJJT1JJVElaRURfSU8sCgogICAgX1NDX1NZTkNIUk9OSVpFRF9JTywKCiAgICBf U0NfRlNZTkMsCgogICAgX1NDX01BUFBFRF9GSUxFUywKCiAgICBfU0NfTUVNTE9DSywKCiAgICBf
U0NfTUVNTE9DS19SQU5HRSwKCiAgICBfU0NfTUVNT1JZX1BST1RFQ1RJT04sCgogICAgX1NDX01F U1NBR0VfUEFTU0lORywKCiAgICBfU0NfU0VNQVBIT1JFUywKCiAgICBfU0NfU0hBUkVEX01FTU9S WV9PQkpFQ1RTLAoKICAgIF9TQ19BSU9fTElTVElPX01BWCwKCiAgICBfU0NfQUlPX01BWCwKCiAg
ICBfU0NfQUlPX1BSSU9fREVMVEFfTUFYLAoKICAgIF9TQ19ERUxBWVRJTUVSX01BWCwKCiAgICBf U0NfTVFfT1BFTl9NQVgsCgogICAgX1NDX01RX1BSSU9fTUFYLAoKICAgIF9TQ19WRVJTSU9OLAoK ICAgIF9TQ19QQUdFU0laRSwKCgogICAgX1NDX1JUU0lHX01BWCwKCiAgICBfU0NfU0VNX05TRU1T
X01BWCwKCiAgICBfU0NfU0VNX1ZBTFVFX01BWCwKCiAgICBfU0NfU0lHUVVFVUVfTUFYLAoKICAg IF9TQ19USU1FUl9NQVgsCgoKCgogICAgX1NDX0JDX0JBU0VfTUFYLAoKICAgIF9TQ19CQ19ESU1f TUFYLAoKICAgIF9TQ19CQ19TQ0FMRV9NQVgsCgogICAgX1NDX0JDX1NUUklOR19NQVgsCgogICAg
X1NDX0NPTExfV0VJR0hUU19NQVgsCgogICAgX1NDX0VRVUlWX0NMQVNTX01BWCwKCiAgICBfU0Nf RVhQUl9ORVNUX01BWCwKCiAgICBfU0NfTElORV9NQVgsCgogICAgX1NDX1JFX0RVUF9NQVgsCgog ICAgX1NDX0NIQVJDTEFTU19OQU1FX01BWCwKCgogICAgX1NDXzJfVkVSU0lPTiwKCiAgICBfU0Nf
Ml9DX0JJTkQsCgogICAgX1NDXzJfQ19ERVYsCgogICAgX1NDXzJfRk9SVF9ERVYsCgogICAgX1ND XzJfRk9SVF9SVU4sCgogICAgX1NDXzJfU1dfREVWLAoKICAgIF9TQ18yX0xPQ0FMRURFRiwKCgog ICAgX1NDX1BJSSwKCiAgICBfU0NfUElJX1hUSSwKCiAgICBfU0NfUElJX1NPQ0tFVCwKCiAgICBf
U0NfUElJX0lOVEVSTkVULAoKICAgIF9TQ19QSUlfT1NJLAoKICAgIF9TQ19QT0xMLAoKICAgIF9T Q19TRUxFQ1QsCgogICAgX1NDX1VJT19NQVhJT1YsCgogICAgX1NDX0lPVl9NQVggPSBfU0NfVUlP X01BWElPViwKCiAgICBfU0NfUElJX0lOVEVSTkVUX1NUUkVBTSwKCiAgICBfU0NfUElJX0lOVEVS
TkVUX0RHUkFNLAoKICAgIF9TQ19QSUlfT1NJX0NPVFMsCgogICAgX1NDX1BJSV9PU0lfQ0xUUywK CiAgICBfU0NfUElJX09TSV9NLAoKICAgIF9TQ19UX0lPVl9NQVgsCgoKCiAgICBfU0NfVEhSRUFE UywKCiAgICBfU0NfVEhSRUFEX1NBRkVfRlVOQ1RJT05TLAoKICAgIF9TQ19HRVRHUl9SX1NJWkVf
TUFYLAoKICAgIF9TQ19HRVRQV19SX1NJWkVfTUFYLAoKICAgIF9TQ19MT0dJTl9OQU1FX01BWCwK CiAgICBfU0NfVFRZX05BTUVfTUFYLAoKICAgIF9TQ19USFJFQURfREVTVFJVQ1RPUl9JVEVSQVRJ T05TLAoKICAgIF9TQ19USFJFQURfS0VZU19NQVgsCgogICAgX1NDX1RIUkVBRF9TVEFDS19NSU4s
CgogICAgX1NDX1RIUkVBRF9USFJFQURTX01BWCwKCiAgICBfU0NfVEhSRUFEX0FUVFJfU1RBQ0tB RERSLAoKICAgIF9TQ19USFJFQURfQVRUUl9TVEFDS1NJWkUsCgogICAgX1NDX1RIUkVBRF9QUklP UklUWV9TQ0hFRFVMSU5HLAoKICAgIF9TQ19USFJFQURfUFJJT19JTkhFUklULAoKICAgIF9TQ19U
SFJFQURfUFJJT19QUk9URUNULAoKICAgIF9TQ19USFJFQURfUFJPQ0VTU19TSEFSRUQsCgoKICAg IF9TQ19OUFJPQ0VTU09SU19DT05GLAoKICAgIF9TQ19OUFJPQ0VTU09SU19PTkxOLAoKICAgIF9T Q19QSFlTX1BBR0VTLAoKICAgIF9TQ19BVlBIWVNfUEFHRVMsCgogICAgX1NDX0FURVhJVF9NQVgs
CgogICAgX1NDX1BBU1NfTUFYLAoKCiAgICBfU0NfWE9QRU5fVkVSU0lPTiwKCiAgICBfU0NfWE9Q RU5fWENVX1ZFUlNJT04sCgogICAgX1NDX1hPUEVOX1VOSVgsCgogICAgX1NDX1hPUEVOX0NSWVBU LAoKICAgIF9TQ19YT1BFTl9FTkhfSTE4TiwKCiAgICBfU0NfWE9QRU5fU0hNLAoKCiAgICBfU0Nf
Ml9DSEFSX1RFUk0sCgogICAgX1NDXzJfQ19WRVJTSU9OLAoKICAgIF9TQ18yX1VQRSwKCgogICAg X1NDX1hPUEVOX1hQRzIsCgogICAgX1NDX1hPUEVOX1hQRzMsCgogICAgX1NDX1hPUEVOX1hQRzQs CgoKICAgIF9TQ19DSEFSX0JJVCwKCiAgICBfU0NfQ0hBUl9NQVgsCgogICAgX1NDX0NIQVJfTUlO
LAoKICAgIF9TQ19JTlRfTUFYLAoKICAgIF9TQ19JTlRfTUlOLAoKICAgIF9TQ19MT05HX0JJVCwK CiAgICBfU0NfV09SRF9CSVQsCgogICAgX1NDX01CX0xFTl9NQVgsCgogICAgX1NDX05aRVJPLAoK ICAgIF9TQ19TU0laRV9NQVgsCgogICAgX1NDX1NDSEFSX01BWCwKCiAgICBfU0NfU0NIQVJfTUlO
LAoKICAgIF9TQ19TSFJUX01BWCwKCiAgICBfU0NfU0hSVF9NSU4sCgogICAgX1NDX1VDSEFSX01B WCwKCiAgICBfU0NfVUlOVF9NQVgsCgogICAgX1NDX1VMT05HX01BWCwKCiAgICBfU0NfVVNIUlRf TUFYLAoKCiAgICBfU0NfTkxfQVJHTUFYLAoKICAgIF9TQ19OTF9MQU5HTUFYLAoKICAgIF9TQ19O
TF9NU0dNQVgsCgogICAgX1NDX05MX05NQVgsCgogICAgX1NDX05MX1NFVE1BWCwKCiAgICBfU0Nf TkxfVEVYVE1BWCwKCgogICAgX1NDX1hCUzVfSUxQMzJfT0ZGMzIsCgogICAgX1NDX1hCUzVfSUxQ MzJfT0ZGQklHLAoKICAgIF9TQ19YQlM1X0xQNjRfT0ZGNjQsCgogICAgX1NDX1hCUzVfTFBCSUdf
T0ZGQklHLAoKCiAgICBfU0NfWE9QRU5fTEVHQUNZLAoKICAgIF9TQ19YT1BFTl9SRUFMVElNRSwK CiAgICBfU0NfWE9QRU5fUkVBTFRJTUVfVEhSRUFEUywKCgogICAgX1NDX0FEVklTT1JZX0lORk8s CgogICAgX1NDX0JBUlJJRVJTLAoKICAgIF9TQ19CQVNFLAoKICAgIF9TQ19DX0xBTkdfU1VQUE9S
VCwKCiAgICBfU0NfQ19MQU5HX1NVUFBPUlRfUiwKCiAgICBfU0NfQ0xPQ0tfU0VMRUNUSU9OLAoK ICAgIF9TQ19DUFVUSU1FLAoKICAgIF9TQ19USFJFQURfQ1BVVElNRSwKCiAgICBfU0NfREVWSUNF X0lPLAoKICAgIF9TQ19ERVZJQ0VfU1BFQ0lGSUMsCgogICAgX1NDX0RFVklDRV9TUEVDSUZJQ19S
LAoKICAgIF9TQ19GRF9NR01ULAoKICAgIF9TQ19GSUZPLAoKICAgIF9TQ19QSVBFLAoKICAgIF9T Q19GSUxFX0FUVFJJQlVURVMsCgogICAgX1NDX0ZJTEVfTE9DS0lORywKCiAgICBfU0NfRklMRV9T WVNURU0sCgogICAgX1NDX01PTk9UT05JQ19DTE9DSywKCiAgICBfU0NfTVVMVElfUFJPQ0VTUywK
CiAgICBfU0NfU0lOR0xFX1BST0NFU1MsCgogICAgX1NDX05FVFdPUktJTkcsCgogICAgX1NDX1JF QURFUl9XUklURVJfTE9DS1MsCgogICAgX1NDX1NQSU5fTE9DS1MsCgogICAgX1NDX1JFR0VYUCwK CiAgICBfU0NfUkVHRVhfVkVSU0lPTiwKCiAgICBfU0NfU0hFTEwsCgogICAgX1NDX1NJR05BTFMs
CgogICAgX1NDX1NQQVdOLAoKICAgIF9TQ19TUE9SQURJQ19TRVJWRVIsCgogICAgX1NDX1RIUkVB RF9TUE9SQURJQ19TRVJWRVIsCgogICAgX1NDX1NZU1RFTV9EQVRBQkFTRSwKCiAgICBfU0NfU1lT VEVNX0RBVEFCQVNFX1IsCgogICAgX1NDX1RJTUVPVVRTLAoKICAgIF9TQ19UWVBFRF9NRU1PUllf
T0JKRUNUUywKCiAgICBfU0NfVVNFUl9HUk9VUFMsCgogICAgX1NDX1VTRVJfR1JPVVBTX1IsCgog ICAgX1NDXzJfUEJTLAoKICAgIF9TQ18yX1BCU19BQ0NPVU5USU5HLAoKICAgIF9TQ18yX1BCU19M T0NBVEUsCgogICAgX1NDXzJfUEJTX01FU1NBR0UsCgogICAgX1NDXzJfUEJTX1RSQUNLLAoKICAg
IF9TQ19TWU1MT09QX01BWCwKCiAgICBfU0NfU1RSRUFNUywKCiAgICBfU0NfMl9QQlNfQ0hFQ0tQ T0lOVCwKCgogICAgX1NDX1Y2X0lMUDMyX09GRjMyLAoKICAgIF9TQ19WNl9JTFAzMl9PRkZCSUcs CgogICAgX1NDX1Y2X0xQNjRfT0ZGNjQsCgogICAgX1NDX1Y2X0xQQklHX09GRkJJRywKCgogICAg
X1NDX0hPU1RfTkFNRV9NQVgsCgogICAgX1NDX1RSQUNFLAoKICAgIF9TQ19UUkFDRV9FVkVOVF9G SUxURVIsCgogICAgX1NDX1RSQUNFX0lOSEVSSVQsCgogICAgX1NDX1RSQUNFX0xPRywKCgogICAg X1NDX0xFVkVMMV9JQ0FDSEVfU0laRSwKCiAgICBfU0NfTEVWRUwxX0lDQUNIRV9BU1NPQywKCiAg
ICBfU0NfTEVWRUwxX0lDQUNIRV9MSU5FU0laRSwKCiAgICBfU0NfTEVWRUwxX0RDQUNIRV9TSVpF LAoKICAgIF9TQ19MRVZFTDFfRENBQ0hFX0FTU09DLAoKICAgIF9TQ19MRVZFTDFfRENBQ0hFX0xJ TkVTSVpFLAoKICAgIF9TQ19MRVZFTDJfQ0FDSEVfU0laRSwKCiAgICBfU0NfTEVWRUwyX0NBQ0hF
X0FTU09DLAoKICAgIF9TQ19MRVZFTDJfQ0FDSEVfTElORVNJWkUsCgogICAgX1NDX0xFVkVMM19D QUNIRV9TSVpFLAoKICAgIF9TQ19MRVZFTDNfQ0FDSEVfQVNTT0MsCgogICAgX1NDX0xFVkVMM19D QUNIRV9MSU5FU0laRSwKCiAgICBfU0NfTEVWRUw0X0NBQ0hFX1NJWkUsCgogICAgX1NDX0xFVkVM
NF9DQUNIRV9BU1NPQywKCiAgICBfU0NfTEVWRUw0X0NBQ0hFX0xJTkVTSVpFLAoKCgogICAgX1ND X0lQVjYgPSBfU0NfTEVWRUwxX0lDQUNIRV9TSVpFICsgNTAsCgogICAgX1NDX1JBV19TT0NLRVRT LAoKCiAgICBfU0NfVjdfSUxQMzJfT0ZGMzIsCgogICAgX1NDX1Y3X0lMUDMyX09GRkJJRywKCiAg
ICBfU0NfVjdfTFA2NF9PRkY2NCwKCiAgICBfU0NfVjdfTFBCSUdfT0ZGQklHLAoKCiAgICBfU0Nf U1NfUkVQTF9NQVgsCgoKICAgIF9TQ19UUkFDRV9FVkVOVF9OQU1FX01BWCwKCiAgICBfU0NfVFJB Q0VfTkFNRV9NQVgsCgogICAgX1NDX1RSQUNFX1NZU19NQVgsCgogICAgX1NDX1RSQUNFX1VTRVJf
RVZFTlRfTUFYLAoKCiAgICBfU0NfWE9QRU5fU1RSRUFNUywKCgogICAgX1NDX1RIUkVBRF9ST0JV U1RfUFJJT19JTkhFUklULAoKICAgIF9TQ19USFJFQURfUk9CVVNUX1BSSU9fUFJPVEVDVAoKICB9 OwoKCmVudW0KICB7CiAgICBfQ1NfUEFUSCwKCgogICAgX0NTX1Y2X1dJRFRIX1JFU1RSSUNURURf
RU5WUywKCgoKICAgIF9DU19HTlVfTElCQ19WRVJTSU9OLAoKICAgIF9DU19HTlVfTElCUFRIUkVB RF9WRVJTSU9OLAoKCiAgICBfQ1NfVjVfV0lEVEhfUkVTVFJJQ1RFRF9FTlZTLAoKCgogICAgX0NT X1Y3X1dJRFRIX1JFU1RSSUNURURfRU5WUywKCgoKICAgIF9DU19MRlNfQ0ZMQUdTID0gMTAwMCwK
CiAgICBfQ1NfTEZTX0xERkxBR1MsCgogICAgX0NTX0xGU19MSUJTLAoKICAgIF9DU19MRlNfTElO VEZMQUdTLAoKICAgIF9DU19MRlM2NF9DRkxBR1MsCgogICAgX0NTX0xGUzY0X0xERkxBR1MsCgog ICAgX0NTX0xGUzY0X0xJQlMsCgogICAgX0NTX0xGUzY0X0xJTlRGTEFHUywKCgogICAgX0NTX1hC
UzVfSUxQMzJfT0ZGMzJfQ0ZMQUdTID0gMTEwMCwKCiAgICBfQ1NfWEJTNV9JTFAzMl9PRkYzMl9M REZMQUdTLAoKICAgIF9DU19YQlM1X0lMUDMyX09GRjMyX0xJQlMsCgogICAgX0NTX1hCUzVfSUxQ MzJfT0ZGMzJfTElOVEZMQUdTLAoKICAgIF9DU19YQlM1X0lMUDMyX09GRkJJR19DRkxBR1MsCgog
ICAgX0NTX1hCUzVfSUxQMzJfT0ZGQklHX0xERkxBR1MsCgogICAgX0NTX1hCUzVfSUxQMzJfT0ZG QklHX0xJQlMsCgogICAgX0NTX1hCUzVfSUxQMzJfT0ZGQklHX0xJTlRGTEFHUywKCiAgICBfQ1Nf WEJTNV9MUDY0X09GRjY0X0NGTEFHUywKCiAgICBfQ1NfWEJTNV9MUDY0X09GRjY0X0xERkxBR1Ms
CgogICAgX0NTX1hCUzVfTFA2NF9PRkY2NF9MSUJTLAoKICAgIF9DU19YQlM1X0xQNjRfT0ZGNjRf TElOVEZMQUdTLAoKICAgIF9DU19YQlM1X0xQQklHX09GRkJJR19DRkxBR1MsCgogICAgX0NTX1hC UzVfTFBCSUdfT0ZGQklHX0xERkxBR1MsCgogICAgX0NTX1hCUzVfTFBCSUdfT0ZGQklHX0xJQlMs
CgogICAgX0NTX1hCUzVfTFBCSUdfT0ZGQklHX0xJTlRGTEFHUywKCgogICAgX0NTX1BPU0lYX1Y2 X0lMUDMyX09GRjMyX0NGTEFHUywKCiAgICBfQ1NfUE9TSVhfVjZfSUxQMzJfT0ZGMzJfTERGTEFH UywKCiAgICBfQ1NfUE9TSVhfVjZfSUxQMzJfT0ZGMzJfTElCUywKCiAgICBfQ1NfUE9TSVhfVjZf
SUxQMzJfT0ZGMzJfTElOVEZMQUdTLAoKICAgIF9DU19QT1NJWF9WNl9JTFAzMl9PRkZCSUdfQ0ZM QUdTLAoKICAgIF9DU19QT1NJWF9WNl9JTFAzMl9PRkZCSUdfTERGTEFHUywKCiAgICBfQ1NfUE9T SVhfVjZfSUxQMzJfT0ZGQklHX0xJQlMsCgogICAgX0NTX1BPU0lYX1Y2X0lMUDMyX09GRkJJR19M
SU5URkxBR1MsCgogICAgX0NTX1BPU0lYX1Y2X0xQNjRfT0ZGNjRfQ0ZMQUdTLAoKICAgIF9DU19Q T1NJWF9WNl9MUDY0X09GRjY0X0xERkxBR1MsCgogICAgX0NTX1BPU0lYX1Y2X0xQNjRfT0ZGNjRf TElCUywKCiAgICBfQ1NfUE9TSVhfVjZfTFA2NF9PRkY2NF9MSU5URkxBR1MsCgogICAgX0NTX1BP
U0lYX1Y2X0xQQklHX09GRkJJR19DRkxBR1MsCgogICAgX0NTX1BPU0lYX1Y2X0xQQklHX09GRkJJ R19MREZMQUdTLAoKICAgIF9DU19QT1NJWF9WNl9MUEJJR19PRkZCSUdfTElCUywKCiAgICBfQ1Nf UE9TSVhfVjZfTFBCSUdfT0ZGQklHX0xJTlRGTEFHUywKCgogICAgX0NTX1BPU0lYX1Y3X0lMUDMy
X09GRjMyX0NGTEFHUywKCiAgICBfQ1NfUE9TSVhfVjdfSUxQMzJfT0ZGMzJfTERGTEFHUywKCiAg ICBfQ1NfUE9TSVhfVjdfSUxQMzJfT0ZGMzJfTElCUywKCiAgICBfQ1NfUE9TSVhfVjdfSUxQMzJf T0ZGMzJfTElOVEZMQUdTLAoKICAgIF9DU19QT1NJWF9WN19JTFAzMl9PRkZCSUdfQ0ZMQUdTLAoK
ICAgIF9DU19QT1NJWF9WN19JTFAzMl9PRkZCSUdfTERGTEFHUywKCiAgICBfQ1NfUE9TSVhfVjdf SUxQMzJfT0ZGQklHX0xJQlMsCgogICAgX0NTX1BPU0lYX1Y3X0lMUDMyX09GRkJJR19MSU5URkxB R1MsCgogICAgX0NTX1BPU0lYX1Y3X0xQNjRfT0ZGNjRfQ0ZMQUdTLAoKICAgIF9DU19QT1NJWF9W
N19MUDY0X09GRjY0X0xERkxBR1MsCgogICAgX0NTX1BPU0lYX1Y3X0xQNjRfT0ZGNjRfTElCUywK CiAgICBfQ1NfUE9TSVhfVjdfTFA2NF9PRkY2NF9MSU5URkxBR1MsCgogICAgX0NTX1BPU0lYX1Y3 X0xQQklHX09GRkJJR19DRkxBR1MsCgogICAgX0NTX1BPU0lYX1Y3X0xQQklHX09GRkJJR19MREZM
QUdTLAoKICAgIF9DU19QT1NJWF9WN19MUEJJR19PRkZCSUdfTElCUywKCiAgICBfQ1NfUE9TSVhf VjdfTFBCSUdfT0ZGQklHX0xJTlRGTEFHUywKCgogICAgX0NTX1Y2X0VOViwKCiAgICBfQ1NfVjdf RU5WCgogIH07CiMgNjEzICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDIgMyA0CgoKZXh0ZXJuIGxv
bmcgaW50IHBhdGhjb25mIChjb25zdCBjaGFyICpfX3BhdGgsIGludCBfX25hbWUpCiAgICAgX19h dHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19u b25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGxvbmcgaW50IGZwYXRoY29uZiAoaW50IF9fZmQsIGlu
dCBfX25hbWUpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0 ZXJuIGxvbmcgaW50IHN5c2NvbmYgKGludCBfX25hbWUpIF9fYXR0cmlidXRlX18gKChfX25vdGhy b3dfXyAsIF9fbGVhZl9fKSk7CgoKCmV4dGVybiBzaXplX3QgY29uZnN0ciAoaW50IF9fbmFtZSwg
Y2hhciAqX19idWYsIHNpemVfdCBfX2xlbikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg X19sZWFmX18pKTsKCgoKCmV4dGVybiBfX3BpZF90IGdldHBpZCAodm9pZCkgX19hdHRyaWJ1dGVf XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRlcm4gX19waWRfdCBnZXRwcGlkICh2
b2lkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCmV4dGVybiBf X3BpZF90IGdldHBncnAgKHZvaWQpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh Zl9fKSk7CgoKZXh0ZXJuIF9fcGlkX3QgX19nZXRwZ2lkIChfX3BpZF90IF9fcGlkKSBfX2F0dHJp
YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKZXh0ZXJuIF9fcGlkX3QgZ2V0cGdp ZCAoX19waWRfdCBfX3BpZCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18p KTsKCgoKCgoKZXh0ZXJuIGludCBzZXRwZ2lkIChfX3BpZF90IF9fcGlkLCBfX3BpZF90IF9fcGdp
ZCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKIyA2NjMgIi91c3Iv aW5jbHVkZS91bmlzdGQuaCIgMyA0CmV4dGVybiBpbnQgc2V0cGdycCAodm9pZCkgX19hdHRyaWJ1 dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCgoKZXh0ZXJuIF9fcGlkX3Qgc2V0
c2lkICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgpl eHRlcm4gX19waWRfdCBnZXRzaWQgKF9fcGlkX3QgX19waWQpIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCmV4dGVybiBfX3VpZF90IGdldHVpZCAodm9pZCkgX19h
dHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRlcm4gX191aWRfdCBn ZXRldWlkICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoK CmV4dGVybiBfX2dpZF90IGdldGdpZCAodm9pZCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19f
ICwgX19sZWFmX18pKTsKCgpleHRlcm4gX19naWRfdCBnZXRlZ2lkICh2b2lkKSBfX2F0dHJpYnV0 ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKZXh0ZXJuIGludCBnZXRncm91cHMg KGludCBfX3NpemUsIF9fZ2lkX3QgX19saXN0W10pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df
XyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsK CgoKZXh0ZXJuIGludCBncm91cF9tZW1iZXIgKF9fZ2lkX3QgX19naWQpIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgoKCmV4dGVybiBpbnQgc2V0dWlkIChfX3Vp
ZF90IF9fdWlkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0 cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gaW50IHNldHJl dWlkIChfX3VpZF90IF9fcnVpZCwgX191aWRfdCBfX2V1aWQpIF9fYXR0cmlidXRlX18gKChfX25v
dGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0 X18pKTsKCgoKCmV4dGVybiBpbnQgc2V0ZXVpZCAoX191aWRfdCBfX3VpZCkgX19hdHRyaWJ1dGVf XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNl
ZF9yZXN1bHRfXykpOwoKCgoKCgpleHRlcm4gaW50IHNldGdpZCAoX19naWRfdCBfX2dpZCkgX19h dHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX193 YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKZXh0ZXJuIGludCBzZXRyZWdpZCAoX19naWRfdCBf
X3JnaWQsIF9fZ2lkX3QgX19lZ2lkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl YWZfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRl cm4gaW50IHNldGVnaWQgKF9fZ2lkX3QgX19naWQpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df
XyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsK CgoKCgpleHRlcm4gaW50IGdldHJlc3VpZCAoX191aWRfdCAqX19ydWlkLCBfX3VpZF90ICpfX2V1 aWQsIF9fdWlkX3QgKl9fc3VpZCkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBf
X2xlYWZfXykpOwoKCgpleHRlcm4gaW50IGdldHJlc2dpZCAoX19naWRfdCAqX19yZ2lkLCBfX2dp ZF90ICpfX2VnaWQsIF9fZ2lkX3QgKl9fc2dpZCkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro cm93X18gLCBfX2xlYWZfXykpOwoKCgpleHRlcm4gaW50IHNldHJlc3VpZCAoX191aWRfdCBfX3J1
aWQsIF9fdWlkX3QgX19ldWlkLCBfX3VpZF90IF9fc3VpZCkKICAgICBfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jl c3VsdF9fKSk7CgoKCmV4dGVybiBpbnQgc2V0cmVzZ2lkIChfX2dpZF90IF9fcmdpZCwgX19naWRf
dCBfX2VnaWQsIF9fZ2lkX3QgX19zZ2lkKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df XyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsK CgoKCgoKZXh0ZXJuIF9fcGlkX3QgZm9yayAodm9pZCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv
d19fKSk7CgoKCgoKCgpleHRlcm4gX19waWRfdCB2Zm9yayAodm9pZCkgX19hdHRyaWJ1dGVfXyAo KF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCgpleHRlcm4gY2hhciAqdHR5bmFtZSAoaW50 IF9fZmQpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCmV4dGVy
biBpbnQgdHR5bmFtZV9yIChpbnQgX19mZCwgY2hhciAqX19idWYsIHNpemVfdCBfX2J1ZmxlbikK ICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRl X18gKChfX25vbm51bGxfXyAoMikpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1
bHRfXykpOwoKCgpleHRlcm4gaW50IGlzYXR0eSAoaW50IF9fZmQpIF9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgoKZXh0ZXJuIGludCB0dHlzbG90ICh2b2lkKSBf X2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKZXh0ZXJuIGludCBs
aW5rIChjb25zdCBjaGFyICpfX2Zyb20sIGNvbnN0IGNoYXIgKl9fdG8pCiAgICAgX19hdHRyaWJ1 dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxs X18gKDEsIDIpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoK
CmV4dGVybiBpbnQgbGlua2F0IChpbnQgX19mcm9tZmQsIGNvbnN0IGNoYXIgKl9fZnJvbSwgaW50 IF9fdG9mZCwKICAgICBjb25zdCBjaGFyICpfX3RvLCBpbnQgX19mbGFncykKICAgICBfX2F0dHJp YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51
bGxfXyAoMiwgNCkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoK CgoKZXh0ZXJuIGludCBzeW1saW5rIChjb25zdCBjaGFyICpfX2Zyb20sIGNvbnN0IGNoYXIgKl9f dG8pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJp
YnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVz ZWRfcmVzdWx0X18pKTsKCgoKCmV4dGVybiBzc2l6ZV90IHJlYWRsaW5rIChjb25zdCBjaGFyICpf X3Jlc3RyaWN0IF9fcGF0aCwKICAgIGNoYXIgKl9fcmVzdHJpY3QgX19idWYsIHNpemVfdCBfX2xl
bikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmli dXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNl ZF9yZXN1bHRfXykpOwoKCgoKZXh0ZXJuIGludCBzeW1saW5rYXQgKGNvbnN0IGNoYXIgKl9fZnJv
bSwgaW50IF9fdG9mZCwKICAgICAgICBjb25zdCBjaGFyICpfX3RvKSBfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwg MykpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCmV4dGVybiBz
c2l6ZV90IHJlYWRsaW5rYXQgKGludCBfX2ZkLCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fcGF0 aCwKICAgICAgY2hhciAqX19yZXN0cmljdCBfX2J1Ziwgc2l6ZV90IF9fbGVuKQogICAgIF9fYXR0 cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgyLCAzKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7 CgoKCmV4dGVybiBpbnQgdW5saW5rIChjb25zdCBjaGFyICpfX25hbWUpIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx
KSkpOwoKCgpleHRlcm4gaW50IHVubGlua2F0IChpbnQgX19mZCwgY29uc3QgY2hhciAqX19uYW1l LCBpbnQgX19mbGFnKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9f KSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyKSkpOwoKCgpleHRlcm4gaW50IHJtZGly
IChjb25zdCBjaGFyICpfX3BhdGgpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh Zl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgpleHRlcm4gX19waWRf dCB0Y2dldHBncnAgKGludCBfX2ZkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl
YWZfXykpOwoKCmV4dGVybiBpbnQgdGNzZXRwZ3JwIChpbnQgX19mZCwgX19waWRfdCBfX3BncnBf aWQpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgoKCmV4dGVy biBjaGFyICpnZXRsb2dpbiAodm9pZCk7CgoKCgoKCgpleHRlcm4gaW50IGdldGxvZ2luX3IgKGNo
YXIgKl9fbmFtZSwgc2l6ZV90IF9fbmFtZV9sZW4pIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxf XyAoMSkpKTsKCgoKCmV4dGVybiBpbnQgc2V0bG9naW4gKGNvbnN0IGNoYXIgKl9fbmFtZSkgX19h dHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19u
b25udWxsX18gKDEpKSk7CiMgODc0ICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDMgNAojIDEgIi91 c3IvaW5jbHVkZS9nZXRvcHQuaCIgMSAzIDQKIyA1NyAiL3Vzci9pbmNsdWRlL2dldG9wdC5oIiAz IDQKZXh0ZXJuIGNoYXIgKm9wdGFyZzsKIyA3MSAiL3Vzci9pbmNsdWRlL2dldG9wdC5oIiAzIDQK
ZXh0ZXJuIGludCBvcHRpbmQ7CgoKCgpleHRlcm4gaW50IG9wdGVycjsKCgoKZXh0ZXJuIGludCBv cHRvcHQ7CiMgMTUwICIvdXNyL2luY2x1ZGUvZ2V0b3B0LmgiIDMgNApleHRlcm4gaW50IGdldG9w dCAoaW50IF9fX2FyZ2MsIGNoYXIgKmNvbnN0ICpfX19hcmd2LCBjb25zdCBjaGFyICpfX3Nob3J0
b3B0cykKICAgICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CiMg ODc1ICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDIgMyA0CgoKCgoKCgpleHRlcm4gaW50IGdldGhv c3RuYW1lIChjaGFyICpfX25hbWUsIHNpemVfdCBfX2xlbikgX19hdHRyaWJ1dGVfXyAoKF9fbm90
aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoK CgoKCmV4dGVybiBpbnQgc2V0aG9zdG5hbWUgKGNvbnN0IGNoYXIgKl9fbmFtZSwgc2l6ZV90IF9f bGVuKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRy
aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2Vk X3Jlc3VsdF9fKSk7CgoKCmV4dGVybiBpbnQgc2V0aG9zdGlkIChsb25nIGludCBfX2lkKSBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3dh
cm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKZXh0ZXJuIGludCBnZXRkb21haW5uYW1lIChjaGFy ICpfX25hbWUsIHNpemVfdCBfX2xlbikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18g LCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0
ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gaW50IHNldGRvbWFpbm5hbWUg KGNvbnN0IGNoYXIgKl9fbmFtZSwgc2l6ZV90IF9fbGVuKQogICAgIF9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkp
IF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKZXh0ZXJuIGlu dCB2aGFuZ3VwICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykp OwoKCmV4dGVybiBpbnQgcmV2b2tlIChjb25zdCBjaGFyICpfX2ZpbGUpIF9fYXR0cmlidXRlX18g
KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx KSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKCgpleHRl cm4gaW50IHByb2ZpbCAodW5zaWduZWQgc2hvcnQgaW50ICpfX3NhbXBsZV9idWZmZXIsIHNpemVf
dCBfX3NpemUsCiAgICAgc2l6ZV90IF9fb2Zmc2V0LCB1bnNpZ25lZCBpbnQgX19zY2FsZSkKICAg ICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18g KChfX25vbm51bGxfXyAoMSkpKTsKCgoKCgpleHRlcm4gaW50IGFjY3QgKGNvbnN0IGNoYXIgKl9f
bmFtZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKZXh0ZXJu IGNoYXIgKmdldHVzZXJzaGVsbCAodm9pZCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg X19sZWFmX18pKTsKZXh0ZXJuIHZvaWQgZW5kdXNlcnNoZWxsICh2b2lkKSBfX2F0dHJpYnV0ZV9f
ICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwpleHRlcm4gdm9pZCBzZXR1c2Vyc2hlbGwgKHZv aWQpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgoKZXh0ZXJu IGludCBkYWVtb24gKGludCBfX25vY2hkaXIsIGludCBfX25vY2xvc2UpIF9fYXR0cmlidXRlX18g
KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRf cmVzdWx0X18pKTsKCgoKCgoKZXh0ZXJuIGludCBjaHJvb3QgKGNvbnN0IGNoYXIgKl9fcGF0aCkg X19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgo
X19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18p KTsKCgoKZXh0ZXJuIGNoYXIgKmdldHBhc3MgKGNvbnN0IGNoYXIgKl9fcHJvbXB0KSBfX2F0dHJp YnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoKCgpleHRlcm4gaW50IGZzeW5jIChpbnQg
X19mZCk7CgoKCgoKZXh0ZXJuIGludCBzeW5jZnMgKGludCBfX2ZkKSBfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKCgpleHRlcm4gbG9uZyBpbnQgZ2V0aG9zdGlk ICh2b2lkKTsKCgpleHRlcm4gdm9pZCBzeW5jICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro
cm93X18gLCBfX2xlYWZfXykpOwoKCgoKCmV4dGVybiBpbnQgZ2V0cGFnZXNpemUgKHZvaWQpIF9f YXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f Y29uc3RfXykpOwoKCgoKZXh0ZXJuIGludCBnZXRkdGFibGVzaXplICh2b2lkKSBfX2F0dHJpYnV0
ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwojIDk5NiAiL3Vzci9pbmNsdWRlL3VuaXN0 ZC5oIiAzIDQKZXh0ZXJuIGludCB0cnVuY2F0ZSAoY29uc3QgY2hhciAqX19maWxlLCBfX29mZl90 IF9fbGVuZ3RoKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkg
X19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5f dW51c2VkX3Jlc3VsdF9fKSk7CiMgMTAwOCAiL3Vzci9pbmNsdWRlL3VuaXN0ZC5oIiAzIDQKZXh0 ZXJuIGludCB0cnVuY2F0ZTY0IChjb25zdCBjaGFyICpfX2ZpbGUsIF9fb2ZmNjRfdCBfX2xlbmd0
aCkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmli dXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9y ZXN1bHRfXykpOwojIDEwMTkgIi91c3IvaW5jbHVkZS91bmlzdGQuaCIgMyA0CmV4dGVybiBpbnQg
ZnRydW5jYXRlIChpbnQgX19mZCwgX19vZmZfdCBfX2xlbmd0aCkgX19hdHRyaWJ1dGVfXyAoKF9f bm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1 bHRfXykpOwojIDEwMjkgIi91c3IvaW5jbHVkZS91bmlzdGQuaCIgMyA0CmV4dGVybiBpbnQgZnRy
dW5jYXRlNjQgKGludCBfX2ZkLCBfX29mZjY0X3QgX19sZW5ndGgpIF9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVz dWx0X18pKTsKIyAxMDQwICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDMgNApleHRlcm4gaW50IGJy
ayAodm9pZCAqX19hZGRyKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykp IF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKZXh0ZXJuIHZv aWQgKnNicmsgKGludHB0cl90IF9fZGVsdGEpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs
IF9fbGVhZl9fKSk7CiMgMTA2MSAiL3Vzci9pbmNsdWRlL3VuaXN0ZC5oIiAzIDQKZXh0ZXJuIGxv bmcgaW50IHN5c2NhbGwgKGxvbmcgaW50IF9fc3lzbm8sIC4uLikgX19hdHRyaWJ1dGVfXyAoKF9f bm90aHJvd19fICwgX19sZWFmX18pKTsKIyAxMDg0ICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDMg
NApleHRlcm4gaW50IGxvY2tmIChpbnQgX19mZCwgaW50IF9fY21kLCBfX29mZl90IF9fbGVuKSBf X2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDEwOTQgIi91c3IvaW5j bHVkZS91bmlzdGQuaCIgMyA0CmV4dGVybiBpbnQgbG9ja2Y2NCAoaW50IF9fZmQsIGludCBfX2Nt
ZCwgX19vZmY2NF90IF9fbGVuKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRf XykpOwojIDExMTUgIi91c3IvaW5jbHVkZS91bmlzdGQuaCIgMyA0CmV4dGVybiBpbnQgZmRhdGFz eW5jIChpbnQgX19maWxkZXMpOwoKCgoKCgoKZXh0ZXJuIGNoYXIgKmNyeXB0IChjb25zdCBjaGFy
ICpfX2tleSwgY29uc3QgY2hhciAqX19zYWx0KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhy b3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoK CgpleHRlcm4gdm9pZCBlbmNyeXB0IChjaGFyICpfX2dsaWJjX2Jsb2NrLCBpbnQgX19lZGZsYWcp
CiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0 ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoKCmV4dGVybiB2b2lkIHN3YWIgKGNvbnN0IHZv aWQgKl9fcmVzdHJpY3QgX19mcm9tLCB2b2lkICpfX3Jlc3RyaWN0IF9fdG8sCiAgICBzc2l6ZV90
IF9fbikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0 ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CiMgMTE1MSAiL3Vzci9pbmNsdWRlL3VuaXN0ZC5o IiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy91bmlzdGQuaCIgMSAzIDQKIyAyMyAiL3Vzci9p
bmNsdWRlL2JpdHMvdW5pc3RkLmgiIDMgNApleHRlcm4gc3NpemVfdCBfX3JlYWRfY2hrIChpbnQg X19mZCwgdm9pZCAqX19idWYsIHNpemVfdCBfX25ieXRlcywKICAgICAgc2l6ZV90IF9fYnVmbGVu KSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gc3NpemVf
dCBfX3JlYWRfYWxpYXMgKGludCBfX2ZkLCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbmJ5dGVzKSBf X2FzbV9fICgiIiAicmVhZCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2F0dHJp YnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gc3NpemVfdCBfX3JlYWRf
Y2hrX3dhcm4gKGludCBfX2ZkLCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbmJ5dGVzLCBzaXplX3Qg X19idWZsZW4pIF9fYXNtX18gKCIiICJfX3JlYWRfY2hrIikKCgogICAgIF9fYXR0cmlidXRlX18g KChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuaW5nX18gKCJy
ZWFkIGNhbGxlZCB3aXRoIGJpZ2dlciBsZW5ndGggdGhhbiBzaXplIG9mICIgInRoZSBkZXN0aW5h dGlvbiBidWZmZXIiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CgpleHRl cm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkg X19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBzc2l6ZV90CnJlYWQgKGlu dCBfX2ZkLCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbmJ5dGVzKQp7CiAgaWYgKF9fYnVpbHRpbl9v
YmplY3Rfc2l6ZSAoX19idWYsIDApICE9IChzaXplX3QpIC0xKQogICAgewogICAgICBpZiAoIV9f YnVpbHRpbl9jb25zdGFudF9wIChfX25ieXRlcykpCiByZXR1cm4gX19yZWFkX2NoayAoX19mZCwg X19idWYsIF9fbmJ5dGVzLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAwKSk7CgogICAg
ICBpZiAoX19uYnl0ZXMgPiBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAwKSkKIHJldHVy biBfX3JlYWRfY2hrX3dhcm4gKF9fZmQsIF9fYnVmLCBfX25ieXRlcywgX19idWlsdGluX29iamVj dF9zaXplIChfX2J1ZiwgMCkpOwogICAgfQogIHJldHVybiBfX3JlYWRfYWxpYXMgKF9fZmQsIF9f
YnVmLCBfX25ieXRlcyk7Cn0KCgpleHRlcm4gc3NpemVfdCBfX3ByZWFkX2NoayAoaW50IF9fZmQs IHZvaWQgKl9fYnVmLCBzaXplX3QgX19uYnl0ZXMsCiAgICAgICBfX29mZl90IF9fb2Zmc2V0LCBz aXplX3QgX19idWZzaXplKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykp
OwpleHRlcm4gc3NpemVfdCBfX3ByZWFkNjRfY2hrIChpbnQgX19mZCwgdm9pZCAqX19idWYsIHNp emVfdCBfX25ieXRlcywKICAgICAgICAgX19vZmY2NF90IF9fb2Zmc2V0LCBzaXplX3QgX19idWZz aXplKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gc3Np
emVfdCBfX3ByZWFkX2FsaWFzIChpbnQgX19mZCwgdm9pZCAqX19idWYsIHNpemVfdCBfX25ieXRl cywgX19vZmZfdCBfX29mZnNldCkgX19hc21fXyAoIiIgInByZWFkIikKCiAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9f
KSk7CmV4dGVybiBzc2l6ZV90IF9fcHJlYWQ2NF9hbGlhcyAoaW50IF9fZmQsIHZvaWQgKl9fYnVm LCBzaXplX3QgX19uYnl0ZXMsIF9fb2ZmNjRfdCBfX29mZnNldCkgX19hc21fXyAoIiIgInByZWFk NjQiKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fYXR0cmlidXRlX18g
KChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBzc2l6ZV90IF9fcHJlYWRfY2hrX3dh cm4gKGludCBfX2ZkLCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbmJ5dGVzLCBfX29mZl90IF9fb2Zm c2V0LCBzaXplX3QgX19idWZzaXplKSBfX2FzbV9fICgiIiAiX19wcmVhZF9jaGsiKQoKCiAgICAg
X19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBfX2F0dHJpYnV0ZV9fKChf X3dhcm5pbmdfXyAoInByZWFkIGNhbGxlZCB3aXRoIGJpZ2dlciBsZW5ndGggdGhhbiBzaXplIG9m ICIgInRoZSBkZXN0aW5hdGlvbiBidWZmZXIiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICA7CmV4dGVybiBzc2l6ZV90IF9fcHJlYWQ2NF9jaGtfd2FybiAoaW50IF9fZmQsIHZv aWQgKl9fYnVmLCBzaXplX3QgX19uYnl0ZXMsIF9fb2ZmNjRfdCBfX29mZnNldCwgc2l6ZV90IF9f YnVmc2l6ZSkgX19hc21fXyAoIiIgIl9fcHJlYWQ2NF9jaGsiKQoKCgogICAgIF9fYXR0cmlidXRl
X18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuaW5nX18g KCJwcmVhZDY0IGNhbGxlZCB3aXRoIGJpZ2dlciBsZW5ndGggdGhhbiBzaXplIG9mICIgInRoZSBk ZXN0aW5hdGlvbiBidWZmZXIiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7
CgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9f YXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNp YWxfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgc3NpemVfdApw
cmVhZCAoaW50IF9fZmQsIHZvaWQgKl9fYnVmLCBzaXplX3QgX19uYnl0ZXMsIF9fb2ZmX3QgX19v ZmZzZXQpCnsKICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMCkgIT0gKHNpemVf dCkgLTEpCiAgICB7CiAgICAgIGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fbmJ5dGVzKSkK
IHJldHVybiBfX3ByZWFkX2NoayAoX19mZCwgX19idWYsIF9fbmJ5dGVzLCBfX29mZnNldCwgX19i dWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMCkpOwoKICAgICAgaWYgKCBfX25ieXRlcyA+IF9f YnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDApKQogcmV0dXJuIF9fcHJlYWRfY2hrX3dhcm4g
KF9fZmQsIF9fYnVmLCBfX25ieXRlcywgX19vZmZzZXQsCiAgICAgX19idWlsdGluX29iamVjdF9z aXplIChfX2J1ZiwgMCkpOwogICAgfQogIHJldHVybiBfX3ByZWFkX2FsaWFzIChfX2ZkLCBfX2J1 ZiwgX19uYnl0ZXMsIF9fb2Zmc2V0KTsKfQojIDEwNCAiL3Vzci9pbmNsdWRlL2JpdHMvdW5pc3Rk
LmgiIDMgNApleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9f KSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0 aWZpY2lhbF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBzc2l6
ZV90CnByZWFkNjQgKGludCBfX2ZkLCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbmJ5dGVzLCBfX29m ZjY0X3QgX19vZmZzZXQpCnsKICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMCkg IT0gKHNpemVfdCkgLTEpCiAgICB7CiAgICAgIGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9f
bmJ5dGVzKSkKIHJldHVybiBfX3ByZWFkNjRfY2hrIChfX2ZkLCBfX2J1ZiwgX19uYnl0ZXMsIF9f b2Zmc2V0LCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAwKSk7CgogICAgICBpZiAoIF9f bmJ5dGVzID4gX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMCkpCiByZXR1cm4gX19wcmVh
ZDY0X2Noa193YXJuIChfX2ZkLCBfX2J1ZiwgX19uYnl0ZXMsIF9fb2Zmc2V0LAogICAgICAgX19i dWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMCkpOwogICAgfQoKICByZXR1cm4gX19wcmVhZDY0 X2FsaWFzIChfX2ZkLCBfX2J1ZiwgX19uYnl0ZXMsIF9fb2Zmc2V0KTsKfQoKCgoKZXh0ZXJuIHNz
aXplX3QgX19yZWFkbGlua19jaGsgKGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19wYXRoLAogICAg ICAgICAgY2hhciAqX19yZXN0cmljdCBfX2J1Ziwgc2l6ZV90IF9fbGVuLAogICAgICAgICAgc2l6 ZV90IF9fYnVmbGVuKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9f
KSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpIF9fYXR0cmlidXRlX18gKChf X3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBzc2l6ZV90IF9fcmVhZGxpbmtfYWxpYXMg KGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19wYXRoLCBjaGFyICpfX3Jlc3RyaWN0IF9fYnVmLCBz
aXplX3QgX19sZW4pIF9fYXNtX18gKCIiICJyZWFkbGluayIpIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSkKCgogICAgIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo MSwgMikpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4g
c3NpemVfdCBfX3JlYWRsaW5rX2Noa193YXJuIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fcGF0 aCwgY2hhciAqX19yZXN0cmljdCBfX2J1Ziwgc2l6ZV90IF9fbGVuLCBzaXplX3QgX19idWZsZW4p IF9fYXNtX18gKCIiICJfX3JlYWRsaW5rX2NoayIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df
XyAsIF9fbGVhZl9fKSkKCgoKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIp KSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBfX2F0dHJpYnV0ZV9f KChfX3dhcm5pbmdfXyAoInJlYWRsaW5rIGNhbGxlZCB3aXRoIGJpZ2dlciBsZW5ndGggIiAidGhh
biBzaXplIG9mIGRlc3RpbmF0aW9uIGJ1ZmZlciIpKSkKICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3 YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAy KSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgc3NpemVfdApfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIHJlYWRsaW5rIChjb25zdCBjaGFy
ICpfX3Jlc3RyaWN0IF9fcGF0aCwgY2hhciAqX19yZXN0cmljdCBfX2J1Ziwgc2l6ZV90IF9fbGVu KQoKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkgIT0gKHNpemVf dCkgLTEpCiAgICB7CiAgICAgIGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fbGVuKSkKIHJl
dHVybiBfX3JlYWRsaW5rX2NoayAoX19wYXRoLCBfX2J1ZiwgX19sZW4sIF9fYnVpbHRpbl9vYmpl Y3Rfc2l6ZSAoX19idWYsIDIgPiAxKSk7CgogICAgICBpZiAoIF9fbGVuID4gX19idWlsdGluX29i amVjdF9zaXplIChfX2J1ZiwgMiA+IDEpKQogcmV0dXJuIF9fcmVhZGxpbmtfY2hrX3dhcm4gKF9f
cGF0aCwgX19idWYsIF9fbGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkp OwogICAgfQogIHJldHVybiBfX3JlYWRsaW5rX2FsaWFzIChfX3BhdGgsIF9fYnVmLCBfX2xlbik7 Cn0KCgoKZXh0ZXJuIHNzaXplX3QgX19yZWFkbGlua2F0X2NoayAoaW50IF9fZmQsIGNvbnN0IGNo
YXIgKl9fcmVzdHJpY3QgX19wYXRoLAogICAgIGNoYXIgKl9fcmVzdHJpY3QgX19idWYsIHNpemVf dCBfX2xlbiwKICAgICBzaXplX3QgX19idWZsZW4pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90 aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIsIDMpKSkg
X19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIHNzaXplX3Qg X19yZWFkbGlua2F0X2FsaWFzIChpbnQgX19mZCwgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3Bh dGgsIGNoYXIgKl9fcmVzdHJpY3QgX19idWYsIHNpemVfdCBfX2xlbikgX19hc21fXyAoIiIgInJl
YWRsaW5rYXQiKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpCgoKCiAg ICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyLCAzKSkpIF9fYXR0cmlidXRlX18gKChf X3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBzc2l6ZV90IF9fcmVhZGxpbmthdF9jaGtf
d2FybiAoaW50IF9fZmQsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19wYXRoLCBjaGFyICpfX3Jl c3RyaWN0IF9fYnVmLCBzaXplX3QgX19sZW4sIHNpemVfdCBfX2J1ZmxlbikgX19hc21fXyAoIiIg Il9fcmVhZGxpbmthdF9jaGsiKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZf
XykpCgoKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyLCAzKSkpIF9fYXR0cmli dXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuaW5n X18gKCJyZWFkbGlua2F0IGNhbGxlZCB3aXRoIGJpZ2dlciAiICJsZW5ndGggdGhhbiBzaXplIG9m
IGRlc3RpbmF0aW9uICIgImJ1ZmZlciIpKSkKCiAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19p bmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAo KF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgX19hdHRy
aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyLCAzKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51 c2VkX3Jlc3VsdF9fKSkgc3NpemVfdApfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl YWZfXykpIHJlYWRsaW5rYXQgKGludCBfX2ZkLCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fcGF0
aCwgY2hhciAqX19yZXN0cmljdCBfX2J1Ziwgc2l6ZV90IF9fbGVuKQoKewogIGlmIChfX2J1aWx0 aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICB7CiAgICAg IGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fbGVuKSkKIHJldHVybiBfX3JlYWRsaW5rYXRf
Y2hrIChfX2ZkLCBfX3BhdGgsIF9fYnVmLCBfX2xlbiwgX19idWlsdGluX29iamVjdF9zaXplIChf X2J1ZiwgMiA+IDEpKTsKCiAgICAgIGlmIChfX2xlbiA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAo X19idWYsIDIgPiAxKSkKIHJldHVybiBfX3JlYWRsaW5rYXRfY2hrX3dhcm4gKF9fZmQsIF9fcGF0
aCwgX19idWYsIF9fbGVuLAogICAgICAgICAgX19idWlsdGluX29iamVjdF9zaXplIChfX2J1Ziwg MiA+IDEpKTsKICAgIH0KICByZXR1cm4gX19yZWFkbGlua2F0X2FsaWFzIChfX2ZkLCBfX3BhdGgs IF9fYnVmLCBfX2xlbik7Cn0KCgpleHRlcm4gY2hhciAqX19nZXRjd2RfY2hrIChjaGFyICpfX2J1
Ziwgc2l6ZV90IF9fc2l6ZSwgc2l6ZV90IF9fYnVmbGVuKQogICAgIF9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVz dWx0X18pKTsKZXh0ZXJuIGNoYXIgKl9fZ2V0Y3dkX2FsaWFzIChjaGFyICpfX2J1Ziwgc2l6ZV90
IF9fc2l6ZSkgX19hc21fXyAoIiIgImdldGN3ZCIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df XyAsIF9fbGVhZl9fKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBjaGFy
ICpfX2dldGN3ZF9jaGtfd2FybiAoY2hhciAqX19idWYsIHNpemVfdCBfX3NpemUsIHNpemVfdCBf X2J1ZmxlbikgX19hc21fXyAoIiIgIl9fZ2V0Y3dkX2NoayIpIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSkKCgogICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2Vk
X3Jlc3VsdF9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuaW5nX18gKCJnZXRjd2QgY2FsbGVyIHdp dGggYmlnZ2VyIGxlbmd0aCB0aGFuIHNpemUgb2YgIiAiZGVzdGluYXRpb24gYnVmZmVyIikpKQog ICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1
dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9f KSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fy bl91bnVzZWRfcmVzdWx0X18pKSBjaGFyICoKX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg
X19sZWFmX18pKSBnZXRjd2QgKGNoYXIgKl9fYnVmLCBzaXplX3QgX19zaXplKQp7CiAgaWYgKF9f YnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSAhPSAoc2l6ZV90KSAtMSkKICAgIHsK ICAgICAgaWYgKCFfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19zaXplKSkKIHJldHVybiBfX2dldGN3
ZF9jaGsgKF9fYnVmLCBfX3NpemUsIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAx KSk7CgogICAgICBpZiAoX19zaXplID4gX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+ IDEpKQogcmV0dXJuIF9fZ2V0Y3dkX2Noa193YXJuIChfX2J1ZiwgX19zaXplLCBfX2J1aWx0aW5f
b2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkpOwogICAgfQogIHJldHVybiBfX2dldGN3ZF9hbGlh cyAoX19idWYsIF9fc2l6ZSk7Cn0KCgpleHRlcm4gY2hhciAqX19nZXR3ZF9jaGsgKGNoYXIgKl9f YnVmLCBzaXplX3QgYnVmbGVuKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f
bGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18g KChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBjaGFyICpfX2dldHdkX3dhcm4gKGNo YXIgKl9fYnVmKSBfX2FzbV9fICgiIiAiZ2V0d2QiKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93
X18gLCBfX2xlYWZfXykpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9f YXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgX19hdHRyaWJ1dGVfXygoX193 YXJuaW5nX18gKCJwbGVhc2UgdXNlIGdldGN3ZCBpbnN0ZWFkLCBhcyBnZXR3ZCAiICJkb2Vzbid0
IHNwZWNpZnkgYnVmZmVyIHNpemUiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxp bmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChf
X2FydGlmaWNpYWxfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJp YnV0ZV9fICgoX19kZXByZWNhdGVkX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9y ZXN1bHRfXykpIGNoYXIgKgpfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykp
IGdldHdkIChjaGFyICpfX2J1ZikKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVm LCAyID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICByZXR1cm4gX19nZXR3ZF9jaGsgKF9fYnVmLCBf X2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkpOwogIHJldHVybiBfX2dldHdkX3dh
cm4gKF9fYnVmKTsKfQoKCmV4dGVybiBzaXplX3QgX19jb25mc3RyX2NoayAoaW50IF9fbmFtZSwg Y2hhciAqX19idWYsIHNpemVfdCBfX2xlbiwKICAgICAgICBzaXplX3QgX19idWZsZW4pIF9fYXR0 cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CmV4dGVybiBzaXplX3QgX19jb25m
c3RyX2FsaWFzIChpbnQgX19uYW1lLCBjaGFyICpfX2J1Ziwgc2l6ZV90IF9fbGVuKSBfX2FzbV9f ICgiIiAiY29uZnN0ciIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkK ICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CmV4dGVybiBzaXplX3QgX19jb25mc3RyX2No
a193YXJuIChpbnQgX19uYW1lLCBjaGFyICpfX2J1Ziwgc2l6ZV90IF9fbGVuLCBzaXplX3QgX19i dWZsZW4pIF9fYXNtX18gKCIiICJfX2NvbmZzdHJfY2hrIikgX19hdHRyaWJ1dGVfXyAoKF9fbm90 aHJvd19fICwgX19sZWFmX18pKQoKCiAgICAgX19hdHRyaWJ1dGVfXygoX193YXJuaW5nX18gKCJj
b25mc3RyIGNhbGxlZCB3aXRoIGJpZ2dlciBsZW5ndGggdGhhbiBzaXplIG9mIGRlc3RpbmF0aW9u ICIgImJ1ZmZlciIpKSkKICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRl X18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIHNpemVfdApfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpIGNvbmZzdHIgKGludCBfX25hbWUsIGNoYXIgKl9fYnVm LCBzaXplX3QgX19sZW4pCnsKICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+
IDEpICE9IChzaXplX3QpIC0xKQogICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9w IChfX2xlbikpCiByZXR1cm4gX19jb25mc3RyX2NoayAoX19uYW1lLCBfX2J1ZiwgX19sZW4sIF9f YnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSk7CgogICAgICBpZiAoX19idWlsdGlu
X29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpIDwgX19sZW4pCiByZXR1cm4gX19jb25mc3RyX2No a193YXJuIChfX25hbWUsIF9fYnVmLCBfX2xlbiwgX19idWlsdGluX29iamVjdF9zaXplIChfX2J1 ZiwgMiA+IDEpKTsKICAgIH0KICByZXR1cm4gX19jb25mc3RyX2FsaWFzIChfX25hbWUsIF9fYnVm
LCBfX2xlbik7Cn0KCgpleHRlcm4gaW50IF9fZ2V0Z3JvdXBzX2NoayAoaW50IF9fc2l6ZSwgX19n aWRfdCBfX2xpc3RbXSwgc2l6ZV90IF9fbGlzdGxlbikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19u b3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3Vs
dF9fKSk7CmV4dGVybiBpbnQgX19nZXRncm91cHNfYWxpYXMgKGludCBfX3NpemUsIF9fZ2lkX3Qg X19saXN0W10pIF9fYXNtX18gKCIiICJnZXRncm91cHMiKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro cm93X18gLCBfX2xlYWZfXykpCiAgICAgICAgICAgICAgICAgX19hdHRyaWJ1dGVfXyAoKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIGludCBfX2dldGdyb3Vwc19jaGtfd2FybiAoaW50 IF9fc2l6ZSwgX19naWRfdCBfX2xpc3RbXSwgc2l6ZV90IF9fbGlzdGxlbikgX19hc21fXyAoIiIg Il9fZ2V0Z3JvdXBzX2NoayIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9f
KSkKCgogICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgX19hdHRy aWJ1dGVfXygoX193YXJuaW5nX18gKCJnZXRncm91cHMgY2FsbGVkIHdpdGggYmlnZ2VyIGdyb3Vw IGNvdW50IHRoYW4gd2hhdCAiICJjYW4gZml0IGludG8gZGVzdGluYXRpb24gYnVmZmVyIikpKQog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5s aW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChf X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGludApfX2F0
dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIGdldGdyb3VwcyAoaW50IF9fc2l6 ZSwgX19naWRfdCBfX2xpc3RbXSkKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fbGlz dCwgMiA+IDEpICE9IChzaXplX3QpIC0xKQogICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9jb25z
dGFudF9wIChfX3NpemUpIHx8IF9fc2l6ZSA8IDApCiByZXR1cm4gX19nZXRncm91cHNfY2hrIChf X3NpemUsIF9fbGlzdCwgX19idWlsdGluX29iamVjdF9zaXplIChfX2xpc3QsIDIgPiAxKSk7Cgog ICAgICBpZiAoX19zaXplICogc2l6ZW9mIChfX2dpZF90KSA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6
ZSAoX19saXN0LCAyID4gMSkpCiByZXR1cm4gX19nZXRncm91cHNfY2hrX3dhcm4gKF9fc2l6ZSwg X19saXN0LCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fbGlzdCwgMiA+IDEpKTsKICAgIH0KICBy ZXR1cm4gX19nZXRncm91cHNfYWxpYXMgKF9fc2l6ZSwgX19saXN0KTsKfQoKCmV4dGVybiBpbnQg
X190dHluYW1lX3JfY2hrIChpbnQgX19mZCwgY2hhciAqX19idWYsIHNpemVfdCBfX2J1ZmxlbiwK ICAgICAgIHNpemVfdCBfX25yZWFsKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl YWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMikpKTsKZXh0ZXJuIGludCBfX3R0
eW5hbWVfcl9hbGlhcyAoaW50IF9fZmQsIGNoYXIgKl9fYnVmLCBzaXplX3QgX19idWZsZW4pIF9f YXNtX18gKCIiICJ0dHluYW1lX3IiKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl YWZfXykpCgogICAgIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMikpKTsKZXh0ZXJuIGlu
dCBfX3R0eW5hbWVfcl9jaGtfd2FybiAoaW50IF9fZmQsIGNoYXIgKl9fYnVmLCBzaXplX3QgX19i dWZsZW4sIHNpemVfdCBfX25yZWFsKSBfX2FzbV9fICgiIiAiX190dHluYW1lX3JfY2hrIikgX19h dHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKQoKCiAgICAgX19hdHRyaWJ1dGVf
XyAoKF9fbm9ubnVsbF9fICgyKSkpIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgidHR5bmFt ZV9yIGNhbGxlZCB3aXRoIGJpZ2dlciBidWZsZW4gdGhhbiAiICJzaXplIG9mIGRlc3RpbmF0aW9u IGJ1ZmZlciIpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKCmV4dGVybiBf
X2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f ICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBpbnQK X19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSB0dHluYW1lX3IgKGludCBf
X2ZkLCBjaGFyICpfX2J1Ziwgc2l6ZV90IF9fYnVmbGVuKQp7CiAgaWYgKF9fYnVpbHRpbl9vYmpl Y3Rfc2l6ZSAoX19idWYsIDIgPiAxKSAhPSAoc2l6ZV90KSAtMSkKICAgIHsKICAgICAgaWYgKCFf X2J1aWx0aW5fY29uc3RhbnRfcCAoX19idWZsZW4pKQogcmV0dXJuIF9fdHR5bmFtZV9yX2NoayAo
X19mZCwgX19idWYsIF9fYnVmbGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4g MSkpOwoKICAgICAgaWYgKF9fYnVmbGVuID4gX19idWlsdGluX29iamVjdF9zaXplIChfX2J1Ziwg MiA+IDEpKQogcmV0dXJuIF9fdHR5bmFtZV9yX2Noa193YXJuIChfX2ZkLCBfX2J1ZiwgX19idWZs
ZW4sIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSk7CiAgICB9CiAgcmV0dXJu IF9fdHR5bmFtZV9yX2FsaWFzIChfX2ZkLCBfX2J1ZiwgX19idWZsZW4pOwp9CgoKCmV4dGVybiBp bnQgX19nZXRsb2dpbl9yX2NoayAoY2hhciAqX19idWYsIHNpemVfdCBfX2J1Zmxlbiwgc2l6ZV90
IF9fbnJlYWwpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwpleHRlcm4g aW50IF9fZ2V0bG9naW5fcl9hbGlhcyAoY2hhciAqX19idWYsIHNpemVfdCBfX2J1ZmxlbikgX19h c21fXyAoIiIgImdldGxvZ2luX3IiKQogICAgICAgICAgICAgICAgICAgICBfX2F0dHJpYnV0ZV9f
ICgoX19ub25udWxsX18gKDEpKSk7CmV4dGVybiBpbnQgX19nZXRsb2dpbl9yX2Noa193YXJuIChj aGFyICpfX2J1Ziwgc2l6ZV90IF9fYnVmbGVuLCBzaXplX3QgX19ucmVhbCkgX19hc21fXyAoIiIg Il9fZ2V0bG9naW5fcl9jaGsiKQoKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx
KSkpIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgiZ2V0bG9naW5fciBjYWxsZWQgd2l0aCBi aWdnZXIgYnVmbGVuIHRoYW4gIiAic2l6ZSBvZiBkZXN0aW5hdGlvbiBidWZmZXIiKSkpCiAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1
dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9f KSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgaW50CmdldGxvZ2luX3IgKGNoYXIg Kl9fYnVmLCBzaXplX3QgX19idWZsZW4pCnsKICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChf
X2J1ZiwgMiA+IDEpICE9IChzaXplX3QpIC0xKQogICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9j b25zdGFudF9wIChfX2J1ZmxlbikpCiByZXR1cm4gX19nZXRsb2dpbl9yX2NoayAoX19idWYsIF9f YnVmbGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkpOwoKICAgICAgaWYg
KF9fYnVmbGVuID4gX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpKQogcmV0dXJu IF9fZ2V0bG9naW5fcl9jaGtfd2FybiAoX19idWYsIF9fYnVmbGVuLCBfX2J1aWx0aW5fb2JqZWN0 X3NpemUgKF9fYnVmLCAyID4gMSkpOwogICAgfQogIHJldHVybiBfX2dldGxvZ2luX3JfYWxpYXMg
KF9fYnVmLCBfX2J1Zmxlbik7Cn0KCgoKCmV4dGVybiBpbnQgX19nZXRob3N0bmFtZV9jaGsgKGNo YXIgKl9fYnVmLCBzaXplX3QgX19idWZsZW4sIHNpemVfdCBfX25yZWFsKQogICAgIF9fYXR0cmli dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs
bF9fICgxKSkpOwpleHRlcm4gaW50IF9fZ2V0aG9zdG5hbWVfYWxpYXMgKGNoYXIgKl9fYnVmLCBz aXplX3QgX19idWZsZW4pIF9fYXNtX18gKCIiICJnZXRob3N0bmFtZSIpIF9fYXR0cmlidXRlX18g KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkKICAgICAgICAgICAgICAgICAgIF9fYXR0cmlidXRl
X18gKChfX25vbm51bGxfXyAoMSkpKTsKZXh0ZXJuIGludCBfX2dldGhvc3RuYW1lX2Noa193YXJu IChjaGFyICpfX2J1Ziwgc2l6ZV90IF9fYnVmbGVuLCBzaXplX3QgX19ucmVhbCkgX19hc21fXyAo IiIgIl9fZ2V0aG9zdG5hbWVfY2hrIikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19s
ZWFmX18pKQoKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmli dXRlX18oKF9fd2FybmluZ19fICgiZ2V0aG9zdG5hbWUgY2FsbGVkIHdpdGggYmlnZ2VyIGJ1Zmxl biB0aGFuICIgInNpemUgb2YgZGVzdGluYXRpb24gYnVmZmVyIikpKQogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fs d2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli dXRlX18gKChfX2FydGlmaWNpYWxfXykpIGludApfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18g
LCBfX2xlYWZfXykpIGdldGhvc3RuYW1lIChjaGFyICpfX2J1Ziwgc2l6ZV90IF9fYnVmbGVuKQp7 CiAgaWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSAhPSAoc2l6ZV90KSAt MSkKICAgIHsKICAgICAgaWYgKCFfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19idWZsZW4pKQogcmV0
dXJuIF9fZ2V0aG9zdG5hbWVfY2hrIChfX2J1ZiwgX19idWZsZW4sIF9fYnVpbHRpbl9vYmplY3Rf c2l6ZSAoX19idWYsIDIgPiAxKSk7CgogICAgICBpZiAoX19idWZsZW4gPiBfX2J1aWx0aW5fb2Jq ZWN0X3NpemUgKF9fYnVmLCAyID4gMSkpCiByZXR1cm4gX19nZXRob3N0bmFtZV9jaGtfd2FybiAo
X19idWYsIF9fYnVmbGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkpOwog ICAgfQogIHJldHVybiBfX2dldGhvc3RuYW1lX2FsaWFzIChfX2J1ZiwgX19idWZsZW4pOwp9CgoK CgpleHRlcm4gaW50IF9fZ2V0ZG9tYWlubmFtZV9jaGsgKGNoYXIgKl9fYnVmLCBzaXplX3QgX19i
dWZsZW4sIHNpemVfdCBfX25yZWFsKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs IF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRl X18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBpbnQgX19nZXRkb21haW5uYW1l
X2FsaWFzIChjaGFyICpfX2J1Ziwgc2l6ZV90IF9fYnVmbGVuKSBfX2FzbV9fICgiIiAiZ2V0ZG9t YWlubmFtZSIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkKCiAgICAg ICAgICAgICAgICAgICAgIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJp
YnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gaW50IF9fZ2V0ZG9tYWlu bmFtZV9jaGtfd2FybiAoY2hhciAqX19idWYsIHNpemVfdCBfX2J1Zmxlbiwgc2l6ZV90IF9fbnJl YWwpIF9fYXNtX18gKCIiICJfX2dldGRvbWFpbm5hbWVfY2hrIikgX19hdHRyaWJ1dGVfXyAoKF9f
bm90aHJvd19fICwgX19sZWFmX18pKQoKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f ICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgX19hdHRyaWJ1 dGVfXygoX193YXJuaW5nX18gKCJnZXRkb21haW5uYW1lIGNhbGxlZCB3aXRoIGJpZ2dlciAiICJi
dWZsZW4gdGhhbiBzaXplIG9mIGRlc3RpbmF0aW9uICIgImJ1ZmZlciIpKSkKCiAgICAgICAgICAg ICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxp bmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChf
X2FydGlmaWNpYWxfXykpIGludApfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZf XykpIGdldGRvbWFpbm5hbWUgKGNoYXIgKl9fYnVmLCBzaXplX3QgX19idWZsZW4pCnsKICBpZiAo X19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpICE9IChzaXplX3QpIC0xKQogICAg
ewogICAgICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX2J1ZmxlbikpCiByZXR1cm4gX19n ZXRkb21haW5uYW1lX2NoayAoX19idWYsIF9fYnVmbGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUg KF9fYnVmLCAyID4gMSkpOwoKICAgICAgaWYgKF9fYnVmbGVuID4gX19idWlsdGluX29iamVjdF9z
aXplIChfX2J1ZiwgMiA+IDEpKQogcmV0dXJuIF9fZ2V0ZG9tYWlubmFtZV9jaGtfd2FybiAoX19i dWYsIF9fYnVmbGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkpOwogICAg fQogIHJldHVybiBfX2dldGRvbWFpbm5hbWVfYWxpYXMgKF9fYnVmLCBfX2J1Zmxlbik7Cn0KIyAx
MTUyICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDIgMyA0CgoKCiMgMjggIm5ldGxpbmsuYyIgMgoj IDEgIi91c3IvaW5jbHVkZS9zdHJpbmcuaCIgMSAzIDQKIyAyNyAiL3Vzci9pbmNsdWRlL3N0cmlu Zy5oIiAzIDQKCgoKCgojIDEgIi91c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAv
aW5jbHVkZS9zdGRkZWYuaCIgMSAzIDQKIyAzMyAiL3Vzci9pbmNsdWRlL3N0cmluZy5oIiAyIDMg NAoKCgoKCgoKCgpleHRlcm4gdm9pZCAqbWVtY3B5ICh2b2lkICpfX3Jlc3RyaWN0IF9fZGVzdCwg Y29uc3Qgdm9pZCAqX19yZXN0cmljdCBfX3NyYywKICAgICAgIHNpemVfdCBfX24pIF9fYXR0cmli
dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs bF9fICgxLCAyKSkpOwoKCmV4dGVybiB2b2lkICptZW1tb3ZlICh2b2lkICpfX2Rlc3QsIGNvbnN0 IHZvaWQgKl9fc3JjLCBzaXplX3QgX19uKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df
XyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCgoK CgpleHRlcm4gdm9pZCAqbWVtY2NweSAodm9pZCAqX19yZXN0cmljdCBfX2Rlc3QsIGNvbnN0IHZv aWQgKl9fcmVzdHJpY3QgX19zcmMsCiAgICAgICAgaW50IF9fYywgc2l6ZV90IF9fbikKICAgICBf
X2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChf X25vbm51bGxfXyAoMSwgMikpKTsKCgoKCgpleHRlcm4gdm9pZCAqbWVtc2V0ICh2b2lkICpfX3Ms IGludCBfX2MsIHNpemVfdCBfX24pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh
Zl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQgbWVt Y21wIChjb25zdCB2b2lkICpfX3MxLCBjb25zdCB2b2lkICpfX3MyLCBzaXplX3QgX19uKQogICAg IF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAo
KF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwojIDkyICIv dXNyL2luY2x1ZGUvc3RyaW5nLmgiIDMgNApleHRlcm4gdm9pZCAqbWVtY2hyIChjb25zdCB2b2lk ICpfX3MsIGludCBfX2MsIHNpemVfdCBfX24pCiAgICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhy
b3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVf XyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCiMgMTA2ICIvdXNyL2luY2x1ZGUvc3RyaW5nLmgiIDMg NApleHRlcm4gdm9pZCAqcmF3bWVtY2hyIChjb25zdCB2b2lkICpfX3MsIGludCBfX2MpCiAgICAg
X19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgo X19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CiMgMTE3ICIvdXNy L2luY2x1ZGUvc3RyaW5nLmgiIDMgNApleHRlcm4gdm9pZCAqbWVtcmNociAoY29uc3Qgdm9pZCAq
X19zLCBpbnQgX19jLCBzaXplX3QgX19uKQogICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93 X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18g KChfX25vbm51bGxfXyAoMSkpKTsKCgoKCgoKZXh0ZXJuIGNoYXIgKnN0cmNweSAoY2hhciAqX19y
ZXN0cmljdCBfX2Rlc3QsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zcmMpCiAgICAgX19hdHRy aWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25u dWxsX18gKDEsIDIpKSk7CgpleHRlcm4gY2hhciAqc3RybmNweSAoY2hhciAqX19yZXN0cmljdCBf
X2Rlc3QsCiAgICAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbikK ICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRl X18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gY2hhciAqc3RyY2F0IChjaGFyICpf
X3Jlc3RyaWN0IF9fZGVzdCwgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3NyYykKICAgICBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25v bm51bGxfXyAoMSwgMikpKTsKCmV4dGVybiBjaGFyICpzdHJuY2F0IChjaGFyICpfX3Jlc3RyaWN0
IF9fZGVzdCwgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3NyYywKICAgICAgICBzaXplX3QgX19u KSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18g KChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHN0cmNtcCAoY29uc3QgY2hhciAq
X19zMSwgY29uc3QgY2hhciAqX19zMikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18g LCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChf X25vbm51bGxfXyAoMSwgMikpKTsKCmV4dGVybiBpbnQgc3RybmNtcCAoY29uc3QgY2hhciAqX19z
MSwgY29uc3QgY2hhciAqX19zMiwgc2l6ZV90IF9fbikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19u b3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmli dXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHN0cmNvbGwgKGNvbnN0
IGNoYXIgKl9fczEsIGNvbnN0IGNoYXIgKl9fczIpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90 aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0 ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgpleHRlcm4gc2l6ZV90IHN0cnhmcm0gKGNoYXIg
Kl9fcmVzdHJpY3QgX19kZXN0LAogICAgICAgICBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fc3Jj LCBzaXplX3QgX19uKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9f KSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyKSkpOwoKCgoKCgojIDEgIi91c3IvaW5j
bHVkZS94bG9jYWxlLmgiIDEgMyA0CiMgMjcgIi91c3IvaW5jbHVkZS94bG9jYWxlLmgiIDMgNAp0 eXBlZGVmIHN0cnVjdCBfX2xvY2FsZV9zdHJ1Y3QKewoKICBzdHJ1Y3QgX19sb2NhbGVfZGF0YSAq X19sb2NhbGVzWzEzXTsKCgogIGNvbnN0IHVuc2lnbmVkIHNob3J0IGludCAqX19jdHlwZV9iOwog
IGNvbnN0IGludCAqX19jdHlwZV90b2xvd2VyOwogIGNvbnN0IGludCAqX19jdHlwZV90b3VwcGVy OwoKCiAgY29uc3QgY2hhciAqX19uYW1lc1sxM107Cn0gKl9fbG9jYWxlX3Q7CgoKdHlwZWRlZiBf X2xvY2FsZV90IGxvY2FsZV90OwojIDE2MCAiL3Vzci9pbmNsdWRlL3N0cmluZy5oIiAyIDMgNAoK
CmV4dGVybiBpbnQgc3RyY29sbF9sIChjb25zdCBjaGFyICpfX3MxLCBjb25zdCBjaGFyICpfX3My LCBfX2xvY2FsZV90IF9fbCkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl YWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51
bGxfXyAoMSwgMiwgMykpKTsKCmV4dGVybiBzaXplX3Qgc3RyeGZybV9sIChjaGFyICpfX2Rlc3Qs IGNvbnN0IGNoYXIgKl9fc3JjLCBzaXplX3QgX19uLAogICAgX19sb2NhbGVfdCBfX2wpIF9fYXR0 cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgyLCA0KSkpOwoKCgoKZXh0ZXJuIGNoYXIgKnN0cmR1cCAoY29uc3QgY2hhciAqX19z KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1 dGVfXyAoKF9fbWFsbG9jX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoK
CgoKCmV4dGVybiBjaGFyICpzdHJuZHVwIChjb25zdCBjaGFyICpfX3N0cmluZywgc2l6ZV90IF9f bikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmli dXRlX18gKChfX21hbGxvY19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoj
IDIwNiAiL3Vzci9pbmNsdWRlL3N0cmluZy5oIiAzIDQKCiMgMjMxICIvdXNyL2luY2x1ZGUvc3Ry aW5nLmgiIDMgNApleHRlcm4gY2hhciAqc3RyY2hyIChjb25zdCBjaGFyICpfX3MsIGludCBfX2Mp CiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0
ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CiMgMjU4 ICIvdXNyL2luY2x1ZGUvc3RyaW5nLmgiIDMgNApleHRlcm4gY2hhciAqc3RycmNociAoY29uc3Qg Y2hhciAqX19zLCBpbnQgX19jKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f
bGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u bnVsbF9fICgxKSkpOwoKCiMgMjcyICIvdXNyL2luY2x1ZGUvc3RyaW5nLmgiIDMgNApleHRlcm4g Y2hhciAqc3RyY2hybnVsIChjb25zdCBjaGFyICpfX3MsIGludCBfX2MpCiAgICAgX19hdHRyaWJ1
dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18p KSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoKCmV4dGVybiBzaXplX3Qg c3RyY3NwbiAoY29uc3QgY2hhciAqX19zLCBjb25zdCBjaGFyICpfX3JlamVjdCkKICAgICBfX2F0
dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1 cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gc2l6 ZV90IHN0cnNwbiAoY29uc3QgY2hhciAqX19zLCBjb25zdCBjaGFyICpfX2FjY2VwdCkKICAgICBf
X2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChf X3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKIyAzMTAgIi91 c3IvaW5jbHVkZS9zdHJpbmcuaCIgMyA0CmV4dGVybiBjaGFyICpzdHJwYnJrIChjb25zdCBjaGFy
ICpfX3MsIGNvbnN0IGNoYXIgKl9fYWNjZXB0KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhy b3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVf XyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwojIDMzNyAiL3Vzci9pbmNsdWRlL3N0cmluZy5oIiAz
IDQKZXh0ZXJuIGNoYXIgKnN0cnN0ciAoY29uc3QgY2hhciAqX19oYXlzdGFjaywgY29uc3QgY2hh ciAqX19uZWVkbGUpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18p KSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g
KDEsIDIpKSk7CgoKCgpleHRlcm4gY2hhciAqc3RydG9rIChjaGFyICpfX3Jlc3RyaWN0IF9fcywg Y29uc3QgY2hhciAqX19yZXN0cmljdCBfX2RlbGltKQogICAgIF9fYXR0cmlidXRlX18gKChfX25v dGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyKSkpOwoK
CgoKZXh0ZXJuIGNoYXIgKl9fc3RydG9rX3IgKGNoYXIgKl9fcmVzdHJpY3QgX19zLAogICAgY29u c3QgY2hhciAqX19yZXN0cmljdCBfX2RlbGltLAogICAgY2hhciAqKl9fcmVzdHJpY3QgX19zYXZl X3B0cikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0
cmlidXRlX18gKChfX25vbm51bGxfXyAoMiwgMykpKTsKCmV4dGVybiBjaGFyICpzdHJ0b2tfciAo Y2hhciAqX19yZXN0cmljdCBfX3MsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19kZWxpbSwKICAg ICAgICAgY2hhciAqKl9fcmVzdHJpY3QgX19zYXZlX3B0cikKICAgICBfX2F0dHJpYnV0ZV9fICgo
X19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMiwg MykpKTsKIyAzNjggIi91c3IvaW5jbHVkZS9zdHJpbmcuaCIgMyA0CmV4dGVybiBjaGFyICpzdHJj YXNlc3RyIChjb25zdCBjaGFyICpfX2hheXN0YWNrLCBjb25zdCBjaGFyICpfX25lZWRsZSkKICAg
ICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18g KChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgoKCgoK CmV4dGVybiB2b2lkICptZW1tZW0gKGNvbnN0IHZvaWQgKl9faGF5c3RhY2ssIHNpemVfdCBfX2hh
eXN0YWNrbGVuLAogICAgICAgY29uc3Qgdm9pZCAqX19uZWVkbGUsIHNpemVfdCBfX25lZWRsZWxl bikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmli dXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMykpKTsK
CgoKZXh0ZXJuIHZvaWQgKl9fbWVtcGNweSAodm9pZCAqX19yZXN0cmljdCBfX2Rlc3QsCiAgIGNv bnN0IHZvaWQgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX24pCiAgICAgX19hdHRyaWJ1dGVf XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g
KDEsIDIpKSk7CmV4dGVybiB2b2lkICptZW1wY3B5ICh2b2lkICpfX3Jlc3RyaWN0IF9fZGVzdCwK ICAgICAgICBjb25zdCB2b2lkICpfX3Jlc3RyaWN0IF9fc3JjLCBzaXplX3QgX19uKQogICAgIF9f YXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f
bm9ubnVsbF9fICgxLCAyKSkpOwoKCgoKCmV4dGVybiBzaXplX3Qgc3RybGVuIChjb25zdCBjaGFy ICpfX3MpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBfX2F0 dHJpYnV0ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7
CgoKCgoKZXh0ZXJuIHNpemVfdCBzdHJubGVuIChjb25zdCBjaGFyICpfX3N0cmluZywgc2l6ZV90 IF9fbWF4bGVuKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkg X19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx
KSkpOwoKCgoKCmV4dGVybiBjaGFyICpzdHJlcnJvciAoaW50IF9fZXJybnVtKSBfX2F0dHJpYnV0 ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKIyA0MzMgIi91c3IvaW5jbHVkZS9zdHJp bmcuaCIgMyA0CmV4dGVybiBjaGFyICpzdHJlcnJvcl9yIChpbnQgX19lcnJudW0sIGNoYXIgKl9f
YnVmLCBzaXplX3QgX19idWZsZW4pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg X19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIpKSkgX19hdHRyaWJ1dGVf XyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCgpleHRlcm4gY2hhciAqc3RyZXJyb3Jf
bCAoaW50IF9fZXJybnVtLCBfX2xvY2FsZV90IF9fbCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv d19fICwgX19sZWFmX18pKTsKCgoKCgpleHRlcm4gdm9pZCBfX2J6ZXJvICh2b2lkICpfX3MsIHNp emVfdCBfX24pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRy
aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgpleHRlcm4gdm9pZCBiY29weSAoY29uc3Qg dm9pZCAqX19zcmMsIHZvaWQgKl9fZGVzdCwgc2l6ZV90IF9fbikKICAgICBfX2F0dHJpYnV0ZV9f ICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo
MSwgMikpKTsKCgpleHRlcm4gdm9pZCBiemVybyAodm9pZCAqX19zLCBzaXplX3QgX19uKSBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25v bm51bGxfXyAoMSkpKTsKCgpleHRlcm4gaW50IGJjbXAgKGNvbnN0IHZvaWQgKl9fczEsIGNvbnN0
IHZvaWQgKl9fczIsIHNpemVfdCBfX24pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19f ICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgo X19ub25udWxsX18gKDEsIDIpKSk7CiMgNDg0ICIvdXNyL2luY2x1ZGUvc3RyaW5nLmgiIDMgNApl
eHRlcm4gY2hhciAqaW5kZXggKGNvbnN0IGNoYXIgKl9fcywgaW50IF9fYykKICAgICBfX2F0dHJp YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVf XykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKIyA1MTIgIi91c3IvaW5jbHVk
ZS9zdHJpbmcuaCIgMyA0CmV4dGVybiBjaGFyICpyaW5kZXggKGNvbnN0IGNoYXIgKl9fcywgaW50 IF9fYykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0 cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsK
CgoKCmV4dGVybiBpbnQgZmZzIChpbnQgX19pKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18g LCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0X18pKTsKCgoKCmV4dGVybiBpbnQg ZmZzbCAobG9uZyBpbnQgX19sKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZf
XykpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0X18pKTsKX19leHRlbnNpb25fXyBleHRlcm4gaW50 IGZmc2xsIChsb25nIGxvbmcgaW50IF9fbGwpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv d19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSk7CgoKCmV4dGVybiBp
bnQgc3RyY2FzZWNtcCAoY29uc3QgY2hhciAqX19zMSwgY29uc3QgY2hhciAqX19zMikKICAgICBf X2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChf X3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4g
aW50IHN0cm5jYXNlY21wIChjb25zdCBjaGFyICpfX3MxLCBjb25zdCBjaGFyICpfX3MyLCBzaXpl X3QgX19uKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19h dHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAy
KSkpOwoKCgoKCmV4dGVybiBpbnQgc3RyY2FzZWNtcF9sIChjb25zdCBjaGFyICpfX3MxLCBjb25z dCBjaGFyICpfX3MyLAogICAgX19sb2NhbGVfdCBfX2xvYykKICAgICBfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0
cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMiwgMykpKTsKCmV4dGVybiBpbnQgc3RybmNhc2Vj bXBfbCAoY29uc3QgY2hhciAqX19zMSwgY29uc3QgY2hhciAqX19zMiwKICAgICBzaXplX3QgX19u LCBfX2xvY2FsZV90IF9fbG9jKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f
bGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u bnVsbF9fICgxLCAyLCA0KSkpOwoKCgoKCmV4dGVybiBjaGFyICpzdHJzZXAgKGNoYXIgKipfX3Jl c3RyaWN0IF9fc3RyaW5ncCwKICAgICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19kZWxpbSkK
ICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRl X18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgoKCmV4dGVybiBjaGFyICpzdHJzaWduYWwgKGlu dCBfX3NpZykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRl
cm4gY2hhciAqX19zdHBjcHkgKGNoYXIgKl9fcmVzdHJpY3QgX19kZXN0LCBjb25zdCBjaGFyICpf X3Jlc3RyaWN0IF9fc3JjKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh Zl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwpleHRlcm4gY2hhciAq
c3RwY3B5IChjaGFyICpfX3Jlc3RyaWN0IF9fZGVzdCwgY29uc3QgY2hhciAqX19yZXN0cmljdCBf X3NyYykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0 cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgoKZXh0ZXJuIGNoYXIgKl9fc3RwbmNw
eSAoY2hhciAqX19yZXN0cmljdCBfX2Rlc3QsCiAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19z cmMsIHNpemVfdCBfX24pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFm X18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CmV4dGVybiBjaGFyICpz
dHBuY3B5IChjaGFyICpfX3Jlc3RyaWN0IF9fZGVzdCwKICAgICAgICBjb25zdCBjaGFyICpfX3Jl c3RyaWN0IF9fc3JjLCBzaXplX3QgX19uKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df XyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCgoK
ZXh0ZXJuIGludCBzdHJ2ZXJzY21wIChjb25zdCBjaGFyICpfX3MxLCBjb25zdCBjaGFyICpfX3My KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1 dGVfXyAoKF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoK
CmV4dGVybiBjaGFyICpzdHJmcnkgKGNoYXIgKl9fc3RyaW5nKSBfX2F0dHJpYnV0ZV9fICgoX19u b3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsK CgpleHRlcm4gdm9pZCAqbWVtZnJvYiAodm9pZCAqX19zLCBzaXplX3QgX19uKSBfX2F0dHJpYnV0
ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxf XyAoMSkpKTsKIyA1OTkgIi91c3IvaW5jbHVkZS9zdHJpbmcuaCIgMyA0CmV4dGVybiBjaGFyICpi YXNlbmFtZSAoY29uc3QgY2hhciAqX19maWxlbmFtZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv
d19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CiMgNjI3 ICIvdXNyL2luY2x1ZGUvc3RyaW5nLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3N0cmlu Zy5oIiAxIDMgNAojIDYyOCAiL3Vzci9pbmNsdWRlL3N0cmluZy5oIiAyIDMgNAoKCiMgMSAiL3Vz
ci9pbmNsdWRlL2JpdHMvc3RyaW5nMi5oIiAxIDMgNAojIDUxICIvdXNyL2luY2x1ZGUvYml0cy9z dHJpbmcyLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9lbmRpYW4uaCIgMSAzIDQKIyAzNiAiL3Vz ci9pbmNsdWRlL2VuZGlhbi5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9lbmRpYW4uaCIg
MSAzIDQKIyAzNyAiL3Vzci9pbmNsdWRlL2VuZGlhbi5oIiAyIDMgNAojIDYwICIvdXNyL2luY2x1 ZGUvZW5kaWFuLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2FwLmgiIDEgMyA0 CiMgMjQgIi91c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2FwLmgiIDMgNAojIDEgIi91c3IvaW5jbHVk
ZS9iaXRzL3dvcmRzaXplLmgiIDEgMyA0CiMgMjUgIi91c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2Fw LmgiIDIgMyA0CiMgMzMgIi91c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2FwLmgiIDMgNAojIDEgIi91 c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2FwLTE2LmgiIDEgMyA0CiMgMjQgIi91c3IvaW5jbHVkZS9i
aXRzL2J5dGVzd2FwLTE2LmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3dvcmRzaXplLmgi IDEgMyA0CiMgMjUgIi91c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2FwLTE2LmgiIDIgMyA0CiMgMzQg Ii91c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2FwLmgiIDIgMyA0CiMgNjEgIi91c3IvaW5jbHVkZS9l
bmRpYW4uaCIgMiAzIDQKIyA1MiAiL3Vzci9pbmNsdWRlL2JpdHMvc3RyaW5nMi5oIiAyIDMgNAoj IDM5MyAiL3Vzci9pbmNsdWRlL2JpdHMvc3RyaW5nMi5oIiAzIDQKZXh0ZXJuIHZvaWQgKl9fcmF3 bWVtY2hyIChjb25zdCB2b2lkICpfX3MsIGludCBfX2MpOwojIDk0NSAiL3Vzci9pbmNsdWRlL2Jp
dHMvc3RyaW5nMi5oIiAzIDQKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9p bmxpbmVfXykpIHNpemVfdCBfX3N0cmNzcG5fYzEgKGNvbnN0IGNoYXIgKl9fcywgaW50IF9fcmVq ZWN0KTsKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIHNp
emVfdApfX3N0cmNzcG5fYzEgKGNvbnN0IGNoYXIgKl9fcywgaW50IF9fcmVqZWN0KQp7CiAgc2l6 ZV90IF9fcmVzdWx0ID0gMDsKICB3aGlsZSAoX19zW19fcmVzdWx0XSAhPSAnXDAnICYmIF9fc1tf X3Jlc3VsdF0gIT0gX19yZWplY3QpCiAgICArK19fcmVzdWx0OwogIHJldHVybiBfX3Jlc3VsdDsK
fQoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIHNpemVf dCBfX3N0cmNzcG5fYzIgKGNvbnN0IGNoYXIgKl9fcywgaW50IF9fcmVqZWN0MSwKICAgICAgICAg aW50IF9fcmVqZWN0Mik7CmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5s
aW5lX18pKSBzaXplX3QKX19zdHJjc3BuX2MyIChjb25zdCBjaGFyICpfX3MsIGludCBfX3JlamVj dDEsIGludCBfX3JlamVjdDIpCnsKICBzaXplX3QgX19yZXN1bHQgPSAwOwogIHdoaWxlIChfX3Nb X19yZXN1bHRdICE9ICdcMCcgJiYgX19zW19fcmVzdWx0XSAhPSBfX3JlamVjdDEKICAmJiBfX3Nb
X19yZXN1bHRdICE9IF9fcmVqZWN0MikKICAgICsrX19yZXN1bHQ7CiAgcmV0dXJuIF9fcmVzdWx0 Owp9CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgc2l6 ZV90IF9fc3RyY3Nwbl9jMyAoY29uc3QgY2hhciAqX19zLCBpbnQgX19yZWplY3QxLAogICAgICAg
ICBpbnQgX19yZWplY3QyLCBpbnQgX19yZWplY3QzKTsKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmli dXRlX18gKChfX2dudV9pbmxpbmVfXykpIHNpemVfdApfX3N0cmNzcG5fYzMgKGNvbnN0IGNoYXIg Kl9fcywgaW50IF9fcmVqZWN0MSwgaW50IF9fcmVqZWN0MiwKICAgICAgIGludCBfX3JlamVjdDMp
CnsKICBzaXplX3QgX19yZXN1bHQgPSAwOwogIHdoaWxlIChfX3NbX19yZXN1bHRdICE9ICdcMCcg JiYgX19zW19fcmVzdWx0XSAhPSBfX3JlamVjdDEKICAmJiBfX3NbX19yZXN1bHRdICE9IF9fcmVq ZWN0MiAmJiBfX3NbX19yZXN1bHRdICE9IF9fcmVqZWN0MykKICAgICsrX19yZXN1bHQ7CiAgcmV0
dXJuIF9fcmVzdWx0Owp9CiMgMTAyMSAiL3Vzci9pbmNsdWRlL2JpdHMvc3RyaW5nMi5oIiAzIDQK ZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIHNpemVfdCBf X3N0cnNwbl9jMSAoY29uc3QgY2hhciAqX19zLCBpbnQgX19hY2NlcHQpOwpleHRlcm4gX19pbmxp
bmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgc2l6ZV90Cl9fc3Ryc3BuX2MxIChj b25zdCBjaGFyICpfX3MsIGludCBfX2FjY2VwdCkKewogIHNpemVfdCBfX3Jlc3VsdCA9IDA7Cgog IHdoaWxlIChfX3NbX19yZXN1bHRdID09IF9fYWNjZXB0KQogICAgKytfX3Jlc3VsdDsKICByZXR1
cm4gX19yZXN1bHQ7Cn0KCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5s aW5lX18pKSBzaXplX3QgX19zdHJzcG5fYzIgKGNvbnN0IGNoYXIgKl9fcywgaW50IF9fYWNjZXB0 MSwKICAgICAgICBpbnQgX19hY2NlcHQyKTsKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18g
KChfX2dudV9pbmxpbmVfXykpIHNpemVfdApfX3N0cnNwbl9jMiAoY29uc3QgY2hhciAqX19zLCBp bnQgX19hY2NlcHQxLCBpbnQgX19hY2NlcHQyKQp7CiAgc2l6ZV90IF9fcmVzdWx0ID0gMDsKCiAg d2hpbGUgKF9fc1tfX3Jlc3VsdF0gPT0gX19hY2NlcHQxIHx8IF9fc1tfX3Jlc3VsdF0gPT0gX19h
Y2NlcHQyKQogICAgKytfX3Jlc3VsdDsKICByZXR1cm4gX19yZXN1bHQ7Cn0KCmV4dGVybiBfX2lu bGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBzaXplX3QgX19zdHJzcG5fYzMg KGNvbnN0IGNoYXIgKl9fcywgaW50IF9fYWNjZXB0MSwKICAgICAgICBpbnQgX19hY2NlcHQyLCBp
bnQgX19hY2NlcHQzKTsKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxp bmVfXykpIHNpemVfdApfX3N0cnNwbl9jMyAoY29uc3QgY2hhciAqX19zLCBpbnQgX19hY2NlcHQx LCBpbnQgX19hY2NlcHQyLCBpbnQgX19hY2NlcHQzKQp7CiAgc2l6ZV90IF9fcmVzdWx0ID0gMDsK
CiAgd2hpbGUgKF9fc1tfX3Jlc3VsdF0gPT0gX19hY2NlcHQxIHx8IF9fc1tfX3Jlc3VsdF0gPT0g X19hY2NlcHQyCiAgfHwgX19zW19fcmVzdWx0XSA9PSBfX2FjY2VwdDMpCiAgICArK19fcmVzdWx0 OwogIHJldHVybiBfX3Jlc3VsdDsKfQojIDEwOTcgIi91c3IvaW5jbHVkZS9iaXRzL3N0cmluZzIu
aCIgMyA0CmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBj aGFyICpfX3N0cnBicmtfYzIgKGNvbnN0IGNoYXIgKl9fcywgaW50IF9fYWNjZXB0MSwKICAgICAg ICBpbnQgX19hY2NlcHQyKTsKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9p
bmxpbmVfXykpIGNoYXIgKgpfX3N0cnBicmtfYzIgKGNvbnN0IGNoYXIgKl9fcywgaW50IF9fYWNj ZXB0MSwgaW50IF9fYWNjZXB0MikKewoKICB3aGlsZSAoKl9fcyAhPSAnXDAnICYmICpfX3MgIT0g X19hY2NlcHQxICYmICpfX3MgIT0gX19hY2NlcHQyKQogICAgKytfX3M7CiAgcmV0dXJuICpfX3Mg
PT0gJ1wwJyA/ICgodm9pZCAqKTApIDogKGNoYXIgKikgKHNpemVfdCkgX19zOwp9CgpleHRlcm4g X19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgY2hhciAqX19zdHJwYnJr X2MzIChjb25zdCBjaGFyICpfX3MsIGludCBfX2FjY2VwdDEsCiAgICAgICAgaW50IF9fYWNjZXB0
MiwgaW50IF9fYWNjZXB0Myk7CmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVf aW5saW5lX18pKSBjaGFyICoKX19zdHJwYnJrX2MzIChjb25zdCBjaGFyICpfX3MsIGludCBfX2Fj Y2VwdDEsIGludCBfX2FjY2VwdDIsIGludCBfX2FjY2VwdDMpCnsKCiAgd2hpbGUgKCpfX3MgIT0g
J1wwJyAmJiAqX19zICE9IF9fYWNjZXB0MSAmJiAqX19zICE9IF9fYWNjZXB0MgogICYmICpfX3Mg IT0gX19hY2NlcHQzKQogICAgKytfX3M7CiAgcmV0dXJuICpfX3MgPT0gJ1wwJyA/ICgodm9pZCAq KTApIDogKGNoYXIgKikgKHNpemVfdCkgX19zOwp9CiMgMTE0NyAiL3Vzci9pbmNsdWRlL2JpdHMv
c3RyaW5nMi5oIiAzIDQKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxp bmVfXykpIGNoYXIgKl9fc3RydG9rX3JfMWMgKGNoYXIgKl9fcywgY2hhciBfX3NlcCwgY2hhciAq Kl9fbmV4dHApOwpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9f
KSkgY2hhciAqCl9fc3RydG9rX3JfMWMgKGNoYXIgKl9fcywgY2hhciBfX3NlcCwgY2hhciAqKl9f bmV4dHApCnsKICBjaGFyICpfX3Jlc3VsdDsKICBpZiAoX19zID09ICgodm9pZCAqKTApKQogICAg X19zID0gKl9fbmV4dHA7CiAgd2hpbGUgKCpfX3MgPT0gX19zZXApCiAgICArK19fczsKICBfX3Jl
c3VsdCA9ICgodm9pZCAqKTApOwogIGlmICgqX19zICE9ICdcMCcpCiAgICB7CiAgICAgIF9fcmVz dWx0ID0gX19zKys7CiAgICAgIHdoaWxlICgqX19zICE9ICdcMCcpCiBpZiAoKl9fcysrID09IF9f c2VwKQogICB7CiAgICAgX19zWy0xXSA9ICdcMCc7CiAgICAgYnJlYWs7CiAgIH0KICAgIH0KICAq
X19uZXh0cCA9IF9fczsKICByZXR1cm4gX19yZXN1bHQ7Cn0KIyAxMTc5ICIvdXNyL2luY2x1ZGUv Yml0cy9zdHJpbmcyLmgiIDMgNApleHRlcm4gY2hhciAqX19zdHJzZXBfZyAoY2hhciAqKl9fc3Ry aW5ncCwgY29uc3QgY2hhciAqX19kZWxpbSk7CiMgMTE5NyAiL3Vzci9pbmNsdWRlL2JpdHMvc3Ry
aW5nMi5oIiAzIDQKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVf XykpIGNoYXIgKl9fc3Ryc2VwXzFjIChjaGFyICoqX19zLCBjaGFyIF9fcmVqZWN0KTsKZXh0ZXJu IF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGNoYXIgKgpfX3N0cnNl
cF8xYyAoY2hhciAqKl9fcywgY2hhciBfX3JlamVjdCkKewogIGNoYXIgKl9fcmV0dmFsID0gKl9f czsKICBpZiAoX19yZXR2YWwgIT0gKCh2b2lkICopMCkgJiYgKCpfX3MgPSAoX19leHRlbnNpb25f XyAoX19idWlsdGluX2NvbnN0YW50X3AgKF9fcmVqZWN0KSAmJiAhX19idWlsdGluX2NvbnN0YW50
X3AgKF9fcmV0dmFsKSAmJiAoX19yZWplY3QpID09ICdcMCcgPyAoY2hhciAqKSBfX3Jhd21lbWNo ciAoX19yZXR2YWwsIF9fcmVqZWN0KSA6IF9fYnVpbHRpbl9zdHJjaHIgKF9fcmV0dmFsLCBfX3Jl amVjdCkpKSkgIT0gKCh2b2lkICopMCkpCiAgICAqKCpfX3MpKysgPSAnXDAnOwogIHJldHVybiBf
X3JldHZhbDsKfQoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVf XykpIGNoYXIgKl9fc3Ryc2VwXzJjIChjaGFyICoqX19zLCBjaGFyIF9fcmVqZWN0MSwgY2hhciBf X3JlamVjdDIpOwpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9f
KSkgY2hhciAqCl9fc3Ryc2VwXzJjIChjaGFyICoqX19zLCBjaGFyIF9fcmVqZWN0MSwgY2hhciBf X3JlamVjdDIpCnsKICBjaGFyICpfX3JldHZhbCA9ICpfX3M7CiAgaWYgKF9fcmV0dmFsICE9ICgo dm9pZCAqKTApKQogICAgewogICAgICBjaGFyICpfX2NwID0gX19yZXR2YWw7CiAgICAgIHdoaWxl
ICgxKQogewogICBpZiAoKl9fY3AgPT0gJ1wwJykKICAgICB7CiAgICAgICBfX2NwID0gKCh2b2lk ICopMCk7CiAgIGJyZWFrOwogICAgIH0KICAgaWYgKCpfX2NwID09IF9fcmVqZWN0MSB8fCAqX19j cCA9PSBfX3JlamVjdDIpCiAgICAgewogICAgICAgKl9fY3ArKyA9ICdcMCc7CiAgICAgICBicmVh
azsKICAgICB9CiAgICsrX19jcDsKIH0KICAgICAgKl9fcyA9IF9fY3A7CiAgICB9CiAgcmV0dXJu IF9fcmV0dmFsOwp9CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGlu ZV9fKSkgY2hhciAqX19zdHJzZXBfM2MgKGNoYXIgKipfX3MsIGNoYXIgX19yZWplY3QxLCBjaGFy
IF9fcmVqZWN0MiwKICAgICAgIGNoYXIgX19yZWplY3QzKTsKZXh0ZXJuIF9faW5saW5lIF9fYXR0 cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGNoYXIgKgpfX3N0cnNlcF8zYyAoY2hhciAqKl9f cywgY2hhciBfX3JlamVjdDEsIGNoYXIgX19yZWplY3QyLCBjaGFyIF9fcmVqZWN0MykKewogIGNo
YXIgKl9fcmV0dmFsID0gKl9fczsKICBpZiAoX19yZXR2YWwgIT0gKCh2b2lkICopMCkpCiAgICB7 CiAgICAgIGNoYXIgKl9fY3AgPSBfX3JldHZhbDsKICAgICAgd2hpbGUgKDEpCiB7CiAgIGlmICgq X19jcCA9PSAnXDAnKQogICAgIHsKICAgICAgIF9fY3AgPSAoKHZvaWQgKikwKTsKICAgYnJlYWs7
CiAgICAgfQogICBpZiAoKl9fY3AgPT0gX19yZWplY3QxIHx8ICpfX2NwID09IF9fcmVqZWN0MiB8 fCAqX19jcCA9PSBfX3JlamVjdDMpCiAgICAgewogICAgICAgKl9fY3ArKyA9ICdcMCc7CiAgICAg ICBicmVhazsKICAgICB9CiAgICsrX19jcDsKIH0KICAgICAgKl9fcyA9IF9fY3A7CiAgICB9CiAg
cmV0dXJuIF9fcmV0dmFsOwp9CiMgMTI3MyAiL3Vzci9pbmNsdWRlL2JpdHMvc3RyaW5nMi5oIiAz IDQKIyAxICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDEgMyA0CiMgMzIgIi91c3IvaW5jbHVkZS9z dGRsaWIuaCIgMyA0CiMgMSAiL3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51eC82LjAuMC9p
bmNsdWRlL3N0ZGRlZi5oIiAxIDMgNAojIDMzICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDIgMyA0 CgoKIyA0NjQgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMyA0CgoKZXh0ZXJuIHZvaWQgKm1hbGxv YyAoc2l6ZV90IF9fc2l6ZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18p
KSBfX2F0dHJpYnV0ZV9fICgoX19tYWxsb2NfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51 c2VkX3Jlc3VsdF9fKSk7CgpleHRlcm4gdm9pZCAqY2FsbG9jIChzaXplX3QgX19ubWVtYiwgc2l6 ZV90IF9fc2l6ZSkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykp
IF9fYXR0cmlidXRlX18gKChfX21hbGxvY19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVz ZWRfcmVzdWx0X18pKTsKCiMgOTY3ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDMgNAoKIyAxMjc0 ICIvdXNyL2luY2x1ZGUvYml0cy9zdHJpbmcyLmgiIDIgMyA0CgoKCgpleHRlcm4gY2hhciAqX19z
dHJkdXAgKGNvbnN0IGNoYXIgKl9fc3RyaW5nKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18g LCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX21hbGxvY19fKSk7CiMgMTI5NyAiL3Vzci9p bmNsdWRlL2JpdHMvc3RyaW5nMi5oIiAzIDQKZXh0ZXJuIGNoYXIgKl9fc3RybmR1cCAoY29uc3Qg
Y2hhciAqX19zdHJpbmcsIHNpemVfdCBfX24pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv d19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19tYWxsb2NfXykpOwojIDYzMSAiL3Vz ci9pbmNsdWRlL3N0cmluZy5oIiAyIDMgNAoKCgoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9zdHJp
bmczLmgiIDEgMyA0CiMgNDkgIi91c3IvaW5jbHVkZS9iaXRzL3N0cmluZzMuaCIgMyA0CmV4dGVy biBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0 ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSB2
b2lkICoKX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBtZW1jcHkgKHZv aWQgKl9fcmVzdHJpY3QgX19kZXN0LCBjb25zdCB2b2lkICpfX3Jlc3RyaWN0IF9fc3JjLCBzaXpl X3QgX19sZW4pCgp7CiAgcmV0dXJuIF9fYnVpbHRpbl9fX21lbWNweV9jaGsgKF9fZGVzdCwgX19z
cmMsIF9fbGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fZGVzdCwgMCkpOwp9CgpleHRlcm4g X19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVf XyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgdm9p
ZCAqCl9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgbWVtbW92ZSAodm9p ZCAqX19kZXN0LCBjb25zdCB2b2lkICpfX3NyYywgc2l6ZV90IF9fbGVuKQp7CiAgcmV0dXJuIF9f YnVpbHRpbl9fX21lbW1vdmVfY2hrIChfX2Rlc3QsIF9fc3JjLCBfX2xlbiwgX19idWlsdGluX29i
amVjdF9zaXplIChfX2Rlc3QsIDApKTsKfQoKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9f ICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBf X2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSB2b2lkICoKX19hdHRyaWJ1dGVfXyAoKF9f
bm90aHJvd19fICwgX19sZWFmX18pKSBtZW1wY3B5ICh2b2lkICpfX3Jlc3RyaWN0IF9fZGVzdCwg Y29uc3Qgdm9pZCAqX19yZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbGVuKQoKewogIHJldHVybiBf X2J1aWx0aW5fX19tZW1wY3B5X2NoayAoX19kZXN0LCBfX3NyYywgX19sZW4sIF9fYnVpbHRpbl9v
YmplY3Rfc2l6ZSAoX19kZXN0LCAwKSk7Cn0KIyA3NyAiL3Vzci9pbmNsdWRlL2JpdHMvc3RyaW5n My5oIiAzIDQKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVf XykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2Fy
dGlmaWNpYWxfXykpIHZvaWQgKgpfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZf XykpIG1lbXNldCAodm9pZCAqX19kZXN0LCBpbnQgX19jaCwgc2l6ZV90IF9fbGVuKQp7CiMgOTAg Ii91c3IvaW5jbHVkZS9iaXRzL3N0cmluZzMuaCIgMyA0CiAgcmV0dXJuIF9fYnVpbHRpbl9fX21l
bXNldF9jaGsgKF9fZGVzdCwgX19jaCwgX19sZW4sIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19k ZXN0LCAwKSk7Cn0KCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lu bGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAo
KF9fYXJ0aWZpY2lhbF9fKSkgdm9pZApfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl YWZfXykpIGJjb3B5IChjb25zdCB2b2lkICpfX3NyYywgdm9pZCAqX19kZXN0LCBzaXplX3QgX19s ZW4pCnsKICAodm9pZCkgX19idWlsdGluX19fbWVtbW92ZV9jaGsgKF9fZGVzdCwgX19zcmMsIF9f
bGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fZGVzdCwgMCkpOwp9CgpleHRlcm4gX19pbmxp bmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgdm9pZApfX2F0
dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIGJ6ZXJvICh2b2lkICpfX2Rlc3Qs IHNpemVfdCBfX2xlbikKewogICh2b2lkKSBfX2J1aWx0aW5fX19tZW1zZXRfY2hrIChfX2Rlc3Qs ICdcMCcsIF9fbGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fZGVzdCwgMCkpOwp9CgoKZXh0
ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmli dXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykp IGNoYXIgKgpfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpIHN0cmNweSAo
Y2hhciAqX19yZXN0cmljdCBfX2Rlc3QsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zcmMpCnsK ICByZXR1cm4gX19idWlsdGluX19fc3RyY3B5X2NoayAoX19kZXN0LCBfX3NyYywgX19idWlsdGlu X29iamVjdF9zaXplIChfX2Rlc3QsIDIgPiAxKSk7Cn0KCgpleHRlcm4gX19pbmxpbmUgX19hdHRy
aWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGlu ZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgY2hhciAqCl9fYXR0cmlidXRl X18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgc3RwY3B5IChjaGFyICpfX3Jlc3RyaWN0IF9f
ZGVzdCwgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3NyYykKewogIHJldHVybiBfX2J1aWx0aW5f X19zdHBjcHlfY2hrIChfX2Rlc3QsIF9fc3JjLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fZGVz dCwgMiA+IDEpKTsKfQoKCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlz
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf XyAoKF9fYXJ0aWZpY2lhbF9fKSkgY2hhciAqCl9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs IF9fbGVhZl9fKSkgc3RybmNweSAoY2hhciAqX19yZXN0cmljdCBfX2Rlc3QsIGNvbnN0IGNoYXIg
Kl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX2xlbikKCnsKICByZXR1cm4gX19idWlsdGluX19f c3RybmNweV9jaGsgKF9fZGVzdCwgX19zcmMsIF9fbGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUg KF9fZGVzdCwgMiA+IDEpKTsKfQoKCmV4dGVybiBjaGFyICpfX3N0cG5jcHlfY2hrIChjaGFyICpf
X2Rlc3QsIGNvbnN0IGNoYXIgKl9fc3JjLCBzaXplX3QgX19uLAogICAgICAgc2l6ZV90IF9fZGVz dGxlbikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKZXh0ZXJuIGNo YXIgKl9fc3RwbmNweV9hbGlhcyAoY2hhciAqX19kZXN0LCBjb25zdCBjaGFyICpfX3NyYywgc2l6
ZV90IF9fbikgX19hc21fXyAoIiIgInN0cG5jcHkiKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93 X18gLCBfX2xlYWZfXykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKCmV4dGVy biBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBj aGFyICoKX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKSBzdHBuY3B5IChj aGFyICpfX2Rlc3QsIGNvbnN0IGNoYXIgKl9fc3JjLCBzaXplX3QgX19uKQp7CiAgaWYgKF9fYnVp
bHRpbl9vYmplY3Rfc2l6ZSAoX19kZXN0LCAyID4gMSkgIT0gKHNpemVfdCkgLTEKICAgICAgJiYg KCFfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19uKSB8fCBfX24gPiBfX2J1aWx0aW5fb2JqZWN0X3Np emUgKF9fZGVzdCwgMiA+IDEpKSkKICAgIHJldHVybiBfX3N0cG5jcHlfY2hrIChfX2Rlc3QsIF9f
c3JjLCBfX24sIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kZXN0LCAyID4gMSkpOwogIHJldHVy biBfX3N0cG5jcHlfYWxpYXMgKF9fZGVzdCwgX19zcmMsIF9fbik7Cn0KCgpleHRlcm4gX19pbmxp bmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgY2hhciAqCl9f YXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgc3RyY2F0IChjaGFyICpfX3Jl c3RyaWN0IF9fZGVzdCwgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3NyYykKewogIHJldHVybiBf
X2J1aWx0aW5fX19zdHJjYXRfY2hrIChfX2Rlc3QsIF9fc3JjLCBfX2J1aWx0aW5fb2JqZWN0X3Np emUgKF9fZGVzdCwgMiA+IDEpKTsKfQoKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgo X19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBjaGFyICoKX19hdHRyaWJ1dGVfXyAoKF9fbm90 aHJvd19fICwgX19sZWFmX18pKSBzdHJuY2F0IChjaGFyICpfX3Jlc3RyaWN0IF9fZGVzdCwgY29u c3QgY2hhciAqX19yZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbGVuKQoKewogIHJldHVybiBfX2J1
aWx0aW5fX19zdHJuY2F0X2NoayAoX19kZXN0LCBfX3NyYywgX19sZW4sIF9fYnVpbHRpbl9vYmpl Y3Rfc2l6ZSAoX19kZXN0LCAyID4gMSkpOwp9CiMgNjM2ICIvdXNyL2luY2x1ZGUvc3RyaW5nLmgi IDIgMyA0CiMgNjQ4ICIvdXNyL2luY2x1ZGUvc3RyaW5nLmgiIDMgNApleHRlcm4gX19pbmxpbmUg
X19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251 X2lubGluZV9fKSkgdm9pZCAqCl9fbWVtcGNweV9pbmxpbmUgKHZvaWQgKl9fcmVzdHJpY3QgX19k ZXN0LAogICAgY29uc3Qgdm9pZCAqX19yZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbikKewogIHJl
dHVybiAoY2hhciAqKSBtZW1jcHkgKF9fZGVzdCwgX19zcmMsIF9fbikgKyBfX247Cn0KCgoKCgoj IDI5ICJuZXRsaW5rLmMiIDIKIyAxICIvdXNyL2luY2x1ZGUvZXJybm8uaCIgMSAzIDQKIyAzMSAi L3Vzci9pbmNsdWRlL2Vycm5vLmgiIDMgNAoKCgoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9lcnJu
by5oIiAxIDMgNAojIDI0ICIvdXNyL2luY2x1ZGUvYml0cy9lcnJuby5oIiAzIDQKIyAxICIvdXNy L2luY2x1ZGUvbGludXgvZXJybm8uaCIgMSAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYXNtL2Vycm5v LmgiIDEgMyA0CiMgOSAiL3Vzci9pbmNsdWRlL2FzbS9lcnJuby5oIiAzIDQKIyAxICIvdXNyL2lu
Y2x1ZGUvYXNtLWdlbmVyaWMvZXJybm8uaCIgMSAzIDQKCgoKIyAxICIvdXNyL2luY2x1ZGUvYXNt LWdlbmVyaWMvZXJybm8tYmFzZS5oIiAxIDMgNAojIDUgIi91c3IvaW5jbHVkZS9hc20tZ2VuZXJp Yy9lcnJuby5oIiAyIDMgNAojIDEwICIvdXNyL2luY2x1ZGUvYXNtL2Vycm5vLmgiIDIgMyA0CiMg
MSAiL3Vzci9pbmNsdWRlL2xpbnV4L2Vycm5vLmgiIDIgMyA0CiMgMjUgIi91c3IvaW5jbHVkZS9i aXRzL2Vycm5vLmgiIDIgMyA0CiMgNTAgIi91c3IvaW5jbHVkZS9iaXRzL2Vycm5vLmgiIDMgNApl eHRlcm4gaW50ICpfX2Vycm5vX2xvY2F0aW9uICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Ro
cm93X18gLCBfX2xlYWZfXykpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0X18pKTsKIyAzNiAiL3Vz ci9pbmNsdWRlL2Vycm5vLmgiIDIgMyA0CiMgNTQgIi91c3IvaW5jbHVkZS9lcnJuby5oIiAzIDQK ZXh0ZXJuIGNoYXIgKnByb2dyYW1faW52b2NhdGlvbl9uYW1lLCAqcHJvZ3JhbV9pbnZvY2F0aW9u
X3Nob3J0X25hbWU7CgoKCgojIDY4ICIvdXNyL2luY2x1ZGUvZXJybm8uaCIgMyA0CnR5cGVkZWYg aW50IGVycm9yX3Q7CiMgMzAgIm5ldGxpbmsuYyIgMgojIDEgIi91c3IvaW5jbHVkZS9mY250bC5o IiAxIDMgNAojIDI4ICIvdXNyL2luY2x1ZGUvZmNudGwuaCIgMyA0CgoKCgoKCgojIDEgIi91c3Iv
aW5jbHVkZS9iaXRzL2ZjbnRsLmgiIDEgMyA0CiMgMjMgIi91c3IvaW5jbHVkZS9iaXRzL2ZjbnRs LmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3dvcmRzaXplLmgiIDEgMyA0CiMgMjQgIi91 c3IvaW5jbHVkZS9iaXRzL2ZjbnRsLmgiIDIgMyA0CiMgMzcgIi91c3IvaW5jbHVkZS9iaXRzL2Zj
bnRsLmgiIDMgNApzdHJ1Y3QgZmxvY2sKICB7CiAgICBzaG9ydCBpbnQgbF90eXBlOwogICAgc2hv cnQgaW50IGxfd2hlbmNlOwoKICAgIF9fb2ZmX3QgbF9zdGFydDsKICAgIF9fb2ZmX3QgbF9sZW47 CgoKCgogICAgX19waWRfdCBsX3BpZDsKICB9OwoKCnN0cnVjdCBmbG9jazY0CiAgewogICAgc2hv
cnQgaW50IGxfdHlwZTsKICAgIHNob3J0IGludCBsX3doZW5jZTsKICAgIF9fb2ZmNjRfdCBsX3N0 YXJ0OwogICAgX19vZmY2NF90IGxfbGVuOwogICAgX19waWRfdCBsX3BpZDsKICB9OwojIDcxICIv dXNyL2luY2x1ZGUvYml0cy9mY250bC5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9mY250
bC1saW51eC5oIiAxIDMgNAojIDM4ICIvdXNyL2luY2x1ZGUvYml0cy9mY250bC1saW51eC5oIiAz IDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy91aW8uaCIgMSAzIDQKIyAyNSAiL3Vzci9pbmNsdWRl L2JpdHMvdWlvLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9zeXMvdHlwZXMuaCIgMSAzIDQKIyAy
NyAiL3Vzci9pbmNsdWRlL3N5cy90eXBlcy5oIiAzIDQKCgoKCgoKdHlwZWRlZiBfX3VfY2hhciB1 X2NoYXI7CnR5cGVkZWYgX191X3Nob3J0IHVfc2hvcnQ7CnR5cGVkZWYgX191X2ludCB1X2ludDsK dHlwZWRlZiBfX3VfbG9uZyB1X2xvbmc7CnR5cGVkZWYgX19xdWFkX3QgcXVhZF90Owp0eXBlZGVm
IF9fdV9xdWFkX3QgdV9xdWFkX3Q7CnR5cGVkZWYgX19mc2lkX3QgZnNpZF90OwoKCgoKdHlwZWRl ZiBfX2xvZmZfdCBsb2ZmX3Q7CgoKCnR5cGVkZWYgX19pbm9fdCBpbm9fdDsKCgoKCgoKdHlwZWRl ZiBfX2lubzY0X3QgaW5vNjRfdDsKCgoKCnR5cGVkZWYgX19kZXZfdCBkZXZfdDsKIyA3MCAiL3Vz
ci9pbmNsdWRlL3N5cy90eXBlcy5oIiAzIDQKdHlwZWRlZiBfX21vZGVfdCBtb2RlX3Q7CgoKCgp0 eXBlZGVmIF9fbmxpbmtfdCBubGlua190OwojIDEwNCAiL3Vzci9pbmNsdWRlL3N5cy90eXBlcy5o IiAzIDQKdHlwZWRlZiBfX2lkX3QgaWRfdDsKIyAxMTUgIi91c3IvaW5jbHVkZS9zeXMvdHlwZXMu
aCIgMyA0CnR5cGVkZWYgX19kYWRkcl90IGRhZGRyX3Q7CnR5cGVkZWYgX19jYWRkcl90IGNhZGRy X3Q7CgoKCgoKdHlwZWRlZiBfX2tleV90IGtleV90OwojIDEzMiAiL3Vzci9pbmNsdWRlL3N5cy90 eXBlcy5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvdGltZS5oIiAxIDMgNAojIDU3ICIvdXNyL2lu
Y2x1ZGUvdGltZS5oIiAzIDQKCgp0eXBlZGVmIF9fY2xvY2tfdCBjbG9ja190OwoKCgojIDczICIv dXNyL2luY2x1ZGUvdGltZS5oIiAzIDQKCgp0eXBlZGVmIF9fdGltZV90IHRpbWVfdDsKCgoKIyA5 MSAiL3Vzci9pbmNsdWRlL3RpbWUuaCIgMyA0CnR5cGVkZWYgX19jbG9ja2lkX3QgY2xvY2tpZF90
OwojIDEwMyAiL3Vzci9pbmNsdWRlL3RpbWUuaCIgMyA0CnR5cGVkZWYgX190aW1lcl90IHRpbWVy X3Q7CiMgMTMzICIvdXNyL2luY2x1ZGUvc3lzL3R5cGVzLmgiIDIgMyA0CgoKCgoKCgp0eXBlZGVm IF9fc3VzZWNvbmRzX3Qgc3VzZWNvbmRzX3Q7CgoKCgoKIyAxICIvdXNyL2xpYi9nY2MvczM5MHgt
cmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDEgMyA0CiMgMTQ3ICIvdXNyL2lu Y2x1ZGUvc3lzL3R5cGVzLmgiIDIgMyA0CgoKCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQgdWxv bmc7CnR5cGVkZWYgdW5zaWduZWQgc2hvcnQgaW50IHVzaG9ydDsKdHlwZWRlZiB1bnNpZ25lZCBp
bnQgdWludDsKIyAxOTQgIi91c3IvaW5jbHVkZS9zeXMvdHlwZXMuaCIgMyA0CnR5cGVkZWYgaW50 IGludDhfdCBfX2F0dHJpYnV0ZV9fICgoX19tb2RlX18gKF9fUUlfXykpKTsKdHlwZWRlZiBpbnQg aW50MTZfdCBfX2F0dHJpYnV0ZV9fICgoX19tb2RlX18gKF9fSElfXykpKTsKdHlwZWRlZiBpbnQg
aW50MzJfdCBfX2F0dHJpYnV0ZV9fICgoX19tb2RlX18gKF9fU0lfXykpKTsKdHlwZWRlZiBpbnQg aW50NjRfdCBfX2F0dHJpYnV0ZV9fICgoX19tb2RlX18gKF9fRElfXykpKTsKCgp0eXBlZGVmIHVu c2lnbmVkIGludCB1X2ludDhfdCBfX2F0dHJpYnV0ZV9fICgoX19tb2RlX18gKF9fUUlfXykpKTsK
dHlwZWRlZiB1bnNpZ25lZCBpbnQgdV9pbnQxNl90IF9fYXR0cmlidXRlX18gKChfX21vZGVfXyAo X19ISV9fKSkpOwp0eXBlZGVmIHVuc2lnbmVkIGludCB1X2ludDMyX3QgX19hdHRyaWJ1dGVfXyAo KF9fbW9kZV9fIChfX1NJX18pKSk7CnR5cGVkZWYgdW5zaWduZWQgaW50IHVfaW50NjRfdCBfX2F0
dHJpYnV0ZV9fICgoX19tb2RlX18gKF9fRElfXykpKTsKCnR5cGVkZWYgaW50IHJlZ2lzdGVyX3Qg X19hdHRyaWJ1dGVfXyAoKF9fbW9kZV9fIChfX3dvcmRfXykpKTsKIyAyMTkgIi91c3IvaW5jbHVk ZS9zeXMvdHlwZXMuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL3N5cy9zZWxlY3QuaCIgMSAzIDQK
IyAzMCAiL3Vzci9pbmNsdWRlL3N5cy9zZWxlY3QuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2Jp dHMvc2VsZWN0LmgiIDEgMyA0CiMgMzEgIi91c3IvaW5jbHVkZS9zeXMvc2VsZWN0LmgiIDIgMyA0 CgoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9zaWdzZXQuaCIgMSAzIDQKIyAyMiAiL3Vzci9pbmNs
dWRlL2JpdHMvc2lnc2V0LmgiIDMgNAp0eXBlZGVmIGludCBfX3NpZ19hdG9taWNfdDsKCgoKCnR5 cGVkZWYgc3RydWN0CiAgewogICAgdW5zaWduZWQgbG9uZyBpbnQgX192YWxbKDEwMjQgLyAoOCAq IHNpemVvZiAodW5zaWduZWQgbG9uZyBpbnQpKSldOwogIH0gX19zaWdzZXRfdDsKIyAzNCAiL3Vz
ci9pbmNsdWRlL3N5cy9zZWxlY3QuaCIgMiAzIDQKCgoKdHlwZWRlZiBfX3NpZ3NldF90IHNpZ3Nl dF90OwoKCgoKCiMgMSAiL3Vzci9pbmNsdWRlL3RpbWUuaCIgMSAzIDQKIyAxMjAgIi91c3IvaW5j bHVkZS90aW1lLmgiIDMgNApzdHJ1Y3QgdGltZXNwZWMKICB7CiAgICBfX3RpbWVfdCB0dl9zZWM7
CiAgICBfX3N5c2NhbGxfc2xvbmdfdCB0dl9uc2VjOwogIH07CiMgNDQgIi91c3IvaW5jbHVkZS9z eXMvc2VsZWN0LmgiIDIgMyA0CgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3RpbWUuaCIgMSAzIDQK IyAzMCAiL3Vzci9pbmNsdWRlL2JpdHMvdGltZS5oIiAzIDQKc3RydWN0IHRpbWV2YWwKICB7CiAg
ICBfX3RpbWVfdCB0dl9zZWM7CiAgICBfX3N1c2Vjb25kc190IHR2X3VzZWM7CiAgfTsKIyA0NiAi L3Vzci9pbmNsdWRlL3N5cy9zZWxlY3QuaCIgMiAzIDQKIyA1NCAiL3Vzci9pbmNsdWRlL3N5cy9z ZWxlY3QuaCIgMyA0CnR5cGVkZWYgbG9uZyBpbnQgX19mZF9tYXNrOwojIDY0ICIvdXNyL2luY2x1
ZGUvc3lzL3NlbGVjdC5oIiAzIDQKdHlwZWRlZiBzdHJ1Y3QKICB7CgoKCiAgICBfX2ZkX21hc2sg ZmRzX2JpdHNbMTAyNCAvICg4ICogKGludCkgc2l6ZW9mIChfX2ZkX21hc2spKV07CgoKCgoKICB9 IGZkX3NldDsKCgoKCgoKdHlwZWRlZiBfX2ZkX21hc2sgZmRfbWFzazsKIyA5NiAiL3Vzci9pbmNs
dWRlL3N5cy9zZWxlY3QuaCIgMyA0CgojIDEwNiAiL3Vzci9pbmNsdWRlL3N5cy9zZWxlY3QuaCIg MyA0CmV4dGVybiBpbnQgc2VsZWN0IChpbnQgX19uZmRzLCBmZF9zZXQgKl9fcmVzdHJpY3QgX19y ZWFkZmRzLAogICAgIGZkX3NldCAqX19yZXN0cmljdCBfX3dyaXRlZmRzLAogICAgIGZkX3NldCAq
X19yZXN0cmljdCBfX2V4Y2VwdGZkcywKICAgICBzdHJ1Y3QgdGltZXZhbCAqX19yZXN0cmljdCBf X3RpbWVvdXQpOwojIDExOCAiL3Vzci9pbmNsdWRlL3N5cy9zZWxlY3QuaCIgMyA0CmV4dGVybiBp bnQgcHNlbGVjdCAoaW50IF9fbmZkcywgZmRfc2V0ICpfX3Jlc3RyaWN0IF9fcmVhZGZkcywKICAg
ICAgZmRfc2V0ICpfX3Jlc3RyaWN0IF9fd3JpdGVmZHMsCiAgICAgIGZkX3NldCAqX19yZXN0cmlj dCBfX2V4Y2VwdGZkcywKICAgICAgY29uc3Qgc3RydWN0IHRpbWVzcGVjICpfX3Jlc3RyaWN0IF9f dGltZW91dCwKICAgICAgY29uc3QgX19zaWdzZXRfdCAqX19yZXN0cmljdCBfX3NpZ21hc2spOwoK
CgoKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvc2VsZWN0Mi5oIiAxIDMgNAojIDI0ICIvdXNyL2lu Y2x1ZGUvYml0cy9zZWxlY3QyLmgiIDMgNApleHRlcm4gbG9uZyBpbnQgX19mZGVsdF9jaGsgKGxv bmcgaW50IF9fZCk7CmV4dGVybiBsb25nIGludCBfX2ZkZWx0X3dhcm4gKGxvbmcgaW50IF9fZCkK
ICBfX2F0dHJpYnV0ZV9fKChfX3dhcm5pbmdfXyAoImJpdCBvdXRzaWRlIG9mIGZkX3NldCBzZWxl Y3RlZCIpKSk7CiMgMTI5ICIvdXNyL2luY2x1ZGUvc3lzL3NlbGVjdC5oIiAyIDMgNAoKCgojIDIy MCAiL3Vzci9pbmNsdWRlL3N5cy90eXBlcy5oIiAyIDMgNAoKCiMgMSAiL3Vzci9pbmNsdWRlL3N5
cy9zeXNtYWNyb3MuaCIgMSAzIDQKIyAyNCAiL3Vzci9pbmNsdWRlL3N5cy9zeXNtYWNyb3MuaCIg MyA0CgoKX19leHRlbnNpb25fXwpleHRlcm4gdW5zaWduZWQgaW50IGdudV9kZXZfbWFqb3IgKHVu c2lnbmVkIGxvbmcgbG9uZyBpbnQgX19kZXYpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv
d19fICwgX19sZWFmX18pKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSk7Cl9fZXh0ZW5zaW9u X18KZXh0ZXJuIHVuc2lnbmVkIGludCBnbnVfZGV2X21pbm9yICh1bnNpZ25lZCBsb25nIGxvbmcg aW50IF9fZGV2KQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkg
X19hdHRyaWJ1dGVfXyAoKF9fY29uc3RfXykpOwpfX2V4dGVuc2lvbl9fCmV4dGVybiB1bnNpZ25l ZCBsb25nIGxvbmcgaW50IGdudV9kZXZfbWFrZWRldiAodW5zaWduZWQgaW50IF9fbWFqb3IsCiAg ICAgICAgICAgIHVuc2lnbmVkIGludCBfX21pbm9yKQogICAgIF9fYXR0cmlidXRlX18gKChfX25v
dGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fY29uc3RfXykpOwoKCl9fZXh0 ZW5zaW9uX18gZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykp IF9fYXR0cmlidXRlX18gKChfX2NvbnN0X18pKSB1bnNpZ25lZCBpbnQKX19hdHRyaWJ1dGVfXyAo
KF9fbm90aHJvd19fICwgX19sZWFmX18pKSBnbnVfZGV2X21ham9yICh1bnNpZ25lZCBsb25nIGxv bmcgaW50IF9fZGV2KQp7CiAgcmV0dXJuICgoX19kZXYgPj4gOCkgJiAweGZmZikgfCAoKHVuc2ln bmVkIGludCkgKF9fZGV2ID4+IDMyKSAmIH4weGZmZik7Cn0KCl9fZXh0ZW5zaW9uX18gZXh0ZXJu
IF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18g KChfX2NvbnN0X18pKSB1bnNpZ25lZCBpbnQKX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg X19sZWFmX18pKSBnbnVfZGV2X21pbm9yICh1bnNpZ25lZCBsb25nIGxvbmcgaW50IF9fZGV2KQp7
CiAgcmV0dXJuIChfX2RldiAmIDB4ZmYpIHwgKCh1bnNpZ25lZCBpbnQpIChfX2RldiA+PiAxMikg JiB+MHhmZik7Cn0KCl9fZXh0ZW5zaW9uX18gZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18g KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0X18pKSB1bnNpZ25lZCBs
b25nIGxvbmcgaW50Cl9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgZ251 X2Rldl9tYWtlZGV2ICh1bnNpZ25lZCBpbnQgX19tYWpvciwgdW5zaWduZWQgaW50IF9fbWlub3Ip CnsKICByZXR1cm4gKChfX21pbm9yICYgMHhmZikgfCAoKF9fbWFqb3IgJiAweGZmZikgPDwgOCkK
ICAgfCAoKCh1bnNpZ25lZCBsb25nIGxvbmcgaW50KSAoX19taW5vciAmIH4weGZmKSkgPDwgMTIp CiAgIHwgKCgodW5zaWduZWQgbG9uZyBsb25nIGludCkgKF9fbWFqb3IgJiB+MHhmZmYpKSA8PCAz MikpOwp9CgoKIyAyMjMgIi91c3IvaW5jbHVkZS9zeXMvdHlwZXMuaCIgMiAzIDQKCgoKCgp0eXBl
ZGVmIF9fYmxrc2l6ZV90IGJsa3NpemVfdDsKCgoKCgoKdHlwZWRlZiBfX2Jsa2NudF90IGJsa2Nu dF90OwoKCgp0eXBlZGVmIF9fZnNibGtjbnRfdCBmc2Jsa2NudF90OwoKCgp0eXBlZGVmIF9fZnNm aWxjbnRfdCBmc2ZpbGNudF90OwojIDI2MiAiL3Vzci9pbmNsdWRlL3N5cy90eXBlcy5oIiAzIDQK
dHlwZWRlZiBfX2Jsa2NudDY0X3QgYmxrY250NjRfdDsKdHlwZWRlZiBfX2ZzYmxrY250NjRfdCBm c2Jsa2NudDY0X3Q7CnR5cGVkZWYgX19mc2ZpbGNudDY0X3QgZnNmaWxjbnQ2NF90OwoKCgoKCiMg MSAiL3Vzci9pbmNsdWRlL2JpdHMvcHRocmVhZHR5cGVzLmgiIDEgMyA0CiMgMjEgIi91c3IvaW5j
bHVkZS9iaXRzL3B0aHJlYWR0eXBlcy5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy93b3Jk c2l6ZS5oIiAxIDMgNAojIDIyICIvdXNyL2luY2x1ZGUvYml0cy9wdGhyZWFkdHlwZXMuaCIgMiAz IDQKIyA0OCAiL3Vzci9pbmNsdWRlL2JpdHMvcHRocmVhZHR5cGVzLmgiIDMgNAp0eXBlZGVmIHVu
c2lnbmVkIGxvbmcgaW50IHB0aHJlYWRfdDsKCgp1bmlvbiBwdGhyZWFkX2F0dHJfdAp7CiAgY2hh ciBfX3NpemVbNTZdOwogIGxvbmcgaW50IF9fYWxpZ247Cn07Cgp0eXBlZGVmIHVuaW9uIHB0aHJl YWRfYXR0cl90IHB0aHJlYWRfYXR0cl90OwoKCgoKCnR5cGVkZWYgc3RydWN0IF9fcHRocmVhZF9p
bnRlcm5hbF9saXN0CnsKICBzdHJ1Y3QgX19wdGhyZWFkX2ludGVybmFsX2xpc3QgKl9fcHJldjsK ICBzdHJ1Y3QgX19wdGhyZWFkX2ludGVybmFsX2xpc3QgKl9fbmV4dDsKfSBfX3B0aHJlYWRfbGlz dF90OwojIDc4ICIvdXNyL2luY2x1ZGUvYml0cy9wdGhyZWFkdHlwZXMuaCIgMyA0CnR5cGVkZWYg
dW5pb24KewogIHN0cnVjdCBfX3B0aHJlYWRfbXV0ZXhfcwogIHsKICAgIGludCBfX2xvY2s7CiAg ICB1bnNpZ25lZCBpbnQgX19jb3VudDsKICAgIGludCBfX293bmVyOwoKICAgIHVuc2lnbmVkIGlu dCBfX251c2VyczsKCgoKICAgIGludCBfX2tpbmQ7CgoKCgoKCgogICAgaW50IF9fc3BpbnM7CgoK
CiAgICBfX3B0aHJlYWRfbGlzdF90IF9fbGlzdDsKIyAxMjYgIi91c3IvaW5jbHVkZS9iaXRzL3B0 aHJlYWR0eXBlcy5oIiAzIDQKICB9IF9fZGF0YTsKICBjaGFyIF9fc2l6ZVs0MF07CiAgbG9uZyBp bnQgX19hbGlnbjsKfSBwdGhyZWFkX211dGV4X3Q7CgoKdHlwZWRlZiB1bmlvbgp7CiAgY2hhciBf
X3NpemVbNF07CiAgaW50IF9fYWxpZ247Cn0gcHRocmVhZF9tdXRleGF0dHJfdDsKCgoKCnR5cGVk ZWYgdW5pb24KewogIHN0cnVjdAogIHsKICAgIGludCBfX2xvY2s7CiAgICB1bnNpZ25lZCBpbnQg X19mdXRleDsKICAgIF9fZXh0ZW5zaW9uX18gdW5zaWduZWQgbG9uZyBsb25nIGludCBfX3RvdGFs
X3NlcTsKICAgIF9fZXh0ZW5zaW9uX18gdW5zaWduZWQgbG9uZyBsb25nIGludCBfX3dha2V1cF9z ZXE7CiAgICBfX2V4dGVuc2lvbl9fIHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgX193b2tlbl9zZXE7 CiAgICB2b2lkICpfX211dGV4OwogICAgdW5zaWduZWQgaW50IF9fbndhaXRlcnM7CiAgICB1bnNp
Z25lZCBpbnQgX19icm9hZGNhc3Rfc2VxOwogIH0gX19kYXRhOwogIGNoYXIgX19zaXplWzQ4XTsK ICBfX2V4dGVuc2lvbl9fIGxvbmcgbG9uZyBpbnQgX19hbGlnbjsKfSBwdGhyZWFkX2NvbmRfdDsK CnR5cGVkZWYgdW5pb24KewogIGNoYXIgX19zaXplWzRdOwogIGludCBfX2FsaWduOwp9IHB0aHJl
YWRfY29uZGF0dHJfdDsKCgoKdHlwZWRlZiB1bnNpZ25lZCBpbnQgcHRocmVhZF9rZXlfdDsKCgoK dHlwZWRlZiBpbnQgcHRocmVhZF9vbmNlX3Q7CgoKCgoKdHlwZWRlZiB1bmlvbgp7CgogIHN0cnVj dAogIHsKICAgIGludCBfX2xvY2s7CiAgICB1bnNpZ25lZCBpbnQgX19ucl9yZWFkZXJzOwogICAg
dW5zaWduZWQgaW50IF9fcmVhZGVyc193YWtldXA7CiAgICB1bnNpZ25lZCBpbnQgX193cml0ZXJf d2FrZXVwOwogICAgdW5zaWduZWQgaW50IF9fbnJfcmVhZGVyc19xdWV1ZWQ7CiAgICB1bnNpZ25l ZCBpbnQgX19ucl93cml0ZXJzX3F1ZXVlZDsKICAgIGludCBfX3dyaXRlcjsKICAgIGludCBfX3No
YXJlZDsKICAgIHVuc2lnbmVkIGxvbmcgaW50IF9fcGFkMTsKICAgIHVuc2lnbmVkIGxvbmcgaW50 IF9fcGFkMjsKCgogICAgdW5zaWduZWQgaW50IF9fZmxhZ3M7CiAgfSBfX2RhdGE7CiMgMjEzICIv dXNyL2luY2x1ZGUvYml0cy9wdGhyZWFkdHlwZXMuaCIgMyA0CiAgY2hhciBfX3NpemVbNTZdOwog
IGxvbmcgaW50IF9fYWxpZ247Cn0gcHRocmVhZF9yd2xvY2tfdDsKCgoKdHlwZWRlZiB1bmlvbgp7 CiAgY2hhciBfX3NpemVbOF07CiAgbG9uZyBpbnQgX19hbGlnbjsKfSBwdGhyZWFkX3J3bG9ja2F0 dHJfdDsKCgoKCgp0eXBlZGVmIHZvbGF0aWxlIGludCBwdGhyZWFkX3NwaW5sb2NrX3Q7CgoKCgp0
eXBlZGVmIHVuaW9uCnsKICBjaGFyIF9fc2l6ZVszMl07CiAgbG9uZyBpbnQgX19hbGlnbjsKfSBw dGhyZWFkX2JhcnJpZXJfdDsKCnR5cGVkZWYgdW5pb24KewogIGNoYXIgX19zaXplWzRdOwogIGlu dCBfX2FsaWduOwp9IHB0aHJlYWRfYmFycmllcmF0dHJfdDsKIyAyNzEgIi91c3IvaW5jbHVkZS9z
eXMvdHlwZXMuaCIgMiAzIDQKCgoKIyAyNiAiL3Vzci9pbmNsdWRlL2JpdHMvdWlvLmgiIDIgMyA0 CiMgNDMgIi91c3IvaW5jbHVkZS9iaXRzL3Vpby5oIiAzIDQKc3RydWN0IGlvdmVjCiAgewogICAg dm9pZCAqaW92X2Jhc2U7CiAgICBzaXplX3QgaW92X2xlbjsKICB9OwojIDM5ICIvdXNyL2luY2x1
ZGUvYml0cy9mY250bC1saW51eC5oIiAyIDMgNAojIDI1OCAiL3Vzci9pbmNsdWRlL2JpdHMvZmNu dGwtbGludXguaCIgMyA0CmVudW0gX19waWRfdHlwZQogIHsKICAgIEZfT1dORVJfVElEID0gMCwK ICAgIEZfT1dORVJfUElELAogICAgRl9PV05FUl9QR1JQLAogICAgRl9PV05FUl9HSUQgPSBGX09X
TkVSX1BHUlAKICB9OwoKCnN0cnVjdCBmX293bmVyX2V4CiAgewogICAgZW51bSBfX3BpZF90eXBl IHR5cGU7CiAgICBfX3BpZF90IHBpZDsKICB9OwojIDMzMyAiL3Vzci9pbmNsdWRlL2JpdHMvZmNu dGwtbGludXguaCIgMyA0CnN0cnVjdCBmaWxlX2hhbmRsZQp7CiAgdW5zaWduZWQgaW50IGhhbmRs
ZV9ieXRlczsKICBpbnQgaGFuZGxlX3R5cGU7CgogIHVuc2lnbmVkIGNoYXIgZl9oYW5kbGVbMF07 Cn07CgoKCgoKCgoKCgpleHRlcm4gc3NpemVfdCByZWFkYWhlYWQgKGludCBfX2ZkLCBfX29mZjY0 X3QgX19vZmZzZXQsIHNpemVfdCBfX2NvdW50KQogICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv
d19fICwgX19sZWFmX18pKTsKCgoKCgoKZXh0ZXJuIGludCBzeW5jX2ZpbGVfcmFuZ2UgKGludCBf X2ZkLCBfX29mZjY0X3QgX19vZmZzZXQsIF9fb2ZmNjRfdCBfX2NvdW50LAogICAgICAgdW5zaWdu ZWQgaW50IF9fZmxhZ3MpOwoKCgoKCgpleHRlcm4gc3NpemVfdCB2bXNwbGljZSAoaW50IF9fZmRv
dXQsIGNvbnN0IHN0cnVjdCBpb3ZlYyAqX19pb3YsCiAgICBzaXplX3QgX19jb3VudCwgdW5zaWdu ZWQgaW50IF9fZmxhZ3MpOwoKCgoKCmV4dGVybiBzc2l6ZV90IHNwbGljZSAoaW50IF9fZmRpbiwg X19vZmY2NF90ICpfX29mZmluLCBpbnQgX19mZG91dCwKICAgICAgICAgX19vZmY2NF90ICpfX29m
Zm91dCwgc2l6ZV90IF9fbGVuLAogICAgICAgICB1bnNpZ25lZCBpbnQgX19mbGFncyk7CgoKCgoK ZXh0ZXJuIHNzaXplX3QgdGVlIChpbnQgX19mZGluLCBpbnQgX19mZG91dCwgc2l6ZV90IF9fbGVu LAogICAgICB1bnNpZ25lZCBpbnQgX19mbGFncyk7CgoKCgoKCmV4dGVybiBpbnQgZmFsbG9jYXRl
IChpbnQgX19mZCwgaW50IF9fbW9kZSwgX19vZmZfdCBfX29mZnNldCwgX19vZmZfdCBfX2xlbik7 CiMgNDAwICIvdXNyL2luY2x1ZGUvYml0cy9mY250bC1saW51eC5oIiAzIDQKZXh0ZXJuIGludCBm YWxsb2NhdGU2NCAoaW50IF9fZmQsIGludCBfX21vZGUsIF9fb2ZmNjRfdCBfX29mZnNldCwKICAg
X19vZmY2NF90IF9fbGVuKTsKCgoKCmV4dGVybiBpbnQgbmFtZV90b19oYW5kbGVfYXQgKGludCBf X2RmZCwgY29uc3QgY2hhciAqX19uYW1lLAogICAgICAgICBzdHJ1Y3QgZmlsZV9oYW5kbGUgKl9f aGFuZGxlLCBpbnQgKl9fbW50X2lkLAogICAgICAgICBpbnQgX19mbGFncykgX19hdHRyaWJ1dGVf
XyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCgpleHRlcm4gaW50IG9wZW5fYnlfaGFu ZGxlX2F0IChpbnQgX19tb3VudGRpcmZkLCBzdHJ1Y3QgZmlsZV9oYW5kbGUgKl9faGFuZGxlLAog ICAgICAgICBpbnQgX19mbGFncyk7CgoKCgojIDcxICIvdXNyL2luY2x1ZGUvYml0cy9mY250bC5o
IiAyIDMgNAojIDM2ICIvdXNyL2luY2x1ZGUvZmNudGwuaCIgMiAzIDQKIyA3NiAiL3Vzci9pbmNs dWRlL2ZjbnRsLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS90aW1lLmgiIDEgMyA0CiMgNzcgIi91 c3IvaW5jbHVkZS9mY250bC5oIiAyIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3N0YXQuaCIg
MSAzIDQKIyAyNSAiL3Vzci9pbmNsdWRlL2JpdHMvc3RhdC5oIiAzIDQKIyAxICIvdXNyL2luY2x1 ZGUvYml0cy93b3Jkc2l6ZS5oIiAxIDMgNAojIDI2ICIvdXNyL2luY2x1ZGUvYml0cy9zdGF0Lmgi IDIgMyA0CiMgNTAgIi91c3IvaW5jbHVkZS9iaXRzL3N0YXQuaCIgMyA0CnN0cnVjdCBzdGF0CiAg
ewogICAgX19kZXZfdCBzdF9kZXY7CiAgICBfX2lub190IHN0X2lubzsKICAgIF9fbmxpbmtfdCBz dF9ubGluazsKICAgIF9fbW9kZV90IHN0X21vZGU7CiAgICBfX3VpZF90IHN0X3VpZDsKICAgIF9f Z2lkX3Qgc3RfZ2lkOwogICAgaW50IF9fZ2xpYmNfcmVzZXJ2ZWQwOwogICAgX19kZXZfdCBzdF9y
ZGV2OwogICAgX19vZmZfdCBzdF9zaXplOwoKCgoKCgoKICAgIHN0cnVjdCB0aW1lc3BlYyBzdF9h dGltOwogICAgc3RydWN0IHRpbWVzcGVjIHN0X210aW07CiAgICBzdHJ1Y3QgdGltZXNwZWMgc3Rf Y3RpbTsKIyA4MiAiL3Vzci9pbmNsdWRlL2JpdHMvc3RhdC5oIiAzIDQKICAgIF9fYmxrc2l6ZV90
IHN0X2Jsa3NpemU7CiAgICBfX2Jsa2NudF90IHN0X2Jsb2NrczsKICAgIGxvbmcgaW50IF9fZ2xp YmNfcmVzZXJ2ZWRbM107CiAgfTsKIyAxNDcgIi91c3IvaW5jbHVkZS9iaXRzL3N0YXQuaCIgMyA0 CnN0cnVjdCBzdGF0NjQKICB7CiAgICBfX2Rldl90IHN0X2RldjsKICAgIF9faW5vNjRfdCBzdF9p
bm87CiAgICBfX25saW5rX3Qgc3Rfbmxpbms7CiAgICBfX21vZGVfdCBzdF9tb2RlOwogICAgX191 aWRfdCBzdF91aWQ7CiAgICBfX2dpZF90IHN0X2dpZDsKICAgIGludCBfX2dsaWJjX3Jlc2VydmVk MDsKICAgIF9fZGV2X3Qgc3RfcmRldjsKICAgIF9fb2ZmX3Qgc3Rfc2l6ZTsKCgoKCgoKCiAgICBz
dHJ1Y3QgdGltZXNwZWMgc3RfYXRpbTsKICAgIHN0cnVjdCB0aW1lc3BlYyBzdF9tdGltOwogICAg c3RydWN0IHRpbWVzcGVjIHN0X2N0aW07CiMgMTc5ICIvdXNyL2luY2x1ZGUvYml0cy9zdGF0Lmgi IDMgNAogICAgX19ibGtzaXplX3Qgc3RfYmxrc2l6ZTsKICAgIF9fYmxrY250NjRfdCBzdF9ibG9j
a3M7CiAgICBsb25nIGludCBfX2dsaWJjX3Jlc2VydmVkWzNdOwogIH07CiMgNzggIi91c3IvaW5j bHVkZS9mY250bC5oIiAyIDMgNAojIDE2OSAiL3Vzci9pbmNsdWRlL2ZjbnRsLmgiIDMgNApleHRl cm4gaW50IGZjbnRsIChpbnQgX19mZCwgaW50IF9fY21kLCAuLi4pOwojIDE3OSAiL3Vzci9pbmNs
dWRlL2ZjbnRsLmgiIDMgNApleHRlcm4gaW50IG9wZW4gKGNvbnN0IGNoYXIgKl9fZmlsZSwgaW50 IF9fb2ZsYWcsIC4uLikgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwojIDE4OSAi L3Vzci9pbmNsdWRlL2ZjbnRsLmgiIDMgNApleHRlcm4gaW50IG9wZW42NCAoY29uc3QgY2hhciAq
X19maWxlLCBpbnQgX19vZmxhZywgLi4uKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEp KSk7CiMgMjAzICIvdXNyL2luY2x1ZGUvZmNudGwuaCIgMyA0CmV4dGVybiBpbnQgb3BlbmF0IChp bnQgX19mZCwgY29uc3QgY2hhciAqX19maWxlLCBpbnQgX19vZmxhZywgLi4uKQogICAgIF9fYXR0
cmlidXRlX18gKChfX25vbm51bGxfXyAoMikpKTsKIyAyMTQgIi91c3IvaW5jbHVkZS9mY250bC5o IiAzIDQKZXh0ZXJuIGludCBvcGVuYXQ2NCAoaW50IF9fZmQsIGNvbnN0IGNoYXIgKl9fZmlsZSwg aW50IF9fb2ZsYWcsIC4uLikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIpKSk7
CiMgMjI1ICIvdXNyL2luY2x1ZGUvZmNudGwuaCIgMyA0CmV4dGVybiBpbnQgY3JlYXQgKGNvbnN0 IGNoYXIgKl9fZmlsZSwgbW9kZV90IF9fbW9kZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f ICgxKSkpOwojIDIzNSAiL3Vzci9pbmNsdWRlL2ZjbnRsLmgiIDMgNApleHRlcm4gaW50IGNyZWF0
NjQgKGNvbnN0IGNoYXIgKl9fZmlsZSwgbW9kZV90IF9fbW9kZSkgX19hdHRyaWJ1dGVfXyAoKF9f bm9ubnVsbF9fICgxKSkpOwojIDI3MSAiL3Vzci9pbmNsdWRlL2ZjbnRsLmgiIDMgNApleHRlcm4g aW50IHBvc2l4X2ZhZHZpc2UgKGludCBfX2ZkLCBvZmZfdCBfX29mZnNldCwgb2ZmX3QgX19sZW4s
CiAgICAgaW50IF9fYWR2aXNlKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZf XykpOwojIDI4MyAiL3Vzci9pbmNsdWRlL2ZjbnRsLmgiIDMgNApleHRlcm4gaW50IHBvc2l4X2Zh ZHZpc2U2NCAoaW50IF9fZmQsIG9mZjY0X3QgX19vZmZzZXQsIG9mZjY0X3QgX19sZW4sCiAgICAg
ICBpbnQgX19hZHZpc2UpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7 CiMgMjkzICIvdXNyL2luY2x1ZGUvZmNudGwuaCIgMyA0CmV4dGVybiBpbnQgcG9zaXhfZmFsbG9j YXRlIChpbnQgX19mZCwgb2ZmX3QgX19vZmZzZXQsIG9mZl90IF9fbGVuKTsKIyAzMDQgIi91c3Iv
aW5jbHVkZS9mY250bC5oIiAzIDQKZXh0ZXJuIGludCBwb3NpeF9mYWxsb2NhdGU2NCAoaW50IF9f ZmQsIG9mZjY0X3QgX19vZmZzZXQsIG9mZjY0X3QgX19sZW4pOwoKCgoKCgoKIyAxICIvdXNyL2lu Y2x1ZGUvYml0cy9mY250bDIuaCIgMSAzIDQKIyAyNiAiL3Vzci9pbmNsdWRlL2JpdHMvZmNudGwy
LmgiIDMgNApleHRlcm4gaW50IF9fb3Blbl8yIChjb25zdCBjaGFyICpfX3BhdGgsIGludCBfX29m bGFnKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CmV4dGVybiBpbnQgX19vcGVu X2FsaWFzIChjb25zdCBjaGFyICpfX3BhdGgsIGludCBfX29mbGFnLCAuLi4pIF9fYXNtX18gKCIi
ICJvcGVuIikKICAgICAgICAgICAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkp OwoKCgoKCgpleHRlcm4gdm9pZCBfX29wZW5fdG9vX21hbnlfYXJncyAodm9pZCkgX19hdHRyaWJ1 dGVfXygoX19lcnJvcl9fICgib3BlbiBjYW4gYmUgY2FsbGVkIGVpdGhlciB3aXRoIDIgb3IgMyBh
cmd1bWVudHMsIG5vdCBtb3JlIikpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CmV4dGVybiB2b2lkIF9fb3Blbl9taXNz aW5nX21vZGUgKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXyAoIm9wZW4gd2l0aCBPX0NS
RUFUIG9yIE9fVE1QRklMRSBpbiBzZWNvbmQgYXJndW1lbnQgbmVlZHMgMyBhcmd1bWVudHMiKSkp CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9f
YWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRy aWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgaW50Cm9wZW4gKGNvbnN0IGNoYXIgKl9fcGF0aCwg aW50IF9fb2ZsYWcsIC4uLikKewogIGlmIChfX2J1aWx0aW5fdmFfYXJnX3BhY2tfbGVuICgpID4g
MSkKICAgIF9fb3Blbl90b29fbWFueV9hcmdzICgpOwoKICBpZiAoX19idWlsdGluX2NvbnN0YW50 X3AgKF9fb2ZsYWcpKQogICAgewogICAgICBpZiAoKCgoX19vZmxhZykgJiAwMTAwKSAhPSAwIHx8 ICgoX19vZmxhZykgJiAoMDIwMDAwMDAwIHwgMDIwMDAwMCkpID09ICgwMjAwMDAwMDAgfCAwMjAw
MDAwKSkgJiYgX19idWlsdGluX3ZhX2FyZ19wYWNrX2xlbiAoKSA8IDEpCiB7CiAgIF9fb3Blbl9t aXNzaW5nX21vZGUgKCk7CiAgIHJldHVybiBfX29wZW5fMiAoX19wYXRoLCBfX29mbGFnKTsKIH0K ICAgICAgcmV0dXJuIF9fb3Blbl9hbGlhcyAoX19wYXRoLCBfX29mbGFnLCBfX2J1aWx0aW5fdmFf
YXJnX3BhY2sgKCkpOwogICAgfQoKICBpZiAoX19idWlsdGluX3ZhX2FyZ19wYWNrX2xlbiAoKSA8 IDEpCiAgICByZXR1cm4gX19vcGVuXzIgKF9fcGF0aCwgX19vZmxhZyk7CgogIHJldHVybiBfX29w ZW5fYWxpYXMgKF9fcGF0aCwgX19vZmxhZywgX19idWlsdGluX3ZhX2FyZ19wYWNrICgpKTsKfQoK
CgpleHRlcm4gaW50IF9fb3BlbjY0XzIgKGNvbnN0IGNoYXIgKl9fcGF0aCwgaW50IF9fb2ZsYWcp IF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKZXh0ZXJuIGludCBfX29wZW42NF9h bGlhcyAoY29uc3QgY2hhciAqX19wYXRoLCBpbnQgX19vZmxhZywgLi4uKSBfX2FzbV9fICgiIiAi
b3BlbjY0IikKICAgICAgICAgICAgICAgICAgIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo MSkpKTsKZXh0ZXJuIHZvaWQgX19vcGVuNjRfdG9vX21hbnlfYXJncyAodm9pZCkgX19hdHRyaWJ1 dGVfXygoX19lcnJvcl9fICgib3BlbjY0IGNhbiBiZSBjYWxsZWQgZWl0aGVyIHdpdGggMiBvciAz
IGFyZ3VtZW50cywgbm90IG1vcmUiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwpleHRlcm4gdm9pZCBfX29wZW42 NF9taXNzaW5nX21vZGUgKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXyAoIm9wZW42NCB3
aXRoIE9fQ1JFQVQgb3IgT19UTVBGSUxFIGluIHNlY29uZCBhcmd1bWVudCBuZWVkcyAzIGFyZ3Vt ZW50cyIpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmli
dXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVf XykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGludApvcGVuNjQgKGNvbnN0IGNo YXIgKl9fcGF0aCwgaW50IF9fb2ZsYWcsIC4uLikKewogIGlmIChfX2J1aWx0aW5fdmFfYXJnX3Bh
Y2tfbGVuICgpID4gMSkKICAgIF9fb3BlbjY0X3Rvb19tYW55X2FyZ3MgKCk7CgogIGlmIChfX2J1 aWx0aW5fY29uc3RhbnRfcCAoX19vZmxhZykpCiAgICB7CiAgICAgIGlmICgoKChfX29mbGFnKSAm IDAxMDApICE9IDAgfHwgKChfX29mbGFnKSAmICgwMjAwMDAwMDAgfCAwMjAwMDAwKSkgPT0gKDAy
MDAwMDAwMCB8IDAyMDAwMDApKSAmJiBfX2J1aWx0aW5fdmFfYXJnX3BhY2tfbGVuICgpIDwgMSkK IHsKICAgX19vcGVuNjRfbWlzc2luZ19tb2RlICgpOwogICByZXR1cm4gX19vcGVuNjRfMiAoX19w YXRoLCBfX29mbGFnKTsKIH0KICAgICAgcmV0dXJuIF9fb3BlbjY0X2FsaWFzIChfX3BhdGgsIF9f
b2ZsYWcsIF9fYnVpbHRpbl92YV9hcmdfcGFjayAoKSk7CiAgICB9CgogIGlmIChfX2J1aWx0aW5f dmFfYXJnX3BhY2tfbGVuICgpIDwgMSkKICAgIHJldHVybiBfX29wZW42NF8yIChfX3BhdGgsIF9f b2ZsYWcpOwoKICByZXR1cm4gX19vcGVuNjRfYWxpYXMgKF9fcGF0aCwgX19vZmxhZywgX19idWls
dGluX3ZhX2FyZ19wYWNrICgpKTsKfQoKCgoKCmV4dGVybiBpbnQgX19vcGVuYXRfMiAoaW50IF9f ZmQsIGNvbnN0IGNoYXIgKl9fcGF0aCwgaW50IF9fb2ZsYWcpCiAgICAgX19hdHRyaWJ1dGVfXyAo KF9fbm9ubnVsbF9fICgyKSkpOwpleHRlcm4gaW50IF9fb3BlbmF0X2FsaWFzIChpbnQgX19mZCwg
Y29uc3QgY2hhciAqX19wYXRoLCBpbnQgX19vZmxhZywgLi4uKSBfX2FzbV9fICgiIiAib3BlbmF0 IikKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyKSkpOwojIDExMSAiL3Vzci9p bmNsdWRlL2JpdHMvZmNudGwyLmgiIDMgNApleHRlcm4gdm9pZCBfX29wZW5hdF90b29fbWFueV9h
cmdzICh2b2lkKSBfX2F0dHJpYnV0ZV9fKChfX2Vycm9yX18gKCJvcGVuYXQgY2FuIGJlIGNhbGxl ZCBlaXRoZXIgd2l0aCAzIG9yIDQgYXJndW1lbnRzLCBub3QgbW9yZSIpKSkKICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7
CmV4dGVybiB2b2lkIF9fb3BlbmF0X21pc3NpbmdfbW9kZSAodm9pZCkgX19hdHRyaWJ1dGVfXygo X19lcnJvcl9fICgib3BlbmF0IHdpdGggT19DUkVBVCBvciBPX1RNUEZJTEUgaW4gdGhpcmQgYXJn dW1lbnQgbmVlZHMgNCBhcmd1bWVudHMiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJu IF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRl X18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGlu
dApvcGVuYXQgKGludCBfX2ZkLCBjb25zdCBjaGFyICpfX3BhdGgsIGludCBfX29mbGFnLCAuLi4p CnsKICBpZiAoX19idWlsdGluX3ZhX2FyZ19wYWNrX2xlbiAoKSA+IDEpCiAgICBfX29wZW5hdF90 b29fbWFueV9hcmdzICgpOwoKICBpZiAoX19idWlsdGluX2NvbnN0YW50X3AgKF9fb2ZsYWcpKQog
ICAgewogICAgICBpZiAoKCgoX19vZmxhZykgJiAwMTAwKSAhPSAwIHx8ICgoX19vZmxhZykgJiAo MDIwMDAwMDAwIHwgMDIwMDAwMCkpID09ICgwMjAwMDAwMDAgfCAwMjAwMDAwKSkgJiYgX19idWls dGluX3ZhX2FyZ19wYWNrX2xlbiAoKSA8IDEpCiB7CiAgIF9fb3BlbmF0X21pc3NpbmdfbW9kZSAo
KTsKICAgcmV0dXJuIF9fb3BlbmF0XzIgKF9fZmQsIF9fcGF0aCwgX19vZmxhZyk7CiB9CiAgICAg IHJldHVybiBfX29wZW5hdF9hbGlhcyAoX19mZCwgX19wYXRoLCBfX29mbGFnLCBfX2J1aWx0aW5f dmFfYXJnX3BhY2sgKCkpOwogICAgfQoKICBpZiAoX19idWlsdGluX3ZhX2FyZ19wYWNrX2xlbiAo
KSA8IDEpCiAgICByZXR1cm4gX19vcGVuYXRfMiAoX19mZCwgX19wYXRoLCBfX29mbGFnKTsKCiAg cmV0dXJuIF9fb3BlbmF0X2FsaWFzIChfX2ZkLCBfX3BhdGgsIF9fb2ZsYWcsIF9fYnVpbHRpbl92 YV9hcmdfcGFjayAoKSk7Cn0KCgoKZXh0ZXJuIGludCBfX29wZW5hdDY0XzIgKGludCBfX2ZkLCBj
b25zdCBjaGFyICpfX3BhdGgsIGludCBfX29mbGFnKQogICAgIF9fYXR0cmlidXRlX18gKChfX25v bm51bGxfXyAoMikpKTsKZXh0ZXJuIGludCBfX29wZW5hdDY0X2FsaWFzIChpbnQgX19mZCwgY29u c3QgY2hhciAqX19wYXRoLCBpbnQgX19vZmxhZywgLi4uKSBfX2FzbV9fICgiIiAib3BlbmF0NjQi
KQoKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIpKSk7CmV4dGVybiB2b2lkIF9f b3BlbmF0NjRfdG9vX21hbnlfYXJncyAodm9pZCkgX19hdHRyaWJ1dGVfXygoX19lcnJvcl9fICgi b3BlbmF0NjQgY2FuIGJlIGNhbGxlZCBlaXRoZXIgd2l0aCAzIG9yIDQgYXJndW1lbnRzLCBub3Qg
bW9yZSIpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgIDsKZXh0ZXJuIHZvaWQgX19vcGVuYXQ2NF9taXNzaW5nX21v ZGUgKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fZXJyb3JfXyAoIm9wZW5hdDY0IHdpdGggT19DUkVB
VCBvciBPX1RNUEZJTEUgaW4gdGhpcmQgYXJndW1lbnQgbmVlZHMgNCBhcmd1bWVudHMiKSkpCiAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9f
YWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRy aWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgaW50Cm9wZW5hdDY0IChpbnQgX19mZCwgY29uc3Qg Y2hhciAqX19wYXRoLCBpbnQgX19vZmxhZywgLi4uKQp7CiAgaWYgKF9fYnVpbHRpbl92YV9hcmdf
cGFja19sZW4gKCkgPiAxKQogICAgX19vcGVuYXQ2NF90b29fbWFueV9hcmdzICgpOwoKICBpZiAo X19idWlsdGluX2NvbnN0YW50X3AgKF9fb2ZsYWcpKQogICAgewogICAgICBpZiAoKCgoX19vZmxh ZykgJiAwMTAwKSAhPSAwIHx8ICgoX19vZmxhZykgJiAoMDIwMDAwMDAwIHwgMDIwMDAwMCkpID09
ICgwMjAwMDAwMDAgfCAwMjAwMDAwKSkgJiYgX19idWlsdGluX3ZhX2FyZ19wYWNrX2xlbiAoKSA8 IDEpCiB7CiAgIF9fb3BlbmF0NjRfbWlzc2luZ19tb2RlICgpOwogICByZXR1cm4gX19vcGVuYXQ2 NF8yIChfX2ZkLCBfX3BhdGgsIF9fb2ZsYWcpOwogfQogICAgICByZXR1cm4gX19vcGVuYXQ2NF9h
bGlhcyAoX19mZCwgX19wYXRoLCBfX29mbGFnLCBfX2J1aWx0aW5fdmFfYXJnX3BhY2sgKCkpOwog ICAgfQoKICBpZiAoX19idWlsdGluX3ZhX2FyZ19wYWNrX2xlbiAoKSA8IDEpCiAgICByZXR1cm4g X19vcGVuYXQ2NF8yIChfX2ZkLCBfX3BhdGgsIF9fb2ZsYWcpOwoKICByZXR1cm4gX19vcGVuYXQ2
NF9hbGlhcyAoX19mZCwgX19wYXRoLCBfX29mbGFnLCBfX2J1aWx0aW5fdmFfYXJnX3BhY2sgKCkp Owp9CiMgMzEzICIvdXNyL2luY2x1ZGUvZmNudGwuaCIgMiAzIDQKCgoKIyAzMSAibmV0bGluay5j IiAyCiMgMSAiL3Vzci9pbmNsdWRlL3RpbWUuaCIgMSAzIDQKIyAyOSAiL3Vzci9pbmNsdWRlL3Rp
bWUuaCIgMyA0CgoKCgoKCgoKIyAxICIvdXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0LWxpbnV4LzYu MC4wL2luY2x1ZGUvc3RkZGVmLmgiIDEgMyA0CiMgMzggIi91c3IvaW5jbHVkZS90aW1lLmgiIDIg MyA0CgoKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvdGltZS5oIiAxIDMgNAojIDg4ICIvdXNyL2lu
Y2x1ZGUvYml0cy90aW1lLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3RpbWV4LmgiIDEg MyA0CiMgMjUgIi91c3IvaW5jbHVkZS9iaXRzL3RpbWV4LmgiIDMgNApzdHJ1Y3QgdGltZXgKewog IHVuc2lnbmVkIGludCBtb2RlczsKICBfX3N5c2NhbGxfc2xvbmdfdCBvZmZzZXQ7CiAgX19zeXNj
YWxsX3Nsb25nX3QgZnJlcTsKICBfX3N5c2NhbGxfc2xvbmdfdCBtYXhlcnJvcjsKICBfX3N5c2Nh bGxfc2xvbmdfdCBlc3RlcnJvcjsKICBpbnQgc3RhdHVzOwogIF9fc3lzY2FsbF9zbG9uZ190IGNv bnN0YW50OwogIF9fc3lzY2FsbF9zbG9uZ190IHByZWNpc2lvbjsKICBfX3N5c2NhbGxfc2xvbmdf
dCB0b2xlcmFuY2U7CiAgc3RydWN0IHRpbWV2YWwgdGltZTsKICBfX3N5c2NhbGxfc2xvbmdfdCB0 aWNrOwogIF9fc3lzY2FsbF9zbG9uZ190IHBwc2ZyZXE7CiAgX19zeXNjYWxsX3Nsb25nX3Qgaml0 dGVyOwogIGludCBzaGlmdDsKICBfX3N5c2NhbGxfc2xvbmdfdCBzdGFiaWw7CiAgX19zeXNjYWxs
X3Nsb25nX3Qgaml0Y250OwogIF9fc3lzY2FsbF9zbG9uZ190IGNhbGNudDsKICBfX3N5c2NhbGxf c2xvbmdfdCBlcnJjbnQ7CiAgX19zeXNjYWxsX3Nsb25nX3Qgc3RiY250OwoKICBpbnQgdGFpOwoK CiAgaW50IDozMjsgaW50IDozMjsgaW50IDozMjsgaW50IDozMjsKICBpbnQgOjMyOyBpbnQgOjMy
OyBpbnQgOjMyOyBpbnQgOjMyOwogIGludCA6MzI7IGludCA6MzI7IGludCA6MzI7Cn07CiMgODkg Ii91c3IvaW5jbHVkZS9iaXRzL3RpbWUuaCIgMiAzIDQKCgoKCmV4dGVybiBpbnQgY2xvY2tfYWRq dGltZSAoX19jbG9ja2lkX3QgX19jbG9ja19pZCwgc3RydWN0IHRpbWV4ICpfX3V0eCkgX19hdHRy
aWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgojIDQyICIvdXNyL2luY2x1ZGUv dGltZS5oIiAyIDMgNAojIDEzMSAiL3Vzci9pbmNsdWRlL3RpbWUuaCIgMyA0CgoKc3RydWN0IHRt CnsKICBpbnQgdG1fc2VjOwogIGludCB0bV9taW47CiAgaW50IHRtX2hvdXI7CiAgaW50IHRtX21k
YXk7CiAgaW50IHRtX21vbjsKICBpbnQgdG1feWVhcjsKICBpbnQgdG1fd2RheTsKICBpbnQgdG1f eWRheTsKICBpbnQgdG1faXNkc3Q7CgoKICBsb25nIGludCB0bV9nbXRvZmY7CiAgY29uc3QgY2hh ciAqdG1fem9uZTsKCgoKCn07CgoKCgoKCgoKc3RydWN0IGl0aW1lcnNwZWMKICB7CiAgICBzdHJ1
Y3QgdGltZXNwZWMgaXRfaW50ZXJ2YWw7CiAgICBzdHJ1Y3QgdGltZXNwZWMgaXRfdmFsdWU7CiAg fTsKCgpzdHJ1Y3Qgc2lnZXZlbnQ7CiMgMTg2ICIvdXNyL2luY2x1ZGUvdGltZS5oIiAzIDQKCgoK ZXh0ZXJuIGNsb2NrX3QgY2xvY2sgKHZvaWQpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs
IF9fbGVhZl9fKSk7CgoKZXh0ZXJuIHRpbWVfdCB0aW1lICh0aW1lX3QgKl9fdGltZXIpIF9fYXR0 cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGRvdWJsZSBkaWZm dGltZSAodGltZV90IF9fdGltZTEsIHRpbWVfdCBfX3RpbWUwKQogICAgIF9fYXR0cmlidXRlX18g
KChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fY29uc3RfXykpOwoK CmV4dGVybiB0aW1lX3QgbWt0aW1lIChzdHJ1Y3QgdG0gKl9fdHApIF9fYXR0cmlidXRlX18gKChf X25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgoKZXh0ZXJuIHNpemVfdCBzdHJmdGltZSAoY2hh
ciAqX19yZXN0cmljdCBfX3MsIHNpemVfdCBfX21heHNpemUsCiAgIGNvbnN0IGNoYXIgKl9fcmVz dHJpY3QgX19mb3JtYXQsCiAgIGNvbnN0IHN0cnVjdCB0bSAqX19yZXN0cmljdCBfX3RwKSBfX2F0 dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKCmV4dGVybiBjaGFyICpz
dHJwdGltZSAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3MsCiAgICAgICAgIGNvbnN0IGNoYXIg Kl9fcmVzdHJpY3QgX19mbXQsIHN0cnVjdCB0bSAqX190cCkKICAgICBfX2F0dHJpYnV0ZV9fICgo X19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKCgoKZXh0ZXJuIHNpemVfdCBzdHJmdGltZV9s
IChjaGFyICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fbWF4c2l6ZSwKICAgICBjb25zdCBjaGFy ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LAogICAgIGNvbnN0IHN0cnVjdCB0bSAqX19yZXN0cmljdCBf X3RwLAogICAgIF9fbG9jYWxlX3QgX19sb2MpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs
IF9fbGVhZl9fKSk7CgoKCmV4dGVybiBjaGFyICpzdHJwdGltZV9sIChjb25zdCBjaGFyICpfX3Jl c3RyaWN0IF9fcywKICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mbXQsIHN0cnVjdCB0bSAq X190cCwKICAgIF9fbG9jYWxlX3QgX19sb2MpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAs
IF9fbGVhZl9fKSk7CgoKCgoKCmV4dGVybiBzdHJ1Y3QgdG0gKmdtdGltZSAoY29uc3QgdGltZV90 ICpfX3RpbWVyKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgpl eHRlcm4gc3RydWN0IHRtICpsb2NhbHRpbWUgKGNvbnN0IHRpbWVfdCAqX190aW1lcikgX19hdHRy
aWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCgpleHRlcm4gc3RydWN0IHRt ICpnbXRpbWVfciAoY29uc3QgdGltZV90ICpfX3Jlc3RyaWN0IF9fdGltZXIsCiAgICAgICBzdHJ1 Y3QgdG0gKl9fcmVzdHJpY3QgX190cCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19s
ZWFmX18pKTsKCgoKZXh0ZXJuIHN0cnVjdCB0bSAqbG9jYWx0aW1lX3IgKGNvbnN0IHRpbWVfdCAq X19yZXN0cmljdCBfX3RpbWVyLAogICAgICAgICAgc3RydWN0IHRtICpfX3Jlc3RyaWN0IF9fdHAp IF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgoKZXh0ZXJuIGNo
YXIgKmFzY3RpbWUgKGNvbnN0IHN0cnVjdCB0bSAqX190cCkgX19hdHRyaWJ1dGVfXyAoKF9fbm90 aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRlcm4gY2hhciAqY3RpbWUgKGNvbnN0IHRpbWVfdCAq X190aW1lcikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCgoK
CmV4dGVybiBjaGFyICphc2N0aW1lX3IgKGNvbnN0IHN0cnVjdCB0bSAqX19yZXN0cmljdCBfX3Rw LAogICBjaGFyICpfX3Jlc3RyaWN0IF9fYnVmKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18g LCBfX2xlYWZfXykpOwoKCmV4dGVybiBjaGFyICpjdGltZV9yIChjb25zdCB0aW1lX3QgKl9fcmVz
dHJpY3QgX190aW1lciwKICAgICAgICBjaGFyICpfX3Jlc3RyaWN0IF9fYnVmKSBfX2F0dHJpYnV0 ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKZXh0ZXJuIGNoYXIgKl9fdHpuYW1l WzJdOwpleHRlcm4gaW50IF9fZGF5bGlnaHQ7CmV4dGVybiBsb25nIGludCBfX3RpbWV6b25lOwoK
CgoKZXh0ZXJuIGNoYXIgKnR6bmFtZVsyXTsKCgoKZXh0ZXJuIHZvaWQgdHpzZXQgKHZvaWQpIF9f YXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCmV4dGVybiBpbnQgZGF5 bGlnaHQ7CmV4dGVybiBsb25nIGludCB0aW1lem9uZTsKCgoKCgpleHRlcm4gaW50IHN0aW1lIChj
b25zdCB0aW1lX3QgKl9fd2hlbikgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFm X18pKTsKIyAzMTkgIi91c3IvaW5jbHVkZS90aW1lLmgiIDMgNApleHRlcm4gdGltZV90IHRpbWVn bSAoc3RydWN0IHRtICpfX3RwKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZf
XykpOwoKCmV4dGVybiB0aW1lX3QgdGltZWxvY2FsIChzdHJ1Y3QgdG0gKl9fdHApIF9fYXR0cmli dXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGludCBkeXNpemUgKGlu dCBfX3llYXIpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19hdHRy
aWJ1dGVfXyAoKF9fY29uc3RfXykpOwojIDMzNCAiL3Vzci9pbmNsdWRlL3RpbWUuaCIgMyA0CmV4 dGVybiBpbnQgbmFub3NsZWVwIChjb25zdCBzdHJ1Y3QgdGltZXNwZWMgKl9fcmVxdWVzdGVkX3Rp bWUsCiAgICAgICAgc3RydWN0IHRpbWVzcGVjICpfX3JlbWFpbmluZyk7CgoKCmV4dGVybiBpbnQg
Y2xvY2tfZ2V0cmVzIChjbG9ja2lkX3QgX19jbG9ja19pZCwgc3RydWN0IHRpbWVzcGVjICpfX3Jl cykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRlcm4gaW50 IGNsb2NrX2dldHRpbWUgKGNsb2NraWRfdCBfX2Nsb2NrX2lkLCBzdHJ1Y3QgdGltZXNwZWMgKl9f
dHApIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGlu dCBjbG9ja19zZXR0aW1lIChjbG9ja2lkX3QgX19jbG9ja19pZCwgY29uc3Qgc3RydWN0IHRpbWVz cGVjICpfX3RwKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7
CgoKCgoKCmV4dGVybiBpbnQgY2xvY2tfbmFub3NsZWVwIChjbG9ja2lkX3QgX19jbG9ja19pZCwg aW50IF9fZmxhZ3MsCiAgICAgICBjb25zdCBzdHJ1Y3QgdGltZXNwZWMgKl9fcmVxLAogICAgICAg c3RydWN0IHRpbWVzcGVjICpfX3JlbSk7CgoKZXh0ZXJuIGludCBjbG9ja19nZXRjcHVjbG9ja2lk
IChwaWRfdCBfX3BpZCwgY2xvY2tpZF90ICpfX2Nsb2NrX2lkKSBfX2F0dHJpYnV0ZV9fICgoX19u b3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKZXh0ZXJuIGludCB0aW1lcl9jcmVhdGUgKGNsb2Nr aWRfdCBfX2Nsb2NrX2lkLAogICAgc3RydWN0IHNpZ2V2ZW50ICpfX3Jlc3RyaWN0IF9fZXZwLAog
ICAgdGltZXJfdCAqX19yZXN0cmljdCBfX3RpbWVyaWQpIF9fYXR0cmlidXRlX18gKChfX25vdGhy b3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGludCB0aW1lcl9kZWxldGUgKHRpbWVyX3QgX190 aW1lcmlkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCmV4dGVy
biBpbnQgdGltZXJfc2V0dGltZSAodGltZXJfdCBfX3RpbWVyaWQsIGludCBfX2ZsYWdzLAogICAg IGNvbnN0IHN0cnVjdCBpdGltZXJzcGVjICpfX3Jlc3RyaWN0IF9fdmFsdWUsCiAgICAgc3RydWN0 IGl0aW1lcnNwZWMgKl9fcmVzdHJpY3QgX19vdmFsdWUpIF9fYXR0cmlidXRlX18gKChfX25vdGhy
b3dfXyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGludCB0aW1lcl9nZXR0aW1lICh0aW1lcl90IF9f dGltZXJpZCwgc3RydWN0IGl0aW1lcnNwZWMgKl9fdmFsdWUpCiAgICAgX19hdHRyaWJ1dGVfXyAo KF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRlcm4gaW50IHRpbWVyX2dldG92ZXJydW4g
KHRpbWVyX3QgX190aW1lcmlkKSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZf XykpOwoKCgoKCmV4dGVybiBpbnQgdGltZXNwZWNfZ2V0IChzdHJ1Y3QgdGltZXNwZWMgKl9fdHMs IGludCBfX2Jhc2UpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18p
KSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CiMgNDAzICIvdXNyL2luY2x1ZGUv dGltZS5oIiAzIDQKZXh0ZXJuIGludCBnZXRkYXRlX2VycjsKIyA0MTIgIi91c3IvaW5jbHVkZS90 aW1lLmgiIDMgNApleHRlcm4gc3RydWN0IHRtICpnZXRkYXRlIChjb25zdCBjaGFyICpfX3N0cmlu
Zyk7CiMgNDI2ICIvdXNyL2luY2x1ZGUvdGltZS5oIiAzIDQKZXh0ZXJuIGludCBnZXRkYXRlX3Ig KGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zdHJpbmcsCiAgICAgICAgc3RydWN0IHRtICpfX3Jl c3RyaWN0IF9fcmVzYnVmcCk7CgoKCiMgMzIgIm5ldGxpbmsuYyIgMgojIDEgIi91c3IvaW5jbHVk
ZS9zeXMvcG9sbC5oIiAxIDMgNAojIDI1ICIvdXNyL2luY2x1ZGUvc3lzL3BvbGwuaCIgMyA0CiMg MSAiL3Vzci9pbmNsdWRlL2JpdHMvcG9sbC5oIiAxIDMgNAojIDI2ICIvdXNyL2luY2x1ZGUvc3lz L3BvbGwuaCIgMiAzIDQKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3NpZ3NldC5oIiAxIDMgNAoj
IDI5ICIvdXNyL2luY2x1ZGUvc3lzL3BvbGwuaCIgMiAzIDQKCgoKCgoKCnR5cGVkZWYgdW5zaWdu ZWQgbG9uZyBpbnQgbmZkc190OwoKCnN0cnVjdCBwb2xsZmQKICB7CiAgICBpbnQgZmQ7CiAgICBz aG9ydCBpbnQgZXZlbnRzOwogICAgc2hvcnQgaW50IHJldmVudHM7CiAgfTsKCgoKIyA1NyAiL3Vz
ci9pbmNsdWRlL3N5cy9wb2xsLmgiIDMgNApleHRlcm4gaW50IHBvbGwgKHN0cnVjdCBwb2xsZmQg Kl9fZmRzLCBuZmRzX3QgX19uZmRzLCBpbnQgX190aW1lb3V0KTsKIyA2NiAiL3Vzci9pbmNsdWRl L3N5cy9wb2xsLmgiIDMgNApleHRlcm4gaW50IHBwb2xsIChzdHJ1Y3QgcG9sbGZkICpfX2Zkcywg
bmZkc190IF9fbmZkcywKICAgIGNvbnN0IHN0cnVjdCB0aW1lc3BlYyAqX190aW1lb3V0LAogICAg Y29uc3QgX19zaWdzZXRfdCAqX19zcyk7CgoKCgoKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3Bv bGwyLmgiIDEgMyA0CiMgMjQgIi91c3IvaW5jbHVkZS9iaXRzL3BvbGwyLmgiIDMgNAoKCmV4dGVy
biBpbnQgX19wb2xsX2FsaWFzIChzdHJ1Y3QgcG9sbGZkICpfX2ZkcywgbmZkc190IF9fbmZkcywg aW50IF9fdGltZW91dCkgX19hc21fXyAoIiIgInBvbGwiKQogICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgOwpleHRlcm4gaW50IF9fcG9sbF9jaGsgKHN0cnVjdCBwb2xsZmQgKl9fZmRzLCBu
ZmRzX3QgX19uZmRzLCBpbnQgX190aW1lb3V0LAogICAgICAgICBsb25nIHVuc2lnbmVkIGludCBf X2Zkc2xlbik7CmV4dGVybiBpbnQgX19wb2xsX2Noa193YXJuIChzdHJ1Y3QgcG9sbGZkICpfX2Zk cywgbmZkc190IF9fbmZkcywgaW50IF9fdGltZW91dCwgbG9uZyB1bnNpZ25lZCBpbnQgX19mZHNs
ZW4pIF9fYXNtX18gKCIiICJfX3BvbGxfY2hrIikKCgogIF9fYXR0cmlidXRlX18oKF9fd2Fybmlu Z19fICgicG9sbCBjYWxsZWQgd2l0aCBmZHMgYnVmZmVyIHRvbyBzbWFsbCBmaWxlIG5mZHMgZW50 cmllcyIpKSk7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f YXJ0aWZpY2lhbF9fKSkgaW50CnBvbGwgKHN0cnVjdCBwb2xsZmQgKl9fZmRzLCBuZmRzX3QgX19u ZmRzLCBpbnQgX190aW1lb3V0KQp7CiAgaWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19mZHMs
IDIgPiAxKSAhPSAobG9uZyB1bnNpZ25lZCBpbnQpIC0xKQogICAgewogICAgICBpZiAoISBfX2J1 aWx0aW5fY29uc3RhbnRfcCAoX19uZmRzKSkKIHJldHVybiBfX3BvbGxfY2hrIChfX2ZkcywgX19u ZmRzLCBfX3RpbWVvdXQsIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19mZHMsIDIgPiAxKSk7CiAg
ICAgIGVsc2UgaWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19mZHMsIDIgPiAxKSAvIHNpemVv ZiAoKl9fZmRzKSA8IF9fbmZkcykKIHJldHVybiBfX3BvbGxfY2hrX3dhcm4gKF9fZmRzLCBfX25m ZHMsIF9fdGltZW91dCwgX19idWlsdGluX29iamVjdF9zaXplIChfX2ZkcywgMiA+IDEpKTsKICAg
IH0KCiAgcmV0dXJuIF9fcG9sbF9hbGlhcyAoX19mZHMsIF9fbmZkcywgX190aW1lb3V0KTsKfQoK CgpleHRlcm4gaW50IF9fcHBvbGxfYWxpYXMgKHN0cnVjdCBwb2xsZmQgKl9fZmRzLCBuZmRzX3Qg X19uZmRzLCBjb25zdCBzdHJ1Y3QgdGltZXNwZWMgKl9fdGltZW91dCwgY29uc3QgX19zaWdzZXRf
dCAqX19zcykgX19hc21fXyAoIiIgInBwb2xsIikKCiAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgIDsKZXh0ZXJuIGludCBfX3Bwb2xsX2NoayAoc3RydWN0IHBvbGxmZCAq X19mZHMsIG5mZHNfdCBfX25mZHMsCiAgIGNvbnN0IHN0cnVjdCB0aW1lc3BlYyAqX190aW1lb3V0
LAogICBjb25zdCBfX3NpZ3NldF90ICpfX3NzLCBsb25nIHVuc2lnbmVkIGludCBfX2Zkc2xlbik7 CmV4dGVybiBpbnQgX19wcG9sbF9jaGtfd2FybiAoc3RydWN0IHBvbGxmZCAqX19mZHMsIG5mZHNf dCBfX25mZHMsIGNvbnN0IHN0cnVjdCB0aW1lc3BlYyAqX190aW1lb3V0LCBjb25zdCBfX3NpZ3Nl
dF90ICpfX3NzLCBsb25nIHVuc2lnbmVkIGludCBfX2Zkc2xlbikgX19hc21fXyAoIiIgIl9fcHBv bGxfY2hrIikKCgoKCiAgX19hdHRyaWJ1dGVfXygoX193YXJuaW5nX18gKCJwcG9sbCBjYWxsZWQg d2l0aCBmZHMgYnVmZmVyIHRvbyBzbWFsbCBmaWxlIG5mZHMgZW50cmllcyIpKSk7CgpleHRlcm4g
X19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVf XyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgaW50 CnBwb2xsIChzdHJ1Y3QgcG9sbGZkICpfX2ZkcywgbmZkc190IF9fbmZkcywgY29uc3Qgc3RydWN0
IHRpbWVzcGVjICpfX3RpbWVvdXQsCiAgICAgICBjb25zdCBfX3NpZ3NldF90ICpfX3NzKQp7CiAg aWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19mZHMsIDIgPiAxKSAhPSAobG9uZyB1bnNpZ25l ZCBpbnQpIC0xKQogICAgewogICAgICBpZiAoISBfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19uZmRz
KSkKIHJldHVybiBfX3Bwb2xsX2NoayAoX19mZHMsIF9fbmZkcywgX190aW1lb3V0LCBfX3NzLCBf X2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fZmRzLCAyID4gMSkpOwogICAgICBlbHNlIGlmIChfX2J1 aWx0aW5fb2JqZWN0X3NpemUgKF9fZmRzLCAyID4gMSkgLyBzaXplb2YgKCpfX2ZkcykgPCBfX25m
ZHMpCiByZXR1cm4gX19wcG9sbF9jaGtfd2FybiAoX19mZHMsIF9fbmZkcywgX190aW1lb3V0LCBf X3NzLAogICAgIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19mZHMsIDIgPiAxKSk7CiAgICB9Cgog IHJldHVybiBfX3Bwb2xsX2FsaWFzIChfX2ZkcywgX19uZmRzLCBfX3RpbWVvdXQsIF9fc3MpOwp9
CgoKCiMgNzcgIi91c3IvaW5jbHVkZS9zeXMvcG9sbC5oIiAyIDMgNAojIDMzICJuZXRsaW5rLmMi IDIKIyAxICJsaWJhdWRpdC5oIiAxCiMgMzEgImxpYmF1ZGl0LmgiCiMgMSAiL3Vzci9pbmNsdWRl L2FzbS90eXBlcy5oIiAxIDMgNAojIDEwICIvdXNyL2luY2x1ZGUvYXNtL3R5cGVzLmgiIDMgNAoj
IDEgIi91c3IvaW5jbHVkZS9hc20tZ2VuZXJpYy9pbnQtbGw2NC5oIiAxIDMgNAojIDExICIvdXNy L2luY2x1ZGUvYXNtLWdlbmVyaWMvaW50LWxsNjQuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2Fz bS9iaXRzcGVybG9uZy5oIiAxIDMgNAojIDEwICIvdXNyL2luY2x1ZGUvYXNtL2JpdHNwZXJsb25n
LmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9hc20tZ2VuZXJpYy9iaXRzcGVybG9uZy5oIiAxIDMg NAojIDExICIvdXNyL2luY2x1ZGUvYXNtL2JpdHNwZXJsb25nLmgiIDIgMyA0CiMgMTIgIi91c3Iv aW5jbHVkZS9hc20tZ2VuZXJpYy9pbnQtbGw2NC5oIiAyIDMgNAoKCgoKCgoKdHlwZWRlZiBfX3Np
Z25lZF9fIGNoYXIgX19zODsKdHlwZWRlZiB1bnNpZ25lZCBjaGFyIF9fdTg7Cgp0eXBlZGVmIF9f c2lnbmVkX18gc2hvcnQgX19zMTY7CnR5cGVkZWYgdW5zaWduZWQgc2hvcnQgX191MTY7Cgp0eXBl ZGVmIF9fc2lnbmVkX18gaW50IF9fczMyOwp0eXBlZGVmIHVuc2lnbmVkIGludCBfX3UzMjsKCgpf
X2V4dGVuc2lvbl9fIHR5cGVkZWYgX19zaWduZWRfXyBsb25nIGxvbmcgX19zNjQ7Cl9fZXh0ZW5z aW9uX18gdHlwZWRlZiB1bnNpZ25lZCBsb25nIGxvbmcgX191NjQ7CiMgMTEgIi91c3IvaW5jbHVk ZS9hc20vdHlwZXMuaCIgMiAzIDQKCgoKCgoKdHlwZWRlZiB1bnNpZ25lZCBsb25nIGFkZHJfdDsK
dHlwZWRlZiBfX3NpZ25lZF9fIGxvbmcgc2FkZHJfdDsKCnR5cGVkZWYgc3RydWN0IHsKIF9fdTMy IHVbNF07Cn0gX192ZWN0b3IxMjg7CiMgMzIgImxpYmF1ZGl0LmgiIDIKIyAxICIvdXNyL2xpYi9n Y2MvczM5MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkaW50LmgiIDEgMyA0CiMgOSAi
L3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51eC82LjAuMC9pbmNsdWRlL3N0ZGludC5oIiAz IDQKIyAxICIvdXNyL2luY2x1ZGUvc3RkaW50LmgiIDEgMyA0CiMgMjYgIi91c3IvaW5jbHVkZS9z dGRpbnQuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvd2NoYXIuaCIgMSAzIDQKIyAyNyAi
L3Vzci9pbmNsdWRlL3N0ZGludC5oIiAyIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3dvcmRz aXplLmgiIDEgMyA0CiMgMjggIi91c3IvaW5jbHVkZS9zdGRpbnQuaCIgMiAzIDQKIyA0OCAiL3Vz ci9pbmNsdWRlL3N0ZGludC5oIiAzIDQKdHlwZWRlZiB1bnNpZ25lZCBjaGFyIHVpbnQ4X3Q7CnR5
cGVkZWYgdW5zaWduZWQgc2hvcnQgaW50IHVpbnQxNl90OwoKdHlwZWRlZiB1bnNpZ25lZCBpbnQg dWludDMyX3Q7CgoKCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQgdWludDY0X3Q7CiMgNjUgIi91 c3IvaW5jbHVkZS9zdGRpbnQuaCIgMyA0CnR5cGVkZWYgc2lnbmVkIGNoYXIgaW50X2xlYXN0OF90
Owp0eXBlZGVmIHNob3J0IGludCBpbnRfbGVhc3QxNl90Owp0eXBlZGVmIGludCBpbnRfbGVhc3Qz Ml90OwoKdHlwZWRlZiBsb25nIGludCBpbnRfbGVhc3Q2NF90OwoKCgoKCgp0eXBlZGVmIHVuc2ln bmVkIGNoYXIgdWludF9sZWFzdDhfdDsKdHlwZWRlZiB1bnNpZ25lZCBzaG9ydCBpbnQgdWludF9s
ZWFzdDE2X3Q7CnR5cGVkZWYgdW5zaWduZWQgaW50IHVpbnRfbGVhc3QzMl90OwoKdHlwZWRlZiB1 bnNpZ25lZCBsb25nIGludCB1aW50X2xlYXN0NjRfdDsKIyA5MCAiL3Vzci9pbmNsdWRlL3N0ZGlu dC5oIiAzIDQKdHlwZWRlZiBzaWduZWQgY2hhciBpbnRfZmFzdDhfdDsKCnR5cGVkZWYgbG9uZyBp
bnQgaW50X2Zhc3QxNl90Owp0eXBlZGVmIGxvbmcgaW50IGludF9mYXN0MzJfdDsKdHlwZWRlZiBs b25nIGludCBpbnRfZmFzdDY0X3Q7CiMgMTAzICIvdXNyL2luY2x1ZGUvc3RkaW50LmgiIDMgNAp0 eXBlZGVmIHVuc2lnbmVkIGNoYXIgdWludF9mYXN0OF90OwoKdHlwZWRlZiB1bnNpZ25lZCBsb25n
IGludCB1aW50X2Zhc3QxNl90Owp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IHVpbnRfZmFzdDMy X3Q7CnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQgdWludF9mYXN0NjRfdDsKIyAxMjIgIi91c3Iv aW5jbHVkZS9zdGRpbnQuaCIgMyA0CnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQgdWludHB0cl90
OwojIDEzNCAiL3Vzci9pbmNsdWRlL3N0ZGludC5oIiAzIDQKdHlwZWRlZiBsb25nIGludCBpbnRt YXhfdDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIGludCB1aW50bWF4X3Q7CiMgMTAgIi91c3IvbGli L2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVkZS9zdGRpbnQuaCIgMiAzIDQKIyAz
MyAibGliYXVkaXQuaCIgMgojIDEgIi91c3IvaW5jbHVkZS9zeXMvc29ja2V0LmgiIDEgMyA0CiMg MjQgIi91c3IvaW5jbHVkZS9zeXMvc29ja2V0LmgiIDMgNAoKCiMgMSAiL3Vzci9pbmNsdWRlL3N5 cy91aW8uaCIgMSAzIDQKIyAyNSAiL3Vzci9pbmNsdWRlL3N5cy91aW8uaCIgMyA0CgoKCiMgMSAi
L3Vzci9pbmNsdWRlL2JpdHMvdWlvLmgiIDEgMyA0CiMgNTYgIi91c3IvaW5jbHVkZS9iaXRzL3Vp by5oIiAzIDQKCgoKZXh0ZXJuIHNzaXplX3QgcHJvY2Vzc192bV9yZWFkdiAocGlkX3QgX19waWQs IGNvbnN0IHN0cnVjdCBpb3ZlYyAqX19sdmVjLAogICAgIHVuc2lnbmVkIGxvbmcgaW50IF9fbGlv
dmNudCwKICAgICBjb25zdCBzdHJ1Y3QgaW92ZWMgKl9fcnZlYywKICAgICB1bnNpZ25lZCBsb25n IGludCBfX3Jpb3ZjbnQsCiAgICAgdW5zaWduZWQgbG9uZyBpbnQgX19mbGFncykKICBfX2F0dHJp YnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCmV4dGVybiBzc2l6ZV90IHByb2Nl
c3Nfdm1fd3JpdGV2IChwaWRfdCBfX3BpZCwgY29uc3Qgc3RydWN0IGlvdmVjICpfX2x2ZWMsCiAg ICAgIHVuc2lnbmVkIGxvbmcgaW50IF9fbGlvdmNudCwKICAgICAgY29uc3Qgc3RydWN0IGlvdmVj ICpfX3J2ZWMsCiAgICAgIHVuc2lnbmVkIGxvbmcgaW50IF9fcmlvdmNudCwKICAgICAgdW5zaWdu
ZWQgbG9uZyBpbnQgX19mbGFncykKICBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xl YWZfXykpOwoKCiMgMjkgIi91c3IvaW5jbHVkZS9zeXMvdWlvLmgiIDIgMyA0CiMgMzkgIi91c3Iv aW5jbHVkZS9zeXMvdWlvLmgiIDMgNApleHRlcm4gc3NpemVfdCByZWFkdiAoaW50IF9fZmQsIGNv
bnN0IHN0cnVjdCBpb3ZlYyAqX19pb3ZlYywgaW50IF9fY291bnQpCiAgX19hdHRyaWJ1dGVfXyAo KF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKIyA1MCAiL3Vzci9pbmNsdWRlL3N5cy91aW8uaCIg MyA0CmV4dGVybiBzc2l6ZV90IHdyaXRldiAoaW50IF9fZmQsIGNvbnN0IHN0cnVjdCBpb3ZlYyAq
X19pb3ZlYywgaW50IF9fY291bnQpCiAgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVz dWx0X18pKTsKIyA2NSAiL3Vzci9pbmNsdWRlL3N5cy91aW8uaCIgMyA0CmV4dGVybiBzc2l6ZV90 IHByZWFkdiAoaW50IF9fZmQsIGNvbnN0IHN0cnVjdCBpb3ZlYyAqX19pb3ZlYywgaW50IF9fY291
bnQsCiAgICAgICAgIF9fb2ZmX3QgX19vZmZzZXQpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51 c2VkX3Jlc3VsdF9fKSk7CiMgNzcgIi91c3IvaW5jbHVkZS9zeXMvdWlvLmgiIDMgNApleHRlcm4g c3NpemVfdCBwd3JpdGV2IChpbnQgX19mZCwgY29uc3Qgc3RydWN0IGlvdmVjICpfX2lvdmVjLCBp
bnQgX19jb3VudCwKICAgX19vZmZfdCBfX29mZnNldCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91 bnVzZWRfcmVzdWx0X18pKTsKIyAxMDMgIi91c3IvaW5jbHVkZS9zeXMvdWlvLmgiIDMgNApleHRl cm4gc3NpemVfdCBwcmVhZHY2NCAoaW50IF9fZmQsIGNvbnN0IHN0cnVjdCBpb3ZlYyAqX19pb3Zl
YywgaW50IF9fY291bnQsCiAgICBfX29mZjY0X3QgX19vZmZzZXQpIF9fYXR0cmlidXRlX18gKChf X3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CiMgMTE1ICIvdXNyL2luY2x1ZGUvc3lzL3Vpby5oIiAz IDQKZXh0ZXJuIHNzaXplX3QgcHdyaXRldjY0IChpbnQgX19mZCwgY29uc3Qgc3RydWN0IGlvdmVj
ICpfX2lvdmVjLCBpbnQgX19jb3VudCwKICAgICBfX29mZjY0X3QgX19vZmZzZXQpIF9fYXR0cmli dXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgojIDI3ICIvdXNyL2luY2x1ZGUv c3lzL3NvY2tldC5oIiAyIDMgNAoKIyAxICIvdXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0LWxpbnV4
LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDEgMyA0CiMgMjkgIi91c3IvaW5jbHVkZS9zeXMvc29j a2V0LmgiIDIgMyA0CgoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9zaWdzZXQuaCIgMSAzIDQKIyAz MiAiL3Vzci9pbmNsdWRlL3N5cy9zb2NrZXQuaCIgMiAzIDQKCgoKCgoKIyAxICIvdXNyL2luY2x1
ZGUvYml0cy9zb2NrZXQuaCIgMSAzIDQKIyAyNyAiL3Vzci9pbmNsdWRlL2JpdHMvc29ja2V0Lmgi IDMgNAojIDEgIi91c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVkZS9z dGRkZWYuaCIgMSAzIDQKIyAyOCAiL3Vzci9pbmNsdWRlL2JpdHMvc29ja2V0LmgiIDIgMyA0CiMg
MzggIi91c3IvaW5jbHVkZS9iaXRzL3NvY2tldC5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0 cy9zb2NrZXRfdHlwZS5oIiAxIDMgNAojIDI0ICIvdXNyL2luY2x1ZGUvYml0cy9zb2NrZXRfdHlw ZS5oIiAzIDQKZW51bSBfX3NvY2tldF90eXBlCnsKICBTT0NLX1NUUkVBTSA9IDEsCgoKICBTT0NL
X0RHUkFNID0gMiwKCgogIFNPQ0tfUkFXID0gMywKCiAgU09DS19SRE0gPSA0LAoKICBTT0NLX1NF UVBBQ0tFVCA9IDUsCgoKICBTT0NLX0RDQ1AgPSA2LAoKICBTT0NLX1BBQ0tFVCA9IDEwLAoKCgoK CgoKICBTT0NLX0NMT0VYRUMgPSAwMjAwMDAwMCwKCgogIFNPQ0tfTk9OQkxPQ0sgPSAwMDAwNDAw
MAoKCn07CiMgMzkgIi91c3IvaW5jbHVkZS9iaXRzL3NvY2tldC5oIiAyIDMgNAojIDE1MCAiL3Vz ci9pbmNsdWRlL2JpdHMvc29ja2V0LmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3NvY2th ZGRyLmgiIDEgMyA0CiMgMjggIi91c3IvaW5jbHVkZS9iaXRzL3NvY2thZGRyLmgiIDMgNAp0eXBl
ZGVmIHVuc2lnbmVkIHNob3J0IGludCBzYV9mYW1pbHlfdDsKIyAxNTEgIi91c3IvaW5jbHVkZS9i aXRzL3NvY2tldC5oIiAyIDMgNAoKCnN0cnVjdCBzb2NrYWRkcgogIHsKICAgIHNhX2ZhbWlseV90 IHNhX2ZhbWlseTsKICAgIGNoYXIgc2FfZGF0YVsxNF07CiAgfTsKIyAxNjYgIi91c3IvaW5jbHVk
ZS9iaXRzL3NvY2tldC5oIiAzIDQKc3RydWN0IHNvY2thZGRyX3N0b3JhZ2UKICB7CiAgICBzYV9m YW1pbHlfdCBzc19mYW1pbHk7CiAgICB1bnNpZ25lZCBsb25nIGludCBfX3NzX2FsaWduOwogICAg Y2hhciBfX3NzX3BhZGRpbmdbKDEyOCAtICgyICogc2l6ZW9mICh1bnNpZ25lZCBsb25nIGludCkp
KV07CiAgfTsKCgoKZW51bQogIHsKICAgIE1TR19PT0IgPSAweDAxLAoKICAgIE1TR19QRUVLID0g MHgwMiwKCiAgICBNU0dfRE9OVFJPVVRFID0gMHgwNCwKCgoKICAgIE1TR19UUllIQVJEID0gTVNH X0RPTlRST1VURSwKCgogICAgTVNHX0NUUlVOQyA9IDB4MDgsCgogICAgTVNHX1BST1hZID0gMHgx
MCwKCiAgICBNU0dfVFJVTkMgPSAweDIwLAoKICAgIE1TR19ET05UV0FJVCA9IDB4NDAsCgogICAg TVNHX0VPUiA9IDB4ODAsCgogICAgTVNHX1dBSVRBTEwgPSAweDEwMCwKCiAgICBNU0dfRklOID0g MHgyMDAsCgogICAgTVNHX1NZTiA9IDB4NDAwLAoKICAgIE1TR19DT05GSVJNID0gMHg4MDAsCgog
ICAgTVNHX1JTVCA9IDB4MTAwMCwKCiAgICBNU0dfRVJSUVVFVUUgPSAweDIwMDAsCgogICAgTVNH X05PU0lHTkFMID0gMHg0MDAwLAoKICAgIE1TR19NT1JFID0gMHg4MDAwLAoKICAgIE1TR19XQUlU Rk9ST05FID0gMHgxMDAwMCwKCiAgICBNU0dfRkFTVE9QRU4gPSAweDIwMDAwMDAwLAoKCiAgICBN
U0dfQ01TR19DTE9FWEVDID0gMHg0MDAwMDAwMAoKCgogIH07CgoKCgpzdHJ1Y3QgbXNnaGRyCiAg ewogICAgdm9pZCAqbXNnX25hbWU7CiAgICBzb2NrbGVuX3QgbXNnX25hbWVsZW47CgogICAgc3Ry dWN0IGlvdmVjICptc2dfaW92OwogICAgc2l6ZV90IG1zZ19pb3ZsZW47CgogICAgdm9pZCAqbXNn
X2NvbnRyb2w7CiAgICBzaXplX3QgbXNnX2NvbnRyb2xsZW47CgoKCgogICAgaW50IG1zZ19mbGFn czsKICB9OwoKCnN0cnVjdCBjbXNnaGRyCiAgewogICAgc2l6ZV90IGNtc2dfbGVuOwoKCgoKICAg IGludCBjbXNnX2xldmVsOwogICAgaW50IGNtc2dfdHlwZTsKCiAgICBfX2V4dGVuc2lvbl9fIHVu
c2lnbmVkIGNoYXIgX19jbXNnX2RhdGEgW107CgogIH07CiMgMjc2ICIvdXNyL2luY2x1ZGUvYml0 cy9zb2NrZXQuaCIgMyA0CmV4dGVybiBzdHJ1Y3QgY21zZ2hkciAqX19jbXNnX254dGhkciAoc3Ry dWN0IG1zZ2hkciAqX19taGRyLAogICAgICAgICAgc3RydWN0IGNtc2doZHIgKl9fY21zZykgX19h
dHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwgX19sZWFmX18pKTsKCgoKCmV4dGVybiBfX2lubGlu ZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBzdHJ1Y3QgY21zZ2hkciAqCl9fYXR0 cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSkgX19jbXNnX254dGhkciAoc3RydWN0
IG1zZ2hkciAqX19taGRyLCBzdHJ1Y3QgY21zZ2hkciAqX19jbXNnKQp7CiAgaWYgKChzaXplX3Qp IF9fY21zZy0+Y21zZ19sZW4gPCBzaXplb2YgKHN0cnVjdCBjbXNnaGRyKSkKCiAgICByZXR1cm4g KHN0cnVjdCBjbXNnaGRyICopIDA7CgogIF9fY21zZyA9IChzdHJ1Y3QgY21zZ2hkciAqKSAoKHVu
c2lnbmVkIGNoYXIgKikgX19jbXNnCiAgICAgICAgICArICgoKF9fY21zZy0+Y21zZ19sZW4pICsg c2l6ZW9mIChzaXplX3QpIC0gMSkgJiAoc2l6ZV90KSB+KHNpemVvZiAoc2l6ZV90KSAtIDEpKSk7 CiAgaWYgKCh1bnNpZ25lZCBjaGFyICopIChfX2Ntc2cgKyAxKSA+ICgodW5zaWduZWQgY2hhciAq
KSBfX21oZHItPm1zZ19jb250cm9sCiAgICAgKyBfX21oZHItPm1zZ19jb250cm9sbGVuKQogICAg ICB8fCAoKHVuc2lnbmVkIGNoYXIgKikgX19jbXNnICsgKCgoX19jbXNnLT5jbXNnX2xlbikgKyBz aXplb2YgKHNpemVfdCkgLSAxKSAmIChzaXplX3QpIH4oc2l6ZW9mIChzaXplX3QpIC0gMSkpCiAg
ID4gKCh1bnNpZ25lZCBjaGFyICopIF9fbWhkci0+bXNnX2NvbnRyb2wgKyBfX21oZHItPm1zZ19j b250cm9sbGVuKSkpCgogICAgcmV0dXJuIChzdHJ1Y3QgY21zZ2hkciAqKSAwOwogIHJldHVybiBf X2Ntc2c7Cn0KCgoKCmVudW0KICB7CiAgICBTQ01fUklHSFRTID0gMHgwMQoKCiAgICAsIFNDTV9D
UkVERU5USUFMUyA9IDB4MDIKCgogIH07CgoKCnN0cnVjdCB1Y3JlZAp7CiAgcGlkX3QgcGlkOwog IHVpZF90IHVpZDsKICBnaWRfdCBnaWQ7Cn07CiMgMzQ5ICIvdXNyL2luY2x1ZGUvYml0cy9zb2Nr ZXQuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2FzbS9zb2NrZXQuaCIgMSAzIDQKIyAxMCAiL3Vz
ci9pbmNsdWRlL2FzbS9zb2NrZXQuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2FzbS9zb2NraW9z LmgiIDEgMyA0CgoKCiMgMSAiL3Vzci9pbmNsdWRlL2FzbS1nZW5lcmljL3NvY2tpb3MuaCIgMSAz IDQKIyA1ICIvdXNyL2luY2x1ZGUvYXNtL3NvY2tpb3MuaCIgMiAzIDQKIyAxMSAiL3Vzci9pbmNs
dWRlL2FzbS9zb2NrZXQuaCIgMiAzIDQKIyAzNTAgIi91c3IvaW5jbHVkZS9iaXRzL3NvY2tldC5o IiAyIDMgNAojIDM4MyAiL3Vzci9pbmNsdWRlL2JpdHMvc29ja2V0LmgiIDMgNApzdHJ1Y3QgbGlu Z2VyCiAgewogICAgaW50IGxfb25vZmY7CiAgICBpbnQgbF9saW5nZXI7CiAgfTsKIyAzOSAiL3Vz
ci9pbmNsdWRlL3N5cy9zb2NrZXQuaCIgMiAzIDQKCgoKCnN0cnVjdCBvc29ja2FkZHIKICB7CiAg ICB1bnNpZ25lZCBzaG9ydCBpbnQgc2FfZmFtaWx5OwogICAgdW5zaWduZWQgY2hhciBzYV9kYXRh WzE0XTsKICB9OwoKCgoKZW51bQp7CiAgU0hVVF9SRCA9IDAsCgogIFNIVVRfV1IsCgogIFNIVVRf
UkRXUgoKfTsKIyA5MCAiL3Vzci9pbmNsdWRlL3N5cy9zb2NrZXQuaCIgMyA0CnR5cGVkZWYgdW5p b24geyBzdHJ1Y3Qgc29ja2FkZHIgKl9fcmVzdHJpY3QgX19zb2NrYWRkcl9fOyBzdHJ1Y3Qgc29j a2FkZHJfYXQgKl9fcmVzdHJpY3QgX19zb2NrYWRkcl9hdF9fOyBzdHJ1Y3Qgc29ja2FkZHJfYXgy
NSAqX19yZXN0cmljdCBfX3NvY2thZGRyX2F4MjVfXzsgc3RydWN0IHNvY2thZGRyX2RsICpfX3Jl c3RyaWN0IF9fc29ja2FkZHJfZGxfXzsgc3RydWN0IHNvY2thZGRyX2VvbiAqX19yZXN0cmljdCBf X3NvY2thZGRyX2Vvbl9fOyBzdHJ1Y3Qgc29ja2FkZHJfaW4gKl9fcmVzdHJpY3QgX19zb2NrYWRk
cl9pbl9fOyBzdHJ1Y3Qgc29ja2FkZHJfaW42ICpfX3Jlc3RyaWN0IF9fc29ja2FkZHJfaW42X187 IHN0cnVjdCBzb2NrYWRkcl9pbmFycCAqX19yZXN0cmljdCBfX3NvY2thZGRyX2luYXJwX187IHN0 cnVjdCBzb2NrYWRkcl9pcHggKl9fcmVzdHJpY3QgX19zb2NrYWRkcl9pcHhfXzsgc3RydWN0IHNv
Y2thZGRyX2lzbyAqX19yZXN0cmljdCBfX3NvY2thZGRyX2lzb19fOyBzdHJ1Y3Qgc29ja2FkZHJf bnMgKl9fcmVzdHJpY3QgX19zb2NrYWRkcl9uc19fOyBzdHJ1Y3Qgc29ja2FkZHJfdW4gKl9fcmVz dHJpY3QgX19zb2NrYWRkcl91bl9fOyBzdHJ1Y3Qgc29ja2FkZHJfeDI1ICpfX3Jlc3RyaWN0IF9f
c29ja2FkZHJfeDI1X187CiAgICAgICB9IF9fU09DS0FERFJfQVJHIF9fYXR0cmlidXRlX18gKChf X3RyYW5zcGFyZW50X3VuaW9uX18pKTsKCgp0eXBlZGVmIHVuaW9uIHsgY29uc3Qgc3RydWN0IHNv Y2thZGRyICpfX3Jlc3RyaWN0IF9fc29ja2FkZHJfXzsgY29uc3Qgc3RydWN0IHNvY2thZGRyX2F0
ICpfX3Jlc3RyaWN0IF9fc29ja2FkZHJfYXRfXzsgY29uc3Qgc3RydWN0IHNvY2thZGRyX2F4MjUg Kl9fcmVzdHJpY3QgX19zb2NrYWRkcl9heDI1X187IGNvbnN0IHN0cnVjdCBzb2NrYWRkcl9kbCAq X19yZXN0cmljdCBfX3NvY2thZGRyX2RsX187IGNvbnN0IHN0cnVjdCBzb2NrYWRkcl9lb24gKl9f
cmVzdHJpY3QgX19zb2NrYWRkcl9lb25fXzsgY29uc3Qgc3RydWN0IHNvY2thZGRyX2luICpfX3Jl c3RyaWN0IF9fc29ja2FkZHJfaW5fXzsgY29uc3Qgc3RydWN0IHNvY2thZGRyX2luNiAqX19yZXN0 cmljdCBfX3NvY2thZGRyX2luNl9fOyBjb25zdCBzdHJ1Y3Qgc29ja2FkZHJfaW5hcnAgKl9fcmVz
dHJpY3QgX19zb2NrYWRkcl9pbmFycF9fOyBjb25zdCBzdHJ1Y3Qgc29ja2FkZHJfaXB4ICpfX3Jl c3RyaWN0IF9fc29ja2FkZHJfaXB4X187IGNvbnN0IHN0cnVjdCBzb2NrYWRkcl9pc28gKl9fcmVz dHJpY3QgX19zb2NrYWRkcl9pc29fXzsgY29uc3Qgc3RydWN0IHNvY2thZGRyX25zICpfX3Jlc3Ry
aWN0IF9fc29ja2FkZHJfbnNfXzsgY29uc3Qgc3RydWN0IHNvY2thZGRyX3VuICpfX3Jlc3RyaWN0 IF9fc29ja2FkZHJfdW5fXzsgY29uc3Qgc3RydWN0IHNvY2thZGRyX3gyNSAqX19yZXN0cmljdCBf X3NvY2thZGRyX3gyNV9fOwogICAgICAgfSBfX0NPTlNUX1NPQ0tBRERSX0FSRyBfX2F0dHJpYnV0
ZV9fICgoX190cmFuc3BhcmVudF91bmlvbl9fKSk7CgoKCgoKc3RydWN0IG1tc2doZHIKICB7CiAg ICBzdHJ1Y3QgbXNnaGRyIG1zZ19oZHI7CiAgICB1bnNpZ25lZCBpbnQgbXNnX2xlbjsKCiAgfTsK CgoKCgoKZXh0ZXJuIGludCBzb2NrZXQgKGludCBfX2RvbWFpbiwgaW50IF9fdHlwZSwgaW50IF9f
cHJvdG9jb2wpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CgoKCgoK ZXh0ZXJuIGludCBzb2NrZXRwYWlyIChpbnQgX19kb21haW4sIGludCBfX3R5cGUsIGludCBfX3By b3RvY29sLAogICAgICAgICBpbnQgX19mZHNbMl0pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df
XyAsIF9fbGVhZl9fKSk7CgoKZXh0ZXJuIGludCBiaW5kIChpbnQgX19mZCwgX19DT05TVF9TT0NL QUREUl9BUkcgX19hZGRyLCBzb2NrbGVuX3QgX19sZW4pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9f bm90aHJvd19fICwgX19sZWFmX18pKTsKCgpleHRlcm4gaW50IGdldHNvY2tuYW1lIChpbnQgX19m
ZCwgX19TT0NLQUREUl9BUkcgX19hZGRyLAogICBzb2NrbGVuX3QgKl9fcmVzdHJpY3QgX19sZW4p IF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVhZl9fKSk7CiMgMTM3ICIvdXNyL2lu Y2x1ZGUvc3lzL3NvY2tldC5oIiAzIDQKZXh0ZXJuIGludCBjb25uZWN0IChpbnQgX19mZCwgX19D
T05TVF9TT0NLQUREUl9BUkcgX19hZGRyLCBzb2NrbGVuX3QgX19sZW4pOwoKCgpleHRlcm4gaW50 IGdldHBlZXJuYW1lIChpbnQgX19mZCwgX19TT0NLQUREUl9BUkcgX19hZGRyLAogICBzb2NrbGVu X3QgKl9fcmVzdHJpY3QgX19sZW4pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9fbGVh
Zl9fKSk7CgoKCgoKCmV4dGVybiBzc2l6ZV90IHNlbmQgKGludCBfX2ZkLCBjb25zdCB2b2lkICpf X2J1Ziwgc2l6ZV90IF9fbiwgaW50IF9fZmxhZ3MpOwoKCgoKCgpleHRlcm4gc3NpemVfdCByZWN2 IChpbnQgX19mZCwgdm9pZCAqX19idWYsIHNpemVfdCBfX24sIGludCBfX2ZsYWdzKTsKCgoKCgoK
ZXh0ZXJuIHNzaXplX3Qgc2VuZHRvIChpbnQgX19mZCwgY29uc3Qgdm9pZCAqX19idWYsIHNpemVf dCBfX24sCiAgICAgICAgIGludCBfX2ZsYWdzLCBfX0NPTlNUX1NPQ0tBRERSX0FSRyBfX2FkZHIs CiAgICAgICAgIHNvY2tsZW5fdCBfX2FkZHJfbGVuKTsKIyAxNzQgIi91c3IvaW5jbHVkZS9zeXMv
c29ja2V0LmgiIDMgNApleHRlcm4gc3NpemVfdCByZWN2ZnJvbSAoaW50IF9fZmQsIHZvaWQgKl9f cmVzdHJpY3QgX19idWYsIHNpemVfdCBfX24sCiAgICBpbnQgX19mbGFncywgX19TT0NLQUREUl9B UkcgX19hZGRyLAogICAgc29ja2xlbl90ICpfX3Jlc3RyaWN0IF9fYWRkcl9sZW4pOwoKCgoKCgoK
ZXh0ZXJuIHNzaXplX3Qgc2VuZG1zZyAoaW50IF9fZmQsIGNvbnN0IHN0cnVjdCBtc2doZHIgKl9f bWVzc2FnZSwKICAgaW50IF9fZmxhZ3MpOwoKCgoKCgoKZXh0ZXJuIGludCBzZW5kbW1zZyAoaW50 IF9fZmQsIHN0cnVjdCBtbXNnaGRyICpfX3ZtZXNzYWdlcywKICAgICAgIHVuc2lnbmVkIGludCBf
X3ZsZW4sIGludCBfX2ZsYWdzKTsKCgoKCgoKCmV4dGVybiBzc2l6ZV90IHJlY3Ztc2cgKGludCBf X2ZkLCBzdHJ1Y3QgbXNnaGRyICpfX21lc3NhZ2UsIGludCBfX2ZsYWdzKTsKCgoKCgoKCmV4dGVy biBpbnQgcmVjdm1tc2cgKGludCBfX2ZkLCBzdHJ1Y3QgbW1zZ2hkciAqX192bWVzc2FnZXMsCiAg
ICAgICB1bnNpZ25lZCBpbnQgX192bGVuLCBpbnQgX19mbGFncywKICAgICAgIHN0cnVjdCB0aW1l c3BlYyAqX190bW8pOwoKCgoKCgpleHRlcm4gaW50IGdldHNvY2tvcHQgKGludCBfX2ZkLCBpbnQg X19sZXZlbCwgaW50IF9fb3B0bmFtZSwKICAgICAgICAgdm9pZCAqX19yZXN0cmljdCBfX29wdHZh
bCwKICAgICAgICAgc29ja2xlbl90ICpfX3Jlc3RyaWN0IF9fb3B0bGVuKSBfX2F0dHJpYnV0ZV9f ICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKZXh0ZXJuIGludCBzZXRzb2Nrb3B0IChp bnQgX19mZCwgaW50IF9fbGV2ZWwsIGludCBfX29wdG5hbWUsCiAgICAgICAgIGNvbnN0IHZvaWQg
Kl9fb3B0dmFsLCBzb2NrbGVuX3QgX19vcHRsZW4pIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3df XyAsIF9fbGVhZl9fKSk7CgoKCgoKZXh0ZXJuIGludCBsaXN0ZW4gKGludCBfX2ZkLCBpbnQgX19u KSBfX2F0dHJpYnV0ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwojIDI0MyAiL3Vzci9p
bmNsdWRlL3N5cy9zb2NrZXQuaCIgMyA0CmV4dGVybiBpbnQgYWNjZXB0IChpbnQgX19mZCwgX19T T0NLQUREUl9BUkcgX19hZGRyLAogICAgIHNvY2tsZW5fdCAqX19yZXN0cmljdCBfX2FkZHJfbGVu KTsKCgoKCgoKZXh0ZXJuIGludCBhY2NlcHQ0IChpbnQgX19mZCwgX19TT0NLQUREUl9BUkcgX19h
ZGRyLAogICAgICBzb2NrbGVuX3QgKl9fcmVzdHJpY3QgX19hZGRyX2xlbiwgaW50IF9fZmxhZ3Mp OwojIDI2MSAiL3Vzci9pbmNsdWRlL3N5cy9zb2NrZXQuaCIgMyA0CmV4dGVybiBpbnQgc2h1dGRv d24gKGludCBfX2ZkLCBpbnQgX19ob3cpIF9fYXR0cmlidXRlX18gKChfX25vdGhyb3dfXyAsIF9f
bGVhZl9fKSk7CgoKCgpleHRlcm4gaW50IHNvY2thdG1hcmsgKGludCBfX2ZkKSBfX2F0dHJpYnV0 ZV9fICgoX19ub3Rocm93X18gLCBfX2xlYWZfXykpOwoKCgoKCgoKZXh0ZXJuIGludCBpc2ZkdHlw ZSAoaW50IF9fZmQsIGludCBfX2ZkdHlwZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJvd19fICwg
X19sZWFmX18pKTsKCgoKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3NvY2tldDIuaCIgMSAzIDQK IyAyMyAiL3Vzci9pbmNsdWRlL2JpdHMvc29ja2V0Mi5oIiAzIDQKZXh0ZXJuIHNzaXplX3QgX19y ZWN2X2NoayAoaW50IF9fZmQsIHZvaWQgKl9fYnVmLCBzaXplX3QgX19uLCBzaXplX3QgX19idWZs
ZW4sCiAgICAgIGludCBfX2ZsYWdzKTsKZXh0ZXJuIHNzaXplX3QgX19yZWN2X2FsaWFzIChpbnQg X19mZCwgdm9pZCAqX19idWYsIHNpemVfdCBfX24sIGludCBfX2ZsYWdzKSBfX2FzbV9fICgiIiAi cmVjdiIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgOwpleHRlcm4gc3NpemVfdCBfX3JlY3Zf
Y2hrX3dhcm4gKGludCBfX2ZkLCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbiwgc2l6ZV90IF9fYnVm bGVuLCBpbnQgX19mbGFncykgX19hc21fXyAoIiIgIl9fcmVjdl9jaGsiKQoKCiAgICAgX19hdHRy aWJ1dGVfXygoX193YXJuaW5nX18gKCJyZWN2IGNhbGxlZCB3aXRoIGJpZ2dlciBsZW5ndGggdGhh
biBzaXplIG9mIGRlc3RpbmF0aW9uICIgImJ1ZmZlciIpKSkKICAgICAgICAgICAgOwoKZXh0ZXJu IF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRl X18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIHNz
aXplX3QKcmVjdiAoaW50IF9fZmQsIHZvaWQgKl9fYnVmLCBzaXplX3QgX19uLCBpbnQgX19mbGFn cykKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAwKSAhPSAoc2l6ZV90KSAt MSkKICAgIHsKICAgICAgaWYgKCFfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19uKSkKIHJldHVybiBf
X3JlY3ZfY2hrIChfX2ZkLCBfX2J1ZiwgX19uLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVm LCAwKSwgX19mbGFncyk7CgogICAgICBpZiAoX19uID4gX19idWlsdGluX29iamVjdF9zaXplIChf X2J1ZiwgMCkpCiByZXR1cm4gX19yZWN2X2Noa193YXJuIChfX2ZkLCBfX2J1ZiwgX19uLCBfX2J1
aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAwKSwgX19mbGFncyk7CiAgICB9CiAgcmV0dXJuIF9f cmVjdl9hbGlhcyAoX19mZCwgX19idWYsIF9fbiwgX19mbGFncyk7Cn0KCmV4dGVybiBzc2l6ZV90 IF9fcmVjdmZyb21fY2hrIChpbnQgX19mZCwgdm9pZCAqX19yZXN0cmljdCBfX2J1Ziwgc2l6ZV90
IF9fbiwKICAgICAgICAgIHNpemVfdCBfX2J1ZmxlbiwgaW50IF9fZmxhZ3MsCiAgICAgICAgICBf X1NPQ0tBRERSX0FSRyBfX2FkZHIsCiAgICAgICAgICBzb2NrbGVuX3QgKl9fcmVzdHJpY3QgX19h ZGRyX2xlbik7CmV4dGVybiBzc2l6ZV90IF9fcmVjdmZyb21fYWxpYXMgKGludCBfX2ZkLCB2b2lk
ICpfX3Jlc3RyaWN0IF9fYnVmLCBzaXplX3QgX19uLCBpbnQgX19mbGFncywgX19TT0NLQUREUl9B UkcgX19hZGRyLCBzb2NrbGVuX3QgKl9fcmVzdHJpY3QgX19hZGRyX2xlbikgX19hc21fXyAoIiIg InJlY3Zmcm9tIikKCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICA7CmV4dGVybiBzc2l6ZV90IF9fcmVjdmZyb21fY2hrX3dhcm4gKGludCBfX2ZkLCB2 b2lkICpfX3Jlc3RyaWN0IF9fYnVmLCBzaXplX3QgX19uLCBzaXplX3QgX19idWZsZW4sIGludCBf X2ZsYWdzLCBfX1NPQ0tBRERSX0FSRyBfX2FkZHIsIHNvY2tsZW5fdCAqX19yZXN0cmljdCBfX2Fk
ZHJfbGVuKSBfX2FzbV9fICgiIiAiX19yZWN2ZnJvbV9jaGsiKQoKCgoKICAgICBfX2F0dHJpYnV0 ZV9fKChfX3dhcm5pbmdfXyAoInJlY3Zmcm9tIGNhbGxlZCB3aXRoIGJpZ2dlciBsZW5ndGggdGhh biBzaXplIG9mICIgImRlc3RpbmF0aW9uIGJ1ZmZlciIpKSkKICAgICAgICAgICAgICAgICAgICAg
ICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykp IF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlm aWNpYWxfXykpIHNzaXplX3QKcmVjdmZyb20gKGludCBfX2ZkLCB2b2lkICpfX3Jlc3RyaWN0IF9f
YnVmLCBzaXplX3QgX19uLCBpbnQgX19mbGFncywKICAgX19TT0NLQUREUl9BUkcgX19hZGRyLCBz b2NrbGVuX3QgKl9fcmVzdHJpY3QgX19hZGRyX2xlbikKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0 X3NpemUgKF9fYnVmLCAwKSAhPSAoc2l6ZV90KSAtMSkKICAgIHsKICAgICAgaWYgKCFfX2J1aWx0
aW5fY29uc3RhbnRfcCAoX19uKSkKIHJldHVybiBfX3JlY3Zmcm9tX2NoayAoX19mZCwgX19idWYs IF9fbiwgX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMCksIF9fZmxhZ3MsCiAgICAgICAg ICBfX2FkZHIsIF9fYWRkcl9sZW4pOwogICAgICBpZiAoX19uID4gX19idWlsdGluX29iamVjdF9z
aXplIChfX2J1ZiwgMCkpCiByZXR1cm4gX19yZWN2ZnJvbV9jaGtfd2FybiAoX19mZCwgX19idWYs IF9fbiwgX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMCksIF9fZmxhZ3MsCiAgICAgICAg X19hZGRyLCBfX2FkZHJfbGVuKTsKICAgIH0KICByZXR1cm4gX19yZWN2ZnJvbV9hbGlhcyAoX19m
ZCwgX19idWYsIF9fbiwgX19mbGFncywgX19hZGRyLCBfX2FkZHJfbGVuKTsKfQojIDI4MSAiL3Vz ci9pbmNsdWRlL3N5cy9zb2NrZXQuaCIgMiAzIDQKCgoKIyAzNCAibGliYXVkaXQuaCIgMgojIDEg Ii91c3IvaW5jbHVkZS9saW51eC9uZXRsaW5rLmgiIDEgMyA0CgoKCiMgMSAiL3Vzci9pbmNsdWRl
L2xpbnV4L2tlcm5lbC5oIiAxIDMgNAoKCgojIDEgIi91c3IvaW5jbHVkZS9saW51eC9zeXNpbmZv LmgiIDEgMyA0CgoKCiMgMSAiL3Vzci9pbmNsdWRlL2xpbnV4L3R5cGVzLmgiIDEgMyA0CgoKCgoK CgojIDEgIi91c3IvaW5jbHVkZS9saW51eC9wb3NpeF90eXBlcy5oIiAxIDMgNAoKCgojIDEgIi91
c3IvaW5jbHVkZS9saW51eC9zdGRkZWYuaCIgMSAzIDQKIyA1ICIvdXNyL2luY2x1ZGUvbGludXgv cG9zaXhfdHlwZXMuaCIgMiAzIDQKIyAyNCAiL3Vzci9pbmNsdWRlL2xpbnV4L3Bvc2l4X3R5cGVz LmgiIDMgNAp0eXBlZGVmIHN0cnVjdCB7CiB1bnNpZ25lZCBsb25nIGZkc19iaXRzWzEwMjQgLyAo
OCAqIHNpemVvZihsb25nKSldOwp9IF9fa2VybmVsX2ZkX3NldDsKCgp0eXBlZGVmIHZvaWQgKCpf X2tlcm5lbF9zaWdoYW5kbGVyX3QpKGludCk7CgoKdHlwZWRlZiBpbnQgX19rZXJuZWxfa2V5X3Q7 CnR5cGVkZWYgaW50IF9fa2VybmVsX21xZF90OwoKIyAxICIvdXNyL2luY2x1ZGUvYXNtL3Bvc2l4
X3R5cGVzLmgiIDEgMyA0CiMgMTUgIi91c3IvaW5jbHVkZS9hc20vcG9zaXhfdHlwZXMuaCIgMyA0 CnR5cGVkZWYgdW5zaWduZWQgbG9uZyBfX2tlcm5lbF9zaXplX3Q7CnR5cGVkZWYgbG9uZyBfX2tl cm5lbF9zc2l6ZV90OwoKCnR5cGVkZWYgdW5zaWduZWQgc2hvcnQgX19rZXJuZWxfb2xkX2Rldl90
OwojIDMzICIvdXNyL2luY2x1ZGUvYXNtL3Bvc2l4X3R5cGVzLmgiIDMgNAp0eXBlZGVmIHVuc2ln bmVkIGludCBfX2tlcm5lbF9pbm9fdDsKdHlwZWRlZiB1bnNpZ25lZCBpbnQgX19rZXJuZWxfbW9k ZV90Owp0eXBlZGVmIGludCBfX2tlcm5lbF9pcGNfcGlkX3Q7CnR5cGVkZWYgdW5zaWduZWQgaW50
IF9fa2VybmVsX3VpZF90Owp0eXBlZGVmIHVuc2lnbmVkIGludCBfX2tlcm5lbF9naWRfdDsKdHlw ZWRlZiBsb25nIF9fa2VybmVsX3B0cmRpZmZfdDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIF9fa2Vy bmVsX3NpZ3NldF90OwojIDQ5ICIvdXNyL2luY2x1ZGUvYXNtL3Bvc2l4X3R5cGVzLmgiIDMgNAoj
IDEgIi91c3IvaW5jbHVkZS9hc20tZ2VuZXJpYy9wb3NpeF90eXBlcy5oIiAxIDMgNAojIDE0ICIv dXNyL2luY2x1ZGUvYXNtLWdlbmVyaWMvcG9zaXhfdHlwZXMuaCIgMyA0CnR5cGVkZWYgbG9uZyBf X2tlcm5lbF9sb25nX3Q7CnR5cGVkZWYgdW5zaWduZWQgbG9uZyBfX2tlcm5lbF91bG9uZ190Owoj
IDI3ICIvdXNyL2luY2x1ZGUvYXNtLWdlbmVyaWMvcG9zaXhfdHlwZXMuaCIgMyA0CnR5cGVkZWYg aW50IF9fa2VybmVsX3BpZF90OwojIDQwICIvdXNyL2luY2x1ZGUvYXNtLWdlbmVyaWMvcG9zaXhf dHlwZXMuaCIgMyA0CnR5cGVkZWYgX19rZXJuZWxfbG9uZ190IF9fa2VybmVsX3N1c2Vjb25kc190
OwoKCgp0eXBlZGVmIGludCBfX2tlcm5lbF9kYWRkcl90OwoKCgp0eXBlZGVmIHVuc2lnbmVkIGlu dCBfX2tlcm5lbF91aWQzMl90Owp0eXBlZGVmIHVuc2lnbmVkIGludCBfX2tlcm5lbF9naWQzMl90 OwoKCgp0eXBlZGVmIF9fa2VybmVsX3VpZF90IF9fa2VybmVsX29sZF91aWRfdDsKdHlwZWRlZiBf
X2tlcm5lbF9naWRfdCBfX2tlcm5lbF9vbGRfZ2lkX3Q7CiMgNzggIi91c3IvaW5jbHVkZS9hc20t Z2VuZXJpYy9wb3NpeF90eXBlcy5oIiAzIDQKdHlwZWRlZiBzdHJ1Y3QgewogaW50IHZhbFsyXTsK fSBfX2tlcm5lbF9mc2lkX3Q7CgoKCgoKdHlwZWRlZiBfX2tlcm5lbF9sb25nX3QgX19rZXJuZWxf
b2ZmX3Q7CnR5cGVkZWYgbG9uZyBsb25nIF9fa2VybmVsX2xvZmZfdDsKdHlwZWRlZiBfX2tlcm5l bF9sb25nX3QgX19rZXJuZWxfdGltZV90Owp0eXBlZGVmIF9fa2VybmVsX2xvbmdfdCBfX2tlcm5l bF9jbG9ja190Owp0eXBlZGVmIGludCBfX2tlcm5lbF90aW1lcl90Owp0eXBlZGVmIGludCBfX2tl
cm5lbF9jbG9ja2lkX3Q7CnR5cGVkZWYgY2hhciAqIF9fa2VybmVsX2NhZGRyX3Q7CnR5cGVkZWYg dW5zaWduZWQgc2hvcnQgX19rZXJuZWxfdWlkMTZfdDsKdHlwZWRlZiB1bnNpZ25lZCBzaG9ydCBf X2tlcm5lbF9naWQxNl90OwojIDUwICIvdXNyL2luY2x1ZGUvYXNtL3Bvc2l4X3R5cGVzLmgiIDIg
MyA0CiMgMzYgIi91c3IvaW5jbHVkZS9saW51eC9wb3NpeF90eXBlcy5oIiAyIDMgNAojIDkgIi91 c3IvaW5jbHVkZS9saW51eC90eXBlcy5oIiAyIDMgNAojIDI3ICIvdXNyL2luY2x1ZGUvbGludXgv dHlwZXMuaCIgMyA0CnR5cGVkZWYgX191MTYgX19sZTE2Owp0eXBlZGVmIF9fdTE2IF9fYmUxNjsK
dHlwZWRlZiBfX3UzMiBfX2xlMzI7CnR5cGVkZWYgX191MzIgX19iZTMyOwp0eXBlZGVmIF9fdTY0 IF9fbGU2NDsKdHlwZWRlZiBfX3U2NCBfX2JlNjQ7Cgp0eXBlZGVmIF9fdTE2IF9fc3VtMTY7CnR5 cGVkZWYgX191MzIgX193c3VtOwojIDUgIi91c3IvaW5jbHVkZS9saW51eC9zeXNpbmZvLmgiIDIg
MyA0CgoKc3RydWN0IHN5c2luZm8gewogX19rZXJuZWxfbG9uZ190IHVwdGltZTsKIF9fa2VybmVs X3Vsb25nX3QgbG9hZHNbM107CiBfX2tlcm5lbF91bG9uZ190IHRvdGFscmFtOwogX19rZXJuZWxf dWxvbmdfdCBmcmVlcmFtOwogX19rZXJuZWxfdWxvbmdfdCBzaGFyZWRyYW07CiBfX2tlcm5lbF91
bG9uZ190IGJ1ZmZlcnJhbTsKIF9fa2VybmVsX3Vsb25nX3QgdG90YWxzd2FwOwogX19rZXJuZWxf dWxvbmdfdCBmcmVlc3dhcDsKIF9fdTE2IHByb2NzOwogX191MTYgcGFkOwogX19rZXJuZWxfdWxv bmdfdCB0b3RhbGhpZ2g7CiBfX2tlcm5lbF91bG9uZ190IGZyZWVoaWdoOwogX191MzIgbWVtX3Vu
aXQ7CiBjaGFyIF9mWzIwLTIqc2l6ZW9mKF9fa2VybmVsX3Vsb25nX3QpLXNpemVvZihfX3UzMild Owp9OwojIDUgIi91c3IvaW5jbHVkZS9saW51eC9rZXJuZWwuaCIgMiAzIDQKIyA1ICIvdXNyL2lu Y2x1ZGUvbGludXgvbmV0bGluay5oIiAyIDMgNAojIDEgIi91c3IvaW5jbHVkZS9saW51eC9zb2Nr
ZXQuaCIgMSAzIDQKIyAxMSAiL3Vzci9pbmNsdWRlL2xpbnV4L3NvY2tldC5oIiAzIDQKdHlwZWRl ZiB1bnNpZ25lZCBzaG9ydCBfX2tlcm5lbF9zYV9mYW1pbHlfdDsKCnN0cnVjdCBfX2tlcm5lbF9z b2NrYWRkcl9zdG9yYWdlIHsKIF9fa2VybmVsX3NhX2ZhbWlseV90IHNzX2ZhbWlseTsKCiBjaGFy
IF9fZGF0YVsxMjggLSBzaXplb2YodW5zaWduZWQgc2hvcnQpXTsKCgp9IF9fYXR0cmlidXRlX18g KChhbGlnbmVkKChfX2FsaWdub2ZfXyAoc3RydWN0IHNvY2thZGRyICopKSkpKTsKIyA2ICIvdXNy L2luY2x1ZGUvbGludXgvbmV0bGluay5oIiAyIDMgNAojIDM1ICIvdXNyL2luY2x1ZGUvbGludXgv
bmV0bGluay5oIiAzIDQKc3RydWN0IHNvY2thZGRyX25sIHsKIF9fa2VybmVsX3NhX2ZhbWlseV90 IG5sX2ZhbWlseTsKIHVuc2lnbmVkIHNob3J0IG5sX3BhZDsKIF9fdTMyIG5sX3BpZDsKICAgICAg ICBfX3UzMiBubF9ncm91cHM7Cn07CgpzdHJ1Y3Qgbmxtc2doZHIgewogX191MzIgbmxtc2dfbGVu
OwogX191MTYgbmxtc2dfdHlwZTsKIF9fdTE2IG5sbXNnX2ZsYWdzOwogX191MzIgbmxtc2dfc2Vx OwogX191MzIgbmxtc2dfcGlkOwp9OwojIDEwMCAiL3Vzci9pbmNsdWRlL2xpbnV4L25ldGxpbmsu aCIgMyA0CnN0cnVjdCBubG1zZ2VyciB7CiBpbnQgZXJyb3I7CiBzdHJ1Y3Qgbmxtc2doZHIgbXNn
Owp9OwojIDExNiAiL3Vzci9pbmNsdWRlL2xpbnV4L25ldGxpbmsuaCIgMyA0CnN0cnVjdCBubF9w a3RpbmZvIHsKIF9fdTMyIGdyb3VwOwp9OwoKc3RydWN0IG5sX21tYXBfcmVxIHsKIHVuc2lnbmVk IGludCBubV9ibG9ja19zaXplOwogdW5zaWduZWQgaW50IG5tX2Jsb2NrX25yOwogdW5zaWduZWQg
aW50IG5tX2ZyYW1lX3NpemU7CiB1bnNpZ25lZCBpbnQgbm1fZnJhbWVfbnI7Cn07CgpzdHJ1Y3Qg bmxfbW1hcF9oZHIgewogdW5zaWduZWQgaW50IG5tX3N0YXR1czsKIHVuc2lnbmVkIGludCBubV9s ZW47CiBfX3UzMiBubV9ncm91cDsKCiBfX3UzMiBubV9waWQ7CiBfX3UzMiBubV91aWQ7CiBfX3Uz
MiBubV9naWQ7Cn07CgplbnVtIG5sX21tYXBfc3RhdHVzIHsKIE5MX01NQVBfU1RBVFVTX1VOVVNF RCwKIE5MX01NQVBfU1RBVFVTX1JFU0VSVkVELAogTkxfTU1BUF9TVEFUVVNfVkFMSUQsCiBOTF9N TUFQX1NUQVRVU19DT1BZLAogTkxfTU1BUF9TVEFUVVNfU0tJUCwKfTsKCgoKCgoKCmVudW0gewog
TkVUTElOS19VTkNPTk5FQ1RFRCA9IDAsCiBORVRMSU5LX0NPTk5FQ1RFRCwKfTsKIyAxNjUgIi91 c3IvaW5jbHVkZS9saW51eC9uZXRsaW5rLmgiIDMgNApzdHJ1Y3QgbmxhdHRyIHsKIF9fdTE2IG5s YV9sZW47CiBfX3UxNiBubGFfdHlwZTsKfTsKIyAzNSAibGliYXVkaXQuaCIgMgojIDEgIi91c3Iv
aW5jbHVkZS9saW51eC9hdWRpdC5oIiAxIDMgNAojIDI4ICIvdXNyL2luY2x1ZGUvbGludXgvYXVk aXQuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2xpbnV4L2VsZi1lbS5oIiAxIDMgNAojIDI5ICIv dXNyL2luY2x1ZGUvbGludXgvYXVkaXQuaCIgMiAzIDQKIyAzMDUgIi91c3IvaW5jbHVkZS9saW51
eC9hdWRpdC5oIiAzIDQKZW51bSB7CiBBdWRpdF9lcXVhbCwKIEF1ZGl0X25vdF9lcXVhbCwKIEF1 ZGl0X2JpdG1hc2ssCiBBdWRpdF9iaXR0ZXN0LAogQXVkaXRfbHQsCiBBdWRpdF9ndCwKIEF1ZGl0 X2xlLAogQXVkaXRfZ2UsCiBBdWRpdF9iYWQKfTsKIyA0MDUgIi91c3IvaW5jbHVkZS9saW51eC9h
dWRpdC5oIiAzIDQKZW51bSBhdWRpdF9ubGdycHMgewogQVVESVRfTkxHUlBfTk9ORSwKIEFVRElU X05MR1JQX1JFQURMT0csCiBfX0FVRElUX05MR1JQX01BWAp9OwoKCnN0cnVjdCBhdWRpdF9zdGF0 dXMgewogX191MzIgbWFzazsKIF9fdTMyIGVuYWJsZWQ7CiBfX3UzMiBmYWlsdXJlOwogX191MzIg
cGlkOwogX191MzIgcmF0ZV9saW1pdDsKIF9fdTMyIGJhY2tsb2dfbGltaXQ7CiBfX3UzMiBsb3N0 OwogX191MzIgYmFja2xvZzsKIHVuaW9uIHsKICBfX3UzMiB2ZXJzaW9uOwogIF9fdTMyIGZlYXR1 cmVfYml0bWFwOwogfTsKIF9fdTMyIGJhY2tsb2dfd2FpdF90aW1lOwp9OwoKc3RydWN0IGF1ZGl0
X2ZlYXR1cmVzIHsKCiBfX3UzMiB2ZXJzOwogX191MzIgbWFzazsKIF9fdTMyIGZlYXR1cmVzOwog X191MzIgbG9jazsKfTsKIyA0NDMgIi91c3IvaW5jbHVkZS9saW51eC9hdWRpdC5oIiAzIDQKc3Ry dWN0IGF1ZGl0X3R0eV9zdGF0dXMgewogX191MzIgZW5hYmxlZDsKIF9fdTMyIGxvZ19wYXNzd2Q7
Cn07CgoKCgoKCgpzdHJ1Y3QgYXVkaXRfcnVsZV9kYXRhIHsKIF9fdTMyIGZsYWdzOwogX191MzIg YWN0aW9uOwogX191MzIgZmllbGRfY291bnQ7CiBfX3UzMiBtYXNrWzY0XTsKIF9fdTMyIGZpZWxk c1s2NF07CiBfX3UzMiB2YWx1ZXNbNjRdOwogX191MzIgZmllbGRmbGFnc1s2NF07CiBfX3UzMiBi
dWZsZW47CiBjaGFyIGJ1ZlswXTsKfTsKIyAzNiAibGliYXVkaXQuaCIgMgojIDEgIi91c3IvbGli L2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVkZS9zdGRhcmcuaCIgMSAzIDQKIyA0 MCAiL3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51eC82LjAuMC9pbmNsdWRlL3N0ZGFyZy5o
IiAzIDQKdHlwZWRlZiBfX2J1aWx0aW5fdmFfbGlzdCBfX2dudWNfdmFfbGlzdDsKIyA5OSAiL3Vz ci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51eC82LjAuMC9pbmNsdWRlL3N0ZGFyZy5oIiAzIDQK dHlwZWRlZiBfX2dudWNfdmFfbGlzdCB2YV9saXN0OwojIDM3ICJsaWJhdWRpdC5oIiAyCiMgMSAi
L3Vzci9pbmNsdWRlL3N5c2xvZy5oIiAxIDMgNAojIDEgIi91c3IvaW5jbHVkZS9zeXMvc3lzbG9n LmgiIDEgMyA0CiMgNDAgIi91c3IvaW5jbHVkZS9zeXMvc3lzbG9nLmgiIDMgNAojIDEgIi91c3Iv aW5jbHVkZS9iaXRzL3N5c2xvZy1wYXRoLmgiIDEgMyA0CiMgNDEgIi91c3IvaW5jbHVkZS9zeXMv
c3lzbG9nLmgiIDIgMyA0CiMgMTY5ICIvdXNyL2luY2x1ZGUvc3lzL3N5c2xvZy5oIiAzIDQKCgoK CgoKZXh0ZXJuIHZvaWQgY2xvc2Vsb2cgKHZvaWQpOwoKCgoKCmV4dGVybiB2b2lkIG9wZW5sb2cg KGNvbnN0IGNoYXIgKl9faWRlbnQsIGludCBfX29wdGlvbiwgaW50IF9fZmFjaWxpdHkpOwoKCmV4
dGVybiBpbnQgc2V0bG9nbWFzayAoaW50IF9fbWFzaykgX19hdHRyaWJ1dGVfXyAoKF9fbm90aHJv d19fICwgX19sZWFmX18pKTsKCgoKCgpleHRlcm4gdm9pZCBzeXNsb2cgKGludCBfX3ByaSwgY29u c3QgY2hhciAqX19mbXQsIC4uLikKICAgICBfX2F0dHJpYnV0ZV9fICgoX19mb3JtYXRfXyAoX19w
cmludGZfXywgMiwgMykpKTsKIyAyMDAgIi91c3IvaW5jbHVkZS9zeXMvc3lzbG9nLmgiIDMgNApl eHRlcm4gdm9pZCB2c3lzbG9nIChpbnQgX19wcmksIGNvbnN0IGNoYXIgKl9fZm10LCBfX2dudWNf dmFfbGlzdCBfX2FwKQogICAgIF9fYXR0cmlidXRlX18gKChfX2Zvcm1hdF9fIChfX3ByaW50Zl9f
LCAyLCAwKSkpOwoKCgoKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvc3lzbG9nLmgiIDEgMyA0CiMg MjQgIi91c3IvaW5jbHVkZS9iaXRzL3N5c2xvZy5oIiAzIDQKZXh0ZXJuIHZvaWQgX19zeXNsb2df Y2hrIChpbnQgX19wcmksIGludCBfX2ZsYWcsIGNvbnN0IGNoYXIgKl9fZm10LCAuLi4pCiAgICAg
X19hdHRyaWJ1dGVfXyAoKF9fZm9ybWF0X18gKF9fcHJpbnRmX18sIDMsIDQpKSk7CgoKZXh0ZXJu IF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRl X18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIHZv
aWQKc3lzbG9nIChpbnQgX19wcmksIGNvbnN0IGNoYXIgKl9fZm10LCAuLi4pCnsKICBfX3N5c2xv Z19jaGsgKF9fcHJpLCAyIC0gMSwgX19mbXQsIF9fYnVpbHRpbl92YV9hcmdfcGFjayAoKSk7Cn0K CgoKCgoKCmV4dGVybiB2b2lkIF9fdnN5c2xvZ19jaGsgKGludCBfX3ByaSwgaW50IF9fZmxhZywg
Y29uc3QgY2hhciAqX19mbXQsCiAgICAgIF9fZ251Y192YV9saXN0IF9fYXApCiAgICAgX19hdHRy aWJ1dGVfXyAoKF9fZm9ybWF0X18gKF9fcHJpbnRmX18sIDMsIDApKSk7CgpleHRlcm4gX19pbmxp bmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgdm9pZAp2c3lz bG9nIChpbnQgX19wcmksIGNvbnN0IGNoYXIgKl9fZm10LCBfX2dudWNfdmFfbGlzdCBfX2FwKQp7 CiAgX192c3lzbG9nX2NoayAoX19wcmksIDIgLSAxLCBfX2ZtdCwgX19hcCk7Cn0KIyAyMDggIi91
c3IvaW5jbHVkZS9zeXMvc3lzbG9nLmgiIDIgMyA0CgoKCgoKCiMgMSAiL3Vzci9pbmNsdWRlL3N5 c2xvZy5oIiAyIDMgNAojIDM4ICJsaWJhdWRpdC5oIiAyCiMgMzk0ICJsaWJhdWRpdC5oIgoKIyAz OTQgImxpYmF1ZGl0LmgiCnN0cnVjdCBhdWRpdF9zaWdfaW5mbyB7CiAgICAgICAgdWlkX3QgdWlk
OwogICAgICAgIHBpZF90IHBpZDsKIGNoYXIgY3R4WzBdOwp9OwoKCgpzdHJ1Y3QgYXVkaXRfbWVz c2FnZSB7CiBzdHJ1Y3Qgbmxtc2doZHIgbmxoOwogY2hhciBkYXRhWzg5NzBdOwp9OwoKCnN0cnVj dCBkYWVtb25fY29uZjsKCnN0cnVjdCBhdWRpdF9yZXBseSB7CiBpbnQgdHlwZTsKIGludCBsZW47
CiBzdHJ1Y3Qgbmxtc2doZHIgKm5saDsKIHN0cnVjdCBhdWRpdF9tZXNzYWdlIG1zZzsKCgoKIHVu aW9uIHsKIHN0cnVjdCBhdWRpdF9zdGF0dXMgKnN0YXR1czsKIHN0cnVjdCBhdWRpdF9ydWxlX2Rh dGEgKnJ1bGVkYXRhOwogc3RydWN0IGF1ZGl0X2xvZ2luICpsb2dpbjsKIGNoYXIgKm1lc3NhZ2U7
CiBzdHJ1Y3Qgbmxtc2dlcnIgKmVycm9yOwogc3RydWN0IGF1ZGl0X3NpZ19pbmZvICpzaWduYWxf aW5mbzsKIHN0cnVjdCBkYWVtb25fY29uZiAqY29uZjsKCiBzdHJ1Y3QgYXVkaXRfZmVhdHVyZXMg KmZlYXR1cmVzOwoKIH07Cn07CiMgNDQ0ICJsaWJhdWRpdC5oIgpzdHJ1Y3QgYXVkaXRfZGlzcGF0
Y2hlcl9oZWFkZXIgewogdWludDMyX3QgdmVyOwogdWludDMyX3QgaGxlbjsKIHVpbnQzMl90IHR5 cGU7CiB1aW50MzJfdCBzaXplOwp9OwojIDQ1OCAibGliYXVkaXQuaCIKdHlwZWRlZiBlbnVtIHsK IE1BQ0hfWDg2PTAsCiBNQUNIXzg2XzY0LAogTUFDSF9JQTY0LAogTUFDSF9QUEM2NCwKIE1BQ0hf
UFBDLAogTUFDSF9TMzkwWCwKIE1BQ0hfUzM5MCwKIE1BQ0hfQUxQSEEsCiBNQUNIX0FSTSwKIE1B Q0hfQUFSQ0g2NCwKIE1BQ0hfUFBDNjRMRQp9IG1hY2hpbmVfdDsKCgp0eXBlZGVmIGVudW0gewog RkFJTF9JR05PUkU9MCwKIEZBSUxfTE9HLAogRkFJTF9URVJNSU5BVEUKfSBhdWRpdGZhaWxfdDsK
Cgp0eXBlZGVmIGVudW0geyBNU0dfU1RERVJSLCBNU0dfU1lTTE9HLCBNU0dfUVVJRVQgfSBtZXNz YWdlX3Q7CnR5cGVkZWYgZW51bSB7IERCR19OTywgREJHX1lFUyB9IGRlYnVnX21lc3NhZ2VfdDsK dm9pZCBzZXRfYXVtZXNzYWdlX21vZGUobWVzc2FnZV90IG1vZGUsIGRlYnVnX21lc3NhZ2VfdCBk
ZWJ1Zyk7CgoKdHlwZWRlZiBlbnVtIHsgR0VUX1JFUExZX0JMT0NLSU5HPTAsIEdFVF9SRVBMWV9O T05CTE9DS0lORyB9IHJlcGx5X3Q7CmV4dGVybiBpbnQgYXVkaXRfb3Blbih2b2lkKTsKZXh0ZXJu IHZvaWQgYXVkaXRfY2xvc2UoaW50IGZkKTsKZXh0ZXJuIGludCBhdWRpdF9nZXRfcmVwbHkoaW50
IGZkLCBzdHJ1Y3QgYXVkaXRfcmVwbHkgKnJlcCwgcmVwbHlfdCBibG9jaywKICBpbnQgcGVlayk7 CmV4dGVybiB1aWRfdCBhdWRpdF9nZXRsb2dpbnVpZCh2b2lkKTsKZXh0ZXJuIGludCBhdWRpdF9z ZXRsb2dpbnVpZCh1aWRfdCB1aWQpOwpleHRlcm4gaW50IGF1ZGl0X2RldGVjdF9tYWNoaW5lKHZv
aWQpOwpleHRlcm4gaW50IGF1ZGl0X2RldGVybWluZV9tYWNoaW5lKGNvbnN0IGNoYXIgKmFyY2gp OwoKCmV4dGVybiBpbnQgYXVkaXRfbmFtZV90b19maWVsZChjb25zdCBjaGFyICpmaWVsZCk7CmV4 dGVybiBjb25zdCBjaGFyICphdWRpdF9maWVsZF90b19uYW1lKGludCBmaWVsZCk7CmV4dGVybiBp
bnQgYXVkaXRfbmFtZV90b19zeXNjYWxsKGNvbnN0IGNoYXIgKnNjLCBpbnQgbWFjaGluZSk7CmV4 dGVybiBjb25zdCBjaGFyICphdWRpdF9zeXNjYWxsX3RvX25hbWUoaW50IHNjLCBpbnQgbWFjaGlu ZSk7CmV4dGVybiBpbnQgYXVkaXRfbmFtZV90b19mbGFnKGNvbnN0IGNoYXIgKmZsYWcpOwpleHRl
cm4gY29uc3QgY2hhciAqYXVkaXRfZmxhZ190b19uYW1lKGludCBmbGFnKTsKZXh0ZXJuIGludCBh dWRpdF9uYW1lX3RvX2FjdGlvbihjb25zdCBjaGFyICphY3Rpb24pOwpleHRlcm4gY29uc3QgY2hh ciAqYXVkaXRfYWN0aW9uX3RvX25hbWUoaW50IGFjdGlvbik7CmV4dGVybiBpbnQgYXVkaXRfbmFt
ZV90b19tc2dfdHlwZShjb25zdCBjaGFyICptc2dfdHlwZSk7CmV4dGVybiBjb25zdCBjaGFyICph dWRpdF9tc2dfdHlwZV90b19uYW1lKGludCBtc2dfdHlwZSk7CmV4dGVybiBpbnQgYXVkaXRfbmFt ZV90b19tYWNoaW5lKGNvbnN0IGNoYXIgKm1hY2hpbmUpOwpleHRlcm4gY29uc3QgY2hhciAqYXVk
aXRfbWFjaGluZV90b19uYW1lKGludCBtYWNoaW5lKTsKZXh0ZXJuIHVuc2lnbmVkIGludCBhdWRp dF9tYWNoaW5lX3RvX2VsZihpbnQgbWFjaGluZSk7CmV4dGVybiBpbnQgYXVkaXRfZWxmX3RvX21h Y2hpbmUodW5zaWduZWQgaW50IGVsZik7CmV4dGVybiBjb25zdCBjaGFyICphdWRpdF9vcGVyYXRv
cl90b19zeW1ib2woaW50IG9wKTsKZXh0ZXJuIGludCBhdWRpdF9uYW1lX3RvX2Vycm5vKGNvbnN0 IGNoYXIgKmVycm9yKTsKZXh0ZXJuIGNvbnN0IGNoYXIgKmF1ZGl0X2Vycm5vX3RvX25hbWUoaW50 IGVycm9yKTsKZXh0ZXJuIGludCBhdWRpdF9uYW1lX3RvX2Z0eXBlKGNvbnN0IGNoYXIgKm5hbWUp
OwpleHRlcm4gY29uc3QgY2hhciAqYXVkaXRfZnR5cGVfdG9fbmFtZShpbnQgZnR5cGUpOwpleHRl cm4gdm9pZCBhdWRpdF9udW1iZXJfdG9fZXJybXNnKGludCBlcnJudW1iZXIsIGNvbnN0IGNoYXIg Km9wdCk7CgoKZXh0ZXJuIGludCBhdWRpdF9yZXF1ZXN0X3N0YXR1cyhpbnQgZmQpOwpleHRlcm4g
aW50IGF1ZGl0X2lzX2VuYWJsZWQoaW50IGZkKTsKZXh0ZXJuIGludCBnZXRfYXVkaXRmYWlsX2Fj dGlvbihhdWRpdGZhaWxfdCAqZmFpbG1vZGUpOwpleHRlcm4gaW50IGF1ZGl0X3JlcXVlc3RfZmVh dHVyZXMoaW50IGZkKTsKZXh0ZXJuIHVpbnQzMl90IGF1ZGl0X2dldF9mZWF0dXJlcyh2b2lkKTsK
Cgp0eXBlZGVmIGVudW0geyBXQUlUX05PLCBXQUlUX1lFUyB9IHJlcF93YWl0X3Q7CmV4dGVybiBp bnQgYXVkaXRfc2V0X3BpZChpbnQgZmQsIHVpbnQzMl90IHBpZCwgcmVwX3dhaXRfdCB3bW9kZSk7 CmV4dGVybiBpbnQgYXVkaXRfc2V0X2VuYWJsZWQoaW50IGZkLCB1aW50MzJfdCBlbmFibGVkKTsK
ZXh0ZXJuIGludCBhdWRpdF9zZXRfZmFpbHVyZShpbnQgZmQsIHVpbnQzMl90IGZhaWx1cmUpOwpl eHRlcm4gaW50IGF1ZGl0X3NldF9yYXRlX2xpbWl0KGludCBmZCwgdWludDMyX3QgbGltaXQpOwpl eHRlcm4gaW50IGF1ZGl0X3NldF9iYWNrbG9nX2xpbWl0KGludCBmZCwgdWludDMyX3QgbGltaXQp
OwppbnQgYXVkaXRfc2V0X2JhY2tsb2dfd2FpdF90aW1lKGludCBmZCwgdWludDMyX3QgYnd0KTsK ZXh0ZXJuIGludCBhdWRpdF9zZXRfZmVhdHVyZShpbnQgZmQsIHVuc2lnbmVkIGZlYXR1cmUsIHVu c2lnbmVkIHZhbHVlLCB1bnNpZ25lZCBsb2NrKTsKZXh0ZXJuIGludCBhdWRpdF9zZXRfbG9naW51
aWRfaW1tdXRhYmxlKGludCBmZCk7CgoKZXh0ZXJuIGludCBhdWRpdF9yZXF1ZXN0X3J1bGVzX2xp c3RfZGF0YShpbnQgZmQpOwoKCmV4dGVybiBpbnQgYXVkaXRfcmVxdWVzdF9zaWduYWxfaW5mbyhp bnQgZmQpOwoKCmV4dGVybiBpbnQgYXVkaXRfdXBkYXRlX3dhdGNoX3Blcm1zKHN0cnVjdCBhdWRp
dF9ydWxlX2RhdGEgKnJ1bGUsIGludCBwZXJtcyk7CmV4dGVybiBpbnQgYXVkaXRfYWRkX3dhdGNo KHN0cnVjdCBhdWRpdF9ydWxlX2RhdGEgKipydWxlcCwgY29uc3QgY2hhciAqcGF0aCk7CmV4dGVy biBpbnQgYXVkaXRfYWRkX2RpcihzdHJ1Y3QgYXVkaXRfcnVsZV9kYXRhICoqcnVsZXAsIGNvbnN0
IGNoYXIgKnBhdGgpOwpleHRlcm4gaW50IGF1ZGl0X2FkZF93YXRjaF9kaXIoaW50IHR5cGUsIHN0 cnVjdCBhdWRpdF9ydWxlX2RhdGEgKipydWxlcCwKICAgIGNvbnN0IGNoYXIgKnBhdGgpOwpleHRl cm4gaW50IGF1ZGl0X3RyaW1fc3VidHJlZXMoaW50IGZkKTsKZXh0ZXJuIGludCBhdWRpdF9tYWtl
X2VxdWl2YWxlbnQoaW50IGZkLCBjb25zdCBjaGFyICptb3VudF9wb2ludCwKICAgIGNvbnN0IGNo YXIgKnN1YnRyZWUpOwoKCmV4dGVybiBpbnQgYXVkaXRfYWRkX3J1bGVfZGF0YShpbnQgZmQsIHN0 cnVjdCBhdWRpdF9ydWxlX2RhdGEgKnJ1bGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaW50IGZsYWdzLCBpbnQgYWN0aW9uKTsKCgpleHRlcm4gaW50IGF1ZGl0X2RlbGV0ZV9ydWxl X2RhdGEoaW50IGZkLCBzdHJ1Y3QgYXVkaXRfcnVsZV9kYXRhICpydWxlLAogICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgIGludCBmbGFncywgaW50IGFjdGlvbik7CgoKZXh0ZXJuIGlu
dCBhdWRpdF92YWx1ZV9uZWVkc19lbmNvZGluZyhjb25zdCBjaGFyICpzdHIsIHVuc2lnbmVkIGlu dCBsZW4pOwpleHRlcm4gY2hhciAqYXVkaXRfZW5jb2RlX3ZhbHVlKGNoYXIgKmZpbmFsLGNvbnN0 IGNoYXIgKmJ1Zix1bnNpZ25lZCBpbnQgc2l6ZSk7CmV4dGVybiBjaGFyICphdWRpdF9lbmNvZGVf
bnZfc3RyaW5nKGNvbnN0IGNoYXIgKm5hbWUsIGNvbnN0IGNoYXIgKnZhbHVlLAogdW5zaWduZWQg aW50IHZsZW4pOwpleHRlcm4gaW50IGF1ZGl0X2xvZ191c2VyX21lc3NhZ2UoaW50IGF1ZGl0X2Zk LCBpbnQgdHlwZSwgY29uc3QgY2hhciAqbWVzc2FnZSwKICAgICAgICBjb25zdCBjaGFyICpob3N0
bmFtZSwgY29uc3QgY2hhciAqYWRkciwgY29uc3QgY2hhciAqdHR5LCBpbnQgcmVzdWx0KTsKZXh0 ZXJuIGludCBhdWRpdF9sb2dfdXNlcl9jb21tX21lc3NhZ2UoaW50IGF1ZGl0X2ZkLCBpbnQgdHlw ZSwKIGNvbnN0IGNoYXIgKm1lc3NhZ2UsIGNvbnN0IGNoYXIgKmNvbW0sIGNvbnN0IGNoYXIgKmhv
c3RuYW1lLAogY29uc3QgY2hhciAqYWRkciwgY29uc3QgY2hhciAqdHR5LCBpbnQgcmVzdWx0KTsK ZXh0ZXJuIGludCBhdWRpdF9sb2dfYWNjdF9tZXNzYWdlKGludCBhdWRpdF9mZCwgaW50IHR5cGUs IGNvbnN0IGNoYXIgKnBnbmFtZSwKICAgICAgICBjb25zdCBjaGFyICpvcCwgY29uc3QgY2hhciAq
bmFtZSwgdW5zaWduZWQgaW50IGlkLAogICAgICAgIGNvbnN0IGNoYXIgKmhvc3QsIGNvbnN0IGNo YXIgKmFkZHIsIGNvbnN0IGNoYXIgKnR0eSwgaW50IHJlc3VsdCk7CmV4dGVybiBpbnQgYXVkaXRf bG9nX3VzZXJfYXZjX21lc3NhZ2UoaW50IGF1ZGl0X2ZkLCBpbnQgdHlwZSwKIGNvbnN0IGNoYXIg
Km1lc3NhZ2UsIGNvbnN0IGNoYXIgKmhvc3RuYW1lLCBjb25zdCBjaGFyICphZGRyLAogY29uc3Qg Y2hhciAqdHR5LCB1aWRfdCB1aWQpOwpleHRlcm4gaW50IGF1ZGl0X2xvZ19zZW1hbmFnZV9tZXNz YWdlKGludCBhdWRpdF9mZCwgaW50IHR5cGUsCiBjb25zdCBjaGFyICpwZ25hbWUsIGNvbnN0IGNo
YXIgKm9wLCBjb25zdCBjaGFyICpuYW1lLCB1bnNpZ25lZCBpbnQgaWQsCiAgICAgICAgY29uc3Qg Y2hhciAqbmV3X3NldXNlciwgY29uc3QgY2hhciAqbmV3X3JvbGUsIGNvbnN0IGNoYXIgKm5ld19y YW5nZSwKIGNvbnN0IGNoYXIgKm9sZF9zZXVzZXIsIGNvbnN0IGNoYXIgKm9sZF9yb2xlLCBjb25z
dCBjaGFyICpvbGRfcmFuZ2UsCiBjb25zdCBjaGFyICpob3N0LCBjb25zdCBjaGFyICphZGRyLAog ICAgICAgIGNvbnN0IGNoYXIgKnR0eSwgaW50IHJlc3VsdCk7CmV4dGVybiBpbnQgYXVkaXRfbG9n X3VzZXJfY29tbWFuZChpbnQgYXVkaXRfZmQsIGludCB0eXBlLCBjb25zdCBjaGFyICpjb21tYW5k
LAogICAgICAgIGNvbnN0IGNoYXIgKnR0eSwgaW50IHJlc3VsdCk7CgoKZXh0ZXJuIGludCBhdWRp dF9ydWxlX3N5c2NhbGxfZGF0YShzdHJ1Y3QgYXVkaXRfcnVsZV9kYXRhICpydWxlLCBpbnQgc2Nh bGwpOwpleHRlcm4gaW50IGF1ZGl0X3J1bGVfc3lzY2FsbGJ5bmFtZV9kYXRhKHN0cnVjdCBhdWRp
dF9ydWxlX2RhdGEgKnJ1bGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgIGNvbnN0IGNoYXIgKnNjYWxsKTsKCgoKZXh0ZXJuIGludCBhdWRpdF9ydWxlX2ZpZWxkcGFp cl9kYXRhKHN0cnVjdCBhdWRpdF9ydWxlX2RhdGEgKipydWxlcCwKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpwYWlyLCBpbnQgZmxhZ3MpOwpleHRlcm4g aW50IGF1ZGl0X3J1bGVfaW50ZXJmaWVsZF9jb21wX2RhdGEoc3RydWN0IGF1ZGl0X3J1bGVfZGF0 YSAqKnJ1bGVwLAogICAgICBjb25zdCBjaGFyICpwYWlyLCBpbnQgZmxhZ3MpOwpleHRlcm4gdm9p
ZCBhdWRpdF9ydWxlX2ZyZWVfZGF0YShzdHJ1Y3QgYXVkaXRfcnVsZV9kYXRhICpydWxlKTsKIyAz NCAibmV0bGluay5jIiAyCiMgMSAicHJpdmF0ZS5oIiAxCiMgMjUgInByaXZhdGUuaCIKIyAxICJk c28uaCIgMQojIDI2ICJwcml2YXRlLmgiIDIKCgoKCgp0eXBlZGVmIGVudW0geyBSRUFMX0VSUiwg
SElERV9JVCB9IGhpZGVfdDsKCgp2b2lkIGF1ZGl0X21zZyhpbnQgcHJpb3JpdHksIGNvbnN0IGNo YXIgKmZtdCwgLi4uKQoKIF9fYXR0cmlidXRlX18gKChmb3JtYXQgKHByaW50ZiwgMiwgMykpKTsK CgoKCgoKc3RydWN0IGF1ZGl0ZF9yZW1vdGVfbWVzc2FnZV93cmFwcGVyIHsKCiB1aW50MzJfdCBt
YWdpYzsKCiB1aW50OF90IGhlYWRlcl92ZXJzaW9uOwoKCiB1aW50OF90IG1lc3NhZ2VfdmVyc2lv bjsKCiB1aW50MzJfdCB0eXBlOwoKIHVpbnQxNl90IGxlbmd0aDsKCiB1aW50MzJfdCBzZXF1ZW5j ZV9pZDsKCn07CiMgMTIzICJwcml2YXRlLmgiCmV4dGVybiBpbnQgYXVkaXRfc2VuZChpbnQgZmQs
IGludCB0eXBlLCBjb25zdCB2b2lkICpkYXRhLCB1bnNpZ25lZCBpbnQgc2l6ZSk7CgoKCmV4dGVy biBpbnQgYXVkaXRfc2VuZF91c2VyX21lc3NhZ2UoaW50IGZkLCBpbnQgdHlwZSwgaGlkZV90IGhp ZGVfZXJyLAogY29uc3QgY2hhciAqbWVzc2FnZSk7CgoKZXh0ZXJuIGludCBfYXVkaXRfcGVybWFk
ZGVkOwpleHRlcm4gaW50IF9hdWRpdF9hcmNoYWRkZWQ7CmV4dGVybiBpbnQgX2F1ZGl0X3N5c2Nh bGxhZGRlZDsKZXh0ZXJuIGludCBfYXVkaXRfZXhlYWRkZWQ7CmV4dGVybiB1bnNpZ25lZCBpbnQg X2F1ZGl0X2VsZjsKCmV4dGVybiBfX3R5cGVvZiAoYXVkaXRfc2VuZF91c2VyX21lc3NhZ2UpIGF1
ZGl0X3NlbmRfdXNlcl9tZXNzYWdlX2ludGVybmFsOyBleHRlcm4gX190eXBlb2YgKGF1ZGl0X3Nl bmRfdXNlcl9tZXNzYWdlKSBhdWRpdF9zZW5kX3VzZXJfbWVzc2FnZSBfX2FzbSAoImF1ZGl0X3Nl bmRfdXNlcl9tZXNzYWdlX2ludGVybmFsIikgX19hdHRyaWJ1dGVfXyAoKHZpc2liaWxpdHkgKCJo
aWRkZW4iKSkpOzsKZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9hZGRfd2F0Y2hfZGlyKSBhdWRpdF9h ZGRfd2F0Y2hfZGlyX2ludGVybmFsOyBleHRlcm4gX190eXBlb2YgKGF1ZGl0X2FkZF93YXRjaF9k aXIpIGF1ZGl0X2FkZF93YXRjaF9kaXIgX19hc20gKCJhdWRpdF9hZGRfd2F0Y2hfZGlyX2ludGVy
bmFsIikgX19hdHRyaWJ1dGVfXyAoKHZpc2liaWxpdHkgKCJoaWRkZW4iKSkpOzsKZXh0ZXJuIF9f dHlwZW9mIChhdWRpdF9kZXRlY3RfbWFjaGluZSkgYXVkaXRfZGV0ZWN0X21hY2hpbmVfaW50ZXJu YWw7IGV4dGVybiBfX3R5cGVvZiAoYXVkaXRfZGV0ZWN0X21hY2hpbmUpIGF1ZGl0X2RldGVjdF9t
YWNoaW5lIF9fYXNtICgiYXVkaXRfZGV0ZWN0X21hY2hpbmVfaW50ZXJuYWwiKSBfX2F0dHJpYnV0 ZV9fICgodmlzaWJpbGl0eSAoImhpZGRlbiIpKSk7OwpleHRlcm4gX190eXBlb2YgKGF1ZGl0X3Jl cXVlc3Rfc3RhdHVzKSBhdWRpdF9yZXF1ZXN0X3N0YXR1c19pbnRlcm5hbDsgZXh0ZXJuIF9fdHlw
ZW9mIChhdWRpdF9yZXF1ZXN0X3N0YXR1cykgYXVkaXRfcmVxdWVzdF9zdGF0dXMgX19hc20gKCJh dWRpdF9yZXF1ZXN0X3N0YXR1c19pbnRlcm5hbCIpIF9fYXR0cmlidXRlX18gKCh2aXNpYmlsaXR5 ICgiaGlkZGVuIikpKTs7CmV4dGVybiBfX3R5cGVvZiAoYXVkaXRfcnVsZV9zeXNjYWxsX2RhdGEp
IGF1ZGl0X3J1bGVfc3lzY2FsbF9kYXRhX2ludGVybmFsOyBleHRlcm4gX190eXBlb2YgKGF1ZGl0 X3J1bGVfc3lzY2FsbF9kYXRhKSBhdWRpdF9ydWxlX3N5c2NhbGxfZGF0YSBfX2FzbSAoImF1ZGl0 X3J1bGVfc3lzY2FsbF9kYXRhX2ludGVybmFsIikgX19hdHRyaWJ1dGVfXyAoKHZpc2liaWxpdHkg
KCJoaWRkZW4iKSkpOzsKZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9ydWxlX3N5c2NhbGxieW5hbWVf ZGF0YSkgYXVkaXRfcnVsZV9zeXNjYWxsYnluYW1lX2RhdGFfaW50ZXJuYWw7IGV4dGVybiBfX3R5 cGVvZiAoYXVkaXRfcnVsZV9zeXNjYWxsYnluYW1lX2RhdGEpIGF1ZGl0X3J1bGVfc3lzY2FsbGJ5
bmFtZV9kYXRhIF9fYXNtICgiYXVkaXRfcnVsZV9zeXNjYWxsYnluYW1lX2RhdGFfaW50ZXJuYWwi KSBfX2F0dHJpYnV0ZV9fICgodmlzaWJpbGl0eSAoImhpZGRlbiIpKSk7OwpleHRlcm4gX190eXBl b2YgKGF1ZGl0X3NldF9mZWF0dXJlKSBhdWRpdF9zZXRfZmVhdHVyZV9pbnRlcm5hbDsgZXh0ZXJu
IF9fdHlwZW9mIChhdWRpdF9zZXRfZmVhdHVyZSkgYXVkaXRfc2V0X2ZlYXR1cmUgX19hc20gKCJh dWRpdF9zZXRfZmVhdHVyZV9pbnRlcm5hbCIpIF9fYXR0cmlidXRlX18gKCh2aXNpYmlsaXR5ICgi aGlkZGVuIikpKTs7CmV4dGVybiBfX3R5cGVvZiAoYXVkaXRfcmVxdWVzdF9mZWF0dXJlcykgYXVk
aXRfcmVxdWVzdF9mZWF0dXJlc19pbnRlcm5hbDsgZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9yZXF1 ZXN0X2ZlYXR1cmVzKSBhdWRpdF9yZXF1ZXN0X2ZlYXR1cmVzIF9fYXNtICgiYXVkaXRfcmVxdWVz dF9mZWF0dXJlc19pbnRlcm5hbCIpIF9fYXR0cmlidXRlX18gKCh2aXNpYmlsaXR5ICgiaGlkZGVu
IikpKTs7CgoKZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9lbGZfdG9fbWFjaGluZSkgYXVkaXRfZWxm X3RvX21hY2hpbmVfaW50ZXJuYWw7IGV4dGVybiBfX3R5cGVvZiAoYXVkaXRfZWxmX3RvX21hY2hp bmUpIGF1ZGl0X2VsZl90b19tYWNoaW5lIF9fYXNtICgiYXVkaXRfZWxmX3RvX21hY2hpbmVfaW50
ZXJuYWwiKSBfX2F0dHJpYnV0ZV9fICgodmlzaWJpbGl0eSAoImhpZGRlbiIpKSk7OwpleHRlcm4g X190eXBlb2YgKGF1ZGl0X21hY2hpbmVfdG9fZWxmKSBhdWRpdF9tYWNoaW5lX3RvX2VsZl9pbnRl cm5hbDsgZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9tYWNoaW5lX3RvX2VsZikgYXVkaXRfbWFjaGlu
ZV90b19lbGYgX19hc20gKCJhdWRpdF9tYWNoaW5lX3RvX2VsZl9pbnRlcm5hbCIpIF9fYXR0cmli dXRlX18gKCh2aXNpYmlsaXR5ICgiaGlkZGVuIikpKTs7CmV4dGVybiBfX3R5cGVvZiAoYXVkaXRf bXNnX3R5cGVfdG9fbmFtZSkgYXVkaXRfbXNnX3R5cGVfdG9fbmFtZV9pbnRlcm5hbDsgZXh0ZXJu
IF9fdHlwZW9mIChhdWRpdF9tc2dfdHlwZV90b19uYW1lKSBhdWRpdF9tc2dfdHlwZV90b19uYW1l IF9fYXNtICgiYXVkaXRfbXNnX3R5cGVfdG9fbmFtZV9pbnRlcm5hbCIpIF9fYXR0cmlidXRlX18g KCh2aXNpYmlsaXR5ICgiaGlkZGVuIikpKTs7CmV4dGVybiBfX3R5cGVvZiAoYXVkaXRfbmFtZV90
b19lcnJubykgYXVkaXRfbmFtZV90b19lcnJub19pbnRlcm5hbDsgZXh0ZXJuIF9fdHlwZW9mIChh dWRpdF9uYW1lX3RvX2Vycm5vKSBhdWRpdF9uYW1lX3RvX2Vycm5vIF9fYXNtICgiYXVkaXRfbmFt ZV90b19lcnJub19pbnRlcm5hbCIpIF9fYXR0cmlidXRlX18gKCh2aXNpYmlsaXR5ICgiaGlkZGVu
IikpKTs7CmV4dGVybiBfX3R5cGVvZiAoYXVkaXRfbmFtZV90b19maWVsZCkgYXVkaXRfbmFtZV90 b19maWVsZF9pbnRlcm5hbDsgZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9uYW1lX3RvX2ZpZWxkKSBh dWRpdF9uYW1lX3RvX2ZpZWxkIF9fYXNtICgiYXVkaXRfbmFtZV90b19maWVsZF9pbnRlcm5hbCIp
IF9fYXR0cmlidXRlX18gKCh2aXNpYmlsaXR5ICgiaGlkZGVuIikpKTs7CmV4dGVybiBfX3R5cGVv ZiAoYXVkaXRfbmFtZV90b19tYWNoaW5lKSBhdWRpdF9uYW1lX3RvX21hY2hpbmVfaW50ZXJuYWw7 IGV4dGVybiBfX3R5cGVvZiAoYXVkaXRfbmFtZV90b19tYWNoaW5lKSBhdWRpdF9uYW1lX3RvX21h
Y2hpbmUgX19hc20gKCJhdWRpdF9uYW1lX3RvX21hY2hpbmVfaW50ZXJuYWwiKSBfX2F0dHJpYnV0 ZV9fICgodmlzaWJpbGl0eSAoImhpZGRlbiIpKSk7OwpleHRlcm4gX190eXBlb2YgKGF1ZGl0X25h bWVfdG9fbXNnX3R5cGUpIGF1ZGl0X25hbWVfdG9fbXNnX3R5cGVfaW50ZXJuYWw7IGV4dGVybiBf
X3R5cGVvZiAoYXVkaXRfbmFtZV90b19tc2dfdHlwZSkgYXVkaXRfbmFtZV90b19tc2dfdHlwZSBf X2FzbSAoImF1ZGl0X25hbWVfdG9fbXNnX3R5cGVfaW50ZXJuYWwiKSBfX2F0dHJpYnV0ZV9fICgo dmlzaWJpbGl0eSAoImhpZGRlbiIpKSk7OwpleHRlcm4gX190eXBlb2YgKGF1ZGl0X25hbWVfdG9f
c3lzY2FsbCkgYXVkaXRfbmFtZV90b19zeXNjYWxsX2ludGVybmFsOyBleHRlcm4gX190eXBlb2Yg KGF1ZGl0X25hbWVfdG9fc3lzY2FsbCkgYXVkaXRfbmFtZV90b19zeXNjYWxsIF9fYXNtICgiYXVk aXRfbmFtZV90b19zeXNjYWxsX2ludGVybmFsIikgX19hdHRyaWJ1dGVfXyAoKHZpc2liaWxpdHkg
KCJoaWRkZW4iKSkpOzsKZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9vcGVyYXRvcl90b19zeW1ib2wp IGF1ZGl0X29wZXJhdG9yX3RvX3N5bWJvbF9pbnRlcm5hbDsgZXh0ZXJuIF9fdHlwZW9mIChhdWRp dF9vcGVyYXRvcl90b19zeW1ib2wpIGF1ZGl0X29wZXJhdG9yX3RvX3N5bWJvbCBfX2FzbSAoImF1
ZGl0X29wZXJhdG9yX3RvX3N5bWJvbF9pbnRlcm5hbCIpIF9fYXR0cmlidXRlX18gKCh2aXNpYmls aXR5ICgiaGlkZGVuIikpKTs7CmV4dGVybiBfX3R5cGVvZiAoYXVkaXRfbmFtZV90b19mdHlwZSkg YXVkaXRfbmFtZV90b19mdHlwZV9pbnRlcm5hbDsgZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9uYW1l
X3RvX2Z0eXBlKSBhdWRpdF9uYW1lX3RvX2Z0eXBlIF9fYXNtICgiYXVkaXRfbmFtZV90b19mdHlw ZV9pbnRlcm5hbCIpIF9fYXR0cmlidXRlX18gKCh2aXNpYmlsaXR5ICgiaGlkZGVuIikpKTs7CgoK ZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9nZXRfcmVwbHkpIGF1ZGl0X2dldF9yZXBseV9pbnRlcm5h
bDsgZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9nZXRfcmVwbHkpIGF1ZGl0X2dldF9yZXBseSBfX2Fz bSAoImF1ZGl0X2dldF9yZXBseV9pbnRlcm5hbCIpIF9fYXR0cmlidXRlX18gKCh2aXNpYmlsaXR5 ICgiaGlkZGVuIikpKTs7CmV4dGVybiBfX3R5cGVvZiAoYXVkaXRfc2VuZCkgYXVkaXRfc2VuZF9p
bnRlcm5hbDsgZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9zZW5kKSBhdWRpdF9zZW5kIF9fYXNtICgi YXVkaXRfc2VuZF9pbnRlcm5hbCIpIF9fYXR0cmlidXRlX18gKCh2aXNpYmlsaXR5ICgiaGlkZGVu IikpKTsKCgpleHRlcm4gX190eXBlb2YgKGF1ZGl0X21zZykgYXVkaXRfbXNnX2ludGVybmFsOyBl
eHRlcm4gX190eXBlb2YgKGF1ZGl0X21zZykgYXVkaXRfbXNnIF9fYXNtICgiYXVkaXRfbXNnX2lu dGVybmFsIikgX19hdHRyaWJ1dGVfXyAoKHZpc2liaWxpdHkgKCJoaWRkZW4iKSkpOwoKCmNoYXIg KmF1ZGl0X3N0cnNwbGl0X3IoY2hhciAqcywgY2hhciAqKnNhdmVkcHApOwpjaGFyICphdWRpdF9z
dHJzcGxpdChjaGFyICpzKTsKZXh0ZXJuIF9fdHlwZW9mIChhdWRpdF9zdHJzcGxpdF9yKSBhdWRp dF9zdHJzcGxpdF9yX2ludGVybmFsOyBleHRlcm4gX190eXBlb2YgKGF1ZGl0X3N0cnNwbGl0X3Ip IGF1ZGl0X3N0cnNwbGl0X3IgX19hc20gKCJhdWRpdF9zdHJzcGxpdF9yX2ludGVybmFsIikgX19h
dHRyaWJ1dGVfXyAoKHZpc2liaWxpdHkgKCJoaWRkZW4iKSkpOwpleHRlcm4gX190eXBlb2YgKGF1 ZGl0X3N0cnNwbGl0KSBhdWRpdF9zdHJzcGxpdF9pbnRlcm5hbDsgZXh0ZXJuIF9fdHlwZW9mIChh dWRpdF9zdHJzcGxpdCkgYXVkaXRfc3Ryc3BsaXQgX19hc20gKCJhdWRpdF9zdHJzcGxpdF9pbnRl
cm5hbCIpIF9fYXR0cmlidXRlX18gKCh2aXNpYmlsaXR5ICgiaGlkZGVuIikpKTsKIyAzNSAibmV0 bGluay5jIiAyCgoKCgoKc3RhdGljIGludCBhZGp1c3RfcmVwbHkoc3RydWN0IGF1ZGl0X3JlcGx5 ICpyZXAsIGludCBsZW4pOwpzdGF0aWMgaW50IGNoZWNrX2FjayhpbnQgZmQsIGludCBzZXEpOwoK
CgoKCgoKaW50IGF1ZGl0X29wZW4odm9pZCkKewogaW50IHNhdmVkX2Vycm5vOwogaW50IGZkID0g c29ja2V0KAojIDUyICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgICAgICAgMTYKIyA1MiAibmV0 bGluay5jIgogICAgICAgICAgICAgICAgICAgICAgICAgICwgCiMgNTIgIm5ldGxpbmsuYyIgMyA0
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTT0NLX1JBVwojIDUyICJuZXRsaW5rLmMiCiAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgCiMgNTIgIm5ldGxpbmsuYyIgMyA0 CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOQojIDUyICJuZXRsaW5rLmMi
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7Cgog aWYgKGZkIDwgMCkgewogIHNhdmVkX2Vycm5vID0gCiMgNTUgIm5ldGxpbmsuYyIgMyA0CiAgICAg ICAgICAgICAgICgqX19lcnJub19sb2NhdGlvbiAoKSkKIyA1NSAibmV0bGluay5jIgogICAgICAg
ICAgICAgICAgICAgIDsKICBpZiAoCiMgNTYgIm5ldGxpbmsuYyIgMyA0CiAgICAgKCpfX2Vycm5v X2xvY2F0aW9uICgpKSAKIyA1NiAibmV0bGluay5jIgogICAgICAgICAgID09IAojIDU2ICJuZXRs aW5rLmMiIDMgNAogICAgICAgICAgICAgIDIyIAojIDU2ICJuZXRsaW5rLmMiCiAgICAgICAgICAg
ICAgICAgICAgIHx8IAojIDU2ICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgICAgICAgICAgICAg ICAoKl9fZXJybm9fbG9jYXRpb24gKCkpIAojIDU2ICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgID09IAojIDU2ICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICA5MyAKIyA1NiAibmV0bGluay5jIgogICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwKICAgIAojIDU3ICJuZXRsaW5rLmMiIDMg NAogICAoKl9fZXJybm9fbG9jYXRpb24gKCkpIAojIDU3ICJuZXRsaW5rLmMiCiAgICAgICAgID09
IAojIDU3ICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgICA5NwojIDU3ICJuZXRsaW5rLmMiCiAg ICAgICAgICAgICAgICAgICAgICAgICkKICAgYXVkaXRfbXNnKAojIDU4ICJuZXRsaW5rLmMiIDMg NAogICAgICAgICAgICAzCiMgNTggIm5ldGxpbmsuYyIKICAgICAgICAgICAgICAgICAgICwKICAg
ICJFcnJvciAtIGF1ZGl0IHN1cHBvcnQgbm90IGluIGtlcm5lbCIpOwogIGVsc2UKICAgYXVkaXRf bXNnKAojIDYxICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgICAzCiMgNjEgIm5ldGxpbmsuYyIK ICAgICAgICAgICAgICAgICAgICwKICAgICJFcnJvciBvcGVuaW5nIGF1ZGl0IG5ldGxpbmsgc29j
a2V0ICglcykiLAogICAgc3RyZXJyb3IoCiMgNjMgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAgICAg ICgqX19lcnJub19sb2NhdGlvbiAoKSkKIyA2MyAibmV0bGluay5jIgogICAgICAgICAgICAgICAg ICkpOwogIAojIDY0ICJuZXRsaW5rLmMiIDMgNAogKCpfX2Vycm5vX2xvY2F0aW9uICgpKSAKIyA2
NCAibmV0bGluay5jIgogICAgICAgPSBzYXZlZF9lcnJubzsKICByZXR1cm4gZmQ7CiB9CiBpZiAo ZmNudGwoZmQsIAojIDY3ICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgICAgIDIKIyA2NyAibmV0 bGluay5jIgogICAgICAgICAgICAgICAgICAgICAsIAojIDY3ICJuZXRsaW5rLmMiIDMgNAogICAg
ICAgICAgICAgICAgICAgICAgIDEKIyA2NyAibmV0bGluay5jIgogICAgICAgICAgICAgICAgICAg ICAgICAgICAgICAgICApID09IC0xKSB7CiAgc2F2ZWRfZXJybm8gPSAKIyA2OCAibmV0bGluay5j IiAzIDQKICAgICAgICAgICAgICAgKCpfX2Vycm5vX2xvY2F0aW9uICgpKQojIDY4ICJuZXRsaW5r
LmMiCiAgICAgICAgICAgICAgICAgICAgOwogIGNsb3NlKGZkKTsKICBhdWRpdF9tc2coCiMgNzAg Im5ldGxpbmsuYyIgMyA0CiAgICAgICAgICAgMwojIDcwICJuZXRsaW5rLmMiCiAgICAgICAgICAg ICAgICAgICwKICAgIkVycm9yIHNldHRpbmcgYXVkaXQgbmV0bGluayBzb2NrZXQgQ0xPRVhFQyBm
bGFnICglcykiLAogICBzdHJlcnJvcigKIyA3MiAibmV0bGluay5jIiAzIDQKICAgICAgICAgICAo Kl9fZXJybm9fbG9jYXRpb24gKCkpCiMgNzIgIm5ldGxpbmsuYyIKICAgICAgICAgICAgICAgICkp OwogIAojIDczICJuZXRsaW5rLmMiIDMgNAogKCpfX2Vycm5vX2xvY2F0aW9uICgpKSAKIyA3MyAi
bmV0bGluay5jIgogICAgICAgPSBzYXZlZF9lcnJubzsKICByZXR1cm4gLTE7CiB9CiByZXR1cm4g ZmQ7Cn0KCgp2b2lkIGF1ZGl0X2Nsb3NlKGludCBmZCkKewogaWYgKGZkID49IDApCiAgY2xvc2Uo ZmQpOwp9CgoKCgoKCmludCBhdWRpdF9nZXRfcmVwbHkoaW50IGZkLCBzdHJ1Y3QgYXVkaXRfcmVw
bHkgKnJlcCwgcmVwbHlfdCBibG9jaywgaW50IHBlZWspCnsKIGludCBsZW47CiBzdHJ1Y3Qgc29j a2FkZHJfbmwgbmxhZGRyOwogc29ja2xlbl90IG5sYWRkcmxlbiA9IHNpemVvZihubGFkZHIpOwoK IGlmIChmZCA8IDApCiAgcmV0dXJuIC0KIyA5OCAibmV0bGluay5jIiAzIDQKICAgICAgICAgOQoj
IDk4ICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgOwoKIGlmIChibG9jayA9PSBHRVRfUkVQTFlf Tk9OQkxPQ0tJTkcpCiAgYmxvY2sgPSAKIyAxMDEgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAgIE1T R19ET05UV0FJVAojIDEwMSAibmV0bGluay5jIgogICAgICAgICAgICAgICAgICAgICA7CgpyZXRy
eToKIGxlbiA9IHJlY3Zmcm9tKGZkLCAmcmVwLT5tc2csIHNpemVvZihyZXAtPm1zZyksIGJsb2Nr fHBlZWssCiAgKHN0cnVjdCBzb2NrYWRkciopJm5sYWRkciwgJm5sYWRkcmxlbik7CgogaWYgKGxl biA8IDApIHsKICBpZiAoCiMgMTA4ICJuZXRsaW5rLmMiIDMgNAogICAgICgqX19lcnJub19sb2Nh
dGlvbiAoKSkgCiMgMTA4ICJuZXRsaW5rLmMiCiAgICAgICAgICAgPT0gCiMgMTA4ICJuZXRsaW5r LmMiIDMgNAogICAgICAgICAgICAgIDQKIyAxMDggIm5ldGxpbmsuYyIKICAgICAgICAgICAgICAg ICAgICkKICAgZ290byByZXRyeTsKICBpZiAoCiMgMTEwICJuZXRsaW5rLmMiIDMgNAogICAgICgq
X19lcnJub19sb2NhdGlvbiAoKSkgCiMgMTEwICJuZXRsaW5rLmMiCiAgICAgICAgICAgIT0gCiMg MTEwICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgICAgIDExCiMgMTEwICJuZXRsaW5rLmMiCiAg ICAgICAgICAgICAgICAgICAgKSB7CiAgIGludCBzYXZlZF9lcnJubyA9IAojIDExMSAibmV0bGlu
ay5jIiAzIDQKICAgICAgICAgICAgICAgICAgICAoKl9fZXJybm9fbG9jYXRpb24gKCkpCiMgMTEx ICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAgICAgICA7CiAgIGF1ZGl0X21zZygKIyAx MTIgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAgICAgIDMKIyAxMTIgIm5ldGxpbmsuYyIKICAgICAg
ICAgICAgICAgICAgICwKICAgICJFcnJvciByZWNlaXZpbmcgYXVkaXQgbmV0bGluayBwYWNrZXQg KCVzKSIsCiAgICBzdHJlcnJvcigKIyAxMTQgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAgICAgICgq X19lcnJub19sb2NhdGlvbiAoKSkKIyAxMTQgIm5ldGxpbmsuYyIKICAgICAgICAgICAgICAgICAp
KTsKICAgCiMgMTE1ICJuZXRsaW5rLmMiIDMgNAogICgqX19lcnJub19sb2NhdGlvbiAoKSkgCiMg MTE1ICJuZXRsaW5rLmMiCiAgICAgICAgPSBzYXZlZF9lcnJubzsKICB9CiAgcmV0dXJuIC0KIyAx MTcgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAgICgqX19lcnJub19sb2NhdGlvbiAoKSkKIyAxMTcg
Im5ldGxpbmsuYyIKICAgICAgICAgICAgICA7CiB9CiBpZiAobmxhZGRybGVuICE9IHNpemVvZihu bGFkZHIpKSB7CiAgYXVkaXRfbXNnKAojIDEyMCAibmV0bGluay5jIiAzIDQKICAgICAgICAgICAz CiMgMTIwICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICwKICAgIkJhZCBhZGRyZXNzIHNp
emUgcmVhZGluZyBhdWRpdCBuZXRsaW5rIHNvY2tldCIpOwogIHJldHVybiAtCiMgMTIyICJuZXRs aW5rLmMiIDMgNAogICAgICAgICA3MQojIDEyMiAibmV0bGluay5jIgogICAgICAgICAgICAgICA7 CiB9CiBpZiAobmxhZGRyLm5sX3BpZCkgewogIGF1ZGl0X21zZygKIyAxMjUgIm5ldGxpbmsuYyIg
MyA0CiAgICAgICAgICAgMwojIDEyNSAibmV0bGluay5jIgogICAgICAgICAgICAgICAgICAsCiAg ICJTcG9vZmVkIHBhY2tldCByZWNlaXZlZCBvbiBhdWRpdCBuZXRsaW5rIHNvY2tldCIpOwogIHJl dHVybiAtCiMgMTI3ICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAyMgojIDEyNyAibmV0bGluay5j
IgogICAgICAgICAgICAgICA7CiB9CgogbGVuID0gYWRqdXN0X3JlcGx5KHJlcCwgbGVuKTsKIGlm IChsZW4gPT0gMCkKICBsZW4gPSAtCiMgMTMyICJuZXRsaW5rLmMiIDMgNAogICAgICAgICgqX19l cnJub19sb2NhdGlvbiAoKSkKIyAxMzIgIm5ldGxpbmsuYyIKICAgICAgICAgICAgIDsKIHJldHVy
biBsZW47Cn0KYXNtICgiLmdsb2JsICIgImF1ZGl0X2dldF9yZXBseSIgIlxuLnNldCAiICJhdWRp dF9nZXRfcmVwbHkiICIsICIgImF1ZGl0X2dldF9yZXBseSIgIl9pbnRlcm5hbCIpOwoKCgoKCl9f YXR0cmlidXRlX18oKG9wdGltaXplKCgiTzEiKSkpKSBzdGF0aWMgaW50IGFkanVzdF9yZXBseShz
dHJ1Y3QgYXVkaXRfcmVwbHkgKnJlcCwgaW50IGxlbikKewogcmVwLT50eXBlID0gcmVwLT5tc2cu bmxoLm5sbXNnX3R5cGU7CiByZXAtPmxlbiA9IHJlcC0+bXNnLm5saC5ubG1zZ19sZW47CiByZXAt Pm5saCA9ICZyZXAtPm1zZy5ubGg7CiByZXAtPnN0YXR1cyA9IAojIDE0NiAibmV0bGluay5jIiAz
IDQKICAgICAgICAgICAgICAgICgodm9pZCAqKTApCiMgMTQ2ICJuZXRsaW5rLmMiCiAgICAgICAg ICAgICAgICAgICAgOwogcmVwLT5ydWxlZGF0YSA9IAojIDE0NyAibmV0bGluay5jIiAzIDQKICAg ICAgICAgICAgICAgICgodm9pZCAqKTApCiMgMTQ3ICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAg
ICAgICAgOwogcmVwLT5sb2dpbiA9IAojIDE0OCAibmV0bGluay5jIiAzIDQKICAgICAgICAgICAg ICAgICgodm9pZCAqKTApCiMgMTQ4ICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAgOwog cmVwLT5tZXNzYWdlID0gCiMgMTQ5ICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgICAgICAgKCh2
b2lkICopMCkKIyAxNDkgIm5ldGxpbmsuYyIKICAgICAgICAgICAgICAgICAgICA7CiByZXAtPmVy cm9yID0gCiMgMTUwICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgICAgICAgKCh2b2lkICopMCkK IyAxNTAgIm5ldGxpbmsuYyIKICAgICAgICAgICAgICAgICAgICA7CiByZXAtPnNpZ25hbF9pbmZv
ID0gCiMgMTUxICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgICAgICAgICAgKCh2b2lkICopMCkK IyAxNTEgIm5ldGxpbmsuYyIKICAgICAgICAgICAgICAgICAgICAgICA7CiByZXAtPmNvbmYgPSAK IyAxNTIgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAgICAgICAgICAoKHZvaWQgKikwKQojIDE1MiAi
bmV0bGluay5jIgogICAgICAgICAgICAgICAgICAgIDsKCiByZXAtPmZlYXR1cmVzID0gCiMgMTU0 ICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgICAgICAgKCh2b2lkICopMCkKIyAxNTQgIm5ldGxp bmsuYyIKICAgICAgICAgICAgICAgICAgICA7CgogaWYgKCEKIyAxNTYgIm5ldGxpbmsuYyIgMyA0
CiAgICAgKCgKIyAxNTYgIm5ldGxpbmsuYyIKICAgICAodW5zaWduZWQgaW50KWxlbgojIDE1NiAi bmV0bGluay5jIiAzIDQKICAgICApID49IChpbnQpc2l6ZW9mKHN0cnVjdCBubG1zZ2hkcikgJiYg KAojIDE1NiAibmV0bGluay5jIgogICAgIHJlcC0+bmxoCiMgMTU2ICJuZXRsaW5rLmMiIDMgNAog
ICAgICktPm5sbXNnX2xlbiA+PSBzaXplb2Yoc3RydWN0IG5sbXNnaGRyKSAmJiAoCiMgMTU2ICJu ZXRsaW5rLmMiCiAgICAgcmVwLT5ubGgKIyAxNTYgIm5ldGxpbmsuYyIgMyA0CiAgICAgKS0+bmxt c2dfbGVuIDw9ICgKIyAxNTYgIm5ldGxpbmsuYyIKICAgICAodW5zaWduZWQgaW50KWxlbgojIDE1
NiAibmV0bGluay5jIiAzIDQKICAgICApKQojIDE1NiAibmV0bGluay5jIgogICAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgICApIHsKICBpZiAobGVuID09IHNpemVvZihyZXAt Pm1zZykpIHsKICAgYXVkaXRfbXNnKAojIDE1OCAibmV0bGluay5jIiAzIDQKICAgICAgICAgICAg
MwojIDE1OCAibmV0bGluay5jIgogICAgICAgICAgICAgICAgICAgLAogICAgIk5ldGxpbmsgZXZl bnQgZnJvbSBrZXJuZWwgaXMgdG9vIGJpZyIpOwogICAKIyAxNjAgIm5ldGxpbmsuYyIgMyA0CiAg KCpfX2Vycm5vX2xvY2F0aW9uICgpKSAKIyAxNjAgIm5ldGxpbmsuYyIKICAgICAgICA9IAojIDE2
MCAibmV0bGluay5jIiAzIDQKICAgICAgICAgIDI3CiMgMTYwICJuZXRsaW5rLmMiCiAgICAgICAg ICAgICAgIDsKICB9IGVsc2UgewogICBhdWRpdF9tc2coCiMgMTYyICJuZXRsaW5rLmMiIDMgNAog ICAgICAgICAgICAzCiMgMTYyICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAsCiAgICJO
ZXRsaW5rIG1lc3NhZ2UgZnJvbSBrZXJuZWwgd2FzIG5vdCBPSyIpOwogICAKIyAxNjQgIm5ldGxp bmsuYyIgMyA0CiAgKCpfX2Vycm5vX2xvY2F0aW9uICgpKSAKIyAxNjQgIm5ldGxpbmsuYyIKICAg ICAgICA9IAojIDE2NCAibmV0bGluay5jIiAzIDQKICAgICAgICAgIDUyCiMgMTY0ICJuZXRsaW5r
LmMiCiAgICAgICAgICAgICAgIDsKICB9CiAgcmV0dXJuIDA7CiB9CgoKCiBzd2l0Y2ggKHJlcC0+ dHlwZSkgewogIGNhc2UgCiMgMTcyICJuZXRsaW5rLmMiIDMgNAogICAgICAweDIKIyAxNzIgIm5l dGxpbmsuYyIKICAgICAgICAgICAgICAgICA6CiAgIHJlcC0+ZXJyb3IgPSAKIyAxNzMgIm5ldGxp
bmsuYyIgMyA0CiAgICAgICAgICAgICAgICAgKCh2b2lkKikoKChjaGFyKikKIyAxNzMgIm5ldGxp bmsuYyIKICAgICAgICAgICAgICAgICByZXAtPm5saAojIDE3MyAibmV0bGluay5jIiAzIDQKICAg ICAgICAgICAgICAgICApICsgKCgwKSArICgoaW50KSAoICgoc2l6ZW9mKHN0cnVjdCBubG1zZ2hk
cikpKzRVIC0xKSAmIH4oNFUgLTEpICkpKSkpCiMgMTczICJuZXRsaW5rLmMiCiAgICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICA7CiAgIGJyZWFrOwogIGNhc2UgCiMgMTc1ICJuZXRs aW5rLmMiIDMgNAogICAgICAxMDAwCiMgMTc1ICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgIDoK
ICAgcmVwLT5zdGF0dXMgPSAKIyAxNzYgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAgICAgICAgICAg KCh2b2lkKikoKChjaGFyKikKIyAxNzYgIm5ldGxpbmsuYyIKICAgICAgICAgICAgICAgICByZXAt Pm5saAojIDE3NiAibmV0bGluay5jIiAzIDQKICAgICAgICAgICAgICAgICApICsgKCgwKSArICgo
aW50KSAoICgoc2l6ZW9mKHN0cnVjdCBubG1zZ2hkcikpKzRVIC0xKSAmIH4oNFUgLTEpICkpKSkp CiMgMTc2ICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7 CiAgIGJyZWFrOwoKICBjYXNlIAojIDE3OSAibmV0bGluay5jIiAzIDQKICAgICAgMTAxOQojIDE3
OSAibmV0bGluay5jIgogICAgICAgICAgICAgICAgICAgICAgIDoKICAgcmVwLT5mZWF0dXJlcyA9 IAojIDE4MCAibmV0bGluay5jIiAzIDQKICAgICAgICAgICAgICAgICAgICgodm9pZCopKCgoY2hh ciopCiMgMTgwICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICByZXAtPm5saAojIDE4MCAi
bmV0bGluay5jIiAzIDQKICAgICAgICAgICAgICAgICAgICkgKyAoKDApICsgKChpbnQpICggKChz aXplb2Yoc3RydWN0IG5sbXNnaGRyKSkrNFUgLTEpICYgfig0VSAtMSkgKSkpKSkKIyAxODAgIm5l dGxpbmsuYyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwogICBicmVh
azsKCiAgY2FzZSAKIyAxODMgIm5ldGxpbmsuYyIgMyA0CiAgICAgIDEwMTMKIyAxODMgIm5ldGxp bmsuYyIKICAgICAgICAgICAgICAgICAgICAgIDoKICAgcmVwLT5ydWxlZGF0YSA9IAojIDE4NCAi bmV0bGluay5jIiAzIDQKICAgICAgICAgICAgICAgICAgKCh2b2lkKikoKChjaGFyKikKIyAxODQg
Im5ldGxpbmsuYyIKICAgICAgICAgICAgICAgICAgcmVwLT5ubGgKIyAxODQgIm5ldGxpbmsuYyIg MyA0CiAgICAgICAgICAgICAgICAgICkgKyAoKDApICsgKChpbnQpICggKChzaXplb2Yoc3RydWN0 IG5sbXNnaGRyKSkrNFUgLTEpICYgfig0VSAtMSkgKSkpKSkKIyAxODQgIm5ldGxpbmsuYyIKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CiAgIGJyZWFrOwogIGNhc2UgCiMg MTg2ICJuZXRsaW5rLmMiIDMgNAogICAgICAxMDA1CiMgMTg2ICJuZXRsaW5rLmMiCiAgICAgICAg ICAgICAgICA6CiAgY2FzZSAKIyAxODcgIm5ldGxpbmsuYyIgMyA0CiAgICAgIDEwMDYKIyAxODcg
Im5ldGxpbmsuYyIKICAgICAgICAgICAgICAgICA6CiAgY2FzZSAKIyAxODggIm5ldGxpbmsuYyIg MyA0CiAgICAgIDIwMDAKIyAxODggIm5ldGxpbmsuYyIKICAgICAgICAgICAgICAgICAgOgogIGNh c2UgMTEwMCAuLi4xMTk5OgogIGNhc2UgCiMgMTkwICJuZXRsaW5rLmMiIDMgNAogICAgICAyMTAw
CiMgMTkwICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLgojIDE5MCAi bmV0bGluay5jIiAzIDQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMjk5OQojIDE5MCAi bmV0bGluay5jIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIDoKICBjYXNlIDEzMDAgLi4uMTg5OToKICAgcmVwLT5tZXNzYWdlID0gCiMgMTkyICJuZXRs aW5rLmMiIDMgNAogICAgICAgICAgICAgICAgICgodm9pZCopKCgoY2hhciopCiMgMTkyICJuZXRs aW5rLmMiCiAgICAgICAgICAgICAgICAgcmVwLT5ubGgKIyAxOTIgIm5ldGxpbmsuYyIgMyA0CiAg
ICAgICAgICAgICAgICAgKSArICgoMCkgKyAoKGludCkgKCAoKHNpemVvZihzdHJ1Y3Qgbmxtc2do ZHIpKSs0VSAtMSkgJiB+KDRVIC0xKSApKSkpKQojIDE5MiAibmV0bGluay5jIgogICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgICAgICAgOwogICBicmVhazsKICBjYXNlIAojIDE5NCAibmV0
bGluay5jIiAzIDQKICAgICAgMTAxMAojIDE5NCAibmV0bGluay5jIgogICAgICAgICAgICAgICAg ICAgICAgIDoKICAgcmVwLT5zaWduYWxfaW5mbyA9IAojIDE5NSAibmV0bGluay5jIiAzIDQKICAg ICAgICAgICAgICAgICAgICAgKCh2b2lkKikoKChjaGFyKikKIyAxOTUgIm5ldGxpbmsuYyIKICAg
ICAgICAgICAgICAgICAgICAgcmVwLT5ubGgKIyAxOTUgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAg ICAgICAgICAgICAgICkgKyAoKDApICsgKChpbnQpICggKChzaXplb2Yoc3RydWN0IG5sbXNnaGRy KSkrNFUgLTEpICYgfig0VSAtMSkgKSkpKSkKIyAxOTUgIm5ldGxpbmsuYyIKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CiAgIGJyZWFrOwogfQogcmV0dXJuIGxlbjsK fQoKCgoKCgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnQgYXVkaXRf c2VuZChpbnQgZmQsIGludCB0eXBlLCBjb25zdCB2b2lkICpkYXRhLCB1bnNpZ25lZCBpbnQgc2l6
ZSkKewogc3RhdGljIGludCBzZXF1ZW5jZSA9IDA7CiBzdHJ1Y3QgYXVkaXRfbWVzc2FnZSByZXE7 CiBpbnQgcmV0dmFsOwogc3RydWN0IHNvY2thZGRyX25sIGFkZHI7CgoKCiBpZiAoZmQgPCAwKSB7 CiAgCiMgMjE3ICJuZXRsaW5rLmMiIDMgNAogKCpfX2Vycm5vX2xvY2F0aW9uICgpKSAKIyAyMTcg
Im5ldGxpbmsuYyIKICAgICAgID0gCiMgMjE3ICJuZXRsaW5rLmMiIDMgNAogICAgICAgICA5CiMg MjE3ICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgOwogIHJldHVybiAtCiMgMjE4ICJuZXRsaW5r LmMiIDMgNAogICAgICAgICAoKl9fZXJybm9fbG9jYXRpb24gKCkpCiMgMjE4ICJuZXRsaW5rLmMi
CiAgICAgICAgICAgICAgOwogfQoKIGlmICgKIyAyMjEgIm5ldGxpbmsuYyIgMyA0CiAgICAoICgo KCgKIyAyMjEgIm5ldGxpbmsuYyIKICAgIHNpemUKIyAyMjEgIm5ldGxpbmsuYyIgMyA0CiAgICAp ICsgKChpbnQpICggKChzaXplb2Yoc3RydWN0IG5sbXNnaGRyKSkrNFUgLTEpICYgfig0VSAtMSkg
KSkpKSs0VSAtMSkgJiB+KDRVIC0xKSApIAojIDIyMSAibmV0bGluay5jIgogICAgICAgICAgICAg ICAgICAgICAgPiA4OTcwKSB7CiAgCiMgMjIyICJuZXRsaW5rLmMiIDMgNAogKCpfX2Vycm5vX2xv Y2F0aW9uICgpKSAKIyAyMjIgIm5ldGxpbmsuYyIKICAgICAgID0gCiMgMjIyICJuZXRsaW5rLmMi
IDMgNAogICAgICAgICAyMgojIDIyMiAibmV0bGluay5jIgogICAgICAgICAgICAgICA7CiAgcmV0 dXJuIC0KIyAyMjMgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAgICgqX19lcnJub19sb2NhdGlvbiAo KSkKIyAyMjMgIm5ldGxpbmsuYyIKICAgICAgICAgICAgICA7CiB9CgogaWYgKCsrc2VxdWVuY2Ug
PCAwKQogIHNlcXVlbmNlID0gMTsKCiBtZW1zZXQoJnJlcSwgMCwgc2l6ZW9mKHJlcSkpOwogcmVx Lm5saC5ubG1zZ19sZW4gPSAKIyAyMzAgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAgICAgICAgICAg ICAgKCAoKCgoCiMgMjMwICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAgc2l6ZQojIDIz
MCAibmV0bGluay5jIiAzIDQKICAgICAgICAgICAgICAgICAgICApICsgKChpbnQpICggKChzaXpl b2Yoc3RydWN0IG5sbXNnaGRyKSkrNFUgLTEpICYgfig0VSAtMSkgKSkpKSs0VSAtMSkgJiB+KDRV IC0xKSApCiMgMjMwICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICA7CiByZXEubmxoLm5sbXNnX3R5cGUgPSB0eXBlOwogcmVxLm5saC5ubG1zZ19mbGFncyA9 IAojIDIzMiAibmV0bGluay5jIiAzIDQKICAgICAgICAgICAgICAgICAgICAgIDEKIyAyMzIgIm5l dGxpbmsuYyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8CiMgMjMyICJuZXRs
aW5rLmMiIDMgNAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA0CiMgMjMyICJu ZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsK IHJlcS5ubGgubmxtc2dfc2VxID0gc2VxdWVuY2U7CiBpZiAoc2l6ZSAmJiBkYXRhKQogIG1lbWNw
eSgKIyAyMzUgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAgKCh2b2lkKikoKChjaGFyKikKIyAyMzUg Im5ldGxpbmsuYyIKICAgICAgICAmcmVxLm5saAojIDIzNSAibmV0bGluay5jIiAzIDQKICAgICAg ICApICsgKCgwKSArICgoaW50KSAoICgoc2l6ZW9mKHN0cnVjdCBubG1zZ2hkcikpKzRVIC0xKSAm
IH4oNFUgLTEpICkpKSkpCiMgMjM1ICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAgICAg ICAgICAsIGRhdGEsIHNpemUpOwogbWVtc2V0KCZhZGRyLCAwLCBzaXplb2YoYWRkcikpOwogYWRk ci5ubF9mYW1pbHkgPSAKIyAyMzcgIm5ldGxpbmsuYyIgMyA0CiAgICAgICAgICAgICAgICAgMTYK
IyAyMzcgIm5ldGxpbmsuYyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgOwogYWRkci5ubF9w aWQgPSAwOwogYWRkci5ubF9ncm91cHMgPSAwOwoKIGRvIHsKICByZXR2YWwgPSBzZW5kdG8oZmQs ICZyZXEsIHJlcS5ubGgubmxtc2dfbGVuLCAwLAogICAoc3RydWN0IHNvY2thZGRyKikmYWRkciwg
c2l6ZW9mKGFkZHIpKTsKIH0gd2hpbGUgKHJldHZhbCA8IDAgJiYgCiMgMjQ0ICJuZXRsaW5rLmMi IDMgNAogICAgICAgICAgICAgICAgICAgICAgICgqX19lcnJub19sb2NhdGlvbiAoKSkgCiMgMjQ0 ICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPT0gCiMgMjQ0ICJuZXRs
aW5rLmMiIDMgNAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDQKIyAyNDQgIm5ldGxp bmsuYyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7CiBpZiAocmV0dmFs ID09IChpbnQpcmVxLm5saC5ubG1zZ19sZW4pIHsKICBpZiAoKHJldHZhbCA9IGNoZWNrX2Fjayhm
ZCwgc2VxdWVuY2UpKSA9PSAwKQogICByZXR1cm4gc2VxdWVuY2U7CiAgZWxzZQogICByZXR1cm4g cmV0dmFsOwogfQogaWYgKHJldHZhbCA8IDApCiAgcmV0dXJuIC0KIyAyNTIgIm5ldGxpbmsuYyIg MyA0CiAgICAgICAgICgqX19lcnJub19sb2NhdGlvbiAoKSkKIyAyNTIgIm5ldGxpbmsuYyIKICAg
ICAgICAgICAgICA7CgogcmV0dXJuIDA7Cn0KYXNtICgiLmdsb2JsICIgImF1ZGl0X3NlbmQiICJc bi5zZXQgIiAiYXVkaXRfc2VuZCIgIiwgIiAiYXVkaXRfc2VuZCIgIl9pbnRlcm5hbCIpOwoKCgoK CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRpYyBpbnQgY2hlY2tf
YWNrKGludCBmZCwgaW50IHNlcSkKewogaW50IHJjLCByZXRyaWVzID0gODA7CiBzdHJ1Y3QgYXVk aXRfcmVwbHkgcmVwOwogc3RydWN0IHBvbGxmZCBwZmRbMV07CgpyZXRyeToKIHBmZFswXS5mZCA9 IGZkOwogcGZkWzBdLmV2ZW50cyA9IAojIDI3MSAibmV0bGluay5jIiAzIDQKICAgICAgICAgICAg
ICAgIDB4MDAxCiMgMjcxICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAgICA7CiBkbyB7 CiAgcmMgPSBwb2xsKHBmZCwgMSwgNTAwKTsKIH0gd2hpbGUgKHJjIDwgMCAmJiAKIyAyNzQgIm5l dGxpbmsuYyIgMyA0CiAgICAgICAgICAgICAgICAgICAoKl9fZXJybm9fbG9jYXRpb24gKCkpIAoj
IDI3NCAibmV0bGluay5jIgogICAgICAgICAgICAgICAgICAgICAgICAgPT0gCiMgMjc0ICJuZXRs aW5rLmMiIDMgNAogICAgICAgICAgICAgICAgICAgICAgICAgICAgNAojIDI3NCAibmV0bGluay5j IgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwoKCgoKCiByYyA9IGF1ZGl0X2dl
dF9yZXBseShmZCwgJnJlcCwgR0VUX1JFUExZX05PTkJMT0NLSU5HLCAKIyAyODAgIm5ldGxpbmsu YyIgMyA0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg ICAgIE1TR19QRUVLCiMgMjgwICJuZXRsaW5rLmMiCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTsKIGlmIChyYyA9PSAtCiMgMjgx ICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAgIDExIAojIDI4MSAibmV0bGluay5jIgogICAgICAg ICAgICAgICAgICAmJiByZXRyaWVzKSB7CiAgcmV0cmllcy0tOwogIGdvdG8gcmV0cnk7CiB9IGVs
c2UgaWYgKHJjIDwgMCkKICByZXR1cm4gcmM7CiBlbHNlIGlmIChyYyA9PSAwKQogIHJldHVybiAt CiMgMjg3ICJuZXRsaW5rLmMiIDMgNAogICAgICAgICAyMgojIDI4NyAibmV0bGluay5jIgogICAg ICAgICAgICAgICA7CiBlbHNlIGlmIChyYyA+IDAgJiYgcmVwLnR5cGUgPT0gCiMgMjg4ICJuZXRs
aW5rLmMiIDMgNAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMHgyCiMgMjg4ICJuZXRs aW5rLmMiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgewogIGlu dCBlcnJvciA9IHJlcC5lcnJvci0+ZXJyb3I7CgogICh2b2lkKWF1ZGl0X2dldF9yZXBseShmZCwg
JnJlcCwgR0VUX1JFUExZX05PTkJMT0NLSU5HLCAwKTsKCgogIGlmIChlcnJvcikgewogICAKIyAy OTUgIm5ldGxpbmsuYyIgMyA0CiAgKCpfX2Vycm5vX2xvY2F0aW9uICgpKSAKIyAyOTUgIm5ldGxp bmsuYyIKICAgICAgICA9IC1lcnJvcjsKICAgcmV0dXJuIGVycm9yOwogIH0KIH0KIHJldHVybiAw Owp9Cg==
</data>

</attachment>

</bug>

</bugzilla>
