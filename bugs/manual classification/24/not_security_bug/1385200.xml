<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1" urlbase="https://bugzilla.redhat.com/" maintainer="bugzilla-error-list@redhat.com">

  <bug>
    <bug_id>1385200</bug_id>

    <creation_ts>2016-10-15 01:44:00 -0400</creation_ts>
    <short_desc>libimobiledevice/usbmuxd fails with new version of GnuTLS</short_desc>
    <delta_ts>2016-12-20 01:22:32 -0500</delta_ts>
    <reporter_accessible>1</reporter_accessible>
    <cclist_accessible>1</cclist_accessible>
    <classification_id>2</classification_id>
    <classification>Fedora</classification>
    <product>Fedora</product>
    <component>libimobiledevice</component>
    <version>24</version>
    <rep_platform>All</rep_platform>
    <op_sys>Linux</op_sys>
    <bug_status>CLOSED</bug_status>
    <resolution>ERRATA</resolution>

    <bug_file_loc></bug_file_loc>
    <status_whiteboard></status_whiteboard>
    <keywords></keywords>
    <priority>unspecified</priority>
    <bug_severity>unspecified</bug_severity>
    <target_milestone>---</target_milestone>

    <everconfirmed>1</everconfirmed>
    <reporter>rosenp</reporter>
    <assigned_to name="Peter Robinson">pbrobinson</assigned_to>
    <cc>cfergeau</cc>

    <cc>ehedgren</cc>

    <cc>nmavrogi</cc>

    <cc>pbrobinson</cc>
    <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>

    <cf_fixed_in>libimobiledevice-1.2.0-8.fc24</cf_fixed_in>
  <cf_doc_type>If docs needed, set a value</cf_doc_type>
<cf_release_notes></cf_release_notes>
<cf_story_points>---</cf_story_points>

<cf_environment></cf_environment>
<cf_last_closed>2016-12-20 01:22:32</cf_last_closed>
<cf_type>Bug</cf_type>
<cf_regression_status>---</cf_regression_status>
<cf_mount_type>---</cf_mount_type>
<cf_documentation_action>---</cf_documentation_action>
<cf_crm></cf_crm>
<cf_verified_branch></cf_verified_branch>
<cf_category>---</cf_category>
<cf_ovirt_team>---</cf_ovirt_team>

<cf_cloudforms_team>---</cf_cloudforms_team>

<target_release>---</target_release>

<votes>0</votes>

<comment_sort_order>oldest_to_newest</comment_sort_order>
<long_desc isprivate="0">
<commentid>9794121</commentid>
<comment_count>0</comment_count>
<who name="">rosenp</who>
<bug_when>2016-10-15 01:44:09 -0400</bug_when>
<thetext>Description of problem: Once I upgrade my version of GnuTLS, I can no longer have any iOS mounts under GVFS. Well, everything except MTP breaks actually. I think the reason has to do with SSLv3 being disabled at compile time. Version-Release
number of selected component (if applicable): last working version seems to be 3.4.12-1 How reproducible: Always Steps to Reproduce: 1. Connect an iOS device Actual results: Nothing except MTP gets mounted Expected results: AFC stuff gets mounted.
Additional info: Upstream has fixed this so a patch is needed in the meantime. Patch is here: https://github.com/libimobiledevice/libimobiledevice/commit/72643b2b83990b9cf97cc84b285b30763d44a72d Another solution would be to switch to OpenSSL and
backport this patch: https://github.com/libimobiledevice/libimobiledevice/commit/13bf235cac2201747de11652cf14fe2714ca0718</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9859943</commentid>
<comment_count>1</comment_count>
<who name="Nikos Mavrogiannopoulos">nmavrogi</who>
<bug_when>2016-11-04 02:50:53 -0400</bug_when>
<thetext>Note that there are multiple issues concerning that. The following patch is also required to be applied: https://github.com/libimobiledevice/libimobiledevice/commit/23069d10341ce637fdad7321d447c53752dba48c</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9861083</commentid>
<comment_count>2</comment_count>
<who name="Peter Robinson">pbrobinson</who>
<bug_when>2016-11-04 05:07:51 -0400</bug_when>
<thetext>I&apos;ll look at this shortly, will likely move to openssl</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9861109</commentid>
<comment_count>3</comment_count>
<who name="Nikos Mavrogiannopoulos">nmavrogi</who>
<bug_when>2016-11-04 05:09:59 -0400</bug_when>
<thetext>(In reply to Peter Robinson from comment #2) &gt; I&apos;ll look at this shortly, will likely move to openssl Please don&apos;t, if you cannot apply the patches please accept my commit access and I&apos;ll look into it.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9861845</commentid>
<comment_count>4</comment_count>
<who name="Peter Robinson">pbrobinson</who>
<bug_when>2016-11-04 09:16:24 -0400</bug_when>
<thetext>
&gt; Please don&apos;t Please don&apos;t do what? Please be specific.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9862089</commentid>
<comment_count>5</comment_count>
<who name="Nikos Mavrogiannopoulos">nmavrogi</who>
<bug_when>2016-11-04 10:19:45 -0400</bug_when>
<thetext>don&apos;t switch to openssl</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9862183</commentid>
<comment_count>6</comment_count>
<who name="Peter Robinson">pbrobinson</who>
<bug_when>2016-11-04 10:39:07 -0400</bug_when>
<thetext>(In reply to Nikos Mavrogiannopoulos from comment #5) &gt; don&apos;t switch to openssl why? as I said before please be specific</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9862248</commentid>
<comment_count>7</comment_count>
<who name="Nikos Mavrogiannopoulos">nmavrogi</who>
<bug_when>2016-11-04 10:51:39 -0400</bug_when>
<thetext>I think I was specific. If you want a reason for my suggestion is because I am the maintainer of gnutls and I would like to verify that the upstream fix works.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9862297</commentid>
<comment_count>8</comment_count>
<who name="Peter Robinson">pbrobinson</who>
<bug_when>2016-11-04 11:03:40 -0400</bug_when>
<thetext>(In reply to Nikos Mavrogiannopoulos from comment #7) &gt; I think I was specific. If you want a reason for my suggestion is because I &gt; am the maintainer of gnutls and I would like to verify that the upstream fix &gt; works. I&apos;m
sorry all you said was &quot;don&apos;t switch to openssl&quot; without any reason as to why. That is NOT specific! The problem I have found with gnutls, and I&apos;ve been considering this change for some time, is it doesn&apos;t have a stable API
and randomly breaks stuff like this forcing things to unnecessarily pull in patches mid-stream to fix those issues. Literally everytime! I originally moved from openssl as I wasn&apos;t convinced of it&apos;s security, since heartbleed this has
improved and they have the actual ability to communicate changes in API with proper details rather than just randomly breaking shit.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9862350</commentid>
<comment_count>9</comment_count>
<who name="Nikos Mavrogiannopoulos">nmavrogi</who>
<bug_when>2016-11-04 11:20:06 -0400</bug_when>
<thetext>(In reply to Peter Robinson from comment #8) &gt; (In reply to Nikos Mavrogiannopoulos from comment #7) &gt; &gt; I think I was specific. If you want a reason for my suggestion is because I &gt; &gt; am the maintainer of gnutls and I would
like to verify that the upstream fix &gt; &gt; works. &gt; I&apos;m sorry all you said was &quot;don&apos;t switch to openssl&quot; without any reason as &gt; to why. That is NOT specific! &gt; The problem I have found with gnutls, and I&apos;ve been
considering this change &gt; for some time, is it doesn&apos;t have a stable API and randomly breaks stuff &gt; like this forcing things to unnecessarily pull in patches mid-stream to fix &gt; those issues. Literally everytime! While there have been
ABI changes, the API hasn&apos;t changed for several years. What has changed though is thorough checking of input parameters (IMO a good thing), and that&apos;s what broke libimobiledevice. Unfortunately the libimobiledevice gnutls support was not
very well written (as seen in the patches above). Notice that the patches above, enable TLS 1.0 (which exists since 1996), introduce error checking (which was not there) and fix wrong use of the API (such as setting invalid RSA keys). So for that
particular case the gnutls API is unchanged but the introduced sanity checks to prevent applications from using invalid keys broke libimobile lib. I could help improving that by reviewing the upstream code, if you keep that support. &gt; I originally
moved from openssl as I &gt; wasn&apos;t convinced of it&apos;s security, since heartbleed this has improved and &gt; they have the actual ability to communicate changes in API with proper &gt; details rather than just randomly breaking shit. Both
are C libraries and I wouldn&apos;t try to make statements that one is more secure than the others. Such issues like heartbleed could happen to C libraries, but note that both libraries have had such issues found once in a decade or so. So
security-wise I would say that both are equivalent or at least not far from each other.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9952083</commentid>
<comment_count>10</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2016-12-02 12:46:15 -0500</bug_when>
<thetext>libimobiledevice-1.2.0-8.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-e9b731e067</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9953059</commentid>
<comment_count>11</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2016-12-03 00:43:47 -0500</bug_when>
<thetext>libimobiledevice-1.2.0-8.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report. See https://fedoraproject.org/wiki/QA:Updates_Testing for instructions on how to install
test updates. You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-e9b731e067</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10000923</commentid>
<comment_count>12</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2016-12-20 01:22:32 -0500</bug_when>
<thetext>libimobiledevice-1.2.0-8.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
</long_desc>

</bug>

</bugzilla>
