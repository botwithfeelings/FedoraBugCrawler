<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1" urlbase="https://bugzilla.redhat.com/" maintainer="bugzilla-error-list@redhat.com">

  <bug>
    <bug_id>888755</bug_id>

    <creation_ts>2012-12-19 07:23:00 -0500</creation_ts>
    <short_desc>mod_dav_svn: unrestricted internal XML entities expansion</short_desc>
    <delta_ts>2017-01-03 06:59:53 -0500</delta_ts>
    <reporter_accessible>1</reporter_accessible>
    <cclist_accessible>1</cclist_accessible>
    <classification_id>2</classification_id>
    <classification>Fedora</classification>
    <product>Fedora</product>
    <component>subversion</component>
    <version>25</version>
    <rep_platform>Unspecified</rep_platform>
    <op_sys>Unspecified</op_sys>
    <bug_status>MODIFIED</bug_status>
    <resolution></resolution>

    <bug_file_loc></bug_file_loc>
    <status_whiteboard></status_whiteboard>
    <keywords>Reopened, Security</keywords>
    <priority>unspecified</priority>
    <bug_severity>unspecified</bug_severity>
    <target_milestone>---</target_milestone>

    <blocked>888729</blocked>
    <everconfirmed>1</everconfirmed>
    <reporter name="Florian Weimer">fweimer</reporter>
    <assigned_to name="Joe Orton">jorton</assigned_to>
    <cc>dmoppert</cc>

    <cc>fweimer</cc>

    <cc>jorton</cc>

    <cc>security-response-team</cc>
    <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>

    <cf_fixed_in>subversion-1.9.5-1.fc25</cf_fixed_in>
  <cf_doc_type>Bug Fix</cf_doc_type>
<cf_release_notes></cf_release_notes>
<cf_story_points>---</cf_story_points>

<cf_environment></cf_environment>
<cf_last_closed>2016-01-26 04:33:38</cf_last_closed>
<cf_type>Bug</cf_type>
<cf_regression_status>---</cf_regression_status>
<cf_mount_type>---</cf_mount_type>
<cf_documentation_action>---</cf_documentation_action>
<cf_crm></cf_crm>
<cf_verified_branch></cf_verified_branch>
<cf_category>---</cf_category>
<cf_ovirt_team>---</cf_ovirt_team>

<cf_cloudforms_team>---</cf_cloudforms_team>
<external_bugs name="Apache JIRA">SVN-4630</external_bugs>

<target_release>---</target_release>

<votes>0</votes>

<comment_sort_order>oldest_to_newest</comment_sort_order>
<long_desc isprivate="0">
<commentid>5302263</commentid>
<comment_count>0</comment_count>
<who name="Florian Weimer">fweimer</who>
<bug_when>2012-12-19 07:23:11 -0500</bug_when>
<thetext>In subversion 1.7.7 in tools/server-side/mod_dontdothat/mod_dontdothat.c, there is the following code: ctx-&gt;xmlp = XML_ParserCreate(NULL); apr_pool_cleanup_register(r-&gt;pool, ctx-&gt;xmlp, clean_up_parser, apr_pool_cleanup_null);
XML_SetUserData(ctx-&gt;xmlp, ctx); XML_SetElementHandler(ctx-&gt;xmlp, start_element, end_element); XML_SetCharacterDataHandler(ctx-&gt;xmlp, cdata); This doesn&apos;t disable entity expansion for the internal DTD subset, so there is a
denial-of-service vector (&quot;billion laughs attack&quot;). I&apos;m marking this as a security bug because it probably allows to crash Apache or trigger the kernel OOM handler. This should probably be fixed in coordination with Subversion
upstream. Adding the following handler using XML_SetEntityDeclHandler(ctx-&gt;xmlp, EntityDeclHandler); should be sufficient to address this issue. // Stop the parser when an entity declaration is encountered. static void EntityDeclHandler(void
*userData, const XML_Char *entityName, int is_parameter_entity, const XML_Char *value, int value_length, const XML_Char *base, const XML_Char *systemId, const XML_Char *publicId, const XML_Char *notationName) { XML_StopParser((XML_Parser)userData,
XML_FALSE); }</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>5302269</commentid>
<comment_count>1</comment_count>
<who name="Florian Weimer">fweimer</who>
<bug_when>2012-12-19 07:24:22 -0500</bug_when>
<thetext>The Expat parser creation in subversion/libsvn_ra_serf/util.c and subversion/libsvn_subr/xml.c should be fixed as well, but these are in the client-side code (I think), and therefore less of a security concern.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>8936937</commentid>
<comment_count>2</comment_count>
<who name="Jan Kurik">jkurik</who>
<bug_when>2015-12-22 06:34:53 -0500</bug_when>
<thetext>This bug is currently assigned to an unsupported release. If you think this bug is still valid and should remain open, please re-assign it to a supported release (F22, F23) or to rawhide. Bugs which will be assigned to an unsupported release
are going to be closed as EOL (End Of Life) on January 26th, 2016.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9262751</commentid>
<comment_count>3</comment_count>
<who name="Florian Weimer">fweimer</who>
<bug_when>2016-04-23 11:51:55 -0400</bug_when>
<thetext>Still present in rawhide.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9302393</commentid>
<comment_count>4</comment_count>
<who name="Peter Robinson">pbrobinson</who>
<bug_when>2016-05-08 12:53:18 -0400</bug_when>
<thetext>Florian is there a patch for this issue?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9303223</commentid>
<comment_count>5</comment_count>
<who name="Florian Weimer">fweimer</who>
<bug_when>2016-05-09 03:41:54 -0400</bug_when>
<thetext>(In reply to Peter Robinson from comment #4) &gt; Florian is there a patch for this issue? I don&apos;t think so. I reported it upstream here because I wasn&apos;t able to file a JIRA issue:
&lt;https://mail-archives.apache.org/mod_mbox/subversion-dev/201604.mbox/%3C87h9ernqse.fsf@mid.deneb.enyo.de%3E&gt; Apache JIRA has been opened up again, so I filed a proper JIRA issue for this.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9549235</commentid>
<comment_count>6</comment_count>
<who name="Jan Kurik">jkurik</who>
<bug_when>2016-07-26 00:26:15 -0400</bug_when>
<thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 25 development cycle. Changing version to &apos;25&apos;.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10023572</commentid>
<comment_count>7</comment_count>
<who name="Doran Moppert">dmoppert</who>
<bug_when>2016-12-29 00:39:26 -0500</bug_when>
<thetext>This flaw was assigned CVE-2016-8734 which now has tracking bug 1399871.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10028114</commentid>
<comment_count>8</comment_count>
<who name="Joe Orton">jorton</who>
<bug_when>2017-01-02 08:23:33 -0500</bug_when>
<thetext>Commit: http://pkgs.fedoraproject.org/gitweb/?p=subversion.git;a=commitdiff;h=8b7160d5aea4d96c746b58621c52fd05382b959f</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10030280</commentid>
<comment_count>9</comment_count>
<who name="Joe Orton">jorton</who>
<bug_when>2017-01-03 06:59:53 -0500</bug_when>
<thetext>Package: subversion-1.9.5-1.fc25 Build: https://koji.fedoraproject.org/koji/buildinfo?buildID=830879</thetext>
</long_desc>

</bug>

</bugzilla>
