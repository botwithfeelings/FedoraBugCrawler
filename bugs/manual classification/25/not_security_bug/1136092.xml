<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1" urlbase="https://bugzilla.redhat.com/" maintainer="bugzilla-error-list@redhat.com">

  <bug>
    <bug_id>1136092</bug_id>

    <creation_ts>2014-09-01 12:41:00 -0400</creation_ts>
    <short_desc>SELinux is preventing php-fpm from &apos;create&apos; accesses on the directory gavrilovmv.</short_desc>
    <delta_ts>2016-10-03 06:57:11 -0400</delta_ts>
    <reporter_accessible>1</reporter_accessible>
    <cclist_accessible>1</cclist_accessible>
    <classification_id>2</classification_id>
    <classification>Fedora</classification>
    <product>Fedora</product>
    <component>selinux-policy</component>
    <version>25</version>
    <rep_platform>x86_64</rep_platform>
    <op_sys>Unspecified</op_sys>
    <bug_status>CLOSED</bug_status>
    <resolution>WONTFIX</resolution>

    <bug_file_loc></bug_file_loc>
    <status_whiteboard>abrt_hash:83bb3d006793f056e4afff66fe45ca36dc99902be33b90bab0be23402502449a</status_whiteboard>
    <keywords></keywords>
    <priority>unspecified</priority>
    <bug_severity>unspecified</bug_severity>
    <target_milestone>---</target_milestone>

    <everconfirmed>1</everconfirmed>
    <reporter name="Mikhail">mikhail.v.gavrilov</reporter>
    <assigned_to name="Lukas Vrabec">lvrabec</assigned_to>
    <cc>dominick.grift</cc>

    <cc>dwalsh</cc>

    <cc>lvrabec</cc>

    <cc>mgrepl</cc>

    <cc>mikhail.v.gavrilov</cc>
    <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>

    <cf_fixed_in></cf_fixed_in>
  <cf_doc_type>Bug Fix</cf_doc_type>
<cf_release_notes></cf_release_notes>
<cf_story_points>---</cf_story_points>

<cf_environment></cf_environment>
<cf_last_closed>2015-12-01 22:40:24</cf_last_closed>
<cf_type>---</cf_type>
<cf_regression_status>---</cf_regression_status>
<cf_mount_type>---</cf_mount_type>
<cf_documentation_action>---</cf_documentation_action>
<cf_crm></cf_crm>
<cf_verified_branch></cf_verified_branch>
<cf_category>---</cf_category>
<cf_ovirt_team>---</cf_ovirt_team>

<cf_cloudforms_team>---</cf_cloudforms_team>

<target_release>---</target_release>

<votes>0</votes>

<comment_sort_order>oldest_to_newest</comment_sort_order>
<long_desc isprivate="0">
<commentid>7436606</commentid>
<comment_count>0</comment_count>
<who name="Mikhail">mikhail.v.gavrilov</who>
<bug_when>2014-09-01 12:41:41 -0400</bug_when>
<thetext>Description of problem: Very strange php can create and write files, but can&apos;t create directories.... Why? SELinux is preventing php-fpm from &apos;create&apos; accesses on the directory gavrilovmv. ***** Plugin catchall_boolean (89.3
confidence) suggests ****************** If you want to allow httpd to unified Then you must tell SELinux about this by enabling the &apos;httpd_unified&apos; boolean. You can read &apos;None&apos; man page for more details. Do setsebool -P
httpd_unified 1 ***** Plugin catchall (11.6 confidence) suggests ************************** If you believe that php-fpm should be allowed create access on the gavrilovmv directory by default. Then you should report this as a bug. You can generate a
local policy module to allow this access. Do allow this access for now by executing: # grep php-fpm /var/log/audit/audit.log | audit2allow -M mypol # semodule -i mypol.pp Additional Information: Source Context system_u:system_r:httpd_t:s0 Target
Context system_u:object_r:httpd_user_ra_content_t:s0 Target Objects gavrilovmv [ dir ] Source php-fpm Source Path php-fpm Port &lt;Unknown&gt; Host (removed) Source RPM Packages Target RPM Packages Policy RPM selinux-policy-3.13.1-77.fc21.noarch
Selinux Enabled True Policy Type targeted Enforcing Mode Enforcing Host Name (removed) Platform Linux (removed) 3.16.1-301.fc21.x86_64 #1 SMP Mon Aug 25 13:06:39 UTC 2014 x86_64 x86_64 Alert Count 8 First Seen 2014-09-01 22:39:08 YEKT Last Seen
2014-09-01 22:39:08 YEKT Local ID 31b5708d-1463-42fe-a85e-35101245fde6 Raw Audit Messages type=AVC msg=audit(1409589548.525:2303): avc: denied { create } for pid=10238 comm=&quot;php-fpm&quot; name=&quot;gavrilovmv&quot;
scontext=system_u:system_r:httpd_t:s0 tcontext=system_u:object_r:httpd_user_ra_content_t:s0 tclass=dir permissive=0 Hash: php-fpm,httpd_t,httpd_user_ra_content_t,dir,create Version-Release number of selected component:
selinux-policy-3.13.1-77.fc21.noarch Additional info: reporter: libreport-2.2.3 hashmarkername: setroubleshoot kernel: 3.16.1-301.fc21.x86_64 type: libreport Potential duplicate: bug 927371</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>7442536</commentid>
<comment_count>1</comment_count>
<who name="Daniel Walsh">dwalsh</who>
<bug_when>2014-09-03 06:05:34 -0400</bug_when>
<thetext>You want to allow apache to create directories in a label that it is only allowed to append to?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>7443676</commentid>
<comment_count>2</comment_count>
<who name="Mikhail">mikhail.v.gavrilov</who>
<bug_when>2014-09-03 10:30:34 -0400</bug_when>
<thetext>(In reply to Daniel Walsh from comment #1) &gt; You want to allow apache to create directories in a label that it is only &gt; allowed to append to? yes. $ ls -Z ~/www/bpl-syrena/logs/ -rw-r--r--. mikhail mikhail
system_u:object_r:httpd_user_ra_content_t:s0 boroda.log -rw-r--r--. mikhail mikhail system_u:object_r:httpd_user_ra_content_t:s0 compositor.log -rw-r--r--. mikhail mikhail system_u:object_r:httpd_user_ra_content_t:s0 error.log -rw-r--r--. mikhail
mikhail system_u:object_r:httpd_user_ra_content_t:s0 get_auth_source.log -rw-r--r--. mikhail mikhail system_u:object_r:httpd_user_ra_content_t:s0 run.log -rw-r--r--. mikhail mikhail system_u:object_r:httpd_user_ra_content_t:s0 sql.log $ ls -Zd
~/www/bpl-syrena/logs drwxr-xr-x. mikhail mikhail unconfined_u:object_r:httpd_user_ra_content_t:s0 /home/mikhail/www/bpl-syrena/logs I think if directory have object_r:httpd_user_ra_content_t and allow write and append files, why do we restrict
recursive directory creation in this directory?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>7756167</commentid>
<comment_count>3</comment_count>
<who name="Lukas Vrabec">lvrabec</who>
<bug_when>2014-12-11 12:28:11 -0500</bug_when>
<thetext>Why you need this?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>7756330</commentid>
<comment_count>4</comment_count>
<who name="Mikhail">mikhail.v.gavrilov</who>
<bug_when>2014-12-11 13:22:02 -0500</bug_when>
<thetext>(In reply to Lukas Vrabec from comment #3) &gt; Why you need this? Very convenient to store logs for each user in a separate folder. And I think we can found find many cases when php application needed create folders. For example
optimization storing uploaded files.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>8789266</commentid>
<comment_count>5</comment_count>
<who name="Fedora End Of Life">jkurik</who>
<bug_when>2015-11-04 09:44:32 -0500</bug_when>
<thetext>This message is a reminder that Fedora 21 is nearing its end of life. Approximately 4 (four) weeks from now Fedora will stop maintaining and issuing updates for Fedora 21. It is Fedora&apos;s policy to close all bug reports from releases
that are no longer maintained. At that time this bug will be closed as EOL if it remains open with a Fedora &apos;version&apos; of &apos;21&apos;. Package Maintainer: If you wish for this bug to remain open because you plan to fix it in a currently
maintained version, simply change the &apos;version&apos; to a later Fedora version. Thank you for reporting this issue and we are sorry that we were not able to fix it before Fedora 21 is end of life. If you would still like to see this bug fixed
and are able to reproduce it against a later version of Fedora, you are encouraged change the &apos;version&apos; to a later Fedora version prior this bug is closed as described in the policy above. Although we aim to fix as many bugs as possible
during every release&apos;s lifetime, sometimes those efforts are overtaken by events. Often a more recent Fedora release includes newer upstream software that fixes bugs or makes them obsolete.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>8876482</commentid>
<comment_count>6</comment_count>
<who name="Fedora End Of Life">jkurik</who>
<bug_when>2015-12-01 22:40:27 -0500</bug_when>
<thetext>Fedora 21 changed to end-of-life (EOL) status on 2015-12-01. Fedora 21 is no longer maintained, which means that it will not receive any further security or bug fix updates. As a result we are closing this bug. If you can reproduce this bug
against a currently maintained version of Fedora please feel free to reopen this bug against that version. If you are unable to reopen this bug, please file a new report against the current release. If you experience problems, please add a comment to
this bug. Thank you for reporting this bug and we are sorry it could not be fixed.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9760681</commentid>
<comment_count>7</comment_count>
<who name="Lukas Vrabec">lvrabec</who>
<bug_when>2016-10-03 06:57:03 -0400</bug_when>
<thetext>You reported this issue also on F25. Closing this issue as WONTFIX. You can create own module to fix this issue, more info: https://lvrabec-selinux.rhcloud.com/2016/09/19/creating-local-module-quickly-in-cil/</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9760683</commentid>
<comment_count>8</comment_count>
<who name="Lukas Vrabec">lvrabec</who>
<bug_when>2016-10-03 06:57:11 -0400</bug_when>
<thetext>*** Bug 1380937 has been marked as a duplicate of this bug. ***</thetext>
</long_desc>

</bug>

</bugzilla>
