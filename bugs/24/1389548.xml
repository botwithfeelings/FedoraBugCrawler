<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1389548</bug_id>
          
          <creation_ts>2016-10-27 16:41:00 -0400</creation_ts>
          <short_desc>AX88179 - connection freezes after large send</short_desc>
          <delta_ts>2017-01-24 13:49:26 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>kernel</component>
          <version>24</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>CURRENTRELEASE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>urgent</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>mvrk</reporter>
          <assigned_to name="Kernel Maintainer List">kernel-maint</assigned_to>
          <cc>gansalmon</cc>
    
    
    <cc>ichavero</cc>
    
    
    <cc>itamar</cc>
    
    
    <cc>jonathan</cc>
    
    
    <cc>kernel-maint</cc>
    
    
    <cc>labbott</cc>
    
    
    <cc>madhu.chinakonda</cc>
    
    
    <cc>mchehab</cc>
    
    
    <cc>mvrk</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-01-24 13:49:26</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9827928</commentid>
    <comment_count>0</comment_count>
    <who name="">mvrk</who>
    <bug_when>2016-10-27 16:41:22 -0400</bug_when>
    <thetext>Hi, 

every time i do a big network transfer my connection just freezes.

Ex: send file to nfs share
    test with iperf

The interface doesn&apos;t go down, it stays up but drops all packets

I can&apos;t see anything on logs.

Hardware/Software:

HP Omen 15-5100np
AX88179 USB 3.0 (0b95:1790 ASIX Electronics Corp. AX88179 Gigabit Ethernet) 
Kernel 4.7.9-200.fc24.x86_64


Tests:

[root@ghost ~]# iperf -f M -i 5 -t 15 -c 192.168.0.10
------------------------------------------------------------
Client connecting to 192.168.0.10, TCP port 5001
TCP window size: 0.08 MByte (default)
------------------------------------------------------------
[  3] local 192.168.0.69 port 60188 connected with 192.168.0.10 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 5.0 sec   549 MBytes   110 MBytes/sec
[  3]  5.0-10.0 sec   549 MBytes   110 MBytes/sec
[  3] 10.0-15.0 sec   549 MBytes   110 MBytes/sec
[  3]  0.0-15.0 sec  1647 MBytes   110 MBytes/sec

[root@ghost ~]# iperf -f M -i 5 -t 15 -c 192.168.0.10
------------------------------------------------------------
Client connecting to 192.168.0.10, TCP port 5001
TCP window size: 0.08 MByte (default)
------------------------------------------------------------
[  3] local 192.168.0.69 port 60196 connected with 192.168.0.10 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 5.0 sec  6.28 MBytes  1.26 MBytes/sec
[  3]  5.0-10.0 sec  0.00 MBytes  0.00 MBytes/sec
[  3] 10.0-15.0 sec  0.00 MBytes  0.00 MBytes/sec
[  3]  0.0-15.1 sec  6.28 MBytes  0.42 MBytes/sec

[root@ghost ~]# ping 8.8.8.8
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
^C
--- 8.8.8.8 ping statistics ---
20 packets transmitted, 0 received, 100% packet loss, time 18999ms

[root@ghost ~]# rmmod ax88179_178a; modprobe ax88179_178a
[root@ghost ~]# ping 8.8.8.8
PING 8.8.8.8 (8.8.8.8) 56(84) bytes of data.
64 bytes from 8.8.8.8: icmp_seq=1 ttl=56 time=9.93 ms
64 bytes from 8.8.8.8: icmp_seq=2 ttl=56 time=10.0 ms
64 bytes from 8.8.8.8: icmp_seq=3 ttl=56 time=10.4 ms
^C
--- 8.8.8.8 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2002ms
rtt min/avg/max/mdev = 9.934/10.141/10.474/0.237 ms

During the pings i see the dropped packets increasing:

[root@ghost ~]# ifconfig enp0s20u5
enp0s20u5: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.0.69  netmask 255.255.255.0  broadcast 192.168.0.255
        inet6 fe80::213:3bff:fe9a:3ba3  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 00:13:3b:9a:3b:a3  txqueuelen 1000  (Ethernet)
        RX packets 87926  bytes 5316161 (5.0 MiB)
        RX errors 1  dropped 0  overruns 0  frame 0
        TX packets 1198343  bytes 1822134718 (1.6 GiB)
        TX errors 739  dropped 0 overruns 0  carrier 0  collisions 0

[root@ghost ~]# ifconfig enp0s20u5
enp0s20u5: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.0.69  netmask 255.255.255.0  broadcast 192.168.0.255
        inet6 fe80::213:3bff:fe9a:3ba3  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 00:13:3b:9a:3b:a3  txqueuelen 1000  (Ethernet)
        RX packets 87926  bytes 5316161 (5.0 MiB)
        RX errors 1  dropped 0  overruns 0  frame 0
        TX packets 1198343  bytes 1822134718 (1.6 GiB)
        TX errors 749  dropped 0 overruns 0  carrier 0  collisions 0

[root@ghost ~]# ifconfig enp0s20u5
enp0s20u5: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500
        inet 192.168.0.69  netmask 255.255.255.0  broadcast 192.168.0.255
        inet6 fe80::213:3bff:fe9a:3ba3  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 00:13:3b:9a:3b:a3  txqueuelen 1000  (Ethernet)
        RX packets 87926  bytes 5316161 (5.0 MiB)
        RX errors 1  dropped 0  overruns 0  frame 0
        TX packets 1198343  bytes 1822134718 (1.6 GiB)
        TX errors 750  dropped 0 overruns 0  carrier 0  collisions 0</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9828029</commentid>
    <comment_count>1</comment_count>
    <who name="">mvrk</who>
    <bug_when>2016-10-27 17:43:08 -0400</bug_when>
    <thetext>One other thing, it seems the problem only occurs when sending data, when receiving i doesn&apos;t seem to hang, i runned iperf for 120s using my laptop as server and was ok:

[root@san ~]# iperf -f M -i 5 -t 120 -c 192.168.0.69
------------------------------------------------------------
Client connecting to 192.168.0.69, TCP port 5001
TCP window size: 0.08 MByte (default)
------------------------------------------------------------
[  3] local 192.168.0.10 port 57792 connected with 192.168.0.69 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 5.0 sec   563 MBytes   113 MBytes/sec
[  3]  5.0-10.0 sec   559 MBytes   112 MBytes/sec
[  3] 10.0-15.0 sec   561 MBytes   112 MBytes/sec
[  3] 15.0-20.0 sec   560 MBytes   112 MBytes/sec
[  3] 20.0-25.0 sec   560 MBytes   112 MBytes/sec
[  3] 25.0-30.0 sec   560 MBytes   112 MBytes/sec
[  3] 30.0-35.0 sec   561 MBytes   112 MBytes/sec
[  3] 35.0-40.0 sec   562 MBytes   112 MBytes/sec
[  3] 40.0-45.0 sec   562 MBytes   112 MBytes/sec
[  3] 45.0-50.0 sec   560 MBytes   112 MBytes/sec
[  3] 50.0-55.0 sec   559 MBytes   112 MBytes/sec
[  3] 55.0-60.0 sec   561 MBytes   112 MBytes/sec
[  3] 60.0-65.0 sec   561 MBytes   112 MBytes/sec
[  3] 65.0-70.0 sec   561 MBytes   112 MBytes/sec
[  3] 70.0-75.0 sec   561 MBytes   112 MBytes/sec
[  3] 75.0-80.0 sec   561 MBytes   112 MBytes/sec
[  3] 80.0-85.0 sec   561 MBytes   112 MBytes/sec
[  3] 85.0-90.0 sec   560 MBytes   112 MBytes/sec
[  3] 90.0-95.0 sec   561 MBytes   112 MBytes/sec
[  3] 95.0-100.0 sec   561 MBytes   112 MBytes/sec
[  3] 100.0-105.0 sec   560 MBytes   112 MBytes/sec
[  3] 105.0-110.0 sec   561 MBytes   112 MBytes/sec
[  3] 110.0-115.0 sec   561 MBytes   112 MBytes/sec
[  3] 115.0-120.0 sec   561 MBytes   112 MBytes/sec
[  3]  0.0-120.0 sec  13457 MBytes   112 MBytes/sec</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9977997</commentid>
    <comment_count>2</comment_count>
    <who name="">mvrk</who>
    <bug_when>2016-12-12 14:01:26 -0500</bug_when>
    <thetext>Hi,

I just updated to F25, and now i don&apos;t have crashes, but the speed went down by half, i can&apos;t have more then 41 MB/s:

[root@ghost ~]# iperf -f M -i 5 -t 120 -c 192.168.0.10
------------------------------------------------------------
Client connecting to 192.168.0.10, TCP port 5001
TCP window size: 0.08 MByte (default)
------------------------------------------------------------
[  3] local 192.168.0.69 port 52302 connected with 192.168.0.10 port 5001
[ ID] Interval       Transfer     Bandwidth
[  3]  0.0- 5.0 sec   209 MBytes  41.8 MBytes/sec
[  3]  5.0-10.0 sec   210 MBytes  41.9 MBytes/sec
[  3] 10.0-15.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 15.0-20.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 20.0-25.0 sec   209 MBytes  41.9 MBytes/sec
[  3] 25.0-30.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 30.0-35.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 35.0-40.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 40.0-45.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 45.0-50.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 50.0-55.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 55.0-60.0 sec   209 MBytes  41.9 MBytes/sec
[  3] 60.0-65.0 sec   211 MBytes  42.1 MBytes/sec
[  3] 65.0-70.0 sec   209 MBytes  41.9 MBytes/sec
[  3] 70.0-75.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 75.0-80.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 80.0-85.0 sec   210 MBytes  41.9 MBytes/sec
[  3] 85.0-90.0 sec   210 MBytes  42.0 MBytes/sec
[  3] 90.0-95.0 sec   210 MBytes  42.0 MBytes/sec
[  3] 95.0-100.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 100.0-105.0 sec   210 MBytes  41.9 MBytes/sec
[  3] 105.0-110.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 110.0-115.0 sec   209 MBytes  41.8 MBytes/sec
[  3] 115.0-120.0 sec   209 MBytes  41.8 MBytes/sec
[  3]  0.0-120.0 sec  5022 MBytes  41.8 MBytes/sec</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10089818</commentid>
    <comment_count>3</comment_count>
    <who name="">mvrk</who>
    <bug_when>2017-01-23 13:52:27 -0500</bug_when>
    <thetext>Hi, the problem still exists in F25 after all, on previous comment i mentioned it didn&apos;t freeze anymore but the speed has cut by half, but this happened because i enabled &quot;Legacy Boot Mode&quot; in my BIOS.

Now with legacy mode disabled, i get the same problem again, it freezes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10089830</commentid>
    <comment_count>4</comment_count>
    <who name="">mvrk</who>
    <bug_when>2017-01-23 13:57:25 -0500</bug_when>
    <thetext>Another information, i start to think the problem maybe with the USB controller and not the USB network card.

I just tried with another card:

Bus 002 Device 003: ID 0bda:8153 Realtek Semiconductor Corp. (r8152)

And the connection also freezes after some intense data sending.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10090081</commentid>
    <comment_count>5</comment_count>
    <who name="">mvrk</who>
    <bug_when>2017-01-23 16:22:42 -0500</bug_when>
    <thetext>Hi,

Happy to inform that the problem is fixed with update of BIOS to latest version (F.38 Rev.A)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10093086</commentid>
    <comment_count>6</comment_count>
    <who name="Laura Abbott">labbott</who>
    <bug_when>2017-01-24 13:49:26 -0500</bug_when>
    <thetext>Thank you for letting us know. I&apos;m going to close the bug now. Please reopen if you see the problem.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>