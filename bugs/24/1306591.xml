<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1306591</bug_id>
          
          <creation_ts>2016-02-11 06:51:00 -0500</creation_ts>
          <short_desc>when weak_install_weak_deps==False don&apos;t show weak dependencies in &quot;Skipping packages with conflicts&quot; section</short_desc>
          <delta_ts>2016-10-04 15:14:17 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>dnf</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          <see_also>https://bugzilla.redhat.com/show_bug.cgi?id=1303991</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ralf Corsepius">rc040203</reporter>
          <assigned_to name="Honza Silhan">jsilhan</assigned_to>
          <cc>gbenson</cc>
    
    
    <cc>jan.kratochvil</cc>
    
    
    <cc>jsilhan</cc>
    
    
    <cc>mluscon</cc>
    
    
    <cc>packaging-team-maint</cc>
    
    
    <cc>palves</cc>
    
    
    <cc>pbrobinson</cc>
    
    
    <cc>pmuldoon</cc>
    
    
    <cc>pnemade</cc>
    
    
    <cc>sergiodj</cc>
    
    
    <cc>tom</cc>
    
    
    <cc>vmukhame</cc>
    
    
    <cc>vondruch</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-07-21 10:31:50</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9052327</commentid>
    <comment_count>0</comment_count>
    <who name="Ralf Corsepius">rc040203</who>
    <bug_when>2016-02-11 06:51:35 -0500</bug_when>
    <thetext>Description of problem:
Todays update to gdb (gdb-7.10.50.20160131-51.fc24) pulls in several *devel packages.

Version-Release number of selected component (if applicable):
gdb-7.10.50.20160131-51.fc24

How reproducible:
Always

Steps to Reproduce:
1. Install gdb 
2. Watch the deps.

Actual results:
# dnf update gdb
....
Installing:
 gcc              i686 6.0.0-0.10.fc24  rawhide                    18 M
 gcc-gdb-plugin   i686 6.0.0-0.10.fc24  rawhide                    69 k
 glibc-devel      i686 2.22.90-33.fc24  rawhide                   930 k
 glibc-headers    i686 2.22.90-33.fc24  rawhide                   497 k
 kernel-headers   i686                   4.5.0-0.rc3.git1.1.fc24                 rawhide                   1.0 M
Upgrading:
 gdb              i686 7.10.50.20160131-51.fc24  rawhide                   3.4 M
...

Additional info:
I don&apos;t know the cause for this dependency bloat, but it is incomprehensible to me why a &quot;mere program&quot; (such as gdb) would want to pull in devel-packages comprising headers and a compiler.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9052384</commentid>
    <comment_count>1</comment_count>
    <who name="Jan Kratochvil">jan.kratochvil</who>
    <bug_when>2016-02-11 07:13:08 -0500</bug_when>
    <thetext>It is because gdb.spec contains:
Recommends: gcc-gdb-plugin%{?_isa}

(In reply to Ralf Corsepius from comment #0)
&gt; I don&apos;t know the cause for this dependency bloat, but it is incomprehensible
&gt; to me why a &quot;mere program&quot; (such as gdb) would want to pull in
&gt; devel-packages comprising headers and a compiler.

It is because GDB can compile C code and thus it is useful to have the basic devel packages:

https://sourceware.org/gdb/onlinedocs/gdb/Compiling-and-Injecting-Code.html#Compiling-and-Injecting-Code

$ gdb -batch true -ex start -ex &apos;compile printf(&quot;result=%d\n&quot;,1+2);&apos;
[...]
result=3

One may argue whether it should be &quot;Recommends&quot; or &quot;Suggests&quot;, for plain C it possibly may be just &quot;Suggests&quot; but given soon GDB will gain the &apos;compile&apos; support even for C++ and in C++ the &apos;compile&apos; feature is mostly required for meaningful debugging GDB would soon switch to &quot;Recommends&quot; anyway.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9052437</commentid>
    <comment_count>2</comment_count>
    <who name="Jan Kratochvil">jan.kratochvil</who>
    <bug_when>2016-02-11 07:26:02 -0500</bug_when>
    <thetext>And to resolve the problem for your special installation purposes:
# dnf --setopt install_weak_deps=false install gdb

But for some reason I cannot test it as &apos;dnf install gdb&apos; does not automatically install &apos;gcc-gdb-plugin&apos; for me on my two hosts.  But I do not have clean enough test host to bugreport that to dnf.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9052573</commentid>
    <comment_count>3</comment_count>
    <who name="Ralf Corsepius">rc040203</who>
    <bug_when>2016-02-11 08:12:35 -0500</bug_when>
    <thetext>(In reply to Jan Kratochvil from comment #2)
&gt; And to resolve the problem for your special installation purposes:
&gt; # dnf --setopt install_weak_deps=false install gdb

Jesus! I really hate to rant, but this doesn&apos;t leave me no other choice.
To put it politely: RH, the Fedora leadership and the dnf guys are suffering from blindness to the company&apos;s failings.

&gt; But for some reason I cannot test it as &apos;dnf install gdb&apos; does not
&gt; automatically install &apos;gcc-gdb-plugin&apos; for me on my two hosts.
The system I am using, is a &quot;grown&quot; real world rawhide installation on an old i686-machine, I am using for experiments.

&gt;  But I do not
&gt; have clean enough test host to bugreport that to dnf.
I could send you the list of packages I have installed on this machine ;) Basically, it&apos;s an xfce desktop with a bit of Gnome underneath. Before today, it had no devel packages installed, but it had gdb installed. Then came this update and pulled-in this bloat.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9052618</commentid>
    <comment_count>4</comment_count>
    <who name="Jan Kratochvil">jan.kratochvil</who>
    <bug_when>2016-02-11 08:24:36 -0500</bug_when>
    <thetext>(In reply to Ralf Corsepius from comment #3)
&gt; To put it politely: RH, the Fedora leadership and the dnf guys are suffering
&gt; from blindness to the company&apos;s failings.

These are not my decision, personally I would prefer a switch to LLDB.

&gt; &gt; But I do not have clean enough test host to bugreport that to dnf.
&gt; I could send you the list of packages I have installed on this machine ;)

To make it clear - I find your Comment #0 as a valid behavior (for &apos;install&apos;, not for &apos;update&apos;).  Only my system for whatever reason behaves wrongly (=not installing gcc-gdb-plugin) but that is offtopic here.

&gt; Before today, it had no devel packages installed, but it had gdb installed.
&gt; Then came this update and pulled-in this bloat.

An update should not bring in new packages I think but that is all up to DNF, not GDB.  Therefore reassign+reopen it for DNF if you think the &apos;update&apos; does not behave correctly.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9052797</commentid>
    <comment_count>5</comment_count>
    <who name="Ralf Corsepius">rc040203</who>
    <bug_when>2016-02-11 09:11:38 -0500</bug_when>
    <thetext>(In reply to Jan Kratochvil from comment #4)
&gt; (In reply to Ralf Corsepius from comment #3)
&gt; &gt; To put it politely: RH, the Fedora leadership and the dnf guys are suffering
&gt; &gt; from blindness to the company&apos;s failings.
&gt; 
&gt; These are not my decision, personally I would prefer a switch to LLDB.
The more severe problem behind this: Nobody wants to take responsibility.
Everybody pretends &quot;everything was in splendid shape&quot;, everybody cheats.


&gt; &gt; &gt; But I do not have clean enough test host to bugreport that to dnf.
&gt; &gt; I could send you the list of packages I have installed on this machine ;)
&gt; 
&gt; To make it clear - I find your Comment #0 as a valid behavior (for
&gt; &apos;install&apos;, not for &apos;update&apos;). 
Well, I consider adding devel packages to a mere desktop as part of an update to be &quot;inacceptable misbehavior&quot;.

Apparently yet another situation, the promoters of weak deps and dnf did not consider.

&gt; An update should not bring in new packages I think but that is all up to
&gt; DNF, not GDB.  Therefore reassign+reopen it for DNF if you think the
&gt; &apos;update&apos; does not behave correctly.
I had to learn, the dnf guys are blind to their failures. Likely they are to inexperienced to comprehend where and why are failing.

That said, I&apos;ve learnt reporting bugs against dnf is a waste of time.

Finally, trying your proposal (Now with gdb removed):

# dnf --setopt install_weak_deps=false install gdb
..
 gdb              i686   7.10.50.20160131-51.fc24     rawhide   3.4 M
 libipt           i686   1.4.4-2.fc24                 rawhide    44 k
Skipping packages with conflicts:
(add &apos;--best --allowerasing&apos; to command line to force their upgrade):
 gcc              i686   6.0.0-0.10.fc24              rawhide    18 M
 gcc-gdb-plugin   i686   6.0.0-0.10.fc24              rawhide    69 k
 glibc-devel      i686   2.22.90-33.fc24              rawhide   930 k
 glibc-headers    i686   2.22.90-33.fc24              rawhide   497 k
 kernel-headers   i686   4.5.0-0.rc3.git1.1.fc24      rawhide   1.0 M
 libmpx           i686   6.0.0-0.10.fc24              rawhide    22 k
...

The same level experience with dnf, as always: An absurd message about conflicts. Obviously, dnf is not ready for weak deps.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9052906</commentid>
    <comment_count>6</comment_count>
    <who name="Jan Kratochvil">jan.kratochvil</who>
    <bug_when>2016-02-11 09:36:54 -0500</bug_when>
    <thetext>(In reply to Ralf Corsepius from comment #5)
&gt; Well, I consider adding devel packages to a mere desktop

If it is a &quot;mere desktop&quot; why do you need GDB there?  For a good enough debugging you really need even a compiler, LLDB uses LLVM for that.


For the &apos;# dnf --setopt install_weak_deps=false install gdb&apos; part reassigning to DNF.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9054685</commentid>
    <comment_count>7</comment_count>
    <who name="Ralf Corsepius">rc040203</who>
    <bug_when>2016-02-12 00:03:06 -0500</bug_when>
    <thetext>(In reply to Jan Kratochvil from comment #6)
&gt; (In reply to Ralf Corsepius from comment #5)
&gt; &gt; Well, I consider adding devel packages to a mere desktop
&gt; 
&gt; If it is a &quot;mere desktop&quot; why do you need GDB there?
E.g. to examine/inspect core dumps.

In general another use case would be using gdb to control remote debugging on remote targets (over a serial wire) and using gdb as a simulator.

&gt;  For a good enough
&gt; debugging you really need even a compiler, LLDB uses LLVM for that.
I do not agree with this. A debugger which requires a compiler is flawed design.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9055161</commentid>
    <comment_count>8</comment_count>
    <who name="Gary Benson">gbenson</who>
    <bug_when>2016-02-12 04:44:42 -0500</bug_when>
    <thetext>The debugger requires a compiler in order to evaluate commands such as &apos;print a.b-&gt;c&apos; or &apos;call puts(&quot;hello world&quot;)&apos;.  We&apos;re not so much adding a compiler as replacing one with another.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9075174</commentid>
    <comment_count>9</comment_count>
    <who name="Honza Silhan">jsilhan</who>
    <bug_when>2016-02-18 07:54:22 -0500</bug_when>
    <thetext>(In reply to Ralf Corsepius from comment #5)
&gt; # dnf --setopt install_weak_deps=false install gdb
&gt; ..
&gt;  gdb              i686   7.10.50.20160131-51.fc24     rawhide   3.4 M
&gt;  libipt           i686   1.4.4-2.fc24                 rawhide    44 k
&gt; Skipping packages with conflicts:
&gt; (add &apos;--best --allowerasing&apos; to command line to force their upgrade):
&gt;  gcc              i686   6.0.0-0.10.fc24              rawhide    18 M
&gt;  gcc-gdb-plugin   i686   6.0.0-0.10.fc24              rawhide    69 k
&gt;  glibc-devel      i686   2.22.90-33.fc24              rawhide   930 k
&gt;  glibc-headers    i686   2.22.90-33.fc24              rawhide   497 k
&gt;  kernel-headers   i686   4.5.0-0.rc3.git1.1.fc24      rawhide   1.0 M
&gt;  libmpx           i686   6.0.0-0.10.fc24              rawhide    22 k
&gt; ...
&gt; 
&gt; The same level experience with dnf, as always: An absurd message about
&gt; conflicts. Obviously, dnf is not ready for weak deps.

I don&apos;t know why completely different bug report ended on DNF component, but ok, let&apos;s track issue in the comment above in this BZ.

The packages which were pulled in as a weak dependencies were shown in &quot;Skipping packages with conflicts&quot; section -&gt; UX DNF bug.

PR: https://github.com/rpm-software-management/dnf/pull/443</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9093134</commentid>
    <comment_count>10</comment_count>
    <who name="Jan Kurik">jkurik</who>
    <bug_when>2016-02-24 09:29:36 -0500</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 24 development cycle.
Changing version to &apos;24&apos;.

More information and reason for this action is here:
https://fedoraproject.org/wiki/Fedora_Program_Management/HouseKeeping/Fedora24#Rawhide_Rebase</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9105854</commentid>
    <comment_count>11</comment_count>
    <who name="Jan Kratochvil">jan.kratochvil</who>
    <bug_when>2016-02-29 09:30:45 -0500</bug_when>
    <thetext>*** Bug 1312919 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9184370</commentid>
    <comment_count>12</comment_count>
    <who name="Mike McCune">mmccune</who>
    <bug_when>2016-03-28 18:49:28 -0400</bug_when>
    <thetext>This bug was accidentally moved from POST to MODIFIED via an error in automation, please see mmccune@redhat.com with any questions</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9316879</commentid>
    <comment_count>13</comment_count>
    <who name="Peter Robinson">pbrobinson</who>
    <bug_when>2016-05-11 08:55:50 -0400</bug_when>
    <thetext>This seems to have regressed again recently.

# dnf upgrade --refresh
Fedora 24 - aarch64                                                                                                                            1.9 MB/s |  41 MB     00:21    
Last metadata expiration check: 0:00:47 ago on Wed May 11 12:50:05 2016.
Dependencies resolved.
========================================================================
 Package         Arch       Version          Repository   Size
========================================================================
Installing:
 binutils        aarch64    2.26-18.fc24     fedora       5.5 M
 cpp             aarch64    6.0.0-0.20.fc24  fedora       7.5 M
 gcc             aarch64    6.0.0-0.20.fc24  fedora        16 M
 gcc-gdb-plugin  aarch64    6.0.0-0.20.fc24  fedora        73 k
 glibc-devel     aarch64    2.23.1-5.fc24    fedora       931 k
 isl             aarch64    0.14-5.fc24      fedora       434 k
 libasan         aarch64    6.0.0-0.20.fc24  fedora       304 k
 libatomic       aarch64    6.0.0-0.20.fc24  fedora        25 k
 libmpc          aarch64    1.0.2-5.fc24     fedora        54 k
 libubsan        aarch64    6.0.0-0.20.fc24  fedora       120 k
 mpfr            aarch64    3.1.4-1.fc24     fedora       204 k
Upgrading:
 gdb             aarch64    7.11-66.fc24     fedora       2.7 M

Transaction Summary
========================================================================
Install  11 Packages
Upgrade   1 Package

Total download size: 34 M
Is this ok [y/N]: 


Installed dnf stack:
dnf-1.1.8-1.fc24.noarch
dnf-conf-1.1.8-1.fc24.noarch
dnf-langpacks-0.15.1-4.fc24.noarch
dnf-langpacks-conf-0.15.1-4.fc24.noarch
dnf-plugins-core-0.1.20-1.fc24.noarch
dnf-yum-1.1.8-1.fc24.noarch
python3-dnf-1.1.8-1.fc24.noarch
python3-dnf-langpacks-0.15.1-4.fc24.noarch
python3-dnf-plugins-core-0.1.20-1.fc24.noarch
hawkey-0.6.3-2.fc24.aarch64
python3-hawkey-0.6.3-2.fc24.aarch64
python3-librepo-1.7.18-2.fc24.aarch64
librepo-1.7.18-2.fc24.aarch64</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9537225</commentid>
    <comment_count>14</comment_count>
    <who name="Igor Gnatenko">ignatenko</who>
    <bug_when>2016-07-21 10:31:50 -0400</bug_when>
    <thetext>Fixed as part of DNF 2.0 which will be available at some point soonish.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9690518</commentid>
    <comment_count>15</comment_count>
    <who name="Jan Kratochvil">jan.kratochvil</who>
    <bug_when>2016-09-08 08:32:55 -0400</bug_when>
    <thetext>*** Bug 1195005 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>