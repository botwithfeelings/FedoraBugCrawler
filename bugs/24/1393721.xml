<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1393721</bug_id>
          
          <creation_ts>2016-11-10 03:41:00 -0500</creation_ts>
          <short_desc>stop enable rpcbind.socket with every update</short_desc>
          <delta_ts>2016-11-29 22:51:35 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>rpcbind</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Yu Watanabe">watanabe.yu+redhat.bugzilla</reporter>
          <assigned_to name="Steve Dickson">steved</assigned_to>
          <cc>h.reindl</cc>
    
    
    <cc>steved</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>rpcbind-0.2.3-12.rc2.fc25 rpcbind-0.2.3-12.rc2.fc24</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-11-19 16:18:09</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          <external_bugs name="Red Hat Bugzilla">1324666</external_bugs>
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9878857</commentid>
    <comment_count>0</comment_count>
    <who name="Yu Watanabe">watanabe.yu+redhat.bugzilla</who>
    <bug_when>2016-11-10 03:41:34 -0500</bug_when>
    <thetext>Description of problem:

This is duplicate of RHBZ#1324666.

The bug is not fixed yet.
===========
# sudo systemctl disable rpcbind.socket
# sudo dnf update rpcbind
# systemctl is-enabled rpcbind.socket
enabled
===========

Version-Release number of selected component (if applicable):

rpcbind-0.2.3-11.rc2.fc24.x86_64

How reproducible:

Always

Steps to Reproduce:
1. See above.
2.
3.

Actual results:

rpcbind.socket is always enabled when rpcbind.rpm is updated.

Expected results:

The status of enabled or not of rpcbind.socket is conserved when rpcbind.rpm is updated.

Additional info:

As I already commented in https://bugzilla.redhat.com/show_bug.cgi?id=1324666#c2 , please remove or modify the following codes in rpcbind.socket.
==========
%triggerin -- rpcbind &gt; 0.2.2-2.0
/bin/systemctl enable rpcbind.socket  &gt;/dev/null 2&gt;&amp;1 || :
/bin/systemctl restart rpcbind.socket &gt;/dev/null 2&gt;&amp;1 || :
==========</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9885236</commentid>
    <comment_count>1</comment_count>
    <who name="Steve Dickson">steved</who>
    <bug_when>2016-11-12 09:40:43 -0500</bug_when>
    <thetext>*** Bug 1324666 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9885286</commentid>
    <comment_count>2</comment_count>
    <who name="Steve Dickson">steved</who>
    <bug_when>2016-11-12 11:58:35 -0500</bug_when>
    <thetext>(In reply to Yu Watanabe from comment #0)
&gt; Description of problem:
&gt; As I already commented in
&gt; https://bugzilla.redhat.com/show_bug.cgi?id=1324666#c2 , please remove or
&gt; modify the following codes in rpcbind.socket.
&gt; ==========
&gt; %triggerin -- rpcbind &gt; 0.2.2-2.0
&gt; /bin/systemctl enable rpcbind.socket  &gt;/dev/null 2&gt;&amp;1 || :
&gt; /bin/systemctl restart rpcbind.socket &gt;/dev/null 2&gt;&amp;1 || :
&gt; ==========

I could do something likes: 

if systemctl is-enabled rpcbind.socket
then
    /bin/systemctl reenable rpcbind.socket  &gt;/dev/null 2&gt;&amp;1 || :
    /bin/systemctl restart rpcbind.socket &gt;/dev/null 2&gt;&amp;1 || :
fi

But the socket will still be enabled because it is
being enabled by systemd via the WantedBy=sockets.target
in the rpcbind.socket.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9885291</commentid>
    <comment_count>3</comment_count>
    <who name="Harald Reindl">h.reindl</who>
    <bug_when>2016-11-12 12:13:52 -0500</bug_when>
    <thetext>since when it&apos;s a problem to distinct between install/uninstall/update of a package in post-scripts? or is that another &quot;advantage&quot; of the new systemd stuff?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9885292</commentid>
    <comment_count>4</comment_count>
    <who name="Harald Reindl">h.reindl</who>
    <bug_when>2016-11-12 12:16:10 -0500</bug_when>
    <thetext>and no it won&apos;t be enabled, it&apos;s only the crap at update

[root@srv-rhsoft:~]$ uptime
 18:15:27 up  2:10,  7 users,  load average: 1,25, 1,41, 1,10

[root@srv-rhsoft:~]$ lsmod | grep rpc
[root@srv-rhsoft:~]$ ps aux | grep rpc
root     29195  0.0  0.0  10752   892 pts/5    S&lt;+  18:15   0:00 /usr/bin/grep --color rpc

[root@srv-rhsoft:~]$ systemctl status rpcbind.service
? rpcbind.service - RPC Bind
   Loaded: loaded (/usr/lib/systemd/system/rpcbind.service; disabled; vendor preset: disabled)
   Active: inactive (dead)
     Docs: man:rpcbind(8)

[root@srv-rhsoft:~]$ systemctl status sockets.target
? sockets.target - Sockets
   Loaded: loaded (/usr/lib/systemd/system/sockets.target; static; vendor preset: disabled)
   Active: active since Sa 2016-11-12 16:04:53 CET; 2h 9min ago
     Docs: man:systemd.special(7)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9885299</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-12 12:50:56 -0500</bug_when>
    <thetext>rpcbind-0.2.3-12.rc2.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2016-19495d4a31</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9885300</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-12 12:51:04 -0500</bug_when>
    <thetext>rpcbind-0.2.3-12.rc2.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-b6d90e5a78</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9885359</commentid>
    <comment_count>7</comment_count>
    <who name="Harald Reindl">h.reindl</who>
    <bug_when>2016-11-12 14:49:45 -0500</bug_when>
    <thetext>the same crap and since the preset is &quot;vendor preset: disabled&quot; this is really unacceptable - REMOVE ALL THAT CRAP which deals about enable services/sockets - this is not microsoft windows

[root@srv-rhsoft:/downloads]$ systemctl status rpcbind.socket 
? rpcbind.socket - RPCbind Server Activation Socket
   Loaded: loaded (/usr/lib/systemd/system/rpcbind.socket; disabled; vendor preset: disabled)
   Active: inactive (dead)
   Listen: /run/rpcbind.sock (Stream)
           0.0.0.0:111 (Stream)
           0.0.0.0:111 (Datagram)
           [::]:111 (Stream)
           [::]:111 (Datagram)

[root@srv-rhsoft:/downloads]$ dnf update rpcbind-0.2.3-12.rc2.fc24.x86_64.rpm

[root@srv-rhsoft:/downloads]$ systemctl status rpcbind.socket
? rpcbind.socket - RPCbind Server Activation Socket
   Loaded: loaded (/usr/lib/systemd/system/rpcbind.socket; enabled; vendor preset: disabled)
   Active: active (listening) since Sa 2016-11-12 20:46:33 CET; 7s ago
   Listen: /run/rpcbind.sock (Stream)
           0.0.0.0:111 (Stream)
           0.0.0.0:111 (Datagram)
           [::]:111 (Stream)
           [::]:111 (Datagram)

[root@srv-rhsoft:/downloads]$ systemctl disable rpcbind.socket
Removed symlink /etc/systemd/system/sockets.target.wants/rpcbind.socket.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9885365</commentid>
    <comment_count>8</comment_count>
    <who name="Harald Reindl">h.reindl</who>
    <bug_when>2016-11-12 14:58:14 -0500</bug_when>
    <thetext>however, i have better things to do than debug packaging basics just because &quot;disable&quot; is not longer &quot;disable&quot; until you mask it and make it completly unavailable (a lsitening socket is practically the same as a running service since it would start the service by the first incoming package)

[root@rh:/downloads]$ systemctl mask rpcbind.socket
Created symlink from /etc/systemd/system/rpcbind.socket to /dev/null. 

[root@srv-rhsoft:/downloads]$ systemctl mask rpcbind.socket
Created symlink from /etc/systemd/system/rpcbind.socket to /dev/null.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9885603</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-12 22:21:36 -0500</bug_when>
    <thetext>rpcbind-0.2.3-12.rc2.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-b6d90e5a78</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9885997</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-13 13:20:48 -0500</bug_when>
    <thetext>rpcbind-0.2.3-12.rc2.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-19495d4a31</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9905925</commentid>
    <comment_count>11</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-19 16:18:09 -0500</bug_when>
    <thetext>rpcbind-0.2.3-12.rc2.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9941235</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-29 22:51:35 -0500</bug_when>
    <thetext>rpcbind-0.2.3-12.rc2.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>