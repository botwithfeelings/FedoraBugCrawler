<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1305367</bug_id>
          
          <creation_ts>2016-02-07 12:12:00 -0500</creation_ts>
          <short_desc>Non-fatal POSTIN scriptlet failure in rpm package mock</short_desc>
          <delta_ts>2016-08-08 17:20:15 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>mock</component>
          <version>24</version>
          <rep_platform>All</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>low</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Vedran Miletić">vedran</reporter>
          <assigned_to name="Miroslav Suchý">msuchy</assigned_to>
          <cc>jdisnard</cc>
    
    
    <cc>jfrieben</cc>
    
    
    <cc>mebrown</cc>
    
    
    <cc>msimacek</cc>
    
    
    <cc>msuchy</cc>
    
    
    <cc>praiskup</cc>
    
    
    <cc>rc040203</cc>
    
    
    <cc>vedran</cc>
    
    
    <cc>williams</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>mock-1.2.18-1.fc23 mock-1.2.18-1.fc24 mock-1.2.18-1.el7 mock-1.2.18-1.el6</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-06-13 00:55:59</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9041506</commentid>
    <comment_count>0</comment_count>
    <who name="Vedran Miletić">vedran</who>
    <bug_when>2016-02-07 12:12:19 -0500</bug_when>
    <thetext>Installing mock-1.2.14-1.fc24 on rawhide gives:

  Installing  :  mock-1.2.14-1.fc24.noarch  36/63 
warning: %post(mock-1.2.14-1.fc24.noarch) scriptlet failed, exit status 254
Non-fatal POSTIN scriptlet failure in rpm package mock
Non-fatal POSTIN scriptlet failure in rpm package mock</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9072614</commentid>
    <comment_count>1</comment_count>
    <who name="Miroslav Suchý">msuchy</who>
    <bug_when>2016-02-17 11:30:32 -0500</bug_when>
    <thetext>I cannot reproduce it.
It would be nice to know content of your /etc/mock/, /etc/os-release and from which version you were updating.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9072807</commentid>
    <comment_count>2</comment_count>
    <who name="Vedran Miletić">vedran</who>
    <bug_when>2016-02-17 12:50:59 -0500</bug_when>
    <thetext>$ cat /etc/os-release 
NAME=Fedora
VERSION=&quot;24 (Workstation Edition)&quot;
ID=fedora
VERSION_ID=24
PRETTY_NAME=&quot;Fedora 24 (Workstation Edition)&quot;
ANSI_COLOR=&quot;0;34&quot;
CPE_NAME=&quot;cpe:/o:fedoraproject:fedora:24&quot;
HOME_URL=&quot;https://fedoraproject.org/&quot;
BUG_REPORT_URL=&quot;https://bugzilla.redhat.com/&quot;
REDHAT_BUGZILLA_PRODUCT=&quot;Fedora&quot;
REDHAT_BUGZILLA_PRODUCT_VERSION=rawhide
REDHAT_SUPPORT_PRODUCT=&quot;Fedora&quot;
REDHAT_SUPPORT_PRODUCT_VERSION=rawhide
PRIVACY_POLICY_URL=https://fedoraproject.org/wiki/Legal:PrivacyPolicy
VARIANT=&quot;Workstation Edition&quot;
VARIANT_ID=workstation

/etc/mock does not exist. All packages are latest rawhide.

$ sudo dnf install @fedora-packager
(...)
Installing  : mock-1.2.14-2.fc24.noarch  45/67
warning: %post(mock-1.2.14-2.fc24.noarch) scriptlet failed, exit status 254
Non-fatal POSTIN scriptlet failure in rpm package mock
Non-fatal POSTIN scriptlet failure in rpm package mock
(...)

Reliably reproducible after removing @fedora-packager and then installing it again.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9072902</commentid>
    <comment_count>3</comment_count>
    <who name="Miroslav Suchý">msuchy</who>
    <bug_when>2016-02-17 13:40:39 -0500</bug_when>
    <thetext>You do not have /etc/mock directory? That is weird because mock ship it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9072910</commentid>
    <comment_count>4</comment_count>
    <who name="Vedran Miletić">vedran</who>
    <bug_when>2016-02-17 13:44:02 -0500</bug_when>
    <thetext>I have it after installation, of course.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9072963</commentid>
    <comment_count>5</comment_count>
    <who name="Miroslav Suchý">msuchy</who>
    <bug_when>2016-02-17 13:58:13 -0500</bug_when>
    <thetext>Can you try this?:
$ wget https://kojipkgs.fedoraproject.org//packages/mock/1.2.14/2.fc24/noarch/mock-1.2.14-2.fc24.noarch.rpm
$ rpm -qp --scripts mock-1.2.14-2.fc24.noarch.rpm

And after the line:
  postinstall scriptlet (using /bin/sh):
there is the script which is run. Can you save it as shell script and execute it.
Likely
  bash -x post.sh
This will show you how variable are evaluate and show where the error occure. Can you post the result here?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9094496</commentid>
    <comment_count>6</comment_count>
    <who name="Jan Kurik">jkurik</who>
    <bug_when>2016-02-24 10:44:46 -0500</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 24 development cycle.
Changing version to &apos;24&apos;.

More information and reason for this action is here:
https://fedoraproject.org/wiki/Fedora_Program_Management/HouseKeeping/Fedora24#Rawhide_Rebase</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9151065</commentid>
    <comment_count>7</comment_count>
    <who name="Vedran Miletić">vedran</who>
    <bug_when>2016-03-15 19:36:51 -0400</bug_when>
    <thetext>Sorry for the delay. Here is the relevant script:

preinstall scriptlet (using /bin/sh):

# check for existence of mock group, create it if not found
getent group mock &gt; /dev/null || groupadd -f -g 135 -r mock
exit 0
postinstall scriptlet (using /bin/sh):

# fix cache permissions from old installs
chmod 2775 /var/cache/mock

if [ -s /etc/os-release ]; then
    # fedora and rhel7
    if grep -Fq Rawhide /etc/os-release; then
        ver=rawhide
    else
        ver=$(source /etc/os-release &amp;&amp; echo $VERSION_ID | cut -d. -f1 | grep -o &apos;[0-9]\+&apos;)
    fi
else
    # rhel6 or something obsure, use buildtime version
    ver=24
fi
mock_arch=$(python -c &quot;import rpmUtils.arch; baseArch = rpmUtils.arch.getBaseArch(); print baseArch&quot;)
cfg=fedora-$ver-${mock_arch}.cfg
[ -e /etc/mock/$cfg ] || exit -2
if [ &quot;$(readlink /etc/mock/default.cfg)&quot; != &quot;$cfg&quot; ]; then
  ln -s $cfg /etc/mock/default.cfg 2&gt;/dev/null || ln -s -f $cfg /etc/mock/default.cfg.rpmnew
fi
:

However, this does not happen with mock 1.2.17 which is currently in F24.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9151713</commentid>
    <comment_count>8</comment_count>
    <who name="Miroslav Suchý">msuchy</who>
    <bug_when>2016-03-16 02:32:32 -0400</bug_when>
    <thetext>The problem is that this error is likely triggered by some obscure situation in /etc/mock/ and I see no error by just reading the code. So unless this happen to you and then you run this code manually by hand (becouse rpm does not print the error) and you post here the error message, there is hardly enything I can do about it. :(</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9263446</commentid>
    <comment_count>9</comment_count>
    <who name="Joachim Frieben">jfrieben</who>
    <bug_when>2016-04-24 08:48:14 -0400</bug_when>
    <thetext>(In reply to Vedran Miletić from comment #7)
&gt; However, this does not happen with mock 1.2.17 which is currently in F24.

Well, I do see this issue in current rawhide:
 &quot;warning: %post(mock-1.2.17-1.fc25.noarch) scriptlet failed, exit status 254
  Non-fatal POSTIN scriptlet failure in rpm package mock&quot;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9264332</commentid>
    <comment_count>10</comment_count>
    <who name="Miroslav Suchý">msuchy</who>
    <bug_when>2016-04-25 04:30:57 -0400</bug_when>
    <thetext>Notes for myself. It seems to be caused by this line:
  [ -e /etc/mock/$cfg ] || exit -2

I should probably change it from this fatal exit just to some warning.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9381313</commentid>
    <comment_count>11</comment_count>
    <who name="Miroslav Suchý">msuchy</who>
    <bug_when>2016-06-02 09:39:46 -0400</bug_when>
    <thetext>Fixed in commit
* 4630ebf (HEAD -&gt; devel) do not fail when we cannot link default.cfg [RHBZ#1305367]</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404034</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 09:13:27 -0400</bug_when>
    <thetext>mock-1.2.16-1.fc22 has been submitted as an update to Fedora 22. https://bodhi.fedoraproject.org/updates/FEDORA-2016-89209fd48b</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404038</commentid>
    <comment_count>13</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 09:13:50 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-70cdc0c410</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404044</commentid>
    <comment_count>14</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 09:14:10 -0400</bug_when>
    <thetext>mock-1.2.18-1.el7 has been submitted as an update to Fedora EPEL 7. https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2016-3d9f899f6a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404048</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 09:14:29 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc23 has been submitted as an update to Fedora 23. https://bodhi.fedoraproject.org/updates/FEDORA-2016-de15171a43</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404052</commentid>
    <comment_count>16</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 09:14:49 -0400</bug_when>
    <thetext>mock-1.2.18-1.el6 has been submitted as an update to Fedora EPEL 6. https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2016-9e2f372208</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404728</commentid>
    <comment_count>17</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 13:59:37 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-70cdc0c410</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9405193</commentid>
    <comment_count>18</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 23:18:18 -0400</bug_when>
    <thetext>mock-1.2.18-1.el6 has been pushed to the Fedora EPEL 6 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2016-9e2f372208</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9405198</commentid>
    <comment_count>19</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 23:19:00 -0400</bug_when>
    <thetext>mock-1.2.18-1.el7 has been pushed to the Fedora EPEL 7 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2016-3d9f899f6a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9405205</commentid>
    <comment_count>20</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 23:53:23 -0400</bug_when>
    <thetext>mock-1.2.16-1.fc22 has been pushed to the Fedora 22 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-89209fd48b</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9405213</commentid>
    <comment_count>21</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 23:53:58 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc23 has been pushed to the Fedora 23 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-de15171a43</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9407834</commentid>
    <comment_count>22</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-13 00:55:44 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc23 has been pushed to the Fedora 23 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9425593</commentid>
    <comment_count>23</comment_count>
    <who name="Vedran Miletić">vedran</who>
    <bug_when>2016-06-16 18:39:55 -0400</bug_when>
    <thetext>Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9430062</commentid>
    <comment_count>24</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-18 14:34:04 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9456787</commentid>
    <comment_count>25</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-27 15:48:26 -0400</bug_when>
    <thetext>mock-1.2.18-1.el7 has been pushed to the Fedora EPEL 7 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9457447</commentid>
    <comment_count>26</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-27 23:19:12 -0400</bug_when>
    <thetext>mock-1.2.18-1.el6 has been pushed to the Fedora EPEL 6 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9595582</commentid>
    <comment_count>27</comment_count>
    <who name="Miroslav Suchý">msuchy</who>
    <bug_when>2016-08-08 17:20:15 -0400</bug_when>
    <thetext>*** Bug 1183454 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>