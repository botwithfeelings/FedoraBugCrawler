<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1376976</bug_id>
          
          <creation_ts>2016-09-17 02:51:00 -0400</creation_ts>
          <short_desc>gtk3: Multiple cells selection freezes LibreOffice Calc when running autokey</short_desc>
          <delta_ts>2016-11-10 10:15:11 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>libreoffice</component>
          <version>24</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>urgent</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Eric Lavarde">elavarde</reporter>
          <assigned_to name="Caolan McNamara">caolanm</assigned_to>
          <cc>caolanm</cc>
    
    
    <cc>dtardon</cc>
    
    
    <cc>elavarde</cc>
    
    
    <cc>erack</cc>
    
    
    <cc>mstahl</cc>
    
    
    <cc>rmj</cc>
    
    
    <cc>sbergman</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>libreoffice-5.1.5.2-8.fc24</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-11-10 10:15:11</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9715989</commentid>
    <comment_count>0</comment_count>
    <who name="Eric Lavarde">elavarde</who>
    <bug_when>2016-09-17 02:51:58 -0400</bug_when>
    <thetext>Description of problem:
Selecting more than one cell freezes Calc and I have to quit, hopefully not loosing unsaved work. This makes it unusable.

Version-Release number of selected component (if applicable):
$ rpm -qa | grep -e libreoffice-gtk -e libreoffice-calc -e ^gtk[23] | sort
gtk2-2.24.31-1.fc24.i686
gtk2-2.24.31-1.fc24.x86_64
gtk2-engines-2.20.2-11.fc24.x86_64
gtk3-3.20.9-1.fc24.x86_64
libreoffice-calc-5.1.5.2-6.fc24.x86_64
libreoffice-gtk2-5.1.5.2-6.fc24.x86_64
libreoffice-gtk3-5.1.5.2-6.fc24.x86_64

How reproducible:
Almost always

Steps to Reproduce:
1. Open Calc
2. Select multiple cells

Actual results:
Calc freezes. It&apos;s kind of still alive as I can close it and, if I have unsaved changes, there will be a dialog to save my changes (sometimes it&apos;s black and unusable though). Sometimes I can escape the freeze by clicking multiple times fast in the selection, but it&apos;s seldom.

Expected results:
Calc doesn&apos;t freeze and I can do something with the selection.

Additional info:

The issue seems related to Bug 1373933 but I&apos;m using F24 and shouldn&apos;t be impacted by the referenced commit (unless it&apos;s been backported). Further I can&apos;t reproduce it using Draw and selecting objects.

Anyway, if I call &apos;SAL_USE_VCLPLUGIN=gtk libreoffice --calc&apos; the problem is gone, so it seems also like a gtk3-specific issue.

The problem did already exist a while ago but I&apos;m pretty sure that it went away already before the summer and has come back somewhere in-between (but I don&apos;t use Calc regularly at home).

I don&apos;t think it&apos;s relevant but I&apos;m using KDE (latest version F24).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9716053</commentid>
    <comment_count>1</comment_count>
    <who name="Eric Lavarde">elavarde</who>
    <bug_when>2016-09-17 04:34:47 -0400</bug_when>
    <thetext>I just discovered that I can break the spel... sorry the freeze, by selecting somewhere else.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9720393</commentid>
    <comment_count>2</comment_count>
    <who name="Caolan McNamara">caolanm</who>
    <bug_when>2016-09-19 04:57:37 -0400</bug_when>
    <thetext>With a blank spreadsheet I can make multiple selections without any apparent problem.

Is there any foul clipboard grabber extension installed like clipit ?

(And I presume because its not mentioned that its not the KDE backend that&apos;s installed, i.e. no libreoffice-kde</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9724676</commentid>
    <comment_count>3</comment_count>
    <who name="Eric Lavarde">elavarde</who>
    <bug_when>2016-09-20 02:32:11 -0400</bug_when>
    <thetext>I couldn&apos;t check but:

clipit -&gt; if it&apos;s not installed by default, I don&apos;t have it. In a similar direction, I have Autokey in action, but I also have it at work (CSB 7.2 more or less standard) and there is no issue.
libreoffice-kde -&gt; if it&apos;s not installed by default, I don&apos;t have it (whatever it is or does).

As a side remark, I have the impression that a full spreadsheet tends more to the issue than an empty one, but the issue also seems to fluctuate with time, so it might be due to this.

Could it be related to a graphic driver issue? I have a Skylake CPU/GPU and it wouldn&apos;t be the first time that it shows that the Intel driver isn&apos;t up to par...
This said I also have a Skylake CPU/GPU at work...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9724683</commentid>
    <comment_count>4</comment_count>
    <who name="Eric Lavarde">elavarde</who>
    <bug_when>2016-09-20 02:34:14 -0400</bug_when>
    <thetext>Sorry, perhaps to clarify: the issue is not with making multiple selections, the issue is with a single selection of multiple cells.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9725053</commentid>
    <comment_count>5</comment_count>
    <who name="Caolan McNamara">caolanm</who>
    <bug_when>2016-09-20 04:26:35 -0400</bug_when>
    <thetext>If I install autokey then my load goes through the roof when I make a selection, so that&apos;s the trigger.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9725295</commentid>
    <comment_count>6</comment_count>
    <who name="Caolan McNamara">caolanm</who>
    <bug_when>2016-09-20 05:35:10 -0400</bug_when>
    <thetext>might have been too quick to blame autokey, but there is a selection problem</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9725586</commentid>
    <comment_count>7</comment_count>
    <who name="Caolan McNamara">caolanm</who>
    <bug_when>2016-09-20 07:02:33 -0400</bug_when>
    <thetext>This might be the same underlying problem as bug 1362451, lets see if the fix there will make a difference here</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9746531</commentid>
    <comment_count>8</comment_count>
    <who name="Caolan McNamara">caolanm</who>
    <bug_when>2016-09-27 09:37:31 -0400</bug_when>
    <thetext>*** Bug 1376975 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>