<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1348712</bug_id>
          
          <creation_ts>2016-06-21 16:35:00 -0400</creation_ts>
          <short_desc>Regression: POCO_UNBUNDLED is no longer defined</short_desc>
          <delta_ts>2016-07-12 02:39:29 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>poco</component>
          <version>24</version>
          <rep_platform>All</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>CURRENTRELEASE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>urgent</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Stuart Campbell">stuart</reporter>
          <assigned_to name="Francis ANDRE">francis.andre.kampbell</assigned_to>
          <cc>francis.andre.kampbell</cc>
    
    
    <cc>swt</cc>
    
    
    <cc>udushlivy</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-07-12 02:39:29</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9438234</commentid>
    <comment_count>0</comment_count>
      <attachid>1170390</attachid>
    <who name="Stuart Campbell">stuart</who>
    <bug_when>2016-06-21 16:35:50 -0400</bug_when>
    <thetext>Created attachment 1170390
Patch file for poco.spec

Description of problem:

This is a regression to the bug fixed in https://bugzilla.redhat.com/show_bug.cgi?format=multiple&amp;id=597934

Basically, it means code that include some of the Poco headers will not compile.  This was fixed a while ago, but it looks like a change in http://pkgs.fedoraproject.org/cgit/rpms/poco.git/commit/?id=a0386b1fc43a2d64fe7242ce0ee5f6134f1425bb 
reverted it, probably accidentally.

I have attached a patch to fix this issue.

Best Wishes
Stu</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9438323</commentid>
    <comment_count>1</comment_count>
    <who name="Francis ANDRE">francis.andre.kampbell</who>
    <bug_when>2016-06-21 17:15:38 -0400</bug_when>
    <thetext>Hi

May be you missed it, but the configure script with the option --unbundled defines POCO_UNBUNDLED to 1

./configure --everything --omit=PDF,CppParse --unbundled

# config.make generated by configure script
POCO_CONFIG = CYGWIN
POCO_BASE = /cygdrive/z/git/poco-1.7.3
POCO_BUILD = /cygdrive/z/git/poco-1.7.3
POCO_FLAGS =  -DPOCO_UNBUNDLED
POCO_PREFIX = /usr/local
OMIT = PDF CppParse
POCO_UNBUNDLED = 1
export POCO_CONFIG
export POCO_BASE
export POCO_BUILD
export POCO_FLAGS
export POCO_PREFIX
export POCO_UNBUNDLED
~
So there is no need to edit the config.h file</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9438420</commentid>
    <comment_count>2</comment_count>
    <who name="Stuart Campbell">stuart</who>
    <bug_when>2016-06-21 18:02:31 -0400</bug_when>
    <thetext>No hadn&apos;t missed that, but you are mixing up cmake variables with compiler directives. At the moment we are shipping a version that won&apos;t compile user code. The version in fedora 23 works fine.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9438435</commentid>
    <comment_count>3</comment_count>
    <who name="Francis ANDRE">francis.andre.kampbell</who>
    <bug_when>2016-06-21 18:08:28 -0400</bug_when>
    <thetext>May be I missed something, but there is no cmake involved in the packaging of Poco. Which user code are you talking?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9438457</commentid>
    <comment_count>4</comment_count>
    <who name="Stuart Campbell">stuart</who>
    <bug_when>2016-06-21 18:23:12 -0400</bug_when>
    <thetext>Sorry I meant to make variables (muscle memory played tricks with me :)) 

Basically any user code that includes a poco header that makes use of (or in the actually doesn&apos;t) a feature that could be bundled. E.g. some of the XML headers that use expat. 

There are offers that check for the compiler directive that was just removed resulting in poco thinking it is using bundled libs and headers which of course have been removed on fedora.  

Hope this makes sense</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9438463</commentid>
    <comment_count>5</comment_count>
    <who name="Stuart Campbell">stuart</who>
    <bug_when>2016-06-21 18:24:35 -0400</bug_when>
    <thetext>Sorry autocorrect on my phone is being a pain... offers == #ifdefs</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9438477</commentid>
    <comment_count>6</comment_count>
    <who name="Stuart Campbell">stuart</who>
    <bug_when>2016-06-21 18:36:26 -0400</bug_when>
    <thetext>As an example, if you write some C and include &quot;Poco/XML/ParserEngine.h&quot; then it will not compile with packages newer than 1.7.3-2.  It&apos;s just 1.7.3-4 that is broken.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9447893</commentid>
    <comment_count>7</comment_count>
    <who name="Stuart Campbell">stuart</who>
    <bug_when>2016-06-23 14:43:10 -0400</bug_when>
    <thetext>I&apos;ve built some packages that seem to work - https://copr.fedorainfracloud.org/coprs/sic/packages/build/361207/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9448376</commentid>
    <comment_count>8</comment_count>
    <who name="Francis ANDRE">francis.andre.kampbell</who>
    <bug_when>2016-06-23 17:11:56 -0400</bug_when>
    <thetext>Add back in definition of POCO_UNBUNDLED in Foundation/include/Poco/Config.h</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1170390</attachid>
            <date>2016-06-21 16:35:00 -0400</date>
            <delta_ts>2016-06-21 16:35:50 -0400</delta_ts>
            <desc>Patch file for poco.spec</desc>
            <filename>poco.patch</filename>
            <type>text/plain</type>
            <size>316</size>
            <attacher name="Stuart Campbell">stuart</attacher>
            
              <data encoding="base64">MThjMTgKPCBSZWxlYXNlOiAgICAgICAgICA0JXs/ZGlzdH0KLS0tCj4gUmVsZWFzZTogICAgICAg
ICAgNSV7P2Rpc3R9CjczYzczCjwgCi0tLQo+IC9iaW4vc2VkIC1pLm9yaWcgLWUgJ3N8I2VuZGlm
fCNkZWZpbmUgUE9DT19VTkJVTkRMRUQgMVxuXG4jZW5kaWZ8ZycgRm91bmRhdGlvbi9pbmNsdWRl
L1BvY28vQ29uZmlnLmgKNDY3YTQ2OCw0NzAKPiAqIFR1ZSBKdW4gMjEgMjAxNiBTdHVhcnQgQ2Ft
cGJlbGwgPHNpY0BmZWRvcmFwcm9qZWN0Lm9yZz4gLSAxLjcuMy01Cj4gLSBBZGQgYmFjayBpbiBk
ZWZpbml0aW9uIG9mIFBPQ09fVU5CVU5ETEVECj4gCg==
</data>

          </attachment>
      

    </bug>

</bugzilla>