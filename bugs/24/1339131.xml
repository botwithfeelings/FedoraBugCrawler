<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1339131</bug_id>
          
          <creation_ts>2016-05-24 04:37:00 -0400</creation_ts>
          <short_desc>networkctl status: abort, munmap_chunk(): invalid pointer</short_desc>
          <delta_ts>2016-07-23 14:48:41 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>systemd</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jan Včelák">jv+fedora</reporter>
          <assigned_to>systemd-maint</assigned_to>
          <cc>johannbg</cc>
    
    
    <cc>jsynacek</cc>
    
    
    <cc>lnykryn</cc>
    
    
    <cc>mbabacek</cc>
    
    
    <cc>msekleta</cc>
    
    
    <cc>muadda</cc>
    
    
    <cc>soeren.grunewald</cc>
    
    
    <cc>ssahani</cc>
    
    
    <cc>s</cc>
    
    
    <cc>systemd-maint</cc>
    
    
    <cc>zbyszek</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>systemd-229-9.fc24</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-07-23 14:48:41</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9353356</commentid>
    <comment_count>0</comment_count>
    <who name="Jan Včelák">jv+fedora</who>
    <bug_when>2016-05-24 04:37:51 -0400</bug_when>
    <thetext>Description of problem:

&quot;networkctl status&quot; is aborted

Version-Release number of selected component (if applicable):
systemd-229-7.fc24.x86_64

How reproducible:
always

Steps to Reproduce:
1. networkctl status
2.
3.

Actual results:

% networkctl status
●        State: n/a
       Address: 147.x.x.x on eno1
                172.x.x.x on vpn-xxxxx
                2001::xxx on eno1
                2001::xxx on eno1
                2001::xxx on eno1
                2001::xxx on vpn-xxxxx
                2001::xxx on vpn-xxxxx
                2001::xxx on vpn-xxxxx
                fe80::xxx on eno1
                fe80::xxx on vpn-xxxxx
       Gateway: 147.x.x.x (Extreme Networks) on eno1
                fe80::xxx (Extreme Networks) on eno1
                fe80::xxx on vpn-xxxxx
 Route Domains: help
*** Error in `networkctl&apos;: munmap_chunk(): invalid pointer: 0x00005633149af502 ***
======= Backtrace: =========
/lib64/libc.so.6(+0x75dbb)[0x7f60a5a69dbb]
/lib64/libc.so.6(cfree+0x1a8)[0x7f60a5a75c28]
networkctl(+0xd989)[0x5633149a2989]
networkctl(+0x17e66)[0x5633149ace66]
networkctl(+0x4cb5)[0x563314999cb5]
/lib64/libc.so.6(__libc_start_main+0xf1)[0x7f60a5a14731]
networkctl(+0x50b9)[0x56331499a0b9]
======= Memory map: ========
563314995000-5633149b7000 r-xp 00000000 fd:01 528825                     /usr/bin/networkctl
5633149b8000-563314a3a000 r--p 00022000 fd:01 528825                     /usr/bin/networkctl
563314a3a000-563314a3b000 rw-p 000a4000 fd:01 528825                     /usr/bin/networkctl
56331589d000-5633158be000 rw-p 00000000 00:00 0                          [heap]
7f609e9ce000-7f60a5341000 r--p 00000000 fd:01 528259                     /usr/lib/locale/locale-archive
7f60a5341000-7f60a59f4000 r--s 00000000 fd:01 1442463                    /etc/udev/hwdb.bin
7f60a59f4000-7f60a5bad000 r-xp 00000000 fd:01 547450                     /usr/lib64/libc-2.23.so
7f60a5bad000-7f60a5dad000 ---p 001b9000 fd:01 547450                     /usr/lib64/libc-2.23.so
7f60a5dad000-7f60a5db1000 r--p 001b9000 fd:01 547450                     /usr/lib64/libc-2.23.so
7f60a5db1000-7f60a5db3000 rw-p 001bd000 fd:01 547450                     /usr/lib64/libc-2.23.so
7f60a5db3000-7f60a5db7000 rw-p 00000000 00:00 0 
7f60a5db7000-7f60a5dce000 r-xp 00000000 fd:01 547475                     /usr/lib64/libpthread-2.23.so
7f60a5dce000-7f60a5fcd000 ---p 00017000 fd:01 547475                     /usr/lib64/libpthread-2.23.so
7f60a5fcd000-7f60a5fce000 r--p 00016000 fd:01 547475                     /usr/lib64/libpthread-2.23.so
7f60a5fce000-7f60a5fcf000 rw-p 00017000 fd:01 547475                     /usr/lib64/libpthread-2.23.so
7f60a5fcf000-7f60a5fd3000 rw-p 00000000 00:00 0 
7f60a5fd3000-7f60a5fe9000 r-xp 00000000 fd:01 547437                     /usr/lib64/libgcc_s-6.1.1-20160510.so.1
7f60a5fe9000-7f60a61e8000 ---p 00016000 fd:01 547437                     /usr/lib64/libgcc_s-6.1.1-20160510.so.1
7f60a61e8000-7f60a61e9000 r--p 00015000 fd:01 547437                     /usr/lib64/libgcc_s-6.1.1-20160510.so.1
7f60a61e9000-7f60a61ea000 rw-p 00016000 fd:01 547437                     /usr/lib64/libgcc_s-6.1.1-20160510.so.1
7f60a61ea000-7f60a61f1000 r-xp 00000000 fd:01 547479                     /usr/lib64/librt-2.23.so
7f60a61f1000-7f60a63f0000 ---p 00007000 fd:01 547479                     /usr/lib64/librt-2.23.so
7f60a63f0000-7f60a63f1000 r--p 00006000 fd:01 547479                     /usr/lib64/librt-2.23.so
7f60a63f1000-7f60a63f2000 rw-p 00007000 fd:01 547479                     /usr/lib64/librt-2.23.so
7f60a63f2000-7f60a6415000 r-xp 00000000 fd:01 525592                     /usr/lib64/ld-2.23.so
7f60a65f0000-7f60a65f4000 rw-p 00000000 00:00 0 
7f60a660c000-7f60a660d000 rw-p 00000000 00:00 0 
7f60a660d000-7f60a6614000 r--s 00000000 fd:01 656874                     /usr/lib64/gconv/gconv-modules.cache
7f60a6614000-7f60a6615000 rw-p 00000000 00:00 0 
7f60a6615000-7f60a6616000 r--p 00023000 fd:01 525592                     /usr/lib64/ld-2.23.so
7f60a6616000-7f60a6617000 rw-p 00024000 fd:01 525592                     /usr/lib64/ld-2.23.so
7f60a6617000-7f60a6618000 rw-p 00000000 00:00 0 
7ffe001a1000-7ffe001c3000 rw-p 00000000 00:00 0                          [stack]
7ffe001d3000-7ffe001d6000 r--p 00000000 00:00 0                          [vvar]
7ffe001d6000-7ffe001d8000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]
[1]    17361 abort      networkctl status


Expected results:


Additional info:</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9353579</commentid>
    <comment_count>1</comment_count>
    <who name="Jan Synacek">jsynacek</who>
    <bug_when>2016-05-24 05:50:55 -0400</bug_when>
    <thetext>Wow, systemd should really be tested for such trivial use cases.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9353595</commentid>
    <comment_count>2</comment_count>
    <who name="Susant Sahani">ssahani</who>
    <bug_when>2016-05-24 05:56:52 -0400</bug_when>
    <thetext>yes really reproduced.


Program received signal SIGABRT, Aborted.
0x00007ffff740fe55 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:54
54	  return INLINE_SYSCALL (tgkill, 3, pid, selftid, sig);
(gdb) bt
#0  0x00007ffff740fe55 in __GI_raise (sig=sig@entry=6) at ../sysdeps/unix/sysv/linux/raise.c:54
#1  0x00007ffff7411a5a in __GI_abort () at abort.c:89
#2  0x00007ffff7450dc0 in __libc_message (do_abort=do_abort@entry=2, fmt=fmt@entry=0x7ffff7567ac0 &quot;*** Error in `%s&apos;: %s: 0x%s ***\n&quot;) at ../sysdeps/posix/libc_fatal.c:175
#3  0x00007ffff745cc28 in malloc_printerr (ar_ptr=0x0, ptr=&lt;optimized out&gt;, str=0x7ffff7567ae8 &quot;munmap_chunk(): invalid pointer&quot;, action=&lt;optimized out&gt;) at malloc.c:5004
#4  munmap_chunk (p=&lt;optimized out&gt;) at malloc.c:2840
#5  __GI___libc_free (mem=&lt;optimized out&gt;) at malloc.c:2961
#6  0x00005555555619c9 in strv_clear () at src/basic/strv.c:83
#7  strv_free (l=0x5555555f87c0 &lt;options&gt;) at src/basic/strv.c:89
#8  0x000055555556be04 in strv_freep () at ./src/basic/strv.h:37
#9  link_status.lto_priv.140 (argc=&lt;optimized out&gt;, argv=&lt;optimized out&gt;, userdata=&lt;optimized out&gt;) at src/network/networkctl.c:679
#10 0x0000555555558d08 in dispatch_verb (userdata=0x0, verbs=0x7fffffffdc10, argv=0x7fffffffded8, argc=&lt;optimized out&gt;) at src/basic/verbs.c:92
#11 networkctl_main (argv=0x7fffffffded8, argc=&lt;optimized out&gt;) at src/network/networkctl.c:1093
#12 main (argc=&lt;optimized out&gt;, argv=0x7fffffffded8) at src/network/networkctl.c:1106
(gdb) f 9
#9  link_status.lto_priv.140 (argc=&lt;optimized out&gt;, argv=&lt;optimized out&gt;, userdata=&lt;optimized out&gt;) at src/network/networkctl.c:679
679	                _cleanup_strv_free_ char **dns = NULL, **ntp = NULL, **search_domains = NULL, **route_domains;
(gdb) q
A debugging session is active.

	Inferior 1 [process 13639] will be killed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9353603</commentid>
    <comment_count>3</comment_count>
      <attachid>1160970</attachid>
    <who name="Susant Sahani">ssahani</who>
    <bug_when>2016-05-24 05:58:18 -0400</bug_when>
    <thetext>Created attachment 1160970
patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9353639</commentid>
    <comment_count>4</comment_count>
    <who name="Susant Sahani">ssahani</who>
    <bug_when>2016-05-24 06:07:01 -0400</bug_when>
    <thetext>This should fix it .

https://github.com/systemd/systemd/commit/3df9bec57c3e2d96f7e2a25961585cfa609b61eb#diff-eba4caff1d05e6af19a9a14f65736a13</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9392892</commentid>
    <comment_count>5</comment_count>
    <who name="Jan Synacek">jsynacek</who>
    <bug_when>2016-06-07 03:01:17 -0400</bug_when>
    <thetext>*** Bug 1343306 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9457523</commentid>
    <comment_count>6</comment_count>
    <who name="Susant Sahani">ssahani</who>
    <bug_when>2016-06-27 23:55:21 -0400</bug_when>
    <thetext>*** Bug 1350394 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9535452</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-07-21 02:46:52 -0400</bug_when>
    <thetext>systemd-229-9.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-47bda25e7a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9538131</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-07-21 14:52:47 -0400</bug_when>
    <thetext>systemd-229-9.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-47bda25e7a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9543227</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-07-23 14:47:55 -0400</bug_when>
    <thetext>systemd-229-9.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1160970</attachid>
            <date>2016-05-24 05:58:00 -0400</date>
            <delta_ts>2016-05-24 05:58:18 -0400</delta_ts>
            <desc>patch</desc>
            <filename>networkctl.patch</filename>
            <type>text/plain</type>
            <size>725</size>
            <attacher name="Susant Sahani">ssahani</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBpL3NyYy9uZXR3b3JrL25ldHdvcmtjdGwuYyB3L3NyYy9uZXR3b3JrL25ldHdv
cmtjdGwuYwppbmRleCA2MDcyNGZjLi45NTcwNTlmIDEwMDY0NAotLS0gaS9zcmMvbmV0d29yay9u
ZXR3b3JrY3RsLmMKKysrIHcvc3JjL25ldHdvcmsvbmV0d29ya2N0bC5jCkBAIC02NzYsNyArNjc2
LDcgQEAgc3RhdGljIGludCBsaW5rX3N0YXR1cyhpbnQgYXJnYywgY2hhciAqYXJndltdLCB2b2lk
ICp1c2VyZGF0YSkgewogCiAgICAgICAgIGlmIChhcmdjIDw9IDEgJiYgIWFyZ19hbGwpIHsKICAg
ICAgICAgICAgICAgICBfY2xlYW51cF9mcmVlXyBjaGFyICpvcGVyYXRpb25hbF9zdGF0ZSA9IE5V
TEw7Ci0gICAgICAgICAgICAgICAgX2NsZWFudXBfc3Rydl9mcmVlXyBjaGFyICoqZG5zID0gTlVM
TCwgKipudHAgPSBOVUxMLCAqKnNlYXJjaF9kb21haW5zID0gTlVMTCwgKipyb3V0ZV9kb21haW5z
OworICAgICAgICAgICAgICAgIF9jbGVhbnVwX3N0cnZfZnJlZV8gY2hhciAqKmRucyA9IE5VTEws
ICoqbnRwID0gTlVMTCwgKipzZWFyY2hfZG9tYWlucyA9IE5VTEwsICoqcm91dGVfZG9tYWlucyA9
IE5VTEw7CiAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqb25fY29sb3Jfb3BlcmF0aW9uYWws
ICpvZmZfY29sb3Jfb3BlcmF0aW9uYWw7CiAKICAgICAgICAgICAgICAgICBzZF9uZXR3b3JrX2dl
dF9vcGVyYXRpb25hbF9zdGF0ZSgmb3BlcmF0aW9uYWxfc3RhdGUpOwo=
</data>

          </attachment>
      

    </bug>

</bugzilla>