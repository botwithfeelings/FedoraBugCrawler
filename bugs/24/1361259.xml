<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1361259</bug_id>
          
          <creation_ts>2016-07-28 11:40:00 -0400</creation_ts>
          <short_desc>SELinux is preventing vboxdrv.sh from &apos;write&apos; accesses on the directory /etc/udev/rules.d.</short_desc>
          <delta_ts>2016-09-21 04:31:59 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>selinux-policy</component>
          <version>24</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>CURRENTRELEASE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard>abrt_hash:a8d3eeaa16b258e55871bdb2ef662b5b12da15cab02068da7838ee4b84b3a715;VARIANT_ID=workstation;</status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Michał">e.misiek</reporter>
          <assigned_to name="Lukas Vrabec">lvrabec</assigned_to>
          <cc>a.lloyd.flanagan</cc>
    
    
    <cc>big-nikita</cc>
    
    
    <cc>bugzilla</cc>
    
    
    <cc>dominick.grift</cc>
    
    
    <cc>dwalsh</cc>
    
    
    <cc>emailtoflorian</cc>
    
    
    <cc>fabrizio.carmine</cc>
    
    
    <cc>geral</cc>
    
    
    <cc>hmayer</cc>
    
    
    <cc>houssem.amiri2</cc>
    
    
    <cc>iv.istvan.varga</cc>
    
    
    <cc>juniormarcos_oficial</cc>
    
    
    <cc>kyberdrb</cc>
    
    
    <cc>lvrabec</cc>
    
    
    <cc>marlon.ferreira</cc>
    
    
    <cc>mgrepl</cc>
    
    
    <cc>plautrba</cc>
    
    
    <cc>raffaellobertini</cc>
    
    
    <cc>theguru1981</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>selinux-policy-3.13.1-191.15.fc24</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-09-02 11:43:10</cf_last_closed>
          <cf_type>---</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9564063</commentid>
    <comment_count>0</comment_count>
    <who name="Michał">e.misiek</who>
    <bug_when>2016-07-28 11:40:56 -0400</bug_when>
    <thetext>Description of problem:
SELinux is preventing vboxdrv.sh from &apos;write&apos; accesses on the directory /etc/udev/rules.d.

*****  Plugin catchall (100. confidence) suggests   **************************

If aby vboxdrv.sh powinno mieć domyślnie write dostęp do rules.d directory.
Then proszę to zgłosić jako błąd.
Można utworzyć lokalny moduł polityki, aby umożliwić ten dostęp.
Do
allow this access for now by executing:
# ausearch -c &apos;vboxdrv.sh&apos; --raw | audit2allow -M my-vboxdrvsh
# semodule -X 300 -i my-vboxdrvsh.pp

Additional Information:
Source Context                system_u:system_r:init_t:s0
Target Context                system_u:object_r:udev_rules_t:s0
Target Objects                /etc/udev/rules.d [ dir ]
Source                        vboxdrv.sh
Source Path                   vboxdrv.sh
Port                          &lt;Unknown&gt;
Host                          (removed)
Source RPM Packages           
Target RPM Packages           systemd-udev-229-9.fc24.x86_64
Policy RPM                    selinux-policy-3.13.1-191.5.fc24.noarch
Selinux Enabled               True
Policy Type                   targeted
Enforcing Mode                Enforcing
Host Name                     (removed)
Platform                      Linux (removed) 4.6.4-301.fc24.x86_64 #1 SMP Tue
                              Jul 12 11:50:00 UTC 2016 x86_64 x86_64
Alert Count                   4
First Seen                    2016-07-24 20:02:48 CEST
Last Seen                     2016-07-27 17:04:24 CEST
Local ID                      83887255-ea6b-4fad-8eaa-e9c8dd719cdd

Raw Audit Messages
type=AVC msg=audit(1469631864.847:97): avc:  denied  { write } for  pid=1276 comm=&quot;vboxdrv.sh&quot; name=&quot;rules.d&quot; dev=&quot;dm-1&quot; ino=1836324 scontext=system_u:system_r:init_t:s0 tcontext=system_u:object_r:udev_rules_t:s0 tclass=dir permissive=0


Hash: vboxdrv.sh,init_t,udev_rules_t,dir,write

Version-Release number of selected component:
selinux-policy-3.13.1-191.5.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.6.4-301.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9567728</commentid>
    <comment_count>1</comment_count>
    <who name="A. Lloyd Flanagan">a.lloyd.flanagan</who>
    <bug_when>2016-07-29 12:01:12 -0400</bug_when>
    <thetext>Description of problem:
Installed latest version of virtualbox from oracle.com.

Version-Release number of selected component:
selinux-policy-3.13.1-191.5.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.6.4-301.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9628481</commentid>
    <comment_count>2</comment_count>
    <who name="Henrique Mayer">hmayer</who>
    <bug_when>2016-08-18 18:38:22 -0400</bug_when>
    <thetext>*** Bug 1368270 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9633574</commentid>
    <comment_count>3</comment_count>
    <who name="Raffaello Bertini">raffaellobertini</who>
    <bug_when>2016-08-21 10:20:16 -0400</bug_when>
    <thetext>Description of problem:
upgrading virtualbox to 5.1.5 with dnf (used the repo)

(not a bug at all in SELinux, but i was not able to find the RPM &quot;report bug&quot; for fedora24-virtualbox-5.1.5 .... rpm.)

Version-Release number of selected component:
selinux-policy-3.13.1-191.5.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.6.6-300.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9636489</commentid>
    <comment_count>4</comment_count>
    <who name="Bruno José">geral</who>
    <bug_when>2016-08-22 11:32:19 -0400</bug_when>
    <thetext>Description of problem:
O Virtualbox foi instalado e na primeira utilização surge o erro.

Version-Release number of selected component:
selinux-policy-3.13.1-191.12.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.6.6-300.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9639100</commentid>
    <comment_count>5</comment_count>
    <who name="István Varga">iv.istvan.varga</who>
    <bug_when>2016-08-23 03:41:23 -0400</bug_when>
    <thetext>*** Bug 1369339 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9639173</commentid>
    <comment_count>6</comment_count>
    <who name="István Varga">iv.istvan.varga</who>
    <bug_when>2016-08-23 03:52:00 -0400</bug_when>
    <thetext>*** Bug 1369344 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9668232</commentid>
    <comment_count>7</comment_count>
    <who name="Adam">adam.csete</who>
    <bug_when>2016-08-31 12:13:56 -0400</bug_when>
    <thetext>Description of problem:
I do not know the exact method VirtualBox works, but it seems to need the right to wright in the certain rules.d file. 
These rights are needed in my opinion as the software wouldn&apos;t want to write somewhere where it shouldn&apos;t work. If it needs, then it should have access.
I would like to advice you to take a look at access rights needed by VirtualBox, as it may cause critial error in the future
if the program cannot get a &quot;write&quot; access right to certain files and directories. 

Version-Release number of selected component:
selinux-policy-3.13.1-191.13.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.6.7-300.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9676790</commentid>
    <comment_count>8</comment_count>
    <who name="MArlon">marlon.ferreira</who>
    <bug_when>2016-09-03 02:50:00 -0400</bug_when>
    <thetext>Description of problem:
SELinux is preventing vboxdrv.sh from &apos;write&apos; accesses on the directory /etc/udev/rules.d.

*****  Plugin catchall (100. confidence) suggests   **************************

allow this access for now by executing:
# ausearch -c &apos;vboxdrv.sh&apos; --raw | audit2allow -M my-vboxdrvsh
# semodule -X 300 -i my-vboxdrvsh.pp

Additional Information:
Source Context                system_u:system_r:init_t:s0
Target Context                system_u:object_r:udev_rules_t:s0
Target Objects                /etc/udev/rules.d [ dir ]
Source                        vboxdrv.sh
Source Path                   vboxdrv.sh
Port                          &lt;Unknown&gt;
Host                          (removed)
Source RPM Packages           
Target RPM Packages           systemd-udev-229-13.fc24.x86_64
Policy RPM                    selinux-policy-3.13.1-191.13.fc24.noarch
Selinux Enabled               True
Policy Type                   targeted
Enforcing Mode                Enforcing
Host Name                     (removed)
Platform                      Linux (removed) 4.6.7-300.fc24.x86_64 #1 SMP Wed
                              Aug 17 18:48:43 UTC 2016 x86_64 x86_64
Alert Count                   21
First Seen                    2016-08-26 19:42:26 BRT
Last Seen                     2016-09-02 12:30:00 BRT
Local ID                      d507c5a0-041c-4514-8c27-aace99ea1eea

Raw Audit Messages
type=AVC msg=audit(1472830200.134:99): avc:  denied  { write } for  pid=764 comm=&quot;vboxdrv.sh&quot; name=&quot;rules.d&quot; dev=&quot;dm-0&quot; ino=2884888 scontext=system_u:system_r:init_t:s0 tcontext=system_u:object_r:udev_rules_t:s0 tclass=dir permissive=0


Hash: vboxdrv.sh,init_t,udev_rules_t,dir,write

Version-Release number of selected component:
selinux-policy-3.13.1-191.13.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.6.7-300.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9677017</commentid>
    <comment_count>9</comment_count>
    <who name="Raffaello Bertini">raffaellobertini</who>
    <bug_when>2016-09-03 10:18:30 -0400</bug_when>
    <thetext>Description of problem:
/sbin/vboxconfig

Version-Release number of selected component:
selinux-policy-3.13.1-191.13.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.6.7-300.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9677805</commentid>
    <comment_count>10</comment_count>
    <who name="Raffaello Bertini">raffaellobertini</who>
    <bug_when>2016-09-04 12:57:24 -0400</bug_when>
    <thetext>Description of problem:
vagrant status

Version-Release number of selected component:
selinux-policy-3.13.1-191.14.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.7.2-201.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9678221</commentid>
    <comment_count>11</comment_count>
    <who name="Kalimboo">juniormarcos_oficial</who>
    <bug_when>2016-09-04 22:32:48 -0400</bug_when>
    <thetext>Description of problem:
Problemas.

Version-Release number of selected component:
selinux-policy-3.13.1-191.14.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.7.2-201.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9682454</commentid>
    <comment_count>12</comment_count>
    <who name="Nikita Bige">big-nikita</who>
    <bug_when>2016-09-06 09:14:23 -0400</bug_when>
    <thetext>*** Bug 1373516 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9691540</commentid>
    <comment_count>13</comment_count>
    <who name="Flo H.">emailtoflorian</who>
    <bug_when>2016-09-08 12:54:29 -0400</bug_when>
    <thetext>Description of problem:
installation of VB 5-1 from oracle repo apparently runs a script that is blocked by SELinux. 

Version-Release number of selected component:
selinux-policy-3.13.1-191.14.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.7.2-201.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9709069</commentid>
    <comment_count>14</comment_count>
    <who name="Andrej Šišila">kyberdrb</who>
    <bug_when>2016-09-14 20:07:26 -0400</bug_when>
    <thetext>Description of problem:
Installed newest version of Virtualbox (5.1.6 r110634) and opened it. All VMs are fully functional, though.

Version-Release number of selected component:
selinux-policy-3.13.1-191.14.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.7.3-200.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9729000</commentid>
    <comment_count>15</comment_count>
    <who name="Carmine Fabrizio">fabrizio.carmine</who>
    <bug_when>2016-09-21 04:31:59 -0400</bug_when>
    <thetext>*** Bug 1377978 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>