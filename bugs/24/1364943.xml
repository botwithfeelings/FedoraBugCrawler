<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1364943</bug_id>
          
          <creation_ts>2016-08-08 05:21:00 -0400</creation_ts>
          <short_desc>Flex 2.6.0 generates C90-incompatible code</short_desc>
          <delta_ts>2016-12-18 20:25:29 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>flex</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          <dependson>1318074</dependson>
          <blocked>1405384</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Daniel Vrátil">me</reporter>
          <assigned_to name="Patsy Franklin">pfrankli</assigned_to>
          <cc>nfd</cc>
    
    
    <cc>pfrankli</cc>
    
    
    <cc>pmachata</cc>
    
    
    <cc>rdieter</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>rawhide and flex-2.6.0-3.f25, flex-2.6.0-3.f24 flex-2.6.0-3.fc25 flex-2.6.0-3.fc24 flex-2.6.0-3.fc23</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-12-18 20:25:29</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9592496</commentid>
    <comment_count>0</comment_count>
    <who name="Daniel Vrátil">me</who>
    <bug_when>2016-08-08 05:21:25 -0400</bug_when>
    <thetext>Description of problem:

flex 2.6.0 generates a code that contains C++-styled comments, causing build in C90 mode to fail:

/builddir/build/BUILD/solid-5.25.0/x86_64-redhat-linux-gnu/src/solid/predicate_lexer.c:1587:21: error: C++ style comments are not allowed in ISO C90
   num_to_alloc = 1; // After all that talk, this was set to 1 anyways...


This issue was addressed in flex 2.6.1: https://github.com/westes/flex/commit/07d89829cce4527c7614a34642d4b2c2ef5d6005

Version-Release number of selected component (if applicable):
2.6.0-2.fc26


How reproducible:
Always



Additional info:
Failed build: http://koji.fedoraproject.org/koji/taskinfo?taskID=15171444</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9703032</commentid>
    <comment_count>1</comment_count>
    <who name="Rex Dieter">rdieter</who>
    <bug_when>2016-09-13 09:16:55 -0400</bug_when>
    <thetext>ping, any objection to updating to flex-2.6.1 that includes the fix?

If not, I&apos;ll be happy to help do it (in a few days time).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9703530</commentid>
    <comment_count>2</comment_count>
    <who name="Patsy Franklin">pfrankli</who>
    <bug_when>2016-09-13 10:51:21 -0400</bug_when>
    <thetext>Hi Rex,

I was hoping to include the changes to add the .so files with the 2.6.1 update.
I&apos;m hoping to get reviewer approval on those changes before the end of this week.  If not, I will be happy to do the 2.6.1 rebase this weekend and add the support for the .so files as an update.

Is that acceptable?

Thanks,
Patsy</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9704383</commentid>
    <comment_count>3</comment_count>
    <who name="Rex Dieter">rdieter</who>
    <bug_when>2016-09-13 14:12:09 -0400</bug_when>
    <thetext>that&apos;s great news, very acceptable, thank you.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9805894</commentid>
    <comment_count>4</comment_count>
    <who name="Rex Dieter">rdieter</who>
    <bug_when>2016-10-19 15:41:54 -0400</bug_when>
    <thetext>ping, this (still) affects f24&apos;s flex-2.6.0-2.fc24.x86_64, possible for an update or fix there too?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9807166</commentid>
    <comment_count>5</comment_count>
    <who name="Fredy Neeser">nfd</who>
    <bug_when>2016-10-20 03:48:50 -0400</bug_when>
    <thetext>Hi,

I&apos;m affected by this bug, which causes Plasma build failures for KF5 packages such as kf5-kservice, kf5-solid ...

The reason I am trying to build Plasma from sources is that I want to debug a new Plasma bug, which makes multiscreen hardly usable for me since I upgraded to Fedora 24 with Plasma 5.8.0 ... 5.8.2.

It would be great to get the flex 2.6.1 update for f24 -- otherwise, I&apos;d have to patch the KDE sources myself to work around the flex issue.

Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9808740</commentid>
    <comment_count>6</comment_count>
    <who name="Patsy Franklin">pfrankli</who>
    <bug_when>2016-10-20 11:40:20 -0400</bug_when>
    <thetext>Hi,

I&apos;ll try to get the fix pushed to Fedora 25 and 24 today.

-Patsy</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9810031</commentid>
    <comment_count>7</comment_count>
    <who name="Patsy Franklin">pfrankli</who>
    <bug_when>2016-10-20 22:48:58 -0400</bug_when>
    <thetext>Fredy,

Pushed to Fedora 25 and 24.

Fedora updates issued.  

Please let me know if this resolves your build problems or if you need additional fixes in 2.6.1.

Thanks,
Patsy</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9810134</commentid>
    <comment_count>8</comment_count>
    <who name="Patsy Franklin">pfrankli</who>
    <bug_when>2016-10-21 00:17:12 -0400</bug_when>
    <thetext>I pushed the patch that replaces the C++ style comment with a C style comment. I did not rebase to 2.6.1 as we usually rebase in rawhide and patch in older releases.  That being said, if you need additional patches, I am happy to provide them to fix your builds.

I provided the patch on both f25 and f24 for consistency.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9810576</commentid>
    <comment_count>9</comment_count>
    <who name="Fredy Neeser">nfd</who>
    <bug_when>2016-10-21 04:53:55 -0400</bug_when>
    <thetext>Patsy,

Thanks for the update! Building kf5_kservice and kf5_solid is now working straight from KDE upstream sources -- I no longer have to patch the CMakeLists.txt files with

  set(CMAKE_C_FLAGS &quot;${CMAKE_C_FLAGS} -std=c99&quot;)

to force C99 compilation.

B.t.w., I found the RPM through
  https://bodhi.fedoraproject.org/updates/FEDORA-2016-92370b4435
and downloaded it from
  http://koji.fedoraproject.org/koji/buildinfo?buildID=811566

  $ rpm -q flex
  flex-2.6.0-3.fc24.x86_64

so I guess it still needs to be pushed to updates-testing.

Regards,
Fredy


PS: For anyone who previously had to patch CMakeLists.txt -- I had to wipe the
  kde/build/kservice
  kde/build/solid
directories to force kdesrc-build to regenerate the code using flex.

Then the build succeeded:

$ kdesrc-build --include-dependencies kservice
Updating kde-build-metadata (to branch master)
 * Downloading projects.kde.org project database...
...
Building kservice from frameworks (10/10)
        Updating kservice (to branch master)
        No source update, but the build directory doesn&apos;t exist
        Source update complete for kservice: no files affected
        Preparing build system for kservice.
        Running cmake...
        Compiling... succeeded (after 11 seconds)
        Installing.. succeeded (after 0 seconds)

&lt;&lt;&lt;  PACKAGES SUCCESSFULLY BUILT  &gt;&gt;&gt;
...
kservice

:-)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9811453</commentid>
    <comment_count>10</comment_count>
    <who name="Patsy Franklin">pfrankli</who>
    <bug_when>2016-10-21 09:47:38 -0400</bug_when>
    <thetext>Fredy,  Thank you very much for the feedback!  


Rex, Daniel,

Please let me know if this update does not fix the build failures you were seeing.

Thanks!
Patsy</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9812741</commentid>
    <comment_count>11</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-21 23:54:00 -0400</bug_when>
    <thetext>flex-2.6.0-3.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-edd72cee3d</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9813004</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-22 07:53:57 -0400</bug_when>
    <thetext>flex-2.6.0-3.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-92370b4435</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9813796</commentid>
    <comment_count>13</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-23 18:52:48 -0400</bug_when>
    <thetext>flex-2.6.0-3.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9856820</commentid>
    <comment_count>14</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-03 19:53:39 -0400</bug_when>
    <thetext>flex-2.6.0-3.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9972534</commentid>
    <comment_count>15</comment_count>
    <who name="Rex Dieter">rdieter</who>
    <bug_when>2016-12-09 12:47:31 -0500</bug_when>
    <thetext>fyi, latest f23 flex build is affected by this too, I&apos;ll take the liberty of cherry-picking the fix, since it&apos;s blocking other builds, see also bug #1400242</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9972630</commentid>
    <comment_count>16</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-09 13:51:14 -0500</bug_when>
    <thetext>flex-2.6.0-3.fc23 has been submitted as an update to Fedora 23. https://bodhi.fedoraproject.org/updates/FEDORA-2016-173dec4c67</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9974267</commentid>
    <comment_count>17</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-10 22:59:17 -0500</bug_when>
    <thetext>flex-2.6.0-3.fc23 has been pushed to the Fedora 23 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-173dec4c67</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9996809</commentid>
    <comment_count>18</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-18 20:25:29 -0500</bug_when>
    <thetext>flex-2.6.0-3.fc23 has been pushed to the Fedora 23 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>