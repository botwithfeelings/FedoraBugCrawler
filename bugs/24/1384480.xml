<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1384480</bug_id>
          
          <creation_ts>2016-10-13 07:23:00 -0400</creation_ts>
          <short_desc>Incorrect remainder calculation in gmpy2 using MPFR-3.1.4-1</short_desc>
          <delta_ts>2016-10-28 15:51:07 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>mpfr</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="spital">spital</reporter>
          <assigned_to name="Frantisek Kluknavsky">fkluknav</assigned_to>
          <cc>fkluknav</cc>
    
    
    <cc>rdieter</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>mpfr-3.1.5-1.fc24</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-10-28 15:51:07</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9788191</commentid>
    <comment_count>0</comment_count>
    <who name="spital">spital</who>
    <bug_when>2016-10-13 07:23:17 -0400</bug_when>
    <thetext>Description of problem:

Assertion failed for

import gmpy2;x=14098670982472701L;mod=(2L**27-1);assert (x % mod) == gmpy2.remainder(x,mod)

Version-Release number of selected component (if applicable):
python2-gmpy2.x86_64                          2.0.8-1.fc24
mpfr-devel.x86_64                           3.1.4-1.fc24

How reproducible:

see description

Actual results:

assertion failed

Expected results:

passed

Additional info:

Please update to the latest upstream,
mpfr-3.1.5 with gmpy2-2.0.8 compiled from source works fine.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9790484</commentid>
    <comment_count>1</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-14 00:55:48 -0400</bug_when>
    <thetext>mpfr-3.1.5-1.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-2a8c61e1cb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9790922</commentid>
    <comment_count>2</comment_count>
    <who name="spital">spital</who>
    <bug_when>2016-10-14 03:58:18 -0400</bug_when>
    <thetext>Did not work for me :

dnf remove python2-gmpy2 mpfr-devel

dnf --enablerepo=updates-testing --releasever=25 install python2-gmpy2-2.0.8-2.fc25 mpfr-devel-3.1.5-1.fc25

python

see OP</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9791105</commentid>
    <comment_count>3</comment_count>
    <who name="Frantisek Kluknavsky">fkluknav</who>
    <bug_when>2016-10-14 04:46:05 -0400</bug_when>
    <thetext>mpfr 3.1.5 for fedora 24 is on the way.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9793860</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-14 17:23:48 -0400</bug_when>
    <thetext>mpfr-3.1.5-1.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-6c9d0d9a4f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9795191</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-16 14:51:12 -0400</bug_when>
    <thetext>mpfr-3.1.5-1.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9795924</commentid>
    <comment_count>6</comment_count>
    <who name="spital">spital</who>
    <bug_when>2016-10-17 03:03:11 -0400</bug_when>
    <thetext>
Still broken, I am thrilled with the quality assurance.

Please kindly try to run commands I posted.

https://bugzilla.redhat.com/show_bug.cgi?id=1384480#c2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9797497</commentid>
    <comment_count>7</comment_count>
    <who name="Frantisek Kluknavsky">fkluknav</who>
    <bug_when>2016-10-17 10:24:13 -0400</bug_when>
    <thetext>gmpy2.remainder(gmpy2.mpfr(&apos;14098670982472701&apos;),gmpy2.mpfr(&apos;134217727&apos;))

-&gt; mpfr(&apos;33159505.0&apos;)



with gmpy2.local_context(gmpy2.context(), precision=100) as ctx:
    gmpy2.remainder(gmpy2.mpfr(&apos;14098670982472701&apos;),gmpy2.mpfr(&apos;134217727&apos;))

-&gt; mpfr(&apos;33159506.0&apos;,100)

Voila!

Please kindly think before you type and RTFM before you file a bug. Otherwise you only get ridiculed and your bug reports closed (sometimes even the meaningful ones once you build your reputation).
Try to file a bug against a correct component. If you think mpfr is buggy, prepare a reproducer using mpfr, not some weird wrapper library written in some funny language which even changes behavior of its division operator from time to time. 
Read some basics about floating point numbers, like https://ece.uwaterloo.ca/~dwharder/NumericalAnalysis/02Numerics/Double/paper.pdf or https://people.eecs.berkeley.edu/~wkahan/
If your number exceeds approximately 2^50, you will get wrong results unless you do something with precision.
If you want quality assurance, pay for rhel.
And again, read the documentation before you file a bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9797559</commentid>
    <comment_count>8</comment_count>
    <who name="Frantisek Kluknavsky">fkluknav</who>
    <bug_when>2016-10-17 10:40:36 -0400</bug_when>
    <thetext>echo &apos;scale=100;l(14098670982472701)/l(2)&apos; | bc -l
-&gt; 53.646...

Your number takes more than 53 bits. Setting 54 bits by gmpy2.local_context(gmpy2.context(), precision=54) is sufficient for a correct result, so I guess the computation done by mpfr is correct. If you think otherwise, please explain (of course I might be wrong).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9830389</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-28 15:51:07 -0400</bug_when>
    <thetext>mpfr-3.1.5-1.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>