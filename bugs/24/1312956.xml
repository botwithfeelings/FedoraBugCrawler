<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1312956</bug_id>
          
          <creation_ts>2016-02-29 10:54:00 -0500</creation_ts>
          <short_desc>langpack split results in all locales being lost on update/upgrade</short_desc>
          <delta_ts>2016-03-01 03:34:33 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>glibc</component>
          <version>24</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>CURRENTRELEASE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>urgent</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1230433</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Adam Williamson">awilliam</reporter>
          <assigned_to name="Carlos O&apos;Donell">codonell</assigned_to>
          <cc>arjun.is</cc>
    
    
    <cc>codonell</cc>
    
    
    <cc>dj</cc>
    
    
    <cc>fweimer</cc>
    
    
    <cc>jakub</cc>
    
    
    <cc>law</cc>
    
    
    <cc>mfabian</cc>
    
    
    <cc>pfrankli</cc>
    
    
    <cc>pnemade</cc>
    
    
    <cc>rhbz2</cc>
    
    
    <cc>robatino</cc>
    
    
    <cc>sgallagh</cc>
    
    
    <cc>sid</cc>
    
    
    <cc>zbyszek</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-03-01 03:34:33</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9106247</commentid>
    <comment_count>0</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2016-02-29 10:54:05 -0500</bug_when>
    <thetext>The glibc langpack split was implemented in such a way that people with Fedora 24 or Rawhide installs who updated their systems in the usual way lost all their locales.

This leads to various other bugs, e.g. gnome-terminal failing to start up and ssh failing to work. Realistically, though, I don&apos;t think we can call all of those cases bugs and say everything has to work with C locale, it&apos;s been expected for years that appropriate locales for the system will be available and at least in the short term we need to make sure they still will be.

I&apos;m nominating this as a Beta blocker, per criteria &quot;For each one of the release-blocking package sets, it must be possible to successfully complete a direct upgrade from fully updated installations of the last two stable Fedora releases with that package set installed... The upgraded system must meet all release criteria.&quot; (Beta) and &quot;It must be possible to run the default web browser and a terminal application from all release-blocking desktop environments.&quot; (Alpha) - upgraded systems will not &quot;meet all release criteria&quot; since GNOME Terminal will not launch.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9106286</commentid>
    <comment_count>1</comment_count>
    <who name="Florian Weimer">fweimer</who>
    <bug_when>2016-02-29 11:01:33 -0500</bug_when>
    <thetext>Is this something that fedup could address?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9106312</commentid>
    <comment_count>2</comment_count>
    <who name="Stephen Gallagher">sgallagh</who>
    <bug_when>2016-02-29 11:06:30 -0500</bug_when>
    <thetext>(In reply to Florian Weimer from comment #1)
&gt; Is this something that fedup could address?

We already have a fix for this being tested in glibc. It&apos;s being fixed by appropriate Requires, Provides and Suggests in the spec file.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9106414</commentid>
    <comment_count>3</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2016-02-29 11:35:57 -0500</bug_when>
    <thetext>fedup doesn&apos;t exist any more, either, so no. :)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9106776</commentid>
    <comment_count>4</comment_count>
    <who name="Carlos O&apos;Donell">codonell</who>
    <bug_when>2016-02-29 13:38:37 -0500</bug_when>
    <thetext>(In reply to Adam Williamson from comment #3)
&gt; fedup doesn&apos;t exist any more, either, so no. :)

Sure, dnf system-upgrade :-}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9106797</commentid>
    <comment_count>5</comment_count>
    <who name="Zbigniew JÄ™drzejewski-Szmek">zbyszek</who>
    <bug_when>2016-02-29 13:45:53 -0500</bug_when>
    <thetext>&gt; Realistically, though, I don&apos;t think we can call all of those cases bugs and say everything has to work with C locale

I don&apos;t think it reasonable to require locales to be always installed. For most packages silently continuing without any translation is the right thing to do. There may be exceptions, like software which outputs financial numerical data and is useless/misleading without i18n. But gnome-terminal doesn&apos;t fall into this category. Crashing on missing locales is simply a bug in gnome-terminal and should be fixed there.

(This is not to say that glibc might not want to install more locales on upgrade.)

&gt; Is this something that fedup could address?

It would be really terrible if dnf system-upgrade had to grow those kinds of hacks. So far it hasn&apos;t any. This allows it to remain simple to implement and understand. In fact the only package-specific logic that dnf system-upgrade has is for the kernel, and even that is a source of problems, and something that will hopefully be removed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9106867</commentid>
    <comment_count>6</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2016-02-29 14:06:18 -0500</bug_when>
    <thetext>I should have said realistically in the short term. Maybe it&apos;s an interesting exercise for someone to go through a bunch of apps and find ones that don&apos;t work without locales and fix them, but for practical purposes for Fedora 24, the sensible thing to do is make sure locales are available in the situations where they&apos;ve always been available before and we don&apos;t have any urgent need to get rid of them.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9106890</commentid>
    <comment_count>7</comment_count>
    <who name="Carlos O&apos;Donell">codonell</who>
    <bug_when>2016-02-29 14:14:03 -0500</bug_when>
    <thetext>(In reply to Adam Williamson from comment #6)
&gt; I should have said realistically in the short term. Maybe it&apos;s an
&gt; interesting exercise for someone to go through a bunch of apps and find ones
&gt; that don&apos;t work without locales and fix them, but for practical purposes for
&gt; Fedora 24, the sensible thing to do is make sure locales are available in
&gt; the situations where they&apos;ve always been available before and we don&apos;t have
&gt; any urgent need to get rid of them.

We do have an urgent need to get rid of them, but it&apos;s entirely in another use case. So I agree with you 100% on the solution, the glibc team will make sure that by default the upgrade, dnf system-upgrade, and other various upgrades (when no language is selected via langpacks) produce the same system you had before the upgrade.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9106899</commentid>
    <comment_count>8</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2016-02-29 14:16:01 -0500</bug_when>
    <thetext>&quot;We do have an urgent need to get rid of them, but it&apos;s entirely in another use case.&quot;

Right, that&apos;s what I meant by &quot;the situations where...we don&apos;t have any urgent need to get rid of them&quot;. :)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9109188</commentid>
    <comment_count>9</comment_count>
    <who name="Carlos O&apos;Donell">codonell</who>
    <bug_when>2016-03-01 03:34:13 -0500</bug_when>
    <thetext>With glibc-2.23.90-3.fc25 and glibc-2.23.1-5.fc24 we have now fixed
the issue in several important ways.

See:
https://lists.fedoraproject.org/archives/list/devel@lists.fedoraproject.org/message/WXOOUGA3YCB2O4O77JGLSJZ25BS4RFK5/

Upgrades now properly install glibc-all-langpacks and preserver the &quot;all languages installed&quot; behaviour by default.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>