<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1315630</bug_id>
          
          <creation_ts>2016-03-08 04:42:00 -0500</creation_ts>
          <short_desc>FTBFS due &quot;error: nonnull argument &apos;this&apos; compared to NULL&quot;</short_desc>
          <delta_ts>2016-04-03 13:57:52 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>libyui</component>
          <version>24</version>
          <rep_platform>s390x</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>467765</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Dan Horák">dan</reporter>
          <assigned_to name="Björn &quot;besser82&quot; Esser">besser82</assigned_to>
          <cc>besser82</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>libyui-3.2.5-1.fc24</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-04-03 13:57:52</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9128224</commentid>
    <comment_count>0</comment_count>
      <attachid>1134081</attachid>
    <who name="Dan Horák">dan</who>
    <bug_when>2016-03-08 04:42:13 -0500</bug_when>
    <thetext>Created attachment 1134081
preprocessed source file

build of recent libyui fails on s390(x) due &quot;error: nonnull argument &apos;this&apos; compared to NULL&quot;

from build.log
...
cd /home/sharkcz/libyui/libyui-libyui-master-3.2.1/build-s390x.fc25/src &amp;&amp; /usr/bin/c++   -DVERSION=\&quot;3.2.1\&quot; -D_XOPEN_SOURCE=500 -Dyui_EXPORTS -I/home/sharkcz/libyui/libyui-libyui-master-3.2.1/src -I/home/sharkcz/libyui/libyui-libyui-master-3.2.1/build-s390x.fc25/src  -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -m64 -march=z9-109 -mtune=z10 -std=c++0x -fmessage-length=0 -Wall -Werror -fPIC   -o CMakeFiles/yui.dir/YDialog.cc.o -c /home/sharkcz/libyui/libyui-libyui-master-3.2.1/src/YDialog.cc
In file included from /home/sharkcz/libyui/libyui-libyui-master-3.2.1/src/YWidget.h:34:0,
                 from /home/sharkcz/libyui/libyui-libyui-master-3.2.1/src/YSingleChildContainerWidget.h:28,
                 from /home/sharkcz/libyui/libyui-libyui-master-3.2.1/src/YDialog.h:29,
                 from /home/sharkcz/libyui/libyui-libyui-master-3.2.1/src/YDialog.cc:32:
/home/sharkcz/libyui/libyui-libyui-master-3.2.1/src/YDialog.cc: In member function &apos;bool YDialog::destroy(bool)&apos;:
/home/sharkcz/libyui/libyui-libyui-master-3.2.1/src/YUIException.h:179:18: error: nonnull argument &apos;this&apos; compared to NULL [-Werror=nonnull-compare]
  if ( ! (WIDGET) || ! (WIDGET)-&gt;isValid() ) \
       ~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~
/home/sharkcz/libyui/libyui-libyui-master-3.2.1/src/YDialog.cc:254:5: note: in expansion of macro &apos;YUI_CHECK_WIDGET&apos;
     YUI_CHECK_WIDGET( this );
     ^~~~~~~~~~~~~~~~
cc1plus: all warnings being treated as errors
src/CMakeFiles/yui.dir/build.make:1001: recipe for target &apos;src/CMakeFiles/yui.dir/YDialog.cc.o&apos; failed
make[2]: *** [src/CMakeFiles/yui.dir/YDialog.cc.o] Error 1
make[2]: *** Waiting for unfinished jobs....

for complete logs please see http://s390.koji.fedoraproject.org/koji/taskinfo?taskID=2143933

Version-Release number of selected component (if applicable):
libyui-3.2.1-5.fc24
gcc-6.0.0-0.15.fc24.s390x</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9132250</commentid>
    <comment_count>1</comment_count>
    <who name="Dan Horák">dan</who>
    <bug_when>2016-03-09 04:19:46 -0500</bug_when>
    <thetext>very likely https://gcc.gnu.org/bugzilla/show_bug.cgi?id=70143 as it coincides with bug 1315191 (and others)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9157059</commentid>
    <comment_count>2</comment_count>
    <who name="Dan Horák">dan</who>
    <bug_when>2016-03-17 12:14:26 -0400</bug_when>
    <thetext>still present with gcc-6.0.0-0.16.fc24.s390x, so rather a different issue</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9187145</commentid>
    <comment_count>3</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-03-29 07:01:20 -0400</bug_when>
    <thetext>libyui-qt-2.46.21-1.fc24 libyui-gtk-2.44.7-1.fc24 libyui-ncurses-2.47.6-1.fc24 libyui-bindings-1.1.1-1.fc24 libyui-3.2.4-1.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-043b1ee852</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9189712</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-03-29 20:27:52 -0400</bug_when>
    <thetext>libyui-3.2.4-1.fc24, libyui-bindings-1.1.1-1.fc24, libyui-gtk-2.44.7-1.fc24, libyui-ncurses-2.47.6-1.fc24, libyui-qt-2.46.21-1.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-043b1ee852</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9190649</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-03-30 04:38:08 -0400</bug_when>
    <thetext>libyui-3.2.4-2.fc24 libyui-bindings-1.1.1-1.fc24 libyui-gtk-2.44.7-1.fc24 libyui-ncurses-2.47.6-1.fc24 libyui-qt-2.46.21-1.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-043b1ee852</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9193393</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-03-30 18:27:25 -0400</bug_when>
    <thetext>libyui-3.2.5-1.fc24, libyui-bindings-1.1.1-3.fc24, libyui-gtk-2.44.7-1.fc24, libyui-ncurses-2.47.6-1.fc24, libyui-qt-2.46.21-1.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-043b1ee852</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9202764</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-04-03 13:57:44 -0400</bug_when>
    <thetext>libyui-3.2.5-1.fc24, libyui-bindings-1.1.1-3.fc24, libyui-gtk-2.44.7-1.fc24, libyui-ncurses-2.47.6-1.fc24, libyui-qt-2.46.21-1.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1134081</attachid>
            <date>2016-03-08 04:42:00 -0500</date>
            <delta_ts>2016-03-08 04:42:13 -0500</delta_ts>
            <desc>preprocessed source file</desc>
            <filename>YDialog.i</filename>
            <type>text/plain</type>
            <size>1574433</size>
            <attacher name="Dan Horák">dan</attacher>
            
              <data encoding="base64">IyAxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMv
WURpYWxvZy5jYyIKIyAxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rl
ci0zLjIuMS9zcmMvLyIKIyAxICI8YnVpbHQtaW4+IgojIDEgIjxjb21tYW5kLWxpbmU+IgojIDEg
Ii91c3IvaW5jbHVkZS9zdGRjLXByZWRlZi5oIiAxIDMgNAojIDEgIjxjb21tYW5kLWxpbmU+IiAy
CiMgMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3Jj
L1lEaWFsb2cuY2MiCiMgMjYgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFz
dGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIgojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvbGlz
dCIgMSAzCiMgNTggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvbGlzdCIgMwogICAgICAgCiMgNTkg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvbGlzdCIgMwoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvc3RsX2FsZ29iYXNlLmgiIDEgMwojIDU5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvc3RsX2FsZ29iYXNlLmgiIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3MzOTB4
LXJlZGhhdC1saW51eC9iaXRzL2MrK2NvbmZpZy5oIiAxIDMKCgojIDEgIi91c3IvaW5jbHVkZS9i
aXRzL3dvcmRzaXplLmgiIDEgMyA0CiMgNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1y
ZWRoYXQtbGludXgvYml0cy9jKytjb25maWcuaCIgMiAzCiMgMjA4NiAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9jKytjb25maWcuaCIgMwoKIyAyMDg2ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2MrK2NvbmZpZy5o
IiAzCm5hbWVzcGFjZSBzdGQKewogIHR5cGVkZWYgbG9uZyB1bnNpZ25lZCBpbnQgc2l6ZV90Owog
IHR5cGVkZWYgbG9uZyBpbnQgcHRyZGlmZl90OwoKCiAgdHlwZWRlZiBkZWNsdHlwZShudWxscHRy
KSBudWxscHRyX3Q7Cgp9CiMgMjEwOCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRo
YXQtbGludXgvYml0cy9jKytjb25maWcuaCIgMwpuYW1lc3BhY2Ugc3RkCnsKICBpbmxpbmUgbmFt
ZXNwYWNlIF9fY3h4MTEgX19hdHRyaWJ1dGVfXygoX19hYmlfdGFnX18gKCJjeHgxMSIpKSkgeyB9
Cn0KbmFtZXNwYWNlIF9fZ251X2N4eAp7CiAgaW5saW5lIG5hbWVzcGFjZSBfX2N4eDExIF9fYXR0
cmlidXRlX18oKF9fYWJpX3RhZ19fICgiY3h4MTEiKSkpIHsgfQp9CiMgMjI4MyAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9jKytjb25maWcuaCIgMwpuYW1l
c3BhY2Ugc3RkCnsKICBpbmxpbmUgbmFtZXNwYWNlIF9fZ251X2N4eF9sZGJsMTI4IHsgfQp9CiMg
MjM4NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9jKytj
b25maWcuaCIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvczM5MHgtcmVkaGF0LWxpbnV4
L2JpdHMvb3NfZGVmaW5lcy5oIiAxIDMKIyAzOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkw
eC1yZWRoYXQtbGludXgvYml0cy9vc19kZWZpbmVzLmgiIDMKIyAxICIvdXNyL2luY2x1ZGUvZmVh
dHVyZXMuaCIgMSAzIDQKIyAzNjggIi91c3IvaW5jbHVkZS9mZWF0dXJlcy5oIiAzIDQKIyAxICIv
dXNyL2luY2x1ZGUvc3lzL2NkZWZzLmgiIDEgMyA0CiMgNDEwICIvdXNyL2luY2x1ZGUvc3lzL2Nk
ZWZzLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3dvcmRzaXplLmgiIDEgMyA0CiMgNDEx
ICIvdXNyL2luY2x1ZGUvc3lzL2NkZWZzLmgiIDIgMyA0CiMgMzY5ICIvdXNyL2luY2x1ZGUvZmVh
dHVyZXMuaCIgMiAzIDQKIyAzOTIgIi91c3IvaW5jbHVkZS9mZWF0dXJlcy5oIiAzIDQKIyAxICIv
dXNyL2luY2x1ZGUvZ251L3N0dWJzLmgiIDEgMyA0CgoKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRz
L3dvcmRzaXplLmgiIDEgMyA0CiMgNiAiL3Vzci9pbmNsdWRlL2dudS9zdHVicy5oIiAyIDMgNAoK
CgoKCiMgMSAiL3Vzci9pbmNsdWRlL2dudS9zdHVicy02NC5oIiAxIDMgNAojIDEyICIvdXNyL2lu
Y2x1ZGUvZ251L3N0dWJzLmgiIDIgMyA0CiMgMzkzICIvdXNyL2luY2x1ZGUvZmVhdHVyZXMuaCIg
MiAzIDQKIyA0MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0
cy9vc19kZWZpbmVzLmgiIDIgMwojIDIzODYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvczM5MHgt
cmVkaGF0LWxpbnV4L2JpdHMvYysrY29uZmlnLmgiIDIgMwoKCiMgMSAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9jcHVfZGVmaW5lcy5oIiAxIDMKIyAyMzg5
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2MrK2NvbmZp
Zy5oIiAyIDMKIyA2MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvYmFzZS5o
IiAyIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvZnVuY3RleGNlcHQuaCIgMSAz
CiMgNDAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9mdW5jdGV4Y2VwdC5oIiAzCiMgMSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2V4Y2VwdGlvbl9kZWZpbmVzLmgiIDEgMwojIDQx
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvZnVuY3RleGNlcHQuaCIgMiAzCgpuYW1lc3Bh
Y2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgoK
ICB2b2lkCiAgX190aHJvd19iYWRfZXhjZXB0aW9uKHZvaWQpIF9fYXR0cmlidXRlX18oKF9fbm9y
ZXR1cm5fXykpOwoKCiAgdm9pZAogIF9fdGhyb3dfYmFkX2FsbG9jKHZvaWQpIF9fYXR0cmlidXRl
X18oKF9fbm9yZXR1cm5fXykpOwoKCiAgdm9pZAogIF9fdGhyb3dfYmFkX2Nhc3Qodm9pZCkgX19h
dHRyaWJ1dGVfXygoX19ub3JldHVybl9fKSk7CgogIHZvaWQKICBfX3Rocm93X2JhZF90eXBlaWQo
dm9pZCkgX19hdHRyaWJ1dGVfXygoX19ub3JldHVybl9fKSk7CgoKICB2b2lkCiAgX190aHJvd19s
b2dpY19lcnJvcihjb25zdCBjaGFyKikgX19hdHRyaWJ1dGVfXygoX19ub3JldHVybl9fKSk7Cgog
IHZvaWQKICBfX3Rocm93X2RvbWFpbl9lcnJvcihjb25zdCBjaGFyKikgX19hdHRyaWJ1dGVfXygo
X19ub3JldHVybl9fKSk7CgogIHZvaWQKICBfX3Rocm93X2ludmFsaWRfYXJndW1lbnQoY29uc3Qg
Y2hhciopIF9fYXR0cmlidXRlX18oKF9fbm9yZXR1cm5fXykpOwoKICB2b2lkCiAgX190aHJvd19s
ZW5ndGhfZXJyb3IoY29uc3QgY2hhciopIF9fYXR0cmlidXRlX18oKF9fbm9yZXR1cm5fXykpOwoK
ICB2b2lkCiAgX190aHJvd19vdXRfb2ZfcmFuZ2UoY29uc3QgY2hhciopIF9fYXR0cmlidXRlX18o
KF9fbm9yZXR1cm5fXykpOwoKICB2b2lkCiAgX190aHJvd19vdXRfb2ZfcmFuZ2VfZm10KGNvbnN0
IGNoYXIqLCAuLi4pIF9fYXR0cmlidXRlX18oKF9fbm9yZXR1cm5fXykpCiAgICBfX2F0dHJpYnV0
ZV9fKChfX2Zvcm1hdF9fKF9fZ251X3ByaW50Zl9fLCAxLCAyKSkpOwoKICB2b2lkCiAgX190aHJv
d19ydW50aW1lX2Vycm9yKGNvbnN0IGNoYXIqKSBfX2F0dHJpYnV0ZV9fKChfX25vcmV0dXJuX18p
KTsKCiAgdm9pZAogIF9fdGhyb3dfcmFuZ2VfZXJyb3IoY29uc3QgY2hhciopIF9fYXR0cmlidXRl
X18oKF9fbm9yZXR1cm5fXykpOwoKICB2b2lkCiAgX190aHJvd19vdmVyZmxvd19lcnJvcihjb25z
dCBjaGFyKikgX19hdHRyaWJ1dGVfXygoX19ub3JldHVybl9fKSk7CgogIHZvaWQKICBfX3Rocm93
X3VuZGVyZmxvd19lcnJvcihjb25zdCBjaGFyKikgX19hdHRyaWJ1dGVfXygoX19ub3JldHVybl9f
KSk7CgoKICB2b2lkCiAgX190aHJvd19pb3NfZmFpbHVyZShjb25zdCBjaGFyKikgX19hdHRyaWJ1
dGVfXygoX19ub3JldHVybl9fKSk7CgogIHZvaWQKICBfX3Rocm93X3N5c3RlbV9lcnJvcihpbnQp
IF9fYXR0cmlidXRlX18oKF9fbm9yZXR1cm5fXykpOwoKICB2b2lkCiAgX190aHJvd19mdXR1cmVf
ZXJyb3IoaW50KSBfX2F0dHJpYnV0ZV9fKChfX25vcmV0dXJuX18pKTsKCgogIHZvaWQKICBfX3Ro
cm93X2JhZF9mdW5jdGlvbl9jYWxsKCkgX19hdHRyaWJ1dGVfXygoX19ub3JldHVybl9fKSk7CgoK
fQojIDYxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ29iYXNlLmgiIDIgMwoj
IDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9jcHBfdHlwZV90cmFpdHMuaCIgMSAzCiMg
MzUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9jcHBfdHlwZV90cmFpdHMuaCIgMwogICAg
ICAgCiMgMzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9jcHBfdHlwZV90cmFpdHMuaCIg
MwojIDY3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvY3BwX3R5cGVfdHJhaXRzLmgiIDMK
ZXh0ZXJuICJDKysiIHsKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0
eV9fICgiZGVmYXVsdCIpKSkKewoKCiAgc3RydWN0IF9fdHJ1ZV90eXBlIHsgfTsKICBzdHJ1Y3Qg
X19mYWxzZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8Ym9vbD4KICAgIHN0cnVjdCBfX3RydXRoX3R5
cGUKICAgIHsgdHlwZWRlZiBfX2ZhbHNlX3R5cGUgX190eXBlOyB9OwoKICB0ZW1wbGF0ZTw+CiAg
ICBzdHJ1Y3QgX190cnV0aF90eXBlPHRydWU+CiAgICB7IHR5cGVkZWYgX190cnVlX3R5cGUgX190
eXBlOyB9OwoKCgogIHRlbXBsYXRlPGNsYXNzIF9TcCwgY2xhc3MgX1RwPgogICAgc3RydWN0IF9f
dHJhaXRvcgogICAgewogICAgICBlbnVtIHsgX192YWx1ZSA9IGJvb2woX1NwOjpfX3ZhbHVlKSB8
fCBib29sKF9UcDo6X192YWx1ZSkgfTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX3RydXRoX3R5
cGU8X192YWx1ZT46Ol9fdHlwZSBfX3R5cGU7CiAgICB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUs
IHR5cGVuYW1lPgogICAgc3RydWN0IF9fYXJlX3NhbWUKICAgIHsKICAgICAgZW51bSB7IF9fdmFs
dWUgPSAwIH07CiAgICAgIHR5cGVkZWYgX19mYWxzZV90eXBlIF9fdHlwZTsKICAgIH07CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2FyZV9zYW1lPF9UcCwgX1RwPgogICAg
ewogICAgICBlbnVtIHsgX192YWx1ZSA9IDEgfTsKICAgICAgdHlwZWRlZiBfX3RydWVfdHlwZSBf
X3R5cGU7CiAgICB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNf
dm9pZAogICAgewogICAgICBlbnVtIHsgX192YWx1ZSA9IDAgfTsKICAgICAgdHlwZWRlZiBfX2Zh
bHNlX3R5cGUgX190eXBlOwogICAgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9faXNfdm9p
ZDx2b2lkPgogICAgewogICAgICBlbnVtIHsgX192YWx1ZSA9IDEgfTsKICAgICAgdHlwZWRlZiBf
X3RydWVfdHlwZSBfX3R5cGU7CiAgICB9OwoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAg
ICBzdHJ1Y3QgX19pc19pbnRlZ2VyCiAgICB7CiAgICAgIGVudW0geyBfX3ZhbHVlID0gMCB9Owog
ICAgICB0eXBlZGVmIF9fZmFsc2VfdHlwZSBfX3R5cGU7CiAgICB9OwoKCgoKCiAgdGVtcGxhdGU8
PgogICAgc3RydWN0IF9faXNfaW50ZWdlcjxib29sPgogICAgewogICAgICBlbnVtIHsgX192YWx1
ZSA9IDEgfTsKICAgICAgdHlwZWRlZiBfX3RydWVfdHlwZSBfX3R5cGU7CiAgICB9OwoKICB0ZW1w
bGF0ZTw+CiAgICBzdHJ1Y3QgX19pc19pbnRlZ2VyPGNoYXI+CiAgICB7CiAgICAgIGVudW0geyBf
X3ZhbHVlID0gMSB9OwogICAgICB0eXBlZGVmIF9fdHJ1ZV90eXBlIF9fdHlwZTsKICAgIH07Cgog
IHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2ludGVnZXI8c2lnbmVkIGNoYXI+CiAgICB7CiAg
ICAgIGVudW0geyBfX3ZhbHVlID0gMSB9OwogICAgICB0eXBlZGVmIF9fdHJ1ZV90eXBlIF9fdHlw
ZTsKICAgIH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2ludGVnZXI8dW5zaWduZWQg
Y2hhcj4KICAgIHsKICAgICAgZW51bSB7IF9fdmFsdWUgPSAxIH07CiAgICAgIHR5cGVkZWYgX190
cnVlX3R5cGUgX190eXBlOwogICAgfTsKCgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2lu
dGVnZXI8d2NoYXJfdD4KICAgIHsKICAgICAgZW51bSB7IF9fdmFsdWUgPSAxIH07CiAgICAgIHR5
cGVkZWYgX190cnVlX3R5cGUgX190eXBlOwogICAgfTsKCgoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1
Y3QgX19pc19pbnRlZ2VyPGNoYXIxNl90PgogICAgewogICAgICBlbnVtIHsgX192YWx1ZSA9IDEg
fTsKICAgICAgdHlwZWRlZiBfX3RydWVfdHlwZSBfX3R5cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTw+
CiAgICBzdHJ1Y3QgX19pc19pbnRlZ2VyPGNoYXIzMl90PgogICAgewogICAgICBlbnVtIHsgX192
YWx1ZSA9IDEgfTsKICAgICAgdHlwZWRlZiBfX3RydWVfdHlwZSBfX3R5cGU7CiAgICB9OwoKCiAg
dGVtcGxhdGU8PgogICAgc3RydWN0IF9faXNfaW50ZWdlcjxzaG9ydD4KICAgIHsKICAgICAgZW51
bSB7IF9fdmFsdWUgPSAxIH07CiAgICAgIHR5cGVkZWYgX190cnVlX3R5cGUgX190eXBlOwogICAg
fTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9faXNfaW50ZWdlcjx1bnNpZ25lZCBzaG9ydD4K
ICAgIHsKICAgICAgZW51bSB7IF9fdmFsdWUgPSAxIH07CiAgICAgIHR5cGVkZWYgX190cnVlX3R5
cGUgX190eXBlOwogICAgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9faXNfaW50ZWdlcjxp
bnQ+CiAgICB7CiAgICAgIGVudW0geyBfX3ZhbHVlID0gMSB9OwogICAgICB0eXBlZGVmIF9fdHJ1
ZV90eXBlIF9fdHlwZTsKICAgIH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2ludGVn
ZXI8dW5zaWduZWQgaW50PgogICAgewogICAgICBlbnVtIHsgX192YWx1ZSA9IDEgfTsKICAgICAg
dHlwZWRlZiBfX3RydWVfdHlwZSBfX3R5cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1
Y3QgX19pc19pbnRlZ2VyPGxvbmc+CiAgICB7CiAgICAgIGVudW0geyBfX3ZhbHVlID0gMSB9Owog
ICAgICB0eXBlZGVmIF9fdHJ1ZV90eXBlIF9fdHlwZTsKICAgIH07CgogIHRlbXBsYXRlPD4KICAg
IHN0cnVjdCBfX2lzX2ludGVnZXI8dW5zaWduZWQgbG9uZz4KICAgIHsKICAgICAgZW51bSB7IF9f
dmFsdWUgPSAxIH07CiAgICAgIHR5cGVkZWYgX190cnVlX3R5cGUgX190eXBlOwogICAgfTsKCiAg
dGVtcGxhdGU8PgogICAgc3RydWN0IF9faXNfaW50ZWdlcjxsb25nIGxvbmc+CiAgICB7CiAgICAg
IGVudW0geyBfX3ZhbHVlID0gMSB9OwogICAgICB0eXBlZGVmIF9fdHJ1ZV90eXBlIF9fdHlwZTsK
ICAgIH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2ludGVnZXI8dW5zaWduZWQgbG9u
ZyBsb25nPgogICAgewogICAgICBlbnVtIHsgX192YWx1ZSA9IDEgfTsKICAgICAgdHlwZWRlZiBf
X3RydWVfdHlwZSBfX3R5cGU7CiAgICB9OwojIDI3OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL2NwcF90eXBlX3RyYWl0cy5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3Ry
dWN0IF9faXNfZmxvYXRpbmcKICAgIHsKICAgICAgZW51bSB7IF9fdmFsdWUgPSAwIH07CiAgICAg
IHR5cGVkZWYgX19mYWxzZV90eXBlIF9fdHlwZTsKICAgIH07CgoKICB0ZW1wbGF0ZTw+CiAgICBz
dHJ1Y3QgX19pc19mbG9hdGluZzxmbG9hdD4KICAgIHsKICAgICAgZW51bSB7IF9fdmFsdWUgPSAx
IH07CiAgICAgIHR5cGVkZWYgX190cnVlX3R5cGUgX190eXBlOwogICAgfTsKCiAgdGVtcGxhdGU8
PgogICAgc3RydWN0IF9faXNfZmxvYXRpbmc8ZG91YmxlPgogICAgewogICAgICBlbnVtIHsgX192
YWx1ZSA9IDEgfTsKICAgICAgdHlwZWRlZiBfX3RydWVfdHlwZSBfX3R5cGU7CiAgICB9OwoKICB0
ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19pc19mbG9hdGluZzxsb25nIGRvdWJsZT4KICAgIHsKICAg
ICAgZW51bSB7IF9fdmFsdWUgPSAxIH07CiAgICAgIHR5cGVkZWYgX190cnVlX3R5cGUgX190eXBl
OwogICAgfTsKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNfcG9p
bnRlcgogICAgewogICAgICBlbnVtIHsgX192YWx1ZSA9IDAgfTsKICAgICAgdHlwZWRlZiBfX2Zh
bHNlX3R5cGUgX190eXBlOwogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3Ry
dWN0IF9faXNfcG9pbnRlcjxfVHAqPgogICAgewogICAgICBlbnVtIHsgX192YWx1ZSA9IDEgfTsK
ICAgICAgdHlwZWRlZiBfX3RydWVfdHlwZSBfX3R5cGU7CiAgICB9OwoKCgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19pc19hcml0aG1ldGljCiAgICA6IHB1YmxpYyBfX3Ry
YWl0b3I8X19pc19pbnRlZ2VyPF9UcD4sIF9faXNfZmxvYXRpbmc8X1RwPiA+CiAgICB7IH07CgoK
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX3NjYWxhcgogICAgOiBw
dWJsaWMgX190cmFpdG9yPF9faXNfYXJpdGhtZXRpYzxfVHA+LCBfX2lzX3BvaW50ZXI8X1RwPiA+
CiAgICB7IH07CgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX2No
YXIKICAgIHsKICAgICAgZW51bSB7IF9fdmFsdWUgPSAwIH07CiAgICAgIHR5cGVkZWYgX19mYWxz
ZV90eXBlIF9fdHlwZTsKICAgIH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2NoYXI8
Y2hhcj4KICAgIHsKICAgICAgZW51bSB7IF9fdmFsdWUgPSAxIH07CiAgICAgIHR5cGVkZWYgX190
cnVlX3R5cGUgX190eXBlOwogICAgfTsKCgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2No
YXI8d2NoYXJfdD4KICAgIHsKICAgICAgZW51bSB7IF9fdmFsdWUgPSAxIH07CiAgICAgIHR5cGVk
ZWYgX190cnVlX3R5cGUgX190eXBlOwogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4K
ICAgIHN0cnVjdCBfX2lzX2J5dGUKICAgIHsKICAgICAgZW51bSB7IF9fdmFsdWUgPSAwIH07CiAg
ICAgIHR5cGVkZWYgX19mYWxzZV90eXBlIF9fdHlwZTsKICAgIH07CgogIHRlbXBsYXRlPD4KICAg
IHN0cnVjdCBfX2lzX2J5dGU8Y2hhcj4KICAgIHsKICAgICAgZW51bSB7IF9fdmFsdWUgPSAxIH07
CiAgICAgIHR5cGVkZWYgX190cnVlX3R5cGUgX190eXBlOwogICAgfTsKCiAgdGVtcGxhdGU8Pgog
ICAgc3RydWN0IF9faXNfYnl0ZTxzaWduZWQgY2hhcj4KICAgIHsKICAgICAgZW51bSB7IF9fdmFs
dWUgPSAxIH07CiAgICAgIHR5cGVkZWYgX190cnVlX3R5cGUgX190eXBlOwogICAgfTsKCiAgdGVt
cGxhdGU8PgogICAgc3RydWN0IF9faXNfYnl0ZTx1bnNpZ25lZCBjaGFyPgogICAgewogICAgICBl
bnVtIHsgX192YWx1ZSA9IDEgfTsKICAgICAgdHlwZWRlZiBfX3RydWVfdHlwZSBfX3R5cGU7CiAg
ICB9OwoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19pc19tb3ZlX2l0
ZXJhdG9yCiAgICB7CiAgICAgIGVudW0geyBfX3ZhbHVlID0gMCB9OwogICAgICB0eXBlZGVmIF9f
ZmFsc2VfdHlwZSBfX3R5cGU7CiAgICB9OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRv
cj4KICAgIGlubGluZSBfSXRlcmF0b3IKICAgIF9fbWl0ZXJfYmFzZShfSXRlcmF0b3IgX19pdCkK
ICAgIHsgcmV0dXJuIF9faXQ7IH0KCgp9Cn0KIyA2MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3N0bF9hbGdvYmFzZS5oIiAyIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2V4dC90
eXBlX3RyYWl0cy5oIiAxIDMKIyAzMiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leHQvdHlwZV90
cmFpdHMuaCIgMwogICAgICAgCiMgMzMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZXh0L3R5cGVf
dHJhaXRzLmgiIDMKCgoKCmV4dGVybiAiQysrIiB7CgpuYW1lc3BhY2UgX19nbnVfY3h4IF9fYXR0
cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgoKICB0ZW1wbGF0ZTxi
b29sLCB0eXBlbmFtZT4KICAgIHN0cnVjdCBfX2VuYWJsZV9pZgogICAgeyB9OwoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19lbmFibGVfaWY8dHJ1ZSwgX1RwPgogICAgeyB0
eXBlZGVmIF9UcCBfX3R5cGU7IH07CgoKCiAgdGVtcGxhdGU8Ym9vbCBfQ29uZCwgdHlwZW5hbWUg
X0lmdHJ1ZSwgdHlwZW5hbWUgX0lmZmFsc2U+CiAgICBzdHJ1Y3QgX19jb25kaXRpb25hbF90eXBl
CiAgICB7IHR5cGVkZWYgX0lmdHJ1ZSBfX3R5cGU7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9J
ZnRydWUsIHR5cGVuYW1lIF9JZmZhbHNlPgogICAgc3RydWN0IF9fY29uZGl0aW9uYWxfdHlwZTxm
YWxzZSwgX0lmdHJ1ZSwgX0lmZmFsc2U+CiAgICB7IHR5cGVkZWYgX0lmZmFsc2UgX190eXBlOyB9
OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2FkZF91bnNpZ25lZAog
ICAgewogICAgcHJpdmF0ZToKICAgICAgdHlwZWRlZiBfX2VuYWJsZV9pZjxzdGQ6Ol9faXNfaW50
ZWdlcjxfVHA+OjpfX3ZhbHVlLCBfVHA+IF9faWZfdHlwZTsKCiAgICBwdWJsaWM6CiAgICAgIHR5
cGVkZWYgdHlwZW5hbWUgX19pZl90eXBlOjpfX3R5cGUgX190eXBlOwogICAgfTsKCiAgdGVtcGxh
dGU8PgogICAgc3RydWN0IF9fYWRkX3Vuc2lnbmVkPGNoYXI+CiAgICB7IHR5cGVkZWYgdW5zaWdu
ZWQgY2hhciBfX3R5cGU7IH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2FkZF91bnNpZ25l
ZDxzaWduZWQgY2hhcj4KICAgIHsgdHlwZWRlZiB1bnNpZ25lZCBjaGFyIF9fdHlwZTsgfTsKCiAg
dGVtcGxhdGU8PgogICAgc3RydWN0IF9fYWRkX3Vuc2lnbmVkPHNob3J0PgogICAgeyB0eXBlZGVm
IHVuc2lnbmVkIHNob3J0IF9fdHlwZTsgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fYWRk
X3Vuc2lnbmVkPGludD4KICAgIHsgdHlwZWRlZiB1bnNpZ25lZCBpbnQgX190eXBlOyB9OwoKICB0
ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19hZGRfdW5zaWduZWQ8bG9uZz4KICAgIHsgdHlwZWRlZiB1
bnNpZ25lZCBsb25nIF9fdHlwZTsgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fYWRkX3Vu
c2lnbmVkPGxvbmcgbG9uZz4KICAgIHsgdHlwZWRlZiB1bnNpZ25lZCBsb25nIGxvbmcgX190eXBl
OyB9OwoKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fYWRkX3Vuc2lnbmVkPGJvb2w+OwoKICB0
ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19hZGRfdW5zaWduZWQ8d2NoYXJfdD47CgoKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9fcmVtb3ZlX3Vuc2lnbmVkCiAgICB7CiAgICBw
cml2YXRlOgogICAgICB0eXBlZGVmIF9fZW5hYmxlX2lmPHN0ZDo6X19pc19pbnRlZ2VyPF9UcD46
Ol9fdmFsdWUsIF9UcD4gX19pZl90eXBlOwoKICAgIHB1YmxpYzoKICAgICAgdHlwZWRlZiB0eXBl
bmFtZSBfX2lmX3R5cGU6Ol9fdHlwZSBfX3R5cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTw+CiAgICBz
dHJ1Y3QgX19yZW1vdmVfdW5zaWduZWQ8Y2hhcj4KICAgIHsgdHlwZWRlZiBzaWduZWQgY2hhciBf
X3R5cGU7IH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX3JlbW92ZV91bnNpZ25lZDx1bnNp
Z25lZCBjaGFyPgogICAgeyB0eXBlZGVmIHNpZ25lZCBjaGFyIF9fdHlwZTsgfTsKCiAgdGVtcGxh
dGU8PgogICAgc3RydWN0IF9fcmVtb3ZlX3Vuc2lnbmVkPHVuc2lnbmVkIHNob3J0PgogICAgeyB0
eXBlZGVmIHNob3J0IF9fdHlwZTsgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fcmVtb3Zl
X3Vuc2lnbmVkPHVuc2lnbmVkIGludD4KICAgIHsgdHlwZWRlZiBpbnQgX190eXBlOyB9OwoKICB0
ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19yZW1vdmVfdW5zaWduZWQ8dW5zaWduZWQgbG9uZz4KICAg
IHsgdHlwZWRlZiBsb25nIF9fdHlwZTsgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fcmVt
b3ZlX3Vuc2lnbmVkPHVuc2lnbmVkIGxvbmcgbG9uZz4KICAgIHsgdHlwZWRlZiBsb25nIGxvbmcg
X190eXBlOyB9OwoKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fcmVtb3ZlX3Vuc2lnbmVkPGJv
b2w+OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19yZW1vdmVfdW5zaWduZWQ8d2NoYXJfdD47
CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1R5cGU+CiAgICBpbmxpbmUgYm9vbAogICAgX19pc19u
dWxsX3BvaW50ZXIoX1R5cGUqIF9fcHRyKQogICAgeyByZXR1cm4gX19wdHIgPT0gMDsgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHlwZT4KICAgIGlubGluZSBib29sCiAgICBfX2lzX251bGxfcG9p
bnRlcihfVHlwZSkKICAgIHsgcmV0dXJuIGZhbHNlOyB9CgoKICBpbmxpbmUgYm9vbAogIF9faXNf
bnVsbF9wb2ludGVyKHN0ZDo6bnVsbHB0cl90KQogIHsgcmV0dXJuIHRydWU7IH0KCgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHAsIGJvb2wgPSBzdGQ6Ol9faXNfaW50ZWdlcjxfVHA+OjpfX3ZhbHVl
PgogICAgc3RydWN0IF9fcHJvbW90ZQogICAgeyB0eXBlZGVmIGRvdWJsZSBfX3R5cGU7IH07CgoK
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX3Byb21vdGU8X1RwLCBmYWxz
ZT4KICAgIHsgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fcHJvbW90ZTxsb25nIGRvdWJs
ZT4KICAgIHsgdHlwZWRlZiBsb25nIGRvdWJsZSBfX3R5cGU7IH07CgogIHRlbXBsYXRlPD4KICAg
IHN0cnVjdCBfX3Byb21vdGU8ZG91YmxlPgogICAgeyB0eXBlZGVmIGRvdWJsZSBfX3R5cGU7IH07
CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX3Byb21vdGU8ZmxvYXQ+CiAgICB7IHR5cGVkZWYg
ZmxvYXQgX190eXBlOyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9VcCwK
ICAgICAgICAgICB0eXBlbmFtZSBfVHAyID0gdHlwZW5hbWUgX19wcm9tb3RlPF9UcD46Ol9fdHlw
ZSwKICAgICAgICAgICB0eXBlbmFtZSBfVXAyID0gdHlwZW5hbWUgX19wcm9tb3RlPF9VcD46Ol9f
dHlwZT4KICAgIHN0cnVjdCBfX3Byb21vdGVfMgogICAgewogICAgICB0eXBlZGVmIF9fdHlwZW9m
X18oX1RwMigpICsgX1VwMigpKSBfX3R5cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHAsIHR5cGVuYW1lIF9VcCwgdHlwZW5hbWUgX1ZwLAogICAgICAgICAgIHR5cGVuYW1lIF9UcDIg
PSB0eXBlbmFtZSBfX3Byb21vdGU8X1RwPjo6X190eXBlLAogICAgICAgICAgIHR5cGVuYW1lIF9V
cDIgPSB0eXBlbmFtZSBfX3Byb21vdGU8X1VwPjo6X190eXBlLAogICAgICAgICAgIHR5cGVuYW1l
IF9WcDIgPSB0eXBlbmFtZSBfX3Byb21vdGU8X1ZwPjo6X190eXBlPgogICAgc3RydWN0IF9fcHJv
bW90ZV8zCiAgICB7CiAgICAgIHR5cGVkZWYgX190eXBlb2ZfXyhfVHAyKCkgKyBfVXAyKCkgKyBf
VnAyKCkpIF9fdHlwZTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUg
X1VwLCB0eXBlbmFtZSBfVnAsIHR5cGVuYW1lIF9XcCwKICAgICAgICAgICB0eXBlbmFtZSBfVHAy
ID0gdHlwZW5hbWUgX19wcm9tb3RlPF9UcD46Ol9fdHlwZSwKICAgICAgICAgICB0eXBlbmFtZSBf
VXAyID0gdHlwZW5hbWUgX19wcm9tb3RlPF9VcD46Ol9fdHlwZSwKICAgICAgICAgICB0eXBlbmFt
ZSBfVnAyID0gdHlwZW5hbWUgX19wcm9tb3RlPF9WcD46Ol9fdHlwZSwKICAgICAgICAgICB0eXBl
bmFtZSBfV3AyID0gdHlwZW5hbWUgX19wcm9tb3RlPF9XcD46Ol9fdHlwZT4KICAgIHN0cnVjdCBf
X3Byb21vdGVfNAogICAgewogICAgICB0eXBlZGVmIF9fdHlwZW9mX18oX1RwMigpICsgX1VwMigp
ICsgX1ZwMigpICsgX1dwMigpKSBfX3R5cGU7CiAgICB9OwoKCn0KfQojIDYzICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ29iYXNlLmgiIDIgMwojIDEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvZXh0L251bWVyaWNfdHJhaXRzLmgiIDEgMwojIDMyICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2V4dC9udW1lcmljX3RyYWl0cy5oIiAzCiAgICAgICAKIyAzMyAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9leHQvbnVtZXJpY190cmFpdHMuaCIgMwoKCgoKbmFtZXNwYWNlIF9fZ251X2N4
eCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgojIDU0ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2V4dC9udW1lcmljX3RyYWl0cy5oIiAzCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX1ZhbHVlPgogICAgc3RydWN0IF9fbnVtZXJpY190cmFpdHNfaW50ZWdlcgogICAg
ewoKICAgICAgc3RhdGljIGNvbnN0IF9WYWx1ZSBfX21pbiA9ICgoKF9WYWx1ZSkoLTEpIDwgMCkg
PyAoX1ZhbHVlKTEgPDwgKHNpemVvZihfVmFsdWUpICogOCAtICgoX1ZhbHVlKSgtMSkgPCAwKSkg
OiAoX1ZhbHVlKTApOwogICAgICBzdGF0aWMgY29uc3QgX1ZhbHVlIF9fbWF4ID0gKCgoX1ZhbHVl
KSgtMSkgPCAwKSA/ICgoKCgoX1ZhbHVlKTEgPDwgKChzaXplb2YoX1ZhbHVlKSAqIDggLSAoKF9W
YWx1ZSkoLTEpIDwgMCkpIC0gMSkpIC0gMSkgPDwgMSkgKyAxKSA6IH4oX1ZhbHVlKTApOwoKCgog
ICAgICBzdGF0aWMgY29uc3QgYm9vbCBfX2lzX3NpZ25lZCA9ICgoX1ZhbHVlKSgtMSkgPCAwKTsK
ICAgICAgc3RhdGljIGNvbnN0IGludCBfX2RpZ2l0cyA9IChzaXplb2YoX1ZhbHVlKSAqIDggLSAo
KF9WYWx1ZSkoLTEpIDwgMCkpOwogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1ZhbHVlPgog
ICAgY29uc3QgX1ZhbHVlIF9fbnVtZXJpY190cmFpdHNfaW50ZWdlcjxfVmFsdWU+OjpfX21pbjsK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1ZhbHVlPgogICAgY29uc3QgX1ZhbHVlIF9fbnVtZXJpY190
cmFpdHNfaW50ZWdlcjxfVmFsdWU+OjpfX21heDsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1ZhbHVl
PgogICAgY29uc3QgYm9vbCBfX251bWVyaWNfdHJhaXRzX2ludGVnZXI8X1ZhbHVlPjo6X19pc19z
aWduZWQ7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9WYWx1ZT4KICAgIGNvbnN0IGludCBfX251bWVy
aWNfdHJhaXRzX2ludGVnZXI8X1ZhbHVlPjo6X19kaWdpdHM7CiMgOTkgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvZXh0L251bWVyaWNfdHJhaXRzLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVmFs
dWU+CiAgICBzdHJ1Y3QgX19udW1lcmljX3RyYWl0c19mbG9hdGluZwogICAgewoKICAgICAgc3Rh
dGljIGNvbnN0IGludCBfX21heF9kaWdpdHMxMCA9ICgyICsgKHN0ZDo6X19hcmVfc2FtZTxfVmFs
dWUsIGZsb2F0Pjo6X192YWx1ZSA/IDI0IDogc3RkOjpfX2FyZV9zYW1lPF9WYWx1ZSwgZG91Ymxl
Pjo6X192YWx1ZSA/IDUzIDogMTEzKSAqIDY0M0wgLyAyMTM2KTsKCgogICAgICBzdGF0aWMgY29u
c3QgYm9vbCBfX2lzX3NpZ25lZCA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdCBpbnQgX19kaWdp
dHMxMCA9IChzdGQ6Ol9fYXJlX3NhbWU8X1ZhbHVlLCBmbG9hdD46Ol9fdmFsdWUgPyA2IDogc3Rk
OjpfX2FyZV9zYW1lPF9WYWx1ZSwgZG91YmxlPjo6X192YWx1ZSA/IDE1IDogMzMpOwogICAgICBz
dGF0aWMgY29uc3QgaW50IF9fbWF4X2V4cG9uZW50MTAgPSAoc3RkOjpfX2FyZV9zYW1lPF9WYWx1
ZSwgZmxvYXQ+OjpfX3ZhbHVlID8gMzggOiBzdGQ6Ol9fYXJlX3NhbWU8X1ZhbHVlLCBkb3VibGU+
OjpfX3ZhbHVlID8gMzA4IDogNDkzMik7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVmFs
dWU+CiAgICBjb25zdCBpbnQgX19udW1lcmljX3RyYWl0c19mbG9hdGluZzxfVmFsdWU+OjpfX21h
eF9kaWdpdHMxMDsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1ZhbHVlPgogICAgY29uc3QgYm9vbCBf
X251bWVyaWNfdHJhaXRzX2Zsb2F0aW5nPF9WYWx1ZT46Ol9faXNfc2lnbmVkOwoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVmFsdWU+CiAgICBjb25zdCBpbnQgX19udW1lcmljX3RyYWl0c19mbG9hdGlu
ZzxfVmFsdWU+OjpfX2RpZ2l0czEwOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVmFsdWU+CiAgICBj
b25zdCBpbnQgX19udW1lcmljX3RyYWl0c19mbG9hdGluZzxfVmFsdWU+OjpfX21heF9leHBvbmVu
dDEwOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVmFsdWU+CiAgICBzdHJ1Y3QgX19udW1lcmljX3Ry
YWl0cwogICAgOiBwdWJsaWMgX19jb25kaXRpb25hbF90eXBlPHN0ZDo6X19pc19pbnRlZ2VyPF9W
YWx1ZT46Ol9fdmFsdWUsCiAgICBfX251bWVyaWNfdHJhaXRzX2ludGVnZXI8X1ZhbHVlPiwKICAg
IF9fbnVtZXJpY190cmFpdHNfZmxvYXRpbmc8X1ZhbHVlPiA+OjpfX3R5cGUKICAgIHsgfTsKCgp9
CiMgNjQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnb2Jhc2UuaCIgMiAzCiMg
MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9wYWlyLmgiIDEgMwojIDU5ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3BhaXIuaCIgMwojIDEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9tb3ZlLmgiIDEgMwojIDM0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvbW92ZS5oIiAzCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2NvbmNlcHRfY2hl
Y2suaCIgMSAzCiMgMzMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9jb25jZXB0X2NoZWNr
LmgiIDMKICAgICAgIAojIDM0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvY29uY2VwdF9j
aGVjay5oIiAzCiMgMzUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9tb3ZlLmgiIDIgMwoK
bmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0Iikp
KQp7CgoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBfVHAqCiAgICBf
X2FkZHJlc3NvZihfVHAmIF9fcikgbm9leGNlcHQKICAgIHsKICAgICAgcmV0dXJuIHJlaW50ZXJw
cmV0X2Nhc3Q8X1RwKj4KICgmY29uc3RfY2FzdDxjaGFyJj4ocmVpbnRlcnByZXRfY2FzdDxjb25z
dCB2b2xhdGlsZSBjaGFyJj4oX19yKSkpOwogICAgfQoKCn0KCgojIDEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvdHlwZV90cmFpdHMiIDEgMwojIDMyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3R5
cGVfdHJhaXRzIiAzCiAgICAgICAKIyAzMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC90eXBlX3Ry
YWl0cyIgMwojIDQyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3R5cGVfdHJhaXRzIiAzCm5hbWVz
cGFjZSBzdGQKewogIHR5cGVkZWYgc2hvcnQgdW5zaWduZWQgaW50IHVpbnRfbGVhc3QxNl90Owog
IHR5cGVkZWYgdW5zaWduZWQgaW50IHVpbnRfbGVhc3QzMl90Owp9CgoKCgoKbmFtZXNwYWNlIHN0
ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgojIDY4ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL3R5cGVfdHJhaXRzIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwLCBfVHAgX192PgogICAgc3RydWN0IGludGVncmFsX2NvbnN0YW50CiAgICB7CiAgICAgIHN0
YXRpYyBjb25zdGV4cHIgX1RwIHZhbHVlID0gX192OwogICAgICB0eXBlZGVmIF9UcCB2YWx1ZV90
eXBlOwogICAgICB0eXBlZGVmIGludGVncmFsX2NvbnN0YW50PF9UcCwgX192PiB0eXBlOwogICAg
ICBjb25zdGV4cHIgb3BlcmF0b3IgdmFsdWVfdHlwZSgpIGNvbnN0IHsgcmV0dXJuIHZhbHVlOyB9
CgoKCgoKCiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIF9UcCBfX3Y+CiAgICBjb25z
dGV4cHIgX1RwIGludGVncmFsX2NvbnN0YW50PF9UcCwgX192Pjo6dmFsdWU7CgoKICB0eXBlZGVm
IGludGVncmFsX2NvbnN0YW50PGJvb2wsIHRydWU+IHRydWVfdHlwZTsKCgogIHR5cGVkZWYgaW50
ZWdyYWxfY29uc3RhbnQ8Ym9vbCwgZmFsc2U+IGZhbHNlX3R5cGU7CgogIHRlbXBsYXRlPGJvb2wg
X192PgogICAgdXNpbmcgX19ib29sX2NvbnN0YW50ID0gaW50ZWdyYWxfY29uc3RhbnQ8Ym9vbCwg
X192PjsKIyAxMDMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdHlwZV90cmFpdHMiIDMKICB0ZW1w
bGF0ZTxib29sLCB0eXBlbmFtZSwgdHlwZW5hbWU+CiAgICBzdHJ1Y3QgY29uZGl0aW9uYWw7Cgog
IHRlbXBsYXRlPHR5cGVuYW1lLi4uPgogICAgc3RydWN0IF9fb3JfOwoKICB0ZW1wbGF0ZTw+CiAg
ICBzdHJ1Y3QgX19vcl88PgogICAgOiBwdWJsaWMgZmFsc2VfdHlwZQogICAgeyB9OwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfQjE+CiAgICBzdHJ1Y3QgX19vcl88X0IxPgogICAgOiBwdWJsaWMgX0Ix
CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9CMSwgdHlwZW5hbWUgX0IyPgogICAgc3Ry
dWN0IF9fb3JfPF9CMSwgX0IyPgogICAgOiBwdWJsaWMgY29uZGl0aW9uYWw8X0IxOjp2YWx1ZSwg
X0IxLCBfQjI+Ojp0eXBlCiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9CMSwgdHlwZW5h
bWUgX0IyLCB0eXBlbmFtZSBfQjMsIHR5cGVuYW1lLi4uIF9Cbj4KICAgIHN0cnVjdCBfX29yXzxf
QjEsIF9CMiwgX0IzLCBfQm4uLi4+CiAgICA6IHB1YmxpYyBjb25kaXRpb25hbDxfQjE6OnZhbHVl
LCBfQjEsIF9fb3JfPF9CMiwgX0IzLCBfQm4uLi4+Pjo6dHlwZQogICAgeyB9OwoKICB0ZW1wbGF0
ZTx0eXBlbmFtZS4uLj4KICAgIHN0cnVjdCBfX2FuZF87CgogIHRlbXBsYXRlPD4KICAgIHN0cnVj
dCBfX2FuZF88PgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlCiAgICB7IH07CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9CMT4KICAgIHN0cnVjdCBfX2FuZF88X0IxPgogICAgOiBwdWJsaWMgX0IxCiAgICB7
IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9CMSwgdHlwZW5hbWUgX0IyPgogICAgc3RydWN0IF9f
YW5kXzxfQjEsIF9CMj4KICAgIDogcHVibGljIGNvbmRpdGlvbmFsPF9CMTo6dmFsdWUsIF9CMiwg
X0IxPjo6dHlwZQogICAgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQjEsIHR5cGVuYW1lIF9C
MiwgdHlwZW5hbWUgX0IzLCB0eXBlbmFtZS4uLiBfQm4+CiAgICBzdHJ1Y3QgX19hbmRfPF9CMSwg
X0IyLCBfQjMsIF9Cbi4uLj4KICAgIDogcHVibGljIGNvbmRpdGlvbmFsPF9CMTo6dmFsdWUsIF9f
YW5kXzxfQjIsIF9CMywgX0JuLi4uPiwgX0IxPjo6dHlwZQogICAgeyB9OwoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfUHA+CiAgICBzdHJ1Y3QgX19ub3RfCiAgICA6IHB1YmxpYyBpbnRlZ3JhbF9jb25z
dGFudDxib29sLCAhX1BwOjp2YWx1ZT4KICAgIHsgfTsKIyAxODIgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvdHlwZV90cmFpdHMiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3Qg
X19zdWNjZXNzX3R5cGUKICAgIHsgdHlwZWRlZiBfVHAgdHlwZTsgfTsKCiAgc3RydWN0IF9fZmFp
bHVyZV90eXBlCiAgeyB9OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lPgogICAgc3RydWN0IHJlbW92
ZV9jdjsKCiAgdGVtcGxhdGU8dHlwZW5hbWU+CiAgICBzdHJ1Y3QgX19pc192b2lkX2hlbHBlcgog
ICAgOiBwdWJsaWMgZmFsc2VfdHlwZSB7IH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lz
X3ZvaWRfaGVscGVyPHZvaWQ+CiAgICA6IHB1YmxpYyB0cnVlX3R5cGUgeyB9OwoKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGlzX3ZvaWQKICAgIDogcHVibGljIF9faXNfdm9p
ZF9oZWxwZXI8dHlwZW5hbWUgcmVtb3ZlX2N2PF9UcD46OnR5cGU+Ojp0eXBlCiAgICB7IH07Cgog
IHRlbXBsYXRlPHR5cGVuYW1lPgogICAgc3RydWN0IF9faXNfaW50ZWdyYWxfaGVscGVyCiAgICA6
IHB1YmxpYyBmYWxzZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9faXNfaW50
ZWdyYWxfaGVscGVyPGJvb2w+CiAgICA6IHB1YmxpYyB0cnVlX3R5cGUgeyB9OwoKICB0ZW1wbGF0
ZTw+CiAgICBzdHJ1Y3QgX19pc19pbnRlZ3JhbF9oZWxwZXI8Y2hhcj4KICAgIDogcHVibGljIHRy
dWVfdHlwZSB7IH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2ludGVncmFsX2hlbHBl
cjxzaWduZWQgY2hhcj4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRlbXBsYXRlPD4K
ICAgIHN0cnVjdCBfX2lzX2ludGVncmFsX2hlbHBlcjx1bnNpZ25lZCBjaGFyPgogICAgOiBwdWJs
aWMgdHJ1ZV90eXBlIHsgfTsKCgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2ludGVncmFs
X2hlbHBlcjx3Y2hhcl90PgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCgogIHRlbXBsYXRl
PD4KICAgIHN0cnVjdCBfX2lzX2ludGVncmFsX2hlbHBlcjxjaGFyMTZfdD4KICAgIDogcHVibGlj
IHRydWVfdHlwZSB7IH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2ludGVncmFsX2hl
bHBlcjxjaGFyMzJfdD4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRlbXBsYXRlPD4K
ICAgIHN0cnVjdCBfX2lzX2ludGVncmFsX2hlbHBlcjxzaG9ydD4KICAgIDogcHVibGljIHRydWVf
dHlwZSB7IH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2ludGVncmFsX2hlbHBlcjx1
bnNpZ25lZCBzaG9ydD4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRlbXBsYXRlPD4K
ICAgIHN0cnVjdCBfX2lzX2ludGVncmFsX2hlbHBlcjxpbnQ+CiAgICA6IHB1YmxpYyB0cnVlX3R5
cGUgeyB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19pc19pbnRlZ3JhbF9oZWxwZXI8dW5z
aWduZWQgaW50PgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8PgogICAg
c3RydWN0IF9faXNfaW50ZWdyYWxfaGVscGVyPGxvbmc+CiAgICA6IHB1YmxpYyB0cnVlX3R5cGUg
eyB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19pc19pbnRlZ3JhbF9oZWxwZXI8dW5zaWdu
ZWQgbG9uZz4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRlbXBsYXRlPD4KICAgIHN0
cnVjdCBfX2lzX2ludGVncmFsX2hlbHBlcjxsb25nIGxvbmc+CiAgICA6IHB1YmxpYyB0cnVlX3R5
cGUgeyB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19pc19pbnRlZ3JhbF9oZWxwZXI8dW5z
aWduZWQgbG9uZyBsb25nPgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKIyAzMTQgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvdHlwZV90cmFpdHMiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+
CiAgICBzdHJ1Y3QgaXNfaW50ZWdyYWwKICAgIDogcHVibGljIF9faXNfaW50ZWdyYWxfaGVscGVy
PHR5cGVuYW1lIHJlbW92ZV9jdjxfVHA+Ojp0eXBlPjo6dHlwZQogICAgeyB9OwoKICB0ZW1wbGF0
ZTx0eXBlbmFtZT4KICAgIHN0cnVjdCBfX2lzX2Zsb2F0aW5nX3BvaW50X2hlbHBlcgogICAgOiBw
dWJsaWMgZmFsc2VfdHlwZSB7IH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2Zsb2F0
aW5nX3BvaW50X2hlbHBlcjxmbG9hdD4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRl
bXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX2Zsb2F0aW5nX3BvaW50X2hlbHBlcjxkb3VibGU+CiAg
ICA6IHB1YmxpYyB0cnVlX3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19pc19m
bG9hdGluZ19wb2ludF9oZWxwZXI8bG9uZyBkb3VibGU+CiAgICA6IHB1YmxpYyB0cnVlX3R5cGUg
eyB9OwojIDM0MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC90eXBlX3RyYWl0cyIgMwogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19mbG9hdGluZ19wb2ludAogICAgOiBwdWJs
aWMgX19pc19mbG9hdGluZ19wb2ludF9oZWxwZXI8dHlwZW5hbWUgcmVtb3ZlX2N2PF9UcD46OnR5
cGU+Ojp0eXBlCiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZT4KICAgIHN0cnVjdCBpc19h
cnJheQogICAgOiBwdWJsaWMgZmFsc2VfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cCwgc3RkOjpzaXplX3QgX1NpemU+CiAgICBzdHJ1Y3QgaXNfYXJyYXk8X1RwW19TaXplXT4KICAg
IDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0
cnVjdCBpc19hcnJheTxfVHBbXT4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRlbXBs
YXRlPHR5cGVuYW1lPgogICAgc3RydWN0IF9faXNfcG9pbnRlcl9oZWxwZXIKICAgIDogcHVibGlj
IGZhbHNlX3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19p
c19wb2ludGVyX2hlbHBlcjxfVHAqPgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19wb2ludGVyCiAgICA6IHB1YmxpYyBf
X2lzX3BvaW50ZXJfaGVscGVyPHR5cGVuYW1lIHJlbW92ZV9jdjxfVHA+Ojp0eXBlPjo6dHlwZQog
ICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWU+CiAgICBzdHJ1Y3QgaXNfbHZhbHVlX3JlZmVy
ZW5jZQogICAgOiBwdWJsaWMgZmFsc2VfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cD4KICAgIHN0cnVjdCBpc19sdmFsdWVfcmVmZXJlbmNlPF9UcCY+CiAgICA6IHB1YmxpYyB0cnVl
X3R5cGUgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWU+CiAgICBzdHJ1Y3QgaXNfcnZhbHVlX3Jl
ZmVyZW5jZQogICAgOiBwdWJsaWMgZmFsc2VfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcD4KICAgIHN0cnVjdCBpc19ydmFsdWVfcmVmZXJlbmNlPF9UcCYmPgogICAgOiBwdWJsaWMg
dHJ1ZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWU+CiAgICBzdHJ1Y3QgaXNfZnVuY3Rp
b247CgogIHRlbXBsYXRlPHR5cGVuYW1lPgogICAgc3RydWN0IF9faXNfbWVtYmVyX29iamVjdF9w
b2ludGVyX2hlbHBlcgogICAgOiBwdWJsaWMgZmFsc2VfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0NwPgogICAgc3RydWN0IF9faXNfbWVtYmVyX29iamVjdF9w
b2ludGVyX2hlbHBlcjxfVHAgX0NwOjoqPgogICAgOiBwdWJsaWMgaW50ZWdyYWxfY29uc3RhbnQ8
Ym9vbCwgIWlzX2Z1bmN0aW9uPF9UcD46OnZhbHVlPiB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfVHA+CiAgICBzdHJ1Y3QgaXNfbWVtYmVyX29iamVjdF9wb2ludGVyCiAgICA6IHB1YmxpYyBf
X2lzX21lbWJlcl9vYmplY3RfcG9pbnRlcl9oZWxwZXI8CiAgICB0eXBlbmFtZSByZW1vdmVfY3Y8
X1RwPjo6dHlwZT46OnR5cGUKICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWU+CiAgICBzdHJ1
Y3QgX19pc19tZW1iZXJfZnVuY3Rpb25fcG9pbnRlcl9oZWxwZXIKICAgIDogcHVibGljIGZhbHNl
X3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9DcD4KICAgIHN0
cnVjdCBfX2lzX21lbWJlcl9mdW5jdGlvbl9wb2ludGVyX2hlbHBlcjxfVHAgX0NwOjoqPgogICAg
OiBwdWJsaWMgaW50ZWdyYWxfY29uc3RhbnQ8Ym9vbCwgaXNfZnVuY3Rpb248X1RwPjo6dmFsdWU+
IHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19tZW1iZXJfZnVu
Y3Rpb25fcG9pbnRlcgogICAgOiBwdWJsaWMgX19pc19tZW1iZXJfZnVuY3Rpb25fcG9pbnRlcl9o
ZWxwZXI8CiAgICB0eXBlbmFtZSByZW1vdmVfY3Y8X1RwPjo6dHlwZT46OnR5cGUKICAgIHsgfTsK
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19lbnVtCiAgICA6IHB1Ymxp
YyBpbnRlZ3JhbF9jb25zdGFudDxib29sLCBfX2lzX2VudW0oX1RwKT4KICAgIHsgfTsKCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc191bmlvbgogICAgOiBwdWJsaWMgaW50
ZWdyYWxfY29uc3RhbnQ8Ym9vbCwgX19pc191bmlvbihfVHApPgogICAgeyB9OwoKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGlzX2NsYXNzCiAgICA6IHB1YmxpYyBpbnRlZ3Jh
bF9jb25zdGFudDxib29sLCBfX2lzX2NsYXNzKF9UcCk+CiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZT4KICAgIHN0cnVjdCBpc19mdW5jdGlvbgogICAgOiBwdWJsaWMgZmFsc2VfdHlwZSB7
IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAg
IHN0cnVjdCBpc19mdW5jdGlvbjxfUmVzKF9BcmdUeXBlcy4uLik+CiAgICA6IHB1YmxpYyB0cnVl
X3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJnVHlw
ZXM+CiAgICBzdHJ1Y3QgaXNfZnVuY3Rpb248X1JlcyhfQXJnVHlwZXMuLi4pICY+CiAgICA6IHB1
YmxpYyB0cnVlX3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4u
LiBfQXJnVHlwZXM+CiAgICBzdHJ1Y3QgaXNfZnVuY3Rpb248X1JlcyhfQXJnVHlwZXMuLi4pICYm
PgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Jlcywg
dHlwZW5hbWUuLi4gX0FyZ1R5cGVzPgogICAgc3RydWN0IGlzX2Z1bmN0aW9uPF9SZXMoX0FyZ1R5
cGVzLi4uLi4uKT4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIHN0cnVjdCBpc19mdW5jdGlvbjxf
UmVzKF9BcmdUeXBlcy4uLi4uLikgJj4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIHN0cnVjdCBp
c19mdW5jdGlvbjxfUmVzKF9BcmdUeXBlcy4uLi4uLikgJiY+CiAgICA6IHB1YmxpYyB0cnVlX3R5
cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+
CiAgICBzdHJ1Y3QgaXNfZnVuY3Rpb248X1JlcyhfQXJnVHlwZXMuLi4pIGNvbnN0PgogICAgOiBw
dWJsaWMgdHJ1ZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUu
Li4gX0FyZ1R5cGVzPgogICAgc3RydWN0IGlzX2Z1bmN0aW9uPF9SZXMoX0FyZ1R5cGVzLi4uKSBj
b25zdCAmPgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1JlcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPgogICAgc3RydWN0IGlzX2Z1bmN0aW9uPF9SZXMo
X0FyZ1R5cGVzLi4uKSBjb25zdCAmJj4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIHN0cnVjdCBp
c19mdW5jdGlvbjxfUmVzKF9BcmdUeXBlcy4uLi4uLikgY29uc3Q+CiAgICA6IHB1YmxpYyB0cnVl
X3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJnVHlw
ZXM+CiAgICBzdHJ1Y3QgaXNfZnVuY3Rpb248X1JlcyhfQXJnVHlwZXMuLi4uLi4pIGNvbnN0ICY+
CiAgICA6IHB1YmxpYyB0cnVlX3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0
eXBlbmFtZS4uLiBfQXJnVHlwZXM+CiAgICBzdHJ1Y3QgaXNfZnVuY3Rpb248X1JlcyhfQXJnVHlw
ZXMuLi4uLi4pIGNvbnN0ICYmPgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPgogICAgc3RydWN0IGlzX2Z1
bmN0aW9uPF9SZXMoX0FyZ1R5cGVzLi4uKSB2b2xhdGlsZT4KICAgIDogcHVibGljIHRydWVfdHlw
ZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4K
ICAgIHN0cnVjdCBpc19mdW5jdGlvbjxfUmVzKF9BcmdUeXBlcy4uLikgdm9sYXRpbGUgJj4KICAg
IDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVu
YW1lLi4uIF9BcmdUeXBlcz4KICAgIHN0cnVjdCBpc19mdW5jdGlvbjxfUmVzKF9BcmdUeXBlcy4u
Likgdm9sYXRpbGUgJiY+CiAgICA6IHB1YmxpYyB0cnVlX3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+CiAgICBzdHJ1Y3QgaXNfZnVuY3Rp
b248X1JlcyhfQXJnVHlwZXMuLi4uLi4pIHZvbGF0aWxlPgogICAgOiBwdWJsaWMgdHJ1ZV90eXBl
IHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPgog
ICAgc3RydWN0IGlzX2Z1bmN0aW9uPF9SZXMoX0FyZ1R5cGVzLi4uLi4uKSB2b2xhdGlsZSAmPgog
ICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlw
ZW5hbWUuLi4gX0FyZ1R5cGVzPgogICAgc3RydWN0IGlzX2Z1bmN0aW9uPF9SZXMoX0FyZ1R5cGVz
Li4uLi4uKSB2b2xhdGlsZSAmJj4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIHN0cnVjdCBpc19m
dW5jdGlvbjxfUmVzKF9BcmdUeXBlcy4uLikgY29uc3Qgdm9sYXRpbGU+CiAgICA6IHB1YmxpYyB0
cnVlX3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJn
VHlwZXM+CiAgICBzdHJ1Y3QgaXNfZnVuY3Rpb248X1JlcyhfQXJnVHlwZXMuLi4pIGNvbnN0IHZv
bGF0aWxlICY+CiAgICA6IHB1YmxpYyB0cnVlX3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+CiAgICBzdHJ1Y3QgaXNfZnVuY3Rpb248X1Jl
cyhfQXJnVHlwZXMuLi4pIGNvbnN0IHZvbGF0aWxlICYmPgogICAgOiBwdWJsaWMgdHJ1ZV90eXBl
IHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPgog
ICAgc3RydWN0IGlzX2Z1bmN0aW9uPF9SZXMoX0FyZ1R5cGVzLi4uLi4uKSBjb25zdCB2b2xhdGls
ZT4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMs
IHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIHN0cnVjdCBpc19mdW5jdGlvbjxfUmVzKF9BcmdU
eXBlcy4uLi4uLikgY29uc3Qgdm9sYXRpbGUgJj4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIHN0
cnVjdCBpc19mdW5jdGlvbjxfUmVzKF9BcmdUeXBlcy4uLi4uLikgY29uc3Qgdm9sYXRpbGUgJiY+
CiAgICA6IHB1YmxpYyB0cnVlX3R5cGUgeyB9OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lPgogICAg
c3RydWN0IF9faXNfbnVsbF9wb2ludGVyX2hlbHBlcgogICAgOiBwdWJsaWMgZmFsc2VfdHlwZSB7
IH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lzX251bGxfcG9pbnRlcl9oZWxwZXI8c3Rk
OjpudWxscHRyX3Q+CiAgICA6IHB1YmxpYyB0cnVlX3R5cGUgeyB9OwoKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwPgogICAgc3RydWN0IGlzX251bGxfcG9pbnRlcgogICAgOiBwdWJsaWMgX19pc19u
dWxsX3BvaW50ZXJfaGVscGVyPHR5cGVuYW1lIHJlbW92ZV9jdjxfVHA+Ojp0eXBlPjo6dHlwZQog
ICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNfbnVsbHB0
cl90CiAgICA6IHB1YmxpYyBpc19udWxsX3BvaW50ZXI8X1RwPgogICAgeyB9OwoKCgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgaXNfcmVmZXJlbmNlCiAgICA6IHB1YmxpYyBf
X29yXzxpc19sdmFsdWVfcmVmZXJlbmNlPF9UcD4sCiAgICAgICAgICAgICAgICAgICBpc19ydmFs
dWVfcmVmZXJlbmNlPF9UcD4+Ojp0eXBlCiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHA+CiAgICBzdHJ1Y3QgaXNfYXJpdGhtZXRpYwogICAgOiBwdWJsaWMgX19vcl88aXNfaW50ZWdy
YWw8X1RwPiwgaXNfZmxvYXRpbmdfcG9pbnQ8X1RwPj46OnR5cGUKICAgIHsgfTsKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19mdW5kYW1lbnRhbAogICAgOiBwdWJsaWMg
X19vcl88aXNfYXJpdGhtZXRpYzxfVHA+LCBpc192b2lkPF9UcD4sCiAgICAgaXNfbnVsbF9wb2lu
dGVyPF9UcD4+Ojp0eXBlCiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBz
dHJ1Y3QgaXNfb2JqZWN0CiAgICA6IHB1YmxpYyBfX25vdF88X19vcl88aXNfZnVuY3Rpb248X1Rw
PiwgaXNfcmVmZXJlbmNlPF9UcD4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgaXNfdm9pZDxf
VHA+Pj46OnR5cGUKICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWU+CiAgICBzdHJ1Y3QgaXNf
bWVtYmVyX3BvaW50ZXI7CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgaXNf
c2NhbGFyCiAgICA6IHB1YmxpYyBfX29yXzxpc19hcml0aG1ldGljPF9UcD4sIGlzX2VudW08X1Rw
PiwgaXNfcG9pbnRlcjxfVHA+LAogICAgICAgICAgICAgICAgICAgaXNfbWVtYmVyX3BvaW50ZXI8
X1RwPiwgaXNfbnVsbF9wb2ludGVyPF9UcD4+Ojp0eXBlCiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgaXNfY29tcG91bmQKICAgIDogcHVibGljIGludGVncmFs
X2NvbnN0YW50PGJvb2wsICFpc19mdW5kYW1lbnRhbDxfVHA+Ojp2YWx1ZT4geyB9OwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19pc19tZW1iZXJfcG9pbnRlcl9oZWxwZXIK
ICAgIDogcHVibGljIGZhbHNlX3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5
cGVuYW1lIF9DcD4KICAgIHN0cnVjdCBfX2lzX21lbWJlcl9wb2ludGVyX2hlbHBlcjxfVHAgX0Nw
OjoqPgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cD4KICAgIHN0cnVjdCBpc19tZW1iZXJfcG9pbnRlcgogICAgOiBwdWJsaWMgX19pc19tZW1iZXJf
cG9pbnRlcl9oZWxwZXI8dHlwZW5hbWUgcmVtb3ZlX2N2PF9UcD46OnR5cGU+Ojp0eXBlCiAgICB7
IH07CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNfcmVmZXJlbmNl
YWJsZQogICAgOiBwdWJsaWMgX19vcl88aXNfb2JqZWN0PF9UcD4sIGlzX3JlZmVyZW5jZTxfVHA+
Pjo6dHlwZQogICAgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBf
QXJncz4KICAgIHN0cnVjdCBfX2lzX3JlZmVyZW5jZWFibGU8X1JlcyhfQXJncy4uLik+CiAgICA6
IHB1YmxpYyB0cnVlX3R5cGUKICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlw
ZW5hbWUuLi4gX0FyZ3M+CiAgICBzdHJ1Y3QgX19pc19yZWZlcmVuY2VhYmxlPF9SZXMoX0FyZ3Mu
Li4uLi4pPgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlCiAgICB7IH07CgoKCgogIHRlbXBsYXRlPHR5
cGVuYW1lPgogICAgc3RydWN0IGlzX2NvbnN0CiAgICA6IHB1YmxpYyBmYWxzZV90eXBlIHsgfTsK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGlzX2NvbnN0PF9UcCBjb25zdD4K
ICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZT4KICAgIHN0
cnVjdCBpc192b2xhdGlsZQogICAgOiBwdWJsaWMgZmFsc2VfdHlwZSB7IH07CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc192b2xhdGlsZTxfVHAgdm9sYXRpbGU+CiAgICA6
IHB1YmxpYyB0cnVlX3R5cGUgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3Ry
dWN0IGlzX3RyaXZpYWwKICAgIDogcHVibGljIGludGVncmFsX2NvbnN0YW50PGJvb2wsIF9faXNf
dHJpdmlhbChfVHApPgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3Ry
dWN0IGlzX3RyaXZpYWxseV9jb3B5YWJsZQogICAgOiBwdWJsaWMgaW50ZWdyYWxfY29uc3RhbnQ8
Ym9vbCwgX19pc190cml2aWFsbHlfY29weWFibGUoX1RwKT4KICAgIHsgfTsKCgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19zdGFuZGFyZF9sYXlvdXQKICAgIDogcHVibGlj
IGludGVncmFsX2NvbnN0YW50PGJvb2wsIF9faXNfc3RhbmRhcmRfbGF5b3V0KF9UcCk+CiAgICB7
IH07CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGlzX3BvZAogICAgOiBw
dWJsaWMgaW50ZWdyYWxfY29uc3RhbnQ8Ym9vbCwgX19pc19wb2QoX1RwKT4KICAgIHsgfTsKCgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19saXRlcmFsX3R5cGUKICAgIDog
cHVibGljIGludGVncmFsX2NvbnN0YW50PGJvb2wsIF9faXNfbGl0ZXJhbF90eXBlKF9UcCk+CiAg
ICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgaXNfZW1wdHkKICAg
IDogcHVibGljIGludGVncmFsX2NvbnN0YW50PGJvb2wsIF9faXNfZW1wdHkoX1RwKT4KICAgIHsg
fTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19wb2x5bW9ycGhpYwog
ICAgOiBwdWJsaWMgaW50ZWdyYWxfY29uc3RhbnQ8Ym9vbCwgX19pc19wb2x5bW9ycGhpYyhfVHAp
PgogICAgeyB9OwojIDcxNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC90eXBlX3RyYWl0cyIgMwog
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19hYnN0cmFjdAogICAgOiBwdWJs
aWMgaW50ZWdyYWxfY29uc3RhbnQ8Ym9vbCwgX19pc19hYnN0cmFjdChfVHApPgogICAgeyB9OwoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsCiAgICBib29sID0gaXNfYXJpdGhtZXRpYzxfVHA+Ojp2
YWx1ZT4KICAgIHN0cnVjdCBfX2lzX3NpZ25lZF9oZWxwZXIKICAgIDogcHVibGljIGZhbHNlX3R5
cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19pc19zaWduZWRf
aGVscGVyPF9UcCwgdHJ1ZT4KICAgIDogcHVibGljIGludGVncmFsX2NvbnN0YW50PGJvb2wsIF9U
cCgtMSkgPCBfVHAoMCk+CiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBz
dHJ1Y3QgaXNfc2lnbmVkCiAgICA6IHB1YmxpYyBfX2lzX3NpZ25lZF9oZWxwZXI8X1RwPjo6dHlw
ZQogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGlzX3Vuc2ln
bmVkCiAgICA6IHB1YmxpYyBfX2FuZF88aXNfYXJpdGhtZXRpYzxfVHA+LCBfX25vdF88aXNfc2ln
bmVkPF9UcD4+PgogICAgeyB9OwoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZT4KICAgIHN0cnVjdCBh
ZGRfcnZhbHVlX3JlZmVyZW5jZTsKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHR5
cGVuYW1lIGFkZF9ydmFsdWVfcmVmZXJlbmNlPF9UcD46OnR5cGUgZGVjbHZhbCgpIG5vZXhjZXB0
OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSwgdW5zaWduZWQgPSAwPgogICAgc3RydWN0IGV4dGVudDsK
CiAgdGVtcGxhdGU8dHlwZW5hbWU+CiAgICBzdHJ1Y3QgcmVtb3ZlX2FsbF9leHRlbnRzOwoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19pc19hcnJheV9rbm93bl9ib3VuZHMK
ICAgIDogcHVibGljIGludGVncmFsX2NvbnN0YW50PGJvb2wsIChleHRlbnQ8X1RwPjo6dmFsdWUg
PiAwKT4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNf
YXJyYXlfdW5rbm93bl9ib3VuZHMKICAgIDogcHVibGljIF9fYW5kXzxpc19hcnJheTxfVHA+LCBf
X25vdF88ZXh0ZW50PF9UcD4+PgogICAgeyB9OwoKCgoKCgogIHN0cnVjdCBfX2RvX2lzX2Rlc3Ry
dWN0aWJsZV9pbXBsCiAgewogICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSA9IGRl
Y2x0eXBlKGRlY2x2YWw8X1RwJj4oKS5+X1RwKCkpPgogICAgICBzdGF0aWMgdHJ1ZV90eXBlIF9f
dGVzdChpbnQpOwoKICAgIHRlbXBsYXRlPHR5cGVuYW1lPgogICAgICBzdGF0aWMgZmFsc2VfdHlw
ZSBfX3Rlc3QoLi4uKTsKICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3Qg
X19pc19kZXN0cnVjdGlibGVfaW1wbAogICAgOiBwdWJsaWMgX19kb19pc19kZXN0cnVjdGlibGVf
aW1wbAogICAgewogICAgICB0eXBlZGVmIGRlY2x0eXBlKF9fdGVzdDxfVHA+KDApKSB0eXBlOwog
ICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLAogICAgICAgICAgIGJvb2wgPSBfX29yXzxp
c192b2lkPF9UcD4sCiAgICAgICAgICAgICAgICAgICAgICAgIF9faXNfYXJyYXlfdW5rbm93bl9i
b3VuZHM8X1RwPiwKICAgICAgICAgICAgICAgICAgICAgICAgaXNfZnVuY3Rpb248X1RwPj46OnZh
bHVlLAogICAgICAgICAgIGJvb2wgPSBfX29yXzxpc19yZWZlcmVuY2U8X1RwPiwgaXNfc2NhbGFy
PF9UcD4+Ojp2YWx1ZT4KICAgIHN0cnVjdCBfX2lzX2Rlc3RydWN0aWJsZV9zYWZlOwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19pc19kZXN0cnVjdGlibGVfc2FmZTxfVHAs
IGZhbHNlLCBmYWxzZT4KICAgIDogcHVibGljIF9faXNfZGVzdHJ1Y3RpYmxlX2ltcGw8dHlwZW5h
bWUKICAgICAgICAgICAgICAgcmVtb3ZlX2FsbF9leHRlbnRzPF9UcD46OnR5cGU+Ojp0eXBlCiAg
ICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX2Rlc3RydWN0
aWJsZV9zYWZlPF9UcCwgdHJ1ZSwgZmFsc2U+CiAgICA6IHB1YmxpYyBmYWxzZV90eXBlIHsgfTsK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNfZGVzdHJ1Y3RpYmxlX3Nh
ZmU8X1RwLCBmYWxzZSwgdHJ1ZT4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgaXNfZGVzdHJ1Y3RpYmxlCiAgICA6IHB1Ymxp
YyBfX2lzX2Rlc3RydWN0aWJsZV9zYWZlPF9UcD46OnR5cGUKICAgIHsgfTsKCgoKCgogIHN0cnVj
dCBfX2RvX2lzX250X2Rlc3RydWN0aWJsZV9pbXBsCiAgewogICAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwPgogICAgICBzdGF0aWMgaW50ZWdyYWxfY29uc3RhbnQ8Ym9vbCwgbm9leGNlcHQoZGVjbHZh
bDxfVHAmPigpLn5fVHAoKSk+CiAgICAgICAgX190ZXN0KGludCk7CgogICAgdGVtcGxhdGU8dHlw
ZW5hbWU+CiAgICAgIHN0YXRpYyBmYWxzZV90eXBlIF9fdGVzdCguLi4pOwogIH07CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX250X2Rlc3RydWN0aWJsZV9pbXBsCiAg
ICA6IHB1YmxpYyBfX2RvX2lzX250X2Rlc3RydWN0aWJsZV9pbXBsCiAgICB7CiAgICAgIHR5cGVk
ZWYgZGVjbHR5cGUoX190ZXN0PF9UcD4oMCkpIHR5cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHAsCiAgICAgICAgICAgYm9vbCA9IF9fb3JfPGlzX3ZvaWQ8X1RwPiwKICAgICAgICAg
ICAgICAgICAgICAgICAgX19pc19hcnJheV91bmtub3duX2JvdW5kczxfVHA+LAogICAgICAgICAg
ICAgICAgICAgICAgICBpc19mdW5jdGlvbjxfVHA+Pjo6dmFsdWUsCiAgICAgICAgICAgYm9vbCA9
IF9fb3JfPGlzX3JlZmVyZW5jZTxfVHA+LCBpc19zY2FsYXI8X1RwPj46OnZhbHVlPgogICAgc3Ry
dWN0IF9faXNfbnRfZGVzdHJ1Y3RpYmxlX3NhZmU7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4K
ICAgIHN0cnVjdCBfX2lzX250X2Rlc3RydWN0aWJsZV9zYWZlPF9UcCwgZmFsc2UsIGZhbHNlPgog
ICAgOiBwdWJsaWMgX19pc19udF9kZXN0cnVjdGlibGVfaW1wbDx0eXBlbmFtZQogICAgICAgICAg
ICAgICByZW1vdmVfYWxsX2V4dGVudHM8X1RwPjo6dHlwZT46OnR5cGUKICAgIHsgfTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNfbnRfZGVzdHJ1Y3RpYmxlX3NhZmU8
X1RwLCB0cnVlLCBmYWxzZT4KICAgIDogcHVibGljIGZhbHNlX3R5cGUgeyB9OwoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19pc19udF9kZXN0cnVjdGlibGVfc2FmZTxfVHAs
IGZhbHNlLCB0cnVlPgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19ub3Rocm93X2Rlc3RydWN0aWJsZQogICAgOiBwdWJs
aWMgX19pc19udF9kZXN0cnVjdGlibGVfc2FmZTxfVHA+Ojp0eXBlCiAgICB7IH07CgogIHN0cnVj
dCBfX2RvX2lzX2RlZmF1bHRfY29uc3RydWN0aWJsZV9pbXBsCiAgewogICAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwLCB0eXBlbmFtZSA9IGRlY2x0eXBlKF9UcCgpKT4KICAgICAgc3RhdGljIHRydWVf
dHlwZSBfX3Rlc3QoaW50KTsKCiAgICB0ZW1wbGF0ZTx0eXBlbmFtZT4KICAgICAgc3RhdGljIGZh
bHNlX3R5cGUgX190ZXN0KC4uLik7CiAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAg
c3RydWN0IF9faXNfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlX2ltcGwKICAgIDogcHVibGljIF9fZG9f
aXNfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlX2ltcGwKICAgIHsKICAgICAgdHlwZWRlZiBkZWNsdHlw
ZShfX3Rlc3Q8X1RwPigwKSkgdHlwZTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4K
ICAgIHN0cnVjdCBfX2lzX2RlZmF1bHRfY29uc3RydWN0aWJsZV9hdG9tCiAgICA6IHB1YmxpYyBf
X2FuZF88X19ub3RfPGlzX3ZvaWQ8X1RwPj4sCiAgICAgICAgICAgICAgICAgICAgX19pc19kZWZh
dWx0X2NvbnN0cnVjdGlibGVfaW1wbDxfVHA+PgogICAgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfVHAsIGJvb2wgPSBpc19hcnJheTxfVHA+Ojp2YWx1ZT4KICAgIHN0cnVjdCBfX2lzX2RlZmF1
bHRfY29uc3RydWN0aWJsZV9zYWZlOwoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
IHN0cnVjdCBfX2lzX2RlZmF1bHRfY29uc3RydWN0aWJsZV9zYWZlPF9UcCwgdHJ1ZT4KICAgIDog
cHVibGljIF9fYW5kXzxfX2lzX2FycmF5X2tub3duX2JvdW5kczxfVHA+LAogICAgICBfX2lzX2Rl
ZmF1bHRfY29uc3RydWN0aWJsZV9hdG9tPHR5cGVuYW1lCiAgICAgICAgICAgICAgICAgICAgICBy
ZW1vdmVfYWxsX2V4dGVudHM8X1RwPjo6dHlwZT4+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX2RlZmF1bHRfY29uc3RydWN0aWJsZV9zYWZlPF9UcCwg
ZmFsc2U+CiAgICA6IHB1YmxpYyBfX2lzX2RlZmF1bHRfY29uc3RydWN0aWJsZV9hdG9tPF9UcD46
OnR5cGUKICAgIHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19k
ZWZhdWx0X2NvbnN0cnVjdGlibGUKICAgIDogcHVibGljIF9faXNfZGVmYXVsdF9jb25zdHJ1Y3Rp
YmxlX3NhZmU8X1RwPjo6dHlwZQogICAgeyB9OwojIDkyNiAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC90eXBlX3RyYWl0cyIgMwogIHN0cnVjdCBfX2RvX2lzX3N0YXRpY19jYXN0YWJsZV9pbXBsCiAg
ewogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0Zyb20sIHR5cGVuYW1lIF9UbywgdHlwZW5hbWUKICAg
ICAgICAgICAgID0gZGVjbHR5cGUoc3RhdGljX2Nhc3Q8X1RvPihkZWNsdmFsPF9Gcm9tPigpKSk+
CiAgICAgIHN0YXRpYyB0cnVlX3R5cGUgX190ZXN0KGludCk7CgogICAgdGVtcGxhdGU8dHlwZW5h
bWUsIHR5cGVuYW1lPgogICAgICBzdGF0aWMgZmFsc2VfdHlwZSBfX3Rlc3QoLi4uKTsKICB9OwoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnJvbSwgdHlwZW5hbWUgX1RvPgogICAgc3RydWN0IF9faXNf
c3RhdGljX2Nhc3RhYmxlX2ltcGwKICAgIDogcHVibGljIF9fZG9faXNfc3RhdGljX2Nhc3RhYmxl
X2ltcGwKICAgIHsKICAgICAgdHlwZWRlZiBkZWNsdHlwZShfX3Rlc3Q8X0Zyb20sIF9Ubz4oMCkp
IHR5cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnJvbSwgdHlwZW5hbWUgX1RvPgog
ICAgc3RydWN0IF9faXNfc3RhdGljX2Nhc3RhYmxlX3NhZmUKICAgIDogcHVibGljIF9faXNfc3Rh
dGljX2Nhc3RhYmxlX2ltcGw8X0Zyb20sIF9Ubz46OnR5cGUKICAgIHsgfTsKCgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9Gcm9tLCB0eXBlbmFtZSBfVG8+CiAgICBzdHJ1Y3QgX19pc19zdGF0aWNfY2Fz
dGFibGUKICAgIDogcHVibGljIGludGVncmFsX2NvbnN0YW50PGJvb2wsIChfX2lzX3N0YXRpY19j
YXN0YWJsZV9zYWZlPAogICAgICAgICAgX0Zyb20sIF9Ubz46OnZhbHVlKT4KICAgIHsgfTsKCgoK
CgoKICBzdHJ1Y3QgX19kb19pc19kaXJlY3RfY29uc3RydWN0aWJsZV9pbXBsCiAgewogICAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQXJnLCB0eXBlbmFtZQogICAgICA9IGRlY2x0
eXBlKDo6bmV3IF9UcChkZWNsdmFsPF9Bcmc+KCkpKT4KICAgICAgc3RhdGljIHRydWVfdHlwZSBf
X3Rlc3QoaW50KTsKCiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSwgdHlwZW5hbWU+CiAgICAgIHN0YXRp
YyBmYWxzZV90eXBlIF9fdGVzdCguLi4pOwogIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwg
dHlwZW5hbWUgX0FyZz4KICAgIHN0cnVjdCBfX2lzX2RpcmVjdF9jb25zdHJ1Y3RpYmxlX2ltcGwK
ICAgIDogcHVibGljIF9fZG9faXNfZGlyZWN0X2NvbnN0cnVjdGlibGVfaW1wbAogICAgewogICAg
ICB0eXBlZGVmIGRlY2x0eXBlKF9fdGVzdDxfVHAsIF9Bcmc+KDApKSB0eXBlOwogICAgfTsKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQXJnPgogICAgc3RydWN0IF9faXNfZGly
ZWN0X2NvbnN0cnVjdGlibGVfbmV3X3NhZmUKICAgIDogcHVibGljIF9fYW5kXzxpc19kZXN0cnVj
dGlibGU8X1RwPiwKICAgICAgICAgICAgICAgICAgICBfX2lzX2RpcmVjdF9jb25zdHJ1Y3RpYmxl
X2ltcGw8X1RwLCBfQXJnPj4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUsIHR5cGVuYW1l
PgogICAgc3RydWN0IGlzX3NhbWU7CgogIHRlbXBsYXRlPHR5cGVuYW1lLCB0eXBlbmFtZT4KICAg
IHN0cnVjdCBpc19iYXNlX29mOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZT4KICAgIHN0cnVjdCByZW1v
dmVfcmVmZXJlbmNlOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnJvbSwgdHlwZW5hbWUgX1RvLCBi
b29sCiAgICAgICAgICAgPSBfX25vdF88X19vcl88aXNfdm9pZDxfRnJvbT4sCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgaXNfZnVuY3Rpb248X0Zyb20+Pj46OnZhbHVlPgogICAgc3RydWN0IF9f
aXNfYmFzZV90b19kZXJpdmVkX3JlZjsKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnJvbSwgdHlw
ZW5hbWUgX1RvPgogICAgc3RydWN0IF9faXNfYmFzZV90b19kZXJpdmVkX3JlZjxfRnJvbSwgX1Rv
LCB0cnVlPgogICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIHJlbW92ZV9jdjx0eXBlbmFtZSBy
ZW1vdmVfcmVmZXJlbmNlPF9Gcm9tCiAgICAgICAgPjo6dHlwZT46OnR5cGUgX19zcmNfdDsKICAg
ICAgdHlwZWRlZiB0eXBlbmFtZSByZW1vdmVfY3Y8dHlwZW5hbWUgcmVtb3ZlX3JlZmVyZW5jZTxf
VG8KICAgICAgICA+Ojp0eXBlPjo6dHlwZSBfX2RzdF90OwogICAgICB0eXBlZGVmIF9fYW5kXzxf
X25vdF88aXNfc2FtZTxfX3NyY190LCBfX2RzdF90Pj4sCiAgICAgICBpc19iYXNlX29mPF9fc3Jj
X3QsIF9fZHN0X3Q+PiB0eXBlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgdmFsdWUgPSB0
eXBlOjp2YWx1ZTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gcm9tLCB0eXBlbmFtZSBf
VG8+CiAgICBzdHJ1Y3QgX19pc19iYXNlX3RvX2Rlcml2ZWRfcmVmPF9Gcm9tLCBfVG8sIGZhbHNl
PgogICAgOiBwdWJsaWMgZmFsc2VfdHlwZQogICAgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
RnJvbSwgdHlwZW5hbWUgX1RvLCBib29sCiAgICAgICAgICAgPSBfX2FuZF88aXNfbHZhbHVlX3Jl
ZmVyZW5jZTxfRnJvbT4sCiAgICAgICAgICAgICAgICAgICAgaXNfcnZhbHVlX3JlZmVyZW5jZTxf
VG8+Pjo6dmFsdWU+CiAgICBzdHJ1Y3QgX19pc19sdmFsdWVfdG9fcnZhbHVlX3JlZjsKCgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfRnJvbSwgdHlwZW5hbWUgX1RvPgogICAgc3RydWN0IF9faXNfbHZh
bHVlX3RvX3J2YWx1ZV9yZWY8X0Zyb20sIF9UbywgdHJ1ZT4KICAgIHsKICAgICAgdHlwZWRlZiB0
eXBlbmFtZSByZW1vdmVfY3Y8dHlwZW5hbWUgcmVtb3ZlX3JlZmVyZW5jZTwKICAgICAgICBfRnJv
bT46OnR5cGU+Ojp0eXBlIF9fc3JjX3Q7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgcmVtb3ZlX2N2
PHR5cGVuYW1lIHJlbW92ZV9yZWZlcmVuY2U8CiAgICAgICAgX1RvPjo6dHlwZT46OnR5cGUgX19k
c3RfdDsKICAgICAgdHlwZWRlZiBfX2FuZF88X19ub3RfPGlzX2Z1bmN0aW9uPF9fc3JjX3Q+PiwK
ICAgICAgICBfX29yXzxpc19zYW1lPF9fc3JjX3QsIF9fZHN0X3Q+LAogICAgICBpc19iYXNlX29m
PF9fZHN0X3QsIF9fc3JjX3Q+Pj4gdHlwZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIHZh
bHVlID0gdHlwZTo6dmFsdWU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnJvbSwgdHlw
ZW5hbWUgX1RvPgogICAgc3RydWN0IF9faXNfbHZhbHVlX3RvX3J2YWx1ZV9yZWY8X0Zyb20sIF9U
bywgZmFsc2U+CiAgICA6IHB1YmxpYyBmYWxzZV90eXBlCiAgICB7IH07CgoKCgoKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FyZz4KICAgIHN0cnVjdCBfX2lzX2RpcmVjdF9j
b25zdHJ1Y3RpYmxlX3JlZl9jYXN0CiAgICA6IHB1YmxpYyBfX2FuZF88X19pc19zdGF0aWNfY2Fz
dGFibGU8X0FyZywgX1RwPiwKICAgICAgICAgICAgICAgICAgICBfX25vdF88X19vcl88X19pc19i
YXNlX3RvX2Rlcml2ZWRfcmVmPF9BcmcsIF9UcD4sCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIF9faXNfbHZhbHVlX3RvX3J2YWx1ZV9yZWY8X0FyZywgX1RwPgogICAgICAgICAgICAg
ICAgICAgPj4+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0Fy
Zz4KICAgIHN0cnVjdCBfX2lzX2RpcmVjdF9jb25zdHJ1Y3RpYmxlX25ldwogICAgOiBwdWJsaWMg
Y29uZGl0aW9uYWw8aXNfcmVmZXJlbmNlPF9UcD46OnZhbHVlLAogICAgX19pc19kaXJlY3RfY29u
c3RydWN0aWJsZV9yZWZfY2FzdDxfVHAsIF9Bcmc+LAogICAgX19pc19kaXJlY3RfY29uc3RydWN0
aWJsZV9uZXdfc2FmZTxfVHAsIF9Bcmc+CiAgICA+Ojp0eXBlCiAgICB7IH07CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FyZz4KICAgIHN0cnVjdCBfX2lzX2RpcmVjdF9jb25z
dHJ1Y3RpYmxlCiAgICA6IHB1YmxpYyBfX2lzX2RpcmVjdF9jb25zdHJ1Y3RpYmxlX25ldzxfVHAs
IF9Bcmc+Ojp0eXBlCiAgICB7IH07CgoKCgoKCiAgc3RydWN0IF9fZG9faXNfbmFyeV9jb25zdHJ1
Y3RpYmxlX2ltcGwKICB7CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lLi4uIF9B
cmdzLCB0eXBlbmFtZQogICAgICAgICAgICAgPSBkZWNsdHlwZShfVHAoZGVjbHZhbDxfQXJncz4o
KS4uLikpPgogICAgICBzdGF0aWMgdHJ1ZV90eXBlIF9fdGVzdChpbnQpOwoKICAgIHRlbXBsYXRl
PHR5cGVuYW1lLCB0eXBlbmFtZS4uLj4KICAgICAgc3RhdGljIGZhbHNlX3R5cGUgX190ZXN0KC4u
Lik7CiAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZS4uLiBfQXJncz4KICAg
IHN0cnVjdCBfX2lzX25hcnlfY29uc3RydWN0aWJsZV9pbXBsCiAgICA6IHB1YmxpYyBfX2RvX2lz
X25hcnlfY29uc3RydWN0aWJsZV9pbXBsCiAgICB7CiAgICAgIHR5cGVkZWYgZGVjbHR5cGUoX190
ZXN0PF9UcCwgX0FyZ3MuLi4+KDApKSB0eXBlOwogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgIHN0cnVjdCBfX2lzX25hcnlfY29uc3RydWN0aWJs
ZQogICAgOiBwdWJsaWMgX19pc19uYXJ5X2NvbnN0cnVjdGlibGVfaW1wbDxfVHAsIF9BcmdzLi4u
Pjo6dHlwZQogICAgewogICAgICBzdGF0aWNfYXNzZXJ0KHNpemVvZi4uLihfQXJncykgPiAxLAog
ICAgICAgICAgICAgICAgICAgICJPbmx5IHVzZWZ1bCBmb3IgPiAxIGFyZ3VtZW50cyIpOwogICAg
fTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgIHN0cnVj
dCBfX2lzX2NvbnN0cnVjdGlibGVfaW1wbAogICAgOiBwdWJsaWMgX19pc19uYXJ5X2NvbnN0cnVj
dGlibGU8X1RwLCBfQXJncy4uLj4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0
eXBlbmFtZSBfQXJnPgogICAgc3RydWN0IF9faXNfY29uc3RydWN0aWJsZV9pbXBsPF9UcCwgX0Fy
Zz4KICAgIDogcHVibGljIF9faXNfZGlyZWN0X2NvbnN0cnVjdGlibGU8X1RwLCBfQXJnPgogICAg
eyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19pc19jb25zdHJ1Y3Rp
YmxlX2ltcGw8X1RwPgogICAgOiBwdWJsaWMgaXNfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlPF9UcD4K
ICAgIHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUuLi4gX0FyZ3M+CiAg
ICBzdHJ1Y3QgaXNfY29uc3RydWN0aWJsZQogICAgOiBwdWJsaWMgX19pc19jb25zdHJ1Y3RpYmxl
X2ltcGw8X1RwLCBfQXJncy4uLj46OnR5cGUKICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwLCBib29sID0gX19pc19yZWZlcmVuY2VhYmxlPF9UcD46OnZhbHVlPgogICAgc3RydWN0IF9f
aXNfY29weV9jb25zdHJ1Y3RpYmxlX2ltcGw7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
IHN0cnVjdCBfX2lzX2NvcHlfY29uc3RydWN0aWJsZV9pbXBsPF9UcCwgZmFsc2U+CiAgICA6IHB1
YmxpYyBmYWxzZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0
IF9faXNfY29weV9jb25zdHJ1Y3RpYmxlX2ltcGw8X1RwLCB0cnVlPgogICAgOiBwdWJsaWMgaXNf
Y29uc3RydWN0aWJsZTxfVHAsIGNvbnN0IF9UcCY+CiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHA+CiAgICBzdHJ1Y3QgaXNfY29weV9jb25zdHJ1Y3RpYmxlCiAgICA6IHB1YmxpYyBf
X2lzX2NvcHlfY29uc3RydWN0aWJsZV9pbXBsPF9UcD4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwLCBib29sID0gX19pc19yZWZlcmVuY2VhYmxlPF9UcD46OnZhbHVlPgogICAgc3Ry
dWN0IF9faXNfbW92ZV9jb25zdHJ1Y3RpYmxlX2ltcGw7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cD4KICAgIHN0cnVjdCBfX2lzX21vdmVfY29uc3RydWN0aWJsZV9pbXBsPF9UcCwgZmFsc2U+CiAg
ICA6IHB1YmxpYyBmYWxzZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAg
c3RydWN0IF9faXNfbW92ZV9jb25zdHJ1Y3RpYmxlX2ltcGw8X1RwLCB0cnVlPgogICAgOiBwdWJs
aWMgaXNfY29uc3RydWN0aWJsZTxfVHAsIF9UcCYmPgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwPgogICAgc3RydWN0IGlzX21vdmVfY29uc3RydWN0aWJsZQogICAgOiBwdWJsaWMg
X19pc19tb3ZlX2NvbnN0cnVjdGlibGVfaW1wbDxfVHA+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX250X2RlZmF1bHRfY29uc3RydWN0aWJsZV9hdG9t
CiAgICA6IHB1YmxpYyBpbnRlZ3JhbF9jb25zdGFudDxib29sLCBub2V4Y2VwdChfVHAoKSk+CiAg
ICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgYm9vbCA9IGlzX2FycmF5PF9UcD46OnZh
bHVlPgogICAgc3RydWN0IF9faXNfbnRfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlX2ltcGw7CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX250X2RlZmF1bHRfY29uc3RydWN0
aWJsZV9pbXBsPF9UcCwgdHJ1ZT4KICAgIDogcHVibGljIF9fYW5kXzxfX2lzX2FycmF5X2tub3du
X2JvdW5kczxfVHA+LAogICAgICBfX2lzX250X2RlZmF1bHRfY29uc3RydWN0aWJsZV9hdG9tPHR5
cGVuYW1lCiAgICAgICAgICAgICAgICAgICAgICByZW1vdmVfYWxsX2V4dGVudHM8X1RwPjo6dHlw
ZT4+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX250
X2RlZmF1bHRfY29uc3RydWN0aWJsZV9pbXBsPF9UcCwgZmFsc2U+CiAgICA6IHB1YmxpYyBfX2lz
X250X2RlZmF1bHRfY29uc3RydWN0aWJsZV9hdG9tPF9UcD4KICAgIHsgfTsKCgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19ub3Rocm93X2RlZmF1bHRfY29uc3RydWN0aWJs
ZQogICAgOiBwdWJsaWMgX19hbmRfPGlzX2RlZmF1bHRfY29uc3RydWN0aWJsZTxfVHA+LAogICAg
ICAgICAgICAgICAgICAgIF9faXNfbnRfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlX2ltcGw8X1RwPj4K
ICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZS4uLiBfQXJncz4KICAg
IHN0cnVjdCBfX2lzX250X2NvbnN0cnVjdGlibGVfaW1wbAogICAgOiBwdWJsaWMgaW50ZWdyYWxf
Y29uc3RhbnQ8Ym9vbCwgbm9leGNlcHQoX1RwKGRlY2x2YWw8X0FyZ3M+KCkuLi4pKT4KICAgIHsg
fTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQXJnPgogICAgc3RydWN0IF9f
aXNfbnRfY29uc3RydWN0aWJsZV9pbXBsPF9UcCwgX0FyZz4KICAgIDogcHVibGljIGludGVncmFs
X2NvbnN0YW50PGJvb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2V4Y2VwdChz
dGF0aWNfY2FzdDxfVHA+KGRlY2x2YWw8X0FyZz4oKSkpPgogICAgeyB9OwoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19pc19udF9jb25zdHJ1Y3RpYmxlX2ltcGw8X1RwPgog
ICAgOiBwdWJsaWMgaXNfbm90aHJvd19kZWZhdWx0X2NvbnN0cnVjdGlibGU8X1RwPgogICAgeyB9
OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgIHN0cnVj
dCBpc19ub3Rocm93X2NvbnN0cnVjdGlibGUKICAgIDogcHVibGljIF9fYW5kXzxpc19jb25zdHJ1
Y3RpYmxlPF9UcCwgX0FyZ3MuLi4+LAogICAgICBfX2lzX250X2NvbnN0cnVjdGlibGVfaW1wbDxf
VHAsIF9BcmdzLi4uPj4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBib29sID0g
X19pc19yZWZlcmVuY2VhYmxlPF9UcD46OnZhbHVlPgogICAgc3RydWN0IF9faXNfbm90aHJvd19j
b3B5X2NvbnN0cnVjdGlibGVfaW1wbDsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3Ry
dWN0IF9faXNfbm90aHJvd19jb3B5X2NvbnN0cnVjdGlibGVfaW1wbDxfVHAsIGZhbHNlPgogICAg
OiBwdWJsaWMgZmFsc2VfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0
cnVjdCBfX2lzX25vdGhyb3dfY29weV9jb25zdHJ1Y3RpYmxlX2ltcGw8X1RwLCB0cnVlPgogICAg
OiBwdWJsaWMgaXNfbm90aHJvd19jb25zdHJ1Y3RpYmxlPF9UcCwgY29uc3QgX1RwJj4KICAgIHsg
fTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc19ub3Rocm93X2NvcHlf
Y29uc3RydWN0aWJsZQogICAgOiBwdWJsaWMgX19pc19ub3Rocm93X2NvcHlfY29uc3RydWN0aWJs
ZV9pbXBsPF9UcD4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBib29sID0gX19p
c19yZWZlcmVuY2VhYmxlPF9UcD46OnZhbHVlPgogICAgc3RydWN0IF9faXNfbm90aHJvd19tb3Zl
X2NvbnN0cnVjdGlibGVfaW1wbDsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0
IF9faXNfbm90aHJvd19tb3ZlX2NvbnN0cnVjdGlibGVfaW1wbDxfVHAsIGZhbHNlPgogICAgOiBw
dWJsaWMgZmFsc2VfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVj
dCBfX2lzX25vdGhyb3dfbW92ZV9jb25zdHJ1Y3RpYmxlX2ltcGw8X1RwLCB0cnVlPgogICAgOiBw
dWJsaWMgaXNfbm90aHJvd19jb25zdHJ1Y3RpYmxlPF9UcCwgX1RwJiY+CiAgICB7IH07CgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgaXNfbm90aHJvd19tb3ZlX2NvbnN0cnVj
dGlibGUKICAgIDogcHVibGljIF9faXNfbm90aHJvd19tb3ZlX2NvbnN0cnVjdGlibGVfaW1wbDxf
VHA+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1VwPgogICAg
Y2xhc3MgX19pc19hc3NpZ25hYmxlX2hlbHBlcgogICAgewogICAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfVHAxLCB0eXBlbmFtZSBfVXAxLAogICAgICAgIHR5cGVuYW1lID0gZGVjbHR5cGUoZGVjbHZh
bDxfVHAxPigpID0gZGVjbHZhbDxfVXAxPigpKT4KIHN0YXRpYyB0cnVlX3R5cGUKIF9fdGVzdChp
bnQpOwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUsIHR5cGVuYW1lPgogc3RhdGljIGZhbHNlX3R5
cGUKIF9fdGVzdCguLi4pOwoKICAgIHB1YmxpYzoKICAgICAgdHlwZWRlZiBkZWNsdHlwZShfX3Rl
c3Q8X1RwLCBfVXA+KDApKSB0eXBlOwogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwg
dHlwZW5hbWUgX1VwPgogICAgc3RydWN0IGlzX2Fzc2lnbmFibGUKICAgICAgOiBwdWJsaWMgX19p
c19hc3NpZ25hYmxlX2hlbHBlcjxfVHAsIF9VcD46OnR5cGUKICAgIHsgfTsKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX1RwLCBib29sID0gX19pc19yZWZlcmVuY2VhYmxlPF9UcD46OnZhbHVlPgogICAg
c3RydWN0IF9faXNfY29weV9hc3NpZ25hYmxlX2ltcGw7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cD4KICAgIHN0cnVjdCBfX2lzX2NvcHlfYXNzaWduYWJsZV9pbXBsPF9UcCwgZmFsc2U+CiAgICA6
IHB1YmxpYyBmYWxzZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3Ry
dWN0IF9faXNfY29weV9hc3NpZ25hYmxlX2ltcGw8X1RwLCB0cnVlPgogICAgOiBwdWJsaWMgaXNf
YXNzaWduYWJsZTxfVHAmLCBjb25zdCBfVHAmPgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwPgogICAgc3RydWN0IGlzX2NvcHlfYXNzaWduYWJsZQogICAgOiBwdWJsaWMgX19pc19j
b3B5X2Fzc2lnbmFibGVfaW1wbDxfVHA+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cCwgYm9vbCA9IF9faXNfcmVmZXJlbmNlYWJsZTxfVHA+Ojp2YWx1ZT4KICAgIHN0cnVjdCBfX2lz
X21vdmVfYXNzaWduYWJsZV9pbXBsOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1
Y3QgX19pc19tb3ZlX2Fzc2lnbmFibGVfaW1wbDxfVHAsIGZhbHNlPgogICAgOiBwdWJsaWMgZmFs
c2VfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX21v
dmVfYXNzaWduYWJsZV9pbXBsPF9UcCwgdHJ1ZT4KICAgIDogcHVibGljIGlzX2Fzc2lnbmFibGU8
X1RwJiwgX1RwJiY+CiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1
Y3QgaXNfbW92ZV9hc3NpZ25hYmxlCiAgICA6IHB1YmxpYyBfX2lzX21vdmVfYXNzaWduYWJsZV9p
bXBsPF9UcD4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfVXA+
CiAgICBzdHJ1Y3QgX19pc19udF9hc3NpZ25hYmxlX2ltcGwKICAgIDogcHVibGljIGludGVncmFs
X2NvbnN0YW50PGJvb2wsIG5vZXhjZXB0KGRlY2x2YWw8X1RwPigpID0gZGVjbHZhbDxfVXA+KCkp
PgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfVXA+CiAgICBz
dHJ1Y3QgaXNfbm90aHJvd19hc3NpZ25hYmxlCiAgICA6IHB1YmxpYyBfX2FuZF88aXNfYXNzaWdu
YWJsZTxfVHAsIF9VcD4sCiAgICAgIF9faXNfbnRfYXNzaWduYWJsZV9pbXBsPF9UcCwgX1VwPj4K
ICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBib29sID0gX19pc19yZWZlcmVuY2Vh
YmxlPF9UcD46OnZhbHVlPgogICAgc3RydWN0IF9faXNfbnRfY29weV9hc3NpZ25hYmxlX2ltcGw7
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX250X2NvcHlfYXNzaWdu
YWJsZV9pbXBsPF9UcCwgZmFsc2U+CiAgICA6IHB1YmxpYyBmYWxzZV90eXBlIHsgfTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNfbnRfY29weV9hc3NpZ25hYmxlX2lt
cGw8X1RwLCB0cnVlPgogICAgOiBwdWJsaWMgaXNfbm90aHJvd19hc3NpZ25hYmxlPF9UcCYsIGNv
bnN0IF9UcCY+CiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3Qg
aXNfbm90aHJvd19jb3B5X2Fzc2lnbmFibGUKICAgIDogcHVibGljIF9faXNfbnRfY29weV9hc3Np
Z25hYmxlX2ltcGw8X1RwPgogICAgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIGJvb2wg
PSBfX2lzX3JlZmVyZW5jZWFibGU8X1RwPjo6dmFsdWU+CiAgICBzdHJ1Y3QgX19pc19udF9tb3Zl
X2Fzc2lnbmFibGVfaW1wbDsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9f
aXNfbnRfbW92ZV9hc3NpZ25hYmxlX2ltcGw8X1RwLCBmYWxzZT4KICAgIDogcHVibGljIGZhbHNl
X3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19pc19udF9t
b3ZlX2Fzc2lnbmFibGVfaW1wbDxfVHAsIHRydWU+CiAgICA6IHB1YmxpYyBpc19ub3Rocm93X2Fz
c2lnbmFibGU8X1RwJiwgX1RwJiY+CiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+
CiAgICBzdHJ1Y3QgaXNfbm90aHJvd19tb3ZlX2Fzc2lnbmFibGUKICAgIDogcHVibGljIF9faXNf
bnRfbW92ZV9hc3NpZ25hYmxlX2ltcGw8X1RwPgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgIHN0cnVjdCBpc190cml2aWFsbHlfY29uc3Ry
dWN0aWJsZQogICAgOiBwdWJsaWMgX19hbmRfPGlzX2NvbnN0cnVjdGlibGU8X1RwLCBfQXJncy4u
Lj4sIGludGVncmFsX2NvbnN0YW50PGJvb2wsCiAgIF9faXNfdHJpdmlhbGx5X2NvbnN0cnVjdGli
bGUoX1RwLCBfQXJncy4uLik+PgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgog
ICAgc3RydWN0IGlzX3RyaXZpYWxseV9kZWZhdWx0X2NvbnN0cnVjdGlibGUKICAgIDogcHVibGlj
IGlzX3RyaXZpYWxseV9jb25zdHJ1Y3RpYmxlPF9UcD46OnR5cGUKICAgIHsgfTsKCiAgc3RydWN0
IF9fZG9faXNfaW1wbGljaXRseV9kZWZhdWx0X2NvbnN0cnVjdGlibGVfaW1wbAogIHsKICAgIHRl
bXBsYXRlIDx0eXBlbmFtZSBfVHA+CiAgICBzdGF0aWMgdm9pZCBfX2hlbHBlcihjb25zdCBfVHAm
KTsKCiAgICB0ZW1wbGF0ZSA8dHlwZW5hbWUgX1RwPgogICAgc3RhdGljIHRydWVfdHlwZSBfX3Rl
c3QoY29uc3QgX1RwJiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY2x0eXBlKF9faGVs
cGVyPGNvbnN0IF9UcCY+KHt9KSkqID0gMCk7CgogICAgc3RhdGljIGZhbHNlX3R5cGUgX190ZXN0
KC4uLik7CiAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNfaW1w
bGljaXRseV9kZWZhdWx0X2NvbnN0cnVjdGlibGVfaW1wbAogICAgICA6IHB1YmxpYyBfX2RvX2lz
X2ltcGxpY2l0bHlfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlX2ltcGwKICB7CiAgICB0eXBlZGVmIGRl
Y2x0eXBlKF9fdGVzdChkZWNsdmFsPF9UcD4oKSkpIHR5cGU7CiAgfTsKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNfaW1wbGljaXRseV9kZWZhdWx0X2NvbnN0cnVjdGli
bGVfc2FmZQogICAgICA6IHB1YmxpYyBfX2lzX2ltcGxpY2l0bHlfZGVmYXVsdF9jb25zdHJ1Y3Rp
YmxlX2ltcGw8X1RwPjo6dHlwZQogIHsgfTsKCiAgdGVtcGxhdGUgPHR5cGVuYW1lIF9UcD4KICAg
IHN0cnVjdCBfX2lzX2ltcGxpY2l0bHlfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlCiAgICAgIDogcHVi
bGljIF9fYW5kXzxpc19kZWZhdWx0X2NvbnN0cnVjdGlibGU8X1RwPiwKICAgICAgICAgICAgICAg
ICAgICAgIF9faXNfaW1wbGljaXRseV9kZWZhdWx0X2NvbnN0cnVjdGlibGVfc2FmZTxfVHA+Pgog
IHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc190cml2aWFsbHlf
Y29weV9jb25zdHJ1Y3RpYmxlCiAgICA6IHB1YmxpYyBfX2FuZF88aXNfY29weV9jb25zdHJ1Y3Rp
YmxlPF9UcD4sCiAgICAgIGludGVncmFsX2NvbnN0YW50PGJvb2wsCiAgIF9faXNfdHJpdmlhbGx5
X2NvbnN0cnVjdGlibGUoX1RwLCBjb25zdCBfVHAmKT4+CiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgaXNfdHJpdmlhbGx5X21vdmVfY29uc3RydWN0aWJsZQog
ICAgOiBwdWJsaWMgX19hbmRfPGlzX21vdmVfY29uc3RydWN0aWJsZTxfVHA+LAogICAgICBpbnRl
Z3JhbF9jb25zdGFudDxib29sLAogICBfX2lzX3RyaXZpYWxseV9jb25zdHJ1Y3RpYmxlKF9UcCwg
X1RwJiYpPj4KICAgIHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1Vw
PgogICAgc3RydWN0IGlzX3RyaXZpYWxseV9hc3NpZ25hYmxlCiAgICA6IHB1YmxpYyBfX2FuZF88
aXNfYXNzaWduYWJsZTxfVHAsIF9VcD4sCiAgICAgIGludGVncmFsX2NvbnN0YW50PGJvb2wsCiAg
IF9faXNfdHJpdmlhbGx5X2Fzc2lnbmFibGUoX1RwLCBfVXApPj4KICAgIHsgfTsKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBpc190cml2aWFsbHlfY29weV9hc3NpZ25hYmxl
CiAgICA6IHB1YmxpYyBfX2FuZF88aXNfY29weV9hc3NpZ25hYmxlPF9UcD4sCiAgICAgIGludGVn
cmFsX2NvbnN0YW50PGJvb2wsCiAgIF9faXNfdHJpdmlhbGx5X2Fzc2lnbmFibGUoX1RwJiwgY29u
c3QgX1RwJik+PgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0
IGlzX3RyaXZpYWxseV9tb3ZlX2Fzc2lnbmFibGUKICAgIDogcHVibGljIF9fYW5kXzxpc19tb3Zl
X2Fzc2lnbmFibGU8X1RwPiwKICAgICAgaW50ZWdyYWxfY29uc3RhbnQ8Ym9vbCwKICAgX19pc190
cml2aWFsbHlfYXNzaWduYWJsZShfVHAmLCBfVHAmJik+PgogICAgeyB9OwoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGlzX3RyaXZpYWxseV9kZXN0cnVjdGlibGUKICAgIDog
cHVibGljIF9fYW5kXzxpc19kZXN0cnVjdGlibGU8X1RwPiwgaW50ZWdyYWxfY29uc3RhbnQ8Ym9v
bCwKICAgICAgICAgX19oYXNfdHJpdmlhbF9kZXN0cnVjdG9yKF9UcCk+PgogICAgeyB9OwoKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGhhc190cml2aWFsX2RlZmF1bHRfY29u
c3RydWN0b3IKICAgIDogcHVibGljIGludGVncmFsX2NvbnN0YW50PGJvb2wsIF9faGFzX3RyaXZp
YWxfY29uc3RydWN0b3IoX1RwKT4KICAgIHsgfSBfX2F0dHJpYnV0ZV9fICgoX19kZXByZWNhdGVk
X18pKTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBoYXNfdHJpdmlhbF9j
b3B5X2NvbnN0cnVjdG9yCiAgICA6IHB1YmxpYyBpbnRlZ3JhbF9jb25zdGFudDxib29sLCBfX2hh
c190cml2aWFsX2NvcHkoX1RwKT4KICAgIHsgfSBfX2F0dHJpYnV0ZV9fICgoX19kZXByZWNhdGVk
X18pKTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBoYXNfdHJpdmlhbF9j
b3B5X2Fzc2lnbgogICAgOiBwdWJsaWMgaW50ZWdyYWxfY29uc3RhbnQ8Ym9vbCwgX19oYXNfdHJp
dmlhbF9hc3NpZ24oX1RwKT4KICAgIHsgfSBfX2F0dHJpYnV0ZV9fICgoX19kZXByZWNhdGVkX18p
KTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBoYXNfdmlydHVhbF9kZXN0
cnVjdG9yCiAgICA6IHB1YmxpYyBpbnRlZ3JhbF9jb25zdGFudDxib29sLCBfX2hhc192aXJ0dWFs
X2Rlc3RydWN0b3IoX1RwKT4KICAgIHsgfTsKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4K
ICAgIHN0cnVjdCBhbGlnbm1lbnRfb2YKICAgIDogcHVibGljIGludGVncmFsX2NvbnN0YW50PHN0
ZDo6c2l6ZV90LCBfX2FsaWdub2ZfXyhfVHApPiB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZT4K
ICAgIHN0cnVjdCByYW5rCiAgICA6IHB1YmxpYyBpbnRlZ3JhbF9jb25zdGFudDxzdGQ6OnNpemVf
dCwgMD4geyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHN0ZDo6c2l6ZV90IF9TaXplPgog
ICAgc3RydWN0IHJhbms8X1RwW19TaXplXT4KICAgIDogcHVibGljIGludGVncmFsX2NvbnN0YW50
PHN0ZDo6c2l6ZV90LCAxICsgcmFuazxfVHA+Ojp2YWx1ZT4geyB9OwoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHA+CiAgICBzdHJ1Y3QgcmFuazxfVHBbXT4KICAgIDogcHVibGljIGludGVncmFsX2Nv
bnN0YW50PHN0ZDo6c2l6ZV90LCAxICsgcmFuazxfVHA+Ojp2YWx1ZT4geyB9OwoKCiAgdGVtcGxh
dGU8dHlwZW5hbWUsIHVuc2lnbmVkIF9VaW50PgogICAgc3RydWN0IGV4dGVudAogICAgOiBwdWJs
aWMgaW50ZWdyYWxfY29uc3RhbnQ8c3RkOjpzaXplX3QsIDA+IHsgfTsKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwLCB1bnNpZ25lZCBfVWludCwgc3RkOjpzaXplX3QgX1NpemU+CiAgICBzdHJ1Y3Qg
ZXh0ZW50PF9UcFtfU2l6ZV0sIF9VaW50PgogICAgOiBwdWJsaWMgaW50ZWdyYWxfY29uc3RhbnQ8
c3RkOjpzaXplX3QsCiAgICAgICAgICBfVWludCA9PSAwID8gX1NpemUgOiBleHRlbnQ8X1RwLAog
ICAgICAgICAgX1VpbnQgLSAxPjo6dmFsdWU+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcCwgdW5zaWduZWQgX1VpbnQ+CiAgICBzdHJ1Y3QgZXh0ZW50PF9UcFtdLCBfVWludD4KICAg
IDogcHVibGljIGludGVncmFsX2NvbnN0YW50PHN0ZDo6c2l6ZV90LAogICAgICAgICAgX1VpbnQg
PT0gMCA/IDAgOiBleHRlbnQ8X1RwLAogICAgICAgICAgICAgX1VpbnQgLSAxPjo6dmFsdWU+CiAg
ICB7IH07CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSwgdHlwZW5hbWU+CiAgICBzdHJ1Y3QgaXNf
c2FtZQogICAgOiBwdWJsaWMgZmFsc2VfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cD4KICAgIHN0cnVjdCBpc19zYW1lPF9UcCwgX1RwPgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsg
fTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9CYXNlLCB0eXBlbmFtZSBfRGVyaXZlZD4KICAgIHN0
cnVjdCBpc19iYXNlX29mCiAgICA6IHB1YmxpYyBpbnRlZ3JhbF9jb25zdGFudDxib29sLCBfX2lz
X2Jhc2Vfb2YoX0Jhc2UsIF9EZXJpdmVkKT4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0Zyb20sIHR5cGVuYW1lIF9UbywKICAgICAgICAgICBib29sID0gX19vcl88aXNfdm9pZDxfRnJv
bT4sIGlzX2Z1bmN0aW9uPF9Ubz4sCiAgICAgICAgICAgICAgICAgICAgICAgIGlzX2FycmF5PF9U
bz4+Ojp2YWx1ZT4KICAgIHN0cnVjdCBfX2lzX2NvbnZlcnRpYmxlX2hlbHBlcgogICAgeyB0eXBl
ZGVmIHR5cGVuYW1lIGlzX3ZvaWQ8X1RvPjo6dHlwZSB0eXBlOyB9OwoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfRnJvbSwgdHlwZW5hbWUgX1RvPgogICAgY2xhc3MgX19pc19jb252ZXJ0aWJsZV9oZWxw
ZXI8X0Zyb20sIF9UbywgZmFsc2U+CiAgICB7CiAgICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVG8x
Pgogc3RhdGljIHZvaWQgX190ZXN0X2F1eChfVG8xKTsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9Gcm9tMSwgdHlwZW5hbWUgX1RvMSwKICAgICAgICB0eXBlbmFtZSA9IGRlY2x0eXBlKF9fdGVz
dF9hdXg8X1RvMT4oc3RkOjpkZWNsdmFsPF9Gcm9tMT4oKSkpPgogc3RhdGljIHRydWVfdHlwZQog
X190ZXN0KGludCk7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSwgdHlwZW5hbWU+CiBzdGF0aWMg
ZmFsc2VfdHlwZQogX190ZXN0KC4uLik7CgogICAgcHVibGljOgogICAgICB0eXBlZGVmIGRlY2x0
eXBlKF9fdGVzdDxfRnJvbSwgX1RvPigwKSkgdHlwZTsKICAgIH07CgoKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0Zyb20sIHR5cGVuYW1lIF9Ubz4KICAgIHN0cnVjdCBpc19jb252ZXJ0aWJsZQogICAg
OiBwdWJsaWMgX19pc19jb252ZXJ0aWJsZV9oZWxwZXI8X0Zyb20sIF9Ubz46OnR5cGUKICAgIHsg
fTsKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCByZW1vdmVfY29uc3QK
ICAgIHsgdHlwZWRlZiBfVHAgdHlwZTsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAg
c3RydWN0IHJlbW92ZV9jb25zdDxfVHAgY29uc3Q+CiAgICB7IHR5cGVkZWYgX1RwIHR5cGU7IH07
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgcmVtb3ZlX3ZvbGF0aWxlCiAg
ICB7IHR5cGVkZWYgX1RwIHR5cGU7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0
cnVjdCByZW1vdmVfdm9sYXRpbGU8X1RwIHZvbGF0aWxlPgogICAgeyB0eXBlZGVmIF9UcCB0eXBl
OyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IHJlbW92ZV9jdgogICAg
ewogICAgICB0eXBlZGVmIHR5cGVuYW1lCiAgICAgIHJlbW92ZV9jb25zdDx0eXBlbmFtZSByZW1v
dmVfdm9sYXRpbGU8X1RwPjo6dHlwZT46OnR5cGUgdHlwZTsKICAgIH07CgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgYWRkX2NvbnN0CiAgICB7IHR5cGVkZWYgX1RwIGNvbnN0
IHR5cGU7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgYWRkX3ZvbGF0
aWxlCiAgICB7IHR5cGVkZWYgX1RwIHZvbGF0aWxlIHR5cGU7IH07CgoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHA+CiAgICBzdHJ1Y3QgYWRkX2N2CiAgICB7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUK
ICAgICAgYWRkX2NvbnN0PHR5cGVuYW1lIGFkZF92b2xhdGlsZTxfVHA+Ojp0eXBlPjo6dHlwZSB0
eXBlOwogICAgfTsKIyAxNjMwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3R5cGVfdHJhaXRzIiAz
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IHJlbW92ZV9yZWZlcmVuY2UKICAg
IHsgdHlwZWRlZiBfVHAgdHlwZTsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3Ry
dWN0IHJlbW92ZV9yZWZlcmVuY2U8X1RwJj4KICAgIHsgdHlwZWRlZiBfVHAgdHlwZTsgfTsKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IHJlbW92ZV9yZWZlcmVuY2U8X1RwJiY+
CiAgICB7IHR5cGVkZWYgX1RwIHR5cGU7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgYm9v
bCA9IF9faXNfcmVmZXJlbmNlYWJsZTxfVHA+Ojp2YWx1ZT4KICAgIHN0cnVjdCBfX2FkZF9sdmFs
dWVfcmVmZXJlbmNlX2hlbHBlcgogICAgeyB0eXBlZGVmIF9UcCB0eXBlOyB9OwoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19hZGRfbHZhbHVlX3JlZmVyZW5jZV9oZWxwZXI8
X1RwLCB0cnVlPgogICAgeyB0eXBlZGVmIF9UcCYgdHlwZTsgfTsKCgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcD4KICAgIHN0cnVjdCBhZGRfbHZhbHVlX3JlZmVyZW5jZQogICAgOiBwdWJsaWMgX19h
ZGRfbHZhbHVlX3JlZmVyZW5jZV9oZWxwZXI8X1RwPgogICAgeyB9OwoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHAsIGJvb2wgPSBfX2lzX3JlZmVyZW5jZWFibGU8X1RwPjo6dmFsdWU+CiAgICBzdHJ1
Y3QgX19hZGRfcnZhbHVlX3JlZmVyZW5jZV9oZWxwZXIKICAgIHsgdHlwZWRlZiBfVHAgdHlwZTsg
fTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9fYWRkX3J2YWx1ZV9yZWZl
cmVuY2VfaGVscGVyPF9UcCwgdHJ1ZT4KICAgIHsgdHlwZWRlZiBfVHAmJiB0eXBlOyB9OwoKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGFkZF9ydmFsdWVfcmVmZXJlbmNlCiAg
ICA6IHB1YmxpYyBfX2FkZF9ydmFsdWVfcmVmZXJlbmNlX2hlbHBlcjxfVHA+CiAgICB7IH07CiMg
MTY4NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC90eXBlX3RyYWl0cyIgMwogIHRlbXBsYXRlPHR5
cGVuYW1lIF9VbnF1YWxpZmllZCwgYm9vbCBfSXNDb25zdCwgYm9vbCBfSXNWb2w+CiAgICBzdHJ1
Y3QgX19jdl9zZWxlY3RvcjsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1VucXVhbGlmaWVkPgogICAg
c3RydWN0IF9fY3Zfc2VsZWN0b3I8X1VucXVhbGlmaWVkLCBmYWxzZSwgZmFsc2U+CiAgICB7IHR5
cGVkZWYgX1VucXVhbGlmaWVkIF9fdHlwZTsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1VucXVh
bGlmaWVkPgogICAgc3RydWN0IF9fY3Zfc2VsZWN0b3I8X1VucXVhbGlmaWVkLCBmYWxzZSwgdHJ1
ZT4KICAgIHsgdHlwZWRlZiB2b2xhdGlsZSBfVW5xdWFsaWZpZWQgX190eXBlOyB9OwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVW5xdWFsaWZpZWQ+CiAgICBzdHJ1Y3QgX19jdl9zZWxlY3RvcjxfVW5x
dWFsaWZpZWQsIHRydWUsIGZhbHNlPgogICAgeyB0eXBlZGVmIGNvbnN0IF9VbnF1YWxpZmllZCBf
X3R5cGU7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9VbnF1YWxpZmllZD4KICAgIHN0cnVjdCBf
X2N2X3NlbGVjdG9yPF9VbnF1YWxpZmllZCwgdHJ1ZSwgdHJ1ZT4KICAgIHsgdHlwZWRlZiBjb25z
dCB2b2xhdGlsZSBfVW5xdWFsaWZpZWQgX190eXBlOyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
UXVhbGlmaWVkLCB0eXBlbmFtZSBfVW5xdWFsaWZpZWQsCiAgICBib29sIF9Jc0NvbnN0ID0gaXNf
Y29uc3Q8X1F1YWxpZmllZD46OnZhbHVlLAogICAgYm9vbCBfSXNWb2wgPSBpc192b2xhdGlsZTxf
UXVhbGlmaWVkPjo6dmFsdWU+CiAgICBjbGFzcyBfX21hdGNoX2N2X3F1YWxpZmllcnMKICAgIHsK
ICAgICAgdHlwZWRlZiBfX2N2X3NlbGVjdG9yPF9VbnF1YWxpZmllZCwgX0lzQ29uc3QsIF9Jc1Zv
bD4gX19tYXRjaDsKCiAgICBwdWJsaWM6CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19tYXRjaDo6
X190eXBlIF9fdHlwZTsKICAgIH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1
Y3QgX19tYWtlX3Vuc2lnbmVkCiAgICB7IHR5cGVkZWYgX1RwIF9fdHlwZTsgfTsKCiAgdGVtcGxh
dGU8PgogICAgc3RydWN0IF9fbWFrZV91bnNpZ25lZDxjaGFyPgogICAgeyB0eXBlZGVmIHVuc2ln
bmVkIGNoYXIgX190eXBlOyB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19tYWtlX3Vuc2ln
bmVkPHNpZ25lZCBjaGFyPgogICAgeyB0eXBlZGVmIHVuc2lnbmVkIGNoYXIgX190eXBlOyB9OwoK
ICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19tYWtlX3Vuc2lnbmVkPHNob3J0PgogICAgeyB0eXBl
ZGVmIHVuc2lnbmVkIHNob3J0IF9fdHlwZTsgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9f
bWFrZV91bnNpZ25lZDxpbnQ+CiAgICB7IHR5cGVkZWYgdW5zaWduZWQgaW50IF9fdHlwZTsgfTsK
CiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fbWFrZV91bnNpZ25lZDxsb25nPgogICAgeyB0eXBl
ZGVmIHVuc2lnbmVkIGxvbmcgX190eXBlOyB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19t
YWtlX3Vuc2lnbmVkPGxvbmcgbG9uZz4KICAgIHsgdHlwZWRlZiB1bnNpZ25lZCBsb25nIGxvbmcg
X190eXBlOyB9OwoKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fbWFrZV91bnNpZ25lZDx3Y2hh
cl90PiA6IF9fbWFrZV91bnNpZ25lZDxpbnQ+CiAgICB7IH07CiMgMTc3NCAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC90eXBlX3RyYWl0cyIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwKICAgIGJv
b2wgX0lzSW50ID0gaXNfaW50ZWdyYWw8X1RwPjo6dmFsdWUsCiAgICBib29sIF9Jc0VudW0gPSBp
c19lbnVtPF9UcD46OnZhbHVlPgogICAgY2xhc3MgX19tYWtlX3Vuc2lnbmVkX3NlbGVjdG9yOwoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBjbGFzcyBfX21ha2VfdW5zaWduZWRfc2VsZWN0
b3I8X1RwLCB0cnVlLCBmYWxzZT4KICAgIHsKICAgICAgdHlwZWRlZiBfX21ha2VfdW5zaWduZWQ8
dHlwZW5hbWUgcmVtb3ZlX2N2PF9UcD46OnR5cGU+IF9fdW5zaWduZWR0OwogICAgICB0eXBlZGVm
IHR5cGVuYW1lIF9fdW5zaWduZWR0OjpfX3R5cGUgX191bnNpZ25lZF90eXBlOwogICAgICB0eXBl
ZGVmIF9fbWF0Y2hfY3ZfcXVhbGlmaWVyczxfVHAsIF9fdW5zaWduZWRfdHlwZT4gX19jdl91bnNp
Z25lZDsKCiAgICBwdWJsaWM6CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19jdl91bnNpZ25lZDo6
X190eXBlIF9fdHlwZTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGNsYXNz
IF9fbWFrZV91bnNpZ25lZF9zZWxlY3RvcjxfVHAsIGZhbHNlLCB0cnVlPgogICAgewoKICAgICAg
dHlwZWRlZiB1bnNpZ25lZCBjaGFyIF9fc21hbGxlc3Q7CiAgICAgIHN0YXRpYyBjb25zdCBib29s
IF9fYjAgPSBzaXplb2YoX1RwKSA8PSBzaXplb2YoX19zbWFsbGVzdCk7CiAgICAgIHN0YXRpYyBj
b25zdCBib29sIF9fYjEgPSBzaXplb2YoX1RwKSA8PSBzaXplb2YodW5zaWduZWQgc2hvcnQpOwog
ICAgICBzdGF0aWMgY29uc3QgYm9vbCBfX2IyID0gc2l6ZW9mKF9UcCkgPD0gc2l6ZW9mKHVuc2ln
bmVkIGludCk7CiAgICAgIHN0YXRpYyBjb25zdCBib29sIF9fYjMgPSBzaXplb2YoX1RwKSA8PSBz
aXplb2YodW5zaWduZWQgbG9uZyk7CiAgICAgIHR5cGVkZWYgY29uZGl0aW9uYWw8X19iMywgdW5z
aWduZWQgbG9uZywgdW5zaWduZWQgbG9uZyBsb25nPiBfX2NvbmQzOwogICAgICB0eXBlZGVmIHR5
cGVuYW1lIF9fY29uZDM6OnR5cGUgX19jb25kM190eXBlOwogICAgICB0eXBlZGVmIGNvbmRpdGlv
bmFsPF9fYjIsIHVuc2lnbmVkIGludCwgX19jb25kM190eXBlPiBfX2NvbmQyOwogICAgICB0eXBl
ZGVmIHR5cGVuYW1lIF9fY29uZDI6OnR5cGUgX19jb25kMl90eXBlOwogICAgICB0eXBlZGVmIGNv
bmRpdGlvbmFsPF9fYjEsIHVuc2lnbmVkIHNob3J0LCBfX2NvbmQyX3R5cGU+IF9fY29uZDE7CiAg
ICAgIHR5cGVkZWYgdHlwZW5hbWUgX19jb25kMTo6dHlwZSBfX2NvbmQxX3R5cGU7CgogICAgICB0
eXBlZGVmIHR5cGVuYW1lIGNvbmRpdGlvbmFsPF9fYjAsIF9fc21hbGxlc3QsIF9fY29uZDFfdHlw
ZT46OnR5cGUKIF9fdW5zaWduZWRfdHlwZTsKICAgICAgdHlwZWRlZiBfX21hdGNoX2N2X3F1YWxp
ZmllcnM8X1RwLCBfX3Vuc2lnbmVkX3R5cGU+IF9fY3ZfdW5zaWduZWQ7CgogICAgcHVibGljOgog
ICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fY3ZfdW5zaWduZWQ6Ol9fdHlwZSBfX3R5cGU7CiAgICB9
OwoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IG1ha2VfdW5zaWduZWQK
ICAgIHsgdHlwZWRlZiB0eXBlbmFtZSBfX21ha2VfdW5zaWduZWRfc2VsZWN0b3I8X1RwPjo6X190
eXBlIHR5cGU7IH07CgoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgbWFrZV91bnNpZ25lZDxib29s
PjsKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19tYWtlX3NpZ25lZAog
ICAgeyB0eXBlZGVmIF9UcCBfX3R5cGU7IH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX21h
a2Vfc2lnbmVkPGNoYXI+CiAgICB7IHR5cGVkZWYgc2lnbmVkIGNoYXIgX190eXBlOyB9OwoKICB0
ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19tYWtlX3NpZ25lZDx1bnNpZ25lZCBjaGFyPgogICAgeyB0
eXBlZGVmIHNpZ25lZCBjaGFyIF9fdHlwZTsgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9f
bWFrZV9zaWduZWQ8dW5zaWduZWQgc2hvcnQ+CiAgICB7IHR5cGVkZWYgc2lnbmVkIHNob3J0IF9f
dHlwZTsgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fbWFrZV9zaWduZWQ8dW5zaWduZWQg
aW50PgogICAgeyB0eXBlZGVmIHNpZ25lZCBpbnQgX190eXBlOyB9OwoKICB0ZW1wbGF0ZTw+CiAg
ICBzdHJ1Y3QgX19tYWtlX3NpZ25lZDx1bnNpZ25lZCBsb25nPgogICAgeyB0eXBlZGVmIHNpZ25l
ZCBsb25nIF9fdHlwZTsgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fbWFrZV9zaWduZWQ8
dW5zaWduZWQgbG9uZyBsb25nPgogICAgeyB0eXBlZGVmIHNpZ25lZCBsb25nIGxvbmcgX190eXBl
OyB9OwojIDE4NjMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdHlwZV90cmFpdHMiIDMKICB0ZW1w
bGF0ZTw+CiAgICBzdHJ1Y3QgX19tYWtlX3NpZ25lZDxjaGFyMTZfdD4gOiBfX21ha2Vfc2lnbmVk
PHVpbnRfbGVhc3QxNl90PgogICAgeyB9OwogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX21ha2Vf
c2lnbmVkPGNoYXIzMl90PiA6IF9fbWFrZV9zaWduZWQ8dWludF9sZWFzdDMyX3Q+CiAgICB7IH07
CiMgMTg5MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC90eXBlX3RyYWl0cyIgMwogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcCwKICAgIGJvb2wgX0lzSW50ID0gaXNfaW50ZWdyYWw8X1RwPjo6dmFsdWUs
CiAgICBib29sIF9Jc0VudW0gPSBpc19lbnVtPF9UcD46OnZhbHVlPgogICAgY2xhc3MgX19tYWtl
X3NpZ25lZF9zZWxlY3RvcjsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgY2xhc3MgX19t
YWtlX3NpZ25lZF9zZWxlY3RvcjxfVHAsIHRydWUsIGZhbHNlPgogICAgewogICAgICB0eXBlZGVm
IF9fbWFrZV9zaWduZWQ8dHlwZW5hbWUgcmVtb3ZlX2N2PF9UcD46OnR5cGU+IF9fc2lnbmVkdDsK
ICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX3NpZ25lZHQ6Ol9fdHlwZSBfX3NpZ25lZF90eXBlOwog
ICAgICB0eXBlZGVmIF9fbWF0Y2hfY3ZfcXVhbGlmaWVyczxfVHAsIF9fc2lnbmVkX3R5cGU+IF9f
Y3Zfc2lnbmVkOwoKICAgIHB1YmxpYzoKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX2N2X3NpZ25l
ZDo6X190eXBlIF9fdHlwZTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGNs
YXNzIF9fbWFrZV9zaWduZWRfc2VsZWN0b3I8X1RwLCBmYWxzZSwgdHJ1ZT4KICAgIHsKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBfX21ha2VfdW5zaWduZWRfc2VsZWN0b3I8X1RwPjo6X190eXBlIF9f
dW5zaWduZWRfdHlwZTsKCiAgICBwdWJsaWM6CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19tYWtl
X3NpZ25lZF9zZWxlY3RvcjxfX3Vuc2lnbmVkX3R5cGU+OjpfX3R5cGUgX190eXBlOwogICAgfTsK
CgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBtYWtlX3NpZ25lZAogICAg
eyB0eXBlZGVmIHR5cGVuYW1lIF9fbWFrZV9zaWduZWRfc2VsZWN0b3I8X1RwPjo6X190eXBlIHR5
cGU7IH07CgoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgbWFrZV9zaWduZWQ8Ym9vbD47CiMgMTk0
MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC90eXBlX3RyYWl0cyIgMwogIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcD4KICAgIHN0cnVjdCByZW1vdmVfZXh0ZW50CiAgICB7IHR5cGVkZWYgX1RwIHR5cGU7
IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgc3RkOjpzaXplX3QgX1NpemU+CiAgICBzdHJ1
Y3QgcmVtb3ZlX2V4dGVudDxfVHBbX1NpemVdPgogICAgeyB0eXBlZGVmIF9UcCB0eXBlOyB9OwoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgcmVtb3ZlX2V4dGVudDxfVHBbXT4K
ICAgIHsgdHlwZWRlZiBfVHAgdHlwZTsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
IHN0cnVjdCByZW1vdmVfYWxsX2V4dGVudHMKICAgIHsgdHlwZWRlZiBfVHAgdHlwZTsgfTsKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBzdGQ6OnNpemVfdCBfU2l6ZT4KICAgIHN0cnVjdCByZW1v
dmVfYWxsX2V4dGVudHM8X1RwW19TaXplXT4KICAgIHsgdHlwZWRlZiB0eXBlbmFtZSByZW1vdmVf
YWxsX2V4dGVudHM8X1RwPjo6dHlwZSB0eXBlOyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+
CiAgICBzdHJ1Y3QgcmVtb3ZlX2FsbF9leHRlbnRzPF9UcFtdPgogICAgeyB0eXBlZGVmIHR5cGVu
YW1lIHJlbW92ZV9hbGxfZXh0ZW50czxfVHA+Ojp0eXBlIHR5cGU7IH07CiMgMTk4MCAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC90eXBlX3RyYWl0cyIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwg
dHlwZW5hbWU+CiAgICBzdHJ1Y3QgX19yZW1vdmVfcG9pbnRlcl9oZWxwZXIKICAgIHsgdHlwZWRl
ZiBfVHAgdHlwZTsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfVXA+CiAg
ICBzdHJ1Y3QgX19yZW1vdmVfcG9pbnRlcl9oZWxwZXI8X1RwLCBfVXAqPgogICAgeyB0eXBlZGVm
IF9VcCB0eXBlOyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IHJlbW92
ZV9wb2ludGVyCiAgICA6IHB1YmxpYyBfX3JlbW92ZV9wb2ludGVyX2hlbHBlcjxfVHAsIHR5cGVu
YW1lIHJlbW92ZV9jdjxfVHA+Ojp0eXBlPgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwLCBib29sID0gX19vcl88X19pc19yZWZlcmVuY2VhYmxlPF9UcD4sCiAgICAgICAgICBpc192
b2lkPF9UcD4+Ojp2YWx1ZT4KICAgIHN0cnVjdCBfX2FkZF9wb2ludGVyX2hlbHBlcgogICAgeyB0
eXBlZGVmIF9UcCB0eXBlOyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3Qg
X19hZGRfcG9pbnRlcl9oZWxwZXI8X1RwLCB0cnVlPgogICAgeyB0eXBlZGVmIHR5cGVuYW1lIHJl
bW92ZV9yZWZlcmVuY2U8X1RwPjo6dHlwZSogdHlwZTsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwPgogICAgc3RydWN0IGFkZF9wb2ludGVyCiAgICA6IHB1YmxpYyBfX2FkZF9wb2ludGVyX2hl
bHBlcjxfVHA+CiAgICB7IH07CiMgMjAxOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC90eXBlX3Ry
YWl0cyIgMwogIHRlbXBsYXRlPHN0ZDo6c2l6ZV90IF9MZW4+CiAgICBzdHJ1Y3QgX19hbGlnbmVk
X3N0b3JhZ2VfbXNhCiAgICB7CiAgICAgIHVuaW9uIF9fdHlwZQogICAgICB7CiB1bnNpZ25lZCBj
aGFyIF9fZGF0YVtfTGVuXTsKIHN0cnVjdCBfX2F0dHJpYnV0ZV9fKChfX2FsaWduZWRfXykpIHsg
fSBfX2FsaWduOwogICAgICB9OwogICAgfTsKIyAyMDM5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L3R5cGVfdHJhaXRzIiAzCiAgdGVtcGxhdGU8c3RkOjpzaXplX3QgX0xlbiwgc3RkOjpzaXplX3Qg
X0FsaWduID0KICAgIF9fYWxpZ25vZl9fKHR5cGVuYW1lIF9fYWxpZ25lZF9zdG9yYWdlX21zYTxf
TGVuPjo6X190eXBlKT4KICAgIHN0cnVjdCBhbGlnbmVkX3N0b3JhZ2UKICAgIHsKICAgICAgdW5p
b24gdHlwZQogICAgICB7CiB1bnNpZ25lZCBjaGFyIF9fZGF0YVtfTGVuXTsKIHN0cnVjdCBfX2F0
dHJpYnV0ZV9fKChfX2FsaWduZWRfXygoX0FsaWduKSkpKSB7IH0gX19hbGlnbjsKICAgICAgfTsK
ICAgIH07CgogIHRlbXBsYXRlIDx0eXBlbmFtZS4uLiBfVHlwZXM+CiAgICBzdHJ1Y3QgX19zdHJp
Y3Rlc3RfYWxpZ25tZW50CiAgICB7CiAgICAgIHN0YXRpYyBjb25zdCBzaXplX3QgX1NfYWxpZ25t
ZW50ID0gMDsKICAgICAgc3RhdGljIGNvbnN0IHNpemVfdCBfU19zaXplID0gMDsKICAgIH07Cgog
IHRlbXBsYXRlIDx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lLi4uIF9UeXBlcz4KICAgIHN0cnVjdCBf
X3N0cmljdGVzdF9hbGlnbm1lbnQ8X1RwLCBfVHlwZXMuLi4+CiAgICB7CiAgICAgIHN0YXRpYyBj
b25zdCBzaXplX3QgX1NfYWxpZ25tZW50ID0KICAgICAgICBhbGlnbm9mKF9UcCkgPiBfX3N0cmlj
dGVzdF9hbGlnbm1lbnQ8X1R5cGVzLi4uPjo6X1NfYWxpZ25tZW50CiA/IGFsaWdub2YoX1RwKSA6
IF9fc3RyaWN0ZXN0X2FsaWdubWVudDxfVHlwZXMuLi4+OjpfU19hbGlnbm1lbnQ7CiAgICAgIHN0
YXRpYyBjb25zdCBzaXplX3QgX1Nfc2l6ZSA9CiAgICAgICAgc2l6ZW9mKF9UcCkgPiBfX3N0cmlj
dGVzdF9hbGlnbm1lbnQ8X1R5cGVzLi4uPjo6X1Nfc2l6ZQogPyBzaXplb2YoX1RwKSA6IF9fc3Ry
aWN0ZXN0X2FsaWdubWVudDxfVHlwZXMuLi4+OjpfU19zaXplOwogICAgfTsKIyAyMDc4ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL3R5cGVfdHJhaXRzIiAzCiAgdGVtcGxhdGUgPHNpemVfdCBfTGVu
LCB0eXBlbmFtZS4uLiBfVHlwZXM+CiAgICBzdHJ1Y3QgYWxpZ25lZF91bmlvbgogICAgewogICAg
cHJpdmF0ZToKICAgICAgc3RhdGljX2Fzc2VydChzaXplb2YuLi4oX1R5cGVzKSAhPSAwLCAiQXQg
bGVhc3Qgb25lIHR5cGUgaXMgcmVxdWlyZWQiKTsKCiAgICAgIHVzaW5nIF9fc3RyaWN0ZXN0ID0g
X19zdHJpY3Rlc3RfYWxpZ25tZW50PF9UeXBlcy4uLj47CiAgICAgIHN0YXRpYyBjb25zdCBzaXpl
X3QgX1NfbGVuID0gX0xlbiA+IF9fc3RyaWN0ZXN0OjpfU19zaXplCiA/IF9MZW4gOiBfX3N0cmlj
dGVzdDo6X1Nfc2l6ZTsKICAgIHB1YmxpYzoKCiAgICAgIHN0YXRpYyBjb25zdCBzaXplX3QgYWxp
Z25tZW50X3ZhbHVlID0gX19zdHJpY3Rlc3Q6Ol9TX2FsaWdubWVudDsKCiAgICAgIHR5cGVkZWYg
dHlwZW5hbWUgYWxpZ25lZF9zdG9yYWdlPF9TX2xlbiwgYWxpZ25tZW50X3ZhbHVlPjo6dHlwZSB0
eXBlOwogICAgfTsKCiAgdGVtcGxhdGUgPHNpemVfdCBfTGVuLCB0eXBlbmFtZS4uLiBfVHlwZXM+
CiAgICBjb25zdCBzaXplX3QgYWxpZ25lZF91bmlvbjxfTGVuLCBfVHlwZXMuLi4+OjphbGlnbm1l
bnRfdmFsdWU7CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1VwLAogICAgYm9vbCBfSXNBcnJheSA9
IGlzX2FycmF5PF9VcD46OnZhbHVlLAogICAgYm9vbCBfSXNGdW5jdGlvbiA9IGlzX2Z1bmN0aW9u
PF9VcD46OnZhbHVlPgogICAgc3RydWN0IF9fZGVjYXlfc2VsZWN0b3I7CgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVXA+CiAgICBzdHJ1Y3QgX19kZWNheV9zZWxlY3RvcjxfVXAsIGZhbHNlLCBmYWxz
ZT4KICAgIHsgdHlwZWRlZiB0eXBlbmFtZSByZW1vdmVfY3Y8X1VwPjo6dHlwZSBfX3R5cGU7IH07
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9VcD4KICAgIHN0cnVjdCBfX2RlY2F5X3NlbGVjdG9yPF9V
cCwgdHJ1ZSwgZmFsc2U+CiAgICB7IHR5cGVkZWYgdHlwZW5hbWUgcmVtb3ZlX2V4dGVudDxfVXA+
Ojp0eXBlKiBfX3R5cGU7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9VcD4KICAgIHN0cnVjdCBf
X2RlY2F5X3NlbGVjdG9yPF9VcCwgZmFsc2UsIHRydWU+CiAgICB7IHR5cGVkZWYgdHlwZW5hbWUg
YWRkX3BvaW50ZXI8X1VwPjo6dHlwZSBfX3R5cGU7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHA+CiAgICBjbGFzcyBkZWNheQogICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIHJlbW92ZV9y
ZWZlcmVuY2U8X1RwPjo6dHlwZSBfX3JlbW92ZV90eXBlOwoKICAgIHB1YmxpYzoKICAgICAgdHlw
ZWRlZiB0eXBlbmFtZSBfX2RlY2F5X3NlbGVjdG9yPF9fcmVtb3ZlX3R5cGU+OjpfX3R5cGUgdHlw
ZTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGNsYXNzIHJlZmVyZW5jZV93
cmFwcGVyOwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9fc3RyaXBfcmVm
ZXJlbmNlX3dyYXBwZXIKICAgIHsKICAgICAgdHlwZWRlZiBfVHAgX190eXBlOwogICAgfTsKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9fc3RyaXBfcmVmZXJlbmNlX3dyYXBw
ZXI8cmVmZXJlbmNlX3dyYXBwZXI8X1RwPiA+CiAgICB7CiAgICAgIHR5cGVkZWYgX1RwJiBfX3R5
cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19kZWNheV9h
bmRfc3RyaXAKICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX3N0cmlwX3JlZmVyZW5jZV93
cmFwcGVyPAogdHlwZW5hbWUgZGVjYXk8X1RwPjo6dHlwZT46Ol9fdHlwZSBfX3R5cGU7CiAgICB9
OwoKCgoKICB0ZW1wbGF0ZTxib29sLCB0eXBlbmFtZSBfVHAgPSB2b2lkPgogICAgc3RydWN0IGVu
YWJsZV9pZgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGVu
YWJsZV9pZjx0cnVlLCBfVHA+CiAgICB7IHR5cGVkZWYgX1RwIHR5cGU7IH07CgogIHRlbXBsYXRl
PHR5cGVuYW1lLi4uIF9Db25kPgogICAgdXNpbmcgX1JlcXVpcmUgPSB0eXBlbmFtZSBlbmFibGVf
aWY8X19hbmRfPF9Db25kLi4uPjo6dmFsdWU+Ojp0eXBlOwoKCgogIHRlbXBsYXRlPGJvb2wgX0Nv
bmQsIHR5cGVuYW1lIF9JZnRydWUsIHR5cGVuYW1lIF9JZmZhbHNlPgogICAgc3RydWN0IGNvbmRp
dGlvbmFsCiAgICB7IHR5cGVkZWYgX0lmdHJ1ZSB0eXBlOyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0lmdHJ1ZSwgdHlwZW5hbWUgX0lmZmFsc2U+CiAgICBzdHJ1Y3QgY29uZGl0aW9uYWw8ZmFs
c2UsIF9JZnRydWUsIF9JZmZhbHNlPgogICAgeyB0eXBlZGVmIF9JZmZhbHNlIHR5cGU7IH07CgoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfVHA+CiAgICBzdHJ1Y3QgY29tbW9uX3R5cGU7CgoKCiAg
c3RydWN0IF9fZG9fY29tbW9uX3R5cGVfaW1wbAogIHsKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cCwgdHlwZW5hbWUgX1VwPgogICAgICBzdGF0aWMgX19zdWNjZXNzX3R5cGU8dHlwZW5hbWUgZGVj
YXk8ZGVjbHR5cGUKICAgICAgICh0cnVlID8gc3RkOjpkZWNsdmFsPF9UcD4oKQogICAgICAgIDog
c3RkOjpkZWNsdmFsPF9VcD4oKSk+Ojp0eXBlPiBfU190ZXN0KGludCk7CgogICAgdGVtcGxhdGU8
dHlwZW5hbWUsIHR5cGVuYW1lPgogICAgICBzdGF0aWMgX19mYWlsdXJlX3R5cGUgX1NfdGVzdCgu
Li4pOwogIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1VwPgogICAgc3Ry
dWN0IF9fY29tbW9uX3R5cGVfaW1wbAogICAgOiBwcml2YXRlIF9fZG9fY29tbW9uX3R5cGVfaW1w
bAogICAgewogICAgICB0eXBlZGVmIGRlY2x0eXBlKF9TX3Rlc3Q8X1RwLCBfVXA+KDApKSB0eXBl
OwogICAgfTsKCiAgc3RydWN0IF9fZG9fbWVtYmVyX3R5cGVfd3JhcHBlcgogIHsKICAgIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgICAgc3RhdGljIF9fc3VjY2Vzc190eXBlPHR5cGVuYW1lIF9U
cDo6dHlwZT4gX1NfdGVzdChpbnQpOwoKICAgIHRlbXBsYXRlPHR5cGVuYW1lPgogICAgICBzdGF0
aWMgX19mYWlsdXJlX3R5cGUgX1NfdGVzdCguLi4pOwogIH07CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcD4KICAgIHN0cnVjdCBfX21lbWJlcl90eXBlX3dyYXBwZXIKICAgIDogcHJpdmF0ZSBfX2Rv
X21lbWJlcl90eXBlX3dyYXBwZXIKICAgIHsKICAgICAgdHlwZWRlZiBkZWNsdHlwZShfU190ZXN0
PF9UcD4oMCkpIHR5cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ1RwLCB0eXBlbmFt
ZS4uLiBfQXJncz4KICAgIHN0cnVjdCBfX2V4cGFuZGVkX2NvbW1vbl90eXBlX3dyYXBwZXIKICAg
IHsKICAgICAgdHlwZWRlZiBjb21tb25fdHlwZTx0eXBlbmFtZSBfQ1RwOjp0eXBlLCBfQXJncy4u
Lj4gdHlwZTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogICAgc3RydWN0
IF9fZXhwYW5kZWRfY29tbW9uX3R5cGVfd3JhcHBlcjxfX2ZhaWx1cmVfdHlwZSwgX0FyZ3MuLi4+
CiAgICB7IHR5cGVkZWYgX19mYWlsdXJlX3R5cGUgdHlwZTsgfTsKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwPgogICAgc3RydWN0IGNvbW1vbl90eXBlPF9UcD4KICAgIHsgdHlwZWRlZiB0eXBlbmFt
ZSBkZWNheTxfVHA+Ojp0eXBlIHR5cGU7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlw
ZW5hbWUgX1VwPgogICAgc3RydWN0IGNvbW1vbl90eXBlPF9UcCwgX1VwPgogICAgOiBwdWJsaWMg
X19jb21tb25fdHlwZV9pbXBsPF9UcCwgX1VwPjo6dHlwZQogICAgeyB9OwoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9VcCwgdHlwZW5hbWUuLi4gX1ZwPgogICAgc3RydWN0IGNv
bW1vbl90eXBlPF9UcCwgX1VwLCBfVnAuLi4+CiAgICA6IHB1YmxpYyBfX2V4cGFuZGVkX2NvbW1v
bl90eXBlX3dyYXBwZXI8dHlwZW5hbWUgX19tZW1iZXJfdHlwZV93cmFwcGVyPAogICAgICAgICAg
ICAgICBjb21tb25fdHlwZTxfVHAsIF9VcD4+Ojp0eXBlLCBfVnAuLi4+Ojp0eXBlCiAgICB7IH07
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgdW5kZXJseWluZ190eXBlCiAg
ICB7CiAgICAgIHR5cGVkZWYgX191bmRlcmx5aW5nX3R5cGUoX1RwKSB0eXBlOwogICAgfTsKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9fZGVjbHZhbF9wcm90ZWN0b3IKICAg
IHsKICAgICAgc3RhdGljIGNvbnN0IGJvb2wgX19zdG9wID0gZmFsc2U7CiAgICAgIHN0YXRpYyB0
eXBlbmFtZSBhZGRfcnZhbHVlX3JlZmVyZW5jZTxfVHA+Ojp0eXBlIF9fZGVsZWdhdGUoKTsKICAg
IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSB0eXBlbmFtZSBhZGRfcnZh
bHVlX3JlZmVyZW5jZTxfVHA+Ojp0eXBlCiAgICBkZWNsdmFsKCkgbm9leGNlcHQKICAgIHsKICAg
ICAgc3RhdGljX2Fzc2VydChfX2RlY2x2YWxfcHJvdGVjdG9yPF9UcD46Ol9fc3RvcCwKICAgICAg
ImRlY2x2YWwoKSBtdXN0IG5vdCBiZSB1c2VkISIpOwogICAgICByZXR1cm4gX19kZWNsdmFsX3By
b3RlY3RvcjxfVHA+OjpfX2RlbGVnYXRlKCk7CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
U2lnbmF0dXJlPgogICAgY2xhc3MgcmVzdWx0X29mOwoKCgoKCiAgc3RydWN0IF9faW52b2tlX21l
bWZ1bl9yZWYgeyB9OwogIHN0cnVjdCBfX2ludm9rZV9tZW1mdW5fZGVyZWYgeyB9OwogIHN0cnVj
dCBfX2ludm9rZV9tZW1vYmpfcmVmIHsgfTsKICBzdHJ1Y3QgX19pbnZva2VfbWVtb2JqX2RlcmVm
IHsgfTsKICBzdHJ1Y3QgX19pbnZva2Vfb3RoZXIgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwLCB0eXBlbmFtZSBfVGFnPgogICAgc3RydWN0IF9fcmVzdWx0X29mX3N1Y2Nlc3MgOiBfX3N1
Y2Nlc3NfdHlwZTxfVHA+CiAgICB7IHVzaW5nIF9faW52b2tlX3R5cGUgPSBfVGFnOyB9OwoKCiAg
c3RydWN0IF9fcmVzdWx0X29mX21lbWZ1bl9yZWZfaW1wbAogIHsKICAgIHRlbXBsYXRlPHR5cGVu
YW1lIF9GcCwgdHlwZW5hbWUgX1RwMSwgdHlwZW5hbWUuLi4gX0FyZ3M+CiAgICAgIHN0YXRpYyBf
X3Jlc3VsdF9vZl9zdWNjZXNzPGRlY2x0eXBlKAogICAgICAoc3RkOjpkZWNsdmFsPF9UcDE+KCku
KnN0ZDo6ZGVjbHZhbDxfRnA+KCkpKHN0ZDo6ZGVjbHZhbDxfQXJncz4oKS4uLikKICAgICAgKSwg
X19pbnZva2VfbWVtZnVuX3JlZj4gX1NfdGVzdChpbnQpOwoKICAgIHRlbXBsYXRlPHR5cGVuYW1l
Li4uPgogICAgICBzdGF0aWMgX19mYWlsdXJlX3R5cGUgX1NfdGVzdCguLi4pOwogIH07CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9NZW1QdHIsIHR5cGVuYW1lIF9BcmcsIHR5cGVuYW1lLi4uIF9Bcmdz
PgogICAgc3RydWN0IF9fcmVzdWx0X29mX21lbWZ1bl9yZWYKICAgIDogcHJpdmF0ZSBfX3Jlc3Vs
dF9vZl9tZW1mdW5fcmVmX2ltcGwKICAgIHsKICAgICAgdHlwZWRlZiBkZWNsdHlwZShfU190ZXN0
PF9NZW1QdHIsIF9BcmcsIF9BcmdzLi4uPigwKSkgdHlwZTsKICAgIH07CgoKICBzdHJ1Y3QgX19y
ZXN1bHRfb2ZfbWVtZnVuX2RlcmVmX2ltcGwKICB7CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnAs
IHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lLi4uIF9BcmdzPgogICAgICBzdGF0aWMgX19yZXN1bHRf
b2Zfc3VjY2VzczxkZWNsdHlwZSgKICAgICAgKCgqc3RkOjpkZWNsdmFsPF9UcDE+KCkpLipzdGQ6
OmRlY2x2YWw8X0ZwPigpKShzdGQ6OmRlY2x2YWw8X0FyZ3M+KCkuLi4pCiAgICAgICksIF9faW52
b2tlX21lbWZ1bl9kZXJlZj4gX1NfdGVzdChpbnQpOwoKICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4u
PgogICAgICBzdGF0aWMgX19mYWlsdXJlX3R5cGUgX1NfdGVzdCguLi4pOwogIH07CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9NZW1QdHIsIHR5cGVuYW1lIF9BcmcsIHR5cGVuYW1lLi4uIF9BcmdzPgog
ICAgc3RydWN0IF9fcmVzdWx0X29mX21lbWZ1bl9kZXJlZgogICAgOiBwcml2YXRlIF9fcmVzdWx0
X29mX21lbWZ1bl9kZXJlZl9pbXBsCiAgICB7CiAgICAgIHR5cGVkZWYgZGVjbHR5cGUoX1NfdGVz
dDxfTWVtUHRyLCBfQXJnLCBfQXJncy4uLj4oMCkpIHR5cGU7CiAgICB9OwoKCiAgc3RydWN0IF9f
cmVzdWx0X29mX21lbW9ial9yZWZfaW1wbAogIHsKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9GcCwg
dHlwZW5hbWUgX1RwMT4KICAgICAgc3RhdGljIF9fcmVzdWx0X29mX3N1Y2Nlc3M8ZGVjbHR5cGUo
CiAgICAgIHN0ZDo6ZGVjbHZhbDxfVHAxPigpLipzdGQ6OmRlY2x2YWw8X0ZwPigpCiAgICAgICks
IF9faW52b2tlX21lbW9ial9yZWY+IF9TX3Rlc3QoaW50KTsKCiAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSwgdHlwZW5hbWU+CiAgICAgIHN0YXRpYyBfX2ZhaWx1cmVfdHlwZSBfU190ZXN0KC4uLik7CiAg
fTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX01lbVB0ciwgdHlwZW5hbWUgX0FyZz4KICAgIHN0cnVj
dCBfX3Jlc3VsdF9vZl9tZW1vYmpfcmVmCiAgICA6IHByaXZhdGUgX19yZXN1bHRfb2ZfbWVtb2Jq
X3JlZl9pbXBsCiAgICB7CiAgICAgIHR5cGVkZWYgZGVjbHR5cGUoX1NfdGVzdDxfTWVtUHRyLCBf
QXJnPigwKSkgdHlwZTsKICAgIH07CgoKICBzdHJ1Y3QgX19yZXN1bHRfb2ZfbWVtb2JqX2RlcmVm
X2ltcGwKICB7CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnAsIHR5cGVuYW1lIF9UcDE+CiAgICAg
IHN0YXRpYyBfX3Jlc3VsdF9vZl9zdWNjZXNzPGRlY2x0eXBlKAogICAgICAoKnN0ZDo6ZGVjbHZh
bDxfVHAxPigpKS4qc3RkOjpkZWNsdmFsPF9GcD4oKQogICAgICApLCBfX2ludm9rZV9tZW1vYmpf
ZGVyZWY+IF9TX3Rlc3QoaW50KTsKCiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSwgdHlwZW5hbWU+CiAg
ICAgIHN0YXRpYyBfX2ZhaWx1cmVfdHlwZSBfU190ZXN0KC4uLik7CiAgfTsKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX01lbVB0ciwgdHlwZW5hbWUgX0FyZz4KICAgIHN0cnVjdCBfX3Jlc3VsdF9vZl9t
ZW1vYmpfZGVyZWYKICAgIDogcHJpdmF0ZSBfX3Jlc3VsdF9vZl9tZW1vYmpfZGVyZWZfaW1wbAog
ICAgewogICAgICB0eXBlZGVmIGRlY2x0eXBlKF9TX3Rlc3Q8X01lbVB0ciwgX0FyZz4oMCkpIHR5
cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfTWVtUHRyLCB0eXBlbmFtZSBfQXJnPgog
ICAgc3RydWN0IF9fcmVzdWx0X29mX21lbW9iajsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Jlcywg
dHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZSBfQXJnPgogICAgc3RydWN0IF9fcmVzdWx0X29mX21l
bW9iajxfUmVzIF9DbGFzczo6KiwgX0FyZz4KICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBy
ZW1vdmVfY3Y8dHlwZW5hbWUgcmVtb3ZlX3JlZmVyZW5jZTwKICAgICAgICBfQXJnPjo6dHlwZT46
OnR5cGUgX0FyZ3ZhbDsKICAgICAgdHlwZWRlZiBfUmVzIF9DbGFzczo6KiBfTWVtUHRyOwogICAg
ICB0eXBlZGVmIHR5cGVuYW1lIGNvbmRpdGlvbmFsPF9fb3JfPGlzX3NhbWU8X0FyZ3ZhbCwgX0Ns
YXNzPiwKICAgICAgICBpc19iYXNlX29mPF9DbGFzcywgX0FyZ3ZhbD4+Ojp2YWx1ZSwKICAgICAg
ICBfX3Jlc3VsdF9vZl9tZW1vYmpfcmVmPF9NZW1QdHIsIF9Bcmc+LAogICAgICAgIF9fcmVzdWx0
X29mX21lbW9ial9kZXJlZjxfTWVtUHRyLCBfQXJnPgogICAgICA+Ojp0eXBlOjp0eXBlIHR5cGU7
CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfTWVtUHRyLCB0eXBlbmFtZSBfQXJnLCB0eXBl
bmFtZS4uLiBfQXJncz4KICAgIHN0cnVjdCBfX3Jlc3VsdF9vZl9tZW1mdW47CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlwZW5hbWUgX0FyZywgdHlwZW5hbWUu
Li4gX0FyZ3M+CiAgICBzdHJ1Y3QgX19yZXN1bHRfb2ZfbWVtZnVuPF9SZXMgX0NsYXNzOjoqLCBf
QXJnLCBfQXJncy4uLj4KICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSByZW1vdmVfY3Y8dHlw
ZW5hbWUgcmVtb3ZlX3JlZmVyZW5jZTwKICAgICAgICBfQXJnPjo6dHlwZT46OnR5cGUgX0FyZ3Zh
bDsKICAgICAgdHlwZWRlZiBfUmVzIF9DbGFzczo6KiBfTWVtUHRyOwogICAgICB0eXBlZGVmIHR5
cGVuYW1lIGNvbmRpdGlvbmFsPF9fb3JfPGlzX3NhbWU8X0FyZ3ZhbCwgX0NsYXNzPiwKICAgICAg
ICBpc19iYXNlX29mPF9DbGFzcywgX0FyZ3ZhbD4+Ojp2YWx1ZSwKICAgICAgICBfX3Jlc3VsdF9v
Zl9tZW1mdW5fcmVmPF9NZW1QdHIsIF9BcmcsIF9BcmdzLi4uPiwKICAgICAgICBfX3Jlc3VsdF9v
Zl9tZW1mdW5fZGVyZWY8X01lbVB0ciwgX0FyZywgX0FyZ3MuLi4+CiAgICAgID46OnR5cGU6OnR5
cGUgdHlwZTsKICAgIH07CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBf
Q2xhc3MsIHR5cGVuYW1lIF9Bcmc+CiAgICBzdHJ1Y3QgX19yZXN1bHRfb2ZfbWVtb2JqPF9SZXMg
X0NsYXNzOjoqLCByZWZlcmVuY2Vfd3JhcHBlcjxfQXJnPj4KICAgIDogX19yZXN1bHRfb2ZfbWVt
b2JqX3JlZjxfUmVzIF9DbGFzczo6KiwgX0FyZyY+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9SZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlwZW5hbWUgX0FyZz4KICAgIHN0cnVjdCBfX3Jl
c3VsdF9vZl9tZW1vYmo8X1JlcyBfQ2xhc3M6OiosIHJlZmVyZW5jZV93cmFwcGVyPF9Bcmc+Jj4K
ICAgIDogX19yZXN1bHRfb2ZfbWVtb2JqX3JlZjxfUmVzIF9DbGFzczo6KiwgX0FyZyY+CiAgICB7
IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlwZW5hbWUg
X0FyZz4KICAgIHN0cnVjdCBfX3Jlc3VsdF9vZl9tZW1vYmo8X1JlcyBfQ2xhc3M6OiosIGNvbnN0
IHJlZmVyZW5jZV93cmFwcGVyPF9Bcmc+Jj4KICAgIDogX19yZXN1bHRfb2ZfbWVtb2JqX3JlZjxf
UmVzIF9DbGFzczo6KiwgX0FyZyY+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMs
IHR5cGVuYW1lIF9DbGFzcywgdHlwZW5hbWUgX0FyZz4KICAgIHN0cnVjdCBfX3Jlc3VsdF9vZl9t
ZW1vYmo8X1JlcyBfQ2xhc3M6OiosIHJlZmVyZW5jZV93cmFwcGVyPF9Bcmc+JiY+CiAgICA6IF9f
cmVzdWx0X29mX21lbW9ial9yZWY8X1JlcyBfQ2xhc3M6OiosIF9BcmcmPgogICAgeyB9OwoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfQ2xhc3MsIHR5cGVuYW1lIF9Bcmc+CiAg
ICBzdHJ1Y3QgX19yZXN1bHRfb2ZfbWVtb2JqPF9SZXMgX0NsYXNzOjoqLCBjb25zdCByZWZlcmVu
Y2Vfd3JhcHBlcjxfQXJnPiYmPgogICAgOiBfX3Jlc3VsdF9vZl9tZW1vYmpfcmVmPF9SZXMgX0Ns
YXNzOjoqLCBfQXJnJj4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5h
bWUgX0NsYXNzLCB0eXBlbmFtZSBfQXJnLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgIHN0cnVjdCBf
X3Jlc3VsdF9vZl9tZW1mdW48X1JlcyBfQ2xhc3M6OiosIHJlZmVyZW5jZV93cmFwcGVyPF9Bcmc+
LCBfQXJncy4uLj4KICAgIDogX19yZXN1bHRfb2ZfbWVtZnVuX3JlZjxfUmVzIF9DbGFzczo6Kiwg
X0FyZyYsIF9BcmdzLi4uPgogICAgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBl
bmFtZSBfQ2xhc3MsIHR5cGVuYW1lIF9BcmcsIHR5cGVuYW1lLi4uIF9BcmdzPgogICAgc3RydWN0
IF9fcmVzdWx0X29mX21lbWZ1bjxfUmVzIF9DbGFzczo6KiwgcmVmZXJlbmNlX3dyYXBwZXI8X0Fy
Zz4mLAogICAgICAgICBfQXJncy4uLj4KICAgIDogX19yZXN1bHRfb2ZfbWVtZnVuX3JlZjxfUmVz
IF9DbGFzczo6KiwgX0FyZyYsIF9BcmdzLi4uPgogICAgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfUmVzLCB0eXBlbmFtZSBfQ2xhc3MsIHR5cGVuYW1lIF9BcmcsIHR5cGVuYW1lLi4uIF9Bcmdz
PgogICAgc3RydWN0IF9fcmVzdWx0X29mX21lbWZ1bjxfUmVzIF9DbGFzczo6KiwgY29uc3QgcmVm
ZXJlbmNlX3dyYXBwZXI8X0FyZz4mLAogICAgICAgICBfQXJncy4uLj4KICAgIDogX19yZXN1bHRf
b2ZfbWVtZnVuX3JlZjxfUmVzIF9DbGFzczo6KiwgX0FyZyYsIF9BcmdzLi4uPgogICAgeyB9OwoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfQ2xhc3MsIHR5cGVuYW1lIF9Bcmcs
IHR5cGVuYW1lLi4uIF9BcmdzPgogICAgc3RydWN0IF9fcmVzdWx0X29mX21lbWZ1bjxfUmVzIF9D
bGFzczo6KiwgcmVmZXJlbmNlX3dyYXBwZXI8X0FyZz4mJiwKICAgICAgICAgX0FyZ3MuLi4+CiAg
ICA6IF9fcmVzdWx0X29mX21lbWZ1bl9yZWY8X1JlcyBfQ2xhc3M6OiosIF9BcmcmLCBfQXJncy4u
Lj4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0
eXBlbmFtZSBfQXJnLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgIHN0cnVjdCBfX3Jlc3VsdF9vZl9t
ZW1mdW48X1JlcyBfQ2xhc3M6OiosIGNvbnN0IHJlZmVyZW5jZV93cmFwcGVyPF9Bcmc+JiYsCiAg
ICAgICAgIF9BcmdzLi4uPgogICAgOiBfX3Jlc3VsdF9vZl9tZW1mdW5fcmVmPF9SZXMgX0NsYXNz
OjoqLCBfQXJnJiwgX0FyZ3MuLi4+CiAgICB7IH07CgogIHRlbXBsYXRlPGJvb2wsIGJvb2wsIHR5
cGVuYW1lIF9GdW5jdG9yLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+CiAgICBzdHJ1Y3QgX19yZXN1
bHRfb2ZfaW1wbAogICAgewogICAgICB0eXBlZGVmIF9fZmFpbHVyZV90eXBlIHR5cGU7CiAgICB9
OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfTWVtUHRyLCB0eXBlbmFtZSBfQXJnPgogICAgc3RydWN0
IF9fcmVzdWx0X29mX2ltcGw8dHJ1ZSwgZmFsc2UsIF9NZW1QdHIsIF9Bcmc+CiAgICA6IHB1Ymxp
YyBfX3Jlc3VsdF9vZl9tZW1vYmo8dHlwZW5hbWUgZGVjYXk8X01lbVB0cj46OnR5cGUsIF9Bcmc+
CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9NZW1QdHIsIHR5cGVuYW1lIF9BcmcsIHR5
cGVuYW1lLi4uIF9BcmdzPgogICAgc3RydWN0IF9fcmVzdWx0X29mX2ltcGw8ZmFsc2UsIHRydWUs
IF9NZW1QdHIsIF9BcmcsIF9BcmdzLi4uPgogICAgOiBwdWJsaWMgX19yZXN1bHRfb2ZfbWVtZnVu
PHR5cGVuYW1lIGRlY2F5PF9NZW1QdHI+Ojp0eXBlLCBfQXJnLCBfQXJncy4uLj4KICAgIHsgfTsK
CgogIHN0cnVjdCBfX3Jlc3VsdF9vZl9vdGhlcl9pbXBsCiAgewogICAgdGVtcGxhdGU8dHlwZW5h
bWUgX0ZuLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgICAgc3RhdGljIF9fcmVzdWx0X29mX3N1Y2Nl
c3M8ZGVjbHR5cGUoCiAgICAgIHN0ZDo6ZGVjbHZhbDxfRm4+KCkoc3RkOjpkZWNsdmFsPF9Bcmdz
PigpLi4uKQogICAgICApLCBfX2ludm9rZV9vdGhlcj4gX1NfdGVzdChpbnQpOwoKICAgIHRlbXBs
YXRlPHR5cGVuYW1lLi4uPgogICAgICBzdGF0aWMgX19mYWlsdXJlX3R5cGUgX1NfdGVzdCguLi4p
OwogIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GdW5jdG9yLCB0eXBlbmFtZS4uLiBfQXJnVHlw
ZXM+CiAgICBzdHJ1Y3QgX19yZXN1bHRfb2ZfaW1wbDxmYWxzZSwgZmFsc2UsIF9GdW5jdG9yLCBf
QXJnVHlwZXMuLi4+CiAgICA6IHByaXZhdGUgX19yZXN1bHRfb2Zfb3RoZXJfaW1wbAogICAgewog
ICAgICB0eXBlZGVmIGRlY2x0eXBlKF9TX3Rlc3Q8X0Z1bmN0b3IsIF9BcmdUeXBlcy4uLj4oMCkp
IHR5cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnVuY3RvciwgdHlwZW5hbWUuLi4g
X0FyZ1R5cGVzPgogICAgc3RydWN0IHJlc3VsdF9vZjxfRnVuY3RvcihfQXJnVHlwZXMuLi4pPgog
ICAgOiBwdWJsaWMgX19yZXN1bHRfb2ZfaW1wbDwKICAgICAgICBpc19tZW1iZXJfb2JqZWN0X3Bv
aW50ZXI8CiAgICAgICAgICB0eXBlbmFtZSByZW1vdmVfcmVmZXJlbmNlPF9GdW5jdG9yPjo6dHlw
ZQogICAgICAgID46OnZhbHVlLAogICAgICAgIGlzX21lbWJlcl9mdW5jdGlvbl9wb2ludGVyPAog
ICAgICAgICAgdHlwZW5hbWUgcmVtb3ZlX3JlZmVyZW5jZTxfRnVuY3Rvcj46OnR5cGUKICAgICAg
ICA+Ojp2YWx1ZSwKICAgICBfRnVuY3RvciwgX0FyZ1R5cGVzLi4uCiAgICAgID46OnR5cGUKICAg
IHsgfTsKIyAyNTMxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3R5cGVfdHJhaXRzIiAzCiAgdGVt
cGxhdGU8dHlwZW5hbWUuLi4+IHVzaW5nIF9fdm9pZF90ID0gdm9pZDsKIyAyNTQwICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL3R5cGVfdHJhaXRzIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0RlZmF1
bHQsIHR5cGVuYW1lIF9BbHdheXNWb2lkLAogICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4+IGNsYXNz
IF9PcCwgdHlwZW5hbWUuLi4gX0FyZ3M+CiAgICBzdHJ1Y3QgX19kZXRlY3RvcgogICAgewogICAg
ICB1c2luZyB2YWx1ZV90ID0gZmFsc2VfdHlwZTsKICAgICAgdXNpbmcgdHlwZSA9IF9EZWZhdWx0
OwogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9EZWZhdWx0LCB0ZW1wbGF0ZTx0eXBlbmFt
ZS4uLj4gY2xhc3MgX09wLAogICAgIHR5cGVuYW1lLi4uIF9BcmdzPgogICAgc3RydWN0IF9fZGV0
ZWN0b3I8X0RlZmF1bHQsIF9fdm9pZF90PF9PcDxfQXJncy4uLj4+LCBfT3AsIF9BcmdzLi4uPgog
ICAgewogICAgICB1c2luZyB2YWx1ZV90ID0gdHJ1ZV90eXBlOwogICAgICB1c2luZyB0eXBlID0g
X09wPF9BcmdzLi4uPjsKICAgIH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRGVmYXVsdCwgdGVt
cGxhdGU8dHlwZW5hbWUuLi4+IGNsYXNzIF9PcCwKICAgIHR5cGVuYW1lLi4uIF9BcmdzPgogICAg
dXNpbmcgX19kZXRlY3RlZF9vciA9IF9fZGV0ZWN0b3I8X0RlZmF1bHQsIHZvaWQsIF9PcCwgX0Fy
Z3MuLi4+OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0RlZmF1bHQsIHRlbXBsYXRlPHR5cGVuYW1l
Li4uPiBjbGFzcyBfT3AsCiAgICB0eXBlbmFtZS4uLiBfQXJncz4KICAgIHVzaW5nIF9fZGV0ZWN0
ZWRfb3JfdAogICAgICA9IHR5cGVuYW1lIF9fZGV0ZWN0ZWRfb3I8X0RlZmF1bHQsIF9PcCwgX0Fy
Z3MuLi4+Ojp0eXBlOwoKCiAgdGVtcGxhdGU8dGVtcGxhdGU8dHlwZW5hbWUuLi4+IGNsYXNzIF9E
ZWZhdWx0LAogICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4+IGNsYXNzIF9PcCwgdHlwZW5hbWUuLi4g
X0FyZ3M+CiAgICB1c2luZyBfX2RldGVjdGVkX29yX3RfID0KICAgICAgX19kZXRlY3RlZF9vcl90
PF9EZWZhdWx0PF9BcmdzLi4uPiwgX09wLCBfQXJncy4uLj47CiMgMjU5MCAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC90eXBlX3RyYWl0cyIgMwogIHRlbXBsYXRlIDx0eXBlbmFtZSBfVHA+CiAgICBz
dHJ1Y3QgX19pc19zd2FwcGFibGU7CgogIHRlbXBsYXRlIDx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1
Y3QgX19pc19ub3Rocm93X3N3YXBwYWJsZTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAg
aW5saW5lCiAgICB0eXBlbmFtZSBlbmFibGVfaWY8X19hbmRfPGlzX21vdmVfY29uc3RydWN0aWJs
ZTxfVHA+LAogICAgICAgICBpc19tb3ZlX2Fzc2lnbmFibGU8X1RwPj46OnZhbHVlPjo6dHlwZQog
ICAgc3dhcChfVHAmLCBfVHAmKQogICAgbm9leGNlcHQoX19hbmRfPGlzX25vdGhyb3dfbW92ZV9j
b25zdHJ1Y3RpYmxlPF9UcD4sCiAgICAgICAgICAgICBpc19ub3Rocm93X21vdmVfYXNzaWduYWJs
ZTxfVHA+Pjo6dmFsdWUpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHNpemVfdCBfTm0+CiAg
ICBpbmxpbmUKICAgIHR5cGVuYW1lIGVuYWJsZV9pZjxfX2lzX3N3YXBwYWJsZTxfVHA+Ojp2YWx1
ZT46OnR5cGUKICAgIHN3YXAoX1RwICgmX19hKVtfTm1dLCBfVHAgKCZfX2IpW19ObV0pCiAgICBu
b2V4Y2VwdChfX2lzX25vdGhyb3dfc3dhcHBhYmxlPF9UcD46OnZhbHVlKTsKCiAgbmFtZXNwYWNl
IF9fc3dhcHBhYmxlX2RldGFpbHMgewogICAgdXNpbmcgc3RkOjpzd2FwOwoKICAgIHN0cnVjdCBf
X2RvX2lzX3N3YXBwYWJsZV9pbXBsCiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwg
dHlwZW5hbWUKICAgICAgICAgICAgICAgPSBkZWNsdHlwZShzd2FwKHN0ZDo6ZGVjbHZhbDxfVHAm
PigpLCBzdGQ6OmRlY2x2YWw8X1RwJj4oKSkpPgogICAgICAgIHN0YXRpYyB0cnVlX3R5cGUgX190
ZXN0KGludCk7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZT4KICAgICAgICBzdGF0aWMgZmFsc2Vf
dHlwZSBfX3Rlc3QoLi4uKTsKICAgIH07CgogICAgc3RydWN0IF9fZG9faXNfbm90aHJvd19zd2Fw
cGFibGVfaW1wbAogICAgewogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICAgICAgc3Rh
dGljIF9fYm9vbF9jb25zdGFudDwKICAgICAgICAgIG5vZXhjZXB0KHN3YXAoc3RkOjpkZWNsdmFs
PF9UcCY+KCksIHN0ZDo6ZGVjbHZhbDxfVHAmPigpKSkKICAgICAgICA+IF9fdGVzdChpbnQpOwoK
ICAgICAgdGVtcGxhdGU8dHlwZW5hbWU+CiAgICAgICAgc3RhdGljIGZhbHNlX3R5cGUgX190ZXN0
KC4uLik7CiAgICB9OwoKICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBf
X2lzX3N3YXBwYWJsZV9pbXBsCiAgICA6IHB1YmxpYyBfX3N3YXBwYWJsZV9kZXRhaWxzOjpfX2Rv
X2lzX3N3YXBwYWJsZV9pbXBsCiAgICB7CiAgICAgIHR5cGVkZWYgZGVjbHR5cGUoX190ZXN0PF9U
cD4oMCkpIHR5cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3Qg
X19pc19ub3Rocm93X3N3YXBwYWJsZV9pbXBsCiAgICA6IHB1YmxpYyBfX3N3YXBwYWJsZV9kZXRh
aWxzOjpfX2RvX2lzX25vdGhyb3dfc3dhcHBhYmxlX2ltcGwKICAgIHsKICAgICAgdHlwZWRlZiBk
ZWNsdHlwZShfX3Rlc3Q8X1RwPigwKSkgdHlwZTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcD4KICAgIHN0cnVjdCBfX2lzX3N3YXBwYWJsZQogICAgOiBwdWJsaWMgX19pc19zd2FwcGFi
bGVfaW1wbDxfVHA+Ojp0eXBlCiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
IHN0cnVjdCBfX2lzX25vdGhyb3dfc3dhcHBhYmxlCiAgICA6IHB1YmxpYyBfX2lzX25vdGhyb3df
c3dhcHBhYmxlX2ltcGw8X1RwPjo6dHlwZQogICAgeyB9OwoKCn0KIyA1OCAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9iaXRzL21vdmUuaCIgMiAzCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18g
KChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCiMgNzQgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9tb3ZlLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBjb25zdGV4
cHIgX1RwJiYKICAgIGZvcndhcmQodHlwZW5hbWUgc3RkOjpyZW1vdmVfcmVmZXJlbmNlPF9UcD46
OnR5cGUmIF9fdCkgbm9leGNlcHQKICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PF9UcCYmPihfX3Qp
OyB9CgoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGNvbnN0ZXhwciBfVHAmJgog
ICAgZm9yd2FyZCh0eXBlbmFtZSBzdGQ6OnJlbW92ZV9yZWZlcmVuY2U8X1RwPjo6dHlwZSYmIF9f
dCkgbm9leGNlcHQKICAgIHsKICAgICAgc3RhdGljX2Fzc2VydCghc3RkOjppc19sdmFsdWVfcmVm
ZXJlbmNlPF9UcD46OnZhbHVlLCAidGVtcGxhdGUgYXJndW1lbnQiCiAgICAgICIgc3Vic3RpdHV0
aW5nIF9UcCBpcyBhbiBsdmFsdWUgcmVmZXJlbmNlIHR5cGUiKTsKICAgICAgcmV0dXJuIHN0YXRp
Y19jYXN0PF9UcCYmPihfX3QpOwogICAgfQoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4K
ICAgIGNvbnN0ZXhwciB0eXBlbmFtZSBzdGQ6OnJlbW92ZV9yZWZlcmVuY2U8X1RwPjo6dHlwZSYm
CiAgICBtb3ZlKF9UcCYmIF9fdCkgbm9leGNlcHQKICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PHR5
cGVuYW1lIHN0ZDo6cmVtb3ZlX3JlZmVyZW5jZTxfVHA+Ojp0eXBlJiY+KF9fdCk7IH0KCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX21vdmVfaWZfbm9leGNlcHRfY29uZAog
ICAgOiBwdWJsaWMgX19hbmRfPF9fbm90Xzxpc19ub3Rocm93X21vdmVfY29uc3RydWN0aWJsZTxf
VHA+PiwKICAgICAgICAgICAgICAgICAgICBpc19jb3B5X2NvbnN0cnVjdGlibGU8X1RwPj46OnR5
cGUgeyB9OwojIDExOCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL21vdmUuaCIgMwogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGNvbnN0ZXhwciB0eXBlbmFtZQogICAgY29uZGl0aW9u
YWw8X19tb3ZlX2lmX25vZXhjZXB0X2NvbmQ8X1RwPjo6dmFsdWUsIGNvbnN0IF9UcCYsIF9UcCYm
Pjo6dHlwZQogICAgbW92ZV9pZl9ub2V4Y2VwdChfVHAmIF9feCkgbm9leGNlcHQKICAgIHsgcmV0
dXJuIHN0ZDo6bW92ZShfX3gpOyB9CiMgMTMzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
bW92ZS5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgaW5saW5lIF9UcCoKICAgIGFk
ZHJlc3NvZihfVHAmIF9fcikgbm9leGNlcHQKICAgIHsgcmV0dXJuIHN0ZDo6X19hZGRyZXNzb2Yo
X19yKTsgfQoKCiAgdGVtcGxhdGUgPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1VwID0gX1RwPgog
ICAgaW5saW5lIF9UcAogICAgX19leGNoYW5nZShfVHAmIF9fb2JqLCBfVXAmJiBfX25ld192YWwp
CiAgICB7CiAgICAgIF9UcCBfX29sZF92YWwgPSBzdGQ6Om1vdmUoX19vYmopOwogICAgICBfX29i
aiA9IHN0ZDo6Zm9yd2FyZDxfVXA+KF9fbmV3X3ZhbCk7CiAgICAgIHJldHVybiBfX29sZF92YWw7
CiAgICB9CgoKCn0KIyAxNTkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9tb3ZlLmgiIDMK
bmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0Iikp
KQp7CgojIDE3NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL21vdmUuaCIgMwogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGluZQoKICAgIHR5cGVuYW1lIGVuYWJsZV9pZjxfX2Fu
ZF88aXNfbW92ZV9jb25zdHJ1Y3RpYmxlPF9UcD4sCiAgICAgICAgIGlzX21vdmVfYXNzaWduYWJs
ZTxfVHA+Pjo6dmFsdWU+Ojp0eXBlCiAgICBzd2FwKF9UcCYgX19hLCBfVHAmIF9fYikKICAgIG5v
ZXhjZXB0KF9fYW5kXzxpc19ub3Rocm93X21vdmVfY29uc3RydWN0aWJsZTxfVHA+LAogICAgICAg
ICAgICAgaXNfbm90aHJvd19tb3ZlX2Fzc2lnbmFibGU8X1RwPj46OnZhbHVlKQoKCgoKICAgIHsK
CiAgICAgCgogICAgICBfVHAgX190bXAgPSBzdGQ6Om1vdmUoX19hKTsKICAgICAgX19hID0gc3Rk
Ojptb3ZlKF9fYik7CiAgICAgIF9fYiA9IHN0ZDo6bW92ZShfX3RtcCk7CiAgICB9CgoKCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcCwgc2l6ZV90IF9ObT4KICAgIGlubGluZQoKICAgIHR5cGVuYW1l
IGVuYWJsZV9pZjxfX2lzX3N3YXBwYWJsZTxfVHA+Ojp2YWx1ZT46OnR5cGUKICAgIHN3YXAoX1Rw
ICgmX19hKVtfTm1dLCBfVHAgKCZfX2IpW19ObV0pCiAgICBub2V4Y2VwdChfX2lzX25vdGhyb3df
c3dhcHBhYmxlPF9UcD46OnZhbHVlKQoKCgoKICAgIHsKICAgICAgZm9yIChzaXplX3QgX19uID0g
MDsgX19uIDwgX05tOyArK19fbikKIHN3YXAoX19hW19fbl0sIF9fYltfX25dKTsKICAgIH0KCgoK
fQojIDYwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3BhaXIuaCIgMiAzCgoKCgoK
bmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0Iikp
KQp7CgojIDc2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3BhaXIuaCIgMwogIHN0
cnVjdCBwaWVjZXdpc2VfY29uc3RydWN0X3QgeyBleHBsaWNpdCBwaWVjZXdpc2VfY29uc3RydWN0
X3QoKSA9IGRlZmF1bHQ7IH07CgoKICBjb25zdGV4cHIgcGllY2V3aXNlX2NvbnN0cnVjdF90IHBp
ZWNld2lzZV9jb25zdHJ1Y3QgPSBwaWVjZXdpc2VfY29uc3RydWN0X3QoKTsKCgogIHRlbXBsYXRl
PHR5cGVuYW1lLi4uPgogICAgY2xhc3MgdHVwbGU7CgogIHRlbXBsYXRlPHN0ZDo6c2l6ZV90Li4u
PgogICAgc3RydWN0IF9JbmRleF90dXBsZTsKCgoKICB0ZW1wbGF0ZSA8dHlwZW5hbWUgX1QxLCB0
eXBlbmFtZSBfVDIsIHR5cGVuYW1lIF9VMSwgdHlwZW5hbWUgX1UyPgogIGNvbnN0ZXhwciBib29s
IF9Db25zdHJ1Y3RpYmxlUGFpcigpCiAgewogICAgcmV0dXJuIF9fYW5kXzxpc19jb25zdHJ1Y3Rp
YmxlPF9UMSwgY29uc3QgX1UxJj4sCiAgICBpc19jb25zdHJ1Y3RpYmxlPF9UMiwgY29uc3QgX1Uy
Jj4+Ojp2YWx1ZTsKICB9CgogIHRlbXBsYXRlIDx0eXBlbmFtZSBfVDEsIHR5cGVuYW1lIF9UMiwg
dHlwZW5hbWUgX1UxLCB0eXBlbmFtZSBfVTI+CiAgY29uc3RleHByIGJvb2wgX0ltcGxpY2l0bHlD
b252ZXJ0aWJsZVBhaXIoKQogIHsKICAgIHJldHVybiBfX2FuZF88aXNfY29udmVydGlibGU8Y29u
c3QgX1UxJiwgX1QxPiwKICAgIGlzX2NvbnZlcnRpYmxlPGNvbnN0IF9VMiYsIF9UMj4+Ojp2YWx1
ZTsKICB9CgogIHRlbXBsYXRlIDx0eXBlbmFtZSBfVDEsIHR5cGVuYW1lIF9UMiwgdHlwZW5hbWUg
X1UxLCB0eXBlbmFtZSBfVTI+CiAgY29uc3RleHByIGJvb2wgX01vdmVDb25zdHJ1Y3RpYmxlUGFp
cigpCiAgewogICAgcmV0dXJuIF9fYW5kXzxpc19jb25zdHJ1Y3RpYmxlPF9UMSwgX1UxJiY+LAog
ICAgaXNfY29uc3RydWN0aWJsZTxfVDIsIF9VMiYmPj46OnZhbHVlOwogIH0KCiAgdGVtcGxhdGUg
PHR5cGVuYW1lIF9UMSwgdHlwZW5hbWUgX1QyLCB0eXBlbmFtZSBfVTEsIHR5cGVuYW1lIF9VMj4K
ICBjb25zdGV4cHIgYm9vbCBfSW1wbGljaXRseU1vdmVDb252ZXJ0aWJsZVBhaXIoKQogIHsKICAg
IHJldHVybiBfX2FuZF88aXNfY29udmVydGlibGU8X1UxJiYsIF9UMT4sCiAgICBpc19jb252ZXJ0
aWJsZTxfVTImJiwgX1QyPj46OnZhbHVlOwogIH0KIyAxMjcgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9zdGxfcGFpci5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1QxLCB0eXBlbmFtZSBf
VDI+CiAgICBzdHJ1Y3QgcGFpcgogICAgewogICAgICB0eXBlZGVmIF9UMSBmaXJzdF90eXBlOwog
ICAgICB0eXBlZGVmIF9UMiBzZWNvbmRfdHlwZTsKCiAgICAgIF9UMSBmaXJzdDsKICAgICAgX1Qy
IHNlY29uZDsKCgoKCgoKICAgICAgdGVtcGxhdGUgPHR5cGVuYW1lIF9VMSA9IF9UMSwKICAgICAg
ICAgICAgICAgIHR5cGVuYW1lIF9VMiA9IF9UMiwKICAgICAgICAgICAgICAgIHR5cGVuYW1lIGVu
YWJsZV9pZjxfX2FuZF88CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2lz
X2ltcGxpY2l0bHlfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlPF9VMT4sCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBfX2lzX2ltcGxpY2l0bHlfZGVmYXVsdF9jb25zdHJ1Y3RpYmxl
PF9VMj4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOjp2YWx1ZSwgYm9vbD46
OnR5cGUgPSB0cnVlPgoKICAgICAgY29uc3RleHByIHBhaXIoKQogICAgICA6IGZpcnN0KCksIHNl
Y29uZCgpIHsgfQoKCiAgICAgIHRlbXBsYXRlIDx0eXBlbmFtZSBfVTEgPSBfVDEsCiAgICAgICAg
ICAgICAgICB0eXBlbmFtZSBfVTIgPSBfVDIsCiAgICAgICAgICAgICAgICB0eXBlbmFtZSBlbmFi
bGVfaWY8X19hbmRfPAogICAgICAgICAgICAgICAgICAgICAgIGlzX2RlZmF1bHRfY29uc3RydWN0
aWJsZTxfVTE+LAogICAgICAgICAgICAgICAgICAgICAgIGlzX2RlZmF1bHRfY29uc3RydWN0aWJs
ZTxfVTI+LAogICAgICAgICAgICAgICAgICAgICAgIF9fbm90XzwKICAgICAgICAgICAgICAgICAg
ICAgICAgIF9fYW5kXzxfX2lzX2ltcGxpY2l0bHlfZGVmYXVsdF9jb25zdHJ1Y3RpYmxlPF9VMT4s
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX19pc19pbXBsaWNpdGx5X2RlZmF1bHRf
Y29uc3RydWN0aWJsZTxfVTI+Pj4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Ojp2YWx1ZSwgYm9vbD46OnR5cGUgPSBmYWxzZT4KICAgICAgZXhwbGljaXQgY29uc3RleHByIHBh
aXIoKQogICAgICA6IGZpcnN0KCksIHNlY29uZCgpIHsgfQoKCgoKCgoKICAgICAgdGVtcGxhdGU8
dHlwZW5hbWUgX1UxID0gX1QxLCB0eXBlbmFtZSBfVTI9X1QyLCB0eXBlbmFtZQogICAgICAgICAg
ICAgICAgZW5hYmxlX2lmPF9Db25zdHJ1Y3RpYmxlUGFpcjxfVDEsIF9UMiwgX1UxLCBfVTI+KCkK
ICAgICAgICAgICAgICAgICAgICAgICAgICYmIF9JbXBsaWNpdGx5Q29udmVydGlibGVQYWlyPF9U
MSwgX1QyLCBfVTEsIF9VMj4oKSwKICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2w+Ojp0eXBl
PXRydWU+CiAgICAgIGNvbnN0ZXhwciBwYWlyKGNvbnN0IF9UMSYgX19hLCBjb25zdCBfVDImIF9f
YikKICAgICAgOiBmaXJzdChfX2EpLCBzZWNvbmQoX19iKSB7IH0KCiAgICAgICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVTEgPSBfVDEsIHR5cGVuYW1lIF9VMj1fVDIsIHR5cGVuYW1lCiAgICAgICAgZW5h
YmxlX2lmPF9Db25zdHJ1Y3RpYmxlUGFpcjxfVDEsIF9UMiwgX1UxLCBfVTI+KCkKICAgICAgICAg
ICAgICAgICAgICAgICAgICYmICFfSW1wbGljaXRseUNvbnZlcnRpYmxlUGFpcjxfVDEsIF9UMiwg
X1UxLCBfVTI+KCksCiAgICAgICAgICAgICAgICAgICAgICAgICBib29sPjo6dHlwZT1mYWxzZT4K
ICAgICAgZXhwbGljaXQgY29uc3RleHByIHBhaXIoY29uc3QgX1QxJiBfX2EsIGNvbnN0IF9UMiYg
X19iKQogICAgICA6IGZpcnN0KF9fYSksIHNlY29uZChfX2IpIHsgfQojIDE5MSAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9wYWlyLmgiIDMKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUg
X1UxLCB0eXBlbmFtZSBfVTIsIHR5cGVuYW1lCiAgICAgICAgZW5hYmxlX2lmPF9Db25zdHJ1Y3Rp
YmxlUGFpcjxfVDEsIF9UMiwgX1UxLCBfVTI+KCkKICAgICAgICAgICAgICAgICAgICAgICAgICYm
IF9JbXBsaWNpdGx5Q29udmVydGlibGVQYWlyPF9UMSwgX1QyLCBfVTEsIF9VMj4oKSwKICAgICAg
ICAgICAgICAgICAgICAgICAgIGJvb2w+Ojp0eXBlPXRydWU+CiAgICAgICAgY29uc3RleHByIHBh
aXIoY29uc3QgcGFpcjxfVTEsIF9VMj4mIF9fcCkKICAgICAgICA6IGZpcnN0KF9fcC5maXJzdCks
IHNlY29uZChfX3Auc2Vjb25kKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VMSwgdHlw
ZW5hbWUgX1UyLCB0eXBlbmFtZQogICAgICAgICAgICAgICBlbmFibGVfaWY8X0NvbnN0cnVjdGli
bGVQYWlyPF9UMSwgX1QyLCBfVTEsIF9VMj4oKQogICAgICAgICAgICAgICAgICAgICAgICAgJiYg
IV9JbXBsaWNpdGx5Q29udmVydGlibGVQYWlyPF9UMSwgX1QyLCBfVTEsIF9VMj4oKSwKICAgICAg
ICAgICAgICAgICAgICAgICAgIGJvb2w+Ojp0eXBlPWZhbHNlPgogZXhwbGljaXQgY29uc3RleHBy
IHBhaXIoY29uc3QgcGFpcjxfVTEsIF9VMj4mIF9fcCkKIDogZmlyc3QoX19wLmZpcnN0KSwgc2Vj
b25kKF9fcC5zZWNvbmQpIHsgfQoKICAgICAgY29uc3RleHByIHBhaXIoY29uc3QgcGFpciYpID0g
ZGVmYXVsdDsKICAgICAgY29uc3RleHByIHBhaXIocGFpciYmKSA9IGRlZmF1bHQ7CgoKICAgICAg
dGVtcGxhdGU8dHlwZW5hbWUgX1UxLCB0eXBlbmFtZQogICAgICAgICAgICAgICBlbmFibGVfaWY8
X0NvbnN0cnVjdGlibGVQYWlyPF9UMiwgX1QyLCBfVDIsIF9UMj4oKQogICAgICAgICAgICAgICAg
ICAgICAgICAgJiYgX01vdmVDb25zdHJ1Y3RpYmxlUGFpcjxfVDEsIF9UMiwgX1UxLCBfVDI+KCkK
ICAgICAgICAgICAgICAgICAgICAgICAgICYmIF9JbXBsaWNpdGx5Q29udmVydGlibGVQYWlyPF9U
MiwgX1QyLCBfVDIsIF9UMj4oKQogICAgICAgICAgICAgICAgICAgICAgICAgJiYgX0ltcGxpY2l0
bHlNb3ZlQ29udmVydGlibGVQYWlyPF9UMSwgX1QyLAogICAgICAgICBfVTEsIF9UMj4oKSwKICAg
ICAgICAgICAgICAgICAgICAgICAgIGJvb2w+Ojp0eXBlPXRydWU+CiAgICAgICBjb25zdGV4cHIg
cGFpcihfVTEmJiBfX3gsIGNvbnN0IF9UMiYgX195KQogICAgICAgOiBmaXJzdChzdGQ6OmZvcndh
cmQ8X1UxPihfX3gpKSwgc2Vjb25kKF9feSkgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VTEsIHR5cGVuYW1lCiAgICAgICAgICAgICAgIGVuYWJsZV9pZjxfQ29uc3RydWN0aWJsZVBhaXI8
X1QyLCBfVDIsIF9UMiwgX1QyPigpCiAgICAgICAgICAgICAgICAgICAgICAgICAmJiBfTW92ZUNv
bnN0cnVjdGlibGVQYWlyPF9UMSwgX1QyLCBfVTEsIF9UMj4oKQogICAgICAgICAgICAgICAgICAg
ICAgICAgJiYgKCFfSW1wbGljaXRseUNvbnZlcnRpYmxlUGFpcjxfVDIsIF9UMiwgX1QyLCBfVDI+
KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAhX0ltcGxpY2l0bHlNb3ZlQ29udmVy
dGlibGVQYWlyPF9UMSwgX1QyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgX1UxLCBfVDI+KCkpLAogICAgICAgICAgICAgICAg
ICAgICAgICAgYm9vbD46OnR5cGU9ZmFsc2U+CiAgICAgICBleHBsaWNpdCBjb25zdGV4cHIgcGFp
cihfVTEmJiBfX3gsIGNvbnN0IF9UMiYgX195KQogICAgICAgOiBmaXJzdChzdGQ6OmZvcndhcmQ8
X1UxPihfX3gpKSwgc2Vjb25kKF9feSkgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVTIs
IHR5cGVuYW1lCiAgICAgICAgICAgICAgIGVuYWJsZV9pZjxfQ29uc3RydWN0aWJsZVBhaXI8X1Qx
LCBfVDEsIF9UMSwgX1QxPigpCiAgICAgICAgICAgICAgICAgICAgICAgICAmJiBfTW92ZUNvbnN0
cnVjdGlibGVQYWlyPF9UMSwgX1QyLCBfVDEsIF9VMj4oKQogICAgICAgICAgICAgICAgICAgICAg
ICAgJiYgX0ltcGxpY2l0bHlDb252ZXJ0aWJsZVBhaXI8X1QxLCBfVDEsIF9UMSwgX1QxPigpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAmJiBfSW1wbGljaXRseU1vdmVDb252ZXJ0aWJsZVBhaXI8
X1QxLCBfVDIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgX1QxLCBfVTI+KCksCiAgICAgICAgICAgICAgICAgICAgICAgICBib29sPjo6
dHlwZT10cnVlPgogICAgICAgY29uc3RleHByIHBhaXIoY29uc3QgX1QxJiBfX3gsIF9VMiYmIF9f
eSkKICAgICAgIDogZmlyc3QoX194KSwgc2Vjb25kKHN0ZDo6Zm9yd2FyZDxfVTI+KF9feSkpIHsg
fQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1UyLCB0eXBlbmFtZQogICAgICAgICAgICAgICBl
bmFibGVfaWY8X0NvbnN0cnVjdGlibGVQYWlyPF9UMSwgX1QxLCBfVDEsIF9UMT4oKQogICAgICAg
ICAgICAgICAgICAgICAgICAgJiYgX01vdmVDb25zdHJ1Y3RpYmxlUGFpcjxfVDEsIF9UMiwgX1Qx
LCBfVTI+KCkKICAgICAgICAgICAgICAgICAgICAgICAgICYmICghX0ltcGxpY2l0bHlDb252ZXJ0
aWJsZVBhaXI8X1QxLCBfVDEsIF9UMSwgX1QxPigpCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgfHwgIV9JbXBsaWNpdGx5TW92ZUNvbnZlcnRpYmxlUGFpcjxfVDEsIF9UMiwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9U
MSwgX1UyPigpKSwKICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2w+Ojp0eXBlPWZhbHNlPgog
ICAgICAgZXhwbGljaXQgcGFpcihjb25zdCBfVDEmIF9feCwgX1UyJiYgX195KQogICAgICAgOiBm
aXJzdChfX3gpLCBzZWNvbmQoc3RkOjpmb3J3YXJkPF9VMj4oX195KSkgeyB9CgogICAgICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVTEsIHR5cGVuYW1lIF9VMiwgdHlwZW5hbWUKICAgICAgICBlbmFibGVf
aWY8X01vdmVDb25zdHJ1Y3RpYmxlUGFpcjxfVDEsIF9UMiwgX1UxLCBfVTI+KCkKICAgICAgICAg
ICAgICAgICAgICAgICAgICYmIF9JbXBsaWNpdGx5TW92ZUNvbnZlcnRpYmxlUGFpcjxfVDEsIF9U
MiwKICAgICAgICAgIF9VMSwgX1UyPigpLAogICAgICAgICAgICAgICAgICAgICAgICAgYm9vbD46
OnR5cGU9dHJ1ZT4KIGNvbnN0ZXhwciBwYWlyKF9VMSYmIF9feCwgX1UyJiYgX195KQogOiBmaXJz
dChzdGQ6OmZvcndhcmQ8X1UxPihfX3gpKSwgc2Vjb25kKHN0ZDo6Zm9yd2FyZDxfVTI+KF9feSkp
IHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1UxLCB0eXBlbmFtZSBfVTIsIHR5cGVuYW1l
CiAgICAgICAgZW5hYmxlX2lmPF9Nb3ZlQ29uc3RydWN0aWJsZVBhaXI8X1QxLCBfVDIsIF9VMSwg
X1UyPigpCiAgICAgICAgICAgICAgICAgICAgICAgICAmJiAhX0ltcGxpY2l0bHlNb3ZlQ29udmVy
dGlibGVQYWlyPF9UMSwgX1QyLAogICAgICAgICAgIF9VMSwgX1UyPigpLAogICAgICAgICAgICAg
ICAgICAgICAgICAgYm9vbD46OnR5cGU9ZmFsc2U+CiBleHBsaWNpdCBjb25zdGV4cHIgcGFpcihf
VTEmJiBfX3gsIF9VMiYmIF9feSkKIDogZmlyc3Qoc3RkOjpmb3J3YXJkPF9VMT4oX194KSksIHNl
Y29uZChzdGQ6OmZvcndhcmQ8X1UyPihfX3kpKSB7IH0KCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfVTEsIHR5cGVuYW1lIF9VMiwgdHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8X01vdmVDb25z
dHJ1Y3RpYmxlUGFpcjxfVDEsIF9UMiwgX1UxLCBfVTI+KCkKICAgICAgICAgICAgICAgICAgICAg
ICAgICYmIF9JbXBsaWNpdGx5TW92ZUNvbnZlcnRpYmxlUGFpcjxfVDEsIF9UMiwKICAgICAgICAg
IF9VMSwgX1UyPigpLAogICAgICAgICAgICAgICAgICAgICAgICAgYm9vbD46OnR5cGU9dHJ1ZT4K
IGNvbnN0ZXhwciBwYWlyKHBhaXI8X1UxLCBfVTI+JiYgX19wKQogOiBmaXJzdChzdGQ6OmZvcndh
cmQ8X1UxPihfX3AuZmlyc3QpKSwKICAgc2Vjb25kKHN0ZDo6Zm9yd2FyZDxfVTI+KF9fcC5zZWNv
bmQpKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VMSwgdHlwZW5hbWUgX1UyLCB0eXBl
bmFtZQogICAgICAgIGVuYWJsZV9pZjxfTW92ZUNvbnN0cnVjdGlibGVQYWlyPF9UMSwgX1QyLCBf
VTEsIF9VMj4oKQogICAgICAgICAgICAgICAgICAgICAgICAgJiYgIV9JbXBsaWNpdGx5TW92ZUNv
bnZlcnRpYmxlUGFpcjxfVDEsIF9UMiwKICAgICAgICAgIF9VMSwgX1UyPigpLAogICAgICAgICAg
ICAgICAgICAgICAgICAgYm9vbD46OnR5cGU9ZmFsc2U+CiBleHBsaWNpdCBjb25zdGV4cHIgcGFp
cihwYWlyPF9VMSwgX1UyPiYmIF9fcCkKIDogZmlyc3Qoc3RkOjpmb3J3YXJkPF9VMT4oX19wLmZp
cnN0KSksCiAgIHNlY29uZChzdGQ6OmZvcndhcmQ8X1UyPihfX3Auc2Vjb25kKSkgeyB9CgogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfQXJnczEsIHR5cGVuYW1lLi4uIF9BcmdzMj4KICAgICAg
ICBwYWlyKHBpZWNld2lzZV9jb25zdHJ1Y3RfdCwgdHVwbGU8X0FyZ3MxLi4uPiwgdHVwbGU8X0Fy
Z3MyLi4uPik7CgogICAgICBwYWlyJgogICAgICBvcGVyYXRvcj0oY29uc3QgcGFpciYgX19wKQog
ICAgICB7CiBmaXJzdCA9IF9fcC5maXJzdDsKIHNlY29uZCA9IF9fcC5zZWNvbmQ7CiByZXR1cm4g
KnRoaXM7CiAgICAgIH0KCiAgICAgIHBhaXImCiAgICAgIG9wZXJhdG9yPShwYWlyJiYgX19wKQog
ICAgICBub2V4Y2VwdChfX2FuZF88aXNfbm90aHJvd19tb3ZlX2Fzc2lnbmFibGU8X1QxPiwKICAg
ICAgICAgICAgICAgaXNfbm90aHJvd19tb3ZlX2Fzc2lnbmFibGU8X1QyPj46OnZhbHVlKQogICAg
ICB7CiBmaXJzdCA9IHN0ZDo6Zm9yd2FyZDxmaXJzdF90eXBlPihfX3AuZmlyc3QpOwogc2Vjb25k
ID0gc3RkOjpmb3J3YXJkPHNlY29uZF90eXBlPihfX3Auc2Vjb25kKTsKIHJldHVybiAqdGhpczsK
ICAgICAgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1UxLCB0eXBlbmFtZSBfVTI+CiBwYWly
Jgogb3BlcmF0b3I9KGNvbnN0IHBhaXI8X1UxLCBfVTI+JiBfX3ApCiB7CiAgIGZpcnN0ID0gX19w
LmZpcnN0OwogICBzZWNvbmQgPSBfX3Auc2Vjb25kOwogICByZXR1cm4gKnRoaXM7CiB9CgogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVTEsIHR5cGVuYW1lIF9VMj4KIHBhaXImCiBvcGVyYXRvcj0o
cGFpcjxfVTEsIF9VMj4mJiBfX3ApCiB7CiAgIGZpcnN0ID0gc3RkOjpmb3J3YXJkPF9VMT4oX19w
LmZpcnN0KTsKICAgc2Vjb25kID0gc3RkOjpmb3J3YXJkPF9VMj4oX19wLnNlY29uZCk7CiAgIHJl
dHVybiAqdGhpczsKIH0KCiAgICAgIHZvaWQKICAgICAgc3dhcChwYWlyJiBfX3ApCiAgICAgIG5v
ZXhjZXB0KF9faXNfbm90aHJvd19zd2FwcGFibGU8X1QxPjo6dmFsdWUKICAgICAgICAgICAgICAg
JiYgX19pc19ub3Rocm93X3N3YXBwYWJsZTxfVDI+Ojp2YWx1ZSkKICAgICAgewogdXNpbmcgc3Rk
Ojpzd2FwOwogc3dhcChmaXJzdCwgX19wLmZpcnN0KTsKIHN3YXAoc2Vjb25kLCBfX3Auc2Vjb25k
KTsKICAgICAgfQoKICAgIHByaXZhdGU6CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9Bcmdz
MSwgc3RkOjpzaXplX3QuLi4gX0luZGV4ZXMxLAogICAgICAgICAgICAgICB0eXBlbmFtZS4uLiBf
QXJnczIsIHN0ZDo6c2l6ZV90Li4uIF9JbmRleGVzMj4KICAgICAgICBwYWlyKHR1cGxlPF9Bcmdz
MS4uLj4mLCB0dXBsZTxfQXJnczIuLi4+JiwKICAgICAgICAgICAgIF9JbmRleF90dXBsZTxfSW5k
ZXhlczEuLi4+LCBfSW5kZXhfdHVwbGU8X0luZGV4ZXMyLi4uPik7CgogICAgfTsKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UMSwgdHlwZW5hbWUgX1QyPgogICAgaW5saW5lIGNvbnN0ZXhwciBib29s
CiAgICBvcGVyYXRvcj09KGNvbnN0IHBhaXI8X1QxLCBfVDI+JiBfX3gsIGNvbnN0IHBhaXI8X1Qx
LCBfVDI+JiBfX3kpCiAgICB7IHJldHVybiBfX3guZmlyc3QgPT0gX195LmZpcnN0ICYmIF9feC5z
ZWNvbmQgPT0gX195LnNlY29uZDsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1QxLCB0eXBlbmFt
ZSBfVDI+CiAgICBpbmxpbmUgY29uc3RleHByIGJvb2wKICAgIG9wZXJhdG9yPChjb25zdCBwYWly
PF9UMSwgX1QyPiYgX194LCBjb25zdCBwYWlyPF9UMSwgX1QyPiYgX195KQogICAgeyByZXR1cm4g
X194LmZpcnN0IDwgX195LmZpcnN0CiAgICAgIHx8ICghKF9feS5maXJzdCA8IF9feC5maXJzdCkg
JiYgX194LnNlY29uZCA8IF9feS5zZWNvbmQpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVDEs
IHR5cGVuYW1lIF9UMj4KICAgIGlubGluZSBjb25zdGV4cHIgYm9vbAogICAgb3BlcmF0b3IhPShj
b25zdCBwYWlyPF9UMSwgX1QyPiYgX194LCBjb25zdCBwYWlyPF9UMSwgX1QyPiYgX195KQogICAg
eyByZXR1cm4gIShfX3ggPT0gX195KTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1QxLCB0eXBl
bmFtZSBfVDI+CiAgICBpbmxpbmUgY29uc3RleHByIGJvb2wKICAgIG9wZXJhdG9yPihjb25zdCBw
YWlyPF9UMSwgX1QyPiYgX194LCBjb25zdCBwYWlyPF9UMSwgX1QyPiYgX195KQogICAgeyByZXR1
cm4gX195IDwgX194OyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVDEsIHR5cGVuYW1lIF9UMj4K
ICAgIGlubGluZSBjb25zdGV4cHIgYm9vbAogICAgb3BlcmF0b3I8PShjb25zdCBwYWlyPF9UMSwg
X1QyPiYgX194LCBjb25zdCBwYWlyPF9UMSwgX1QyPiYgX195KQogICAgeyByZXR1cm4gIShfX3kg
PCBfX3gpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVDEsIHR5cGVuYW1lIF9UMj4KICAgIGlu
bGluZSBjb25zdGV4cHIgYm9vbAogICAgb3BlcmF0b3I+PShjb25zdCBwYWlyPF9UMSwgX1QyPiYg
X194LCBjb25zdCBwYWlyPF9UMSwgX1QyPiYgX195KQogICAgeyByZXR1cm4gIShfX3ggPCBfX3kp
OyB9CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVDEsIHR5cGVuYW1lIF9UMj4KICAgIGlubGlu
ZSB2b2lkCiAgICBzd2FwKHBhaXI8X1QxLCBfVDI+JiBfX3gsIHBhaXI8X1QxLCBfVDI+JiBfX3kp
CiAgICBub2V4Y2VwdChub2V4Y2VwdChfX3guc3dhcChfX3kpKSkKICAgIHsgX194LnN3YXAoX195
KTsgfQojIDQwMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9wYWlyLmgiIDMKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVDEsIHR5cGVuYW1lIF9UMj4KICAgIGNvbnN0ZXhwciBwYWlyPHR5
cGVuYW1lIF9fZGVjYXlfYW5kX3N0cmlwPF9UMT46Ol9fdHlwZSwKICAgICAgICAgICAgICAgICAg
IHR5cGVuYW1lIF9fZGVjYXlfYW5kX3N0cmlwPF9UMj46Ol9fdHlwZT4KICAgIG1ha2VfcGFpcihf
VDEmJiBfX3gsIF9UMiYmIF9feSkKICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX2RlY2F5
X2FuZF9zdHJpcDxfVDE+OjpfX3R5cGUgX19kc190eXBlMTsKICAgICAgdHlwZWRlZiB0eXBlbmFt
ZSBfX2RlY2F5X2FuZF9zdHJpcDxfVDI+OjpfX3R5cGUgX19kc190eXBlMjsKICAgICAgdHlwZWRl
ZiBwYWlyPF9fZHNfdHlwZTEsIF9fZHNfdHlwZTI+IF9fcGFpcl90eXBlOwogICAgICByZXR1cm4g
X19wYWlyX3R5cGUoc3RkOjpmb3J3YXJkPF9UMT4oX194KSwgc3RkOjpmb3J3YXJkPF9UMj4oX195
KSk7CiAgICB9CiMgNDIyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3BhaXIuaCIg
MwoKfQojIDY1ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ29iYXNlLmgiIDIg
MwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfaXRlcmF0b3JfYmFzZV90eXBl
cy5oIiAxIDMKIyA2MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9pdGVyYXRvcl9i
YXNlX3R5cGVzLmgiIDMKICAgICAgIAojIDYzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
c3RsX2l0ZXJhdG9yX2Jhc2VfdHlwZXMuaCIgMwoKCgoKCgoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJp
YnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgojIDg5ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2l0ZXJhdG9yX2Jhc2VfdHlwZXMuaCIgMwogIHN0cnVjdCBp
bnB1dF9pdGVyYXRvcl90YWcgeyB9OwoKCiAgc3RydWN0IG91dHB1dF9pdGVyYXRvcl90YWcgeyB9
OwoKCiAgc3RydWN0IGZvcndhcmRfaXRlcmF0b3JfdGFnIDogcHVibGljIGlucHV0X2l0ZXJhdG9y
X3RhZyB7IH07CgoKCiAgc3RydWN0IGJpZGlyZWN0aW9uYWxfaXRlcmF0b3JfdGFnIDogcHVibGlj
IGZvcndhcmRfaXRlcmF0b3JfdGFnIHsgfTsKCgoKICBzdHJ1Y3QgcmFuZG9tX2FjY2Vzc19pdGVy
YXRvcl90YWcgOiBwdWJsaWMgYmlkaXJlY3Rpb25hbF9pdGVyYXRvcl90YWcgeyB9OwojIDExNiAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9pdGVyYXRvcl9iYXNlX3R5cGVzLmgiIDMK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2F0ZWdvcnksIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0Rp
c3RhbmNlID0gcHRyZGlmZl90LAogICAgICAgICAgIHR5cGVuYW1lIF9Qb2ludGVyID0gX1RwKiwg
dHlwZW5hbWUgX1JlZmVyZW5jZSA9IF9UcCY+CiAgICBzdHJ1Y3QgaXRlcmF0b3IKICAgIHsKCiAg
ICAgIHR5cGVkZWYgX0NhdGVnb3J5IGl0ZXJhdG9yX2NhdGVnb3J5OwoKICAgICAgdHlwZWRlZiBf
VHAgdmFsdWVfdHlwZTsKCiAgICAgIHR5cGVkZWYgX0Rpc3RhbmNlIGRpZmZlcmVuY2VfdHlwZTsK
CiAgICAgIHR5cGVkZWYgX1BvaW50ZXIgcG9pbnRlcjsKCiAgICAgIHR5cGVkZWYgX1JlZmVyZW5j
ZSByZWZlcmVuY2U7CiAgICB9OwojIDE0MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0
bF9pdGVyYXRvcl9iYXNlX3R5cGVzLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3Is
IHR5cGVuYW1lID0gX192b2lkX3Q8Pj4KICAgIHN0cnVjdCBfX2l0ZXJhdG9yX3RyYWl0cyB7IH07
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvcj4KICAgIHN0cnVjdCBfX2l0ZXJhdG9yX3Ry
YWl0czxfSXRlcmF0b3IsCiAgICAgICAgX192b2lkX3Q8dHlwZW5hbWUgX0l0ZXJhdG9yOjppdGVy
YXRvcl9jYXRlZ29yeSwKICAgICAgICAgIHR5cGVuYW1lIF9JdGVyYXRvcjo6dmFsdWVfdHlwZSwK
ICAgICAgICAgIHR5cGVuYW1lIF9JdGVyYXRvcjo6ZGlmZmVyZW5jZV90eXBlLAogICAgICAgICAg
dHlwZW5hbWUgX0l0ZXJhdG9yOjpwb2ludGVyLAogICAgICAgICAgdHlwZW5hbWUgX0l0ZXJhdG9y
OjpyZWZlcmVuY2U+PgogICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9JdGVyYXRvcjo6aXRl
cmF0b3JfY2F0ZWdvcnkgaXRlcmF0b3JfY2F0ZWdvcnk7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUg
X0l0ZXJhdG9yOjp2YWx1ZV90eXBlIHZhbHVlX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUg
X0l0ZXJhdG9yOjpkaWZmZXJlbmNlX3R5cGUgZGlmZmVyZW5jZV90eXBlOwogICAgICB0eXBlZGVm
IHR5cGVuYW1lIF9JdGVyYXRvcjo6cG9pbnRlciBwb2ludGVyOwogICAgICB0eXBlZGVmIHR5cGVu
YW1lIF9JdGVyYXRvcjo6cmVmZXJlbmNlIHJlZmVyZW5jZTsKICAgIH07CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9JdGVyYXRvcj4KICAgIHN0cnVjdCBpdGVyYXRvcl90cmFpdHMKICAgIDogcHVibGlj
IF9faXRlcmF0b3JfdHJhaXRzPF9JdGVyYXRvcj4geyB9OwojIDE3NyAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL3N0bF9pdGVyYXRvcl9iYXNlX3R5cGVzLmgiIDMKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHA+CiAgICBzdHJ1Y3QgaXRlcmF0b3JfdHJhaXRzPF9UcCo+CiAgICB7CiAgICAgIHR5
cGVkZWYgcmFuZG9tX2FjY2Vzc19pdGVyYXRvcl90YWcgaXRlcmF0b3JfY2F0ZWdvcnk7CiAgICAg
IHR5cGVkZWYgX1RwIHZhbHVlX3R5cGU7CiAgICAgIHR5cGVkZWYgcHRyZGlmZl90IGRpZmZlcmVu
Y2VfdHlwZTsKICAgICAgdHlwZWRlZiBfVHAqIHBvaW50ZXI7CiAgICAgIHR5cGVkZWYgX1RwJiBy
ZWZlcmVuY2U7CiAgICB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGl0
ZXJhdG9yX3RyYWl0czxjb25zdCBfVHAqPgogICAgewogICAgICB0eXBlZGVmIHJhbmRvbV9hY2Nl
c3NfaXRlcmF0b3JfdGFnIGl0ZXJhdG9yX2NhdGVnb3J5OwogICAgICB0eXBlZGVmIF9UcCB2YWx1
ZV90eXBlOwogICAgICB0eXBlZGVmIHB0cmRpZmZfdCBkaWZmZXJlbmNlX3R5cGU7CiAgICAgIHR5
cGVkZWYgY29uc3QgX1RwKiBwb2ludGVyOwogICAgICB0eXBlZGVmIGNvbnN0IF9UcCYgcmVmZXJl
bmNlOwogICAgfTsKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyPgogICAgaW5saW5lIHR5
cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfSXRlcj46Oml0ZXJhdG9yX2NhdGVnb3J5CiAgICBfX2l0
ZXJhdG9yX2NhdGVnb3J5KGNvbnN0IF9JdGVyJikKICAgIHsgcmV0dXJuIHR5cGVuYW1lIGl0ZXJh
dG9yX3RyYWl0czxfSXRlcj46Oml0ZXJhdG9yX2NhdGVnb3J5KCk7IH0KIyAyMzAgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfaXRlcmF0b3JfYmFzZV90eXBlcy5oIiAzCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0luSXRlcj4KICAgIHVzaW5nIF9SZXF1aXJlSW5wdXRJdGVyID0gdHlwZW5h
bWUKICAgICAgZW5hYmxlX2lmPGlzX2NvbnZlcnRpYmxlPHR5cGVuYW1lCiAgaXRlcmF0b3JfdHJh
aXRzPF9Jbkl0ZXI+OjppdGVyYXRvcl9jYXRlZ29yeSwKICAgICAgICAgIGlucHV0X2l0ZXJhdG9y
X3RhZz46OnZhbHVlPjo6dHlwZTsKCgoKfQojIDY2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX2FsZ29iYXNlLmgiIDIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9z
dGxfaXRlcmF0b3JfYmFzZV9mdW5jcy5oIiAxIDMKIyA2MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL3N0bF9pdGVyYXRvcl9iYXNlX2Z1bmNzLmgiIDMKICAgICAgIAojIDYzICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2l0ZXJhdG9yX2Jhc2VfZnVuY3MuaCIgMwoKCiMgMSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9kZWJ1Zy9hc3NlcnRpb25zLmgiIDEgMwojIDY2ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2l0ZXJhdG9yX2Jhc2VfZnVuY3MuaCIgMiAzCgpu
YW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkp
CnsKCgogIHRlbXBsYXRlIDx0eXBlbmFtZT4gc3RydWN0IF9MaXN0X2l0ZXJhdG9yOwogIHRlbXBs
YXRlIDx0eXBlbmFtZT4gc3RydWN0IF9MaXN0X2NvbnN0X2l0ZXJhdG9yOwoKCgoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcj4KICAgIGlubGluZSB0eXBlbmFtZSBpdGVyYXRvcl90
cmFpdHM8X0lucHV0SXRlcmF0b3I+OjpkaWZmZXJlbmNlX3R5cGUKICAgIF9fZGlzdGFuY2UoX0lu
cHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgICAgICAgICAg
ICBpbnB1dF9pdGVyYXRvcl90YWcpCiAgICB7CgogICAgIAoKICAgICAgdHlwZW5hbWUgaXRlcmF0
b3JfdHJhaXRzPF9JbnB1dEl0ZXJhdG9yPjo6ZGlmZmVyZW5jZV90eXBlIF9fbiA9IDA7CiAgICAg
IHdoaWxlIChfX2ZpcnN0ICE9IF9fbGFzdCkKIHsKICAgKytfX2ZpcnN0OwogICArK19fbjsKIH0K
ICAgICAgcmV0dXJuIF9fbjsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFjY2Vz
c0l0ZXJhdG9yPgogICAgaW5saW5lIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfUmFuZG9tQWNj
ZXNzSXRlcmF0b3I+OjpkaWZmZXJlbmNlX3R5cGUKICAgIF9fZGlzdGFuY2UoX1JhbmRvbUFjY2Vz
c0l0ZXJhdG9yIF9fZmlyc3QsIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QsCiAgICAgICAg
ICAgICAgIHJhbmRvbV9hY2Nlc3NfaXRlcmF0b3JfdGFnKQogICAgewoKICAgICAKCiAgICAgIHJl
dHVybiBfX2xhc3QgLSBfX2ZpcnN0OwogICAgfQoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4K
ICAgIHB0cmRpZmZfdAogICAgX19kaXN0YW5jZShzdGQ6Ol9MaXN0X2l0ZXJhdG9yPF9UcD4sCiAg
ICAgICAgc3RkOjpfTGlzdF9pdGVyYXRvcjxfVHA+LAogICAgICAgIGlucHV0X2l0ZXJhdG9yX3Rh
Zyk7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHB0cmRpZmZfdAogICAgX19kaXN0YW5j
ZShzdGQ6Ol9MaXN0X2NvbnN0X2l0ZXJhdG9yPF9UcD4sCiAgICAgICAgc3RkOjpfTGlzdF9jb25z
dF9pdGVyYXRvcjxfVHA+LAogICAgICAgIGlucHV0X2l0ZXJhdG9yX3RhZyk7CiMgMTMzICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2l0ZXJhdG9yX2Jhc2VfZnVuY3MuaCIgMwogIHRl
bXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yPgogICAgaW5saW5lIHR5cGVuYW1lIGl0ZXJh
dG9yX3RyYWl0czxfSW5wdXRJdGVyYXRvcj46OmRpZmZlcmVuY2VfdHlwZQogICAgZGlzdGFuY2Uo
X0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0KQogICAgewoKICAg
ICAgcmV0dXJuIHN0ZDo6X19kaXN0YW5jZShfX2ZpcnN0LCBfX2xhc3QsCiAgICAgICAgc3RkOjpf
X2l0ZXJhdG9yX2NhdGVnb3J5KF9fZmlyc3QpKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9EaXN0YW5jZT4KICAgIGlubGluZSB2b2lkCiAgICBf
X2FkdmFuY2UoX0lucHV0SXRlcmF0b3ImIF9faSwgX0Rpc3RhbmNlIF9fbiwgaW5wdXRfaXRlcmF0
b3JfdGFnKQogICAgewoKICAgICAKICAgICAgOwogICAgICB3aGlsZSAoX19uLS0pCiArK19faTsK
ICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0JpZGlyZWN0aW9uYWxJdGVyYXRvciwgdHlwZW5h
bWUgX0Rpc3RhbmNlPgogICAgaW5saW5lIHZvaWQKICAgIF9fYWR2YW5jZShfQmlkaXJlY3Rpb25h
bEl0ZXJhdG9yJiBfX2ksIF9EaXN0YW5jZSBfX24sCiAgICAgICBiaWRpcmVjdGlvbmFsX2l0ZXJh
dG9yX3RhZykKICAgIHsKCiAgICAgCgogICAgICBpZiAoX19uID4gMCkKICAgICAgICB3aGlsZSAo
X19uLS0pCiAgICsrX19pOwogICAgICBlbHNlCiAgICAgICAgd2hpbGUgKF9fbisrKQogICAtLV9f
aTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBl
bmFtZSBfRGlzdGFuY2U+CiAgICBpbmxpbmUgdm9pZAogICAgX19hZHZhbmNlKF9SYW5kb21BY2Nl
c3NJdGVyYXRvciYgX19pLCBfRGlzdGFuY2UgX19uLAogICAgICAgICAgICAgIHJhbmRvbV9hY2Nl
c3NfaXRlcmF0b3JfdGFnKQogICAgewoKICAgICAKCiAgICAgIF9faSArPSBfX247CiAgICB9CiMg
MTkyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2l0ZXJhdG9yX2Jhc2VfZnVuY3Mu
aCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfRGlzdGFu
Y2U+CiAgICBpbmxpbmUgdm9pZAogICAgYWR2YW5jZShfSW5wdXRJdGVyYXRvciYgX19pLCBfRGlz
dGFuY2UgX19uKQogICAgewoKICAgICAgdHlwZW5hbWUgaXRlcmF0b3JfdHJhaXRzPF9JbnB1dEl0
ZXJhdG9yPjo6ZGlmZmVyZW5jZV90eXBlIF9fZCA9IF9fbjsKICAgICAgc3RkOjpfX2FkdmFuY2Uo
X19pLCBfX2QsIHN0ZDo6X19pdGVyYXRvcl9jYXRlZ29yeShfX2kpKTsKICAgIH0KCgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yPgogICAgaW5saW5lIF9Gb3J3YXJkSXRlcmF0
b3IKICAgIG5leHQoX0ZvcndhcmRJdGVyYXRvciBfX3gsIHR5cGVuYW1lCiAgaXRlcmF0b3JfdHJh
aXRzPF9Gb3J3YXJkSXRlcmF0b3I+OjpkaWZmZXJlbmNlX3R5cGUgX19uID0gMSkKICAgIHsKCiAg
ICAgCgogICAgICBzdGQ6OmFkdmFuY2UoX194LCBfX24pOwogICAgICByZXR1cm4gX194OwogICAg
fQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yPgogICAgaW5saW5l
IF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IKICAgIHByZXYoX0JpZGlyZWN0aW9uYWxJdGVyYXRvciBf
X3gsIHR5cGVuYW1lCiAgaXRlcmF0b3JfdHJhaXRzPF9CaWRpcmVjdGlvbmFsSXRlcmF0b3I+Ojpk
aWZmZXJlbmNlX3R5cGUgX19uID0gMSkKICAgIHsKCiAgICAgCgogICAgICBzdGQ6OmFkdmFuY2Uo
X194LCAtX19uKTsKICAgICAgcmV0dXJuIF9feDsKICAgIH0KCgoKCn0KIyA2NyAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvYmFzZS5oIiAyIDMKIyAxICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RsX2l0ZXJhdG9yLmgiIDEgMwojIDY2ICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvc3RsX2l0ZXJhdG9yLmgiIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvcHRyX3RyYWl0cy5oIiAxIDMKIyAzNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L3B0cl90cmFpdHMuaCIgMwpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxp
dHlfXyAoImRlZmF1bHQiKSkpCnsKCgogIGNsYXNzIF9fdW5kZWZpbmVkOwoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9fZ2V0X2ZpcnN0X2FyZwogICAgeyB1c2luZyB0eXBl
ID0gX191bmRlZmluZWQ7IH07CgogIHRlbXBsYXRlPHRlbXBsYXRlPHR5cGVuYW1lLCB0eXBlbmFt
ZS4uLj4gY2xhc3MgX1RlbXBsYXRlLCB0eXBlbmFtZSBfVHAsCiAgICAgICAgICAgdHlwZW5hbWUu
Li4gX1R5cGVzPgogICAgc3RydWN0IF9fZ2V0X2ZpcnN0X2FyZzxfVGVtcGxhdGU8X1RwLCBfVHlw
ZXMuLi4+PgogICAgeyB1c2luZyB0eXBlID0gX1RwOyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHA+CiAgICB1c2luZyBfX2dldF9maXJzdF9hcmdfdCA9IHR5cGVuYW1lIF9fZ2V0X2ZpcnN0X2Fy
ZzxfVHA+Ojp0eXBlOwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfVXA+CiAg
ICBzdHJ1Y3QgX19yZXBsYWNlX2ZpcnN0X2FyZwogICAgeyB1c2luZyB0eXBlID0gX191bmRlZmlu
ZWQ7IH07CgogIHRlbXBsYXRlPHRlbXBsYXRlPHR5cGVuYW1lLCB0eXBlbmFtZS4uLj4gY2xhc3Mg
X1RlbXBsYXRlLCB0eXBlbmFtZSBfVXAsCiAgICAgICAgICAgdHlwZW5hbWUgX1RwLCB0eXBlbmFt
ZS4uLiBfVHlwZXM+CiAgICBzdHJ1Y3QgX19yZXBsYWNlX2ZpcnN0X2FyZzxfVGVtcGxhdGU8X1Rw
LCBfVHlwZXMuLi4+LCBfVXA+CiAgICB7IHVzaW5nIHR5cGUgPSBfVGVtcGxhdGU8X1VwLCBfVHlw
ZXMuLi4+OyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9VcD4KICAgIHVz
aW5nIF9fcmVwbGFjZV9maXJzdF9hcmdfdCA9IHR5cGVuYW1lIF9fcmVwbGFjZV9maXJzdF9hcmc8
X1RwLCBfVXA+Ojp0eXBlOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICB1c2luZyBfX21h
a2Vfbm90X3ZvaWQKICAgICAgPSB0eXBlbmFtZSBjb25kaXRpb25hbDxpc192b2lkPF9UcD46OnZh
bHVlLCBfX3VuZGVmaW5lZCwgX1RwPjo6dHlwZTsKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Q
dHI+CiAgICBzdHJ1Y3QgcG9pbnRlcl90cmFpdHMKICAgIHsKICAgIHByaXZhdGU6CiAgICAgIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcD4KIHVzaW5nIF9fZWxlbWVudF90eXBlID0gdHlwZW5hbWUgX1Rw
OjplbGVtZW50X3R5cGU7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiB1c2luZyBfX2Rp
ZmZlcmVuY2VfdHlwZSA9IHR5cGVuYW1lIF9UcDo6ZGlmZmVyZW5jZV90eXBlOwoKICAgICAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfVXA+CiB1c2luZyBfX3JlYmluZCA9IHR5cGVu
YW1lIF9UcDo6dGVtcGxhdGUgcmViaW5kPF9VcD47CgogICAgcHVibGljOgoKICAgICAgdXNpbmcg
cG9pbnRlciA9IF9QdHI7CgoKICAgICAgdXNpbmcgZWxlbWVudF90eXBlCiA9IF9fZGV0ZWN0ZWRf
b3JfdF88X19nZXRfZmlyc3RfYXJnX3QsIF9fZWxlbWVudF90eXBlLCBfUHRyPjsKCgogICAgICB1
c2luZyBkaWZmZXJlbmNlX3R5cGUKID0gX19kZXRlY3RlZF9vcl90PHB0cmRpZmZfdCwgX19kaWZm
ZXJlbmNlX3R5cGUsIF9QdHI+OwoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VcD4KICAgICAg
ICB1c2luZyByZWJpbmQKICAgPSBfX2RldGVjdGVkX29yX3RfPF9fcmVwbGFjZV9maXJzdF9hcmdf
dCwgX19yZWJpbmQsIF9QdHIsIF9VcD47CgogICAgICBzdGF0aWMgX1B0cgogICAgICBwb2ludGVy
X3RvKF9fbWFrZV9ub3Rfdm9pZDxlbGVtZW50X3R5cGU+JiBfX2UpCiAgICAgIHsgcmV0dXJuIF9Q
dHI6OnBvaW50ZXJfdG8oX19lKTsgfQoKICAgICAgc3RhdGljX2Fzc2VydCghaXNfc2FtZTxlbGVt
ZW50X3R5cGUsIF9fdW5kZWZpbmVkPjo6dmFsdWUsCiAgICJwb2ludGVyIHR5cGUgZGVmaW5lcyBl
bGVtZW50X3R5cGUgb3IgaXMgbGlrZSBTb21lUG9pbnRlcjxULCBBcmdzPiIpOwogICAgICBzdGF0
aWNfYXNzZXJ0KCFpc19zYW1lPHJlYmluZDxlbGVtZW50X3R5cGU+LCBfX3VuZGVmaW5lZD46OnZh
bHVlLAogICAicG9pbnRlciB0eXBlIGRlZmluZXMgcmViaW5kPFU+IG9yIGlzIGxpa2UgU29tZVBv
aW50ZXI8VCwgQXJncz4iKTsKICAgIH07CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAg
ICBzdHJ1Y3QgcG9pbnRlcl90cmFpdHM8X1RwKj4KICAgIHsKCiAgICAgIHR5cGVkZWYgX1RwKiBw
b2ludGVyOwoKICAgICAgdHlwZWRlZiBfVHAgZWxlbWVudF90eXBlOwoKICAgICAgdHlwZWRlZiBw
dHJkaWZmX3QgZGlmZmVyZW5jZV90eXBlOwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1VwPgog
ICAgICAgIHVzaW5nIHJlYmluZCA9IF9VcCo7CgoKCgoKCiAgICAgIHN0YXRpYyBwb2ludGVyCiAg
ICAgIHBvaW50ZXJfdG8oX19tYWtlX25vdF92b2lkPGVsZW1lbnRfdHlwZT4mIF9fcikgbm9leGNl
cHQKICAgICAgeyByZXR1cm4gc3RkOjphZGRyZXNzb2YoX19yKTsgfQogICAgfTsKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9QdHIsIHR5cGVuYW1lIF9UcD4KICAgIHVzaW5nIF9fcHRyX3JlYmluZCA9
IHR5cGVuYW1lIHBvaW50ZXJfdHJhaXRzPF9QdHI+Ojp0ZW1wbGF0ZSByZWJpbmQ8X1RwPjsKCgp9
CiMgNjcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfaXRlcmF0b3IuaCIgMiAzCgpu
YW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkp
CnsKCiMgOTYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfaXRlcmF0b3IuaCIgMwog
IHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvcj4KICAgIGNsYXNzIHJldmVyc2VfaXRlcmF0b3IK
ICAgIDogcHVibGljIGl0ZXJhdG9yPHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfSXRlcmF0b3I+
OjppdGVyYXRvcl9jYXRlZ29yeSwKICAgICAgICB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0l0
ZXJhdG9yPjo6dmFsdWVfdHlwZSwKICAgICAgICB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0l0
ZXJhdG9yPjo6ZGlmZmVyZW5jZV90eXBlLAogICAgICAgIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0
czxfSXRlcmF0b3I+Ojpwb2ludGVyLAogICAgICAgICAgICAgICAgICAgICAgdHlwZW5hbWUgaXRl
cmF0b3JfdHJhaXRzPF9JdGVyYXRvcj46OnJlZmVyZW5jZT4KICAgIHsKICAgIHByb3RlY3RlZDoK
ICAgICAgX0l0ZXJhdG9yIGN1cnJlbnQ7CgogICAgICB0eXBlZGVmIGl0ZXJhdG9yX3RyYWl0czxf
SXRlcmF0b3I+IF9fdHJhaXRzX3R5cGU7CgogICAgcHVibGljOgogICAgICB0eXBlZGVmIF9JdGVy
YXRvciBpdGVyYXRvcl90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fdHJhaXRzX3R5cGU6
OmRpZmZlcmVuY2VfdHlwZSBkaWZmZXJlbmNlX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUg
X190cmFpdHNfdHlwZTo6cG9pbnRlciBwb2ludGVyOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9f
dHJhaXRzX3R5cGU6OnJlZmVyZW5jZSByZWZlcmVuY2U7CgoKCgoKCgogICAgICByZXZlcnNlX2l0
ZXJhdG9yKCkgOiBjdXJyZW50KCkgeyB9CgoKCgogICAgICBleHBsaWNpdAogICAgICByZXZlcnNl
X2l0ZXJhdG9yKGl0ZXJhdG9yX3R5cGUgX194KSA6IGN1cnJlbnQoX194KSB7IH0KCgoKCiAgICAg
IHJldmVyc2VfaXRlcmF0b3IoY29uc3QgcmV2ZXJzZV9pdGVyYXRvciYgX194KQogICAgICA6IGN1
cnJlbnQoX194LmN1cnJlbnQpIHsgfQoKCgoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVy
PgogICAgICAgIHJldmVyc2VfaXRlcmF0b3IoY29uc3QgcmV2ZXJzZV9pdGVyYXRvcjxfSXRlcj4m
IF9feCkKIDogY3VycmVudChfX3guYmFzZSgpKSB7IH0KCgoKCiAgICAgIGl0ZXJhdG9yX3R5cGUK
ICAgICAgYmFzZSgpIGNvbnN0CiAgICAgIHsgcmV0dXJuIGN1cnJlbnQ7IH0KIyAxNjAgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfaXRlcmF0b3IuaCIgMwogICAgICByZWZlcmVuY2UK
ICAgICAgb3BlcmF0b3IqKCkgY29uc3QKICAgICAgewogX0l0ZXJhdG9yIF9fdG1wID0gY3VycmVu
dDsKIHJldHVybiAqLS1fX3RtcDsKICAgICAgfQoKCgoKCgogICAgICBwb2ludGVyCiAgICAgIG9w
ZXJhdG9yLT4oKSBjb25zdAogICAgICB7IHJldHVybiAmKG9wZXJhdG9yKigpKTsgfQoKCgoKCgog
ICAgICByZXZlcnNlX2l0ZXJhdG9yJgogICAgICBvcGVyYXRvcisrKCkKICAgICAgewogLS1jdXJy
ZW50OwogcmV0dXJuICp0aGlzOwogICAgICB9CgoKCgoKCiAgICAgIHJldmVyc2VfaXRlcmF0b3IK
ICAgICAgb3BlcmF0b3IrKyhpbnQpCiAgICAgIHsKIHJldmVyc2VfaXRlcmF0b3IgX190bXAgPSAq
dGhpczsKIC0tY3VycmVudDsKIHJldHVybiBfX3RtcDsKICAgICAgfQoKCgoKCgogICAgICByZXZl
cnNlX2l0ZXJhdG9yJgogICAgICBvcGVyYXRvci0tKCkKICAgICAgewogKytjdXJyZW50OwogcmV0
dXJuICp0aGlzOwogICAgICB9CgoKCgoKCiAgICAgIHJldmVyc2VfaXRlcmF0b3IKICAgICAgb3Bl
cmF0b3ItLShpbnQpCiAgICAgIHsKIHJldmVyc2VfaXRlcmF0b3IgX190bXAgPSAqdGhpczsKICsr
Y3VycmVudDsKIHJldHVybiBfX3RtcDsKICAgICAgfQoKCgoKCgogICAgICByZXZlcnNlX2l0ZXJh
dG9yCiAgICAgIG9wZXJhdG9yKyhkaWZmZXJlbmNlX3R5cGUgX19uKSBjb25zdAogICAgICB7IHJl
dHVybiByZXZlcnNlX2l0ZXJhdG9yKGN1cnJlbnQgLSBfX24pOyB9CgoKCgoKCgogICAgICByZXZl
cnNlX2l0ZXJhdG9yJgogICAgICBvcGVyYXRvcis9KGRpZmZlcmVuY2VfdHlwZSBfX24pCiAgICAg
IHsKIGN1cnJlbnQgLT0gX19uOwogcmV0dXJuICp0aGlzOwogICAgICB9CgoKCgoKCiAgICAgIHJl
dmVyc2VfaXRlcmF0b3IKICAgICAgb3BlcmF0b3ItKGRpZmZlcmVuY2VfdHlwZSBfX24pIGNvbnN0
CiAgICAgIHsgcmV0dXJuIHJldmVyc2VfaXRlcmF0b3IoY3VycmVudCArIF9fbik7IH0KCgoKCgoK
CiAgICAgIHJldmVyc2VfaXRlcmF0b3ImCiAgICAgIG9wZXJhdG9yLT0oZGlmZmVyZW5jZV90eXBl
IF9fbikKICAgICAgewogY3VycmVudCArPSBfX247CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCgoK
CgoKICAgICAgcmVmZXJlbmNlCiAgICAgIG9wZXJhdG9yW10oZGlmZmVyZW5jZV90eXBlIF9fbikg
Y29uc3QKICAgICAgeyByZXR1cm4gKigqdGhpcyArIF9fbik7IH0KICAgIH07CiMgMjkwICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2l0ZXJhdG9yLmgiIDMKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfSXRlcmF0b3I+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I9PShjb25zdCByZXZl
cnNlX2l0ZXJhdG9yPF9JdGVyYXRvcj4mIF9feCwKICAgICAgICBjb25zdCByZXZlcnNlX2l0ZXJh
dG9yPF9JdGVyYXRvcj4mIF9feSkKICAgIHsgcmV0dXJuIF9feC5iYXNlKCkgPT0gX195LmJhc2Uo
KTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3I+CiAgICBpbmxpbmUgYm9vbAogICAg
b3BlcmF0b3I8KGNvbnN0IHJldmVyc2VfaXRlcmF0b3I8X0l0ZXJhdG9yPiYgX194LAogICAgICAg
Y29uc3QgcmV2ZXJzZV9pdGVyYXRvcjxfSXRlcmF0b3I+JiBfX3kpCiAgICB7IHJldHVybiBfX3ku
YmFzZSgpIDwgX194LmJhc2UoKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3I+CiAg
ICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3IhPShjb25zdCByZXZlcnNlX2l0ZXJhdG9yPF9JdGVy
YXRvcj4mIF9feCwKICAgICAgICBjb25zdCByZXZlcnNlX2l0ZXJhdG9yPF9JdGVyYXRvcj4mIF9f
eSkKICAgIHsgcmV0dXJuICEoX194ID09IF9feSk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0
ZXJhdG9yPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPihjb25zdCByZXZlcnNlX2l0ZXJh
dG9yPF9JdGVyYXRvcj4mIF9feCwKICAgICAgIGNvbnN0IHJldmVyc2VfaXRlcmF0b3I8X0l0ZXJh
dG9yPiYgX195KQogICAgeyByZXR1cm4gX195IDwgX194OyB9CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9JdGVyYXRvcj4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcjw9KGNvbnN0IHJldmVyc2Vf
aXRlcmF0b3I8X0l0ZXJhdG9yPiYgX194LAogICAgICAgIGNvbnN0IHJldmVyc2VfaXRlcmF0b3I8
X0l0ZXJhdG9yPiYgX195KQogICAgeyByZXR1cm4gIShfX3kgPCBfX3gpOyB9CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9JdGVyYXRvcj4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj49KGNvbnN0
IHJldmVyc2VfaXRlcmF0b3I8X0l0ZXJhdG9yPiYgX194LAogICAgICAgIGNvbnN0IHJldmVyc2Vf
aXRlcmF0b3I8X0l0ZXJhdG9yPiYgX195KQogICAgeyByZXR1cm4gIShfX3ggPCBfX3kpOyB9Cgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvcj4KICAgIGlubGluZSB0eXBlbmFtZSByZXZlcnNl
X2l0ZXJhdG9yPF9JdGVyYXRvcj46OmRpZmZlcmVuY2VfdHlwZQogICAgb3BlcmF0b3ItKGNvbnN0
IHJldmVyc2VfaXRlcmF0b3I8X0l0ZXJhdG9yPiYgX194LAogICAgICAgY29uc3QgcmV2ZXJzZV9p
dGVyYXRvcjxfSXRlcmF0b3I+JiBfX3kpCiAgICB7IHJldHVybiBfX3kuYmFzZSgpIC0gX194LmJh
c2UoKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3I+CiAgICBpbmxpbmUgcmV2ZXJz
ZV9pdGVyYXRvcjxfSXRlcmF0b3I+CiAgICBvcGVyYXRvcisodHlwZW5hbWUgcmV2ZXJzZV9pdGVy
YXRvcjxfSXRlcmF0b3I+OjpkaWZmZXJlbmNlX3R5cGUgX19uLAogICAgICAgY29uc3QgcmV2ZXJz
ZV9pdGVyYXRvcjxfSXRlcmF0b3I+JiBfX3gpCiAgICB7IHJldHVybiByZXZlcnNlX2l0ZXJhdG9y
PF9JdGVyYXRvcj4oX194LmJhc2UoKSAtIF9fbik7IH0KCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
SXRlcmF0b3JMLCB0eXBlbmFtZSBfSXRlcmF0b3JSPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJh
dG9yPT0oY29uc3QgcmV2ZXJzZV9pdGVyYXRvcjxfSXRlcmF0b3JMPiYgX194LAogICAgICAgIGNv
bnN0IHJldmVyc2VfaXRlcmF0b3I8X0l0ZXJhdG9yUj4mIF9feSkKICAgIHsgcmV0dXJuIF9feC5i
YXNlKCkgPT0gX195LmJhc2UoKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3JMLCB0
eXBlbmFtZSBfSXRlcmF0b3JSPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPChjb25zdCBy
ZXZlcnNlX2l0ZXJhdG9yPF9JdGVyYXRvckw+JiBfX3gsCiAgICAgICBjb25zdCByZXZlcnNlX2l0
ZXJhdG9yPF9JdGVyYXRvclI+JiBfX3kpCiAgICB7IHJldHVybiBfX3kuYmFzZSgpIDwgX194LmJh
c2UoKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3JMLCB0eXBlbmFtZSBfSXRlcmF0
b3JSPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yIT0oY29uc3QgcmV2ZXJzZV9pdGVyYXRv
cjxfSXRlcmF0b3JMPiYgX194LAogICAgICAgIGNvbnN0IHJldmVyc2VfaXRlcmF0b3I8X0l0ZXJh
dG9yUj4mIF9feSkKICAgIHsgcmV0dXJuICEoX194ID09IF9feSk7IH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0l0ZXJhdG9yTCwgdHlwZW5hbWUgX0l0ZXJhdG9yUj4KICAgIGlubGluZSBib29sCiAg
ICBvcGVyYXRvcj4oY29uc3QgcmV2ZXJzZV9pdGVyYXRvcjxfSXRlcmF0b3JMPiYgX194LAogICAg
ICAgY29uc3QgcmV2ZXJzZV9pdGVyYXRvcjxfSXRlcmF0b3JSPiYgX195KQogICAgeyByZXR1cm4g
X195IDwgX194OyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvckwsIHR5cGVuYW1lIF9J
dGVyYXRvclI+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I8PShjb25zdCByZXZlcnNlX2l0
ZXJhdG9yPF9JdGVyYXRvckw+JiBfX3gsCiAgICAgICAgY29uc3QgcmV2ZXJzZV9pdGVyYXRvcjxf
SXRlcmF0b3JSPiYgX195KQogICAgeyByZXR1cm4gIShfX3kgPCBfX3gpOyB9CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9JdGVyYXRvckwsIHR5cGVuYW1lIF9JdGVyYXRvclI+CiAgICBpbmxpbmUgYm9v
bAogICAgb3BlcmF0b3I+PShjb25zdCByZXZlcnNlX2l0ZXJhdG9yPF9JdGVyYXRvckw+JiBfX3gs
CiAgICAgICAgY29uc3QgcmV2ZXJzZV9pdGVyYXRvcjxfSXRlcmF0b3JSPiYgX195KQogICAgeyBy
ZXR1cm4gIShfX3ggPCBfX3kpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvckwsIHR5
cGVuYW1lIF9JdGVyYXRvclI+CgoKICAgIGlubGluZSBhdXRvCiAgICBvcGVyYXRvci0oY29uc3Qg
cmV2ZXJzZV9pdGVyYXRvcjxfSXRlcmF0b3JMPiYgX194LAogICAgICAgY29uc3QgcmV2ZXJzZV9p
dGVyYXRvcjxfSXRlcmF0b3JSPiYgX195KQogICAgLT4gZGVjbHR5cGUoX195LmJhc2UoKSAtIF9f
eC5iYXNlKCkpCgoKCgoKICAgIHsgcmV0dXJuIF9feS5iYXNlKCkgLSBfX3guYmFzZSgpOyB9CgoK
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvcj4KICAgIGlubGluZSByZXZlcnNlX2l0ZXJh
dG9yPF9JdGVyYXRvcj4KICAgIF9fbWFrZV9yZXZlcnNlX2l0ZXJhdG9yKF9JdGVyYXRvciBfX2kp
CiAgICB7IHJldHVybiByZXZlcnNlX2l0ZXJhdG9yPF9JdGVyYXRvcj4oX19pKTsgfQojIDQxMiAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9pdGVyYXRvci5oIiAzCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0l0ZXJhdG9yPgogICAgYXV0bwogICAgX19uaXRlcl9iYXNlKHJldmVyc2VfaXRl
cmF0b3I8X0l0ZXJhdG9yPiBfX2l0KQogICAgLT4gZGVjbHR5cGUoX19tYWtlX3JldmVyc2VfaXRl
cmF0b3IoX19uaXRlcl9iYXNlKF9faXQuYmFzZSgpKSkpCiAgICB7IHJldHVybiBfX21ha2VfcmV2
ZXJzZV9pdGVyYXRvcihfX25pdGVyX2Jhc2UoX19pdC5iYXNlKCkpKTsgfQoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfSXRlcmF0b3I+CiAgICBzdHJ1Y3QgX19pc19tb3ZlX2l0ZXJhdG9yPHJldmVyc2Vf
aXRlcmF0b3I8X0l0ZXJhdG9yPiA+CiAgICAgIDogX19pc19tb3ZlX2l0ZXJhdG9yPF9JdGVyYXRv
cj4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9yPgogICAgYXV0bwogICAg
X19taXRlcl9iYXNlKHJldmVyc2VfaXRlcmF0b3I8X0l0ZXJhdG9yPiBfX2l0KQogICAgLT4gZGVj
bHR5cGUoX19tYWtlX3JldmVyc2VfaXRlcmF0b3IoX19taXRlcl9iYXNlKF9faXQuYmFzZSgpKSkp
CiAgICB7IHJldHVybiBfX21ha2VfcmV2ZXJzZV9pdGVyYXRvcihfX21pdGVyX2Jhc2UoX19pdC5i
YXNlKCkpKTsgfQojIDQ0MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9pdGVyYXRv
ci5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NvbnRhaW5lcj4KICAgIGNsYXNzIGJhY2tfaW5z
ZXJ0X2l0ZXJhdG9yCiAgICA6IHB1YmxpYyBpdGVyYXRvcjxvdXRwdXRfaXRlcmF0b3JfdGFnLCB2
b2lkLCB2b2lkLCB2b2lkLCB2b2lkPgogICAgewogICAgcHJvdGVjdGVkOgogICAgICBfQ29udGFp
bmVyKiBjb250YWluZXI7CgogICAgcHVibGljOgoKICAgICAgdHlwZWRlZiBfQ29udGFpbmVyIGNv
bnRhaW5lcl90eXBlOwoKCiAgICAgIGV4cGxpY2l0CiAgICAgIGJhY2tfaW5zZXJ0X2l0ZXJhdG9y
KF9Db250YWluZXImIF9feCkKICAgICAgOiBjb250YWluZXIoc3RkOjpfX2FkZHJlc3NvZihfX3gp
KSB7IH0KIyA0NzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfaXRlcmF0b3IuaCIg
MwogICAgICBiYWNrX2luc2VydF9pdGVyYXRvciYKICAgICAgb3BlcmF0b3I9KGNvbnN0IHR5cGVu
YW1lIF9Db250YWluZXI6OnZhbHVlX3R5cGUmIF9fdmFsdWUpCiAgICAgIHsKIGNvbnRhaW5lci0+
cHVzaF9iYWNrKF9fdmFsdWUpOwogcmV0dXJuICp0aGlzOwogICAgICB9CgogICAgICBiYWNrX2lu
c2VydF9pdGVyYXRvciYKICAgICAgb3BlcmF0b3I9KHR5cGVuYW1lIF9Db250YWluZXI6OnZhbHVl
X3R5cGUmJiBfX3ZhbHVlKQogICAgICB7CiBjb250YWluZXItPnB1c2hfYmFjayhzdGQ6Om1vdmUo
X192YWx1ZSkpOwogcmV0dXJuICp0aGlzOwogICAgICB9CgoKCiAgICAgIGJhY2tfaW5zZXJ0X2l0
ZXJhdG9yJgogICAgICBvcGVyYXRvciooKQogICAgICB7IHJldHVybiAqdGhpczsgfQoKCiAgICAg
IGJhY2tfaW5zZXJ0X2l0ZXJhdG9yJgogICAgICBvcGVyYXRvcisrKCkKICAgICAgeyByZXR1cm4g
KnRoaXM7IH0KCgogICAgICBiYWNrX2luc2VydF9pdGVyYXRvcgogICAgICBvcGVyYXRvcisrKGlu
dCkKICAgICAgeyByZXR1cm4gKnRoaXM7IH0KICAgIH07CiMgNTE4ICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvc3RsX2l0ZXJhdG9yLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ29udGFp
bmVyPgogICAgaW5saW5lIGJhY2tfaW5zZXJ0X2l0ZXJhdG9yPF9Db250YWluZXI+CiAgICBiYWNr
X2luc2VydGVyKF9Db250YWluZXImIF9feCkKICAgIHsgcmV0dXJuIGJhY2tfaW5zZXJ0X2l0ZXJh
dG9yPF9Db250YWluZXI+KF9feCk7IH0KIyA1MzMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9zdGxfaXRlcmF0b3IuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Db250YWluZXI+CiAgICBj
bGFzcyBmcm9udF9pbnNlcnRfaXRlcmF0b3IKICAgIDogcHVibGljIGl0ZXJhdG9yPG91dHB1dF9p
dGVyYXRvcl90YWcsIHZvaWQsIHZvaWQsIHZvaWQsIHZvaWQ+CiAgICB7CiAgICBwcm90ZWN0ZWQ6
CiAgICAgIF9Db250YWluZXIqIGNvbnRhaW5lcjsKCiAgICBwdWJsaWM6CgogICAgICB0eXBlZGVm
IF9Db250YWluZXIgY29udGFpbmVyX3R5cGU7CgoKICAgICAgZXhwbGljaXQgZnJvbnRfaW5zZXJ0
X2l0ZXJhdG9yKF9Db250YWluZXImIF9feCkKICAgICAgOiBjb250YWluZXIoc3RkOjpfX2FkZHJl
c3NvZihfX3gpKSB7IH0KIyA1NjcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfaXRl
cmF0b3IuaCIgMwogICAgICBmcm9udF9pbnNlcnRfaXRlcmF0b3ImCiAgICAgIG9wZXJhdG9yPShj
b25zdCB0eXBlbmFtZSBfQ29udGFpbmVyOjp2YWx1ZV90eXBlJiBfX3ZhbHVlKQogICAgICB7CiBj
b250YWluZXItPnB1c2hfZnJvbnQoX192YWx1ZSk7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCiAg
ICAgIGZyb250X2luc2VydF9pdGVyYXRvciYKICAgICAgb3BlcmF0b3I9KHR5cGVuYW1lIF9Db250
YWluZXI6OnZhbHVlX3R5cGUmJiBfX3ZhbHVlKQogICAgICB7CiBjb250YWluZXItPnB1c2hfZnJv
bnQoc3RkOjptb3ZlKF9fdmFsdWUpKTsKIHJldHVybiAqdGhpczsKICAgICAgfQoKCgogICAgICBm
cm9udF9pbnNlcnRfaXRlcmF0b3ImCiAgICAgIG9wZXJhdG9yKigpCiAgICAgIHsgcmV0dXJuICp0
aGlzOyB9CgoKICAgICAgZnJvbnRfaW5zZXJ0X2l0ZXJhdG9yJgogICAgICBvcGVyYXRvcisrKCkK
ICAgICAgeyByZXR1cm4gKnRoaXM7IH0KCgogICAgICBmcm9udF9pbnNlcnRfaXRlcmF0b3IKICAg
ICAgb3BlcmF0b3IrKyhpbnQpCiAgICAgIHsgcmV0dXJuICp0aGlzOyB9CiAgICB9OwojIDYwOSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9pdGVyYXRvci5oIiAzCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0NvbnRhaW5lcj4KICAgIGlubGluZSBmcm9udF9pbnNlcnRfaXRlcmF0b3I8X0Nv
bnRhaW5lcj4KICAgIGZyb250X2luc2VydGVyKF9Db250YWluZXImIF9feCkKICAgIHsgcmV0dXJu
IGZyb250X2luc2VydF9pdGVyYXRvcjxfQ29udGFpbmVyPihfX3gpOyB9CiMgNjI4ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2l0ZXJhdG9yLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfQ29udGFpbmVyPgogICAgY2xhc3MgaW5zZXJ0X2l0ZXJhdG9yCiAgICA6IHB1YmxpYyBpdGVy
YXRvcjxvdXRwdXRfaXRlcmF0b3JfdGFnLCB2b2lkLCB2b2lkLCB2b2lkLCB2b2lkPgogICAgewog
ICAgcHJvdGVjdGVkOgogICAgICBfQ29udGFpbmVyKiBjb250YWluZXI7CiAgICAgIHR5cGVuYW1l
IF9Db250YWluZXI6Oml0ZXJhdG9yIGl0ZXI7CgogICAgcHVibGljOgoKICAgICAgdHlwZWRlZiBf
Q29udGFpbmVyIGNvbnRhaW5lcl90eXBlOwoKCgoKCiAgICAgIGluc2VydF9pdGVyYXRvcihfQ29u
dGFpbmVyJiBfX3gsIHR5cGVuYW1lIF9Db250YWluZXI6Oml0ZXJhdG9yIF9faSkKICAgICAgOiBj
b250YWluZXIoc3RkOjpfX2FkZHJlc3NvZihfX3gpKSwgaXRlcihfX2kpIHt9CiMgNjc5ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2l0ZXJhdG9yLmgiIDMKICAgICAgaW5zZXJ0X2l0
ZXJhdG9yJgogICAgICBvcGVyYXRvcj0oY29uc3QgdHlwZW5hbWUgX0NvbnRhaW5lcjo6dmFsdWVf
dHlwZSYgX192YWx1ZSkKICAgICAgewogaXRlciA9IGNvbnRhaW5lci0+aW5zZXJ0KGl0ZXIsIF9f
dmFsdWUpOwogKytpdGVyOwogcmV0dXJuICp0aGlzOwogICAgICB9CgogICAgICBpbnNlcnRfaXRl
cmF0b3ImCiAgICAgIG9wZXJhdG9yPSh0eXBlbmFtZSBfQ29udGFpbmVyOjp2YWx1ZV90eXBlJiYg
X192YWx1ZSkKICAgICAgewogaXRlciA9IGNvbnRhaW5lci0+aW5zZXJ0KGl0ZXIsIHN0ZDo6bW92
ZShfX3ZhbHVlKSk7CiArK2l0ZXI7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCgoKICAgICAgaW5z
ZXJ0X2l0ZXJhdG9yJgogICAgICBvcGVyYXRvciooKQogICAgICB7IHJldHVybiAqdGhpczsgfQoK
CiAgICAgIGluc2VydF9pdGVyYXRvciYKICAgICAgb3BlcmF0b3IrKygpCiAgICAgIHsgcmV0dXJu
ICp0aGlzOyB9CgoKICAgICAgaW5zZXJ0X2l0ZXJhdG9yJgogICAgICBvcGVyYXRvcisrKGludCkK
ICAgICAgeyByZXR1cm4gKnRoaXM7IH0KICAgIH07CiMgNzIzICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvc3RsX2l0ZXJhdG9yLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ29udGFpbmVy
LCB0eXBlbmFtZSBfSXRlcmF0b3I+CiAgICBpbmxpbmUgaW5zZXJ0X2l0ZXJhdG9yPF9Db250YWlu
ZXI+CiAgICBpbnNlcnRlcihfQ29udGFpbmVyJiBfX3gsIF9JdGVyYXRvciBfX2kpCiAgICB7CiAg
ICAgIHJldHVybiBpbnNlcnRfaXRlcmF0b3I8X0NvbnRhaW5lcj4oX194LAogICAgICB0eXBlbmFt
ZSBfQ29udGFpbmVyOjppdGVyYXRvcihfX2kpKTsKICAgIH0KCgoKCn0KCm5hbWVzcGFjZSBfX2du
dV9jeHggX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKIyA3
NDcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfaXRlcmF0b3IuaCIgMwogIHVzaW5n
IHN0ZDo6aXRlcmF0b3JfdHJhaXRzOwogIHVzaW5nIHN0ZDo6aXRlcmF0b3I7CiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0l0ZXJhdG9yLCB0eXBlbmFtZSBfQ29udGFpbmVyPgogICAgY2xhc3MgX19ub3Jt
YWxfaXRlcmF0b3IKICAgIHsKICAgIHByb3RlY3RlZDoKICAgICAgX0l0ZXJhdG9yIF9NX2N1cnJl
bnQ7CgogICAgICB0eXBlZGVmIGl0ZXJhdG9yX3RyYWl0czxfSXRlcmF0b3I+IF9fdHJhaXRzX3R5
cGU7CgogICAgcHVibGljOgogICAgICB0eXBlZGVmIF9JdGVyYXRvciBpdGVyYXRvcl90eXBlOwog
ICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fdHJhaXRzX3R5cGU6Oml0ZXJhdG9yX2NhdGVnb3J5IGl0
ZXJhdG9yX2NhdGVnb3J5OwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fdHJhaXRzX3R5cGU6OnZh
bHVlX3R5cGUgdmFsdWVfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX3RyYWl0c190eXBl
OjpkaWZmZXJlbmNlX3R5cGUgZGlmZmVyZW5jZV90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1l
IF9fdHJhaXRzX3R5cGU6OnJlZmVyZW5jZSByZWZlcmVuY2U7CiAgICAgIHR5cGVkZWYgdHlwZW5h
bWUgX190cmFpdHNfdHlwZTo6cG9pbnRlciBwb2ludGVyOwoKICAgICAgY29uc3RleHByIF9fbm9y
bWFsX2l0ZXJhdG9yKCkgbm9leGNlcHQKICAgICAgOiBfTV9jdXJyZW50KF9JdGVyYXRvcigpKSB7
IH0KCiAgICAgIGV4cGxpY2l0CiAgICAgIF9fbm9ybWFsX2l0ZXJhdG9yKGNvbnN0IF9JdGVyYXRv
ciYgX19pKSBub2V4Y2VwdAogICAgICA6IF9NX2N1cnJlbnQoX19pKSB7IH0KCgogICAgICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfSXRlcj4KICAgICAgICBfX25vcm1hbF9pdGVyYXRvcihjb25zdCBfX25v
cm1hbF9pdGVyYXRvcjxfSXRlciwKICAgICB0eXBlbmFtZSBfX2VuYWJsZV9pZjwKICAgICAgICAg
ICAgICAoc3RkOjpfX2FyZV9zYW1lPF9JdGVyLCB0eXBlbmFtZSBfQ29udGFpbmVyOjpwb2ludGVy
Pjo6X192YWx1ZSksCiAgICAgICAgX0NvbnRhaW5lcj46Ol9fdHlwZT4mIF9faSkgbm9leGNlcHQK
ICAgICAgICA6IF9NX2N1cnJlbnQoX19pLmJhc2UoKSkgeyB9CgoKICAgICAgcmVmZXJlbmNlCiAg
ICAgIG9wZXJhdG9yKigpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuICpfTV9jdXJyZW50
OyB9CgogICAgICBwb2ludGVyCiAgICAgIG9wZXJhdG9yLT4oKSBjb25zdCBub2V4Y2VwdAogICAg
ICB7IHJldHVybiBfTV9jdXJyZW50OyB9CgogICAgICBfX25vcm1hbF9pdGVyYXRvciYKICAgICAg
b3BlcmF0b3IrKygpIG5vZXhjZXB0CiAgICAgIHsKICsrX01fY3VycmVudDsKIHJldHVybiAqdGhp
czsKICAgICAgfQoKICAgICAgX19ub3JtYWxfaXRlcmF0b3IKICAgICAgb3BlcmF0b3IrKyhpbnQp
IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fbm9ybWFsX2l0ZXJhdG9yKF9NX2N1cnJlbnQrKyk7
IH0KCgogICAgICBfX25vcm1hbF9pdGVyYXRvciYKICAgICAgb3BlcmF0b3ItLSgpIG5vZXhjZXB0
CiAgICAgIHsKIC0tX01fY3VycmVudDsKIHJldHVybiAqdGhpczsKICAgICAgfQoKICAgICAgX19u
b3JtYWxfaXRlcmF0b3IKICAgICAgb3BlcmF0b3ItLShpbnQpIG5vZXhjZXB0CiAgICAgIHsgcmV0
dXJuIF9fbm9ybWFsX2l0ZXJhdG9yKF9NX2N1cnJlbnQtLSk7IH0KCgogICAgICByZWZlcmVuY2UK
ICAgICAgb3BlcmF0b3JbXShkaWZmZXJlbmNlX3R5cGUgX19uKSBjb25zdCBub2V4Y2VwdAogICAg
ICB7IHJldHVybiBfTV9jdXJyZW50W19fbl07IH0KCiAgICAgIF9fbm9ybWFsX2l0ZXJhdG9yJgog
ICAgICBvcGVyYXRvcis9KGRpZmZlcmVuY2VfdHlwZSBfX24pIG5vZXhjZXB0CiAgICAgIHsgX01f
Y3VycmVudCArPSBfX247IHJldHVybiAqdGhpczsgfQoKICAgICAgX19ub3JtYWxfaXRlcmF0b3IK
ICAgICAgb3BlcmF0b3IrKGRpZmZlcmVuY2VfdHlwZSBfX24pIGNvbnN0IG5vZXhjZXB0CiAgICAg
IHsgcmV0dXJuIF9fbm9ybWFsX2l0ZXJhdG9yKF9NX2N1cnJlbnQgKyBfX24pOyB9CgogICAgICBf
X25vcm1hbF9pdGVyYXRvciYKICAgICAgb3BlcmF0b3ItPShkaWZmZXJlbmNlX3R5cGUgX19uKSBu
b2V4Y2VwdAogICAgICB7IF9NX2N1cnJlbnQgLT0gX19uOyByZXR1cm4gKnRoaXM7IH0KCiAgICAg
IF9fbm9ybWFsX2l0ZXJhdG9yCiAgICAgIG9wZXJhdG9yLShkaWZmZXJlbmNlX3R5cGUgX19uKSBj
b25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfX25vcm1hbF9pdGVyYXRvcihfTV9jdXJyZW50
IC0gX19uKTsgfQoKICAgICAgY29uc3QgX0l0ZXJhdG9yJgogICAgICBiYXNlKCkgY29uc3Qgbm9l
eGNlcHQKICAgICAgeyByZXR1cm4gX01fY3VycmVudDsgfQogICAgfTsKIyA4NDcgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfaXRlcmF0b3IuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1l
IF9JdGVyYXRvckwsIHR5cGVuYW1lIF9JdGVyYXRvclIsIHR5cGVuYW1lIF9Db250YWluZXI+CiAg
ICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I9PShjb25zdCBfX25vcm1hbF9pdGVyYXRvcjxfSXRl
cmF0b3JMLCBfQ29udGFpbmVyPiYgX19saHMsCiAgICAgICAgY29uc3QgX19ub3JtYWxfaXRlcmF0
b3I8X0l0ZXJhdG9yUiwgX0NvbnRhaW5lcj4mIF9fcmhzKQogICAgbm9leGNlcHQKICAgIHsgcmV0
dXJuIF9fbGhzLmJhc2UoKSA9PSBfX3Jocy5iYXNlKCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0l0ZXJhdG9yLCB0eXBlbmFtZSBfQ29udGFpbmVyPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJh
dG9yPT0oY29uc3QgX19ub3JtYWxfaXRlcmF0b3I8X0l0ZXJhdG9yLCBfQ29udGFpbmVyPiYgX19s
aHMsCiAgICAgICAgY29uc3QgX19ub3JtYWxfaXRlcmF0b3I8X0l0ZXJhdG9yLCBfQ29udGFpbmVy
PiYgX19yaHMpCiAgICBub2V4Y2VwdAogICAgeyByZXR1cm4gX19saHMuYmFzZSgpID09IF9fcmhz
LmJhc2UoKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3JMLCB0eXBlbmFtZSBfSXRl
cmF0b3JSLCB0eXBlbmFtZSBfQ29udGFpbmVyPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9y
IT0oY29uc3QgX19ub3JtYWxfaXRlcmF0b3I8X0l0ZXJhdG9yTCwgX0NvbnRhaW5lcj4mIF9fbGhz
LAogICAgICAgIGNvbnN0IF9fbm9ybWFsX2l0ZXJhdG9yPF9JdGVyYXRvclIsIF9Db250YWluZXI+
JiBfX3JocykKICAgIG5vZXhjZXB0CiAgICB7IHJldHVybiBfX2xocy5iYXNlKCkgIT0gX19yaHMu
YmFzZSgpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvciwgdHlwZW5hbWUgX0NvbnRh
aW5lcj4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvciE9KGNvbnN0IF9fbm9ybWFsX2l0ZXJh
dG9yPF9JdGVyYXRvciwgX0NvbnRhaW5lcj4mIF9fbGhzLAogICAgICAgIGNvbnN0IF9fbm9ybWFs
X2l0ZXJhdG9yPF9JdGVyYXRvciwgX0NvbnRhaW5lcj4mIF9fcmhzKQogICAgbm9leGNlcHQKICAg
IHsgcmV0dXJuIF9fbGhzLmJhc2UoKSAhPSBfX3Jocy5iYXNlKCk7IH0KCgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9JdGVyYXRvckwsIHR5cGVuYW1lIF9JdGVyYXRvclIsIHR5cGVuYW1lIF9Db250YWlu
ZXI+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I8KGNvbnN0IF9fbm9ybWFsX2l0ZXJhdG9y
PF9JdGVyYXRvckwsIF9Db250YWluZXI+JiBfX2xocywKICAgICAgIGNvbnN0IF9fbm9ybWFsX2l0
ZXJhdG9yPF9JdGVyYXRvclIsIF9Db250YWluZXI+JiBfX3JocykKICAgIG5vZXhjZXB0CiAgICB7
IHJldHVybiBfX2xocy5iYXNlKCkgPCBfX3Jocy5iYXNlKCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0l0ZXJhdG9yLCB0eXBlbmFtZSBfQ29udGFpbmVyPgogICAgaW5saW5lIGJvb2wKICAgIG9w
ZXJhdG9yPChjb25zdCBfX25vcm1hbF9pdGVyYXRvcjxfSXRlcmF0b3IsIF9Db250YWluZXI+JiBf
X2xocywKICAgICAgIGNvbnN0IF9fbm9ybWFsX2l0ZXJhdG9yPF9JdGVyYXRvciwgX0NvbnRhaW5l
cj4mIF9fcmhzKQogICAgbm9leGNlcHQKICAgIHsgcmV0dXJuIF9fbGhzLmJhc2UoKSA8IF9fcmhz
LmJhc2UoKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3JMLCB0eXBlbmFtZSBfSXRl
cmF0b3JSLCB0eXBlbmFtZSBfQ29udGFpbmVyPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9y
Pihjb25zdCBfX25vcm1hbF9pdGVyYXRvcjxfSXRlcmF0b3JMLCBfQ29udGFpbmVyPiYgX19saHMs
CiAgICAgICBjb25zdCBfX25vcm1hbF9pdGVyYXRvcjxfSXRlcmF0b3JSLCBfQ29udGFpbmVyPiYg
X19yaHMpCiAgICBub2V4Y2VwdAogICAgeyByZXR1cm4gX19saHMuYmFzZSgpID4gX19yaHMuYmFz
ZSgpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvciwgdHlwZW5hbWUgX0NvbnRhaW5l
cj4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj4oY29uc3QgX19ub3JtYWxfaXRlcmF0b3I8
X0l0ZXJhdG9yLCBfQ29udGFpbmVyPiYgX19saHMsCiAgICAgICBjb25zdCBfX25vcm1hbF9pdGVy
YXRvcjxfSXRlcmF0b3IsIF9Db250YWluZXI+JiBfX3JocykKICAgIG5vZXhjZXB0CiAgICB7IHJl
dHVybiBfX2xocy5iYXNlKCkgPiBfX3Jocy5iYXNlKCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0l0ZXJhdG9yTCwgdHlwZW5hbWUgX0l0ZXJhdG9yUiwgdHlwZW5hbWUgX0NvbnRhaW5lcj4KICAg
IGlubGluZSBib29sCiAgICBvcGVyYXRvcjw9KGNvbnN0IF9fbm9ybWFsX2l0ZXJhdG9yPF9JdGVy
YXRvckwsIF9Db250YWluZXI+JiBfX2xocywKICAgICAgICBjb25zdCBfX25vcm1hbF9pdGVyYXRv
cjxfSXRlcmF0b3JSLCBfQ29udGFpbmVyPiYgX19yaHMpCiAgICBub2V4Y2VwdAogICAgeyByZXR1
cm4gX19saHMuYmFzZSgpIDw9IF9fcmhzLmJhc2UoKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
SXRlcmF0b3IsIHR5cGVuYW1lIF9Db250YWluZXI+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0
b3I8PShjb25zdCBfX25vcm1hbF9pdGVyYXRvcjxfSXRlcmF0b3IsIF9Db250YWluZXI+JiBfX2xo
cywKICAgICAgICBjb25zdCBfX25vcm1hbF9pdGVyYXRvcjxfSXRlcmF0b3IsIF9Db250YWluZXI+
JiBfX3JocykKICAgIG5vZXhjZXB0CiAgICB7IHJldHVybiBfX2xocy5iYXNlKCkgPD0gX19yaHMu
YmFzZSgpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvckwsIHR5cGVuYW1lIF9JdGVy
YXRvclIsIHR5cGVuYW1lIF9Db250YWluZXI+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I+
PShjb25zdCBfX25vcm1hbF9pdGVyYXRvcjxfSXRlcmF0b3JMLCBfQ29udGFpbmVyPiYgX19saHMs
CiAgICAgICAgY29uc3QgX19ub3JtYWxfaXRlcmF0b3I8X0l0ZXJhdG9yUiwgX0NvbnRhaW5lcj4m
IF9fcmhzKQogICAgbm9leGNlcHQKICAgIHsgcmV0dXJuIF9fbGhzLmJhc2UoKSA+PSBfX3Jocy5i
YXNlKCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9yLCB0eXBlbmFtZSBfQ29udGFp
bmVyPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPj0oY29uc3QgX19ub3JtYWxfaXRlcmF0
b3I8X0l0ZXJhdG9yLCBfQ29udGFpbmVyPiYgX19saHMsCiAgICAgICAgY29uc3QgX19ub3JtYWxf
aXRlcmF0b3I8X0l0ZXJhdG9yLCBfQ29udGFpbmVyPiYgX19yaHMpCiAgICBub2V4Y2VwdAogICAg
eyByZXR1cm4gX19saHMuYmFzZSgpID49IF9fcmhzLmJhc2UoKTsgfQoKCgoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0l0ZXJhdG9yTCwgdHlwZW5hbWUgX0l0ZXJhdG9yUiwgdHlwZW5hbWUgX0NvbnRh
aW5lcj4KCgogICAgaW5saW5lIGF1dG8KICAgIG9wZXJhdG9yLShjb25zdCBfX25vcm1hbF9pdGVy
YXRvcjxfSXRlcmF0b3JMLCBfQ29udGFpbmVyPiYgX19saHMsCiAgICAgICBjb25zdCBfX25vcm1h
bF9pdGVyYXRvcjxfSXRlcmF0b3JSLCBfQ29udGFpbmVyPiYgX19yaHMpIG5vZXhjZXB0CiAgICAt
PiBkZWNsdHlwZShfX2xocy5iYXNlKCkgLSBfX3Jocy5iYXNlKCkpCgoKCgoKICAgIHsgcmV0dXJu
IF9fbGhzLmJhc2UoKSAtIF9fcmhzLmJhc2UoKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRl
cmF0b3IsIHR5cGVuYW1lIF9Db250YWluZXI+CiAgICBpbmxpbmUgdHlwZW5hbWUgX19ub3JtYWxf
aXRlcmF0b3I8X0l0ZXJhdG9yLCBfQ29udGFpbmVyPjo6ZGlmZmVyZW5jZV90eXBlCiAgICBvcGVy
YXRvci0oY29uc3QgX19ub3JtYWxfaXRlcmF0b3I8X0l0ZXJhdG9yLCBfQ29udGFpbmVyPiYgX19s
aHMsCiAgICAgICBjb25zdCBfX25vcm1hbF9pdGVyYXRvcjxfSXRlcmF0b3IsIF9Db250YWluZXI+
JiBfX3JocykKICAgIG5vZXhjZXB0CiAgICB7IHJldHVybiBfX2xocy5iYXNlKCkgLSBfX3Jocy5i
YXNlKCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9yLCB0eXBlbmFtZSBfQ29udGFp
bmVyPgogICAgaW5saW5lIF9fbm9ybWFsX2l0ZXJhdG9yPF9JdGVyYXRvciwgX0NvbnRhaW5lcj4K
ICAgIG9wZXJhdG9yKyh0eXBlbmFtZSBfX25vcm1hbF9pdGVyYXRvcjxfSXRlcmF0b3IsIF9Db250
YWluZXI+OjpkaWZmZXJlbmNlX3R5cGUKICAgICAgIF9fbiwgY29uc3QgX19ub3JtYWxfaXRlcmF0
b3I8X0l0ZXJhdG9yLCBfQ29udGFpbmVyPiYgX19pKQogICAgbm9leGNlcHQKICAgIHsgcmV0dXJu
IF9fbm9ybWFsX2l0ZXJhdG9yPF9JdGVyYXRvciwgX0NvbnRhaW5lcj4oX19pLmJhc2UoKSArIF9f
bik7IH0KCgp9CgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAo
ImRlZmF1bHQiKSkpCnsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvciwgdHlwZW5hbWUg
X0NvbnRhaW5lcj4KICAgIF9JdGVyYXRvcgogICAgX19uaXRlcl9iYXNlKF9fZ251X2N4eDo6X19u
b3JtYWxfaXRlcmF0b3I8X0l0ZXJhdG9yLCBfQ29udGFpbmVyPiBfX2l0KQogICAgeyByZXR1cm4g
X19pdC5iYXNlKCk7IH0KCgp9CgoKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlz
aWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKIyA5OTkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfaXRlcmF0b3IuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvcj4KICAg
IGNsYXNzIG1vdmVfaXRlcmF0b3IKICAgIHsKICAgIHByb3RlY3RlZDoKICAgICAgX0l0ZXJhdG9y
IF9NX2N1cnJlbnQ7CgogICAgICB0eXBlZGVmIGl0ZXJhdG9yX3RyYWl0czxfSXRlcmF0b3I+IF9f
dHJhaXRzX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX190cmFpdHNfdHlwZTo6cmVmZXJl
bmNlIF9fYmFzZV9yZWY7CgogICAgcHVibGljOgogICAgICB0eXBlZGVmIF9JdGVyYXRvciBpdGVy
YXRvcl90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fdHJhaXRzX3R5cGU6Oml0ZXJhdG9y
X2NhdGVnb3J5IGl0ZXJhdG9yX2NhdGVnb3J5OwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fdHJh
aXRzX3R5cGU6OnZhbHVlX3R5cGUgdmFsdWVfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBf
X3RyYWl0c190eXBlOjpkaWZmZXJlbmNlX3R5cGUgZGlmZmVyZW5jZV90eXBlOwoKICAgICAgdHlw
ZWRlZiBfSXRlcmF0b3IgcG9pbnRlcjsKCgogICAgICB0eXBlZGVmIHR5cGVuYW1lIGNvbmRpdGlv
bmFsPGlzX3JlZmVyZW5jZTxfX2Jhc2VfcmVmPjo6dmFsdWUsCiAgICB0eXBlbmFtZSByZW1vdmVf
cmVmZXJlbmNlPF9fYmFzZV9yZWY+Ojp0eXBlJiYsCiAgICBfX2Jhc2VfcmVmPjo6dHlwZSByZWZl
cmVuY2U7CgogICAgICBtb3ZlX2l0ZXJhdG9yKCkKICAgICAgOiBfTV9jdXJyZW50KCkgeyB9Cgog
ICAgICBleHBsaWNpdAogICAgICBtb3ZlX2l0ZXJhdG9yKGl0ZXJhdG9yX3R5cGUgX19pKQogICAg
ICA6IF9NX2N1cnJlbnQoX19pKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyPgog
bW92ZV9pdGVyYXRvcihjb25zdCBtb3ZlX2l0ZXJhdG9yPF9JdGVyPiYgX19pKQogOiBfTV9jdXJy
ZW50KF9faS5iYXNlKCkpIHsgfQoKICAgICAgaXRlcmF0b3JfdHlwZQogICAgICBiYXNlKCkgY29u
c3QKICAgICAgeyByZXR1cm4gX01fY3VycmVudDsgfQoKICAgICAgcmVmZXJlbmNlCiAgICAgIG9w
ZXJhdG9yKigpIGNvbnN0CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PHJlZmVyZW5jZT4oKl9N
X2N1cnJlbnQpOyB9CgogICAgICBwb2ludGVyCiAgICAgIG9wZXJhdG9yLT4oKSBjb25zdAogICAg
ICB7IHJldHVybiBfTV9jdXJyZW50OyB9CgogICAgICBtb3ZlX2l0ZXJhdG9yJgogICAgICBvcGVy
YXRvcisrKCkKICAgICAgewogKytfTV9jdXJyZW50OwogcmV0dXJuICp0aGlzOwogICAgICB9Cgog
ICAgICBtb3ZlX2l0ZXJhdG9yCiAgICAgIG9wZXJhdG9yKysoaW50KQogICAgICB7CiBtb3ZlX2l0
ZXJhdG9yIF9fdG1wID0gKnRoaXM7CiArK19NX2N1cnJlbnQ7CiByZXR1cm4gX190bXA7CiAgICAg
IH0KCiAgICAgIG1vdmVfaXRlcmF0b3ImCiAgICAgIG9wZXJhdG9yLS0oKQogICAgICB7CiAtLV9N
X2N1cnJlbnQ7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCiAgICAgIG1vdmVfaXRlcmF0b3IKICAg
ICAgb3BlcmF0b3ItLShpbnQpCiAgICAgIHsKIG1vdmVfaXRlcmF0b3IgX190bXAgPSAqdGhpczsK
IC0tX01fY3VycmVudDsKIHJldHVybiBfX3RtcDsKICAgICAgfQoKICAgICAgbW92ZV9pdGVyYXRv
cgogICAgICBvcGVyYXRvcisoZGlmZmVyZW5jZV90eXBlIF9fbikgY29uc3QKICAgICAgeyByZXR1
cm4gbW92ZV9pdGVyYXRvcihfTV9jdXJyZW50ICsgX19uKTsgfQoKICAgICAgbW92ZV9pdGVyYXRv
ciYKICAgICAgb3BlcmF0b3IrPShkaWZmZXJlbmNlX3R5cGUgX19uKQogICAgICB7CiBfTV9jdXJy
ZW50ICs9IF9fbjsKIHJldHVybiAqdGhpczsKICAgICAgfQoKICAgICAgbW92ZV9pdGVyYXRvcgog
ICAgICBvcGVyYXRvci0oZGlmZmVyZW5jZV90eXBlIF9fbikgY29uc3QKICAgICAgeyByZXR1cm4g
bW92ZV9pdGVyYXRvcihfTV9jdXJyZW50IC0gX19uKTsgfQoKICAgICAgbW92ZV9pdGVyYXRvciYK
ICAgICAgb3BlcmF0b3ItPShkaWZmZXJlbmNlX3R5cGUgX19uKQogICAgICB7CiBfTV9jdXJyZW50
IC09IF9fbjsKIHJldHVybiAqdGhpczsKICAgICAgfQoKICAgICAgcmVmZXJlbmNlCiAgICAgIG9w
ZXJhdG9yW10oZGlmZmVyZW5jZV90eXBlIF9fbikgY29uc3QKICAgICAgeyByZXR1cm4gc3RkOjpt
b3ZlKF9NX2N1cnJlbnRbX19uXSk7IH0KICAgIH07CgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9J
dGVyYXRvckwsIHR5cGVuYW1lIF9JdGVyYXRvclI+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0
b3I9PShjb25zdCBtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvckw+JiBfX3gsCiAgICAgICAgY29uc3Qg
bW92ZV9pdGVyYXRvcjxfSXRlcmF0b3JSPiYgX195KQogICAgeyByZXR1cm4gX194LmJhc2UoKSA9
PSBfX3kuYmFzZSgpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvcj4KICAgIGlubGlu
ZSBib29sCiAgICBvcGVyYXRvcj09KGNvbnN0IG1vdmVfaXRlcmF0b3I8X0l0ZXJhdG9yPiYgX194
LAogICAgICAgIGNvbnN0IG1vdmVfaXRlcmF0b3I8X0l0ZXJhdG9yPiYgX195KQogICAgeyByZXR1
cm4gX194LmJhc2UoKSA9PSBfX3kuYmFzZSgpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVy
YXRvckwsIHR5cGVuYW1lIF9JdGVyYXRvclI+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3Ih
PShjb25zdCBtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvckw+JiBfX3gsCiAgICAgICAgY29uc3QgbW92
ZV9pdGVyYXRvcjxfSXRlcmF0b3JSPiYgX195KQogICAgeyByZXR1cm4gIShfX3ggPT0gX195KTsg
fQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3I+CiAgICBpbmxpbmUgYm9vbAogICAgb3Bl
cmF0b3IhPShjb25zdCBtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvcj4mIF9feCwKICAgICAgICBjb25z
dCBtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvcj4mIF9feSkKICAgIHsgcmV0dXJuICEoX194ID09IF9f
eSk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9yTCwgdHlwZW5hbWUgX0l0ZXJhdG9y
Uj4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcjwoY29uc3QgbW92ZV9pdGVyYXRvcjxfSXRl
cmF0b3JMPiYgX194LAogICAgICAgY29uc3QgbW92ZV9pdGVyYXRvcjxfSXRlcmF0b3JSPiYgX195
KQogICAgeyByZXR1cm4gX194LmJhc2UoKSA8IF9feS5iYXNlKCk7IH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0l0ZXJhdG9yPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPChjb25zdCBtb3Zl
X2l0ZXJhdG9yPF9JdGVyYXRvcj4mIF9feCwKICAgICAgIGNvbnN0IG1vdmVfaXRlcmF0b3I8X0l0
ZXJhdG9yPiYgX195KQogICAgeyByZXR1cm4gX194LmJhc2UoKSA8IF9feS5iYXNlKCk7IH0KCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9yTCwgdHlwZW5hbWUgX0l0ZXJhdG9yUj4KICAgIGlu
bGluZSBib29sCiAgICBvcGVyYXRvcjw9KGNvbnN0IG1vdmVfaXRlcmF0b3I8X0l0ZXJhdG9yTD4m
IF9feCwKICAgICAgICBjb25zdCBtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvclI+JiBfX3kpCiAgICB7
IHJldHVybiAhKF9feSA8IF9feCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9yPgog
ICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPD0oY29uc3QgbW92ZV9pdGVyYXRvcjxfSXRlcmF0
b3I+JiBfX3gsCiAgICAgICAgY29uc3QgbW92ZV9pdGVyYXRvcjxfSXRlcmF0b3I+JiBfX3kpCiAg
ICB7IHJldHVybiAhKF9feSA8IF9feCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9y
TCwgdHlwZW5hbWUgX0l0ZXJhdG9yUj4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj4oY29u
c3QgbW92ZV9pdGVyYXRvcjxfSXRlcmF0b3JMPiYgX194LAogICAgICAgY29uc3QgbW92ZV9pdGVy
YXRvcjxfSXRlcmF0b3JSPiYgX195KQogICAgeyByZXR1cm4gX195IDwgX194OyB9CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9JdGVyYXRvcj4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj4oY29u
c3QgbW92ZV9pdGVyYXRvcjxfSXRlcmF0b3I+JiBfX3gsCiAgICAgICBjb25zdCBtb3ZlX2l0ZXJh
dG9yPF9JdGVyYXRvcj4mIF9feSkKICAgIHsgcmV0dXJuIF9feSA8IF9feDsgfQoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfSXRlcmF0b3JMLCB0eXBlbmFtZSBfSXRlcmF0b3JSPgogICAgaW5saW5lIGJv
b2wKICAgIG9wZXJhdG9yPj0oY29uc3QgbW92ZV9pdGVyYXRvcjxfSXRlcmF0b3JMPiYgX194LAog
ICAgICAgIGNvbnN0IG1vdmVfaXRlcmF0b3I8X0l0ZXJhdG9yUj4mIF9feSkKICAgIHsgcmV0dXJu
ICEoX194IDwgX195KTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3I+CiAgICBpbmxp
bmUgYm9vbAogICAgb3BlcmF0b3I+PShjb25zdCBtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvcj4mIF9f
eCwKICAgICAgICBjb25zdCBtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvcj4mIF9feSkKICAgIHsgcmV0
dXJuICEoX194IDwgX195KTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9yTCwgdHlw
ZW5hbWUgX0l0ZXJhdG9yUj4KICAgIGlubGluZSBhdXRvCiAgICBvcGVyYXRvci0oY29uc3QgbW92
ZV9pdGVyYXRvcjxfSXRlcmF0b3JMPiYgX194LAogICAgICAgY29uc3QgbW92ZV9pdGVyYXRvcjxf
SXRlcmF0b3JSPiYgX195KQogICAgLT4gZGVjbHR5cGUoX194LmJhc2UoKSAtIF9feS5iYXNlKCkp
CiAgICB7IHJldHVybiBfX3guYmFzZSgpIC0gX195LmJhc2UoKTsgfQoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfSXRlcmF0b3I+CiAgICBpbmxpbmUgYXV0bwogICAgb3BlcmF0b3ItKGNvbnN0IG1vdmVf
aXRlcmF0b3I8X0l0ZXJhdG9yPiYgX194LAogICAgICAgY29uc3QgbW92ZV9pdGVyYXRvcjxfSXRl
cmF0b3I+JiBfX3kpCiAgICAtPiBkZWNsdHlwZShfX3guYmFzZSgpIC0gX195LmJhc2UoKSkKICAg
IHsgcmV0dXJuIF9feC5iYXNlKCkgLSBfX3kuYmFzZSgpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9JdGVyYXRvcj4KICAgIGlubGluZSBtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvcj4KICAgIG9wZXJh
dG9yKyh0eXBlbmFtZSBtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvcj46OmRpZmZlcmVuY2VfdHlwZSBf
X24sCiAgICAgICBjb25zdCBtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvcj4mIF9feCkKICAgIHsgcmV0
dXJuIF9feCArIF9fbjsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3I+CiAgICBpbmxp
bmUgbW92ZV9pdGVyYXRvcjxfSXRlcmF0b3I+CiAgICBtYWtlX21vdmVfaXRlcmF0b3IoX0l0ZXJh
dG9yIF9faSkKICAgIHsgcmV0dXJuIG1vdmVfaXRlcmF0b3I8X0l0ZXJhdG9yPihfX2kpOyB9Cgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvciwgdHlwZW5hbWUgX1JldHVyblR5cGUKICAgID0g
dHlwZW5hbWUgY29uZGl0aW9uYWw8X19tb3ZlX2lmX25vZXhjZXB0X2NvbmQKICAgICAgPHR5cGVu
YW1lIGl0ZXJhdG9yX3RyYWl0czxfSXRlcmF0b3I+Ojp2YWx1ZV90eXBlPjo6dmFsdWUsCiAgICAg
ICAgICAgICAgICBfSXRlcmF0b3IsIG1vdmVfaXRlcmF0b3I8X0l0ZXJhdG9yPj46OnR5cGU+CiAg
ICBpbmxpbmUgX1JldHVyblR5cGUKICAgIF9fbWFrZV9tb3ZlX2lmX25vZXhjZXB0X2l0ZXJhdG9y
KF9JdGVyYXRvciBfX2kpCiAgICB7IHJldHVybiBfUmV0dXJuVHlwZShfX2kpOyB9CgoKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfUmV0dXJuVHlwZQogICAgPSB0eXBlbmFtZSBj
b25kaXRpb25hbDxfX21vdmVfaWZfbm9leGNlcHRfY29uZDxfVHA+Ojp2YWx1ZSwKICAgICAgY29u
c3QgX1RwKiwgbW92ZV9pdGVyYXRvcjxfVHAqPj46OnR5cGU+CiAgICBpbmxpbmUgX1JldHVyblR5
cGUKICAgIF9fbWFrZV9tb3ZlX2lmX25vZXhjZXB0X2l0ZXJhdG9yKF9UcCogX19pKQogICAgeyBy
ZXR1cm4gX1JldHVyblR5cGUoX19pKTsgfQoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRv
cj4KICAgIGF1dG8KICAgIF9fbml0ZXJfYmFzZShtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvcj4gX19p
dCkKICAgIC0+IGRlY2x0eXBlKG1ha2VfbW92ZV9pdGVyYXRvcihfX25pdGVyX2Jhc2UoX19pdC5i
YXNlKCkpKSkKICAgIHsgcmV0dXJuIG1ha2VfbW92ZV9pdGVyYXRvcihfX25pdGVyX2Jhc2UoX19p
dC5iYXNlKCkpKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3I+CiAgICBzdHJ1Y3Qg
X19pc19tb3ZlX2l0ZXJhdG9yPG1vdmVfaXRlcmF0b3I8X0l0ZXJhdG9yPiA+CiAgICB7CiAgICAg
IGVudW0geyBfX3ZhbHVlID0gMSB9OwogICAgICB0eXBlZGVmIF9fdHJ1ZV90eXBlIF9fdHlwZTsK
ICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvcj4KICAgIGF1dG8KICAgIF9fbWl0
ZXJfYmFzZShtb3ZlX2l0ZXJhdG9yPF9JdGVyYXRvcj4gX19pdCkKICAgIC0+IGRlY2x0eXBlKF9f
bWl0ZXJfYmFzZShfX2l0LmJhc2UoKSkpCiAgICB7IHJldHVybiBfX21pdGVyX2Jhc2UoX19pdC5i
YXNlKCkpOyB9CgoKfQojIDY4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ29i
YXNlLmgiIDIgMwoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2RlYnVnL2RlYnVnLmgiIDEg
MwojIDQ4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2RlYnVnL2RlYnVnLmgiIDMKbmFtZXNwYWNl
IHN0ZAp7CiAgbmFtZXNwYWNlIF9fZGVidWcgeyB9Cn0KCgoKCm5hbWVzcGFjZSBfX2dudV9kZWJ1
Zwp7CiAgdXNpbmcgbmFtZXNwYWNlIHN0ZDo6X19kZWJ1ZzsKfQojIDcwICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RsX2FsZ29iYXNlLmgiIDIgMwoKIyAxICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvcHJlZGVmaW5lZF9vcHMuaCIgMSAzCiMgMzMgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9wcmVkZWZpbmVkX29wcy5oIiAzCm5hbWVzcGFjZSBfX2dudV9jeHgKewpuYW1l
c3BhY2UgX19vcHMKewogIHN0cnVjdCBfSXRlcl9sZXNzX2l0ZXIKICB7CiAgICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfSXRlcmF0b3IxLCB0eXBlbmFtZSBfSXRlcmF0b3IyPgogICAgIAogICAgICBib29s
CiAgICAgIG9wZXJhdG9yKCkoX0l0ZXJhdG9yMSBfX2l0MSwgX0l0ZXJhdG9yMiBfX2l0MikgY29u
c3QKICAgICAgeyByZXR1cm4gKl9faXQxIDwgKl9faXQyOyB9CiAgfTsKIAogIGlubGluZSBfSXRl
cl9sZXNzX2l0ZXIKICBfX2l0ZXJfbGVzc19pdGVyKCkKICB7IHJldHVybiBfSXRlcl9sZXNzX2l0
ZXIoKTsgfQoKICBzdHJ1Y3QgX0l0ZXJfbGVzc192YWwKICB7CiAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfSXRlcmF0b3IsIHR5cGVuYW1lIF9WYWx1ZT4KICAgICAgYm9vbAogICAgICBvcGVyYXRvcigp
KF9JdGVyYXRvciBfX2l0LCBfVmFsdWUmIF9fdmFsKSBjb25zdAogICAgICB7IHJldHVybiAqX19p
dCA8IF9fdmFsOyB9CiAgICB9OwoKICBpbmxpbmUgX0l0ZXJfbGVzc192YWwKICBfX2l0ZXJfbGVz
c192YWwoKQogIHsgcmV0dXJuIF9JdGVyX2xlc3NfdmFsKCk7IH0KCiAgaW5saW5lIF9JdGVyX2xl
c3NfdmFsCiAgX19pdGVyX2NvbXBfdmFsKF9JdGVyX2xlc3NfaXRlcikKICB7IHJldHVybiBfSXRl
cl9sZXNzX3ZhbCgpOyB9CgogIHN0cnVjdCBfVmFsX2xlc3NfaXRlcgogIHsKICAgIHRlbXBsYXRl
PHR5cGVuYW1lIF9WYWx1ZSwgdHlwZW5hbWUgX0l0ZXJhdG9yPgogICAgICBib29sCiAgICAgIG9w
ZXJhdG9yKCkoX1ZhbHVlJiBfX3ZhbCwgX0l0ZXJhdG9yIF9faXQpIGNvbnN0CiAgICAgIHsgcmV0
dXJuIF9fdmFsIDwgKl9faXQ7IH0KICAgIH07CgogIGlubGluZSBfVmFsX2xlc3NfaXRlcgogIF9f
dmFsX2xlc3NfaXRlcigpCiAgeyByZXR1cm4gX1ZhbF9sZXNzX2l0ZXIoKTsgfQoKICBpbmxpbmUg
X1ZhbF9sZXNzX2l0ZXIKICBfX3ZhbF9jb21wX2l0ZXIoX0l0ZXJfbGVzc19pdGVyKQogIHsgcmV0
dXJuIF9WYWxfbGVzc19pdGVyKCk7IH0KCiAgc3RydWN0IF9JdGVyX2VxdWFsX3RvX2l0ZXIKICB7
CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3IxLCB0eXBlbmFtZSBfSXRlcmF0b3IyPgog
ICAgICBib29sCiAgICAgIG9wZXJhdG9yKCkoX0l0ZXJhdG9yMSBfX2l0MSwgX0l0ZXJhdG9yMiBf
X2l0MikgY29uc3QKICAgICAgeyByZXR1cm4gKl9faXQxID09ICpfX2l0MjsgfQogICAgfTsKCiAg
aW5saW5lIF9JdGVyX2VxdWFsX3RvX2l0ZXIKICBfX2l0ZXJfZXF1YWxfdG9faXRlcigpCiAgeyBy
ZXR1cm4gX0l0ZXJfZXF1YWxfdG9faXRlcigpOyB9CgogIHN0cnVjdCBfSXRlcl9lcXVhbF90b192
YWwKICB7CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3IsIHR5cGVuYW1lIF9WYWx1ZT4K
ICAgICAgYm9vbAogICAgICBvcGVyYXRvcigpKF9JdGVyYXRvciBfX2l0LCBfVmFsdWUmIF9fdmFs
KSBjb25zdAogICAgICB7IHJldHVybiAqX19pdCA9PSBfX3ZhbDsgfQogICAgfTsKCiAgaW5saW5l
IF9JdGVyX2VxdWFsX3RvX3ZhbAogIF9faXRlcl9lcXVhbF90b192YWwoKQogIHsgcmV0dXJuIF9J
dGVyX2VxdWFsX3RvX3ZhbCgpOyB9CgogIGlubGluZSBfSXRlcl9lcXVhbF90b192YWwKICBfX2l0
ZXJfY29tcF92YWwoX0l0ZXJfZXF1YWxfdG9faXRlcikKICB7IHJldHVybiBfSXRlcl9lcXVhbF90
b192YWwoKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ29tcGFyZT4KICAgIHN0cnVjdCBfSXRl
cl9jb21wX2l0ZXIKICAgIHsKICAgICAgX0NvbXBhcmUgX01fY29tcDsKICAgICAKICAgICAgX0l0
ZXJfY29tcF9pdGVyKF9Db21wYXJlIF9fY29tcCkKIDogX01fY29tcChfX2NvbXApCiAgICAgIHsg
fQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9yMSwgdHlwZW5hbWUgX0l0ZXJhdG9y
Mj4KICAgICAgIAogICAgICAgIGJvb2wKICAgICAgICBvcGVyYXRvcigpKF9JdGVyYXRvcjEgX19p
dDEsIF9JdGVyYXRvcjIgX19pdDIpCiAgICAgICAgeyByZXR1cm4gYm9vbChfTV9jb21wKCpfX2l0
MSwgKl9faXQyKSk7IH0KICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Db21wYXJlPgogICAK
ICAgIGlubGluZSBfSXRlcl9jb21wX2l0ZXI8X0NvbXBhcmU+CiAgICBfX2l0ZXJfY29tcF9pdGVy
KF9Db21wYXJlIF9fY29tcCkKICAgIHsgcmV0dXJuIF9JdGVyX2NvbXBfaXRlcjxfQ29tcGFyZT4o
X19jb21wKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ29tcGFyZT4KICAgIHN0cnVjdCBfSXRl
cl9jb21wX3ZhbAogICAgewogICAgICBfQ29tcGFyZSBfTV9jb21wOwoKICAgICAgX0l0ZXJfY29t
cF92YWwoX0NvbXBhcmUgX19jb21wKQogOiBfTV9jb21wKF9fY29tcCkKICAgICAgeyB9CgogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3IsIHR5cGVuYW1lIF9WYWx1ZT4KIGJvb2wKIG9w
ZXJhdG9yKCkoX0l0ZXJhdG9yIF9faXQsIF9WYWx1ZSYgX192YWwpCiB7IHJldHVybiBib29sKF9N
X2NvbXAoKl9faXQsIF9fdmFsKSk7IH0KICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Db21w
YXJlPgogICBpbmxpbmUgX0l0ZXJfY29tcF92YWw8X0NvbXBhcmU+CiAgICBfX2l0ZXJfY29tcF92
YWwoX0NvbXBhcmUgX19jb21wKQogICAgeyByZXR1cm4gX0l0ZXJfY29tcF92YWw8X0NvbXBhcmU+
KF9fY29tcCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NvbXBhcmU+CiAgICBpbmxpbmUgX0l0
ZXJfY29tcF92YWw8X0NvbXBhcmU+CiAgICBfX2l0ZXJfY29tcF92YWwoX0l0ZXJfY29tcF9pdGVy
PF9Db21wYXJlPiBfX2NvbXApCiAgICB7IHJldHVybiBfSXRlcl9jb21wX3ZhbDxfQ29tcGFyZT4o
X19jb21wLl9NX2NvbXApOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Db21wYXJlPgogICAgc3Ry
dWN0IF9WYWxfY29tcF9pdGVyCiAgICB7CiAgICAgIF9Db21wYXJlIF9NX2NvbXA7CgogICAgICBf
VmFsX2NvbXBfaXRlcihfQ29tcGFyZSBfX2NvbXApCiA6IF9NX2NvbXAoX19jb21wKQogICAgICB7
IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9WYWx1ZSwgdHlwZW5hbWUgX0l0ZXJhdG9yPgog
Ym9vbAogb3BlcmF0b3IoKShfVmFsdWUmIF9fdmFsLCBfSXRlcmF0b3IgX19pdCkKIHsgcmV0dXJu
IGJvb2woX01fY29tcChfX3ZhbCwgKl9faXQpKTsgfQogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0NvbXBhcmU+CiAgICBpbmxpbmUgX1ZhbF9jb21wX2l0ZXI8X0NvbXBhcmU+CiAgICBfX3Zh
bF9jb21wX2l0ZXIoX0NvbXBhcmUgX19jb21wKQogICAgeyByZXR1cm4gX1ZhbF9jb21wX2l0ZXI8
X0NvbXBhcmU+KF9fY29tcCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NvbXBhcmU+CiAgICBp
bmxpbmUgX1ZhbF9jb21wX2l0ZXI8X0NvbXBhcmU+CiAgICBfX3ZhbF9jb21wX2l0ZXIoX0l0ZXJf
Y29tcF9pdGVyPF9Db21wYXJlPiBfX2NvbXApCiAgICB7IHJldHVybiBfVmFsX2NvbXBfaXRlcjxf
Q29tcGFyZT4oX19jb21wLl9NX2NvbXApOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9WYWx1ZT4K
ICAgIHN0cnVjdCBfSXRlcl9lcXVhbHNfdmFsCiAgICB7CiAgICAgIF9WYWx1ZSYgX01fdmFsdWU7
CgogICAgICBfSXRlcl9lcXVhbHNfdmFsKF9WYWx1ZSYgX192YWx1ZSkKIDogX01fdmFsdWUoX192
YWx1ZSkKICAgICAgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3I+CiBib29s
CiBvcGVyYXRvcigpKF9JdGVyYXRvciBfX2l0KQogeyByZXR1cm4gKl9faXQgPT0gX01fdmFsdWU7
IH0KICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9WYWx1ZT4KICAgIGlubGluZSBfSXRlcl9l
cXVhbHNfdmFsPF9WYWx1ZT4KICAgIF9faXRlcl9lcXVhbHNfdmFsKF9WYWx1ZSYgX192YWwpCiAg
ICB7IHJldHVybiBfSXRlcl9lcXVhbHNfdmFsPF9WYWx1ZT4oX192YWwpOyB9CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9JdGVyYXRvcjE+CiAgICBzdHJ1Y3QgX0l0ZXJfZXF1YWxzX2l0ZXIKICAgIHsK
ICAgICAgdHlwZW5hbWUgc3RkOjppdGVyYXRvcl90cmFpdHM8X0l0ZXJhdG9yMT46OnJlZmVyZW5j
ZSBfTV9yZWY7CgogICAgICBfSXRlcl9lcXVhbHNfaXRlcihfSXRlcmF0b3IxIF9faXQxKQogOiBf
TV9yZWYoKl9faXQxKQogICAgICB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRv
cjI+CiBib29sCiBvcGVyYXRvcigpKF9JdGVyYXRvcjIgX19pdDIpCiB7IHJldHVybiAqX19pdDIg
PT0gX01fcmVmOyB9CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3I+CiAgICBp
bmxpbmUgX0l0ZXJfZXF1YWxzX2l0ZXI8X0l0ZXJhdG9yPgogICAgX19pdGVyX2NvbXBfaXRlcihf
SXRlcl9lcXVhbF90b19pdGVyLCBfSXRlcmF0b3IgX19pdCkKICAgIHsgcmV0dXJuIF9JdGVyX2Vx
dWFsc19pdGVyPF9JdGVyYXRvcj4oX19pdCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1ByZWRp
Y2F0ZT4KICAgIHN0cnVjdCBfSXRlcl9wcmVkCiAgICB7CiAgICAgIF9QcmVkaWNhdGUgX01fcHJl
ZDsKCiAgICAgIF9JdGVyX3ByZWQoX1ByZWRpY2F0ZSBfX3ByZWQpCiA6IF9NX3ByZWQoX19wcmVk
KQogICAgICB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvcj4KIGJvb2wKIG9w
ZXJhdG9yKCkoX0l0ZXJhdG9yIF9faXQpCiB7IHJldHVybiBib29sKF9NX3ByZWQoKl9faXQpKTsg
fQogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1ByZWRpY2F0ZT4KICAgIGlubGluZSBfSXRl
cl9wcmVkPF9QcmVkaWNhdGU+CiAgICBfX3ByZWRfaXRlcihfUHJlZGljYXRlIF9fcHJlZCkKICAg
IHsgcmV0dXJuIF9JdGVyX3ByZWQ8X1ByZWRpY2F0ZT4oX19wcmVkKTsgfQoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX1ZhbHVlPgogICAgc3RydWN0IF9JdGVyX2NvbXBf
dG9fdmFsCiAgICB7CiAgICAgIF9Db21wYXJlIF9NX2NvbXA7CiAgICAgIF9WYWx1ZSYgX01fdmFs
dWU7CgogICAgICBfSXRlcl9jb21wX3RvX3ZhbChfQ29tcGFyZSBfX2NvbXAsIF9WYWx1ZSYgX192
YWx1ZSkKIDogX01fY29tcChfX2NvbXApLCBfTV92YWx1ZShfX3ZhbHVlKQogICAgICB7IH0KCiAg
ICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JdGVyYXRvcj4KIGJvb2wKIG9wZXJhdG9yKCkoX0l0ZXJh
dG9yIF9faXQpCiB7IHJldHVybiBib29sKF9NX2NvbXAoKl9faXQsIF9NX3ZhbHVlKSk7IH0KICAg
IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfVmFsdWU+CiAgICBf
SXRlcl9jb21wX3RvX3ZhbDxfQ29tcGFyZSwgX1ZhbHVlPgogICAgX19pdGVyX2NvbXBfdmFsKF9D
b21wYXJlIF9fY29tcCwgX1ZhbHVlICZfX3ZhbCkKICAgIHsgcmV0dXJuIF9JdGVyX2NvbXBfdG9f
dmFsPF9Db21wYXJlLCBfVmFsdWU+KF9fY29tcCwgX192YWwpOyB9CgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfSXRlcmF0b3IxPgogICAgc3RydWN0IF9JdGVyX2NvbXBf
dG9faXRlcgogICAgewogICAgICBfQ29tcGFyZSBfTV9jb21wOwogICAgICB0eXBlbmFtZSBzdGQ6
Oml0ZXJhdG9yX3RyYWl0czxfSXRlcmF0b3IxPjo6cmVmZXJlbmNlIF9NX3JlZjsKCiAgICAgIF9J
dGVyX2NvbXBfdG9faXRlcihfQ29tcGFyZSBfX2NvbXAsIF9JdGVyYXRvcjEgX19pdDEpCiA6IF9N
X2NvbXAoX19jb21wKSwgX01fcmVmKCpfX2l0MSkKICAgICAgeyB9CgogICAgICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfSXRlcmF0b3IyPgogYm9vbAogb3BlcmF0b3IoKShfSXRlcmF0b3IyIF9faXQyKQog
eyByZXR1cm4gYm9vbChfTV9jb21wKCpfX2l0MiwgX01fcmVmKSk7IH0KICAgIH07CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfSXRlcmF0b3I+CiAgICBpbmxpbmUgX0l0
ZXJfY29tcF90b19pdGVyPF9Db21wYXJlLCBfSXRlcmF0b3I+CiAgICBfX2l0ZXJfY29tcF9pdGVy
KF9JdGVyX2NvbXBfaXRlcjxfQ29tcGFyZT4gX19jb21wLCBfSXRlcmF0b3IgX19pdCkKICAgIHsg
cmV0dXJuIF9JdGVyX2NvbXBfdG9faXRlcjxfQ29tcGFyZSwgX0l0ZXJhdG9yPihfX2NvbXAuX01f
Y29tcCwgX19pdCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1ByZWRpY2F0ZT4KICAgIHN0cnVj
dCBfSXRlcl9uZWdhdGUKICAgIHsKICAgICAgX1ByZWRpY2F0ZSBfTV9wcmVkOwoKICAgICAgX0l0
ZXJfbmVnYXRlKF9QcmVkaWNhdGUgX19wcmVkKQogOiBfTV9wcmVkKF9fcHJlZCkKICAgICAgeyB9
CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3I+CiBib29sCiBvcGVyYXRvcigpKF9J
dGVyYXRvciBfX2l0KQogeyByZXR1cm4gIWJvb2woX01fcHJlZCgqX19pdCkpOyB9CiAgICB9OwoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUHJlZGljYXRlPgogICAgaW5saW5lIF9JdGVyX25lZ2F0ZTxf
UHJlZGljYXRlPgogICAgX19uZWdhdGUoX0l0ZXJfcHJlZDxfUHJlZGljYXRlPiBfX3ByZWQpCiAg
ICB7IHJldHVybiBfSXRlcl9uZWdhdGU8X1ByZWRpY2F0ZT4oX19wcmVkLl9NX3ByZWQpOyB9Cgp9
Cn0KIyA3MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvYmFzZS5oIiAyIDMK
Cm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIp
KSkKewoKIyAxMTggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnb2Jhc2UuaCIg
MwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IxLCB0eXBlbmFtZSBfRm9yd2Fy
ZEl0ZXJhdG9yMj4KICAgIGlubGluZSB2b2lkCiAgICBpdGVyX3N3YXAoX0ZvcndhcmRJdGVyYXRv
cjEgX19hLCBfRm9yd2FyZEl0ZXJhdG9yMiBfX2IpCiAgICB7CgogICAgIAoKICAgICAKIyAxNDgg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnb2Jhc2UuaCIgMwogICAgICBzd2Fw
KCpfX2EsICpfX2IpOwoKICAgIH0KIyAxNjQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9z
dGxfYWxnb2Jhc2UuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IxLCB0
eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yMj4KICAgIF9Gb3J3YXJkSXRlcmF0b3IyCiAgICBzd2Fw
X3JhbmdlcyhfRm9yd2FyZEl0ZXJhdG9yMSBfX2ZpcnN0MSwgX0ZvcndhcmRJdGVyYXRvcjEgX19s
YXN0MSwKICBfRm9yd2FyZEl0ZXJhdG9yMiBfX2ZpcnN0MikKICAgIHsKCiAgICAgCgogICAgIAoK
ICAgICAgOwoKICAgICAgZm9yICg7IF9fZmlyc3QxICE9IF9fbGFzdDE7ICsrX19maXJzdDEsICh2
b2lkKSsrX19maXJzdDIpCiBzdGQ6Oml0ZXJfc3dhcChfX2ZpcnN0MSwgX19maXJzdDIpOwogICAg
ICByZXR1cm4gX19maXJzdDI7CiAgICB9CiMgMTkyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX2FsZ29iYXNlLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgIAogICAgaW5s
aW5lIGNvbnN0IF9UcCYKICAgIG1pbihjb25zdCBfVHAmIF9fYSwgY29uc3QgX1RwJiBfX2IpCiAg
ICB7CgogICAgIAoKICAgICAgaWYgKF9fYiA8IF9fYSkKIHJldHVybiBfX2I7CiAgICAgIHJldHVy
biBfX2E7CiAgICB9CiMgMjE2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ29i
YXNlLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgIAogICAgaW5saW5lIGNvbnN0IF9U
cCYKICAgIG1heChjb25zdCBfVHAmIF9fYSwgY29uc3QgX1RwJiBfX2IpCiAgICB7CgogICAgIAoK
ICAgICAgaWYgKF9fYSA8IF9fYikKIHJldHVybiBfX2I7CiAgICAgIHJldHVybiBfX2E7CiAgICB9
CiMgMjQwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ29iYXNlLmgiIDMKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9Db21wYXJlPgogICAKICAgIGlubGluZSBj
b25zdCBfVHAmCiAgICBtaW4oY29uc3QgX1RwJiBfX2EsIGNvbnN0IF9UcCYgX19iLCBfQ29tcGFy
ZSBfX2NvbXApCiAgICB7CgogICAgICBpZiAoX19jb21wKF9fYiwgX19hKSkKIHJldHVybiBfX2I7
CiAgICAgIHJldHVybiBfX2E7CiAgICB9CiMgMjYyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX2FsZ29iYXNlLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9D
b21wYXJlPgogICAKICAgIGlubGluZSBjb25zdCBfVHAmCiAgICBtYXgoY29uc3QgX1RwJiBfX2Es
IGNvbnN0IF9UcCYgX19iLCBfQ29tcGFyZSBfX2NvbXApCiAgICB7CgogICAgICBpZiAoX19jb21w
KF9fYSwgX19iKSkKIHJldHVybiBfX2I7CiAgICAgIHJldHVybiBfX2E7CiAgICB9CgoKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9yPgogICAgaW5saW5lIF9JdGVyYXRvcgogICAgX19uaXRl
cl9iYXNlKF9JdGVyYXRvciBfX2l0KQogICAgeyByZXR1cm4gX19pdDsgfQoKCgoKCgoKICB0ZW1w
bGF0ZTxib29sLCBib29sLCB0eXBlbmFtZT4KICAgIHN0cnVjdCBfX2NvcHlfbW92ZQogICAgewog
ICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUksIHR5cGVuYW1lIF9PST4KICAgICAgICBzdGF0aWMg
X09JCiAgICAgICAgX19jb3B5X20oX0lJIF9fZmlyc3QsIF9JSSBfX2xhc3QsIF9PSSBfX3Jlc3Vs
dCkKICAgICAgICB7CiAgIGZvciAoOyBfX2ZpcnN0ICE9IF9fbGFzdDsgKytfX3Jlc3VsdCwgKHZv
aWQpKytfX2ZpcnN0KQogICAgICpfX3Jlc3VsdCA9ICpfX2ZpcnN0OwogICByZXR1cm4gX19yZXN1
bHQ7CiB9CiAgICB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NhdGVnb3J5PgogICAgc3RydWN0
IF9fY29weV9tb3ZlPHRydWUsIGZhbHNlLCBfQ2F0ZWdvcnk+CiAgICB7CiAgICAgIHRlbXBsYXRl
PHR5cGVuYW1lIF9JSSwgdHlwZW5hbWUgX09JPgogICAgICAgIHN0YXRpYyBfT0kKICAgICAgICBf
X2NvcHlfbShfSUkgX19maXJzdCwgX0lJIF9fbGFzdCwgX09JIF9fcmVzdWx0KQogICAgICAgIHsK
ICAgZm9yICg7IF9fZmlyc3QgIT0gX19sYXN0OyArK19fcmVzdWx0LCAodm9pZCkrK19fZmlyc3Qp
CiAgICAgKl9fcmVzdWx0ID0gc3RkOjptb3ZlKCpfX2ZpcnN0KTsKICAgcmV0dXJuIF9fcmVzdWx0
OwogfQogICAgfTsKCgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2NvcHlfbW92ZTxmYWxzZSwg
ZmFsc2UsIHJhbmRvbV9hY2Nlc3NfaXRlcmF0b3JfdGFnPgogICAgewogICAgICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfSUksIHR5cGVuYW1lIF9PST4KICAgICAgICBzdGF0aWMgX09JCiAgICAgICAgX19j
b3B5X20oX0lJIF9fZmlyc3QsIF9JSSBfX2xhc3QsIF9PSSBfX3Jlc3VsdCkKICAgICAgICB7CiAg
IHR5cGVkZWYgdHlwZW5hbWUgaXRlcmF0b3JfdHJhaXRzPF9JST46OmRpZmZlcmVuY2VfdHlwZSBf
RGlzdGFuY2U7CiAgIGZvcihfRGlzdGFuY2UgX19uID0gX19sYXN0IC0gX19maXJzdDsgX19uID4g
MDsgLS1fX24pCiAgICAgewogICAgICAgKl9fcmVzdWx0ID0gKl9fZmlyc3Q7CiAgICAgICArK19f
Zmlyc3Q7CiAgICAgICArK19fcmVzdWx0OwogICAgIH0KICAgcmV0dXJuIF9fcmVzdWx0OwogfQog
ICAgfTsKCgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2NvcHlfbW92ZTx0cnVlLCBmYWxzZSwg
cmFuZG9tX2FjY2Vzc19pdGVyYXRvcl90YWc+CiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9JSSwgdHlwZW5hbWUgX09JPgogICAgICAgIHN0YXRpYyBfT0kKICAgICAgICBfX2NvcHlfbShf
SUkgX19maXJzdCwgX0lJIF9fbGFzdCwgX09JIF9fcmVzdWx0KQogICAgICAgIHsKICAgdHlwZWRl
ZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0lJPjo6ZGlmZmVyZW5jZV90eXBlIF9EaXN0YW5j
ZTsKICAgZm9yKF9EaXN0YW5jZSBfX24gPSBfX2xhc3QgLSBfX2ZpcnN0OyBfX24gPiAwOyAtLV9f
bikKICAgICB7CiAgICAgICAqX19yZXN1bHQgPSBzdGQ6Om1vdmUoKl9fZmlyc3QpOwogICAgICAg
KytfX2ZpcnN0OwogICAgICAgKytfX3Jlc3VsdDsKICAgICB9CiAgIHJldHVybiBfX3Jlc3VsdDsK
IH0KICAgIH07CgoKICB0ZW1wbGF0ZTxib29sIF9Jc01vdmU+CiAgICBzdHJ1Y3QgX19jb3B5X21v
dmU8X0lzTW92ZSwgdHJ1ZSwgcmFuZG9tX2FjY2Vzc19pdGVyYXRvcl90YWc+CiAgICB7CiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgICAgICBzdGF0aWMgX1RwKgogICAgICAgIF9fY29w
eV9tKGNvbnN0IF9UcCogX19maXJzdCwgY29uc3QgX1RwKiBfX2xhc3QsIF9UcCogX19yZXN1bHQp
CiAgICAgICAgewoKICAgdXNpbmcgX19hc3NpZ25hYmxlID0gY29uZGl0aW9uYWw8X0lzTW92ZSwK
ICAgICAgICBpc19tb3ZlX2Fzc2lnbmFibGU8X1RwPiwKICAgICAgICBpc19jb3B5X2Fzc2lnbmFi
bGU8X1RwPj47CgogICBzdGF0aWNfYXNzZXJ0KCBfX2Fzc2lnbmFibGU6OnR5cGU6OnZhbHVlLCAi
dHlwZSBpcyBub3QgYXNzaWduYWJsZSIgKTsKCiAgIGNvbnN0IHB0cmRpZmZfdCBfTnVtID0gX19s
YXN0IC0gX19maXJzdDsKICAgaWYgKF9OdW0pCiAgICAgX19idWlsdGluX21lbW1vdmUoX19yZXN1
bHQsIF9fZmlyc3QsIHNpemVvZihfVHApICogX051bSk7CiAgIHJldHVybiBfX3Jlc3VsdCArIF9O
dW07CiB9CiAgICB9OwoKICB0ZW1wbGF0ZTxib29sIF9Jc01vdmUsIHR5cGVuYW1lIF9JSSwgdHlw
ZW5hbWUgX09JPgogICAgaW5saW5lIF9PSQogICAgX19jb3B5X21vdmVfYShfSUkgX19maXJzdCwg
X0lJIF9fbGFzdCwgX09JIF9fcmVzdWx0KQogICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIGl0
ZXJhdG9yX3RyYWl0czxfSUk+Ojp2YWx1ZV90eXBlIF9WYWx1ZVR5cGVJOwogICAgICB0eXBlZGVm
IHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfT0k+Ojp2YWx1ZV90eXBlIF9WYWx1ZVR5cGVPOwog
ICAgICB0eXBlZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfSUk+OjppdGVyYXRvcl9jYXRl
Z29yeSBfQ2F0ZWdvcnk7CiAgICAgIGNvbnN0IGJvb2wgX19zaW1wbGUgPSAoX19pc190cml2aWFs
KF9WYWx1ZVR5cGVJKQogICAgICAgICAgICAgICAgICAgICAgJiYgX19pc19wb2ludGVyPF9JST46
Ol9fdmFsdWUKICAgICAgICAgICAgICAgICAgICAgICYmIF9faXNfcG9pbnRlcjxfT0k+OjpfX3Zh
bHVlCiAgICAgICAgJiYgX19hcmVfc2FtZTxfVmFsdWVUeXBlSSwgX1ZhbHVlVHlwZU8+OjpfX3Zh
bHVlKTsKCiAgICAgIHJldHVybiBzdGQ6Ol9fY29weV9tb3ZlPF9Jc01vdmUsIF9fc2ltcGxlLAog
ICAgICAgICAgICAgICAgICAgICAgIF9DYXRlZ29yeT46Ol9fY29weV9tKF9fZmlyc3QsIF9fbGFz
dCwgX19yZXN1bHQpOwogICAgfQoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIHN0
cnVjdCBjaGFyX3RyYWl0czsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBf
VHJhaXRzPgogICAgY2xhc3MgaXN0cmVhbWJ1Zl9pdGVyYXRvcjsKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgY2xhc3Mgb3N0cmVhbWJ1Zl9pdGVyYXRv
cjsKCiAgdGVtcGxhdGU8Ym9vbCBfSXNNb3ZlLCB0eXBlbmFtZSBfQ2hhclQ+CiAgICB0eXBlbmFt
ZSBfX2dudV9jeHg6Ol9fZW5hYmxlX2lmPF9faXNfY2hhcjxfQ2hhclQ+OjpfX3ZhbHVlLAogICAg
ICBvc3RyZWFtYnVmX2l0ZXJhdG9yPF9DaGFyVCwgY2hhcl90cmFpdHM8X0NoYXJUPiA+ID46Ol9f
dHlwZQogICAgX19jb3B5X21vdmVfYTIoX0NoYXJUKiwgX0NoYXJUKiwKICAgICBvc3RyZWFtYnVm
X2l0ZXJhdG9yPF9DaGFyVCwgY2hhcl90cmFpdHM8X0NoYXJUPiA+KTsKCiAgdGVtcGxhdGU8Ym9v
bCBfSXNNb3ZlLCB0eXBlbmFtZSBfQ2hhclQ+CiAgICB0eXBlbmFtZSBfX2dudV9jeHg6Ol9fZW5h
YmxlX2lmPF9faXNfY2hhcjxfQ2hhclQ+OjpfX3ZhbHVlLAogICAgICBvc3RyZWFtYnVmX2l0ZXJh
dG9yPF9DaGFyVCwgY2hhcl90cmFpdHM8X0NoYXJUPiA+ID46Ol9fdHlwZQogICAgX19jb3B5X21v
dmVfYTIoY29uc3QgX0NoYXJUKiwgY29uc3QgX0NoYXJUKiwKICAgICBvc3RyZWFtYnVmX2l0ZXJh
dG9yPF9DaGFyVCwgY2hhcl90cmFpdHM8X0NoYXJUPiA+KTsKCiAgdGVtcGxhdGU8Ym9vbCBfSXNN
b3ZlLCB0eXBlbmFtZSBfQ2hhclQ+CiAgICB0eXBlbmFtZSBfX2dudV9jeHg6Ol9fZW5hYmxlX2lm
PF9faXNfY2hhcjxfQ2hhclQ+OjpfX3ZhbHVlLAogICAgICAgIF9DaGFyVCo+OjpfX3R5cGUKICAg
IF9fY29weV9tb3ZlX2EyKGlzdHJlYW1idWZfaXRlcmF0b3I8X0NoYXJULCBjaGFyX3RyYWl0czxf
Q2hhclQ+ID4sCiAgICAgaXN0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQsIGNoYXJfdHJhaXRzPF9D
aGFyVD4gPiwgX0NoYXJUKik7CgogIHRlbXBsYXRlPGJvb2wgX0lzTW92ZSwgdHlwZW5hbWUgX0lJ
LCB0eXBlbmFtZSBfT0k+CiAgICBpbmxpbmUgX09JCiAgICBfX2NvcHlfbW92ZV9hMihfSUkgX19m
aXJzdCwgX0lJIF9fbGFzdCwgX09JIF9fcmVzdWx0KQogICAgewogICAgICByZXR1cm4gX09JKHN0
ZDo6X19jb3B5X21vdmVfYTxfSXNNb3ZlPihzdGQ6Ol9fbml0ZXJfYmFzZShfX2ZpcnN0KSwKICAg
ICAgICAgIHN0ZDo6X19uaXRlcl9iYXNlKF9fbGFzdCksCiAgICAgICAgICBzdGQ6Ol9fbml0ZXJf
YmFzZShfX3Jlc3VsdCkpKTsKICAgIH0KIyA0NDQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9zdGxfYWxnb2Jhc2UuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSSwgdHlwZW5hbWUgX09J
PgogICAgaW5saW5lIF9PSQogICAgY29weShfSUkgX19maXJzdCwgX0lJIF9fbGFzdCwgX09JIF9f
cmVzdWx0KQogICAgewoKICAgICAKICAgICAKCiAgICAgIDsKCiAgICAgIHJldHVybiAoc3RkOjpf
X2NvcHlfbW92ZV9hMjxfX2lzX21vdmVfaXRlcmF0b3I8X0lJPjo6X192YWx1ZT4KICAgICAgIChz
dGQ6Ol9fbWl0ZXJfYmFzZShfX2ZpcnN0KSwgc3RkOjpfX21pdGVyX2Jhc2UoX19sYXN0KSwKICAg
ICAgICBfX3Jlc3VsdCkpOwogICAgfQojIDQ3NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L3N0bF9hbGdvYmFzZS5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lJLCB0eXBlbmFtZSBfT0k+
CiAgICBpbmxpbmUgX09JCiAgICBtb3ZlKF9JSSBfX2ZpcnN0LCBfSUkgX19sYXN0LCBfT0kgX19y
ZXN1bHQpCiAgICB7CgogICAgIAogICAgIAoKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19j
b3B5X21vdmVfYTI8dHJ1ZT4oc3RkOjpfX21pdGVyX2Jhc2UoX19maXJzdCksCiAgICAgICAgICAg
c3RkOjpfX21pdGVyX2Jhc2UoX19sYXN0KSwgX19yZXN1bHQpOwogICAgfQoKCgoKCgogIHRlbXBs
YXRlPGJvb2wsIGJvb2wsIHR5cGVuYW1lPgogICAgc3RydWN0IF9fY29weV9tb3ZlX2JhY2t3YXJk
CiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9CSTEsIHR5cGVuYW1lIF9CSTI+CiAgICAg
ICAgc3RhdGljIF9CSTIKICAgICAgICBfX2NvcHlfbW92ZV9iKF9CSTEgX19maXJzdCwgX0JJMSBf
X2xhc3QsIF9CSTIgX19yZXN1bHQpCiAgICAgICAgewogICB3aGlsZSAoX19maXJzdCAhPSBfX2xh
c3QpCiAgICAgKi0tX19yZXN1bHQgPSAqLS1fX2xhc3Q7CiAgIHJldHVybiBfX3Jlc3VsdDsKIH0K
ICAgIH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2F0ZWdvcnk+CiAgICBzdHJ1Y3QgX19jb3B5
X21vdmVfYmFja3dhcmQ8dHJ1ZSwgZmFsc2UsIF9DYXRlZ29yeT4KICAgIHsKICAgICAgdGVtcGxh
dGU8dHlwZW5hbWUgX0JJMSwgdHlwZW5hbWUgX0JJMj4KICAgICAgICBzdGF0aWMgX0JJMgogICAg
ICAgIF9fY29weV9tb3ZlX2IoX0JJMSBfX2ZpcnN0LCBfQkkxIF9fbGFzdCwgX0JJMiBfX3Jlc3Vs
dCkKICAgICAgICB7CiAgIHdoaWxlIChfX2ZpcnN0ICE9IF9fbGFzdCkKICAgICAqLS1fX3Jlc3Vs
dCA9IHN0ZDo6bW92ZSgqLS1fX2xhc3QpOwogICByZXR1cm4gX19yZXN1bHQ7CiB9CiAgICB9OwoK
CiAgdGVtcGxhdGU8PgogICAgc3RydWN0IF9fY29weV9tb3ZlX2JhY2t3YXJkPGZhbHNlLCBmYWxz
ZSwgcmFuZG9tX2FjY2Vzc19pdGVyYXRvcl90YWc+CiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVu
YW1lIF9CSTEsIHR5cGVuYW1lIF9CSTI+CiAgICAgICAgc3RhdGljIF9CSTIKICAgICAgICBfX2Nv
cHlfbW92ZV9iKF9CSTEgX19maXJzdCwgX0JJMSBfX2xhc3QsIF9CSTIgX19yZXN1bHQpCiAgICAg
ICAgewogICB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0JJMT46OmRpZmZlcmVuY2VfdHlwZSBf
X247CiAgIGZvciAoX19uID0gX19sYXN0IC0gX19maXJzdDsgX19uID4gMDsgLS1fX24pCiAgICAg
Ki0tX19yZXN1bHQgPSAqLS1fX2xhc3Q7CiAgIHJldHVybiBfX3Jlc3VsdDsKIH0KICAgIH07CgoK
ICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19jb3B5X21vdmVfYmFja3dhcmQ8dHJ1ZSwgZmFsc2Us
IHJhbmRvbV9hY2Nlc3NfaXRlcmF0b3JfdGFnPgogICAgewogICAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfQkkxLCB0eXBlbmFtZSBfQkkyPgogICAgICAgIHN0YXRpYyBfQkkyCiAgICAgICAgX19jb3B5
X21vdmVfYihfQkkxIF9fZmlyc3QsIF9CSTEgX19sYXN0LCBfQkkyIF9fcmVzdWx0KQogICAgICAg
IHsKICAgdHlwZW5hbWUgaXRlcmF0b3JfdHJhaXRzPF9CSTE+OjpkaWZmZXJlbmNlX3R5cGUgX19u
OwogICBmb3IgKF9fbiA9IF9fbGFzdCAtIF9fZmlyc3Q7IF9fbiA+IDA7IC0tX19uKQogICAgICot
LV9fcmVzdWx0ID0gc3RkOjptb3ZlKCotLV9fbGFzdCk7CiAgIHJldHVybiBfX3Jlc3VsdDsKIH0K
ICAgIH07CgoKICB0ZW1wbGF0ZTxib29sIF9Jc01vdmU+CiAgICBzdHJ1Y3QgX19jb3B5X21vdmVf
YmFja3dhcmQ8X0lzTW92ZSwgdHJ1ZSwgcmFuZG9tX2FjY2Vzc19pdGVyYXRvcl90YWc+CiAgICB7
CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgICAgICBzdGF0aWMgX1RwKgogICAgICAg
IF9fY29weV9tb3ZlX2IoY29uc3QgX1RwKiBfX2ZpcnN0LCBjb25zdCBfVHAqIF9fbGFzdCwgX1Rw
KiBfX3Jlc3VsdCkKICAgICAgICB7CgogICB1c2luZyBfX2Fzc2lnbmFibGUgPSBjb25kaXRpb25h
bDxfSXNNb3ZlLAogICAgICAgIGlzX21vdmVfYXNzaWduYWJsZTxfVHA+LAogICAgICAgIGlzX2Nv
cHlfYXNzaWduYWJsZTxfVHA+PjsKCiAgIHN0YXRpY19hc3NlcnQoIF9fYXNzaWduYWJsZTo6dHlw
ZTo6dmFsdWUsICJ0eXBlIGlzIG5vdCBhc3NpZ25hYmxlIiApOwoKICAgY29uc3QgcHRyZGlmZl90
IF9OdW0gPSBfX2xhc3QgLSBfX2ZpcnN0OwogICBpZiAoX051bSkKICAgICBfX2J1aWx0aW5fbWVt
bW92ZShfX3Jlc3VsdCAtIF9OdW0sIF9fZmlyc3QsIHNpemVvZihfVHApICogX051bSk7CiAgIHJl
dHVybiBfX3Jlc3VsdCAtIF9OdW07CiB9CiAgICB9OwoKICB0ZW1wbGF0ZTxib29sIF9Jc01vdmUs
IHR5cGVuYW1lIF9CSTEsIHR5cGVuYW1lIF9CSTI+CiAgICBpbmxpbmUgX0JJMgogICAgX19jb3B5
X21vdmVfYmFja3dhcmRfYShfQkkxIF9fZmlyc3QsIF9CSTEgX19sYXN0LCBfQkkyIF9fcmVzdWx0
KQogICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfQkkxPjo6dmFs
dWVfdHlwZSBfVmFsdWVUeXBlMTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFp
dHM8X0JJMj46OnZhbHVlX3R5cGUgX1ZhbHVlVHlwZTI7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUg
aXRlcmF0b3JfdHJhaXRzPF9CSTE+OjppdGVyYXRvcl9jYXRlZ29yeSBfQ2F0ZWdvcnk7CiAgICAg
IGNvbnN0IGJvb2wgX19zaW1wbGUgPSAoX19pc190cml2aWFsKF9WYWx1ZVR5cGUxKQogICAgICAg
ICAgICAgICAgICAgICAgJiYgX19pc19wb2ludGVyPF9CSTE+OjpfX3ZhbHVlCiAgICAgICAgICAg
ICAgICAgICAgICAmJiBfX2lzX3BvaW50ZXI8X0JJMj46Ol9fdmFsdWUKICAgICAgICAmJiBfX2Fy
ZV9zYW1lPF9WYWx1ZVR5cGUxLCBfVmFsdWVUeXBlMj46Ol9fdmFsdWUpOwoKICAgICAgcmV0dXJu
IHN0ZDo6X19jb3B5X21vdmVfYmFja3dhcmQ8X0lzTW92ZSwgX19zaW1wbGUsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgX0NhdGVnb3J5Pjo6X19jb3B5X21vdmVfYihfX2ZpcnN0LAog
ICAgICAgICBfX2xhc3QsCiAgICAgICAgIF9fcmVzdWx0KTsKICAgIH0KCiAgdGVtcGxhdGU8Ym9v
bCBfSXNNb3ZlLCB0eXBlbmFtZSBfQkkxLCB0eXBlbmFtZSBfQkkyPgogICAgaW5saW5lIF9CSTIK
ICAgIF9fY29weV9tb3ZlX2JhY2t3YXJkX2EyKF9CSTEgX19maXJzdCwgX0JJMSBfX2xhc3QsIF9C
STIgX19yZXN1bHQpCiAgICB7CiAgICAgIHJldHVybiBfQkkyKHN0ZDo6X19jb3B5X21vdmVfYmFj
a3dhcmRfYTxfSXNNb3ZlPgogICAgKHN0ZDo6X19uaXRlcl9iYXNlKF9fZmlyc3QpLCBzdGQ6Ol9f
bml0ZXJfYmFzZShfX2xhc3QpLAogICAgIHN0ZDo6X19uaXRlcl9iYXNlKF9fcmVzdWx0KSkpOwog
ICAgfQojIDYyMCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvYmFzZS5oIiAz
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0JJMSwgdHlwZW5hbWUgX0JJMj4KICAgIGlubGluZSBfQkky
CiAgICBjb3B5X2JhY2t3YXJkKF9CSTEgX19maXJzdCwgX0JJMSBfX2xhc3QsIF9CSTIgX19yZXN1
bHQpCiAgICB7CgogICAgIAogICAgIAogICAgIAoKCiAgICAgIDsKCiAgICAgIHJldHVybiAoc3Rk
OjpfX2NvcHlfbW92ZV9iYWNrd2FyZF9hMjxfX2lzX21vdmVfaXRlcmF0b3I8X0JJMT46Ol9fdmFs
dWU+CiAgICAgICAoc3RkOjpfX21pdGVyX2Jhc2UoX19maXJzdCksIHN0ZDo6X19taXRlcl9iYXNl
KF9fbGFzdCksCiAgICAgICAgX19yZXN1bHQpKTsKICAgIH0KIyA2NTYgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9zdGxfYWxnb2Jhc2UuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9CSTEs
IHR5cGVuYW1lIF9CSTI+CiAgICBpbmxpbmUgX0JJMgogICAgbW92ZV9iYWNrd2FyZChfQkkxIF9f
Zmlyc3QsIF9CSTEgX19sYXN0LCBfQkkyIF9fcmVzdWx0KQogICAgewoKICAgICAKICAgICAKICAg
ICAKCgogICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX2NvcHlfbW92ZV9iYWNrd2FyZF9hMjx0
cnVlPihzdGQ6Ol9fbWl0ZXJfYmFzZShfX2ZpcnN0KSwKICAgICAgc3RkOjpfX21pdGVyX2Jhc2Uo
X19sYXN0KSwKICAgICAgX19yZXN1bHQpOwogICAgfQoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSB0eXBlbmFtZQogICAg
X19nbnVfY3h4OjpfX2VuYWJsZV9pZjwhX19pc19zY2FsYXI8X1RwPjo6X192YWx1ZSwgdm9pZD46
Ol9fdHlwZQogICAgX19maWxsX2EoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0
ZXJhdG9yIF9fbGFzdCwKICAgICAgIGNvbnN0IF9UcCYgX192YWx1ZSkKICAgIHsKICAgICAgZm9y
ICg7IF9fZmlyc3QgIT0gX19sYXN0OyArK19fZmlyc3QpCiAqX19maXJzdCA9IF9fdmFsdWU7CiAg
ICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9UcD4K
ICAgIGlubGluZSB0eXBlbmFtZQogICAgX19nbnVfY3h4OjpfX2VuYWJsZV9pZjxfX2lzX3NjYWxh
cjxfVHA+OjpfX3ZhbHVlLCB2b2lkPjo6X190eXBlCiAgICBfX2ZpbGxfYShfRm9yd2FyZEl0ZXJh
dG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0LAogICAgICBjb25zdCBfVHAmIF9f
dmFsdWUpCiAgICB7CiAgICAgIGNvbnN0IF9UcCBfX3RtcCA9IF9fdmFsdWU7CiAgICAgIGZvciAo
OyBfX2ZpcnN0ICE9IF9fbGFzdDsgKytfX2ZpcnN0KQogKl9fZmlyc3QgPSBfX3RtcDsKICAgIH0K
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSB0eXBlbmFtZQogICAgX19nbnVf
Y3h4OjpfX2VuYWJsZV9pZjxfX2lzX2J5dGU8X1RwPjo6X192YWx1ZSwgdm9pZD46Ol9fdHlwZQog
ICAgX19maWxsX2EoX1RwKiBfX2ZpcnN0LCBfVHAqIF9fbGFzdCwgY29uc3QgX1RwJiBfX2MpCiAg
ICB7CiAgICAgIGNvbnN0IF9UcCBfX3RtcCA9IF9fYzsKICAgICAgaWYgKGNvbnN0IHNpemVfdCBf
X2xlbiA9IF9fbGFzdCAtIF9fZmlyc3QpCiBfX2J1aWx0aW5fbWVtc2V0KF9fZmlyc3QsIHN0YXRp
Y19jYXN0PHVuc2lnbmVkIGNoYXI+KF9fdG1wKSwgX19sZW4pOwogICAgfQojIDcyMiAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvYmFzZS5oIiAzCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX1RwPgogICAgaW5saW5lIHZvaWQKICAgIGZp
bGwoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwgY29u
c3QgX1RwJiBfX3ZhbHVlKQogICAgewoKICAgICAKCiAgICAgIDsKCiAgICAgIHN0ZDo6X19maWxs
X2Eoc3RkOjpfX25pdGVyX2Jhc2UoX19maXJzdCksIHN0ZDo6X19uaXRlcl9iYXNlKF9fbGFzdCks
CiAgICAgIF9fdmFsdWUpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfT3V0cHV0SXRlcmF0
b3IsIHR5cGVuYW1lIF9TaXplLCB0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgdHlwZW5hbWUKICAg
IF9fZ251X2N4eDo6X19lbmFibGVfaWY8IV9faXNfc2NhbGFyPF9UcD46Ol9fdmFsdWUsIF9PdXRw
dXRJdGVyYXRvcj46Ol9fdHlwZQogICAgX19maWxsX25fYShfT3V0cHV0SXRlcmF0b3IgX19maXJz
dCwgX1NpemUgX19uLCBjb25zdCBfVHAmIF9fdmFsdWUpCiAgICB7CiAgICAgIGZvciAoX19kZWNs
dHlwZShfX24gKyAwKSBfX25pdGVyID0gX19uOwogICAgX19uaXRlciA+IDA7IC0tX19uaXRlciwg
KytfX2ZpcnN0KQogKl9fZmlyc3QgPSBfX3ZhbHVlOwogICAgICByZXR1cm4gX19maXJzdDsKICAg
IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX091dHB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfU2l6ZSwg
dHlwZW5hbWUgX1RwPgogICAgaW5saW5lIHR5cGVuYW1lCiAgICBfX2dudV9jeHg6Ol9fZW5hYmxl
X2lmPF9faXNfc2NhbGFyPF9UcD46Ol9fdmFsdWUsIF9PdXRwdXRJdGVyYXRvcj46Ol9fdHlwZQog
ICAgX19maWxsX25fYShfT3V0cHV0SXRlcmF0b3IgX19maXJzdCwgX1NpemUgX19uLCBjb25zdCBf
VHAmIF9fdmFsdWUpCiAgICB7CiAgICAgIGNvbnN0IF9UcCBfX3RtcCA9IF9fdmFsdWU7CiAgICAg
IGZvciAoX19kZWNsdHlwZShfX24gKyAwKSBfX25pdGVyID0gX19uOwogICAgX19uaXRlciA+IDA7
IC0tX19uaXRlciwgKytfX2ZpcnN0KQogKl9fZmlyc3QgPSBfX3RtcDsKICAgICAgcmV0dXJuIF9f
Zmlyc3Q7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9TaXplLCB0eXBlbmFtZSBfVHA+CiAg
ICBpbmxpbmUgdHlwZW5hbWUKICAgIF9fZ251X2N4eDo6X19lbmFibGVfaWY8X19pc19ieXRlPF9U
cD46Ol9fdmFsdWUsIF9UcCo+OjpfX3R5cGUKICAgIF9fZmlsbF9uX2EoX1RwKiBfX2ZpcnN0LCBf
U2l6ZSBfX24sIGNvbnN0IF9UcCYgX19jKQogICAgewogICAgICBzdGQ6Ol9fZmlsbF9hKF9fZmly
c3QsIF9fZmlyc3QgKyBfX24sIF9fYyk7CiAgICAgIHJldHVybiBfX2ZpcnN0ICsgX19uOwogICAg
fQojIDc4MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvYmFzZS5oIiAzCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX09JLCB0eXBlbmFtZSBfU2l6ZSwgdHlwZW5hbWUgX1RwPgogICAg
aW5saW5lIF9PSQogICAgZmlsbF9uKF9PSSBfX2ZpcnN0LCBfU2l6ZSBfX24sIGNvbnN0IF9UcCYg
X192YWx1ZSkKICAgIHsKCiAgICAgCgogICAgICByZXR1cm4gX09JKHN0ZDo6X19maWxsX25fYShz
dGQ6Ol9fbml0ZXJfYmFzZShfX2ZpcnN0KSwgX19uLCBfX3ZhbHVlKSk7CiAgICB9CgogIHRlbXBs
YXRlPGJvb2wgX0Jvb2xUeXBlPgogICAgc3RydWN0IF9fZXF1YWwKICAgIHsKICAgICAgdGVtcGxh
dGU8dHlwZW5hbWUgX0lJMSwgdHlwZW5hbWUgX0lJMj4KICAgICAgICBzdGF0aWMgYm9vbAogICAg
ICAgIGVxdWFsKF9JSTEgX19maXJzdDEsIF9JSTEgX19sYXN0MSwgX0lJMiBfX2ZpcnN0MikKICAg
ICAgICB7CiAgIGZvciAoOyBfX2ZpcnN0MSAhPSBfX2xhc3QxOyArK19fZmlyc3QxLCAodm9pZCkr
K19fZmlyc3QyKQogICAgIGlmICghKCpfX2ZpcnN0MSA9PSAqX19maXJzdDIpKQogICAgICAgcmV0
dXJuIGZhbHNlOwogICByZXR1cm4gdHJ1ZTsKIH0KICAgIH07CgogIHRlbXBsYXRlPD4KICAgIHN0
cnVjdCBfX2VxdWFsPHRydWU+CiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
ICAgICBzdGF0aWMgYm9vbAogICAgICAgIGVxdWFsKGNvbnN0IF9UcCogX19maXJzdDEsIGNvbnN0
IF9UcCogX19sYXN0MSwgY29uc3QgX1RwKiBfX2ZpcnN0MikKICAgICAgICB7CiAgIGlmIChjb25z
dCBzaXplX3QgX19sZW4gPSAoX19sYXN0MSAtIF9fZmlyc3QxKSkKICAgICByZXR1cm4gIV9fYnVp
bHRpbl9tZW1jbXAoX19maXJzdDEsIF9fZmlyc3QyLCBzaXplb2YoX1RwKSAqIF9fbGVuKTsKICAg
cmV0dXJuIHRydWU7CiB9CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUkxLCB0eXBlbmFt
ZSBfSUkyPgogICAgaW5saW5lIGJvb2wKICAgIF9fZXF1YWxfYXV4KF9JSTEgX19maXJzdDEsIF9J
STEgX19sYXN0MSwgX0lJMiBfX2ZpcnN0MikKICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBp
dGVyYXRvcl90cmFpdHM8X0lJMT46OnZhbHVlX3R5cGUgX1ZhbHVlVHlwZTE7CiAgICAgIHR5cGVk
ZWYgdHlwZW5hbWUgaXRlcmF0b3JfdHJhaXRzPF9JSTI+Ojp2YWx1ZV90eXBlIF9WYWx1ZVR5cGUy
OwogICAgICBjb25zdCBib29sIF9fc2ltcGxlID0gKChfX2lzX2ludGVnZXI8X1ZhbHVlVHlwZTE+
OjpfX3ZhbHVlCiAgICAgICAgIHx8IF9faXNfcG9pbnRlcjxfVmFsdWVUeXBlMT46Ol9fdmFsdWUp
CiAgICAgICAgICAgICAgICAgICAgICAmJiBfX2lzX3BvaW50ZXI8X0lJMT46Ol9fdmFsdWUKICAg
ICAgICAgICAgICAgICAgICAgICYmIF9faXNfcG9pbnRlcjxfSUkyPjo6X192YWx1ZQogICAgICAg
ICYmIF9fYXJlX3NhbWU8X1ZhbHVlVHlwZTEsIF9WYWx1ZVR5cGUyPjo6X192YWx1ZSk7CgogICAg
ICByZXR1cm4gc3RkOjpfX2VxdWFsPF9fc2ltcGxlPjo6ZXF1YWwoX19maXJzdDEsIF9fbGFzdDEs
IF9fZmlyc3QyKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUsIHR5cGVuYW1lPgogICAgc3Ry
dWN0IF9fbGNfcmFpCiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JSTEsIHR5cGVuYW1l
IF9JSTI+CiAgICAgICAgc3RhdGljIF9JSTEKICAgICAgICBfX25ld2xhc3QxKF9JSTEsIF9JSTEg
X19sYXN0MSwgX0lJMiwgX0lJMikKICAgICAgICB7IHJldHVybiBfX2xhc3QxOyB9CgogICAgICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfSUk+CiAgICAgICAgc3RhdGljIGJvb2wKICAgICAgICBfX2NuZDIo
X0lJIF9fZmlyc3QsIF9JSSBfX2xhc3QpCiAgICAgICAgeyByZXR1cm4gX19maXJzdCAhPSBfX2xh
c3Q7IH0KICAgIH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2xjX3JhaTxyYW5kb21fYWNj
ZXNzX2l0ZXJhdG9yX3RhZywgcmFuZG9tX2FjY2Vzc19pdGVyYXRvcl90YWc+CiAgICB7CiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9SQUkxLCB0eXBlbmFtZSBfUkFJMj4KICAgICAgICBzdGF0aWMg
X1JBSTEKICAgICAgICBfX25ld2xhc3QxKF9SQUkxIF9fZmlyc3QxLCBfUkFJMSBfX2xhc3QxLAog
ICAgIF9SQUkyIF9fZmlyc3QyLCBfUkFJMiBfX2xhc3QyKQogICAgICAgIHsKICAgY29uc3QgdHlw
ZW5hbWUgaXRlcmF0b3JfdHJhaXRzPF9SQUkxPjo6ZGlmZmVyZW5jZV90eXBlCiAgICAgX19kaWZm
MSA9IF9fbGFzdDEgLSBfX2ZpcnN0MTsKICAgY29uc3QgdHlwZW5hbWUgaXRlcmF0b3JfdHJhaXRz
PF9SQUkyPjo6ZGlmZmVyZW5jZV90eXBlCiAgICAgX19kaWZmMiA9IF9fbGFzdDIgLSBfX2ZpcnN0
MjsKICAgcmV0dXJuIF9fZGlmZjIgPCBfX2RpZmYxID8gX19maXJzdDEgKyBfX2RpZmYyIDogX19s
YXN0MTsKIH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9SQUk+CiAgICAgICAgc3RhdGljIGJv
b2wKICAgICAgICBfX2NuZDIoX1JBSSwgX1JBSSkKICAgICAgICB7IHJldHVybiB0cnVlOyB9CiAg
ICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUkxLCB0eXBlbmFtZSBfSUkyLCB0eXBlbmFtZSBf
Q29tcGFyZT4KICAgIGJvb2wKICAgIF9fbGV4aWNvZ3JhcGhpY2FsX2NvbXBhcmVfaW1wbChfSUkx
IF9fZmlyc3QxLCBfSUkxIF9fbGFzdDEsCiAgICAgICBfSUkyIF9fZmlyc3QyLCBfSUkyIF9fbGFz
dDIsCiAgICAgICBfQ29tcGFyZSBfX2NvbXApCiAgICB7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUg
aXRlcmF0b3JfdHJhaXRzPF9JSTE+OjppdGVyYXRvcl9jYXRlZ29yeSBfQ2F0ZWdvcnkxOwogICAg
ICB0eXBlZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfSUkyPjo6aXRlcmF0b3JfY2F0ZWdv
cnkgX0NhdGVnb3J5MjsKICAgICAgdHlwZWRlZiBzdGQ6Ol9fbGNfcmFpPF9DYXRlZ29yeTEsIF9D
YXRlZ29yeTI+IF9fcmFpX3R5cGU7CgogICAgICBfX2xhc3QxID0gX19yYWlfdHlwZTo6X19uZXds
YXN0MShfX2ZpcnN0MSwgX19sYXN0MSwgX19maXJzdDIsIF9fbGFzdDIpOwogICAgICBmb3IgKDsg
X19maXJzdDEgIT0gX19sYXN0MSAmJiBfX3JhaV90eXBlOjpfX2NuZDIoX19maXJzdDIsIF9fbGFz
dDIpOwogICAgKytfX2ZpcnN0MSwgKHZvaWQpKytfX2ZpcnN0MikKIHsKICAgaWYgKF9fY29tcChf
X2ZpcnN0MSwgX19maXJzdDIpKQogICAgIHJldHVybiB0cnVlOwogICBpZiAoX19jb21wKF9fZmly
c3QyLCBfX2ZpcnN0MSkpCiAgICAgcmV0dXJuIGZhbHNlOwogfQogICAgICByZXR1cm4gX19maXJz
dDEgPT0gX19sYXN0MSAmJiBfX2ZpcnN0MiAhPSBfX2xhc3QyOwogICAgfQoKICB0ZW1wbGF0ZTxi
b29sIF9Cb29sVHlwZT4KICAgIHN0cnVjdCBfX2xleGljb2dyYXBoaWNhbF9jb21wYXJlCiAgICB7
CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JSTEsIHR5cGVuYW1lIF9JSTI+CiAgICAgICAgc3Rh
dGljIGJvb2wgX19sYyhfSUkxLCBfSUkxLCBfSUkyLCBfSUkyKTsKICAgIH07CgogIHRlbXBsYXRl
PGJvb2wgX0Jvb2xUeXBlPgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0lJMSwgdHlwZW5hbWUgX0lJ
Mj4KICAgICAgYm9vbAogICAgICBfX2xleGljb2dyYXBoaWNhbF9jb21wYXJlPF9Cb29sVHlwZT46
OgogICAgICBfX2xjKF9JSTEgX19maXJzdDEsIF9JSTEgX19sYXN0MSwgX0lJMiBfX2ZpcnN0Miwg
X0lJMiBfX2xhc3QyKQogICAgICB7CiByZXR1cm4gc3RkOjpfX2xleGljb2dyYXBoaWNhbF9jb21w
YXJlX2ltcGwoX19maXJzdDEsIF9fbGFzdDEsCiAgICAgICAgIF9fZmlyc3QyLCBfX2xhc3QyLAog
ICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNzX2l0ZXIoKSk7CiAgICAgIH0KCiAgdGVt
cGxhdGU8PgogICAgc3RydWN0IF9fbGV4aWNvZ3JhcGhpY2FsX2NvbXBhcmU8dHJ1ZT4KICAgIHsK
ICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfVXA+CiAgICAgICAgc3RhdGlj
IGJvb2wKICAgICAgICBfX2xjKGNvbnN0IF9UcCogX19maXJzdDEsIGNvbnN0IF9UcCogX19sYXN0
MSwKICAgICAgY29uc3QgX1VwKiBfX2ZpcnN0MiwgY29uc3QgX1VwKiBfX2xhc3QyKQogewogICBj
b25zdCBzaXplX3QgX19sZW4xID0gX19sYXN0MSAtIF9fZmlyc3QxOwogICBjb25zdCBzaXplX3Qg
X19sZW4yID0gX19sYXN0MiAtIF9fZmlyc3QyOwogICBpZiAoY29uc3Qgc2l6ZV90IF9fbGVuID0g
c3RkOjptaW4oX19sZW4xLCBfX2xlbjIpKQogICAgIGlmIChpbnQgX19yZXN1bHQgPSBfX2J1aWx0
aW5fbWVtY21wKF9fZmlyc3QxLCBfX2ZpcnN0MiwgX19sZW4pKQogICAgICAgcmV0dXJuIF9fcmVz
dWx0IDwgMDsKICAgcmV0dXJuIF9fbGVuMSA8IF9fbGVuMjsKIH0KICAgIH07CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9JSTEsIHR5cGVuYW1lIF9JSTI+CiAgICBpbmxpbmUgYm9vbAogICAgX19sZXhp
Y29ncmFwaGljYWxfY29tcGFyZV9hdXgoX0lJMSBfX2ZpcnN0MSwgX0lJMSBfX2xhc3QxLAogICAg
ICBfSUkyIF9fZmlyc3QyLCBfSUkyIF9fbGFzdDIpCiAgICB7CiAgICAgIHR5cGVkZWYgdHlwZW5h
bWUgaXRlcmF0b3JfdHJhaXRzPF9JSTE+Ojp2YWx1ZV90eXBlIF9WYWx1ZVR5cGUxOwogICAgICB0
eXBlZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfSUkyPjo6dmFsdWVfdHlwZSBfVmFsdWVU
eXBlMjsKICAgICAgY29uc3QgYm9vbCBfX3NpbXBsZSA9CiAoX19pc19ieXRlPF9WYWx1ZVR5cGUx
Pjo6X192YWx1ZSAmJiBfX2lzX2J5dGU8X1ZhbHVlVHlwZTI+OjpfX3ZhbHVlCiAgJiYgIV9fZ251
X2N4eDo6X19udW1lcmljX3RyYWl0czxfVmFsdWVUeXBlMT46Ol9faXNfc2lnbmVkCiAgJiYgIV9f
Z251X2N4eDo6X19udW1lcmljX3RyYWl0czxfVmFsdWVUeXBlMj46Ol9faXNfc2lnbmVkCiAgJiYg
X19pc19wb2ludGVyPF9JSTE+OjpfX3ZhbHVlCiAgJiYgX19pc19wb2ludGVyPF9JSTI+OjpfX3Zh
bHVlKTsKCiAgICAgIHJldHVybiBzdGQ6Ol9fbGV4aWNvZ3JhcGhpY2FsX2NvbXBhcmU8X19zaW1w
bGU+OjpfX2xjKF9fZmlyc3QxLCBfX2xhc3QxLAogICAgICAgICAgIF9fZmlyc3QyLCBfX2xhc3Qy
KTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUg
X1RwLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIF9Gb3J3YXJkSXRlcmF0b3IKICAgIF9fbG93ZXJf
Ym91bmQoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwK
ICAgIGNvbnN0IF9UcCYgX192YWwsIF9Db21wYXJlIF9fY29tcCkKICAgIHsKICAgICAgdHlwZWRl
ZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0ZvcndhcmRJdGVyYXRvcj46OmRpZmZlcmVuY2Vf
dHlwZQogX0Rpc3RhbmNlVHlwZTsKCiAgICAgIF9EaXN0YW5jZVR5cGUgX19sZW4gPSBzdGQ6OmRp
c3RhbmNlKF9fZmlyc3QsIF9fbGFzdCk7CgogICAgICB3aGlsZSAoX19sZW4gPiAwKQogewogICBf
RGlzdGFuY2VUeXBlIF9faGFsZiA9IF9fbGVuID4+IDE7CiAgIF9Gb3J3YXJkSXRlcmF0b3IgX19t
aWRkbGUgPSBfX2ZpcnN0OwogICBzdGQ6OmFkdmFuY2UoX19taWRkbGUsIF9faGFsZik7CiAgIGlm
IChfX2NvbXAoX19taWRkbGUsIF9fdmFsKSkKICAgICB7CiAgICAgICBfX2ZpcnN0ID0gX19taWRk
bGU7CiAgICAgICArK19fZmlyc3Q7CiAgICAgICBfX2xlbiA9IF9fbGVuIC0gX19oYWxmIC0gMTsK
ICAgICB9CiAgIGVsc2UKICAgICBfX2xlbiA9IF9faGFsZjsKIH0KICAgICAgcmV0dXJuIF9fZmly
c3Q7CiAgICB9CiMgOTgyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ29iYXNl
LmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfVHA+
CiAgICBpbmxpbmUgX0ZvcndhcmRJdGVyYXRvcgogICAgbG93ZXJfYm91bmQoX0ZvcndhcmRJdGVy
YXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICBjb25zdCBfVHAmIF9fdmFs
KQogICAgewoKICAgICAKICAgICAKCiAgICAgIDsKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6
X19sb3dlcl9ib3VuZChfX2ZpcnN0LCBfX2xhc3QsIF9fdmFsLAogICAgX19nbnVfY3h4OjpfX29w
czo6X19pdGVyX2xlc3NfdmFsKCkpOwogICAgfQoKCgogIGlubGluZSBjb25zdGV4cHIgaW50CiAg
X19sZyhpbnQgX19uKQogIHsgcmV0dXJuIHNpemVvZihpbnQpICogOCAtIDEgLSBfX2J1aWx0aW5f
Y2x6KF9fbik7IH0KCiAgaW5saW5lIGNvbnN0ZXhwciB1bnNpZ25lZAogIF9fbGcodW5zaWduZWQg
X19uKQogIHsgcmV0dXJuIHNpemVvZihpbnQpICogOCAtIDEgLSBfX2J1aWx0aW5fY2x6KF9fbik7
IH0KCiAgaW5saW5lIGNvbnN0ZXhwciBsb25nCiAgX19sZyhsb25nIF9fbikKICB7IHJldHVybiBz
aXplb2YobG9uZykgKiA4IC0gMSAtIF9fYnVpbHRpbl9jbHpsKF9fbik7IH0KCiAgaW5saW5lIGNv
bnN0ZXhwciB1bnNpZ25lZCBsb25nCiAgX19sZyh1bnNpZ25lZCBsb25nIF9fbikKICB7IHJldHVy
biBzaXplb2YobG9uZykgKiA4IC0gMSAtIF9fYnVpbHRpbl9jbHpsKF9fbik7IH0KCiAgaW5saW5l
IGNvbnN0ZXhwciBsb25nIGxvbmcKICBfX2xnKGxvbmcgbG9uZyBfX24pCiAgeyByZXR1cm4gc2l6
ZW9mKGxvbmcgbG9uZykgKiA4IC0gMSAtIF9fYnVpbHRpbl9jbHpsbChfX24pOyB9CgogIGlubGlu
ZSBjb25zdGV4cHIgdW5zaWduZWQgbG9uZyBsb25nCiAgX19sZyh1bnNpZ25lZCBsb25nIGxvbmcg
X19uKQogIHsgcmV0dXJuIHNpemVvZihsb25nIGxvbmcpICogOCAtIDEgLSBfX2J1aWx0aW5fY2x6
bGwoX19uKTsgfQoKCgoKIyAxMDQwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2Fs
Z29iYXNlLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUkxLCB0eXBlbmFtZSBfSUkyPgogICAg
aW5saW5lIGJvb2wKICAgIGVxdWFsKF9JSTEgX19maXJzdDEsIF9JSTEgX19sYXN0MSwgX0lJMiBf
X2ZpcnN0MikKICAgIHsKCiAgICAgCiAgICAgCiAgICAgCgoKICAgICAgOwoKICAgICAgcmV0dXJu
IHN0ZDo6X19lcXVhbF9hdXgoc3RkOjpfX25pdGVyX2Jhc2UoX19maXJzdDEpLAogICAgICAgICBz
dGQ6Ol9fbml0ZXJfYmFzZShfX2xhc3QxKSwKICAgICAgICAgc3RkOjpfX25pdGVyX2Jhc2UoX19m
aXJzdDIpKTsKICAgIH0KIyAxMDcyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2Fs
Z29iYXNlLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUl0ZXIxLCB0eXBlbmFtZSBfSUl0ZXIy
LCB0eXBlbmFtZSBfQmluYXJ5UHJlZGljYXRlPgogICAgaW5saW5lIGJvb2wKICAgIGVxdWFsKF9J
SXRlcjEgX19maXJzdDEsIF9JSXRlcjEgX19sYXN0MSwKICAgX0lJdGVyMiBfX2ZpcnN0MiwgX0Jp
bmFyeVByZWRpY2F0ZSBfX2JpbmFyeV9wcmVkKQogICAgewoKICAgICAKICAgICAKICAgICAgOwoK
ICAgICAgZm9yICg7IF9fZmlyc3QxICE9IF9fbGFzdDE7ICsrX19maXJzdDEsICh2b2lkKSsrX19m
aXJzdDIpCiBpZiAoIWJvb2woX19iaW5hcnlfcHJlZCgqX19maXJzdDEsICpfX2ZpcnN0MikpKQog
ICByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQojIDEyMDIgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnb2Jhc2UuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1l
IF9JSTEsIHR5cGVuYW1lIF9JSTI+CiAgICBpbmxpbmUgYm9vbAogICAgbGV4aWNvZ3JhcGhpY2Fs
X2NvbXBhcmUoX0lJMSBfX2ZpcnN0MSwgX0lJMSBfX2xhc3QxLAogICAgICAgX0lJMiBfX2ZpcnN0
MiwgX0lJMiBfX2xhc3QyKQogICAgewoKCgoKCiAgICAgCiAgICAgCiAgICAgCiAgICAgCiAgICAg
IDsKICAgICAgOwogICAgICA7CiAgICAgIDsKCiAgICAgIHJldHVybiBzdGQ6Ol9fbGV4aWNvZ3Jh
cGhpY2FsX2NvbXBhcmVfYXV4KHN0ZDo6X19uaXRlcl9iYXNlKF9fZmlyc3QxKSwKICAgICAgc3Rk
OjpfX25pdGVyX2Jhc2UoX19sYXN0MSksCiAgICAgIHN0ZDo6X19uaXRlcl9iYXNlKF9fZmlyc3Qy
KSwKICAgICAgc3RkOjpfX25pdGVyX2Jhc2UoX19sYXN0MikpOwogICAgfQojIDEyNDAgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnb2Jhc2UuaCIgMwogIHRlbXBsYXRlPHR5cGVu
YW1lIF9JSTEsIHR5cGVuYW1lIF9JSTIsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgaW5saW5lIGJv
b2wKICAgIGxleGljb2dyYXBoaWNhbF9jb21wYXJlKF9JSTEgX19maXJzdDEsIF9JSTEgX19sYXN0
MSwKICAgICAgIF9JSTIgX19maXJzdDIsIF9JSTIgX19sYXN0MiwgX0NvbXBhcmUgX19jb21wKQog
ICAgewoKICAgICAKICAgICAKICAgICAgOwogICAgICA7CiAgICAgIDsKICAgICAgOwoKICAgICAg
cmV0dXJuIHN0ZDo6X19sZXhpY29ncmFwaGljYWxfY29tcGFyZV9pbXBsCiAoX19maXJzdDEsIF9f
bGFzdDEsIF9fZmlyc3QyLCBfX2xhc3QyLAogIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9jb21w
X2l0ZXIoX19jb21wKSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9y
MSwgdHlwZW5hbWUgX0lucHV0SXRlcmF0b3IyLAogICAgdHlwZW5hbWUgX0JpbmFyeVByZWRpY2F0
ZT4KICAgIHBhaXI8X0lucHV0SXRlcmF0b3IxLCBfSW5wdXRJdGVyYXRvcjI+CiAgICBfX21pc21h
dGNoKF9JbnB1dEl0ZXJhdG9yMSBfX2ZpcnN0MSwgX0lucHV0SXRlcmF0b3IxIF9fbGFzdDEsCiAg
ICAgICAgX0lucHV0SXRlcmF0b3IyIF9fZmlyc3QyLCBfQmluYXJ5UHJlZGljYXRlIF9fYmluYXJ5
X3ByZWQpCiAgICB7CiAgICAgIHdoaWxlIChfX2ZpcnN0MSAhPSBfX2xhc3QxICYmIF9fYmluYXJ5
X3ByZWQoX19maXJzdDEsIF9fZmlyc3QyKSkKICAgICAgICB7CiAgICsrX19maXJzdDE7CiAgICsr
X19maXJzdDI7CiAgICAgICAgfQogICAgICByZXR1cm4gcGFpcjxfSW5wdXRJdGVyYXRvcjEsIF9J
bnB1dEl0ZXJhdG9yMj4oX19maXJzdDEsIF9fZmlyc3QyKTsKICAgIH0KIyAxMjg1ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ29iYXNlLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfSW5wdXRJdGVyYXRvcjEsIHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yMj4KICAgIGlubGluZSBw
YWlyPF9JbnB1dEl0ZXJhdG9yMSwgX0lucHV0SXRlcmF0b3IyPgogICAgbWlzbWF0Y2goX0lucHV0
SXRlcmF0b3IxIF9fZmlyc3QxLCBfSW5wdXRJdGVyYXRvcjEgX19sYXN0MSwKICAgICAgX0lucHV0
SXRlcmF0b3IyIF9fZmlyc3QyKQogICAgewoKICAgICAKICAgICAKICAgICAKCgogICAgICA7Cgog
ICAgICByZXR1cm4gc3RkOjpfX21pc21hdGNoKF9fZmlyc3QxLCBfX2xhc3QxLCBfX2ZpcnN0MiwK
ICAgICAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfZXF1YWxfdG9faXRlcigpKTsKICAgIH0K
IyAxMzE4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ29iYXNlLmgiIDMKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcjEsIHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9y
MiwKICAgIHR5cGVuYW1lIF9CaW5hcnlQcmVkaWNhdGU+CiAgICBpbmxpbmUgcGFpcjxfSW5wdXRJ
dGVyYXRvcjEsIF9JbnB1dEl0ZXJhdG9yMj4KICAgIG1pc21hdGNoKF9JbnB1dEl0ZXJhdG9yMSBf
X2ZpcnN0MSwgX0lucHV0SXRlcmF0b3IxIF9fbGFzdDEsCiAgICAgIF9JbnB1dEl0ZXJhdG9yMiBf
X2ZpcnN0MiwgX0JpbmFyeVByZWRpY2F0ZSBfX2JpbmFyeV9wcmVkKQogICAgewoKICAgICAKICAg
ICAKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19taXNtYXRjaChfX2ZpcnN0MSwgX19sYXN0
MSwgX19maXJzdDIsCiBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfY29tcF9pdGVyKF9fYmluYXJ5
X3ByZWQpKTsKICAgIH0KIyAxNDE4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2Fs
Z29iYXNlLmgiIDMKCn0KIyA2MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9saXN0IiAyIDMKIyAx
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYWxsb2NhdG9yLmgiIDEgMwojIDQ2ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYWxsb2NhdG9yLmgiIDMKIyAxICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2MrK2FsbG9jYXRvci5oIiAxIDMKIyAz
MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9jKythbGxv
Y2F0b3IuaCIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZXh0L25ld19hbGxvY2F0b3Iu
aCIgMSAzCiMgMzMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZXh0L25ld19hbGxvY2F0b3IuaCIg
MwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvbmV3IiAxIDMKIyAzNyAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9uZXciIDMKICAgICAgIAojIDM4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL25l
dyIgMwoKCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leGNlcHRpb24iIDEgMwojIDMzICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2V4Y2VwdGlvbiIgMwogICAgICAgCiMgMzQgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvZXhjZXB0aW9uIiAzCgojcHJhZ21hIEdDQyB2aXNpYmlsaXR5IHB1c2go
ZGVmYXVsdCkKCgojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9hdG9taWNfbG9ja2Zy
ZWVfZGVmaW5lcy5oIiAxIDMKIyAzMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2F0b21p
Y19sb2NrZnJlZV9kZWZpbmVzLmgiIDMKICAgICAgIAojIDM0ICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvYXRvbWljX2xvY2tmcmVlX2RlZmluZXMuaCIgMwojIDM5ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2V4Y2VwdGlvbiIgMiAzCgpleHRlcm4gIkMrKyIgewoKbmFtZXNwYWNlIHN0ZAp7
CiMgNjAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZXhjZXB0aW9uIiAzCiAgY2xhc3MgZXhjZXB0
aW9uCiAgewogIHB1YmxpYzoKICAgIGV4Y2VwdGlvbigpIG5vZXhjZXB0IHsgfQogICAgdmlydHVh
bCB+ZXhjZXB0aW9uKCkgbm9leGNlcHQ7CgoKCiAgICB2aXJ0dWFsIGNvbnN0IGNoYXIqCiAgICB3
aGF0KCkgY29uc3Qgbm9leGNlcHQ7CiAgfTsKCgoKICBjbGFzcyBiYWRfZXhjZXB0aW9uIDogcHVi
bGljIGV4Y2VwdGlvbgogIHsKICBwdWJsaWM6CiAgICBiYWRfZXhjZXB0aW9uKCkgbm9leGNlcHQg
eyB9CgoKCiAgICB2aXJ0dWFsIH5iYWRfZXhjZXB0aW9uKCkgbm9leGNlcHQ7CgoKICAgIHZpcnR1
YWwgY29uc3QgY2hhcioKICAgIHdoYXQoKSBjb25zdCBub2V4Y2VwdDsKICB9OwoKCiAgdHlwZWRl
ZiB2b2lkICgqdGVybWluYXRlX2hhbmRsZXIpICgpOwoKCiAgdHlwZWRlZiB2b2lkICgqdW5leHBl
Y3RlZF9oYW5kbGVyKSAoKTsKCgogIHRlcm1pbmF0ZV9oYW5kbGVyIHNldF90ZXJtaW5hdGUodGVy
bWluYXRlX2hhbmRsZXIpIG5vZXhjZXB0OwoKCgogIHRlcm1pbmF0ZV9oYW5kbGVyIGdldF90ZXJt
aW5hdGUoKSBub2V4Y2VwdDsKCgoKCiAgdm9pZCB0ZXJtaW5hdGUoKSBub2V4Y2VwdCBfX2F0dHJp
YnV0ZV9fICgoX19ub3JldHVybl9fKSk7CgoKICB1bmV4cGVjdGVkX2hhbmRsZXIgc2V0X3VuZXhw
ZWN0ZWQodW5leHBlY3RlZF9oYW5kbGVyKSBub2V4Y2VwdDsKCgoKICB1bmV4cGVjdGVkX2hhbmRs
ZXIgZ2V0X3VuZXhwZWN0ZWQoKSBub2V4Y2VwdDsKCgoKCiAgdm9pZCB1bmV4cGVjdGVkKCkgX19h
dHRyaWJ1dGVfXyAoKF9fbm9yZXR1cm5fXykpOwojIDEyOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9leGNlcHRpb24iIDMKICBib29sIHVuY2F1Z2h0X2V4Y2VwdGlvbigpIG5vZXhjZXB0IF9fYXR0
cmlidXRlX18gKChfX3B1cmVfXykpOwojIDEzOCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leGNl
cHRpb24iIDMKfQoKbmFtZXNwYWNlIF9fZ251X2N4eAp7CgojIDE2MCAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9leGNlcHRpb24iIDMKICB2b2lkIF9fdmVyYm9zZV90ZXJtaW5hdGVfaGFuZGxlcigp
OwoKCn0KCn0KCiNwcmFnbWEgR0NDIHZpc2liaWxpdHkgcG9wCgoKIyAxICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvZXhjZXB0aW9uX3B0ci5oIiAxIDMKIyAzNCAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL2V4Y2VwdGlvbl9wdHIuaCIgMwojcHJhZ21hIEdDQyB2aXNpYmlsaXR5IHB1
c2goZGVmYXVsdCkKIyA0MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2V4Y2VwdGlvbl9w
dHIuaCIgMwpleHRlcm4gIkMrKyIgewoKbmFtZXNwYWNlIHN0ZAp7CiAgY2xhc3MgdHlwZV9pbmZv
OwoKCgoKCiAgbmFtZXNwYWNlIF9fZXhjZXB0aW9uX3B0cgogIHsKICAgIGNsYXNzIGV4Y2VwdGlv
bl9wdHI7CiAgfQoKICB1c2luZyBfX2V4Y2VwdGlvbl9wdHI6OmV4Y2VwdGlvbl9wdHI7CgoKCgoK
ICBleGNlcHRpb25fcHRyIGN1cnJlbnRfZXhjZXB0aW9uKCkgbm9leGNlcHQ7CgoKICB2b2lkIHJl
dGhyb3dfZXhjZXB0aW9uKGV4Y2VwdGlvbl9wdHIpIF9fYXR0cmlidXRlX18gKChfX25vcmV0dXJu
X18pKTsKCiAgbmFtZXNwYWNlIF9fZXhjZXB0aW9uX3B0cgogIHsKICAgIHVzaW5nIHN0ZDo6cmV0
aHJvd19leGNlcHRpb247CgoKCgoKICAgIGNsYXNzIGV4Y2VwdGlvbl9wdHIKICAgIHsKICAgICAg
dm9pZCogX01fZXhjZXB0aW9uX29iamVjdDsKCiAgICAgIGV4cGxpY2l0IGV4Y2VwdGlvbl9wdHIo
dm9pZCogX19lKSBub2V4Y2VwdDsKCiAgICAgIHZvaWQgX01fYWRkcmVmKCkgbm9leGNlcHQ7CiAg
ICAgIHZvaWQgX01fcmVsZWFzZSgpIG5vZXhjZXB0OwoKICAgICAgdm9pZCAqX01fZ2V0KCkgY29u
c3Qgbm9leGNlcHQgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSk7CgogICAgICBmcmllbmQgZXhj
ZXB0aW9uX3B0ciBzdGQ6OmN1cnJlbnRfZXhjZXB0aW9uKCkgbm9leGNlcHQ7CiAgICAgIGZyaWVu
ZCB2b2lkIHN0ZDo6cmV0aHJvd19leGNlcHRpb24oZXhjZXB0aW9uX3B0cik7CgogICAgcHVibGlj
OgogICAgICBleGNlcHRpb25fcHRyKCkgbm9leGNlcHQ7CgogICAgICBleGNlcHRpb25fcHRyKGNv
bnN0IGV4Y2VwdGlvbl9wdHImKSBub2V4Y2VwdDsKCgogICAgICBleGNlcHRpb25fcHRyKG51bGxw
dHJfdCkgbm9leGNlcHQKICAgICAgOiBfTV9leGNlcHRpb25fb2JqZWN0KDApCiAgICAgIHsgfQoK
ICAgICAgZXhjZXB0aW9uX3B0cihleGNlcHRpb25fcHRyJiYgX19vKSBub2V4Y2VwdAogICAgICA6
IF9NX2V4Y2VwdGlvbl9vYmplY3QoX19vLl9NX2V4Y2VwdGlvbl9vYmplY3QpCiAgICAgIHsgX19v
Ll9NX2V4Y2VwdGlvbl9vYmplY3QgPSAwOyB9CiMgMTEzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvZXhjZXB0aW9uX3B0ci5oIiAzCiAgICAgIGV4Y2VwdGlvbl9wdHImCiAgICAgIG9wZXJh
dG9yPShjb25zdCBleGNlcHRpb25fcHRyJikgbm9leGNlcHQ7CgoKICAgICAgZXhjZXB0aW9uX3B0
ciYKICAgICAgb3BlcmF0b3I9KGV4Y2VwdGlvbl9wdHImJiBfX28pIG5vZXhjZXB0CiAgICAgIHsK
ICAgICAgICBleGNlcHRpb25fcHRyKHN0YXRpY19jYXN0PGV4Y2VwdGlvbl9wdHImJj4oX19vKSku
c3dhcCgqdGhpcyk7CiAgICAgICAgcmV0dXJuICp0aGlzOwogICAgICB9CgoKICAgICAgfmV4Y2Vw
dGlvbl9wdHIoKSBub2V4Y2VwdDsKCiAgICAgIHZvaWQKICAgICAgc3dhcChleGNlcHRpb25fcHRy
Jikgbm9leGNlcHQ7CiMgMTQwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvZXhjZXB0aW9u
X3B0ci5oIiAzCiAgICAgIGV4cGxpY2l0IG9wZXJhdG9yIGJvb2woKSBjb25zdAogICAgICB7IHJl
dHVybiBfTV9leGNlcHRpb25fb2JqZWN0OyB9CgoKICAgICAgZnJpZW5kIGJvb2wKICAgICAgb3Bl
cmF0b3I9PShjb25zdCBleGNlcHRpb25fcHRyJiwgY29uc3QgZXhjZXB0aW9uX3B0ciYpCiBub2V4
Y2VwdCBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKTsKCiAgICAgIGNvbnN0IGNsYXNzIHN0ZDo6
dHlwZV9pbmZvKgogICAgICBfX2N4YV9leGNlcHRpb25fdHlwZSgpIGNvbnN0IG5vZXhjZXB0CiBf
X2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKTsKICAgIH07CgogICAgYm9vbAogICAgb3BlcmF0b3I9
PShjb25zdCBleGNlcHRpb25fcHRyJiwgY29uc3QgZXhjZXB0aW9uX3B0ciYpCiAgICAgIG5vZXhj
ZXB0IF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpOwoKICAgIGJvb2wKICAgIG9wZXJhdG9yIT0o
Y29uc3QgZXhjZXB0aW9uX3B0ciYsIGNvbnN0IGV4Y2VwdGlvbl9wdHImKQogICAgICBub2V4Y2Vw
dCBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKTsKCiAgICBpbmxpbmUgdm9pZAogICAgc3dhcChl
eGNlcHRpb25fcHRyJiBfX2xocywgZXhjZXB0aW9uX3B0ciYgX19yaHMpCiAgICB7IF9fbGhzLnN3
YXAoX19yaHMpOyB9CgogIH0KCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRXg+CiAgICBleGNlcHRp
b25fcHRyCiAgICBtYWtlX2V4Y2VwdGlvbl9wdHIoX0V4IF9fZXgpIG5vZXhjZXB0CiAgICB7Cgog
ICAgICB0cnkKIHsKICAgdGhyb3cgX19leDsKIH0KICAgICAgY2F0Y2goLi4uKQogewogICByZXR1
cm4gY3VycmVudF9leGNlcHRpb24oKTsKIH0KCgoKICAgIH0KCgoKCgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9FeD4KICAgIGV4Y2VwdGlvbl9wdHIKICAgIGNvcHlfZXhjZXB0aW9uKF9FeCBfX2V4KSBu
b2V4Y2VwdCBfX2F0dHJpYnV0ZV9fICgoX19kZXByZWNhdGVkX18pKTsKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0V4PgogICAgZXhjZXB0aW9uX3B0cgogICAgY29weV9leGNlcHRpb24oX0V4IF9fZXgp
IG5vZXhjZXB0CiAgICB7IHJldHVybiBzdGQ6Om1ha2VfZXhjZXB0aW9uX3B0cjxfRXg+KF9fZXgp
OyB9CgoKfQoKfQoKI3ByYWdtYSBHQ0MgdmlzaWJpbGl0eSBwb3AKIyAxNzEgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvZXhjZXB0aW9uIiAyIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvbmVzdGVkX2V4Y2VwdGlvbi5oIiAxIDMKIyAzMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL25lc3RlZF9leGNlcHRpb24uaCIgMwojcHJhZ21hIEdDQyB2aXNpYmlsaXR5IHB1c2goZGVm
YXVsdCkKIyA0NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL25lc3RlZF9leGNlcHRpb24u
aCIgMwpleHRlcm4gIkMrKyIgewoKbmFtZXNwYWNlIHN0ZAp7CgoKCgoKCiAgY2xhc3MgbmVzdGVk
X2V4Y2VwdGlvbgogIHsKICAgIGV4Y2VwdGlvbl9wdHIgX01fcHRyOwoKICBwdWJsaWM6CiAgICBu
ZXN0ZWRfZXhjZXB0aW9uKCkgbm9leGNlcHQgOiBfTV9wdHIoY3VycmVudF9leGNlcHRpb24oKSkg
eyB9CgogICAgbmVzdGVkX2V4Y2VwdGlvbihjb25zdCBuZXN0ZWRfZXhjZXB0aW9uJikgbm9leGNl
cHQgPSBkZWZhdWx0OwoKICAgIG5lc3RlZF9leGNlcHRpb24mIG9wZXJhdG9yPShjb25zdCBuZXN0
ZWRfZXhjZXB0aW9uJikgbm9leGNlcHQgPSBkZWZhdWx0OwoKICAgIHZpcnR1YWwgfm5lc3RlZF9l
eGNlcHRpb24oKSBub2V4Y2VwdDsKCiAgICBbW25vcmV0dXJuXV0KICAgIHZvaWQKICAgIHJldGhy
b3dfbmVzdGVkKCkgY29uc3QKICAgIHsKICAgICAgaWYgKF9NX3B0cikKIHJldGhyb3dfZXhjZXB0
aW9uKF9NX3B0cik7CiAgICAgIHN0ZDo6dGVybWluYXRlKCk7CiAgICB9CgogICAgZXhjZXB0aW9u
X3B0cgogICAgbmVzdGVkX3B0cigpIGNvbnN0IG5vZXhjZXB0CiAgICB7IHJldHVybiBfTV9wdHI7
IH0KICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRXhjZXB0PgogICAgc3RydWN0IF9OZXN0ZWRf
ZXhjZXB0aW9uIDogcHVibGljIF9FeGNlcHQsIHB1YmxpYyBuZXN0ZWRfZXhjZXB0aW9uCiAgICB7
CiAgICAgIGV4cGxpY2l0IF9OZXN0ZWRfZXhjZXB0aW9uKGNvbnN0IF9FeGNlcHQmIF9fZXgpCiAg
ICAgIDogX0V4Y2VwdChfX2V4KQogICAgICB7IH0KCiAgICAgIGV4cGxpY2l0IF9OZXN0ZWRfZXhj
ZXB0aW9uKF9FeGNlcHQmJiBfX2V4KQogICAgICA6IF9FeGNlcHQoc3RhdGljX2Nhc3Q8X0V4Y2Vw
dCYmPihfX2V4KSkKICAgICAgeyB9CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsCiAg
ICBib29sIF9fd2l0aF9uZXN0ZWQgPSAhX19pc19iYXNlX29mKG5lc3RlZF9leGNlcHRpb24sIF9U
cCk+CiAgICBzdHJ1Y3QgX1Rocm93X3dpdGhfbmVzdGVkX2ltcGwKICAgIHsKICAgICAgdGVtcGxh
dGU8dHlwZW5hbWUgX1VwPgogc3RhdGljIHZvaWQgX1NfdGhyb3coX1VwJiYgX190KQogeyB0aHJv
dyBfTmVzdGVkX2V4Y2VwdGlvbjxfVHA+e3N0YXRpY19jYXN0PF9VcCYmPihfX3QpfTsgfQogICAg
fTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9UaHJvd193aXRoX25lc3Rl
ZF9pbXBsPF9UcCwgZmFsc2U+CiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VcD4KIHN0
YXRpYyB2b2lkIF9TX3Rocm93KF9VcCYmIF9fdCkKIHsgdGhyb3cgc3RhdGljX2Nhc3Q8X1VwJiY+
KF9fdCk7IH0KICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgYm9vbCA9IF9faXNfY2xh
c3MoX1RwKSAmJiAhX19pc19maW5hbChfVHApPgogICAgc3RydWN0IF9UaHJvd193aXRoX25lc3Rl
ZF9oZWxwZXIgOiBfVGhyb3dfd2l0aF9uZXN0ZWRfaW1wbDxfVHA+CiAgICB7IH07CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfVGhyb3dfd2l0aF9uZXN0ZWRfaGVscGVyPF9U
cCwgZmFsc2U+CiAgICA6IF9UaHJvd193aXRoX25lc3RlZF9pbXBsPF9UcCwgZmFsc2U+CiAgICB7
IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfVGhyb3dfd2l0aF9uZXN0
ZWRfaGVscGVyPF9UcCYsIGZhbHNlPgogICAgOiBfVGhyb3dfd2l0aF9uZXN0ZWRfaGVscGVyPF9U
cD4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9UaHJvd193
aXRoX25lc3RlZF9oZWxwZXI8X1RwJiYsIGZhbHNlPgogICAgOiBfVGhyb3dfd2l0aF9uZXN0ZWRf
aGVscGVyPF9UcD4KICAgIHsgfTsKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBbW25v
cmV0dXJuXV0KICAgIGlubGluZSB2b2lkCiAgICB0aHJvd193aXRoX25lc3RlZChfVHAmJiBfX3Qp
CiAgICB7CiAgICAgIF9UaHJvd193aXRoX25lc3RlZF9oZWxwZXI8X1RwPjo6X1NfdGhyb3coc3Rh
dGljX2Nhc3Q8X1RwJiY+KF9fdCkpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIGJv
b2wgPSBfX2lzX3BvbHltb3JwaGljKF9UcCk+CiAgICBzdHJ1Y3QgX1JldGhyb3dfaWZfbmVzdGVk
X2ltcGwKICAgIHsKICAgICAgc3RhdGljIHZvaWQgX1NfcmV0aHJvdyhjb25zdCBfVHAmIF9fdCkK
ICAgICAgewogaWYgKGF1dG8gX190cCA9CiAgICAgICAgICAgIGR5bmFtaWNfY2FzdDxjb25zdCBu
ZXN0ZWRfZXhjZXB0aW9uKj4oc3RkOjpfX2FkZHJlc3NvZihfX3QpKSkKICAgX190cC0+cmV0aHJv
d19uZXN0ZWQoKTsKICAgICAgfQogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAg
c3RydWN0IF9SZXRocm93X2lmX25lc3RlZF9pbXBsPF9UcCwgZmFsc2U+CiAgICB7CiAgICAgIHN0
YXRpYyB2b2lkIF9TX3JldGhyb3coY29uc3QgX1RwJikgeyB9CiAgICB9OwoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0V4PgogICAgaW5saW5lIHZvaWQKICAgIHJldGhyb3dfaWZfbmVzdGVkKGNvbnN0
IF9FeCYgX19leCkKICAgIHsKICAgICAgX1JldGhyb3dfaWZfbmVzdGVkX2ltcGw8X0V4Pjo6X1Nf
cmV0aHJvdyhfX2V4KTsKICAgIH0KCgp9Cgp9CgoKCiNwcmFnbWEgR0NDIHZpc2liaWxpdHkgcG9w
CiMgMTcyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2V4Y2VwdGlvbiIgMiAzCiMgNDEgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvbmV3IiAyIDMKCiNwcmFnbWEgR0NDIHZpc2liaWxpdHkgcHVzaChk
ZWZhdWx0KQoKZXh0ZXJuICJDKysiIHsKCm5hbWVzcGFjZSBzdGQKewoKCgoKCgogIGNsYXNzIGJh
ZF9hbGxvYyA6IHB1YmxpYyBleGNlcHRpb24KICB7CiAgcHVibGljOgogICAgYmFkX2FsbG9jKCkg
dGhyb3coKSB7IH0KCgoKICAgIHZpcnR1YWwgfmJhZF9hbGxvYygpIHRocm93KCk7CgoKICAgIHZp
cnR1YWwgY29uc3QgY2hhciogd2hhdCgpIGNvbnN0IHRocm93KCk7CiAgfTsKCgogIGNsYXNzIGJh
ZF9hcnJheV9uZXdfbGVuZ3RoIDogcHVibGljIGJhZF9hbGxvYwogIHsKICBwdWJsaWM6CiAgICBi
YWRfYXJyYXlfbmV3X2xlbmd0aCgpIHRocm93KCkgeyB9OwoKCgogICAgdmlydHVhbCB+YmFkX2Fy
cmF5X25ld19sZW5ndGgoKSB0aHJvdygpOwoKCiAgICB2aXJ0dWFsIGNvbnN0IGNoYXIqIHdoYXQo
KSBjb25zdCB0aHJvdygpOwogIH07CgoKICBzdHJ1Y3Qgbm90aHJvd190CiAgewoKICAgIGV4cGxp
Y2l0IG5vdGhyb3dfdCgpID0gZGVmYXVsdDsKCiAgfTsKCiAgZXh0ZXJuIGNvbnN0IG5vdGhyb3df
dCBub3Rocm93OwoKCgogIHR5cGVkZWYgdm9pZCAoKm5ld19oYW5kbGVyKSgpOwoKCgogIG5ld19o
YW5kbGVyIHNldF9uZXdfaGFuZGxlcihuZXdfaGFuZGxlcikgdGhyb3coKTsKCgoKICBuZXdfaGFu
ZGxlciBnZXRfbmV3X2hhbmRsZXIoKSBub2V4Y2VwdDsKCn0KIyAxMTYgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvbmV3IiAzCnZvaWQqIG9wZXJhdG9yIG5ldyhzdGQ6OnNpemVfdCkKICBfX2F0dHJp
YnV0ZV9fKChfX2V4dGVybmFsbHlfdmlzaWJsZV9fKSk7CnZvaWQqIG9wZXJhdG9yIG5ld1tdKHN0
ZDo6c2l6ZV90KQogIF9fYXR0cmlidXRlX18oKF9fZXh0ZXJuYWxseV92aXNpYmxlX18pKTsKdm9p
ZCBvcGVyYXRvciBkZWxldGUodm9pZCopIG5vZXhjZXB0CiAgX19hdHRyaWJ1dGVfXygoX19leHRl
cm5hbGx5X3Zpc2libGVfXykpOwp2b2lkIG9wZXJhdG9yIGRlbGV0ZVtdKHZvaWQqKSBub2V4Y2Vw
dAogIF9fYXR0cmlidXRlX18oKF9fZXh0ZXJuYWxseV92aXNpYmxlX18pKTsKCgoKCgoKdm9pZCog
b3BlcmF0b3IgbmV3KHN0ZDo6c2l6ZV90LCBjb25zdCBzdGQ6Om5vdGhyb3dfdCYpIG5vZXhjZXB0
CiAgX19hdHRyaWJ1dGVfXygoX19leHRlcm5hbGx5X3Zpc2libGVfXykpOwp2b2lkKiBvcGVyYXRv
ciBuZXdbXShzdGQ6OnNpemVfdCwgY29uc3Qgc3RkOjpub3Rocm93X3QmKSBub2V4Y2VwdAogIF9f
YXR0cmlidXRlX18oKF9fZXh0ZXJuYWxseV92aXNpYmxlX18pKTsKdm9pZCBvcGVyYXRvciBkZWxl
dGUodm9pZCosIGNvbnN0IHN0ZDo6bm90aHJvd190Jikgbm9leGNlcHQKICBfX2F0dHJpYnV0ZV9f
KChfX2V4dGVybmFsbHlfdmlzaWJsZV9fKSk7CnZvaWQgb3BlcmF0b3IgZGVsZXRlW10odm9pZCos
IGNvbnN0IHN0ZDo6bm90aHJvd190Jikgbm9leGNlcHQKICBfX2F0dHJpYnV0ZV9fKChfX2V4dGVy
bmFsbHlfdmlzaWJsZV9fKSk7CiMgMTQ2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL25ldyIgMwpp
bmxpbmUgdm9pZCogb3BlcmF0b3IgbmV3KHN0ZDo6c2l6ZV90LCB2b2lkKiBfX3ApIG5vZXhjZXB0
CnsgcmV0dXJuIF9fcDsgfQppbmxpbmUgdm9pZCogb3BlcmF0b3IgbmV3W10oc3RkOjpzaXplX3Qs
IHZvaWQqIF9fcCkgbm9leGNlcHQKeyByZXR1cm4gX19wOyB9CgoKaW5saW5lIHZvaWQgb3BlcmF0
b3IgZGVsZXRlICh2b2lkKiwgdm9pZCopIG5vZXhjZXB0IHsgfQppbmxpbmUgdm9pZCBvcGVyYXRv
ciBkZWxldGVbXSh2b2lkKiwgdm9pZCopIG5vZXhjZXB0IHsgfQoKfQoKI3ByYWdtYSBHQ0Mgdmlz
aWJpbGl0eSBwb3AKIyAzNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leHQvbmV3X2FsbG9jYXRv
ci5oIiAyIDMKCgoKCgoKbmFtZXNwYWNlIF9fZ251X2N4eCBfX2F0dHJpYnV0ZV9fICgoX192aXNp
YmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoKICB1c2luZyBzdGQ6OnNpemVfdDsKICB1c2luZyBz
dGQ6OnB0cmRpZmZfdDsKIyA1NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leHQvbmV3X2FsbG9j
YXRvci5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgY2xhc3MgbmV3X2FsbG9jYXRv
cgogICAgewogICAgcHVibGljOgogICAgICB0eXBlZGVmIHNpemVfdCBzaXplX3R5cGU7CiAgICAg
IHR5cGVkZWYgcHRyZGlmZl90IGRpZmZlcmVuY2VfdHlwZTsKICAgICAgdHlwZWRlZiBfVHAqIHBv
aW50ZXI7CiAgICAgIHR5cGVkZWYgY29uc3QgX1RwKiBjb25zdF9wb2ludGVyOwogICAgICB0eXBl
ZGVmIF9UcCYgcmVmZXJlbmNlOwogICAgICB0eXBlZGVmIGNvbnN0IF9UcCYgY29uc3RfcmVmZXJl
bmNlOwogICAgICB0eXBlZGVmIF9UcCB2YWx1ZV90eXBlOwoKICAgICAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwMT4KICAgICAgICBzdHJ1Y3QgcmViaW5kCiAgICAgICAgeyB0eXBlZGVmIG5ld19hbGxv
Y2F0b3I8X1RwMT4gb3RoZXI7IH07CgoKCgogICAgICB0eXBlZGVmIHN0ZDo6dHJ1ZV90eXBlIHBy
b3BhZ2F0ZV9vbl9jb250YWluZXJfbW92ZV9hc3NpZ25tZW50OwoKCiAgICAgIG5ld19hbGxvY2F0
b3IoKSBub2V4Y2VwdCB7IH0KCiAgICAgIG5ld19hbGxvY2F0b3IoY29uc3QgbmV3X2FsbG9jYXRv
ciYpIG5vZXhjZXB0IHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KICAgICAgICBu
ZXdfYWxsb2NhdG9yKGNvbnN0IG5ld19hbGxvY2F0b3I8X1RwMT4mKSBub2V4Y2VwdCB7IH0KCiAg
ICAgIH5uZXdfYWxsb2NhdG9yKCkgbm9leGNlcHQgeyB9CgogICAgICBwb2ludGVyCiAgICAgIGFk
ZHJlc3MocmVmZXJlbmNlIF9feCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc3RkOjpf
X2FkZHJlc3NvZihfX3gpOyB9CgogICAgICBjb25zdF9wb2ludGVyCiAgICAgIGFkZHJlc3MoY29u
c3RfcmVmZXJlbmNlIF9feCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc3RkOjpfX2Fk
ZHJlc3NvZihfX3gpOyB9CgoKCiAgICAgIHBvaW50ZXIKICAgICAgYWxsb2NhdGUoc2l6ZV90eXBl
IF9fbiwgY29uc3Qgdm9pZCogPSAwKQogICAgICB7CiBpZiAoX19uID4gdGhpcy0+bWF4X3NpemUo
KSkKICAgc3RkOjpfX3Rocm93X2JhZF9hbGxvYygpOwoKIHJldHVybiBzdGF0aWNfY2FzdDxfVHAq
Pig6Om9wZXJhdG9yIG5ldyhfX24gKiBzaXplb2YoX1RwKSkpOwogICAgICB9CgoKICAgICAgdm9p
ZAogICAgICBkZWFsbG9jYXRlKHBvaW50ZXIgX19wLCBzaXplX3R5cGUpCiAgICAgIHsgOjpvcGVy
YXRvciBkZWxldGUoX19wKTsgfQoKICAgICAgc2l6ZV90eXBlCiAgICAgIG1heF9zaXplKCkgY29u
c3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc2l6ZV90KC0xKSAvIHNpemVvZihfVHApOyB9CgoK
ICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1VwLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgICAgICB2
b2lkCiAgICAgICAgY29uc3RydWN0KF9VcCogX19wLCBfQXJncyYmLi4uIF9fYXJncykKIHsgOjpu
ZXcoKHZvaWQgKilfX3ApIF9VcChzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pOyB9Cgog
ICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVXA+CiAgICAgICAgdm9pZAogICAgICAgIGRlc3Ryb3ko
X1VwKiBfX3ApIHsgX19wLT5+X1VwKCk7IH0KIyAxMzUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
ZXh0L25ld19hbGxvY2F0b3IuaCIgMwogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgog
ICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPT0oY29uc3QgbmV3X2FsbG9jYXRvcjxfVHA+Jiwg
Y29uc3QgbmV3X2FsbG9jYXRvcjxfVHA+JikKICAgIHsgcmV0dXJuIHRydWU7IH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yIT0oY29uc3QgbmV3
X2FsbG9jYXRvcjxfVHA+JiwgY29uc3QgbmV3X2FsbG9jYXRvcjxfVHA+JikKICAgIHsgcmV0dXJu
IGZhbHNlOyB9CgoKfQojIDM0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1s
aW51eC9iaXRzL2MrK2FsbG9jYXRvci5oIiAyIDMKCgpuYW1lc3BhY2Ugc3RkCnsKIyA0NyAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9jKythbGxvY2F0b3Iu
aCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHVzaW5nIF9fYWxsb2NhdG9yX2Jhc2Ug
PSBfX2dudV9jeHg6Om5ld19hbGxvY2F0b3I8X1RwPjsKfQojIDQ3ICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvYWxsb2NhdG9yLmgiIDIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9tZW1vcnlmd2QuaCIgMSAzCiMgNDYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9t
ZW1vcnlmd2QuaCIgMwogICAgICAgCiMgNDcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9t
ZW1vcnlmd2QuaCIgMwoKCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxp
dHlfXyAoImRlZmF1bHQiKSkpCnsKCiMgNjMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9t
ZW1vcnlmd2QuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lPgogICAgY2xhc3MgYWxsb2NhdG9yOwoK
ICB0ZW1wbGF0ZTw+CiAgICBjbGFzcyBhbGxvY2F0b3I8dm9pZD47CgoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSwgdHlwZW5hbWU+CiAgICBzdHJ1Y3QgdXNlc19hbGxvY2F0b3I7CgoKCgp9CiMgNDggIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9hbGxvY2F0b3IuaCIgMiAzCgoKCgpuYW1lc3BhY2Ug
c3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgoKCgoK
CgogIHRlbXBsYXRlPD4KICAgIGNsYXNzIGFsbG9jYXRvcjx2b2lkPgogICAgewogICAgcHVibGlj
OgogICAgICB0eXBlZGVmIHNpemVfdCBzaXplX3R5cGU7CiAgICAgIHR5cGVkZWYgcHRyZGlmZl90
IGRpZmZlcmVuY2VfdHlwZTsKICAgICAgdHlwZWRlZiB2b2lkKiBwb2ludGVyOwogICAgICB0eXBl
ZGVmIGNvbnN0IHZvaWQqIGNvbnN0X3BvaW50ZXI7CiAgICAgIHR5cGVkZWYgdm9pZCB2YWx1ZV90
eXBlOwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KICAgICAgICBzdHJ1Y3QgcmViaW5k
CiAgICAgICAgeyB0eXBlZGVmIGFsbG9jYXRvcjxfVHAxPiBvdGhlcjsgfTsKCgoKCiAgICAgIHR5
cGVkZWYgdHJ1ZV90eXBlIHByb3BhZ2F0ZV9vbl9jb250YWluZXJfbW92ZV9hc3NpZ25tZW50OwoK
CiAgICAgIHR5cGVkZWYgdHJ1ZV90eXBlIGlzX2Fsd2F5c19lcXVhbDsKCiAgICB9OwojIDk0ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYWxsb2NhdG9yLmgiIDMKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHA+CiAgICBjbGFzcyBhbGxvY2F0b3I6IHB1YmxpYyBfX2FsbG9jYXRvcl9iYXNlPF9U
cD4KICAgIHsKICAgcHVibGljOgogICAgICB0eXBlZGVmIHNpemVfdCBzaXplX3R5cGU7CiAgICAg
IHR5cGVkZWYgcHRyZGlmZl90IGRpZmZlcmVuY2VfdHlwZTsKICAgICAgdHlwZWRlZiBfVHAqIHBv
aW50ZXI7CiAgICAgIHR5cGVkZWYgY29uc3QgX1RwKiBjb25zdF9wb2ludGVyOwogICAgICB0eXBl
ZGVmIF9UcCYgcmVmZXJlbmNlOwogICAgICB0eXBlZGVmIGNvbnN0IF9UcCYgY29uc3RfcmVmZXJl
bmNlOwogICAgICB0eXBlZGVmIF9UcCB2YWx1ZV90eXBlOwoKICAgICAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwMT4KICAgICAgICBzdHJ1Y3QgcmViaW5kCiAgICAgICAgeyB0eXBlZGVmIGFsbG9jYXRv
cjxfVHAxPiBvdGhlcjsgfTsKCgoKCiAgICAgIHR5cGVkZWYgdHJ1ZV90eXBlIHByb3BhZ2F0ZV9v
bl9jb250YWluZXJfbW92ZV9hc3NpZ25tZW50OwoKCiAgICAgIGFsbG9jYXRvcigpIHRocm93KCkg
eyB9CgogICAgICBhbGxvY2F0b3IoY29uc3QgYWxsb2NhdG9yJiBfX2EpIHRocm93KCkKICAgICAg
OiBfX2FsbG9jYXRvcl9iYXNlPF9UcD4oX19hKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcDE+CiAgICAgICAgYWxsb2NhdG9yKGNvbnN0IGFsbG9jYXRvcjxfVHAxPiYpIHRocm93KCkg
eyB9CgogICAgICB+YWxsb2NhdG9yKCkgdGhyb3coKSB7IH0KCgogICAgfTsKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX1QxLCB0eXBlbmFtZSBfVDI+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I9
PShjb25zdCBhbGxvY2F0b3I8X1QxPiYsIGNvbnN0IGFsbG9jYXRvcjxfVDI+JikKICAgIG5vZXhj
ZXB0CiAgICB7IHJldHVybiB0cnVlOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGlu
bGluZSBib29sCiAgICBvcGVyYXRvcj09KGNvbnN0IGFsbG9jYXRvcjxfVHA+JiwgY29uc3QgYWxs
b2NhdG9yPF9UcD4mKQogICAgbm9leGNlcHQKICAgIHsgcmV0dXJuIHRydWU7IH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1QxLCB0eXBlbmFtZSBfVDI+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0
b3IhPShjb25zdCBhbGxvY2F0b3I8X1QxPiYsIGNvbnN0IGFsbG9jYXRvcjxfVDI+JikKICAgIG5v
ZXhjZXB0CiAgICB7IHJldHVybiBmYWxzZTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAg
ICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3IhPShjb25zdCBhbGxvY2F0b3I8X1RwPiYsIGNvbnN0
IGFsbG9jYXRvcjxfVHA+JikKICAgIG5vZXhjZXB0CiAgICB7IHJldHVybiBmYWxzZTsgfQoKCgoK
CgogIGV4dGVybiB0ZW1wbGF0ZSBjbGFzcyBhbGxvY2F0b3I8Y2hhcj47CiAgZXh0ZXJuIHRlbXBs
YXRlIGNsYXNzIGFsbG9jYXRvcjx3Y2hhcl90PjsKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
QWxsb2MsIGJvb2wgPSBfX2lzX2VtcHR5KF9BbGxvYyk+CiAgICBzdHJ1Y3QgX19hbGxvY19zd2Fw
CiAgICB7IHN0YXRpYyB2b2lkIF9TX2RvX2l0KF9BbGxvYyYsIF9BbGxvYyYpIG5vZXhjZXB0IHsg
fSB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2M+CiAgICBzdHJ1Y3QgX19hbGxvY19zd2Fw
PF9BbGxvYywgZmFsc2U+CiAgICB7CiAgICAgIHN0YXRpYyB2b2lkCiAgICAgIF9TX2RvX2l0KF9B
bGxvYyYgX19vbmUsIF9BbGxvYyYgX190d28pIG5vZXhjZXB0CiAgICAgIHsKCiBpZiAoX19vbmUg
IT0gX190d28pCiAgIHN3YXAoX19vbmUsIF9fdHdvKTsKICAgICAgfQogICAgfTsKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9BbGxvYywgYm9vbCA9IF9faXNfZW1wdHkoX0FsbG9jKT4KICAgIHN0cnVj
dCBfX2FsbG9jX25lcQogICAgewogICAgICBzdGF0aWMgYm9vbAogICAgICBfU19kb19pdChjb25z
dCBfQWxsb2MmLCBjb25zdCBfQWxsb2MmKQogICAgICB7IHJldHVybiBmYWxzZTsgfQogICAgfTsK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogICAgc3RydWN0IF9fYWxsb2NfbmVxPF9BbGxv
YywgZmFsc2U+CiAgICB7CiAgICAgIHN0YXRpYyBib29sCiAgICAgIF9TX2RvX2l0KGNvbnN0IF9B
bGxvYyYgX19vbmUsIGNvbnN0IF9BbGxvYyYgX190d28pCiAgICAgIHsgcmV0dXJuIF9fb25lICE9
IF9fdHdvOyB9CiAgICB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBib29sCiAgICA9IF9f
b3JfPGlzX2NvcHlfY29uc3RydWN0aWJsZTx0eXBlbmFtZSBfVHA6OnZhbHVlX3R5cGU+LAogICAg
ICAgICAgICBpc19ub3Rocm93X21vdmVfY29uc3RydWN0aWJsZTx0eXBlbmFtZSBfVHA6OnZhbHVl
X3R5cGU+Pjo6dmFsdWU+CiAgICBzdHJ1Y3QgX19zaHJpbmtfdG9fZml0X2F1eAogICAgeyBzdGF0
aWMgYm9vbCBfU19kb19pdChfVHAmKSBub2V4Y2VwdCB7IHJldHVybiBmYWxzZTsgfSB9OwoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19zaHJpbmtfdG9fZml0X2F1eDxfVHAs
IHRydWU+CiAgICB7CiAgICAgIHN0YXRpYyBib29sCiAgICAgIF9TX2RvX2l0KF9UcCYgX19jKSBu
b2V4Y2VwdAogICAgICB7CgogdHJ5CiAgIHsKICAgICBfVHAoX19tYWtlX21vdmVfaWZfbm9leGNl
cHRfaXRlcmF0b3IoX19jLmJlZ2luKCkpLAogIF9fbWFrZV9tb3ZlX2lmX25vZXhjZXB0X2l0ZXJh
dG9yKF9fYy5lbmQoKSksCiAgX19jLmdldF9hbGxvY2F0b3IoKSkuc3dhcChfX2MpOwogICAgIHJl
dHVybiB0cnVlOwogICB9CiBjYXRjaCguLi4pCiAgIHsgcmV0dXJuIGZhbHNlOyB9CgoKCiAgICAg
IH0KICAgIH07CgoKCn0KIyA2MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9saXN0IiAyIDMKIyAx
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvcmFuZ2VfYWNjZXNzLmgiIDEgMwojIDMzICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvcmFuZ2VfYWNjZXNzLmgiIDMKICAgICAgIAojIDM0
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvcmFuZ2VfYWNjZXNzLmgiIDMKCgojIDEgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvaW5pdGlhbGl6ZXJfbGlzdCIgMSAzCiMgMzMgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvaW5pdGlhbGl6ZXJfbGlzdCIgMwogICAgICAgCiMgMzQgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvaW5pdGlhbGl6ZXJfbGlzdCIgMwoKCgoKCiNwcmFnbWEgR0NDIHZpc2li
aWxpdHkgcHVzaChkZWZhdWx0KQoKCgpuYW1lc3BhY2Ugc3RkCnsKCiAgdGVtcGxhdGU8Y2xhc3Mg
X0U+CiAgICBjbGFzcyBpbml0aWFsaXplcl9saXN0CiAgICB7CiAgICBwdWJsaWM6CiAgICAgIHR5
cGVkZWYgX0UgdmFsdWVfdHlwZTsKICAgICAgdHlwZWRlZiBjb25zdCBfRSYgcmVmZXJlbmNlOwog
ICAgICB0eXBlZGVmIGNvbnN0IF9FJiBjb25zdF9yZWZlcmVuY2U7CiAgICAgIHR5cGVkZWYgc2l6
ZV90IHNpemVfdHlwZTsKICAgICAgdHlwZWRlZiBjb25zdCBfRSogaXRlcmF0b3I7CiAgICAgIHR5
cGVkZWYgY29uc3QgX0UqIGNvbnN0X2l0ZXJhdG9yOwoKICAgIHByaXZhdGU6CiAgICAgIGl0ZXJh
dG9yIF9NX2FycmF5OwogICAgICBzaXplX3R5cGUgX01fbGVuOwoKCiAgICAgIGNvbnN0ZXhwciBp
bml0aWFsaXplcl9saXN0KGNvbnN0X2l0ZXJhdG9yIF9fYSwgc2l6ZV90eXBlIF9fbCkKICAgICAg
OiBfTV9hcnJheShfX2EpLCBfTV9sZW4oX19sKSB7IH0KCiAgICBwdWJsaWM6CiAgICAgIGNvbnN0
ZXhwciBpbml0aWFsaXplcl9saXN0KCkgbm9leGNlcHQKICAgICAgOiBfTV9hcnJheSgwKSwgX01f
bGVuKDApIHsgfQoKCiAgICAgIGNvbnN0ZXhwciBzaXplX3R5cGUKICAgICAgc2l6ZSgpIGNvbnN0
IG5vZXhjZXB0IHsgcmV0dXJuIF9NX2xlbjsgfQoKCiAgICAgIGNvbnN0ZXhwciBjb25zdF9pdGVy
YXRvcgogICAgICBiZWdpbigpIGNvbnN0IG5vZXhjZXB0IHsgcmV0dXJuIF9NX2FycmF5OyB9CgoK
ICAgICAgY29uc3RleHByIGNvbnN0X2l0ZXJhdG9yCiAgICAgIGVuZCgpIGNvbnN0IG5vZXhjZXB0
IHsgcmV0dXJuIGJlZ2luKCkgKyBzaXplKCk7IH0KICAgIH07CgoKCgoKCiAgdGVtcGxhdGU8Y2xh
c3MgX1RwPgogICAgY29uc3RleHByIGNvbnN0IF9UcCoKICAgIGJlZ2luKGluaXRpYWxpemVyX2xp
c3Q8X1RwPiBfX2lscykgbm9leGNlcHQKICAgIHsgcmV0dXJuIF9faWxzLmJlZ2luKCk7IH0KCgoK
CgoKICB0ZW1wbGF0ZTxjbGFzcyBfVHA+CiAgICBjb25zdGV4cHIgY29uc3QgX1RwKgogICAgZW5k
KGluaXRpYWxpemVyX2xpc3Q8X1RwPiBfX2lscykgbm9leGNlcHQKICAgIHsgcmV0dXJuIF9faWxz
LmVuZCgpOyB9Cn0KCiNwcmFnbWEgR0NDIHZpc2liaWxpdHkgcG9wCiMgMzcgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYml0cy9yYW5nZV9hY2Nlc3MuaCIgMiAzCm5hbWVzcGFjZSBzdGQgX19hdHRy
aWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCgoKCgoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfQ29udGFpbmVyPgogICAgaW5saW5lIGF1dG8KICAgIGJlZ2luKF9Db250YWlu
ZXImIF9fY29udCkgLT4gZGVjbHR5cGUoX19jb250LmJlZ2luKCkpCiAgICB7IHJldHVybiBfX2Nv
bnQuYmVnaW4oKTsgfQoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Db250YWluZXI+CiAgICBp
bmxpbmUgYXV0bwogICAgYmVnaW4oY29uc3QgX0NvbnRhaW5lciYgX19jb250KSAtPiBkZWNsdHlw
ZShfX2NvbnQuYmVnaW4oKSkKICAgIHsgcmV0dXJuIF9fY29udC5iZWdpbigpOyB9CgoKCgoKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0NvbnRhaW5lcj4KICAgIGlubGluZSBhdXRvCiAgICBlbmQoX0Nv
bnRhaW5lciYgX19jb250KSAtPiBkZWNsdHlwZShfX2NvbnQuZW5kKCkpCiAgICB7IHJldHVybiBf
X2NvbnQuZW5kKCk7IH0KCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ29udGFpbmVyPgogICAg
aW5saW5lIGF1dG8KICAgIGVuZChjb25zdCBfQ29udGFpbmVyJiBfX2NvbnQpIC0+IGRlY2x0eXBl
KF9fY29udC5lbmQoKSkKICAgIHsgcmV0dXJuIF9fY29udC5lbmQoKTsgfQoKCgoKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwLCBzaXplX3QgX05tPgogICAgaW5saW5lIF9UcCoKICAgIGJlZ2luKF9U
cCAoJl9fYXJyKVtfTm1dKQogICAgeyByZXR1cm4gX19hcnI7IH0KCgoKCgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHAsIHNpemVfdCBfTm0+CiAgICBpbmxpbmUgX1RwKgogICAgZW5kKF9UcCAoJl9f
YXJyKVtfTm1dKQogICAgeyByZXR1cm4gX19hcnIgKyBfTm07IH0KIyAzMTkgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYml0cy9yYW5nZV9hY2Nlc3MuaCIgMwoKfQojIDYzICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2xpc3QiIDIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxf
bGlzdC5oIiAxIDMKIyA2MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9saXN0Lmgi
IDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2V4dC9hbGxvY190cmFpdHMuaCIgMSAzCiMg
MzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZXh0L2FsbG9jX3RyYWl0cy5oIiAzCiAgICAgICAK
IyAzMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leHQvYWxsb2NfdHJhaXRzLmgiIDMKCgoKIyAx
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYWxsb2NfdHJhaXRzLmgiIDEgMwojIDQxICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYWxsb2NfdHJhaXRzLmgiIDMKbmFtZXNwYWNlIHN0
ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoKICBzdHJ1
Y3QgX19hbGxvY2F0b3JfdHJhaXRzX2Jhc2UKICB7CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxs
b2MsIHR5cGVuYW1lIF9VcD4KICAgICAgdXNpbmcgX19yZWJpbmQgPSB0eXBlbmFtZSBfQWxsb2M6
OnRlbXBsYXRlIHJlYmluZDxfVXA+OjpvdGhlcjsKCiAgcHJvdGVjdGVkOgogICAgdGVtcGxhdGU8
dHlwZW5hbWUgX1RwPgogICAgICB1c2luZyBfX3BvaW50ZXIgPSB0eXBlbmFtZSBfVHA6OnBvaW50
ZXI7CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICAgIHVzaW5nIF9fY19wb2ludGVyID0g
dHlwZW5hbWUgX1RwOjpjb25zdF9wb2ludGVyOwogICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgog
ICAgICB1c2luZyBfX3ZfcG9pbnRlciA9IHR5cGVuYW1lIF9UcDo6dm9pZF9wb2ludGVyOwogICAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgICB1c2luZyBfX2N2X3BvaW50ZXIgPSB0eXBlbmFt
ZSBfVHA6OmNvbnN0X3ZvaWRfcG9pbnRlcjsKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
ICAgdXNpbmcgX19kaWZmX3R5cGUgPSB0eXBlbmFtZSBfVHA6OmRpZmZlcmVuY2VfdHlwZTsKICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgICAgdXNpbmcgX19zaXplX3R5cGUgPSB0eXBlbmFt
ZSBfVHA6OnNpemVfdHlwZTsKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgICAgdXNpbmcg
X19wb2NjYSA9IHR5cGVuYW1lIF9UcDo6cHJvcGFnYXRlX29uX2NvbnRhaW5lcl9jb3B5X2Fzc2ln
bm1lbnQ7CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICAgIHVzaW5nIF9fcG9jbWEgPSB0
eXBlbmFtZSBfVHA6OnByb3BhZ2F0ZV9vbl9jb250YWluZXJfbW92ZV9hc3NpZ25tZW50OwogICAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgICB1c2luZyBfX3BvY3MgPSB0eXBlbmFtZSBfVHA6
OnByb3BhZ2F0ZV9vbl9jb250YWluZXJfc3dhcDsKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4K
ICAgICAgdXNpbmcgX19lcXVhbCA9IHR5cGVuYW1lIF9UcDo6aXNfYWx3YXlzX2VxdWFsOwogIH07
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUgX1VwPgogICAgdXNpbmcgX19h
bGxvY19yZWJpbmQgPSBfX2RldGVjdGVkX29yX3RfPF9fcmVwbGFjZV9maXJzdF9hcmdfdCwKICAg
ICAgICAgX19hbGxvY2F0b3JfdHJhaXRzX2Jhc2U6Ol9fcmViaW5kLAogICAgICAgICBfQWxsb2Ms
IF9VcD47CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2M+CiAgICBzdHJ1Y3QgYWxsb2Nh
dG9yX3RyYWl0cyA6IF9fYWxsb2NhdG9yX3RyYWl0c19iYXNlCiAgICB7CgogICAgICB0eXBlZGVm
IF9BbGxvYyBhbGxvY2F0b3JfdHlwZTsKCiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0FsbG9jOjp2
YWx1ZV90eXBlIHZhbHVlX3R5cGU7CgoKCgoKCiAgICAgIHVzaW5nIHBvaW50ZXIgPSBfX2RldGVj
dGVkX29yX3Q8dmFsdWVfdHlwZSosIF9fcG9pbnRlciwgX0FsbG9jPjsKCgoKCgoKCiAgICAgIHVz
aW5nIGNvbnN0X3BvaW50ZXIKID0gX19kZXRlY3RlZF9vcl90PF9fcHRyX3JlYmluZDxwb2ludGVy
LCBjb25zdCB2YWx1ZV90eXBlPiwKICAgICBfX2NfcG9pbnRlciwgX0FsbG9jPjsKCgoKCgoKCiAg
ICAgIHVzaW5nIHZvaWRfcG9pbnRlcgogPSBfX2RldGVjdGVkX29yX3Q8X19wdHJfcmViaW5kPHBv
aW50ZXIsIHZvaWQ+LCBfX3ZfcG9pbnRlciwgX0FsbG9jPjsKCgoKCgoKCiAgICAgIHVzaW5nIGNv
bnN0X3ZvaWRfcG9pbnRlcgogPSBfX2RldGVjdGVkX29yX3Q8X19wdHJfcmViaW5kPHBvaW50ZXIs
IGNvbnN0IHZvaWQ+LCBfX2N2X3BvaW50ZXIsCiAgICAgX0FsbG9jPjsKCgoKCgoKCiAgICAgIHVz
aW5nIGRpZmZlcmVuY2VfdHlwZQogPSBfX2RldGVjdGVkX29yX3Q8dHlwZW5hbWUgcG9pbnRlcl90
cmFpdHM8cG9pbnRlcj46OmRpZmZlcmVuY2VfdHlwZSwKICAgICBfX2RpZmZfdHlwZSwgX0FsbG9j
PjsKCgoKCgoKCiAgICAgIHVzaW5nIHNpemVfdHlwZQogPSBfX2RldGVjdGVkX29yX3Q8dHlwZW5h
bWUgbWFrZV91bnNpZ25lZDxkaWZmZXJlbmNlX3R5cGU+Ojp0eXBlLAogICAgIF9fc2l6ZV90eXBl
LCBfQWxsb2M+OwoKCgoKCgoKICAgICAgdXNpbmcgcHJvcGFnYXRlX29uX2NvbnRhaW5lcl9jb3B5
X2Fzc2lnbm1lbnQKID0gX19kZXRlY3RlZF9vcl90PGZhbHNlX3R5cGUsIF9fcG9jY2EsIF9BbGxv
Yz47CgoKCgoKCgogICAgICB1c2luZyBwcm9wYWdhdGVfb25fY29udGFpbmVyX21vdmVfYXNzaWdu
bWVudAogPSBfX2RldGVjdGVkX29yX3Q8ZmFsc2VfdHlwZSwgX19wb2NtYSwgX0FsbG9jPjsKCgoK
CgoKCiAgICAgIHVzaW5nIHByb3BhZ2F0ZV9vbl9jb250YWluZXJfc3dhcAogPSBfX2RldGVjdGVk
X29yX3Q8ZmFsc2VfdHlwZSwgX19wb2NzLCBfQWxsb2M+OwoKCgoKCgoKICAgICAgdXNpbmcgaXNf
YWx3YXlzX2VxdWFsCiA9IF9fZGV0ZWN0ZWRfb3JfdDx0eXBlbmFtZSBpc19lbXB0eTxfQWxsb2M+
Ojp0eXBlLCBfX2VxdWFsLCBfQWxsb2M+OwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgog
dXNpbmcgcmViaW5kX2FsbG9jID0gX19hbGxvY19yZWJpbmQ8X0FsbG9jLCBfVHA+OwogICAgICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiB1c2luZyByZWJpbmRfdHJhaXRzID0gYWxsb2NhdG9yX3Ry
YWl0czxyZWJpbmRfYWxsb2M8X1RwPj47CgogICAgICBzdGF0aWNfYXNzZXJ0KCFpc19zYW1lPHJl
YmluZF9hbGxvYzx2YWx1ZV90eXBlPiwgX191bmRlZmluZWQ+Ojp2YWx1ZSwKICAgImFsbG9jYXRv
ciBkZWZpbmVzIHJlYmluZCBvciBpcyBsaWtlIEFsbG9jPFQsIEFyZ3M+Iik7CgogICAgcHJpdmF0
ZToKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jMj4KIHN0YXRpYyBhdXRvCiBfU19hbGxv
Y2F0ZShfQWxsb2MyJiBfX2EsIHNpemVfdHlwZSBfX24sIGNvbnN0X3ZvaWRfcG9pbnRlciBfX2hp
bnQsIGludCkKIC0+IGRlY2x0eXBlKF9fYS5hbGxvY2F0ZShfX24sIF9faGludCkpCiB7IHJldHVy
biBfX2EuYWxsb2NhdGUoX19uLCBfX2hpbnQpOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
QWxsb2MyPgogc3RhdGljIHBvaW50ZXIKIF9TX2FsbG9jYXRlKF9BbGxvYzImIF9fYSwgc2l6ZV90
eXBlIF9fbiwgY29uc3Rfdm9pZF9wb2ludGVyLCAuLi4pCiB7IHJldHVybiBfX2EuYWxsb2NhdGUo
X19uKTsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZS4uLiBfQXJncz4K
IHN0cnVjdCBfX2NvbnN0cnVjdF9oZWxwZXIKIHsKICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9j
MiwKICAgICB0eXBlbmFtZSA9IGRlY2x0eXBlKHN0ZDo6ZGVjbHZhbDxfQWxsb2MyKj4oKS0+Y29u
c3RydWN0KAogICAgc3RkOjpkZWNsdmFsPF9UcCo+KCksIHN0ZDo6ZGVjbHZhbDxfQXJncz4oKS4u
LikpPgogICAgIHN0YXRpYyB0cnVlX3R5cGUgX190ZXN0KGludCk7CgogICB0ZW1wbGF0ZTx0eXBl
bmFtZT4KICAgICBzdGF0aWMgZmFsc2VfdHlwZSBfX3Rlc3QoLi4uKTsKCiAgIHVzaW5nIHR5cGUg
PSBkZWNsdHlwZShfX3Rlc3Q8X0FsbG9jPigwKSk7CiB9OwoKICAgICAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwLCB0eXBlbmFtZS4uLiBfQXJncz4KIHVzaW5nIF9faGFzX2NvbnN0cnVjdAogICA9IHR5
cGVuYW1lIF9fY29uc3RydWN0X2hlbHBlcjxfVHAsIF9BcmdzLi4uPjo6dHlwZTsKCiAgICAgIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUuLi4gX0FyZ3M+CiBzdGF0aWMgX1JlcXVpcmU8
X19oYXNfY29uc3RydWN0PF9UcCwgX0FyZ3MuLi4+PgogX1NfY29uc3RydWN0KF9BbGxvYyYgX19h
LCBfVHAqIF9fcCwgX0FyZ3MmJi4uLiBfX2FyZ3MpCiB7IF9fYS5jb25zdHJ1Y3QoX19wLCBzdGQ6
OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHAsIHR5cGVuYW1lLi4uIF9BcmdzPgogc3RhdGljCiBfUmVxdWlyZTxfX2FuZF88X19ub3RfPF9f
aGFzX2NvbnN0cnVjdDxfVHAsIF9BcmdzLi4uPj4sCiAgICAgICAgICBpc19jb25zdHJ1Y3RpYmxl
PF9UcCwgX0FyZ3MuLi4+Pj4KIF9TX2NvbnN0cnVjdChfQWxsb2MmLCBfVHAqIF9fcCwgX0FyZ3Mm
Ji4uLiBfX2FyZ3MpCiB7IDo6bmV3KCh2b2lkKilfX3ApIF9UcChzdGQ6OmZvcndhcmQ8X0FyZ3M+
KF9fYXJncykuLi4pOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2MyLCB0eXBlbmFt
ZSBfVHA+CiBzdGF0aWMgYXV0bwogX1NfZGVzdHJveShfQWxsb2MyJiBfX2EsIF9UcCogX19wLCBp
bnQpCiAtPiBkZWNsdHlwZShfX2EuZGVzdHJveShfX3ApKQogeyBfX2EuZGVzdHJveShfX3ApOyB9
CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2MyLCB0eXBlbmFtZSBfVHA+CiBzdGF0aWMg
dm9pZAogX1NfZGVzdHJveShfQWxsb2MyJiwgX1RwKiBfX3AsIC4uLikKIHsgX19wLT5+X1RwKCk7
IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYzI+CiBzdGF0aWMgYXV0bwogX1NfbWF4
X3NpemUoX0FsbG9jMiYgX19hLCBpbnQpCiAtPiBkZWNsdHlwZShfX2EubWF4X3NpemUoKSkKIHsg
cmV0dXJuIF9fYS5tYXhfc2l6ZSgpOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2My
Pgogc3RhdGljIHNpemVfdHlwZQogX1NfbWF4X3NpemUoX0FsbG9jMiYsIC4uLikKIHsKCgogICBy
ZXR1cm4gX19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPHNpemVfdHlwZT46Ol9fbWF4CiAgICAg
LyBzaXplb2YodmFsdWVfdHlwZSk7CiB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2My
Pgogc3RhdGljIGF1dG8KIF9TX3NlbGVjdChfQWxsb2MyJiBfX2EsIGludCkKIC0+IGRlY2x0eXBl
KF9fYS5zZWxlY3Rfb25fY29udGFpbmVyX2NvcHlfY29uc3RydWN0aW9uKCkpCiB7IHJldHVybiBf
X2Euc2VsZWN0X29uX2NvbnRhaW5lcl9jb3B5X2NvbnN0cnVjdGlvbigpOyB9CgogICAgICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfQWxsb2MyPgogc3RhdGljIF9BbGxvYzIKIF9TX3NlbGVjdChfQWxsb2My
JiBfX2EsIC4uLikKIHsgcmV0dXJuIF9fYTsgfQoKICAgIHB1YmxpYzoKIyAyNzkgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9hbGxvY190cmFpdHMuaCIgMwogICAgICBzdGF0aWMgcG9pbnRl
cgogICAgICBhbGxvY2F0ZShfQWxsb2MmIF9fYSwgc2l6ZV90eXBlIF9fbikKICAgICAgeyByZXR1
cm4gX19hLmFsbG9jYXRlKF9fbik7IH0KIyAyOTQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9hbGxvY190cmFpdHMuaCIgMwogICAgICBzdGF0aWMgcG9pbnRlcgogICAgICBhbGxvY2F0ZShf
QWxsb2MmIF9fYSwgc2l6ZV90eXBlIF9fbiwgY29uc3Rfdm9pZF9wb2ludGVyIF9faGludCkKICAg
ICAgeyByZXR1cm4gX1NfYWxsb2NhdGUoX19hLCBfX24sIF9faGludCwgMCk7IH0KIyAzMDYgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9hbGxvY190cmFpdHMuaCIgMwogICAgICBzdGF0aWMg
dm9pZAogICAgICBkZWFsbG9jYXRlKF9BbGxvYyYgX19hLCBwb2ludGVyIF9fcCwgc2l6ZV90eXBl
IF9fbikKICAgICAgeyBfX2EuZGVhbGxvY2F0ZShfX3AsIF9fbik7IH0KIyAzMjEgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9hbGxvY190cmFpdHMuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHAsIHR5cGVuYW1lLi4uIF9BcmdzPgogc3RhdGljIGF1dG8gY29uc3RydWN0KF9BbGxv
YyYgX19hLCBfVHAqIF9fcCwgX0FyZ3MmJi4uLiBfX2FyZ3MpCiAtPiBkZWNsdHlwZShfU19jb25z
dHJ1Y3QoX19hLCBfX3AsIHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLikpCiB7IF9TX2Nv
bnN0cnVjdChfX2EsIF9fcCwgc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsgfQojIDMz
NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2FsbG9jX3RyYWl0cy5oIiAzCiAgICAgIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcD4KIHN0YXRpYyB2b2lkIGRlc3Ryb3koX0FsbG9jJiBfX2EsIF9U
cCogX19wKQogeyBfU19kZXN0cm95KF9fYSwgX19wLCAwKTsgfQojIDM0NiAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9iaXRzL2FsbG9jX3RyYWl0cy5oIiAzCiAgICAgIHN0YXRpYyBzaXplX3R5cGUg
bWF4X3NpemUoY29uc3QgX0FsbG9jJiBfX2EpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9TX21h
eF9zaXplKF9fYSwgMCk7IH0KIyAzNTcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9hbGxv
Y190cmFpdHMuaCIgMwogICAgICBzdGF0aWMgX0FsbG9jCiAgICAgIHNlbGVjdF9vbl9jb250YWlu
ZXJfY29weV9jb25zdHJ1Y3Rpb24oY29uc3QgX0FsbG9jJiBfX3JocykKICAgICAgeyByZXR1cm4g
X1Nfc2VsZWN0KF9fcmhzLCAwKTsgfQogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4K
ICAgIHN0cnVjdCBhbGxvY2F0b3JfdHJhaXRzPGFsbG9jYXRvcjxfVHA+PgogICAgewoKICAgICAg
dXNpbmcgYWxsb2NhdG9yX3R5cGUgPSBhbGxvY2F0b3I8X1RwPjsKCiAgICAgIHVzaW5nIHZhbHVl
X3R5cGUgPSBfVHA7CgoKICAgICAgdXNpbmcgcG9pbnRlciA9IF9UcCo7CgoKICAgICAgdXNpbmcg
Y29uc3RfcG9pbnRlciA9IGNvbnN0IF9UcCo7CgoKICAgICAgdXNpbmcgdm9pZF9wb2ludGVyID0g
dm9pZCo7CgoKICAgICAgdXNpbmcgY29uc3Rfdm9pZF9wb2ludGVyID0gY29uc3Qgdm9pZCo7CgoK
ICAgICAgdXNpbmcgZGlmZmVyZW5jZV90eXBlID0gc3RkOjpwdHJkaWZmX3Q7CgoKICAgICAgdXNp
bmcgc2l6ZV90eXBlID0gc3RkOjpzaXplX3Q7CgoKICAgICAgdXNpbmcgcHJvcGFnYXRlX29uX2Nv
bnRhaW5lcl9jb3B5X2Fzc2lnbm1lbnQgPSBmYWxzZV90eXBlOwoKCiAgICAgIHVzaW5nIHByb3Bh
Z2F0ZV9vbl9jb250YWluZXJfbW92ZV9hc3NpZ25tZW50ID0gdHJ1ZV90eXBlOwoKCiAgICAgIHVz
aW5nIHByb3BhZ2F0ZV9vbl9jb250YWluZXJfc3dhcCA9IGZhbHNlX3R5cGU7CgoKICAgICAgdXNp
bmcgaXNfYWx3YXlzX2VxdWFsID0gdHJ1ZV90eXBlOwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUg
X1VwPgogdXNpbmcgcmViaW5kX2FsbG9jID0gYWxsb2NhdG9yPF9VcD47CgogICAgICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVXA+CiB1c2luZyByZWJpbmRfdHJhaXRzID0gYWxsb2NhdG9yX3RyYWl0czxh
bGxvY2F0b3I8X1VwPj47CiMgNDE0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYWxsb2Nf
dHJhaXRzLmgiIDMKICAgICAgc3RhdGljIHBvaW50ZXIKICAgICAgYWxsb2NhdGUoYWxsb2NhdG9y
X3R5cGUmIF9fYSwgc2l6ZV90eXBlIF9fbikKICAgICAgeyByZXR1cm4gX19hLmFsbG9jYXRlKF9f
bik7IH0KIyA0MjggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9hbGxvY190cmFpdHMuaCIg
MwogICAgICBzdGF0aWMgcG9pbnRlcgogICAgICBhbGxvY2F0ZShhbGxvY2F0b3JfdHlwZSYgX19h
LCBzaXplX3R5cGUgX19uLCBjb25zdF92b2lkX3BvaW50ZXIgX19oaW50KQogICAgICB7IHJldHVy
biBfX2EuYWxsb2NhdGUoX19uLCBfX2hpbnQpOyB9CiMgNDQwICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvYWxsb2NfdHJhaXRzLmgiIDMKICAgICAgc3RhdGljIHZvaWQKICAgICAgZGVhbGxv
Y2F0ZShhbGxvY2F0b3JfdHlwZSYgX19hLCBwb2ludGVyIF9fcCwgc2l6ZV90eXBlIF9fbikKICAg
ICAgeyBfX2EuZGVhbGxvY2F0ZShfX3AsIF9fbik7IH0KIyA0NTIgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9hbGxvY190cmFpdHMuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVXAs
IHR5cGVuYW1lLi4uIF9BcmdzPgogc3RhdGljIHZvaWQKIGNvbnN0cnVjdChhbGxvY2F0b3JfdHlw
ZSYgX19hLCBfVXAqIF9fcCwgX0FyZ3MmJi4uLiBfX2FyZ3MpCiB7IF9fYS5jb25zdHJ1Y3QoX19w
LCBzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pOyB9CiMgNDY0ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvYWxsb2NfdHJhaXRzLmgiIDMKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUg
X1VwPgogc3RhdGljIHZvaWQKIGRlc3Ryb3koYWxsb2NhdG9yX3R5cGUmIF9fYSwgX1VwKiBfX3Ap
CiB7IF9fYS5kZXN0cm95KF9fcCk7IH0KCgoKCgoKICAgICAgc3RhdGljIHNpemVfdHlwZQogICAg
ICBtYXhfc2l6ZShjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hKSBub2V4Y2VwdAogICAgICB7IHJl
dHVybiBfX2EubWF4X3NpemUoKTsgfQoKCgoKCgogICAgICBzdGF0aWMgYWxsb2NhdG9yX3R5cGUK
ICAgICAgc2VsZWN0X29uX2NvbnRhaW5lcl9jb3B5X2NvbnN0cnVjdGlvbihjb25zdCBhbGxvY2F0
b3JfdHlwZSYgX19yaHMpCiAgICAgIHsgcmV0dXJuIF9fcmhzOyB9CiAgICB9OwoKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIHZvaWQKICAgIF9fZG9fYWxsb2Nfb25fY29w
eShfQWxsb2MmIF9fb25lLCBjb25zdCBfQWxsb2MmIF9fdHdvLCB0cnVlX3R5cGUpCiAgICB7IF9f
b25lID0gX190d287IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIHZv
aWQKICAgIF9fZG9fYWxsb2Nfb25fY29weShfQWxsb2MmLCBjb25zdCBfQWxsb2MmLCBmYWxzZV90
eXBlKQogICAgeyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSB2b2lk
IF9fYWxsb2Nfb25fY29weShfQWxsb2MmIF9fb25lLCBjb25zdCBfQWxsb2MmIF9fdHdvKQogICAg
ewogICAgICB0eXBlZGVmIGFsbG9jYXRvcl90cmFpdHM8X0FsbG9jPiBfX3RyYWl0czsKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBfX3RyYWl0czo6cHJvcGFnYXRlX29uX2NvbnRhaW5lcl9jb3B5X2Fz
c2lnbm1lbnQgX19wb2NjYTsKICAgICAgX19kb19hbGxvY19vbl9jb3B5KF9fb25lLCBfX3R3bywg
X19wb2NjYSgpKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5l
IF9BbGxvYyBfX2FsbG9jX29uX2NvcHkoY29uc3QgX0FsbG9jJiBfX2EpCiAgICB7CiAgICAgIHR5
cGVkZWYgYWxsb2NhdG9yX3RyYWl0czxfQWxsb2M+IF9fdHJhaXRzOwogICAgICByZXR1cm4gX190
cmFpdHM6OnNlbGVjdF9vbl9jb250YWluZXJfY29weV9jb25zdHJ1Y3Rpb24oX19hKTsKICAgIH0K
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIHZvaWQgX19kb19hbGxvY19v
bl9tb3ZlKF9BbGxvYyYgX19vbmUsIF9BbGxvYyYgX190d28sIHRydWVfdHlwZSkKICAgIHsgX19v
bmUgPSBzdGQ6Om1vdmUoX190d28pOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KICAg
IGlubGluZSB2b2lkIF9fZG9fYWxsb2Nfb25fbW92ZShfQWxsb2MmLCBfQWxsb2MmLCBmYWxzZV90
eXBlKQogICAgeyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSB2b2lk
IF9fYWxsb2Nfb25fbW92ZShfQWxsb2MmIF9fb25lLCBfQWxsb2MmIF9fdHdvKQogICAgewogICAg
ICB0eXBlZGVmIGFsbG9jYXRvcl90cmFpdHM8X0FsbG9jPiBfX3RyYWl0czsKICAgICAgdHlwZWRl
ZiB0eXBlbmFtZSBfX3RyYWl0czo6cHJvcGFnYXRlX29uX2NvbnRhaW5lcl9tb3ZlX2Fzc2lnbm1l
bnQgX19wb2NtYTsKICAgICAgX19kb19hbGxvY19vbl9tb3ZlKF9fb25lLCBfX3R3bywgX19wb2Nt
YSgpKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIHZvaWQg
X19kb19hbGxvY19vbl9zd2FwKF9BbGxvYyYgX19vbmUsIF9BbGxvYyYgX190d28sIHRydWVfdHlw
ZSkKICAgIHsKICAgICAgdXNpbmcgc3RkOjpzd2FwOwogICAgICBzd2FwKF9fb25lLCBfX3R3byk7
CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSB2b2lkIF9fZG9f
YWxsb2Nfb25fc3dhcChfQWxsb2MmLCBfQWxsb2MmLCBmYWxzZV90eXBlKQogICAgeyB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSB2b2lkIF9fYWxsb2Nfb25fc3dhcChf
QWxsb2MmIF9fb25lLCBfQWxsb2MmIF9fdHdvKQogICAgewogICAgICB0eXBlZGVmIGFsbG9jYXRv
cl90cmFpdHM8X0FsbG9jPiBfX3RyYWl0czsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX3RyYWl0
czo6cHJvcGFnYXRlX29uX2NvbnRhaW5lcl9zd2FwIF9fcG9jczsKICAgICAgX19kb19hbGxvY19v
bl9zd2FwKF9fb25lLCBfX3R3bywgX19wb2NzKCkpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfQWxsb2M+CiAgICBjbGFzcyBfX2lzX2NvcHlfaW5zZXJ0YWJsZV9pbXBsCiAgICB7CiAgICAg
IHR5cGVkZWYgYWxsb2NhdG9yX3RyYWl0czxfQWxsb2M+IF9UcmFpdHM7CgogICAgICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVXAsIHR5cGVuYW1lCiAgICAgICAgPSBkZWNsdHlwZShfVHJhaXRzOjpjb25z
dHJ1Y3Qoc3RkOjpkZWNsdmFsPF9BbGxvYyY+KCksCiAgICAgICAgICBzdGQ6OmRlY2x2YWw8X1Vw
Kj4oKSwKICAgICAgICAgIHN0ZDo6ZGVjbHZhbDxjb25zdCBfVXAmPigpKSk+CiBzdGF0aWMgdHJ1
ZV90eXBlCiBfTV9zZWxlY3QoaW50KTsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VcD4KIHN0
YXRpYyBmYWxzZV90eXBlCiBfTV9zZWxlY3QoLi4uKTsKCiAgICBwdWJsaWM6CiAgICAgIHR5cGVk
ZWYgZGVjbHR5cGUoX01fc2VsZWN0PHR5cGVuYW1lIF9BbGxvYzo6dmFsdWVfdHlwZT4oMCkpIHR5
cGU7CiAgICB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogICAgc3RydWN0IF9faXNf
Y29weV9pbnNlcnRhYmxlCiAgICA6IF9faXNfY29weV9pbnNlcnRhYmxlX2ltcGw8X0FsbG9jPjo6
dHlwZQogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNf
Y29weV9pbnNlcnRhYmxlPGFsbG9jYXRvcjxfVHA+PgogICAgOiBpc19jb3B5X2NvbnN0cnVjdGli
bGU8X1RwPgogICAgeyB9OwoKCn0KIyAzNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leHQvYWxs
b2NfdHJhaXRzLmgiIDIgMwoKCgoKbmFtZXNwYWNlIF9fZ251X2N4eCBfX2F0dHJpYnV0ZV9fICgo
X192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoKCgoKCnRlbXBsYXRlPHR5cGVuYW1lIF9B
bGxvYz4KICBzdHJ1Y3QgX19hbGxvY190cmFpdHMKCiAgOiBzdGQ6OmFsbG9jYXRvcl90cmFpdHM8
X0FsbG9jPgoKICB7CiAgICB0eXBlZGVmIF9BbGxvYyBhbGxvY2F0b3JfdHlwZTsKCiAgICB0eXBl
ZGVmIHN0ZDo6YWxsb2NhdG9yX3RyYWl0czxfQWxsb2M+IF9CYXNlX3R5cGU7CiAgICB0eXBlZGVm
IHR5cGVuYW1lIF9CYXNlX3R5cGU6OnZhbHVlX3R5cGUgdmFsdWVfdHlwZTsKICAgIHR5cGVkZWYg
dHlwZW5hbWUgX0Jhc2VfdHlwZTo6cG9pbnRlciBwb2ludGVyOwogICAgdHlwZWRlZiB0eXBlbmFt
ZSBfQmFzZV90eXBlOjpjb25zdF9wb2ludGVyIGNvbnN0X3BvaW50ZXI7CiAgICB0eXBlZGVmIHR5
cGVuYW1lIF9CYXNlX3R5cGU6OnNpemVfdHlwZSBzaXplX3R5cGU7CiAgICB0eXBlZGVmIHR5cGVu
YW1lIF9CYXNlX3R5cGU6OmRpZmZlcmVuY2VfdHlwZSBkaWZmZXJlbmNlX3R5cGU7CgogICAgdHlw
ZWRlZiB2YWx1ZV90eXBlJiByZWZlcmVuY2U7CiAgICB0eXBlZGVmIGNvbnN0IHZhbHVlX3R5cGUm
IGNvbnN0X3JlZmVyZW5jZTsKICAgIHVzaW5nIF9CYXNlX3R5cGU6OmFsbG9jYXRlOwogICAgdXNp
bmcgX0Jhc2VfdHlwZTo6ZGVhbGxvY2F0ZTsKICAgIHVzaW5nIF9CYXNlX3R5cGU6OmNvbnN0cnVj
dDsKICAgIHVzaW5nIF9CYXNlX3R5cGU6OmRlc3Ryb3k7CiAgICB1c2luZyBfQmFzZV90eXBlOjpt
YXhfc2l6ZTsKCiAgcHJpdmF0ZToKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9QdHI+CiAgICAgIHVz
aW5nIF9faXNfY3VzdG9tX3BvaW50ZXIKID0gc3RkOjpfX2FuZF88c3RkOjppc19zYW1lPHBvaW50
ZXIsIF9QdHI+LAogICAgICAgIHN0ZDo6X19ub3RfPHN0ZDo6aXNfcG9pbnRlcjxfUHRyPj4+OwoK
ICBwdWJsaWM6CgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX1B0ciwgdHlwZW5hbWUuLi4gX0FyZ3M+
CiAgICAgIHN0YXRpYyB0eXBlbmFtZSBzdGQ6OmVuYWJsZV9pZjxfX2lzX2N1c3RvbV9wb2ludGVy
PF9QdHI+Ojp2YWx1ZT46OnR5cGUKICAgICAgY29uc3RydWN0KF9BbGxvYyYgX19hLCBfUHRyIF9f
cCwgX0FyZ3MmJi4uLiBfX2FyZ3MpCiAgICAgIHsKIF9CYXNlX3R5cGU6OmNvbnN0cnVjdChfX2Es
IHN0ZDo6YWRkcmVzc29mKCpfX3ApLAogICAgICAgICBzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJn
cykuLi4pOwogICAgICB9CgoKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9QdHI+CiAgICAgIHN0YXRp
YyB0eXBlbmFtZSBzdGQ6OmVuYWJsZV9pZjxfX2lzX2N1c3RvbV9wb2ludGVyPF9QdHI+Ojp2YWx1
ZT46OnR5cGUKICAgICAgZGVzdHJveShfQWxsb2MmIF9fYSwgX1B0ciBfX3ApCiAgICAgIHsgX0Jh
c2VfdHlwZTo6ZGVzdHJveShfX2EsIHN0ZDo6YWRkcmVzc29mKCpfX3ApKTsgfQoKICAgIHN0YXRp
YyBfQWxsb2MgX1Nfc2VsZWN0X29uX2NvcHkoY29uc3QgX0FsbG9jJiBfX2EpCiAgICB7IHJldHVy
biBfQmFzZV90eXBlOjpzZWxlY3Rfb25fY29udGFpbmVyX2NvcHlfY29uc3RydWN0aW9uKF9fYSk7
IH0KCiAgICBzdGF0aWMgdm9pZCBfU19vbl9zd2FwKF9BbGxvYyYgX19hLCBfQWxsb2MmIF9fYikK
ICAgIHsgc3RkOjpfX2FsbG9jX29uX3N3YXAoX19hLCBfX2IpOyB9CgogICAgc3RhdGljIGNvbnN0
ZXhwciBib29sIF9TX3Byb3BhZ2F0ZV9vbl9jb3B5X2Fzc2lnbigpCiAgICB7IHJldHVybiBfQmFz
ZV90eXBlOjpwcm9wYWdhdGVfb25fY29udGFpbmVyX2NvcHlfYXNzaWdubWVudDo6dmFsdWU7IH0K
CiAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgX1NfcHJvcGFnYXRlX29uX21vdmVfYXNzaWduKCkK
ICAgIHsgcmV0dXJuIF9CYXNlX3R5cGU6OnByb3BhZ2F0ZV9vbl9jb250YWluZXJfbW92ZV9hc3Np
Z25tZW50Ojp2YWx1ZTsgfQoKICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBfU19wcm9wYWdhdGVf
b25fc3dhcCgpCiAgICB7IHJldHVybiBfQmFzZV90eXBlOjpwcm9wYWdhdGVfb25fY29udGFpbmVy
X3N3YXA6OnZhbHVlOyB9CgogICAgc3RhdGljIGNvbnN0ZXhwciBib29sIF9TX2Fsd2F5c19lcXVh
bCgpCiAgICB7IHJldHVybiBfQmFzZV90eXBlOjppc19hbHdheXNfZXF1YWw6OnZhbHVlOyB9Cgog
ICAgc3RhdGljIGNvbnN0ZXhwciBib29sIF9TX25vdGhyb3dfbW92ZSgpCiAgICB7IHJldHVybiBf
U19wcm9wYWdhdGVfb25fbW92ZV9hc3NpZ24oKSB8fCBfU19hbHdheXNfZXF1YWwoKTsgfQoKICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgICAgc3RydWN0IHJlYmluZAogICAgICB7IHR5cGVk
ZWYgdHlwZW5hbWUgX0Jhc2VfdHlwZTo6dGVtcGxhdGUgcmViaW5kX2FsbG9jPF9UcD4gb3RoZXI7
IH07CiMgMTU4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2V4dC9hbGxvY190cmFpdHMuaCIgMwog
IH07CgoKfQojIDYxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMiAz
CgoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYWxsb2NhdGVkX3B0ci5oIiAxIDMK
IyA0MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2FsbG9jYXRlZF9wdHIuaCIgMwpuYW1l
c3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsK
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2M+CiAgICBzdHJ1Y3QgX19hbGxvY2F0ZWRfcHRy
CiAgICB7CiAgICAgIHVzaW5nIHBvaW50ZXIgPSB0eXBlbmFtZSBhbGxvY2F0b3JfdHJhaXRzPF9B
bGxvYz46OnBvaW50ZXI7CiAgICAgIHVzaW5nIHZhbHVlX3R5cGUgPSB0eXBlbmFtZSBhbGxvY2F0
b3JfdHJhaXRzPF9BbGxvYz46OnZhbHVlX3R5cGU7CgoKICAgICAgX19hbGxvY2F0ZWRfcHRyKF9B
bGxvYyYgX19hLCBwb2ludGVyIF9fcHRyKSBub2V4Y2VwdAogICAgICA6IF9NX2FsbG9jKHN0ZDo6
X19hZGRyZXNzb2YoX19hKSksIF9NX3B0cihfX3B0cikKICAgICAgeyB9CgoKICAgICAgdGVtcGxh
dGU8dHlwZW5hbWUgX1B0ciwKICAgICAgICB0eXBlbmFtZSBfUmVxID0gX1JlcXVpcmU8aXNfc2Ft
ZTxfUHRyLCB2YWx1ZV90eXBlKj4+PgogICAgICBfX2FsbG9jYXRlZF9wdHIoX0FsbG9jJiBfX2Es
IF9QdHIgX19wdHIpCiAgICAgIDogX01fYWxsb2Moc3RkOjpfX2FkZHJlc3NvZihfX2EpKSwKIF9N
X3B0cihwb2ludGVyX3RyYWl0czxwb2ludGVyPjo6cG9pbnRlcl90bygqX19wdHIpKQogICAgICB7
IH0KCgogICAgICBfX2FsbG9jYXRlZF9wdHIoX19hbGxvY2F0ZWRfcHRyJiYgX19nZCkgbm9leGNl
cHQKICAgICAgOiBfTV9hbGxvYyhfX2dkLl9NX2FsbG9jKSwgX01fcHRyKF9fZ2QuX01fcHRyKQog
ICAgICB7IF9fZ2QuX01fcHRyID0gbnVsbHB0cjsgfQoKCiAgICAgIH5fX2FsbG9jYXRlZF9wdHIo
KQogICAgICB7CiBpZiAoX01fcHRyICE9IG51bGxwdHIpCiAgIHN0ZDo6YWxsb2NhdG9yX3RyYWl0
czxfQWxsb2M+OjpkZWFsbG9jYXRlKCpfTV9hbGxvYywgX01fcHRyLCAxKTsKICAgICAgfQoKCiAg
ICAgIF9fYWxsb2NhdGVkX3B0ciYKICAgICAgb3BlcmF0b3I9KHN0ZDo6bnVsbHB0cl90KSBub2V4
Y2VwdAogICAgICB7CiBfTV9wdHIgPSBudWxscHRyOwogcmV0dXJuICp0aGlzOwogICAgICB9CgoK
ICAgICAgdmFsdWVfdHlwZSogZ2V0KCkgeyByZXR1cm4gX1NfcmF3X3B0cihfTV9wdHIpOyB9Cgog
ICAgcHJpdmF0ZToKICAgICAgdmFsdWVfdHlwZSogX1NfcmF3X3B0cih2YWx1ZV90eXBlKiBfX3B0
cikgeyByZXR1cm4gX19wdHI7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9QdHI+CiBhdXRv
IF9TX3Jhd19wdHIoX1B0ciBfX3B0cikgLT4gZGVjbHR5cGUoX1NfcmF3X3B0cihfX3B0ci5vcGVy
YXRvci0+KCkpKQogeyByZXR1cm4gX1NfcmF3X3B0cihfX3B0ci5vcGVyYXRvci0+KCkpOyB9Cgog
ICAgICBfQWxsb2MqIF9NX2FsbG9jOwogICAgICBwb2ludGVyIF9NX3B0cjsKICAgIH07CgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2M+CiAgICBfX2FsbG9jYXRlZF9wdHI8X0FsbG9jPgogICAg
X19hbGxvY2F0ZV9ndWFyZGVkKF9BbGxvYyYgX19hKQogICAgewogICAgICByZXR1cm4geyBfX2Es
IHN0ZDo6YWxsb2NhdG9yX3RyYWl0czxfQWxsb2M+OjphbGxvY2F0ZShfX2EsIDEpIH07CiAgICB9
CgoKfQojIDY0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMiAzCiMg
MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leHQvYWxpZ25lZF9idWZmZXIuaCIgMSAzCiMgMzIg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvZXh0L2FsaWduZWRfYnVmZmVyLmgiIDMKICAgICAgIAoj
IDMzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2V4dC9hbGlnbmVkX2J1ZmZlci5oIiAzCgoKCgoK
CgpuYW1lc3BhY2UgX19nbnVfY3h4CnsKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAg
c3RydWN0IF9fYWxpZ25lZF9tZW1idWYKICAgIHsKCgoKICAgICAgc3RydWN0IF9UcDIgeyBfVHAg
X01fdDsgfTsKCiAgICAgIGFsaWduYXMoX19hbGlnbm9mX18oX1RwMjo6X01fdCkpIHVuc2lnbmVk
IGNoYXIgX01fc3RvcmFnZVtzaXplb2YoX1RwKV07CgogICAgICBfX2FsaWduZWRfbWVtYnVmKCkg
PSBkZWZhdWx0OwoKCiAgICAgIF9fYWxpZ25lZF9tZW1idWYoc3RkOjpudWxscHRyX3QpIHsgfQoK
ICAgICAgdm9pZCoKICAgICAgX01fYWRkcigpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0YXRp
Y19jYXN0PHZvaWQqPigmX01fc3RvcmFnZSk7IH0KCiAgICAgIGNvbnN0IHZvaWQqCiAgICAgIF9N
X2FkZHIoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxjb25zdCB2
b2lkKj4oJl9NX3N0b3JhZ2UpOyB9CgogICAgICBfVHAqCiAgICAgIF9NX3B0cigpIG5vZXhjZXB0
CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PF9UcCo+KF9NX2FkZHIoKSk7IH0KCiAgICAgIGNv
bnN0IF9UcCoKICAgICAgX01fcHRyKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc3Rh
dGljX2Nhc3Q8Y29uc3QgX1RwKj4oX01fYWRkcigpKTsgfQogICAgfTsKCgoKCgoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19hbGlnbmVkX2J1ZmZlcgogICAgOiBzdGQ6OmFs
aWduZWRfc3RvcmFnZTxzaXplb2YoX1RwKSwgc3RkOjphbGlnbm1lbnRfb2Y8X1RwPjo6dmFsdWU+
CiAgICB7CiAgICAgIHR5cGVuYW1lCiBzdGQ6OmFsaWduZWRfc3RvcmFnZTxzaXplb2YoX1RwKSwg
c3RkOjphbGlnbm1lbnRfb2Y8X1RwPjo6dmFsdWU+Ojp0eXBlCiBfTV9zdG9yYWdlOwoKICAgICAg
X19hbGlnbmVkX2J1ZmZlcigpID0gZGVmYXVsdDsKCgogICAgICBfX2FsaWduZWRfYnVmZmVyKHN0
ZDo6bnVsbHB0cl90KSB7IH0KCiAgICAgIHZvaWQqCiAgICAgIF9NX2FkZHIoKSBub2V4Y2VwdAog
ICAgICB7CiAgICAgICAgcmV0dXJuIHN0YXRpY19jYXN0PHZvaWQqPigmX01fc3RvcmFnZSk7CiAg
ICAgIH0KCiAgICAgIGNvbnN0IHZvaWQqCiAgICAgIF9NX2FkZHIoKSBjb25zdCBub2V4Y2VwdAog
ICAgICB7CiAgICAgICAgcmV0dXJuIHN0YXRpY19jYXN0PGNvbnN0IHZvaWQqPigmX01fc3RvcmFn
ZSk7CiAgICAgIH0KCiAgICAgIF9UcCoKICAgICAgX01fcHRyKCkgbm9leGNlcHQKICAgICAgeyBy
ZXR1cm4gc3RhdGljX2Nhc3Q8X1RwKj4oX01fYWRkcigpKTsgfQoKICAgICAgY29uc3QgX1RwKgog
ICAgICBfTV9wdHIoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxj
b25zdCBfVHAqPihfTV9hZGRyKCkpOyB9CiAgICB9OwoKfQojIDY1ICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMiAzCgoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9f
ICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CiAgbmFtZXNwYWNlIF9fZGV0YWlsCiAg
ewogCiMgODAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICBz
dHJ1Y3QgX0xpc3Rfbm9kZV9iYXNlCiAgICB7CiAgICAgIF9MaXN0X25vZGVfYmFzZSogX01fbmV4
dDsKICAgICAgX0xpc3Rfbm9kZV9iYXNlKiBfTV9wcmV2OwoKICAgICAgc3RhdGljIHZvaWQKICAg
ICAgc3dhcChfTGlzdF9ub2RlX2Jhc2UmIF9feCwgX0xpc3Rfbm9kZV9iYXNlJiBfX3kpIG5vZXhj
ZXB0OwoKICAgICAgdm9pZAogICAgICBfTV90cmFuc2ZlcihfTGlzdF9ub2RlX2Jhc2UqIGNvbnN0
IF9fZmlyc3QsCiAgICBfTGlzdF9ub2RlX2Jhc2UqIGNvbnN0IF9fbGFzdCkgbm9leGNlcHQ7Cgog
ICAgICB2b2lkCiAgICAgIF9NX3JldmVyc2UoKSBub2V4Y2VwdDsKCiAgICAgIHZvaWQKICAgICAg
X01faG9vayhfTGlzdF9ub2RlX2Jhc2UqIGNvbnN0IF9fcG9zaXRpb24pIG5vZXhjZXB0OwoKICAg
ICAgdm9pZAogICAgICBfTV91bmhvb2soKSBub2V4Y2VwdDsKICAgIH07CgogCiAgfQoKCgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX0xpc3Rfbm9kZSA6IHB1YmxpYyBfX2Rl
dGFpbDo6X0xpc3Rfbm9kZV9iYXNlCiAgICB7CgogICAgICBfX2dudV9jeHg6Ol9fYWxpZ25lZF9t
ZW1idWY8X1RwPiBfTV9zdG9yYWdlOwogICAgICBfVHAqIF9NX3ZhbHB0cigpIHsgcmV0dXJuIF9N
X3N0b3JhZ2UuX01fcHRyKCk7IH0KICAgICAgX1RwIGNvbnN0KiBfTV92YWxwdHIoKSBjb25zdCB7
IHJldHVybiBfTV9zdG9yYWdlLl9NX3B0cigpOyB9CgoKCgoKICAgIH07CgoKCgoKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9MaXN0X2l0ZXJhdG9yCiAgICB7CiAgICAgIHR5
cGVkZWYgX0xpc3RfaXRlcmF0b3I8X1RwPiBfU2VsZjsKICAgICAgdHlwZWRlZiBfTGlzdF9ub2Rl
PF9UcD4gX05vZGU7CgogICAgICB0eXBlZGVmIHB0cmRpZmZfdCBkaWZmZXJlbmNlX3R5cGU7CiAg
ICAgIHR5cGVkZWYgc3RkOjpiaWRpcmVjdGlvbmFsX2l0ZXJhdG9yX3RhZyBpdGVyYXRvcl9jYXRl
Z29yeTsKICAgICAgdHlwZWRlZiBfVHAgdmFsdWVfdHlwZTsKICAgICAgdHlwZWRlZiBfVHAqIHBv
aW50ZXI7CiAgICAgIHR5cGVkZWYgX1RwJiByZWZlcmVuY2U7CgogICAgICBfTGlzdF9pdGVyYXRv
cigpIG5vZXhjZXB0CiAgICAgIDogX01fbm9kZSgpIHsgfQoKICAgICAgZXhwbGljaXQKICAgICAg
X0xpc3RfaXRlcmF0b3IoX19kZXRhaWw6Ol9MaXN0X25vZGVfYmFzZSogX194KSBub2V4Y2VwdAog
ICAgICA6IF9NX25vZGUoX194KSB7IH0KCiAgICAgIF9TZWxmCiAgICAgIF9NX2NvbnN0X2Nhc3Qo
KSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiAqdGhpczsgfQoKCiAgICAgIHJlZmVyZW5j
ZQogICAgICBvcGVyYXRvciooKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiAqc3RhdGlj
X2Nhc3Q8X05vZGUqPihfTV9ub2RlKS0+X01fdmFscHRyKCk7IH0KCiAgICAgIHBvaW50ZXIKICAg
ICAgb3BlcmF0b3ItPigpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0
PF9Ob2RlKj4oX01fbm9kZSktPl9NX3ZhbHB0cigpOyB9CgogICAgICBfU2VsZiYKICAgICAgb3Bl
cmF0b3IrKygpIG5vZXhjZXB0CiAgICAgIHsKIF9NX25vZGUgPSBfTV9ub2RlLT5fTV9uZXh0Owog
cmV0dXJuICp0aGlzOwogICAgICB9CgogICAgICBfU2VsZgogICAgICBvcGVyYXRvcisrKGludCkg
bm9leGNlcHQKICAgICAgewogX1NlbGYgX190bXAgPSAqdGhpczsKIF9NX25vZGUgPSBfTV9ub2Rl
LT5fTV9uZXh0OwogcmV0dXJuIF9fdG1wOwogICAgICB9CgogICAgICBfU2VsZiYKICAgICAgb3Bl
cmF0b3ItLSgpIG5vZXhjZXB0CiAgICAgIHsKIF9NX25vZGUgPSBfTV9ub2RlLT5fTV9wcmV2Owog
cmV0dXJuICp0aGlzOwogICAgICB9CgogICAgICBfU2VsZgogICAgICBvcGVyYXRvci0tKGludCkg
bm9leGNlcHQKICAgICAgewogX1NlbGYgX190bXAgPSAqdGhpczsKIF9NX25vZGUgPSBfTV9ub2Rl
LT5fTV9wcmV2OwogcmV0dXJuIF9fdG1wOwogICAgICB9CgogICAgICBib29sCiAgICAgIG9wZXJh
dG9yPT0oY29uc3QgX1NlbGYmIF9feCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX01f
bm9kZSA9PSBfX3guX01fbm9kZTsgfQoKICAgICAgYm9vbAogICAgICBvcGVyYXRvciE9KGNvbnN0
IF9TZWxmJiBfX3gpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX25vZGUgIT0gX194
Ll9NX25vZGU7IH0KCgogICAgICBfX2RldGFpbDo6X0xpc3Rfbm9kZV9iYXNlKiBfTV9ub2RlOwog
ICAgfTsKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX0xpc3RfY29u
c3RfaXRlcmF0b3IKICAgIHsKICAgICAgdHlwZWRlZiBfTGlzdF9jb25zdF9pdGVyYXRvcjxfVHA+
IF9TZWxmOwogICAgICB0eXBlZGVmIGNvbnN0IF9MaXN0X25vZGU8X1RwPiBfTm9kZTsKICAgICAg
dHlwZWRlZiBfTGlzdF9pdGVyYXRvcjxfVHA+IGl0ZXJhdG9yOwoKICAgICAgdHlwZWRlZiBwdHJk
aWZmX3QgZGlmZmVyZW5jZV90eXBlOwogICAgICB0eXBlZGVmIHN0ZDo6YmlkaXJlY3Rpb25hbF9p
dGVyYXRvcl90YWcgaXRlcmF0b3JfY2F0ZWdvcnk7CiAgICAgIHR5cGVkZWYgX1RwIHZhbHVlX3R5
cGU7CiAgICAgIHR5cGVkZWYgY29uc3QgX1RwKiBwb2ludGVyOwogICAgICB0eXBlZGVmIGNvbnN0
IF9UcCYgcmVmZXJlbmNlOwoKICAgICAgX0xpc3RfY29uc3RfaXRlcmF0b3IoKSBub2V4Y2VwdAog
ICAgICA6IF9NX25vZGUoKSB7IH0KCiAgICAgIGV4cGxpY2l0CiAgICAgIF9MaXN0X2NvbnN0X2l0
ZXJhdG9yKGNvbnN0IF9fZGV0YWlsOjpfTGlzdF9ub2RlX2Jhc2UqIF9feCkKICAgICAgbm9leGNl
cHQKICAgICAgOiBfTV9ub2RlKF9feCkgeyB9CgogICAgICBfTGlzdF9jb25zdF9pdGVyYXRvcihj
b25zdCBpdGVyYXRvciYgX194KSBub2V4Y2VwdAogICAgICA6IF9NX25vZGUoX194Ll9NX25vZGUp
IHsgfQoKICAgICAgaXRlcmF0b3IKICAgICAgX01fY29uc3RfY2FzdCgpIGNvbnN0IG5vZXhjZXB0
CiAgICAgIHsgcmV0dXJuIGl0ZXJhdG9yKGNvbnN0X2Nhc3Q8X19kZXRhaWw6Ol9MaXN0X25vZGVf
YmFzZSo+KF9NX25vZGUpKTsgfQoKCiAgICAgIHJlZmVyZW5jZQogICAgICBvcGVyYXRvciooKSBj
b25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiAqc3RhdGljX2Nhc3Q8X05vZGUqPihfTV9ub2Rl
KS0+X01fdmFscHRyKCk7IH0KCiAgICAgIHBvaW50ZXIKICAgICAgb3BlcmF0b3ItPigpIGNvbnN0
IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PF9Ob2RlKj4oX01fbm9kZSktPl9N
X3ZhbHB0cigpOyB9CgogICAgICBfU2VsZiYKICAgICAgb3BlcmF0b3IrKygpIG5vZXhjZXB0CiAg
ICAgIHsKIF9NX25vZGUgPSBfTV9ub2RlLT5fTV9uZXh0OwogcmV0dXJuICp0aGlzOwogICAgICB9
CgogICAgICBfU2VsZgogICAgICBvcGVyYXRvcisrKGludCkgbm9leGNlcHQKICAgICAgewogX1Nl
bGYgX190bXAgPSAqdGhpczsKIF9NX25vZGUgPSBfTV9ub2RlLT5fTV9uZXh0OwogcmV0dXJuIF9f
dG1wOwogICAgICB9CgogICAgICBfU2VsZiYKICAgICAgb3BlcmF0b3ItLSgpIG5vZXhjZXB0CiAg
ICAgIHsKIF9NX25vZGUgPSBfTV9ub2RlLT5fTV9wcmV2OwogcmV0dXJuICp0aGlzOwogICAgICB9
CgogICAgICBfU2VsZgogICAgICBvcGVyYXRvci0tKGludCkgbm9leGNlcHQKICAgICAgewogX1Nl
bGYgX190bXAgPSAqdGhpczsKIF9NX25vZGUgPSBfTV9ub2RlLT5fTV9wcmV2OwogcmV0dXJuIF9f
dG1wOwogICAgICB9CgogICAgICBib29sCiAgICAgIG9wZXJhdG9yPT0oY29uc3QgX1NlbGYmIF9f
eCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX01fbm9kZSA9PSBfX3guX01fbm9kZTsg
fQoKICAgICAgYm9vbAogICAgICBvcGVyYXRvciE9KGNvbnN0IF9TZWxmJiBfX3gpIGNvbnN0IG5v
ZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX25vZGUgIT0gX194Ll9NX25vZGU7IH0KCgogICAgICBj
b25zdCBfX2RldGFpbDo6X0xpc3Rfbm9kZV9iYXNlKiBfTV9ub2RlOwogICAgfTsKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1ZhbD4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj09KGNvbnN0IF9M
aXN0X2l0ZXJhdG9yPF9WYWw+JiBfX3gsCiAgICAgICAgY29uc3QgX0xpc3RfY29uc3RfaXRlcmF0
b3I8X1ZhbD4mIF9feSkgbm9leGNlcHQKICAgIHsgcmV0dXJuIF9feC5fTV9ub2RlID09IF9feS5f
TV9ub2RlOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9WYWw+CiAgICBpbmxpbmUgYm9vbAogICAg
b3BlcmF0b3IhPShjb25zdCBfTGlzdF9pdGVyYXRvcjxfVmFsPiYgX194LAogICAgICAgICAgICAg
ICBjb25zdCBfTGlzdF9jb25zdF9pdGVyYXRvcjxfVmFsPiYgX195KSBub2V4Y2VwdAogICAgeyBy
ZXR1cm4gX194Ll9NX25vZGUgIT0gX195Ll9NX25vZGU7IH0KCm5hbWVzcGFjZSBfX2N4eDExIHsK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBjbGFzcyBfTGlz
dF9iYXNlCiAgICB7CiAgICBwcm90ZWN0ZWQ6CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19nbnVf
Y3h4OjpfX2FsbG9jX3RyYWl0czxfQWxsb2M+Ojp0ZW1wbGF0ZQogcmViaW5kPF9UcD46Om90aGVy
IF9UcF9hbGxvY190eXBlOwogICAgICB0eXBlZGVmIF9fZ251X2N4eDo6X19hbGxvY190cmFpdHM8
X1RwX2FsbG9jX3R5cGU+IF9UcF9hbGxvY190cmFpdHM7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUg
X1RwX2FsbG9jX3RyYWl0czo6dGVtcGxhdGUKIHJlYmluZDxfTGlzdF9ub2RlPF9UcD4gPjo6b3Ro
ZXIgX05vZGVfYWxsb2NfdHlwZTsKICAgICAgdHlwZWRlZiBfX2dudV9jeHg6Ol9fYWxsb2NfdHJh
aXRzPF9Ob2RlX2FsbG9jX3R5cGU+IF9Ob2RlX2FsbG9jX3RyYWl0czsKCiAgICAgIHN0YXRpYyBz
aXplX3QKICAgICAgX1NfZGlzdGFuY2UoY29uc3QgX19kZXRhaWw6Ol9MaXN0X25vZGVfYmFzZSog
X19maXJzdCwKICAgIGNvbnN0IF9fZGV0YWlsOjpfTGlzdF9ub2RlX2Jhc2UqIF9fbGFzdCkKICAg
ICAgewogc2l6ZV90IF9fbiA9IDA7CiB3aGlsZSAoX19maXJzdCAhPSBfX2xhc3QpCiAgIHsKICAg
ICBfX2ZpcnN0ID0gX19maXJzdC0+X01fbmV4dDsKICAgICArK19fbjsKICAgfQogcmV0dXJuIF9f
bjsKICAgICAgfQoKICAgICAgc3RydWN0IF9MaXN0X2ltcGwKICAgICAgOiBwdWJsaWMgX05vZGVf
YWxsb2NfdHlwZQogICAgICB7CgogX0xpc3Rfbm9kZTxzaXplX3Q+IF9NX25vZGU7CgoKCgogX0xp
c3RfaW1wbCgpIG5vZXhjZXB0CiA6IF9Ob2RlX2FsbG9jX3R5cGUoKSwgX01fbm9kZSgpCiB7IH0K
CiBfTGlzdF9pbXBsKGNvbnN0IF9Ob2RlX2FsbG9jX3R5cGUmIF9fYSkgbm9leGNlcHQKIDogX05v
ZGVfYWxsb2NfdHlwZShfX2EpLCBfTV9ub2RlKCkKIHsgfQoKCiBfTGlzdF9pbXBsKF9Ob2RlX2Fs
bG9jX3R5cGUmJiBfX2EpIG5vZXhjZXB0CiA6IF9Ob2RlX2FsbG9jX3R5cGUoc3RkOjptb3ZlKF9f
YSkpLCBfTV9ub2RlKCkKIHsgfQoKICAgICAgfTsKCiAgICAgIF9MaXN0X2ltcGwgX01faW1wbDsK
CgogICAgICBzaXplX3QgX01fZ2V0X3NpemUoKSBjb25zdCB7IHJldHVybiAqX01faW1wbC5fTV9u
b2RlLl9NX3ZhbHB0cigpOyB9CgogICAgICB2b2lkIF9NX3NldF9zaXplKHNpemVfdCBfX24pIHsg
Kl9NX2ltcGwuX01fbm9kZS5fTV92YWxwdHIoKSA9IF9fbjsgfQoKICAgICAgdm9pZCBfTV9pbmNf
c2l6ZShzaXplX3QgX19uKSB7ICpfTV9pbXBsLl9NX25vZGUuX01fdmFscHRyKCkgKz0gX19uOyB9
CgogICAgICB2b2lkIF9NX2RlY19zaXplKHNpemVfdCBfX24pIHsgKl9NX2ltcGwuX01fbm9kZS5f
TV92YWxwdHIoKSAtPSBfX247IH0KCiAgICAgIHNpemVfdAogICAgICBfTV9kaXN0YW5jZShjb25z
dCBfX2RldGFpbDo6X0xpc3Rfbm9kZV9iYXNlKiBfX2ZpcnN0LAogICAgY29uc3QgX19kZXRhaWw6
Ol9MaXN0X25vZGVfYmFzZSogX19sYXN0KSBjb25zdAogICAgICB7IHJldHVybiBfU19kaXN0YW5j
ZShfX2ZpcnN0LCBfX2xhc3QpOyB9CgoKICAgICAgc2l6ZV90IF9NX25vZGVfY291bnQoKSBjb25z
dCB7IHJldHVybiAqX01faW1wbC5fTV9ub2RlLl9NX3ZhbHB0cigpOyB9CiMgMzgxICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMwogICAgICB0eXBlbmFtZSBfTm9kZV9h
bGxvY190cmFpdHM6OnBvaW50ZXIKICAgICAgX01fZ2V0X25vZGUoKQogICAgICB7IHJldHVybiBf
Tm9kZV9hbGxvY190cmFpdHM6OmFsbG9jYXRlKF9NX2ltcGwsIDEpOyB9CgogICAgICB2b2lkCiAg
ICAgIF9NX3B1dF9ub2RlKHR5cGVuYW1lIF9Ob2RlX2FsbG9jX3RyYWl0czo6cG9pbnRlciBfX3Ap
IG5vZXhjZXB0CiAgICAgIHsgX05vZGVfYWxsb2NfdHJhaXRzOjpkZWFsbG9jYXRlKF9NX2ltcGws
IF9fcCwgMSk7IH0KCiAgcHVibGljOgogICAgICB0eXBlZGVmIF9BbGxvYyBhbGxvY2F0b3JfdHlw
ZTsKCiAgICAgIF9Ob2RlX2FsbG9jX3R5cGUmCiAgICAgIF9NX2dldF9Ob2RlX2FsbG9jYXRvcigp
IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX2ltcGw7IH0KCiAgICAgIGNvbnN0IF9Ob2RlX2Fs
bG9jX3R5cGUmCiAgICAgIF9NX2dldF9Ob2RlX2FsbG9jYXRvcigpIGNvbnN0IG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuIF9NX2ltcGw7IH0KCiAgICAgIF9MaXN0X2Jhc2UoKQogICAgICA6IF9NX2lt
cGwoKQogICAgICB7IF9NX2luaXQoKTsgfQoKICAgICAgX0xpc3RfYmFzZShjb25zdCBfTm9kZV9h
bGxvY190eXBlJiBfX2EpIG5vZXhjZXB0CiAgICAgIDogX01faW1wbChfX2EpCiAgICAgIHsgX01f
aW5pdCgpOyB9CgoKICAgICAgX0xpc3RfYmFzZShfTGlzdF9iYXNlJiYgX194KSBub2V4Y2VwdAog
ICAgICA6IF9NX2ltcGwoc3RkOjptb3ZlKF9feC5fTV9nZXRfTm9kZV9hbGxvY2F0b3IoKSkpCiAg
ICAgIHsgX01fbW92ZV9ub2RlcyhzdGQ6Om1vdmUoX194KSk7IH0KCiAgICAgIF9MaXN0X2Jhc2Uo
X0xpc3RfYmFzZSYmIF9feCwgX05vZGVfYWxsb2NfdHlwZSYmIF9fYSkKICAgICAgOiBfTV9pbXBs
KHN0ZDo6bW92ZShfX2EpKQogICAgICB7CiBpZiAoX194Ll9NX2dldF9Ob2RlX2FsbG9jYXRvcigp
ID09IF9NX2dldF9Ob2RlX2FsbG9jYXRvcigpKQogICBfTV9tb3ZlX25vZGVzKHN0ZDo6bW92ZShf
X3gpKTsKIGVsc2UKICAgX01faW5pdCgpOwogICAgICB9CgogICAgICB2b2lkCiAgICAgIF9NX21v
dmVfbm9kZXMoX0xpc3RfYmFzZSYmIF9feCkKICAgICAgewogYXV0byogY29uc3QgX194bm9kZSA9
IHN0ZDo6X19hZGRyZXNzb2YoX194Ll9NX2ltcGwuX01fbm9kZSk7CiBpZiAoX194bm9kZS0+X01f
bmV4dCA9PSBfX3hub2RlKQogICBfTV9pbml0KCk7CiBlbHNlCiAgIHsKICAgICBhdXRvKiBjb25z
dCBfX25vZGUgPSBzdGQ6Ol9fYWRkcmVzc29mKF9NX2ltcGwuX01fbm9kZSk7CiAgICAgX19ub2Rl
LT5fTV9uZXh0ID0gX194bm9kZS0+X01fbmV4dDsKICAgICBfX25vZGUtPl9NX3ByZXYgPSBfX3hu
b2RlLT5fTV9wcmV2OwogICAgIF9fbm9kZS0+X01fbmV4dC0+X01fcHJldiA9IF9fbm9kZS0+X01f
cHJldi0+X01fbmV4dCA9IF9fbm9kZTsKICAgICBfTV9zZXRfc2l6ZShfX3guX01fZ2V0X3NpemUo
KSk7CiAgICAgX194Ll9NX2luaXQoKTsKICAgfQogICAgICB9CgoKCiAgICAgIH5fTGlzdF9iYXNl
KCkgbm9leGNlcHQKICAgICAgeyBfTV9jbGVhcigpOyB9CgogICAgICB2b2lkCiAgICAgIF9NX2Ns
ZWFyKCkgbm9leGNlcHQ7CgogICAgICB2b2lkCiAgICAgIF9NX2luaXQoKSBub2V4Y2VwdAogICAg
ICB7CiAgICAgICAgdGhpcy0+X01faW1wbC5fTV9ub2RlLl9NX25leHQgPSAmdGhpcy0+X01faW1w
bC5fTV9ub2RlOwogICAgICAgIHRoaXMtPl9NX2ltcGwuX01fbm9kZS5fTV9wcmV2ID0gJnRoaXMt
Pl9NX2ltcGwuX01fbm9kZTsKIF9NX3NldF9zaXplKDApOwogICAgICB9CiAgICB9OwojIDUwMiAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9saXN0LmgiIDMKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYyA9IHN0ZDo6YWxsb2NhdG9yPF9UcD4gPgogICAgY2xh
c3MgbGlzdCA6IHByb3RlY3RlZCBfTGlzdF9iYXNlPF9UcCwgX0FsbG9jPgogICAgewoKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBfQWxsb2M6OnZhbHVlX3R5cGUgX0FsbG9jX3ZhbHVlX3R5cGU7CiAg
ICAgCiAgICAgCgogICAgICB0eXBlZGVmIF9MaXN0X2Jhc2U8X1RwLCBfQWxsb2M+IF9CYXNlOwog
ICAgICB0eXBlZGVmIHR5cGVuYW1lIF9CYXNlOjpfVHBfYWxsb2NfdHlwZSBfVHBfYWxsb2NfdHlw
ZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQmFzZTo6X1RwX2FsbG9jX3RyYWl0cyBfVHBfYWxs
b2NfdHJhaXRzOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9CYXNlOjpfTm9kZV9hbGxvY190eXBl
IF9Ob2RlX2FsbG9jX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0Jhc2U6Ol9Ob2RlX2Fs
bG9jX3RyYWl0cyBfTm9kZV9hbGxvY190cmFpdHM7CgogICAgcHVibGljOgogICAgICB0eXBlZGVm
IF9UcCB2YWx1ZV90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9UcF9hbGxvY190cmFpdHM6
OnBvaW50ZXIgcG9pbnRlcjsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfVHBfYWxsb2NfdHJhaXRz
Ojpjb25zdF9wb2ludGVyIGNvbnN0X3BvaW50ZXI7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX1Rw
X2FsbG9jX3RyYWl0czo6cmVmZXJlbmNlIHJlZmVyZW5jZTsKICAgICAgdHlwZWRlZiB0eXBlbmFt
ZSBfVHBfYWxsb2NfdHJhaXRzOjpjb25zdF9yZWZlcmVuY2UgY29uc3RfcmVmZXJlbmNlOwogICAg
ICB0eXBlZGVmIF9MaXN0X2l0ZXJhdG9yPF9UcD4gaXRlcmF0b3I7CiAgICAgIHR5cGVkZWYgX0xp
c3RfY29uc3RfaXRlcmF0b3I8X1RwPiBjb25zdF9pdGVyYXRvcjsKICAgICAgdHlwZWRlZiBzdGQ6
OnJldmVyc2VfaXRlcmF0b3I8Y29uc3RfaXRlcmF0b3I+IGNvbnN0X3JldmVyc2VfaXRlcmF0b3I7
CiAgICAgIHR5cGVkZWYgc3RkOjpyZXZlcnNlX2l0ZXJhdG9yPGl0ZXJhdG9yPiByZXZlcnNlX2l0
ZXJhdG9yOwogICAgICB0eXBlZGVmIHNpemVfdCBzaXplX3R5cGU7CiAgICAgIHR5cGVkZWYgcHRy
ZGlmZl90IGRpZmZlcmVuY2VfdHlwZTsKICAgICAgdHlwZWRlZiBfQWxsb2MgYWxsb2NhdG9yX3R5
cGU7CgogICAgcHJvdGVjdGVkOgoKCiAgICAgIHR5cGVkZWYgX0xpc3Rfbm9kZTxfVHA+IF9Ob2Rl
OwoKICAgICAgdXNpbmcgX0Jhc2U6Ol9NX2ltcGw7CiAgICAgIHVzaW5nIF9CYXNlOjpfTV9wdXRf
bm9kZTsKICAgICAgdXNpbmcgX0Jhc2U6Ol9NX2dldF9ub2RlOwogICAgICB1c2luZyBfQmFzZTo6
X01fZ2V0X05vZGVfYWxsb2NhdG9yOwojIDU2NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L3N0bF9saXN0LmgiIDMKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX0FyZ3M+CiAgICAgICAg
X05vZGUqCiAgICAgICAgX01fY3JlYXRlX25vZGUoX0FyZ3MmJi4uLiBfX2FyZ3MpCiB7CiAgIGF1
dG8gX19wID0gdGhpcy0+X01fZ2V0X25vZGUoKTsKICAgYXV0byYgX19hbGxvYyA9IF9NX2dldF9O
b2RlX2FsbG9jYXRvcigpOwogICBfX2FsbG9jYXRlZF9wdHI8X05vZGVfYWxsb2NfdHlwZT4gX19n
dWFyZHtfX2FsbG9jLCBfX3B9OwogICBfTm9kZV9hbGxvY190cmFpdHM6OmNvbnN0cnVjdChfX2Fs
bG9jLCBfX3AtPl9NX3ZhbHB0cigpLAogICAgIHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4u
Lik7CiAgIF9fZ3VhcmQgPSBudWxscHRyOwogICByZXR1cm4gX19wOwogfQoKCiAgICBwdWJsaWM6
CgoKCgoKCiAgICAgIGxpc3QoKQoKICAgICAgbm9leGNlcHQoaXNfbm90aHJvd19kZWZhdWx0X2Nv
bnN0cnVjdGlibGU8X05vZGVfYWxsb2NfdHlwZT46OnZhbHVlKQoKICAgICAgOiBfQmFzZSgpIHsg
fQoKCgoKCiAgICAgIGV4cGxpY2l0CiAgICAgIGxpc3QoY29uc3QgYWxsb2NhdG9yX3R5cGUmIF9f
YSkgbm9leGNlcHQKICAgICAgOiBfQmFzZShfTm9kZV9hbGxvY190eXBlKF9fYSkpIHsgfQojIDYw
OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9saXN0LmgiIDMKICAgICAgZXhwbGlj
aXQKICAgICAgbGlzdChzaXplX3R5cGUgX19uLCBjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hID0g
YWxsb2NhdG9yX3R5cGUoKSkKICAgICAgOiBfQmFzZShfTm9kZV9hbGxvY190eXBlKF9fYSkpCiAg
ICAgIHsgX01fZGVmYXVsdF9pbml0aWFsaXplKF9fbik7IH0KIyA2MjEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIGxpc3Qoc2l6ZV90eXBlIF9fbiwgY29u
c3QgdmFsdWVfdHlwZSYgX192YWx1ZSwKICAgIGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EgPSBh
bGxvY2F0b3JfdHlwZSgpKQogICAgICA6IF9CYXNlKF9Ob2RlX2FsbG9jX3R5cGUoX19hKSkKICAg
ICAgeyBfTV9maWxsX2luaXRpYWxpemUoX19uLCBfX3ZhbHVlKTsgfQojIDY0OCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9saXN0LmgiIDMKICAgICAgbGlzdChjb25zdCBsaXN0JiBf
X3gpCiAgICAgIDogX0Jhc2UoX05vZGVfYWxsb2NfdHJhaXRzOjoKICAgICAgIF9TX3NlbGVjdF9v
bl9jb3B5KF9feC5fTV9nZXRfTm9kZV9hbGxvY2F0b3IoKSkpCiAgICAgIHsgX01faW5pdGlhbGl6
ZV9kaXNwYXRjaChfX3guYmVnaW4oKSwgX194LmVuZCgpLCBfX2ZhbHNlX3R5cGUoKSk7IH0KIyA2
NjEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIGxpc3Qo
bGlzdCYmIF9feCkgbm9leGNlcHQKICAgICAgOiBfQmFzZShzdGQ6Om1vdmUoX194KSkgeyB9CiMg
NjcyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMwogICAgICBsaXN0
KGluaXRpYWxpemVyX2xpc3Q8dmFsdWVfdHlwZT4gX19sLAogICAgICAgICAgIGNvbnN0IGFsbG9j
YXRvcl90eXBlJiBfX2EgPSBhbGxvY2F0b3JfdHlwZSgpKQogICAgICA6IF9CYXNlKF9Ob2RlX2Fs
bG9jX3R5cGUoX19hKSkKICAgICAgeyBfTV9pbml0aWFsaXplX2Rpc3BhdGNoKF9fbC5iZWdpbigp
LCBfX2wuZW5kKCksIF9fZmFsc2VfdHlwZSgpKTsgfQoKICAgICAgbGlzdChjb25zdCBsaXN0JiBf
X3gsIGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EpCiAgICAgIDogX0Jhc2UoX05vZGVfYWxsb2Nf
dHlwZShfX2EpKQogICAgICB7IF9NX2luaXRpYWxpemVfZGlzcGF0Y2goX194LmJlZ2luKCksIF9f
eC5lbmQoKSwgX19mYWxzZV90eXBlKCkpOyB9CgogICAgICBsaXN0KGxpc3QmJiBfX3gsIGNvbnN0
IGFsbG9jYXRvcl90eXBlJiBfX2EpCiAgICAgIG5vZXhjZXB0KF9Ob2RlX2FsbG9jX3RyYWl0czo6
X1NfYWx3YXlzX2VxdWFsKCkpCiAgICAgIDogX0Jhc2Uoc3RkOjptb3ZlKF9feCksIF9Ob2RlX2Fs
bG9jX3R5cGUoX19hKSkKICAgICAgewoKCiBpbnNlcnQoYmVnaW4oKSwgc3RkOjpfX21ha2VfbW92
ZV9pZl9ub2V4Y2VwdF9pdGVyYXRvcihfX3guYmVnaW4oKSksCiAgIHN0ZDo6X19tYWtlX21vdmVf
aWZfbm9leGNlcHRfaXRlcmF0b3IoX194LmVuZCgpKSk7CiAgICAgIH0KIyA3MDMgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9JbnB1dEl0ZXJhdG9yLAogICAgICAgIHR5cGVuYW1lID0gc3RkOjpfUmVxdWlyZUlucHV0SXRl
cjxfSW5wdXRJdGVyYXRvcj4+CiAgICAgICAgbGlzdChfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBf
SW5wdXRJdGVyYXRvciBfX2xhc3QsCiAgICAgIGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EgPSBh
bGxvY2F0b3JfdHlwZSgpKQogOiBfQmFzZShfTm9kZV9hbGxvY190eXBlKF9fYSkpCiAgICAgICAg
eyBfTV9pbml0aWFsaXplX2Rpc3BhdGNoKF9fZmlyc3QsIF9fbGFzdCwgX19mYWxzZV90eXBlKCkp
OyB9CiMgNzM2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMwogICAg
ICBsaXN0JgogICAgICBvcGVyYXRvcj0oY29uc3QgbGlzdCYgX194KTsKIyA3NDcgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIGxpc3QmCiAgICAgIG9wZXJh
dG9yPShsaXN0JiYgX194KQogICAgICBub2V4Y2VwdChfTm9kZV9hbGxvY190cmFpdHM6Ol9TX25v
dGhyb3dfbW92ZSgpKQogICAgICB7CiBjb25zdGV4cHIgYm9vbCBfX21vdmVfc3RvcmFnZSA9CiAg
ICAgICAgICBfTm9kZV9hbGxvY190cmFpdHM6Ol9TX3Byb3BhZ2F0ZV9vbl9tb3ZlX2Fzc2lnbigp
CiAgICAgICAgICB8fCBfTm9kZV9hbGxvY190cmFpdHM6Ol9TX2Fsd2F5c19lcXVhbCgpOwogICAg
ICAgIF9NX21vdmVfYXNzaWduKHN0ZDo6bW92ZShfX3gpLCBfX2Jvb2xfY29uc3RhbnQ8X19tb3Zl
X3N0b3JhZ2U+KCkpOwogcmV0dXJuICp0aGlzOwogICAgICB9CiMgNzY1ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMwogICAgICBsaXN0JgogICAgICBvcGVyYXRvcj0o
aW5pdGlhbGl6ZXJfbGlzdDx2YWx1ZV90eXBlPiBfX2wpCiAgICAgIHsKIHRoaXMtPmFzc2lnbihf
X2wuYmVnaW4oKSwgX19sLmVuZCgpKTsKIHJldHVybiAqdGhpczsKICAgICAgfQojIDc4MyAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9saXN0LmgiIDMKICAgICAgdm9pZAogICAgICBh
c3NpZ24oc2l6ZV90eXBlIF9fbiwgY29uc3QgdmFsdWVfdHlwZSYgX192YWwpCiAgICAgIHsgX01f
ZmlsbF9hc3NpZ24oX19uLCBfX3ZhbCk7IH0KIyA4MDAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9y
LAogICAgICAgIHR5cGVuYW1lID0gc3RkOjpfUmVxdWlyZUlucHV0SXRlcjxfSW5wdXRJdGVyYXRv
cj4+CiAgICAgICAgdm9pZAogICAgICAgIGFzc2lnbihfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBf
SW5wdXRJdGVyYXRvciBfX2xhc3QpCiAgICAgICAgeyBfTV9hc3NpZ25fZGlzcGF0Y2goX19maXJz
dCwgX19sYXN0LCBfX2ZhbHNlX3R5cGUoKSk7IH0KIyA4MjQgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIHZvaWQKICAgICAgYXNzaWduKGluaXRpYWxpemVy
X2xpc3Q8dmFsdWVfdHlwZT4gX19sKQogICAgICB7IHRoaXMtPmFzc2lnbihfX2wuYmVnaW4oKSwg
X19sLmVuZCgpKTsgfQoKCgogICAgICBhbGxvY2F0b3JfdHlwZQogICAgICBnZXRfYWxsb2NhdG9y
KCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gYWxsb2NhdG9yX3R5cGUoX0Jhc2U6Ol9N
X2dldF9Ob2RlX2FsbG9jYXRvcigpKTsgfQoKCgoKCgogICAgICBpdGVyYXRvcgogICAgICBiZWdp
bigpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGl0ZXJhdG9yKHRoaXMtPl9NX2ltcGwuX01fbm9k
ZS5fTV9uZXh0KTsgfQoKCgoKCgogICAgICBjb25zdF9pdGVyYXRvcgogICAgICBiZWdpbigpIGNv
bnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGNvbnN0X2l0ZXJhdG9yKHRoaXMtPl9NX2ltcGwu
X01fbm9kZS5fTV9uZXh0KTsgfQoKCgoKCgogICAgICBpdGVyYXRvcgogICAgICBlbmQoKSBub2V4
Y2VwdAogICAgICB7IHJldHVybiBpdGVyYXRvcigmdGhpcy0+X01faW1wbC5fTV9ub2RlKTsgfQoK
CgoKCgogICAgICBjb25zdF9pdGVyYXRvcgogICAgICBlbmQoKSBjb25zdCBub2V4Y2VwdAogICAg
ICB7IHJldHVybiBjb25zdF9pdGVyYXRvcigmdGhpcy0+X01faW1wbC5fTV9ub2RlKTsgfQoKCgoK
CgogICAgICByZXZlcnNlX2l0ZXJhdG9yCiAgICAgIHJiZWdpbigpIG5vZXhjZXB0CiAgICAgIHsg
cmV0dXJuIHJldmVyc2VfaXRlcmF0b3IoZW5kKCkpOyB9CgoKCgoKCiAgICAgIGNvbnN0X3JldmVy
c2VfaXRlcmF0b3IKICAgICAgcmJlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4g
Y29uc3RfcmV2ZXJzZV9pdGVyYXRvcihlbmQoKSk7IH0KCgoKCgoKICAgICAgcmV2ZXJzZV9pdGVy
YXRvcgogICAgICByZW5kKCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4gcmV2ZXJzZV9pdGVyYXRv
cihiZWdpbigpKTsgfQoKCgoKCgogICAgICBjb25zdF9yZXZlcnNlX2l0ZXJhdG9yCiAgICAgIHJl
bmQoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBjb25zdF9yZXZlcnNlX2l0ZXJhdG9y
KGJlZ2luKCkpOyB9CgoKCgoKCgogICAgICBjb25zdF9pdGVyYXRvcgogICAgICBjYmVnaW4oKSBj
b25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBjb25zdF9pdGVyYXRvcih0aGlzLT5fTV9pbXBs
Ll9NX25vZGUuX01fbmV4dCk7IH0KCgoKCgoKICAgICAgY29uc3RfaXRlcmF0b3IKICAgICAgY2Vu
ZCgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGNvbnN0X2l0ZXJhdG9yKCZ0aGlzLT5f
TV9pbXBsLl9NX25vZGUpOyB9CgoKCgoKCiAgICAgIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAg
ICAgY3JiZWdpbigpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGNvbnN0X3JldmVyc2Vf
aXRlcmF0b3IoZW5kKCkpOyB9CgoKCgoKCiAgICAgIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAg
ICAgY3JlbmQoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBjb25zdF9yZXZlcnNlX2l0
ZXJhdG9yKGJlZ2luKCkpOyB9CgoKCgoKCgogICAgICBib29sCiAgICAgIGVtcHR5KCkgY29uc3Qg
bm9leGNlcHQKICAgICAgeyByZXR1cm4gdGhpcy0+X01faW1wbC5fTV9ub2RlLl9NX25leHQgPT0g
JnRoaXMtPl9NX2ltcGwuX01fbm9kZTsgfQoKCiAgICAgIHNpemVfdHlwZQogICAgICBzaXplKCkg
Y29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gdGhpcy0+X01fbm9kZV9jb3VudCgpOyB9CgoK
ICAgICAgc2l6ZV90eXBlCiAgICAgIG1heF9zaXplKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyBy
ZXR1cm4gX05vZGVfYWxsb2NfdHJhaXRzOjptYXhfc2l6ZShfTV9nZXRfTm9kZV9hbGxvY2F0b3Io
KSk7IH0KIyA5NzMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAg
ICAgIHZvaWQKICAgICAgcmVzaXplKHNpemVfdHlwZSBfX25ld19zaXplKTsKIyA5ODYgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIHZvaWQKICAgICAgcmVz
aXplKHNpemVfdHlwZSBfX25ld19zaXplLCBjb25zdCB2YWx1ZV90eXBlJiBfX3gpOwojIDEwMDgg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIHJlZmVyZW5j
ZQogICAgICBmcm9udCgpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuICpiZWdpbigpOyB9CgoKCgoK
ICAgICAgY29uc3RfcmVmZXJlbmNlCiAgICAgIGZyb250KCkgY29uc3Qgbm9leGNlcHQKICAgICAg
eyByZXR1cm4gKmJlZ2luKCk7IH0KCgoKCgogICAgICByZWZlcmVuY2UKICAgICAgYmFjaygpIG5v
ZXhjZXB0CiAgICAgIHsKIGl0ZXJhdG9yIF9fdG1wID0gZW5kKCk7CiAtLV9fdG1wOwogcmV0dXJu
ICpfX3RtcDsKICAgICAgfQoKCgoKCiAgICAgIGNvbnN0X3JlZmVyZW5jZQogICAgICBiYWNrKCkg
Y29uc3Qgbm9leGNlcHQKICAgICAgewogY29uc3RfaXRlcmF0b3IgX190bXAgPSBlbmQoKTsKIC0t
X190bXA7CiByZXR1cm4gKl9fdG1wOwogICAgICB9CiMgMTA1NSAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3N0bF9saXN0LmgiIDMKICAgICAgdm9pZAogICAgICBwdXNoX2Zyb250KGNvbnN0
IHZhbHVlX3R5cGUmIF9feCkKICAgICAgeyB0aGlzLT5fTV9pbnNlcnQoYmVnaW4oKSwgX194KTsg
fQoKCiAgICAgIHZvaWQKICAgICAgcHVzaF9mcm9udCh2YWx1ZV90eXBlJiYgX194KQogICAgICB7
IHRoaXMtPl9NX2luc2VydChiZWdpbigpLCBzdGQ6Om1vdmUoX194KSk7IH0KCiAgICAgIHRlbXBs
YXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogICAgICAgIHZvaWQKICAgICAgICBlbXBsYWNlX2Zyb250
KF9BcmdzJiYuLi4gX19hcmdzKQogICAgICAgIHsgdGhpcy0+X01faW5zZXJ0KGJlZ2luKCksIHN0
ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLik7IH0KIyAxMDgyICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMwogICAgICB2b2lkCiAgICAgIHBvcF9mcm9udCgpIG5v
ZXhjZXB0CiAgICAgIHsgdGhpcy0+X01fZXJhc2UoYmVnaW4oKSk7IH0KIyAxMDk2ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMwogICAgICB2b2lkCiAgICAgIHB1c2hf
YmFjayhjb25zdCB2YWx1ZV90eXBlJiBfX3gpCiAgICAgIHsgdGhpcy0+X01faW5zZXJ0KGVuZCgp
LCBfX3gpOyB9CgoKICAgICAgdm9pZAogICAgICBwdXNoX2JhY2sodmFsdWVfdHlwZSYmIF9feCkK
ICAgICAgeyB0aGlzLT5fTV9pbnNlcnQoZW5kKCksIHN0ZDo6bW92ZShfX3gpKTsgfQoKICAgICAg
dGVtcGxhdGU8dHlwZW5hbWUuLi4gX0FyZ3M+CiAgICAgICAgdm9pZAogICAgICAgIGVtcGxhY2Vf
YmFjayhfQXJncyYmLi4uIF9fYXJncykKICAgICAgICB7IHRoaXMtPl9NX2luc2VydChlbmQoKSwg
c3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsgfQojIDExMjIgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIHZvaWQKICAgICAgcG9wX2JhY2soKSBu
b2V4Y2VwdAogICAgICB7IHRoaXMtPl9NX2VyYXNlKGl0ZXJhdG9yKHRoaXMtPl9NX2ltcGwuX01f
bm9kZS5fTV9wcmV2KSk7IH0KIyAxMTM5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3Rs
X2xpc3QuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfQXJncz4KICAgICAgICBpdGVy
YXRvcgogICAgICAgIGVtcGxhY2UoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgX0FyZ3MmJi4u
LiBfX2FyZ3MpOwojIDExNTQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5o
IiAzCiAgICAgIGl0ZXJhdG9yCiAgICAgIGluc2VydChjb25zdF9pdGVyYXRvciBfX3Bvc2l0aW9u
LCBjb25zdCB2YWx1ZV90eXBlJiBfX3gpOwojIDExODQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIGl0ZXJhdG9yCiAgICAgIGluc2VydChjb25zdF9pdGVy
YXRvciBfX3Bvc2l0aW9uLCB2YWx1ZV90eXBlJiYgX194KQogICAgICB7IHJldHVybiBlbXBsYWNl
KF9fcG9zaXRpb24sIHN0ZDo6bW92ZShfX3gpKTsgfQojIDEyMDMgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIGl0ZXJhdG9yCiAgICAgIGluc2VydChjb25z
dF9pdGVyYXRvciBfX3AsIGluaXRpYWxpemVyX2xpc3Q8dmFsdWVfdHlwZT4gX19sKQogICAgICB7
IHJldHVybiB0aGlzLT5pbnNlcnQoX19wLCBfX2wuYmVnaW4oKSwgX19sLmVuZCgpKTsgfQojIDEy
MjMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIGl0ZXJh
dG9yCiAgICAgIGluc2VydChjb25zdF9pdGVyYXRvciBfX3Bvc2l0aW9uLCBzaXplX3R5cGUgX19u
LCBjb25zdCB2YWx1ZV90eXBlJiBfX3gpOwojIDEyNjIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9y
LAogICAgICAgIHR5cGVuYW1lID0gc3RkOjpfUmVxdWlyZUlucHV0SXRlcjxfSW5wdXRJdGVyYXRv
cj4+CiBpdGVyYXRvcgogaW5zZXJ0KGNvbnN0X2l0ZXJhdG9yIF9fcG9zaXRpb24sIF9JbnB1dEl0
ZXJhdG9yIF9fZmlyc3QsCiAgICAgICAgX0lucHV0SXRlcmF0b3IgX19sYXN0KTsKIyAxMzA2ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMwogICAgICBpdGVyYXRvcgoK
ICAgICAgZXJhc2UoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbikgbm9leGNlcHQ7CiMgMTMzMSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9saXN0LmgiIDMKICAgICAgaXRlcmF0b3IK
CiAgICAgIGVyYXNlKGNvbnN0X2l0ZXJhdG9yIF9fZmlyc3QsIGNvbnN0X2l0ZXJhdG9yIF9fbGFz
dCkgbm9leGNlcHQKCgoKICAgICAgewogd2hpbGUgKF9fZmlyc3QgIT0gX19sYXN0KQogICBfX2Zp
cnN0ID0gZXJhc2UoX19maXJzdCk7CiByZXR1cm4gX19sYXN0Ll9NX2NvbnN0X2Nhc3QoKTsKICAg
ICAgfQojIDEzNTIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAg
ICAgIHZvaWQKICAgICAgc3dhcChsaXN0JiBfX3gpIG5vZXhjZXB0CiAgICAgIHsKIF9fZGV0YWls
OjpfTGlzdF9ub2RlX2Jhc2U6OnN3YXAodGhpcy0+X01faW1wbC5fTV9ub2RlLAogICAgICAgICAg
ICBfX3guX01faW1wbC5fTV9ub2RlKTsKCiBzaXplX3QgX194c2l6ZSA9IF9feC5fTV9nZXRfc2l6
ZSgpOwogX194Ll9NX3NldF9zaXplKHRoaXMtPl9NX2dldF9zaXplKCkpOwogdGhpcy0+X01fc2V0
X3NpemUoX194c2l6ZSk7CgogX05vZGVfYWxsb2NfdHJhaXRzOjpfU19vbl9zd2FwKHRoaXMtPl9N
X2dldF9Ob2RlX2FsbG9jYXRvcigpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBfX3guX01fZ2V0X05vZGVfYWxsb2NhdG9yKCkpOwogICAgICB9CgoKCgoKCgogICAgICB2
b2lkCiAgICAgIGNsZWFyKCkgbm9leGNlcHQKICAgICAgewogICAgICAgIF9CYXNlOjpfTV9jbGVh
cigpOwogICAgICAgIF9CYXNlOjpfTV9pbml0KCk7CiAgICAgIH0KIyAxMzkxICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMwogICAgICB2b2lkCgogICAgICBzcGxpY2Uo
Y29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgbGlzdCYmIF9feCkgbm9leGNlcHQKCgoKICAgICAg
ewogaWYgKCFfX3guZW1wdHkoKSkKICAgewogICAgIF9NX2NoZWNrX2VxdWFsX2FsbG9jYXRvcnMo
X194KTsKCiAgICAgdGhpcy0+X01fdHJhbnNmZXIoX19wb3NpdGlvbi5fTV9jb25zdF9jYXN0KCks
CiAgICAgICAgIF9feC5iZWdpbigpLCBfX3guZW5kKCkpOwoKICAgICB0aGlzLT5fTV9pbmNfc2l6
ZShfX3guX01fZ2V0X3NpemUoKSk7CiAgICAgX194Ll9NX3NldF9zaXplKDApOwogICB9CiAgICAg
IH0KCgogICAgICB2b2lkCiAgICAgIHNwbGljZShjb25zdF9pdGVyYXRvciBfX3Bvc2l0aW9uLCBs
aXN0JiBfX3gpIG5vZXhjZXB0CiAgICAgIHsgc3BsaWNlKF9fcG9zaXRpb24sIHN0ZDo6bW92ZShf
X3gpKTsgfQojIDE0MjcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAz
CiAgICAgIHZvaWQKICAgICAgc3BsaWNlKGNvbnN0X2l0ZXJhdG9yIF9fcG9zaXRpb24sIGxpc3Qm
JiBfX3gsIGNvbnN0X2l0ZXJhdG9yIF9faSkgbm9leGNlcHQKIyAxNDQyICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMwogICAgICB7CiBpdGVyYXRvciBfX2ogPSBfX2ku
X01fY29uc3RfY2FzdCgpOwogKytfX2o7CiBpZiAoX19wb3NpdGlvbiA9PSBfX2kgfHwgX19wb3Np
dGlvbiA9PSBfX2opCiAgIHJldHVybjsKCiBpZiAodGhpcyAhPSBzdGQ6Ol9fYWRkcmVzc29mKF9f
eCkpCiAgIF9NX2NoZWNrX2VxdWFsX2FsbG9jYXRvcnMoX194KTsKCiB0aGlzLT5fTV90cmFuc2Zl
cihfX3Bvc2l0aW9uLl9NX2NvbnN0X2Nhc3QoKSwKICAgICBfX2kuX01fY29uc3RfY2FzdCgpLCBf
X2opOwoKIHRoaXMtPl9NX2luY19zaXplKDEpOwogX194Ll9NX2RlY19zaXplKDEpOwogICAgICB9
CiMgMTQ2OSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9saXN0LmgiIDMKICAgICAg
dm9pZAogICAgICBzcGxpY2UoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgbGlzdCYgX194LCBj
b25zdF9pdGVyYXRvciBfX2kpIG5vZXhjZXB0CiAgICAgIHsgc3BsaWNlKF9fcG9zaXRpb24sIHN0
ZDo6bW92ZShfX3gpLCBfX2kpOyB9CiMgMTQ4OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L3N0bF9saXN0LmgiIDMKICAgICAgdm9pZAogICAgICBzcGxpY2UoY29uc3RfaXRlcmF0b3IgX19w
b3NpdGlvbiwgbGlzdCYmIF9feCwgY29uc3RfaXRlcmF0b3IgX19maXJzdCwKICAgICAgY29uc3Rf
aXRlcmF0b3IgX19sYXN0KSBub2V4Y2VwdAojIDE1MDggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIHsKIGlmIChfX2ZpcnN0ICE9IF9fbGFzdCkKICAgewog
ICAgIGlmICh0aGlzICE9IHN0ZDo6X19hZGRyZXNzb2YoX194KSkKICAgICAgIF9NX2NoZWNrX2Vx
dWFsX2FsbG9jYXRvcnMoX194KTsKCiAgICAgc2l6ZV90IF9fbiA9IHRoaXMtPl9NX2Rpc3RhbmNl
KF9fZmlyc3QuX01fbm9kZSwgX19sYXN0Ll9NX25vZGUpOwogICAgIHRoaXMtPl9NX2luY19zaXpl
KF9fbik7CiAgICAgX194Ll9NX2RlY19zaXplKF9fbik7CgogICAgIHRoaXMtPl9NX3RyYW5zZmVy
KF9fcG9zaXRpb24uX01fY29uc3RfY2FzdCgpLAogICAgICAgICBfX2ZpcnN0Ll9NX2NvbnN0X2Nh
c3QoKSwKICAgICAgICAgX19sYXN0Ll9NX2NvbnN0X2Nhc3QoKSk7CiAgIH0KICAgICAgfQojIDE1
MzggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIHZvaWQK
ICAgICAgc3BsaWNlKGNvbnN0X2l0ZXJhdG9yIF9fcG9zaXRpb24sIGxpc3QmIF9feCwgY29uc3Rf
aXRlcmF0b3IgX19maXJzdCwKICAgICAgY29uc3RfaXRlcmF0b3IgX19sYXN0KSBub2V4Y2VwdAog
ICAgICB7IHNwbGljZShfX3Bvc2l0aW9uLCBzdGQ6Om1vdmUoX194KSwgX19maXJzdCwgX19sYXN0
KTsgfQojIDE1NTUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAg
ICAgIHZvaWQKICAgICAgcmVtb3ZlKGNvbnN0IF9UcCYgX192YWx1ZSk7CiMgMTU2OSAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9saXN0LmgiIDMKICAgICAgdGVtcGxhdGU8dHlwZW5h
bWUgX1ByZWRpY2F0ZT4KICAgICAgICB2b2lkCiAgICAgICAgcmVtb3ZlX2lmKF9QcmVkaWNhdGUp
OwojIDE1ODMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAg
IHZvaWQKICAgICAgdW5pcXVlKCk7CiMgMTU5OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L3N0bF9saXN0LmgiIDMKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0JpbmFyeVByZWRpY2F0ZT4K
ICAgICAgICB2b2lkCiAgICAgICAgdW5pcXVlKF9CaW5hcnlQcmVkaWNhdGUpOwojIDE2MTIgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbGlzdC5oIiAzCiAgICAgIHZvaWQKICAgICAg
bWVyZ2UobGlzdCYmIF9feCk7CgogICAgICB2b2lkCiAgICAgIG1lcmdlKGxpc3QmIF9feCkKICAg
ICAgeyBtZXJnZShzdGQ6Om1vdmUoX194KSk7IH0KIyAxNjM3ICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvc3RsX2xpc3QuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfU3RyaWN0V2Vh
a09yZGVyaW5nPgogICAgICAgIHZvaWQKICAgICAgICBtZXJnZShsaXN0JiYgX194LCBfU3RyaWN0
V2Vha09yZGVyaW5nIF9fY29tcCk7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfU3RyaWN0V2Vh
a09yZGVyaW5nPgogICAgICAgIHZvaWQKICAgICAgICBtZXJnZShsaXN0JiBfX3gsIF9TdHJpY3RX
ZWFrT3JkZXJpbmcgX19jb21wKQogICAgICAgIHsgbWVyZ2Uoc3RkOjptb3ZlKF9feCksIF9fY29t
cCk7IH0KIyAxNjU2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMwog
ICAgICB2b2lkCiAgICAgIHJldmVyc2UoKSBub2V4Y2VwdAogICAgICB7IHRoaXMtPl9NX2ltcGwu
X01fbm9kZS5fTV9yZXZlcnNlKCk7IH0KCgoKCgoKCiAgICAgIHZvaWQKICAgICAgc29ydCgpOwoK
CgoKCgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1N0cmljdFdlYWtPcmRlcmluZz4KICAgICAg
ICB2b2lkCiAgICAgICAgc29ydChfU3RyaWN0V2Vha09yZGVyaW5nKTsKCiAgICBwcm90ZWN0ZWQ6
CgoKCgoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnRlZ2VyPgogICAgICAgIHZvaWQKICAg
ICAgICBfTV9pbml0aWFsaXplX2Rpc3BhdGNoKF9JbnRlZ2VyIF9fbiwgX0ludGVnZXIgX194LCBf
X3RydWVfdHlwZSkKICAgICAgICB7IF9NX2ZpbGxfaW5pdGlhbGl6ZShzdGF0aWNfY2FzdDxzaXpl
X3R5cGU+KF9fbiksIF9feCk7IH0KCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVy
YXRvcj4KICAgICAgICB2b2lkCiAgICAgICAgX01faW5pdGlhbGl6ZV9kaXNwYXRjaChfSW5wdXRJ
dGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QsCiAgICAgICAgICBfX2ZhbHNl
X3R5cGUpCiAgICAgICAgewogICBmb3IgKDsgX19maXJzdCAhPSBfX2xhc3Q7ICsrX19maXJzdCkK
CiAgICAgZW1wbGFjZV9iYWNrKCpfX2ZpcnN0KTsKCgoKIH0KCgoKICAgICAgdm9pZAogICAgICBf
TV9maWxsX2luaXRpYWxpemUoc2l6ZV90eXBlIF9fbiwgY29uc3QgdmFsdWVfdHlwZSYgX194KQog
ICAgICB7CiBmb3IgKDsgX19uOyAtLV9fbikKICAgcHVzaF9iYWNrKF9feCk7CiAgICAgIH0KCgoK
ICAgICAgdm9pZAogICAgICBfTV9kZWZhdWx0X2luaXRpYWxpemUoc2l6ZV90eXBlIF9fbikKICAg
ICAgewogZm9yICg7IF9fbjsgLS1fX24pCiAgIGVtcGxhY2VfYmFjaygpOwogICAgICB9CgoKICAg
ICAgdm9pZAogICAgICBfTV9kZWZhdWx0X2FwcGVuZChzaXplX3R5cGUgX19uKTsKIyAxNzM0ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2xpc3QuaCIgMwogICAgICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfSW50ZWdlcj4KICAgICAgICB2b2lkCiAgICAgICAgX01fYXNzaWduX2Rpc3BhdGNo
KF9JbnRlZ2VyIF9fbiwgX0ludGVnZXIgX192YWwsIF9fdHJ1ZV90eXBlKQogICAgICAgIHsgX01f
ZmlsbF9hc3NpZ24oX19uLCBfX3ZhbCk7IH0KCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5w
dXRJdGVyYXRvcj4KICAgICAgICB2b2lkCiAgICAgICAgX01fYXNzaWduX2Rpc3BhdGNoKF9JbnB1
dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgX19mYWxzZV90
eXBlKTsKCgoKICAgICAgdm9pZAogICAgICBfTV9maWxsX2Fzc2lnbihzaXplX3R5cGUgX19uLCBj
b25zdCB2YWx1ZV90eXBlJiBfX3ZhbCk7CgoKCiAgICAgIHZvaWQKICAgICAgX01fdHJhbnNmZXIo
aXRlcmF0b3IgX19wb3NpdGlvbiwgaXRlcmF0b3IgX19maXJzdCwgaXRlcmF0b3IgX19sYXN0KQog
ICAgICB7IF9fcG9zaXRpb24uX01fbm9kZS0+X01fdHJhbnNmZXIoX19maXJzdC5fTV9ub2RlLCBf
X2xhc3QuX01fbm9kZSk7IH0KIyAxNzY2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3Rs
X2xpc3QuaCIgMwogICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogICAgICAgdm9pZAog
ICAgICAgX01faW5zZXJ0KGl0ZXJhdG9yIF9fcG9zaXRpb24sIF9BcmdzJiYuLi4gX19hcmdzKQog
ICAgICAgewogIF9Ob2RlKiBfX3RtcCA9IF9NX2NyZWF0ZV9ub2RlKHN0ZDo6Zm9yd2FyZDxfQXJn
cz4oX19hcmdzKS4uLik7CiAgX190bXAtPl9NX2hvb2soX19wb3NpdGlvbi5fTV9ub2RlKTsKICB0
aGlzLT5fTV9pbmNfc2l6ZSgxKTsKICAgICAgIH0KCgoKICAgICAgdm9pZAogICAgICBfTV9lcmFz
ZShpdGVyYXRvciBfX3Bvc2l0aW9uKSBub2V4Y2VwdAogICAgICB7CiB0aGlzLT5fTV9kZWNfc2l6
ZSgxKTsKICAgICAgICBfX3Bvc2l0aW9uLl9NX25vZGUtPl9NX3VuaG9vaygpOwogICAgICAgIF9O
b2RlKiBfX24gPSBzdGF0aWNfY2FzdDxfTm9kZSo+KF9fcG9zaXRpb24uX01fbm9kZSk7CgogX05v
ZGVfYWxsb2NfdHJhaXRzOjpkZXN0cm95KF9NX2dldF9Ob2RlX2FsbG9jYXRvcigpLCBfX24tPl9N
X3ZhbHB0cigpKTsKCgoKCiAgICAgICAgX01fcHV0X25vZGUoX19uKTsKICAgICAgfQoKCiAgICAg
IHZvaWQKICAgICAgX01fY2hlY2tfZXF1YWxfYWxsb2NhdG9ycyhsaXN0JiBfX3gpIG5vZXhjZXB0
CiAgICAgIHsKIGlmIChzdGQ6Ol9fYWxsb2NfbmVxPHR5cGVuYW1lIF9CYXNlOjpfTm9kZV9hbGxv
Y190eXBlPjo6CiAgICAgX1NfZG9faXQoX01fZ2V0X05vZGVfYWxsb2NhdG9yKCksIF9feC5fTV9n
ZXRfTm9kZV9hbGxvY2F0b3IoKSkpCiAgIF9fYnVpbHRpbl9hYm9ydCgpOwogICAgICB9CgoKICAg
ICAgY29uc3RfaXRlcmF0b3IKICAgICAgX01fcmVzaXplX3BvcyhzaXplX3R5cGUmIF9fbmV3X3Np
emUpIGNvbnN0OwoKCiAgICAgIHZvaWQKICAgICAgX01fbW92ZV9hc3NpZ24obGlzdCYmIF9feCwg
dHJ1ZV90eXBlKSBub2V4Y2VwdAogICAgICB7CiB0aGlzLT5fTV9jbGVhcigpOwogaWYgKF9feC5l
bXB0eSgpKQogICB0aGlzLT5fTV9pbml0KCk7CiBlbHNlCiAgIHsKICAgICB0aGlzLT5fTV9pbXBs
Ll9NX25vZGUuX01fbmV4dCA9IF9feC5fTV9pbXBsLl9NX25vZGUuX01fbmV4dDsKICAgICB0aGlz
LT5fTV9pbXBsLl9NX25vZGUuX01fbmV4dC0+X01fcHJldiA9ICZ0aGlzLT5fTV9pbXBsLl9NX25v
ZGU7CiAgICAgdGhpcy0+X01faW1wbC5fTV9ub2RlLl9NX3ByZXYgPSBfX3guX01faW1wbC5fTV9u
b2RlLl9NX3ByZXY7CiAgICAgdGhpcy0+X01faW1wbC5fTV9ub2RlLl9NX3ByZXYtPl9NX25leHQg
PSAmdGhpcy0+X01faW1wbC5fTV9ub2RlOwogICAgIHRoaXMtPl9NX3NldF9zaXplKF9feC5fTV9n
ZXRfc2l6ZSgpKTsKICAgICBfX3guX01faW5pdCgpOwogICB9CiAgICAgICAgc3RkOjpfX2FsbG9j
X29uX21vdmUodGhpcy0+X01fZ2V0X05vZGVfYWxsb2NhdG9yKCksCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgX194Ll9NX2dldF9Ob2RlX2FsbG9jYXRvcigpKTsKICAgICAgfQoKICAgICAg
dm9pZAogICAgICBfTV9tb3ZlX2Fzc2lnbihsaXN0JiYgX194LCBmYWxzZV90eXBlKQogICAgICB7
CiBpZiAoX194Ll9NX2dldF9Ob2RlX2FsbG9jYXRvcigpID09IHRoaXMtPl9NX2dldF9Ob2RlX2Fs
bG9jYXRvcigpKQogICAgICAgICAgX01fbW92ZV9hc3NpZ24oc3RkOjptb3ZlKF9feCksIHRydWVf
dHlwZXt9KTsKICAgICAgICBlbHNlCgoKICAgX01fYXNzaWduX2Rpc3BhdGNoKHN0ZDo6X19tYWtl
X21vdmVfaWZfbm9leGNlcHRfaXRlcmF0b3IoX194LmJlZ2luKCkpLAogICAgICAgIHN0ZDo6X19t
YWtlX21vdmVfaWZfbm9leGNlcHRfaXRlcmF0b3IoX194LmVuZCgpKSwKICAgICAgICBfX2ZhbHNl
X3R5cGV7fSk7CiAgICAgIH0KCiAgICB9Owp9CiMgMTg1MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL3N0bF9saXN0LmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9B
bGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj09KGNvbnN0IGxpc3Q8X1RwLCBfQWxs
b2M+JiBfX3gsIGNvbnN0IGxpc3Q8X1RwLCBfQWxsb2M+JiBfX3kpCiAgICB7CgogICAgICBpZiAo
X194LnNpemUoKSAhPSBfX3kuc2l6ZSgpKQogcmV0dXJuIGZhbHNlOwoKCiAgICAgIHR5cGVkZWYg
dHlwZW5hbWUgbGlzdDxfVHAsIF9BbGxvYz46OmNvbnN0X2l0ZXJhdG9yIGNvbnN0X2l0ZXJhdG9y
OwogICAgICBjb25zdF9pdGVyYXRvciBfX2VuZDEgPSBfX3guZW5kKCk7CiAgICAgIGNvbnN0X2l0
ZXJhdG9yIF9fZW5kMiA9IF9feS5lbmQoKTsKCiAgICAgIGNvbnN0X2l0ZXJhdG9yIF9faTEgPSBf
X3guYmVnaW4oKTsKICAgICAgY29uc3RfaXRlcmF0b3IgX19pMiA9IF9feS5iZWdpbigpOwogICAg
ICB3aGlsZSAoX19pMSAhPSBfX2VuZDEgJiYgX19pMiAhPSBfX2VuZDIgJiYgKl9faTEgPT0gKl9f
aTIpCiB7CiAgICsrX19pMTsKICAgKytfX2kyOwogfQogICAgICByZXR1cm4gX19pMSA9PSBfX2Vu
ZDEgJiYgX19pMiA9PSBfX2VuZDI7CiAgICB9CiMgMTg4NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL3N0bF9saXN0LmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9B
bGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcjwoY29uc3QgbGlzdDxfVHAsIF9BbGxv
Yz4mIF9feCwgY29uc3QgbGlzdDxfVHAsIF9BbGxvYz4mIF9feSkKICAgIHsgcmV0dXJuIHN0ZDo6
bGV4aWNvZ3JhcGhpY2FsX2NvbXBhcmUoX194LmJlZ2luKCksIF9feC5lbmQoKSwKICAgICAgIF9f
eS5iZWdpbigpLCBfX3kuZW5kKCkpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVu
YW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvciE9KGNvbnN0IGxpc3Q8X1Rw
LCBfQWxsb2M+JiBfX3gsIGNvbnN0IGxpc3Q8X1RwLCBfQWxsb2M+JiBfX3kpCiAgICB7IHJldHVy
biAhKF9feCA9PSBfX3kpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9B
bGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj4oY29uc3QgbGlzdDxfVHAsIF9BbGxv
Yz4mIF9feCwgY29uc3QgbGlzdDxfVHAsIF9BbGxvYz4mIF9feSkKICAgIHsgcmV0dXJuIF9feSA8
IF9feDsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBp
bmxpbmUgYm9vbAogICAgb3BlcmF0b3I8PShjb25zdCBsaXN0PF9UcCwgX0FsbG9jPiYgX194LCBj
b25zdCBsaXN0PF9UcCwgX0FsbG9jPiYgX195KQogICAgeyByZXR1cm4gIShfX3kgPCBfX3gpOyB9
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBi
b29sCiAgICBvcGVyYXRvcj49KGNvbnN0IGxpc3Q8X1RwLCBfQWxsb2M+JiBfX3gsIGNvbnN0IGxp
c3Q8X1RwLCBfQWxsb2M+JiBfX3kpCiAgICB7IHJldHVybiAhKF9feCA8IF9feSk7IH0KCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIHZvaWQKICAg
IHN3YXAobGlzdDxfVHAsIF9BbGxvYz4mIF9feCwgbGlzdDxfVHAsIF9BbGxvYz4mIF9feSkKICAg
IG5vZXhjZXB0KG5vZXhjZXB0KF9feC5zd2FwKF9feSkpKQogICAgeyBfX3guc3dhcChfX3kpOyB9
CgoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBwdHJkaWZmX3QKICAg
IF9fZGlzdGFuY2Uoc3RkOjpfTGlzdF9pdGVyYXRvcjxfVHA+IF9fZmlyc3QsCiAgICAgICAgc3Rk
OjpfTGlzdF9pdGVyYXRvcjxfVHA+IF9fbGFzdCwKICAgICAgICBpbnB1dF9pdGVyYXRvcl90YWcg
X190YWcpCiAgICB7CiAgICAgIHR5cGVkZWYgc3RkOjpfTGlzdF9jb25zdF9pdGVyYXRvcjxfVHA+
IF9DSXRlcjsKICAgICAgcmV0dXJuIHN0ZDo6X19kaXN0YW5jZShfQ0l0ZXIoX19maXJzdCksIF9D
SXRlcihfX2xhc3QpLCBfX3RhZyk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
IGlubGluZSBwdHJkaWZmX3QKICAgIF9fZGlzdGFuY2Uoc3RkOjpfTGlzdF9jb25zdF9pdGVyYXRv
cjxfVHA+IF9fZmlyc3QsCiAgICAgICAgc3RkOjpfTGlzdF9jb25zdF9pdGVyYXRvcjxfVHA+IF9f
bGFzdCwKICAgICAgICBpbnB1dF9pdGVyYXRvcl90YWcpCiAgICB7CiAgICAgIHR5cGVkZWYgc3Rk
OjpfTGlzdF9ub2RlPHNpemVfdD4gX1NlbnRpbmVsOwogICAgICBzdGQ6Ol9MaXN0X2NvbnN0X2l0
ZXJhdG9yPF9UcD4gX19iZXlvbmQgPSBfX2xhc3Q7CiAgICAgICsrX19iZXlvbmQ7CiAgICAgIGJv
b2wgX193aG9sZSA9IF9fZmlyc3QgPT0gX19iZXlvbmQ7CiAgICAgIGlmIChfX2J1aWx0aW5fY29u
c3RhbnRfcCAoX193aG9sZSkgJiYgX193aG9sZSkKIHJldHVybiAqc3RhdGljX2Nhc3Q8Y29uc3Qg
X1NlbnRpbmVsKj4oX19sYXN0Ll9NX25vZGUpLT5fTV92YWxwdHIoKTsKCiAgICAgIHB0cmRpZmZf
dCBfX24gPSAwOwogICAgICB3aGlsZSAoX19maXJzdCAhPSBfX2xhc3QpCiB7CiAgICsrX19maXJz
dDsKICAgKytfX247CiB9CiAgICAgIHJldHVybiBfX247CiAgICB9CgoKCn0KIyA2NCAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9saXN0IiAyIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvbGlzdC50Y2MiIDEgMwojIDU5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbGlzdC50
Y2MiIDMKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZh
dWx0IikpKQp7CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAg
IHZvaWQKICAgIF9MaXN0X2Jhc2U8X1RwLCBfQWxsb2M+OjoKICAgIF9NX2NsZWFyKCkgbm9leGNl
cHQKICAgIHsKICAgICAgdHlwZWRlZiBfTGlzdF9ub2RlPF9UcD4gX05vZGU7CiAgICAgIF9fZGV0
YWlsOjpfTGlzdF9ub2RlX2Jhc2UqIF9fY3VyID0gX01faW1wbC5fTV9ub2RlLl9NX25leHQ7CiAg
ICAgIHdoaWxlIChfX2N1ciAhPSAmX01faW1wbC5fTV9ub2RlKQogewogICBfTm9kZSogX190bXAg
PSBzdGF0aWNfY2FzdDxfTm9kZSo+KF9fY3VyKTsKICAgX19jdXIgPSBfX3RtcC0+X01fbmV4dDsK
ICAgX1RwKiBfX3ZhbCA9IF9fdG1wLT5fTV92YWxwdHIoKTsKCiAgIF9Ob2RlX2FsbG9jX3RyYWl0
czo6ZGVzdHJveShfTV9nZXRfTm9kZV9hbGxvY2F0b3IoKSwgX192YWwpOwoKCgogICBfTV9wdXRf
bm9kZShfX3RtcCk7CiB9CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1l
IF9BbGxvYz4KICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogICAgICB0eXBlbmFtZSBs
aXN0PF9UcCwgX0FsbG9jPjo6aXRlcmF0b3IKICAgICAgbGlzdDxfVHAsIF9BbGxvYz46OgogICAg
ICBlbXBsYWNlKGNvbnN0X2l0ZXJhdG9yIF9fcG9zaXRpb24sIF9BcmdzJiYuLi4gX19hcmdzKQog
ICAgICB7CiBfTm9kZSogX190bXAgPSBfTV9jcmVhdGVfbm9kZShzdGQ6OmZvcndhcmQ8X0FyZ3M+
KF9fYXJncykuLi4pOwogX190bXAtPl9NX2hvb2soX19wb3NpdGlvbi5fTV9jb25zdF9jYXN0KCku
X01fbm9kZSk7CiB0aGlzLT5fTV9pbmNfc2l6ZSgxKTsKIHJldHVybiBpdGVyYXRvcihfX3RtcCk7
CiAgICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAg
dHlwZW5hbWUgbGlzdDxfVHAsIF9BbGxvYz46Oml0ZXJhdG9yCiAgICBsaXN0PF9UcCwgX0FsbG9j
Pjo6CgogICAgaW5zZXJ0KGNvbnN0X2l0ZXJhdG9yIF9fcG9zaXRpb24sIGNvbnN0IHZhbHVlX3R5
cGUmIF9feCkKCgoKICAgIHsKICAgICAgX05vZGUqIF9fdG1wID0gX01fY3JlYXRlX25vZGUoX194
KTsKICAgICAgX190bXAtPl9NX2hvb2soX19wb3NpdGlvbi5fTV9jb25zdF9jYXN0KCkuX01fbm9k
ZSk7CiAgICAgIHRoaXMtPl9NX2luY19zaXplKDEpOwogICAgICByZXR1cm4gaXRlcmF0b3IoX190
bXApOwogICAgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAg
ICB0eXBlbmFtZSBsaXN0PF9UcCwgX0FsbG9jPjo6aXRlcmF0b3IKICAgIGxpc3Q8X1RwLCBfQWxs
b2M+OjoKICAgIGluc2VydChjb25zdF9pdGVyYXRvciBfX3Bvc2l0aW9uLCBzaXplX3R5cGUgX19u
LCBjb25zdCB2YWx1ZV90eXBlJiBfX3gpCiAgICB7CiAgICAgIGlmIChfX24pCiB7CiAgIGxpc3Qg
X190bXAoX19uLCBfX3gsIGdldF9hbGxvY2F0b3IoKSk7CiAgIGl0ZXJhdG9yIF9faXQgPSBfX3Rt
cC5iZWdpbigpOwogICBzcGxpY2UoX19wb3NpdGlvbiwgX190bXApOwogICByZXR1cm4gX19pdDsK
IH0KICAgICAgcmV0dXJuIF9fcG9zaXRpb24uX01fY29uc3RfY2FzdCgpOwogICAgfQoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZT4KICAgICAgdHlwZW5hbWUgbGlzdDxfVHAsIF9BbGxv
Yz46Oml0ZXJhdG9yCiAgICAgIGxpc3Q8X1RwLCBfQWxsb2M+OjoKICAgICAgaW5zZXJ0KGNvbnN0
X2l0ZXJhdG9yIF9fcG9zaXRpb24sIF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsCiAgICAgIF9JbnB1
dEl0ZXJhdG9yIF9fbGFzdCkKICAgICAgewogbGlzdCBfX3RtcChfX2ZpcnN0LCBfX2xhc3QsIGdl
dF9hbGxvY2F0b3IoKSk7CiBpZiAoIV9fdG1wLmVtcHR5KCkpCiAgIHsKICAgICBpdGVyYXRvciBf
X2l0ID0gX190bXAuYmVnaW4oKTsKICAgICBzcGxpY2UoX19wb3NpdGlvbiwgX190bXApOwogICAg
IHJldHVybiBfX2l0OwogICB9CiByZXR1cm4gX19wb3NpdGlvbi5fTV9jb25zdF9jYXN0KCk7CiAg
ICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdHlw
ZW5hbWUgbGlzdDxfVHAsIF9BbGxvYz46Oml0ZXJhdG9yCiAgICBsaXN0PF9UcCwgX0FsbG9jPjo6
CgogICAgZXJhc2UoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbikgbm9leGNlcHQKCgoKICAgIHsK
ICAgICAgaXRlcmF0b3IgX19yZXQgPSBpdGVyYXRvcihfX3Bvc2l0aW9uLl9NX25vZGUtPl9NX25l
eHQpOwogICAgICBfTV9lcmFzZShfX3Bvc2l0aW9uLl9NX2NvbnN0X2Nhc3QoKSk7CiAgICAgIHJl
dHVybiBfX3JldDsKICAgIH0KIyAxNzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9saXN0
LnRjYyIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdHlw
ZW5hbWUgbGlzdDxfVHAsIF9BbGxvYz46OmNvbnN0X2l0ZXJhdG9yCiAgICBsaXN0PF9UcCwgX0Fs
bG9jPjo6CiAgICBfTV9yZXNpemVfcG9zKHNpemVfdHlwZSYgX19uZXdfc2l6ZSkgY29uc3QKICAg
IHsKICAgICAgY29uc3RfaXRlcmF0b3IgX19pOwoKICAgICAgY29uc3Qgc2l6ZV90eXBlIF9fbGVu
ID0gc2l6ZSgpOwogICAgICBpZiAoX19uZXdfc2l6ZSA8IF9fbGVuKQogewogICBpZiAoX19uZXdf
c2l6ZSA8PSBfX2xlbiAvIDIpCiAgICAgewogICAgICAgX19pID0gYmVnaW4oKTsKICAgICAgIHN0
ZDo6YWR2YW5jZShfX2ksIF9fbmV3X3NpemUpOwogICAgIH0KICAgZWxzZQogICAgIHsKICAgICAg
IF9faSA9IGVuZCgpOwogICAgICAgcHRyZGlmZl90IF9fbnVtX2VyYXNlID0gX19sZW4gLSBfX25l
d19zaXplOwogICAgICAgc3RkOjphZHZhbmNlKF9faSwgLV9fbnVtX2VyYXNlKTsKICAgICB9CiAg
IF9fbmV3X3NpemUgPSAwOwogICByZXR1cm4gX19pOwogfQogICAgICBlbHNlCiBfX2kgPSBlbmQo
KTsKCgoKCgogICAgICBfX25ld19zaXplIC09IF9fbGVuOwogICAgICByZXR1cm4gX19pOwogICAg
fQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB2b2lkCiAg
ICBsaXN0PF9UcCwgX0FsbG9jPjo6CiAgICBfTV9kZWZhdWx0X2FwcGVuZChzaXplX3R5cGUgX19u
KQogICAgewogICAgICBzaXplX3R5cGUgX19pID0gMDsKICAgICAgdHJ5CiB7CiAgIGZvciAoOyBf
X2kgPCBfX247ICsrX19pKQogICAgIGVtcGxhY2VfYmFjaygpOwogfQogICAgICBjYXRjaCguLi4p
CiB7CiAgIGZvciAoOyBfX2k7IC0tX19pKQogICAgIHBvcF9iYWNrKCk7CiAgIHRocm93OwogfQog
ICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHZvaWQK
ICAgIGxpc3Q8X1RwLCBfQWxsb2M+OjoKICAgIHJlc2l6ZShzaXplX3R5cGUgX19uZXdfc2l6ZSkK
ICAgIHsKICAgICAgY29uc3RfaXRlcmF0b3IgX19pID0gX01fcmVzaXplX3BvcyhfX25ld19zaXpl
KTsKICAgICAgaWYgKF9fbmV3X3NpemUpCiBfTV9kZWZhdWx0X2FwcGVuZChfX25ld19zaXplKTsK
ICAgICAgZWxzZQogICAgICAgIGVyYXNlKF9faSwgZW5kKCkpOwogICAgfQoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHZvaWQKICAgIGxpc3Q8X1RwLCBfQWxs
b2M+OjoKICAgIHJlc2l6ZShzaXplX3R5cGUgX19uZXdfc2l6ZSwgY29uc3QgdmFsdWVfdHlwZSYg
X194KQogICAgewogICAgICBjb25zdF9pdGVyYXRvciBfX2kgPSBfTV9yZXNpemVfcG9zKF9fbmV3
X3NpemUpOwogICAgICBpZiAoX19uZXdfc2l6ZSkKICAgICAgICBpbnNlcnQoZW5kKCksIF9fbmV3
X3NpemUsIF9feCk7CiAgICAgIGVsc2UKICAgICAgICBlcmFzZShfX2ksIGVuZCgpKTsKICAgIH0K
IyAyNjQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9saXN0LnRjYyIgMwogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgbGlzdDxfVHAsIF9BbGxvYz4mCiAg
ICBsaXN0PF9UcCwgX0FsbG9jPjo6CiAgICBvcGVyYXRvcj0oY29uc3QgbGlzdCYgX194KQogICAg
ewogICAgICBpZiAodGhpcyAhPSBzdGQ6Ol9fYWRkcmVzc29mKF9feCkpCiB7CgogICBpZiAoX05v
ZGVfYWxsb2NfdHJhaXRzOjpfU19wcm9wYWdhdGVfb25fY29weV9hc3NpZ24oKSkKICAgICB7CiAg
ICAgICAgICAgICAgYXV0byYgX190aGlzX2FsbG9jID0gdGhpcy0+X01fZ2V0X05vZGVfYWxsb2Nh
dG9yKCk7CiAgICAgICAgICAgICAgYXV0byYgX190aGF0X2FsbG9jID0gX194Ll9NX2dldF9Ob2Rl
X2FsbG9jYXRvcigpOwogICAgICAgICAgICAgIGlmICghX05vZGVfYWxsb2NfdHJhaXRzOjpfU19h
bHdheXNfZXF1YWwoKQogICAgICAgICAgICYmIF9fdGhpc19hbGxvYyAhPSBfX3RoYXRfYWxsb2Mp
CiAgICAgICAgIHsKCiAgICBjbGVhcigpOwogIH0KICAgICAgIHN0ZDo6X19hbGxvY19vbl9jb3B5
KF9fdGhpc19hbGxvYywgX190aGF0X2FsbG9jKTsKICAgICAgICAgICAgfQoKICAgX01fYXNzaWdu
X2Rpc3BhdGNoKF9feC5iZWdpbigpLCBfX3guZW5kKCksIF9fZmFsc2VfdHlwZSgpKTsKIH0KICAg
ICAgcmV0dXJuICp0aGlzOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1l
IF9BbGxvYz4KICAgIHZvaWQKICAgIGxpc3Q8X1RwLCBfQWxsb2M+OjoKICAgIF9NX2ZpbGxfYXNz
aWduKHNpemVfdHlwZSBfX24sIGNvbnN0IHZhbHVlX3R5cGUmIF9fdmFsKQogICAgewogICAgICBp
dGVyYXRvciBfX2kgPSBiZWdpbigpOwogICAgICBmb3IgKDsgX19pICE9IGVuZCgpICYmIF9fbiA+
IDA7ICsrX19pLCAtLV9fbikKICAgICAgICAqX19pID0gX192YWw7CiAgICAgIGlmIChfX24gPiAw
KQogICAgICAgIGluc2VydChlbmQoKSwgX19uLCBfX3ZhbCk7CiAgICAgIGVsc2UKICAgICAgICBl
cmFzZShfX2ksIGVuZCgpKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFt
ZSBfQWxsb2M+CiAgICB0ZW1wbGF0ZSA8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3I+CiAgICAgIHZv
aWQKICAgICAgbGlzdDxfVHAsIF9BbGxvYz46OgogICAgICBfTV9hc3NpZ25fZGlzcGF0Y2goX0lu
cHV0SXRlcmF0b3IgX19maXJzdDIsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdDIsCiAgICBfX2ZhbHNl
X3R5cGUpCiAgICAgIHsKICAgICAgICBpdGVyYXRvciBfX2ZpcnN0MSA9IGJlZ2luKCk7CiAgICAg
ICAgaXRlcmF0b3IgX19sYXN0MSA9IGVuZCgpOwogICAgICAgIGZvciAoOyBfX2ZpcnN0MSAhPSBf
X2xhc3QxICYmIF9fZmlyc3QyICE9IF9fbGFzdDI7CiAgICAgICsrX19maXJzdDEsICsrX19maXJz
dDIpCiAgICAgICAgICAqX19maXJzdDEgPSAqX19maXJzdDI7CiAgICAgICAgaWYgKF9fZmlyc3Qy
ID09IF9fbGFzdDIpCiAgICAgICAgICBlcmFzZShfX2ZpcnN0MSwgX19sYXN0MSk7CiAgICAgICAg
ZWxzZQogICAgICAgICAgaW5zZXJ0KF9fbGFzdDEsIF9fZmlyc3QyLCBfX2xhc3QyKTsKICAgICAg
fQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHZvaWQKICAg
IGxpc3Q8X1RwLCBfQWxsb2M+OjoKICAgIHJlbW92ZShjb25zdCB2YWx1ZV90eXBlJiBfX3ZhbHVl
KQogICAgewogICAgICBpdGVyYXRvciBfX2ZpcnN0ID0gYmVnaW4oKTsKICAgICAgaXRlcmF0b3Ig
X19sYXN0ID0gZW5kKCk7CiAgICAgIGl0ZXJhdG9yIF9fZXh0cmEgPSBfX2xhc3Q7CiAgICAgIHdo
aWxlIChfX2ZpcnN0ICE9IF9fbGFzdCkKIHsKICAgaXRlcmF0b3IgX19uZXh0ID0gX19maXJzdDsK
ICAgKytfX25leHQ7CiAgIGlmICgqX19maXJzdCA9PSBfX3ZhbHVlKQogICAgIHsKCgoKICAgICAg
IGlmIChzdGQ6Ol9fYWRkcmVzc29mKCpfX2ZpcnN0KSAhPSBzdGQ6Ol9fYWRkcmVzc29mKF9fdmFs
dWUpKQogIF9NX2VyYXNlKF9fZmlyc3QpOwogICAgICAgZWxzZQogIF9fZXh0cmEgPSBfX2ZpcnN0
OwogICAgIH0KICAgX19maXJzdCA9IF9fbmV4dDsKIH0KICAgICAgaWYgKF9fZXh0cmEgIT0gX19s
YXN0KQogX01fZXJhc2UoX19leHRyYSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwg
dHlwZW5hbWUgX0FsbG9jPgogICAgdm9pZAogICAgbGlzdDxfVHAsIF9BbGxvYz46OgogICAgdW5p
cXVlKCkKICAgIHsKICAgICAgaXRlcmF0b3IgX19maXJzdCA9IGJlZ2luKCk7CiAgICAgIGl0ZXJh
dG9yIF9fbGFzdCA9IGVuZCgpOwogICAgICBpZiAoX19maXJzdCA9PSBfX2xhc3QpCiByZXR1cm47
CiAgICAgIGl0ZXJhdG9yIF9fbmV4dCA9IF9fZmlyc3Q7CiAgICAgIHdoaWxlICgrK19fbmV4dCAh
PSBfX2xhc3QpCiB7CiAgIGlmICgqX19maXJzdCA9PSAqX19uZXh0KQogICAgIF9NX2VyYXNlKF9f
bmV4dCk7CiAgIGVsc2UKICAgICBfX2ZpcnN0ID0gX19uZXh0OwogICBfX25leHQgPSBfX2ZpcnN0
OwogfQogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAg
IHZvaWQKICAgIGxpc3Q8X1RwLCBfQWxsb2M+OjoKCiAgICBtZXJnZShsaXN0JiYgX194KQoKCgog
ICAgewoKCiAgICAgIGlmICh0aGlzICE9IHN0ZDo6X19hZGRyZXNzb2YoX194KSkKIHsKICAgX01f
Y2hlY2tfZXF1YWxfYWxsb2NhdG9ycyhfX3gpOwoKICAgaXRlcmF0b3IgX19maXJzdDEgPSBiZWdp
bigpOwogICBpdGVyYXRvciBfX2xhc3QxID0gZW5kKCk7CiAgIGl0ZXJhdG9yIF9fZmlyc3QyID0g
X194LmJlZ2luKCk7CiAgIGl0ZXJhdG9yIF9fbGFzdDIgPSBfX3guZW5kKCk7CiAgIHdoaWxlIChf
X2ZpcnN0MSAhPSBfX2xhc3QxICYmIF9fZmlyc3QyICE9IF9fbGFzdDIpCiAgICAgaWYgKCpfX2Zp
cnN0MiA8ICpfX2ZpcnN0MSkKICAgICAgIHsKICBpdGVyYXRvciBfX25leHQgPSBfX2ZpcnN0MjsK
ICBfTV90cmFuc2ZlcihfX2ZpcnN0MSwgX19maXJzdDIsICsrX19uZXh0KTsKICBfX2ZpcnN0MiA9
IF9fbmV4dDsKICAgICAgIH0KICAgICBlbHNlCiAgICAgICArK19fZmlyc3QxOwogICBpZiAoX19m
aXJzdDIgIT0gX19sYXN0MikKICAgICBfTV90cmFuc2ZlcihfX2xhc3QxLCBfX2ZpcnN0MiwgX19s
YXN0Mik7CgogICB0aGlzLT5fTV9pbmNfc2l6ZShfX3guX01fZ2V0X3NpemUoKSk7CiAgIF9feC5f
TV9zZXRfc2l6ZSgwKTsKIH0KICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFt
ZSBfQWxsb2M+CiAgICB0ZW1wbGF0ZSA8dHlwZW5hbWUgX1N0cmljdFdlYWtPcmRlcmluZz4KICAg
ICAgdm9pZAogICAgICBsaXN0PF9UcCwgX0FsbG9jPjo6CgogICAgICBtZXJnZShsaXN0JiYgX194
LCBfU3RyaWN0V2Vha09yZGVyaW5nIF9fY29tcCkKCgoKICAgICAgewoKCiBpZiAodGhpcyAhPSBz
dGQ6Ol9fYWRkcmVzc29mKF9feCkpCiAgIHsKICAgICBfTV9jaGVja19lcXVhbF9hbGxvY2F0b3Jz
KF9feCk7CgogICAgIGl0ZXJhdG9yIF9fZmlyc3QxID0gYmVnaW4oKTsKICAgICBpdGVyYXRvciBf
X2xhc3QxID0gZW5kKCk7CiAgICAgaXRlcmF0b3IgX19maXJzdDIgPSBfX3guYmVnaW4oKTsKICAg
ICBpdGVyYXRvciBfX2xhc3QyID0gX194LmVuZCgpOwogICAgIHdoaWxlIChfX2ZpcnN0MSAhPSBf
X2xhc3QxICYmIF9fZmlyc3QyICE9IF9fbGFzdDIpCiAgICAgICBpZiAoX19jb21wKCpfX2ZpcnN0
MiwgKl9fZmlyc3QxKSkKICB7CiAgICBpdGVyYXRvciBfX25leHQgPSBfX2ZpcnN0MjsKICAgIF9N
X3RyYW5zZmVyKF9fZmlyc3QxLCBfX2ZpcnN0MiwgKytfX25leHQpOwogICAgX19maXJzdDIgPSBf
X25leHQ7CiAgfQogICAgICAgZWxzZQogICsrX19maXJzdDE7CiAgICAgaWYgKF9fZmlyc3QyICE9
IF9fbGFzdDIpCiAgICAgICBfTV90cmFuc2ZlcihfX2xhc3QxLCBfX2ZpcnN0MiwgX19sYXN0Mik7
CgogICAgIHRoaXMtPl9NX2luY19zaXplKF9feC5fTV9nZXRfc2l6ZSgpKTsKICAgICBfX3guX01f
c2V0X3NpemUoMCk7CiAgIH0KICAgICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVu
YW1lIF9BbGxvYz4KICAgIHZvaWQKICAgIGxpc3Q8X1RwLCBfQWxsb2M+OjoKICAgIHNvcnQoKQog
ICAgewoKICAgICAgaWYgKHRoaXMtPl9NX2ltcGwuX01fbm9kZS5fTV9uZXh0ICE9ICZ0aGlzLT5f
TV9pbXBsLl9NX25vZGUKICAgJiYgdGhpcy0+X01faW1wbC5fTV9ub2RlLl9NX25leHQtPl9NX25l
eHQgIT0gJnRoaXMtPl9NX2ltcGwuX01fbm9kZSkKICAgICAgewogICAgICAgIGxpc3QgX19jYXJy
eTsKICAgICAgICBsaXN0IF9fdG1wWzY0XTsKICAgICAgICBsaXN0ICogX19maWxsID0gX190bXA7
CiAgICAgICAgbGlzdCAqIF9fY291bnRlcjsKCiAgICAgICAgZG8KICAgewogICAgIF9fY2Fycnku
c3BsaWNlKF9fY2FycnkuYmVnaW4oKSwgKnRoaXMsIGJlZ2luKCkpOwoKICAgICBmb3IoX19jb3Vu
dGVyID0gX190bXA7CiAgX19jb3VudGVyICE9IF9fZmlsbCAmJiAhX19jb3VudGVyLT5lbXB0eSgp
OwogICsrX19jb3VudGVyKQogICAgICAgewogIF9fY291bnRlci0+bWVyZ2UoX19jYXJyeSk7CiAg
X19jYXJyeS5zd2FwKCpfX2NvdW50ZXIpOwogICAgICAgfQogICAgIF9fY2Fycnkuc3dhcCgqX19j
b3VudGVyKTsKICAgICBpZiAoX19jb3VudGVyID09IF9fZmlsbCkKICAgICAgICsrX19maWxsOwog
ICB9CiB3aGlsZSAoICFlbXB0eSgpICk7CgogICAgICAgIGZvciAoX19jb3VudGVyID0gX190bXAg
KyAxOyBfX2NvdW50ZXIgIT0gX19maWxsOyArK19fY291bnRlcikKICAgICAgICAgIF9fY291bnRl
ci0+bWVyZ2UoKihfX2NvdW50ZXIgLSAxKSk7CiAgICAgICAgc3dhcCggKihfX2ZpbGwgLSAxKSAp
OwogICAgICB9CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9j
PgogICAgdGVtcGxhdGUgPHR5cGVuYW1lIF9QcmVkaWNhdGU+CiAgICAgIHZvaWQKICAgICAgbGlz
dDxfVHAsIF9BbGxvYz46OgogICAgICByZW1vdmVfaWYoX1ByZWRpY2F0ZSBfX3ByZWQpCiAgICAg
IHsKICAgICAgICBpdGVyYXRvciBfX2ZpcnN0ID0gYmVnaW4oKTsKICAgICAgICBpdGVyYXRvciBf
X2xhc3QgPSBlbmQoKTsKICAgICAgICB3aGlsZSAoX19maXJzdCAhPSBfX2xhc3QpCiAgIHsKICAg
ICBpdGVyYXRvciBfX25leHQgPSBfX2ZpcnN0OwogICAgICsrX19uZXh0OwogICAgIGlmIChfX3By
ZWQoKl9fZmlyc3QpKQogICAgICAgX01fZXJhc2UoX19maXJzdCk7CiAgICAgX19maXJzdCA9IF9f
bmV4dDsKICAgfQogICAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0Fs
bG9jPgogICAgdGVtcGxhdGUgPHR5cGVuYW1lIF9CaW5hcnlQcmVkaWNhdGU+CiAgICAgIHZvaWQK
ICAgICAgbGlzdDxfVHAsIF9BbGxvYz46OgogICAgICB1bmlxdWUoX0JpbmFyeVByZWRpY2F0ZSBf
X2JpbmFyeV9wcmVkKQogICAgICB7CiAgICAgICAgaXRlcmF0b3IgX19maXJzdCA9IGJlZ2luKCk7
CiAgICAgICAgaXRlcmF0b3IgX19sYXN0ID0gZW5kKCk7CiAgICAgICAgaWYgKF9fZmlyc3QgPT0g
X19sYXN0KQogICByZXR1cm47CiAgICAgICAgaXRlcmF0b3IgX19uZXh0ID0gX19maXJzdDsKICAg
ICAgICB3aGlsZSAoKytfX25leHQgIT0gX19sYXN0KQogICB7CiAgICAgaWYgKF9fYmluYXJ5X3By
ZWQoKl9fZmlyc3QsICpfX25leHQpKQogICAgICAgX01fZXJhc2UoX19uZXh0KTsKICAgICBlbHNl
CiAgICAgICBfX2ZpcnN0ID0gX19uZXh0OwogICAgIF9fbmV4dCA9IF9fZmlyc3Q7CiAgIH0KICAg
ICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHRlbXBs
YXRlIDx0eXBlbmFtZSBfU3RyaWN0V2Vha09yZGVyaW5nPgogICAgICB2b2lkCiAgICAgIGxpc3Q8
X1RwLCBfQWxsb2M+OjoKICAgICAgc29ydChfU3RyaWN0V2Vha09yZGVyaW5nIF9fY29tcCkKICAg
ICAgewoKIGlmICh0aGlzLT5fTV9pbXBsLl9NX25vZGUuX01fbmV4dCAhPSAmdGhpcy0+X01faW1w
bC5fTV9ub2RlCiAgICAgJiYgdGhpcy0+X01faW1wbC5fTV9ub2RlLl9NX25leHQtPl9NX25leHQg
IT0gJnRoaXMtPl9NX2ltcGwuX01fbm9kZSkKICAgewogICAgIGxpc3QgX19jYXJyeTsKICAgICBs
aXN0IF9fdG1wWzY0XTsKICAgICBsaXN0ICogX19maWxsID0gX190bXA7CiAgICAgbGlzdCAqIF9f
Y291bnRlcjsKCiAgICAgZG8KICAgICAgIHsKICBfX2NhcnJ5LnNwbGljZShfX2NhcnJ5LmJlZ2lu
KCksICp0aGlzLCBiZWdpbigpKTsKCiAgZm9yKF9fY291bnRlciA9IF9fdG1wOwogICAgICBfX2Nv
dW50ZXIgIT0gX19maWxsICYmICFfX2NvdW50ZXItPmVtcHR5KCk7CiAgICAgICsrX19jb3VudGVy
KQogICAgewogICAgICBfX2NvdW50ZXItPm1lcmdlKF9fY2FycnksIF9fY29tcCk7CiAgICAgIF9f
Y2Fycnkuc3dhcCgqX19jb3VudGVyKTsKICAgIH0KICBfX2NhcnJ5LnN3YXAoKl9fY291bnRlcik7
CiAgaWYgKF9fY291bnRlciA9PSBfX2ZpbGwpCiAgICArK19fZmlsbDsKICAgICAgIH0KICAgICB3
aGlsZSAoICFlbXB0eSgpICk7CgogICAgIGZvciAoX19jb3VudGVyID0gX190bXAgKyAxOyBfX2Nv
dW50ZXIgIT0gX19maWxsOyArK19fY291bnRlcikKICAgICAgIF9fY291bnRlci0+bWVyZ2UoKihf
X2NvdW50ZXIgLSAxKSwgX19jb21wKTsKICAgICBzd2FwKCooX19maWxsIC0gMSkpOwogICB9CiAg
ICAgIH0KCgp9CiMgNjUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvbGlzdCIgMiAzCiMgMjcgIi9o
b21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9n
LmNjIiAyCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9hbGdvcml0aG0iIDEgMwojIDU4ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2FsZ29yaXRobSIgMwogICAgICAgCiMgNTkgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYWxnb3JpdGhtIiAzCgojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
dXRpbGl0eSIgMSAzCiMgNTggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdXRpbGl0eSIgMwogICAg
ICAgCiMgNTkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdXRpbGl0eSIgMwojIDY5ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL3V0aWxpdHkiIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX3JlbG9wcy5oIiAxIDMKIyA2NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0
bF9yZWxvcHMuaCIgMwpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlf
XyAoImRlZmF1bHQiKSkpCnsKICBuYW1lc3BhY2UgcmVsX29wcwogIHsKIAojIDg1ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3JlbG9wcy5oIiAzCiAgICB0ZW1wbGF0ZSA8Y2xhc3Mg
X1RwPgogICAgICBpbmxpbmUgYm9vbAogICAgICBvcGVyYXRvciE9KGNvbnN0IF9UcCYgX194LCBj
b25zdCBfVHAmIF9feSkKICAgICAgeyByZXR1cm4gIShfX3ggPT0gX195KTsgfQojIDk4ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3JlbG9wcy5oIiAzCiAgICB0ZW1wbGF0ZSA8Y2xh
c3MgX1RwPgogICAgICBpbmxpbmUgYm9vbAogICAgICBvcGVyYXRvcj4oY29uc3QgX1RwJiBfX3gs
IGNvbnN0IF9UcCYgX195KQogICAgICB7IHJldHVybiBfX3kgPCBfX3g7IH0KIyAxMTEgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfcmVsb3BzLmgiIDMKICAgIHRlbXBsYXRlIDxjbGFz
cyBfVHA+CiAgICAgIGlubGluZSBib29sCiAgICAgIG9wZXJhdG9yPD0oY29uc3QgX1RwJiBfX3gs
IGNvbnN0IF9UcCYgX195KQogICAgICB7IHJldHVybiAhKF9feSA8IF9feCk7IH0KIyAxMjQgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfcmVsb3BzLmgiIDMKICAgIHRlbXBsYXRlIDxj
bGFzcyBfVHA+CiAgICAgIGlubGluZSBib29sCiAgICAgIG9wZXJhdG9yPj0oY29uc3QgX1RwJiBf
X3gsIGNvbnN0IF9UcCYgX195KQogICAgICB7IHJldHVybiAhKF9feCA8IF9feSk7IH0KCiAKICB9
Cgp9CiMgNzAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdXRpbGl0eSIgMiAzCiMgNzggIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvdXRpbGl0eSIgMwpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18g
KChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHA+CiAgICBzdHJ1Y3QgdHVwbGVfc2l6ZTsKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAg
ICBzdHJ1Y3QgdHVwbGVfc2l6ZTxjb25zdCBfVHA+CiAgICA6IGludGVncmFsX2NvbnN0YW50PHNp
emVfdCwgdHVwbGVfc2l6ZTxfVHA+Ojp2YWx1ZT4geyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHA+CiAgICBzdHJ1Y3QgdHVwbGVfc2l6ZTx2b2xhdGlsZSBfVHA+CiAgICA6IGludGVncmFsX2Nv
bnN0YW50PHNpemVfdCwgdHVwbGVfc2l6ZTxfVHA+Ojp2YWx1ZT4geyB9OwoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgdHVwbGVfc2l6ZTxjb25zdCB2b2xhdGlsZSBfVHA+CiAg
ICA6IGludGVncmFsX2NvbnN0YW50PHNpemVfdCwgdHVwbGVfc2l6ZTxfVHA+Ojp2YWx1ZT4geyB9
OwoKCiAgdGVtcGxhdGU8c3RkOjpzaXplX3QgX19pLCB0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3Qg
dHVwbGVfZWxlbWVudDsKCgogIHRlbXBsYXRlPHN0ZDo6c2l6ZV90IF9faSwgdHlwZW5hbWUgX1Rw
PgogICAgdXNpbmcgX190dXBsZV9lbGVtZW50X3QgPSB0eXBlbmFtZSB0dXBsZV9lbGVtZW50PF9f
aSwgX1RwPjo6dHlwZTsKCiAgdGVtcGxhdGU8c3RkOjpzaXplX3QgX19pLCB0eXBlbmFtZSBfVHA+
CiAgICBzdHJ1Y3QgdHVwbGVfZWxlbWVudDxfX2ksIGNvbnN0IF9UcD4KICAgIHsKICAgICAgdHlw
ZWRlZiB0eXBlbmFtZSBhZGRfY29uc3Q8X190dXBsZV9lbGVtZW50X3Q8X19pLCBfVHA+Pjo6dHlw
ZSB0eXBlOwogICAgfTsKCiAgdGVtcGxhdGU8c3RkOjpzaXplX3QgX19pLCB0eXBlbmFtZSBfVHA+
CiAgICBzdHJ1Y3QgdHVwbGVfZWxlbWVudDxfX2ksIHZvbGF0aWxlIF9UcD4KICAgIHsKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBhZGRfdm9sYXRpbGU8X190dXBsZV9lbGVtZW50X3Q8X19pLCBfVHA+
Pjo6dHlwZSB0eXBlOwogICAgfTsKCiAgdGVtcGxhdGU8c3RkOjpzaXplX3QgX19pLCB0eXBlbmFt
ZSBfVHA+CiAgICBzdHJ1Y3QgdHVwbGVfZWxlbWVudDxfX2ksIGNvbnN0IHZvbGF0aWxlIF9UcD4K
ICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBhZGRfY3Y8X190dXBsZV9lbGVtZW50X3Q8X19p
LCBfVHA+Pjo6dHlwZSB0eXBlOwogICAgfTsKIyAxMzMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
dXRpbGl0eSIgMwogIHRlbXBsYXRlPHR5cGVuYW1lPgogICAgc3RydWN0IF9faXNfdHVwbGVfbGlr
ZV9pbXBsIDogZmFsc2VfdHlwZQogICAgeyB9OwoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVDEs
IHR5cGVuYW1lIF9UMj4KICAgIHN0cnVjdCBfX2lzX3R1cGxlX2xpa2VfaW1wbDxzdGQ6OnBhaXI8
X1QxLCBfVDI+PiA6IHRydWVfdHlwZQogICAgeyB9OwoKCiAgdGVtcGxhdGU8Y2xhc3MgX1RwMSwg
Y2xhc3MgX1RwMj4KICAgIHN0cnVjdCB0dXBsZV9zaXplPHN0ZDo6cGFpcjxfVHAxLCBfVHAyPj4K
ICAgIDogcHVibGljIGludGVncmFsX2NvbnN0YW50PHN0ZDo6c2l6ZV90LCAyPiB7IH07CgoKICB0
ZW1wbGF0ZTxjbGFzcyBfVHAxLCBjbGFzcyBfVHAyPgogICAgc3RydWN0IHR1cGxlX2VsZW1lbnQ8
MCwgc3RkOjpwYWlyPF9UcDEsIF9UcDI+PgogICAgeyB0eXBlZGVmIF9UcDEgdHlwZTsgfTsKCgog
IHRlbXBsYXRlPGNsYXNzIF9UcDEsIGNsYXNzIF9UcDI+CiAgICBzdHJ1Y3QgdHVwbGVfZWxlbWVu
dDwxLCBzdGQ6OnBhaXI8X1RwMSwgX1RwMj4+CiAgICB7IHR5cGVkZWYgX1RwMiB0eXBlOyB9OwoK
ICB0ZW1wbGF0ZTxzdGQ6OnNpemVfdCBfSW50PgogICAgc3RydWN0IF9fcGFpcl9nZXQ7CgogIHRl
bXBsYXRlPD4KICAgIHN0cnVjdCBfX3BhaXJfZ2V0PDA+CiAgICB7CiAgICAgIHRlbXBsYXRlPHR5
cGVuYW1lIF9UcDEsIHR5cGVuYW1lIF9UcDI+CiAgICAgICAgc3RhdGljIGNvbnN0ZXhwciBfVHAx
JgogICAgICAgIF9fZ2V0KHN0ZDo6cGFpcjxfVHAxLCBfVHAyPiYgX19wYWlyKSBub2V4Y2VwdAog
ICAgICAgIHsgcmV0dXJuIF9fcGFpci5maXJzdDsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwMSwgdHlwZW5hbWUgX1RwMj4KICAgICAgICBzdGF0aWMgY29uc3RleHByIF9UcDEmJgogICAg
ICAgIF9fbW92ZV9nZXQoc3RkOjpwYWlyPF9UcDEsIF9UcDI+JiYgX19wYWlyKSBub2V4Y2VwdAog
ICAgICAgIHsgcmV0dXJuIHN0ZDo6Zm9yd2FyZDxfVHAxPihfX3BhaXIuZmlyc3QpOyB9CgogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCB0eXBlbmFtZSBfVHAyPgogICAgICAgIHN0YXRpYyBj
b25zdGV4cHIgY29uc3QgX1RwMSYKICAgICAgICBfX2NvbnN0X2dldChjb25zdCBzdGQ6OnBhaXI8
X1RwMSwgX1RwMj4mIF9fcGFpcikgbm9leGNlcHQKICAgICAgICB7IHJldHVybiBfX3BhaXIuZmly
c3Q7IH0KICAgIH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX3BhaXJfZ2V0PDE+CiAgICB7
CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lIF9UcDI+CiAgICAgICAgc3Rh
dGljIGNvbnN0ZXhwciBfVHAyJgogICAgICAgIF9fZ2V0KHN0ZDo6cGFpcjxfVHAxLCBfVHAyPiYg
X19wYWlyKSBub2V4Y2VwdAogICAgICAgIHsgcmV0dXJuIF9fcGFpci5zZWNvbmQ7IH0KCiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lIF9UcDI+CiAgICAgICAgc3RhdGljIGNv
bnN0ZXhwciBfVHAyJiYKICAgICAgICBfX21vdmVfZ2V0KHN0ZDo6cGFpcjxfVHAxLCBfVHAyPiYm
IF9fcGFpcikgbm9leGNlcHQKICAgICAgICB7IHJldHVybiBzdGQ6OmZvcndhcmQ8X1RwMj4oX19w
YWlyLnNlY29uZCk7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lIF9U
cDI+CiAgICAgICAgc3RhdGljIGNvbnN0ZXhwciBjb25zdCBfVHAyJgogICAgICAgIF9fY29uc3Rf
Z2V0KGNvbnN0IHN0ZDo6cGFpcjxfVHAxLCBfVHAyPiYgX19wYWlyKSBub2V4Y2VwdAogICAgICAg
IHsgcmV0dXJuIF9fcGFpci5zZWNvbmQ7IH0KICAgIH07CgogIHRlbXBsYXRlPHN0ZDo6c2l6ZV90
IF9JbnQsIGNsYXNzIF9UcDEsIGNsYXNzIF9UcDI+CiAgICBjb25zdGV4cHIgdHlwZW5hbWUgdHVw
bGVfZWxlbWVudDxfSW50LCBzdGQ6OnBhaXI8X1RwMSwgX1RwMj4+Ojp0eXBlJgogICAgZ2V0KHN0
ZDo6cGFpcjxfVHAxLCBfVHAyPiYgX19pbikgbm9leGNlcHQKICAgIHsgcmV0dXJuIF9fcGFpcl9n
ZXQ8X0ludD46Ol9fZ2V0KF9faW4pOyB9CgogIHRlbXBsYXRlPHN0ZDo6c2l6ZV90IF9JbnQsIGNs
YXNzIF9UcDEsIGNsYXNzIF9UcDI+CiAgICBjb25zdGV4cHIgdHlwZW5hbWUgdHVwbGVfZWxlbWVu
dDxfSW50LCBzdGQ6OnBhaXI8X1RwMSwgX1RwMj4+Ojp0eXBlJiYKICAgIGdldChzdGQ6OnBhaXI8
X1RwMSwgX1RwMj4mJiBfX2luKSBub2V4Y2VwdAogICAgeyByZXR1cm4gX19wYWlyX2dldDxfSW50
Pjo6X19tb3ZlX2dldChzdGQ6Om1vdmUoX19pbikpOyB9CgogIHRlbXBsYXRlPHN0ZDo6c2l6ZV90
IF9JbnQsIGNsYXNzIF9UcDEsIGNsYXNzIF9UcDI+CiAgICBjb25zdGV4cHIgY29uc3QgdHlwZW5h
bWUgdHVwbGVfZWxlbWVudDxfSW50LCBzdGQ6OnBhaXI8X1RwMSwgX1RwMj4+Ojp0eXBlJgogICAg
Z2V0KGNvbnN0IHN0ZDo6cGFpcjxfVHAxLCBfVHAyPiYgX19pbikgbm9leGNlcHQKICAgIHsgcmV0
dXJuIF9fcGFpcl9nZXQ8X0ludD46Ol9fY29uc3RfZ2V0KF9faW4pOyB9CiMgMjYwICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL3V0aWxpdHkiIDMKICB0ZW1wbGF0ZTxzaXplX3QuLi4gX0luZGV4ZXM+
IHN0cnVjdCBfSW5kZXhfdHVwbGUgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0dXAxLCB0
eXBlbmFtZSBfSXR1cDI+IHN0cnVjdCBfSXR1cF9jYXQ7CgogIHRlbXBsYXRlPHNpemVfdC4uLiBf
SW5kMSwgc2l6ZV90Li4uIF9JbmQyPgogICAgc3RydWN0IF9JdHVwX2NhdDxfSW5kZXhfdHVwbGU8
X0luZDEuLi4+LCBfSW5kZXhfdHVwbGU8X0luZDIuLi4+PgogICAgewogICAgICB1c2luZyBfX3R5
cGUgPSBfSW5kZXhfdHVwbGU8X0luZDEuLi4sIChfSW5kMiArIHNpemVvZi4uLihfSW5kMSkpLi4u
PjsKICAgIH07CgoKICB0ZW1wbGF0ZTxzaXplX3QgX051bT4KICAgIHN0cnVjdCBfQnVpbGRfaW5k
ZXhfdHVwbGUKICAgIDogX0l0dXBfY2F0PHR5cGVuYW1lIF9CdWlsZF9pbmRleF90dXBsZTxfTnVt
IC8gMj46Ol9fdHlwZSwKICB0eXBlbmFtZSBfQnVpbGRfaW5kZXhfdHVwbGU8X051bSAtIF9OdW0g
LyAyPjo6X190eXBlPgogICAgeyB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX0J1aWxkX2lu
ZGV4X3R1cGxlPDE+CiAgICB7CiAgICAgIHR5cGVkZWYgX0luZGV4X3R1cGxlPDA+IF9fdHlwZTsK
ICAgIH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfQnVpbGRfaW5kZXhfdHVwbGU8MD4KICAg
IHsKICAgICAgdHlwZWRlZiBfSW5kZXhfdHVwbGU8PiBfX3R5cGU7CiAgICB9OwojIDMzMyAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC91dGlsaXR5IiAzCgp9CiMgNjEgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYWxnb3JpdGhtIiAyIDMKCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0
bF9hbGdvLmgiIDEgMwojIDU5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28u
aCIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3N0ZGxpYiIgMSAzCiMgMzkgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvY3N0ZGxpYiIgMwogICAgICAgCiMgNDAgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvY3N0ZGxpYiIgMwojIDc1ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2NzdGRsaWIi
IDMKIyAxICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDEgMyA0CiMgMzIgIi91c3IvaW5jbHVkZS9z
dGRsaWIuaCIgMyA0CiMgMSAiL3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51eC82LjAuMC9p
bmNsdWRlL3N0ZGRlZi5oIiAxIDMgNAojIDIxNiAiL3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1s
aW51eC82LjAuMC9pbmNsdWRlL3N0ZGRlZi5oIiAzIDQKdHlwZWRlZiBsb25nIHVuc2lnbmVkIGlu
dCBzaXplX3Q7CiMgMzMgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMiAzIDQKCmV4dGVybiAiQyIg
ewoKCgoKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3dhaXRmbGFncy5oIiAxIDMgNAojIDQyICIv
dXNyL2luY2x1ZGUvc3RkbGliLmgiIDIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvd2FpdHN0
YXR1cy5oIiAxIDMgNAojIDY0ICIvdXNyL2luY2x1ZGUvYml0cy93YWl0c3RhdHVzLmgiIDMgNAoj
IDEgIi91c3IvaW5jbHVkZS9lbmRpYW4uaCIgMSAzIDQKIyAzNiAiL3Vzci9pbmNsdWRlL2VuZGlh
bi5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9lbmRpYW4uaCIgMSAzIDQKIyAzNyAiL3Vz
ci9pbmNsdWRlL2VuZGlhbi5oIiAyIDMgNAojIDYwICIvdXNyL2luY2x1ZGUvZW5kaWFuLmgiIDMg
NAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2FwLmgiIDEgMyA0CiMgMjQgIi91c3IvaW5j
bHVkZS9iaXRzL2J5dGVzd2FwLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3dvcmRzaXpl
LmgiIDEgMyA0CiMgMjUgIi91c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2FwLmgiIDIgMyA0CiMgMzMg
Ii91c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2FwLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRz
L2J5dGVzd2FwLTE2LmgiIDEgMyA0CiMgMjQgIi91c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2FwLTE2
LmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3dvcmRzaXplLmgiIDEgMyA0CiMgMjUgIi91
c3IvaW5jbHVkZS9iaXRzL2J5dGVzd2FwLTE2LmgiIDIgMyA0CiMgMzQgIi91c3IvaW5jbHVkZS9i
aXRzL2J5dGVzd2FwLmgiIDIgMyA0CiMgNjEgIi91c3IvaW5jbHVkZS9lbmRpYW4uaCIgMiAzIDQK
IyA2NSAiL3Vzci9pbmNsdWRlL2JpdHMvd2FpdHN0YXR1cy5oIiAyIDMgNAoKdW5pb24gd2FpdAog
IHsKICAgIGludCB3X3N0YXR1czsKICAgIHN0cnVjdAogICAgICB7CgoKCgoKCgogdW5zaWduZWQg
aW50OjE2OwogdW5zaWduZWQgaW50IF9fd19yZXRjb2RlOjg7CiB1bnNpZ25lZCBpbnQgX193X2Nv
cmVkdW1wOjE7CiB1bnNpZ25lZCBpbnQgX193X3Rlcm1zaWc6NzsKCiAgICAgIH0gX193YWl0X3Rl
cm1pbmF0ZWQ7CiAgICBzdHJ1Y3QKICAgICAgewoKCgoKCgogdW5zaWduZWQgaW50OjE2OwogdW5z
aWduZWQgaW50IF9fd19zdG9wc2lnOjg7CiB1bnNpZ25lZCBpbnQgX193X3N0b3B2YWw6ODsKCiAg
ICAgIH0gX193YWl0X3N0b3BwZWQ7CiAgfTsKIyA0MyAiL3Vzci9pbmNsdWRlL3N0ZGxpYi5oIiAy
IDMgNAojIDk1ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDMgNAoKCnR5cGVkZWYgc3RydWN0CiAg
ewogICAgaW50IHF1b3Q7CiAgICBpbnQgcmVtOwogIH0gZGl2X3Q7CgoKCnR5cGVkZWYgc3RydWN0
CiAgewogICAgbG9uZyBpbnQgcXVvdDsKICAgIGxvbmcgaW50IHJlbTsKICB9IGxkaXZfdDsKCgoK
CgoKCl9fZXh0ZW5zaW9uX18gdHlwZWRlZiBzdHJ1Y3QKICB7CiAgICBsb25nIGxvbmcgaW50IHF1
b3Q7CiAgICBsb25nIGxvbmcgaW50IHJlbTsKICB9IGxsZGl2X3Q7CgoKIyAxMzkgIi91c3IvaW5j
bHVkZS9zdGRsaWIuaCIgMyA0CmV4dGVybiBzaXplX3QgX19jdHlwZV9nZXRfbWJfY3VyX21heCAo
dm9pZCkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsK
CgoKCmV4dGVybiBkb3VibGUgYXRvZiAoY29uc3QgY2hhciAqX19ucHRyKQogICAgIHRocm93ICgp
IF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo
MSkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKZXh0ZXJuIGlu
dCBhdG9pIChjb25zdCBjaGFyICpfX25wdHIpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAo
KF9fcHVyZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRl
X18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgpleHRlcm4gbG9uZyBpbnQgYXRvbCAoY29u
c3QgY2hhciAqX19ucHRyKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykp
IF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJu
X3VudXNlZF9yZXN1bHRfXykpOwoKCgoKCl9fZXh0ZW5zaW9uX18gZXh0ZXJuIGxvbmcgbG9uZyBp
bnQgYXRvbGwgKGNvbnN0IGNoYXIgKl9fbnB0cikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9f
ICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1
dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCgpleHRlcm4gZG91YmxlIHN0cnRv
ZCAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX25wdHIsCiAgICAgICAgY2hhciAqKl9fcmVzdHJp
Y3QgX19lbmRwdHIpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx
KSkpOwoKCgoKCmV4dGVybiBmbG9hdCBzdHJ0b2YgKGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19u
cHRyLAogICAgICAgY2hhciAqKl9fcmVzdHJpY3QgX19lbmRwdHIpIHRocm93ICgpIF9fYXR0cmli
dXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCmV4dGVybiBsb25nIGRvdWJsZSBzdHJ0b2xkIChj
b25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fbnB0ciwKICAgICAgIGNoYXIgKipfX3Jlc3RyaWN0IF9f
ZW5kcHRyKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsK
CgoKCgpleHRlcm4gbG9uZyBpbnQgc3RydG9sIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fbnB0
ciwKICAgY2hhciAqKl9fcmVzdHJpY3QgX19lbmRwdHIsIGludCBfX2Jhc2UpCiAgICAgdGhyb3cg
KCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKZXh0ZXJuIHVuc2lnbmVkIGxv
bmcgaW50IHN0cnRvdWwgKGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19ucHRyLAogICAgICBjaGFy
ICoqX19yZXN0cmljdCBfX2VuZHB0ciwgaW50IF9fYmFzZSkKICAgICB0aHJvdyAoKSBfX2F0dHJp
YnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgpfX2V4dGVuc2lvbl9fCmV4dGVybiBsb25n
IGxvbmcgaW50IHN0cnRvcSAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX25wdHIsCiAgICAgICAg
Y2hhciAqKl9fcmVzdHJpY3QgX19lbmRwdHIsIGludCBfX2Jhc2UpCiAgICAgdGhyb3cgKCkgX19h
dHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKX19leHRlbnNpb25fXwpleHRlcm4gdW5z
aWduZWQgbG9uZyBsb25nIGludCBzdHJ0b3VxIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fbnB0
ciwKICAgICAgICAgICBjaGFyICoqX19yZXN0cmljdCBfX2VuZHB0ciwgaW50IF9fYmFzZSkKICAg
ICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoKX19leHRl
bnNpb25fXwpleHRlcm4gbG9uZyBsb25nIGludCBzdHJ0b2xsIChjb25zdCBjaGFyICpfX3Jlc3Ry
aWN0IF9fbnB0ciwKICAgICAgICAgY2hhciAqKl9fcmVzdHJpY3QgX19lbmRwdHIsIGludCBfX2Jh
c2UpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKX19l
eHRlbnNpb25fXwpleHRlcm4gdW5zaWduZWQgbG9uZyBsb25nIGludCBzdHJ0b3VsbCAoY29uc3Qg
Y2hhciAqX19yZXN0cmljdCBfX25wdHIsCiAgICAgY2hhciAqKl9fcmVzdHJpY3QgX19lbmRwdHIs
IGludCBfX2Jhc2UpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx
KSkpOwoKIyAyMzUgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRl
L3hsb2NhbGUuaCIgMSAzIDQKIyAyNyAiL3Vzci9pbmNsdWRlL3hsb2NhbGUuaCIgMyA0CnR5cGVk
ZWYgc3RydWN0IF9fbG9jYWxlX3N0cnVjdAp7CgogIHN0cnVjdCBfX2xvY2FsZV9kYXRhICpfX2xv
Y2FsZXNbMTNdOwoKCiAgY29uc3QgdW5zaWduZWQgc2hvcnQgaW50ICpfX2N0eXBlX2I7CiAgY29u
c3QgaW50ICpfX2N0eXBlX3RvbG93ZXI7CiAgY29uc3QgaW50ICpfX2N0eXBlX3RvdXBwZXI7CgoK
ICBjb25zdCBjaGFyICpfX25hbWVzWzEzXTsKfSAqX19sb2NhbGVfdDsKCgp0eXBlZGVmIF9fbG9j
YWxlX3QgbG9jYWxlX3Q7CiMgMjM2ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDIgMyA0CgoKCmV4
dGVybiBsb25nIGludCBzdHJ0b2xfbCAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX25wdHIsCiAg
ICAgY2hhciAqKl9fcmVzdHJpY3QgX19lbmRwdHIsIGludCBfX2Jhc2UsCiAgICAgX19sb2NhbGVf
dCBfX2xvYykgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCA0KSkpOwoK
ZXh0ZXJuIHVuc2lnbmVkIGxvbmcgaW50IHN0cnRvdWxfbCAoY29uc3QgY2hhciAqX19yZXN0cmlj
dCBfX25wdHIsCiAgICAgICAgY2hhciAqKl9fcmVzdHJpY3QgX19lbmRwdHIsCiAgICAgICAgaW50
IF9fYmFzZSwgX19sb2NhbGVfdCBfX2xvYykKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgo
X19ub25udWxsX18gKDEsIDQpKSk7CgpfX2V4dGVuc2lvbl9fCmV4dGVybiBsb25nIGxvbmcgaW50
IHN0cnRvbGxfbCAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX25wdHIsCiAgICBjaGFyICoqX19y
ZXN0cmljdCBfX2VuZHB0ciwgaW50IF9fYmFzZSwKICAgIF9fbG9jYWxlX3QgX19sb2MpCiAgICAg
dGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCA0KSkpOwoKX19leHRlbnNp
b25fXwpleHRlcm4gdW5zaWduZWQgbG9uZyBsb25nIGludCBzdHJ0b3VsbF9sIChjb25zdCBjaGFy
ICpfX3Jlc3RyaWN0IF9fbnB0ciwKICAgICAgIGNoYXIgKipfX3Jlc3RyaWN0IF9fZW5kcHRyLAog
ICAgICAgaW50IF9fYmFzZSwgX19sb2NhbGVfdCBfX2xvYykKICAgICB0aHJvdyAoKSBfX2F0dHJp
YnV0ZV9fICgoX19ub25udWxsX18gKDEsIDQpKSk7CgpleHRlcm4gZG91YmxlIHN0cnRvZF9sIChj
b25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fbnB0ciwKICAgY2hhciAqKl9fcmVzdHJpY3QgX19lbmRw
dHIsIF9fbG9jYWxlX3QgX19sb2MpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgxLCAzKSkpOwoKZXh0ZXJuIGZsb2F0IHN0cnRvZl9sIChjb25zdCBjaGFyICpfX3Jl
c3RyaWN0IF9fbnB0ciwKICAgICAgICAgY2hhciAqKl9fcmVzdHJpY3QgX19lbmRwdHIsIF9fbG9j
YWxlX3QgX19sb2MpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx
LCAzKSkpOwoKZXh0ZXJuIGxvbmcgZG91YmxlIHN0cnRvbGRfbCAoY29uc3QgY2hhciAqX19yZXN0
cmljdCBfX25wdHIsCiAgICAgICAgIGNoYXIgKipfX3Jlc3RyaWN0IF9fZW5kcHRyLAogICAgICAg
ICBfX2xvY2FsZV90IF9fbG9jKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51
bGxfXyAoMSwgMykpKTsKCgoKCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251
X2lubGluZV9fKSkgaW50Cl9fYXR0cmlidXRlX18gKChfX2xlYWZfXykpIGF0b2kgKGNvbnN0IGNo
YXIgKl9fbnB0cikgdGhyb3cgKCkKewogIHJldHVybiAoaW50KSBzdHJ0b2wgKF9fbnB0ciwgKGNo
YXIgKiopIF9fbnVsbCwgMTApOwp9CmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19n
bnVfaW5saW5lX18pKSBsb25nIGludApfX2F0dHJpYnV0ZV9fICgoX19sZWFmX18pKSBhdG9sIChj
b25zdCBjaGFyICpfX25wdHIpIHRocm93ICgpCnsKICByZXR1cm4gc3RydG9sIChfX25wdHIsIChj
aGFyICoqKSBfX251bGwsIDEwKTsKfQoKCgoKX19leHRlbnNpb25fXyBleHRlcm4gX19pbmxpbmUg
X19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgbG9uZyBsb25nIGludApfX2F0dHJpYnV0
ZV9fICgoX19sZWFmX18pKSBhdG9sbCAoY29uc3QgY2hhciAqX19ucHRyKSB0aHJvdyAoKQp7CiAg
cmV0dXJuIHN0cnRvbGwgKF9fbnB0ciwgKGNoYXIgKiopIF9fbnVsbCwgMTApOwp9CgojIDMwNSAi
L3Vzci9pbmNsdWRlL3N0ZGxpYi5oIiAzIDQKZXh0ZXJuIGNoYXIgKmw2NGEgKGxvbmcgaW50IF9f
bikgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgpl
eHRlcm4gbG9uZyBpbnQgYTY0bCAoY29uc3QgY2hhciAqX19zKQogICAgIHRocm93ICgpIF9fYXR0
cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBf
X2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKIyAxICIvdXNyL2lu
Y2x1ZGUvc3lzL3R5cGVzLmgiIDEgMyA0CiMgMjcgIi91c3IvaW5jbHVkZS9zeXMvdHlwZXMuaCIg
MyA0CmV4dGVybiAiQyIgewoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy90eXBlcy5oIiAxIDMgNAoj
IDI3ICIvdXNyL2luY2x1ZGUvYml0cy90eXBlcy5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0
cy93b3Jkc2l6ZS5oIiAxIDMgNAojIDI4ICIvdXNyL2luY2x1ZGUvYml0cy90eXBlcy5oIiAyIDMg
NAoKCnR5cGVkZWYgdW5zaWduZWQgY2hhciBfX3VfY2hhcjsKdHlwZWRlZiB1bnNpZ25lZCBzaG9y
dCBpbnQgX191X3Nob3J0Owp0eXBlZGVmIHVuc2lnbmVkIGludCBfX3VfaW50Owp0eXBlZGVmIHVu
c2lnbmVkIGxvbmcgaW50IF9fdV9sb25nOwoKCnR5cGVkZWYgc2lnbmVkIGNoYXIgX19pbnQ4X3Q7
CnR5cGVkZWYgdW5zaWduZWQgY2hhciBfX3VpbnQ4X3Q7CnR5cGVkZWYgc2lnbmVkIHNob3J0IGlu
dCBfX2ludDE2X3Q7CnR5cGVkZWYgdW5zaWduZWQgc2hvcnQgaW50IF9fdWludDE2X3Q7CnR5cGVk
ZWYgc2lnbmVkIGludCBfX2ludDMyX3Q7CnR5cGVkZWYgdW5zaWduZWQgaW50IF9fdWludDMyX3Q7
Cgp0eXBlZGVmIHNpZ25lZCBsb25nIGludCBfX2ludDY0X3Q7CnR5cGVkZWYgdW5zaWduZWQgbG9u
ZyBpbnQgX191aW50NjRfdDsKCgoKCgoKCnR5cGVkZWYgbG9uZyBpbnQgX19xdWFkX3Q7CnR5cGVk
ZWYgdW5zaWduZWQgbG9uZyBpbnQgX191X3F1YWRfdDsKIyAxMjEgIi91c3IvaW5jbHVkZS9iaXRz
L3R5cGVzLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3R5cGVzaXplcy5oIiAxIDMgNAoj
IDEyMiAiL3Vzci9pbmNsdWRlL2JpdHMvdHlwZXMuaCIgMiAzIDQKCgp0eXBlZGVmIHVuc2lnbmVk
IGxvbmcgaW50IF9fZGV2X3Q7CnR5cGVkZWYgdW5zaWduZWQgaW50IF9fdWlkX3Q7CnR5cGVkZWYg
dW5zaWduZWQgaW50IF9fZ2lkX3Q7CnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQgX19pbm9fdDsK
dHlwZWRlZiB1bnNpZ25lZCBsb25nIGludCBfX2lubzY0X3Q7CnR5cGVkZWYgdW5zaWduZWQgaW50
IF9fbW9kZV90Owp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fbmxpbmtfdDsKdHlwZWRlZiBs
b25nIGludCBfX29mZl90Owp0eXBlZGVmIGxvbmcgaW50IF9fb2ZmNjRfdDsKdHlwZWRlZiBpbnQg
X19waWRfdDsKdHlwZWRlZiBzdHJ1Y3QgeyBpbnQgX192YWxbMl07IH0gX19mc2lkX3Q7CnR5cGVk
ZWYgbG9uZyBpbnQgX19jbG9ja190Owp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fcmxpbV90
Owp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fcmxpbTY0X3Q7CnR5cGVkZWYgdW5zaWduZWQg
aW50IF9faWRfdDsKdHlwZWRlZiBsb25nIGludCBfX3RpbWVfdDsKdHlwZWRlZiB1bnNpZ25lZCBp
bnQgX191c2Vjb25kc190Owp0eXBlZGVmIGxvbmcgaW50IF9fc3VzZWNvbmRzX3Q7Cgp0eXBlZGVm
IGludCBfX2RhZGRyX3Q7CnR5cGVkZWYgaW50IF9fa2V5X3Q7CgoKdHlwZWRlZiBpbnQgX19jbG9j
a2lkX3Q7CgoKdHlwZWRlZiB2b2lkICogX190aW1lcl90OwoKCnR5cGVkZWYgbG9uZyBpbnQgX19i
bGtzaXplX3Q7CgoKCgp0eXBlZGVmIGxvbmcgaW50IF9fYmxrY250X3Q7CnR5cGVkZWYgbG9uZyBp
bnQgX19ibGtjbnQ2NF90OwoKCnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQgX19mc2Jsa2NudF90
Owp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fZnNibGtjbnQ2NF90OwoKCnR5cGVkZWYgdW5z
aWduZWQgbG9uZyBpbnQgX19mc2ZpbGNudF90Owp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9f
ZnNmaWxjbnQ2NF90OwoKCnR5cGVkZWYgbG9uZyBpbnQgX19mc3dvcmRfdDsKCnR5cGVkZWYgbG9u
ZyBpbnQgX19zc2l6ZV90OwoKCnR5cGVkZWYgbG9uZyBpbnQgX19zeXNjYWxsX3Nsb25nX3Q7Cgp0
eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IF9fc3lzY2FsbF91bG9uZ190OwoKCgp0eXBlZGVmIF9f
b2ZmNjRfdCBfX2xvZmZfdDsKdHlwZWRlZiBfX3F1YWRfdCAqX19xYWRkcl90Owp0eXBlZGVmIGNo
YXIgKl9fY2FkZHJfdDsKCgp0eXBlZGVmIGxvbmcgaW50IF9faW50cHRyX3Q7CgoKdHlwZWRlZiB1
bnNpZ25lZCBpbnQgX19zb2NrbGVuX3Q7CiMgMzAgIi91c3IvaW5jbHVkZS9zeXMvdHlwZXMuaCIg
MiAzIDQKCgoKdHlwZWRlZiBfX3VfY2hhciB1X2NoYXI7CnR5cGVkZWYgX191X3Nob3J0IHVfc2hv
cnQ7CnR5cGVkZWYgX191X2ludCB1X2ludDsKdHlwZWRlZiBfX3VfbG9uZyB1X2xvbmc7CnR5cGVk
ZWYgX19xdWFkX3QgcXVhZF90Owp0eXBlZGVmIF9fdV9xdWFkX3QgdV9xdWFkX3Q7CnR5cGVkZWYg
X19mc2lkX3QgZnNpZF90OwoKCgoKdHlwZWRlZiBfX2xvZmZfdCBsb2ZmX3Q7CgoKCnR5cGVkZWYg
X19pbm9fdCBpbm9fdDsKCgoKCgoKdHlwZWRlZiBfX2lubzY0X3QgaW5vNjRfdDsKCgoKCnR5cGVk
ZWYgX19kZXZfdCBkZXZfdDsKCgoKCnR5cGVkZWYgX19naWRfdCBnaWRfdDsKCgoKCnR5cGVkZWYg
X19tb2RlX3QgbW9kZV90OwoKCgoKdHlwZWRlZiBfX25saW5rX3QgbmxpbmtfdDsKCgoKCnR5cGVk
ZWYgX191aWRfdCB1aWRfdDsKCgoKCgp0eXBlZGVmIF9fb2ZmX3Qgb2ZmX3Q7CgoKCgoKCnR5cGVk
ZWYgX19vZmY2NF90IG9mZjY0X3Q7CgoKCgp0eXBlZGVmIF9fcGlkX3QgcGlkX3Q7CgoKCgoKdHlw
ZWRlZiBfX2lkX3QgaWRfdDsKCgoKCnR5cGVkZWYgX19zc2l6ZV90IHNzaXplX3Q7CgoKCgoKdHlw
ZWRlZiBfX2RhZGRyX3QgZGFkZHJfdDsKdHlwZWRlZiBfX2NhZGRyX3QgY2FkZHJfdDsKCgoKCgp0
eXBlZGVmIF9fa2V5X3Qga2V5X3Q7CiMgMTMyICIvdXNyL2luY2x1ZGUvc3lzL3R5cGVzLmgiIDMg
NAojIDEgIi91c3IvaW5jbHVkZS90aW1lLmgiIDEgMyA0CiMgNTcgIi91c3IvaW5jbHVkZS90aW1l
LmgiIDMgNAoKCnR5cGVkZWYgX19jbG9ja190IGNsb2NrX3Q7CgoKCiMgNzMgIi91c3IvaW5jbHVk
ZS90aW1lLmgiIDMgNAoKCnR5cGVkZWYgX190aW1lX3QgdGltZV90OwoKCgojIDkxICIvdXNyL2lu
Y2x1ZGUvdGltZS5oIiAzIDQKdHlwZWRlZiBfX2Nsb2NraWRfdCBjbG9ja2lkX3Q7CiMgMTAzICIv
dXNyL2luY2x1ZGUvdGltZS5oIiAzIDQKdHlwZWRlZiBfX3RpbWVyX3QgdGltZXJfdDsKIyAxMzMg
Ii91c3IvaW5jbHVkZS9zeXMvdHlwZXMuaCIgMiAzIDQKCgoKdHlwZWRlZiBfX3VzZWNvbmRzX3Qg
dXNlY29uZHNfdDsKCgoKdHlwZWRlZiBfX3N1c2Vjb25kc190IHN1c2Vjb25kc190OwoKCgoKCiMg
MSAiL3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51eC82LjAuMC9pbmNsdWRlL3N0ZGRlZi5o
IiAxIDMgNAojIDE0NyAiL3Vzci9pbmNsdWRlL3N5cy90eXBlcy5oIiAyIDMgNAoKCgp0eXBlZGVm
IHVuc2lnbmVkIGxvbmcgaW50IHVsb25nOwp0eXBlZGVmIHVuc2lnbmVkIHNob3J0IGludCB1c2hv
cnQ7CnR5cGVkZWYgdW5zaWduZWQgaW50IHVpbnQ7CiMgMTk0ICIvdXNyL2luY2x1ZGUvc3lzL3R5
cGVzLmgiIDMgNAp0eXBlZGVmIGludCBpbnQ4X3QgX19hdHRyaWJ1dGVfXyAoKF9fbW9kZV9fIChf
X1FJX18pKSk7CnR5cGVkZWYgaW50IGludDE2X3QgX19hdHRyaWJ1dGVfXyAoKF9fbW9kZV9fIChf
X0hJX18pKSk7CnR5cGVkZWYgaW50IGludDMyX3QgX19hdHRyaWJ1dGVfXyAoKF9fbW9kZV9fIChf
X1NJX18pKSk7CnR5cGVkZWYgaW50IGludDY0X3QgX19hdHRyaWJ1dGVfXyAoKF9fbW9kZV9fIChf
X0RJX18pKSk7CgoKdHlwZWRlZiB1bnNpZ25lZCBpbnQgdV9pbnQ4X3QgX19hdHRyaWJ1dGVfXyAo
KF9fbW9kZV9fIChfX1FJX18pKSk7CnR5cGVkZWYgdW5zaWduZWQgaW50IHVfaW50MTZfdCBfX2F0
dHJpYnV0ZV9fICgoX19tb2RlX18gKF9fSElfXykpKTsKdHlwZWRlZiB1bnNpZ25lZCBpbnQgdV9p
bnQzMl90IF9fYXR0cmlidXRlX18gKChfX21vZGVfXyAoX19TSV9fKSkpOwp0eXBlZGVmIHVuc2ln
bmVkIGludCB1X2ludDY0X3QgX19hdHRyaWJ1dGVfXyAoKF9fbW9kZV9fIChfX0RJX18pKSk7Cgp0
eXBlZGVmIGludCByZWdpc3Rlcl90IF9fYXR0cmlidXRlX18gKChfX21vZGVfXyAoX193b3JkX18p
KSk7CiMgMjE5ICIvdXNyL2luY2x1ZGUvc3lzL3R5cGVzLmgiIDMgNAojIDEgIi91c3IvaW5jbHVk
ZS9zeXMvc2VsZWN0LmgiIDEgMyA0CiMgMzAgIi91c3IvaW5jbHVkZS9zeXMvc2VsZWN0LmgiIDMg
NAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3NlbGVjdC5oIiAxIDMgNAojIDMxICIvdXNyL2luY2x1
ZGUvc3lzL3NlbGVjdC5oIiAyIDMgNAoKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvc2lnc2V0Lmgi
IDEgMyA0CiMgMjIgIi91c3IvaW5jbHVkZS9iaXRzL3NpZ3NldC5oIiAzIDQKdHlwZWRlZiBpbnQg
X19zaWdfYXRvbWljX3Q7CgoKCgp0eXBlZGVmIHN0cnVjdAogIHsKICAgIHVuc2lnbmVkIGxvbmcg
aW50IF9fdmFsWygxMDI0IC8gKDggKiBzaXplb2YgKHVuc2lnbmVkIGxvbmcgaW50KSkpXTsKICB9
IF9fc2lnc2V0X3Q7CiMgMzQgIi91c3IvaW5jbHVkZS9zeXMvc2VsZWN0LmgiIDIgMyA0CgoKCnR5
cGVkZWYgX19zaWdzZXRfdCBzaWdzZXRfdDsKCgoKCgojIDEgIi91c3IvaW5jbHVkZS90aW1lLmgi
IDEgMyA0CiMgMTIwICIvdXNyL2luY2x1ZGUvdGltZS5oIiAzIDQKc3RydWN0IHRpbWVzcGVjCiAg
ewogICAgX190aW1lX3QgdHZfc2VjOwogICAgX19zeXNjYWxsX3Nsb25nX3QgdHZfbnNlYzsKICB9
OwojIDQ0ICIvdXNyL2luY2x1ZGUvc3lzL3NlbGVjdC5oIiAyIDMgNAoKIyAxICIvdXNyL2luY2x1
ZGUvYml0cy90aW1lLmgiIDEgMyA0CiMgMzAgIi91c3IvaW5jbHVkZS9iaXRzL3RpbWUuaCIgMyA0
CnN0cnVjdCB0aW1ldmFsCiAgewogICAgX190aW1lX3QgdHZfc2VjOwogICAgX19zdXNlY29uZHNf
dCB0dl91c2VjOwogIH07CiMgNDYgIi91c3IvaW5jbHVkZS9zeXMvc2VsZWN0LmgiIDIgMyA0CiMg
NTQgIi91c3IvaW5jbHVkZS9zeXMvc2VsZWN0LmgiIDMgNAp0eXBlZGVmIGxvbmcgaW50IF9fZmRf
bWFzazsKIyA2NCAiL3Vzci9pbmNsdWRlL3N5cy9zZWxlY3QuaCIgMyA0CnR5cGVkZWYgc3RydWN0
CiAgewoKCgogICAgX19mZF9tYXNrIGZkc19iaXRzWzEwMjQgLyAoOCAqIChpbnQpIHNpemVvZiAo
X19mZF9tYXNrKSldOwoKCgoKCiAgfSBmZF9zZXQ7CgoKCgoKCnR5cGVkZWYgX19mZF9tYXNrIGZk
X21hc2s7CiMgOTYgIi91c3IvaW5jbHVkZS9zeXMvc2VsZWN0LmgiIDMgNApleHRlcm4gIkMiIHsK
IyAxMDYgIi91c3IvaW5jbHVkZS9zeXMvc2VsZWN0LmgiIDMgNApleHRlcm4gaW50IHNlbGVjdCAo
aW50IF9fbmZkcywgZmRfc2V0ICpfX3Jlc3RyaWN0IF9fcmVhZGZkcywKICAgICBmZF9zZXQgKl9f
cmVzdHJpY3QgX193cml0ZWZkcywKICAgICBmZF9zZXQgKl9fcmVzdHJpY3QgX19leGNlcHRmZHMs
CiAgICAgc3RydWN0IHRpbWV2YWwgKl9fcmVzdHJpY3QgX190aW1lb3V0KTsKIyAxMTggIi91c3Iv
aW5jbHVkZS9zeXMvc2VsZWN0LmgiIDMgNApleHRlcm4gaW50IHBzZWxlY3QgKGludCBfX25mZHMs
IGZkX3NldCAqX19yZXN0cmljdCBfX3JlYWRmZHMsCiAgICAgIGZkX3NldCAqX19yZXN0cmljdCBf
X3dyaXRlZmRzLAogICAgICBmZF9zZXQgKl9fcmVzdHJpY3QgX19leGNlcHRmZHMsCiAgICAgIGNv
bnN0IHN0cnVjdCB0aW1lc3BlYyAqX19yZXN0cmljdCBfX3RpbWVvdXQsCiAgICAgIGNvbnN0IF9f
c2lnc2V0X3QgKl9fcmVzdHJpY3QgX19zaWdtYXNrKTsKCgoKCgojIDEgIi91c3IvaW5jbHVkZS9i
aXRzL3NlbGVjdDIuaCIgMSAzIDQKIyAyNCAiL3Vzci9pbmNsdWRlL2JpdHMvc2VsZWN0Mi5oIiAz
IDQKZXh0ZXJuIGxvbmcgaW50IF9fZmRlbHRfY2hrIChsb25nIGludCBfX2QpOwpleHRlcm4gbG9u
ZyBpbnQgX19mZGVsdF93YXJuIChsb25nIGludCBfX2QpCiAgX19hdHRyaWJ1dGVfXygoX193YXJu
aW5nX18gKCJiaXQgb3V0c2lkZSBvZiBmZF9zZXQgc2VsZWN0ZWQiKSkpOwojIDEyOSAiL3Vzci9p
bmNsdWRlL3N5cy9zZWxlY3QuaCIgMiAzIDQKCgp9CiMgMjIwICIvdXNyL2luY2x1ZGUvc3lzL3R5
cGVzLmgiIDIgMyA0CgoKIyAxICIvdXNyL2luY2x1ZGUvc3lzL3N5c21hY3Jvcy5oIiAxIDMgNAoj
IDI0ICIvdXNyL2luY2x1ZGUvc3lzL3N5c21hY3Jvcy5oIiAzIDQKZXh0ZXJuICJDIiB7CgpfX2V4
dGVuc2lvbl9fCmV4dGVybiB1bnNpZ25lZCBpbnQgZ251X2Rldl9tYWpvciAodW5zaWduZWQgbG9u
ZyBsb25nIGludCBfX2RldikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9f
KSk7Cl9fZXh0ZW5zaW9uX18KZXh0ZXJuIHVuc2lnbmVkIGludCBnbnVfZGV2X21pbm9yICh1bnNp
Z25lZCBsb25nIGxvbmcgaW50IF9fZGV2KQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChf
X2NvbnN0X18pKTsKX19leHRlbnNpb25fXwpleHRlcm4gdW5zaWduZWQgbG9uZyBsb25nIGludCBn
bnVfZGV2X21ha2VkZXYgKHVuc2lnbmVkIGludCBfX21ham9yLAogICAgICAgICAgICB1bnNpZ25l
ZCBpbnQgX19taW5vcikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSk7
CgoKX19leHRlbnNpb25fXyBleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fY29uc3RfXykpIHVuc2lnbmVkIGludApfX2F0dHJp
YnV0ZV9fICgoX19sZWFmX18pKSBnbnVfZGV2X21ham9yICh1bnNpZ25lZCBsb25nIGxvbmcgaW50
IF9fZGV2KSB0aHJvdyAoKQp7CiAgcmV0dXJuICgoX19kZXYgPj4gOCkgJiAweGZmZikgfCAoKHVu
c2lnbmVkIGludCkgKF9fZGV2ID4+IDMyKSAmIH4weGZmZik7Cn0KCl9fZXh0ZW5zaW9uX18gZXh0
ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18gKChfX2NvbnN0X18pKSB1bnNpZ25lZCBpbnQKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkg
Z251X2Rldl9taW5vciAodW5zaWduZWQgbG9uZyBsb25nIGludCBfX2RldikgdGhyb3cgKCkKewog
IHJldHVybiAoX19kZXYgJiAweGZmKSB8ICgodW5zaWduZWQgaW50KSAoX19kZXYgPj4gMTIpICYg
fjB4ZmYpOwp9CgpfX2V4dGVuc2lvbl9fIGV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgo
X19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSkgdW5zaWduZWQgbG9u
ZyBsb25nIGludApfX2F0dHJpYnV0ZV9fICgoX19sZWFmX18pKSBnbnVfZGV2X21ha2VkZXYgKHVu
c2lnbmVkIGludCBfX21ham9yLCB1bnNpZ25lZCBpbnQgX19taW5vcikgdGhyb3cgKCkKewogIHJl
dHVybiAoKF9fbWlub3IgJiAweGZmKSB8ICgoX19tYWpvciAmIDB4ZmZmKSA8PCA4KQogICB8ICgo
KHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQpIChfX21pbm9yICYgfjB4ZmYpKSA8PCAxMikKICAgfCAo
KCh1bnNpZ25lZCBsb25nIGxvbmcgaW50KSAoX19tYWpvciAmIH4weGZmZikpIDw8IDMyKSk7Cn0K
Cn0KIyAyMjMgIi91c3IvaW5jbHVkZS9zeXMvdHlwZXMuaCIgMiAzIDQKCgoKCgp0eXBlZGVmIF9f
Ymxrc2l6ZV90IGJsa3NpemVfdDsKCgoKCgoKdHlwZWRlZiBfX2Jsa2NudF90IGJsa2NudF90OwoK
Cgp0eXBlZGVmIF9fZnNibGtjbnRfdCBmc2Jsa2NudF90OwoKCgp0eXBlZGVmIF9fZnNmaWxjbnRf
dCBmc2ZpbGNudF90OwojIDI2MiAiL3Vzci9pbmNsdWRlL3N5cy90eXBlcy5oIiAzIDQKdHlwZWRl
ZiBfX2Jsa2NudDY0X3QgYmxrY250NjRfdDsKdHlwZWRlZiBfX2ZzYmxrY250NjRfdCBmc2Jsa2Nu
dDY0X3Q7CnR5cGVkZWYgX19mc2ZpbGNudDY0X3QgZnNmaWxjbnQ2NF90OwoKCgoKCiMgMSAiL3Vz
ci9pbmNsdWRlL2JpdHMvcHRocmVhZHR5cGVzLmgiIDEgMyA0CiMgMjEgIi91c3IvaW5jbHVkZS9i
aXRzL3B0aHJlYWR0eXBlcy5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy93b3Jkc2l6ZS5o
IiAxIDMgNAojIDIyICIvdXNyL2luY2x1ZGUvYml0cy9wdGhyZWFkdHlwZXMuaCIgMiAzIDQKIyA0
OCAiL3Vzci9pbmNsdWRlL2JpdHMvcHRocmVhZHR5cGVzLmgiIDMgNAp0eXBlZGVmIHVuc2lnbmVk
IGxvbmcgaW50IHB0aHJlYWRfdDsKCgp1bmlvbiBwdGhyZWFkX2F0dHJfdAp7CiAgY2hhciBfX3Np
emVbNTZdOwogIGxvbmcgaW50IF9fYWxpZ247Cn07Cgp0eXBlZGVmIHVuaW9uIHB0aHJlYWRfYXR0
cl90IHB0aHJlYWRfYXR0cl90OwoKCgoKCnR5cGVkZWYgc3RydWN0IF9fcHRocmVhZF9pbnRlcm5h
bF9saXN0CnsKICBzdHJ1Y3QgX19wdGhyZWFkX2ludGVybmFsX2xpc3QgKl9fcHJldjsKICBzdHJ1
Y3QgX19wdGhyZWFkX2ludGVybmFsX2xpc3QgKl9fbmV4dDsKfSBfX3B0aHJlYWRfbGlzdF90Owoj
IDc4ICIvdXNyL2luY2x1ZGUvYml0cy9wdGhyZWFkdHlwZXMuaCIgMyA0CnR5cGVkZWYgdW5pb24K
ewogIHN0cnVjdCBfX3B0aHJlYWRfbXV0ZXhfcwogIHsKICAgIGludCBfX2xvY2s7CiAgICB1bnNp
Z25lZCBpbnQgX19jb3VudDsKICAgIGludCBfX293bmVyOwoKICAgIHVuc2lnbmVkIGludCBfX251
c2VyczsKCgoKICAgIGludCBfX2tpbmQ7CgoKCgoKCgogICAgaW50IF9fc3BpbnM7CgoKCiAgICBf
X3B0aHJlYWRfbGlzdF90IF9fbGlzdDsKIyAxMjYgIi91c3IvaW5jbHVkZS9iaXRzL3B0aHJlYWR0
eXBlcy5oIiAzIDQKICB9IF9fZGF0YTsKICBjaGFyIF9fc2l6ZVs0MF07CiAgbG9uZyBpbnQgX19h
bGlnbjsKfSBwdGhyZWFkX211dGV4X3Q7CgoKdHlwZWRlZiB1bmlvbgp7CiAgY2hhciBfX3NpemVb
NF07CiAgaW50IF9fYWxpZ247Cn0gcHRocmVhZF9tdXRleGF0dHJfdDsKCgoKCnR5cGVkZWYgdW5p
b24KewogIHN0cnVjdAogIHsKICAgIGludCBfX2xvY2s7CiAgICB1bnNpZ25lZCBpbnQgX19mdXRl
eDsKICAgIF9fZXh0ZW5zaW9uX18gdW5zaWduZWQgbG9uZyBsb25nIGludCBfX3RvdGFsX3NlcTsK
ICAgIF9fZXh0ZW5zaW9uX18gdW5zaWduZWQgbG9uZyBsb25nIGludCBfX3dha2V1cF9zZXE7CiAg
ICBfX2V4dGVuc2lvbl9fIHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgX193b2tlbl9zZXE7CiAgICB2
b2lkICpfX211dGV4OwogICAgdW5zaWduZWQgaW50IF9fbndhaXRlcnM7CiAgICB1bnNpZ25lZCBp
bnQgX19icm9hZGNhc3Rfc2VxOwogIH0gX19kYXRhOwogIGNoYXIgX19zaXplWzQ4XTsKICBfX2V4
dGVuc2lvbl9fIGxvbmcgbG9uZyBpbnQgX19hbGlnbjsKfSBwdGhyZWFkX2NvbmRfdDsKCnR5cGVk
ZWYgdW5pb24KewogIGNoYXIgX19zaXplWzRdOwogIGludCBfX2FsaWduOwp9IHB0aHJlYWRfY29u
ZGF0dHJfdDsKCgoKdHlwZWRlZiB1bnNpZ25lZCBpbnQgcHRocmVhZF9rZXlfdDsKCgoKdHlwZWRl
ZiBpbnQgcHRocmVhZF9vbmNlX3Q7CgoKCgoKdHlwZWRlZiB1bmlvbgp7CgogIHN0cnVjdAogIHsK
ICAgIGludCBfX2xvY2s7CiAgICB1bnNpZ25lZCBpbnQgX19ucl9yZWFkZXJzOwogICAgdW5zaWdu
ZWQgaW50IF9fcmVhZGVyc193YWtldXA7CiAgICB1bnNpZ25lZCBpbnQgX193cml0ZXJfd2FrZXVw
OwogICAgdW5zaWduZWQgaW50IF9fbnJfcmVhZGVyc19xdWV1ZWQ7CiAgICB1bnNpZ25lZCBpbnQg
X19ucl93cml0ZXJzX3F1ZXVlZDsKICAgIGludCBfX3dyaXRlcjsKICAgIGludCBfX3NoYXJlZDsK
ICAgIHVuc2lnbmVkIGxvbmcgaW50IF9fcGFkMTsKICAgIHVuc2lnbmVkIGxvbmcgaW50IF9fcGFk
MjsKCgogICAgdW5zaWduZWQgaW50IF9fZmxhZ3M7CiAgfSBfX2RhdGE7CiMgMjEzICIvdXNyL2lu
Y2x1ZGUvYml0cy9wdGhyZWFkdHlwZXMuaCIgMyA0CiAgY2hhciBfX3NpemVbNTZdOwogIGxvbmcg
aW50IF9fYWxpZ247Cn0gcHRocmVhZF9yd2xvY2tfdDsKCgoKdHlwZWRlZiB1bmlvbgp7CiAgY2hh
ciBfX3NpemVbOF07CiAgbG9uZyBpbnQgX19hbGlnbjsKfSBwdGhyZWFkX3J3bG9ja2F0dHJfdDsK
CgoKCgp0eXBlZGVmIHZvbGF0aWxlIGludCBwdGhyZWFkX3NwaW5sb2NrX3Q7CgoKCgp0eXBlZGVm
IHVuaW9uCnsKICBjaGFyIF9fc2l6ZVszMl07CiAgbG9uZyBpbnQgX19hbGlnbjsKfSBwdGhyZWFk
X2JhcnJpZXJfdDsKCnR5cGVkZWYgdW5pb24KewogIGNoYXIgX19zaXplWzRdOwogIGludCBfX2Fs
aWduOwp9IHB0aHJlYWRfYmFycmllcmF0dHJfdDsKIyAyNzEgIi91c3IvaW5jbHVkZS9zeXMvdHlw
ZXMuaCIgMiAzIDQKCgp9CiMgMzE1ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDIgMyA0CgoKCgoK
CmV4dGVybiBsb25nIGludCByYW5kb20gKHZvaWQpIHRocm93ICgpOwoKCmV4dGVybiB2b2lkIHNy
YW5kb20gKHVuc2lnbmVkIGludCBfX3NlZWQpIHRocm93ICgpOwoKCgoKCmV4dGVybiBjaGFyICpp
bml0c3RhdGUgKHVuc2lnbmVkIGludCBfX3NlZWQsIGNoYXIgKl9fc3RhdGVidWYsCiAgIHNpemVf
dCBfX3N0YXRlbGVuKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIpKSk7
CgoKCmV4dGVybiBjaGFyICpzZXRzdGF0ZSAoY2hhciAqX19zdGF0ZWJ1ZikgdGhyb3cgKCkgX19h
dHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKCgoKc3RydWN0IHJhbmRvbV9kYXRh
CiAgewogICAgaW50MzJfdCAqZnB0cjsKICAgIGludDMyX3QgKnJwdHI7CiAgICBpbnQzMl90ICpz
dGF0ZTsKICAgIGludCByYW5kX3R5cGU7CiAgICBpbnQgcmFuZF9kZWc7CiAgICBpbnQgcmFuZF9z
ZXA7CiAgICBpbnQzMl90ICplbmRfcHRyOwogIH07CgpleHRlcm4gaW50IHJhbmRvbV9yIChzdHJ1
Y3QgcmFuZG9tX2RhdGEgKl9fcmVzdHJpY3QgX19idWYsCiAgICAgICBpbnQzMl90ICpfX3Jlc3Ry
aWN0IF9fcmVzdWx0KSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIp
KSk7CgpleHRlcm4gaW50IHNyYW5kb21fciAodW5zaWduZWQgaW50IF9fc2VlZCwgc3RydWN0IHJh
bmRvbV9kYXRhICpfX2J1ZikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxs
X18gKDIpKSk7CgpleHRlcm4gaW50IGluaXRzdGF0ZV9yICh1bnNpZ25lZCBpbnQgX19zZWVkLCBj
aGFyICpfX3Jlc3RyaWN0IF9fc3RhdGVidWYsCiAgIHNpemVfdCBfX3N0YXRlbGVuLAogICBzdHJ1
Y3QgcmFuZG9tX2RhdGEgKl9fcmVzdHJpY3QgX19idWYpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1
dGVfXyAoKF9fbm9ubnVsbF9fICgyLCA0KSkpOwoKZXh0ZXJuIGludCBzZXRzdGF0ZV9yIChjaGFy
ICpfX3Jlc3RyaWN0IF9fc3RhdGVidWYsCiAgICAgICAgIHN0cnVjdCByYW5kb21fZGF0YSAqX19y
ZXN0cmljdCBfX2J1ZikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g
KDEsIDIpKSk7CgoKCgoKCmV4dGVybiBpbnQgcmFuZCAodm9pZCkgdGhyb3cgKCk7CgpleHRlcm4g
dm9pZCBzcmFuZCAodW5zaWduZWQgaW50IF9fc2VlZCkgdGhyb3cgKCk7CgoKCgpleHRlcm4gaW50
IHJhbmRfciAodW5zaWduZWQgaW50ICpfX3NlZWQpIHRocm93ICgpOwoKCgoKCgoKZXh0ZXJuIGRv
dWJsZSBkcmFuZDQ4ICh2b2lkKSB0aHJvdyAoKTsKZXh0ZXJuIGRvdWJsZSBlcmFuZDQ4ICh1bnNp
Z25lZCBzaG9ydCBpbnQgX194c3ViaVszXSkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgxKSkpOwoKCmV4dGVybiBsb25nIGludCBscmFuZDQ4ICh2b2lkKSB0aHJvdyAoKTsK
ZXh0ZXJuIGxvbmcgaW50IG5yYW5kNDggKHVuc2lnbmVkIHNob3J0IGludCBfX3hzdWJpWzNdKQog
ICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4g
bG9uZyBpbnQgbXJhbmQ0OCAodm9pZCkgdGhyb3cgKCk7CmV4dGVybiBsb25nIGludCBqcmFuZDQ4
ICh1bnNpZ25lZCBzaG9ydCBpbnQgX194c3ViaVszXSkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0
ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIHZvaWQgc3JhbmQ0OCAobG9uZyBpbnQg
X19zZWVkdmFsKSB0aHJvdyAoKTsKZXh0ZXJuIHVuc2lnbmVkIHNob3J0IGludCAqc2VlZDQ4ICh1
bnNpZ25lZCBzaG9ydCBpbnQgX19zZWVkMTZ2WzNdKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRl
X18gKChfX25vbm51bGxfXyAoMSkpKTsKZXh0ZXJuIHZvaWQgbGNvbmc0OCAodW5zaWduZWQgc2hv
cnQgaW50IF9fcGFyYW1bN10pIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo
MSkpKTsKCgoKCgpzdHJ1Y3QgZHJhbmQ0OF9kYXRhCiAgewogICAgdW5zaWduZWQgc2hvcnQgaW50
IF9feFszXTsKICAgIHVuc2lnbmVkIHNob3J0IGludCBfX29sZF94WzNdOwogICAgdW5zaWduZWQg
c2hvcnQgaW50IF9fYzsKICAgIHVuc2lnbmVkIHNob3J0IGludCBfX2luaXQ7CiAgICBfX2V4dGVu
c2lvbl9fIHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgX19hOwoKICB9OwoKCmV4dGVybiBpbnQgZHJh
bmQ0OF9yIChzdHJ1Y3QgZHJhbmQ0OF9kYXRhICpfX3Jlc3RyaWN0IF9fYnVmZmVyLAogICAgICAg
IGRvdWJsZSAqX19yZXN0cmljdCBfX3Jlc3VsdCkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9f
bm9ubnVsbF9fICgxLCAyKSkpOwpleHRlcm4gaW50IGVyYW5kNDhfciAodW5zaWduZWQgc2hvcnQg
aW50IF9feHN1YmlbM10sCiAgICAgICAgc3RydWN0IGRyYW5kNDhfZGF0YSAqX19yZXN0cmljdCBf
X2J1ZmZlciwKICAgICAgICBkb3VibGUgKl9fcmVzdHJpY3QgX19yZXN1bHQpIHRocm93ICgpIF9f
YXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IGxyYW5kNDhf
ciAoc3RydWN0IGRyYW5kNDhfZGF0YSAqX19yZXN0cmljdCBfX2J1ZmZlciwKICAgICAgICBsb25n
IGludCAqX19yZXN0cmljdCBfX3Jlc3VsdCkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgo
X19ub25udWxsX18gKDEsIDIpKSk7CmV4dGVybiBpbnQgbnJhbmQ0OF9yICh1bnNpZ25lZCBzaG9y
dCBpbnQgX194c3ViaVszXSwKICAgICAgICBzdHJ1Y3QgZHJhbmQ0OF9kYXRhICpfX3Jlc3RyaWN0
IF9fYnVmZmVyLAogICAgICAgIGxvbmcgaW50ICpfX3Jlc3RyaWN0IF9fcmVzdWx0KQogICAgIHRo
cm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50
IG1yYW5kNDhfciAoc3RydWN0IGRyYW5kNDhfZGF0YSAqX19yZXN0cmljdCBfX2J1ZmZlciwKICAg
ICAgICBsb25nIGludCAqX19yZXN0cmljdCBfX3Jlc3VsdCkKICAgICB0aHJvdyAoKSBfX2F0dHJp
YnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CmV4dGVybiBpbnQganJhbmQ0OF9yICh1bnNp
Z25lZCBzaG9ydCBpbnQgX194c3ViaVszXSwKICAgICAgICBzdHJ1Y3QgZHJhbmQ0OF9kYXRhICpf
X3Jlc3RyaWN0IF9fYnVmZmVyLAogICAgICAgIGxvbmcgaW50ICpfX3Jlc3RyaWN0IF9fcmVzdWx0
KQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpl
eHRlcm4gaW50IHNyYW5kNDhfciAobG9uZyBpbnQgX19zZWVkdmFsLCBzdHJ1Y3QgZHJhbmQ0OF9k
YXRhICpfX2J1ZmZlcikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g
KDIpKSk7CgpleHRlcm4gaW50IHNlZWQ0OF9yICh1bnNpZ25lZCBzaG9ydCBpbnQgX19zZWVkMTZ2
WzNdLAogICAgICAgc3RydWN0IGRyYW5kNDhfZGF0YSAqX19idWZmZXIpIHRocm93ICgpIF9fYXR0
cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCmV4dGVybiBpbnQgbGNvbmc0OF9yICh1
bnNpZ25lZCBzaG9ydCBpbnQgX19wYXJhbVs3XSwKICAgICAgICBzdHJ1Y3QgZHJhbmQ0OF9kYXRh
ICpfX2J1ZmZlcikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEs
IDIpKSk7CgoKCgoKCgoKCmV4dGVybiB2b2lkICptYWxsb2MgKHNpemVfdCBfX3NpemUpIHRocm93
ICgpIF9fYXR0cmlidXRlX18gKChfX21hbGxvY19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91
bnVzZWRfcmVzdWx0X18pKTsKCmV4dGVybiB2b2lkICpjYWxsb2MgKHNpemVfdCBfX25tZW1iLCBz
aXplX3QgX19zaXplKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX21hbGxvY19fKSkg
X19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCgoKCgoKCmV4dGVy
biB2b2lkICpyZWFsbG9jICh2b2lkICpfX3B0ciwgc2l6ZV90IF9fc2l6ZSkKICAgICB0aHJvdyAo
KSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKZXh0ZXJuIHZvaWQg
ZnJlZSAodm9pZCAqX19wdHIpIHRocm93ICgpOwoKCgoKZXh0ZXJuIHZvaWQgY2ZyZWUgKHZvaWQg
Kl9fcHRyKSB0aHJvdyAoKTsKCgoKIyAxICIvdXNyL2luY2x1ZGUvYWxsb2NhLmgiIDEgMyA0CiMg
MjQgIi91c3IvaW5jbHVkZS9hbGxvY2EuaCIgMyA0CiMgMSAiL3Vzci9saWIvZ2NjL3MzOTB4LXJl
ZGhhdC1saW51eC82LjAuMC9pbmNsdWRlL3N0ZGRlZi5oIiAxIDMgNAojIDI1ICIvdXNyL2luY2x1
ZGUvYWxsb2NhLmgiIDIgMyA0CgpleHRlcm4gIkMiIHsKCgoKCgpleHRlcm4gdm9pZCAqYWxsb2Nh
IChzaXplX3QgX19zaXplKSB0aHJvdyAoKTsKCgoKCgp9CiMgNDkzICIvdXNyL2luY2x1ZGUvc3Rk
bGliLmgiIDIgMyA0CgoKCgoKZXh0ZXJuIHZvaWQgKnZhbGxvYyAoc2l6ZV90IF9fc2l6ZSkgdGhy
b3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbWFsbG9jX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJu
X3VudXNlZF9yZXN1bHRfXykpOwoKCgoKZXh0ZXJuIGludCBwb3NpeF9tZW1hbGlnbiAodm9pZCAq
Kl9fbWVtcHRyLCBzaXplX3QgX19hbGlnbm1lbnQsIHNpemVfdCBfX3NpemUpCiAgICAgdGhyb3cg
KCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dh
cm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gdm9pZCAqYWxpZ25lZF9hbGxvYyAoc2l6
ZV90IF9fYWxpZ25tZW50LCBzaXplX3QgX19zaXplKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRl
X18gKChfX21hbGxvY19fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYWxsb2Nfc2l6ZV9fICgyKSkpIF9f
YXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gdm9pZCBh
Ym9ydCAodm9pZCkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9yZXR1cm5fXykpOwoKCgpl
eHRlcm4gaW50IGF0ZXhpdCAodm9pZCAoKl9fZnVuYykgKHZvaWQpKSB0aHJvdyAoKSBfX2F0dHJp
YnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgpleHRlcm4gIkMrKyIgaW50IGF0X3F1aWNr
X2V4aXQgKHZvaWQgKCpfX2Z1bmMpICh2b2lkKSkKICAgICB0aHJvdyAoKSBfX2FzbSAoImF0X3F1
aWNrX2V4aXQiKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoKCgoKCmV4
dGVybiBpbnQgb25fZXhpdCAodm9pZCAoKl9fZnVuYykgKGludCBfX3N0YXR1cywgdm9pZCAqX19h
cmcpLCB2b2lkICpfX2FyZykKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxs
X18gKDEpKSk7CgoKCgoKCmV4dGVybiB2b2lkIGV4aXQgKGludCBfX3N0YXR1cykgdGhyb3cgKCkg
X19hdHRyaWJ1dGVfXyAoKF9fbm9yZXR1cm5fXykpOwoKCgoKCmV4dGVybiB2b2lkIHF1aWNrX2V4
aXQgKGludCBfX3N0YXR1cykgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9yZXR1cm5fXykp
OwoKCgoKCgoKZXh0ZXJuIHZvaWQgX0V4aXQgKGludCBfX3N0YXR1cykgdGhyb3cgKCkgX19hdHRy
aWJ1dGVfXyAoKF9fbm9yZXR1cm5fXykpOwoKCgoKCgpleHRlcm4gY2hhciAqZ2V0ZW52IChjb25z
dCBjaGFyICpfX25hbWUpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkp
KSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKCmV4dGVybiBj
aGFyICpzZWN1cmVfZ2V0ZW52IChjb25zdCBjaGFyICpfX25hbWUpCiAgICAgdGhyb3cgKCkgX19h
dHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51
c2VkX3Jlc3VsdF9fKSk7CgoKCgoKCmV4dGVybiBpbnQgcHV0ZW52IChjaGFyICpfX3N0cmluZykg
dGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKCmV4dGVybiBp
bnQgc2V0ZW52IChjb25zdCBjaGFyICpfX25hbWUsIGNvbnN0IGNoYXIgKl9fdmFsdWUsIGludCBf
X3JlcGxhY2UpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyKSkp
OwoKCmV4dGVybiBpbnQgdW5zZXRlbnYgKGNvbnN0IGNoYXIgKl9fbmFtZSkgdGhyb3cgKCkgX19h
dHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKCgpleHRlcm4gaW50IGNsZWFyZW52
ICh2b2lkKSB0aHJvdyAoKTsKIyA2MDYgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMyA0CmV4dGVy
biBjaGFyICpta3RlbXAgKGNoYXIgKl9fdGVtcGxhdGUpIHRocm93ICgpIF9fYXR0cmlidXRlX18g
KChfX25vbm51bGxfXyAoMSkpKTsKIyA2MTkgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMyA0CmV4
dGVybiBpbnQgbWtzdGVtcCAoY2hhciAqX190ZW1wbGF0ZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CiMg
NjI5ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDMgNApleHRlcm4gaW50IG1rc3RlbXA2NCAoY2hh
ciAqX190ZW1wbGF0ZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmli
dXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CiMgNjQxICIvdXNyL2luY2x1ZGUvc3Rk
bGliLmgiIDMgNApleHRlcm4gaW50IG1rc3RlbXBzIChjaGFyICpfX3RlbXBsYXRlLCBpbnQgX19z
dWZmaXhsZW4pIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0ZV9f
ICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDY1MSAiL3Vzci9pbmNsdWRlL3N0ZGxpYi5o
IiAzIDQKZXh0ZXJuIGludCBta3N0ZW1wczY0IChjaGFyICpfX3RlbXBsYXRlLCBpbnQgX19zdWZm
aXhsZW4pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRl
X18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CiMgNjYyICIvdXNyL2luY2x1ZGUvc3RkbGli
LmgiIDMgNApleHRlcm4gY2hhciAqbWtkdGVtcCAoY2hhciAqX190ZW1wbGF0ZSkgdGhyb3cgKCkg
X19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5f
dW51c2VkX3Jlc3VsdF9fKSk7CiMgNjczICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDMgNApleHRl
cm4gaW50IG1rb3N0ZW1wIChjaGFyICpfX3RlbXBsYXRlLCBpbnQgX19mbGFncykgX19hdHRyaWJ1
dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jl
c3VsdF9fKSk7CiMgNjgzICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDMgNApleHRlcm4gaW50IG1r
b3N0ZW1wNjQgKGNoYXIgKl9fdGVtcGxhdGUsIGludCBfX2ZsYWdzKSBfX2F0dHJpYnV0ZV9fICgo
X19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18p
KTsKIyA2OTMgIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMyA0CmV4dGVybiBpbnQgbWtvc3RlbXBz
IChjaGFyICpfX3RlbXBsYXRlLCBpbnQgX19zdWZmaXhsZW4sIGludCBfX2ZsYWdzKQogICAgIF9f
YXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3Vu
dXNlZF9yZXN1bHRfXykpOwojIDcwNSAiL3Vzci9pbmNsdWRlL3N0ZGxpYi5oIiAzIDQKZXh0ZXJu
IGludCBta29zdGVtcHM2NCAoY2hhciAqX190ZW1wbGF0ZSwgaW50IF9fc3VmZml4bGVuLCBpbnQg
X19mbGFncykKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1
dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCgoKCgoKZXh0ZXJuIGludCBzeXN0
ZW0gKGNvbnN0IGNoYXIgKl9fY29tbWFuZCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKTsKCgoKCgoKZXh0ZXJuIGNoYXIgKmNhbm9uaWNhbGl6ZV9maWxlX25hbWUgKGNv
bnN0IGNoYXIgKl9fbmFtZSkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxs
X18gKDEpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKIyA3MzMg
Ii91c3IvaW5jbHVkZS9zdGRsaWIuaCIgMyA0CmV4dGVybiBjaGFyICpyZWFscGF0aCAoY29uc3Qg
Y2hhciAqX19yZXN0cmljdCBfX25hbWUsCiAgICAgICAgIGNoYXIgKl9fcmVzdHJpY3QgX19yZXNv
bHZlZCkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsK
CgoKCgoKdHlwZWRlZiBpbnQgKCpfX2NvbXBhcl9mbl90KSAoY29uc3Qgdm9pZCAqLCBjb25zdCB2
b2lkICopOwoKCnR5cGVkZWYgX19jb21wYXJfZm5fdCBjb21wYXJpc29uX2ZuX3Q7CgoKCnR5cGVk
ZWYgaW50ICgqX19jb21wYXJfZF9mbl90KSAoY29uc3Qgdm9pZCAqLCBjb25zdCB2b2lkICosIHZv
aWQgKik7CgoKCgoKZXh0ZXJuIHZvaWQgKmJzZWFyY2ggKGNvbnN0IHZvaWQgKl9fa2V5LCBjb25z
dCB2b2lkICpfX2Jhc2UsCiAgICAgICAgc2l6ZV90IF9fbm1lbWIsIHNpemVfdCBfX3NpemUsIF9f
Y29tcGFyX2ZuX3QgX19jb21wYXIpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx
LCAyLCA1KSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKIyAx
ICIvdXNyL2luY2x1ZGUvYml0cy9zdGRsaWItYnNlYXJjaC5oIiAxIDMgNAojIDE5ICIvdXNyL2lu
Y2x1ZGUvYml0cy9zdGRsaWItYnNlYXJjaC5oIiAzIDQKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmli
dXRlX18gKChfX2dudV9pbmxpbmVfXykpIHZvaWQgKgpic2VhcmNoIChjb25zdCB2b2lkICpfX2tl
eSwgY29uc3Qgdm9pZCAqX19iYXNlLCBzaXplX3QgX19ubWVtYiwgc2l6ZV90IF9fc2l6ZSwKICBf
X2NvbXBhcl9mbl90IF9fY29tcGFyKQp7CiAgc2l6ZV90IF9fbCwgX191LCBfX2lkeDsKICBjb25z
dCB2b2lkICpfX3A7CiAgaW50IF9fY29tcGFyaXNvbjsKCiAgX19sID0gMDsKICBfX3UgPSBfX25t
ZW1iOwogIHdoaWxlIChfX2wgPCBfX3UpCiAgICB7CiAgICAgIF9faWR4ID0gKF9fbCArIF9fdSkg
LyAyOwogICAgICBfX3AgPSAodm9pZCAqKSAoKChjb25zdCBjaGFyICopIF9fYmFzZSkgKyAoX19p
ZHggKiBfX3NpemUpKTsKICAgICAgX19jb21wYXJpc29uID0gKCpfX2NvbXBhcikgKF9fa2V5LCBf
X3ApOwogICAgICBpZiAoX19jb21wYXJpc29uIDwgMCkKIF9fdSA9IF9faWR4OwogICAgICBlbHNl
IGlmIChfX2NvbXBhcmlzb24gPiAwKQogX19sID0gX19pZHggKyAxOwogICAgICBlbHNlCiByZXR1
cm4gKHZvaWQgKikgX19wOwogICAgfQoKICByZXR1cm4gX19udWxsOwp9CiMgNzYwICIvdXNyL2lu
Y2x1ZGUvc3RkbGliLmgiIDIgMyA0CgoKCgpleHRlcm4gdm9pZCBxc29ydCAodm9pZCAqX19iYXNl
LCBzaXplX3QgX19ubWVtYiwgc2l6ZV90IF9fc2l6ZSwKICAgICBfX2NvbXBhcl9mbl90IF9fY29t
cGFyKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDQpKSk7CgpleHRlcm4gdm9pZCBx
c29ydF9yICh2b2lkICpfX2Jhc2UsIHNpemVfdCBfX25tZW1iLCBzaXplX3QgX19zaXplLAogICAg
ICAgX19jb21wYXJfZF9mbl90IF9fY29tcGFyLCB2b2lkICpfX2FyZykKICBfX2F0dHJpYnV0ZV9f
ICgoX19ub25udWxsX18gKDEsIDQpKSk7CgoKCgpleHRlcm4gaW50IGFicyAoaW50IF9feCkgdGhy
b3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fY29uc3RfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5f
dW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBsb25nIGludCBsYWJzIChsb25nIGludCBfX3gpIHRo
cm93ICgpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0X18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJu
X3VudXNlZF9yZXN1bHRfXykpOwoKCgpfX2V4dGVuc2lvbl9fIGV4dGVybiBsb25nIGxvbmcgaW50
IGxsYWJzIChsb25nIGxvbmcgaW50IF9feCkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgo
X19jb25zdF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoK
CgoKCmV4dGVybiBkaXZfdCBkaXYgKGludCBfX251bWVyLCBpbnQgX19kZW5vbSkKICAgICB0aHJv
dyAoKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91
bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIGxkaXZfdCBsZGl2IChsb25nIGludCBfX251bWVyLCBs
b25nIGludCBfX2Rlbm9tKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0X18p
KSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKX19leHRlbnNp
b25fXyBleHRlcm4gbGxkaXZfdCBsbGRpdiAobG9uZyBsb25nIGludCBfX251bWVyLAogICAgICAg
IGxvbmcgbG9uZyBpbnQgX19kZW5vbSkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19j
b25zdF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCiMgODEx
ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDMgNApleHRlcm4gY2hhciAqZWN2dCAoZG91YmxlIF9f
dmFsdWUsIGludCBfX25kaWdpdCwgaW50ICpfX3Jlc3RyaWN0IF9fZGVjcHQsCiAgICAgaW50ICpf
X3Jlc3RyaWN0IF9fc2lnbikgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgz
LCA0KSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRl
cm4gY2hhciAqZmN2dCAoZG91YmxlIF9fdmFsdWUsIGludCBfX25kaWdpdCwgaW50ICpfX3Jlc3Ry
aWN0IF9fZGVjcHQsCiAgICAgaW50ICpfX3Jlc3RyaWN0IF9fc2lnbikgdGhyb3cgKCkgX19hdHRy
aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgzLCA0KSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51
c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gY2hhciAqZ2N2dCAoZG91YmxlIF9fdmFsdWUsIGlu
dCBfX25kaWdpdCwgY2hhciAqX19idWYpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9f
bm9ubnVsbF9fICgzKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7
CgoKCgpleHRlcm4gY2hhciAqcWVjdnQgKGxvbmcgZG91YmxlIF9fdmFsdWUsIGludCBfX25kaWdp
dCwKICAgICAgaW50ICpfX3Jlc3RyaWN0IF9fZGVjcHQsIGludCAqX19yZXN0cmljdCBfX3NpZ24p
CiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgzLCA0KSkpIF9fYXR0
cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBjaGFyICpxZmN2dCAo
bG9uZyBkb3VibGUgX192YWx1ZSwgaW50IF9fbmRpZ2l0LAogICAgICBpbnQgKl9fcmVzdHJpY3Qg
X19kZWNwdCwgaW50ICpfX3Jlc3RyaWN0IF9fc2lnbikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0
ZV9fICgoX19ub25udWxsX18gKDMsIDQpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKTsKZXh0ZXJuIGNoYXIgKnFnY3Z0IChsb25nIGRvdWJsZSBfX3ZhbHVlLCBpbnQg
X19uZGlnaXQsIGNoYXIgKl9fYnVmKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMykpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoK
CgoKZXh0ZXJuIGludCBlY3Z0X3IgKGRvdWJsZSBfX3ZhbHVlLCBpbnQgX19uZGlnaXQsIGludCAq
X19yZXN0cmljdCBfX2RlY3B0LAogICAgIGludCAqX19yZXN0cmljdCBfX3NpZ24sIGNoYXIgKl9f
cmVzdHJpY3QgX19idWYsCiAgICAgc2l6ZV90IF9fbGVuKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9f
ICgoX19ub25udWxsX18gKDMsIDQsIDUpKSk7CmV4dGVybiBpbnQgZmN2dF9yIChkb3VibGUgX192
YWx1ZSwgaW50IF9fbmRpZ2l0LCBpbnQgKl9fcmVzdHJpY3QgX19kZWNwdCwKICAgICBpbnQgKl9f
cmVzdHJpY3QgX19zaWduLCBjaGFyICpfX3Jlc3RyaWN0IF9fYnVmLAogICAgIHNpemVfdCBfX2xl
bikgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgzLCA0LCA1KSkpOwoKZXh0
ZXJuIGludCBxZWN2dF9yIChsb25nIGRvdWJsZSBfX3ZhbHVlLCBpbnQgX19uZGlnaXQsCiAgICAg
IGludCAqX19yZXN0cmljdCBfX2RlY3B0LCBpbnQgKl9fcmVzdHJpY3QgX19zaWduLAogICAgICBj
aGFyICpfX3Jlc3RyaWN0IF9fYnVmLCBzaXplX3QgX19sZW4pCiAgICAgdGhyb3cgKCkgX19hdHRy
aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgzLCA0LCA1KSkpOwpleHRlcm4gaW50IHFmY3Z0X3IgKGxv
bmcgZG91YmxlIF9fdmFsdWUsIGludCBfX25kaWdpdCwKICAgICAgaW50ICpfX3Jlc3RyaWN0IF9f
ZGVjcHQsIGludCAqX19yZXN0cmljdCBfX3NpZ24sCiAgICAgIGNoYXIgKl9fcmVzdHJpY3QgX19i
dWYsIHNpemVfdCBfX2xlbikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxs
X18gKDMsIDQsIDUpKSk7CgoKCgoKCmV4dGVybiBpbnQgbWJsZW4gKGNvbnN0IGNoYXIgKl9fcywg
c2l6ZV90IF9fbikgdGhyb3cgKCk7CgoKZXh0ZXJuIGludCBtYnRvd2MgKHdjaGFyX3QgKl9fcmVz
dHJpY3QgX19wd2MsCiAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3MsIHNpemVfdCBfX24p
IHRocm93ICgpOwoKCmV4dGVybiBpbnQgd2N0b21iIChjaGFyICpfX3MsIHdjaGFyX3QgX193Y2hh
cikgdGhyb3cgKCk7CgoKCmV4dGVybiBzaXplX3QgbWJzdG93Y3MgKHdjaGFyX3QgKl9fcmVzdHJp
Y3QgX19wd2NzLAogICBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fbikgdGhy
b3cgKCk7CgpleHRlcm4gc2l6ZV90IHdjc3RvbWJzIChjaGFyICpfX3Jlc3RyaWN0IF9fcywKICAg
Y29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX3B3Y3MsIHNpemVfdCBfX24pCiAgICAgdGhyb3cg
KCk7CgoKCgoKCgoKZXh0ZXJuIGludCBycG1hdGNoIChjb25zdCBjaGFyICpfX3Jlc3BvbnNlKSB0
aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVfXyAo
KF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKIyA4OTggIi91c3IvaW5jbHVkZS9zdGRsaWIuaCIg
MyA0CmV4dGVybiBpbnQgZ2V0c3Vib3B0IChjaGFyICoqX19yZXN0cmljdCBfX29wdGlvbnAsCiAg
ICAgICAgY2hhciAqY29uc3QgKl9fcmVzdHJpY3QgX190b2tlbnMsCiAgICAgICAgY2hhciAqKl9f
cmVzdHJpY3QgX192YWx1ZXApCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs
bF9fICgxLCAyLCAzKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7
CgoKCgoKZXh0ZXJuIHZvaWQgc2V0a2V5IChjb25zdCBjaGFyICpfX2tleSkgdGhyb3cgKCkgX19h
dHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKCgoKZXh0ZXJuIGludCBwb3NpeF9v
cGVucHQgKGludCBfX29mbGFnKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRf
XykpOwoKCgoKCgoKZXh0ZXJuIGludCBncmFudHB0IChpbnQgX19mZCkgdGhyb3cgKCk7CgoKCmV4
dGVybiBpbnQgdW5sb2NrcHQgKGludCBfX2ZkKSB0aHJvdyAoKTsKCgoKCmV4dGVybiBjaGFyICpw
dHNuYW1lIChpbnQgX19mZCkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKTsKCgoKCgoKZXh0ZXJuIGludCBwdHNuYW1lX3IgKGludCBfX2ZkLCBjaGFyICpf
X2J1Ziwgc2l6ZV90IF9fYnVmbGVuKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMikpKTsKCgpleHRlcm4gaW50IGdldHB0ICh2b2lkKTsKCgoKCgoKZXh0ZXJuIGlu
dCBnZXRsb2FkYXZnIChkb3VibGUgX19sb2FkYXZnW10sIGludCBfX25lbGVtKQogICAgIHRocm93
ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgojIDEgIi91c3IvaW5jbHVk
ZS9iaXRzL3N0ZGxpYi1mbG9hdC5oIiAxIDMgNAojIDI0ICIvdXNyL2luY2x1ZGUvYml0cy9zdGRs
aWItZmxvYXQuaCIgMyA0CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lu
bGluZV9fKSkgZG91YmxlCl9fYXR0cmlidXRlX18gKChfX2xlYWZfXykpIGF0b2YgKGNvbnN0IGNo
YXIgKl9fbnB0cikgdGhyb3cgKCkKewogIHJldHVybiBzdHJ0b2QgKF9fbnB0ciwgKGNoYXIgKiop
IF9fbnVsbCk7Cn0KCiMgOTU1ICIvdXNyL2luY2x1ZGUvc3RkbGliLmgiIDIgMyA0CgoKCiMgMSAi
L3Vzci9pbmNsdWRlL2JpdHMvc3RkbGliLmgiIDEgMyA0CiMgMjMgIi91c3IvaW5jbHVkZS9iaXRz
L3N0ZGxpYi5oIiAzIDQKZXh0ZXJuIGNoYXIgKl9fcmVhbHBhdGhfY2hrIChjb25zdCBjaGFyICpf
X3Jlc3RyaWN0IF9fbmFtZSwKICAgICAgICBjaGFyICpfX3Jlc3RyaWN0IF9fcmVzb2x2ZWQsCiAg
ICAgICAgc2l6ZV90IF9fcmVzb2x2ZWRsZW4pIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dh
cm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBjaGFyICpfX3JlYWxwYXRoX2FsaWFzIChjb25z
dCBjaGFyICpfX3Jlc3RyaWN0IF9fbmFtZSwgY2hhciAqX19yZXN0cmljdCBfX3Jlc29sdmVkKSB0
aHJvdyAoKSBfX2FzbV9fICgiIiAicmVhbHBhdGgiKQoKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jl
c3VsdF9fKSk7CmV4dGVybiBjaGFyICpfX3JlYWxwYXRoX2Noa193YXJuIChjb25zdCBjaGFyICpf
X3Jlc3RyaWN0IF9fbmFtZSwgY2hhciAqX19yZXN0cmljdCBfX3Jlc29sdmVkLCBzaXplX3QgX19y
ZXNvbHZlZGxlbikgdGhyb3cgKCkgX19hc21fXyAoIiIgIl9fcmVhbHBhdGhfY2hrIikKCgogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2F0dHJpYnV0ZV9f
ICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpCiAgICAgX19hdHRyaWJ1dGVfXygoX193YXJuaW5n
X18gKCJzZWNvbmQgYXJndW1lbnQgb2YgcmVhbHBhdGggbXVzdCBiZSBlaXRoZXIgTlVMTCBvciBh
dCAiICJsZWFzdCBQQVRIX01BWCBieXRlcyBsb25nIGJ1ZmZlciIpKSkKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAo
KF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVz
ZWRfcmVzdWx0X18pKSBjaGFyICoKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkgcmVhbHBhdGgg
KGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19uYW1lLCBjaGFyICpfX3Jlc3RyaWN0IF9fcmVzb2x2
ZWQpIHRocm93ICgpCnsKICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChfX3Jlc29sdmVkLCAy
ID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICB7CgoKCgogICAgICByZXR1cm4gX19yZWFscGF0aF9j
aGsgKF9fbmFtZSwgX19yZXNvbHZlZCwgX19idWlsdGluX29iamVjdF9zaXplIChfX3Jlc29sdmVk
LCAyID4gMSkpOwogICAgfQoKICByZXR1cm4gX19yZWFscGF0aF9hbGlhcyAoX19uYW1lLCBfX3Jl
c29sdmVkKTsKfQoKCmV4dGVybiBpbnQgX19wdHNuYW1lX3JfY2hrIChpbnQgX19mZCwgY2hhciAq
X19idWYsIHNpemVfdCBfX2J1ZmxlbiwKICAgICAgIHNpemVfdCBfX25yZWFsKSB0aHJvdyAoKSBf
X2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIpKSk7CmV4dGVybiBpbnQgX19wdHNuYW1lX3Jf
YWxpYXMgKGludCBfX2ZkLCBjaGFyICpfX2J1Ziwgc2l6ZV90IF9fYnVmbGVuKSB0aHJvdyAoKSBf
X2FzbV9fICgiIiAicHRzbmFtZV9yIikKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgyKSkpOwpleHRlcm4gaW50IF9fcHRzbmFtZV9yX2Noa193YXJuIChpbnQgX19mZCwgY2hhciAq
X19idWYsIHNpemVfdCBfX2J1Zmxlbiwgc2l6ZV90IF9fbnJlYWwpIHRocm93ICgpIF9fYXNtX18g
KCIiICJfX3B0c25hbWVfcl9jaGsiKQoKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgyKSkpIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgicHRzbmFtZV9yIGNhbGxlZCB3aXRo
IGJ1ZmxlbiBiaWdnZXIgdGhhbiAiICJzaXplIG9mIGJ1ZiIpKSkKICAgICAgICAgICAgICAgICAg
IDsKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmlj
aWFsX18pKSBpbnQKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkgcHRzbmFtZV9yIChpbnQgX19m
ZCwgY2hhciAqX19idWYsIHNpemVfdCBfX2J1ZmxlbikgdGhyb3cgKCkKewogIGlmIChfX2J1aWx0
aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICB7CiAgICAg
IGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fYnVmbGVuKSkKIHJldHVybiBfX3B0c25hbWVf
cl9jaGsgKF9fZmQsIF9fYnVmLCBfX2J1ZmxlbiwgX19idWlsdGluX29iamVjdF9zaXplIChfX2J1
ZiwgMiA+IDEpKTsKICAgICAgaWYgKF9fYnVmbGVuID4gX19idWlsdGluX29iamVjdF9zaXplIChf
X2J1ZiwgMiA+IDEpKQogcmV0dXJuIF9fcHRzbmFtZV9yX2Noa193YXJuIChfX2ZkLCBfX2J1Ziwg
X19idWZsZW4sIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSk7CiAgICB9CiAg
cmV0dXJuIF9fcHRzbmFtZV9yX2FsaWFzIChfX2ZkLCBfX2J1ZiwgX19idWZsZW4pOwp9CgoKZXh0
ZXJuIGludCBfX3djdG9tYl9jaGsgKGNoYXIgKl9fcywgd2NoYXJfdCBfX3djaGFyLCBzaXplX3Qg
X19idWZsZW4pCiAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0
X18pKTsKZXh0ZXJuIGludCBfX3djdG9tYl9hbGlhcyAoY2hhciAqX19zLCB3Y2hhcl90IF9fd2No
YXIpIHRocm93ICgpIF9fYXNtX18gKCIiICJ3Y3RvbWIiKQogICAgICAgICAgICAgIF9fYXR0cmli
dXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgpleHRlcm4gX19pbmxpbmUgX19hdHRy
aWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f
d2Fybl91bnVzZWRfcmVzdWx0X18pKSBpbnQKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkgd2N0
b21iIChjaGFyICpfX3MsIHdjaGFyX3QgX193Y2hhcikgdGhyb3cgKCkKewoKCgoKCgoKICBpZiAo
X19idWlsdGluX29iamVjdF9zaXplIChfX3MsIDIgPiAxKSAhPSAoc2l6ZV90KSAtMSAmJiAxNiA+
IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19zLCAyID4gMSkpCiAgICByZXR1cm4gX193Y3RvbWJf
Y2hrIChfX3MsIF9fd2NoYXIsIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19zLCAyID4gMSkpOwog
IHJldHVybiBfX3djdG9tYl9hbGlhcyAoX19zLCBfX3djaGFyKTsKfQoKCmV4dGVybiBzaXplX3Qg
X19tYnN0b3djc19jaGsgKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19kc3QsCiAgICAgICAgIGNvbnN0
IGNoYXIgKl9fcmVzdHJpY3QgX19zcmMsCiAgICAgICAgIHNpemVfdCBfX2xlbiwgc2l6ZV90IF9f
ZHN0bGVuKSB0aHJvdyAoKTsKZXh0ZXJuIHNpemVfdCBfX21ic3Rvd2NzX2FsaWFzICh3Y2hhcl90
ICpfX3Jlc3RyaWN0IF9fZHN0LCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fc3JjLCBzaXplX3Qg
X19sZW4pIHRocm93ICgpIF9fYXNtX18gKCIiICJtYnN0b3djcyIpCgoKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIDsKZXh0ZXJuIHNpemVfdCBfX21ic3Rvd2NzX2Noa193YXJuICh3
Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZHN0LCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fc3JjLCBz
aXplX3QgX19sZW4sIHNpemVfdCBfX2RzdGxlbikgdGhyb3cgKCkgX19hc21fXyAoIiIgIl9fbWJz
dG93Y3NfY2hrIikKCgoKICAgICBfX2F0dHJpYnV0ZV9fKChfX3dhcm5pbmdfXyAoIm1ic3Rvd2Nz
IGNhbGxlZCB3aXRoIGRzdCBidWZmZXIgc21hbGxlciB0aGFuIGxlbiAiICIqIHNpemVvZiAod2No
YXJfdCkiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIDsKCmV4dGVybiBfX2lubGluZSBfX2F0
dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBzaXplX3QKX19hdHRyaWJ1
dGVfXyAoKF9fbGVhZl9fKSkgbWJzdG93Y3MgKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19kc3QsIGNv
bnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX2xlbikgdGhyb3cgKCkKCnsKICBp
ZiAoX19idWlsdGluX29iamVjdF9zaXplIChfX2RzdCwgMiA+IDEpICE9IChzaXplX3QpIC0xKQog
ICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX2xlbikpCiByZXR1cm4gX19t
YnN0b3djc19jaGsgKF9fZHN0LCBfX3NyYywgX19sZW4sCiAgICAgICAgICBfX2J1aWx0aW5fb2Jq
ZWN0X3NpemUgKF9fZHN0LCAyID4gMSkgLyBzaXplb2YgKHdjaGFyX3QpKTsKCiAgICAgIGlmIChf
X2xlbiA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kc3QsIDIgPiAxKSAvIHNpemVvZiAod2No
YXJfdCkpCiByZXR1cm4gX19tYnN0b3djc19jaGtfd2FybiAoX19kc3QsIF9fc3JjLCBfX2xlbiwK
ICAgICAgICAgX19idWlsdGluX29iamVjdF9zaXplIChfX2RzdCwgMiA+IDEpIC8gc2l6ZW9mICh3
Y2hhcl90KSk7CiAgICB9CiAgcmV0dXJuIF9fbWJzdG93Y3NfYWxpYXMgKF9fZHN0LCBfX3NyYywg
X19sZW4pOwp9CgoKZXh0ZXJuIHNpemVfdCBfX3djc3RvbWJzX2NoayAoY2hhciAqX19yZXN0cmlj
dCBfX2RzdCwKICAgICAgICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX3NyYywKICAgICAg
ICAgc2l6ZV90IF9fbGVuLCBzaXplX3QgX19kc3RsZW4pIHRocm93ICgpOwpleHRlcm4gc2l6ZV90
IF9fd2NzdG9tYnNfYWxpYXMgKGNoYXIgKl9fcmVzdHJpY3QgX19kc3QsIGNvbnN0IHdjaGFyX3Qg
Kl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX2xlbikgdGhyb3cgKCkgX19hc21fXyAoIiIgIndj
c3RvbWJzIikKCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwpleHRlcm4gc2l6
ZV90IF9fd2NzdG9tYnNfY2hrX3dhcm4gKGNoYXIgKl9fcmVzdHJpY3QgX19kc3QsIGNvbnN0IHdj
aGFyX3QgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX2xlbiwgc2l6ZV90IF9fZHN0bGVuKSB0
aHJvdyAoKSBfX2FzbV9fICgiIiAiX193Y3N0b21ic19jaGsiKQoKCgogICAgIF9fYXR0cmlidXRl
X18oKF9fd2FybmluZ19fICgid2NzdG9tYnMgY2FsbGVkIHdpdGggZHN0IGJ1ZmZlciBzbWFsbGVy
IHRoYW4gbGVuIikpKTsKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
ICgoX19hcnRpZmljaWFsX18pKSBzaXplX3QKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkgd2Nz
dG9tYnMgKGNoYXIgKl9fcmVzdHJpY3QgX19kc3QsIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3Qg
X19zcmMsIHNpemVfdCBfX2xlbikgdGhyb3cgKCkKCnsKICBpZiAoX19idWlsdGluX29iamVjdF9z
aXplIChfX2RzdCwgMiA+IDEpICE9IChzaXplX3QpIC0xKQogICAgewogICAgICBpZiAoIV9fYnVp
bHRpbl9jb25zdGFudF9wIChfX2xlbikpCiByZXR1cm4gX193Y3N0b21ic19jaGsgKF9fZHN0LCBf
X3NyYywgX19sZW4sIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kc3QsIDIgPiAxKSk7CiAgICAg
IGlmIChfX2xlbiA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kc3QsIDIgPiAxKSkKIHJldHVy
biBfX3djc3RvbWJzX2Noa193YXJuIChfX2RzdCwgX19zcmMsIF9fbGVuLCBfX2J1aWx0aW5fb2Jq
ZWN0X3NpemUgKF9fZHN0LCAyID4gMSkpOwogICAgfQogIHJldHVybiBfX3djc3RvbWJzX2FsaWFz
IChfX2RzdCwgX19zcmMsIF9fbGVuKTsKfQojIDk1OSAiL3Vzci9pbmNsdWRlL3N0ZGxpYi5oIiAy
IDMgNAojIDk2NyAiL3Vzci9pbmNsdWRlL3N0ZGxpYi5oIiAzIDQKfQojIDc2ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2NzdGRsaWIiIDIgMwojIDExOCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9j
c3RkbGliIiAzCmV4dGVybiAiQysrIgp7Cm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9f
dmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCiAgdXNpbmcgOjpkaXZfdDsKICB1c2luZyA6
OmxkaXZfdDsKCiAgdXNpbmcgOjphYm9ydDsKICB1c2luZyA6OmFiczsKICB1c2luZyA6OmF0ZXhp
dDsKCgogIHVzaW5nIDo6YXRfcXVpY2tfZXhpdDsKCgogIHVzaW5nIDo6YXRvZjsKICB1c2luZyA6
OmF0b2k7CiAgdXNpbmcgOjphdG9sOwogIHVzaW5nIDo6YnNlYXJjaDsKICB1c2luZyA6OmNhbGxv
YzsKICB1c2luZyA6OmRpdjsKICB1c2luZyA6OmV4aXQ7CiAgdXNpbmcgOjpmcmVlOwogIHVzaW5n
IDo6Z2V0ZW52OwogIHVzaW5nIDo6bGFiczsKICB1c2luZyA6OmxkaXY7CiAgdXNpbmcgOjptYWxs
b2M7CgogIHVzaW5nIDo6bWJsZW47CiAgdXNpbmcgOjptYnN0b3djczsKICB1c2luZyA6Om1idG93
YzsKCiAgdXNpbmcgOjpxc29ydDsKCgogIHVzaW5nIDo6cXVpY2tfZXhpdDsKCgogIHVzaW5nIDo6
cmFuZDsKICB1c2luZyA6OnJlYWxsb2M7CiAgdXNpbmcgOjpzcmFuZDsKICB1c2luZyA6OnN0cnRv
ZDsKICB1c2luZyA6OnN0cnRvbDsKICB1c2luZyA6OnN0cnRvdWw7CiAgdXNpbmcgOjpzeXN0ZW07
CgogIHVzaW5nIDo6d2NzdG9tYnM7CiAgdXNpbmcgOjp3Y3RvbWI7CgoKCiAgaW5saW5lIGxvbmcK
ICBhYnMobG9uZyBfX2kpIHsgcmV0dXJuIF9fYnVpbHRpbl9sYWJzKF9faSk7IH0KCiAgaW5saW5l
IGxkaXZfdAogIGRpdihsb25nIF9faSwgbG9uZyBfX2opIHsgcmV0dXJuIGxkaXYoX19pLCBfX2op
OyB9CgoKCiAgaW5saW5lIGxvbmcgbG9uZwogIGFicyhsb25nIGxvbmcgX194KSB7IHJldHVybiBf
X2J1aWx0aW5fbGxhYnMgKF9feCk7IH0KIyAyMDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3N0
ZGxpYiIgMwoKfQojIDIxNSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jc3RkbGliIiAzCm5hbWVz
cGFjZSBfX2dudV9jeHggX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIp
KSkKewoKCgogIHVzaW5nIDo6bGxkaXZfdDsKCgoKCgogIHVzaW5nIDo6X0V4aXQ7CgoKCiAgdXNp
bmcgOjpsbGFiczsKCiAgaW5saW5lIGxsZGl2X3QKICBkaXYobG9uZyBsb25nIF9fbiwgbG9uZyBs
b25nIF9fZCkKICB7IGxsZGl2X3QgX19xOyBfX3EucXVvdCA9IF9fbiAvIF9fZDsgX19xLnJlbSA9
IF9fbiAlIF9fZDsgcmV0dXJuIF9fcTsgfQoKICB1c2luZyA6OmxsZGl2OwojIDI0NyAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9jc3RkbGliIiAzCiAgdXNpbmcgOjphdG9sbDsKICB1c2luZyA6OnN0
cnRvbGw7CiAgdXNpbmcgOjpzdHJ0b3VsbDsKCiAgdXNpbmcgOjpzdHJ0b2Y7CiAgdXNpbmcgOjpz
dHJ0b2xkOwoKCn0KCm5hbWVzcGFjZSBzdGQKewoKICB1c2luZyA6Ol9fZ251X2N4eDo6bGxkaXZf
dDsKCiAgdXNpbmcgOjpfX2dudV9jeHg6Ol9FeGl0OwoKICB1c2luZyA6Ol9fZ251X2N4eDo6bGxh
YnM7CiAgdXNpbmcgOjpfX2dudV9jeHg6OmRpdjsKICB1c2luZyA6Ol9fZ251X2N4eDo6bGxkaXY7
CgogIHVzaW5nIDo6X19nbnVfY3h4OjphdG9sbDsKICB1c2luZyA6Ol9fZ251X2N4eDo6c3RydG9m
OwogIHVzaW5nIDo6X19nbnVfY3h4OjpzdHJ0b2xsOwogIHVzaW5nIDo6X19nbnVfY3h4OjpzdHJ0
b3VsbDsKICB1c2luZyA6Ol9fZ251X2N4eDo6c3RydG9sZDsKfQoKCgp9CiMgNjAgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAyIDMKIyAxICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvYWxnb3JpdGhtZndkLmgiIDEgMwojIDMzICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvYWxnb3JpdGhtZndkLmgiIDMKICAgICAgIAojIDM0ICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvYWxnb3JpdGhtZndkLmgiIDMKIyA0MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL2FsZ29yaXRobWZ3ZC5oIiAzCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9f
dmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKIyAxOTQgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9hbGdvcml0aG1md2QuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlciwgdHlw
ZW5hbWUgX1ByZWRpY2F0ZT4KICAgIGJvb2wKICAgIGFsbF9vZihfSUl0ZXIsIF9JSXRlciwgX1By
ZWRpY2F0ZSk7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlciwgdHlwZW5hbWUgX1ByZWRpY2F0
ZT4KICAgIGJvb2wKICAgIGFueV9vZihfSUl0ZXIsIF9JSXRlciwgX1ByZWRpY2F0ZSk7CgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfRkl0ZXIsIHR5cGVuYW1lIF9UcD4KICAgIGJvb2wKICAgIGJpbmFy
eV9zZWFyY2goX0ZJdGVyLCBfRkl0ZXIsIGNvbnN0IF9UcCYpOwoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfRkl0ZXIsIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBib29sCiAgICBi
aW5hcnlfc2VhcmNoKF9GSXRlciwgX0ZJdGVyLCBjb25zdCBfVHAmLCBfQ29tcGFyZSk7CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9JSXRlciwgdHlwZW5hbWUgX09JdGVyPgogICAgX09JdGVyCiAgICBj
b3B5KF9JSXRlciwgX0lJdGVyLCBfT0l0ZXIpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQkl0ZXIx
LCB0eXBlbmFtZSBfQkl0ZXIyPgogICAgX0JJdGVyMgogICAgY29weV9iYWNrd2FyZChfQkl0ZXIx
LCBfQkl0ZXIxLCBfQkl0ZXIyKTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlciwgdHlwZW5h
bWUgX09JdGVyLCB0eXBlbmFtZSBfUHJlZGljYXRlPgogICAgX09JdGVyCiAgICBjb3B5X2lmKF9J
SXRlciwgX0lJdGVyLCBfT0l0ZXIsIF9QcmVkaWNhdGUpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
SUl0ZXIsIHR5cGVuYW1lIF9TaXplLCB0eXBlbmFtZSBfT0l0ZXI+CiAgICBfT0l0ZXIKICAgIGNv
cHlfbihfSUl0ZXIsIF9TaXplLCBfT0l0ZXIpOwoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZJ
dGVyLCB0eXBlbmFtZSBfVHA+CiAgICBwYWlyPF9GSXRlciwgX0ZJdGVyPgogICAgZXF1YWxfcmFu
Z2UoX0ZJdGVyLCBfRkl0ZXIsIGNvbnN0IF9UcCYpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRkl0
ZXIsIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBwYWlyPF9GSXRlciwgX0ZJ
dGVyPgogICAgZXF1YWxfcmFuZ2UoX0ZJdGVyLCBfRkl0ZXIsIGNvbnN0IF9UcCYsIF9Db21wYXJl
KTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZJdGVyLCB0eXBlbmFtZSBfVHA+CiAgICB2b2lkCiAg
ICBmaWxsKF9GSXRlciwgX0ZJdGVyLCBjb25zdCBfVHAmKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X09JdGVyLCB0eXBlbmFtZSBfU2l6ZSwgdHlwZW5hbWUgX1RwPgogICAgX09JdGVyCiAgICBmaWxs
X24oX09JdGVyLCBfU2l6ZSwgY29uc3QgX1RwJik7CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZJ
dGVyMSwgdHlwZW5hbWUgX0ZJdGVyMj4KICAgIF9GSXRlcjEKICAgIGZpbmRfZW5kKF9GSXRlcjEs
IF9GSXRlcjEsIF9GSXRlcjIsIF9GSXRlcjIpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRkl0ZXIx
LCB0eXBlbmFtZSBfRkl0ZXIyLCB0eXBlbmFtZSBfQmluYXJ5UHJlZGljYXRlPgogICAgX0ZJdGVy
MQogICAgZmluZF9lbmQoX0ZJdGVyMSwgX0ZJdGVyMSwgX0ZJdGVyMiwgX0ZJdGVyMiwgX0JpbmFy
eVByZWRpY2F0ZSk7CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUl0ZXIsIHR5cGVuYW1lIF9Q
cmVkaWNhdGU+CiAgICBfSUl0ZXIKICAgIGZpbmRfaWZfbm90KF9JSXRlciwgX0lJdGVyLCBfUHJl
ZGljYXRlKTsKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUl0ZXIxLCB0eXBlbmFtZSBfSUl0
ZXIyPgogICAgYm9vbAogICAgaW5jbHVkZXMoX0lJdGVyMSwgX0lJdGVyMSwgX0lJdGVyMiwgX0lJ
dGVyMik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlcjEsIHR5cGVuYW1lIF9JSXRlcjIsIHR5
cGVuYW1lIF9Db21wYXJlPgogICAgYm9vbAogICAgaW5jbHVkZXMoX0lJdGVyMSwgX0lJdGVyMSwg
X0lJdGVyMiwgX0lJdGVyMiwgX0NvbXBhcmUpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQkl0ZXI+
CiAgICB2b2lkCiAgICBpbnBsYWNlX21lcmdlKF9CSXRlciwgX0JJdGVyLCBfQkl0ZXIpOwoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfQkl0ZXIsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgdm9pZAogICAg
aW5wbGFjZV9tZXJnZShfQkl0ZXIsIF9CSXRlciwgX0JJdGVyLCBfQ29tcGFyZSk7CgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfUkFJdGVyPgogICAgYm9vbAogICAgaXNfaGVhcChfUkFJdGVyLCBfUkFJ
dGVyKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JBSXRlciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAg
ICBib29sCiAgICBpc19oZWFwKF9SQUl0ZXIsIF9SQUl0ZXIsIF9Db21wYXJlKTsKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1JBSXRlcj4KICAgIF9SQUl0ZXIKICAgIGlzX2hlYXBfdW50aWwoX1JBSXRl
ciwgX1JBSXRlcik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SQUl0ZXIsIHR5cGVuYW1lIF9Db21w
YXJlPgogICAgX1JBSXRlcgogICAgaXNfaGVhcF91bnRpbChfUkFJdGVyLCBfUkFJdGVyLCBfQ29t
cGFyZSk7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlciwgdHlwZW5hbWUgX1ByZWRpY2F0ZT4K
ICAgIGJvb2wKICAgIGlzX3BhcnRpdGlvbmVkKF9JSXRlciwgX0lJdGVyLCBfUHJlZGljYXRlKTsK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZJdGVyMSwgdHlwZW5hbWUgX0ZJdGVyMj4KICAgIGJvb2wK
ICAgIGlzX3Blcm11dGF0aW9uKF9GSXRlcjEsIF9GSXRlcjEsIF9GSXRlcjIpOwoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfRkl0ZXIxLCB0eXBlbmFtZSBfRkl0ZXIyLAogICAgdHlwZW5hbWUgX0JpbmFy
eVByZWRpY2F0ZT4KICAgIGJvb2wKICAgIGlzX3Blcm11dGF0aW9uKF9GSXRlcjEsIF9GSXRlcjEs
IF9GSXRlcjIsIF9CaW5hcnlQcmVkaWNhdGUpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRkl0ZXI+
CiAgICBib29sCiAgICBpc19zb3J0ZWQoX0ZJdGVyLCBfRkl0ZXIpOwoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfRkl0ZXIsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgYm9vbAogICAgaXNfc29ydGVkKF9G
SXRlciwgX0ZJdGVyLCBfQ29tcGFyZSk7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GSXRlcj4KICAg
IF9GSXRlcgogICAgaXNfc29ydGVkX3VudGlsKF9GSXRlciwgX0ZJdGVyKTsKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0ZJdGVyLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIF9GSXRlcgogICAgaXNfc29y
dGVkX3VudGlsKF9GSXRlciwgX0ZJdGVyLCBfQ29tcGFyZSk7CgoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfRkl0ZXIxLCB0eXBlbmFtZSBfRkl0ZXIyPgogICAgdm9pZAogICAgaXRlcl9zd2FwKF9GSXRl
cjEsIF9GSXRlcjIpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRkl0ZXIsIHR5cGVuYW1lIF9UcD4K
ICAgIF9GSXRlcgogICAgbG93ZXJfYm91bmQoX0ZJdGVyLCBfRkl0ZXIsIGNvbnN0IF9UcCYpOwoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRkl0ZXIsIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0NvbXBh
cmU+CiAgICBfRkl0ZXIKICAgIGxvd2VyX2JvdW5kKF9GSXRlciwgX0ZJdGVyLCBjb25zdCBfVHAm
LCBfQ29tcGFyZSk7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SQUl0ZXI+CiAgICB2b2lkCiAgICBt
YWtlX2hlYXAoX1JBSXRlciwgX1JBSXRlcik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SQUl0ZXIs
IHR5cGVuYW1lIF9Db21wYXJlPgogICAgdm9pZAogICAgbWFrZV9oZWFwKF9SQUl0ZXIsIF9SQUl0
ZXIsIF9Db21wYXJlKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAKICAgIGNvbnN0IF9U
cCYKICAgIG1heChjb25zdCBfVHAmLCBjb25zdCBfVHAmKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgCiAgICBjb25zdCBfVHAmCiAgICBtYXgoY29uc3Qg
X1RwJiwgY29uc3QgX1RwJiwgX0NvbXBhcmUpOwoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+
CiAgIAogICAgY29uc3QgX1RwJgogICAgbWluKGNvbnN0IF9UcCYsIGNvbnN0IF9UcCYpOwoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9Db21wYXJlPgogICAKICAgIGNvbnN0IF9U
cCYKICAgIG1pbihjb25zdCBfVHAmLCBjb25zdCBfVHAmLCBfQ29tcGFyZSk7CgoKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgCiAgICBwYWlyPGNvbnN0IF9UcCYsIGNvbnN0IF9UcCY+CiAg
ICBtaW5tYXgoY29uc3QgX1RwJiwgY29uc3QgX1RwJik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cCwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgIAogICAgcGFpcjxjb25zdCBfVHAmLCBjb25zdCBfVHAm
PgogICAgbWlubWF4KGNvbnN0IF9UcCYsIGNvbnN0IF9UcCYsIF9Db21wYXJlKTsKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0ZJdGVyPgogICAKICAgIHBhaXI8X0ZJdGVyLCBfRkl0ZXI+CiAgICBtaW5t
YXhfZWxlbWVudChfRkl0ZXIsIF9GSXRlcik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GSXRlciwg
dHlwZW5hbWUgX0NvbXBhcmU+CiAgIAogICAgcGFpcjxfRkl0ZXIsIF9GSXRlcj4KICAgIG1pbm1h
eF9lbGVtZW50KF9GSXRlciwgX0ZJdGVyLCBfQ29tcGFyZSk7CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcD4KICAgCiAgICBfVHAKICAgIG1pbihpbml0aWFsaXplcl9saXN0PF9UcD4pOwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9Db21wYXJlPgogICAKICAgIF9UcAogICAgbWlu
KGluaXRpYWxpemVyX2xpc3Q8X1RwPiwgX0NvbXBhcmUpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHA+CiAgIAogICAgX1RwCiAgICBtYXgoaW5pdGlhbGl6ZXJfbGlzdDxfVHA+KTsKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgCiAgICBfVHAKICAgIG1heChp
bml0aWFsaXplcl9saXN0PF9UcD4sIF9Db21wYXJlKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Rw
PgogICAKICAgIHBhaXI8X1RwLCBfVHA+CiAgICBtaW5tYXgoaW5pdGlhbGl6ZXJfbGlzdDxfVHA+
KTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgCiAgICBw
YWlyPF9UcCwgX1RwPgogICAgbWlubWF4KGluaXRpYWxpemVyX2xpc3Q8X1RwPiwgX0NvbXBhcmUp
OwoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQkl0ZXI+CiAgICBib29sCiAgICBuZXh0X3Blcm11
dGF0aW9uKF9CSXRlciwgX0JJdGVyKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0JJdGVyLCB0eXBl
bmFtZSBfQ29tcGFyZT4KICAgIGJvb2wKICAgIG5leHRfcGVybXV0YXRpb24oX0JJdGVyLCBfQkl0
ZXIsIF9Db21wYXJlKTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlciwgdHlwZW5hbWUgX1By
ZWRpY2F0ZT4KICAgIGJvb2wKICAgIG5vbmVfb2YoX0lJdGVyLCBfSUl0ZXIsIF9QcmVkaWNhdGUp
OwoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lJdGVyLCB0eXBlbmFtZSBfUkFJdGVyPgogICAg
X1JBSXRlcgogICAgcGFydGlhbF9zb3J0X2NvcHkoX0lJdGVyLCBfSUl0ZXIsIF9SQUl0ZXIsIF9S
QUl0ZXIpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUl0ZXIsIHR5cGVuYW1lIF9SQUl0ZXIsIHR5
cGVuYW1lIF9Db21wYXJlPgogICAgX1JBSXRlcgogICAgcGFydGlhbF9zb3J0X2NvcHkoX0lJdGVy
LCBfSUl0ZXIsIF9SQUl0ZXIsIF9SQUl0ZXIsIF9Db21wYXJlKTsKCgoKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0lJdGVyLCB0eXBlbmFtZSBfT0l0ZXIxLAogICAgdHlwZW5hbWUgX09JdGVyMiwgdHlw
ZW5hbWUgX1ByZWRpY2F0ZT4KICAgIHBhaXI8X09JdGVyMSwgX09JdGVyMj4KICAgIHBhcnRpdGlv
bl9jb3B5KF9JSXRlciwgX0lJdGVyLCBfT0l0ZXIxLCBfT0l0ZXIyLCBfUHJlZGljYXRlKTsKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0ZJdGVyLCB0eXBlbmFtZSBfUHJlZGljYXRlPgogICAgX0ZJdGVy
CiAgICBwYXJ0aXRpb25fcG9pbnQoX0ZJdGVyLCBfRkl0ZXIsIF9QcmVkaWNhdGUpOwoKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1JBSXRlcj4KICAgIHZvaWQKICAgIHBvcF9oZWFwKF9SQUl0ZXIsIF9S
QUl0ZXIpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUkFJdGVyLCB0eXBlbmFtZSBfQ29tcGFyZT4K
ICAgIHZvaWQKICAgIHBvcF9oZWFwKF9SQUl0ZXIsIF9SQUl0ZXIsIF9Db21wYXJlKTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0JJdGVyPgogICAgYm9vbAogICAgcHJldl9wZXJtdXRhdGlvbihfQkl0
ZXIsIF9CSXRlcik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9CSXRlciwgdHlwZW5hbWUgX0NvbXBh
cmU+CiAgICBib29sCiAgICBwcmV2X3Blcm11dGF0aW9uKF9CSXRlciwgX0JJdGVyLCBfQ29tcGFy
ZSk7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SQUl0ZXI+CiAgICB2b2lkCiAgICBwdXNoX2hlYXAo
X1JBSXRlciwgX1JBSXRlcik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SQUl0ZXIsIHR5cGVuYW1l
IF9Db21wYXJlPgogICAgdm9pZAogICAgcHVzaF9oZWFwKF9SQUl0ZXIsIF9SQUl0ZXIsIF9Db21w
YXJlKTsKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRkl0ZXIsIHR5cGVuYW1lIF9UcD4KICAgIF9G
SXRlcgogICAgcmVtb3ZlKF9GSXRlciwgX0ZJdGVyLCBjb25zdCBfVHAmKTsKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0ZJdGVyLCB0eXBlbmFtZSBfUHJlZGljYXRlPgogICAgX0ZJdGVyCiAgICByZW1v
dmVfaWYoX0ZJdGVyLCBfRkl0ZXIsIF9QcmVkaWNhdGUpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
SUl0ZXIsIHR5cGVuYW1lIF9PSXRlciwgdHlwZW5hbWUgX1RwPgogICAgX09JdGVyCiAgICByZW1v
dmVfY29weShfSUl0ZXIsIF9JSXRlciwgX09JdGVyLCBjb25zdCBfVHAmKTsKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0lJdGVyLCB0eXBlbmFtZSBfT0l0ZXIsIHR5cGVuYW1lIF9QcmVkaWNhdGU+CiAg
ICBfT0l0ZXIKICAgIHJlbW92ZV9jb3B5X2lmKF9JSXRlciwgX0lJdGVyLCBfT0l0ZXIsIF9QcmVk
aWNhdGUpOwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlciwgdHlwZW5hbWUgX09JdGVyLCB0
eXBlbmFtZSBfVHA+CiAgICBfT0l0ZXIKICAgIHJlcGxhY2VfY29weShfSUl0ZXIsIF9JSXRlciwg
X09JdGVyLCBjb25zdCBfVHAmLCBjb25zdCBfVHAmKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0
ZXIsIHR5cGVuYW1lIF9PSXRlciwgdHlwZW5hbWUgX1ByZWRpY2F0ZSwgdHlwZW5hbWUgX1RwPgog
ICAgX09JdGVyCiAgICByZXBsYWNlX2NvcHlfaWYoX0l0ZXIsIF9JdGVyLCBfT0l0ZXIsIF9QcmVk
aWNhdGUsIGNvbnN0IF9UcCYpOwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9CSXRlcj4KICAgIHZv
aWQKICAgIHJldmVyc2UoX0JJdGVyLCBfQkl0ZXIpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQkl0
ZXIsIHR5cGVuYW1lIF9PSXRlcj4KICAgIF9PSXRlcgogICAgcmV2ZXJzZV9jb3B5KF9CSXRlciwg
X0JJdGVyLCBfT0l0ZXIpOwoKICBpbmxpbmUgbmFtZXNwYWNlIF9WMgogIHsKICAgIHRlbXBsYXRl
PHR5cGVuYW1lIF9GSXRlcj4KICAgICAgX0ZJdGVyCiAgICAgIHJvdGF0ZShfRkl0ZXIsIF9GSXRl
ciwgX0ZJdGVyKTsKICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GSXRlciwgdHlwZW5hbWUgX09J
dGVyPgogICAgX09JdGVyCiAgICByb3RhdGVfY29weShfRkl0ZXIsIF9GSXRlciwgX0ZJdGVyLCBf
T0l0ZXIpOwojIDU1MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2FsZ29yaXRobWZ3ZC5o
IiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JBSXRlciwgdHlwZW5hbWUgX1VHZW5lcmF0b3I+CiAg
ICB2b2lkCiAgICBzaHVmZmxlKF9SQUl0ZXIsIF9SQUl0ZXIsIF9VR2VuZXJhdG9yJiYpOwoKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1JBSXRlcj4KICAgIHZvaWQKICAgIHNvcnRfaGVhcChfUkFJdGVy
LCBfUkFJdGVyKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JBSXRlciwgdHlwZW5hbWUgX0NvbXBh
cmU+CiAgICB2b2lkCiAgICBzb3J0X2hlYXAoX1JBSXRlciwgX1JBSXRlciwgX0NvbXBhcmUpOwoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQkl0ZXIsIHR5cGVuYW1lIF9QcmVkaWNhdGU+CiAgICBfQkl0
ZXIKICAgIHN0YWJsZV9wYXJ0aXRpb24oX0JJdGVyLCBfQkl0ZXIsIF9QcmVkaWNhdGUpOwojIDU4
MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2FsZ29yaXRobWZ3ZC5oIiAzCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0ZJdGVyMSwgdHlwZW5hbWUgX0ZJdGVyMj4KICAgIF9GSXRlcjIKICAgIHN3
YXBfcmFuZ2VzKF9GSXRlcjEsIF9GSXRlcjEsIF9GSXRlcjIpOwoKCgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9GSXRlcj4KICAgIF9GSXRlcgogICAgdW5pcXVlKF9GSXRlciwgX0ZJdGVyKTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0ZJdGVyLCB0eXBlbmFtZSBfQmluYXJ5UHJlZGljYXRlPgogICAgX0ZJ
dGVyCiAgICB1bmlxdWUoX0ZJdGVyLCBfRkl0ZXIsIF9CaW5hcnlQcmVkaWNhdGUpOwoKCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9GSXRlciwgdHlwZW5hbWUgX1RwPgogICAgX0ZJdGVyCiAgICB1cHBl
cl9ib3VuZChfRkl0ZXIsIF9GSXRlciwgY29uc3QgX1RwJik7CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9GSXRlciwgdHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIF9GSXRlcgogICAg
dXBwZXJfYm91bmQoX0ZJdGVyLCBfRkl0ZXIsIGNvbnN0IF9UcCYsIF9Db21wYXJlKTsKCgoKCgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9GSXRlcj4KICAgIF9GSXRlcgogICAgYWRqYWNlbnRfZmluZChf
Rkl0ZXIsIF9GSXRlcik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GSXRlciwgdHlwZW5hbWUgX0Jp
bmFyeVByZWRpY2F0ZT4KICAgIF9GSXRlcgogICAgYWRqYWNlbnRfZmluZChfRkl0ZXIsIF9GSXRl
ciwgX0JpbmFyeVByZWRpY2F0ZSk7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlciwgdHlwZW5h
bWUgX1RwPgogICAgdHlwZW5hbWUgaXRlcmF0b3JfdHJhaXRzPF9JSXRlcj46OmRpZmZlcmVuY2Vf
dHlwZQogICAgY291bnQoX0lJdGVyLCBfSUl0ZXIsIGNvbnN0IF9UcCYpOwoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfSUl0ZXIsIHR5cGVuYW1lIF9QcmVkaWNhdGU+CiAgICB0eXBlbmFtZSBpdGVyYXRv
cl90cmFpdHM8X0lJdGVyPjo6ZGlmZmVyZW5jZV90eXBlCiAgICBjb3VudF9pZihfSUl0ZXIsIF9J
SXRlciwgX1ByZWRpY2F0ZSk7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlcjEsIHR5cGVuYW1l
IF9JSXRlcjI+CiAgICBib29sCiAgICBlcXVhbChfSUl0ZXIxLCBfSUl0ZXIxLCBfSUl0ZXIyKTsK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lJdGVyMSwgdHlwZW5hbWUgX0lJdGVyMiwgdHlwZW5hbWUg
X0JpbmFyeVByZWRpY2F0ZT4KICAgIGJvb2wKICAgIGVxdWFsKF9JSXRlcjEsIF9JSXRlcjEsIF9J
SXRlcjIsIF9CaW5hcnlQcmVkaWNhdGUpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUl0ZXIsIHR5
cGVuYW1lIF9UcD4KICAgIF9JSXRlcgogICAgZmluZChfSUl0ZXIsIF9JSXRlciwgY29uc3QgX1Rw
Jik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GSXRlcjEsIHR5cGVuYW1lIF9GSXRlcjI+CiAgICBf
Rkl0ZXIxCiAgICBmaW5kX2ZpcnN0X29mKF9GSXRlcjEsIF9GSXRlcjEsIF9GSXRlcjIsIF9GSXRl
cjIpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRkl0ZXIxLCB0eXBlbmFtZSBfRkl0ZXIyLCB0eXBl
bmFtZSBfQmluYXJ5UHJlZGljYXRlPgogICAgX0ZJdGVyMQogICAgZmluZF9maXJzdF9vZihfRkl0
ZXIxLCBfRkl0ZXIxLCBfRkl0ZXIyLCBfRkl0ZXIyLCBfQmluYXJ5UHJlZGljYXRlKTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0lJdGVyLCB0eXBlbmFtZSBfUHJlZGljYXRlPgogICAgX0lJdGVyCiAg
ICBmaW5kX2lmKF9JSXRlciwgX0lJdGVyLCBfUHJlZGljYXRlKTsKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0lJdGVyLCB0eXBlbmFtZSBfRnVuY3Q+CiAgICBfRnVuY3QKICAgIGZvcl9lYWNoKF9JSXRl
ciwgX0lJdGVyLCBfRnVuY3QpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRkl0ZXIsIHR5cGVuYW1l
IF9HZW5lcmF0b3I+CiAgICB2b2lkCiAgICBnZW5lcmF0ZShfRkl0ZXIsIF9GSXRlciwgX0dlbmVy
YXRvcik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9PSXRlciwgdHlwZW5hbWUgX1NpemUsIHR5cGVu
YW1lIF9HZW5lcmF0b3I+CiAgICBfT0l0ZXIKICAgIGdlbmVyYXRlX24oX09JdGVyLCBfU2l6ZSwg
X0dlbmVyYXRvcik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlcjEsIHR5cGVuYW1lIF9JSXRl
cjI+CiAgICBib29sCiAgICBsZXhpY29ncmFwaGljYWxfY29tcGFyZShfSUl0ZXIxLCBfSUl0ZXIx
LCBfSUl0ZXIyLCBfSUl0ZXIyKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lJdGVyMSwgdHlwZW5h
bWUgX0lJdGVyMiwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBib29sCiAgICBsZXhpY29ncmFwaGlj
YWxfY29tcGFyZShfSUl0ZXIxLCBfSUl0ZXIxLCBfSUl0ZXIyLCBfSUl0ZXIyLCBfQ29tcGFyZSk7
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GSXRlcj4KICAgCiAgICBfRkl0ZXIKICAgIG1heF9lbGVt
ZW50KF9GSXRlciwgX0ZJdGVyKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZJdGVyLCB0eXBlbmFt
ZSBfQ29tcGFyZT4KICAgCiAgICBfRkl0ZXIKICAgIG1heF9lbGVtZW50KF9GSXRlciwgX0ZJdGVy
LCBfQ29tcGFyZSk7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlcjEsIHR5cGVuYW1lIF9JSXRl
cjIsIHR5cGVuYW1lIF9PSXRlcj4KICAgIF9PSXRlcgogICAgbWVyZ2UoX0lJdGVyMSwgX0lJdGVy
MSwgX0lJdGVyMiwgX0lJdGVyMiwgX09JdGVyKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lJdGVy
MSwgdHlwZW5hbWUgX0lJdGVyMiwgdHlwZW5hbWUgX09JdGVyLAogICAgdHlwZW5hbWUgX0NvbXBh
cmU+CiAgICBfT0l0ZXIKICAgIG1lcmdlKF9JSXRlcjEsIF9JSXRlcjEsIF9JSXRlcjIsIF9JSXRl
cjIsIF9PSXRlciwgX0NvbXBhcmUpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRkl0ZXI+CiAgIAog
ICAgX0ZJdGVyCiAgICBtaW5fZWxlbWVudChfRkl0ZXIsIF9GSXRlcik7CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9GSXRlciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgIAogICAgX0ZJdGVyCiAgICBtaW5f
ZWxlbWVudChfRkl0ZXIsIF9GSXRlciwgX0NvbXBhcmUpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
SUl0ZXIxLCB0eXBlbmFtZSBfSUl0ZXIyPgogICAgcGFpcjxfSUl0ZXIxLCBfSUl0ZXIyPgogICAg
bWlzbWF0Y2goX0lJdGVyMSwgX0lJdGVyMSwgX0lJdGVyMik7CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9JSXRlcjEsIHR5cGVuYW1lIF9JSXRlcjIsIHR5cGVuYW1lIF9CaW5hcnlQcmVkaWNhdGU+CiAg
ICBwYWlyPF9JSXRlcjEsIF9JSXRlcjI+CiAgICBtaXNtYXRjaChfSUl0ZXIxLCBfSUl0ZXIxLCBf
SUl0ZXIyLCBfQmluYXJ5UHJlZGljYXRlKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JBSXRlcj4K
ICAgIHZvaWQKICAgIG50aF9lbGVtZW50KF9SQUl0ZXIsIF9SQUl0ZXIsIF9SQUl0ZXIpOwoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfUkFJdGVyLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIHZvaWQKICAg
IG50aF9lbGVtZW50KF9SQUl0ZXIsIF9SQUl0ZXIsIF9SQUl0ZXIsIF9Db21wYXJlKTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1JBSXRlcj4KICAgIHZvaWQKICAgIHBhcnRpYWxfc29ydChfUkFJdGVy
LCBfUkFJdGVyLCBfUkFJdGVyKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JBSXRlciwgdHlwZW5h
bWUgX0NvbXBhcmU+CiAgICB2b2lkCiAgICBwYXJ0aWFsX3NvcnQoX1JBSXRlciwgX1JBSXRlciwg
X1JBSXRlciwgX0NvbXBhcmUpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQkl0ZXIsIHR5cGVuYW1l
IF9QcmVkaWNhdGU+CiAgICBfQkl0ZXIKICAgIHBhcnRpdGlvbihfQkl0ZXIsIF9CSXRlciwgX1By
ZWRpY2F0ZSk7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SQUl0ZXI+CiAgICB2b2lkCiAgICByYW5k
b21fc2h1ZmZsZShfUkFJdGVyLCBfUkFJdGVyKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JBSXRl
ciwgdHlwZW5hbWUgX0dlbmVyYXRvcj4KICAgIHZvaWQKICAgIHJhbmRvbV9zaHVmZmxlKF9SQUl0
ZXIsIF9SQUl0ZXIsCgogICAgIF9HZW5lcmF0b3ImJik7CgoKCgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9GSXRlciwgdHlwZW5hbWUgX1RwPgogICAgdm9pZAogICAgcmVwbGFjZShfRkl0ZXIsIF9GSXRl
ciwgY29uc3QgX1RwJiwgY29uc3QgX1RwJik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GSXRlciwg
dHlwZW5hbWUgX1ByZWRpY2F0ZSwgdHlwZW5hbWUgX1RwPgogICAgdm9pZAogICAgcmVwbGFjZV9p
ZihfRkl0ZXIsIF9GSXRlciwgX1ByZWRpY2F0ZSwgY29uc3QgX1RwJik7CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9GSXRlcjEsIHR5cGVuYW1lIF9GSXRlcjI+CiAgICBfRkl0ZXIxCiAgICBzZWFyY2go
X0ZJdGVyMSwgX0ZJdGVyMSwgX0ZJdGVyMiwgX0ZJdGVyMik7CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9GSXRlcjEsIHR5cGVuYW1lIF9GSXRlcjIsIHR5cGVuYW1lIF9CaW5hcnlQcmVkaWNhdGU+CiAg
ICBfRkl0ZXIxCiAgICBzZWFyY2goX0ZJdGVyMSwgX0ZJdGVyMSwgX0ZJdGVyMiwgX0ZJdGVyMiwg
X0JpbmFyeVByZWRpY2F0ZSk7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GSXRlciwgdHlwZW5hbWUg
X1NpemUsIHR5cGVuYW1lIF9UcD4KICAgIF9GSXRlcgogICAgc2VhcmNoX24oX0ZJdGVyLCBfRkl0
ZXIsIF9TaXplLCBjb25zdCBfVHAmKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZJdGVyLCB0eXBl
bmFtZSBfU2l6ZSwgdHlwZW5hbWUgX1RwLAogICAgdHlwZW5hbWUgX0JpbmFyeVByZWRpY2F0ZT4K
ICAgIF9GSXRlcgogICAgc2VhcmNoX24oX0ZJdGVyLCBfRkl0ZXIsIF9TaXplLCBjb25zdCBfVHAm
LCBfQmluYXJ5UHJlZGljYXRlKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lJdGVyMSwgdHlwZW5h
bWUgX0lJdGVyMiwgdHlwZW5hbWUgX09JdGVyPgogICAgX09JdGVyCiAgICBzZXRfZGlmZmVyZW5j
ZShfSUl0ZXIxLCBfSUl0ZXIxLCBfSUl0ZXIyLCBfSUl0ZXIyLCBfT0l0ZXIpOwoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfSUl0ZXIxLCB0eXBlbmFtZSBfSUl0ZXIyLCB0eXBlbmFtZSBfT0l0ZXIsCiAg
ICB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIF9PSXRlcgogICAgc2V0X2RpZmZlcmVuY2UoX0lJdGVy
MSwgX0lJdGVyMSwgX0lJdGVyMiwgX0lJdGVyMiwgX09JdGVyLCBfQ29tcGFyZSk7CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9JSXRlcjEsIHR5cGVuYW1lIF9JSXRlcjIsIHR5cGVuYW1lIF9PSXRlcj4K
ICAgIF9PSXRlcgogICAgc2V0X2ludGVyc2VjdGlvbihfSUl0ZXIxLCBfSUl0ZXIxLCBfSUl0ZXIy
LCBfSUl0ZXIyLCBfT0l0ZXIpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUl0ZXIxLCB0eXBlbmFt
ZSBfSUl0ZXIyLCB0eXBlbmFtZSBfT0l0ZXIsCiAgICB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIF9P
SXRlcgogICAgc2V0X2ludGVyc2VjdGlvbihfSUl0ZXIxLCBfSUl0ZXIxLCBfSUl0ZXIyLCBfSUl0
ZXIyLCBfT0l0ZXIsIF9Db21wYXJlKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lJdGVyMSwgdHlw
ZW5hbWUgX0lJdGVyMiwgdHlwZW5hbWUgX09JdGVyPgogICAgX09JdGVyCiAgICBzZXRfc3ltbWV0
cmljX2RpZmZlcmVuY2UoX0lJdGVyMSwgX0lJdGVyMSwgX0lJdGVyMiwgX0lJdGVyMiwgX09JdGVy
KTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lJdGVyMSwgdHlwZW5hbWUgX0lJdGVyMiwgdHlwZW5h
bWUgX09JdGVyLAogICAgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBfT0l0ZXIKICAgIHNldF9zeW1t
ZXRyaWNfZGlmZmVyZW5jZShfSUl0ZXIxLCBfSUl0ZXIxLCBfSUl0ZXIyLCBfSUl0ZXIyLAogICAg
ICAgIF9PSXRlciwgX0NvbXBhcmUpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUl0ZXIxLCB0eXBl
bmFtZSBfSUl0ZXIyLCB0eXBlbmFtZSBfT0l0ZXI+CiAgICBfT0l0ZXIKICAgIHNldF91bmlvbihf
SUl0ZXIxLCBfSUl0ZXIxLCBfSUl0ZXIyLCBfSUl0ZXIyLCBfT0l0ZXIpOwoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfSUl0ZXIxLCB0eXBlbmFtZSBfSUl0ZXIyLCB0eXBlbmFtZSBfT0l0ZXIsCiAgICB0
eXBlbmFtZSBfQ29tcGFyZT4KICAgIF9PSXRlcgogICAgc2V0X3VuaW9uKF9JSXRlcjEsIF9JSXRl
cjEsIF9JSXRlcjIsIF9JSXRlcjIsIF9PSXRlciwgX0NvbXBhcmUpOwoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfUkFJdGVyPgogICAgdm9pZAogICAgc29ydChfUkFJdGVyLCBfUkFJdGVyKTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1JBSXRlciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICB2b2lkCiAgICBz
b3J0KF9SQUl0ZXIsIF9SQUl0ZXIsIF9Db21wYXJlKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JB
SXRlcj4KICAgIHZvaWQKICAgIHN0YWJsZV9zb3J0KF9SQUl0ZXIsIF9SQUl0ZXIpOwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfUkFJdGVyLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIHZvaWQKICAgIHN0
YWJsZV9zb3J0KF9SQUl0ZXIsIF9SQUl0ZXIsIF9Db21wYXJlKTsKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0lJdGVyLCB0eXBlbmFtZSBfT0l0ZXIsIHR5cGVuYW1lIF9VbmFyeU9wZXJhdGlvbj4KICAg
IF9PSXRlcgogICAgdHJhbnNmb3JtKF9JSXRlciwgX0lJdGVyLCBfT0l0ZXIsIF9VbmFyeU9wZXJh
dGlvbik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JSXRlcjEsIHR5cGVuYW1lIF9JSXRlcjIsIHR5
cGVuYW1lIF9PSXRlciwKICAgIHR5cGVuYW1lIF9CaW5hcnlPcGVyYXRpb24+CiAgICBfT0l0ZXIK
ICAgIHRyYW5zZm9ybShfSUl0ZXIxLCBfSUl0ZXIxLCBfSUl0ZXIyLCBfT0l0ZXIsIF9CaW5hcnlP
cGVyYXRpb24pOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSUl0ZXIsIHR5cGVuYW1lIF9PSXRlcj4K
ICAgIF9PSXRlcgogICAgdW5pcXVlX2NvcHkoX0lJdGVyLCBfSUl0ZXIsIF9PSXRlcik7CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9JSXRlciwgdHlwZW5hbWUgX09JdGVyLCB0eXBlbmFtZSBfQmluYXJ5
UHJlZGljYXRlPgogICAgX09JdGVyCiAgICB1bmlxdWVfY29weShfSUl0ZXIsIF9JSXRlciwgX09J
dGVyLCBfQmluYXJ5UHJlZGljYXRlKTsKCgp9CiMgNjEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfYWxnby5oIiAyIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3Rs
X2hlYXAuaCIgMSAzCiMgNjIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfaGVhcC5o
IiAzCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVs
dCIpKSkKewoKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3Is
IHR5cGVuYW1lIF9EaXN0YW5jZSwKICAgIHR5cGVuYW1lIF9Db21wYXJlPgogICAgX0Rpc3RhbmNl
CiAgICBfX2lzX2hlYXBfdW50aWwoX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fZmlyc3QsIF9EaXN0
YW5jZSBfX24sCiAgICAgIF9Db21wYXJlIF9fY29tcCkKICAgIHsKICAgICAgX0Rpc3RhbmNlIF9f
cGFyZW50ID0gMDsKICAgICAgZm9yIChfRGlzdGFuY2UgX19jaGlsZCA9IDE7IF9fY2hpbGQgPCBf
X247ICsrX19jaGlsZCkKIHsKICAgaWYgKF9fY29tcChfX2ZpcnN0ICsgX19wYXJlbnQsIF9fZmly
c3QgKyBfX2NoaWxkKSkKICAgICByZXR1cm4gX19jaGlsZDsKICAgaWYgKChfX2NoaWxkICYgMSkg
PT0gMCkKICAgICArK19fcGFyZW50OwogfQogICAgICByZXR1cm4gX19uOwogICAgfQoKCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVyYXRvciwgdHlwZW5hbWUgX0Rpc3RhbmNl
PgogICAgaW5saW5lIGJvb2wKICAgIF9faXNfaGVhcChfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19m
aXJzdCwgX0Rpc3RhbmNlIF9fbikKICAgIHsKICAgICAgcmV0dXJuIHN0ZDo6X19pc19oZWFwX3Vu
dGlsKF9fZmlyc3QsIF9fbiwKICAgX19nbnVfY3h4OjpfX29wczo6X19pdGVyX2xlc3NfaXRlcigp
KSA9PSBfX247CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVyYXRv
ciwgdHlwZW5hbWUgX0NvbXBhcmUsCiAgICB0eXBlbmFtZSBfRGlzdGFuY2U+CiAgICBpbmxpbmUg
Ym9vbAogICAgX19pc19oZWFwKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0LCBfQ29tcGFy
ZSBfX2NvbXAsIF9EaXN0YW5jZSBfX24pCiAgICB7CiAgICAgIHJldHVybiBzdGQ6Ol9faXNfaGVh
cF91bnRpbChfX2ZpcnN0LCBfX24sCiBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfY29tcF9pdGVy
KF9fY29tcCkpID09IF9fbjsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFjY2Vz
c0l0ZXJhdG9yPgogICAgaW5saW5lIGJvb2wKICAgIF9faXNfaGVhcChfUmFuZG9tQWNjZXNzSXRl
cmF0b3IgX19maXJzdCwgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fbGFzdCkKICAgIHsgcmV0dXJu
IHN0ZDo6X19pc19oZWFwKF9fZmlyc3QsIHN0ZDo6ZGlzdGFuY2UoX19maXJzdCwgX19sYXN0KSk7
IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBf
Q29tcGFyZT4KICAgIGlubGluZSBib29sCiAgICBfX2lzX2hlYXAoX1JhbmRvbUFjY2Vzc0l0ZXJh
dG9yIF9fZmlyc3QsIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QsCiAgICAgICBfQ29tcGFy
ZSBfX2NvbXApCiAgICB7IHJldHVybiBzdGQ6Ol9faXNfaGVhcChfX2ZpcnN0LCBfX2NvbXAsIHN0
ZDo6ZGlzdGFuY2UoX19maXJzdCwgX19sYXN0KSk7IH0KCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1JhbmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBfRGlzdGFuY2UsIHR5cGVuYW1lIF9UcCwK
ICAgIHR5cGVuYW1lIF9Db21wYXJlPgogICAgdm9pZAogICAgX19wdXNoX2hlYXAoX1JhbmRvbUFj
Y2Vzc0l0ZXJhdG9yIF9fZmlyc3QsCiAgX0Rpc3RhbmNlIF9faG9sZUluZGV4LCBfRGlzdGFuY2Ug
X190b3BJbmRleCwgX1RwIF9fdmFsdWUsCiAgX0NvbXBhcmUgX19jb21wKQogICAgewogICAgICBf
RGlzdGFuY2UgX19wYXJlbnQgPSAoX19ob2xlSW5kZXggLSAxKSAvIDI7CiAgICAgIHdoaWxlIChf
X2hvbGVJbmRleCA+IF9fdG9wSW5kZXggJiYgX19jb21wKF9fZmlyc3QgKyBfX3BhcmVudCwgX192
YWx1ZSkpCiB7CiAgICooX19maXJzdCArIF9faG9sZUluZGV4KSA9IHN0ZDo6bW92ZSgqKF9fZmly
c3QgKyBfX3BhcmVudCkpOwogICBfX2hvbGVJbmRleCA9IF9fcGFyZW50OwogICBfX3BhcmVudCA9
IChfX2hvbGVJbmRleCAtIDEpIC8gMjsKIH0KICAgICAgKihfX2ZpcnN0ICsgX19ob2xlSW5kZXgp
ID0gc3RkOjptb3ZlKF9fdmFsdWUpOwogICAgfQojIDE0OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL3N0bF9oZWFwLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRl
cmF0b3I+CiAgICBpbmxpbmUgdm9pZAogICAgcHVzaF9oZWFwKF9SYW5kb21BY2Nlc3NJdGVyYXRv
ciBfX2ZpcnN0LCBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0KQogICAgewogICAgICB0eXBl
ZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfUmFuZG9tQWNjZXNzSXRlcmF0b3I+Ojp2YWx1
ZV90eXBlCiAgIF9WYWx1ZVR5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgaXRlcmF0b3JfdHJh
aXRzPF9SYW5kb21BY2Nlc3NJdGVyYXRvcj46OmRpZmZlcmVuY2VfdHlwZQogICBfRGlzdGFuY2VU
eXBlOwoKCiAgICAgCgogICAgIAogICAgICA7CiAgICAgIDsKICAgICAgOwoKICAgICAgX1ZhbHVl
VHlwZSBfX3ZhbHVlID0gc3RkOjptb3ZlKCooX19sYXN0IC0gMSkpOwogICAgICBzdGQ6Ol9fcHVz
aF9oZWFwKF9fZmlyc3QsIF9EaXN0YW5jZVR5cGUoKF9fbGFzdCAtIF9fZmlyc3QpIC0gMSksCiAg
ICAgICAgIF9EaXN0YW5jZVR5cGUoMCksIHN0ZDo6bW92ZShfX3ZhbHVlKSwKICAgICAgICAgX19n
bnVfY3h4OjpfX29wczo6X19pdGVyX2xlc3NfdmFsKCkpOwogICAgfQojIDE4MyAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9oZWFwLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFu
ZG9tQWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgaW5saW5lIHZvaWQKICAg
IHB1c2hfaGVhcChfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19maXJzdCwgX1JhbmRvbUFjY2Vzc0l0
ZXJhdG9yIF9fbGFzdCwKICAgICAgIF9Db21wYXJlIF9fY29tcCkKICAgIHsKICAgICAgdHlwZWRl
ZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X1JhbmRvbUFjY2Vzc0l0ZXJhdG9yPjo6dmFsdWVf
dHlwZQogICBfVmFsdWVUeXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0
czxfUmFuZG9tQWNjZXNzSXRlcmF0b3I+OjpkaWZmZXJlbmNlX3R5cGUKICAgX0Rpc3RhbmNlVHlw
ZTsKCgogICAgIAoKICAgICAgOwogICAgICA7CiAgICAgIDsKCiAgICAgIF9WYWx1ZVR5cGUgX192
YWx1ZSA9IHN0ZDo6bW92ZSgqKF9fbGFzdCAtIDEpKTsKICAgICAgc3RkOjpfX3B1c2hfaGVhcChf
X2ZpcnN0LCBfRGlzdGFuY2VUeXBlKChfX2xhc3QgLSBfX2ZpcnN0KSAtIDEpLAogICAgICAgICBf
RGlzdGFuY2VUeXBlKDApLCBzdGQ6Om1vdmUoX192YWx1ZSksCiAgICAgICAgIF9fZ251X2N4eDo6
X19vcHM6Ol9faXRlcl9jb21wX3ZhbChfX2NvbXApKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBfRGlzdGFuY2UsCiAgICB0eXBlbmFt
ZSBfVHAsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgdm9pZAogICAgX19hZGp1c3RfaGVhcChfUmFu
ZG9tQWNjZXNzSXRlcmF0b3IgX19maXJzdCwgX0Rpc3RhbmNlIF9faG9sZUluZGV4LAogICAgX0Rp
c3RhbmNlIF9fbGVuLCBfVHAgX192YWx1ZSwgX0NvbXBhcmUgX19jb21wKQogICAgewogICAgICBj
b25zdCBfRGlzdGFuY2UgX190b3BJbmRleCA9IF9faG9sZUluZGV4OwogICAgICBfRGlzdGFuY2Ug
X19zZWNvbmRDaGlsZCA9IF9faG9sZUluZGV4OwogICAgICB3aGlsZSAoX19zZWNvbmRDaGlsZCA8
IChfX2xlbiAtIDEpIC8gMikKIHsKICAgX19zZWNvbmRDaGlsZCA9IDIgKiAoX19zZWNvbmRDaGls
ZCArIDEpOwogICBpZiAoX19jb21wKF9fZmlyc3QgKyBfX3NlY29uZENoaWxkLAogICAgICAgX19m
aXJzdCArIChfX3NlY29uZENoaWxkIC0gMSkpKQogICAgIF9fc2Vjb25kQ2hpbGQtLTsKICAgKihf
X2ZpcnN0ICsgX19ob2xlSW5kZXgpID0gc3RkOjptb3ZlKCooX19maXJzdCArIF9fc2Vjb25kQ2hp
bGQpKTsKICAgX19ob2xlSW5kZXggPSBfX3NlY29uZENoaWxkOwogfQogICAgICBpZiAoKF9fbGVu
ICYgMSkgPT0gMCAmJiBfX3NlY29uZENoaWxkID09IChfX2xlbiAtIDIpIC8gMikKIHsKICAgX19z
ZWNvbmRDaGlsZCA9IDIgKiAoX19zZWNvbmRDaGlsZCArIDEpOwogICAqKF9fZmlyc3QgKyBfX2hv
bGVJbmRleCkgPSBzdGQ6Om1vdmUoKihfX2ZpcnN0ICsgKF9fc2Vjb25kQ2hpbGQgLSAxKSkpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CiAgIF9faG9sZUluZGV4ID0gX19zZWNv
bmRDaGlsZCAtIDE7CiB9CiAgICAgIHN0ZDo6X19wdXNoX2hlYXAoX19maXJzdCwgX19ob2xlSW5k
ZXgsIF9fdG9wSW5kZXgsCiAgICAgICAgIHN0ZDo6bW92ZShfX3ZhbHVlKSwKICAgICAgICAgX19n
bnVfY3h4OjpfX29wczo6X19pdGVyX2NvbXBfdmFsKF9fY29tcCkpOwogICAgfQoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAg
aW5saW5lIHZvaWQKICAgIF9fcG9wX2hlYXAoX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fZmlyc3Qs
IF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QsCiAgICAgICAgX1JhbmRvbUFjY2Vzc0l0ZXJh
dG9yIF9fcmVzdWx0LCBfQ29tcGFyZSBfX2NvbXApCiAgICB7CiAgICAgIHR5cGVkZWYgdHlwZW5h
bWUgaXRlcmF0b3JfdHJhaXRzPF9SYW5kb21BY2Nlc3NJdGVyYXRvcj46OnZhbHVlX3R5cGUKIF9W
YWx1ZVR5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgaXRlcmF0b3JfdHJhaXRzPF9SYW5kb21B
Y2Nlc3NJdGVyYXRvcj46OmRpZmZlcmVuY2VfdHlwZQogX0Rpc3RhbmNlVHlwZTsKCiAgICAgIF9W
YWx1ZVR5cGUgX192YWx1ZSA9IHN0ZDo6bW92ZSgqX19yZXN1bHQpOwogICAgICAqX19yZXN1bHQg
PSBzdGQ6Om1vdmUoKl9fZmlyc3QpOwogICAgICBzdGQ6Ol9fYWRqdXN0X2hlYXAoX19maXJzdCwg
X0Rpc3RhbmNlVHlwZSgwKSwKICAgIF9EaXN0YW5jZVR5cGUoX19sYXN0IC0gX19maXJzdCksCiAg
ICBzdGQ6Om1vdmUoX192YWx1ZSksIF9fY29tcCk7CiAgICB9CiMgMjYzICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RsX2hlYXAuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9SYW5kb21B
Y2Nlc3NJdGVyYXRvcj4KICAgIGlubGluZSB2b2lkCiAgICBwb3BfaGVhcChfUmFuZG9tQWNjZXNz
SXRlcmF0b3IgX19maXJzdCwgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fbGFzdCkKICAgIHsKCiAg
ICAgCgogICAgIAoKICAgICAgOwogICAgICA7CiAgICAgIDsKICAgICAgOwoKICAgICAgaWYgKF9f
bGFzdCAtIF9fZmlyc3QgPiAxKQogewogICAtLV9fbGFzdDsKICAgc3RkOjpfX3BvcF9oZWFwKF9f
Zmlyc3QsIF9fbGFzdCwgX19sYXN0LAogICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNz
X2l0ZXIoKSk7CiB9CiAgICB9CiMgMjk2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3Rs
X2hlYXAuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVyYXRvciwgdHlw
ZW5hbWUgX0NvbXBhcmU+CiAgICBpbmxpbmUgdm9pZAogICAgcG9wX2hlYXAoX1JhbmRvbUFjY2Vz
c0l0ZXJhdG9yIF9fZmlyc3QsCiAgICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QsIF9D
b21wYXJlIF9fY29tcCkKICAgIHsKCiAgICAgCgogICAgICA7CiAgICAgIDsKICAgICAgOwogICAg
ICA7CgogICAgICBpZiAoX19sYXN0IC0gX19maXJzdCA+IDEpCiB7CiAgIC0tX19sYXN0OwogICBz
dGQ6Ol9fcG9wX2hlYXAoX19maXJzdCwgX19sYXN0LCBfX2xhc3QsCiAgICAgX19nbnVfY3h4Ojpf
X29wczo6X19pdGVyX2NvbXBfaXRlcihfX2NvbXApKTsKIH0KICAgIH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIHZvaWQK
ICAgIF9fbWFrZV9oZWFwKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0LCBfUmFuZG9tQWNj
ZXNzSXRlcmF0b3IgX19sYXN0LAogIF9Db21wYXJlIF9fY29tcCkKICAgIHsKICAgICAgdHlwZWRl
ZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X1JhbmRvbUFjY2Vzc0l0ZXJhdG9yPjo6dmFsdWVf
dHlwZQogICBfVmFsdWVUeXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0
czxfUmFuZG9tQWNjZXNzSXRlcmF0b3I+OjpkaWZmZXJlbmNlX3R5cGUKICAgX0Rpc3RhbmNlVHlw
ZTsKCiAgICAgIGlmIChfX2xhc3QgLSBfX2ZpcnN0IDwgMikKIHJldHVybjsKCiAgICAgIGNvbnN0
IF9EaXN0YW5jZVR5cGUgX19sZW4gPSBfX2xhc3QgLSBfX2ZpcnN0OwogICAgICBfRGlzdGFuY2VU
eXBlIF9fcGFyZW50ID0gKF9fbGVuIC0gMikgLyAyOwogICAgICB3aGlsZSAodHJ1ZSkKIHsKICAg
X1ZhbHVlVHlwZSBfX3ZhbHVlID0gc3RkOjptb3ZlKCooX19maXJzdCArIF9fcGFyZW50KSk7CiAg
IHN0ZDo6X19hZGp1c3RfaGVhcChfX2ZpcnN0LCBfX3BhcmVudCwgX19sZW4sIHN0ZDo6bW92ZShf
X3ZhbHVlKSwKICAgICAgICBfX2NvbXApOwogICBpZiAoX19wYXJlbnQgPT0gMCkKICAgICByZXR1
cm47CiAgIF9fcGFyZW50LS07CiB9CiAgICB9CiMgMzUxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvc3RsX2hlYXAuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVy
YXRvcj4KICAgIGlubGluZSB2b2lkCiAgICBtYWtlX2hlYXAoX1JhbmRvbUFjY2Vzc0l0ZXJhdG9y
IF9fZmlyc3QsIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QpCiAgICB7CgogICAgIAoKICAg
ICAKCiAgICAgIDsKICAgICAgOwoKICAgICAgc3RkOjpfX21ha2VfaGVhcChfX2ZpcnN0LCBfX2xh
c3QsCiAgICAgICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNzX2l0ZXIoKSk7CiAgICB9
CiMgMzc3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2hlYXAuaCIgMwogIHRlbXBs
YXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVyYXRvciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAg
ICBpbmxpbmUgdm9pZAogICAgbWFrZV9oZWFwKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0
LCBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0LAogICAgICAgX0NvbXBhcmUgX19jb21wKQog
ICAgewoKICAgICAKCiAgICAgIDsKICAgICAgOwoKICAgICAgc3RkOjpfX21ha2VfaGVhcChfX2Zp
cnN0LCBfX2xhc3QsCiAgICAgICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9jb21wX2l0ZXIo
X19jb21wKSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVyYXRv
ciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICB2b2lkCiAgICBfX3NvcnRfaGVhcChfUmFuZG9tQWNj
ZXNzSXRlcmF0b3IgX19maXJzdCwgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fbGFzdCwKICBfQ29t
cGFyZSBfX2NvbXApCiAgICB7CiAgICAgIHdoaWxlIChfX2xhc3QgLSBfX2ZpcnN0ID4gMSkKIHsK
ICAgLS1fX2xhc3Q7CiAgIHN0ZDo6X19wb3BfaGVhcChfX2ZpcnN0LCBfX2xhc3QsIF9fbGFzdCwg
X19jb21wKTsKIH0KICAgIH0KIyA0MTIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxf
aGVhcC5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yPgogICAg
aW5saW5lIHZvaWQKICAgIHNvcnRfaGVhcChfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19maXJzdCwg
X1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fbGFzdCkKICAgIHsKCiAgICAgCgogICAgIAoKICAgICAg
OwogICAgICA7CiAgICAgIDsKCiAgICAgIHN0ZDo6X19zb3J0X2hlYXAoX19maXJzdCwgX19sYXN0
LAogICAgICAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfbGVzc19pdGVyKCkpOwogICAgfQoj
IDQzOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9oZWFwLmgiIDMKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAg
aW5saW5lIHZvaWQKICAgIHNvcnRfaGVhcChfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19maXJzdCwg
X1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fbGFzdCwKICAgICAgIF9Db21wYXJlIF9fY29tcCkKICAg
IHsKCiAgICAgCgogICAgICA7CiAgICAgIDsKICAgICAgOwoKICAgICAgc3RkOjpfX3NvcnRfaGVh
cChfX2ZpcnN0LCBfX2xhc3QsCiAgICAgICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9jb21w
X2l0ZXIoX19jb21wKSk7CiAgICB9CiMgNDY2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
c3RsX2hlYXAuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVyYXRvcj4K
ICAgIGlubGluZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IKICAgIGlzX2hlYXBfdW50aWwoX1JhbmRv
bUFjY2Vzc0l0ZXJhdG9yIF9fZmlyc3QsIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QpCiAg
ICB7CgogICAgIAoKICAgICAKCiAgICAgIDsKICAgICAgOwoKICAgICAgcmV0dXJuIF9fZmlyc3Qg
Kwogc3RkOjpfX2lzX2hlYXBfdW50aWwoX19maXJzdCwgc3RkOjpkaXN0YW5jZShfX2ZpcnN0LCBf
X2xhc3QpLAogICAgICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNzX2l0ZXIoKSk7CiAg
ICB9CiMgNDk0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2hlYXAuaCIgMwogIHRl
bXBsYXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVyYXRvciwgdHlwZW5hbWUgX0NvbXBhcmU+
CiAgICBpbmxpbmUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yCiAgICBpc19oZWFwX3VudGlsKF9SYW5k
b21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0LCBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0LAog
ICAgX0NvbXBhcmUgX19jb21wKQogICAgewoKICAgICAKCiAgICAgIDsKICAgICAgOwoKICAgICAg
cmV0dXJuIF9fZmlyc3QKICsgc3RkOjpfX2lzX2hlYXBfdW50aWwoX19maXJzdCwgc3RkOjpkaXN0
YW5jZShfX2ZpcnN0LCBfX2xhc3QpLAogICAgICAgICAgX19nbnVfY3h4OjpfX29wczo6X19pdGVy
X2NvbXBfaXRlcihfX2NvbXApKTsKICAgIH0KIyA1MTcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfaGVhcC5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJh
dG9yPgogICAgaW5saW5lIGJvb2wKICAgIGlzX2hlYXAoX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9f
Zmlyc3QsIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QpCiAgICB7IHJldHVybiBzdGQ6Omlz
X2hlYXBfdW50aWwoX19maXJzdCwgX19sYXN0KSA9PSBfX2xhc3Q7IH0KIyA1MzAgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfaGVhcC5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Jh
bmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIGlubGluZSBib29sCiAg
ICBpc19oZWFwKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0LCBfUmFuZG9tQWNjZXNzSXRl
cmF0b3IgX19sYXN0LAogICAgIF9Db21wYXJlIF9fY29tcCkKICAgIHsgcmV0dXJuIHN0ZDo6aXNf
aGVhcF91bnRpbChfX2ZpcnN0LCBfX2xhc3QsIF9fY29tcCkgPT0gX19sYXN0OyB9CgoKCn0KIyA2
MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDIgMwojIDEgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfdGVtcGJ1Zi5oIiAxIDMKIyA2MCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF90ZW1wYnVmLmgiIDMKIyAxICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvc3RsX2NvbnN0cnVjdC5oIiAxIDMKIyA2MyAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3N0bF9jb25zdHJ1Y3QuaCIgMwpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18g
KChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgoKCgoKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1QxLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgIGlubGluZSB2b2lkCiAgICBfQ29uc3RydWN0
KF9UMSogX19wLCBfQXJncyYmLi4uIF9fYXJncykKICAgIHsgOjpuZXcoc3RhdGljX2Nhc3Q8dm9p
ZCo+KF9fcCkpIF9UMShzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pOyB9CiMgOTAgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfY29uc3RydWN0LmgiIDMKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgdm9pZAogICAgX0Rlc3Ryb3koX1RwKiBfX3BvaW50ZXIp
CiAgICB7IF9fcG9pbnRlci0+fl9UcCgpOyB9CgogIHRlbXBsYXRlPGJvb2w+CiAgICBzdHJ1Y3Qg
X0Rlc3Ryb3lfYXV4CiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0
b3I+CiAgICAgICAgc3RhdGljIHZvaWQKICAgICAgICBfX2Rlc3Ryb3koX0ZvcndhcmRJdGVyYXRv
ciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCkKIHsKICAgZm9yICg7IF9fZmlyc3Qg
IT0gX19sYXN0OyArK19fZmlyc3QpCiAgICAgc3RkOjpfRGVzdHJveShzdGQ6Ol9fYWRkcmVzc29m
KCpfX2ZpcnN0KSk7CiB9CiAgICB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX0Rlc3Ryb3lf
YXV4PHRydWU+CiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3I+
CiAgICAgICAgc3RhdGljIHZvaWQKICAgICAgICBfX2Rlc3Ryb3koX0ZvcndhcmRJdGVyYXRvciwg
X0ZvcndhcmRJdGVyYXRvcikgeyB9CiAgICB9OwoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9G
b3J3YXJkSXRlcmF0b3I+CiAgICBpbmxpbmUgdm9pZAogICAgX0Rlc3Ryb3koX0ZvcndhcmRJdGVy
YXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCkKICAgIHsKICAgICAgdHlwZWRl
ZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0ZvcndhcmRJdGVyYXRvcj46OnZhbHVlX3R5cGUK
ICAgICAgICAgICAgICAgICAgICAgICBfVmFsdWVfdHlwZTsKICAgICAgc3RkOjpfRGVzdHJveV9h
dXg8X19oYXNfdHJpdmlhbF9kZXN0cnVjdG9yKF9WYWx1ZV90eXBlKT46OgogX19kZXN0cm95KF9f
Zmlyc3QsIF9fbGFzdCk7CiAgICB9CgoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJk
SXRlcmF0b3IsIHR5cGVuYW1lIF9BbGxvY2F0b3I+CiAgICB2b2lkCiAgICBfRGVzdHJveShfRm9y
d2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0LAogICAgICBfQWxs
b2NhdG9yJiBfX2FsbG9jKQogICAgewogICAgICB0eXBlZGVmIF9fZ251X2N4eDo6X19hbGxvY190
cmFpdHM8X0FsbG9jYXRvcj4gX190cmFpdHM7CiAgICAgIGZvciAoOyBfX2ZpcnN0ICE9IF9fbGFz
dDsgKytfX2ZpcnN0KQogX190cmFpdHM6OmRlc3Ryb3koX19hbGxvYywgc3RkOjpfX2FkZHJlc3Nv
ZigqX19maXJzdCkpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9y
LCB0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgdm9pZAogICAgX0Rlc3Ryb3koX0ZvcndhcmRJdGVy
YXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgYWxsb2NhdG9yPF9U
cD4mKQogICAgewogICAgICBfRGVzdHJveShfX2ZpcnN0LCBfX2xhc3QpOwogICAgfQoKCn0KIyA2
MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF90ZW1wYnVmLmgiIDIgMwoKbmFtZXNw
YWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7Cgoj
IDgzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3RlbXBidWYuaCIgMwogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgIHBhaXI8X1RwKiwgcHRyZGlmZl90PgogICAgZ2V0X3RlbXBv
cmFyeV9idWZmZXIocHRyZGlmZl90IF9fbGVuKSBub2V4Y2VwdAogICAgewogICAgICBjb25zdCBw
dHJkaWZmX3QgX19tYXggPQogX19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPHB0cmRpZmZfdD46
Ol9fbWF4IC8gc2l6ZW9mKF9UcCk7CiAgICAgIGlmIChfX2xlbiA+IF9fbWF4KQogX19sZW4gPSBf
X21heDsKCiAgICAgIHdoaWxlIChfX2xlbiA+IDApCiB7CiAgIF9UcCogX190bXAgPSBzdGF0aWNf
Y2FzdDxfVHAqPig6Om9wZXJhdG9yIG5ldyhfX2xlbiAqIHNpemVvZihfVHApLAogICAgICAgc3Rk
Ojpub3Rocm93KSk7CiAgIGlmIChfX3RtcCAhPSAwKQogICAgIHJldHVybiBzdGQ6OnBhaXI8X1Rw
KiwgcHRyZGlmZl90PihfX3RtcCwgX19sZW4pOwogICBfX2xlbiAvPSAyOwogfQogICAgICByZXR1
cm4gc3RkOjpwYWlyPF9UcCosIHB0cmRpZmZfdD4oc3RhdGljX2Nhc3Q8X1RwKj4oMCksIDApOwog
ICAgfQojIDExMCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF90ZW1wYnVmLmgiIDMK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgdm9pZAogICAgcmV0dXJuX3RlbXBv
cmFyeV9idWZmZXIoX1RwKiBfX3ApCiAgICB7IDo6b3BlcmF0b3IgZGVsZXRlKF9fcCwgc3RkOjpu
b3Rocm93KTsgfQoKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0
eXBlbmFtZSBfVHA+CiAgICBjbGFzcyBfVGVtcG9yYXJ5X2J1ZmZlcgogICAgewoKICAgICAKCiAg
ICBwdWJsaWM6CiAgICAgIHR5cGVkZWYgX1RwIHZhbHVlX3R5cGU7CiAgICAgIHR5cGVkZWYgdmFs
dWVfdHlwZSogcG9pbnRlcjsKICAgICAgdHlwZWRlZiBwb2ludGVyIGl0ZXJhdG9yOwogICAgICB0
eXBlZGVmIHB0cmRpZmZfdCBzaXplX3R5cGU7CgogICAgcHJvdGVjdGVkOgogICAgICBzaXplX3R5
cGUgX01fb3JpZ2luYWxfbGVuOwogICAgICBzaXplX3R5cGUgX01fbGVuOwogICAgICBwb2ludGVy
IF9NX2J1ZmZlcjsKCiAgICBwdWJsaWM6CgogICAgICBzaXplX3R5cGUKICAgICAgc2l6ZSgpIGNv
bnN0CiAgICAgIHsgcmV0dXJuIF9NX2xlbjsgfQoKCiAgICAgIHNpemVfdHlwZQogICAgICByZXF1
ZXN0ZWRfc2l6ZSgpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX29yaWdpbmFsX2xlbjsgfQoKCiAg
ICAgIGl0ZXJhdG9yCiAgICAgIGJlZ2luKCkKICAgICAgeyByZXR1cm4gX01fYnVmZmVyOyB9CgoK
ICAgICAgaXRlcmF0b3IKICAgICAgZW5kKCkKICAgICAgeyByZXR1cm4gX01fYnVmZmVyICsgX01f
bGVuOyB9CgoKCgoKICAgICAgX1RlbXBvcmFyeV9idWZmZXIoX0ZvcndhcmRJdGVyYXRvciBfX2Zp
cnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCk7CgogICAgICB+X1RlbXBvcmFyeV9idWZmZXIo
KQogICAgICB7CiBzdGQ6Ol9EZXN0cm95KF9NX2J1ZmZlciwgX01fYnVmZmVyICsgX01fbGVuKTsK
IHN0ZDo6cmV0dXJuX3RlbXBvcmFyeV9idWZmZXIoX01fYnVmZmVyKTsKICAgICAgfQoKICAgIHBy
aXZhdGU6CgogICAgICBfVGVtcG9yYXJ5X2J1ZmZlcihjb25zdCBfVGVtcG9yYXJ5X2J1ZmZlciYp
OwoKICAgICAgdm9pZAogICAgICBvcGVyYXRvcj0oY29uc3QgX1RlbXBvcmFyeV9idWZmZXImKTsK
ICAgIH07CgoKICB0ZW1wbGF0ZTxib29sPgogICAgc3RydWN0IF9fdW5pbml0aWFsaXplZF9jb25z
dHJ1Y3RfYnVmX2Rpc3BhdGNoCiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Qb2ludGVy
LCB0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yPgogICAgICAgIHN0YXRpYyB2b2lkCiAgICAgICAg
X191Y3IoX1BvaW50ZXIgX19maXJzdCwgX1BvaW50ZXIgX19sYXN0LAogICAgICAgX0ZvcndhcmRJ
dGVyYXRvciBfX3NlZWQpCiAgICAgICAgewogICBpZihfX2ZpcnN0ID09IF9fbGFzdCkKICAgICBy
ZXR1cm47CgogICBfUG9pbnRlciBfX2N1ciA9IF9fZmlyc3Q7CiAgIHRyeQogICAgIHsKICAgICAg
IHN0ZDo6X0NvbnN0cnVjdChzdGQ6Ol9fYWRkcmVzc29mKCpfX2ZpcnN0KSwKICAgICAgICAgc3Rk
Ojptb3ZlKCpfX3NlZWQpKTsKICAgICAgIF9Qb2ludGVyIF9fcHJldiA9IF9fY3VyOwogICAgICAg
KytfX2N1cjsKICAgICAgIGZvcig7IF9fY3VyICE9IF9fbGFzdDsgKytfX2N1ciwgKytfX3ByZXYp
CiAgc3RkOjpfQ29uc3RydWN0KHN0ZDo6X19hZGRyZXNzb2YoKl9fY3VyKSwKICAgIHN0ZDo6bW92
ZSgqX19wcmV2KSk7CiAgICAgICAqX19zZWVkID0gc3RkOjptb3ZlKCpfX3ByZXYpOwogICAgIH0K
ICAgY2F0Y2goLi4uKQogICAgIHsKICAgICAgIHN0ZDo6X0Rlc3Ryb3koX19maXJzdCwgX19jdXIp
OwogICAgICAgdGhyb3c7CiAgICAgfQogfQogICAgfTsKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0
IF9fdW5pbml0aWFsaXplZF9jb25zdHJ1Y3RfYnVmX2Rpc3BhdGNoPHRydWU+CiAgICB7CiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9Qb2ludGVyLCB0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yPgog
ICAgICAgIHN0YXRpYyB2b2lkCiAgICAgICAgX191Y3IoX1BvaW50ZXIsIF9Qb2ludGVyLCBfRm9y
d2FyZEl0ZXJhdG9yKSB7IH0KICAgIH07CiMgMjI5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX3RlbXBidWYuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Qb2ludGVyLCB0eXBlbmFt
ZSBfRm9yd2FyZEl0ZXJhdG9yPgogICAgaW5saW5lIHZvaWQKICAgIF9fdW5pbml0aWFsaXplZF9j
b25zdHJ1Y3RfYnVmKF9Qb2ludGVyIF9fZmlyc3QsIF9Qb2ludGVyIF9fbGFzdCwKICAgICAgX0Zv
cndhcmRJdGVyYXRvciBfX3NlZWQpCiAgICB7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgc3RkOjpp
dGVyYXRvcl90cmFpdHM8X1BvaW50ZXI+Ojp2YWx1ZV90eXBlCiBfVmFsdWVUeXBlOwoKICAgICAg
c3RkOjpfX3VuaW5pdGlhbGl6ZWRfY29uc3RydWN0X2J1Zl9kaXNwYXRjaDwKICAgICAgICBfX2hh
c190cml2aWFsX2NvbnN0cnVjdG9yKF9WYWx1ZVR5cGUpPjo6CiAgIF9fdWNyKF9fZmlyc3QsIF9f
bGFzdCwgX19zZWVkKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRv
ciwgdHlwZW5hbWUgX1RwPgogICAgX1RlbXBvcmFyeV9idWZmZXI8X0ZvcndhcmRJdGVyYXRvciwg
X1RwPjo6CiAgICBfVGVtcG9yYXJ5X2J1ZmZlcihfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9G
b3J3YXJkSXRlcmF0b3IgX19sYXN0KQogICAgOiBfTV9vcmlnaW5hbF9sZW4oc3RkOjpkaXN0YW5j
ZShfX2ZpcnN0LCBfX2xhc3QpKSwKICAgICAgX01fbGVuKDApLCBfTV9idWZmZXIoMCkKICAgIHsK
ICAgICAgdHJ5CiB7CiAgIHN0ZDo6cGFpcjxwb2ludGVyLCBzaXplX3R5cGU+IF9fcChzdGQ6Omdl
dF90ZW1wb3JhcnlfYnVmZmVyPAogICAgICAgICB2YWx1ZV90eXBlPihfTV9vcmlnaW5hbF9sZW4p
KTsKICAgX01fYnVmZmVyID0gX19wLmZpcnN0OwogICBfTV9sZW4gPSBfX3Auc2Vjb25kOwogICBp
ZiAoX01fYnVmZmVyKQogICAgIHN0ZDo6X191bmluaXRpYWxpemVkX2NvbnN0cnVjdF9idWYoX01f
YnVmZmVyLCBfTV9idWZmZXIgKyBfTV9sZW4sCiAgICAgICAgICAgIF9fZmlyc3QpOwogfQogICAg
ICBjYXRjaCguLi4pCiB7CiAgIHN0ZDo6cmV0dXJuX3RlbXBvcmFyeV9idWZmZXIoX01fYnVmZmVy
KTsKICAgX01fYnVmZmVyID0gMDsKICAgX01fbGVuID0gMDsKICAgdGhyb3c7CiB9CiAgICB9CgoK
fQojIDYzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMiAzCgoKCiMg
MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3VuaWZvcm1faW50X2Rpc3QuaCIgMSAzCiMg
MzUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy91bmlmb3JtX2ludF9kaXN0LmgiIDMKIyAx
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2xpbWl0cyIgMSAzCiMgNDAgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvbGltaXRzIiAzCiAgICAgICAKIyA0MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9s
aW1pdHMiIDMKIyAxNTggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvbGltaXRzIiAzCm5hbWVzcGFj
ZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCgoK
CgoKICBlbnVtIGZsb2F0X3JvdW5kX3N0eWxlCiAgewogICAgcm91bmRfaW5kZXRlcm1pbmF0ZSA9
IC0xLAogICAgcm91bmRfdG93YXJkX3plcm8gPSAwLAogICAgcm91bmRfdG9fbmVhcmVzdCA9IDEs
CiAgICByb3VuZF90b3dhcmRfaW5maW5pdHkgPSAyLAogICAgcm91bmRfdG93YXJkX25lZ19pbmZp
bml0eSA9IDMKICB9OwoKCgoKCgoKICBlbnVtIGZsb2F0X2Rlbm9ybV9zdHlsZQogIHsKCiAgICBk
ZW5vcm1faW5kZXRlcm1pbmF0ZSA9IC0xLAoKICAgIGRlbm9ybV9hYnNlbnQgPSAwLAoKICAgIGRl
bm9ybV9wcmVzZW50ID0gMQogIH07CiMgMjAyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2xpbWl0
cyIgMwogIHN0cnVjdCBfX251bWVyaWNfbGltaXRzX2Jhc2UKICB7CgoKICAgIHN0YXRpYyBjb25z
dGV4cHIgYm9vbCBpc19zcGVjaWFsaXplZCA9IGZhbHNlOwoKCgoKICAgIHN0YXRpYyBjb25zdGV4
cHIgaW50IGRpZ2l0cyA9IDA7CgoKICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IGRpZ2l0czEwID0g
MDsKCgoKCiAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZGlnaXRzMTAgPSAwOwoKCgogICAg
c3RhdGljIGNvbnN0ZXhwciBib29sIGlzX3NpZ25lZCA9IGZhbHNlOwoKCiAgICBzdGF0aWMgY29u
c3RleHByIGJvb2wgaXNfaW50ZWdlciA9IGZhbHNlOwoKCgoKICAgIHN0YXRpYyBjb25zdGV4cHIg
Ym9vbCBpc19leGFjdCA9IGZhbHNlOwoKCgogICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgcmFkaXgg
PSAwOwoKCgogICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWluX2V4cG9uZW50ID0gMDsKCgoKICAg
IHN0YXRpYyBjb25zdGV4cHIgaW50IG1pbl9leHBvbmVudDEwID0gMDsKCgoKCiAgICBzdGF0aWMg
Y29uc3RleHByIGludCBtYXhfZXhwb25lbnQgPSAwOwoKCgogICAgc3RhdGljIGNvbnN0ZXhwciBp
bnQgbWF4X2V4cG9uZW50MTAgPSAwOwoKCiAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFzX2lu
ZmluaXR5ID0gZmFsc2U7CgoKCiAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFzX3F1aWV0X05h
TiA9IGZhbHNlOwoKCgogICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19zaWduYWxpbmdfTmFO
ID0gZmFsc2U7CgoKICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRfZGVub3JtX3N0eWxlIGhhc19k
ZW5vcm0gPSBkZW5vcm1fYWJzZW50OwoKCgogICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19k
ZW5vcm1fbG9zcyA9IGZhbHNlOwoKCgogICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2llYzU1
OSA9IGZhbHNlOwoKCgoKICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19ib3VuZGVkID0gZmFs
c2U7CiMgMjg4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2xpbWl0cyIgMwogICAgc3RhdGljIGNv
bnN0ZXhwciBib29sIGlzX21vZHVsbyA9IGZhbHNlOwoKCiAgICBzdGF0aWMgY29uc3RleHByIGJv
b2wgdHJhcHMgPSBmYWxzZTsKCgogICAgc3RhdGljIGNvbnN0ZXhwciBib29sIHRpbnluZXNzX2Jl
Zm9yZSA9IGZhbHNlOwoKCgoKICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRfcm91bmRfc3R5bGUg
cm91bmRfc3R5bGUgPQogICAgICAgICAgcm91bmRfdG93YXJkX3plcm87CiAgfTsKIyAzMTQgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvbGltaXRzIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgog
ICAgc3RydWN0IG51bWVyaWNfbGltaXRzIDogcHVibGljIF9fbnVtZXJpY19saW1pdHNfYmFzZQog
ICAgewoKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgX1RwCiAgICAgIG1pbigpIG5vZXhjZXB0IHsg
cmV0dXJuIF9UcCgpOyB9CgoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBfVHAKICAgICAgbWF4KCkg
bm9leGNlcHQgeyByZXR1cm4gX1RwKCk7IH0KCgoKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgX1Rw
CiAgICAgIGxvd2VzdCgpIG5vZXhjZXB0IHsgcmV0dXJuIF9UcCgpOyB9CgoKCgogICAgICBzdGF0
aWMgY29uc3RleHByIF9UcAogICAgICBlcHNpbG9uKCkgbm9leGNlcHQgeyByZXR1cm4gX1RwKCk7
IH0KCgogICAgICBzdGF0aWMgY29uc3RleHByIF9UcAogICAgICByb3VuZF9lcnJvcigpIG5vZXhj
ZXB0IHsgcmV0dXJuIF9UcCgpOyB9CgoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBfVHAKICAgICAg
aW5maW5pdHkoKSBub2V4Y2VwdCB7IHJldHVybiBfVHAoKTsgfQoKCgogICAgICBzdGF0aWMgY29u
c3RleHByIF9UcAogICAgICBxdWlldF9OYU4oKSBub2V4Y2VwdCB7IHJldHVybiBfVHAoKTsgfQoK
CgogICAgICBzdGF0aWMgY29uc3RleHByIF9UcAogICAgICBzaWduYWxpbmdfTmFOKCkgbm9leGNl
cHQgeyByZXR1cm4gX1RwKCk7IH0KCgoKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgX1RwCiAgICAg
IGRlbm9ybV9taW4oKSBub2V4Y2VwdCB7IHJldHVybiBfVHAoKTsgfQogICAgfTsKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBudW1lcmljX2xpbWl0czxjb25zdCBfVHA+CiAg
ICA6IHB1YmxpYyBudW1lcmljX2xpbWl0czxfVHA+IHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwPgogICAgc3RydWN0IG51bWVyaWNfbGltaXRzPHZvbGF0aWxlIF9UcD4KICAgIDogcHVibGlj
IG51bWVyaWNfbGltaXRzPF9UcD4geyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBz
dHJ1Y3QgbnVtZXJpY19saW1pdHM8Y29uc3Qgdm9sYXRpbGUgX1RwPgogICAgOiBwdWJsaWMgbnVt
ZXJpY19saW1pdHM8X1RwPiB7IH07CgoKCgoKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IG51bWVy
aWNfbGltaXRzPGJvb2w+CiAgICB7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19zcGVj
aWFsaXplZCA9IHRydWU7CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wKICAgICAgbWluKCkg
bm9leGNlcHQgeyByZXR1cm4gZmFsc2U7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbAog
ICAgICBtYXgoKSBub2V4Y2VwdCB7IHJldHVybiB0cnVlOyB9CgoKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBib29sCiAgICAgIGxvd2VzdCgpIG5vZXhjZXB0IHsgcmV0dXJuIG1pbigpOyB9CgogICAg
ICBzdGF0aWMgY29uc3RleHByIGludCBkaWdpdHMgPSAxOwogICAgICBzdGF0aWMgY29uc3RleHBy
IGludCBkaWdpdHMxMCA9IDA7CgogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZGlnaXRz
MTAgPSAwOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX3NpZ25lZCA9IGZhbHNlOwog
ICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfaW50ZWdlciA9IHRydWU7CiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgYm9vbCBpc19leGFjdCA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
aW50IHJhZGl4ID0gMjsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbAogICAgICBlcHNpbG9u
KCkgbm9leGNlcHQgeyByZXR1cm4gZmFsc2U7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9v
bAogICAgICByb3VuZF9lcnJvcigpIG5vZXhjZXB0IHsgcmV0dXJuIGZhbHNlOyB9CgogICAgICBz
dGF0aWMgY29uc3RleHByIGludCBtaW5fZXhwb25lbnQgPSAwOwogICAgICBzdGF0aWMgY29uc3Rl
eHByIGludCBtaW5fZXhwb25lbnQxMCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1h
eF9leHBvbmVudCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1heF9leHBvbmVudDEw
ID0gMDsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNfaW5maW5pdHkgPSBmYWxzZTsK
ICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19xdWlldF9OYU4gPSBmYWxzZTsKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19zaWduYWxpbmdfTmFOID0gZmFsc2U7CiAgICAgIHN0
YXRpYyBjb25zdGV4cHIgZmxvYXRfZGVub3JtX3N0eWxlIGhhc19kZW5vcm0KICAgICAgID0gZGVu
b3JtX2Fic2VudDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19kZW5vcm1fbG9zcyA9
IGZhbHNlOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sCiAgICAgIGluZmluaXR5KCkgbm9l
eGNlcHQgeyByZXR1cm4gZmFsc2U7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbAogICAg
ICBxdWlldF9OYU4oKSBub2V4Y2VwdCB7IHJldHVybiBmYWxzZTsgfQoKICAgICAgc3RhdGljIGNv
bnN0ZXhwciBib29sCiAgICAgIHNpZ25hbGluZ19OYU4oKSBub2V4Y2VwdCB7IHJldHVybiBmYWxz
ZTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sCiAgICAgIGRlbm9ybV9taW4oKSBub2V4
Y2VwdCB7IHJldHVybiBmYWxzZTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2ll
YzU1OSA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfYm91bmRlZCA9IHRy
dWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19tb2R1bG8gPSBmYWxzZTsKCgoKCiAg
ICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCB0cmFwcyA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25z
dGV4cHIgYm9vbCB0aW55bmVzc19iZWZvcmUgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBmbG9hdF9yb3VuZF9zdHlsZSByb3VuZF9zdHlsZQogICAgICAgPSByb3VuZF90b3dhcmRfemVy
bzsKICAgIH07CgoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgbnVtZXJpY19saW1pdHM8Y2hhcj4K
ICAgIHsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX3NwZWNpYWxpemVkID0gdHJ1ZTsK
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgY2hhcgogICAgICBtaW4oKSBub2V4Y2VwdCB7IHJldHVy
biAoKChjaGFyKSgtMSkgPCAwKSA/IC0oKChjaGFyKSgtMSkgPCAwKSA/ICgoKCgoY2hhcikxIDw8
ICgoc2l6ZW9mKGNoYXIpICogOCAtICgoY2hhcikoLTEpIDwgMCkpIC0gMSkpIC0gMSkgPDwgMSkg
KyAxKSA6IH4oY2hhcikwKSAtIDEgOiAoY2hhcikwKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBjaGFyCiAgICAgIG1heCgpIG5vZXhjZXB0IHsgcmV0dXJuICgoKGNoYXIpKC0xKSA8IDApID8g
KCgoKChjaGFyKTEgPDwgKChzaXplb2YoY2hhcikgKiA4IC0gKChjaGFyKSgtMSkgPCAwKSkgLSAx
KSkgLSAxKSA8PCAxKSArIDEpIDogfihjaGFyKTApOyB9CgoKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBjaGFyCiAgICAgIGxvd2VzdCgpIG5vZXhjZXB0IHsgcmV0dXJuIG1pbigpOyB9CgoKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBpbnQgZGlnaXRzID0gKHNpemVvZihjaGFyKSAqIDggLSAoKGNoYXIp
KC0xKSA8IDApKTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgZGlnaXRzMTAgPSAoKHNpemVv
ZihjaGFyKSAqIDggLSAoKGNoYXIpKC0xKSA8IDApKSAqIDY0M0wgLyAyMTM2KTsKCiAgICAgIHN0
YXRpYyBjb25zdGV4cHIgaW50IG1heF9kaWdpdHMxMCA9IDA7CgogICAgICBzdGF0aWMgY29uc3Rl
eHByIGJvb2wgaXNfc2lnbmVkID0gKChjaGFyKSgtMSkgPCAwKTsKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBib29sIGlzX2ludGVnZXIgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wg
aXNfZXhhY3QgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCByYWRpeCA9IDI7Cgog
ICAgICBzdGF0aWMgY29uc3RleHByIGNoYXIKICAgICAgZXBzaWxvbigpIG5vZXhjZXB0IHsgcmV0
dXJuIDA7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgY2hhcgogICAgICByb3VuZF9lcnJvcigp
IG5vZXhjZXB0IHsgcmV0dXJuIDA7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1pbl9l
eHBvbmVudCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1pbl9leHBvbmVudDEwID0g
MDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWF4X2V4cG9uZW50ID0gMDsKICAgICAgc3Rh
dGljIGNvbnN0ZXhwciBpbnQgbWF4X2V4cG9uZW50MTAgPSAwOwoKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBib29sIGhhc19pbmZpbml0eSA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJv
b2wgaGFzX3F1aWV0X05hTiA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFz
X3NpZ25hbGluZ19OYU4gPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBmbG9hdF9kZW5v
cm1fc3R5bGUgaGFzX2Rlbm9ybQogICAgICAgPSBkZW5vcm1fYWJzZW50OwogICAgICBzdGF0aWMg
Y29uc3RleHByIGJvb2wgaGFzX2Rlbm9ybV9sb3NzID0gZmFsc2U7CgogICAgICBzdGF0aWMgY29u
c3RleHByCiAgICAgIGNoYXIgaW5maW5pdHkoKSBub2V4Y2VwdCB7IHJldHVybiBjaGFyKCk7IH0K
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgY2hhcgogICAgICBxdWlldF9OYU4oKSBub2V4Y2VwdCB7
IHJldHVybiBjaGFyKCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgY2hhcgogICAgICBzaWdu
YWxpbmdfTmFOKCkgbm9leGNlcHQgeyByZXR1cm4gY2hhcigpOyB9CgogICAgICBzdGF0aWMgY29u
c3RleHByIGNoYXIKICAgICAgZGVub3JtX21pbigpIG5vZXhjZXB0IHsgcmV0dXJuIHN0YXRpY19j
YXN0PGNoYXI+KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfaWVjNTU5ID0g
ZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19ib3VuZGVkID0gdHJ1ZTsKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX21vZHVsbyA9ICFpc19zaWduZWQ7CgogICAgICBz
dGF0aWMgY29uc3RleHByIGJvb2wgdHJhcHMgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHBy
IGJvb2wgdGlueW5lc3NfYmVmb3JlID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxv
YXRfcm91bmRfc3R5bGUgcm91bmRfc3R5bGUKICAgICAgID0gcm91bmRfdG93YXJkX3plcm87CiAg
ICB9OwoKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IG51bWVyaWNfbGltaXRzPHNpZ25lZCBjaGFy
PgogICAgewogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfc3BlY2lhbGl6ZWQgPSB0cnVl
OwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBzaWduZWQgY2hhcgogICAgICBtaW4oKSBub2V4Y2Vw
dCB7IHJldHVybiAtMHg3ZiAtIDE7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgc2lnbmVkIGNo
YXIKICAgICAgbWF4KCkgbm9leGNlcHQgeyByZXR1cm4gMHg3ZjsgfQoKCiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgc2lnbmVkIGNoYXIKICAgICAgbG93ZXN0KCkgbm9leGNlcHQgeyByZXR1cm4gbWlu
KCk7IH0KCgogICAgICBzdGF0aWMgY29uc3RleHByIGludCBkaWdpdHMgPSAoc2l6ZW9mKHNpZ25l
ZCBjaGFyKSAqIDggLSAoKHNpZ25lZCBjaGFyKSgtMSkgPCAwKSk7CiAgICAgIHN0YXRpYyBjb25z
dGV4cHIgaW50IGRpZ2l0czEwCiAgICAgICA9ICgoc2l6ZW9mKHNpZ25lZCBjaGFyKSAqIDggLSAo
KHNpZ25lZCBjaGFyKSgtMSkgPCAwKSkgKiA2NDNMIC8gMjEzNik7CgogICAgICBzdGF0aWMgY29u
c3RleHByIGludCBtYXhfZGlnaXRzMTAgPSAwOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29s
IGlzX3NpZ25lZCA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19pbnRlZ2Vy
ID0gdHJ1ZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2V4YWN0ID0gdHJ1ZTsKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgcmFkaXggPSAyOwoKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBzaWduZWQgY2hhcgogICAgICBlcHNpbG9uKCkgbm9leGNlcHQgeyByZXR1cm4gMDsgfQoKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBzaWduZWQgY2hhcgogICAgICByb3VuZF9lcnJvcigpIG5vZXhj
ZXB0IHsgcmV0dXJuIDA7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1pbl9leHBvbmVu
dCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1pbl9leHBvbmVudDEwID0gMDsKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWF4X2V4cG9uZW50ID0gMDsKICAgICAgc3RhdGljIGNv
bnN0ZXhwciBpbnQgbWF4X2V4cG9uZW50MTAgPSAwOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBi
b29sIGhhc19pbmZpbml0eSA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFz
X3F1aWV0X05hTiA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFzX3NpZ25h
bGluZ19OYU4gPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBmbG9hdF9kZW5vcm1fc3R5
bGUgaGFzX2Rlbm9ybQogICAgICAgPSBkZW5vcm1fYWJzZW50OwogICAgICBzdGF0aWMgY29uc3Rl
eHByIGJvb2wgaGFzX2Rlbm9ybV9sb3NzID0gZmFsc2U7CgogICAgICBzdGF0aWMgY29uc3RleHBy
IHNpZ25lZCBjaGFyCiAgICAgIGluZmluaXR5KCkgbm9leGNlcHQgeyByZXR1cm4gc3RhdGljX2Nh
c3Q8c2lnbmVkIGNoYXI+KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIHNpZ25lZCBjaGFy
CiAgICAgIHF1aWV0X05hTigpIG5vZXhjZXB0IHsgcmV0dXJuIHN0YXRpY19jYXN0PHNpZ25lZCBj
aGFyPigwKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBzaWduZWQgY2hhcgogICAgICBzaWdu
YWxpbmdfTmFOKCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc3RhdGljX2Nhc3Q8c2lnbmVkIGNo
YXI+KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIHNpZ25lZCBjaGFyCiAgICAgIGRlbm9y
bV9taW4oKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxzaWduZWQgY2hhcj4o
MCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19pZWM1NTkgPSBmYWxzZTsKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2JvdW5kZWQgPSB0cnVlOwogICAgICBzdGF0aWMg
Y29uc3RleHByIGJvb2wgaXNfbW9kdWxvID0gZmFsc2U7CgogICAgICBzdGF0aWMgY29uc3RleHBy
IGJvb2wgdHJhcHMgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgdGlueW5lc3Nf
YmVmb3JlID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRfcm91bmRfc3R5bGUg
cm91bmRfc3R5bGUKICAgICAgID0gcm91bmRfdG93YXJkX3plcm87CiAgICB9OwoKCiAgdGVtcGxh
dGU8PgogICAgc3RydWN0IG51bWVyaWNfbGltaXRzPHVuc2lnbmVkIGNoYXI+CiAgICB7CiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19zcGVjaWFsaXplZCA9IHRydWU7CgogICAgICBzdGF0
aWMgY29uc3RleHByIHVuc2lnbmVkIGNoYXIKICAgICAgbWluKCkgbm9leGNlcHQgeyByZXR1cm4g
MDsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB1bnNpZ25lZCBjaGFyCiAgICAgIG1heCgpIG5v
ZXhjZXB0IHsgcmV0dXJuIDB4N2YgKiAyVSArIDE7IH0KCgogICAgICBzdGF0aWMgY29uc3RleHBy
IHVuc2lnbmVkIGNoYXIKICAgICAgbG93ZXN0KCkgbm9leGNlcHQgeyByZXR1cm4gbWluKCk7IH0K
CgogICAgICBzdGF0aWMgY29uc3RleHByIGludCBkaWdpdHMKICAgICAgID0gKHNpemVvZih1bnNp
Z25lZCBjaGFyKSAqIDggLSAoKHVuc2lnbmVkIGNoYXIpKC0xKSA8IDApKTsKICAgICAgc3RhdGlj
IGNvbnN0ZXhwciBpbnQgZGlnaXRzMTAKICAgICAgID0gKChzaXplb2YodW5zaWduZWQgY2hhcikg
KiA4IC0gKCh1bnNpZ25lZCBjaGFyKSgtMSkgPCAwKSkgKiA2NDNMIC8gMjEzNik7CgogICAgICBz
dGF0aWMgY29uc3RleHByIGludCBtYXhfZGlnaXRzMTAgPSAwOwoKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBib29sIGlzX3NpZ25lZCA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wg
aXNfaW50ZWdlciA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19leGFjdCA9
IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IHJhZGl4ID0gMjsKCiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgdW5zaWduZWQgY2hhcgogICAgICBlcHNpbG9uKCkgbm9leGNlcHQgeyByZXR1
cm4gMDsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB1bnNpZ25lZCBjaGFyCiAgICAgIHJvdW5k
X2Vycm9yKCkgbm9leGNlcHQgeyByZXR1cm4gMDsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBp
bnQgbWluX2V4cG9uZW50ID0gMDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWluX2V4cG9u
ZW50MTAgPSAwOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZXhwb25lbnQgPSAwOwog
ICAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZXhwb25lbnQxMCA9IDA7CgogICAgICBzdGF0
aWMgY29uc3RleHByIGJvb2wgaGFzX2luZmluaXR5ID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25z
dGV4cHIgYm9vbCBoYXNfcXVpZXRfTmFOID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
Ym9vbCBoYXNfc2lnbmFsaW5nX05hTiA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGZs
b2F0X2Rlbm9ybV9zdHlsZSBoYXNfZGVub3JtCiAgICAgICA9IGRlbm9ybV9hYnNlbnQ7CiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNfZGVub3JtX2xvc3MgPSBmYWxzZTsKCiAgICAgIHN0
YXRpYyBjb25zdGV4cHIgdW5zaWduZWQgY2hhcgogICAgICBpbmZpbml0eSgpIG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PHVuc2lnbmVkIGNoYXI+KDApOyB9CgogICAgICBzdGF0
aWMgY29uc3RleHByIHVuc2lnbmVkIGNoYXIKICAgICAgcXVpZXRfTmFOKCkgbm9leGNlcHQKICAg
ICAgeyByZXR1cm4gc3RhdGljX2Nhc3Q8dW5zaWduZWQgY2hhcj4oMCk7IH0KCiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgdW5zaWduZWQgY2hhcgogICAgICBzaWduYWxpbmdfTmFOKCkgbm9leGNlcHQK
ICAgICAgeyByZXR1cm4gc3RhdGljX2Nhc3Q8dW5zaWduZWQgY2hhcj4oMCk7IH0KCiAgICAgIHN0
YXRpYyBjb25zdGV4cHIgdW5zaWduZWQgY2hhcgogICAgICBkZW5vcm1fbWluKCkgbm9leGNlcHQK
ICAgICAgeyByZXR1cm4gc3RhdGljX2Nhc3Q8dW5zaWduZWQgY2hhcj4oMCk7IH0KCiAgICAgIHN0
YXRpYyBjb25zdGV4cHIgYm9vbCBpc19pZWM1NTkgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBib29sIGlzX2JvdW5kZWQgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wg
aXNfbW9kdWxvID0gdHJ1ZTsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCB0cmFwcyA9IHRy
dWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCB0aW55bmVzc19iZWZvcmUgPSBmYWxzZTsK
ICAgICAgc3RhdGljIGNvbnN0ZXhwciBmbG9hdF9yb3VuZF9zdHlsZSByb3VuZF9zdHlsZQogICAg
ICAgPSByb3VuZF90b3dhcmRfemVybzsKICAgIH07CgoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3Qg
bnVtZXJpY19saW1pdHM8d2NoYXJfdD4KICAgIHsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29s
IGlzX3NwZWNpYWxpemVkID0gdHJ1ZTsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgd2NoYXJfdAog
ICAgICBtaW4oKSBub2V4Y2VwdCB7IHJldHVybiAoKCh3Y2hhcl90KSgtMSkgPCAwKSA/IC0oKCh3
Y2hhcl90KSgtMSkgPCAwKSA/ICgoKCgod2NoYXJfdCkxIDw8ICgoc2l6ZW9mKHdjaGFyX3QpICog
OCAtICgod2NoYXJfdCkoLTEpIDwgMCkpIC0gMSkpIC0gMSkgPDwgMSkgKyAxKSA6IH4od2NoYXJf
dCkwKSAtIDEgOiAod2NoYXJfdCkwKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB3Y2hhcl90
CiAgICAgIG1heCgpIG5vZXhjZXB0IHsgcmV0dXJuICgoKHdjaGFyX3QpKC0xKSA8IDApID8gKCgo
KCh3Y2hhcl90KTEgPDwgKChzaXplb2Yod2NoYXJfdCkgKiA4IC0gKCh3Y2hhcl90KSgtMSkgPCAw
KSkgLSAxKSkgLSAxKSA8PCAxKSArIDEpIDogfih3Y2hhcl90KTApOyB9CgoKICAgICAgc3RhdGlj
IGNvbnN0ZXhwciB3Y2hhcl90CiAgICAgIGxvd2VzdCgpIG5vZXhjZXB0IHsgcmV0dXJuIG1pbigp
OyB9CgoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgZGlnaXRzID0gKHNpemVvZih3Y2hhcl90
KSAqIDggLSAoKHdjaGFyX3QpKC0xKSA8IDApKTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQg
ZGlnaXRzMTAKICAgICAgID0gKChzaXplb2Yod2NoYXJfdCkgKiA4IC0gKCh3Y2hhcl90KSgtMSkg
PCAwKSkgKiA2NDNMIC8gMjEzNik7CgogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZGln
aXRzMTAgPSAwOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX3NpZ25lZCA9ICgod2No
YXJfdCkoLTEpIDwgMCk7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19pbnRlZ2VyID0g
dHJ1ZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2V4YWN0ID0gdHJ1ZTsKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBpbnQgcmFkaXggPSAyOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB3
Y2hhcl90CiAgICAgIGVwc2lsb24oKSBub2V4Y2VwdCB7IHJldHVybiAwOyB9CgogICAgICBzdGF0
aWMgY29uc3RleHByIHdjaGFyX3QKICAgICAgcm91bmRfZXJyb3IoKSBub2V4Y2VwdCB7IHJldHVy
biAwOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtaW5fZXhwb25lbnQgPSAwOwogICAg
ICBzdGF0aWMgY29uc3RleHByIGludCBtaW5fZXhwb25lbnQxMCA9IDA7CiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgaW50IG1heF9leHBvbmVudCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50
IG1heF9leHBvbmVudDEwID0gMDsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNfaW5m
aW5pdHkgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19xdWlldF9OYU4g
PSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19zaWduYWxpbmdfTmFOID0g
ZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRfZGVub3JtX3N0eWxlIGhhc19kZW5v
cm0KICAgICAgID0gZGVub3JtX2Fic2VudDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhh
c19kZW5vcm1fbG9zcyA9IGZhbHNlOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB3Y2hhcl90CiAg
ICAgIGluZmluaXR5KCkgbm9leGNlcHQgeyByZXR1cm4gd2NoYXJfdCgpOyB9CgogICAgICBzdGF0
aWMgY29uc3RleHByIHdjaGFyX3QKICAgICAgcXVpZXRfTmFOKCkgbm9leGNlcHQgeyByZXR1cm4g
d2NoYXJfdCgpOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIHdjaGFyX3QKICAgICAgc2lnbmFs
aW5nX05hTigpIG5vZXhjZXB0IHsgcmV0dXJuIHdjaGFyX3QoKTsgfQoKICAgICAgc3RhdGljIGNv
bnN0ZXhwciB3Y2hhcl90CiAgICAgIGRlbm9ybV9taW4oKSBub2V4Y2VwdCB7IHJldHVybiB3Y2hh
cl90KCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19pZWM1NTkgPSBmYWxzZTsK
ICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2JvdW5kZWQgPSB0cnVlOwogICAgICBzdGF0
aWMgY29uc3RleHByIGJvb2wgaXNfbW9kdWxvID0gIWlzX3NpZ25lZDsKCiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgYm9vbCB0cmFwcyA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCB0
aW55bmVzc19iZWZvcmUgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBmbG9hdF9yb3Vu
ZF9zdHlsZSByb3VuZF9zdHlsZQogICAgICAgPSByb3VuZF90b3dhcmRfemVybzsKICAgIH07CgoK
CiAgdGVtcGxhdGU8PgogICAgc3RydWN0IG51bWVyaWNfbGltaXRzPGNoYXIxNl90PgogICAgewog
ICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfc3BlY2lhbGl6ZWQgPSB0cnVlOwoKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBjaGFyMTZfdAogICAgICBtaW4oKSBub2V4Y2VwdCB7IHJldHVybiAo
KChjaGFyMTZfdCkoLTEpIDwgMCkgPyAtKCgoY2hhcjE2X3QpKC0xKSA8IDApID8gKCgoKChjaGFy
MTZfdCkxIDw8ICgoc2l6ZW9mKGNoYXIxNl90KSAqIDggLSAoKGNoYXIxNl90KSgtMSkgPCAwKSkg
LSAxKSkgLSAxKSA8PCAxKSArIDEpIDogfihjaGFyMTZfdCkwKSAtIDEgOiAoY2hhcjE2X3QpMCk7
IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgY2hhcjE2X3QKICAgICAgbWF4KCkgbm9leGNlcHQg
eyByZXR1cm4gKCgoY2hhcjE2X3QpKC0xKSA8IDApID8gKCgoKChjaGFyMTZfdCkxIDw8ICgoc2l6
ZW9mKGNoYXIxNl90KSAqIDggLSAoKGNoYXIxNl90KSgtMSkgPCAwKSkgLSAxKSkgLSAxKSA8PCAx
KSArIDEpIDogfihjaGFyMTZfdCkwKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBjaGFyMTZf
dAogICAgICBsb3dlc3QoKSBub2V4Y2VwdCB7IHJldHVybiBtaW4oKTsgfQoKICAgICAgc3RhdGlj
IGNvbnN0ZXhwciBpbnQgZGlnaXRzID0gKHNpemVvZihjaGFyMTZfdCkgKiA4IC0gKChjaGFyMTZf
dCkoLTEpIDwgMCkpOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBkaWdpdHMxMCA9ICgoc2l6
ZW9mKGNoYXIxNl90KSAqIDggLSAoKGNoYXIxNl90KSgtMSkgPCAwKSkgKiA2NDNMIC8gMjEzNik7
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1heF9kaWdpdHMxMCA9IDA7CiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgYm9vbCBpc19zaWduZWQgPSAoKGNoYXIxNl90KSgtMSkgPCAwKTsKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2ludGVnZXIgPSB0cnVlOwogICAgICBzdGF0aWMgY29u
c3RleHByIGJvb2wgaXNfZXhhY3QgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBy
YWRpeCA9IDI7CgogICAgICBzdGF0aWMgY29uc3RleHByIGNoYXIxNl90CiAgICAgIGVwc2lsb24o
KSBub2V4Y2VwdCB7IHJldHVybiAwOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGNoYXIxNl90
CiAgICAgIHJvdW5kX2Vycm9yKCkgbm9leGNlcHQgeyByZXR1cm4gMDsgfQoKICAgICAgc3RhdGlj
IGNvbnN0ZXhwciBpbnQgbWluX2V4cG9uZW50ID0gMDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBp
bnQgbWluX2V4cG9uZW50MTAgPSAwOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZXhw
b25lbnQgPSAwOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZXhwb25lbnQxMCA9IDA7
CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFzX2luZmluaXR5ID0gZmFsc2U7CiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNfcXVpZXRfTmFOID0gZmFsc2U7CiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgYm9vbCBoYXNfc2lnbmFsaW5nX05hTiA9IGZhbHNlOwogICAgICBzdGF0aWMg
Y29uc3RleHByIGZsb2F0X2Rlbm9ybV9zdHlsZSBoYXNfZGVub3JtID0gZGVub3JtX2Fic2VudDsK
ICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19kZW5vcm1fbG9zcyA9IGZhbHNlOwoKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBjaGFyMTZfdAogICAgICBpbmZpbml0eSgpIG5vZXhjZXB0IHsg
cmV0dXJuIGNoYXIxNl90KCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgY2hhcjE2X3QKICAg
ICAgcXVpZXRfTmFOKCkgbm9leGNlcHQgeyByZXR1cm4gY2hhcjE2X3QoKTsgfQoKICAgICAgc3Rh
dGljIGNvbnN0ZXhwciBjaGFyMTZfdAogICAgICBzaWduYWxpbmdfTmFOKCkgbm9leGNlcHQgeyBy
ZXR1cm4gY2hhcjE2X3QoKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBjaGFyMTZfdAogICAg
ICBkZW5vcm1fbWluKCkgbm9leGNlcHQgeyByZXR1cm4gY2hhcjE2X3QoKTsgfQoKICAgICAgc3Rh
dGljIGNvbnN0ZXhwciBib29sIGlzX2llYzU1OSA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3Rl
eHByIGJvb2wgaXNfYm91bmRlZCA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBp
c19tb2R1bG8gPSAhaXNfc2lnbmVkOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIHRyYXBz
ID0gdHJ1ZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIHRpbnluZXNzX2JlZm9yZSA9IGZh
bHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGZsb2F0X3JvdW5kX3N0eWxlIHJvdW5kX3N0eWxl
ID0gcm91bmRfdG93YXJkX3plcm87CiAgICB9OwoKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IG51
bWVyaWNfbGltaXRzPGNoYXIzMl90PgogICAgewogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wg
aXNfc3BlY2lhbGl6ZWQgPSB0cnVlOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBjaGFyMzJfdAog
ICAgICBtaW4oKSBub2V4Y2VwdCB7IHJldHVybiAoKChjaGFyMzJfdCkoLTEpIDwgMCkgPyAtKCgo
Y2hhcjMyX3QpKC0xKSA8IDApID8gKCgoKChjaGFyMzJfdCkxIDw8ICgoc2l6ZW9mKGNoYXIzMl90
KSAqIDggLSAoKGNoYXIzMl90KSgtMSkgPCAwKSkgLSAxKSkgLSAxKSA8PCAxKSArIDEpIDogfihj
aGFyMzJfdCkwKSAtIDEgOiAoY2hhcjMyX3QpMCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
Y2hhcjMyX3QKICAgICAgbWF4KCkgbm9leGNlcHQgeyByZXR1cm4gKCgoY2hhcjMyX3QpKC0xKSA8
IDApID8gKCgoKChjaGFyMzJfdCkxIDw8ICgoc2l6ZW9mKGNoYXIzMl90KSAqIDggLSAoKGNoYXIz
Ml90KSgtMSkgPCAwKSkgLSAxKSkgLSAxKSA8PCAxKSArIDEpIDogfihjaGFyMzJfdCkwKTsgfQoK
ICAgICAgc3RhdGljIGNvbnN0ZXhwciBjaGFyMzJfdAogICAgICBsb3dlc3QoKSBub2V4Y2VwdCB7
IHJldHVybiBtaW4oKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgZGlnaXRzID0gKHNp
emVvZihjaGFyMzJfdCkgKiA4IC0gKChjaGFyMzJfdCkoLTEpIDwgMCkpOwogICAgICBzdGF0aWMg
Y29uc3RleHByIGludCBkaWdpdHMxMCA9ICgoc2l6ZW9mKGNoYXIzMl90KSAqIDggLSAoKGNoYXIz
Ml90KSgtMSkgPCAwKSkgKiA2NDNMIC8gMjEzNik7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50
IG1heF9kaWdpdHMxMCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19zaWduZWQg
PSAoKGNoYXIzMl90KSgtMSkgPCAwKTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2lu
dGVnZXIgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfZXhhY3QgPSB0cnVl
OwogICAgICBzdGF0aWMgY29uc3RleHByIGludCByYWRpeCA9IDI7CgogICAgICBzdGF0aWMgY29u
c3RleHByIGNoYXIzMl90CiAgICAgIGVwc2lsb24oKSBub2V4Y2VwdCB7IHJldHVybiAwOyB9Cgog
ICAgICBzdGF0aWMgY29uc3RleHByIGNoYXIzMl90CiAgICAgIHJvdW5kX2Vycm9yKCkgbm9leGNl
cHQgeyByZXR1cm4gMDsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWluX2V4cG9uZW50
ID0gMDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWluX2V4cG9uZW50MTAgPSAwOwogICAg
ICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZXhwb25lbnQgPSAwOwogICAgICBzdGF0aWMgY29u
c3RleHByIGludCBtYXhfZXhwb25lbnQxMCA9IDA7CgogICAgICBzdGF0aWMgY29uc3RleHByIGJv
b2wgaGFzX2luZmluaXR5ID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNf
cXVpZXRfTmFOID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNfc2lnbmFs
aW5nX05hTiA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGZsb2F0X2Rlbm9ybV9zdHls
ZSBoYXNfZGVub3JtID0gZGVub3JtX2Fic2VudDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29s
IGhhc19kZW5vcm1fbG9zcyA9IGZhbHNlOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBjaGFyMzJf
dAogICAgICBpbmZpbml0eSgpIG5vZXhjZXB0IHsgcmV0dXJuIGNoYXIzMl90KCk7IH0KCiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgY2hhcjMyX3QKICAgICAgcXVpZXRfTmFOKCkgbm9leGNlcHQgeyBy
ZXR1cm4gY2hhcjMyX3QoKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBjaGFyMzJfdAogICAg
ICBzaWduYWxpbmdfTmFOKCkgbm9leGNlcHQgeyByZXR1cm4gY2hhcjMyX3QoKTsgfQoKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBjaGFyMzJfdAogICAgICBkZW5vcm1fbWluKCkgbm9leGNlcHQgeyBy
ZXR1cm4gY2hhcjMyX3QoKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2llYzU1
OSA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfYm91bmRlZCA9IHRydWU7
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19tb2R1bG8gPSAhaXNfc2lnbmVkOwoKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBib29sIHRyYXBzID0gdHJ1ZTsKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBib29sIHRpbnluZXNzX2JlZm9yZSA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHBy
IGZsb2F0X3JvdW5kX3N0eWxlIHJvdW5kX3N0eWxlID0gcm91bmRfdG93YXJkX3plcm87CiAgICB9
OwoKCgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBudW1lcmljX2xpbWl0czxzaG9ydD4KICAgIHsK
ICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX3NwZWNpYWxpemVkID0gdHJ1ZTsKCiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgc2hvcnQKICAgICAgbWluKCkgbm9leGNlcHQgeyByZXR1cm4gLTB4
N2ZmZiAtIDE7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgc2hvcnQKICAgICAgbWF4KCkgbm9l
eGNlcHQgeyByZXR1cm4gMHg3ZmZmOyB9CgoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBzaG9ydAog
ICAgICBsb3dlc3QoKSBub2V4Y2VwdCB7IHJldHVybiBtaW4oKTsgfQoKCiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgaW50IGRpZ2l0cyA9IChzaXplb2Yoc2hvcnQpICogOCAtICgoc2hvcnQpKC0xKSA8
IDApKTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgZGlnaXRzMTAgPSAoKHNpemVvZihzaG9y
dCkgKiA4IC0gKChzaG9ydCkoLTEpIDwgMCkpICogNjQzTCAvIDIxMzYpOwoKICAgICAgc3RhdGlj
IGNvbnN0ZXhwciBpbnQgbWF4X2RpZ2l0czEwID0gMDsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
Ym9vbCBpc19zaWduZWQgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfaW50
ZWdlciA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19leGFjdCA9IHRydWU7
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IHJhZGl4ID0gMjsKCiAgICAgIHN0YXRpYyBjb25z
dGV4cHIgc2hvcnQKICAgICAgZXBzaWxvbigpIG5vZXhjZXB0IHsgcmV0dXJuIDA7IH0KCiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgc2hvcnQKICAgICAgcm91bmRfZXJyb3IoKSBub2V4Y2VwdCB7IHJl
dHVybiAwOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtaW5fZXhwb25lbnQgPSAwOwog
ICAgICBzdGF0aWMgY29uc3RleHByIGludCBtaW5fZXhwb25lbnQxMCA9IDA7CiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgaW50IG1heF9leHBvbmVudCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
aW50IG1heF9leHBvbmVudDEwID0gMDsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNf
aW5maW5pdHkgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19xdWlldF9O
YU4gPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19zaWduYWxpbmdfTmFO
ID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRfZGVub3JtX3N0eWxlIGhhc19k
ZW5vcm0KICAgICAgID0gZGVub3JtX2Fic2VudDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29s
IGhhc19kZW5vcm1fbG9zcyA9IGZhbHNlOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBzaG9ydAog
ICAgICBpbmZpbml0eSgpIG5vZXhjZXB0IHsgcmV0dXJuIHNob3J0KCk7IH0KCiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgc2hvcnQKICAgICAgcXVpZXRfTmFOKCkgbm9leGNlcHQgeyByZXR1cm4gc2hv
cnQoKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBzaG9ydAogICAgICBzaWduYWxpbmdfTmFO
KCkgbm9leGNlcHQgeyByZXR1cm4gc2hvcnQoKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBz
aG9ydAogICAgICBkZW5vcm1fbWluKCkgbm9leGNlcHQgeyByZXR1cm4gc2hvcnQoKTsgfQoKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2llYzU1OSA9IGZhbHNlOwogICAgICBzdGF0aWMg
Y29uc3RleHByIGJvb2wgaXNfYm91bmRlZCA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
Ym9vbCBpc19tb2R1bG8gPSBmYWxzZTsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCB0cmFw
cyA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCB0aW55bmVzc19iZWZvcmUgPSBm
YWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBmbG9hdF9yb3VuZF9zdHlsZSByb3VuZF9zdHls
ZQogICAgICAgPSByb3VuZF90b3dhcmRfemVybzsKICAgIH07CgoKICB0ZW1wbGF0ZTw+CiAgICBz
dHJ1Y3QgbnVtZXJpY19saW1pdHM8dW5zaWduZWQgc2hvcnQ+CiAgICB7CiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgYm9vbCBpc19zcGVjaWFsaXplZCA9IHRydWU7CgogICAgICBzdGF0aWMgY29uc3Rl
eHByIHVuc2lnbmVkIHNob3J0CiAgICAgIG1pbigpIG5vZXhjZXB0IHsgcmV0dXJuIDA7IH0KCiAg
ICAgIHN0YXRpYyBjb25zdGV4cHIgdW5zaWduZWQgc2hvcnQKICAgICAgbWF4KCkgbm9leGNlcHQg
eyByZXR1cm4gMHg3ZmZmICogMlUgKyAxOyB9CgoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB1bnNp
Z25lZCBzaG9ydAogICAgICBsb3dlc3QoKSBub2V4Y2VwdCB7IHJldHVybiBtaW4oKTsgfQoKCiAg
ICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IGRpZ2l0cwogICAgICAgPSAoc2l6ZW9mKHVuc2lnbmVk
IHNob3J0KSAqIDggLSAoKHVuc2lnbmVkIHNob3J0KSgtMSkgPCAwKSk7CiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgaW50IGRpZ2l0czEwCiAgICAgICA9ICgoc2l6ZW9mKHVuc2lnbmVkIHNob3J0KSAq
IDggLSAoKHVuc2lnbmVkIHNob3J0KSgtMSkgPCAwKSkgKiA2NDNMIC8gMjEzNik7CgogICAgICBz
dGF0aWMgY29uc3RleHByIGludCBtYXhfZGlnaXRzMTAgPSAwOwoKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBib29sIGlzX3NpZ25lZCA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wg
aXNfaW50ZWdlciA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19leGFjdCA9
IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IHJhZGl4ID0gMjsKCiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgdW5zaWduZWQgc2hvcnQKICAgICAgZXBzaWxvbigpIG5vZXhjZXB0IHsgcmV0
dXJuIDA7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgdW5zaWduZWQgc2hvcnQKICAgICAgcm91
bmRfZXJyb3IoKSBub2V4Y2VwdCB7IHJldHVybiAwOyB9CgogICAgICBzdGF0aWMgY29uc3RleHBy
IGludCBtaW5fZXhwb25lbnQgPSAwOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtaW5fZXhw
b25lbnQxMCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1heF9leHBvbmVudCA9IDA7
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1heF9leHBvbmVudDEwID0gMDsKCiAgICAgIHN0
YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNfaW5maW5pdHkgPSBmYWxzZTsKICAgICAgc3RhdGljIGNv
bnN0ZXhwciBib29sIGhhc19xdWlldF9OYU4gPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBib29sIGhhc19zaWduYWxpbmdfTmFOID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
ZmxvYXRfZGVub3JtX3N0eWxlIGhhc19kZW5vcm0KICAgICAgID0gZGVub3JtX2Fic2VudDsKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19kZW5vcm1fbG9zcyA9IGZhbHNlOwoKICAgICAg
c3RhdGljIGNvbnN0ZXhwciB1bnNpZ25lZCBzaG9ydAogICAgICBpbmZpbml0eSgpIG5vZXhjZXB0
CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PHVuc2lnbmVkIHNob3J0PigwKTsgfQoKICAgICAg
c3RhdGljIGNvbnN0ZXhwciB1bnNpZ25lZCBzaG9ydAogICAgICBxdWlldF9OYU4oKSBub2V4Y2Vw
dAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDx1bnNpZ25lZCBzaG9ydD4oMCk7IH0KCiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgdW5zaWduZWQgc2hvcnQKICAgICAgc2lnbmFsaW5nX05hTigpIG5v
ZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PHVuc2lnbmVkIHNob3J0PigwKTsgfQoK
ICAgICAgc3RhdGljIGNvbnN0ZXhwciB1bnNpZ25lZCBzaG9ydAogICAgICBkZW5vcm1fbWluKCkg
bm9leGNlcHQKICAgICAgeyByZXR1cm4gc3RhdGljX2Nhc3Q8dW5zaWduZWQgc2hvcnQ+KDApOyB9
CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfaWVjNTU5ID0gZmFsc2U7CiAgICAgIHN0
YXRpYyBjb25zdGV4cHIgYm9vbCBpc19ib3VuZGVkID0gdHJ1ZTsKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBib29sIGlzX21vZHVsbyA9IHRydWU7CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wg
dHJhcHMgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgdGlueW5lc3NfYmVmb3Jl
ID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRfcm91bmRfc3R5bGUgcm91bmRf
c3R5bGUKICAgICAgID0gcm91bmRfdG93YXJkX3plcm87CiAgICB9OwoKCiAgdGVtcGxhdGU8Pgog
ICAgc3RydWN0IG51bWVyaWNfbGltaXRzPGludD4KICAgIHsKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBib29sIGlzX3NwZWNpYWxpemVkID0gdHJ1ZTsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50
CiAgICAgIG1pbigpIG5vZXhjZXB0IHsgcmV0dXJuIC0weDdmZmZmZmZmIC0gMTsgfQoKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBpbnQKICAgICAgbWF4KCkgbm9leGNlcHQgeyByZXR1cm4gMHg3ZmZm
ZmZmZjsgfQoKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50CiAgICAgIGxvd2VzdCgpIG5vZXhj
ZXB0IHsgcmV0dXJuIG1pbigpOyB9CgoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgZGlnaXRz
ID0gKHNpemVvZihpbnQpICogOCAtICgoaW50KSgtMSkgPCAwKSk7CiAgICAgIHN0YXRpYyBjb25z
dGV4cHIgaW50IGRpZ2l0czEwID0gKChzaXplb2YoaW50KSAqIDggLSAoKGludCkoLTEpIDwgMCkp
ICogNjQzTCAvIDIxMzYpOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWF4X2RpZ2l0czEw
ID0gMDsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19zaWduZWQgPSB0cnVlOwogICAg
ICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfaW50ZWdlciA9IHRydWU7CiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgYm9vbCBpc19leGFjdCA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50
IHJhZGl4ID0gMjsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50CiAgICAgIGVwc2lsb24oKSBu
b2V4Y2VwdCB7IHJldHVybiAwOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGludAogICAgICBy
b3VuZF9lcnJvcigpIG5vZXhjZXB0IHsgcmV0dXJuIDA7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4
cHIgaW50IG1pbl9leHBvbmVudCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1pbl9l
eHBvbmVudDEwID0gMDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWF4X2V4cG9uZW50ID0g
MDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWF4X2V4cG9uZW50MTAgPSAwOwoKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19pbmZpbml0eSA9IGZhbHNlOwogICAgICBzdGF0aWMg
Y29uc3RleHByIGJvb2wgaGFzX3F1aWV0X05hTiA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3Rl
eHByIGJvb2wgaGFzX3NpZ25hbGluZ19OYU4gPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBmbG9hdF9kZW5vcm1fc3R5bGUgaGFzX2Rlbm9ybQogICAgICAgPSBkZW5vcm1fYWJzZW50Owog
ICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFzX2Rlbm9ybV9sb3NzID0gZmFsc2U7CgogICAg
ICBzdGF0aWMgY29uc3RleHByIGludAogICAgICBpbmZpbml0eSgpIG5vZXhjZXB0IHsgcmV0dXJu
IHN0YXRpY19jYXN0PGludD4oMCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50CiAgICAg
IHF1aWV0X05hTigpIG5vZXhjZXB0IHsgcmV0dXJuIHN0YXRpY19jYXN0PGludD4oMCk7IH0KCiAg
ICAgIHN0YXRpYyBjb25zdGV4cHIgaW50CiAgICAgIHNpZ25hbGluZ19OYU4oKSBub2V4Y2VwdCB7
IHJldHVybiBzdGF0aWNfY2FzdDxpbnQ+KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGlu
dAogICAgICBkZW5vcm1fbWluKCkgbm9leGNlcHQgeyByZXR1cm4gc3RhdGljX2Nhc3Q8aW50Pigw
KTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2llYzU1OSA9IGZhbHNlOwogICAg
ICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfYm91bmRlZCA9IHRydWU7CiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgYm9vbCBpc19tb2R1bG8gPSBmYWxzZTsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
Ym9vbCB0cmFwcyA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCB0aW55bmVzc19i
ZWZvcmUgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBmbG9hdF9yb3VuZF9zdHlsZSBy
b3VuZF9zdHlsZQogICAgICAgPSByb3VuZF90b3dhcmRfemVybzsKICAgIH07CgoKICB0ZW1wbGF0
ZTw+CiAgICBzdHJ1Y3QgbnVtZXJpY19saW1pdHM8dW5zaWduZWQgaW50PgogICAgewogICAgICBz
dGF0aWMgY29uc3RleHByIGJvb2wgaXNfc3BlY2lhbGl6ZWQgPSB0cnVlOwoKICAgICAgc3RhdGlj
IGNvbnN0ZXhwciB1bnNpZ25lZCBpbnQKICAgICAgbWluKCkgbm9leGNlcHQgeyByZXR1cm4gMDsg
fQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB1bnNpZ25lZCBpbnQKICAgICAgbWF4KCkgbm9leGNl
cHQgeyByZXR1cm4gMHg3ZmZmZmZmZiAqIDJVICsgMTsgfQoKCiAgICAgIHN0YXRpYyBjb25zdGV4
cHIgdW5zaWduZWQgaW50CiAgICAgIGxvd2VzdCgpIG5vZXhjZXB0IHsgcmV0dXJuIG1pbigpOyB9
CgoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgZGlnaXRzCiAgICAgICA9IChzaXplb2YodW5z
aWduZWQgaW50KSAqIDggLSAoKHVuc2lnbmVkIGludCkoLTEpIDwgMCkpOwogICAgICBzdGF0aWMg
Y29uc3RleHByIGludCBkaWdpdHMxMAogICAgICAgPSAoKHNpemVvZih1bnNpZ25lZCBpbnQpICog
OCAtICgodW5zaWduZWQgaW50KSgtMSkgPCAwKSkgKiA2NDNMIC8gMjEzNik7CgogICAgICBzdGF0
aWMgY29uc3RleHByIGludCBtYXhfZGlnaXRzMTAgPSAwOwoKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBib29sIGlzX3NpZ25lZCA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNf
aW50ZWdlciA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19leGFjdCA9IHRy
dWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IHJhZGl4ID0gMjsKCiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgdW5zaWduZWQgaW50CiAgICAgIGVwc2lsb24oKSBub2V4Y2VwdCB7IHJldHVybiAw
OyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIHVuc2lnbmVkIGludAogICAgICByb3VuZF9lcnJv
cigpIG5vZXhjZXB0IHsgcmV0dXJuIDA7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1p
bl9leHBvbmVudCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1pbl9leHBvbmVudDEw
ID0gMDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWF4X2V4cG9uZW50ID0gMDsKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBpbnQgbWF4X2V4cG9uZW50MTAgPSAwOwoKICAgICAgc3RhdGljIGNv
bnN0ZXhwciBib29sIGhhc19pbmZpbml0eSA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHBy
IGJvb2wgaGFzX3F1aWV0X05hTiA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wg
aGFzX3NpZ25hbGluZ19OYU4gPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBmbG9hdF9k
ZW5vcm1fc3R5bGUgaGFzX2Rlbm9ybQogICAgICAgPSBkZW5vcm1fYWJzZW50OwogICAgICBzdGF0
aWMgY29uc3RleHByIGJvb2wgaGFzX2Rlbm9ybV9sb3NzID0gZmFsc2U7CgogICAgICBzdGF0aWMg
Y29uc3RleHByIHVuc2lnbmVkIGludAogICAgICBpbmZpbml0eSgpIG5vZXhjZXB0IHsgcmV0dXJu
IHN0YXRpY19jYXN0PHVuc2lnbmVkIGludD4oMCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
dW5zaWduZWQgaW50CiAgICAgIHF1aWV0X05hTigpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0
YXRpY19jYXN0PHVuc2lnbmVkIGludD4oMCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgdW5z
aWduZWQgaW50CiAgICAgIHNpZ25hbGluZ19OYU4oKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBz
dGF0aWNfY2FzdDx1bnNpZ25lZCBpbnQ+KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIHVu
c2lnbmVkIGludAogICAgICBkZW5vcm1fbWluKCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc3Rh
dGljX2Nhc3Q8dW5zaWduZWQgaW50PigwKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29s
IGlzX2llYzU1OSA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfYm91bmRl
ZCA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19tb2R1bG8gPSB0cnVlOwoK
ICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIHRyYXBzID0gdHJ1ZTsKICAgICAgc3RhdGljIGNv
bnN0ZXhwciBib29sIHRpbnluZXNzX2JlZm9yZSA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3Rl
eHByIGZsb2F0X3JvdW5kX3N0eWxlIHJvdW5kX3N0eWxlCiAgICAgICA9IHJvdW5kX3Rvd2FyZF96
ZXJvOwogICAgfTsKCgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBudW1lcmljX2xpbWl0czxsb25n
PgogICAgewogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfc3BlY2lhbGl6ZWQgPSB0cnVl
OwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBsb25nCiAgICAgIG1pbigpIG5vZXhjZXB0IHsgcmV0
dXJuIC0weDdmZmZmZmZmZmZmZmZmZmZMIC0gMTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBs
b25nCiAgICAgIG1heCgpIG5vZXhjZXB0IHsgcmV0dXJuIDB4N2ZmZmZmZmZmZmZmZmZmZkw7IH0K
CgogICAgICBzdGF0aWMgY29uc3RleHByIGxvbmcKICAgICAgbG93ZXN0KCkgbm9leGNlcHQgeyBy
ZXR1cm4gbWluKCk7IH0KCgogICAgICBzdGF0aWMgY29uc3RleHByIGludCBkaWdpdHMgPSAoc2l6
ZW9mKGxvbmcpICogOCAtICgobG9uZykoLTEpIDwgMCkpOwogICAgICBzdGF0aWMgY29uc3RleHBy
IGludCBkaWdpdHMxMCA9ICgoc2l6ZW9mKGxvbmcpICogOCAtICgobG9uZykoLTEpIDwgMCkpICog
NjQzTCAvIDIxMzYpOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWF4X2RpZ2l0czEwID0g
MDsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19zaWduZWQgPSB0cnVlOwogICAgICBz
dGF0aWMgY29uc3RleHByIGJvb2wgaXNfaW50ZWdlciA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25z
dGV4cHIgYm9vbCBpc19leGFjdCA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IHJh
ZGl4ID0gMjsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgbG9uZwogICAgICBlcHNpbG9uKCkgbm9l
eGNlcHQgeyByZXR1cm4gMDsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBsb25nCiAgICAgIHJv
dW5kX2Vycm9yKCkgbm9leGNlcHQgeyByZXR1cm4gMDsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBpbnQgbWluX2V4cG9uZW50ID0gMDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWluX2V4
cG9uZW50MTAgPSAwOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZXhwb25lbnQgPSAw
OwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZXhwb25lbnQxMCA9IDA7CgogICAgICBz
dGF0aWMgY29uc3RleHByIGJvb2wgaGFzX2luZmluaXR5ID0gZmFsc2U7CiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgYm9vbCBoYXNfcXVpZXRfTmFOID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4
cHIgYm9vbCBoYXNfc2lnbmFsaW5nX05hTiA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHBy
IGZsb2F0X2Rlbm9ybV9zdHlsZSBoYXNfZGVub3JtCiAgICAgICA9IGRlbm9ybV9hYnNlbnQ7CiAg
ICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNfZGVub3JtX2xvc3MgPSBmYWxzZTsKCiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgbG9uZwogICAgICBpbmZpbml0eSgpIG5vZXhjZXB0IHsgcmV0dXJu
IHN0YXRpY19jYXN0PGxvbmc+KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGxvbmcKICAg
ICAgcXVpZXRfTmFOKCkgbm9leGNlcHQgeyByZXR1cm4gc3RhdGljX2Nhc3Q8bG9uZz4oMCk7IH0K
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgbG9uZwogICAgICBzaWduYWxpbmdfTmFOKCkgbm9leGNl
cHQgeyByZXR1cm4gc3RhdGljX2Nhc3Q8bG9uZz4oMCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4
cHIgbG9uZwogICAgICBkZW5vcm1fbWluKCkgbm9leGNlcHQgeyByZXR1cm4gc3RhdGljX2Nhc3Q8
bG9uZz4oMCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19pZWM1NTkgPSBmYWxz
ZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2JvdW5kZWQgPSB0cnVlOwogICAgICBz
dGF0aWMgY29uc3RleHByIGJvb2wgaXNfbW9kdWxvID0gZmFsc2U7CgogICAgICBzdGF0aWMgY29u
c3RleHByIGJvb2wgdHJhcHMgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgdGlu
eW5lc3NfYmVmb3JlID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRfcm91bmRf
c3R5bGUgcm91bmRfc3R5bGUKICAgICAgID0gcm91bmRfdG93YXJkX3plcm87CiAgICB9OwoKCiAg
dGVtcGxhdGU8PgogICAgc3RydWN0IG51bWVyaWNfbGltaXRzPHVuc2lnbmVkIGxvbmc+CiAgICB7
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19zcGVjaWFsaXplZCA9IHRydWU7CgogICAg
ICBzdGF0aWMgY29uc3RleHByIHVuc2lnbmVkIGxvbmcKICAgICAgbWluKCkgbm9leGNlcHQgeyBy
ZXR1cm4gMDsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB1bnNpZ25lZCBsb25nCiAgICAgIG1h
eCgpIG5vZXhjZXB0IHsgcmV0dXJuIDB4N2ZmZmZmZmZmZmZmZmZmZkwgKiAyVUwgKyAxOyB9CgoK
ICAgICAgc3RhdGljIGNvbnN0ZXhwciB1bnNpZ25lZCBsb25nCiAgICAgIGxvd2VzdCgpIG5vZXhj
ZXB0IHsgcmV0dXJuIG1pbigpOyB9CgoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgZGlnaXRz
CiAgICAgICA9IChzaXplb2YodW5zaWduZWQgbG9uZykgKiA4IC0gKCh1bnNpZ25lZCBsb25nKSgt
MSkgPCAwKSk7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IGRpZ2l0czEwCiAgICAgICA9ICgo
c2l6ZW9mKHVuc2lnbmVkIGxvbmcpICogOCAtICgodW5zaWduZWQgbG9uZykoLTEpIDwgMCkpICog
NjQzTCAvIDIxMzYpOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWF4X2RpZ2l0czEwID0g
MDsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19zaWduZWQgPSBmYWxzZTsKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2ludGVnZXIgPSB0cnVlOwogICAgICBzdGF0aWMgY29u
c3RleHByIGJvb2wgaXNfZXhhY3QgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBy
YWRpeCA9IDI7CgogICAgICBzdGF0aWMgY29uc3RleHByIHVuc2lnbmVkIGxvbmcKICAgICAgZXBz
aWxvbigpIG5vZXhjZXB0IHsgcmV0dXJuIDA7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgdW5z
aWduZWQgbG9uZwogICAgICByb3VuZF9lcnJvcigpIG5vZXhjZXB0IHsgcmV0dXJuIDA7IH0KCiAg
ICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1pbl9leHBvbmVudCA9IDA7CiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgaW50IG1pbl9leHBvbmVudDEwID0gMDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBp
bnQgbWF4X2V4cG9uZW50ID0gMDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgbWF4X2V4cG9u
ZW50MTAgPSAwOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19pbmZpbml0eSA9IGZh
bHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFzX3F1aWV0X05hTiA9IGZhbHNlOwog
ICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFzX3NpZ25hbGluZ19OYU4gPSBmYWxzZTsKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBmbG9hdF9kZW5vcm1fc3R5bGUgaGFzX2Rlbm9ybQogICAgICAg
PSBkZW5vcm1fYWJzZW50OwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFzX2Rlbm9ybV9s
b3NzID0gZmFsc2U7CgogICAgICBzdGF0aWMgY29uc3RleHByIHVuc2lnbmVkIGxvbmcKICAgICAg
aW5maW5pdHkoKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDx1bnNpZ25lZCBs
b25nPigwKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB1bnNpZ25lZCBsb25nCiAgICAgIHF1
aWV0X05hTigpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PHVuc2lnbmVkIGxv
bmc+KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIHVuc2lnbmVkIGxvbmcKICAgICAgc2ln
bmFsaW5nX05hTigpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PHVuc2lnbmVk
IGxvbmc+KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIHVuc2lnbmVkIGxvbmcKICAgICAg
ZGVub3JtX21pbigpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PHVuc2lnbmVk
IGxvbmc+KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfaWVjNTU5ID0gZmFs
c2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19ib3VuZGVkID0gdHJ1ZTsKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBib29sIGlzX21vZHVsbyA9IHRydWU7CgogICAgICBzdGF0aWMgY29u
c3RleHByIGJvb2wgdHJhcHMgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgdGlu
eW5lc3NfYmVmb3JlID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRfcm91bmRf
c3R5bGUgcm91bmRfc3R5bGUKICAgICAgID0gcm91bmRfdG93YXJkX3plcm87CiAgICB9OwoKCiAg
dGVtcGxhdGU8PgogICAgc3RydWN0IG51bWVyaWNfbGltaXRzPGxvbmcgbG9uZz4KICAgIHsKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX3NwZWNpYWxpemVkID0gdHJ1ZTsKCiAgICAgIHN0
YXRpYyBjb25zdGV4cHIgbG9uZyBsb25nCiAgICAgIG1pbigpIG5vZXhjZXB0IHsgcmV0dXJuIC0w
eDdmZmZmZmZmZmZmZmZmZmZMTCAtIDE7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgbG9uZyBs
b25nCiAgICAgIG1heCgpIG5vZXhjZXB0IHsgcmV0dXJuIDB4N2ZmZmZmZmZmZmZmZmZmZkxMOyB9
CgoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBsb25nIGxvbmcKICAgICAgbG93ZXN0KCkgbm9leGNl
cHQgeyByZXR1cm4gbWluKCk7IH0KCgogICAgICBzdGF0aWMgY29uc3RleHByIGludCBkaWdpdHMK
ICAgICAgID0gKHNpemVvZihsb25nIGxvbmcpICogOCAtICgobG9uZyBsb25nKSgtMSkgPCAwKSk7
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IGRpZ2l0czEwCiAgICAgICA9ICgoc2l6ZW9mKGxv
bmcgbG9uZykgKiA4IC0gKChsb25nIGxvbmcpKC0xKSA8IDApKSAqIDY0M0wgLyAyMTM2KTsKCiAg
ICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1heF9kaWdpdHMxMCA9IDA7CgogICAgICBzdGF0aWMg
Y29uc3RleHByIGJvb2wgaXNfc2lnbmVkID0gdHJ1ZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBi
b29sIGlzX2ludGVnZXIgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfZXhh
Y3QgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCByYWRpeCA9IDI7CgogICAgICBz
dGF0aWMgY29uc3RleHByIGxvbmcgbG9uZwogICAgICBlcHNpbG9uKCkgbm9leGNlcHQgeyByZXR1
cm4gMDsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBsb25nIGxvbmcKICAgICAgcm91bmRfZXJy
b3IoKSBub2V4Y2VwdCB7IHJldHVybiAwOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGludCBt
aW5fZXhwb25lbnQgPSAwOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtaW5fZXhwb25lbnQx
MCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1heF9leHBvbmVudCA9IDA7CiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgaW50IG1heF9leHBvbmVudDEwID0gMDsKCiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgYm9vbCBoYXNfaW5maW5pdHkgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBib29sIGhhc19xdWlldF9OYU4gPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29s
IGhhc19zaWduYWxpbmdfTmFOID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRf
ZGVub3JtX3N0eWxlIGhhc19kZW5vcm0KICAgICAgID0gZGVub3JtX2Fic2VudDsKICAgICAgc3Rh
dGljIGNvbnN0ZXhwciBib29sIGhhc19kZW5vcm1fbG9zcyA9IGZhbHNlOwoKICAgICAgc3RhdGlj
IGNvbnN0ZXhwciBsb25nIGxvbmcKICAgICAgaW5maW5pdHkoKSBub2V4Y2VwdCB7IHJldHVybiBz
dGF0aWNfY2FzdDxsb25nIGxvbmc+KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGxvbmcg
bG9uZwogICAgICBxdWlldF9OYU4oKSBub2V4Y2VwdCB7IHJldHVybiBzdGF0aWNfY2FzdDxsb25n
IGxvbmc+KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGxvbmcgbG9uZwogICAgICBzaWdu
YWxpbmdfTmFOKCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc3RhdGljX2Nhc3Q8bG9uZyBsb25n
PigwKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBsb25nIGxvbmcKICAgICAgZGVub3JtX21p
bigpIG5vZXhjZXB0IHsgcmV0dXJuIHN0YXRpY19jYXN0PGxvbmcgbG9uZz4oMCk7IH0KCiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19pZWM1NTkgPSBmYWxzZTsKICAgICAgc3RhdGljIGNv
bnN0ZXhwciBib29sIGlzX2JvdW5kZWQgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJv
b2wgaXNfbW9kdWxvID0gZmFsc2U7CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgdHJhcHMg
PSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgdGlueW5lc3NfYmVmb3JlID0gZmFs
c2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRfcm91bmRfc3R5bGUgcm91bmRfc3R5bGUK
ICAgICAgID0gcm91bmRfdG93YXJkX3plcm87CiAgICB9OwoKCiAgdGVtcGxhdGU8PgogICAgc3Ry
dWN0IG51bWVyaWNfbGltaXRzPHVuc2lnbmVkIGxvbmcgbG9uZz4KICAgIHsKICAgICAgc3RhdGlj
IGNvbnN0ZXhwciBib29sIGlzX3NwZWNpYWxpemVkID0gdHJ1ZTsKCiAgICAgIHN0YXRpYyBjb25z
dGV4cHIgdW5zaWduZWQgbG9uZyBsb25nCiAgICAgIG1pbigpIG5vZXhjZXB0IHsgcmV0dXJuIDA7
IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgdW5zaWduZWQgbG9uZyBsb25nCiAgICAgIG1heCgp
IG5vZXhjZXB0IHsgcmV0dXJuIDB4N2ZmZmZmZmZmZmZmZmZmZkxMICogMlVMTCArIDE7IH0KCgog
ICAgICBzdGF0aWMgY29uc3RleHByIHVuc2lnbmVkIGxvbmcgbG9uZwogICAgICBsb3dlc3QoKSBu
b2V4Y2VwdCB7IHJldHVybiBtaW4oKTsgfQoKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IGRp
Z2l0cwogICAgICAgPSAoc2l6ZW9mKHVuc2lnbmVkIGxvbmcgbG9uZykgKiA4IC0gKCh1bnNpZ25l
ZCBsb25nIGxvbmcpKC0xKSA8IDApKTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgZGlnaXRz
MTAKICAgICAgID0gKChzaXplb2YodW5zaWduZWQgbG9uZyBsb25nKSAqIDggLSAoKHVuc2lnbmVk
IGxvbmcgbG9uZykoLTEpIDwgMCkpICogNjQzTCAvIDIxMzYpOwoKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBpbnQgbWF4X2RpZ2l0czEwID0gMDsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBp
c19zaWduZWQgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2ludGVnZXIg
PSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfZXhhY3QgPSB0cnVlOwogICAg
ICBzdGF0aWMgY29uc3RleHByIGludCByYWRpeCA9IDI7CgogICAgICBzdGF0aWMgY29uc3RleHBy
IHVuc2lnbmVkIGxvbmcgbG9uZwogICAgICBlcHNpbG9uKCkgbm9leGNlcHQgeyByZXR1cm4gMDsg
fQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB1bnNpZ25lZCBsb25nIGxvbmcKICAgICAgcm91bmRf
ZXJyb3IoKSBub2V4Y2VwdCB7IHJldHVybiAwOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGlu
dCBtaW5fZXhwb25lbnQgPSAwOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtaW5fZXhwb25l
bnQxMCA9IDA7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1heF9leHBvbmVudCA9IDA7CiAg
ICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1heF9leHBvbmVudDEwID0gMDsKCiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgYm9vbCBoYXNfaW5maW5pdHkgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBib29sIGhhc19xdWlldF9OYU4gPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBi
b29sIGhhc19zaWduYWxpbmdfTmFOID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxv
YXRfZGVub3JtX3N0eWxlIGhhc19kZW5vcm0KICAgICAgID0gZGVub3JtX2Fic2VudDsKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBib29sIGhhc19kZW5vcm1fbG9zcyA9IGZhbHNlOwoKICAgICAgc3Rh
dGljIGNvbnN0ZXhwciB1bnNpZ25lZCBsb25nIGxvbmcKICAgICAgaW5maW5pdHkoKSBub2V4Y2Vw
dAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDx1bnNpZ25lZCBsb25nIGxvbmc+KDApOyB9Cgog
ICAgICBzdGF0aWMgY29uc3RleHByIHVuc2lnbmVkIGxvbmcgbG9uZwogICAgICBxdWlldF9OYU4o
KSBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDx1bnNpZ25lZCBsb25nIGxvbmc+
KDApOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIHVuc2lnbmVkIGxvbmcgbG9uZwogICAgICBz
aWduYWxpbmdfTmFOKCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc3RhdGljX2Nhc3Q8dW5zaWdu
ZWQgbG9uZyBsb25nPigwKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB1bnNpZ25lZCBsb25n
IGxvbmcKICAgICAgZGVub3JtX21pbigpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0YXRpY19j
YXN0PHVuc2lnbmVkIGxvbmcgbG9uZz4oMCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9v
bCBpc19pZWM1NTkgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2JvdW5k
ZWQgPSB0cnVlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfbW9kdWxvID0gdHJ1ZTsK
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCB0cmFwcyA9IHRydWU7CiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgYm9vbCB0aW55bmVzc19iZWZvcmUgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBmbG9hdF9yb3VuZF9zdHlsZSByb3VuZF9zdHlsZQogICAgICAgPSByb3VuZF90b3dhcmRf
emVybzsKICAgIH07CiMgMTU5MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9saW1pdHMiIDMKICB0
ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgbnVtZXJpY19saW1pdHM8ZmxvYXQ+CiAgICB7CiAgICAgIHN0
YXRpYyBjb25zdGV4cHIgYm9vbCBpc19zcGVjaWFsaXplZCA9IHRydWU7CgogICAgICBzdGF0aWMg
Y29uc3RleHByIGZsb2F0CiAgICAgIG1pbigpIG5vZXhjZXB0IHsgcmV0dXJuIDEuMTc1NDk0MzUw
ODIyMjg3NTA3OTY4NzM2NTM3MjIyMjQ1NjhlLTM4RjsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBmbG9hdAogICAgICBtYXgoKSBub2V4Y2VwdCB7IHJldHVybiAzLjQwMjgyMzQ2NjM4NTI4ODU5
ODExNzA0MTgzNDg0NTE2OTI1ZSszOEY7IH0KCgogICAgICBzdGF0aWMgY29uc3RleHByIGZsb2F0
CiAgICAgIGxvd2VzdCgpIG5vZXhjZXB0IHsgcmV0dXJuIC0zLjQwMjgyMzQ2NjM4NTI4ODU5ODEx
NzA0MTgzNDg0NTE2OTI1ZSszOEY7IH0KCgogICAgICBzdGF0aWMgY29uc3RleHByIGludCBkaWdp
dHMgPSAyNDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgZGlnaXRzMTAgPSA2OwoKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBpbnQgbWF4X2RpZ2l0czEwCiAgPSAoMiArICgyNCkgKiA2NDNMIC8g
MjEzNik7CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfc2lnbmVkID0gdHJ1ZTsKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2ludGVnZXIgPSBmYWxzZTsKICAgICAgc3RhdGlj
IGNvbnN0ZXhwciBib29sIGlzX2V4YWN0ID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
aW50IHJhZGl4ID0gMjsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXQKICAgICAgZXBzaWxv
bigpIG5vZXhjZXB0IHsgcmV0dXJuIDEuMTkyMDkyODk1NTA3ODEyNTAwMDAwMDAwMDAwMDAwMDAw
MDBlLTdGOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGZsb2F0CiAgICAgIHJvdW5kX2Vycm9y
KCkgbm9leGNlcHQgeyByZXR1cm4gMC41RjsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQg
bWluX2V4cG9uZW50ID0gKC0xMjUpOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtaW5fZXhw
b25lbnQxMCA9ICgtMzcpOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZXhwb25lbnQg
PSAxMjg7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1heF9leHBvbmVudDEwID0gMzg7Cgog
ICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFzX2luZmluaXR5ID0gMTsKICAgICAgc3RhdGlj
IGNvbnN0ZXhwciBib29sIGhhc19xdWlldF9OYU4gPSAxOwogICAgICBzdGF0aWMgY29uc3RleHBy
IGJvb2wgaGFzX3NpZ25hbGluZ19OYU4gPSBoYXNfcXVpZXRfTmFOOwogICAgICBzdGF0aWMgY29u
c3RleHByIGZsb2F0X2Rlbm9ybV9zdHlsZSBoYXNfZGVub3JtCiA9IGJvb2woMSkgPyBkZW5vcm1f
cHJlc2VudCA6IGRlbm9ybV9hYnNlbnQ7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNf
ZGVub3JtX2xvc3MKICAgICAgID0gZmFsc2U7CgogICAgICBzdGF0aWMgY29uc3RleHByIGZsb2F0
CiAgICAgIGluZmluaXR5KCkgbm9leGNlcHQgeyByZXR1cm4gX19idWlsdGluX2h1Z2VfdmFsZigp
OyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGZsb2F0CiAgICAgIHF1aWV0X05hTigpIG5vZXhj
ZXB0IHsgcmV0dXJuIF9fYnVpbHRpbl9uYW5mKCIiKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBmbG9hdAogICAgICBzaWduYWxpbmdfTmFOKCkgbm9leGNlcHQgeyByZXR1cm4gX19idWlsdGlu
X25hbnNmKCIiKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBmbG9hdAogICAgICBkZW5vcm1f
bWluKCkgbm9leGNlcHQgeyByZXR1cm4gMS40MDEyOTg0NjQzMjQ4MTcwNzA5MjM3Mjk1ODMyODk5
MTYxM2UtNDVGOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfaWVjNTU5CiA9IGhh
c19pbmZpbml0eSAmJiBoYXNfcXVpZXRfTmFOICYmIGhhc19kZW5vcm0gPT0gZGVub3JtX3ByZXNl
bnQ7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19ib3VuZGVkID0gdHJ1ZTsKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBib29sIGlzX21vZHVsbyA9IGZhbHNlOwoKICAgICAgc3RhdGljIGNv
bnN0ZXhwciBib29sIHRyYXBzID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCB0
aW55bmVzc19iZWZvcmUKICAgICAgID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxv
YXRfcm91bmRfc3R5bGUgcm91bmRfc3R5bGUKICAgICAgID0gcm91bmRfdG9fbmVhcmVzdDsKICAg
IH07CgoKCgoKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IG51bWVyaWNfbGltaXRzPGRvdWJsZT4K
ICAgIHsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX3NwZWNpYWxpemVkID0gdHJ1ZTsK
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZG91YmxlCiAgICAgIG1pbigpIG5vZXhjZXB0IHsgcmV0
dXJuIGRvdWJsZSgyLjIyNTA3Mzg1ODUwNzIwMTM4MzA5MDIzMjcxNzMzMjQwNDA2ZS0zMDhMKTsg
fQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBkb3VibGUKICAgICAgbWF4KCkgbm9leGNlcHQgeyBy
ZXR1cm4gZG91YmxlKDEuNzk3NjkzMTM0ODYyMzE1NzA4MTQ1Mjc0MjM3MzE3MDQzNTdlKzMwOEwp
OyB9CgoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBkb3VibGUKICAgICAgbG93ZXN0KCkgbm9leGNl
cHQgeyByZXR1cm4gLWRvdWJsZSgxLjc5NzY5MzEzNDg2MjMxNTcwODE0NTI3NDIzNzMxNzA0MzU3
ZSszMDhMKTsgfQoKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IGRpZ2l0cyA9IDUzOwogICAg
ICBzdGF0aWMgY29uc3RleHByIGludCBkaWdpdHMxMCA9IDE1OwoKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBpbnQgbWF4X2RpZ2l0czEwCiAgPSAoMiArICg1MykgKiA2NDNMIC8gMjEzNik7CgogICAg
ICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfc2lnbmVkID0gdHJ1ZTsKICAgICAgc3RhdGljIGNv
bnN0ZXhwciBib29sIGlzX2ludGVnZXIgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBi
b29sIGlzX2V4YWN0ID0gZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IHJhZGl4ID0g
MjsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZG91YmxlCiAgICAgIGVwc2lsb24oKSBub2V4Y2Vw
dCB7IHJldHVybiBkb3VibGUoMi4yMjA0NDYwNDkyNTAzMTMwODA4NDcyNjMzMzYxODE2NDA2MmUt
MTZMKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBkb3VibGUKICAgICAgcm91bmRfZXJyb3Io
KSBub2V4Y2VwdCB7IHJldHVybiAwLjU7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1p
bl9leHBvbmVudCA9ICgtMTAyMSk7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1pbl9leHBv
bmVudDEwID0gKC0zMDcpOwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZXhwb25lbnQg
PSAxMDI0OwogICAgICBzdGF0aWMgY29uc3RleHByIGludCBtYXhfZXhwb25lbnQxMCA9IDMwODsK
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNfaW5maW5pdHkgPSAxOwogICAgICBzdGF0
aWMgY29uc3RleHByIGJvb2wgaGFzX3F1aWV0X05hTiA9IDE7CiAgICAgIHN0YXRpYyBjb25zdGV4
cHIgYm9vbCBoYXNfc2lnbmFsaW5nX05hTiA9IGhhc19xdWlldF9OYU47CiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgZmxvYXRfZGVub3JtX3N0eWxlIGhhc19kZW5vcm0KID0gYm9vbCgxKSA/IGRlbm9y
bV9wcmVzZW50IDogZGVub3JtX2Fic2VudDsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGhh
c19kZW5vcm1fbG9zcwogICAgICAgID0gZmFsc2U7CgogICAgICBzdGF0aWMgY29uc3RleHByIGRv
dWJsZQogICAgICBpbmZpbml0eSgpIG5vZXhjZXB0IHsgcmV0dXJuIF9fYnVpbHRpbl9odWdlX3Zh
bCgpOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGRvdWJsZQogICAgICBxdWlldF9OYU4oKSBu
b2V4Y2VwdCB7IHJldHVybiBfX2J1aWx0aW5fbmFuKCIiKTsgfQoKICAgICAgc3RhdGljIGNvbnN0
ZXhwciBkb3VibGUKICAgICAgc2lnbmFsaW5nX05hTigpIG5vZXhjZXB0IHsgcmV0dXJuIF9fYnVp
bHRpbl9uYW5zKCIiKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBkb3VibGUKICAgICAgZGVu
b3JtX21pbigpIG5vZXhjZXB0IHsgcmV0dXJuIGRvdWJsZSg0Ljk0MDY1NjQ1ODQxMjQ2NTQ0MTc2
NTY4NzkyODY4MjIxMzcyZS0zMjRMKTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlz
X2llYzU1OQogPSBoYXNfaW5maW5pdHkgJiYgaGFzX3F1aWV0X05hTiAmJiBoYXNfZGVub3JtID09
IGRlbm9ybV9wcmVzZW50OwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfYm91bmRlZCA9
IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19tb2R1bG8gPSBmYWxzZTsKCiAg
ICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCB0cmFwcyA9IGZhbHNlOwogICAgICBzdGF0aWMgY29u
c3RleHByIGJvb2wgdGlueW5lc3NfYmVmb3JlCiAgICAgICA9IGZhbHNlOwogICAgICBzdGF0aWMg
Y29uc3RleHByIGZsb2F0X3JvdW5kX3N0eWxlIHJvdW5kX3N0eWxlCiAgICAgICA9IHJvdW5kX3Rv
X25lYXJlc3Q7CiAgICB9OwoKCgoKCgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBudW1lcmljX2xp
bWl0czxsb25nIGRvdWJsZT4KICAgIHsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX3Nw
ZWNpYWxpemVkID0gdHJ1ZTsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgbG9uZyBkb3VibGUKICAg
ICAgbWluKCkgbm9leGNlcHQgeyByZXR1cm4gMy4zNjIxMDMxNDMxMTIwOTM1MDYyNjI2Nzc4MTcz
MjE3NTI2MGUtNDkzMkw7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgbG9uZyBkb3VibGUKICAg
ICAgbWF4KCkgbm9leGNlcHQgeyByZXR1cm4gMS4xODk3MzE0OTUzNTcyMzE3NjUwODU3NTkzMjY2
MjgwMDcwMmUrNDkzMkw7IH0KCgogICAgICBzdGF0aWMgY29uc3RleHByIGxvbmcgZG91YmxlCiAg
ICAgIGxvd2VzdCgpIG5vZXhjZXB0IHsgcmV0dXJuIC0xLjE4OTczMTQ5NTM1NzIzMTc2NTA4NTc1
OTMyNjYyODAwNzAyZSs0OTMyTDsgfQoKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IGRpZ2l0
cyA9IDExMzsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnQgZGlnaXRzMTAgPSAzMzsKCiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgaW50IG1heF9kaWdpdHMxMAogID0gKDIgKyAoMTEzKSAqIDY0M0wg
LyAyMTM2KTsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBpc19zaWduZWQgPSB0cnVlOwog
ICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaXNfaW50ZWdlciA9IGZhbHNlOwogICAgICBzdGF0
aWMgY29uc3RleHByIGJvb2wgaXNfZXhhY3QgPSBmYWxzZTsKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBpbnQgcmFkaXggPSAyOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBsb25nIGRvdWJsZQogICAg
ICBlcHNpbG9uKCkgbm9leGNlcHQgeyByZXR1cm4gMS45MjU5Mjk5NDQzODcyMzU4NTMwNTU5Nzc5
NDI1ODQ5MjczMmUtMzRMOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGxvbmcgZG91YmxlCiAg
ICAgIHJvdW5kX2Vycm9yKCkgbm9leGNlcHQgeyByZXR1cm4gMC41TDsgfQoKICAgICAgc3RhdGlj
IGNvbnN0ZXhwciBpbnQgbWluX2V4cG9uZW50ID0gKC0xNjM4MSk7CiAgICAgIHN0YXRpYyBjb25z
dGV4cHIgaW50IG1pbl9leHBvbmVudDEwID0gKC00OTMxKTsKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBpbnQgbWF4X2V4cG9uZW50ID0gMTYzODQ7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50IG1h
eF9leHBvbmVudDEwID0gNDkzMjsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNfaW5m
aW5pdHkgPSAxOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgaGFzX3F1aWV0X05hTiA9IDE7
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBoYXNfc2lnbmFsaW5nX05hTiA9IGhhc19xdWll
dF9OYU47CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRfZGVub3JtX3N0eWxlIGhhc19kZW5v
cm0KID0gYm9vbCgxKSA/IGRlbm9ybV9wcmVzZW50IDogZGVub3JtX2Fic2VudDsKICAgICAgc3Rh
dGljIGNvbnN0ZXhwciBib29sIGhhc19kZW5vcm1fbG9zcwogPSBmYWxzZTsKCiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgbG9uZyBkb3VibGUKICAgICAgaW5maW5pdHkoKSBub2V4Y2VwdCB7IHJldHVy
biBfX2J1aWx0aW5faHVnZV92YWxsKCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgbG9uZyBk
b3VibGUKICAgICAgcXVpZXRfTmFOKCkgbm9leGNlcHQgeyByZXR1cm4gX19idWlsdGluX25hbmwo
IiIpOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGxvbmcgZG91YmxlCiAgICAgIHNpZ25hbGlu
Z19OYU4oKSBub2V4Y2VwdCB7IHJldHVybiBfX2J1aWx0aW5fbmFuc2woIiIpOyB9CgogICAgICBz
dGF0aWMgY29uc3RleHByIGxvbmcgZG91YmxlCiAgICAgIGRlbm9ybV9taW4oKSBub2V4Y2VwdCB7
IHJldHVybiA2LjQ3NTE3NTExOTQzODAyNTExMDkyNDQzODk1ODIyNzY0NjU1ZS00OTY2TDsgfQoK
ICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sIGlzX2llYzU1OQogPSBoYXNfaW5maW5pdHkgJiYg
aGFzX3F1aWV0X05hTiAmJiBoYXNfZGVub3JtID09IGRlbm9ybV9wcmVzZW50OwogICAgICBzdGF0
aWMgY29uc3RleHByIGJvb2wgaXNfYm91bmRlZCA9IHRydWU7CiAgICAgIHN0YXRpYyBjb25zdGV4
cHIgYm9vbCBpc19tb2R1bG8gPSBmYWxzZTsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCB0
cmFwcyA9IGZhbHNlOwogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgdGlueW5lc3NfYmVmb3Jl
ID0KICAgICAgZmFsc2U7CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgZmxvYXRfcm91bmRfc3R5bGUg
cm91bmRfc3R5bGUgPQogICAgICAgICAgICByb3VuZF90b19uZWFyZXN0OwogICAgfTsKCgoKCgoK
fQojIDM2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvdW5pZm9ybV9pbnRfZGlzdC5oIiAy
IDMKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVs
dCIpKSkKewoKCiAgbmFtZXNwYWNlIF9fZGV0YWlsCiAgewoKICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcD4KICAgICAgaW5saW5lIGJvb2wKICAgICAgX1Bvd2VyX29mXzIoX1RwIF9feCkKICAgICAg
ewogcmV0dXJuICgoX194IC0gMSkgJiBfX3gpID09IDA7CiAgICAgIH07CiAgfQoKCgoKCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9JbnRUeXBlID0gaW50PgogICAgY2xhc3MgdW5pZm9ybV9pbnRfZGlz
dHJpYnV0aW9uCiAgICB7CiAgICAgIHN0YXRpY19hc3NlcnQoc3RkOjppc19pbnRlZ3JhbDxfSW50
VHlwZT46OnZhbHVlLAogICAgICAidGVtcGxhdGUgYXJndW1lbnQgbm90IGFuIGludGVncmFsIHR5
cGUiKTsKCiAgICBwdWJsaWM6CgogICAgICB0eXBlZGVmIF9JbnRUeXBlIHJlc3VsdF90eXBlOwoK
ICAgICAgc3RydWN0IHBhcmFtX3R5cGUKICAgICAgewogdHlwZWRlZiB1bmlmb3JtX2ludF9kaXN0
cmlidXRpb248X0ludFR5cGU+IGRpc3RyaWJ1dGlvbl90eXBlOwoKIGV4cGxpY2l0CiBwYXJhbV90
eXBlKF9JbnRUeXBlIF9fYSA9IDAsCiAgICAgX0ludFR5cGUgX19iID0gc3RkOjpudW1lcmljX2xp
bWl0czxfSW50VHlwZT46Om1heCgpKQogOiBfTV9hKF9fYSksIF9NX2IoX19iKQogewogICA7CiB9
CgogcmVzdWx0X3R5cGUKIGEoKSBjb25zdAogeyByZXR1cm4gX01fYTsgfQoKIHJlc3VsdF90eXBl
CiBiKCkgY29uc3QKIHsgcmV0dXJuIF9NX2I7IH0KCiBmcmllbmQgYm9vbAogb3BlcmF0b3I9PShj
b25zdCBwYXJhbV90eXBlJiBfX3AxLCBjb25zdCBwYXJhbV90eXBlJiBfX3AyKQogeyByZXR1cm4g
X19wMS5fTV9hID09IF9fcDIuX01fYSAmJiBfX3AxLl9NX2IgPT0gX19wMi5fTV9iOyB9CgogICAg
ICBwcml2YXRlOgogX0ludFR5cGUgX01fYTsKIF9JbnRUeXBlIF9NX2I7CiAgICAgIH07CgogICAg
cHVibGljOgoKCgogICAgICBleHBsaWNpdAogICAgICB1bmlmb3JtX2ludF9kaXN0cmlidXRpb24o
X0ludFR5cGUgX19hID0gMCwKICAgICAgX0ludFR5cGUgX19iID0gc3RkOjpudW1lcmljX2xpbWl0
czxfSW50VHlwZT46Om1heCgpKQogICAgICA6IF9NX3BhcmFtKF9fYSwgX19iKQogICAgICB7IH0K
CiAgICAgIGV4cGxpY2l0CiAgICAgIHVuaWZvcm1faW50X2Rpc3RyaWJ1dGlvbihjb25zdCBwYXJh
bV90eXBlJiBfX3ApCiAgICAgIDogX01fcGFyYW0oX19wKQogICAgICB7IH0KCgoKCgoKICAgICAg
dm9pZAogICAgICByZXNldCgpIHsgfQoKICAgICAgcmVzdWx0X3R5cGUKICAgICAgYSgpIGNvbnN0
CiAgICAgIHsgcmV0dXJuIF9NX3BhcmFtLmEoKTsgfQoKICAgICAgcmVzdWx0X3R5cGUKICAgICAg
YigpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX3BhcmFtLmIoKTsgfQoKCgoKICAgICAgcGFyYW1f
dHlwZQogICAgICBwYXJhbSgpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX3BhcmFtOyB9CgoKCgoK
ICAgICAgdm9pZAogICAgICBwYXJhbShjb25zdCBwYXJhbV90eXBlJiBfX3BhcmFtKQogICAgICB7
IF9NX3BhcmFtID0gX19wYXJhbTsgfQoKCgoKICAgICAgcmVzdWx0X3R5cGUKICAgICAgbWluKCkg
Y29uc3QKICAgICAgeyByZXR1cm4gdGhpcy0+YSgpOyB9CgoKCgogICAgICByZXN1bHRfdHlwZQog
ICAgICBtYXgoKSBjb25zdAogICAgICB7IHJldHVybiB0aGlzLT5iKCk7IH0KCgoKCiAgICAgIHRl
bXBsYXRlPHR5cGVuYW1lIF9Vbmlmb3JtUmFuZG9tTnVtYmVyR2VuZXJhdG9yPgogcmVzdWx0X3R5
cGUKIG9wZXJhdG9yKCkoX1VuaWZvcm1SYW5kb21OdW1iZXJHZW5lcmF0b3ImIF9fdXJuZykKICAg
ICAgICB7IHJldHVybiB0aGlzLT5vcGVyYXRvcigpKF9fdXJuZywgX01fcGFyYW0pOyB9CgogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVW5pZm9ybVJhbmRvbU51bWJlckdlbmVyYXRvcj4KIHJlc3Vs
dF90eXBlCiBvcGVyYXRvcigpKF9Vbmlmb3JtUmFuZG9tTnVtYmVyR2VuZXJhdG9yJiBfX3Vybmcs
CiAgICAgY29uc3QgcGFyYW1fdHlwZSYgX19wKTsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9G
b3J3YXJkSXRlcmF0b3IsCiAgICAgICAgdHlwZW5hbWUgX1VuaWZvcm1SYW5kb21OdW1iZXJHZW5l
cmF0b3I+CiB2b2lkCiBfX2dlbmVyYXRlKF9Gb3J3YXJkSXRlcmF0b3IgX19mLCBfRm9yd2FyZEl0
ZXJhdG9yIF9fdCwKICAgICBfVW5pZm9ybVJhbmRvbU51bWJlckdlbmVyYXRvciYgX191cm5nKQog
eyB0aGlzLT5fX2dlbmVyYXRlKF9fZiwgX190LCBfX3VybmcsIF9NX3BhcmFtKTsgfQoKICAgICAg
dGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwKICAgICAgICB0eXBlbmFtZSBfVW5p
Zm9ybVJhbmRvbU51bWJlckdlbmVyYXRvcj4KIHZvaWQKIF9fZ2VuZXJhdGUoX0ZvcndhcmRJdGVy
YXRvciBfX2YsIF9Gb3J3YXJkSXRlcmF0b3IgX190LAogICAgIF9Vbmlmb3JtUmFuZG9tTnVtYmVy
R2VuZXJhdG9yJiBfX3VybmcsCiAgICAgY29uc3QgcGFyYW1fdHlwZSYgX19wKQogeyB0aGlzLT5f
X2dlbmVyYXRlX2ltcGwoX19mLCBfX3QsIF9fdXJuZywgX19wKTsgfQoKICAgICAgdGVtcGxhdGU8
dHlwZW5hbWUgX1VuaWZvcm1SYW5kb21OdW1iZXJHZW5lcmF0b3I+CiB2b2lkCiBfX2dlbmVyYXRl
KHJlc3VsdF90eXBlKiBfX2YsIHJlc3VsdF90eXBlKiBfX3QsCiAgICAgX1VuaWZvcm1SYW5kb21O
dW1iZXJHZW5lcmF0b3ImIF9fdXJuZywKICAgICBjb25zdCBwYXJhbV90eXBlJiBfX3ApCiB7IHRo
aXMtPl9fZ2VuZXJhdGVfaW1wbChfX2YsIF9fdCwgX191cm5nLCBfX3ApOyB9CgoKCgoKICAgICAg
ZnJpZW5kIGJvb2wKICAgICAgb3BlcmF0b3I9PShjb25zdCB1bmlmb3JtX2ludF9kaXN0cmlidXRp
b24mIF9fZDEsCiAgIGNvbnN0IHVuaWZvcm1faW50X2Rpc3RyaWJ1dGlvbiYgX19kMikKICAgICAg
eyByZXR1cm4gX19kMS5fTV9wYXJhbSA9PSBfX2QyLl9NX3BhcmFtOyB9CgogICAgcHJpdmF0ZToK
ICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwKICAgICAgICB0eXBlbmFt
ZSBfVW5pZm9ybVJhbmRvbU51bWJlckdlbmVyYXRvcj4KIHZvaWQKIF9fZ2VuZXJhdGVfaW1wbChf
Rm9yd2FyZEl0ZXJhdG9yIF9fZiwgX0ZvcndhcmRJdGVyYXRvciBfX3QsCiAgIF9Vbmlmb3JtUmFu
ZG9tTnVtYmVyR2VuZXJhdG9yJiBfX3VybmcsCiAgIGNvbnN0IHBhcmFtX3R5cGUmIF9fcCk7Cgog
ICAgICBwYXJhbV90eXBlIF9NX3BhcmFtOwogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lu
dFR5cGU+CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVW5pZm9ybVJhbmRvbU51bWJlckdlbmVyYXRv
cj4KICAgICAgdHlwZW5hbWUgdW5pZm9ybV9pbnRfZGlzdHJpYnV0aW9uPF9JbnRUeXBlPjo6cmVz
dWx0X3R5cGUKICAgICAgdW5pZm9ybV9pbnRfZGlzdHJpYnV0aW9uPF9JbnRUeXBlPjo6CiAgICAg
IG9wZXJhdG9yKCkoX1VuaWZvcm1SYW5kb21OdW1iZXJHZW5lcmF0b3ImIF9fdXJuZywKICAgY29u
c3QgcGFyYW1fdHlwZSYgX19wYXJhbSkKICAgICAgewogdHlwZWRlZiB0eXBlbmFtZSBfVW5pZm9y
bVJhbmRvbU51bWJlckdlbmVyYXRvcjo6cmVzdWx0X3R5cGUKICAgX0dyZXN1bHRfdHlwZTsKIHR5
cGVkZWYgdHlwZW5hbWUgc3RkOjptYWtlX3Vuc2lnbmVkPHJlc3VsdF90eXBlPjo6dHlwZSBfX3V0
eXBlOwogdHlwZWRlZiB0eXBlbmFtZSBzdGQ6OmNvbW1vbl90eXBlPF9HcmVzdWx0X3R5cGUsIF9f
dXR5cGU+Ojp0eXBlCiAgIF9fdWN0eXBlOwoKIGNvbnN0IF9fdWN0eXBlIF9fdXJuZ21pbiA9IF9f
dXJuZy5taW4oKTsKIGNvbnN0IF9fdWN0eXBlIF9fdXJuZ21heCA9IF9fdXJuZy5tYXgoKTsKIGNv
bnN0IF9fdWN0eXBlIF9fdXJuZ3JhbmdlID0gX191cm5nbWF4IC0gX191cm5nbWluOwogY29uc3Qg
X191Y3R5cGUgX191cmFuZ2UKICAgPSBfX3VjdHlwZShfX3BhcmFtLmIoKSkgLSBfX3VjdHlwZShf
X3BhcmFtLmEoKSk7CgogX191Y3R5cGUgX19yZXQ7CgogaWYgKF9fdXJuZ3JhbmdlID4gX191cmFu
Z2UpCiAgIHsKCiAgICAgY29uc3QgX191Y3R5cGUgX191ZXJhbmdlID0gX191cmFuZ2UgKyAxOwog
ICAgIGNvbnN0IF9fdWN0eXBlIF9fc2NhbGluZyA9IF9fdXJuZ3JhbmdlIC8gX191ZXJhbmdlOwog
ICAgIGNvbnN0IF9fdWN0eXBlIF9fcGFzdCA9IF9fdWVyYW5nZSAqIF9fc2NhbGluZzsKICAgICBk
bwogICAgICAgX19yZXQgPSBfX3VjdHlwZShfX3VybmcoKSkgLSBfX3VybmdtaW47CiAgICAgd2hp
bGUgKF9fcmV0ID49IF9fcGFzdCk7CiAgICAgX19yZXQgLz0gX19zY2FsaW5nOwogICB9CiBlbHNl
IGlmIChfX3VybmdyYW5nZSA8IF9fdXJhbmdlKQogICB7CiMgMjYwICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvdW5pZm9ybV9pbnRfZGlzdC5oIiAzCiAgICAgX191Y3R5cGUgX190bXA7CiAg
ICAgZG8KICAgICAgIHsKICBjb25zdCBfX3VjdHlwZSBfX3Vlcm5ncmFuZ2UgPSBfX3VybmdyYW5n
ZSArIDE7CiAgX190bXAgPSAoX191ZXJuZ3JhbmdlICogb3BlcmF0b3IoKQogICAgKF9fdXJuZywg
cGFyYW1fdHlwZSgwLCBfX3VyYW5nZSAvIF9fdWVybmdyYW5nZSkpKTsKICBfX3JldCA9IF9fdG1w
ICsgKF9fdWN0eXBlKF9fdXJuZygpKSAtIF9fdXJuZ21pbik7CiAgICAgICB9CiAgICAgd2hpbGUg
KF9fcmV0ID4gX191cmFuZ2UgfHwgX19yZXQgPCBfX3RtcCk7CiAgIH0KIGVsc2UKICAgX19yZXQg
PSBfX3VjdHlwZShfX3VybmcoKSkgLSBfX3VybmdtaW47CgogcmV0dXJuIF9fcmV0ICsgX19wYXJh
bS5hKCk7CiAgICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnRUeXBlPgogICAgdGVtcGxh
dGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwKICAgICAgdHlwZW5hbWUgX1VuaWZvcm1SYW5k
b21OdW1iZXJHZW5lcmF0b3I+CiAgICAgIHZvaWQKICAgICAgdW5pZm9ybV9pbnRfZGlzdHJpYnV0
aW9uPF9JbnRUeXBlPjo6CiAgICAgIF9fZ2VuZXJhdGVfaW1wbChfRm9yd2FyZEl0ZXJhdG9yIF9f
ZiwgX0ZvcndhcmRJdGVyYXRvciBfX3QsCiAgICAgICAgX1VuaWZvcm1SYW5kb21OdW1iZXJHZW5l
cmF0b3ImIF9fdXJuZywKICAgICAgICBjb25zdCBwYXJhbV90eXBlJiBfX3BhcmFtKQogICAgICB7
CgogdHlwZWRlZiB0eXBlbmFtZSBfVW5pZm9ybVJhbmRvbU51bWJlckdlbmVyYXRvcjo6cmVzdWx0
X3R5cGUKICAgX0dyZXN1bHRfdHlwZTsKIHR5cGVkZWYgdHlwZW5hbWUgc3RkOjptYWtlX3Vuc2ln
bmVkPHJlc3VsdF90eXBlPjo6dHlwZSBfX3V0eXBlOwogdHlwZWRlZiB0eXBlbmFtZSBzdGQ6OmNv
bW1vbl90eXBlPF9HcmVzdWx0X3R5cGUsIF9fdXR5cGU+Ojp0eXBlCiAgIF9fdWN0eXBlOwoKIGNv
bnN0IF9fdWN0eXBlIF9fdXJuZ21pbiA9IF9fdXJuZy5taW4oKTsKIGNvbnN0IF9fdWN0eXBlIF9f
dXJuZ21heCA9IF9fdXJuZy5tYXgoKTsKIGNvbnN0IF9fdWN0eXBlIF9fdXJuZ3JhbmdlID0gX191
cm5nbWF4IC0gX191cm5nbWluOwogY29uc3QgX191Y3R5cGUgX191cmFuZ2UKICAgPSBfX3VjdHlw
ZShfX3BhcmFtLmIoKSkgLSBfX3VjdHlwZShfX3BhcmFtLmEoKSk7CgogX191Y3R5cGUgX19yZXQ7
CgogaWYgKF9fdXJuZ3JhbmdlID4gX191cmFuZ2UpCiAgIHsKICAgICBpZiAoX19kZXRhaWw6Ol9Q
b3dlcl9vZl8yKF9fdXJuZ3JhbmdlICsgMSkKICAmJiBfX2RldGFpbDo6X1Bvd2VyX29mXzIoX191
cmFuZ2UgKyAxKSkKICAgICAgIHsKICB3aGlsZSAoX19mICE9IF9fdCkKICAgIHsKICAgICAgX19y
ZXQgPSBfX3VjdHlwZShfX3VybmcoKSkgLSBfX3VybmdtaW47CiAgICAgICpfX2YrKyA9IChfX3Jl
dCAmIF9fdXJhbmdlKSArIF9fcGFyYW0uYSgpOwogICAgfQogICAgICAgfQogICAgIGVsc2UKICAg
ICAgIHsKCiAgY29uc3QgX191Y3R5cGUgX191ZXJhbmdlID0gX191cmFuZ2UgKyAxOwogIGNvbnN0
IF9fdWN0eXBlIF9fc2NhbGluZyA9IF9fdXJuZ3JhbmdlIC8gX191ZXJhbmdlOwogIGNvbnN0IF9f
dWN0eXBlIF9fcGFzdCA9IF9fdWVyYW5nZSAqIF9fc2NhbGluZzsKICB3aGlsZSAoX19mICE9IF9f
dCkKICAgIHsKICAgICAgZG8KICAgICAgICBfX3JldCA9IF9fdWN0eXBlKF9fdXJuZygpKSAtIF9f
dXJuZ21pbjsKICAgICAgd2hpbGUgKF9fcmV0ID49IF9fcGFzdCk7CiAgICAgICpfX2YrKyA9IF9f
cmV0IC8gX19zY2FsaW5nICsgX19wYXJhbS5hKCk7CiAgICB9CiAgICAgICB9CiAgIH0KIGVsc2Ug
aWYgKF9fdXJuZ3JhbmdlIDwgX191cmFuZ2UpCiAgIHsKIyAzNDQgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy91bmlmb3JtX2ludF9kaXN0LmgiIDMKICAgICBfX3VjdHlwZSBfX3RtcDsKICAg
ICB3aGlsZSAoX19mICE9IF9fdCkKICAgICAgIHsKICBkbwogICAgewogICAgICBjb25zdCBfX3Vj
dHlwZSBfX3Vlcm5ncmFuZ2UgPSBfX3VybmdyYW5nZSArIDE7CiAgICAgIF9fdG1wID0gKF9fdWVy
bmdyYW5nZSAqIG9wZXJhdG9yKCkKICAgICAgICAoX191cm5nLCBwYXJhbV90eXBlKDAsIF9fdXJh
bmdlIC8gX191ZXJuZ3JhbmdlKSkpOwogICAgICBfX3JldCA9IF9fdG1wICsgKF9fdWN0eXBlKF9f
dXJuZygpKSAtIF9fdXJuZ21pbik7CiAgICB9CiAgd2hpbGUgKF9fcmV0ID4gX191cmFuZ2UgfHwg
X19yZXQgPCBfX3RtcCk7CiAgKl9fZisrID0gX19yZXQ7CiAgICAgICB9CiAgIH0KIGVsc2UKICAg
d2hpbGUgKF9fZiAhPSBfX3QpCiAgICAgKl9fZisrID0gX191Y3R5cGUoX191cm5nKCkpIC0gX191
cm5nbWluICsgX19wYXJhbS5hKCk7CiAgICAgIH0KCgp9CiMgNjcgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9zdGxfYWxnby5oIiAyIDMKCgoKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVf
XyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9JdGVyYXRvciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICB2b2lkCiAgICBfX21vdmVfbWVkaWFu
X3RvX2ZpcnN0KF9JdGVyYXRvciBfX3Jlc3VsdCxfSXRlcmF0b3IgX19hLCBfSXRlcmF0b3IgX19i
LAogICAgICBfSXRlcmF0b3IgX19jLCBfQ29tcGFyZSBfX2NvbXApCiAgICB7CiAgICAgIGlmIChf
X2NvbXAoX19hLCBfX2IpKQogewogICBpZiAoX19jb21wKF9fYiwgX19jKSkKICAgICBzdGQ6Oml0
ZXJfc3dhcChfX3Jlc3VsdCwgX19iKTsKICAgZWxzZSBpZiAoX19jb21wKF9fYSwgX19jKSkKICAg
ICBzdGQ6Oml0ZXJfc3dhcChfX3Jlc3VsdCwgX19jKTsKICAgZWxzZQogICAgIHN0ZDo6aXRlcl9z
d2FwKF9fcmVzdWx0LCBfX2EpOwogfQogICAgICBlbHNlIGlmIChfX2NvbXAoX19hLCBfX2MpKQog
c3RkOjppdGVyX3N3YXAoX19yZXN1bHQsIF9fYSk7CiAgICAgIGVsc2UgaWYgKF9fY29tcChfX2Is
IF9fYykpCiBzdGQ6Oml0ZXJfc3dhcChfX3Jlc3VsdCwgX19jKTsKICAgICAgZWxzZQogc3RkOjpp
dGVyX3N3YXAoX19yZXN1bHQsIF9fYik7CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5w
dXRJdGVyYXRvciwgdHlwZW5hbWUgX1ByZWRpY2F0ZT4KICAgIGlubGluZSBfSW5wdXRJdGVyYXRv
cgogICAgX19maW5kX2lmKF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9f
bGFzdCwKICAgICAgIF9QcmVkaWNhdGUgX19wcmVkLCBpbnB1dF9pdGVyYXRvcl90YWcpCiAgICB7
CiAgICAgIHdoaWxlIChfX2ZpcnN0ICE9IF9fbGFzdCAmJiAhX19wcmVkKF9fZmlyc3QpKQogKytf
X2ZpcnN0OwogICAgICByZXR1cm4gX19maXJzdDsKICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9SYW5kb21BY2Nlc3NJdGVyYXRvciwgdHlwZW5hbWUgX1ByZWRpY2F0ZT4KICAgIF9SYW5kb21B
Y2Nlc3NJdGVyYXRvcgogICAgX19maW5kX2lmKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0
LCBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0LAogICAgICAgX1ByZWRpY2F0ZSBfX3ByZWQs
IHJhbmRvbV9hY2Nlc3NfaXRlcmF0b3JfdGFnKQogICAgewogICAgICB0eXBlbmFtZSBpdGVyYXRv
cl90cmFpdHM8X1JhbmRvbUFjY2Vzc0l0ZXJhdG9yPjo6ZGlmZmVyZW5jZV90eXBlCiBfX3RyaXBf
Y291bnQgPSAoX19sYXN0IC0gX19maXJzdCkgPj4gMjsKCiAgICAgIGZvciAoOyBfX3RyaXBfY291
bnQgPiAwOyAtLV9fdHJpcF9jb3VudCkKIHsKICAgaWYgKF9fcHJlZChfX2ZpcnN0KSkKICAgICBy
ZXR1cm4gX19maXJzdDsKICAgKytfX2ZpcnN0OwoKICAgaWYgKF9fcHJlZChfX2ZpcnN0KSkKICAg
ICByZXR1cm4gX19maXJzdDsKICAgKytfX2ZpcnN0OwoKICAgaWYgKF9fcHJlZChfX2ZpcnN0KSkK
ICAgICByZXR1cm4gX19maXJzdDsKICAgKytfX2ZpcnN0OwoKICAgaWYgKF9fcHJlZChfX2ZpcnN0
KSkKICAgICByZXR1cm4gX19maXJzdDsKICAgKytfX2ZpcnN0OwogfQoKICAgICAgc3dpdGNoIChf
X2xhc3QgLSBfX2ZpcnN0KQogewogY2FzZSAzOgogICBpZiAoX19wcmVkKF9fZmlyc3QpKQogICAg
IHJldHVybiBfX2ZpcnN0OwogICArK19fZmlyc3Q7CiBjYXNlIDI6CiAgIGlmIChfX3ByZWQoX19m
aXJzdCkpCiAgICAgcmV0dXJuIF9fZmlyc3Q7CiAgICsrX19maXJzdDsKIGNhc2UgMToKICAgaWYg
KF9fcHJlZChfX2ZpcnN0KSkKICAgICByZXR1cm4gX19maXJzdDsKICAgKytfX2ZpcnN0OwogY2Fz
ZSAwOgogZGVmYXVsdDoKICAgcmV0dXJuIF9fbGFzdDsKIH0KICAgIH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0l0ZXJhdG9yLCB0eXBlbmFtZSBfUHJlZGljYXRlPgogICAgaW5saW5lIF9JdGVyYXRv
cgogICAgX19maW5kX2lmKF9JdGVyYXRvciBfX2ZpcnN0LCBfSXRlcmF0b3IgX19sYXN0LCBfUHJl
ZGljYXRlIF9fcHJlZCkKICAgIHsKICAgICAgcmV0dXJuIF9fZmluZF9pZihfX2ZpcnN0LCBfX2xh
c3QsIF9fcHJlZCwKICAgICAgICAgc3RkOjpfX2l0ZXJhdG9yX2NhdGVnb3J5KF9fZmlyc3QpKTsK
ICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfUHJl
ZGljYXRlPgogICAgaW5saW5lIF9JbnB1dEl0ZXJhdG9yCiAgICBfX2ZpbmRfaWZfbm90KF9JbnB1
dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgIF9QcmVkaWNhdGUg
X19wcmVkKQogICAgewogICAgICByZXR1cm4gc3RkOjpfX2ZpbmRfaWYoX19maXJzdCwgX19sYXN0
LAogICAgICAgX19nbnVfY3h4OjpfX29wczo6X19uZWdhdGUoX19wcmVkKSwKICAgICAgIHN0ZDo6
X19pdGVyYXRvcl9jYXRlZ29yeShfX2ZpcnN0KSk7CiAgICB9CgoKCgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfUHJlZGljYXRlLCB0eXBlbmFtZSBfRGlzdGFu
Y2U+CiAgICBfSW5wdXRJdGVyYXRvcgogICAgX19maW5kX2lmX25vdF9uKF9JbnB1dEl0ZXJhdG9y
IF9fZmlyc3QsIF9EaXN0YW5jZSYgX19sZW4sIF9QcmVkaWNhdGUgX19wcmVkKQogICAgewogICAg
ICBmb3IgKDsgX19sZW47IC0tX19sZW4sICsrX19maXJzdCkKIGlmICghX19wcmVkKF9fZmlyc3Qp
KQogICBicmVhazsKICAgICAgcmV0dXJuIF9fZmlyc3Q7CiAgICB9CiMgMjAyICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3
YXJkSXRlcmF0b3IxLCB0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yMiwKICAgIHR5cGVuYW1lIF9C
aW5hcnlQcmVkaWNhdGU+CiAgICBfRm9yd2FyZEl0ZXJhdG9yMQogICAgX19zZWFyY2goX0Zvcndh
cmRJdGVyYXRvcjEgX19maXJzdDEsIF9Gb3J3YXJkSXRlcmF0b3IxIF9fbGFzdDEsCiAgICAgIF9G
b3J3YXJkSXRlcmF0b3IyIF9fZmlyc3QyLCBfRm9yd2FyZEl0ZXJhdG9yMiBfX2xhc3QyLAogICAg
ICBfQmluYXJ5UHJlZGljYXRlIF9fcHJlZGljYXRlKQogICAgewoKICAgICAgaWYgKF9fZmlyc3Qx
ID09IF9fbGFzdDEgfHwgX19maXJzdDIgPT0gX19sYXN0MikKIHJldHVybiBfX2ZpcnN0MTsKCgog
ICAgICBfRm9yd2FyZEl0ZXJhdG9yMiBfX3AxKF9fZmlyc3QyKTsKICAgICAgaWYgKCsrX19wMSA9
PSBfX2xhc3QyKQogcmV0dXJuIHN0ZDo6X19maW5kX2lmKF9fZmlyc3QxLCBfX2xhc3QxLAogIF9f
Z251X2N4eDo6X19vcHM6Ol9faXRlcl9jb21wX2l0ZXIoX19wcmVkaWNhdGUsIF9fZmlyc3QyKSk7
CgoKICAgICAgX0ZvcndhcmRJdGVyYXRvcjIgX19wOwogICAgICBfRm9yd2FyZEl0ZXJhdG9yMSBf
X2N1cnJlbnQgPSBfX2ZpcnN0MTsKCiAgICAgIGZvciAoOzspCiB7CiAgIF9fZmlyc3QxID0KICAg
ICBzdGQ6Ol9fZmluZF9pZihfX2ZpcnN0MSwgX19sYXN0MSwKICBfX2dudV9jeHg6Ol9fb3BzOjpf
X2l0ZXJfY29tcF9pdGVyKF9fcHJlZGljYXRlLCBfX2ZpcnN0MikpOwoKICAgaWYgKF9fZmlyc3Qx
ID09IF9fbGFzdDEpCiAgICAgcmV0dXJuIF9fbGFzdDE7CgogICBfX3AgPSBfX3AxOwogICBfX2N1
cnJlbnQgPSBfX2ZpcnN0MTsKICAgaWYgKCsrX19jdXJyZW50ID09IF9fbGFzdDEpCiAgICAgcmV0
dXJuIF9fbGFzdDE7CgogICB3aGlsZSAoX19wcmVkaWNhdGUoX19jdXJyZW50LCBfX3ApKQogICAg
IHsKICAgICAgIGlmICgrK19fcCA9PSBfX2xhc3QyKQogIHJldHVybiBfX2ZpcnN0MTsKICAgICAg
IGlmICgrK19fY3VycmVudCA9PSBfX2xhc3QxKQogIHJldHVybiBfX2xhc3QxOwogICAgIH0KICAg
KytfX2ZpcnN0MTsKIH0KICAgICAgcmV0dXJuIF9fZmlyc3QxOwogICAgfQoKCgoKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9JbnRlZ2VyLAogICAgdHlw
ZW5hbWUgX1VuYXJ5UHJlZGljYXRlPgogICAgX0ZvcndhcmRJdGVyYXRvcgogICAgX19zZWFyY2hf
bl9hdXgoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwK
ICAgICBfSW50ZWdlciBfX2NvdW50LCBfVW5hcnlQcmVkaWNhdGUgX191bmFyeV9wcmVkLAogICAg
IHN0ZDo6Zm9yd2FyZF9pdGVyYXRvcl90YWcpCiAgICB7CiAgICAgIF9fZmlyc3QgPSBzdGQ6Ol9f
ZmluZF9pZihfX2ZpcnN0LCBfX2xhc3QsIF9fdW5hcnlfcHJlZCk7CiAgICAgIHdoaWxlIChfX2Zp
cnN0ICE9IF9fbGFzdCkKIHsKICAgdHlwZW5hbWUgaXRlcmF0b3JfdHJhaXRzPF9Gb3J3YXJkSXRl
cmF0b3I+OjpkaWZmZXJlbmNlX3R5cGUKICAgICBfX24gPSBfX2NvdW50OwogICBfRm9yd2FyZEl0
ZXJhdG9yIF9faSA9IF9fZmlyc3Q7CiAgICsrX19pOwogICB3aGlsZSAoX19pICE9IF9fbGFzdCAm
JiBfX24gIT0gMSAmJiBfX3VuYXJ5X3ByZWQoX19pKSkKICAgICB7CiAgICAgICArK19faTsKICAg
ICAgIC0tX19uOwogICAgIH0KICAgaWYgKF9fbiA9PSAxKQogICAgIHJldHVybiBfX2ZpcnN0Owog
ICBpZiAoX19pID09IF9fbGFzdCkKICAgICByZXR1cm4gX19sYXN0OwogICBfX2ZpcnN0ID0gc3Rk
OjpfX2ZpbmRfaWYoKytfX2ksIF9fbGFzdCwgX191bmFyeV9wcmVkKTsKIH0KICAgICAgcmV0dXJu
IF9fbGFzdDsKICAgIH0KCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVy
LCB0eXBlbmFtZSBfSW50ZWdlciwKICAgIHR5cGVuYW1lIF9VbmFyeVByZWRpY2F0ZT4KICAgIF9S
YW5kb21BY2Nlc3NJdGVyCiAgICBfX3NlYXJjaF9uX2F1eChfUmFuZG9tQWNjZXNzSXRlciBfX2Zp
cnN0LCBfUmFuZG9tQWNjZXNzSXRlciBfX2xhc3QsCiAgICAgX0ludGVnZXIgX19jb3VudCwgX1Vu
YXJ5UHJlZGljYXRlIF9fdW5hcnlfcHJlZCwKICAgICBzdGQ6OnJhbmRvbV9hY2Nlc3NfaXRlcmF0
b3JfdGFnKQogICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIHN0ZDo6aXRlcmF0b3JfdHJhaXRz
PF9SYW5kb21BY2Nlc3NJdGVyPjo6ZGlmZmVyZW5jZV90eXBlCiBfRGlzdGFuY2VUeXBlOwoKICAg
ICAgX0Rpc3RhbmNlVHlwZSBfX3RhaWxTaXplID0gX19sYXN0IC0gX19maXJzdDsKICAgICAgX0Rp
c3RhbmNlVHlwZSBfX3JlbWFpbmRlciA9IF9fY291bnQ7CgogICAgICB3aGlsZSAoX19yZW1haW5k
ZXIgPD0gX190YWlsU2l6ZSkKIHsKICAgX19maXJzdCArPSBfX3JlbWFpbmRlcjsKICAgX190YWls
U2l6ZSAtPSBfX3JlbWFpbmRlcjsKCgogICBfUmFuZG9tQWNjZXNzSXRlciBfX2JhY2tUcmFjayA9
IF9fZmlyc3Q7CiAgIHdoaWxlIChfX3VuYXJ5X3ByZWQoLS1fX2JhY2tUcmFjaykpCiAgICAgewog
ICAgICAgaWYgKC0tX19yZW1haW5kZXIgPT0gMCkKICByZXR1cm4gKF9fZmlyc3QgLSBfX2NvdW50
KTsKICAgICB9CiAgIF9fcmVtYWluZGVyID0gX19jb3VudCArIDEgLSAoX19maXJzdCAtIF9fYmFj
a1RyYWNrKTsKIH0KICAgICAgcmV0dXJuIF9fbGFzdDsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX0ludGVnZXIsCiAgICB0eXBlbmFtZSBfVW5h
cnlQcmVkaWNhdGU+CiAgICBfRm9yd2FyZEl0ZXJhdG9yCiAgICBfX3NlYXJjaF9uKF9Gb3J3YXJk
SXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QsCiAgICAgICAgX0ludGVn
ZXIgX19jb3VudCwKICAgICAgICBfVW5hcnlQcmVkaWNhdGUgX191bmFyeV9wcmVkKQogICAgewog
ICAgICBpZiAoX19jb3VudCA8PSAwKQogcmV0dXJuIF9fZmlyc3Q7CgogICAgICBpZiAoX19jb3Vu
dCA9PSAxKQogcmV0dXJuIHN0ZDo6X19maW5kX2lmKF9fZmlyc3QsIF9fbGFzdCwgX191bmFyeV9w
cmVkKTsKCiAgICAgIHJldHVybiBzdGQ6Ol9fc2VhcmNoX25fYXV4KF9fZmlyc3QsIF9fbGFzdCwg
X19jb3VudCwgX191bmFyeV9wcmVkLAogICAgIHN0ZDo6X19pdGVyYXRvcl9jYXRlZ29yeShfX2Zp
cnN0KSk7CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yMSwgdHlw
ZW5hbWUgX0ZvcndhcmRJdGVyYXRvcjIsCiAgICB0eXBlbmFtZSBfQmluYXJ5UHJlZGljYXRlPgog
ICAgX0ZvcndhcmRJdGVyYXRvcjEKICAgIF9fZmluZF9lbmQoX0ZvcndhcmRJdGVyYXRvcjEgX19m
aXJzdDEsIF9Gb3J3YXJkSXRlcmF0b3IxIF9fbGFzdDEsCiAgICAgICAgX0ZvcndhcmRJdGVyYXRv
cjIgX19maXJzdDIsIF9Gb3J3YXJkSXRlcmF0b3IyIF9fbGFzdDIsCiAgICAgICAgZm9yd2FyZF9p
dGVyYXRvcl90YWcsIGZvcndhcmRfaXRlcmF0b3JfdGFnLAogICAgICAgIF9CaW5hcnlQcmVkaWNh
dGUgX19jb21wKQogICAgewogICAgICBpZiAoX19maXJzdDIgPT0gX19sYXN0MikKIHJldHVybiBf
X2xhc3QxOwoKICAgICAgX0ZvcndhcmRJdGVyYXRvcjEgX19yZXN1bHQgPSBfX2xhc3QxOwogICAg
ICB3aGlsZSAoMSkKIHsKICAgX0ZvcndhcmRJdGVyYXRvcjEgX19uZXdfcmVzdWx0CiAgICAgPSBz
dGQ6Ol9fc2VhcmNoKF9fZmlyc3QxLCBfX2xhc3QxLCBfX2ZpcnN0MiwgX19sYXN0MiwgX19jb21w
KTsKICAgaWYgKF9fbmV3X3Jlc3VsdCA9PSBfX2xhc3QxKQogICAgIHJldHVybiBfX3Jlc3VsdDsK
ICAgZWxzZQogICAgIHsKICAgICAgIF9fcmVzdWx0ID0gX19uZXdfcmVzdWx0OwogICAgICAgX19m
aXJzdDEgPSBfX25ld19yZXN1bHQ7CiAgICAgICArK19fZmlyc3QxOwogICAgIH0KIH0KICAgIH0K
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IxLCB0eXBlbmFtZSBf
QmlkaXJlY3Rpb25hbEl0ZXJhdG9yMiwKICAgIHR5cGVuYW1lIF9CaW5hcnlQcmVkaWNhdGU+CiAg
ICBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yMQogICAgX19maW5kX2VuZChfQmlkaXJlY3Rpb25hbEl0
ZXJhdG9yMSBfX2ZpcnN0MSwKICAgICAgICBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yMSBfX2xhc3Qx
LAogICAgICAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IyIF9fZmlyc3QyLAogICAgICAgIF9CaWRp
cmVjdGlvbmFsSXRlcmF0b3IyIF9fbGFzdDIsCiAgICAgICAgYmlkaXJlY3Rpb25hbF9pdGVyYXRv
cl90YWcsIGJpZGlyZWN0aW9uYWxfaXRlcmF0b3JfdGFnLAogICAgICAgIF9CaW5hcnlQcmVkaWNh
dGUgX19jb21wKQogICAgewoKICAgICAKCiAgICAgCgoKICAgICAgdHlwZWRlZiByZXZlcnNlX2l0
ZXJhdG9yPF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IxPiBfUmV2SXRlcmF0b3IxOwogICAgICB0eXBl
ZGVmIHJldmVyc2VfaXRlcmF0b3I8X0JpZGlyZWN0aW9uYWxJdGVyYXRvcjI+IF9SZXZJdGVyYXRv
cjI7CgogICAgICBfUmV2SXRlcmF0b3IxIF9fcmxhc3QxKF9fZmlyc3QxKTsKICAgICAgX1Jldkl0
ZXJhdG9yMiBfX3JsYXN0MihfX2ZpcnN0Mik7CiAgICAgIF9SZXZJdGVyYXRvcjEgX19ycmVzdWx0
ID0gc3RkOjpfX3NlYXJjaChfUmV2SXRlcmF0b3IxKF9fbGFzdDEpLCBfX3JsYXN0MSwKICAgICAg
ICAgICBfUmV2SXRlcmF0b3IyKF9fbGFzdDIpLCBfX3JsYXN0MiwKICAgICAgICAgICBfX2NvbXAp
OwoKICAgICAgaWYgKF9fcnJlc3VsdCA9PSBfX3JsYXN0MSkKIHJldHVybiBfX2xhc3QxOwogICAg
ICBlbHNlCiB7CiAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IxIF9fcmVzdWx0ID0gX19ycmVzdWx0
LmJhc2UoKTsKICAgc3RkOjphZHZhbmNlKF9fcmVzdWx0LCAtc3RkOjpkaXN0YW5jZShfX2ZpcnN0
MiwgX19sYXN0MikpOwogICByZXR1cm4gX19yZXN1bHQ7CiB9CiAgICB9CiMgNDIzICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9G
b3J3YXJkSXRlcmF0b3IxLCB0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yMj4KICAgIGlubGluZSBf
Rm9yd2FyZEl0ZXJhdG9yMQogICAgZmluZF9lbmQoX0ZvcndhcmRJdGVyYXRvcjEgX19maXJzdDEs
IF9Gb3J3YXJkSXRlcmF0b3IxIF9fbGFzdDEsCiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IyIF9fZmly
c3QyLCBfRm9yd2FyZEl0ZXJhdG9yMiBfX2xhc3QyKQogICAgewoKICAgICAKICAgICAKICAgICAK
CgogICAgICA7CiAgICAgIDsKCiAgICAgIHJldHVybiBzdGQ6Ol9fZmluZF9lbmQoX19maXJzdDEs
IF9fbGFzdDEsIF9fZmlyc3QyLCBfX2xhc3QyLAogICAgICAgIHN0ZDo6X19pdGVyYXRvcl9jYXRl
Z29yeShfX2ZpcnN0MSksCiAgICAgICAgc3RkOjpfX2l0ZXJhdG9yX2NhdGVnb3J5KF9fZmlyc3Qy
KSwKICAgICAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfZXF1YWxfdG9faXRlcigpKTsKICAg
IH0KIyA0NzEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvcjEsIHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0
b3IyLAogICAgdHlwZW5hbWUgX0JpbmFyeVByZWRpY2F0ZT4KICAgIGlubGluZSBfRm9yd2FyZEl0
ZXJhdG9yMQogICAgZmluZF9lbmQoX0ZvcndhcmRJdGVyYXRvcjEgX19maXJzdDEsIF9Gb3J3YXJk
SXRlcmF0b3IxIF9fbGFzdDEsCiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IyIF9fZmlyc3QyLCBfRm9y
d2FyZEl0ZXJhdG9yMiBfX2xhc3QyLAogICAgICBfQmluYXJ5UHJlZGljYXRlIF9fY29tcCkKICAg
IHsKCiAgICAgCiAgICAgCiAgICAgCgoKICAgICAgOwogICAgICA7CgogICAgICByZXR1cm4gc3Rk
OjpfX2ZpbmRfZW5kKF9fZmlyc3QxLCBfX2xhc3QxLCBfX2ZpcnN0MiwgX19sYXN0MiwKICAgICAg
ICBzdGQ6Ol9faXRlcmF0b3JfY2F0ZWdvcnkoX19maXJzdDEpLAogICAgICAgIHN0ZDo6X19pdGVy
YXRvcl9jYXRlZ29yeShfX2ZpcnN0MiksCiAgICAgICAgX19nbnVfY3h4OjpfX29wczo6X19pdGVy
X2NvbXBfaXRlcihfX2NvbXApKTsKICAgIH0KIyA1MDYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5
cGVuYW1lIF9QcmVkaWNhdGU+CiAgICBpbmxpbmUgYm9vbAogICAgYWxsX29mKF9JbnB1dEl0ZXJh
dG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwgX1ByZWRpY2F0ZSBfX3ByZWQpCiAg
ICB7IHJldHVybiBfX2xhc3QgPT0gc3RkOjpmaW5kX2lmX25vdChfX2ZpcnN0LCBfX2xhc3QsIF9f
cHJlZCk7IH0KIyA1MjMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAz
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9QcmVkaWNhdGU+
CiAgICBpbmxpbmUgYm9vbAogICAgbm9uZV9vZihfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBfSW5w
dXRJdGVyYXRvciBfX2xhc3QsIF9QcmVkaWNhdGUgX19wcmVkKQogICAgeyByZXR1cm4gX19sYXN0
ID09IHN0ZDo6ZmluZF9pZihfX2ZpcnN0LCBfX2xhc3QsIF9fcHJlZCk7IH0KIyA1NDEgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9QcmVkaWNhdGU+CiAgICBpbmxpbmUgYm9vbAogICAg
YW55X29mKF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwgX1By
ZWRpY2F0ZSBfX3ByZWQpCiAgICB7IHJldHVybiAhc3RkOjpub25lX29mKF9fZmlyc3QsIF9fbGFz
dCwgX19wcmVkKTsgfQojIDU1NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdv
LmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvciwgdHlwZW5hbWUgX1ByZWRp
Y2F0ZT4KICAgIGlubGluZSBfSW5wdXRJdGVyYXRvcgogICAgZmluZF9pZl9ub3QoX0lucHV0SXRl
cmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogIF9QcmVkaWNhdGUgX19wcmVk
KQogICAgewoKICAgICAKICAgICAKCiAgICAgIDsKICAgICAgcmV0dXJuIHN0ZDo6X19maW5kX2lm
X25vdChfX2ZpcnN0LCBfX2xhc3QsCiAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX3ByZWRfaXRlcihf
X3ByZWQpKTsKICAgIH0KIyA1ODAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxn
by5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9QcmVk
aWNhdGU+CiAgICBpbmxpbmUgYm9vbAogICAgaXNfcGFydGl0aW9uZWQoX0lucHV0SXRlcmF0b3Ig
X19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgIF9QcmVkaWNhdGUgX19wcmVkKQog
ICAgewogICAgICBfX2ZpcnN0ID0gc3RkOjpmaW5kX2lmX25vdChfX2ZpcnN0LCBfX2xhc3QsIF9f
cHJlZCk7CiAgICAgIHJldHVybiBzdGQ6Om5vbmVfb2YoX19maXJzdCwgX19sYXN0LCBfX3ByZWQp
OwogICAgfQojIDU5OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfUHJlZGljYXRl
PgogICAgX0ZvcndhcmRJdGVyYXRvcgogICAgcGFydGl0aW9uX3BvaW50KF9Gb3J3YXJkSXRlcmF0
b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QsCiAgICAgIF9QcmVkaWNhdGUgX19w
cmVkKQogICAgewoKICAgICAKICAgICAKCgoKICAgICAgOwoKICAgICAgdHlwZWRlZiB0eXBlbmFt
ZSBpdGVyYXRvcl90cmFpdHM8X0ZvcndhcmRJdGVyYXRvcj46OmRpZmZlcmVuY2VfdHlwZQogX0Rp
c3RhbmNlVHlwZTsKCiAgICAgIF9EaXN0YW5jZVR5cGUgX19sZW4gPSBzdGQ6OmRpc3RhbmNlKF9f
Zmlyc3QsIF9fbGFzdCk7CiAgICAgIF9EaXN0YW5jZVR5cGUgX19oYWxmOwogICAgICBfRm9yd2Fy
ZEl0ZXJhdG9yIF9fbWlkZGxlOwoKICAgICAgd2hpbGUgKF9fbGVuID4gMCkKIHsKICAgX19oYWxm
ID0gX19sZW4gPj4gMTsKICAgX19taWRkbGUgPSBfX2ZpcnN0OwogICBzdGQ6OmFkdmFuY2UoX19t
aWRkbGUsIF9faGFsZik7CiAgIGlmIChfX3ByZWQoKl9fbWlkZGxlKSkKICAgICB7CiAgICAgICBf
X2ZpcnN0ID0gX19taWRkbGU7CiAgICAgICArK19fZmlyc3Q7CiAgICAgICBfX2xlbiA9IF9fbGVu
IC0gX19oYWxmIC0gMTsKICAgICB9CiAgIGVsc2UKICAgICBfX2xlbiA9IF9faGFsZjsKIH0KICAg
ICAgcmV0dXJuIF9fZmlyc3Q7CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVy
YXRvciwgdHlwZW5hbWUgX091dHB1dEl0ZXJhdG9yLAogICAgdHlwZW5hbWUgX1ByZWRpY2F0ZT4K
ICAgIF9PdXRwdXRJdGVyYXRvcgogICAgX19yZW1vdmVfY29weV9pZihfSW5wdXRJdGVyYXRvciBf
X2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QsCiAgICAgICBfT3V0cHV0SXRlcmF0b3IgX19y
ZXN1bHQsIF9QcmVkaWNhdGUgX19wcmVkKQogICAgewogICAgICBmb3IgKDsgX19maXJzdCAhPSBf
X2xhc3Q7ICsrX19maXJzdCkKIGlmICghX19wcmVkKF9fZmlyc3QpKQogICB7CiAgICAgKl9fcmVz
dWx0ID0gKl9fZmlyc3Q7CiAgICAgKytfX3Jlc3VsdDsKICAgfQogICAgICByZXR1cm4gX19yZXN1
bHQ7CiAgICB9CiMgNjY1ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIg
MwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfT3V0cHV0SXRl
cmF0b3IsIHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBfT3V0cHV0SXRlcmF0b3IKICAgIHJlbW92
ZV9jb3B5KF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICBf
T3V0cHV0SXRlcmF0b3IgX19yZXN1bHQsIGNvbnN0IF9UcCYgX192YWx1ZSkKICAgIHsKCiAgICAg
CiAgICAgCgogICAgIAoKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19yZW1vdmVfY29weV9p
ZihfX2ZpcnN0LCBfX2xhc3QsIF9fcmVzdWx0LAogX19nbnVfY3h4OjpfX29wczo6X19pdGVyX2Vx
dWFsc192YWwoX192YWx1ZSkpOwogICAgfQojIDY5NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvciwgdHlw
ZW5hbWUgX091dHB1dEl0ZXJhdG9yLAogICAgdHlwZW5hbWUgX1ByZWRpY2F0ZT4KICAgIGlubGlu
ZSBfT3V0cHV0SXRlcmF0b3IKICAgIHJlbW92ZV9jb3B5X2lmKF9JbnB1dEl0ZXJhdG9yIF9fZmly
c3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgICBfT3V0cHV0SXRlcmF0b3IgX19yZXN1bHQs
IF9QcmVkaWNhdGUgX19wcmVkKQogICAgewoKICAgICAKICAgICAKCiAgICAgCgogICAgICA7Cgog
ICAgICByZXR1cm4gc3RkOjpfX3JlbW92ZV9jb3B5X2lmKF9fZmlyc3QsIF9fbGFzdCwgX19yZXN1
bHQsCiAgICAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX3ByZWRfaXRlcihfX3ByZWQpKTsKICAgIH0K
IyA3MzEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9PdXRwdXRJdGVyYXRvciwKICAg
IHR5cGVuYW1lIF9QcmVkaWNhdGU+CiAgICBfT3V0cHV0SXRlcmF0b3IKICAgIGNvcHlfaWYoX0lu
cHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgIF9PdXRwdXRJ
dGVyYXRvciBfX3Jlc3VsdCwgX1ByZWRpY2F0ZSBfX3ByZWQpCiAgICB7CgogICAgIAogICAgIAoK
ICAgICAKCiAgICAgIDsKCiAgICAgIGZvciAoOyBfX2ZpcnN0ICE9IF9fbGFzdDsgKytfX2ZpcnN0
KQogaWYgKF9fcHJlZCgqX19maXJzdCkpCiAgIHsKICAgICAqX19yZXN1bHQgPSAqX19maXJzdDsK
ICAgICArK19fcmVzdWx0OwogICB9CiAgICAgIHJldHVybiBfX3Jlc3VsdDsKICAgIH0KCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9TaXplLCB0eXBlbmFtZSBf
T3V0cHV0SXRlcmF0b3I+CiAgICBfT3V0cHV0SXRlcmF0b3IKICAgIF9fY29weV9uKF9JbnB1dEl0
ZXJhdG9yIF9fZmlyc3QsIF9TaXplIF9fbiwKICAgICAgX091dHB1dEl0ZXJhdG9yIF9fcmVzdWx0
LCBpbnB1dF9pdGVyYXRvcl90YWcpCiAgICB7CiAgICAgIGlmIChfX24gPiAwKQogewogICB3aGls
ZSAodHJ1ZSkKICAgICB7CiAgICAgICAqX19yZXN1bHQgPSAqX19maXJzdDsKICAgICAgICsrX19y
ZXN1bHQ7CiAgICAgICBpZiAoLS1fX24gPiAwKQogICsrX19maXJzdDsKICAgICAgIGVsc2UKICBi
cmVhazsKICAgICB9CiB9CiAgICAgIHJldHVybiBfX3Jlc3VsdDsKICAgIH0KCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBfU2l6ZSwKICAgIHR5cGVu
YW1lIF9PdXRwdXRJdGVyYXRvcj4KICAgIGlubGluZSBfT3V0cHV0SXRlcmF0b3IKICAgIF9fY29w
eV9uKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0LCBfU2l6ZSBfX24sCiAgICAgIF9PdXRw
dXRJdGVyYXRvciBfX3Jlc3VsdCwgcmFuZG9tX2FjY2Vzc19pdGVyYXRvcl90YWcpCiAgICB7IHJl
dHVybiBzdGQ6OmNvcHkoX19maXJzdCwgX19maXJzdCArIF9fbiwgX19yZXN1bHQpOyB9CiMgNzk0
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5
cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfU2l6ZSwgdHlwZW5hbWUgX091dHB1dEl0
ZXJhdG9yPgogICAgaW5saW5lIF9PdXRwdXRJdGVyYXRvcgogICAgY29weV9uKF9JbnB1dEl0ZXJh
dG9yIF9fZmlyc3QsIF9TaXplIF9fbiwgX091dHB1dEl0ZXJhdG9yIF9fcmVzdWx0KQogICAgewoK
ICAgICAKICAgICAKCgogICAgICByZXR1cm4gc3RkOjpfX2NvcHlfbihfX2ZpcnN0LCBfX24sIF9f
cmVzdWx0LAogICAgICBzdGQ6Ol9faXRlcmF0b3JfY2F0ZWdvcnkoX19maXJzdCkpOwogICAgfQoj
IDgyMiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvciwgdHlwZW5hbWUgX091dHB1dEl0ZXJhdG9yMSwKICAg
IHR5cGVuYW1lIF9PdXRwdXRJdGVyYXRvcjIsIHR5cGVuYW1lIF9QcmVkaWNhdGU+CiAgICBwYWly
PF9PdXRwdXRJdGVyYXRvcjEsIF9PdXRwdXRJdGVyYXRvcjI+CiAgICBwYXJ0aXRpb25fY29weShf
SW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QsCiAgICAgX091dHB1
dEl0ZXJhdG9yMSBfX291dF90cnVlLCBfT3V0cHV0SXRlcmF0b3IyIF9fb3V0X2ZhbHNlLAogICAg
IF9QcmVkaWNhdGUgX19wcmVkKQogICAgewoKICAgICAKICAgICAKCiAgICAgCgogICAgIAoKICAg
ICAgOwoKICAgICAgZm9yICg7IF9fZmlyc3QgIT0gX19sYXN0OyArK19fZmlyc3QpCiBpZiAoX19w
cmVkKCpfX2ZpcnN0KSkKICAgewogICAgICpfX291dF90cnVlID0gKl9fZmlyc3Q7CiAgICAgKytf
X291dF90cnVlOwogICB9CiBlbHNlCiAgIHsKICAgICAqX19vdXRfZmFsc2UgPSAqX19maXJzdDsK
ICAgICArK19fb3V0X2ZhbHNlOwogICB9CgogICAgICByZXR1cm4gcGFpcjxfT3V0cHV0SXRlcmF0
b3IxLCBfT3V0cHV0SXRlcmF0b3IyPihfX291dF90cnVlLCBfX291dF9mYWxzZSk7CiAgICB9CgoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfUHJlZGljYXRl
PgogICAgX0ZvcndhcmRJdGVyYXRvcgogICAgX19yZW1vdmVfaWYoX0ZvcndhcmRJdGVyYXRvciBf
X2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICBfUHJlZGljYXRlIF9fcHJlZCkKICAg
IHsKICAgICAgX19maXJzdCA9IHN0ZDo6X19maW5kX2lmKF9fZmlyc3QsIF9fbGFzdCwgX19wcmVk
KTsKICAgICAgaWYgKF9fZmlyc3QgPT0gX19sYXN0KQogcmV0dXJuIF9fZmlyc3Q7CiAgICAgIF9G
b3J3YXJkSXRlcmF0b3IgX19yZXN1bHQgPSBfX2ZpcnN0OwogICAgICArK19fZmlyc3Q7CiAgICAg
IGZvciAoOyBfX2ZpcnN0ICE9IF9fbGFzdDsgKytfX2ZpcnN0KQogaWYgKCFfX3ByZWQoX19maXJz
dCkpCiAgIHsKICAgICAqX19yZXN1bHQgPSBzdGQ6Om1vdmUoKl9fZmlyc3QpOwogICAgICsrX19y
ZXN1bHQ7CiAgIH0KICAgICAgcmV0dXJuIF9fcmVzdWx0OwogICAgfQojIDg5MSAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9y
d2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgX0ZvcndhcmRJdGVyYXRvcgog
ICAgcmVtb3ZlKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xh
c3QsCiAgICBjb25zdCBfVHAmIF9fdmFsdWUpCiAgICB7CgogICAgIAoKICAgICAKCiAgICAgIDsK
CiAgICAgIHJldHVybiBzdGQ6Ol9fcmVtb3ZlX2lmKF9fZmlyc3QsIF9fbGFzdCwKICBfX2dudV9j
eHg6Ol9fb3BzOjpfX2l0ZXJfZXF1YWxzX3ZhbChfX3ZhbHVlKSk7CiAgICB9CiMgOTI0ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1l
IF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9QcmVkaWNhdGU+CiAgICBpbmxpbmUgX0Zvcndh
cmRJdGVyYXRvcgogICAgcmVtb3ZlX2lmKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0Zvcndh
cmRJdGVyYXRvciBfX2xhc3QsCiAgICAgICBfUHJlZGljYXRlIF9fcHJlZCkKICAgIHsKCiAgICAg
CgogICAgIAoKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19yZW1vdmVfaWYoX19maXJzdCwg
X19sYXN0LAogICAgICAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX3ByZWRfaXRlcihfX3ByZWQpKTsK
ICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX0Jp
bmFyeVByZWRpY2F0ZT4KICAgIF9Gb3J3YXJkSXRlcmF0b3IKICAgIF9fYWRqYWNlbnRfZmluZChf
Rm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0LAogICAgICBf
QmluYXJ5UHJlZGljYXRlIF9fYmluYXJ5X3ByZWQpCiAgICB7CiAgICAgIGlmIChfX2ZpcnN0ID09
IF9fbGFzdCkKIHJldHVybiBfX2xhc3Q7CiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19uZXh0ID0g
X19maXJzdDsKICAgICAgd2hpbGUgKCsrX19uZXh0ICE9IF9fbGFzdCkKIHsKICAgaWYgKF9fYmlu
YXJ5X3ByZWQoX19maXJzdCwgX19uZXh0KSkKICAgICByZXR1cm4gX19maXJzdDsKICAgX19maXJz
dCA9IF9fbmV4dDsKIH0KICAgICAgcmV0dXJuIF9fbGFzdDsKICAgIH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX0JpbmFyeVByZWRpY2F0ZT4KICAgIF9G
b3J3YXJkSXRlcmF0b3IKICAgIF9fdW5pcXVlKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0Zv
cndhcmRJdGVyYXRvciBfX2xhc3QsCiAgICAgIF9CaW5hcnlQcmVkaWNhdGUgX19iaW5hcnlfcHJl
ZCkKICAgIHsKCiAgICAgIF9fZmlyc3QgPSBzdGQ6Ol9fYWRqYWNlbnRfZmluZChfX2ZpcnN0LCBf
X2xhc3QsIF9fYmluYXJ5X3ByZWQpOwogICAgICBpZiAoX19maXJzdCA9PSBfX2xhc3QpCiByZXR1
cm4gX19sYXN0OwoKCiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19kZXN0ID0gX19maXJzdDsKICAg
ICAgKytfX2ZpcnN0OwogICAgICB3aGlsZSAoKytfX2ZpcnN0ICE9IF9fbGFzdCkKIGlmICghX19i
aW5hcnlfcHJlZChfX2Rlc3QsIF9fZmlyc3QpKQogICAqKytfX2Rlc3QgPSBzdGQ6Om1vdmUoKl9f
Zmlyc3QpOwogICAgICByZXR1cm4gKytfX2Rlc3Q7CiAgICB9CiMgOTkwICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJk
SXRlcmF0b3I+CiAgICBpbmxpbmUgX0ZvcndhcmRJdGVyYXRvcgogICAgdW5pcXVlKF9Gb3J3YXJk
SXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QpCiAgICB7CgogICAgIAoK
ICAgICAKCiAgICAgIDsKCiAgICAgIHJldHVybiBzdGQ6Ol9fdW5pcXVlKF9fZmlyc3QsIF9fbGFz
dCwKICAgICAgX19nbnVfY3h4OjpfX29wczo6X19pdGVyX2VxdWFsX3RvX2l0ZXIoKSk7CiAgICB9
CiMgMTAyMCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfQmluYXJ5UHJlZGljYXRl
PgogICAgaW5saW5lIF9Gb3J3YXJkSXRlcmF0b3IKICAgIHVuaXF1ZShfRm9yd2FyZEl0ZXJhdG9y
IF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0LAogICAgX0JpbmFyeVByZWRpY2F0ZSBf
X2JpbmFyeV9wcmVkKQogICAgewoKICAgICAKCiAgICAgCgoKICAgICAgOwoKICAgICAgcmV0dXJu
IHN0ZDo6X191bmlxdWUoX19maXJzdCwgX19sYXN0LAogICAgICBfX2dudV9jeHg6Ol9fb3BzOjpf
X2l0ZXJfY29tcF9pdGVyKF9fYmluYXJ5X3ByZWQpKTsKICAgIH0KCgoKCgoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX091dHB1dEl0ZXJhdG9yLAogICAg
dHlwZW5hbWUgX0JpbmFyeVByZWRpY2F0ZT4KICAgIF9PdXRwdXRJdGVyYXRvcgogICAgX191bmlx
dWVfY29weShfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0
LAogICAgX091dHB1dEl0ZXJhdG9yIF9fcmVzdWx0LCBfQmluYXJ5UHJlZGljYXRlIF9fYmluYXJ5
X3ByZWQsCiAgICBmb3J3YXJkX2l0ZXJhdG9yX3RhZywgb3V0cHV0X2l0ZXJhdG9yX3RhZykKICAg
IHsKCiAgICAgCgoKCiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19uZXh0ID0gX19maXJzdDsKICAg
ICAgKl9fcmVzdWx0ID0gKl9fZmlyc3Q7CiAgICAgIHdoaWxlICgrK19fbmV4dCAhPSBfX2xhc3Qp
CiBpZiAoIV9fYmluYXJ5X3ByZWQoX19maXJzdCwgX19uZXh0KSkKICAgewogICAgIF9fZmlyc3Qg
PSBfX25leHQ7CiAgICAgKisrX19yZXN1bHQgPSAqX19maXJzdDsKICAgfQogICAgICByZXR1cm4g
KytfX3Jlc3VsdDsKICAgIH0KCgoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0
b3IsIHR5cGVuYW1lIF9PdXRwdXRJdGVyYXRvciwKICAgIHR5cGVuYW1lIF9CaW5hcnlQcmVkaWNh
dGU+CiAgICBfT3V0cHV0SXRlcmF0b3IKICAgIF9fdW5pcXVlX2NvcHkoX0lucHV0SXRlcmF0b3Ig
X19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgX091dHB1dEl0ZXJhdG9yIF9fcmVz
dWx0LCBfQmluYXJ5UHJlZGljYXRlIF9fYmluYXJ5X3ByZWQsCiAgICBpbnB1dF9pdGVyYXRvcl90
YWcsIG91dHB1dF9pdGVyYXRvcl90YWcpCiAgICB7CgogICAgIAoKCgogICAgICB0eXBlbmFtZSBp
dGVyYXRvcl90cmFpdHM8X0lucHV0SXRlcmF0b3I+Ojp2YWx1ZV90eXBlIF9fdmFsdWUgPSAqX19m
aXJzdDsKICAgICAgX19kZWNsdHlwZShfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfY29tcF92YWwo
X19iaW5hcnlfcHJlZCkpCiBfX3JlYm91bmRfcHJlZAogPSBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0
ZXJfY29tcF92YWwoX19iaW5hcnlfcHJlZCk7CiAgICAgICpfX3Jlc3VsdCA9IF9fdmFsdWU7CiAg
ICAgIHdoaWxlICgrK19fZmlyc3QgIT0gX19sYXN0KQogaWYgKCFfX3JlYm91bmRfcHJlZChfX2Zp
cnN0LCBfX3ZhbHVlKSkKICAgewogICAgIF9fdmFsdWUgPSAqX19maXJzdDsKICAgICAqKytfX3Jl
c3VsdCA9IF9fdmFsdWU7CiAgIH0KICAgICAgcmV0dXJuICsrX19yZXN1bHQ7CiAgICB9CgoKCgoK
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfRm9yd2FyZEl0
ZXJhdG9yLAogICAgdHlwZW5hbWUgX0JpbmFyeVByZWRpY2F0ZT4KICAgIF9Gb3J3YXJkSXRlcmF0
b3IKICAgIF9fdW5pcXVlX2NvcHkoX0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0
b3IgX19sYXN0LAogICAgX0ZvcndhcmRJdGVyYXRvciBfX3Jlc3VsdCwgX0JpbmFyeVByZWRpY2F0
ZSBfX2JpbmFyeV9wcmVkLAogICAgaW5wdXRfaXRlcmF0b3JfdGFnLCBmb3J3YXJkX2l0ZXJhdG9y
X3RhZykKICAgIHsKCiAgICAgCgoKICAgICAgKl9fcmVzdWx0ID0gKl9fZmlyc3Q7CiAgICAgIHdo
aWxlICgrK19fZmlyc3QgIT0gX19sYXN0KQogaWYgKCFfX2JpbmFyeV9wcmVkKF9fcmVzdWx0LCBf
X2ZpcnN0KSkKICAgKisrX19yZXN1bHQgPSAqX19maXJzdDsKICAgICAgcmV0dXJuICsrX19yZXN1
bHQ7CiAgICB9CgoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0JpZGlyZWN0aW9uYWxJdGVyYXRv
cj4KICAgIHZvaWQKICAgIF9fcmV2ZXJzZShfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yIF9fZmlyc3Qs
IF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IgX19sYXN0LAogICAgICAgYmlkaXJlY3Rpb25hbF9pdGVy
YXRvcl90YWcpCiAgICB7CiAgICAgIHdoaWxlICh0cnVlKQogaWYgKF9fZmlyc3QgPT0gX19sYXN0
IHx8IF9fZmlyc3QgPT0gLS1fX2xhc3QpCiAgIHJldHVybjsKIGVsc2UKICAgewogICAgIHN0ZDo6
aXRlcl9zd2FwKF9fZmlyc3QsIF9fbGFzdCk7CiAgICAgKytfX2ZpcnN0OwogICB9CiAgICB9CgoK
CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yPgogICAgdm9pZAog
ICAgX19yZXZlcnNlKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0LCBfUmFuZG9tQWNjZXNz
SXRlcmF0b3IgX19sYXN0LAogICAgICAgcmFuZG9tX2FjY2Vzc19pdGVyYXRvcl90YWcpCiAgICB7
CiAgICAgIGlmIChfX2ZpcnN0ID09IF9fbGFzdCkKIHJldHVybjsKICAgICAgLS1fX2xhc3Q7CiAg
ICAgIHdoaWxlIChfX2ZpcnN0IDwgX19sYXN0KQogewogICBzdGQ6Oml0ZXJfc3dhcChfX2ZpcnN0
LCBfX2xhc3QpOwogICArK19fZmlyc3Q7CiAgIC0tX19sYXN0OwogfQogICAgfQojIDExNzUgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0JpZGlyZWN0aW9uYWxJdGVyYXRvcj4KICAgIGlubGluZSB2b2lkCiAgICByZXZlcnNlKF9C
aWRpcmVjdGlvbmFsSXRlcmF0b3IgX19maXJzdCwgX0JpZGlyZWN0aW9uYWxJdGVyYXRvciBfX2xh
c3QpCiAgICB7CgogICAgIAoKICAgICAgOwogICAgICBzdGQ6Ol9fcmV2ZXJzZShfX2ZpcnN0LCBf
X2xhc3QsIHN0ZDo6X19pdGVyYXRvcl9jYXRlZ29yeShfX2ZpcnN0KSk7CiAgICB9CiMgMTIwMiAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yLCB0eXBlbmFtZSBfT3V0cHV0SXRlcmF0b3I+CiAg
ICBfT3V0cHV0SXRlcmF0b3IKICAgIHJldmVyc2VfY29weShfQmlkaXJlY3Rpb25hbEl0ZXJhdG9y
IF9fZmlyc3QsIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IgX19sYXN0LAogICBfT3V0cHV0SXRlcmF0
b3IgX19yZXN1bHQpCiAgICB7CgogICAgIAoKICAgICAKCiAgICAgIDsKCiAgICAgIHdoaWxlIChf
X2ZpcnN0ICE9IF9fbGFzdCkKIHsKICAgLS1fX2xhc3Q7CiAgICpfX3Jlc3VsdCA9ICpfX2xhc3Q7
CiAgICsrX19yZXN1bHQ7CiB9CiAgICAgIHJldHVybiBfX3Jlc3VsdDsKICAgIH0KCgoKCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9FdWNsaWRlYW5SaW5nRWxlbWVudD4KICAgIF9FdWNsaWRlYW5SaW5n
RWxlbWVudAogICAgX19nY2QoX0V1Y2xpZGVhblJpbmdFbGVtZW50IF9fbSwgX0V1Y2xpZGVhblJp
bmdFbGVtZW50IF9fbikKICAgIHsKICAgICAgd2hpbGUgKF9fbiAhPSAwKQogewogICBfRXVjbGlk
ZWFuUmluZ0VsZW1lbnQgX190ID0gX19tICUgX19uOwogICBfX20gPSBfX247CiAgIF9fbiA9IF9f
dDsKIH0KICAgICAgcmV0dXJuIF9fbTsKICAgIH0KCiAgaW5saW5lIG5hbWVzcGFjZSBfVjIKICB7
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yPgogICAgX0ZvcndhcmRJdGVy
YXRvcgogICAgX19yb3RhdGUoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LAogICAgICBfRm9yd2Fy
ZEl0ZXJhdG9yIF9fbWlkZGxlLAogICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICAgICAg
Zm9yd2FyZF9pdGVyYXRvcl90YWcpCiAgICB7CiAgICAgIGlmIChfX2ZpcnN0ID09IF9fbWlkZGxl
KQogcmV0dXJuIF9fbGFzdDsKICAgICAgZWxzZSBpZiAoX19sYXN0ID09IF9fbWlkZGxlKQogcmV0
dXJuIF9fZmlyc3Q7CgogICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QyID0gX19taWRkbGU7
CiAgICAgIGRvCiB7CiAgIHN0ZDo6aXRlcl9zd2FwKF9fZmlyc3QsIF9fZmlyc3QyKTsKICAgKytf
X2ZpcnN0OwogICArK19fZmlyc3QyOwogICBpZiAoX19maXJzdCA9PSBfX21pZGRsZSkKICAgICBf
X21pZGRsZSA9IF9fZmlyc3QyOwogfQogICAgICB3aGlsZSAoX19maXJzdDIgIT0gX19sYXN0KTsK
CiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19yZXQgPSBfX2ZpcnN0OwoKICAgICAgX19maXJzdDIg
PSBfX21pZGRsZTsKCiAgICAgIHdoaWxlIChfX2ZpcnN0MiAhPSBfX2xhc3QpCiB7CiAgIHN0ZDo6
aXRlcl9zd2FwKF9fZmlyc3QsIF9fZmlyc3QyKTsKICAgKytfX2ZpcnN0OwogICArK19fZmlyc3Qy
OwogICBpZiAoX19maXJzdCA9PSBfX21pZGRsZSkKICAgICBfX21pZGRsZSA9IF9fZmlyc3QyOwog
ICBlbHNlIGlmIChfX2ZpcnN0MiA9PSBfX2xhc3QpCiAgICAgX19maXJzdDIgPSBfX21pZGRsZTsK
IH0KICAgICAgcmV0dXJuIF9fcmV0OwogICAgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0JpZGly
ZWN0aW9uYWxJdGVyYXRvcj4KICAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IKICAgIF9fcm90YXRl
KF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IgX19maXJzdCwKICAgICAgX0JpZGlyZWN0aW9uYWxJdGVy
YXRvciBfX21pZGRsZSwKICAgICAgX0JpZGlyZWN0aW9uYWxJdGVyYXRvciBfX2xhc3QsCiAgICAg
ICBiaWRpcmVjdGlvbmFsX2l0ZXJhdG9yX3RhZykKICAgIHsKCiAgICAgCgoKICAgICAgaWYgKF9f
Zmlyc3QgPT0gX19taWRkbGUpCiByZXR1cm4gX19sYXN0OwogICAgICBlbHNlIGlmIChfX2xhc3Qg
PT0gX19taWRkbGUpCiByZXR1cm4gX19maXJzdDsKCiAgICAgIHN0ZDo6X19yZXZlcnNlKF9fZmly
c3QsIF9fbWlkZGxlLCBiaWRpcmVjdGlvbmFsX2l0ZXJhdG9yX3RhZygpKTsKICAgICAgc3RkOjpf
X3JldmVyc2UoX19taWRkbGUsIF9fbGFzdCwgYmlkaXJlY3Rpb25hbF9pdGVyYXRvcl90YWcoKSk7
CgogICAgICB3aGlsZSAoX19maXJzdCAhPSBfX21pZGRsZSAmJiBfX21pZGRsZSAhPSBfX2xhc3Qp
CiB7CiAgIHN0ZDo6aXRlcl9zd2FwKF9fZmlyc3QsIC0tX19sYXN0KTsKICAgKytfX2ZpcnN0Owog
fQoKICAgICAgaWYgKF9fZmlyc3QgPT0gX19taWRkbGUpCiB7CiAgIHN0ZDo6X19yZXZlcnNlKF9f
bWlkZGxlLCBfX2xhc3QsIGJpZGlyZWN0aW9uYWxfaXRlcmF0b3JfdGFnKCkpOwogICByZXR1cm4g
X19sYXN0OwogfQogICAgICBlbHNlCiB7CiAgIHN0ZDo6X19yZXZlcnNlKF9fZmlyc3QsIF9fbWlk
ZGxlLCBiaWRpcmVjdGlvbmFsX2l0ZXJhdG9yX3RhZygpKTsKICAgcmV0dXJuIF9fZmlyc3Q7CiB9
CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3I+CiAgICBf
UmFuZG9tQWNjZXNzSXRlcmF0b3IKICAgIF9fcm90YXRlKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBf
X2ZpcnN0LAogICAgICBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19taWRkbGUsCiAgICAgIF9SYW5k
b21BY2Nlc3NJdGVyYXRvciBfX2xhc3QsCiAgICAgIHJhbmRvbV9hY2Nlc3NfaXRlcmF0b3JfdGFn
KQogICAgewoKICAgICAKCgogICAgICBpZiAoX19maXJzdCA9PSBfX21pZGRsZSkKIHJldHVybiBf
X2xhc3Q7CiAgICAgIGVsc2UgaWYgKF9fbGFzdCA9PSBfX21pZGRsZSkKIHJldHVybiBfX2ZpcnN0
OwoKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X1JhbmRvbUFjY2Vzc0l0
ZXJhdG9yPjo6ZGlmZmVyZW5jZV90eXBlCiBfRGlzdGFuY2U7CiAgICAgIHR5cGVkZWYgdHlwZW5h
bWUgaXRlcmF0b3JfdHJhaXRzPF9SYW5kb21BY2Nlc3NJdGVyYXRvcj46OnZhbHVlX3R5cGUKIF9W
YWx1ZVR5cGU7CgogICAgICBfRGlzdGFuY2UgX19uID0gX19sYXN0IC0gX19maXJzdDsKICAgICAg
X0Rpc3RhbmNlIF9fayA9IF9fbWlkZGxlIC0gX19maXJzdDsKCiAgICAgIGlmIChfX2sgPT0gX19u
IC0gX19rKQogewogICBzdGQ6OnN3YXBfcmFuZ2VzKF9fZmlyc3QsIF9fbWlkZGxlLCBfX21pZGRs
ZSk7CiAgIHJldHVybiBfX21pZGRsZTsKIH0KCiAgICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBf
X3AgPSBfX2ZpcnN0OwogICAgICBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19yZXQgPSBfX2ZpcnN0
ICsgKF9fbGFzdCAtIF9fbWlkZGxlKTsKCiAgICAgIGZvciAoOzspCiB7CiAgIGlmIChfX2sgPCBf
X24gLSBfX2spCiAgICAgewogICAgICAgaWYgKF9faXNfcG9kKF9WYWx1ZVR5cGUpICYmIF9fayA9
PSAxKQogIHsKICAgIF9WYWx1ZVR5cGUgX190ID0gc3RkOjptb3ZlKCpfX3ApOwogICAgc3RkOjpt
b3ZlKF9fcCArIDEsIF9fcCArIF9fbiwgX19wKTsKICAgICooX19wICsgX19uIC0gMSkgPSBzdGQ6
Om1vdmUoX190KTsKICAgIHJldHVybiBfX3JldDsKICB9CiAgICAgICBfUmFuZG9tQWNjZXNzSXRl
cmF0b3IgX19xID0gX19wICsgX19rOwogICAgICAgZm9yIChfRGlzdGFuY2UgX19pID0gMDsgX19p
IDwgX19uIC0gX19rOyArKyBfX2kpCiAgewogICAgc3RkOjppdGVyX3N3YXAoX19wLCBfX3EpOwog
ICAgKytfX3A7CiAgICArK19fcTsKICB9CiAgICAgICBfX24gJT0gX19rOwogICAgICAgaWYgKF9f
biA9PSAwKQogIHJldHVybiBfX3JldDsKICAgICAgIHN0ZDo6c3dhcChfX24sIF9fayk7CiAgICAg
ICBfX2sgPSBfX24gLSBfX2s7CiAgICAgfQogICBlbHNlCiAgICAgewogICAgICAgX19rID0gX19u
IC0gX19rOwogICAgICAgaWYgKF9faXNfcG9kKF9WYWx1ZVR5cGUpICYmIF9fayA9PSAxKQogIHsK
ICAgIF9WYWx1ZVR5cGUgX190ID0gc3RkOjptb3ZlKCooX19wICsgX19uIC0gMSkpOwogICAgc3Rk
Ojptb3ZlX2JhY2t3YXJkKF9fcCwgX19wICsgX19uIC0gMSwgX19wICsgX19uKTsKICAgICpfX3Ag
PSBzdGQ6Om1vdmUoX190KTsKICAgIHJldHVybiBfX3JldDsKICB9CiAgICAgICBfUmFuZG9tQWNj
ZXNzSXRlcmF0b3IgX19xID0gX19wICsgX19uOwogICAgICAgX19wID0gX19xIC0gX19rOwogICAg
ICAgZm9yIChfRGlzdGFuY2UgX19pID0gMDsgX19pIDwgX19uIC0gX19rOyArKyBfX2kpCiAgewog
ICAgLS1fX3A7CiAgICAtLV9fcTsKICAgIHN0ZDo6aXRlcl9zd2FwKF9fcCwgX19xKTsKICB9CiAg
ICAgICBfX24gJT0gX19rOwogICAgICAgaWYgKF9fbiA9PSAwKQogIHJldHVybiBfX3JldDsKICAg
ICAgIHN0ZDo6c3dhcChfX24sIF9fayk7CiAgICAgfQogfQogICAgfQojIDE0MjkgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0Zv
cndhcmRJdGVyYXRvcj4KICAgIGlubGluZSBfRm9yd2FyZEl0ZXJhdG9yCiAgICByb3RhdGUoX0Zv
cndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbWlkZGxlLAogICAgX0Zv
cndhcmRJdGVyYXRvciBfX2xhc3QpCiAgICB7CgogICAgIAoKICAgICAgOwogICAgICA7CgogICAg
ICByZXR1cm4gc3RkOjpfX3JvdGF0ZShfX2ZpcnN0LCBfX21pZGRsZSwgX19sYXN0LAogICAgICBz
dGQ6Ol9faXRlcmF0b3JfY2F0ZWdvcnkoX19maXJzdCkpOwogICAgfQoKICB9CiMgMTQ2NiAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfT3V0cHV0SXRlcmF0b3I+CiAgICBpbmxpbmUg
X091dHB1dEl0ZXJhdG9yCiAgICByb3RhdGVfY29weShfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3Qs
IF9Gb3J3YXJkSXRlcmF0b3IgX19taWRkbGUsCiAgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QsIF9P
dXRwdXRJdGVyYXRvciBfX3Jlc3VsdCkKICAgIHsKCiAgICAgCiAgICAgCgogICAgICA7CiAgICAg
IDsKCiAgICAgIHJldHVybiBzdGQ6OmNvcHkoX19maXJzdCwgX19taWRkbGUsCiAgICAgICAgIHN0
ZDo6Y29weShfX21pZGRsZSwgX19sYXN0LCBfX3Jlc3VsdCkpOwogICAgfQoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX1ByZWRpY2F0ZT4KICAgIF9Gb3J3
YXJkSXRlcmF0b3IKICAgIF9fcGFydGl0aW9uKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0Zv
cndhcmRJdGVyYXRvciBfX2xhc3QsCiAgX1ByZWRpY2F0ZSBfX3ByZWQsIGZvcndhcmRfaXRlcmF0
b3JfdGFnKQogICAgewogICAgICBpZiAoX19maXJzdCA9PSBfX2xhc3QpCiByZXR1cm4gX19maXJz
dDsKCiAgICAgIHdoaWxlIChfX3ByZWQoKl9fZmlyc3QpKQogaWYgKCsrX19maXJzdCA9PSBfX2xh
c3QpCiAgIHJldHVybiBfX2ZpcnN0OwoKICAgICAgX0ZvcndhcmRJdGVyYXRvciBfX25leHQgPSBf
X2ZpcnN0OwoKICAgICAgd2hpbGUgKCsrX19uZXh0ICE9IF9fbGFzdCkKIGlmIChfX3ByZWQoKl9f
bmV4dCkpCiAgIHsKICAgICBzdGQ6Oml0ZXJfc3dhcChfX2ZpcnN0LCBfX25leHQpOwogICAgICsr
X19maXJzdDsKICAgfQoKICAgICAgcmV0dXJuIF9fZmlyc3Q7CiAgICB9CgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yLCB0eXBlbmFtZSBfUHJlZGljYXRlPgogICAg
X0JpZGlyZWN0aW9uYWxJdGVyYXRvcgogICAgX19wYXJ0aXRpb24oX0JpZGlyZWN0aW9uYWxJdGVy
YXRvciBfX2ZpcnN0LCBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yIF9fbGFzdCwKICBfUHJlZGljYXRl
IF9fcHJlZCwgYmlkaXJlY3Rpb25hbF9pdGVyYXRvcl90YWcpCiAgICB7CiAgICAgIHdoaWxlICh0
cnVlKQogewogICB3aGlsZSAodHJ1ZSkKICAgICBpZiAoX19maXJzdCA9PSBfX2xhc3QpCiAgICAg
ICByZXR1cm4gX19maXJzdDsKICAgICBlbHNlIGlmIChfX3ByZWQoKl9fZmlyc3QpKQogICAgICAg
KytfX2ZpcnN0OwogICAgIGVsc2UKICAgICAgIGJyZWFrOwogICAtLV9fbGFzdDsKICAgd2hpbGUg
KHRydWUpCiAgICAgaWYgKF9fZmlyc3QgPT0gX19sYXN0KQogICAgICAgcmV0dXJuIF9fZmlyc3Q7
CiAgICAgZWxzZSBpZiAoIWJvb2woX19wcmVkKCpfX2xhc3QpKSkKICAgICAgIC0tX19sYXN0Owog
ICAgIGVsc2UKICAgICAgIGJyZWFrOwogICBzdGQ6Oml0ZXJfc3dhcChfX2ZpcnN0LCBfX2xhc3Qp
OwogICArK19fZmlyc3Q7CiB9CiAgICB9CiMgMTU0MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0
eXBlbmFtZSBfUG9pbnRlciwgdHlwZW5hbWUgX1ByZWRpY2F0ZSwKICAgIHR5cGVuYW1lIF9EaXN0
YW5jZT4KICAgIF9Gb3J3YXJkSXRlcmF0b3IKICAgIF9fc3RhYmxlX3BhcnRpdGlvbl9hZGFwdGl2
ZShfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsCiAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwK
ICAgIF9QcmVkaWNhdGUgX19wcmVkLCBfRGlzdGFuY2UgX19sZW4sCiAgICBfUG9pbnRlciBfX2J1
ZmZlciwKICAgIF9EaXN0YW5jZSBfX2J1ZmZlcl9zaXplKQogICAgewogICAgICBpZiAoX19sZW4g
PT0gMSkKIHJldHVybiBfX2ZpcnN0OwoKICAgICAgaWYgKF9fbGVuIDw9IF9fYnVmZmVyX3NpemUp
CiB7CiAgIF9Gb3J3YXJkSXRlcmF0b3IgX19yZXN1bHQxID0gX19maXJzdDsKICAgX1BvaW50ZXIg
X19yZXN1bHQyID0gX19idWZmZXI7CgoKCgogICAqX19yZXN1bHQyID0gc3RkOjptb3ZlKCpfX2Zp
cnN0KTsKICAgKytfX3Jlc3VsdDI7CiAgICsrX19maXJzdDsKICAgZm9yICg7IF9fZmlyc3QgIT0g
X19sYXN0OyArK19fZmlyc3QpCiAgICAgaWYgKF9fcHJlZChfX2ZpcnN0KSkKICAgICAgIHsKICAq
X19yZXN1bHQxID0gc3RkOjptb3ZlKCpfX2ZpcnN0KTsKICArK19fcmVzdWx0MTsKICAgICAgIH0K
ICAgICBlbHNlCiAgICAgICB7CiAgKl9fcmVzdWx0MiA9IHN0ZDo6bW92ZSgqX19maXJzdCk7CiAg
KytfX3Jlc3VsdDI7CiAgICAgICB9CgogICBzdGQ6Om1vdmUoX19idWZmZXIsIF9fcmVzdWx0Miwg
X19yZXN1bHQxKTsKICAgcmV0dXJuIF9fcmVzdWx0MTsKIH0KCiAgICAgIF9Gb3J3YXJkSXRlcmF0
b3IgX19taWRkbGUgPSBfX2ZpcnN0OwogICAgICBzdGQ6OmFkdmFuY2UoX19taWRkbGUsIF9fbGVu
IC8gMik7CiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19sZWZ0X3NwbGl0ID0KIHN0ZDo6X19zdGFi
bGVfcGFydGl0aW9uX2FkYXB0aXZlKF9fZmlyc3QsIF9fbWlkZGxlLCBfX3ByZWQsCiAgICAgIF9f
bGVuIC8gMiwgX19idWZmZXIsCiAgICAgIF9fYnVmZmVyX3NpemUpOwoKCgogICAgICBfRGlzdGFu
Y2UgX19yaWdodF9sZW4gPSBfX2xlbiAtIF9fbGVuIC8gMjsKICAgICAgX0ZvcndhcmRJdGVyYXRv
ciBfX3JpZ2h0X3NwbGl0ID0KIHN0ZDo6X19maW5kX2lmX25vdF9uKF9fbWlkZGxlLCBfX3JpZ2h0
X2xlbiwgX19wcmVkKTsKCiAgICAgIGlmIChfX3JpZ2h0X2xlbikKIF9fcmlnaHRfc3BsaXQgPQog
ICBzdGQ6Ol9fc3RhYmxlX3BhcnRpdGlvbl9hZGFwdGl2ZShfX3JpZ2h0X3NwbGl0LCBfX2xhc3Qs
IF9fcHJlZCwKICAgICAgICBfX3JpZ2h0X2xlbiwKICAgICAgICBfX2J1ZmZlciwgX19idWZmZXJf
c2l6ZSk7CgogICAgICBzdGQ6OnJvdGF0ZShfX2xlZnRfc3BsaXQsIF9fbWlkZGxlLCBfX3JpZ2h0
X3NwbGl0KTsKICAgICAgc3RkOjphZHZhbmNlKF9fbGVmdF9zcGxpdCwgc3RkOjpkaXN0YW5jZShf
X21pZGRsZSwgX19yaWdodF9zcGxpdCkpOwogICAgICByZXR1cm4gX19sZWZ0X3NwbGl0OwogICAg
fQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfUHJlZGlj
YXRlPgogICAgX0ZvcndhcmRJdGVyYXRvcgogICAgX19zdGFibGVfcGFydGl0aW9uKF9Gb3J3YXJk
SXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QsCiAgICAgICAgIF9QcmVk
aWNhdGUgX19wcmVkKQogICAgewogICAgICBfX2ZpcnN0ID0gc3RkOjpfX2ZpbmRfaWZfbm90KF9f
Zmlyc3QsIF9fbGFzdCwgX19wcmVkKTsKCiAgICAgIGlmIChfX2ZpcnN0ID09IF9fbGFzdCkKIHJl
dHVybiBfX2ZpcnN0OwoKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0Zv
cndhcmRJdGVyYXRvcj46OnZhbHVlX3R5cGUKIF9WYWx1ZVR5cGU7CiAgICAgIHR5cGVkZWYgdHlw
ZW5hbWUgaXRlcmF0b3JfdHJhaXRzPF9Gb3J3YXJkSXRlcmF0b3I+OjpkaWZmZXJlbmNlX3R5cGUK
IF9EaXN0YW5jZVR5cGU7CgogICAgICBfVGVtcG9yYXJ5X2J1ZmZlcjxfRm9yd2FyZEl0ZXJhdG9y
LCBfVmFsdWVUeXBlPiBfX2J1ZihfX2ZpcnN0LCBfX2xhc3QpOwogICAgICByZXR1cm4KIHN0ZDo6
X19zdGFibGVfcGFydGl0aW9uX2FkYXB0aXZlKF9fZmlyc3QsIF9fbGFzdCwgX19wcmVkLAogICAg
ICBfRGlzdGFuY2VUeXBlKF9fYnVmLnJlcXVlc3RlZF9zaXplKCkpLAogICAgICBfX2J1Zi5iZWdp
bigpLAogICAgICBfRGlzdGFuY2VUeXBlKF9fYnVmLnNpemUoKSkpOwogICAgfQojIDE2NDYgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX1ByZWRpY2F0ZT4KICAgIGlubGluZSBfRm9y
d2FyZEl0ZXJhdG9yCiAgICBzdGFibGVfcGFydGl0aW9uKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJz
dCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QsCiAgICAgICBfUHJlZGljYXRlIF9fcHJlZCkKICAg
IHsKCiAgICAgCgogICAgIAoKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19zdGFibGVfcGFy
dGl0aW9uKF9fZmlyc3QsIF9fbGFzdCwKICAgICAgICAgX19nbnVfY3h4OjpfX29wczo6X19wcmVk
X2l0ZXIoX19wcmVkKSk7CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNz
SXRlcmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgdm9pZAogICAgX19oZWFwX3NlbGVjdChf
UmFuZG9tQWNjZXNzSXRlcmF0b3IgX19maXJzdCwKICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBf
X21pZGRsZSwKICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QsIF9Db21wYXJlIF9fY29t
cCkKICAgIHsKICAgICAgc3RkOjpfX21ha2VfaGVhcChfX2ZpcnN0LCBfX21pZGRsZSwgX19jb21w
KTsKICAgICAgZm9yIChfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19pID0gX19taWRkbGU7IF9faSA8
IF9fbGFzdDsgKytfX2kpCiBpZiAoX19jb21wKF9faSwgX19maXJzdCkpCiAgIHN0ZDo6X19wb3Bf
aGVhcChfX2ZpcnN0LCBfX21pZGRsZSwgX19pLCBfX2NvbXApOwogICAgfQoKCgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3Is
CiAgICB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvcgogICAgX19w
YXJ0aWFsX3NvcnRfY29weShfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBf
X2xhc3QsCiAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX3Jlc3VsdF9maXJzdCwKICAgX1JhbmRv
bUFjY2Vzc0l0ZXJhdG9yIF9fcmVzdWx0X2xhc3QsCiAgIF9Db21wYXJlIF9fY29tcCkKICAgIHsK
ICAgICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0lucHV0SXRlcmF0b3I+Ojp2
YWx1ZV90eXBlCiBfSW5wdXRWYWx1ZVR5cGU7CiAgICAgIHR5cGVkZWYgaXRlcmF0b3JfdHJhaXRz
PF9SYW5kb21BY2Nlc3NJdGVyYXRvcj4gX1JJdFRyYWl0czsKICAgICAgdHlwZWRlZiB0eXBlbmFt
ZSBfUkl0VHJhaXRzOjpkaWZmZXJlbmNlX3R5cGUgX0Rpc3RhbmNlVHlwZTsKCiAgICAgIGlmIChf
X3Jlc3VsdF9maXJzdCA9PSBfX3Jlc3VsdF9sYXN0KQogcmV0dXJuIF9fcmVzdWx0X2xhc3Q7CiAg
ICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX3Jlc3VsdF9yZWFsX2xhc3QgPSBfX3Jlc3VsdF9m
aXJzdDsKICAgICAgd2hpbGUgKF9fZmlyc3QgIT0gX19sYXN0ICYmIF9fcmVzdWx0X3JlYWxfbGFz
dCAhPSBfX3Jlc3VsdF9sYXN0KQogewogICAqX19yZXN1bHRfcmVhbF9sYXN0ID0gKl9fZmlyc3Q7
CiAgICsrX19yZXN1bHRfcmVhbF9sYXN0OwogICArK19fZmlyc3Q7CiB9CgogICAgICBzdGQ6Ol9f
bWFrZV9oZWFwKF9fcmVzdWx0X2ZpcnN0LCBfX3Jlc3VsdF9yZWFsX2xhc3QsIF9fY29tcCk7CiAg
ICAgIHdoaWxlIChfX2ZpcnN0ICE9IF9fbGFzdCkKIHsKICAgaWYgKF9fY29tcChfX2ZpcnN0LCBf
X3Jlc3VsdF9maXJzdCkpCiAgICAgc3RkOjpfX2FkanVzdF9oZWFwKF9fcmVzdWx0X2ZpcnN0LCBf
RGlzdGFuY2VUeXBlKDApLAogICAgICAgICAgX0Rpc3RhbmNlVHlwZShfX3Jlc3VsdF9yZWFsX2xh
c3QKICAgICAgICAgIC0gX19yZXN1bHRfZmlyc3QpLAogICAgICAgICAgX0lucHV0VmFsdWVUeXBl
KCpfX2ZpcnN0KSwgX19jb21wKTsKICAgKytfX2ZpcnN0OwogfQogICAgICBzdGQ6Ol9fc29ydF9o
ZWFwKF9fcmVzdWx0X2ZpcnN0LCBfX3Jlc3VsdF9yZWFsX2xhc3QsIF9fY29tcCk7CiAgICAgIHJl
dHVybiBfX3Jlc3VsdF9yZWFsX2xhc3Q7CiAgICB9CiMgMTczMiAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRv
ciwgdHlwZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yPgogICAgaW5saW5lIF9SYW5kb21BY2Nl
c3NJdGVyYXRvcgogICAgcGFydGlhbF9zb3J0X2NvcHkoX0lucHV0SXRlcmF0b3IgX19maXJzdCwg
X0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX3Jl
c3VsdF9maXJzdCwKICAgICAgICBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19yZXN1bHRfbGFzdCkK
ICAgIHsKIyAxNzQ2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwog
ICAgIAogICAgIAoKICAgICAKCiAgICAgCiAgICAgIDsKICAgICAgOwogICAgICA7CgogICAgICBy
ZXR1cm4gc3RkOjpfX3BhcnRpYWxfc29ydF9jb3B5KF9fZmlyc3QsIF9fbGFzdCwKICAgICAgICAg
IF9fcmVzdWx0X2ZpcnN0LCBfX3Jlc3VsdF9sYXN0LAogICAgICAgICAgX19nbnVfY3h4OjpfX29w
czo6X19pdGVyX2xlc3NfaXRlcigpKTsKICAgIH0KIyAxNzgxICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9y
LCB0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IsCiAgICB0eXBlbmFtZSBfQ29tcGFyZT4K
ICAgIGlubGluZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IKICAgIHBhcnRpYWxfc29ydF9jb3B5KF9J
bnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgICBfUmFu
ZG9tQWNjZXNzSXRlcmF0b3IgX19yZXN1bHRfZmlyc3QsCiAgICAgICAgX1JhbmRvbUFjY2Vzc0l0
ZXJhdG9yIF9fcmVzdWx0X2xhc3QsCiAgICAgICAgX0NvbXBhcmUgX19jb21wKQogICAgewojIDE3
OTcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgICAgCiAgICAg
CgogICAgIAoKICAgICAKCiAgICAgCgogICAgICA7CiAgICAgIDsKICAgICAgOwoKICAgICAgcmV0
dXJuIHN0ZDo6X19wYXJ0aWFsX3NvcnRfY29weShfX2ZpcnN0LCBfX2xhc3QsCiAgICAgICAgICBf
X3Jlc3VsdF9maXJzdCwgX19yZXN1bHRfbGFzdCwKICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRl
cl9jb21wX2l0ZXIoX19jb21wKSk7CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9t
QWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgdm9pZAogICAgX191bmd1YXJk
ZWRfbGluZWFyX2luc2VydChfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0LAogICAgICAgICBf
Q29tcGFyZSBfX2NvbXApCiAgICB7CiAgICAgIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfUmFu
ZG9tQWNjZXNzSXRlcmF0b3I+Ojp2YWx1ZV90eXBlCiBfX3ZhbCA9IHN0ZDo6bW92ZSgqX19sYXN0
KTsKICAgICAgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fbmV4dCA9IF9fbGFzdDsKICAgICAgLS1f
X25leHQ7CiAgICAgIHdoaWxlIChfX2NvbXAoX192YWwsIF9fbmV4dCkpCiB7CiAgICpfX2xhc3Qg
PSBzdGQ6Om1vdmUoKl9fbmV4dCk7CiAgIF9fbGFzdCA9IF9fbmV4dDsKICAgLS1fX25leHQ7CiB9
CiAgICAgICpfX2xhc3QgPSBzdGQ6Om1vdmUoX192YWwpOwogICAgfQoKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIHZvaWQK
ICAgIF9faW5zZXJ0aW9uX3NvcnQoX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fZmlyc3QsCiAgICAg
ICBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0LCBfQ29tcGFyZSBfX2NvbXApCiAgICB7CiAg
ICAgIGlmIChfX2ZpcnN0ID09IF9fbGFzdCkgcmV0dXJuOwoKICAgICAgZm9yIChfUmFuZG9tQWNj
ZXNzSXRlcmF0b3IgX19pID0gX19maXJzdCArIDE7IF9faSAhPSBfX2xhc3Q7ICsrX19pKQogewog
ICBpZiAoX19jb21wKF9faSwgX19maXJzdCkpCiAgICAgewogICAgICAgdHlwZW5hbWUgaXRlcmF0
b3JfdHJhaXRzPF9SYW5kb21BY2Nlc3NJdGVyYXRvcj46OnZhbHVlX3R5cGUKICBfX3ZhbCA9IHN0
ZDo6bW92ZSgqX19pKTsKICAgICAgIHN0ZDo6bW92ZV9iYWNrd2FyZChfX2ZpcnN0LCBfX2ksIF9f
aSArIDEpOwogICAgICAgKl9fZmlyc3QgPSBzdGQ6Om1vdmUoX192YWwpOwogICAgIH0KICAgZWxz
ZQogICAgIHN0ZDo6X191bmd1YXJkZWRfbGluZWFyX2luc2VydChfX2ksCiAgICBfX2dudV9jeHg6
Ol9fb3BzOjpfX3ZhbF9jb21wX2l0ZXIoX19jb21wKSk7CiB9CiAgICB9CgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgaW5s
aW5lIHZvaWQKICAgIF9fdW5ndWFyZGVkX2luc2VydGlvbl9zb3J0KF9SYW5kb21BY2Nlc3NJdGVy
YXRvciBfX2ZpcnN0LAogICAgICAgICAgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fbGFzdCwgX0Nv
bXBhcmUgX19jb21wKQogICAgewogICAgICBmb3IgKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2kg
PSBfX2ZpcnN0OyBfX2kgIT0gX19sYXN0OyArK19faSkKIHN0ZDo6X191bmd1YXJkZWRfbGluZWFy
X2luc2VydChfX2ksCiAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX3ZhbF9jb21wX2l0ZXIoX19jb21w
KSk7CiAgICB9CgoKCgoKICBlbnVtIHsgX1NfdGhyZXNob2xkID0gMTYgfTsKCgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVyYXRvciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICB2
b2lkCiAgICBfX2ZpbmFsX2luc2VydGlvbl9zb3J0KF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2Zp
cnN0LAogICAgICBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0LCBfQ29tcGFyZSBfX2NvbXAp
CiAgICB7CiAgICAgIGlmIChfX2xhc3QgLSBfX2ZpcnN0ID4gaW50KF9TX3RocmVzaG9sZCkpCiB7
CiAgIHN0ZDo6X19pbnNlcnRpb25fc29ydChfX2ZpcnN0LCBfX2ZpcnN0ICsgaW50KF9TX3RocmVz
aG9sZCksIF9fY29tcCk7CiAgIHN0ZDo6X191bmd1YXJkZWRfaW5zZXJ0aW9uX3NvcnQoX19maXJz
dCArIGludChfU190aHJlc2hvbGQpLCBfX2xhc3QsCiAgICAgICBfX2NvbXApOwogfQogICAgICBl
bHNlCiBzdGQ6Ol9faW5zZXJ0aW9uX3NvcnQoX19maXJzdCwgX19sYXN0LCBfX2NvbXApOwogICAg
fQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBf
Q29tcGFyZT4KICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvcgogICAgX191bmd1YXJkZWRfcGFydGl0
aW9uKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0LAogICAgIF9SYW5kb21BY2Nlc3NJdGVy
YXRvciBfX2xhc3QsCiAgICAgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fcGl2b3QsIF9Db21wYXJl
IF9fY29tcCkKICAgIHsKICAgICAgd2hpbGUgKHRydWUpCiB7CiAgIHdoaWxlIChfX2NvbXAoX19m
aXJzdCwgX19waXZvdCkpCiAgICAgKytfX2ZpcnN0OwogICAtLV9fbGFzdDsKICAgd2hpbGUgKF9f
Y29tcChfX3Bpdm90LCBfX2xhc3QpKQogICAgIC0tX19sYXN0OwogICBpZiAoIShfX2ZpcnN0IDwg
X19sYXN0KSkKICAgICByZXR1cm4gX19maXJzdDsKICAgc3RkOjppdGVyX3N3YXAoX19maXJzdCwg
X19sYXN0KTsKICAgKytfX2ZpcnN0OwogfQogICAgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Jh
bmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIGlubGluZSBfUmFuZG9t
QWNjZXNzSXRlcmF0b3IKICAgIF9fdW5ndWFyZGVkX3BhcnRpdGlvbl9waXZvdChfUmFuZG9tQWNj
ZXNzSXRlcmF0b3IgX19maXJzdCwKICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QsIF9D
b21wYXJlIF9fY29tcCkKICAgIHsKICAgICAgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fbWlkID0g
X19maXJzdCArIChfX2xhc3QgLSBfX2ZpcnN0KSAvIDI7CiAgICAgIHN0ZDo6X19tb3ZlX21lZGlh
bl90b19maXJzdChfX2ZpcnN0LCBfX2ZpcnN0ICsgMSwgX19taWQsIF9fbGFzdCAtIDEsCiAgICAg
IF9fY29tcCk7CiAgICAgIHJldHVybiBzdGQ6Ol9fdW5ndWFyZGVkX3BhcnRpdGlvbihfX2ZpcnN0
ICsgMSwgX19sYXN0LCBfX2ZpcnN0LCBfX2NvbXApOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgaW5saW5lIHZv
aWQKICAgIF9fcGFydGlhbF9zb3J0KF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0LAogICAg
IF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX21pZGRsZSwKICAgICBfUmFuZG9tQWNjZXNzSXRlcmF0
b3IgX19sYXN0LAogICAgIF9Db21wYXJlIF9fY29tcCkKICAgIHsKICAgICAgc3RkOjpfX2hlYXBf
c2VsZWN0KF9fZmlyc3QsIF9fbWlkZGxlLCBfX2xhc3QsIF9fY29tcCk7CiAgICAgIHN0ZDo6X19z
b3J0X2hlYXAoX19maXJzdCwgX19taWRkbGUsIF9fY29tcCk7CiAgICB9CgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9TaXplLCB0eXBlbmFtZSBf
Q29tcGFyZT4KICAgIHZvaWQKICAgIF9faW50cm9zb3J0X2xvb3AoX1JhbmRvbUFjY2Vzc0l0ZXJh
dG9yIF9fZmlyc3QsCiAgICAgICBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0LAogICAgICAg
X1NpemUgX19kZXB0aF9saW1pdCwgX0NvbXBhcmUgX19jb21wKQogICAgewogICAgICB3aGlsZSAo
X19sYXN0IC0gX19maXJzdCA+IGludChfU190aHJlc2hvbGQpKQogewogICBpZiAoX19kZXB0aF9s
aW1pdCA9PSAwKQogICAgIHsKICAgICAgIHN0ZDo6X19wYXJ0aWFsX3NvcnQoX19maXJzdCwgX19s
YXN0LCBfX2xhc3QsIF9fY29tcCk7CiAgICAgICByZXR1cm47CiAgICAgfQogICAtLV9fZGVwdGhf
bGltaXQ7CiAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2N1dCA9CiAgICAgc3RkOjpfX3VuZ3Vh
cmRlZF9wYXJ0aXRpb25fcGl2b3QoX19maXJzdCwgX19sYXN0LCBfX2NvbXApOwogICBzdGQ6Ol9f
aW50cm9zb3J0X2xvb3AoX19jdXQsIF9fbGFzdCwgX19kZXB0aF9saW1pdCwgX19jb21wKTsKICAg
X19sYXN0ID0gX19jdXQ7CiB9CiAgICB9CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFj
Y2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIGlubGluZSB2b2lkCiAgICBfX3Nv
cnQoX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fZmlyc3QsIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBf
X2xhc3QsCiAgICBfQ29tcGFyZSBfX2NvbXApCiAgICB7CiAgICAgIGlmIChfX2ZpcnN0ICE9IF9f
bGFzdCkKIHsKICAgc3RkOjpfX2ludHJvc29ydF9sb29wKF9fZmlyc3QsIF9fbGFzdCwKICAgIHN0
ZDo6X19sZyhfX2xhc3QgLSBfX2ZpcnN0KSAqIDIsCiAgICBfX2NvbXApOwogICBzdGQ6Ol9fZmlu
YWxfaW5zZXJ0aW9uX3NvcnQoX19maXJzdCwgX19sYXN0LCBfX2NvbXApOwogfQogICAgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9TaXplLCB0
eXBlbmFtZSBfQ29tcGFyZT4KICAgIHZvaWQKICAgIF9faW50cm9zZWxlY3QoX1JhbmRvbUFjY2Vz
c0l0ZXJhdG9yIF9fZmlyc3QsIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX250aCwKICAgIF9SYW5k
b21BY2Nlc3NJdGVyYXRvciBfX2xhc3QsIF9TaXplIF9fZGVwdGhfbGltaXQsCiAgICBfQ29tcGFy
ZSBfX2NvbXApCiAgICB7CiAgICAgIHdoaWxlIChfX2xhc3QgLSBfX2ZpcnN0ID4gMykKIHsKICAg
aWYgKF9fZGVwdGhfbGltaXQgPT0gMCkKICAgICB7CiAgICAgICBzdGQ6Ol9faGVhcF9zZWxlY3Qo
X19maXJzdCwgX19udGggKyAxLCBfX2xhc3QsIF9fY29tcCk7CgogICAgICAgc3RkOjppdGVyX3N3
YXAoX19maXJzdCwgX19udGgpOwogICAgICAgcmV0dXJuOwogICAgIH0KICAgLS1fX2RlcHRoX2xp
bWl0OwogICBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19jdXQgPQogICAgIHN0ZDo6X191bmd1YXJk
ZWRfcGFydGl0aW9uX3Bpdm90KF9fZmlyc3QsIF9fbGFzdCwgX19jb21wKTsKICAgaWYgKF9fY3V0
IDw9IF9fbnRoKQogICAgIF9fZmlyc3QgPSBfX2N1dDsKICAgZWxzZQogICAgIF9fbGFzdCA9IF9f
Y3V0OwogfQogICAgICBzdGQ6Ol9faW5zZXJ0aW9uX3NvcnQoX19maXJzdCwgX19sYXN0LCBfX2Nv
bXApOwogICAgfQojIDIwMTggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5o
IiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX1RwLCB0
eXBlbmFtZSBfQ29tcGFyZT4KICAgIGlubGluZSBfRm9yd2FyZEl0ZXJhdG9yCiAgICBsb3dlcl9i
b3VuZChfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0LAog
IGNvbnN0IF9UcCYgX192YWwsIF9Db21wYXJlIF9fY29tcCkKICAgIHsKCiAgICAgCiAgICAgCgog
ICAgIAogICAgICAgICAgICAgICAgICAgIDsKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19s
b3dlcl9ib3VuZChfX2ZpcnN0LCBfX2xhc3QsIF9fdmFsLAogICAgX19nbnVfY3h4OjpfX29wczo6
X19pdGVyX2NvbXBfdmFsKF9fY29tcCkpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9y
d2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgX0Zvcndh
cmRJdGVyYXRvcgogICAgX191cHBlcl9ib3VuZChfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9G
b3J3YXJkSXRlcmF0b3IgX19sYXN0LAogICAgY29uc3QgX1RwJiBfX3ZhbCwgX0NvbXBhcmUgX19j
b21wKQogICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfRm9yd2Fy
ZEl0ZXJhdG9yPjo6ZGlmZmVyZW5jZV90eXBlCiBfRGlzdGFuY2VUeXBlOwoKICAgICAgX0Rpc3Rh
bmNlVHlwZSBfX2xlbiA9IHN0ZDo6ZGlzdGFuY2UoX19maXJzdCwgX19sYXN0KTsKCiAgICAgIHdo
aWxlIChfX2xlbiA+IDApCiB7CiAgIF9EaXN0YW5jZVR5cGUgX19oYWxmID0gX19sZW4gPj4gMTsK
ICAgX0ZvcndhcmRJdGVyYXRvciBfX21pZGRsZSA9IF9fZmlyc3Q7CiAgIHN0ZDo6YWR2YW5jZShf
X21pZGRsZSwgX19oYWxmKTsKICAgaWYgKF9fY29tcChfX3ZhbCwgX19taWRkbGUpKQogICAgIF9f
bGVuID0gX19oYWxmOwogICBlbHNlCiAgICAgewogICAgICAgX19maXJzdCA9IF9fbWlkZGxlOwog
ICAgICAgKytfX2ZpcnN0OwogICAgICAgX19sZW4gPSBfX2xlbiAtIF9faGFsZiAtIDE7CiAgICAg
fQogfQogICAgICByZXR1cm4gX19maXJzdDsKICAgIH0KIyAyMDczICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRl
cmF0b3IsIHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBfRm9yd2FyZEl0ZXJhdG9yCiAgICB1cHBl
cl9ib3VuZChfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0
LAogIGNvbnN0IF9UcCYgX192YWwpCiAgICB7CgogICAgIAogICAgIAoKICAgICAgOwogICAgICA7
CgogICAgICByZXR1cm4gc3RkOjpfX3VwcGVyX2JvdW5kKF9fZmlyc3QsIF9fbGFzdCwgX192YWws
CiAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX3ZhbF9sZXNzX2l0ZXIoKSk7CiAgICB9CiMgMjEwNCAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9Db21wYXJlPgog
ICAgaW5saW5lIF9Gb3J3YXJkSXRlcmF0b3IKICAgIHVwcGVyX2JvdW5kKF9Gb3J3YXJkSXRlcmF0
b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QsCiAgY29uc3QgX1RwJiBfX3ZhbCwg
X0NvbXBhcmUgX19jb21wKQogICAgewoKICAgICAKICAgICAKCiAgICAgCiAgICAgICAgICAgICAg
ICAgICAgOwogICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX3VwcGVyX2JvdW5kKF9fZmlyc3Qs
IF9fbGFzdCwgX192YWwsCiAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX3ZhbF9jb21wX2l0ZXIoX19j
b21wKSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVu
YW1lIF9UcCwKICAgIHR5cGVuYW1lIF9Db21wYXJlSXRUcCwgdHlwZW5hbWUgX0NvbXBhcmVUcEl0
PgogICAgcGFpcjxfRm9yd2FyZEl0ZXJhdG9yLCBfRm9yd2FyZEl0ZXJhdG9yPgogICAgX19lcXVh
bF9yYW5nZShfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0
LAogICAgY29uc3QgX1RwJiBfX3ZhbCwKICAgIF9Db21wYXJlSXRUcCBfX2NvbXBfaXRfdmFsLCBf
Q29tcGFyZVRwSXQgX19jb21wX3ZhbF9pdCkKICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBp
dGVyYXRvcl90cmFpdHM8X0ZvcndhcmRJdGVyYXRvcj46OmRpZmZlcmVuY2VfdHlwZQogX0Rpc3Rh
bmNlVHlwZTsKCiAgICAgIF9EaXN0YW5jZVR5cGUgX19sZW4gPSBzdGQ6OmRpc3RhbmNlKF9fZmly
c3QsIF9fbGFzdCk7CgogICAgICB3aGlsZSAoX19sZW4gPiAwKQogewogICBfRGlzdGFuY2VUeXBl
IF9faGFsZiA9IF9fbGVuID4+IDE7CiAgIF9Gb3J3YXJkSXRlcmF0b3IgX19taWRkbGUgPSBfX2Zp
cnN0OwogICBzdGQ6OmFkdmFuY2UoX19taWRkbGUsIF9faGFsZik7CiAgIGlmIChfX2NvbXBfaXRf
dmFsKF9fbWlkZGxlLCBfX3ZhbCkpCiAgICAgewogICAgICAgX19maXJzdCA9IF9fbWlkZGxlOwog
ICAgICAgKytfX2ZpcnN0OwogICAgICAgX19sZW4gPSBfX2xlbiAtIF9faGFsZiAtIDE7CiAgICAg
fQogICBlbHNlIGlmIChfX2NvbXBfdmFsX2l0KF9fdmFsLCBfX21pZGRsZSkpCiAgICAgX19sZW4g
PSBfX2hhbGY7CiAgIGVsc2UKICAgICB7CiAgICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fbGVmdAog
ID0gc3RkOjpfX2xvd2VyX2JvdW5kKF9fZmlyc3QsIF9fbWlkZGxlLCBfX3ZhbCwgX19jb21wX2l0
X3ZhbCk7CiAgICAgICBzdGQ6OmFkdmFuY2UoX19maXJzdCwgX19sZW4pOwogICAgICAgX0Zvcndh
cmRJdGVyYXRvciBfX3JpZ2h0CiAgPSBzdGQ6Ol9fdXBwZXJfYm91bmQoKytfX21pZGRsZSwgX19m
aXJzdCwgX192YWwsIF9fY29tcF92YWxfaXQpOwogICAgICAgcmV0dXJuIHBhaXI8X0ZvcndhcmRJ
dGVyYXRvciwgX0ZvcndhcmRJdGVyYXRvcj4oX19sZWZ0LCBfX3JpZ2h0KTsKICAgICB9CiB9CiAg
ICAgIHJldHVybiBwYWlyPF9Gb3J3YXJkSXRlcmF0b3IsIF9Gb3J3YXJkSXRlcmF0b3I+KF9fZmly
c3QsIF9fZmlyc3QpOwogICAgfQojIDIxNzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9z
dGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5h
bWUgX1RwPgogICAgaW5saW5lIHBhaXI8X0ZvcndhcmRJdGVyYXRvciwgX0ZvcndhcmRJdGVyYXRv
cj4KICAgIGVxdWFsX3JhbmdlKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVy
YXRvciBfX2xhc3QsCiAgY29uc3QgX1RwJiBfX3ZhbCkKICAgIHsKCiAgICAgCiAgICAgCgogICAg
IAoKICAgICAgOwogICAgICA7CiAgICAgIDsKCiAgICAgIHJldHVybiBzdGQ6Ol9fZXF1YWxfcmFu
Z2UoX19maXJzdCwgX19sYXN0LCBfX3ZhbCwKICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9s
ZXNzX3ZhbCgpLAogICAgX19nbnVfY3h4OjpfX29wczo6X192YWxfbGVzc19pdGVyKCkpOwogICAg
fQojIDIyMTMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBf
Q29tcGFyZT4KICAgIGlubGluZSBwYWlyPF9Gb3J3YXJkSXRlcmF0b3IsIF9Gb3J3YXJkSXRlcmF0
b3I+CiAgICBlcXVhbF9yYW5nZShfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRl
cmF0b3IgX19sYXN0LAogIGNvbnN0IF9UcCYgX192YWwsIF9Db21wYXJlIF9fY29tcCkKICAgIHsK
CiAgICAgCiAgICAgCgogICAgIAoKICAgICAKICAgICAgICAgICAgICAgICAgICA7CiAgICAgCiAg
ICAgICAgICAgICAgICAgICAgOwogICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX2VxdWFsX3Jh
bmdlKF9fZmlyc3QsIF9fbGFzdCwgX192YWwsCiAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJf
Y29tcF92YWwoX19jb21wKSwKICAgIF9fZ251X2N4eDo6X19vcHM6Ol9fdmFsX2NvbXBfaXRlcihf
X2NvbXApKTsKICAgIH0KIyAyMjQ3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2Fs
Z28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9U
cD4KICAgIGJvb2wKICAgIGJpbmFyeV9zZWFyY2goX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBf
Rm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICAgIGNvbnN0IF9UcCYgX192YWwpCiAgICB7CgogICAg
IAogICAgIAoKICAgICAgOwogICAgICA7CiAgICAgIDsKCiAgICAgIF9Gb3J3YXJkSXRlcmF0b3Ig
X19pCiA9IHN0ZDo6X19sb3dlcl9ib3VuZChfX2ZpcnN0LCBfX2xhc3QsIF9fdmFsLAogICAgICAg
IF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNzX3ZhbCgpKTsKICAgICAgcmV0dXJuIF9faSAh
PSBfX2xhc3QgJiYgIShfX3ZhbCA8ICpfX2kpOwogICAgfQojIDIyODEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJ
dGVyYXRvciwgdHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIGJvb2wKICAgIGJp
bmFyeV9zZWFyY2goX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9f
bGFzdCwKICAgIGNvbnN0IF9UcCYgX192YWwsIF9Db21wYXJlIF9fY29tcCkKICAgIHsKCiAgICAg
CiAgICAgCgogICAgIAogICAgICAgICAgICAgICAgICAgIDsKICAgICAKICAgICAgICAgICAgICAg
ICAgICA7CiAgICAgIDsKCiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19pCiA9IHN0ZDo6X19sb3dl
cl9ib3VuZChfX2ZpcnN0LCBfX2xhc3QsIF9fdmFsLAogICAgICAgIF9fZ251X2N4eDo6X19vcHM6
Ol9faXRlcl9jb21wX3ZhbChfX2NvbXApKTsKICAgICAgcmV0dXJuIF9faSAhPSBfX2xhc3QgJiYg
IWJvb2woX19jb21wKF9fdmFsLCAqX19pKSk7CiAgICB9CgoKCgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9JbnB1dEl0ZXJhdG9yMSwgdHlwZW5hbWUgX0lucHV0SXRlcmF0b3IyLAogICAgdHlwZW5hbWUg
X091dHB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIHZvaWQKICAgIF9fbW92ZV9t
ZXJnZV9hZGFwdGl2ZShfSW5wdXRJdGVyYXRvcjEgX19maXJzdDEsIF9JbnB1dEl0ZXJhdG9yMSBf
X2xhc3QxLAogICAgIF9JbnB1dEl0ZXJhdG9yMiBfX2ZpcnN0MiwgX0lucHV0SXRlcmF0b3IyIF9f
bGFzdDIsCiAgICAgX091dHB1dEl0ZXJhdG9yIF9fcmVzdWx0LCBfQ29tcGFyZSBfX2NvbXApCiAg
ICB7CiAgICAgIHdoaWxlIChfX2ZpcnN0MSAhPSBfX2xhc3QxICYmIF9fZmlyc3QyICE9IF9fbGFz
dDIpCiB7CiAgIGlmIChfX2NvbXAoX19maXJzdDIsIF9fZmlyc3QxKSkKICAgICB7CiAgICAgICAq
X19yZXN1bHQgPSBzdGQ6Om1vdmUoKl9fZmlyc3QyKTsKICAgICAgICsrX19maXJzdDI7CiAgICAg
fQogICBlbHNlCiAgICAgewogICAgICAgKl9fcmVzdWx0ID0gc3RkOjptb3ZlKCpfX2ZpcnN0MSk7
CiAgICAgICArK19fZmlyc3QxOwogICAgIH0KICAgKytfX3Jlc3VsdDsKIH0KICAgICAgaWYgKF9f
Zmlyc3QxICE9IF9fbGFzdDEpCiBzdGQ6Om1vdmUoX19maXJzdDEsIF9fbGFzdDEsIF9fcmVzdWx0
KTsKICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IxLCB0
eXBlbmFtZSBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yMiwKICAgIHR5cGVuYW1lIF9CaWRpcmVjdGlv
bmFsSXRlcmF0b3IzLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIHZvaWQKICAgIF9fbW92ZV9tZXJn
ZV9hZGFwdGl2ZV9iYWNrd2FyZChfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yMSBfX2ZpcnN0MSwKICAg
ICAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IxIF9fbGFzdDEsCiAgICAgICBfQmlkaXJlY3Rpb25h
bEl0ZXJhdG9yMiBfX2ZpcnN0MiwKICAgICAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IyIF9fbGFz
dDIsCiAgICAgICBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yMyBfX3Jlc3VsdCwKICAgICAgIF9Db21w
YXJlIF9fY29tcCkKICAgIHsKICAgICAgaWYgKF9fZmlyc3QxID09IF9fbGFzdDEpCiB7CiAgIHN0
ZDo6bW92ZV9iYWNrd2FyZChfX2ZpcnN0MiwgX19sYXN0MiwgX19yZXN1bHQpOwogICByZXR1cm47
CiB9CiAgICAgIGVsc2UgaWYgKF9fZmlyc3QyID09IF9fbGFzdDIpCiByZXR1cm47CgogICAgICAt
LV9fbGFzdDE7CiAgICAgIC0tX19sYXN0MjsKICAgICAgd2hpbGUgKHRydWUpCiB7CiAgIGlmIChf
X2NvbXAoX19sYXN0MiwgX19sYXN0MSkpCiAgICAgewogICAgICAgKi0tX19yZXN1bHQgPSBzdGQ6
Om1vdmUoKl9fbGFzdDEpOwogICAgICAgaWYgKF9fZmlyc3QxID09IF9fbGFzdDEpCiAgewogICAg
c3RkOjptb3ZlX2JhY2t3YXJkKF9fZmlyc3QyLCArK19fbGFzdDIsIF9fcmVzdWx0KTsKICAgIHJl
dHVybjsKICB9CiAgICAgICAtLV9fbGFzdDE7CiAgICAgfQogICBlbHNlCiAgICAgewogICAgICAg
Ki0tX19yZXN1bHQgPSBzdGQ6Om1vdmUoKl9fbGFzdDIpOwogICAgICAgaWYgKF9fZmlyc3QyID09
IF9fbGFzdDIpCiAgcmV0dXJuOwogICAgICAgLS1fX2xhc3QyOwogICAgIH0KIH0KICAgIH0KCgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IxLCB0eXBlbmFtZSBfQmlk
aXJlY3Rpb25hbEl0ZXJhdG9yMiwKICAgIHR5cGVuYW1lIF9EaXN0YW5jZT4KICAgIF9CaWRpcmVj
dGlvbmFsSXRlcmF0b3IxCiAgICBfX3JvdGF0ZV9hZGFwdGl2ZShfQmlkaXJlY3Rpb25hbEl0ZXJh
dG9yMSBfX2ZpcnN0LAogICAgICAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IxIF9fbWlkZGxlLAog
ICAgICAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IxIF9fbGFzdCwKICAgICAgICBfRGlzdGFuY2Ug
X19sZW4xLCBfRGlzdGFuY2UgX19sZW4yLAogICAgICAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3Iy
IF9fYnVmZmVyLAogICAgICAgIF9EaXN0YW5jZSBfX2J1ZmZlcl9zaXplKQogICAgewogICAgICBf
QmlkaXJlY3Rpb25hbEl0ZXJhdG9yMiBfX2J1ZmZlcl9lbmQ7CiAgICAgIGlmIChfX2xlbjEgPiBf
X2xlbjIgJiYgX19sZW4yIDw9IF9fYnVmZmVyX3NpemUpCiB7CiAgIGlmIChfX2xlbjIpCiAgICAg
ewogICAgICAgX19idWZmZXJfZW5kID0gc3RkOjptb3ZlKF9fbWlkZGxlLCBfX2xhc3QsIF9fYnVm
ZmVyKTsKICAgICAgIHN0ZDo6bW92ZV9iYWNrd2FyZChfX2ZpcnN0LCBfX21pZGRsZSwgX19sYXN0
KTsKICAgICAgIHJldHVybiBzdGQ6Om1vdmUoX19idWZmZXIsIF9fYnVmZmVyX2VuZCwgX19maXJz
dCk7CiAgICAgfQogICBlbHNlCiAgICAgcmV0dXJuIF9fZmlyc3Q7CiB9CiAgICAgIGVsc2UgaWYg
KF9fbGVuMSA8PSBfX2J1ZmZlcl9zaXplKQogewogICBpZiAoX19sZW4xKQogICAgIHsKICAgICAg
IF9fYnVmZmVyX2VuZCA9IHN0ZDo6bW92ZShfX2ZpcnN0LCBfX21pZGRsZSwgX19idWZmZXIpOwog
ICAgICAgc3RkOjptb3ZlKF9fbWlkZGxlLCBfX2xhc3QsIF9fZmlyc3QpOwogICAgICAgcmV0dXJu
IHN0ZDo6bW92ZV9iYWNrd2FyZChfX2J1ZmZlciwgX19idWZmZXJfZW5kLCBfX2xhc3QpOwogICAg
IH0KICAgZWxzZQogICAgIHJldHVybiBfX2xhc3Q7CiB9CiAgICAgIGVsc2UKIHsKICAgc3RkOjpy
b3RhdGUoX19maXJzdCwgX19taWRkbGUsIF9fbGFzdCk7CiAgIHN0ZDo6YWR2YW5jZShfX2ZpcnN0
LCBzdGQ6OmRpc3RhbmNlKF9fbWlkZGxlLCBfX2xhc3QpKTsKICAgcmV0dXJuIF9fZmlyc3Q7CiB9
CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yLCB0eXBl
bmFtZSBfRGlzdGFuY2UsCiAgICB0eXBlbmFtZSBfUG9pbnRlciwgdHlwZW5hbWUgX0NvbXBhcmU+
CiAgICB2b2lkCiAgICBfX21lcmdlX2FkYXB0aXZlKF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IgX19m
aXJzdCwKICAgICAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IgX19taWRkbGUsCiAgICAgICBfQmlk
aXJlY3Rpb25hbEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgIF9EaXN0YW5jZSBfX2xlbjEsIF9EaXN0
YW5jZSBfX2xlbjIsCiAgICAgICBfUG9pbnRlciBfX2J1ZmZlciwgX0Rpc3RhbmNlIF9fYnVmZmVy
X3NpemUsCiAgICAgICBfQ29tcGFyZSBfX2NvbXApCiAgICB7CiAgICAgIGlmIChfX2xlbjEgPD0g
X19sZW4yICYmIF9fbGVuMSA8PSBfX2J1ZmZlcl9zaXplKQogewogICBfUG9pbnRlciBfX2J1ZmZl
cl9lbmQgPSBzdGQ6Om1vdmUoX19maXJzdCwgX19taWRkbGUsIF9fYnVmZmVyKTsKICAgc3RkOjpf
X21vdmVfbWVyZ2VfYWRhcHRpdmUoX19idWZmZXIsIF9fYnVmZmVyX2VuZCwgX19taWRkbGUsIF9f
bGFzdCwKICAgICAgICAgX19maXJzdCwgX19jb21wKTsKIH0KICAgICAgZWxzZSBpZiAoX19sZW4y
IDw9IF9fYnVmZmVyX3NpemUpCiB7CiAgIF9Qb2ludGVyIF9fYnVmZmVyX2VuZCA9IHN0ZDo6bW92
ZShfX21pZGRsZSwgX19sYXN0LCBfX2J1ZmZlcik7CiAgIHN0ZDo6X19tb3ZlX21lcmdlX2FkYXB0
aXZlX2JhY2t3YXJkKF9fZmlyc3QsIF9fbWlkZGxlLCBfX2J1ZmZlciwKICAgICAgICAgICBfX2J1
ZmZlcl9lbmQsIF9fbGFzdCwgX19jb21wKTsKIH0KICAgICAgZWxzZQogewogICBfQmlkaXJlY3Rp
b25hbEl0ZXJhdG9yIF9fZmlyc3RfY3V0ID0gX19maXJzdDsKICAgX0JpZGlyZWN0aW9uYWxJdGVy
YXRvciBfX3NlY29uZF9jdXQgPSBfX21pZGRsZTsKICAgX0Rpc3RhbmNlIF9fbGVuMTEgPSAwOwog
ICBfRGlzdGFuY2UgX19sZW4yMiA9IDA7CiAgIGlmIChfX2xlbjEgPiBfX2xlbjIpCiAgICAgewog
ICAgICAgX19sZW4xMSA9IF9fbGVuMSAvIDI7CiAgICAgICBzdGQ6OmFkdmFuY2UoX19maXJzdF9j
dXQsIF9fbGVuMTEpOwogICAgICAgX19zZWNvbmRfY3V0CiAgPSBzdGQ6Ol9fbG93ZXJfYm91bmQo
X19taWRkbGUsIF9fbGFzdCwgKl9fZmlyc3RfY3V0LAogICAgICAgICBfX2dudV9jeHg6Ol9fb3Bz
OjpfX2l0ZXJfY29tcF92YWwoX19jb21wKSk7CiAgICAgICBfX2xlbjIyID0gc3RkOjpkaXN0YW5j
ZShfX21pZGRsZSwgX19zZWNvbmRfY3V0KTsKICAgICB9CiAgIGVsc2UKICAgICB7CiAgICAgICBf
X2xlbjIyID0gX19sZW4yIC8gMjsKICAgICAgIHN0ZDo6YWR2YW5jZShfX3NlY29uZF9jdXQsIF9f
bGVuMjIpOwogICAgICAgX19maXJzdF9jdXQKICA9IHN0ZDo6X191cHBlcl9ib3VuZChfX2ZpcnN0
LCBfX21pZGRsZSwgKl9fc2Vjb25kX2N1dCwKICAgICAgICAgX19nbnVfY3h4OjpfX29wczo6X192
YWxfY29tcF9pdGVyKF9fY29tcCkpOwogICAgICAgX19sZW4xMSA9IHN0ZDo6ZGlzdGFuY2UoX19m
aXJzdCwgX19maXJzdF9jdXQpOwogICAgIH0KCiAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IgX19u
ZXdfbWlkZGxlCiAgICAgPSBzdGQ6Ol9fcm90YXRlX2FkYXB0aXZlKF9fZmlyc3RfY3V0LCBfX21p
ZGRsZSwgX19zZWNvbmRfY3V0LAogICAgICAgICBfX2xlbjEgLSBfX2xlbjExLCBfX2xlbjIyLCBf
X2J1ZmZlciwKICAgICAgICAgX19idWZmZXJfc2l6ZSk7CiAgIHN0ZDo6X19tZXJnZV9hZGFwdGl2
ZShfX2ZpcnN0LCBfX2ZpcnN0X2N1dCwgX19uZXdfbWlkZGxlLCBfX2xlbjExLAogICAgX19sZW4y
MiwgX19idWZmZXIsIF9fYnVmZmVyX3NpemUsIF9fY29tcCk7CiAgIHN0ZDo6X19tZXJnZV9hZGFw
dGl2ZShfX25ld19taWRkbGUsIF9fc2Vjb25kX2N1dCwgX19sYXN0LAogICAgX19sZW4xIC0gX19s
ZW4xMSwKICAgIF9fbGVuMiAtIF9fbGVuMjIsIF9fYnVmZmVyLAogICAgX19idWZmZXJfc2l6ZSwg
X19jb21wKTsKIH0KICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9CaWRpcmVjdGlvbmFsSXRl
cmF0b3IsIHR5cGVuYW1lIF9EaXN0YW5jZSwKICAgIHR5cGVuYW1lIF9Db21wYXJlPgogICAgdm9p
ZAogICAgX19tZXJnZV93aXRob3V0X2J1ZmZlcihfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yIF9fZmly
c3QsCiAgICAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IgX19taWRkbGUsCiAgICAgIF9CaWRpcmVj
dGlvbmFsSXRlcmF0b3IgX19sYXN0LAogICAgICBfRGlzdGFuY2UgX19sZW4xLCBfRGlzdGFuY2Ug
X19sZW4yLAogICAgICBfQ29tcGFyZSBfX2NvbXApCiAgICB7CiAgICAgIGlmIChfX2xlbjEgPT0g
MCB8fCBfX2xlbjIgPT0gMCkKIHJldHVybjsKCiAgICAgIGlmIChfX2xlbjEgKyBfX2xlbjIgPT0g
MikKIHsKICAgaWYgKF9fY29tcChfX21pZGRsZSwgX19maXJzdCkpCiAgICAgc3RkOjppdGVyX3N3
YXAoX19maXJzdCwgX19taWRkbGUpOwogICByZXR1cm47CiB9CgogICAgICBfQmlkaXJlY3Rpb25h
bEl0ZXJhdG9yIF9fZmlyc3RfY3V0ID0gX19maXJzdDsKICAgICAgX0JpZGlyZWN0aW9uYWxJdGVy
YXRvciBfX3NlY29uZF9jdXQgPSBfX21pZGRsZTsKICAgICAgX0Rpc3RhbmNlIF9fbGVuMTEgPSAw
OwogICAgICBfRGlzdGFuY2UgX19sZW4yMiA9IDA7CiAgICAgIGlmIChfX2xlbjEgPiBfX2xlbjIp
CiB7CiAgIF9fbGVuMTEgPSBfX2xlbjEgLyAyOwogICBzdGQ6OmFkdmFuY2UoX19maXJzdF9jdXQs
IF9fbGVuMTEpOwogICBfX3NlY29uZF9jdXQKICAgICA9IHN0ZDo6X19sb3dlcl9ib3VuZChfX21p
ZGRsZSwgX19sYXN0LCAqX19maXJzdF9jdXQsCiAgICAgX19nbnVfY3h4OjpfX29wczo6X19pdGVy
X2NvbXBfdmFsKF9fY29tcCkpOwogICBfX2xlbjIyID0gc3RkOjpkaXN0YW5jZShfX21pZGRsZSwg
X19zZWNvbmRfY3V0KTsKIH0KICAgICAgZWxzZQogewogICBfX2xlbjIyID0gX19sZW4yIC8gMjsK
ICAgc3RkOjphZHZhbmNlKF9fc2Vjb25kX2N1dCwgX19sZW4yMik7CiAgIF9fZmlyc3RfY3V0CiAg
ICAgPSBzdGQ6Ol9fdXBwZXJfYm91bmQoX19maXJzdCwgX19taWRkbGUsICpfX3NlY29uZF9jdXQs
CiAgICAgX19nbnVfY3h4OjpfX29wczo6X192YWxfY29tcF9pdGVyKF9fY29tcCkpOwogICBfX2xl
bjExID0gc3RkOjpkaXN0YW5jZShfX2ZpcnN0LCBfX2ZpcnN0X2N1dCk7CiB9CgogICAgICBzdGQ6
OnJvdGF0ZShfX2ZpcnN0X2N1dCwgX19taWRkbGUsIF9fc2Vjb25kX2N1dCk7CiAgICAgIF9CaWRp
cmVjdGlvbmFsSXRlcmF0b3IgX19uZXdfbWlkZGxlID0gX19maXJzdF9jdXQ7CiAgICAgIHN0ZDo6
YWR2YW5jZShfX25ld19taWRkbGUsIHN0ZDo6ZGlzdGFuY2UoX19taWRkbGUsIF9fc2Vjb25kX2N1
dCkpOwogICAgICBzdGQ6Ol9fbWVyZ2Vfd2l0aG91dF9idWZmZXIoX19maXJzdCwgX19maXJzdF9j
dXQsIF9fbmV3X21pZGRsZSwKICAgICAgX19sZW4xMSwgX19sZW4yMiwgX19jb21wKTsKICAgICAg
c3RkOjpfX21lcmdlX3dpdGhvdXRfYnVmZmVyKF9fbmV3X21pZGRsZSwgX19zZWNvbmRfY3V0LCBf
X2xhc3QsCiAgICAgIF9fbGVuMSAtIF9fbGVuMTEsIF9fbGVuMiAtIF9fbGVuMjIsIF9fY29tcCk7
CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IsIHR5cGVu
YW1lIF9Db21wYXJlPgogICAgdm9pZAogICAgX19pbnBsYWNlX21lcmdlKF9CaWRpcmVjdGlvbmFs
SXRlcmF0b3IgX19maXJzdCwKICAgICAgX0JpZGlyZWN0aW9uYWxJdGVyYXRvciBfX21pZGRsZSwK
ICAgICAgX0JpZGlyZWN0aW9uYWxJdGVyYXRvciBfX2xhc3QsCiAgICAgIF9Db21wYXJlIF9fY29t
cCkKICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0JpZGlyZWN0
aW9uYWxJdGVyYXRvcj46OnZhbHVlX3R5cGUKICAgX1ZhbHVlVHlwZTsKICAgICAgdHlwZWRlZiB0
eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0JpZGlyZWN0aW9uYWxJdGVyYXRvcj46OmRpZmZlcmVu
Y2VfdHlwZQogICBfRGlzdGFuY2VUeXBlOwoKICAgICAgaWYgKF9fZmlyc3QgPT0gX19taWRkbGUg
fHwgX19taWRkbGUgPT0gX19sYXN0KQogcmV0dXJuOwoKICAgICAgY29uc3QgX0Rpc3RhbmNlVHlw
ZSBfX2xlbjEgPSBzdGQ6OmRpc3RhbmNlKF9fZmlyc3QsIF9fbWlkZGxlKTsKICAgICAgY29uc3Qg
X0Rpc3RhbmNlVHlwZSBfX2xlbjIgPSBzdGQ6OmRpc3RhbmNlKF9fbWlkZGxlLCBfX2xhc3QpOwoK
ICAgICAgdHlwZWRlZiBfVGVtcG9yYXJ5X2J1ZmZlcjxfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yLCBf
VmFsdWVUeXBlPiBfVG1wQnVmOwogICAgICBfVG1wQnVmIF9fYnVmKF9fZmlyc3QsIF9fbGFzdCk7
CgogICAgICBpZiAoX19idWYuYmVnaW4oKSA9PSAwKQogc3RkOjpfX21lcmdlX3dpdGhvdXRfYnVm
ZmVyCiAgIChfX2ZpcnN0LCBfX21pZGRsZSwgX19sYXN0LCBfX2xlbjEsIF9fbGVuMiwgX19jb21w
KTsKICAgICAgZWxzZQogc3RkOjpfX21lcmdlX2FkYXB0aXZlCiAgIChfX2ZpcnN0LCBfX21pZGRs
ZSwgX19sYXN0LCBfX2xlbjEsIF9fbGVuMiwgX19idWYuYmVnaW4oKSwKICAgIF9EaXN0YW5jZVR5
cGUoX19idWYuc2l6ZSgpKSwgX19jb21wKTsKICAgIH0KIyAyNTc2ICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9CaWRpcmVjdGlv
bmFsSXRlcmF0b3I+CiAgICBpbmxpbmUgdm9pZAogICAgaW5wbGFjZV9tZXJnZShfQmlkaXJlY3Rp
b25hbEl0ZXJhdG9yIF9fZmlyc3QsCiAgICBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yIF9fbWlkZGxl
LAogICAgX0JpZGlyZWN0aW9uYWxJdGVyYXRvciBfX2xhc3QpCiAgICB7CgogICAgIAoKICAgICAK
CiAgICAgIDsKICAgICAgOwogICAgICA7CgogICAgICBzdGQ6Ol9faW5wbGFjZV9tZXJnZShfX2Zp
cnN0LCBfX21pZGRsZSwgX19sYXN0LAogICAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfbGVz
c19pdGVyKCkpOwogICAgfQojIDI2MTcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxf
YWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0JpZGlyZWN0aW9uYWxJdGVyYXRvciwgdHlw
ZW5hbWUgX0NvbXBhcmU+CiAgICBpbmxpbmUgdm9pZAogICAgaW5wbGFjZV9tZXJnZShfQmlkaXJl
Y3Rpb25hbEl0ZXJhdG9yIF9fZmlyc3QsCiAgICBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yIF9fbWlk
ZGxlLAogICAgX0JpZGlyZWN0aW9uYWxJdGVyYXRvciBfX2xhc3QsCiAgICBfQ29tcGFyZSBfX2Nv
bXApCiAgICB7CgogICAgIAoKICAgICAKCgogICAgICA7CiAgICAgIDsKICAgICAgOwoKICAgICAg
c3RkOjpfX2lucGxhY2VfbWVyZ2UoX19maXJzdCwgX19taWRkbGUsIF9fbGFzdCwKICAgICAgX19n
bnVfY3h4OjpfX29wczo6X19pdGVyX2NvbXBfaXRlcihfX2NvbXApKTsKICAgIH0KCgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvciwgdHlwZW5hbWUgX091dHB1dEl0ZXJhdG9yLAog
ICAgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBfT3V0cHV0SXRlcmF0b3IKICAgIF9fbW92ZV9tZXJn
ZShfSW5wdXRJdGVyYXRvciBfX2ZpcnN0MSwgX0lucHV0SXRlcmF0b3IgX19sYXN0MSwKICAgX0lu
cHV0SXRlcmF0b3IgX19maXJzdDIsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdDIsCiAgIF9PdXRwdXRJ
dGVyYXRvciBfX3Jlc3VsdCwgX0NvbXBhcmUgX19jb21wKQogICAgewogICAgICB3aGlsZSAoX19m
aXJzdDEgIT0gX19sYXN0MSAmJiBfX2ZpcnN0MiAhPSBfX2xhc3QyKQogewogICBpZiAoX19jb21w
KF9fZmlyc3QyLCBfX2ZpcnN0MSkpCiAgICAgewogICAgICAgKl9fcmVzdWx0ID0gc3RkOjptb3Zl
KCpfX2ZpcnN0Mik7CiAgICAgICArK19fZmlyc3QyOwogICAgIH0KICAgZWxzZQogICAgIHsKICAg
ICAgICpfX3Jlc3VsdCA9IHN0ZDo6bW92ZSgqX19maXJzdDEpOwogICAgICAgKytfX2ZpcnN0MTsK
ICAgICB9CiAgICsrX19yZXN1bHQ7CiB9CiAgICAgIHJldHVybiBzdGQ6Om1vdmUoX19maXJzdDIs
IF9fbGFzdDIsIHN0ZDo6bW92ZShfX2ZpcnN0MSwgX19sYXN0MSwgX19yZXN1bHQpKQoKICAgICAg
ICAgICAgICAgICAgOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRl
cmF0b3IxLCB0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IyLAogICAgdHlwZW5hbWUgX0Rp
c3RhbmNlLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIHZvaWQKICAgIF9fbWVyZ2Vfc29ydF9sb29w
KF9SYW5kb21BY2Nlc3NJdGVyYXRvcjEgX19maXJzdCwKICAgICAgICBfUmFuZG9tQWNjZXNzSXRl
cmF0b3IxIF9fbGFzdCwKICAgICAgICBfUmFuZG9tQWNjZXNzSXRlcmF0b3IyIF9fcmVzdWx0LCBf
RGlzdGFuY2UgX19zdGVwX3NpemUsCiAgICAgICAgX0NvbXBhcmUgX19jb21wKQogICAgewogICAg
ICBjb25zdCBfRGlzdGFuY2UgX190d29fc3RlcCA9IDIgKiBfX3N0ZXBfc2l6ZTsKCiAgICAgIHdo
aWxlIChfX2xhc3QgLSBfX2ZpcnN0ID49IF9fdHdvX3N0ZXApCiB7CiAgIF9fcmVzdWx0ID0gc3Rk
OjpfX21vdmVfbWVyZ2UoX19maXJzdCwgX19maXJzdCArIF9fc3RlcF9zaXplLAogICAgICAgICAg
IF9fZmlyc3QgKyBfX3N0ZXBfc2l6ZSwKICAgICAgICAgICBfX2ZpcnN0ICsgX190d29fc3RlcCwK
ICAgICAgICAgICBfX3Jlc3VsdCwgX19jb21wKTsKICAgX19maXJzdCArPSBfX3R3b19zdGVwOwog
fQogICAgICBfX3N0ZXBfc2l6ZSA9IHN0ZDo6bWluKF9EaXN0YW5jZShfX2xhc3QgLSBfX2ZpcnN0
KSwgX19zdGVwX3NpemUpOwoKICAgICAgc3RkOjpfX21vdmVfbWVyZ2UoX19maXJzdCwgX19maXJz
dCArIF9fc3RlcF9zaXplLAogICBfX2ZpcnN0ICsgX19zdGVwX3NpemUsIF9fbGFzdCwgX19yZXN1
bHQsIF9fY29tcCk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVy
YXRvciwgdHlwZW5hbWUgX0Rpc3RhbmNlLAogICAgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICB2b2lk
CiAgICBfX2NodW5rX2luc2VydGlvbl9zb3J0KF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0
LAogICAgICBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0LAogICAgICBfRGlzdGFuY2UgX19j
aHVua19zaXplLCBfQ29tcGFyZSBfX2NvbXApCiAgICB7CiAgICAgIHdoaWxlIChfX2xhc3QgLSBf
X2ZpcnN0ID49IF9fY2h1bmtfc2l6ZSkKIHsKICAgc3RkOjpfX2luc2VydGlvbl9zb3J0KF9fZmly
c3QsIF9fZmlyc3QgKyBfX2NodW5rX3NpemUsIF9fY29tcCk7CiAgIF9fZmlyc3QgKz0gX19jaHVu
a19zaXplOwogfQogICAgICBzdGQ6Ol9faW5zZXJ0aW9uX3NvcnQoX19maXJzdCwgX19sYXN0LCBf
X2NvbXApOwogICAgfQoKICBlbnVtIHsgX1NfY2h1bmtfc2l6ZSA9IDcgfTsKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBfUG9pbnRlciwgdHlwZW5h
bWUgX0NvbXBhcmU+CiAgICB2b2lkCiAgICBfX21lcmdlX3NvcnRfd2l0aF9idWZmZXIoX1JhbmRv
bUFjY2Vzc0l0ZXJhdG9yIF9fZmlyc3QsCiAgICAgICAgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9f
bGFzdCwKICAgICAgICBfUG9pbnRlciBfX2J1ZmZlciwgX0NvbXBhcmUgX19jb21wKQogICAgewog
ICAgICB0eXBlZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfUmFuZG9tQWNjZXNzSXRlcmF0
b3I+OjpkaWZmZXJlbmNlX3R5cGUKIF9EaXN0YW5jZTsKCiAgICAgIGNvbnN0IF9EaXN0YW5jZSBf
X2xlbiA9IF9fbGFzdCAtIF9fZmlyc3Q7CiAgICAgIGNvbnN0IF9Qb2ludGVyIF9fYnVmZmVyX2xh
c3QgPSBfX2J1ZmZlciArIF9fbGVuOwoKICAgICAgX0Rpc3RhbmNlIF9fc3RlcF9zaXplID0gX1Nf
Y2h1bmtfc2l6ZTsKICAgICAgc3RkOjpfX2NodW5rX2luc2VydGlvbl9zb3J0KF9fZmlyc3QsIF9f
bGFzdCwgX19zdGVwX3NpemUsIF9fY29tcCk7CgogICAgICB3aGlsZSAoX19zdGVwX3NpemUgPCBf
X2xlbikKIHsKICAgc3RkOjpfX21lcmdlX3NvcnRfbG9vcChfX2ZpcnN0LCBfX2xhc3QsIF9fYnVm
ZmVyLAogICAgIF9fc3RlcF9zaXplLCBfX2NvbXApOwogICBfX3N0ZXBfc2l6ZSAqPSAyOwogICBz
dGQ6Ol9fbWVyZ2Vfc29ydF9sb29wKF9fYnVmZmVyLCBfX2J1ZmZlcl9sYXN0LCBfX2ZpcnN0LAog
ICAgIF9fc3RlcF9zaXplLCBfX2NvbXApOwogICBfX3N0ZXBfc2l6ZSAqPSAyOwogfQogICAgfQoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9Qb2lu
dGVyLAogICAgdHlwZW5hbWUgX0Rpc3RhbmNlLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIHZvaWQK
ICAgIF9fc3RhYmxlX3NvcnRfYWRhcHRpdmUoX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fZmlyc3Qs
CiAgICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QsCiAgICAgIF9Qb2ludGVyIF9fYnVm
ZmVyLCBfRGlzdGFuY2UgX19idWZmZXJfc2l6ZSwKICAgICAgX0NvbXBhcmUgX19jb21wKQogICAg
ewogICAgICBjb25zdCBfRGlzdGFuY2UgX19sZW4gPSAoX19sYXN0IC0gX19maXJzdCArIDEpIC8g
MjsKICAgICAgY29uc3QgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fbWlkZGxlID0gX19maXJzdCAr
IF9fbGVuOwogICAgICBpZiAoX19sZW4gPiBfX2J1ZmZlcl9zaXplKQogewogICBzdGQ6Ol9fc3Rh
YmxlX3NvcnRfYWRhcHRpdmUoX19maXJzdCwgX19taWRkbGUsIF9fYnVmZmVyLAogICAgICAgICAg
X19idWZmZXJfc2l6ZSwgX19jb21wKTsKICAgc3RkOjpfX3N0YWJsZV9zb3J0X2FkYXB0aXZlKF9f
bWlkZGxlLCBfX2xhc3QsIF9fYnVmZmVyLAogICAgICAgICAgX19idWZmZXJfc2l6ZSwgX19jb21w
KTsKIH0KICAgICAgZWxzZQogewogICBzdGQ6Ol9fbWVyZ2Vfc29ydF93aXRoX2J1ZmZlcihfX2Zp
cnN0LCBfX21pZGRsZSwgX19idWZmZXIsIF9fY29tcCk7CiAgIHN0ZDo6X19tZXJnZV9zb3J0X3dp
dGhfYnVmZmVyKF9fbWlkZGxlLCBfX2xhc3QsIF9fYnVmZmVyLCBfX2NvbXApOwogfQogICAgICBz
dGQ6Ol9fbWVyZ2VfYWRhcHRpdmUoX19maXJzdCwgX19taWRkbGUsIF9fbGFzdCwKICAgICAgIF9E
aXN0YW5jZShfX21pZGRsZSAtIF9fZmlyc3QpLAogICAgICAgX0Rpc3RhbmNlKF9fbGFzdCAtIF9f
bWlkZGxlKSwKICAgICAgIF9fYnVmZmVyLCBfX2J1ZmZlcl9zaXplLAogICAgICAgX19jb21wKTsK
ICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVyYXRvciwgdHlwZW5h
bWUgX0NvbXBhcmU+CiAgICB2b2lkCiAgICBfX2lucGxhY2Vfc3RhYmxlX3NvcnQoX1JhbmRvbUFj
Y2Vzc0l0ZXJhdG9yIF9fZmlyc3QsCiAgICAgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fbGFzdCwg
X0NvbXBhcmUgX19jb21wKQogICAgewogICAgICBpZiAoX19sYXN0IC0gX19maXJzdCA8IDE1KQog
ewogICBzdGQ6Ol9faW5zZXJ0aW9uX3NvcnQoX19maXJzdCwgX19sYXN0LCBfX2NvbXApOwogICBy
ZXR1cm47CiB9CiAgICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX21pZGRsZSA9IF9fZmlyc3Qg
KyAoX19sYXN0IC0gX19maXJzdCkgLyAyOwogICAgICBzdGQ6Ol9faW5wbGFjZV9zdGFibGVfc29y
dChfX2ZpcnN0LCBfX21pZGRsZSwgX19jb21wKTsKICAgICAgc3RkOjpfX2lucGxhY2Vfc3RhYmxl
X3NvcnQoX19taWRkbGUsIF9fbGFzdCwgX19jb21wKTsKICAgICAgc3RkOjpfX21lcmdlX3dpdGhv
dXRfYnVmZmVyKF9fZmlyc3QsIF9fbWlkZGxlLCBfX2xhc3QsCiAgICAgIF9fbWlkZGxlIC0gX19m
aXJzdCwKICAgICAgX19sYXN0IC0gX19taWRkbGUsCiAgICAgIF9fY29tcCk7CiAgICB9CiMgMjc4
OSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfSW5wdXRJdGVyYXRvcjEsIHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yMiwKICAgIHR5
cGVuYW1lIF9Db21wYXJlPgogICAgYm9vbAogICAgX19pbmNsdWRlcyhfSW5wdXRJdGVyYXRvcjEg
X19maXJzdDEsIF9JbnB1dEl0ZXJhdG9yMSBfX2xhc3QxLAogICAgICAgIF9JbnB1dEl0ZXJhdG9y
MiBfX2ZpcnN0MiwgX0lucHV0SXRlcmF0b3IyIF9fbGFzdDIsCiAgICAgICAgX0NvbXBhcmUgX19j
b21wKQogICAgewogICAgICB3aGlsZSAoX19maXJzdDEgIT0gX19sYXN0MSAmJiBfX2ZpcnN0MiAh
PSBfX2xhc3QyKQogaWYgKF9fY29tcChfX2ZpcnN0MiwgX19maXJzdDEpKQogICByZXR1cm4gZmFs
c2U7CiBlbHNlIGlmIChfX2NvbXAoX19maXJzdDEsIF9fZmlyc3QyKSkKICAgKytfX2ZpcnN0MTsK
IGVsc2UKICAgewogICAgICsrX19maXJzdDE7CiAgICAgKytfX2ZpcnN0MjsKICAgfQoKICAgICAg
cmV0dXJuIF9fZmlyc3QyID09IF9fbGFzdDI7CiAgICB9CiMgMjgyOCAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVy
YXRvcjEsIHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yMj4KICAgIGlubGluZSBib29sCiAgICBpbmNs
dWRlcyhfSW5wdXRJdGVyYXRvcjEgX19maXJzdDEsIF9JbnB1dEl0ZXJhdG9yMSBfX2xhc3QxLAog
ICAgICBfSW5wdXRJdGVyYXRvcjIgX19maXJzdDIsIF9JbnB1dEl0ZXJhdG9yMiBfX2xhc3QyKQog
ICAgewoKICAgICAKICAgICAKICAgICAKCgogICAgIAoKCiAgICAgIDsKICAgICAgOwogICAgICA7
CiAgICAgIDsKCiAgICAgIHJldHVybiBzdGQ6Ol9faW5jbHVkZXMoX19maXJzdDEsIF9fbGFzdDEs
IF9fZmlyc3QyLCBfX2xhc3QyLAogICAgICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNz
X2l0ZXIoKSk7CiAgICB9CiMgMjg3MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9h
bGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcjEsIHR5cGVuYW1lIF9J
bnB1dEl0ZXJhdG9yMiwKICAgIHR5cGVuYW1lIF9Db21wYXJlPgogICAgaW5saW5lIGJvb2wKICAg
IGluY2x1ZGVzKF9JbnB1dEl0ZXJhdG9yMSBfX2ZpcnN0MSwgX0lucHV0SXRlcmF0b3IxIF9fbGFz
dDEsCiAgICAgIF9JbnB1dEl0ZXJhdG9yMiBfX2ZpcnN0MiwgX0lucHV0SXRlcmF0b3IyIF9fbGFz
dDIsCiAgICAgIF9Db21wYXJlIF9fY29tcCkKICAgIHsKCiAgICAgCiAgICAgCiAgICAgCgoKICAg
ICAKCgogICAgICA7CiAgICAgIDsKICAgICAgOwogICAgICA7CgogICAgICByZXR1cm4gc3RkOjpf
X2luY2x1ZGVzKF9fZmlyc3QxLCBfX2xhc3QxLCBfX2ZpcnN0MiwgX19sYXN0MiwKICAgICAgICBf
X2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfY29tcF9pdGVyKF9fY29tcCkpOwogICAgfQojIDI5MDcg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0JpZGlyZWN0aW9uYWxJdGVyYXRvciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBib29s
CiAgICBfX25leHRfcGVybXV0YXRpb24oX0JpZGlyZWN0aW9uYWxJdGVyYXRvciBfX2ZpcnN0LAog
ICAgICAgICBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yIF9fbGFzdCwgX0NvbXBhcmUgX19jb21wKQog
ICAgewogICAgICBpZiAoX19maXJzdCA9PSBfX2xhc3QpCiByZXR1cm4gZmFsc2U7CiAgICAgIF9C
aWRpcmVjdGlvbmFsSXRlcmF0b3IgX19pID0gX19maXJzdDsKICAgICAgKytfX2k7CiAgICAgIGlm
IChfX2kgPT0gX19sYXN0KQogcmV0dXJuIGZhbHNlOwogICAgICBfX2kgPSBfX2xhc3Q7CiAgICAg
IC0tX19pOwoKICAgICAgZm9yKDs7KQogewogICBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yIF9faWkg
PSBfX2k7CiAgIC0tX19pOwogICBpZiAoX19jb21wKF9faSwgX19paSkpCiAgICAgewogICAgICAg
X0JpZGlyZWN0aW9uYWxJdGVyYXRvciBfX2ogPSBfX2xhc3Q7CiAgICAgICB3aGlsZSAoIV9fY29t
cChfX2ksIC0tX19qKSkKICB7fQogICAgICAgc3RkOjppdGVyX3N3YXAoX19pLCBfX2opOwogICAg
ICAgc3RkOjpfX3JldmVyc2UoX19paSwgX19sYXN0LAogICAgICAgIHN0ZDo6X19pdGVyYXRvcl9j
YXRlZ29yeShfX2ZpcnN0KSk7CiAgICAgICByZXR1cm4gdHJ1ZTsKICAgICB9CiAgIGlmIChfX2kg
PT0gX19maXJzdCkKICAgICB7CiAgICAgICBzdGQ6Ol9fcmV2ZXJzZShfX2ZpcnN0LCBfX2xhc3Qs
CiAgICAgICAgc3RkOjpfX2l0ZXJhdG9yX2NhdGVnb3J5KF9fZmlyc3QpKTsKICAgICAgIHJldHVy
biBmYWxzZTsKICAgICB9CiB9CiAgICB9CiMgMjk1NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQmlkaXJlY3Rpb25hbEl0ZXJh
dG9yPgogICAgaW5saW5lIGJvb2wKICAgIG5leHRfcGVybXV0YXRpb24oX0JpZGlyZWN0aW9uYWxJ
dGVyYXRvciBfX2ZpcnN0LAogICAgICAgX0JpZGlyZWN0aW9uYWxJdGVyYXRvciBfX2xhc3QpCiAg
ICB7CgogICAgIAoKICAgICAKCiAgICAgIDsKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19u
ZXh0X3Blcm11dGF0aW9uCiAoX19maXJzdCwgX19sYXN0LCBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0
ZXJfbGVzc19pdGVyKCkpOwogICAgfQojIDI5ODggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0JpZGlyZWN0aW9uYWxJdGVyYXRv
ciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBpbmxpbmUgYm9vbAogICAgbmV4dF9wZXJtdXRhdGlv
bihfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yIF9fZmlyc3QsCiAgICAgICBfQmlkaXJlY3Rpb25hbEl0
ZXJhdG9yIF9fbGFzdCwgX0NvbXBhcmUgX19jb21wKQogICAgewoKICAgICAKCiAgICAgCgoKICAg
ICAgOwogICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX25leHRfcGVybXV0YXRpb24KIChfX2Zp
cnN0LCBfX2xhc3QsIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9jb21wX2l0ZXIoX19jb21wKSk7
CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IsIHR5cGVu
YW1lIF9Db21wYXJlPgogICAgYm9vbAogICAgX19wcmV2X3Blcm11dGF0aW9uKF9CaWRpcmVjdGlv
bmFsSXRlcmF0b3IgX19maXJzdCwKICAgICAgICAgX0JpZGlyZWN0aW9uYWxJdGVyYXRvciBfX2xh
c3QsIF9Db21wYXJlIF9fY29tcCkKICAgIHsKICAgICAgaWYgKF9fZmlyc3QgPT0gX19sYXN0KQog
cmV0dXJuIGZhbHNlOwogICAgICBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yIF9faSA9IF9fZmlyc3Q7
CiAgICAgICsrX19pOwogICAgICBpZiAoX19pID09IF9fbGFzdCkKIHJldHVybiBmYWxzZTsKICAg
ICAgX19pID0gX19sYXN0OwogICAgICAtLV9faTsKCiAgICAgIGZvcig7OykKIHsKICAgX0JpZGly
ZWN0aW9uYWxJdGVyYXRvciBfX2lpID0gX19pOwogICAtLV9faTsKICAgaWYgKF9fY29tcChfX2lp
LCBfX2kpKQogICAgIHsKICAgICAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IgX19qID0gX19sYXN0
OwogICAgICAgd2hpbGUgKCFfX2NvbXAoLS1fX2osIF9faSkpCiAge30KICAgICAgIHN0ZDo6aXRl
cl9zd2FwKF9faSwgX19qKTsKICAgICAgIHN0ZDo6X19yZXZlcnNlKF9faWksIF9fbGFzdCwKICAg
ICAgICBzdGQ6Ol9faXRlcmF0b3JfY2F0ZWdvcnkoX19maXJzdCkpOwogICAgICAgcmV0dXJuIHRy
dWU7CiAgICAgfQogICBpZiAoX19pID09IF9fZmlyc3QpCiAgICAgewogICAgICAgc3RkOjpfX3Jl
dmVyc2UoX19maXJzdCwgX19sYXN0LAogICAgICAgIHN0ZDo6X19pdGVyYXRvcl9jYXRlZ29yeShf
X2ZpcnN0KSk7CiAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgfQogfQogICAgfQojIDMwNTYgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0JpZGlyZWN0aW9uYWxJdGVyYXRvcj4KICAgIGlubGluZSBib29sCiAgICBwcmV2X3Blcm11
dGF0aW9uKF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IgX19maXJzdCwKICAgICAgIF9CaWRpcmVjdGlv
bmFsSXRlcmF0b3IgX19sYXN0KQogICAgewoKICAgICAKCiAgICAgCgogICAgICA7CiAgICAgIDsK
CiAgICAgIHJldHVybiBzdGQ6Ol9fcHJldl9wZXJtdXRhdGlvbihfX2ZpcnN0LCBfX2xhc3QsCiAg
ICAgICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNzX2l0ZXIoKSk7CiAgICB9CiMgMzA4
OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfQmlkaXJlY3Rpb25hbEl0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIGlu
bGluZSBib29sCiAgICBwcmV2X3Blcm11dGF0aW9uKF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IgX19m
aXJzdCwKICAgICAgIF9CaWRpcmVjdGlvbmFsSXRlcmF0b3IgX19sYXN0LCBfQ29tcGFyZSBfX2Nv
bXApCiAgICB7CgogICAgIAoKICAgICAKCgogICAgICA7CiAgICAgIDsKCiAgICAgIHJldHVybiBz
dGQ6Ol9fcHJldl9wZXJtdXRhdGlvbihfX2ZpcnN0LCBfX2xhc3QsCiAgICBfX2dudV9jeHg6Ol9f
b3BzOjpfX2l0ZXJfY29tcF9pdGVyKF9fY29tcCkpOwogICAgfQoKCgoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfSW5wdXRJdGVyYXRvciwgdHlwZW5hbWUgX091dHB1dEl0ZXJhdG9yLAogICAgdHlwZW5h
bWUgX1ByZWRpY2F0ZSwgdHlwZW5hbWUgX1RwPgogICAgX091dHB1dEl0ZXJhdG9yCiAgICBfX3Jl
cGxhY2VfY29weV9pZihfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xh
c3QsCiAgICAgICAgX091dHB1dEl0ZXJhdG9yIF9fcmVzdWx0LAogICAgICAgIF9QcmVkaWNhdGUg
X19wcmVkLCBjb25zdCBfVHAmIF9fbmV3X3ZhbHVlKQogICAgewogICAgICBmb3IgKDsgX19maXJz
dCAhPSBfX2xhc3Q7ICsrX19maXJzdCwgKHZvaWQpKytfX3Jlc3VsdCkKIGlmIChfX3ByZWQoX19m
aXJzdCkpCiAgICpfX3Jlc3VsdCA9IF9fbmV3X3ZhbHVlOwogZWxzZQogICAqX19yZXN1bHQgPSAq
X19maXJzdDsKICAgICAgcmV0dXJuIF9fcmVzdWx0OwogICAgfQojIDMxMzggIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0
SXRlcmF0b3IsIHR5cGVuYW1lIF9PdXRwdXRJdGVyYXRvciwgdHlwZW5hbWUgX1RwPgogICAgaW5s
aW5lIF9PdXRwdXRJdGVyYXRvcgogICAgcmVwbGFjZV9jb3B5KF9JbnB1dEl0ZXJhdG9yIF9fZmly
c3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgX091dHB1dEl0ZXJhdG9yIF9fcmVzdWx0LAog
ICBjb25zdCBfVHAmIF9fb2xkX3ZhbHVlLCBjb25zdCBfVHAmIF9fbmV3X3ZhbHVlKQogICAgewoK
ICAgICAKICAgICAKCiAgICAgCgogICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX3JlcGxhY2Vf
Y29weV9pZihfX2ZpcnN0LCBfX2xhc3QsIF9fcmVzdWx0LAogICBfX2dudV9jeHg6Ol9fb3BzOjpf
X2l0ZXJfZXF1YWxzX3ZhbChfX29sZF92YWx1ZSksCiAgICAgICAgICAgX19uZXdfdmFsdWUpOwog
ICAgfQojIDMxNzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9PdXRwdXRJdGVyYXRv
ciwKICAgIHR5cGVuYW1lIF9QcmVkaWNhdGUsIHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBfT3V0
cHV0SXRlcmF0b3IKICAgIHJlcGxhY2VfY29weV9pZihfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBf
SW5wdXRJdGVyYXRvciBfX2xhc3QsCiAgICAgIF9PdXRwdXRJdGVyYXRvciBfX3Jlc3VsdCwKICAg
ICAgX1ByZWRpY2F0ZSBfX3ByZWQsIGNvbnN0IF9UcCYgX19uZXdfdmFsdWUpCiAgICB7CgogICAg
IAogICAgIAoKICAgICAKCiAgICAgIDsKCiAgICAgIHJldHVybiBzdGQ6Ol9fcmVwbGFjZV9jb3B5
X2lmKF9fZmlyc3QsIF9fbGFzdCwgX19yZXN1bHQsCiAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX3By
ZWRfaXRlcihfX3ByZWQpLAogICAgICAgICAgIF9fbmV3X3ZhbHVlKTsKICAgIH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9QcmVkaWNhdGU+CiAgICB0eXBl
bmFtZSBpdGVyYXRvcl90cmFpdHM8X0lucHV0SXRlcmF0b3I+OjpkaWZmZXJlbmNlX3R5cGUKICAg
IF9fY291bnRfaWYoX0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0
LCBfUHJlZGljYXRlIF9fcHJlZCkKICAgIHsKICAgICAgdHlwZW5hbWUgaXRlcmF0b3JfdHJhaXRz
PF9JbnB1dEl0ZXJhdG9yPjo6ZGlmZmVyZW5jZV90eXBlIF9fbiA9IDA7CiAgICAgIGZvciAoOyBf
X2ZpcnN0ICE9IF9fbGFzdDsgKytfX2ZpcnN0KQogaWYgKF9fcHJlZChfX2ZpcnN0KSkKICAgKytf
X247CiAgICAgIHJldHVybiBfX247CiAgICB9CiMgMzIxMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9y
PgogICAgaW5saW5lIGJvb2wKICAgIGlzX3NvcnRlZChfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3Qs
IF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0KQogICAgeyByZXR1cm4gc3RkOjppc19zb3J0ZWRfdW50
aWwoX19maXJzdCwgX19sYXN0KSA9PSBfX2xhc3Q7IH0KIyAzMjI1ICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRl
cmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgaW5saW5lIGJvb2wKICAgIGlzX3NvcnRlZChf
Rm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0LAogICAgICAg
X0NvbXBhcmUgX19jb21wKQogICAgeyByZXR1cm4gc3RkOjppc19zb3J0ZWRfdW50aWwoX19maXJz
dCwgX19sYXN0LCBfX2NvbXApID09IF9fbGFzdDsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9y
d2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIF9Gb3J3YXJkSXRlcmF0b3IKICAg
IF9faXNfc29ydGVkX3VudGlsKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVy
YXRvciBfX2xhc3QsCiAgICAgICAgX0NvbXBhcmUgX19jb21wKQogICAgewogICAgICBpZiAoX19m
aXJzdCA9PSBfX2xhc3QpCiByZXR1cm4gX19sYXN0OwoKICAgICAgX0ZvcndhcmRJdGVyYXRvciBf
X25leHQgPSBfX2ZpcnN0OwogICAgICBmb3IgKCsrX19uZXh0OyBfX25leHQgIT0gX19sYXN0OyBf
X2ZpcnN0ID0gX19uZXh0LCAodm9pZCkrK19fbmV4dCkKIGlmIChfX2NvbXAoX19uZXh0LCBfX2Zp
cnN0KSkKICAgcmV0dXJuIF9fbmV4dDsKICAgICAgcmV0dXJuIF9fbmV4dDsKICAgIH0KIyAzMjU0
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5
cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3I+CiAgICBpbmxpbmUgX0ZvcndhcmRJdGVyYXRvcgogICAg
aXNfc29ydGVkX3VudGlsKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRv
ciBfX2xhc3QpCiAgICB7CgogICAgIAogICAgIAoKICAgICAgOwogICAgICA7CgogICAgICByZXR1
cm4gc3RkOjpfX2lzX3NvcnRlZF91bnRpbChfX2ZpcnN0LCBfX2xhc3QsCiAgICAgICAgX19nbnVf
Y3h4OjpfX29wczo6X19pdGVyX2xlc3NfaXRlcigpKTsKICAgIH0KIyAzMjc4ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3
YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgaW5saW5lIF9Gb3J3YXJkSXRlcmF0
b3IKICAgIGlzX3NvcnRlZF91bnRpbChfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJk
SXRlcmF0b3IgX19sYXN0LAogICAgICBfQ29tcGFyZSBfX2NvbXApCiAgICB7CgogICAgIAogICAg
IAoKCiAgICAgIDsKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19pc19zb3J0ZWRfdW50aWwo
X19maXJzdCwgX19sYXN0LAogICAgICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9jb21wX2l0
ZXIoX19jb21wKSk7CiAgICB9CiMgMzMwMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0
bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgIAogICAgaW5saW5lIHBhaXI8
Y29uc3QgX1RwJiwgY29uc3QgX1RwJj4KICAgIG1pbm1heChjb25zdCBfVHAmIF9fYSwgY29uc3Qg
X1RwJiBfX2IpCiAgICB7CgogICAgIAoKICAgICAgcmV0dXJuIF9fYiA8IF9fYSA/IHBhaXI8Y29u
c3QgX1RwJiwgY29uc3QgX1RwJj4oX19iLCBfX2EpCiAgICAgICAgIDogcGFpcjxjb25zdCBfVHAm
LCBjb25zdCBfVHAmPihfX2EsIF9fYik7CiAgICB9CiMgMzMyNCAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1l
IF9Db21wYXJlPgogICAKICAgIGlubGluZSBwYWlyPGNvbnN0IF9UcCYsIGNvbnN0IF9UcCY+CiAg
ICBtaW5tYXgoY29uc3QgX1RwJiBfX2EsIGNvbnN0IF9UcCYgX19iLCBfQ29tcGFyZSBfX2NvbXAp
CiAgICB7CiAgICAgIHJldHVybiBfX2NvbXAoX19iLCBfX2EpID8gcGFpcjxjb25zdCBfVHAmLCBj
b25zdCBfVHAmPihfX2IsIF9fYSkKICAgICAgICAgOiBwYWlyPGNvbnN0IF9UcCYsIGNvbnN0IF9U
cCY+KF9fYSwgX19iKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRv
ciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgIAogICAgcGFpcjxfRm9yd2FyZEl0ZXJhdG9yLCBfRm9y
d2FyZEl0ZXJhdG9yPgogICAgX19taW5tYXhfZWxlbWVudChfRm9yd2FyZEl0ZXJhdG9yIF9fZmly
c3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0LAogICAgICAgX0NvbXBhcmUgX19jb21wKQogICAg
ewogICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fbmV4dCA9IF9fZmlyc3Q7CiAgICAgIGlmIChfX2Zp
cnN0ID09IF9fbGFzdAogICB8fCArK19fbmV4dCA9PSBfX2xhc3QpCiByZXR1cm4gc3RkOjptYWtl
X3BhaXIoX19maXJzdCwgX19maXJzdCk7CgogICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fbWlue30s
IF9fbWF4e307CiAgICAgIGlmIChfX2NvbXAoX19uZXh0LCBfX2ZpcnN0KSkKIHsKICAgX19taW4g
PSBfX25leHQ7CiAgIF9fbWF4ID0gX19maXJzdDsKIH0KICAgICAgZWxzZQogewogICBfX21pbiA9
IF9fZmlyc3Q7CiAgIF9fbWF4ID0gX19uZXh0OwogfQoKICAgICAgX19maXJzdCA9IF9fbmV4dDsK
ICAgICAgKytfX2ZpcnN0OwoKICAgICAgd2hpbGUgKF9fZmlyc3QgIT0gX19sYXN0KQogewogICBf
X25leHQgPSBfX2ZpcnN0OwogICBpZiAoKytfX25leHQgPT0gX19sYXN0KQogICAgIHsKICAgICAg
IGlmIChfX2NvbXAoX19maXJzdCwgX19taW4pKQogIF9fbWluID0gX19maXJzdDsKICAgICAgIGVs
c2UgaWYgKCFfX2NvbXAoX19maXJzdCwgX19tYXgpKQogIF9fbWF4ID0gX19maXJzdDsKICAgICAg
IGJyZWFrOwogICAgIH0KCiAgIGlmIChfX2NvbXAoX19uZXh0LCBfX2ZpcnN0KSkKICAgICB7CiAg
ICAgICBpZiAoX19jb21wKF9fbmV4dCwgX19taW4pKQogIF9fbWluID0gX19uZXh0OwogICAgICAg
aWYgKCFfX2NvbXAoX19maXJzdCwgX19tYXgpKQogIF9fbWF4ID0gX19maXJzdDsKICAgICB9CiAg
IGVsc2UKICAgICB7CiAgICAgICBpZiAoX19jb21wKF9fZmlyc3QsIF9fbWluKSkKICBfX21pbiA9
IF9fZmlyc3Q7CiAgICAgICBpZiAoIV9fY29tcChfX25leHQsIF9fbWF4KSkKICBfX21heCA9IF9f
bmV4dDsKICAgICB9CgogICBfX2ZpcnN0ID0gX19uZXh0OwogICArK19fZmlyc3Q7CiB9CgogICAg
ICByZXR1cm4gc3RkOjptYWtlX3BhaXIoX19taW4sIF9fbWF4KTsKICAgIH0KIyAzNDA0ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1l
IF9Gb3J3YXJkSXRlcmF0b3I+CiAgIAogICAgaW5saW5lIHBhaXI8X0ZvcndhcmRJdGVyYXRvciwg
X0ZvcndhcmRJdGVyYXRvcj4KICAgIG1pbm1heF9lbGVtZW50KF9Gb3J3YXJkSXRlcmF0b3IgX19m
aXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QpCiAgICB7CgogICAgIAogICAgIAoKICAgICAg
OwogICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX21pbm1heF9lbGVtZW50KF9fZmlyc3QsIF9f
bGFzdCwKICAgICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNzX2l0ZXIoKSk7CiAgICB9
CiMgMzQzMiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgCiAg
ICBpbmxpbmUgcGFpcjxfRm9yd2FyZEl0ZXJhdG9yLCBfRm9yd2FyZEl0ZXJhdG9yPgogICAgbWlu
bWF4X2VsZW1lbnQoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9f
bGFzdCwKICAgICBfQ29tcGFyZSBfX2NvbXApCiAgICB7CgogICAgIAogICAgIAoKCiAgICAgIDsK
ICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19taW5tYXhfZWxlbWVudChfX2ZpcnN0LCBfX2xh
c3QsCiAgICAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfY29tcF9pdGVyKF9fY29tcCkpOwog
ICAgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAKICAgIGlubGluZSBfVHAKICAgIG1p
bihpbml0aWFsaXplcl9saXN0PF9UcD4gX19sKQogICAgeyByZXR1cm4gKnN0ZDo6bWluX2VsZW1l
bnQoX19sLmJlZ2luKCksIF9fbC5lbmQoKSk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0
eXBlbmFtZSBfQ29tcGFyZT4KICAgCiAgICBpbmxpbmUgX1RwCiAgICBtaW4oaW5pdGlhbGl6ZXJf
bGlzdDxfVHA+IF9fbCwgX0NvbXBhcmUgX19jb21wKQogICAgeyByZXR1cm4gKnN0ZDo6bWluX2Vs
ZW1lbnQoX19sLmJlZ2luKCksIF9fbC5lbmQoKSwgX19jb21wKTsgfQoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHA+CiAgIAogICAgaW5saW5lIF9UcAogICAgbWF4KGluaXRpYWxpemVyX2xpc3Q8X1Rw
PiBfX2wpCiAgICB7IHJldHVybiAqc3RkOjptYXhfZWxlbWVudChfX2wuYmVnaW4oKSwgX19sLmVu
ZCgpKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9Db21wYXJlPgogICAK
ICAgIGlubGluZSBfVHAKICAgIG1heChpbml0aWFsaXplcl9saXN0PF9UcD4gX19sLCBfQ29tcGFy
ZSBfX2NvbXApCiAgICB7IHJldHVybiAqc3RkOjptYXhfZWxlbWVudChfX2wuYmVnaW4oKSwgX19s
LmVuZCgpLCBfX2NvbXApOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgCiAgICBpbmxp
bmUgcGFpcjxfVHAsIF9UcD4KICAgIG1pbm1heChpbml0aWFsaXplcl9saXN0PF9UcD4gX19sKQog
ICAgewogICAgICBwYWlyPGNvbnN0IF9UcCosIGNvbnN0IF9UcCo+IF9fcCA9CiBzdGQ6Om1pbm1h
eF9lbGVtZW50KF9fbC5iZWdpbigpLCBfX2wuZW5kKCkpOwogICAgICByZXR1cm4gc3RkOjptYWtl
X3BhaXIoKl9fcC5maXJzdCwgKl9fcC5zZWNvbmQpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfVHAsIHR5cGVuYW1lIF9Db21wYXJlPgogICAKICAgIGlubGluZSBwYWlyPF9UcCwgX1RwPgog
ICAgbWlubWF4KGluaXRpYWxpemVyX2xpc3Q8X1RwPiBfX2wsIF9Db21wYXJlIF9fY29tcCkKICAg
IHsKICAgICAgcGFpcjxjb25zdCBfVHAqLCBjb25zdCBfVHAqPiBfX3AgPQogc3RkOjptaW5tYXhf
ZWxlbWVudChfX2wuYmVnaW4oKSwgX19sLmVuZCgpLCBfX2NvbXApOwogICAgICByZXR1cm4gc3Rk
OjptYWtlX3BhaXIoKl9fcC5maXJzdCwgKl9fcC5zZWNvbmQpOwogICAgfQoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yMSwgdHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvcjIsCiAg
ICB0eXBlbmFtZSBfQmluYXJ5UHJlZGljYXRlPgogICAgYm9vbAogICAgX19pc19wZXJtdXRhdGlv
bihfRm9yd2FyZEl0ZXJhdG9yMSBfX2ZpcnN0MSwgX0ZvcndhcmRJdGVyYXRvcjEgX19sYXN0MSwK
ICAgICAgIF9Gb3J3YXJkSXRlcmF0b3IyIF9fZmlyc3QyLCBfQmluYXJ5UHJlZGljYXRlIF9fcHJl
ZCkKICAgIHsKCgogICAgICBmb3IgKDsgX19maXJzdDEgIT0gX19sYXN0MTsgKytfX2ZpcnN0MSwg
KHZvaWQpKytfX2ZpcnN0MikKIGlmICghX19wcmVkKF9fZmlyc3QxLCBfX2ZpcnN0MikpCiAgIGJy
ZWFrOwoKICAgICAgaWYgKF9fZmlyc3QxID09IF9fbGFzdDEpCiByZXR1cm4gdHJ1ZTsKCgoKICAg
ICAgX0ZvcndhcmRJdGVyYXRvcjIgX19sYXN0MiA9IF9fZmlyc3QyOwogICAgICBzdGQ6OmFkdmFu
Y2UoX19sYXN0Miwgc3RkOjpkaXN0YW5jZShfX2ZpcnN0MSwgX19sYXN0MSkpOwogICAgICBmb3Ig
KF9Gb3J3YXJkSXRlcmF0b3IxIF9fc2NhbiA9IF9fZmlyc3QxOyBfX3NjYW4gIT0gX19sYXN0MTsg
KytfX3NjYW4pCiB7CiAgIGlmIChfX3NjYW4gIT0gc3RkOjpfX2ZpbmRfaWYoX19maXJzdDEsIF9f
c2NhbiwKICAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfY29tcF9pdGVyKF9fcHJlZCwgX19z
Y2FuKSkpCiAgICAgY29udGludWU7CgogICBhdXRvIF9fbWF0Y2hlcwogICAgID0gc3RkOjpfX2Nv
dW50X2lmKF9fZmlyc3QyLCBfX2xhc3QyLAogICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfY29t
cF9pdGVyKF9fcHJlZCwgX19zY2FuKSk7CiAgIGlmICgwID09IF9fbWF0Y2hlcyB8fAogICAgICAg
c3RkOjpfX2NvdW50X2lmKF9fc2NhbiwgX19sYXN0MSwKICAgX19nbnVfY3h4OjpfX29wczo6X19p
dGVyX2NvbXBfaXRlcihfX3ByZWQsIF9fc2NhbikpCiAgICAgICAhPSBfX21hdGNoZXMpCiAgICAg
cmV0dXJuIGZhbHNlOwogfQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KIyAzNTQ0ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9G
b3J3YXJkSXRlcmF0b3IxLCB0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yMj4KICAgIGlubGluZSBi
b29sCiAgICBpc19wZXJtdXRhdGlvbihfRm9yd2FyZEl0ZXJhdG9yMSBfX2ZpcnN0MSwgX0Zvcndh
cmRJdGVyYXRvcjEgX19sYXN0MSwKICAgICBfRm9yd2FyZEl0ZXJhdG9yMiBfX2ZpcnN0MikKICAg
IHsKCiAgICAgCiAgICAgCiAgICAgCgoKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19pc19w
ZXJtdXRhdGlvbihfX2ZpcnN0MSwgX19sYXN0MSwgX19maXJzdDIsCiAgICAgICBfX2dudV9jeHg6
Ol9fb3BzOjpfX2l0ZXJfZXF1YWxfdG9faXRlcigpKTsKICAgIH0KIyAzNTc1ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3
YXJkSXRlcmF0b3IxLCB0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yMiwKICAgIHR5cGVuYW1lIF9C
aW5hcnlQcmVkaWNhdGU+CiAgICBpbmxpbmUgYm9vbAogICAgaXNfcGVybXV0YXRpb24oX0Zvcndh
cmRJdGVyYXRvcjEgX19maXJzdDEsIF9Gb3J3YXJkSXRlcmF0b3IxIF9fbGFzdDEsCiAgICAgX0Zv
cndhcmRJdGVyYXRvcjIgX19maXJzdDIsIF9CaW5hcnlQcmVkaWNhdGUgX19wcmVkKQogICAgewoK
ICAgICAKICAgICAKICAgICAKCgogICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX2lzX3Blcm11
dGF0aW9uKF9fZmlyc3QxLCBfX2xhc3QxLCBfX2ZpcnN0MiwKICAgICAgIF9fZ251X2N4eDo6X19v
cHM6Ol9faXRlcl9jb21wX2l0ZXIoX19wcmVkKSk7CiAgICB9CiMgMzcyMyAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9t
QWNjZXNzSXRlcmF0b3IsCiAgICB0eXBlbmFtZSBfVW5pZm9ybVJhbmRvbU51bWJlckdlbmVyYXRv
cj4KICAgIHZvaWQKICAgIHNodWZmbGUoX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fZmlyc3QsIF9S
YW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QsCiAgICAgX1VuaWZvcm1SYW5kb21OdW1iZXJHZW5l
cmF0b3ImJiBfX2cpCiAgICB7CgogICAgIAoKICAgICAgOwoKICAgICAgaWYgKF9fZmlyc3QgPT0g
X19sYXN0KQogcmV0dXJuOwoKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8
X1JhbmRvbUFjY2Vzc0l0ZXJhdG9yPjo6ZGlmZmVyZW5jZV90eXBlCiBfRGlzdGFuY2VUeXBlOwoK
ICAgICAgdHlwZWRlZiB0eXBlbmFtZSBzdGQ6Om1ha2VfdW5zaWduZWQ8X0Rpc3RhbmNlVHlwZT46
OnR5cGUgX191ZF90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIHN0ZDo6dW5pZm9ybV9pbnRf
ZGlzdHJpYnV0aW9uPF9fdWRfdHlwZT4gX19kaXN0cl90eXBlOwogICAgICB0eXBlZGVmIHR5cGVu
YW1lIF9fZGlzdHJfdHlwZTo6cGFyYW1fdHlwZSBfX3BfdHlwZTsKICAgICAgX19kaXN0cl90eXBl
IF9fZDsKCiAgICAgIGZvciAoX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9faSA9IF9fZmlyc3QgKyAx
OyBfX2kgIT0gX19sYXN0OyArK19faSkKIHN0ZDo6aXRlcl9zd2FwKF9faSwgX19maXJzdCArIF9f
ZChfX2csIF9fcF90eXBlKDAsIF9faSAtIF9fZmlyc3QpKSk7CiAgICB9CgoKCgoKCgojIDM3Njgg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9GdW5jdGlvbj4KICAgIF9GdW5jdGlvbgog
ICAgZm9yX2VhY2goX0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0
LCBfRnVuY3Rpb24gX19mKQogICAgewoKICAgICAKICAgICAgOwogICAgICBmb3IgKDsgX19maXJz
dCAhPSBfX2xhc3Q7ICsrX19maXJzdCkKIF9fZigqX19maXJzdCk7CiAgICAgIHJldHVybiBzdGQ6
Om1vdmUoX19mKTsKICAgIH0KIyAzNzg5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3Rs
X2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBf
VHA+CiAgICBpbmxpbmUgX0lucHV0SXRlcmF0b3IKICAgIGZpbmQoX0lucHV0SXRlcmF0b3IgX19m
aXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogIGNvbnN0IF9UcCYgX192YWwpCiAgICB7Cgog
ICAgIAogICAgIAoKICAgICAgOwogICAgICByZXR1cm4gc3RkOjpfX2ZpbmRfaWYoX19maXJzdCwg
X19sYXN0LAogICAgICAgX19nbnVfY3h4OjpfX29wczo6X19pdGVyX2VxdWFsc192YWwoX192YWwp
KTsKICAgIH0KIyAzODEzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIg
MwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfUHJlZGljYXRl
PgogICAgaW5saW5lIF9JbnB1dEl0ZXJhdG9yCiAgICBmaW5kX2lmKF9JbnB1dEl0ZXJhdG9yIF9f
Zmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgICBfUHJlZGljYXRlIF9fcHJlZCkKICAg
IHsKCiAgICAgCiAgICAgCgogICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX2ZpbmRfaWYoX19m
aXJzdCwgX19sYXN0LAogICAgICAgX19nbnVfY3h4OjpfX29wczo6X19wcmVkX2l0ZXIoX19wcmVk
KSk7CiAgICB9CiMgMzg0NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgi
IDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvciwgdHlwZW5hbWUgX0ZvcndhcmRJ
dGVyYXRvcj4KICAgIF9JbnB1dEl0ZXJhdG9yCiAgICBmaW5kX2ZpcnN0X29mKF9JbnB1dEl0ZXJh
dG9yIF9fZmlyc3QxLCBfSW5wdXRJdGVyYXRvciBfX2xhc3QxLAogICAgX0ZvcndhcmRJdGVyYXRv
ciBfX2ZpcnN0MiwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QyKQogICAgewoKICAgICAKICAgICAK
ICAgICAKCgogICAgICA7CiAgICAgIDsKCiAgICAgIGZvciAoOyBfX2ZpcnN0MSAhPSBfX2xhc3Qx
OyArK19fZmlyc3QxKQogZm9yIChfRm9yd2FyZEl0ZXJhdG9yIF9faXRlciA9IF9fZmlyc3QyOyBf
X2l0ZXIgIT0gX19sYXN0MjsgKytfX2l0ZXIpCiAgIGlmICgqX19maXJzdDEgPT0gKl9faXRlcikK
ICAgICByZXR1cm4gX19maXJzdDE7CiAgICAgIHJldHVybiBfX2xhc3QxOwogICAgfQojIDM4ODQg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsCiAgICB0eXBl
bmFtZSBfQmluYXJ5UHJlZGljYXRlPgogICAgX0lucHV0SXRlcmF0b3IKICAgIGZpbmRfZmlyc3Rf
b2YoX0lucHV0SXRlcmF0b3IgX19maXJzdDEsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdDEsCiAgICBf
Rm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QyLCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdDIsCiAgICBf
QmluYXJ5UHJlZGljYXRlIF9fY29tcCkKICAgIHsKCiAgICAgCiAgICAgCiAgICAgCgoKICAgICAg
OwogICAgICA7CgogICAgICBmb3IgKDsgX19maXJzdDEgIT0gX19sYXN0MTsgKytfX2ZpcnN0MSkK
IGZvciAoX0ZvcndhcmRJdGVyYXRvciBfX2l0ZXIgPSBfX2ZpcnN0MjsgX19pdGVyICE9IF9fbGFz
dDI7ICsrX19pdGVyKQogICBpZiAoX19jb21wKCpfX2ZpcnN0MSwgKl9faXRlcikpCiAgICAgcmV0
dXJuIF9fZmlyc3QxOwogICAgICByZXR1cm4gX19sYXN0MTsKICAgIH0KIyAzOTE2ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9G
b3J3YXJkSXRlcmF0b3I+CiAgICBpbmxpbmUgX0ZvcndhcmRJdGVyYXRvcgogICAgYWRqYWNlbnRf
ZmluZChfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0KQog
ICAgewoKICAgICAKICAgICAKCiAgICAgIDsKCiAgICAgIHJldHVybiBzdGQ6Ol9fYWRqYWNlbnRf
ZmluZChfX2ZpcnN0LCBfX2xhc3QsCiAgICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9lcXVh
bF90b19pdGVyKCkpOwogICAgfQojIDM5NDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9z
dGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5h
bWUgX0JpbmFyeVByZWRpY2F0ZT4KICAgIGlubGluZSBfRm9yd2FyZEl0ZXJhdG9yCiAgICBhZGph
Y2VudF9maW5kKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xh
c3QsCiAgICBfQmluYXJ5UHJlZGljYXRlIF9fYmluYXJ5X3ByZWQpCiAgICB7CgogICAgIAogICAg
IAoKCiAgICAgIDsKCiAgICAgIHJldHVybiBzdGQ6Ol9fYWRqYWNlbnRfZmluZChfX2ZpcnN0LCBf
X2xhc3QsCiAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9jb21wX2l0ZXIoX19iaW5hcnlfcHJl
ZCkpOwogICAgfQojIDM5NjYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5o
IiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9UcD4KICAg
IGlubGluZSB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0lucHV0SXRlcmF0b3I+OjpkaWZmZXJl
bmNlX3R5cGUKICAgIGNvdW50KF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9y
IF9fbGFzdCwgY29uc3QgX1RwJiBfX3ZhbHVlKQogICAgewoKICAgICAKICAgICAKCiAgICAgIDsK
CiAgICAgIHJldHVybiBzdGQ6Ol9fY291bnRfaWYoX19maXJzdCwgX19sYXN0LAogICAgICAgIF9f
Z251X2N4eDo6X19vcHM6Ol9faXRlcl9lcXVhbHNfdmFsKF9fdmFsdWUpKTsKICAgIH0KIyAzOTg5
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5
cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfUHJlZGljYXRlPgogICAgaW5saW5lIHR5
cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfSW5wdXRJdGVyYXRvcj46OmRpZmZlcmVuY2VfdHlwZQog
ICAgY291bnRfaWYoX0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0
LCBfUHJlZGljYXRlIF9fcHJlZCkKICAgIHsKCiAgICAgCiAgICAgCgogICAgICA7CgogICAgICBy
ZXR1cm4gc3RkOjpfX2NvdW50X2lmKF9fZmlyc3QsIF9fbGFzdCwKICAgICAgICBfX2dudV9jeHg6
Ol9fb3BzOjpfX3ByZWRfaXRlcihfX3ByZWQpKTsKICAgIH0KIyA0MDI5ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJk
SXRlcmF0b3IxLCB0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yMj4KICAgIGlubGluZSBfRm9yd2Fy
ZEl0ZXJhdG9yMQogICAgc2VhcmNoKF9Gb3J3YXJkSXRlcmF0b3IxIF9fZmlyc3QxLCBfRm9yd2Fy
ZEl0ZXJhdG9yMSBfX2xhc3QxLAogICAgX0ZvcndhcmRJdGVyYXRvcjIgX19maXJzdDIsIF9Gb3J3
YXJkSXRlcmF0b3IyIF9fbGFzdDIpCiAgICB7CgogICAgIAogICAgIAogICAgIAoKCiAgICAgIDsK
ICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19zZWFyY2goX19maXJzdDEsIF9fbGFzdDEsIF9f
Zmlyc3QyLCBfX2xhc3QyLAogICAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfZXF1YWxfdG9f
aXRlcigpKTsKICAgIH0KIyA0MDY4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2Fs
Z28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IxLCB0eXBlbmFtZSBf
Rm9yd2FyZEl0ZXJhdG9yMiwKICAgIHR5cGVuYW1lIF9CaW5hcnlQcmVkaWNhdGU+CiAgICBpbmxp
bmUgX0ZvcndhcmRJdGVyYXRvcjEKICAgIHNlYXJjaChfRm9yd2FyZEl0ZXJhdG9yMSBfX2ZpcnN0
MSwgX0ZvcndhcmRJdGVyYXRvcjEgX19sYXN0MSwKICAgIF9Gb3J3YXJkSXRlcmF0b3IyIF9fZmly
c3QyLCBfRm9yd2FyZEl0ZXJhdG9yMiBfX2xhc3QyLAogICAgX0JpbmFyeVByZWRpY2F0ZSBfX3By
ZWRpY2F0ZSkKICAgIHsKCiAgICAgCiAgICAgCiAgICAgCgoKICAgICAgOwogICAgICA7CgogICAg
ICByZXR1cm4gc3RkOjpfX3NlYXJjaChfX2ZpcnN0MSwgX19sYXN0MSwgX19maXJzdDIsIF9fbGFz
dDIsCiAgICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9jb21wX2l0ZXIoX19wcmVkaWNhdGUp
KTsKICAgIH0KIyA0MTAzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIg
MwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9JbnRlZ2Vy
LCB0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgX0ZvcndhcmRJdGVyYXRvcgogICAgc2VhcmNoX24o
X0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICAgICAg
X0ludGVnZXIgX19jb3VudCwgY29uc3QgX1RwJiBfX3ZhbCkKICAgIHsKCiAgICAgCiAgICAgCgog
ICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX3NlYXJjaF9uKF9fZmlyc3QsIF9fbGFzdCwgX19j
b3VudCwKICAgICAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfZXF1YWxzX3ZhbChfX3ZhbCkp
OwogICAgfQojIDQxMzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAz
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX0ludGVnZXIs
IHR5cGVuYW1lIF9UcCwKICAgIHR5cGVuYW1lIF9CaW5hcnlQcmVkaWNhdGU+CiAgICBpbmxpbmUg
X0ZvcndhcmRJdGVyYXRvcgogICAgc2VhcmNoX24oX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBf
Rm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgX0ludGVnZXIgX19jb3VudCwgY29uc3QgX1Rw
JiBfX3ZhbCwKICAgICAgX0JpbmFyeVByZWRpY2F0ZSBfX2JpbmFyeV9wcmVkKQogICAgewoKICAg
ICAKICAgICAKCiAgICAgIDsKCiAgICAgIHJldHVybiBzdGQ6Ol9fc2VhcmNoX24oX19maXJzdCwg
X19sYXN0LCBfX2NvdW50LAogIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9jb21wX3ZhbChfX2Jp
bmFyeV9wcmVkLCBfX3ZhbCkpOwogICAgfQojIDQxNzAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5
cGVuYW1lIF9PdXRwdXRJdGVyYXRvciwKICAgIHR5cGVuYW1lIF9VbmFyeU9wZXJhdGlvbj4KICAg
IF9PdXRwdXRJdGVyYXRvcgogICAgdHJhbnNmb3JtKF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9J
bnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgIF9PdXRwdXRJdGVyYXRvciBfX3Jlc3VsdCwgX1Vu
YXJ5T3BlcmF0aW9uIF9fdW5hcnlfb3ApCiAgICB7CgogICAgIAogICAgIAoKCiAgICAgIDsKCiAg
ICAgIGZvciAoOyBfX2ZpcnN0ICE9IF9fbGFzdDsgKytfX2ZpcnN0LCAodm9pZCkrK19fcmVzdWx0
KQogKl9fcmVzdWx0ID0gX191bmFyeV9vcCgqX19maXJzdCk7CiAgICAgIHJldHVybiBfX3Jlc3Vs
dDsKICAgIH0KIyA0MjA3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIg
MwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yMSwgdHlwZW5hbWUgX0lucHV0SXRl
cmF0b3IyLAogICAgdHlwZW5hbWUgX091dHB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfQmluYXJ5T3Bl
cmF0aW9uPgogICAgX091dHB1dEl0ZXJhdG9yCiAgICB0cmFuc2Zvcm0oX0lucHV0SXRlcmF0b3Ix
IF9fZmlyc3QxLCBfSW5wdXRJdGVyYXRvcjEgX19sYXN0MSwKICAgICAgIF9JbnB1dEl0ZXJhdG9y
MiBfX2ZpcnN0MiwgX091dHB1dEl0ZXJhdG9yIF9fcmVzdWx0LAogICAgICAgX0JpbmFyeU9wZXJh
dGlvbiBfX2JpbmFyeV9vcCkKICAgIHsKCiAgICAgCiAgICAgCiAgICAgCgoKICAgICAgOwoKICAg
ICAgZm9yICg7IF9fZmlyc3QxICE9IF9fbGFzdDE7ICsrX19maXJzdDEsICh2b2lkKSsrX19maXJz
dDIsICsrX19yZXN1bHQpCiAqX19yZXN1bHQgPSBfX2JpbmFyeV9vcCgqX19maXJzdDEsICpfX2Zp
cnN0Mik7CiAgICAgIHJldHVybiBfX3Jlc3VsdDsKICAgIH0KIyA0MjQwICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJk
SXRlcmF0b3IsIHR5cGVuYW1lIF9UcD4KICAgIHZvaWQKICAgIHJlcGxhY2UoX0ZvcndhcmRJdGVy
YXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICAgICBjb25zdCBfVHAmIF9f
b2xkX3ZhbHVlLCBjb25zdCBfVHAmIF9fbmV3X3ZhbHVlKQogICAgewoKICAgICAKCiAgICAgCgog
ICAgIAoKICAgICAgOwoKICAgICAgZm9yICg7IF9fZmlyc3QgIT0gX19sYXN0OyArK19fZmlyc3Qp
CiBpZiAoKl9fZmlyc3QgPT0gX19vbGRfdmFsdWUpCiAgICpfX2ZpcnN0ID0gX19uZXdfdmFsdWU7
CiAgICB9CiMgNDI3MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfUHJlZGljYXRl
LCB0eXBlbmFtZSBfVHA+CiAgICB2b2lkCiAgICByZXBsYWNlX2lmKF9Gb3J3YXJkSXRlcmF0b3Ig
X19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QsCiAgICAgICAgX1ByZWRpY2F0ZSBfX3By
ZWQsIGNvbnN0IF9UcCYgX19uZXdfdmFsdWUpCiAgICB7CgogICAgIAoKICAgICAKCiAgICAgCgog
ICAgICA7CgogICAgICBmb3IgKDsgX19maXJzdCAhPSBfX2xhc3Q7ICsrX19maXJzdCkKIGlmIChf
X3ByZWQoKl9fZmlyc3QpKQogICAqX19maXJzdCA9IF9fbmV3X3ZhbHVlOwogICAgfQojIDQzMDQg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX0dlbmVyYXRvcj4KICAgIHZvaWQKICAg
IGdlbmVyYXRlKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xh
c3QsCiAgICAgIF9HZW5lcmF0b3IgX19nZW4pCiAgICB7CgogICAgIAogICAgIAoKICAgICAgOwoK
ICAgICAgZm9yICg7IF9fZmlyc3QgIT0gX19sYXN0OyArK19fZmlyc3QpCiAqX19maXJzdCA9IF9f
Z2VuKCk7CiAgICB9CiMgNDMzNSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdv
LmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfT3V0cHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9TaXpl
LCB0eXBlbmFtZSBfR2VuZXJhdG9yPgogICAgX091dHB1dEl0ZXJhdG9yCiAgICBnZW5lcmF0ZV9u
KF9PdXRwdXRJdGVyYXRvciBfX2ZpcnN0LCBfU2l6ZSBfX24sIF9HZW5lcmF0b3IgX19nZW4pCiAg
ICB7CgogICAgIAoKCgogICAgICBmb3IgKF9fZGVjbHR5cGUoX19uICsgMCkgX19uaXRlciA9IF9f
bjsKICAgIF9fbml0ZXIgPiAwOyAtLV9fbml0ZXIsICsrX19maXJzdCkKICpfX2ZpcnN0ID0gX19n
ZW4oKTsKICAgICAgcmV0dXJuIF9fZmlyc3Q7CiAgICB9CiMgNDM3MSAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVy
YXRvciwgdHlwZW5hbWUgX091dHB1dEl0ZXJhdG9yPgogICAgaW5saW5lIF9PdXRwdXRJdGVyYXRv
cgogICAgdW5pcXVlX2NvcHkoX0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3Ig
X19sYXN0LAogIF9PdXRwdXRJdGVyYXRvciBfX3Jlc3VsdCkKICAgIHsKCiAgICAgCiAgICAgCgog
ICAgIAoKICAgICAgOwoKICAgICAgaWYgKF9fZmlyc3QgPT0gX19sYXN0KQogcmV0dXJuIF9fcmVz
dWx0OwogICAgICByZXR1cm4gc3RkOjpfX3VuaXF1ZV9jb3B5KF9fZmlyc3QsIF9fbGFzdCwgX19y
ZXN1bHQsCiAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfZXF1YWxfdG9faXRlcigpLAogICAg
c3RkOjpfX2l0ZXJhdG9yX2NhdGVnb3J5KF9fZmlyc3QpLAogICAgc3RkOjpfX2l0ZXJhdG9yX2Nh
dGVnb3J5KF9fcmVzdWx0KSk7CiAgICB9CiMgNDQxMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvciwgdHlw
ZW5hbWUgX091dHB1dEl0ZXJhdG9yLAogICAgdHlwZW5hbWUgX0JpbmFyeVByZWRpY2F0ZT4KICAg
IGlubGluZSBfT3V0cHV0SXRlcmF0b3IKICAgIHVuaXF1ZV9jb3B5KF9JbnB1dEl0ZXJhdG9yIF9f
Zmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICBfT3V0cHV0SXRlcmF0b3IgX19yZXN1bHQs
CiAgX0JpbmFyeVByZWRpY2F0ZSBfX2JpbmFyeV9wcmVkKQogICAgewoKICAgICAKICAgICAKCiAg
ICAgIDsKCiAgICAgIGlmIChfX2ZpcnN0ID09IF9fbGFzdCkKIHJldHVybiBfX3Jlc3VsdDsKICAg
ICAgcmV0dXJuIHN0ZDo6X191bmlxdWVfY29weShfX2ZpcnN0LCBfX2xhc3QsIF9fcmVzdWx0LAog
ICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfY29tcF9pdGVyKF9fYmluYXJ5X3ByZWQpLAogICAg
c3RkOjpfX2l0ZXJhdG9yX2NhdGVnb3J5KF9fZmlyc3QpLAogICAgc3RkOjpfX2l0ZXJhdG9yX2Nh
dGVnb3J5KF9fcmVzdWx0KSk7CiAgICB9CiMgNDQ0NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0
b3I+CiAgICBpbmxpbmUgdm9pZAogICAgcmFuZG9tX3NodWZmbGUoX1JhbmRvbUFjY2Vzc0l0ZXJh
dG9yIF9fZmlyc3QsIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QpCiAgICB7CgogICAgIAoK
ICAgICAgOwoKICAgICAgaWYgKF9fZmlyc3QgIT0gX19sYXN0KQogZm9yIChfUmFuZG9tQWNjZXNz
SXRlcmF0b3IgX19pID0gX19maXJzdCArIDE7IF9faSAhPSBfX2xhc3Q7ICsrX19pKQogICB7Cgog
ICAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ogPSBfX2ZpcnN0CiAgICAgKyBzdGQ6OnJhbmQo
KSAlICgoX19pIC0gX19maXJzdCkgKyAxKTsKICAgICBpZiAoX19pICE9IF9faikKICAgICAgIHN0
ZDo6aXRlcl9zd2FwKF9faSwgX19qKTsKICAgfQogICAgfQojIDQ0NzkgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFj
Y2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBfUmFuZG9tTnVtYmVyR2VuZXJhdG9yPgogICAgdm9pZAog
ICAgcmFuZG9tX3NodWZmbGUoX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fZmlyc3QsIF9SYW5kb21B
Y2Nlc3NJdGVyYXRvciBfX2xhc3QsCgogICAgIF9SYW5kb21OdW1iZXJHZW5lcmF0b3ImJiBfX3Jh
bmQpCgoKCiAgICB7CgogICAgIAoKICAgICAgOwoKICAgICAgaWYgKF9fZmlyc3QgPT0gX19sYXN0
KQogcmV0dXJuOwogICAgICBmb3IgKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2kgPSBfX2ZpcnN0
ICsgMTsgX19pICE9IF9fbGFzdDsgKytfX2kpCiB7CiAgIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBf
X2ogPSBfX2ZpcnN0ICsgX19yYW5kKChfX2kgLSBfX2ZpcnN0KSArIDEpOwogICBpZiAoX19pICE9
IF9faikKICAgICBzdGQ6Oml0ZXJfc3dhcChfX2ksIF9faik7CiB9CiAgICB9CiMgNDUxOSAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfUHJlZGljYXRlPgogICAgaW5saW5lIF9Gb3J3
YXJkSXRlcmF0b3IKICAgIHBhcnRpdGlvbihfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3
YXJkSXRlcmF0b3IgX19sYXN0LAogICAgICAgX1ByZWRpY2F0ZSBfX3ByZWQpCiAgICB7CgogICAg
IAoKICAgICAKCiAgICAgIDsKCiAgICAgIHJldHVybiBzdGQ6Ol9fcGFydGl0aW9uKF9fZmlyc3Qs
IF9fbGFzdCwgX19wcmVkLAogICAgICAgICBzdGQ6Ol9faXRlcmF0b3JfY2F0ZWdvcnkoX19maXJz
dCkpOwogICAgfQojIDQ1NTIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5o
IiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yPgogICAgaW5saW5l
IHZvaWQKICAgIHBhcnRpYWxfc29ydChfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19maXJzdCwKICAg
X1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fbWlkZGxlLAogICBfUmFuZG9tQWNjZXNzSXRlcmF0b3Ig
X19sYXN0KQogICAgewoKICAgICAKCiAgICAgCgogICAgICA7CiAgICAgIDsKICAgICAgOwoKICAg
ICAgc3RkOjpfX3BhcnRpYWxfc29ydChfX2ZpcnN0LCBfX21pZGRsZSwgX19sYXN0LAogICAgIF9f
Z251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNzX2l0ZXIoKSk7CiAgICB9CiMgNDU5MCAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
UmFuZG9tQWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgaW5saW5lIHZvaWQK
ICAgIHBhcnRpYWxfc29ydChfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19maXJzdCwKICAgX1JhbmRv
bUFjY2Vzc0l0ZXJhdG9yIF9fbWlkZGxlLAogICBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0
LAogICBfQ29tcGFyZSBfX2NvbXApCiAgICB7CgogICAgIAoKICAgICAKCgogICAgICA7CiAgICAg
IDsKICAgICAgOwoKICAgICAgc3RkOjpfX3BhcnRpYWxfc29ydChfX2ZpcnN0LCBfX21pZGRsZSwg
X19sYXN0LAogICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9jb21wX2l0ZXIoX19jb21wKSk7
CiAgICB9CiMgNDYyNiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3I+CiAgICBpbmxpbmUgdm9p
ZAogICAgbnRoX2VsZW1lbnQoX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yIF9fZmlyc3QsIF9SYW5kb21B
Y2Nlc3NJdGVyYXRvciBfX250aCwKICBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0KQogICAg
ewoKICAgICAKCiAgICAgCgogICAgICA7CiAgICAgIDsKICAgICAgOwoKICAgICAgaWYgKF9fZmly
c3QgPT0gX19sYXN0IHx8IF9fbnRoID09IF9fbGFzdCkKIHJldHVybjsKCiAgICAgIHN0ZDo6X19p
bnRyb3NlbGVjdChfX2ZpcnN0LCBfX250aCwgX19sYXN0LAogICAgc3RkOjpfX2xnKF9fbGFzdCAt
IF9fZmlyc3QpICogMiwKICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNzX2l0ZXIoKSk7
CiAgICB9CiMgNDY2NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9Db21w
YXJlPgogICAgaW5saW5lIHZvaWQKICAgIG50aF9lbGVtZW50KF9SYW5kb21BY2Nlc3NJdGVyYXRv
ciBfX2ZpcnN0LCBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19udGgsCiAgX1JhbmRvbUFjY2Vzc0l0
ZXJhdG9yIF9fbGFzdCwgX0NvbXBhcmUgX19jb21wKQogICAgewoKICAgICAKCiAgICAgCgoKICAg
ICAgOwogICAgICA7CiAgICAgIDsKCiAgICAgIGlmIChfX2ZpcnN0ID09IF9fbGFzdCB8fCBfX250
aCA9PSBfX2xhc3QpCiByZXR1cm47CgogICAgICBzdGQ6Ol9faW50cm9zZWxlY3QoX19maXJzdCwg
X19udGgsIF9fbGFzdCwKICAgIHN0ZDo6X19sZyhfX2xhc3QgLSBfX2ZpcnN0KSAqIDIsCiAgICBf
X2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfY29tcF9pdGVyKF9fY29tcCkpOwogICAgfQojIDQ3MDIg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yPgogICAgaW5saW5lIHZvaWQKICAgIHNvcnQoX1Jh
bmRvbUFjY2Vzc0l0ZXJhdG9yIF9fZmlyc3QsIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3Qp
CiAgICB7CgogICAgIAoKICAgICAKCiAgICAgIDsKICAgICAgOwoKICAgICAgc3RkOjpfX3NvcnQo
X19maXJzdCwgX19sYXN0LCBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfbGVzc19pdGVyKCkpOwog
ICAgfQojIDQ3MzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFjY2Vzc0l0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFy
ZT4KICAgIGlubGluZSB2b2lkCiAgICBzb3J0KF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0
LCBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0LAogIF9Db21wYXJlIF9fY29tcCkKICAgIHsK
CiAgICAgCgogICAgIAoKCiAgICAgIDsKICAgICAgOwoKICAgICAgc3RkOjpfX3NvcnQoX19maXJz
dCwgX19sYXN0LCBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfY29tcF9pdGVyKF9fY29tcCkpOwog
ICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcjEsIHR5cGVuYW1lIF9JbnB1
dEl0ZXJhdG9yMiwKICAgIHR5cGVuYW1lIF9PdXRwdXRJdGVyYXRvciwgdHlwZW5hbWUgX0NvbXBh
cmU+CiAgICBfT3V0cHV0SXRlcmF0b3IKICAgIF9fbWVyZ2UoX0lucHV0SXRlcmF0b3IxIF9fZmly
c3QxLCBfSW5wdXRJdGVyYXRvcjEgX19sYXN0MSwKICAgICBfSW5wdXRJdGVyYXRvcjIgX19maXJz
dDIsIF9JbnB1dEl0ZXJhdG9yMiBfX2xhc3QyLAogICAgIF9PdXRwdXRJdGVyYXRvciBfX3Jlc3Vs
dCwgX0NvbXBhcmUgX19jb21wKQogICAgewogICAgICB3aGlsZSAoX19maXJzdDEgIT0gX19sYXN0
MSAmJiBfX2ZpcnN0MiAhPSBfX2xhc3QyKQogewogICBpZiAoX19jb21wKF9fZmlyc3QyLCBfX2Zp
cnN0MSkpCiAgICAgewogICAgICAgKl9fcmVzdWx0ID0gKl9fZmlyc3QyOwogICAgICAgKytfX2Zp
cnN0MjsKICAgICB9CiAgIGVsc2UKICAgICB7CiAgICAgICAqX19yZXN1bHQgPSAqX19maXJzdDE7
CiAgICAgICArK19fZmlyc3QxOwogICAgIH0KICAgKytfX3Jlc3VsdDsKIH0KICAgICAgcmV0dXJu
IHN0ZDo6Y29weShfX2ZpcnN0MiwgX19sYXN0MiwKICAgICAgICAgc3RkOjpjb3B5KF9fZmlyc3Qx
LCBfX2xhc3QxLCBfX3Jlc3VsdCkpOwogICAgfQojIDQ3OTMgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3Ix
LCB0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcjIsCiAgICB0eXBlbmFtZSBfT3V0cHV0SXRlcmF0b3I+
CiAgICBpbmxpbmUgX091dHB1dEl0ZXJhdG9yCiAgICBtZXJnZShfSW5wdXRJdGVyYXRvcjEgX19m
aXJzdDEsIF9JbnB1dEl0ZXJhdG9yMSBfX2xhc3QxLAogICBfSW5wdXRJdGVyYXRvcjIgX19maXJz
dDIsIF9JbnB1dEl0ZXJhdG9yMiBfX2xhc3QyLAogICBfT3V0cHV0SXRlcmF0b3IgX19yZXN1bHQp
CiAgICB7CgogICAgIAogICAgIAogICAgIAoKICAgICAKCiAgICAgCgoKICAgICAgOwogICAgICA7
CiAgICAgIDsKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19tZXJnZShfX2ZpcnN0MSwgX19s
YXN0MSwKICAgICAgICAgX19maXJzdDIsIF9fbGFzdDIsIF9fcmVzdWx0LAogICAgICAgICBfX2du
dV9jeHg6Ol9fb3BzOjpfX2l0ZXJfbGVzc19pdGVyKCkpOwogICAgfQojIDQ4NDMgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lu
cHV0SXRlcmF0b3IxLCB0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcjIsCiAgICB0eXBlbmFtZSBfT3V0
cHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAgaW5saW5lIF9PdXRwdXRJdGVyYXRv
cgogICAgbWVyZ2UoX0lucHV0SXRlcmF0b3IxIF9fZmlyc3QxLCBfSW5wdXRJdGVyYXRvcjEgX19s
YXN0MSwKICAgX0lucHV0SXRlcmF0b3IyIF9fZmlyc3QyLCBfSW5wdXRJdGVyYXRvcjIgX19sYXN0
MiwKICAgX091dHB1dEl0ZXJhdG9yIF9fcmVzdWx0LCBfQ29tcGFyZSBfX2NvbXApCiAgICB7Cgog
ICAgIAogICAgIAogICAgIAoKICAgICAKCiAgICAgCgoKICAgICAgOwogICAgICA7CiAgICAgIDsK
ICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19tZXJnZShfX2ZpcnN0MSwgX19sYXN0MSwKICAg
IF9fZmlyc3QyLCBfX2xhc3QyLCBfX3Jlc3VsdCwKICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRl
cl9jb21wX2l0ZXIoX19jb21wKSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SYW5kb21B
Y2Nlc3NJdGVyYXRvciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBpbmxpbmUgdm9pZAogICAgX19z
dGFibGVfc29ydChfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19maXJzdCwgX1JhbmRvbUFjY2Vzc0l0
ZXJhdG9yIF9fbGFzdCwKICAgIF9Db21wYXJlIF9fY29tcCkKICAgIHsKICAgICAgdHlwZWRlZiB0
eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X1JhbmRvbUFjY2Vzc0l0ZXJhdG9yPjo6dmFsdWVfdHlw
ZQogX1ZhbHVlVHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X1Jh
bmRvbUFjY2Vzc0l0ZXJhdG9yPjo6ZGlmZmVyZW5jZV90eXBlCiBfRGlzdGFuY2VUeXBlOwoKICAg
ICAgdHlwZWRlZiBfVGVtcG9yYXJ5X2J1ZmZlcjxfUmFuZG9tQWNjZXNzSXRlcmF0b3IsIF9WYWx1
ZVR5cGU+IF9UbXBCdWY7CiAgICAgIF9UbXBCdWYgX19idWYoX19maXJzdCwgX19sYXN0KTsKCiAg
ICAgIGlmIChfX2J1Zi5iZWdpbigpID09IDApCiBzdGQ6Ol9faW5wbGFjZV9zdGFibGVfc29ydChf
X2ZpcnN0LCBfX2xhc3QsIF9fY29tcCk7CiAgICAgIGVsc2UKIHN0ZDo6X19zdGFibGVfc29ydF9h
ZGFwdGl2ZShfX2ZpcnN0LCBfX2xhc3QsIF9fYnVmLmJlZ2luKCksCiAgICAgICAgX0Rpc3RhbmNl
VHlwZShfX2J1Zi5zaXplKCkpLCBfX2NvbXApOwogICAgfQojIDQ5MDcgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JhbmRvbUFj
Y2Vzc0l0ZXJhdG9yPgogICAgaW5saW5lIHZvaWQKICAgIHN0YWJsZV9zb3J0KF9SYW5kb21BY2Nl
c3NJdGVyYXRvciBfX2ZpcnN0LCBfUmFuZG9tQWNjZXNzSXRlcmF0b3IgX19sYXN0KQogICAgewoK
ICAgICAKCiAgICAgCgogICAgICA7CiAgICAgIDsKCiAgICAgIHN0ZDo6X19zdGFibGVfc29ydChf
X2ZpcnN0LCBfX2xhc3QsCiAgICAgICAgX19nbnVfY3h4OjpfX29wczo6X19pdGVyX2xlc3NfaXRl
cigpKTsKICAgIH0KIyA0OTQxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28u
aCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9SYW5kb21BY2Nlc3NJdGVyYXRvciwgdHlwZW5hbWUg
X0NvbXBhcmU+CiAgICBpbmxpbmUgdm9pZAogICAgc3RhYmxlX3NvcnQoX1JhbmRvbUFjY2Vzc0l0
ZXJhdG9yIF9fZmlyc3QsIF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2xhc3QsCiAgX0NvbXBhcmUg
X19jb21wKQogICAgewoKICAgICAKCiAgICAgCgoKICAgICAgOwogICAgICA7CgogICAgICBzdGQ6
Ol9fc3RhYmxlX3NvcnQoX19maXJzdCwgX19sYXN0LAogICAgICAgIF9fZ251X2N4eDo6X19vcHM6
Ol9faXRlcl9jb21wX2l0ZXIoX19jb21wKSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9J
bnB1dEl0ZXJhdG9yMSwgdHlwZW5hbWUgX0lucHV0SXRlcmF0b3IyLAogICAgdHlwZW5hbWUgX091
dHB1dEl0ZXJhdG9yLAogICAgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBfT3V0cHV0SXRlcmF0b3IK
ICAgIF9fc2V0X3VuaW9uKF9JbnB1dEl0ZXJhdG9yMSBfX2ZpcnN0MSwgX0lucHV0SXRlcmF0b3Ix
IF9fbGFzdDEsCiAgX0lucHV0SXRlcmF0b3IyIF9fZmlyc3QyLCBfSW5wdXRJdGVyYXRvcjIgX19s
YXN0MiwKICBfT3V0cHV0SXRlcmF0b3IgX19yZXN1bHQsIF9Db21wYXJlIF9fY29tcCkKICAgIHsK
ICAgICAgd2hpbGUgKF9fZmlyc3QxICE9IF9fbGFzdDEgJiYgX19maXJzdDIgIT0gX19sYXN0MikK
IHsKICAgaWYgKF9fY29tcChfX2ZpcnN0MSwgX19maXJzdDIpKQogICAgIHsKICAgICAgICpfX3Jl
c3VsdCA9ICpfX2ZpcnN0MTsKICAgICAgICsrX19maXJzdDE7CiAgICAgfQogICBlbHNlIGlmIChf
X2NvbXAoX19maXJzdDIsIF9fZmlyc3QxKSkKICAgICB7CiAgICAgICAqX19yZXN1bHQgPSAqX19m
aXJzdDI7CiAgICAgICArK19fZmlyc3QyOwogICAgIH0KICAgZWxzZQogICAgIHsKICAgICAgICpf
X3Jlc3VsdCA9ICpfX2ZpcnN0MTsKICAgICAgICsrX19maXJzdDE7CiAgICAgICArK19fZmlyc3Qy
OwogICAgIH0KICAgKytfX3Jlc3VsdDsKIH0KICAgICAgcmV0dXJuIHN0ZDo6Y29weShfX2ZpcnN0
MiwgX19sYXN0MiwKICAgICAgICAgc3RkOjpjb3B5KF9fZmlyc3QxLCBfX2xhc3QxLCBfX3Jlc3Vs
dCkpOwogICAgfQojIDUwMDkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5o
IiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IxLCB0eXBlbmFtZSBfSW5wdXRJ
dGVyYXRvcjIsCiAgICB0eXBlbmFtZSBfT3V0cHV0SXRlcmF0b3I+CiAgICBpbmxpbmUgX091dHB1
dEl0ZXJhdG9yCiAgICBzZXRfdW5pb24oX0lucHV0SXRlcmF0b3IxIF9fZmlyc3QxLCBfSW5wdXRJ
dGVyYXRvcjEgX19sYXN0MSwKICAgICAgIF9JbnB1dEl0ZXJhdG9yMiBfX2ZpcnN0MiwgX0lucHV0
SXRlcmF0b3IyIF9fbGFzdDIsCiAgICAgICBfT3V0cHV0SXRlcmF0b3IgX19yZXN1bHQpCiAgICB7
CgogICAgIAogICAgIAogICAgIAoKICAgICAKCiAgICAgCgoKICAgICAKCgogICAgICA7CiAgICAg
IDsKICAgICAgOwogICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX3NldF91bmlvbihfX2ZpcnN0
MSwgX19sYXN0MSwKICAgIF9fZmlyc3QyLCBfX2xhc3QyLCBfX3Jlc3VsdCwKICAgIF9fZ251X2N4
eDo6X19vcHM6Ol9faXRlcl9sZXNzX2l0ZXIoKSk7CiAgICB9CiMgNTA1OCAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJ
dGVyYXRvcjEsIHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yMiwKICAgIHR5cGVuYW1lIF9PdXRwdXRJ
dGVyYXRvciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBpbmxpbmUgX091dHB1dEl0ZXJhdG9yCiAg
ICBzZXRfdW5pb24oX0lucHV0SXRlcmF0b3IxIF9fZmlyc3QxLCBfSW5wdXRJdGVyYXRvcjEgX19s
YXN0MSwKICAgICAgIF9JbnB1dEl0ZXJhdG9yMiBfX2ZpcnN0MiwgX0lucHV0SXRlcmF0b3IyIF9f
bGFzdDIsCiAgICAgICBfT3V0cHV0SXRlcmF0b3IgX19yZXN1bHQsIF9Db21wYXJlIF9fY29tcCkK
ICAgIHsKCiAgICAgCiAgICAgCiAgICAgCgogICAgIAoKICAgICAKCgogICAgIAoKCiAgICAgIDsK
ICAgICAgOwogICAgICA7CiAgICAgIDsKCiAgICAgIHJldHVybiBzdGQ6Ol9fc2V0X3VuaW9uKF9f
Zmlyc3QxLCBfX2xhc3QxLAogICAgX19maXJzdDIsIF9fbGFzdDIsIF9fcmVzdWx0LAogICAgX19n
bnVfY3h4OjpfX29wczo6X19pdGVyX2NvbXBfaXRlcihfX2NvbXApKTsKICAgIH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IxLCB0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcjIsCiAg
ICB0eXBlbmFtZSBfT3V0cHV0SXRlcmF0b3IsCiAgICB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIF9P
dXRwdXRJdGVyYXRvcgogICAgX19zZXRfaW50ZXJzZWN0aW9uKF9JbnB1dEl0ZXJhdG9yMSBfX2Zp
cnN0MSwgX0lucHV0SXRlcmF0b3IxIF9fbGFzdDEsCiAgICAgICAgIF9JbnB1dEl0ZXJhdG9yMiBf
X2ZpcnN0MiwgX0lucHV0SXRlcmF0b3IyIF9fbGFzdDIsCiAgICAgICAgIF9PdXRwdXRJdGVyYXRv
ciBfX3Jlc3VsdCwgX0NvbXBhcmUgX19jb21wKQogICAgewogICAgICB3aGlsZSAoX19maXJzdDEg
IT0gX19sYXN0MSAmJiBfX2ZpcnN0MiAhPSBfX2xhc3QyKQogaWYgKF9fY29tcChfX2ZpcnN0MSwg
X19maXJzdDIpKQogICArK19fZmlyc3QxOwogZWxzZSBpZiAoX19jb21wKF9fZmlyc3QyLCBfX2Zp
cnN0MSkpCiAgICsrX19maXJzdDI7CiBlbHNlCiAgIHsKICAgICAqX19yZXN1bHQgPSAqX19maXJz
dDE7CiAgICAgKytfX2ZpcnN0MTsKICAgICArK19fZmlyc3QyOwogICAgICsrX19yZXN1bHQ7CiAg
IH0KICAgICAgcmV0dXJuIF9fcmVzdWx0OwogICAgfQojIDUxMjggIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0
b3IxLCB0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcjIsCiAgICB0eXBlbmFtZSBfT3V0cHV0SXRlcmF0
b3I+CiAgICBpbmxpbmUgX091dHB1dEl0ZXJhdG9yCiAgICBzZXRfaW50ZXJzZWN0aW9uKF9JbnB1
dEl0ZXJhdG9yMSBfX2ZpcnN0MSwgX0lucHV0SXRlcmF0b3IxIF9fbGFzdDEsCiAgICAgICBfSW5w
dXRJdGVyYXRvcjIgX19maXJzdDIsIF9JbnB1dEl0ZXJhdG9yMiBfX2xhc3QyLAogICAgICAgX091
dHB1dEl0ZXJhdG9yIF9fcmVzdWx0KQogICAgewoKICAgICAKICAgICAKICAgICAKCiAgICAgCgoK
ICAgICAKCgogICAgICA7CiAgICAgIDsKICAgICAgOwogICAgICA7CgogICAgICByZXR1cm4gc3Rk
OjpfX3NldF9pbnRlcnNlY3Rpb24oX19maXJzdDEsIF9fbGFzdDEsCiAgICAgICAgIF9fZmlyc3Qy
LCBfX2xhc3QyLCBfX3Jlc3VsdCwKICAgICAgICAgX19nbnVfY3h4OjpfX29wczo6X19pdGVyX2xl
c3NfaXRlcigpKTsKICAgIH0KIyA1MTc2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3Rs
X2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yMSwgdHlwZW5hbWUg
X0lucHV0SXRlcmF0b3IyLAogICAgdHlwZW5hbWUgX091dHB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBf
Q29tcGFyZT4KICAgIGlubGluZSBfT3V0cHV0SXRlcmF0b3IKICAgIHNldF9pbnRlcnNlY3Rpb24o
X0lucHV0SXRlcmF0b3IxIF9fZmlyc3QxLCBfSW5wdXRJdGVyYXRvcjEgX19sYXN0MSwKICAgICAg
IF9JbnB1dEl0ZXJhdG9yMiBfX2ZpcnN0MiwgX0lucHV0SXRlcmF0b3IyIF9fbGFzdDIsCiAgICAg
ICBfT3V0cHV0SXRlcmF0b3IgX19yZXN1bHQsIF9Db21wYXJlIF9fY29tcCkKICAgIHsKCiAgICAg
CiAgICAgCiAgICAgCgogICAgIAoKCiAgICAgCgoKICAgICAgOwogICAgICA7CiAgICAgIDsKICAg
ICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19zZXRfaW50ZXJzZWN0aW9uKF9fZmlyc3QxLCBfX2xh
c3QxLAogICAgX19maXJzdDIsIF9fbGFzdDIsIF9fcmVzdWx0LAogICAgX19nbnVfY3h4OjpfX29w
czo6X19pdGVyX2NvbXBfaXRlcihfX2NvbXApKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0lucHV0SXRlcmF0b3IxLCB0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcjIsCiAgICB0eXBlbmFtZSBf
T3V0cHV0SXRlcmF0b3IsCiAgICB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIF9PdXRwdXRJdGVyYXRv
cgogICAgX19zZXRfZGlmZmVyZW5jZShfSW5wdXRJdGVyYXRvcjEgX19maXJzdDEsIF9JbnB1dEl0
ZXJhdG9yMSBfX2xhc3QxLAogICAgICAgX0lucHV0SXRlcmF0b3IyIF9fZmlyc3QyLCBfSW5wdXRJ
dGVyYXRvcjIgX19sYXN0MiwKICAgICAgIF9PdXRwdXRJdGVyYXRvciBfX3Jlc3VsdCwgX0NvbXBh
cmUgX19jb21wKQogICAgewogICAgICB3aGlsZSAoX19maXJzdDEgIT0gX19sYXN0MSAmJiBfX2Zp
cnN0MiAhPSBfX2xhc3QyKQogaWYgKF9fY29tcChfX2ZpcnN0MSwgX19maXJzdDIpKQogICB7CiAg
ICAgKl9fcmVzdWx0ID0gKl9fZmlyc3QxOwogICAgICsrX19maXJzdDE7CiAgICAgKytfX3Jlc3Vs
dDsKICAgfQogZWxzZSBpZiAoX19jb21wKF9fZmlyc3QyLCBfX2ZpcnN0MSkpCiAgICsrX19maXJz
dDI7CiBlbHNlCiAgIHsKICAgICArK19fZmlyc3QxOwogICAgICsrX19maXJzdDI7CiAgIH0KICAg
ICAgcmV0dXJuIHN0ZDo6Y29weShfX2ZpcnN0MSwgX19sYXN0MSwgX19yZXN1bHQpOwogICAgfQoj
IDUyNDggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYWxnby5oIiAzCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IxLCB0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcjIsCiAg
ICB0eXBlbmFtZSBfT3V0cHV0SXRlcmF0b3I+CiAgICBpbmxpbmUgX091dHB1dEl0ZXJhdG9yCiAg
ICBzZXRfZGlmZmVyZW5jZShfSW5wdXRJdGVyYXRvcjEgX19maXJzdDEsIF9JbnB1dEl0ZXJhdG9y
MSBfX2xhc3QxLAogICAgIF9JbnB1dEl0ZXJhdG9yMiBfX2ZpcnN0MiwgX0lucHV0SXRlcmF0b3Iy
IF9fbGFzdDIsCiAgICAgX091dHB1dEl0ZXJhdG9yIF9fcmVzdWx0KQogICAgewoKICAgICAKICAg
ICAKICAgICAKCiAgICAgCgoKICAgICAKCgogICAgICA7CiAgICAgIDsKICAgICAgOwogICAgICA7
CgogICAgICByZXR1cm4gc3RkOjpfX3NldF9kaWZmZXJlbmNlKF9fZmlyc3QxLCBfX2xhc3QxLAog
ICAgICAgX19maXJzdDIsIF9fbGFzdDIsIF9fcmVzdWx0LAogICAgICAgX19nbnVfY3h4OjpfX29w
czo6X19pdGVyX2xlc3NfaXRlcigpKTsKICAgIH0KIyA1Mjk4ICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvc3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9y
MSwgdHlwZW5hbWUgX0lucHV0SXRlcmF0b3IyLAogICAgdHlwZW5hbWUgX091dHB1dEl0ZXJhdG9y
LCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgIGlubGluZSBfT3V0cHV0SXRlcmF0b3IKICAgIHNldF9k
aWZmZXJlbmNlKF9JbnB1dEl0ZXJhdG9yMSBfX2ZpcnN0MSwgX0lucHV0SXRlcmF0b3IxIF9fbGFz
dDEsCiAgICAgX0lucHV0SXRlcmF0b3IyIF9fZmlyc3QyLCBfSW5wdXRJdGVyYXRvcjIgX19sYXN0
MiwKICAgICBfT3V0cHV0SXRlcmF0b3IgX19yZXN1bHQsIF9Db21wYXJlIF9fY29tcCkKICAgIHsK
CiAgICAgCiAgICAgCiAgICAgCgogICAgIAoKCiAgICAgCgoKICAgICAgOwogICAgICA7CiAgICAg
IDsKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19zZXRfZGlmZmVyZW5jZShfX2ZpcnN0MSwg
X19sYXN0MSwKICAgICAgIF9fZmlyc3QyLCBfX2xhc3QyLCBfX3Jlc3VsdCwKICAgICAgIF9fZ251
X2N4eDo6X19vcHM6Ol9faXRlcl9jb21wX2l0ZXIoX19jb21wKSk7CiAgICB9CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yMSwgdHlwZW5hbWUgX0lucHV0SXRlcmF0b3IyLAogICAg
dHlwZW5hbWUgX091dHB1dEl0ZXJhdG9yLAogICAgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBfT3V0
cHV0SXRlcmF0b3IKICAgIF9fc2V0X3N5bW1ldHJpY19kaWZmZXJlbmNlKF9JbnB1dEl0ZXJhdG9y
MSBfX2ZpcnN0MSwKICAgICAgICAgIF9JbnB1dEl0ZXJhdG9yMSBfX2xhc3QxLAogICAgICAgICAg
X0lucHV0SXRlcmF0b3IyIF9fZmlyc3QyLAogICAgICAgICAgX0lucHV0SXRlcmF0b3IyIF9fbGFz
dDIsCiAgICAgICAgICBfT3V0cHV0SXRlcmF0b3IgX19yZXN1bHQsCiAgICAgICAgICBfQ29tcGFy
ZSBfX2NvbXApCiAgICB7CiAgICAgIHdoaWxlIChfX2ZpcnN0MSAhPSBfX2xhc3QxICYmIF9fZmly
c3QyICE9IF9fbGFzdDIpCiBpZiAoX19jb21wKF9fZmlyc3QxLCBfX2ZpcnN0MikpCiAgIHsKICAg
ICAqX19yZXN1bHQgPSAqX19maXJzdDE7CiAgICAgKytfX2ZpcnN0MTsKICAgICArK19fcmVzdWx0
OwogICB9CiBlbHNlIGlmIChfX2NvbXAoX19maXJzdDIsIF9fZmlyc3QxKSkKICAgewogICAgICpf
X3Jlc3VsdCA9ICpfX2ZpcnN0MjsKICAgICArK19fZmlyc3QyOwogICAgICsrX19yZXN1bHQ7CiAg
IH0KIGVsc2UKICAgewogICAgICsrX19maXJzdDE7CiAgICAgKytfX2ZpcnN0MjsKICAgfQogICAg
ICByZXR1cm4gc3RkOjpjb3B5KF9fZmlyc3QyLCBfX2xhc3QyLAogICAgICAgICBzdGQ6OmNvcHko
X19maXJzdDEsIF9fbGFzdDEsIF9fcmVzdWx0KSk7CiAgICB9CiMgNTM3NiAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJ
dGVyYXRvcjEsIHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yMiwKICAgIHR5cGVuYW1lIF9PdXRwdXRJ
dGVyYXRvcj4KICAgIGlubGluZSBfT3V0cHV0SXRlcmF0b3IKICAgIHNldF9zeW1tZXRyaWNfZGlm
ZmVyZW5jZShfSW5wdXRJdGVyYXRvcjEgX19maXJzdDEsIF9JbnB1dEl0ZXJhdG9yMSBfX2xhc3Qx
LAogICAgICAgIF9JbnB1dEl0ZXJhdG9yMiBfX2ZpcnN0MiwgX0lucHV0SXRlcmF0b3IyIF9fbGFz
dDIsCiAgICAgICAgX091dHB1dEl0ZXJhdG9yIF9fcmVzdWx0KQogICAgewoKICAgICAKICAgICAK
ICAgICAKCiAgICAgCgogICAgIAoKCiAgICAgCgoKICAgICAgOwogICAgICA7CiAgICAgIDsKICAg
ICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19zZXRfc3ltbWV0cmljX2RpZmZlcmVuY2UoX19maXJz
dDEsIF9fbGFzdDEsCiAgICAgX19maXJzdDIsIF9fbGFzdDIsIF9fcmVzdWx0LAogICAgIF9fZ251
X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNzX2l0ZXIoKSk7CiAgICB9CiMgNTQyNiAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5w
dXRJdGVyYXRvcjEsIHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yMiwKICAgIHR5cGVuYW1lIF9PdXRw
dXRJdGVyYXRvciwgdHlwZW5hbWUgX0NvbXBhcmU+CiAgICBpbmxpbmUgX091dHB1dEl0ZXJhdG9y
CiAgICBzZXRfc3ltbWV0cmljX2RpZmZlcmVuY2UoX0lucHV0SXRlcmF0b3IxIF9fZmlyc3QxLCBf
SW5wdXRJdGVyYXRvcjEgX19sYXN0MSwKICAgICAgICBfSW5wdXRJdGVyYXRvcjIgX19maXJzdDIs
IF9JbnB1dEl0ZXJhdG9yMiBfX2xhc3QyLAogICAgICAgIF9PdXRwdXRJdGVyYXRvciBfX3Jlc3Vs
dCwKICAgICAgICBfQ29tcGFyZSBfX2NvbXApCiAgICB7CgogICAgIAogICAgIAogICAgIAoKICAg
ICAKCiAgICAgCgoKICAgICAKCgogICAgICA7CiAgICAgIDsKICAgICAgOwogICAgICA7CgogICAg
ICByZXR1cm4gc3RkOjpfX3NldF9zeW1tZXRyaWNfZGlmZmVyZW5jZShfX2ZpcnN0MSwgX19sYXN0
MSwKICAgIF9fZmlyc3QyLCBfX2xhc3QyLCBfX3Jlc3VsdCwKICAgIF9fZ251X2N4eDo6X19vcHM6
Ol9faXRlcl9jb21wX2l0ZXIoX19jb21wKSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9G
b3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9Db21wYXJlPgogICAKICAgIF9Gb3J3YXJkSXRlcmF0
b3IKICAgIF9fbWluX2VsZW1lbnQoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0
ZXJhdG9yIF9fbGFzdCwKICAgIF9Db21wYXJlIF9fY29tcCkKICAgIHsKICAgICAgaWYgKF9fZmly
c3QgPT0gX19sYXN0KQogcmV0dXJuIF9fZmlyc3Q7CiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19y
ZXN1bHQgPSBfX2ZpcnN0OwogICAgICB3aGlsZSAoKytfX2ZpcnN0ICE9IF9fbGFzdCkKIGlmIChf
X2NvbXAoX19maXJzdCwgX19yZXN1bHQpKQogICBfX3Jlc3VsdCA9IF9fZmlyc3Q7CiAgICAgIHJl
dHVybiBfX3Jlc3VsdDsKICAgIH0KIyA1NDc5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
c3RsX2FsZ28uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3I+CiAgIAog
ICAgX0ZvcndhcmRJdGVyYXRvcgogICAgaW5saW5lIG1pbl9lbGVtZW50KF9Gb3J3YXJkSXRlcmF0
b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QpCiAgICB7CgogICAgIAogICAgIAoK
ICAgICAgOwogICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX21pbl9lbGVtZW50KF9fZmlyc3Qs
IF9fbGFzdCwKICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNzX2l0ZXIoKSk7CiAgICB9
CiMgNTUwNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgCiAg
ICBpbmxpbmUgX0ZvcndhcmRJdGVyYXRvcgogICAgbWluX2VsZW1lbnQoX0ZvcndhcmRJdGVyYXRv
ciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICBfQ29tcGFyZSBfX2NvbXApCiAg
ICB7CgogICAgIAogICAgIAoKCiAgICAgIDsKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19t
aW5fZWxlbWVudChfX2ZpcnN0LCBfX2xhc3QsCiAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJf
Y29tcF9pdGVyKF9fY29tcCkpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0
ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgCiAgICBfRm9yd2FyZEl0ZXJhdG9yCiAgICBf
X21heF9lbGVtZW50KF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBf
X2xhc3QsCiAgICBfQ29tcGFyZSBfX2NvbXApCiAgICB7CiAgICAgIGlmIChfX2ZpcnN0ID09IF9f
bGFzdCkgcmV0dXJuIF9fZmlyc3Q7CiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19yZXN1bHQgPSBf
X2ZpcnN0OwogICAgICB3aGlsZSAoKytfX2ZpcnN0ICE9IF9fbGFzdCkKIGlmIChfX2NvbXAoX19y
ZXN1bHQsIF9fZmlyc3QpKQogICBfX3Jlc3VsdCA9IF9fZmlyc3Q7CiAgICAgIHJldHVybiBfX3Jl
c3VsdDsKICAgIH0KIyA1NTQzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2FsZ28u
aCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3I+CiAgIAogICAgaW5saW5l
IF9Gb3J3YXJkSXRlcmF0b3IKICAgIG1heF9lbGVtZW50KF9Gb3J3YXJkSXRlcmF0b3IgX19maXJz
dCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QpCiAgICB7CgogICAgIAogICAgIAoKICAgICAgOwog
ICAgICA7CgogICAgICByZXR1cm4gc3RkOjpfX21heF9lbGVtZW50KF9fZmlyc3QsIF9fbGFzdCwK
ICAgIF9fZ251X2N4eDo6X19vcHM6Ol9faXRlcl9sZXNzX2l0ZXIoKSk7CiAgICB9CiMgNTU2OCAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9hbGdvLmgiIDMKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfQ29tcGFyZT4KICAgCiAgICBpbmxpbmUg
X0ZvcndhcmRJdGVyYXRvcgogICAgbWF4X2VsZW1lbnQoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0
LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICBfQ29tcGFyZSBfX2NvbXApCiAgICB7CgogICAg
IAogICAgIAoKCiAgICAgIDsKICAgICAgOwoKICAgICAgcmV0dXJuIHN0ZDo6X19tYXhfZWxlbWVu
dChfX2ZpcnN0LCBfX2xhc3QsCiAgICBfX2dudV9jeHg6Ol9fb3BzOjpfX2l0ZXJfY29tcF9pdGVy
KF9fY29tcCkpOwogICAgfQoKCn0KIyA2MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9hbGdvcml0
aG0iIDIgMwojIDI4ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0z
LjIuMS9zcmMvWURpYWxvZy5jYyIgMgoKCiMgMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVp
LWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lVSUxvZy5oIiAxCiMgMzEgIi9ob21lL3NoYXJrY3ov
bGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZVUlMb2cuaCIKIyAxICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2lvc3RyZWFtIiAxIDMKIyAzNiAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9pb3N0cmVhbSIgMwogICAgICAgCiMgMzcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaW9z
dHJlYW0iIDMKCgojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvb3N0cmVhbSIgMSAzCiMgMzYg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvb3N0cmVhbSIgMwogICAgICAgCiMgMzcgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvb3N0cmVhbSIgMwoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2lv
cyIgMSAzCiMgMzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaW9zIiAzCiAgICAgICAKIyAzNyAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9pb3MiIDMKCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9pb3Nmd2QiIDEgMwojIDM2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2lvc2Z3ZCIgMwogICAg
ICAgCiMgMzcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaW9zZndkIiAzCgoKIyAxICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RyaW5nZndkLmgiIDEgMwojIDM3ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RyaW5nZndkLmgiIDMKICAgICAgIAojIDM4ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RyaW5nZndkLmgiIDMKCgoKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1
dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCgoKCgoKCiAgdGVtcGxhdGU8
Y2xhc3MgX0NoYXJUPgogICAgc3RydWN0IGNoYXJfdHJhaXRzOwoKICB0ZW1wbGF0ZTw+IHN0cnVj
dCBjaGFyX3RyYWl0czxjaGFyPjsKCgogIHRlbXBsYXRlPD4gc3RydWN0IGNoYXJfdHJhaXRzPHdj
aGFyX3Q+OwoKCgoKICB0ZW1wbGF0ZTw+IHN0cnVjdCBjaGFyX3RyYWl0czxjaGFyMTZfdD47CiAg
dGVtcGxhdGU8PiBzdHJ1Y3QgY2hhcl90cmFpdHM8Y2hhcjMyX3Q+OwoKCm5hbWVzcGFjZSBfX2N4
eDExIHsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzID0gY2hh
cl90cmFpdHM8X0NoYXJUPiwKICAgICAgICAgICB0eXBlbmFtZSBfQWxsb2MgPSBhbGxvY2F0b3I8
X0NoYXJUPiA+CiAgICBjbGFzcyBiYXNpY19zdHJpbmc7CgoKICB0eXBlZGVmIGJhc2ljX3N0cmlu
ZzxjaGFyPiBzdHJpbmc7CgoKCiAgdHlwZWRlZiBiYXNpY19zdHJpbmc8d2NoYXJfdD4gd3N0cmlu
ZzsKCgoKCgogIHR5cGVkZWYgYmFzaWNfc3RyaW5nPGNoYXIxNl90PiB1MTZzdHJpbmc7CgoKICB0
eXBlZGVmIGJhc2ljX3N0cmluZzxjaGFyMzJfdD4gdTMyc3RyaW5nOwoKCn0KCgoKCn0KIyA0MCAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9pb3Nmd2QiIDIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9wb3N0eXBlcy5oIiAxIDMKIyAzOCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3Bvc3R5cGVzLmgiIDMKICAgICAgIAojIDM5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvcG9zdHlwZXMuaCIgMwoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2N3Y2hhciIgMSAz
CiMgMzkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3djaGFyIiAzCiAgICAgICAKIyA0MCAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9jd2NoYXIiIDMKCgoKCiMgMSAiL3Vzci9pbmNsdWRlL3djaGFy
LmgiIDEgMyA0CiMgMzYgIi91c3IvaW5jbHVkZS93Y2hhci5oIiAzIDQKIyAxICIvdXNyL2luY2x1
ZGUvc3RkaW8uaCIgMSAzIDQKIyA0NCAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDMgNApzdHJ1Y3Qg
X0lPX0ZJTEU7CgoKCnR5cGVkZWYgc3RydWN0IF9JT19GSUxFIEZJTEU7CgoKCgoKIyA2NCAiL3Vz
ci9pbmNsdWRlL3N0ZGlvLmgiIDMgNAp0eXBlZGVmIHN0cnVjdCBfSU9fRklMRSBfX0ZJTEU7CiMg
MzcgIi91c3IvaW5jbHVkZS93Y2hhci5oIiAyIDMgNAoKCiMgMSAiL3Vzci9saWIvZ2NjL3MzOTB4
LXJlZGhhdC1saW51eC82LjAuMC9pbmNsdWRlL3N0ZGFyZy5oIiAxIDMgNAojIDQwICIvdXNyL2xp
Yi9nY2MvczM5MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkYXJnLmgiIDMgNAp0eXBl
ZGVmIF9fYnVpbHRpbl92YV9saXN0IF9fZ251Y192YV9saXN0OwojIDQwICIvdXNyL2luY2x1ZGUv
d2NoYXIuaCIgMiAzIDQKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvd2NoYXIuaCIgMSAzIDQKIyA0
MiAiL3Vzci9pbmNsdWRlL3djaGFyLmgiIDIgMyA0CiMgNTEgIi91c3IvaW5jbHVkZS93Y2hhci5o
IiAzIDQKIyAxICIvdXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUv
c3RkZGVmLmgiIDEgMyA0CiMgMzU3ICIvdXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0LWxpbnV4LzYu
MC4wL2luY2x1ZGUvc3RkZGVmLmgiIDMgNAp0eXBlZGVmIHVuc2lnbmVkIGludCB3aW50X3Q7CiMg
NTIgIi91c3IvaW5jbHVkZS93Y2hhci5oIiAyIDMgNAojIDgyICIvdXNyL2luY2x1ZGUvd2NoYXIu
aCIgMyA0CnR5cGVkZWYgc3RydWN0CnsKICBpbnQgX19jb3VudDsKICB1bmlvbgogIHsKCiAgICB1
bnNpZ25lZCBpbnQgX193Y2g7CgoKCiAgICBjaGFyIF9fd2NoYls0XTsKICB9IF9fdmFsdWU7Cn0g
X19tYnN0YXRlX3Q7CiMgMTA0ICIvdXNyL2luY2x1ZGUvd2NoYXIuaCIgMyA0CgoKdHlwZWRlZiBf
X21ic3RhdGVfdCBtYnN0YXRlX3Q7CgoKCgoKCiMgMTMyICIvdXNyL2luY2x1ZGUvd2NoYXIuaCIg
MyA0CmV4dGVybiAiQyIgewoKCgoKc3RydWN0IHRtOwoKCgoKCgoKCgpleHRlcm4gd2NoYXJfdCAq
d2NzY3B5ICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZGVzdCwKICAgY29uc3Qgd2NoYXJfdCAqX19y
ZXN0cmljdCBfX3NyYykKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g
KDEsIDIpKSk7CgoKZXh0ZXJuIHdjaGFyX3QgKndjc25jcHkgKHdjaGFyX3QgKl9fcmVzdHJpY3Qg
X19kZXN0LAogICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbikK
ICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKZXh0
ZXJuIHdjaGFyX3QgKndjc2NhdCAod2NoYXJfdCAqX19yZXN0cmljdCBfX2Rlc3QsCiAgIGNvbnN0
IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19zcmMpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAo
KF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKZXh0ZXJuIHdjaGFyX3QgKndjc25jYXQgKHdjaGFyX3Qg
Kl9fcmVzdHJpY3QgX19kZXN0LAogICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX3NyYywg
c2l6ZV90IF9fbikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEs
IDIpKSk7CgoKZXh0ZXJuIGludCB3Y3NjbXAgKGNvbnN0IHdjaGFyX3QgKl9fczEsIGNvbnN0IHdj
aGFyX3QgKl9fczIpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSkgX19h
dHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKZXh0ZXJuIGludCB3Y3NuY21wIChj
b25zdCB3Y2hhcl90ICpfX3MxLCBjb25zdCB3Y2hhcl90ICpfX3MyLCBzaXplX3QgX19uKQogICAg
IHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMSwgMikpKTsKCgoKCmV4dGVybiBpbnQgd2NzY2FzZWNtcCAoY29uc3Qgd2NoYXJf
dCAqX19zMSwgY29uc3Qgd2NoYXJfdCAqX19zMikgdGhyb3cgKCk7CgoKZXh0ZXJuIGludCB3Y3Nu
Y2FzZWNtcCAoY29uc3Qgd2NoYXJfdCAqX19zMSwgY29uc3Qgd2NoYXJfdCAqX19zMiwKICAgc2l6
ZV90IF9fbikgdGhyb3cgKCk7CgoKCgoKZXh0ZXJuIGludCB3Y3NjYXNlY21wX2wgKGNvbnN0IHdj
aGFyX3QgKl9fczEsIGNvbnN0IHdjaGFyX3QgKl9fczIsCiAgICBfX2xvY2FsZV90IF9fbG9jKSB0
aHJvdyAoKTsKCmV4dGVybiBpbnQgd2NzbmNhc2VjbXBfbCAoY29uc3Qgd2NoYXJfdCAqX19zMSwg
Y29uc3Qgd2NoYXJfdCAqX19zMiwKICAgICBzaXplX3QgX19uLCBfX2xvY2FsZV90IF9fbG9jKSB0
aHJvdyAoKTsKCgoKCgpleHRlcm4gaW50IHdjc2NvbGwgKGNvbnN0IHdjaGFyX3QgKl9fczEsIGNv
bnN0IHdjaGFyX3QgKl9fczIpIHRocm93ICgpOwoKCgpleHRlcm4gc2l6ZV90IHdjc3hmcm0gKHdj
aGFyX3QgKl9fcmVzdHJpY3QgX19zMSwKICAgICAgICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmlj
dCBfX3MyLCBzaXplX3QgX19uKSB0aHJvdyAoKTsKCgoKCgoKCgpleHRlcm4gaW50IHdjc2NvbGxf
bCAoY29uc3Qgd2NoYXJfdCAqX19zMSwgY29uc3Qgd2NoYXJfdCAqX19zMiwKICAgICAgICBfX2xv
Y2FsZV90IF9fbG9jKSB0aHJvdyAoKTsKCgoKCmV4dGVybiBzaXplX3Qgd2NzeGZybV9sICh3Y2hh
cl90ICpfX3MxLCBjb25zdCB3Y2hhcl90ICpfX3MyLAogICAgc2l6ZV90IF9fbiwgX19sb2NhbGVf
dCBfX2xvYykgdGhyb3cgKCk7CgoKZXh0ZXJuIHdjaGFyX3QgKndjc2R1cCAoY29uc3Qgd2NoYXJf
dCAqX19zKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19tYWxsb2NfXykpOwoKCgoKCmV4dGVy
biAiQysrIiB3Y2hhcl90ICp3Y3NjaHIgKHdjaGFyX3QgKl9fd2NzLCB3Y2hhcl90IF9fd2MpCiAg
ICAgdGhyb3cgKCkgX19hc20gKCJ3Y3NjaHIiKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKTsK
ZXh0ZXJuICJDKysiIGNvbnN0IHdjaGFyX3QgKndjc2NociAoY29uc3Qgd2NoYXJfdCAqX193Y3Ms
IHdjaGFyX3QgX193YykKICAgICB0aHJvdyAoKSBfX2FzbSAoIndjc2NociIpIF9fYXR0cmlidXRl
X18gKChfX3B1cmVfXykpOwoKCgoKCgpleHRlcm4gIkMrKyIgd2NoYXJfdCAqd2NzcmNociAod2No
YXJfdCAqX193Y3MsIHdjaGFyX3QgX193YykKICAgICB0aHJvdyAoKSBfX2FzbSAoIndjc3JjaHIi
KSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKTsKZXh0ZXJuICJDKysiIGNvbnN0IHdjaGFyX3Qg
Kndjc3JjaHIgKGNvbnN0IHdjaGFyX3QgKl9fd2NzLCB3Y2hhcl90IF9fd2MpCiAgICAgdGhyb3cg
KCkgX19hc20gKCJ3Y3NyY2hyIikgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSk7CgoKCgoKCgoK
CmV4dGVybiB3Y2hhcl90ICp3Y3NjaHJudWwgKGNvbnN0IHdjaGFyX3QgKl9fcywgd2NoYXJfdCBf
X3djKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpOwoKCgoKCmV4dGVy
biBzaXplX3Qgd2NzY3NwbiAoY29uc3Qgd2NoYXJfdCAqX193Y3MsIGNvbnN0IHdjaGFyX3QgKl9f
cmVqZWN0KQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpOwoKCmV4dGVy
biBzaXplX3Qgd2Nzc3BuIChjb25zdCB3Y2hhcl90ICpfX3djcywgY29uc3Qgd2NoYXJfdCAqX19h
Y2NlcHQpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSk7CgoKZXh0ZXJu
ICJDKysiIHdjaGFyX3QgKndjc3BicmsgKHdjaGFyX3QgKl9fd2NzLCBjb25zdCB3Y2hhcl90ICpf
X2FjY2VwdCkKICAgICB0aHJvdyAoKSBfX2FzbSAoIndjc3BicmsiKSBfX2F0dHJpYnV0ZV9fICgo
X19wdXJlX18pKTsKZXh0ZXJuICJDKysiIGNvbnN0IHdjaGFyX3QgKndjc3BicmsgKGNvbnN0IHdj
aGFyX3QgKl9fd2NzLAogICAgICAgICBjb25zdCB3Y2hhcl90ICpfX2FjY2VwdCkKICAgICB0aHJv
dyAoKSBfX2FzbSAoIndjc3BicmsiKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKTsKCgoKCgoK
ZXh0ZXJuICJDKysiIHdjaGFyX3QgKndjc3N0ciAod2NoYXJfdCAqX19oYXlzdGFjaywgY29uc3Qg
d2NoYXJfdCAqX19uZWVkbGUpCiAgICAgdGhyb3cgKCkgX19hc20gKCJ3Y3NzdHIiKSBfX2F0dHJp
YnV0ZV9fICgoX19wdXJlX18pKTsKZXh0ZXJuICJDKysiIGNvbnN0IHdjaGFyX3QgKndjc3N0ciAo
Y29uc3Qgd2NoYXJfdCAqX19oYXlzdGFjaywKICAgICAgICBjb25zdCB3Y2hhcl90ICpfX25lZWRs
ZSkKICAgICB0aHJvdyAoKSBfX2FzbSAoIndjc3N0ciIpIF9fYXR0cmlidXRlX18gKChfX3B1cmVf
XykpOwoKCgoKCgpleHRlcm4gd2NoYXJfdCAqd2NzdG9rICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9f
cywKICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX2RlbGltLAogICB3Y2hhcl90ICoqX19y
ZXN0cmljdCBfX3B0cikgdGhyb3cgKCk7CgoKZXh0ZXJuIHNpemVfdCB3Y3NsZW4gKGNvbnN0IHdj
aGFyX3QgKl9fcykgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSk7CgoKCgoKZXh0
ZXJuICJDKysiIHdjaGFyX3QgKndjc3djcyAod2NoYXJfdCAqX19oYXlzdGFjaywgY29uc3Qgd2No
YXJfdCAqX19uZWVkbGUpCiAgICAgdGhyb3cgKCkgX19hc20gKCJ3Y3N3Y3MiKSBfX2F0dHJpYnV0
ZV9fICgoX19wdXJlX18pKTsKZXh0ZXJuICJDKysiIGNvbnN0IHdjaGFyX3QgKndjc3djcyAoY29u
c3Qgd2NoYXJfdCAqX19oYXlzdGFjaywKICAgICAgICBjb25zdCB3Y2hhcl90ICpfX25lZWRsZSkK
ICAgICB0aHJvdyAoKSBfX2FzbSAoIndjc3djcyIpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykp
OwojIDMwOSAiL3Vzci9pbmNsdWRlL3djaGFyLmgiIDMgNApleHRlcm4gc2l6ZV90IHdjc25sZW4g
KGNvbnN0IHdjaGFyX3QgKl9fcywgc2l6ZV90IF9fbWF4bGVuKQogICAgIHRocm93ICgpIF9fYXR0
cmlidXRlX18gKChfX3B1cmVfXykpOwoKCgoKCgpleHRlcm4gIkMrKyIgd2NoYXJfdCAqd21lbWNo
ciAod2NoYXJfdCAqX19zLCB3Y2hhcl90IF9fYywgc2l6ZV90IF9fbikKICAgICB0aHJvdyAoKSBf
X2FzbSAoIndtZW1jaHIiKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKTsKZXh0ZXJuICJDKysi
IGNvbnN0IHdjaGFyX3QgKndtZW1jaHIgKGNvbnN0IHdjaGFyX3QgKl9fcywgd2NoYXJfdCBfX2Ms
CiAgICAgICAgIHNpemVfdCBfX24pCiAgICAgdGhyb3cgKCkgX19hc20gKCJ3bWVtY2hyIikgX19h
dHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSk7CgoKCgoKCmV4dGVybiBpbnQgd21lbWNtcCAoY29uc3Qg
d2NoYXJfdCAqX19zMSwgY29uc3Qgd2NoYXJfdCAqX19zMiwgc2l6ZV90IF9fbikKICAgICB0aHJv
dyAoKSBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKTsKCgpleHRlcm4gd2NoYXJfdCAqd21lbWNw
eSAod2NoYXJfdCAqX19yZXN0cmljdCBfX3MxLAogICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmlj
dCBfX3MyLCBzaXplX3QgX19uKSB0aHJvdyAoKTsKCgoKZXh0ZXJuIHdjaGFyX3QgKndtZW1tb3Zl
ICh3Y2hhcl90ICpfX3MxLCBjb25zdCB3Y2hhcl90ICpfX3MyLCBzaXplX3QgX19uKQogICAgIHRo
cm93ICgpOwoKCmV4dGVybiB3Y2hhcl90ICp3bWVtc2V0ICh3Y2hhcl90ICpfX3MsIHdjaGFyX3Qg
X19jLCBzaXplX3QgX19uKSB0aHJvdyAoKTsKCgoKCgpleHRlcm4gd2NoYXJfdCAqd21lbXBjcHkg
KHdjaGFyX3QgKl9fcmVzdHJpY3QgX19zMSwKICAgICBjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0
IF9fczIsIHNpemVfdCBfX24pCiAgICAgdGhyb3cgKCk7CgoKCgoKCmV4dGVybiB3aW50X3QgYnRv
d2MgKGludCBfX2MpIHRocm93ICgpOwoKCgpleHRlcm4gaW50IHdjdG9iICh3aW50X3QgX19jKSB0
aHJvdyAoKTsKCgoKZXh0ZXJuIGludCBtYnNpbml0IChjb25zdCBtYnN0YXRlX3QgKl9fcHMpIHRo
cm93ICgpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpOwoKCgpleHRlcm4gc2l6ZV90IG1icnRv
d2MgKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19wd2MsCiAgICAgICAgIGNvbnN0IGNoYXIgKl9fcmVz
dHJpY3QgX19zLCBzaXplX3QgX19uLAogICAgICAgICBtYnN0YXRlX3QgKl9fcmVzdHJpY3QgX19w
KSB0aHJvdyAoKTsKCgpleHRlcm4gc2l6ZV90IHdjcnRvbWIgKGNoYXIgKl9fcmVzdHJpY3QgX19z
LCB3Y2hhcl90IF9fd2MsCiAgICAgICAgIG1ic3RhdGVfdCAqX19yZXN0cmljdCBfX3BzKSB0aHJv
dyAoKTsKCgpleHRlcm4gc2l6ZV90IF9fbWJybGVuIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9f
cywgc2l6ZV90IF9fbiwKICAgbWJzdGF0ZV90ICpfX3Jlc3RyaWN0IF9fcHMpIHRocm93ICgpOwpl
eHRlcm4gc2l6ZV90IG1icmxlbiAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3MsIHNpemVfdCBf
X24sCiAgICAgICAgbWJzdGF0ZV90ICpfX3Jlc3RyaWN0IF9fcHMpIHRocm93ICgpOwoKCgoKCgoK
CmV4dGVybiB3aW50X3QgX19idG93Y19hbGlhcyAoaW50IF9fYykgX19hc20gKCJidG93YyIpOwpl
eHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgd2ludF90Cl9f
YXR0cmlidXRlX18gKChfX2xlYWZfXykpIGJ0b3djIChpbnQgX19jKSB0aHJvdyAoKQp7IHJldHVy
biAoX19idWlsdGluX2NvbnN0YW50X3AgKF9fYykgJiYgX19jID49ICdcMCcgJiYgX19jIDw9ICdc
eDdmJwogICA/ICh3aW50X3QpIF9fYyA6IF9fYnRvd2NfYWxpYXMgKF9fYykpOyB9CgpleHRlcm4g
aW50IF9fd2N0b2JfYWxpYXMgKHdpbnRfdCBfX2MpIF9fYXNtICgid2N0b2IiKTsKZXh0ZXJuIF9f
aW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGludApfX2F0dHJpYnV0ZV9f
ICgoX19sZWFmX18pKSB3Y3RvYiAod2ludF90IF9fd2MpIHRocm93ICgpCnsgcmV0dXJuIChfX2J1
aWx0aW5fY29uc3RhbnRfcCAoX193YykgJiYgX193YyA+PSBMJ1wwJyAmJiBfX3djIDw9IEwnXHg3
ZicKICAgPyAoaW50KSBfX3djIDogX193Y3RvYl9hbGlhcyAoX193YykpOyB9CgpleHRlcm4gX19p
bmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgc2l6ZV90Cl9fYXR0cmlidXRl
X18gKChfX2xlYWZfXykpIG1icmxlbiAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3MsIHNpemVf
dCBfX24sIG1ic3RhdGVfdCAqX19yZXN0cmljdCBfX3BzKSB0aHJvdyAoKQoKeyByZXR1cm4gKF9f
cHMgIT0gX19udWxsCiAgID8gbWJydG93YyAoX19udWxsLCBfX3MsIF9fbiwgX19wcykgOiBfX21i
cmxlbiAoX19zLCBfX24sIF9fbnVsbCkpOyB9CgoKCgoKZXh0ZXJuIHNpemVfdCBtYnNydG93Y3Mg
KHdjaGFyX3QgKl9fcmVzdHJpY3QgX19kc3QsCiAgICBjb25zdCBjaGFyICoqX19yZXN0cmljdCBf
X3NyYywgc2l6ZV90IF9fbGVuLAogICAgbWJzdGF0ZV90ICpfX3Jlc3RyaWN0IF9fcHMpIHRocm93
ICgpOwoKCgpleHRlcm4gc2l6ZV90IHdjc3J0b21icyAoY2hhciAqX19yZXN0cmljdCBfX2RzdCwK
ICAgIGNvbnN0IHdjaGFyX3QgKipfX3Jlc3RyaWN0IF9fc3JjLCBzaXplX3QgX19sZW4sCiAgICBt
YnN0YXRlX3QgKl9fcmVzdHJpY3QgX19wcykgdGhyb3cgKCk7CgoKCgoKCmV4dGVybiBzaXplX3Qg
bWJzbnJ0b3djcyAod2NoYXJfdCAqX19yZXN0cmljdCBfX2RzdCwKICAgICBjb25zdCBjaGFyICoq
X19yZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbm1jLAogICAgIHNpemVfdCBfX2xlbiwgbWJzdGF0
ZV90ICpfX3Jlc3RyaWN0IF9fcHMpIHRocm93ICgpOwoKCgpleHRlcm4gc2l6ZV90IHdjc25ydG9t
YnMgKGNoYXIgKl9fcmVzdHJpY3QgX19kc3QsCiAgICAgY29uc3Qgd2NoYXJfdCAqKl9fcmVzdHJp
Y3QgX19zcmMsCiAgICAgc2l6ZV90IF9fbndjLCBzaXplX3QgX19sZW4sCiAgICAgbWJzdGF0ZV90
ICpfX3Jlc3RyaWN0IF9fcHMpIHRocm93ICgpOwoKCgoKCgpleHRlcm4gaW50IHdjd2lkdGggKHdj
aGFyX3QgX19jKSB0aHJvdyAoKTsKCgoKZXh0ZXJuIGludCB3Y3N3aWR0aCAoY29uc3Qgd2NoYXJf
dCAqX19zLCBzaXplX3QgX19uKSB0aHJvdyAoKTsKCgoKCgoKZXh0ZXJuIGRvdWJsZSB3Y3N0b2Qg
KGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19ucHRyLAogICAgICAgIHdjaGFyX3QgKipfX3Jl
c3RyaWN0IF9fZW5kcHRyKSB0aHJvdyAoKTsKCgoKCgpleHRlcm4gZmxvYXQgd2NzdG9mIChjb25z
dCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fbnB0ciwKICAgICAgIHdjaGFyX3QgKipfX3Jlc3RyaWN0
IF9fZW5kcHRyKSB0aHJvdyAoKTsKZXh0ZXJuIGxvbmcgZG91YmxlIHdjc3RvbGQgKGNvbnN0IHdj
aGFyX3QgKl9fcmVzdHJpY3QgX19ucHRyLAogICAgICAgd2NoYXJfdCAqKl9fcmVzdHJpY3QgX19l
bmRwdHIpIHRocm93ICgpOwoKCgoKCgoKZXh0ZXJuIGxvbmcgaW50IHdjc3RvbCAoY29uc3Qgd2No
YXJfdCAqX19yZXN0cmljdCBfX25wdHIsCiAgIHdjaGFyX3QgKipfX3Jlc3RyaWN0IF9fZW5kcHRy
LCBpbnQgX19iYXNlKSB0aHJvdyAoKTsKCgoKZXh0ZXJuIHVuc2lnbmVkIGxvbmcgaW50IHdjc3Rv
dWwgKGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19ucHRyLAogICAgICB3Y2hhcl90ICoqX19y
ZXN0cmljdCBfX2VuZHB0ciwgaW50IF9fYmFzZSkKICAgICB0aHJvdyAoKTsKCgoKCgoKX19leHRl
bnNpb25fXwpleHRlcm4gbG9uZyBsb25nIGludCB3Y3N0b2xsIChjb25zdCB3Y2hhcl90ICpfX3Jl
c3RyaWN0IF9fbnB0ciwKICAgICAgICAgd2NoYXJfdCAqKl9fcmVzdHJpY3QgX19lbmRwdHIsIGlu
dCBfX2Jhc2UpCiAgICAgdGhyb3cgKCk7CgoKCl9fZXh0ZW5zaW9uX18KZXh0ZXJuIHVuc2lnbmVk
IGxvbmcgbG9uZyBpbnQgd2NzdG91bGwgKGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19ucHRy
LAogICAgIHdjaGFyX3QgKipfX3Jlc3RyaWN0IF9fZW5kcHRyLAogICAgIGludCBfX2Jhc2UpIHRo
cm93ICgpOwoKCgoKCgpfX2V4dGVuc2lvbl9fCmV4dGVybiBsb25nIGxvbmcgaW50IHdjc3RvcSAo
Y29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX25wdHIsCiAgICAgICAgd2NoYXJfdCAqKl9fcmVz
dHJpY3QgX19lbmRwdHIsIGludCBfX2Jhc2UpCiAgICAgdGhyb3cgKCk7CgoKCl9fZXh0ZW5zaW9u
X18KZXh0ZXJuIHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgd2NzdG91cSAoY29uc3Qgd2NoYXJfdCAq
X19yZXN0cmljdCBfX25wdHIsCiAgICAgICAgICAgd2NoYXJfdCAqKl9fcmVzdHJpY3QgX19lbmRw
dHIsCiAgICAgICAgICAgaW50IF9fYmFzZSkgdGhyb3cgKCk7CiMgNTMzICIvdXNyL2luY2x1ZGUv
d2NoYXIuaCIgMyA0CmV4dGVybiBsb25nIGludCB3Y3N0b2xfbCAoY29uc3Qgd2NoYXJfdCAqX19y
ZXN0cmljdCBfX25wdHIsCiAgICAgd2NoYXJfdCAqKl9fcmVzdHJpY3QgX19lbmRwdHIsIGludCBf
X2Jhc2UsCiAgICAgX19sb2NhbGVfdCBfX2xvYykgdGhyb3cgKCk7CgpleHRlcm4gdW5zaWduZWQg
bG9uZyBpbnQgd2NzdG91bF9sIChjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fbnB0ciwKICAg
ICAgICB3Y2hhcl90ICoqX19yZXN0cmljdCBfX2VuZHB0ciwKICAgICAgICBpbnQgX19iYXNlLCBf
X2xvY2FsZV90IF9fbG9jKSB0aHJvdyAoKTsKCl9fZXh0ZW5zaW9uX18KZXh0ZXJuIGxvbmcgbG9u
ZyBpbnQgd2NzdG9sbF9sIChjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fbnB0ciwKICAgIHdj
aGFyX3QgKipfX3Jlc3RyaWN0IF9fZW5kcHRyLAogICAgaW50IF9fYmFzZSwgX19sb2NhbGVfdCBf
X2xvYykgdGhyb3cgKCk7CgpfX2V4dGVuc2lvbl9fCmV4dGVybiB1bnNpZ25lZCBsb25nIGxvbmcg
aW50IHdjc3RvdWxsX2wgKGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19ucHRyLAogICAgICAg
d2NoYXJfdCAqKl9fcmVzdHJpY3QgX19lbmRwdHIsCiAgICAgICBpbnQgX19iYXNlLCBfX2xvY2Fs
ZV90IF9fbG9jKQogICAgIHRocm93ICgpOwoKZXh0ZXJuIGRvdWJsZSB3Y3N0b2RfbCAoY29uc3Qg
d2NoYXJfdCAqX19yZXN0cmljdCBfX25wdHIsCiAgIHdjaGFyX3QgKipfX3Jlc3RyaWN0IF9fZW5k
cHRyLCBfX2xvY2FsZV90IF9fbG9jKQogICAgIHRocm93ICgpOwoKZXh0ZXJuIGZsb2F0IHdjc3Rv
Zl9sIChjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fbnB0ciwKICAgICAgICAgd2NoYXJfdCAq
Kl9fcmVzdHJpY3QgX19lbmRwdHIsIF9fbG9jYWxlX3QgX19sb2MpCiAgICAgdGhyb3cgKCk7Cgpl
eHRlcm4gbG9uZyBkb3VibGUgd2NzdG9sZF9sIChjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9f
bnB0ciwKICAgICAgICAgd2NoYXJfdCAqKl9fcmVzdHJpY3QgX19lbmRwdHIsCiAgICAgICAgIF9f
bG9jYWxlX3QgX19sb2MpIHRocm93ICgpOwoKCgoKCgpleHRlcm4gd2NoYXJfdCAqd2NwY3B5ICh3
Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZGVzdCwKICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBf
X3NyYykgdGhyb3cgKCk7CgoKCmV4dGVybiB3Y2hhcl90ICp3Y3BuY3B5ICh3Y2hhcl90ICpfX3Jl
c3RyaWN0IF9fZGVzdCwKICAgIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVf
dCBfX24pCiAgICAgdGhyb3cgKCk7CgoKCgoKCmV4dGVybiBfX0ZJTEUgKm9wZW5fd21lbXN0cmVh
bSAod2NoYXJfdCAqKl9fYnVmbG9jLCBzaXplX3QgKl9fc2l6ZWxvYykgdGhyb3cgKCk7CgoKCgoK
CmV4dGVybiBpbnQgZndpZGUgKF9fRklMRSAqX19mcCwgaW50IF9fbW9kZSkgdGhyb3cgKCk7CgoK
CgoKCmV4dGVybiBpbnQgZndwcmludGYgKF9fRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSwKICAg
ICAgIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4uLikKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CgoKCgpleHRl
cm4gaW50IHdwcmludGYgKGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4uLikK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICA7CgpleHRlcm4gaW50IHN3cHJpbnRmICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90
IF9fbiwKICAgICAgIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4uLikKICAg
ICB0aHJvdyAoKSA7CgoKCgoKZXh0ZXJuIGludCB2ZndwcmludGYgKF9fRklMRSAqX19yZXN0cmlj
dCBfX3MsCiAgICAgICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX2Zvcm1hdCwKICAgICAg
ICBfX2dudWNfdmFfbGlzdCBfX2FyZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICA7CgoKCgpleHRlcm4gaW50IHZ3cHJpbnRmIChjb25z
dCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LAogICAgICAgX19nbnVjX3ZhX2xpc3QgX19h
cmcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgOwoKCmV4dGVybiBpbnQgdnN3cHJpbnRmICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fcywg
c2l6ZV90IF9fbiwKICAgICAgICBjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LAog
ICAgICAgIF9fZ251Y192YV9saXN0IF9fYXJnKQogICAgIHRocm93ICgpIDsKCgoKCgoKZXh0ZXJu
IGludCBmd3NjYW5mIChfX0ZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0sCiAgICAgIGNvbnN0IHdj
aGFyX3QgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4uLikKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKCgoKCmV4dGVybiBpbnQgd3NjYW5m
IChjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCAuLi4pCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gaW50
IHN3c2NhbmYgKGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19zLAogICAgICBjb25zdCB3Y2hh
cl90ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCAuLi4pCiAgICAgdGhyb3cgKCkgOwojIDY4MyAiL3Vz
ci9pbmNsdWRlL3djaGFyLmgiIDMgNAoKCgoKCgoKCgpleHRlcm4gaW50IHZmd3NjYW5mIChfX0ZJ
TEUgKl9fcmVzdHJpY3QgX19zLAogICAgICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX2Zv
cm1hdCwKICAgICAgIF9fZ251Y192YV9saXN0IF9fYXJnKQogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwoKCgoKZXh0ZXJuIGludCB2d3Nj
YW5mIChjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LAogICAgICBfX2dudWNfdmFf
bGlzdCBfX2FyZykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIDsKCmV4dGVybiBpbnQgdnN3c2NhbmYgKGNvbnN0IHdjaGFyX3QgKl9fcmVz
dHJpY3QgX19zLAogICAgICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX2Zvcm1hdCwKICAg
ICAgIF9fZ251Y192YV9saXN0IF9fYXJnKQogICAgIHRocm93ICgpIDsKIyA3MzkgIi91c3IvaW5j
bHVkZS93Y2hhci5oIiAzIDQKCgoKCgoKCgoKZXh0ZXJuIHdpbnRfdCBmZ2V0d2MgKF9fRklMRSAq
X19zdHJlYW0pOwpleHRlcm4gd2ludF90IGdldHdjIChfX0ZJTEUgKl9fc3RyZWFtKTsKCgoKCgpl
eHRlcm4gd2ludF90IGdldHdjaGFyICh2b2lkKTsKCgoKCgoKZXh0ZXJuIHdpbnRfdCBmcHV0d2Mg
KHdjaGFyX3QgX193YywgX19GSUxFICpfX3N0cmVhbSk7CmV4dGVybiB3aW50X3QgcHV0d2MgKHdj
aGFyX3QgX193YywgX19GSUxFICpfX3N0cmVhbSk7CgoKCgoKZXh0ZXJuIHdpbnRfdCBwdXR3Y2hh
ciAod2NoYXJfdCBfX3djKTsKCgoKCgoKCmV4dGVybiB3Y2hhcl90ICpmZ2V0d3MgKHdjaGFyX3Qg
Kl9fcmVzdHJpY3QgX193cywgaW50IF9fbiwKICAgX19GSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFt
KTsKCgoKCgpleHRlcm4gaW50IGZwdXR3cyAoY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX3dz
LAogICAgIF9fRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSk7CgoKCgoKCmV4dGVybiB3aW50X3Qg
dW5nZXR3YyAod2ludF90IF9fd2MsIF9fRklMRSAqX19zdHJlYW0pOwoKIyA4MDQgIi91c3IvaW5j
bHVkZS93Y2hhci5oIiAzIDQKZXh0ZXJuIHdpbnRfdCBnZXR3Y191bmxvY2tlZCAoX19GSUxFICpf
X3N0cmVhbSk7CmV4dGVybiB3aW50X3QgZ2V0d2NoYXJfdW5sb2NrZWQgKHZvaWQpOwoKCgoKCgoK
ZXh0ZXJuIHdpbnRfdCBmZ2V0d2NfdW5sb2NrZWQgKF9fRklMRSAqX19zdHJlYW0pOwoKCgoKCgoK
ZXh0ZXJuIHdpbnRfdCBmcHV0d2NfdW5sb2NrZWQgKHdjaGFyX3QgX193YywgX19GSUxFICpfX3N0
cmVhbSk7CiMgODMwICIvdXNyL2luY2x1ZGUvd2NoYXIuaCIgMyA0CmV4dGVybiB3aW50X3QgcHV0
d2NfdW5sb2NrZWQgKHdjaGFyX3QgX193YywgX19GSUxFICpfX3N0cmVhbSk7CmV4dGVybiB3aW50
X3QgcHV0d2NoYXJfdW5sb2NrZWQgKHdjaGFyX3QgX193Yyk7CiMgODQwICIvdXNyL2luY2x1ZGUv
d2NoYXIuaCIgMyA0CmV4dGVybiB3Y2hhcl90ICpmZ2V0d3NfdW5sb2NrZWQgKHdjaGFyX3QgKl9f
cmVzdHJpY3QgX193cywgaW50IF9fbiwKICAgICBfX0ZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0p
OwoKCgoKCgoKZXh0ZXJuIGludCBmcHV0d3NfdW5sb2NrZWQgKGNvbnN0IHdjaGFyX3QgKl9fcmVz
dHJpY3QgX193cywKICAgICAgIF9fRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSk7CgoKCgoKCgpl
eHRlcm4gc2l6ZV90IHdjc2Z0aW1lICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9f
bWF4c2l6ZSwKICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX2Zvcm1hdCwKICAgY29uc3Qg
c3RydWN0IHRtICpfX3Jlc3RyaWN0IF9fdHApIHRocm93ICgpOwoKCgoKCgoKZXh0ZXJuIHNpemVf
dCB3Y3NmdGltZV9sICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fbWF4c2l6ZSwK
ICAgICBjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LAogICAgIGNvbnN0IHN0cnVj
dCB0bSAqX19yZXN0cmljdCBfX3RwLAogICAgIF9fbG9jYWxlX3QgX19sb2MpIHRocm93ICgpOwoj
IDg4NyAiL3Vzci9pbmNsdWRlL3djaGFyLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3dj
aGFyMi5oIiAxIDMgNAojIDI0ICIvdXNyL2luY2x1ZGUvYml0cy93Y2hhcjIuaCIgMyA0CmV4dGVy
biB3Y2hhcl90ICpfX3dtZW1jcHlfY2hrICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fczEsCiAgICAg
ICAgICBjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fczIsIHNpemVfdCBfX24sCiAgICAgICAg
ICBzaXplX3QgX19uczEpIHRocm93ICgpOwpleHRlcm4gd2NoYXJfdCAqX193bWVtY3B5X2FsaWFz
ICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fczEsIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19z
Miwgc2l6ZV90IF9fbikgdGhyb3cgKCkgX19hc21fXyAoIiIgIndtZW1jcHkiKQoKCiAgICAgICAg
ICAgIDsKZXh0ZXJuIHdjaGFyX3QgKl9fd21lbWNweV9jaGtfd2FybiAod2NoYXJfdCAqX19yZXN0
cmljdCBfX3MxLCBjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fczIsIHNpemVfdCBfX24sIHNp
emVfdCBfX25zMSkgdGhyb3cgKCkgX19hc21fXyAoIiIgIl9fd21lbWNweV9jaGsiKQoKCgogICAg
IF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgid21lbWNweSBjYWxsZWQgd2l0aCBsZW5ndGgg
YmlnZ2VyIHRoYW4gc2l6ZSBvZiBkZXN0aW5hdGlvbiAiICJidWZmZXIiKSkpCiAgICAgICAgICAg
IDsKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBf
X2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmlj
aWFsX18pKSB3Y2hhcl90ICoKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkgd21lbWNweSAod2No
YXJfdCAqX19yZXN0cmljdCBfX3MxLCBjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fczIsIHNp
emVfdCBfX24pIHRocm93ICgpCgp7CiAgaWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19zMSwg
MCkgIT0gKHNpemVfdCkgLTEpCiAgICB7CiAgICAgIGlmICghX19idWlsdGluX2NvbnN0YW50X3Ag
KF9fbikpCiByZXR1cm4gX193bWVtY3B5X2NoayAoX19zMSwgX19zMiwgX19uLAogICAgICAgICBf
X2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fczEsIDApIC8gc2l6ZW9mICh3Y2hhcl90KSk7CgogICAg
ICBpZiAoX19uID4gX19idWlsdGluX29iamVjdF9zaXplIChfX3MxLCAwKSAvIHNpemVvZiAod2No
YXJfdCkpCiByZXR1cm4gX193bWVtY3B5X2Noa193YXJuIChfX3MxLCBfX3MyLCBfX24sCiAgICAg
ICBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fczEsIDApIC8gc2l6ZW9mICh3Y2hhcl90KSk7CiAg
ICB9CiAgcmV0dXJuIF9fd21lbWNweV9hbGlhcyAoX19zMSwgX19zMiwgX19uKTsKfQoKCmV4dGVy
biB3Y2hhcl90ICpfX3dtZW1tb3ZlX2NoayAod2NoYXJfdCAqX19zMSwgY29uc3Qgd2NoYXJfdCAq
X19zMiwKICAgIHNpemVfdCBfX24sIHNpemVfdCBfX25zMSkgdGhyb3cgKCk7CmV4dGVybiB3Y2hh
cl90ICpfX3dtZW1tb3ZlX2FsaWFzICh3Y2hhcl90ICpfX3MxLCBjb25zdCB3Y2hhcl90ICpfX3My
LCBzaXplX3QgX19uKSB0aHJvdyAoKSBfX2FzbV9fICgiIiAid21lbW1vdmUiKQoKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIDsKZXh0ZXJuIHdjaGFyX3QgKl9fd21lbW1vdmVfY2hrX3dh
cm4gKHdjaGFyX3QgKl9fczEsIGNvbnN0IHdjaGFyX3QgKl9fczIsIHNpemVfdCBfX24sIHNpemVf
dCBfX25zMSkgdGhyb3cgKCkgX19hc21fXyAoIiIgIl9fd21lbW1vdmVfY2hrIikKCgogICAgIF9f
YXR0cmlidXRlX18oKF9fd2FybmluZ19fICgid21lbW1vdmUgY2FsbGVkIHdpdGggbGVuZ3RoIGJp
Z2dlciB0aGFuIHNpemUgb2YgZGVzdGluYXRpb24gIiAiYnVmZmVyIikpKQogICAgICAgICAgICA7
CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lh
bF9fKSkgd2NoYXJfdCAqCl9fYXR0cmlidXRlX18gKChfX2xlYWZfXykpIHdtZW1tb3ZlICh3Y2hh
cl90ICpfX3MxLCBjb25zdCB3Y2hhcl90ICpfX3MyLCBzaXplX3QgX19uKSB0aHJvdyAoKQp7CiAg
aWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19zMSwgMCkgIT0gKHNpemVfdCkgLTEpCiAgICB7
CiAgICAgIGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fbikpCiByZXR1cm4gX193bWVtbW92
ZV9jaGsgKF9fczEsIF9fczIsIF9fbiwKICAgICAgICAgIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAo
X19zMSwgMCkgLyBzaXplb2YgKHdjaGFyX3QpKTsKCiAgICAgIGlmIChfX24gPiBfX2J1aWx0aW5f
b2JqZWN0X3NpemUgKF9fczEsIDApIC8gc2l6ZW9mICh3Y2hhcl90KSkKIHJldHVybiBfX3dtZW1t
b3ZlX2Noa193YXJuIChfX3MxLCBfX3MyLCBfX24sCiAgICAgICAgX19idWlsdGluX29iamVjdF9z
aXplIChfX3MxLCAwKSAvIHNpemVvZiAod2NoYXJfdCkpOwogICAgfQogIHJldHVybiBfX3dtZW1t
b3ZlX2FsaWFzIChfX3MxLCBfX3MyLCBfX24pOwp9CgoKCmV4dGVybiB3Y2hhcl90ICpfX3dtZW1w
Y3B5X2NoayAod2NoYXJfdCAqX19yZXN0cmljdCBfX3MxLAogICAgY29uc3Qgd2NoYXJfdCAqX19y
ZXN0cmljdCBfX3MyLCBzaXplX3QgX19uLAogICAgc2l6ZV90IF9fbnMxKSB0aHJvdyAoKTsKZXh0
ZXJuIHdjaGFyX3QgKl9fd21lbXBjcHlfYWxpYXMgKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19zMSwg
Y29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX3MyLCBzaXplX3QgX19uKSB0aHJvdyAoKSBfX2Fz
bV9fICgiIiAid21lbXBjcHkiKQoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKZXh0ZXJu
IHdjaGFyX3QgKl9fd21lbXBjcHlfY2hrX3dhcm4gKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19zMSwg
Y29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX3MyLCBzaXplX3QgX19uLCBzaXplX3QgX19uczEp
IHRocm93ICgpIF9fYXNtX18gKCIiICJfX3dtZW1wY3B5X2NoayIpCgoKCiAgICAgX19hdHRyaWJ1
dGVfXygoX193YXJuaW5nX18gKCJ3bWVtcGNweSBjYWxsZWQgd2l0aCBsZW5ndGggYmlnZ2VyIHRo
YW4gc2l6ZSBvZiBkZXN0aW5hdGlvbiAiICJidWZmZXIiKSkpCiAgICAgICAgICAgIDsKCmV4dGVy
biBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSB3
Y2hhcl90ICoKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkgd21lbXBjcHkgKHdjaGFyX3QgKl9f
cmVzdHJpY3QgX19zMSwgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX3MyLCBzaXplX3QgX19u
KSB0aHJvdyAoKQoKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fczEsIDApICE9IChz
aXplX3QpIC0xKQogICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX24pKQog
cmV0dXJuIF9fd21lbXBjcHlfY2hrIChfX3MxLCBfX3MyLCBfX24sCiAgICAgICAgICBfX2J1aWx0
aW5fb2JqZWN0X3NpemUgKF9fczEsIDApIC8gc2l6ZW9mICh3Y2hhcl90KSk7CgogICAgICBpZiAo
X19uID4gX19idWlsdGluX29iamVjdF9zaXplIChfX3MxLCAwKSAvIHNpemVvZiAod2NoYXJfdCkp
CiByZXR1cm4gX193bWVtcGNweV9jaGtfd2FybiAoX19zMSwgX19zMiwgX19uLAogICAgICAgIF9f
YnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19zMSwgMCkgLyBzaXplb2YgKHdjaGFyX3QpKTsKICAgIH0K
ICByZXR1cm4gX193bWVtcGNweV9hbGlhcyAoX19zMSwgX19zMiwgX19uKTsKfQoKCgpleHRlcm4g
d2NoYXJfdCAqX193bWVtc2V0X2NoayAod2NoYXJfdCAqX19zLCB3Y2hhcl90IF9fYywgc2l6ZV90
IF9fbiwKICAgICAgICAgIHNpemVfdCBfX25zKSB0aHJvdyAoKTsKZXh0ZXJuIHdjaGFyX3QgKl9f
d21lbXNldF9hbGlhcyAod2NoYXJfdCAqX19zLCB3Y2hhcl90IF9fYywgc2l6ZV90IF9fbikgdGhy
b3cgKCkgX19hc21fXyAoIiIgIndtZW1zZXQiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAg
IDsKZXh0ZXJuIHdjaGFyX3QgKl9fd21lbXNldF9jaGtfd2FybiAod2NoYXJfdCAqX19zLCB3Y2hh
cl90IF9fYywgc2l6ZV90IF9fbiwgc2l6ZV90IF9fbnMpIHRocm93ICgpIF9fYXNtX18gKCIiICJf
X3dtZW1zZXRfY2hrIikKCgogICAgIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgid21lbXNl
dCBjYWxsZWQgd2l0aCBsZW5ndGggYmlnZ2VyIHRoYW4gc2l6ZSBvZiBkZXN0aW5hdGlvbiAiICJi
dWZmZXIiKSkpCiAgICAgICAgICAgIDsKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgo
X19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSB3Y2hhcl90ICoKX19hdHRyaWJ1dGVfXyAoKF9f
bGVhZl9fKSkgd21lbXNldCAod2NoYXJfdCAqX19zLCB3Y2hhcl90IF9fYywgc2l6ZV90IF9fbikg
dGhyb3cgKCkKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcywgMCkgIT0gKHNpemVf
dCkgLTEpCiAgICB7CiAgICAgIGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fbikpCiByZXR1
cm4gX193bWVtc2V0X2NoayAoX19zLCBfX2MsIF9fbiwgX19idWlsdGluX29iamVjdF9zaXplIChf
X3MsIDApIC8gc2l6ZW9mICh3Y2hhcl90KSk7CgogICAgICBpZiAoX19uID4gX19idWlsdGluX29i
amVjdF9zaXplIChfX3MsIDApIC8gc2l6ZW9mICh3Y2hhcl90KSkKIHJldHVybiBfX3dtZW1zZXRf
Y2hrX3dhcm4gKF9fcywgX19jLCBfX24sCiAgICAgICBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9f
cywgMCkgLyBzaXplb2YgKHdjaGFyX3QpKTsKICAgIH0KICByZXR1cm4gX193bWVtc2V0X2FsaWFz
IChfX3MsIF9fYywgX19uKTsKfQoKCmV4dGVybiB3Y2hhcl90ICpfX3djc2NweV9jaGsgKHdjaGFy
X3QgKl9fcmVzdHJpY3QgX19kZXN0LAogICAgICAgICBjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0
IF9fc3JjLAogICAgICAgICBzaXplX3QgX19uKSB0aHJvdyAoKTsKZXh0ZXJuIHdjaGFyX3QgKl9f
d2NzY3B5X2FsaWFzICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZGVzdCwgY29uc3Qgd2NoYXJfdCAq
X19yZXN0cmljdCBfX3NyYykgdGhyb3cgKCkgX19hc21fXyAoIiIgIndjc2NweSIpCgogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5l
IF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIHdjaGFyX3QgKgpf
X2F0dHJpYnV0ZV9fICgoX19sZWFmX18pKSB3Y3NjcHkgKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19k
ZXN0LCBjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fc3JjKSB0aHJvdyAoKQp7CiAgaWYgKF9f
YnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kZXN0LCAyID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICBy
ZXR1cm4gX193Y3NjcHlfY2hrIChfX2Rlc3QsIF9fc3JjLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUg
KF9fZGVzdCwgMiA+IDEpIC8gc2l6ZW9mICh3Y2hhcl90KSk7CiAgcmV0dXJuIF9fd2NzY3B5X2Fs
aWFzIChfX2Rlc3QsIF9fc3JjKTsKfQoKCmV4dGVybiB3Y2hhcl90ICpfX3djcGNweV9jaGsgKHdj
aGFyX3QgKl9fcmVzdHJpY3QgX19kZXN0LAogICAgICAgICBjb25zdCB3Y2hhcl90ICpfX3Jlc3Ry
aWN0IF9fc3JjLAogICAgICAgICBzaXplX3QgX19kZXN0bGVuKSB0aHJvdyAoKTsKZXh0ZXJuIHdj
aGFyX3QgKl9fd2NwY3B5X2FsaWFzICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZGVzdCwgY29uc3Qg
d2NoYXJfdCAqX19yZXN0cmljdCBfX3NyYykgdGhyb3cgKCkgX19hc21fXyAoIiIgIndjcGNweSIp
CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJu
IF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIHdj
aGFyX3QgKgpfX2F0dHJpYnV0ZV9fICgoX19sZWFmX18pKSB3Y3BjcHkgKHdjaGFyX3QgKl9fcmVz
dHJpY3QgX19kZXN0LCBjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fc3JjKSB0aHJvdyAoKQp7
CiAgaWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kZXN0LCAyID4gMSkgIT0gKHNpemVfdCkg
LTEpCiAgICByZXR1cm4gX193Y3BjcHlfY2hrIChfX2Rlc3QsIF9fc3JjLCBfX2J1aWx0aW5fb2Jq
ZWN0X3NpemUgKF9fZGVzdCwgMiA+IDEpIC8gc2l6ZW9mICh3Y2hhcl90KSk7CiAgcmV0dXJuIF9f
d2NwY3B5X2FsaWFzIChfX2Rlc3QsIF9fc3JjKTsKfQoKCmV4dGVybiB3Y2hhcl90ICpfX3djc25j
cHlfY2hrICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZGVzdCwKICAgICAgICAgIGNvbnN0IHdjaGFy
X3QgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX24sCiAgICAgICAgICBzaXplX3QgX19kZXN0
bGVuKSB0aHJvdyAoKTsKZXh0ZXJuIHdjaGFyX3QgKl9fd2NzbmNweV9hbGlhcyAod2NoYXJfdCAq
X19yZXN0cmljdCBfX2Rlc3QsIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVf
dCBfX24pIHRocm93ICgpIF9fYXNtX18gKCIiICJ3Y3NuY3B5IikKCgogICAgICAgICAgICAgICAg
ICAgICAgICAgIDsKZXh0ZXJuIHdjaGFyX3QgKl9fd2NzbmNweV9jaGtfd2FybiAod2NoYXJfdCAq
X19yZXN0cmljdCBfX2Rlc3QsIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVf
dCBfX24sIHNpemVfdCBfX2Rlc3RsZW4pIHRocm93ICgpIF9fYXNtX18gKCIiICJfX3djc25jcHlf
Y2hrIikKCgoKICAgICBfX2F0dHJpYnV0ZV9fKChfX3dhcm5pbmdfXyAoIndjc25jcHkgY2FsbGVk
IHdpdGggbGVuZ3RoIGJpZ2dlciB0aGFuIHNpemUgb2YgZGVzdGluYXRpb24gIiAiYnVmZmVyIikp
KQogICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlz
X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVf
XyAoKF9fYXJ0aWZpY2lhbF9fKSkgd2NoYXJfdCAqCl9fYXR0cmlidXRlX18gKChfX2xlYWZfXykp
IHdjc25jcHkgKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19kZXN0LCBjb25zdCB3Y2hhcl90ICpfX3Jl
c3RyaWN0IF9fc3JjLCBzaXplX3QgX19uKSB0aHJvdyAoKQoKewogIGlmIChfX2J1aWx0aW5fb2Jq
ZWN0X3NpemUgKF9fZGVzdCwgMiA+IDEpICE9IChzaXplX3QpIC0xKQogICAgewogICAgICBpZiAo
IV9fYnVpbHRpbl9jb25zdGFudF9wIChfX24pKQogcmV0dXJuIF9fd2NzbmNweV9jaGsgKF9fZGVz
dCwgX19zcmMsIF9fbiwKICAgICAgICAgX19idWlsdGluX29iamVjdF9zaXplIChfX2Rlc3QsIDIg
PiAxKSAvIHNpemVvZiAod2NoYXJfdCkpOwogICAgICBpZiAoX19uID4gX19idWlsdGluX29iamVj
dF9zaXplIChfX2Rlc3QsIDIgPiAxKSAvIHNpemVvZiAod2NoYXJfdCkpCiByZXR1cm4gX193Y3Nu
Y3B5X2Noa193YXJuIChfX2Rlc3QsIF9fc3JjLCBfX24sCiAgICAgICBfX2J1aWx0aW5fb2JqZWN0
X3NpemUgKF9fZGVzdCwgMiA+IDEpIC8gc2l6ZW9mICh3Y2hhcl90KSk7CiAgICB9CiAgcmV0dXJu
IF9fd2NzbmNweV9hbGlhcyAoX19kZXN0LCBfX3NyYywgX19uKTsKfQoKCmV4dGVybiB3Y2hhcl90
ICpfX3djcG5jcHlfY2hrICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZGVzdCwKICAgICAgICAgIGNv
bnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX24sCiAgICAgICAgICBzaXpl
X3QgX19kZXN0bGVuKSB0aHJvdyAoKTsKZXh0ZXJuIHdjaGFyX3QgKl9fd2NwbmNweV9hbGlhcyAo
d2NoYXJfdCAqX19yZXN0cmljdCBfX2Rlc3QsIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19z
cmMsIHNpemVfdCBfX24pIHRocm93ICgpIF9fYXNtX18gKCIiICJ3Y3BuY3B5IikKCgogICAgICAg
ICAgICAgICAgICAgICAgICAgIDsKZXh0ZXJuIHdjaGFyX3QgKl9fd2NwbmNweV9jaGtfd2FybiAo
d2NoYXJfdCAqX19yZXN0cmljdCBfX2Rlc3QsIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19z
cmMsIHNpemVfdCBfX24sIHNpemVfdCBfX2Rlc3RsZW4pIHRocm93ICgpIF9fYXNtX18gKCIiICJf
X3djcG5jcHlfY2hrIikKCgoKICAgICBfX2F0dHJpYnV0ZV9fKChfX3dhcm5pbmdfXyAoIndjcG5j
cHkgY2FsbGVkIHdpdGggbGVuZ3RoIGJpZ2dlciB0aGFuIHNpemUgb2YgZGVzdGluYXRpb24gIiAi
YnVmZmVyIikpKQogICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAo
KF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgd2NoYXJfdCAqCl9fYXR0cmlidXRlX18gKChf
X2xlYWZfXykpIHdjcG5jcHkgKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19kZXN0LCBjb25zdCB3Y2hh
cl90ICpfX3Jlc3RyaWN0IF9fc3JjLCBzaXplX3QgX19uKSB0aHJvdyAoKQoKewogIGlmIChfX2J1
aWx0aW5fb2JqZWN0X3NpemUgKF9fZGVzdCwgMiA+IDEpICE9IChzaXplX3QpIC0xKQogICAgewog
ICAgICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX24pKQogcmV0dXJuIF9fd2NwbmNweV9j
aGsgKF9fZGVzdCwgX19zcmMsIF9fbiwKICAgICAgICAgX19idWlsdGluX29iamVjdF9zaXplIChf
X2Rlc3QsIDIgPiAxKSAvIHNpemVvZiAod2NoYXJfdCkpOwogICAgICBpZiAoX19uID4gX19idWls
dGluX29iamVjdF9zaXplIChfX2Rlc3QsIDIgPiAxKSAvIHNpemVvZiAod2NoYXJfdCkpCiByZXR1
cm4gX193Y3BuY3B5X2Noa193YXJuIChfX2Rlc3QsIF9fc3JjLCBfX24sCiAgICAgICBfX2J1aWx0
aW5fb2JqZWN0X3NpemUgKF9fZGVzdCwgMiA+IDEpIC8gc2l6ZW9mICh3Y2hhcl90KSk7CiAgICB9
CiAgcmV0dXJuIF9fd2NwbmNweV9hbGlhcyAoX19kZXN0LCBfX3NyYywgX19uKTsKfQoKCmV4dGVy
biB3Y2hhcl90ICpfX3djc2NhdF9jaGsgKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19kZXN0LAogICAg
ICAgICBjb25zdCB3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fc3JjLAogICAgICAgICBzaXplX3QgX19k
ZXN0bGVuKSB0aHJvdyAoKTsKZXh0ZXJuIHdjaGFyX3QgKl9fd2NzY2F0X2FsaWFzICh3Y2hhcl90
ICpfX3Jlc3RyaWN0IF9fZGVzdCwgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX3NyYykgdGhy
b3cgKCkgX19hc21fXyAoIiIgIndjc2NhdCIpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fs
d2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18gKChfX2FydGlmaWNpYWxfXykpIHdjaGFyX3QgKgpfX2F0dHJpYnV0ZV9fICgoX19sZWFm
X18pKSB3Y3NjYXQgKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19kZXN0LCBjb25zdCB3Y2hhcl90ICpf
X3Jlc3RyaWN0IF9fc3JjKSB0aHJvdyAoKQp7CiAgaWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAo
X19kZXN0LCAyID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICByZXR1cm4gX193Y3NjYXRfY2hrIChf
X2Rlc3QsIF9fc3JjLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fZGVzdCwgMiA+IDEpIC8gc2l6
ZW9mICh3Y2hhcl90KSk7CiAgcmV0dXJuIF9fd2NzY2F0X2FsaWFzIChfX2Rlc3QsIF9fc3JjKTsK
fQoKCmV4dGVybiB3Y2hhcl90ICpfX3djc25jYXRfY2hrICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9f
ZGVzdCwKICAgICAgICAgIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19zcmMsCiAgICAgICAg
ICBzaXplX3QgX19uLCBzaXplX3QgX19kZXN0bGVuKSB0aHJvdyAoKTsKZXh0ZXJuIHdjaGFyX3Qg
Kl9fd2NzbmNhdF9hbGlhcyAod2NoYXJfdCAqX19yZXN0cmljdCBfX2Rlc3QsIGNvbnN0IHdjaGFy
X3QgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX24pIHRocm93ICgpIF9fYXNtX18gKCIiICJ3
Y3NuY2F0IikKCgogICAgICAgICAgICAgICAgICAgICAgICAgIDsKCmV4dGVybiBfX2lubGluZSBf
X2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSB3Y2hhcl90ICoKX19h
dHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkgd2NzbmNhdCAod2NoYXJfdCAqX19yZXN0cmljdCBfX2Rl
c3QsIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX24pIHRocm93ICgp
Cgp7CiAgaWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kZXN0LCAyID4gMSkgIT0gKHNpemVf
dCkgLTEpCiAgICByZXR1cm4gX193Y3NuY2F0X2NoayAoX19kZXN0LCBfX3NyYywgX19uLAogICAg
IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kZXN0LCAyID4gMSkgLyBzaXplb2YgKHdjaGFyX3Qp
KTsKICByZXR1cm4gX193Y3NuY2F0X2FsaWFzIChfX2Rlc3QsIF9fc3JjLCBfX24pOwp9CgoKZXh0
ZXJuIGludCBfX3N3cHJpbnRmX2NoayAod2NoYXJfdCAqX19yZXN0cmljdCBfX3MsIHNpemVfdCBf
X24sCiAgICAgIGludCBfX2ZsYWcsIHNpemVfdCBfX3NfbGVuLAogICAgICBjb25zdCB3Y2hhcl90
ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCAuLi4pCiAgICAgdGhyb3cgKCkgOwoKZXh0ZXJuIGludCBf
X3N3cHJpbnRmX2FsaWFzICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fbiwgY29u
c3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX2ZtdCwgLi4uKSB0aHJvdyAoKSBfX2FzbV9fICgiIiAi
c3dwcmludGYiKQoKCiAgICAgICAgICAgICA7CgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRl
X18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGludApfX2F0dHJpYnV0ZV9fICgoX19s
ZWFmX18pKSBzd3ByaW50ZiAod2NoYXJfdCAqX19yZXN0cmljdCBfX3MsIHNpemVfdCBfX24sIGNv
bnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19mbXQsIC4uLikgdGhyb3cgKCkKCnsKICBpZiAoX19i
dWlsdGluX29iamVjdF9zaXplIChfX3MsIDIgPiAxKSAhPSAoc2l6ZV90KSAtMSB8fCAyID4gMSkK
ICAgIHJldHVybiBfX3N3cHJpbnRmX2NoayAoX19zLCBfX24sIDIgLSAxLAogICAgICBfX2J1aWx0
aW5fb2JqZWN0X3NpemUgKF9fcywgMiA+IDEpIC8gc2l6ZW9mICh3Y2hhcl90KSwKICAgICAgX19m
bXQsIF9fYnVpbHRpbl92YV9hcmdfcGFjayAoKSk7CiAgcmV0dXJuIF9fc3dwcmludGZfYWxpYXMg
KF9fcywgX19uLCBfX2ZtdCwgX19idWlsdGluX3ZhX2FyZ19wYWNrICgpKTsKfQojIDMwMyAiL3Vz
ci9pbmNsdWRlL2JpdHMvd2NoYXIyLmgiIDMgNApleHRlcm4gaW50IF9fdnN3cHJpbnRmX2NoayAo
d2NoYXJfdCAqX19yZXN0cmljdCBfX3MsIHNpemVfdCBfX24sCiAgICAgICBpbnQgX19mbGFnLCBz
aXplX3QgX19zX2xlbiwKICAgICAgIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19mb3JtYXQs
CiAgICAgICBfX2dudWNfdmFfbGlzdCBfX2FyZykKICAgICB0aHJvdyAoKSA7CgpleHRlcm4gaW50
IF9fdnN3cHJpbnRmX2FsaWFzICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fbiwg
Y29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX2ZtdCwgX19nbnVjX3ZhX2xpc3QgX19hcCkgdGhy
b3cgKCkgX19hc21fXyAoIiIgInZzd3ByaW50ZiIpCgoKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIDsKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
ICgoX19hcnRpZmljaWFsX18pKSBpbnQKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkgdnN3cHJp
bnRmICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fbiwgY29uc3Qgd2NoYXJfdCAq
X19yZXN0cmljdCBfX2ZtdCwgX19nbnVjX3ZhX2xpc3QgX19hcCkgdGhyb3cgKCkKCnsKICBpZiAo
X19idWlsdGluX29iamVjdF9zaXplIChfX3MsIDIgPiAxKSAhPSAoc2l6ZV90KSAtMSB8fCAyID4g
MSkKICAgIHJldHVybiBfX3Zzd3ByaW50Zl9jaGsgKF9fcywgX19uLCAyIC0gMSwKICAgICAgIF9f
YnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19zLCAyID4gMSkgLyBzaXplb2YgKHdjaGFyX3QpLCBfX2Zt
dCwgX19hcCk7CiAgcmV0dXJuIF9fdnN3cHJpbnRmX2FsaWFzIChfX3MsIF9fbiwgX19mbXQsIF9f
YXApOwp9CgoKCgpleHRlcm4gaW50IF9fZndwcmludGZfY2hrIChfX0ZJTEUgKl9fcmVzdHJpY3Qg
X19zdHJlYW0sIGludCBfX2ZsYWcsCiAgICAgIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19m
b3JtYXQsIC4uLik7CmV4dGVybiBpbnQgX193cHJpbnRmX2NoayAoaW50IF9fZmxhZywgY29uc3Qg
d2NoYXJfdCAqX19yZXN0cmljdCBfX2Zvcm1hdCwKICAgICAuLi4pOwpleHRlcm4gaW50IF9fdmZ3
cHJpbnRmX2NoayAoX19GSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtLCBpbnQgX19mbGFnLAogICAg
ICAgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX2Zvcm1hdCwKICAgICAgIF9fZ251Y192YV9s
aXN0IF9fYXApOwpleHRlcm4gaW50IF9fdndwcmludGZfY2hrIChpbnQgX19mbGFnLCBjb25zdCB3
Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LAogICAgICBfX2dudWNfdmFfbGlzdCBfX2FwKTsK
CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lh
bF9fKSkgaW50CndwcmludGYgKGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19mbXQsIC4uLikK
ewogIHJldHVybiBfX3dwcmludGZfY2hrICgyIC0gMSwgX19mbXQsIF9fYnVpbHRpbl92YV9hcmdf
cGFjayAoKSk7Cn0KCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgo
X19hcnRpZmljaWFsX18pKSBpbnQKZndwcmludGYgKF9fRklMRSAqX19yZXN0cmljdCBfX3N0cmVh
bSwgY29uc3Qgd2NoYXJfdCAqX19yZXN0cmljdCBfX2ZtdCwgLi4uKQp7CiAgcmV0dXJuIF9fZndw
cmludGZfY2hrIChfX3N0cmVhbSwgMiAtIDEsIF9fZm10LAogICAgX19idWlsdGluX3ZhX2FyZ19w
YWNrICgpKTsKfQoKCgoKCgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5
c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18gKChfX2FydGlmaWNpYWxfXykpIGludAp2d3ByaW50ZiAoY29uc3Qgd2NoYXJfdCAqX19yZXN0
cmljdCBfX2ZtdCwgX19nbnVjX3ZhX2xpc3QgX19hcCkKewogIHJldHVybiBfX3Z3cHJpbnRmX2No
ayAoMiAtIDEsIF9fZm10LCBfX2FwKTsKfQoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18g
KChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9f
YXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGludAp2ZndwcmludGYgKF9fRklMRSAqX19y
ZXN0cmljdCBfX3N0cmVhbSwKICAgIGNvbnN0IHdjaGFyX3QgKl9fcmVzdHJpY3QgX19mbXQsIF9f
Z251Y192YV9saXN0IF9fYXApCnsKICByZXR1cm4gX192ZndwcmludGZfY2hrIChfX3N0cmVhbSwg
MiAtIDEsIF9fZm10LCBfX2FwKTsKfQoKCgpleHRlcm4gd2NoYXJfdCAqX19mZ2V0d3NfY2hrICh3
Y2hhcl90ICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fc2l6ZSwgaW50IF9fbiwKICAgICAgICAg
X19GSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNl
ZF9yZXN1bHRfXykpOwpleHRlcm4gd2NoYXJfdCAqX19mZ2V0d3NfYWxpYXMgKHdjaGFyX3QgKl9f
cmVzdHJpY3QgX19zLCBpbnQgX19uLCBfX0ZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0pIF9fYXNt
X18gKCIiICJmZ2V0d3MiKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiB3
Y2hhcl90ICpfX2ZnZXR3c19jaGtfd2FybiAod2NoYXJfdCAqX19yZXN0cmljdCBfX3MsIHNpemVf
dCBfX3NpemUsIGludCBfX24sIF9fRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSkgX19hc21fXyAo
IiIgIl9fZmdldHdzX2NoayIpCgoKICAgICBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9y
ZXN1bHRfXykpIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgiZmdldHdzIGNhbGxlZCB3aXRo
IGJpZ2dlciBzaXplIHRoYW4gbGVuZ3RoICIgIm9mIGRlc3RpbmF0aW9uIGJ1ZmZlciIpKSkKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmli
dXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIF9fYXR0cmlidXRlX18gKChfX3dh
cm5fdW51c2VkX3Jlc3VsdF9fKSkgd2NoYXJfdCAqCmZnZXR3cyAod2NoYXJfdCAqX19yZXN0cmlj
dCBfX3MsIGludCBfX24sIF9fRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSkKewogIGlmIChfX2J1
aWx0aW5fb2JqZWN0X3NpemUgKF9fcywgMiA+IDEpICE9IChzaXplX3QpIC0xKQogICAgewogICAg
ICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX24pIHx8IF9fbiA8PSAwKQogcmV0dXJuIF9f
ZmdldHdzX2NoayAoX19zLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcywgMiA+IDEpIC8gc2l6
ZW9mICh3Y2hhcl90KSwKICAgICAgICBfX24sIF9fc3RyZWFtKTsKCiAgICAgIGlmICgoc2l6ZV90
KSBfX24gPiBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcywgMiA+IDEpIC8gc2l6ZW9mICh3Y2hh
cl90KSkKIHJldHVybiBfX2ZnZXR3c19jaGtfd2FybiAoX19zLCBfX2J1aWx0aW5fb2JqZWN0X3Np
emUgKF9fcywgMiA+IDEpIC8gc2l6ZW9mICh3Y2hhcl90KSwKICAgICAgX19uLCBfX3N0cmVhbSk7
CiAgICB9CiAgcmV0dXJuIF9fZmdldHdzX2FsaWFzIChfX3MsIF9fbiwgX19zdHJlYW0pOwp9CgoK
ZXh0ZXJuIHdjaGFyX3QgKl9fZmdldHdzX3VubG9ja2VkX2NoayAod2NoYXJfdCAqX19yZXN0cmlj
dCBfX3MsIHNpemVfdCBfX3NpemUsCiAgICAgICAgICAgaW50IF9fbiwgX19GSUxFICpfX3Jlc3Ry
aWN0IF9fc3RyZWFtKQogIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7
CmV4dGVybiB3Y2hhcl90ICpfX2ZnZXR3c191bmxvY2tlZF9hbGlhcyAod2NoYXJfdCAqX19yZXN0
cmljdCBfX3MsIGludCBfX24sIF9fRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSkgX19hc21fXyAo
IiIgImZnZXR3c191bmxvY2tlZCIpCgoKICBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9y
ZXN1bHRfXykpOwpleHRlcm4gd2NoYXJfdCAqX19mZ2V0d3NfdW5sb2NrZWRfY2hrX3dhcm4gKHdj
aGFyX3QgKl9fcmVzdHJpY3QgX19zLCBzaXplX3QgX19zaXplLCBpbnQgX19uLCBfX0ZJTEUgKl9f
cmVzdHJpY3QgX19zdHJlYW0pIF9fYXNtX18gKCIiICJfX2ZnZXR3c191bmxvY2tlZF9jaGsiKQoK
CgogICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgX19hdHRyaWJ1
dGVfXygoX193YXJuaW5nX18gKCJmZ2V0d3NfdW5sb2NrZWQgY2FsbGVkIHdpdGggYmlnZ2VyIHNp
emUgdGhhbiBsZW5ndGggIiAib2YgZGVzdGluYXRpb24gYnVmZmVyIikpKQogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9f
YWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKSB3Y2hhcl90ICoKZmdldHdzX3VubG9ja2VkICh3Y2hhcl90ICpfX3Jlc3RyaWN0
IF9fcywgaW50IF9fbiwgX19GSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKQp7CiAgaWYgKF9fYnVp
bHRpbl9vYmplY3Rfc2l6ZSAoX19zLCAyID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICB7CiAgICAg
IGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fbikgfHwgX19uIDw9IDApCiByZXR1cm4gX19m
Z2V0d3NfdW5sb2NrZWRfY2hrIChfX3MsIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19zLCAyID4g
MSkgLyBzaXplb2YgKHdjaGFyX3QpLAogICAgICAgICAgX19uLCBfX3N0cmVhbSk7CgogICAgICBp
ZiAoKHNpemVfdCkgX19uID4gX19idWlsdGluX29iamVjdF9zaXplIChfX3MsIDIgPiAxKSAvIHNp
emVvZiAod2NoYXJfdCkpCiByZXR1cm4gX19mZ2V0d3NfdW5sb2NrZWRfY2hrX3dhcm4gKF9fcywg
X19idWlsdGluX29iamVjdF9zaXplIChfX3MsIDIgPiAxKSAvIHNpemVvZiAod2NoYXJfdCksCiAg
ICAgICAgX19uLCBfX3N0cmVhbSk7CiAgICB9CiAgcmV0dXJuIF9fZmdldHdzX3VubG9ja2VkX2Fs
aWFzIChfX3MsIF9fbiwgX19zdHJlYW0pOwp9CgoKCmV4dGVybiBzaXplX3QgX193Y3J0b21iX2No
ayAoY2hhciAqX19yZXN0cmljdCBfX3MsIHdjaGFyX3QgX193Y2hhciwKICAgICAgICBtYnN0YXRl
X3QgKl9fcmVzdHJpY3QgX19wLAogICAgICAgIHNpemVfdCBfX2J1ZmxlbikgdGhyb3cgKCkgX19h
dHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIHNpemVfdCBfX3dj
cnRvbWJfYWxpYXMgKGNoYXIgKl9fcmVzdHJpY3QgX19zLCB3Y2hhcl90IF9fd2NoYXIsIG1ic3Rh
dGVfdCAqX19yZXN0cmljdCBfX3BzKSB0aHJvdyAoKSBfX2FzbV9fICgiIiAid2NydG9tYiIpCgog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2F0dHJpYnV0
ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmli
dXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVf
XykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIF9fYXR0cmlidXRlX18gKChfX3dh
cm5fdW51c2VkX3Jlc3VsdF9fKSkgc2l6ZV90Cl9fYXR0cmlidXRlX18gKChfX2xlYWZfXykpIHdj
cnRvbWIgKGNoYXIgKl9fcmVzdHJpY3QgX19zLCB3Y2hhcl90IF9fd2NoYXIsIG1ic3RhdGVfdCAq
X19yZXN0cmljdCBfX3BzKSB0aHJvdyAoKQoKewoKCgoKCgoKICBpZiAoX19idWlsdGluX29iamVj
dF9zaXplIChfX3MsIDIgPiAxKSAhPSAoc2l6ZV90KSAtMSAmJiAxNiA+IF9fYnVpbHRpbl9vYmpl
Y3Rfc2l6ZSAoX19zLCAyID4gMSkpCiAgICByZXR1cm4gX193Y3J0b21iX2NoayAoX19zLCBfX3dj
aGFyLCBfX3BzLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcywgMiA+IDEpKTsKICByZXR1cm4g
X193Y3J0b21iX2FsaWFzIChfX3MsIF9fd2NoYXIsIF9fcHMpOwp9CgoKZXh0ZXJuIHNpemVfdCBf
X21ic3J0b3djc19jaGsgKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19kc3QsCiAgICAgICAgICBjb25z
dCBjaGFyICoqX19yZXN0cmljdCBfX3NyYywKICAgICAgICAgIHNpemVfdCBfX2xlbiwgbWJzdGF0
ZV90ICpfX3Jlc3RyaWN0IF9fcHMsCiAgICAgICAgICBzaXplX3QgX19kc3RsZW4pIHRocm93ICgp
OwpleHRlcm4gc2l6ZV90IF9fbWJzcnRvd2NzX2FsaWFzICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9f
ZHN0LCBjb25zdCBjaGFyICoqX19yZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbGVuLCBtYnN0YXRl
X3QgKl9fcmVzdHJpY3QgX19wcykgdGhyb3cgKCkgX19hc21fXyAoIiIgIm1ic3J0b3djcyIpCgoK
CiAgICAgICAgICAgICAgICAgICA7CmV4dGVybiBzaXplX3QgX19tYnNydG93Y3NfY2hrX3dhcm4g
KHdjaGFyX3QgKl9fcmVzdHJpY3QgX19kc3QsIGNvbnN0IGNoYXIgKipfX3Jlc3RyaWN0IF9fc3Jj
LCBzaXplX3QgX19sZW4sIG1ic3RhdGVfdCAqX19yZXN0cmljdCBfX3BzLCBzaXplX3QgX19kc3Rs
ZW4pIHRocm93ICgpIF9fYXNtX18gKCIiICJfX21ic3J0b3djc19jaGsiKQoKCgoKICAgICBfX2F0
dHJpYnV0ZV9fKChfX3dhcm5pbmdfXyAoIm1ic3J0b3djcyBjYWxsZWQgd2l0aCBkc3QgYnVmZmVy
IHNtYWxsZXIgdGhhbiBsZW4gIiAiKiBzaXplb2YgKHdjaGFyX3QpIikpKQogICAgICAgICAgICAg
ICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lu
bGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAo
KF9fYXJ0aWZpY2lhbF9fKSkgc2l6ZV90Cl9fYXR0cmlidXRlX18gKChfX2xlYWZfXykpIG1ic3J0
b3djcyAod2NoYXJfdCAqX19yZXN0cmljdCBfX2RzdCwgY29uc3QgY2hhciAqKl9fcmVzdHJpY3Qg
X19zcmMsIHNpemVfdCBfX2xlbiwgbWJzdGF0ZV90ICpfX3Jlc3RyaWN0IF9fcHMpIHRocm93ICgp
Cgp7CiAgaWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kc3QsIDIgPiAxKSAhPSAoc2l6ZV90
KSAtMSkKICAgIHsKICAgICAgaWYgKCFfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19sZW4pKQogcmV0
dXJuIF9fbWJzcnRvd2NzX2NoayAoX19kc3QsIF9fc3JjLCBfX2xlbiwgX19wcywKICAgIF9fYnVp
bHRpbl9vYmplY3Rfc2l6ZSAoX19kc3QsIDIgPiAxKSAvIHNpemVvZiAod2NoYXJfdCkpOwoKICAg
ICAgaWYgKF9fbGVuID4gX19idWlsdGluX29iamVjdF9zaXplIChfX2RzdCwgMiA+IDEpIC8gc2l6
ZW9mICh3Y2hhcl90KSkKIHJldHVybiBfX21ic3J0b3djc19jaGtfd2FybiAoX19kc3QsIF9fc3Jj
LCBfX2xlbiwgX19wcywKICAgICAgICAgX19idWlsdGluX29iamVjdF9zaXplIChfX2RzdCwgMiA+
IDEpIC8gc2l6ZW9mICh3Y2hhcl90KSk7CiAgICB9CiAgcmV0dXJuIF9fbWJzcnRvd2NzX2FsaWFz
IChfX2RzdCwgX19zcmMsIF9fbGVuLCBfX3BzKTsKfQoKCmV4dGVybiBzaXplX3QgX193Y3NydG9t
YnNfY2hrIChjaGFyICpfX3Jlc3RyaWN0IF9fZHN0LAogICAgICAgICAgY29uc3Qgd2NoYXJfdCAq
Kl9fcmVzdHJpY3QgX19zcmMsCiAgICAgICAgICBzaXplX3QgX19sZW4sIG1ic3RhdGVfdCAqX19y
ZXN0cmljdCBfX3BzLAogICAgICAgICAgc2l6ZV90IF9fZHN0bGVuKSB0aHJvdyAoKTsKZXh0ZXJu
IHNpemVfdCBfX3djc3J0b21ic19hbGlhcyAoY2hhciAqX19yZXN0cmljdCBfX2RzdCwgY29uc3Qg
d2NoYXJfdCAqKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX2xlbiwgbWJzdGF0ZV90ICpfX3Jl
c3RyaWN0IF9fcHMpIHRocm93ICgpIF9fYXNtX18gKCIiICJ3Y3NydG9tYnMiKQoKCgogICAgICAg
ICAgICAgICAgICAgOwpleHRlcm4gc2l6ZV90IF9fd2NzcnRvbWJzX2Noa193YXJuIChjaGFyICpf
X3Jlc3RyaWN0IF9fZHN0LCBjb25zdCB3Y2hhcl90ICoqX19yZXN0cmljdCBfX3NyYywgc2l6ZV90
IF9fbGVuLCBtYnN0YXRlX3QgKl9fcmVzdHJpY3QgX19wcywgc2l6ZV90IF9fZHN0bGVuKSB0aHJv
dyAoKSBfX2FzbV9fICgiIiAiX193Y3NydG9tYnNfY2hrIikKCgoKCiAgICBfX2F0dHJpYnV0ZV9f
KChfX3dhcm5pbmdfXyAoIndjc3J0b21icyBjYWxsZWQgd2l0aCBkc3QgYnVmZmVyIHNtYWxsZXIg
dGhhbiBsZW4iKSkpOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18g
KChfX2FydGlmaWNpYWxfXykpIHNpemVfdApfX2F0dHJpYnV0ZV9fICgoX19sZWFmX18pKSB3Y3Ny
dG9tYnMgKGNoYXIgKl9fcmVzdHJpY3QgX19kc3QsIGNvbnN0IHdjaGFyX3QgKipfX3Jlc3RyaWN0
IF9fc3JjLCBzaXplX3QgX19sZW4sIG1ic3RhdGVfdCAqX19yZXN0cmljdCBfX3BzKSB0aHJvdyAo
KQoKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fZHN0LCAyID4gMSkgIT0gKHNpemVf
dCkgLTEpCiAgICB7CiAgICAgIGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fbGVuKSkKIHJl
dHVybiBfX3djc3J0b21ic19jaGsgKF9fZHN0LCBfX3NyYywgX19sZW4sIF9fcHMsIF9fYnVpbHRp
bl9vYmplY3Rfc2l6ZSAoX19kc3QsIDIgPiAxKSk7CgogICAgICBpZiAoX19sZW4gPiBfX2J1aWx0
aW5fb2JqZWN0X3NpemUgKF9fZHN0LCAyID4gMSkpCiByZXR1cm4gX193Y3NydG9tYnNfY2hrX3dh
cm4gKF9fZHN0LCBfX3NyYywgX19sZW4sIF9fcHMsIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19k
c3QsIDIgPiAxKSk7CiAgICB9CiAgcmV0dXJuIF9fd2NzcnRvbWJzX2FsaWFzIChfX2RzdCwgX19z
cmMsIF9fbGVuLCBfX3BzKTsKfQoKCgpleHRlcm4gc2l6ZV90IF9fbWJzbnJ0b3djc19jaGsgKHdj
aGFyX3QgKl9fcmVzdHJpY3QgX19kc3QsCiAgICBjb25zdCBjaGFyICoqX19yZXN0cmljdCBfX3Ny
Yywgc2l6ZV90IF9fbm1jLAogICAgc2l6ZV90IF9fbGVuLCBtYnN0YXRlX3QgKl9fcmVzdHJpY3Qg
X19wcywKICAgIHNpemVfdCBfX2RzdGxlbikgdGhyb3cgKCk7CmV4dGVybiBzaXplX3QgX19tYnNu
cnRvd2NzX2FsaWFzICh3Y2hhcl90ICpfX3Jlc3RyaWN0IF9fZHN0LCBjb25zdCBjaGFyICoqX19y
ZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbm1jLCBzaXplX3QgX19sZW4sIG1ic3RhdGVfdCAqX19y
ZXN0cmljdCBfX3BzKSB0aHJvdyAoKSBfX2FzbV9fICgiIiAibWJzbnJ0b3djcyIpCgoKCiAgICAg
ICAgICAgICAgICAgICAgOwpleHRlcm4gc2l6ZV90IF9fbWJzbnJ0b3djc19jaGtfd2FybiAod2No
YXJfdCAqX19yZXN0cmljdCBfX2RzdCwgY29uc3QgY2hhciAqKl9fcmVzdHJpY3QgX19zcmMsIHNp
emVfdCBfX25tYywgc2l6ZV90IF9fbGVuLCBtYnN0YXRlX3QgKl9fcmVzdHJpY3QgX19wcywgc2l6
ZV90IF9fZHN0bGVuKSB0aHJvdyAoKSBfX2FzbV9fICgiIiAiX19tYnNucnRvd2NzX2NoayIpCgoK
CgogICAgIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgibWJzbnJ0b3djcyBjYWxsZWQgd2l0
aCBkc3QgYnVmZmVyIHNtYWxsZXIgdGhhbiBsZW4gIiAiKiBzaXplb2YgKHdjaGFyX3QpIikpKQog
ICAgICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAo
KF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19h
dHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgc2l6ZV90Cl9fYXR0cmlidXRlX18gKChfX2xl
YWZfXykpIG1ic25ydG93Y3MgKHdjaGFyX3QgKl9fcmVzdHJpY3QgX19kc3QsIGNvbnN0IGNoYXIg
KipfX3Jlc3RyaWN0IF9fc3JjLCBzaXplX3QgX19ubWMsIHNpemVfdCBfX2xlbiwgbWJzdGF0ZV90
ICpfX3Jlc3RyaWN0IF9fcHMpIHRocm93ICgpCgp7CiAgaWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6
ZSAoX19kc3QsIDIgPiAxKSAhPSAoc2l6ZV90KSAtMSkKICAgIHsKICAgICAgaWYgKCFfX2J1aWx0
aW5fY29uc3RhbnRfcCAoX19sZW4pKQogcmV0dXJuIF9fbWJzbnJ0b3djc19jaGsgKF9fZHN0LCBf
X3NyYywgX19ubWMsIF9fbGVuLCBfX3BzLAogICAgIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19k
c3QsIDIgPiAxKSAvIHNpemVvZiAod2NoYXJfdCkpOwoKICAgICAgaWYgKF9fbGVuID4gX19idWls
dGluX29iamVjdF9zaXplIChfX2RzdCwgMiA+IDEpIC8gc2l6ZW9mICh3Y2hhcl90KSkKIHJldHVy
biBfX21ic25ydG93Y3NfY2hrX3dhcm4gKF9fZHN0LCBfX3NyYywgX19ubWMsIF9fbGVuLCBfX3Bz
LAogICAgICAgICAgX19idWlsdGluX29iamVjdF9zaXplIChfX2RzdCwgMiA+IDEpIC8gc2l6ZW9m
ICh3Y2hhcl90KSk7CiAgICB9CiAgcmV0dXJuIF9fbWJzbnJ0b3djc19hbGlhcyAoX19kc3QsIF9f
c3JjLCBfX25tYywgX19sZW4sIF9fcHMpOwp9CgoKZXh0ZXJuIHNpemVfdCBfX3djc25ydG9tYnNf
Y2hrIChjaGFyICpfX3Jlc3RyaWN0IF9fZHN0LAogICAgY29uc3Qgd2NoYXJfdCAqKl9fcmVzdHJp
Y3QgX19zcmMsCiAgICBzaXplX3QgX19ud2MsIHNpemVfdCBfX2xlbiwKICAgIG1ic3RhdGVfdCAq
X19yZXN0cmljdCBfX3BzLCBzaXplX3QgX19kc3RsZW4pCiAgICAgdGhyb3cgKCk7CmV4dGVybiBz
aXplX3QgX193Y3NucnRvbWJzX2FsaWFzIChjaGFyICpfX3Jlc3RyaWN0IF9fZHN0LCBjb25zdCB3
Y2hhcl90ICoqX19yZXN0cmljdCBfX3NyYywgc2l6ZV90IF9fbndjLCBzaXplX3QgX19sZW4sIG1i
c3RhdGVfdCAqX19yZXN0cmljdCBfX3BzKSB0aHJvdyAoKSBfX2FzbV9fICgiIiAid2NzbnJ0b21i
cyIpCgoKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
OwpleHRlcm4gc2l6ZV90IF9fd2NzbnJ0b21ic19jaGtfd2FybiAoY2hhciAqX19yZXN0cmljdCBf
X2RzdCwgY29uc3Qgd2NoYXJfdCAqKl9fcmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX253Yywgc2l6
ZV90IF9fbGVuLCBtYnN0YXRlX3QgKl9fcmVzdHJpY3QgX19wcywgc2l6ZV90IF9fZHN0bGVuKSB0
aHJvdyAoKSBfX2FzbV9fICgiIiAiX193Y3NucnRvbWJzX2NoayIpCgoKCgoKICAgICBfX2F0dHJp
YnV0ZV9fKChfX3dhcm5pbmdfXyAoIndjc25ydG9tYnMgY2FsbGVkIHdpdGggZHN0IGJ1ZmZlciBz
bWFsbGVyIHRoYW4gbGVuIikpKTsKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19h
bHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBzaXplX3QKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9f
KSkgd2NzbnJ0b21icyAoY2hhciAqX19yZXN0cmljdCBfX2RzdCwgY29uc3Qgd2NoYXJfdCAqKl9f
cmVzdHJpY3QgX19zcmMsIHNpemVfdCBfX253Yywgc2l6ZV90IF9fbGVuLCBtYnN0YXRlX3QgKl9f
cmVzdHJpY3QgX19wcykgdGhyb3cgKCkKCnsKICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChf
X2RzdCwgMiA+IDEpICE9IChzaXplX3QpIC0xKQogICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9j
b25zdGFudF9wIChfX2xlbikpCiByZXR1cm4gX193Y3NucnRvbWJzX2NoayAoX19kc3QsIF9fc3Jj
LCBfX253YywgX19sZW4sIF9fcHMsCiAgICAgX19idWlsdGluX29iamVjdF9zaXplIChfX2RzdCwg
MiA+IDEpKTsKCiAgICAgIGlmIChfX2xlbiA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19kc3Qs
IDIgPiAxKSkKIHJldHVybiBfX3djc25ydG9tYnNfY2hrX3dhcm4gKF9fZHN0LCBfX3NyYywgX19u
d2MsIF9fbGVuLCBfX3BzLAogICAgICAgICAgX19idWlsdGluX29iamVjdF9zaXplIChfX2RzdCwg
MiA+IDEpKTsKICAgIH0KICByZXR1cm4gX193Y3NucnRvbWJzX2FsaWFzIChfX2RzdCwgX19zcmMs
IF9fbndjLCBfX2xlbiwgX19wcyk7Cn0KIyA4ODggIi91c3IvaW5jbHVkZS93Y2hhci5oIiAyIDMg
NAoKCgoKCgp9CiMgNDUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3djaGFyIiAyIDMKIyA2MiAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jd2NoYXIiIDMKbmFtZXNwYWNlIHN0ZAp7CiAgdXNpbmcg
OjptYnN0YXRlX3Q7Cn0KIyAxMzUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3djaGFyIiAzCm5h
bWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkK
ewoKCiAgdXNpbmcgOjp3aW50X3Q7CgogIHVzaW5nIDo6YnRvd2M7CiAgdXNpbmcgOjpmZ2V0d2M7
CiAgdXNpbmcgOjpmZ2V0d3M7CiAgdXNpbmcgOjpmcHV0d2M7CiAgdXNpbmcgOjpmcHV0d3M7CiAg
dXNpbmcgOjpmd2lkZTsKICB1c2luZyA6OmZ3cHJpbnRmOwogIHVzaW5nIDo6ZndzY2FuZjsKICB1
c2luZyA6OmdldHdjOwogIHVzaW5nIDo6Z2V0d2NoYXI7CiAgdXNpbmcgOjptYnJsZW47CiAgdXNp
bmcgOjptYnJ0b3djOwogIHVzaW5nIDo6bWJzaW5pdDsKICB1c2luZyA6Om1ic3J0b3djczsKICB1
c2luZyA6OnB1dHdjOwogIHVzaW5nIDo6cHV0d2NoYXI7CgogIHVzaW5nIDo6c3dwcmludGY7Cgog
IHVzaW5nIDo6c3dzY2FuZjsKICB1c2luZyA6OnVuZ2V0d2M7CiAgdXNpbmcgOjp2ZndwcmludGY7
CgogIHVzaW5nIDo6dmZ3c2NhbmY7CgoKICB1c2luZyA6OnZzd3ByaW50ZjsKCgogIHVzaW5nIDo6
dnN3c2NhbmY7CgogIHVzaW5nIDo6dndwcmludGY7CgogIHVzaW5nIDo6dndzY2FuZjsKCiAgdXNp
bmcgOjp3Y3J0b21iOwogIHVzaW5nIDo6d2NzY2F0OwogIHVzaW5nIDo6d2NzY21wOwogIHVzaW5n
IDo6d2NzY29sbDsKICB1c2luZyA6Ondjc2NweTsKICB1c2luZyA6Ondjc2NzcG47CiAgdXNpbmcg
Ojp3Y3NmdGltZTsKICB1c2luZyA6Ondjc2xlbjsKICB1c2luZyA6Ondjc25jYXQ7CiAgdXNpbmcg
Ojp3Y3NuY21wOwogIHVzaW5nIDo6d2NzbmNweTsKICB1c2luZyA6Ondjc3J0b21iczsKICB1c2lu
ZyA6Ondjc3NwbjsKICB1c2luZyA6Ondjc3RvZDsKCiAgdXNpbmcgOjp3Y3N0b2Y7CgogIHVzaW5n
IDo6d2NzdG9rOwogIHVzaW5nIDo6d2NzdG9sOwogIHVzaW5nIDo6d2NzdG91bDsKICB1c2luZyA6
Ondjc3hmcm07CiAgdXNpbmcgOjp3Y3RvYjsKICB1c2luZyA6OndtZW1jbXA7CiAgdXNpbmcgOjp3
bWVtY3B5OwogIHVzaW5nIDo6d21lbW1vdmU7CiAgdXNpbmcgOjp3bWVtc2V0OwogIHVzaW5nIDo6
d3ByaW50ZjsKICB1c2luZyA6OndzY2FuZjsKICB1c2luZyA6Ondjc2NocjsKICB1c2luZyA6Ondj
c3Bicms7CiAgdXNpbmcgOjp3Y3NyY2hyOwogIHVzaW5nIDo6d2Nzc3RyOwogIHVzaW5nIDo6d21l
bWNocjsKIyAyMzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3djaGFyIiAzCgp9CgoKCgoKCgpu
YW1lc3BhY2UgX19nbnVfY3h4CnsKCgoKCgogIHVzaW5nIDo6d2NzdG9sZDsKIyAyNTcgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvY3djaGFyIiAzCiAgdXNpbmcgOjp3Y3N0b2xsOwogIHVzaW5nIDo6
d2NzdG91bGw7Cgp9CgpuYW1lc3BhY2Ugc3RkCnsKICB1c2luZyA6Ol9fZ251X2N4eDo6d2NzdG9s
ZDsKICB1c2luZyA6Ol9fZ251X2N4eDo6d2NzdG9sbDsKICB1c2luZyA6Ol9fZ251X2N4eDo6d2Nz
dG91bGw7Cn0KIyAyNzcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3djaGFyIiAzCm5hbWVzcGFj
ZSBzdGQKewoKICB1c2luZyBzdGQ6Ondjc3RvZjsKCgogIHVzaW5nIHN0ZDo6dmZ3c2NhbmY7CgoK
ICB1c2luZyBzdGQ6OnZzd3NjYW5mOwoKCiAgdXNpbmcgc3RkOjp2d3NjYW5mOwoKCgogIHVzaW5n
IHN0ZDo6d2NzdG9sZDsKICB1c2luZyBzdGQ6Ondjc3RvbGw7CiAgdXNpbmcgc3RkOjp3Y3N0b3Vs
bDsKCn0KIyA0MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3Bvc3R5cGVzLmgiIDIgMwoj
IDY4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvcG9zdHlwZXMuaCIgMwpuYW1lc3BhY2Ug
c3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCiMgODgg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9wb3N0eXBlcy5oIiAzCiAgdHlwZWRlZiBsb25n
IHN0cmVhbW9mZjsKIyA5OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3Bvc3R5cGVzLmgi
IDMKICB0eXBlZGVmIHB0cmRpZmZfdCBzdHJlYW1zaXplOwojIDExMSAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL3Bvc3R5cGVzLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfU3RhdGVUPgog
ICAgY2xhc3MgZnBvcwogICAgewogICAgcHJpdmF0ZToKICAgICAgc3RyZWFtb2ZmIF9NX29mZjsK
ICAgICAgX1N0YXRlVCBfTV9zdGF0ZTsKCiAgICBwdWJsaWM6CgoKCgogICAgICBmcG9zKCkKICAg
ICAgOiBfTV9vZmYoMCksIF9NX3N0YXRlKCkgeyB9CiMgMTMzICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvcG9zdHlwZXMuaCIgMwogICAgICBmcG9zKHN0cmVhbW9mZiBfX29mZikKICAgICAg
OiBfTV9vZmYoX19vZmYpLCBfTV9zdGF0ZSgpIHsgfQoKCiAgICAgIG9wZXJhdG9yIHN0cmVhbW9m
ZigpIGNvbnN0IHsgcmV0dXJuIF9NX29mZjsgfQoKCiAgICAgIHZvaWQKICAgICAgc3RhdGUoX1N0
YXRlVCBfX3N0KQogICAgICB7IF9NX3N0YXRlID0gX19zdDsgfQoKCiAgICAgIF9TdGF0ZVQKICAg
ICAgc3RhdGUoKSBjb25zdAogICAgICB7IHJldHVybiBfTV9zdGF0ZTsgfQoKCgoKCiAgICAgIGZw
b3MmCiAgICAgIG9wZXJhdG9yKz0oc3RyZWFtb2ZmIF9fb2ZmKQogICAgICB7CiBfTV9vZmYgKz0g
X19vZmY7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCgoKCgogICAgICBmcG9zJgogICAgICBvcGVy
YXRvci09KHN0cmVhbW9mZiBfX29mZikKICAgICAgewogX01fb2ZmIC09IF9fb2ZmOwogcmV0dXJu
ICp0aGlzOwogICAgICB9CgoKCgoKCgogICAgICBmcG9zCiAgICAgIG9wZXJhdG9yKyhzdHJlYW1v
ZmYgX19vZmYpIGNvbnN0CiAgICAgIHsKIGZwb3MgX19wb3MoKnRoaXMpOwogX19wb3MgKz0gX19v
ZmY7CiByZXR1cm4gX19wb3M7CiAgICAgIH0KCgoKCgoKCiAgICAgIGZwb3MKICAgICAgb3BlcmF0
b3ItKHN0cmVhbW9mZiBfX29mZikgY29uc3QKICAgICAgewogZnBvcyBfX3BvcygqdGhpcyk7CiBf
X3BvcyAtPSBfX29mZjsKIHJldHVybiBfX3BvczsKICAgICAgfQoKCgoKCgogICAgICBzdHJlYW1v
ZmYKICAgICAgb3BlcmF0b3ItKGNvbnN0IGZwb3MmIF9fb3RoZXIpIGNvbnN0CiAgICAgIHsgcmV0
dXJuIF9NX29mZiAtIF9fb3RoZXIuX01fb2ZmOyB9CiAgICB9OwoKCgoKCgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9TdGF0ZVQ+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I9PShjb25zdCBmcG9z
PF9TdGF0ZVQ+JiBfX2xocywgY29uc3QgZnBvczxfU3RhdGVUPiYgX19yaHMpCiAgICB7IHJldHVy
biBzdHJlYW1vZmYoX19saHMpID09IHN0cmVhbW9mZihfX3Jocyk7IH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1N0YXRlVD4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvciE9KGNvbnN0IGZwb3M8
X1N0YXRlVD4mIF9fbGhzLCBjb25zdCBmcG9zPF9TdGF0ZVQ+JiBfX3JocykKICAgIHsgcmV0dXJu
IHN0cmVhbW9mZihfX2xocykgIT0gc3RyZWFtb2ZmKF9fcmhzKTsgfQoKCgoKCiAgdHlwZWRlZiBm
cG9zPG1ic3RhdGVfdD4gc3RyZWFtcG9zOwoKICB0eXBlZGVmIGZwb3M8bWJzdGF0ZV90PiB3c3Ry
ZWFtcG9zOwoKCgogIHR5cGVkZWYgZnBvczxtYnN0YXRlX3Q+IHUxNnN0cmVhbXBvczsKCiAgdHlw
ZWRlZiBmcG9zPG1ic3RhdGVfdD4gdTMyc3RyZWFtcG9zOwoKCgp9CiMgNDEgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvaW9zZndkIiAyIDMKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9f
dmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKIyA3NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9pb3Nmd2QiIDMKICBjbGFzcyBpb3NfYmFzZTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJU
LCB0eXBlbmFtZSBfVHJhaXRzID0gY2hhcl90cmFpdHM8X0NoYXJUPiA+CiAgICBjbGFzcyBiYXNp
Y19pb3M7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cyA9IGNo
YXJfdHJhaXRzPF9DaGFyVD4gPgogICAgY2xhc3MgYmFzaWNfc3RyZWFtYnVmOwoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMgPSBjaGFyX3RyYWl0czxfQ2hhclQ+
ID4KICAgIGNsYXNzIGJhc2ljX2lzdHJlYW07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwg
dHlwZW5hbWUgX1RyYWl0cyA9IGNoYXJfdHJhaXRzPF9DaGFyVD4gPgogICAgY2xhc3MgYmFzaWNf
b3N0cmVhbTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzID0g
Y2hhcl90cmFpdHM8X0NoYXJUPiA+CiAgICBjbGFzcyBiYXNpY19pb3N0cmVhbTsKCgpuYW1lc3Bh
Y2UgX19jeHgxMSB7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0
cyA9IGNoYXJfdHJhaXRzPF9DaGFyVD4sCiAgICAgdHlwZW5hbWUgX0FsbG9jID0gYWxsb2NhdG9y
PF9DaGFyVD4gPgogICAgY2xhc3MgYmFzaWNfc3RyaW5nYnVmOwoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMgPSBjaGFyX3RyYWl0czxfQ2hhclQ+LAogICAgdHlw
ZW5hbWUgX0FsbG9jID0gYWxsb2NhdG9yPF9DaGFyVD4gPgogICAgY2xhc3MgYmFzaWNfaXN0cmlu
Z3N0cmVhbTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzID0g
Y2hhcl90cmFpdHM8X0NoYXJUPiwKICAgIHR5cGVuYW1lIF9BbGxvYyA9IGFsbG9jYXRvcjxfQ2hh
clQ+ID4KICAgIGNsYXNzIGJhc2ljX29zdHJpbmdzdHJlYW07CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cyA9IGNoYXJfdHJhaXRzPF9DaGFyVD4sCiAgICB0eXBl
bmFtZSBfQWxsb2MgPSBhbGxvY2F0b3I8X0NoYXJUPiA+CiAgICBjbGFzcyBiYXNpY19zdHJpbmdz
dHJlYW07Cgp9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cyA9
IGNoYXJfdHJhaXRzPF9DaGFyVD4gPgogICAgY2xhc3MgYmFzaWNfZmlsZWJ1ZjsKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzID0gY2hhcl90cmFpdHM8X0NoYXJU
PiA+CiAgICBjbGFzcyBiYXNpY19pZnN0cmVhbTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJU
LCB0eXBlbmFtZSBfVHJhaXRzID0gY2hhcl90cmFpdHM8X0NoYXJUPiA+CiAgICBjbGFzcyBiYXNp
Y19vZnN0cmVhbTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRz
ID0gY2hhcl90cmFpdHM8X0NoYXJUPiA+CiAgICBjbGFzcyBiYXNpY19mc3RyZWFtOwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMgPSBjaGFyX3RyYWl0czxfQ2hh
clQ+ID4KICAgIGNsYXNzIGlzdHJlYW1idWZfaXRlcmF0b3I7CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cyA9IGNoYXJfdHJhaXRzPF9DaGFyVD4gPgogICAgY2xh
c3Mgb3N0cmVhbWJ1Zl9pdGVyYXRvcjsKCgoKICB0eXBlZGVmIGJhc2ljX2lvczxjaGFyPiBpb3M7
CgoKICB0eXBlZGVmIGJhc2ljX3N0cmVhbWJ1ZjxjaGFyPiBzdHJlYW1idWY7CgoKICB0eXBlZGVm
IGJhc2ljX2lzdHJlYW08Y2hhcj4gaXN0cmVhbTsKCgogIHR5cGVkZWYgYmFzaWNfb3N0cmVhbTxj
aGFyPiBvc3RyZWFtOwoKCiAgdHlwZWRlZiBiYXNpY19pb3N0cmVhbTxjaGFyPiBpb3N0cmVhbTsK
CgogIHR5cGVkZWYgYmFzaWNfc3RyaW5nYnVmPGNoYXI+IHN0cmluZ2J1ZjsKCgogIHR5cGVkZWYg
YmFzaWNfaXN0cmluZ3N0cmVhbTxjaGFyPiBpc3RyaW5nc3RyZWFtOwoKCiAgdHlwZWRlZiBiYXNp
Y19vc3RyaW5nc3RyZWFtPGNoYXI+IG9zdHJpbmdzdHJlYW07CgoKICB0eXBlZGVmIGJhc2ljX3N0
cmluZ3N0cmVhbTxjaGFyPiBzdHJpbmdzdHJlYW07CgoKICB0eXBlZGVmIGJhc2ljX2ZpbGVidWY8
Y2hhcj4gZmlsZWJ1ZjsKCgogIHR5cGVkZWYgYmFzaWNfaWZzdHJlYW08Y2hhcj4gaWZzdHJlYW07
CgoKICB0eXBlZGVmIGJhc2ljX29mc3RyZWFtPGNoYXI+IG9mc3RyZWFtOwoKCiAgdHlwZWRlZiBi
YXNpY19mc3RyZWFtPGNoYXI+IGZzdHJlYW07CgoKCiAgdHlwZWRlZiBiYXNpY19pb3M8d2NoYXJf
dD4gd2lvczsKCgogIHR5cGVkZWYgYmFzaWNfc3RyZWFtYnVmPHdjaGFyX3Q+IHdzdHJlYW1idWY7
CgoKICB0eXBlZGVmIGJhc2ljX2lzdHJlYW08d2NoYXJfdD4gd2lzdHJlYW07CgoKICB0eXBlZGVm
IGJhc2ljX29zdHJlYW08d2NoYXJfdD4gd29zdHJlYW07CgoKICB0eXBlZGVmIGJhc2ljX2lvc3Ry
ZWFtPHdjaGFyX3Q+IHdpb3N0cmVhbTsKCgogIHR5cGVkZWYgYmFzaWNfc3RyaW5nYnVmPHdjaGFy
X3Q+IHdzdHJpbmdidWY7CgoKICB0eXBlZGVmIGJhc2ljX2lzdHJpbmdzdHJlYW08d2NoYXJfdD4g
d2lzdHJpbmdzdHJlYW07CgoKICB0eXBlZGVmIGJhc2ljX29zdHJpbmdzdHJlYW08d2NoYXJfdD4g
d29zdHJpbmdzdHJlYW07CgoKICB0eXBlZGVmIGJhc2ljX3N0cmluZ3N0cmVhbTx3Y2hhcl90PiB3
c3RyaW5nc3RyZWFtOwoKCiAgdHlwZWRlZiBiYXNpY19maWxlYnVmPHdjaGFyX3Q+IHdmaWxlYnVm
OwoKCiAgdHlwZWRlZiBiYXNpY19pZnN0cmVhbTx3Y2hhcl90PiB3aWZzdHJlYW07CgoKICB0eXBl
ZGVmIGJhc2ljX29mc3RyZWFtPHdjaGFyX3Q+IHdvZnN0cmVhbTsKCgogIHR5cGVkZWYgYmFzaWNf
ZnN0cmVhbTx3Y2hhcl90PiB3ZnN0cmVhbTsKCgoKCn0KIyAzOSAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9pb3MiIDIgMwoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvY2hhcl90cmFp
dHMuaCIgMSAzCiMgMzcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9jaGFyX3RyYWl0cy5o
IiAzCiAgICAgICAKIyAzOCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2NoYXJfdHJhaXRz
LmgiIDMKCgoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2N3Y2hhciIgMSAzCiMgMzkgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvY3djaGFyIiAzCiAgICAgICAKIyA0MCAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9jd2NoYXIiIDMKCgoKCiMgMSAiL3Vzci9pbmNsdWRlL3djaGFyLmgiIDEgMyA0
CiMgNDUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3djaGFyIiAyIDMKIyA0MiAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL2NoYXJfdHJhaXRzLmgiIDIgMwoKbmFtZXNwYWNlIF9fZ251X2N4
eCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgojIDU3ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvY2hhcl90cmFpdHMuaCIgMwogIHRlbXBsYXRlPHR5
cGVuYW1lIF9DaGFyVD4KICAgIHN0cnVjdCBfQ2hhcl90eXBlcwogICAgewogICAgICB0eXBlZGVm
IHVuc2lnbmVkIGxvbmcgaW50X3R5cGU7CiAgICAgIHR5cGVkZWYgc3RkOjpzdHJlYW1wb3MgcG9z
X3R5cGU7CiAgICAgIHR5cGVkZWYgc3RkOjpzdHJlYW1vZmYgb2ZmX3R5cGU7CiAgICAgIHR5cGVk
ZWYgc3RkOjptYnN0YXRlX3Qgc3RhdGVfdHlwZTsKICAgIH07CiMgODIgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9jaGFyX3RyYWl0cy5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJU
PgogICAgc3RydWN0IGNoYXJfdHJhaXRzCiAgICB7CiAgICAgIHR5cGVkZWYgX0NoYXJUIGNoYXJf
dHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQ2hhcl90eXBlczxfQ2hhclQ+OjppbnRfdHlw
ZSBpbnRfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQ2hhcl90eXBlczxfQ2hhclQ+Ojpw
b3NfdHlwZSBwb3NfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQ2hhcl90eXBlczxfQ2hh
clQ+OjpvZmZfdHlwZSBvZmZfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQ2hhcl90eXBl
czxfQ2hhclQ+OjpzdGF0ZV90eXBlIHN0YXRlX3R5cGU7CgogICAgICBzdGF0aWMgdm9pZAogICAg
ICBhc3NpZ24oY2hhcl90eXBlJiBfX2MxLCBjb25zdCBjaGFyX3R5cGUmIF9fYzIpCiAgICAgIHsg
X19jMSA9IF9fYzI7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbAogICAgICBlcShjb25z
dCBjaGFyX3R5cGUmIF9fYzEsIGNvbnN0IGNoYXJfdHlwZSYgX19jMikKICAgICAgeyByZXR1cm4g
X19jMSA9PSBfX2MyOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wKICAgICAgbHQoY29u
c3QgY2hhcl90eXBlJiBfX2MxLCBjb25zdCBjaGFyX3R5cGUmIF9fYzIpCiAgICAgIHsgcmV0dXJu
IF9fYzEgPCBfX2MyOyB9CgogICAgICBzdGF0aWMgaW50CiAgICAgIGNvbXBhcmUoY29uc3QgY2hh
cl90eXBlKiBfX3MxLCBjb25zdCBjaGFyX3R5cGUqIF9fczIsIHN0ZDo6c2l6ZV90IF9fbik7Cgog
ICAgICBzdGF0aWMgc3RkOjpzaXplX3QKICAgICAgbGVuZ3RoKGNvbnN0IGNoYXJfdHlwZSogX19z
KTsKCiAgICAgIHN0YXRpYyBjb25zdCBjaGFyX3R5cGUqCiAgICAgIGZpbmQoY29uc3QgY2hhcl90
eXBlKiBfX3MsIHN0ZDo6c2l6ZV90IF9fbiwgY29uc3QgY2hhcl90eXBlJiBfX2EpOwoKICAgICAg
c3RhdGljIGNoYXJfdHlwZSoKICAgICAgbW92ZShjaGFyX3R5cGUqIF9fczEsIGNvbnN0IGNoYXJf
dHlwZSogX19zMiwgc3RkOjpzaXplX3QgX19uKTsKCiAgICAgIHN0YXRpYyBjaGFyX3R5cGUqCiAg
ICAgIGNvcHkoY2hhcl90eXBlKiBfX3MxLCBjb25zdCBjaGFyX3R5cGUqIF9fczIsIHN0ZDo6c2l6
ZV90IF9fbik7CgogICAgICBzdGF0aWMgY2hhcl90eXBlKgogICAgICBhc3NpZ24oY2hhcl90eXBl
KiBfX3MsIHN0ZDo6c2l6ZV90IF9fbiwgY2hhcl90eXBlIF9fYSk7CgogICAgICBzdGF0aWMgY29u
c3RleHByIGNoYXJfdHlwZQogICAgICB0b19jaGFyX3R5cGUoY29uc3QgaW50X3R5cGUmIF9fYykK
ICAgICAgeyByZXR1cm4gc3RhdGljX2Nhc3Q8Y2hhcl90eXBlPihfX2MpOyB9CgogICAgICBzdGF0
aWMgY29uc3RleHByIGludF90eXBlCiAgICAgIHRvX2ludF90eXBlKGNvbnN0IGNoYXJfdHlwZSYg
X19jKQogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxpbnRfdHlwZT4oX19jKTsgfQoKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBib29sCiAgICAgIGVxX2ludF90eXBlKGNvbnN0IGludF90eXBlJiBf
X2MxLCBjb25zdCBpbnRfdHlwZSYgX19jMikKICAgICAgeyByZXR1cm4gX19jMSA9PSBfX2MyOyB9
CgogICAgICBzdGF0aWMgY29uc3RleHByIGludF90eXBlCiAgICAgIGVvZigpCiAgICAgIHsgcmV0
dXJuIHN0YXRpY19jYXN0PGludF90eXBlPigtMSk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
aW50X3R5cGUKICAgICAgbm90X2VvZihjb25zdCBpbnRfdHlwZSYgX19jKQogICAgICB7IHJldHVy
biAhZXFfaW50X3R5cGUoX19jLCBlb2YoKSkgPyBfX2MgOiB0b19pbnRfdHlwZShjaGFyX3R5cGUo
KSk7IH0KICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIGludAogICAgY2hh
cl90cmFpdHM8X0NoYXJUPjo6CiAgICBjb21wYXJlKGNvbnN0IGNoYXJfdHlwZSogX19zMSwgY29u
c3QgY2hhcl90eXBlKiBfX3MyLCBzdGQ6OnNpemVfdCBfX24pCiAgICB7CiAgICAgIGZvciAoc3Rk
OjpzaXplX3QgX19pID0gMDsgX19pIDwgX19uOyArK19faSkKIGlmIChsdChfX3MxW19faV0sIF9f
czJbX19pXSkpCiAgIHJldHVybiAtMTsKIGVsc2UgaWYgKGx0KF9fczJbX19pXSwgX19zMVtfX2ld
KSkKICAgcmV0dXJuIDE7CiAgICAgIHJldHVybiAwOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfQ2hhclQ+CiAgICBzdGQ6OnNpemVfdAogICAgY2hhcl90cmFpdHM8X0NoYXJUPjo6CiAgICBs
ZW5ndGgoY29uc3QgY2hhcl90eXBlKiBfX3ApCiAgICB7CiAgICAgIHN0ZDo6c2l6ZV90IF9faSA9
IDA7CiAgICAgIHdoaWxlICghZXEoX19wW19faV0sIGNoYXJfdHlwZSgpKSkKICAgICAgICArK19f
aTsKICAgICAgcmV0dXJuIF9faTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgog
ICAgY29uc3QgdHlwZW5hbWUgY2hhcl90cmFpdHM8X0NoYXJUPjo6Y2hhcl90eXBlKgogICAgY2hh
cl90cmFpdHM8X0NoYXJUPjo6CiAgICBmaW5kKGNvbnN0IGNoYXJfdHlwZSogX19zLCBzdGQ6OnNp
emVfdCBfX24sIGNvbnN0IGNoYXJfdHlwZSYgX19hKQogICAgewogICAgICBmb3IgKHN0ZDo6c2l6
ZV90IF9faSA9IDA7IF9faSA8IF9fbjsgKytfX2kpCiAgICAgICAgaWYgKGVxKF9fc1tfX2ldLCBf
X2EpKQogICAgICAgICAgcmV0dXJuIF9fcyArIF9faTsKICAgICAgcmV0dXJuIDA7CiAgICB9Cgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIHR5cGVuYW1lIGNoYXJfdHJhaXRzPF9DaGFy
VD46OmNoYXJfdHlwZSoKICAgIGNoYXJfdHJhaXRzPF9DaGFyVD46OgogICAgbW92ZShjaGFyX3R5
cGUqIF9fczEsIGNvbnN0IGNoYXJfdHlwZSogX19zMiwgc3RkOjpzaXplX3QgX19uKQogICAgewog
ICAgICByZXR1cm4gc3RhdGljX2Nhc3Q8X0NoYXJUKj4oX19idWlsdGluX21lbW1vdmUoX19zMSwg
X19zMiwKICAgICAgICAgIF9fbiAqIHNpemVvZihjaGFyX3R5cGUpKSk7CiAgICB9CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIHR5cGVuYW1lIGNoYXJfdHJhaXRzPF9DaGFyVD46OmNo
YXJfdHlwZSoKICAgIGNoYXJfdHJhaXRzPF9DaGFyVD46OgogICAgY29weShjaGFyX3R5cGUqIF9f
czEsIGNvbnN0IGNoYXJfdHlwZSogX19zMiwgc3RkOjpzaXplX3QgX19uKQogICAgewoKICAgICAg
c3RkOjpjb3B5KF9fczIsIF9fczIgKyBfX24sIF9fczEpOwogICAgICByZXR1cm4gX19zMTsKICAg
IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgdHlwZW5hbWUgY2hhcl90cmFpdHM8
X0NoYXJUPjo6Y2hhcl90eXBlKgogICAgY2hhcl90cmFpdHM8X0NoYXJUPjo6CiAgICBhc3NpZ24o
Y2hhcl90eXBlKiBfX3MsIHN0ZDo6c2l6ZV90IF9fbiwgY2hhcl90eXBlIF9fYSkKICAgIHsKCiAg
ICAgIHN0ZDo6ZmlsbF9uKF9fcywgX19uLCBfX2EpOwogICAgICByZXR1cm4gX19zOwogICAgfQoK
Cn0KCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVs
dCIpKSkKewoKIyAyMjYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9jaGFyX3RyYWl0cy5o
IiAzCiAgdGVtcGxhdGU8Y2xhc3MgX0NoYXJUPgogICAgc3RydWN0IGNoYXJfdHJhaXRzIDogcHVi
bGljIF9fZ251X2N4eDo6Y2hhcl90cmFpdHM8X0NoYXJUPgogICAgeyB9OwoKCgogIHRlbXBsYXRl
PD4KICAgIHN0cnVjdCBjaGFyX3RyYWl0czxjaGFyPgogICAgewogICAgICB0eXBlZGVmIGNoYXIg
Y2hhcl90eXBlOwogICAgICB0eXBlZGVmIGludCBpbnRfdHlwZTsKICAgICAgdHlwZWRlZiBzdHJl
YW1wb3MgcG9zX3R5cGU7CiAgICAgIHR5cGVkZWYgc3RyZWFtb2ZmIG9mZl90eXBlOwogICAgICB0
eXBlZGVmIG1ic3RhdGVfdCBzdGF0ZV90eXBlOwoKICAgICAgc3RhdGljIHZvaWQKICAgICAgYXNz
aWduKGNoYXJfdHlwZSYgX19jMSwgY29uc3QgY2hhcl90eXBlJiBfX2MyKSBub2V4Y2VwdAogICAg
ICB7IF9fYzEgPSBfX2MyOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wKICAgICAgZXEo
Y29uc3QgY2hhcl90eXBlJiBfX2MxLCBjb25zdCBjaGFyX3R5cGUmIF9fYzIpIG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuIF9fYzEgPT0gX19jMjsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29s
CiAgICAgIGx0KGNvbnN0IGNoYXJfdHlwZSYgX19jMSwgY29uc3QgY2hhcl90eXBlJiBfX2MyKSBu
b2V4Y2VwdAogICAgICB7CgogcmV0dXJuIChzdGF0aWNfY2FzdDx1bnNpZ25lZCBjaGFyPihfX2Mx
KQogIDwgc3RhdGljX2Nhc3Q8dW5zaWduZWQgY2hhcj4oX19jMikpOwogICAgICB9CgogICAgICBz
dGF0aWMgaW50CiAgICAgIGNvbXBhcmUoY29uc3QgY2hhcl90eXBlKiBfX3MxLCBjb25zdCBjaGFy
X3R5cGUqIF9fczIsIHNpemVfdCBfX24pCiAgICAgIHsKIGlmIChfX24gPT0gMCkKICAgcmV0dXJu
IDA7CiByZXR1cm4gX19idWlsdGluX21lbWNtcChfX3MxLCBfX3MyLCBfX24pOwogICAgICB9Cgog
ICAgICBzdGF0aWMgc2l6ZV90CiAgICAgIGxlbmd0aChjb25zdCBjaGFyX3R5cGUqIF9fcykKICAg
ICAgeyByZXR1cm4gX19idWlsdGluX3N0cmxlbihfX3MpOyB9CgogICAgICBzdGF0aWMgY29uc3Qg
Y2hhcl90eXBlKgogICAgICBmaW5kKGNvbnN0IGNoYXJfdHlwZSogX19zLCBzaXplX3QgX19uLCBj
b25zdCBjaGFyX3R5cGUmIF9fYSkKICAgICAgewogaWYgKF9fbiA9PSAwKQogICByZXR1cm4gMDsK
IHJldHVybiBzdGF0aWNfY2FzdDxjb25zdCBjaGFyX3R5cGUqPihfX2J1aWx0aW5fbWVtY2hyKF9f
cywgX19hLCBfX24pKTsKICAgICAgfQoKICAgICAgc3RhdGljIGNoYXJfdHlwZSoKICAgICAgbW92
ZShjaGFyX3R5cGUqIF9fczEsIGNvbnN0IGNoYXJfdHlwZSogX19zMiwgc2l6ZV90IF9fbikKICAg
ICAgewogaWYgKF9fbiA9PSAwKQogICByZXR1cm4gX19zMTsKIHJldHVybiBzdGF0aWNfY2FzdDxj
aGFyX3R5cGUqPihfX2J1aWx0aW5fbWVtbW92ZShfX3MxLCBfX3MyLCBfX24pKTsKICAgICAgfQoK
ICAgICAgc3RhdGljIGNoYXJfdHlwZSoKICAgICAgY29weShjaGFyX3R5cGUqIF9fczEsIGNvbnN0
IGNoYXJfdHlwZSogX19zMiwgc2l6ZV90IF9fbikKICAgICAgewogaWYgKF9fbiA9PSAwKQogICBy
ZXR1cm4gX19zMTsKIHJldHVybiBzdGF0aWNfY2FzdDxjaGFyX3R5cGUqPihfX2J1aWx0aW5fbWVt
Y3B5KF9fczEsIF9fczIsIF9fbikpOwogICAgICB9CgogICAgICBzdGF0aWMgY2hhcl90eXBlKgog
ICAgICBhc3NpZ24oY2hhcl90eXBlKiBfX3MsIHNpemVfdCBfX24sIGNoYXJfdHlwZSBfX2EpCiAg
ICAgIHsKIGlmIChfX24gPT0gMCkKICAgcmV0dXJuIF9fczsKIHJldHVybiBzdGF0aWNfY2FzdDxj
aGFyX3R5cGUqPihfX2J1aWx0aW5fbWVtc2V0KF9fcywgX19hLCBfX24pKTsKICAgICAgfQoKICAg
ICAgc3RhdGljIGNvbnN0ZXhwciBjaGFyX3R5cGUKICAgICAgdG9fY2hhcl90eXBlKGNvbnN0IGlu
dF90eXBlJiBfX2MpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PGNoYXJfdHlw
ZT4oX19jKTsgfQoKCgogICAgICBzdGF0aWMgY29uc3RleHByIGludF90eXBlCiAgICAgIHRvX2lu
dF90eXBlKGNvbnN0IGNoYXJfdHlwZSYgX19jKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0
aWNfY2FzdDxpbnRfdHlwZT4oc3RhdGljX2Nhc3Q8dW5zaWduZWQgY2hhcj4oX19jKSk7IH0KCiAg
ICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbAogICAgICBlcV9pbnRfdHlwZShjb25zdCBpbnRfdHlw
ZSYgX19jMSwgY29uc3QgaW50X3R5cGUmIF9fYzIpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9f
YzEgPT0gX19jMjsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnRfdHlwZQogICAgICBlb2Yo
KSBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxpbnRfdHlwZT4oLTEpOyB9Cgog
ICAgICBzdGF0aWMgY29uc3RleHByIGludF90eXBlCiAgICAgIG5vdF9lb2YoY29uc3QgaW50X3R5
cGUmIF9fYykgbm9leGNlcHQKICAgICAgeyByZXR1cm4gKF9fYyA9PSBlb2YoKSkgPyAwIDogX19j
OyB9CiAgfTsKCgoKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IGNoYXJfdHJhaXRzPHdjaGFyX3Q+
CiAgICB7CiAgICAgIHR5cGVkZWYgd2NoYXJfdCBjaGFyX3R5cGU7CiAgICAgIHR5cGVkZWYgd2lu
dF90IGludF90eXBlOwogICAgICB0eXBlZGVmIHN0cmVhbW9mZiBvZmZfdHlwZTsKICAgICAgdHlw
ZWRlZiB3c3RyZWFtcG9zIHBvc190eXBlOwogICAgICB0eXBlZGVmIG1ic3RhdGVfdCBzdGF0ZV90
eXBlOwoKICAgICAgc3RhdGljIHZvaWQKICAgICAgYXNzaWduKGNoYXJfdHlwZSYgX19jMSwgY29u
c3QgY2hhcl90eXBlJiBfX2MyKSBub2V4Y2VwdAogICAgICB7IF9fYzEgPSBfX2MyOyB9CgogICAg
ICBzdGF0aWMgY29uc3RleHByIGJvb2wKICAgICAgZXEoY29uc3QgY2hhcl90eXBlJiBfX2MxLCBj
b25zdCBjaGFyX3R5cGUmIF9fYzIpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fYzEgPT0gX19j
MjsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sCiAgICAgIGx0KGNvbnN0IGNoYXJfdHlw
ZSYgX19jMSwgY29uc3QgY2hhcl90eXBlJiBfX2MyKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBf
X2MxIDwgX19jMjsgfQoKICAgICAgc3RhdGljIGludAogICAgICBjb21wYXJlKGNvbnN0IGNoYXJf
dHlwZSogX19zMSwgY29uc3QgY2hhcl90eXBlKiBfX3MyLCBzaXplX3QgX19uKQogICAgICB7CiBp
ZiAoX19uID09IDApCiAgIHJldHVybiAwOwogcmV0dXJuIHdtZW1jbXAoX19zMSwgX19zMiwgX19u
KTsKICAgICAgfQoKICAgICAgc3RhdGljIHNpemVfdAogICAgICBsZW5ndGgoY29uc3QgY2hhcl90
eXBlKiBfX3MpCiAgICAgIHsgcmV0dXJuIHdjc2xlbihfX3MpOyB9CgogICAgICBzdGF0aWMgY29u
c3QgY2hhcl90eXBlKgogICAgICBmaW5kKGNvbnN0IGNoYXJfdHlwZSogX19zLCBzaXplX3QgX19u
LCBjb25zdCBjaGFyX3R5cGUmIF9fYSkKICAgICAgewogaWYgKF9fbiA9PSAwKQogICByZXR1cm4g
MDsKIHJldHVybiB3bWVtY2hyKF9fcywgX19hLCBfX24pOwogICAgICB9CgogICAgICBzdGF0aWMg
Y2hhcl90eXBlKgogICAgICBtb3ZlKGNoYXJfdHlwZSogX19zMSwgY29uc3QgY2hhcl90eXBlKiBf
X3MyLCBzaXplX3QgX19uKQogICAgICB7CiBpZiAoX19uID09IDApCiAgIHJldHVybiBfX3MxOwog
cmV0dXJuIHdtZW1tb3ZlKF9fczEsIF9fczIsIF9fbik7CiAgICAgIH0KCiAgICAgIHN0YXRpYyBj
aGFyX3R5cGUqCiAgICAgIGNvcHkoY2hhcl90eXBlKiBfX3MxLCBjb25zdCBjaGFyX3R5cGUqIF9f
czIsIHNpemVfdCBfX24pCiAgICAgIHsKIGlmIChfX24gPT0gMCkKICAgcmV0dXJuIF9fczE7CiBy
ZXR1cm4gd21lbWNweShfX3MxLCBfX3MyLCBfX24pOwogICAgICB9CgogICAgICBzdGF0aWMgY2hh
cl90eXBlKgogICAgICBhc3NpZ24oY2hhcl90eXBlKiBfX3MsIHNpemVfdCBfX24sIGNoYXJfdHlw
ZSBfX2EpCiAgICAgIHsKIGlmIChfX24gPT0gMCkKICAgcmV0dXJuIF9fczsKIHJldHVybiB3bWVt
c2V0KF9fcywgX19hLCBfX24pOwogICAgICB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGNoYXJf
dHlwZQogICAgICB0b19jaGFyX3R5cGUoY29uc3QgaW50X3R5cGUmIF9fYykgbm9leGNlcHQKICAg
ICAgeyByZXR1cm4gY2hhcl90eXBlKF9fYyk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50
X3R5cGUKICAgICAgdG9faW50X3R5cGUoY29uc3QgY2hhcl90eXBlJiBfX2MpIG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuIGludF90eXBlKF9fYyk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9v
bAogICAgICBlcV9pbnRfdHlwZShjb25zdCBpbnRfdHlwZSYgX19jMSwgY29uc3QgaW50X3R5cGUm
IF9fYzIpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fYzEgPT0gX19jMjsgfQoKICAgICAgc3Rh
dGljIGNvbnN0ZXhwciBpbnRfdHlwZQogICAgICBlb2YoKSBub2V4Y2VwdAogICAgICB7IHJldHVy
biBzdGF0aWNfY2FzdDxpbnRfdHlwZT4oKDB4ZmZmZmZmZmZ1KSk7IH0KCiAgICAgIHN0YXRpYyBj
b25zdGV4cHIgaW50X3R5cGUKICAgICAgbm90X2VvZihjb25zdCBpbnRfdHlwZSYgX19jKSBub2V4
Y2VwdAogICAgICB7IHJldHVybiBlcV9pbnRfdHlwZShfX2MsIGVvZigpKSA/IDAgOiBfX2M7IH0K
ICB9OwoKCgp9CgoKCgojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3N0ZGludCIgMSAzCiMg
MzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3N0ZGludCIgMwogICAgICAgCiMgMzMgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvY3N0ZGludCIgMwojIDQxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2NzdGRpbnQiIDMKIyAxICIvdXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2lu
Y2x1ZGUvc3RkaW50LmgiIDEgMyA0CiMgOSAiL3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51
eC82LjAuMC9pbmNsdWRlL3N0ZGludC5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvc3RkaW50Lmgi
IDEgMyA0CiMgMjcgIi91c3IvaW5jbHVkZS9zdGRpbnQuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRl
L2JpdHMvd29yZHNpemUuaCIgMSAzIDQKIyAyOCAiL3Vzci9pbmNsdWRlL3N0ZGludC5oIiAyIDMg
NAojIDQ4ICIvdXNyL2luY2x1ZGUvc3RkaW50LmgiIDMgNAp0eXBlZGVmIHVuc2lnbmVkIGNoYXIg
dWludDhfdDsKdHlwZWRlZiB1bnNpZ25lZCBzaG9ydCBpbnQgdWludDE2X3Q7Cgp0eXBlZGVmIHVu
c2lnbmVkIGludCB1aW50MzJfdDsKCgoKdHlwZWRlZiB1bnNpZ25lZCBsb25nIGludCB1aW50NjRf
dDsKIyA2NSAiL3Vzci9pbmNsdWRlL3N0ZGludC5oIiAzIDQKdHlwZWRlZiBzaWduZWQgY2hhciBp
bnRfbGVhc3Q4X3Q7CnR5cGVkZWYgc2hvcnQgaW50IGludF9sZWFzdDE2X3Q7CnR5cGVkZWYgaW50
IGludF9sZWFzdDMyX3Q7Cgp0eXBlZGVmIGxvbmcgaW50IGludF9sZWFzdDY0X3Q7CgoKCgoKCnR5
cGVkZWYgdW5zaWduZWQgY2hhciB1aW50X2xlYXN0OF90Owp0eXBlZGVmIHVuc2lnbmVkIHNob3J0
IGludCB1aW50X2xlYXN0MTZfdDsKdHlwZWRlZiB1bnNpZ25lZCBpbnQgdWludF9sZWFzdDMyX3Q7
Cgp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IHVpbnRfbGVhc3Q2NF90OwojIDkwICIvdXNyL2lu
Y2x1ZGUvc3RkaW50LmgiIDMgNAp0eXBlZGVmIHNpZ25lZCBjaGFyIGludF9mYXN0OF90OwoKdHlw
ZWRlZiBsb25nIGludCBpbnRfZmFzdDE2X3Q7CnR5cGVkZWYgbG9uZyBpbnQgaW50X2Zhc3QzMl90
Owp0eXBlZGVmIGxvbmcgaW50IGludF9mYXN0NjRfdDsKIyAxMDMgIi91c3IvaW5jbHVkZS9zdGRp
bnQuaCIgMyA0CnR5cGVkZWYgdW5zaWduZWQgY2hhciB1aW50X2Zhc3Q4X3Q7Cgp0eXBlZGVmIHVu
c2lnbmVkIGxvbmcgaW50IHVpbnRfZmFzdDE2X3Q7CnR5cGVkZWYgdW5zaWduZWQgbG9uZyBpbnQg
dWludF9mYXN0MzJfdDsKdHlwZWRlZiB1bnNpZ25lZCBsb25nIGludCB1aW50X2Zhc3Q2NF90Owoj
IDExOSAiL3Vzci9pbmNsdWRlL3N0ZGludC5oIiAzIDQKdHlwZWRlZiBsb25nIGludCBpbnRwdHJf
dDsKCgp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IHVpbnRwdHJfdDsKIyAxMzQgIi91c3IvaW5j
bHVkZS9zdGRpbnQuaCIgMyA0CnR5cGVkZWYgbG9uZyBpbnQgaW50bWF4X3Q7CnR5cGVkZWYgdW5z
aWduZWQgbG9uZyBpbnQgdWludG1heF90OwojIDEwICIvdXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0
LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkaW50LmgiIDIgMyA0CiMgNDIgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvY3N0ZGludCIgMiAzCgoKCgpuYW1lc3BhY2Ugc3RkCnsKICB1c2luZyA6OmludDhf
dDsKICB1c2luZyA6OmludDE2X3Q7CiAgdXNpbmcgOjppbnQzMl90OwogIHVzaW5nIDo6aW50NjRf
dDsKCiAgdXNpbmcgOjppbnRfZmFzdDhfdDsKICB1c2luZyA6OmludF9mYXN0MTZfdDsKICB1c2lu
ZyA6OmludF9mYXN0MzJfdDsKICB1c2luZyA6OmludF9mYXN0NjRfdDsKCiAgdXNpbmcgOjppbnRf
bGVhc3Q4X3Q7CiAgdXNpbmcgOjppbnRfbGVhc3QxNl90OwogIHVzaW5nIDo6aW50X2xlYXN0MzJf
dDsKICB1c2luZyA6OmludF9sZWFzdDY0X3Q7CgogIHVzaW5nIDo6aW50bWF4X3Q7CiAgdXNpbmcg
OjppbnRwdHJfdDsKCiAgdXNpbmcgOjp1aW50OF90OwogIHVzaW5nIDo6dWludDE2X3Q7CiAgdXNp
bmcgOjp1aW50MzJfdDsKICB1c2luZyA6OnVpbnQ2NF90OwoKICB1c2luZyA6OnVpbnRfZmFzdDhf
dDsKICB1c2luZyA6OnVpbnRfZmFzdDE2X3Q7CiAgdXNpbmcgOjp1aW50X2Zhc3QzMl90OwogIHVz
aW5nIDo6dWludF9mYXN0NjRfdDsKCiAgdXNpbmcgOjp1aW50X2xlYXN0OF90OwogIHVzaW5nIDo6
dWludF9sZWFzdDE2X3Q7CiAgdXNpbmcgOjp1aW50X2xlYXN0MzJfdDsKICB1c2luZyA6OnVpbnRf
bGVhc3Q2NF90OwoKICB1c2luZyA6OnVpbnRtYXhfdDsKICB1c2luZyA6OnVpbnRwdHJfdDsKfQoj
IDQyMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2NoYXJfdHJhaXRzLmgiIDIgMwoKbmFt
ZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7
CgoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgY2hhcl90cmFpdHM8Y2hhcjE2X3Q+CiAgICB7CiAg
ICAgIHR5cGVkZWYgY2hhcjE2X3QgY2hhcl90eXBlOwogICAgICB0eXBlZGVmIHVpbnRfbGVhc3Qx
Nl90IGludF90eXBlOwogICAgICB0eXBlZGVmIHN0cmVhbW9mZiBvZmZfdHlwZTsKICAgICAgdHlw
ZWRlZiB1MTZzdHJlYW1wb3MgcG9zX3R5cGU7CiAgICAgIHR5cGVkZWYgbWJzdGF0ZV90IHN0YXRl
X3R5cGU7CgogICAgICBzdGF0aWMgdm9pZAogICAgICBhc3NpZ24oY2hhcl90eXBlJiBfX2MxLCBj
b25zdCBjaGFyX3R5cGUmIF9fYzIpIG5vZXhjZXB0CiAgICAgIHsgX19jMSA9IF9fYzI7IH0KCiAg
ICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbAogICAgICBlcShjb25zdCBjaGFyX3R5cGUmIF9fYzEs
IGNvbnN0IGNoYXJfdHlwZSYgX19jMikgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX19jMSA9PSBf
X2MyOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wKICAgICAgbHQoY29uc3QgY2hhcl90
eXBlJiBfX2MxLCBjb25zdCBjaGFyX3R5cGUmIF9fYzIpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJu
IF9fYzEgPCBfX2MyOyB9CgogICAgICBzdGF0aWMgaW50CiAgICAgIGNvbXBhcmUoY29uc3QgY2hh
cl90eXBlKiBfX3MxLCBjb25zdCBjaGFyX3R5cGUqIF9fczIsIHNpemVfdCBfX24pCiAgICAgIHsK
IGZvciAoc2l6ZV90IF9faSA9IDA7IF9faSA8IF9fbjsgKytfX2kpCiAgIGlmIChsdChfX3MxW19f
aV0sIF9fczJbX19pXSkpCiAgICAgcmV0dXJuIC0xOwogICBlbHNlIGlmIChsdChfX3MyW19faV0s
IF9fczFbX19pXSkpCiAgICAgcmV0dXJuIDE7CiByZXR1cm4gMDsKICAgICAgfQoKICAgICAgc3Rh
dGljIHNpemVfdAogICAgICBsZW5ndGgoY29uc3QgY2hhcl90eXBlKiBfX3MpCiAgICAgIHsKIHNp
emVfdCBfX2kgPSAwOwogd2hpbGUgKCFlcShfX3NbX19pXSwgY2hhcl90eXBlKCkpKQogICArK19f
aTsKIHJldHVybiBfX2k7CiAgICAgIH0KCiAgICAgIHN0YXRpYyBjb25zdCBjaGFyX3R5cGUqCiAg
ICAgIGZpbmQoY29uc3QgY2hhcl90eXBlKiBfX3MsIHNpemVfdCBfX24sIGNvbnN0IGNoYXJfdHlw
ZSYgX19hKQogICAgICB7CiBmb3IgKHNpemVfdCBfX2kgPSAwOyBfX2kgPCBfX247ICsrX19pKQog
ICBpZiAoZXEoX19zW19faV0sIF9fYSkpCiAgICAgcmV0dXJuIF9fcyArIF9faTsKIHJldHVybiAw
OwogICAgICB9CgogICAgICBzdGF0aWMgY2hhcl90eXBlKgogICAgICBtb3ZlKGNoYXJfdHlwZSog
X19zMSwgY29uc3QgY2hhcl90eXBlKiBfX3MyLCBzaXplX3QgX19uKQogICAgICB7CiBpZiAoX19u
ID09IDApCiAgIHJldHVybiBfX3MxOwogcmV0dXJuIChzdGF0aWNfY2FzdDxjaGFyX3R5cGUqPgog
IChfX2J1aWx0aW5fbWVtbW92ZShfX3MxLCBfX3MyLCBfX24gKiBzaXplb2YoY2hhcl90eXBlKSkp
KTsKICAgICAgfQoKICAgICAgc3RhdGljIGNoYXJfdHlwZSoKICAgICAgY29weShjaGFyX3R5cGUq
IF9fczEsIGNvbnN0IGNoYXJfdHlwZSogX19zMiwgc2l6ZV90IF9fbikKICAgICAgewogaWYgKF9f
biA9PSAwKQogICByZXR1cm4gX19zMTsKIHJldHVybiAoc3RhdGljX2Nhc3Q8Y2hhcl90eXBlKj4K
ICAoX19idWlsdGluX21lbWNweShfX3MxLCBfX3MyLCBfX24gKiBzaXplb2YoY2hhcl90eXBlKSkp
KTsKICAgICAgfQoKICAgICAgc3RhdGljIGNoYXJfdHlwZSoKICAgICAgYXNzaWduKGNoYXJfdHlw
ZSogX19zLCBzaXplX3QgX19uLCBjaGFyX3R5cGUgX19hKQogICAgICB7CiBmb3IgKHNpemVfdCBf
X2kgPSAwOyBfX2kgPCBfX247ICsrX19pKQogICBhc3NpZ24oX19zW19faV0sIF9fYSk7CiByZXR1
cm4gX19zOwogICAgICB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGNoYXJfdHlwZQogICAgICB0
b19jaGFyX3R5cGUoY29uc3QgaW50X3R5cGUmIF9fYykgbm9leGNlcHQKICAgICAgeyByZXR1cm4g
Y2hhcl90eXBlKF9fYyk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50X3R5cGUKICAgICAg
dG9faW50X3R5cGUoY29uc3QgY2hhcl90eXBlJiBfX2MpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJu
IGludF90eXBlKF9fYyk7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbAogICAgICBlcV9p
bnRfdHlwZShjb25zdCBpbnRfdHlwZSYgX19jMSwgY29uc3QgaW50X3R5cGUmIF9fYzIpIG5vZXhj
ZXB0CiAgICAgIHsgcmV0dXJuIF9fYzEgPT0gX19jMjsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhw
ciBpbnRfdHlwZQogICAgICBlb2YoKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0aWNfY2Fz
dDxpbnRfdHlwZT4oLTEpOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGludF90eXBlCiAgICAg
IG5vdF9lb2YoY29uc3QgaW50X3R5cGUmIF9fYykgbm9leGNlcHQKICAgICAgeyByZXR1cm4gZXFf
aW50X3R5cGUoX19jLCBlb2YoKSkgPyAwIDogX19jOyB9CiAgICB9OwoKICB0ZW1wbGF0ZTw+CiAg
ICBzdHJ1Y3QgY2hhcl90cmFpdHM8Y2hhcjMyX3Q+CiAgICB7CiAgICAgIHR5cGVkZWYgY2hhcjMy
X3QgY2hhcl90eXBlOwogICAgICB0eXBlZGVmIHVpbnRfbGVhc3QzMl90IGludF90eXBlOwogICAg
ICB0eXBlZGVmIHN0cmVhbW9mZiBvZmZfdHlwZTsKICAgICAgdHlwZWRlZiB1MzJzdHJlYW1wb3Mg
cG9zX3R5cGU7CiAgICAgIHR5cGVkZWYgbWJzdGF0ZV90IHN0YXRlX3R5cGU7CgogICAgICBzdGF0
aWMgdm9pZAogICAgICBhc3NpZ24oY2hhcl90eXBlJiBfX2MxLCBjb25zdCBjaGFyX3R5cGUmIF9f
YzIpIG5vZXhjZXB0CiAgICAgIHsgX19jMSA9IF9fYzI7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4
cHIgYm9vbAogICAgICBlcShjb25zdCBjaGFyX3R5cGUmIF9fYzEsIGNvbnN0IGNoYXJfdHlwZSYg
X19jMikgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX19jMSA9PSBfX2MyOyB9CgogICAgICBzdGF0
aWMgY29uc3RleHByIGJvb2wKICAgICAgbHQoY29uc3QgY2hhcl90eXBlJiBfX2MxLCBjb25zdCBj
aGFyX3R5cGUmIF9fYzIpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fYzEgPCBfX2MyOyB9Cgog
ICAgICBzdGF0aWMgaW50CiAgICAgIGNvbXBhcmUoY29uc3QgY2hhcl90eXBlKiBfX3MxLCBjb25z
dCBjaGFyX3R5cGUqIF9fczIsIHNpemVfdCBfX24pCiAgICAgIHsKIGZvciAoc2l6ZV90IF9faSA9
IDA7IF9faSA8IF9fbjsgKytfX2kpCiAgIGlmIChsdChfX3MxW19faV0sIF9fczJbX19pXSkpCiAg
ICAgcmV0dXJuIC0xOwogICBlbHNlIGlmIChsdChfX3MyW19faV0sIF9fczFbX19pXSkpCiAgICAg
cmV0dXJuIDE7CiByZXR1cm4gMDsKICAgICAgfQoKICAgICAgc3RhdGljIHNpemVfdAogICAgICBs
ZW5ndGgoY29uc3QgY2hhcl90eXBlKiBfX3MpCiAgICAgIHsKIHNpemVfdCBfX2kgPSAwOwogd2hp
bGUgKCFlcShfX3NbX19pXSwgY2hhcl90eXBlKCkpKQogICArK19faTsKIHJldHVybiBfX2k7CiAg
ICAgIH0KCiAgICAgIHN0YXRpYyBjb25zdCBjaGFyX3R5cGUqCiAgICAgIGZpbmQoY29uc3QgY2hh
cl90eXBlKiBfX3MsIHNpemVfdCBfX24sIGNvbnN0IGNoYXJfdHlwZSYgX19hKQogICAgICB7CiBm
b3IgKHNpemVfdCBfX2kgPSAwOyBfX2kgPCBfX247ICsrX19pKQogICBpZiAoZXEoX19zW19faV0s
IF9fYSkpCiAgICAgcmV0dXJuIF9fcyArIF9faTsKIHJldHVybiAwOwogICAgICB9CgogICAgICBz
dGF0aWMgY2hhcl90eXBlKgogICAgICBtb3ZlKGNoYXJfdHlwZSogX19zMSwgY29uc3QgY2hhcl90
eXBlKiBfX3MyLCBzaXplX3QgX19uKQogICAgICB7CiBpZiAoX19uID09IDApCiAgIHJldHVybiBf
X3MxOwogcmV0dXJuIChzdGF0aWNfY2FzdDxjaGFyX3R5cGUqPgogIChfX2J1aWx0aW5fbWVtbW92
ZShfX3MxLCBfX3MyLCBfX24gKiBzaXplb2YoY2hhcl90eXBlKSkpKTsKICAgICAgfQoKICAgICAg
c3RhdGljIGNoYXJfdHlwZSoKICAgICAgY29weShjaGFyX3R5cGUqIF9fczEsIGNvbnN0IGNoYXJf
dHlwZSogX19zMiwgc2l6ZV90IF9fbikKICAgICAgewogaWYgKF9fbiA9PSAwKQogICByZXR1cm4g
X19zMTsKIHJldHVybiAoc3RhdGljX2Nhc3Q8Y2hhcl90eXBlKj4KICAoX19idWlsdGluX21lbWNw
eShfX3MxLCBfX3MyLCBfX24gKiBzaXplb2YoY2hhcl90eXBlKSkpKTsKICAgICAgfQoKICAgICAg
c3RhdGljIGNoYXJfdHlwZSoKICAgICAgYXNzaWduKGNoYXJfdHlwZSogX19zLCBzaXplX3QgX19u
LCBjaGFyX3R5cGUgX19hKQogICAgICB7CiBmb3IgKHNpemVfdCBfX2kgPSAwOyBfX2kgPCBfX247
ICsrX19pKQogICBhc3NpZ24oX19zW19faV0sIF9fYSk7CiByZXR1cm4gX19zOwogICAgICB9Cgog
ICAgICBzdGF0aWMgY29uc3RleHByIGNoYXJfdHlwZQogICAgICB0b19jaGFyX3R5cGUoY29uc3Qg
aW50X3R5cGUmIF9fYykgbm9leGNlcHQKICAgICAgeyByZXR1cm4gY2hhcl90eXBlKF9fYyk7IH0K
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgaW50X3R5cGUKICAgICAgdG9faW50X3R5cGUoY29uc3Qg
Y2hhcl90eXBlJiBfX2MpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGludF90eXBlKF9fYyk7IH0K
CiAgICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbAogICAgICBlcV9pbnRfdHlwZShjb25zdCBpbnRf
dHlwZSYgX19jMSwgY29uc3QgaW50X3R5cGUmIF9fYzIpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJu
IF9fYzEgPT0gX19jMjsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBpbnRfdHlwZQogICAgICBl
b2YoKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxpbnRfdHlwZT4oLTEpOyB9
CgogICAgICBzdGF0aWMgY29uc3RleHByIGludF90eXBlCiAgICAgIG5vdF9lb2YoY29uc3QgaW50
X3R5cGUmIF9fYykgbm9leGNlcHQKICAgICAgeyByZXR1cm4gZXFfaW50X3R5cGUoX19jLCBlb2Yo
KSkgPyAwIDogX19jOyB9CiAgICB9OwoKCn0KIyA0MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9p
b3MiIDIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVmd2QuaCIgMSAz
CiMgMzcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVmd2QuaCIgMwogICAgICAg
CiMgMzggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVmd2QuaCIgMwoKCiMgMSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9jKytsb2NhbGUu
aCIgMSAzCiMgMzkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvczM5MHgtcmVkaGF0LWxpbnV4L2Jp
dHMvYysrbG9jYWxlLmgiIDMKICAgICAgIAojIDQwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3Mz
OTB4LXJlZGhhdC1saW51eC9iaXRzL2MrK2xvY2FsZS5oIiAzCgojIDEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvY2xvY2FsZSIgMSAzCiMgMzkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY2xvY2Fs
ZSIgMwogICAgICAgCiMgNDAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY2xvY2FsZSIgMwoKCiMg
MSAiL3Vzci9pbmNsdWRlL2xvY2FsZS5oIiAxIDMgNAojIDI4ICIvdXNyL2luY2x1ZGUvbG9jYWxl
LmgiIDMgNAojIDEgIi91c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVk
ZS9zdGRkZWYuaCIgMSAzIDQKIyAyOSAiL3Vzci9pbmNsdWRlL2xvY2FsZS5oIiAyIDMgNAojIDEg
Ii91c3IvaW5jbHVkZS9iaXRzL2xvY2FsZS5oIiAxIDMgNAojIDMwICIvdXNyL2luY2x1ZGUvbG9j
YWxlLmgiIDIgMyA0CgpleHRlcm4gIkMiIHsKIyA1MCAiL3Vzci9pbmNsdWRlL2xvY2FsZS5oIiAz
IDQKCgoKc3RydWN0IGxjb252CnsKCgogIGNoYXIgKmRlY2ltYWxfcG9pbnQ7CiAgY2hhciAqdGhv
dXNhbmRzX3NlcDsKCgoKCgogIGNoYXIgKmdyb3VwaW5nOwoKCgoKCiAgY2hhciAqaW50X2N1cnJf
c3ltYm9sOwogIGNoYXIgKmN1cnJlbmN5X3N5bWJvbDsKICBjaGFyICptb25fZGVjaW1hbF9wb2lu
dDsKICBjaGFyICptb25fdGhvdXNhbmRzX3NlcDsKICBjaGFyICptb25fZ3JvdXBpbmc7CiAgY2hh
ciAqcG9zaXRpdmVfc2lnbjsKICBjaGFyICpuZWdhdGl2ZV9zaWduOwogIGNoYXIgaW50X2ZyYWNf
ZGlnaXRzOwogIGNoYXIgZnJhY19kaWdpdHM7CgogIGNoYXIgcF9jc19wcmVjZWRlczsKCiAgY2hh
ciBwX3NlcF9ieV9zcGFjZTsKCiAgY2hhciBuX2NzX3ByZWNlZGVzOwoKICBjaGFyIG5fc2VwX2J5
X3NwYWNlOwoKCgoKCgogIGNoYXIgcF9zaWduX3Bvc247CiAgY2hhciBuX3NpZ25fcG9zbjsKCgog
IGNoYXIgaW50X3BfY3NfcHJlY2VkZXM7CgogIGNoYXIgaW50X3Bfc2VwX2J5X3NwYWNlOwoKICBj
aGFyIGludF9uX2NzX3ByZWNlZGVzOwoKICBjaGFyIGludF9uX3NlcF9ieV9zcGFjZTsKCgoKCgoK
ICBjaGFyIGludF9wX3NpZ25fcG9zbjsKICBjaGFyIGludF9uX3NpZ25fcG9zbjsKIyAxMjAgIi91
c3IvaW5jbHVkZS9sb2NhbGUuaCIgMyA0Cn07CgoKCmV4dGVybiBjaGFyICpzZXRsb2NhbGUgKGlu
dCBfX2NhdGVnb3J5LCBjb25zdCBjaGFyICpfX2xvY2FsZSkgdGhyb3cgKCk7CgoKZXh0ZXJuIHN0
cnVjdCBsY29udiAqbG9jYWxlY29udiAodm9pZCkgdGhyb3cgKCk7CgoKIyAxNTEgIi91c3IvaW5j
bHVkZS9sb2NhbGUuaCIgMyA0CmV4dGVybiBfX2xvY2FsZV90IG5ld2xvY2FsZSAoaW50IF9fY2F0
ZWdvcnlfbWFzaywgY29uc3QgY2hhciAqX19sb2NhbGUsCiAgICAgICAgX19sb2NhbGVfdCBfX2Jh
c2UpIHRocm93ICgpOwojIDE4NiAiL3Vzci9pbmNsdWRlL2xvY2FsZS5oIiAzIDQKZXh0ZXJuIF9f
bG9jYWxlX3QgZHVwbG9jYWxlIChfX2xvY2FsZV90IF9fZGF0YXNldCkgdGhyb3cgKCk7CgoKCmV4
dGVybiB2b2lkIGZyZWVsb2NhbGUgKF9fbG9jYWxlX3QgX19kYXRhc2V0KSB0aHJvdyAoKTsKCgoK
CgoKZXh0ZXJuIF9fbG9jYWxlX3QgdXNlbG9jYWxlIChfX2xvY2FsZV90IF9fZGF0YXNldCkgdGhy
b3cgKCk7CgoKCgoKCgp9CiMgNDMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY2xvY2FsZSIgMiAz
CiMgNTEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY2xvY2FsZSIgMwpuYW1lc3BhY2Ugc3RkCnsK
ICB1c2luZyA6Omxjb252OwogIHVzaW5nIDo6c2V0bG9jYWxlOwogIHVzaW5nIDo6bG9jYWxlY29u
djsKfQojIDQyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRz
L2MrK2xvY2FsZS5oIiAyIDMKCgoKCgoKbmFtZXNwYWNlIF9fZ251X2N4eCBfX2F0dHJpYnV0ZV9f
ICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoKICBleHRlcm4gIkMiIF9fdHlwZW9m
KHVzZWxvY2FsZSkgX191c2Vsb2NhbGU7CgoKfQoKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVf
XyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCiAgdHlwZWRlZiBfX2xvY2FsZV90
IF9fY19sb2NhbGU7CgoKCgoKICBpbmxpbmUgaW50CiAgX19jb252ZXJ0X2Zyb21fdihjb25zdCBf
X2NfbG9jYWxlJiBfX2Nsb2MgX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKSwKICAgICBjaGFy
KiBfX291dCwKICAgICBjb25zdCBpbnQgX19zaXplIF9fYXR0cmlidXRlX18gKChfX3VudXNlZF9f
KSksCiAgICAgY29uc3QgY2hhciogX19mbXQsIC4uLikKICB7CgogICAgX19jX2xvY2FsZSBfX29s
ZCA9IF9fZ251X2N4eDo6X191c2Vsb2NhbGUoX19jbG9jKTsKIyA4OCAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9jKytsb2NhbGUuaCIgMwogICAgX19idWls
dGluX3ZhX2xpc3QgX19hcmdzOwogICAgX19idWlsdGluX3ZhX3N0YXJ0KF9fYXJncywgX19mbXQp
OwoKCiAgICBjb25zdCBpbnQgX19yZXQgPSBfX2J1aWx0aW5fdnNucHJpbnRmKF9fb3V0LCBfX3Np
emUsIF9fZm10LCBfX2FyZ3MpOwoKCgoKICAgIF9fYnVpbHRpbl92YV9lbmQoX19hcmdzKTsKCgog
ICAgX19nbnVfY3h4OjpfX3VzZWxvY2FsZShfX29sZCk7CgoKCgoKCgogICAgcmV0dXJuIF9fcmV0
OwogIH0KCgp9CiMgNDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVmd2QuaCIg
MiAzCgojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY2N0eXBlIiAxIDMKIyAzOSAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9jY3R5cGUiIDMKICAgICAgIAojIDQwICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2NjdHlwZSIgMwoKCiMgMSAiL3Vzci9pbmNsdWRlL2N0eXBlLmgiIDEgMyA0CiMgMjgg
Ii91c3IvaW5jbHVkZS9jdHlwZS5oIiAzIDQKZXh0ZXJuICJDIiB7CiMgNDYgIi91c3IvaW5jbHVk
ZS9jdHlwZS5oIiAzIDQKZW51bQp7CiAgX0lTdXBwZXIgPSAoMSA8PCAoMCkpLAogIF9JU2xvd2Vy
ID0gKDEgPDwgKDEpKSwKICBfSVNhbHBoYSA9ICgxIDw8ICgyKSksCiAgX0lTZGlnaXQgPSAoMSA8
PCAoMykpLAogIF9JU3hkaWdpdCA9ICgxIDw8ICg0KSksCiAgX0lTc3BhY2UgPSAoMSA8PCAoNSkp
LAogIF9JU3ByaW50ID0gKDEgPDwgKDYpKSwKICBfSVNncmFwaCA9ICgxIDw8ICg3KSksCiAgX0lT
YmxhbmsgPSAoMSA8PCAoOCkpLAogIF9JU2NudHJsID0gKDEgPDwgKDkpKSwKICBfSVNwdW5jdCA9
ICgxIDw8ICgxMCkpLAogIF9JU2FsbnVtID0gKDEgPDwgKDExKSkKfTsKIyA3OSAiL3Vzci9pbmNs
dWRlL2N0eXBlLmgiIDMgNApleHRlcm4gY29uc3QgdW5zaWduZWQgc2hvcnQgaW50ICoqX19jdHlw
ZV9iX2xvYyAodm9pZCkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSk7
CmV4dGVybiBjb25zdCBfX2ludDMyX3QgKipfX2N0eXBlX3RvbG93ZXJfbG9jICh2b2lkKQogICAg
IHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0X18pKTsKZXh0ZXJuIGNvbnN0IF9faW50
MzJfdCAqKl9fY3R5cGVfdG91cHBlcl9sb2MgKHZvaWQpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1
dGVfXyAoKF9fY29uc3RfXykpOwojIDEwNCAiL3Vzci9pbmNsdWRlL2N0eXBlLmgiIDMgNAoKCgoK
CgpleHRlcm4gaW50IGlzYWxudW0gKGludCkgdGhyb3cgKCk7CmV4dGVybiBpbnQgaXNhbHBoYSAo
aW50KSB0aHJvdyAoKTsKZXh0ZXJuIGludCBpc2NudHJsIChpbnQpIHRocm93ICgpOwpleHRlcm4g
aW50IGlzZGlnaXQgKGludCkgdGhyb3cgKCk7CmV4dGVybiBpbnQgaXNsb3dlciAoaW50KSB0aHJv
dyAoKTsKZXh0ZXJuIGludCBpc2dyYXBoIChpbnQpIHRocm93ICgpOwpleHRlcm4gaW50IGlzcHJp
bnQgKGludCkgdGhyb3cgKCk7CmV4dGVybiBpbnQgaXNwdW5jdCAoaW50KSB0aHJvdyAoKTsKZXh0
ZXJuIGludCBpc3NwYWNlIChpbnQpIHRocm93ICgpOwpleHRlcm4gaW50IGlzdXBwZXIgKGludCkg
dGhyb3cgKCk7CmV4dGVybiBpbnQgaXN4ZGlnaXQgKGludCkgdGhyb3cgKCk7CgoKCmV4dGVybiBp
bnQgdG9sb3dlciAoaW50IF9fYykgdGhyb3cgKCk7CgoKZXh0ZXJuIGludCB0b3VwcGVyIChpbnQg
X19jKSB0aHJvdyAoKTsKCgoKCgoKCgpleHRlcm4gaW50IGlzYmxhbmsgKGludCkgdGhyb3cgKCk7
CgoKCgoKCmV4dGVybiBpbnQgaXNjdHlwZSAoaW50IF9fYywgaW50IF9fbWFzaykgdGhyb3cgKCk7
CgoKCgoKCmV4dGVybiBpbnQgaXNhc2NpaSAoaW50IF9fYykgdGhyb3cgKCk7CgoKCmV4dGVybiBp
bnQgdG9hc2NpaSAoaW50IF9fYykgdGhyb3cgKCk7CgoKCmV4dGVybiBpbnQgX3RvdXBwZXIgKGlu
dCkgdGhyb3cgKCk7CmV4dGVybiBpbnQgX3RvbG93ZXIgKGludCkgdGhyb3cgKCk7CiMgMjcxICIv
dXNyL2luY2x1ZGUvY3R5cGUuaCIgMyA0CmV4dGVybiBpbnQgaXNhbG51bV9sIChpbnQsIF9fbG9j
YWxlX3QpIHRocm93ICgpOwpleHRlcm4gaW50IGlzYWxwaGFfbCAoaW50LCBfX2xvY2FsZV90KSB0
aHJvdyAoKTsKZXh0ZXJuIGludCBpc2NudHJsX2wgKGludCwgX19sb2NhbGVfdCkgdGhyb3cgKCk7
CmV4dGVybiBpbnQgaXNkaWdpdF9sIChpbnQsIF9fbG9jYWxlX3QpIHRocm93ICgpOwpleHRlcm4g
aW50IGlzbG93ZXJfbCAoaW50LCBfX2xvY2FsZV90KSB0aHJvdyAoKTsKZXh0ZXJuIGludCBpc2dy
YXBoX2wgKGludCwgX19sb2NhbGVfdCkgdGhyb3cgKCk7CmV4dGVybiBpbnQgaXNwcmludF9sIChp
bnQsIF9fbG9jYWxlX3QpIHRocm93ICgpOwpleHRlcm4gaW50IGlzcHVuY3RfbCAoaW50LCBfX2xv
Y2FsZV90KSB0aHJvdyAoKTsKZXh0ZXJuIGludCBpc3NwYWNlX2wgKGludCwgX19sb2NhbGVfdCkg
dGhyb3cgKCk7CmV4dGVybiBpbnQgaXN1cHBlcl9sIChpbnQsIF9fbG9jYWxlX3QpIHRocm93ICgp
OwpleHRlcm4gaW50IGlzeGRpZ2l0X2wgKGludCwgX19sb2NhbGVfdCkgdGhyb3cgKCk7CgpleHRl
cm4gaW50IGlzYmxhbmtfbCAoaW50LCBfX2xvY2FsZV90KSB0aHJvdyAoKTsKCgoKZXh0ZXJuIGlu
dCBfX3RvbG93ZXJfbCAoaW50IF9fYywgX19sb2NhbGVfdCBfX2wpIHRocm93ICgpOwpleHRlcm4g
aW50IHRvbG93ZXJfbCAoaW50IF9fYywgX19sb2NhbGVfdCBfX2wpIHRocm93ICgpOwoKCmV4dGVy
biBpbnQgX190b3VwcGVyX2wgKGludCBfX2MsIF9fbG9jYWxlX3QgX19sKSB0aHJvdyAoKTsKZXh0
ZXJuIGludCB0b3VwcGVyX2wgKGludCBfX2MsIF9fbG9jYWxlX3QgX19sKSB0aHJvdyAoKTsKIyAz
NDcgIi91c3IvaW5jbHVkZS9jdHlwZS5oIiAzIDQKfQojIDQzICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2NjdHlwZSIgMiAzCiMgNjIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY2N0eXBlIiAzCm5h
bWVzcGFjZSBzdGQKewogIHVzaW5nIDo6aXNhbG51bTsKICB1c2luZyA6OmlzYWxwaGE7CiAgdXNp
bmcgOjppc2NudHJsOwogIHVzaW5nIDo6aXNkaWdpdDsKICB1c2luZyA6OmlzZ3JhcGg7CiAgdXNp
bmcgOjppc2xvd2VyOwogIHVzaW5nIDo6aXNwcmludDsKICB1c2luZyA6OmlzcHVuY3Q7CiAgdXNp
bmcgOjppc3NwYWNlOwogIHVzaW5nIDo6aXN1cHBlcjsKICB1c2luZyA6OmlzeGRpZ2l0OwogIHVz
aW5nIDo6dG9sb3dlcjsKICB1c2luZyA6OnRvdXBwZXI7Cn0KCgoKCgoKCm5hbWVzcGFjZSBzdGQK
ewogIHVzaW5nIDo6aXNibGFuazsKfQojIDQzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
bG9jYWxlZndkLmgiIDIgMwoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmls
aXR5X18gKCJkZWZhdWx0IikpKQp7CgojIDU1ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
bG9jYWxlZndkLmgiIDMKICBjbGFzcyBsb2NhbGU7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GYWNl
dD4KICAgIGJvb2wKICAgIGhhc19mYWNldChjb25zdCBsb2NhbGUmKSB0aHJvdygpOwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfRmFjZXQ+CiAgICBjb25zdCBfRmFjZXQmCiAgICB1c2VfZmFjZXQoY29u
c3QgbG9jYWxlJik7CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBib29sCiAgICBp
c3NwYWNlKF9DaGFyVCwgY29uc3QgbG9jYWxlJik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFy
VD4KICAgIGJvb2wKICAgIGlzcHJpbnQoX0NoYXJULCBjb25zdCBsb2NhbGUmKTsKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0NoYXJUPgogICAgYm9vbAogICAgaXNjbnRybChfQ2hhclQsIGNvbnN0IGxv
Y2FsZSYpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBib29sCiAgICBpc3VwcGVy
KF9DaGFyVCwgY29uc3QgbG9jYWxlJik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAg
IGJvb2wKICAgIGlzbG93ZXIoX0NoYXJULCBjb25zdCBsb2NhbGUmKTsKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0NoYXJUPgogICAgYm9vbAogICAgaXNhbHBoYShfQ2hhclQsIGNvbnN0IGxvY2FsZSYp
OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBib29sCiAgICBpc2RpZ2l0KF9DaGFy
VCwgY29uc3QgbG9jYWxlJik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIGJvb2wK
ICAgIGlzcHVuY3QoX0NoYXJULCBjb25zdCBsb2NhbGUmKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0NoYXJUPgogICAgYm9vbAogICAgaXN4ZGlnaXQoX0NoYXJULCBjb25zdCBsb2NhbGUmKTsKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgYm9vbAogICAgaXNhbG51bShfQ2hhclQsIGNv
bnN0IGxvY2FsZSYpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBib29sCiAgICBp
c2dyYXBoKF9DaGFyVCwgY29uc3QgbG9jYWxlJik7CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hh
clQ+CiAgICBib29sCiAgICBpc2JsYW5rKF9DaGFyVCwgY29uc3QgbG9jYWxlJik7CgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBfQ2hhclQKICAgIHRvdXBwZXIoX0NoYXJULCBjb25z
dCBsb2NhbGUmKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgX0NoYXJUCiAgICB0
b2xvd2VyKF9DaGFyVCwgY29uc3QgbG9jYWxlJik7CgoKICBjbGFzcyBjdHlwZV9iYXNlOwogIHRl
bXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIGNsYXNzIGN0eXBlOwogIHRlbXBsYXRlPD4gY2xh
c3MgY3R5cGU8Y2hhcj47CgogIHRlbXBsYXRlPD4gY2xhc3MgY3R5cGU8d2NoYXJfdD47CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIGNsYXNzIGN0eXBlX2J5bmFtZTsKCgogIGNsYXNz
IGNvZGVjdnRfYmFzZTsKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW50ZXJuVCwgdHlwZW5hbWUgX0V4
dGVyblQsIHR5cGVuYW1lIF9TdGF0ZVQ+CiAgICBjbGFzcyBjb2RlY3Z0OwogIHRlbXBsYXRlPD4g
Y2xhc3MgY29kZWN2dDxjaGFyLCBjaGFyLCBtYnN0YXRlX3Q+OwoKICB0ZW1wbGF0ZTw+IGNsYXNz
IGNvZGVjdnQ8d2NoYXJfdCwgY2hhciwgbWJzdGF0ZV90PjsKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0ludGVyblQsIHR5cGVuYW1lIF9FeHRlcm5ULCB0eXBlbmFtZSBfU3RhdGVUPgogICAgY2xhc3Mg
Y29kZWN2dF9ieW5hbWU7CgoKbmFtZXNwYWNlIF9fZ251X2N4eF9sZGJsMTI4IHsKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9Jbkl0ZXIgPSBpc3RyZWFtYnVmX2l0ZXJhdG9y
PF9DaGFyVD4gPgogICAgY2xhc3MgbnVtX2dldDsKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQs
IHR5cGVuYW1lIF9PdXRJdGVyID0gb3N0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQ+ID4KICAgIGNs
YXNzIG51bV9wdXQ7Cn0KbmFtZXNwYWNlIF9fY3h4MTEgewogIHRlbXBsYXRlPHR5cGVuYW1lIF9D
aGFyVD4gY2xhc3MgbnVtcHVuY3Q7CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPiBjbGFzcyBu
dW1wdW5jdF9ieW5hbWU7Cn0KCm5hbWVzcGFjZSBfX2N4eDExIHsKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0NoYXJUPgogICAgY2xhc3MgY29sbGF0ZTsKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+
CiAgICBjbGFzcyBjb2xsYXRlX2J5bmFtZTsKfQoKCiAgY2xhc3MgdGltZV9iYXNlOwpuYW1lc3Bh
Y2UgX19jeHgxMSB7CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfSW5JdGVy
ID0gaXN0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQ+ID4KICAgIGNsYXNzIHRpbWVfZ2V0OwogIHRl
bXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX0luSXRlciA9IGlzdHJlYW1idWZfaXRl
cmF0b3I8X0NoYXJUPiA+CiAgICBjbGFzcyB0aW1lX2dldF9ieW5hbWU7Cn0KICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9PdXRJdGVyID0gb3N0cmVhbWJ1Zl9pdGVyYXRvcjxf
Q2hhclQ+ID4KICAgIGNsYXNzIHRpbWVfcHV0OwogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwg
dHlwZW5hbWUgX091dEl0ZXIgPSBvc3RyZWFtYnVmX2l0ZXJhdG9yPF9DaGFyVD4gPgogICAgY2xh
c3MgdGltZV9wdXRfYnluYW1lOwoKCiAgY2xhc3MgbW9uZXlfYmFzZTsKbmFtZXNwYWNlIF9fY3h4
MTEgewogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX0luSXRlciA9IGlzdHJl
YW1idWZfaXRlcmF0b3I8X0NoYXJUPiA+CiAgICBjbGFzcyBtb25leV9nZXQ7CiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfT3V0SXRlciA9IG9zdHJlYW1idWZfaXRlcmF0b3I8
X0NoYXJUPiA+CiAgICBjbGFzcyBtb25leV9wdXQ7Cn0KbmFtZXNwYWNlIF9fY3h4MTEgewogIHRl
bXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgYm9vbCBfSW50bCA9IGZhbHNlPgogICAgY2xhc3MgbW9u
ZXlwdW5jdDsKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIGJvb2wgX0ludGwgPSBmYWxzZT4K
ICAgIGNsYXNzIG1vbmV5cHVuY3RfYnluYW1lOwp9CgoKICBjbGFzcyBtZXNzYWdlc19iYXNlOwpu
YW1lc3BhY2UgX19jeHgxMSB7CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgY2xhc3Mg
bWVzc2FnZXM7CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgY2xhc3MgbWVzc2FnZXNf
YnluYW1lOwp9CgoKfQojIDQyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2lvcyIgMiAzCiMgMSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lvc19iYXNlLmgiIDEgMwojIDM3ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvaW9zX2Jhc2UuaCIgMwogICAgICAgCiMgMzggIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9pb3NfYmFzZS5oIiAzCgojIDEgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvZXh0L2F0b21pY2l0eS5oIiAxIDMKIyAzMiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9l
eHQvYXRvbWljaXR5LmgiIDMKICAgICAgIAojIDMzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2V4
dC9hdG9taWNpdHkuaCIgMwoKCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRo
YXQtbGludXgvYml0cy9ndGhyLmgiIDEgMwojIDMwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3Mz
OTB4LXJlZGhhdC1saW51eC9iaXRzL2d0aHIuaCIgMwojcHJhZ21hIEdDQyB2aXNpYmlsaXR5IHB1
c2goZGVmYXVsdCkKIyAxNDggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvczM5MHgtcmVkaGF0LWxp
bnV4L2JpdHMvZ3Roci5oIiAzCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRo
YXQtbGludXgvYml0cy9ndGhyLWRlZmF1bHQuaCIgMSAzCiMgMzUgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvczM5MHgtcmVkaGF0LWxpbnV4L2JpdHMvZ3Roci1kZWZhdWx0LmgiIDMKIyAxICIvdXNy
L2luY2x1ZGUvcHRocmVhZC5oIiAxIDMgNAojIDIzICIvdXNyL2luY2x1ZGUvcHRocmVhZC5oIiAz
IDQKIyAxICIvdXNyL2luY2x1ZGUvc2NoZWQuaCIgMSAzIDQKIyAyOCAiL3Vzci9pbmNsdWRlL3Nj
aGVkLmgiIDMgNAojIDEgIi91c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5j
bHVkZS9zdGRkZWYuaCIgMSAzIDQKIyAyOSAiL3Vzci9pbmNsdWRlL3NjaGVkLmgiIDIgMyA0CgoK
CgoKIyAxICIvdXNyL2luY2x1ZGUvdGltZS5oIiAxIDMgNAojIDM1ICIvdXNyL2luY2x1ZGUvc2No
ZWQuaCIgMiAzIDQKIyA0MyAiL3Vzci9pbmNsdWRlL3NjaGVkLmgiIDMgNAojIDEgIi91c3IvaW5j
bHVkZS9iaXRzL3NjaGVkLmgiIDEgMyA0CiMgNzIgIi91c3IvaW5jbHVkZS9iaXRzL3NjaGVkLmgi
IDMgNApzdHJ1Y3Qgc2NoZWRfcGFyYW0KICB7CiAgICBpbnQgX19zY2hlZF9wcmlvcml0eTsKICB9
OwoKZXh0ZXJuICJDIiB7CgoKCmV4dGVybiBpbnQgY2xvbmUgKGludCAoKl9fZm4pICh2b2lkICpf
X2FyZyksIHZvaWQgKl9fY2hpbGRfc3RhY2ssCiAgICBpbnQgX19mbGFncywgdm9pZCAqX19hcmcs
IC4uLikgdGhyb3cgKCk7CgoKZXh0ZXJuIGludCB1bnNoYXJlIChpbnQgX19mbGFncykgdGhyb3cg
KCk7CgoKZXh0ZXJuIGludCBzY2hlZF9nZXRjcHUgKHZvaWQpIHRocm93ICgpOwoKCmV4dGVybiBp
bnQgc2V0bnMgKGludCBfX2ZkLCBpbnQgX19uc3R5cGUpIHRocm93ICgpOwoKCgp9CgoKCgoKCgpz
dHJ1Y3QgX19zY2hlZF9wYXJhbQogIHsKICAgIGludCBfX3NjaGVkX3ByaW9yaXR5OwogIH07CiMg
MTE4ICIvdXNyL2luY2x1ZGUvYml0cy9zY2hlZC5oIiAzIDQKdHlwZWRlZiB1bnNpZ25lZCBsb25n
IGludCBfX2NwdV9tYXNrOwoKCgoKCgp0eXBlZGVmIHN0cnVjdAp7CiAgX19jcHVfbWFzayBfX2Jp
dHNbMTAyNCAvICg4ICogc2l6ZW9mIChfX2NwdV9tYXNrKSldOwp9IGNwdV9zZXRfdDsKIyAyMDEg
Ii91c3IvaW5jbHVkZS9iaXRzL3NjaGVkLmgiIDMgNApleHRlcm4gIkMiIHsKCmV4dGVybiBpbnQg
X19zY2hlZF9jcHVjb3VudCAoc2l6ZV90IF9fc2V0c2l6ZSwgY29uc3QgY3B1X3NldF90ICpfX3Nl
dHApCiAgdGhyb3cgKCk7CmV4dGVybiBjcHVfc2V0X3QgKl9fc2NoZWRfY3B1YWxsb2MgKHNpemVf
dCBfX2NvdW50KSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRf
XykpOwpleHRlcm4gdm9pZCBfX3NjaGVkX2NwdWZyZWUgKGNwdV9zZXRfdCAqX19zZXQpIHRocm93
ICgpOwoKfQojIDQ0ICIvdXNyL2luY2x1ZGUvc2NoZWQuaCIgMiAzIDQKCgoKCmV4dGVybiAiQyIg
ewoKCmV4dGVybiBpbnQgc2NoZWRfc2V0cGFyYW0gKF9fcGlkX3QgX19waWQsIGNvbnN0IHN0cnVj
dCBzY2hlZF9wYXJhbSAqX19wYXJhbSkKICAgICB0aHJvdyAoKTsKCgpleHRlcm4gaW50IHNjaGVk
X2dldHBhcmFtIChfX3BpZF90IF9fcGlkLCBzdHJ1Y3Qgc2NoZWRfcGFyYW0gKl9fcGFyYW0pIHRo
cm93ICgpOwoKCmV4dGVybiBpbnQgc2NoZWRfc2V0c2NoZWR1bGVyIChfX3BpZF90IF9fcGlkLCBp
bnQgX19wb2xpY3ksCiAgICAgICAgICBjb25zdCBzdHJ1Y3Qgc2NoZWRfcGFyYW0gKl9fcGFyYW0p
IHRocm93ICgpOwoKCmV4dGVybiBpbnQgc2NoZWRfZ2V0c2NoZWR1bGVyIChfX3BpZF90IF9fcGlk
KSB0aHJvdyAoKTsKCgpleHRlcm4gaW50IHNjaGVkX3lpZWxkICh2b2lkKSB0aHJvdyAoKTsKCgpl
eHRlcm4gaW50IHNjaGVkX2dldF9wcmlvcml0eV9tYXggKGludCBfX2FsZ29yaXRobSkgdGhyb3cg
KCk7CgoKZXh0ZXJuIGludCBzY2hlZF9nZXRfcHJpb3JpdHlfbWluIChpbnQgX19hbGdvcml0aG0p
IHRocm93ICgpOwoKCmV4dGVybiBpbnQgc2NoZWRfcnJfZ2V0X2ludGVydmFsIChfX3BpZF90IF9f
cGlkLCBzdHJ1Y3QgdGltZXNwZWMgKl9fdCkgdGhyb3cgKCk7CiMgMTE4ICIvdXNyL2luY2x1ZGUv
c2NoZWQuaCIgMyA0CmV4dGVybiBpbnQgc2NoZWRfc2V0YWZmaW5pdHkgKF9fcGlkX3QgX19waWQs
IHNpemVfdCBfX2NwdXNldHNpemUsCiAgICAgICAgIGNvbnN0IGNwdV9zZXRfdCAqX19jcHVzZXQp
IHRocm93ICgpOwoKCmV4dGVybiBpbnQgc2NoZWRfZ2V0YWZmaW5pdHkgKF9fcGlkX3QgX19waWQs
IHNpemVfdCBfX2NwdXNldHNpemUsCiAgICAgICAgIGNwdV9zZXRfdCAqX19jcHVzZXQpIHRocm93
ICgpOwoKCn0KIyAyNCAiL3Vzci9pbmNsdWRlL3B0aHJlYWQuaCIgMiAzIDQKIyAxICIvdXNyL2lu
Y2x1ZGUvdGltZS5oIiAxIDMgNAojIDI5ICIvdXNyL2luY2x1ZGUvdGltZS5oIiAzIDQKZXh0ZXJu
ICJDIiB7CgoKCgoKCgojIDEgIi91c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAv
aW5jbHVkZS9zdGRkZWYuaCIgMSAzIDQKIyAzOCAiL3Vzci9pbmNsdWRlL3RpbWUuaCIgMiAzIDQK
CgoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy90aW1lLmgiIDEgMyA0CiMgODggIi91c3IvaW5jbHVk
ZS9iaXRzL3RpbWUuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvdGltZXguaCIgMSAzIDQK
IyAyNSAiL3Vzci9pbmNsdWRlL2JpdHMvdGltZXguaCIgMyA0CnN0cnVjdCB0aW1leAp7CiAgdW5z
aWduZWQgaW50IG1vZGVzOwogIF9fc3lzY2FsbF9zbG9uZ190IG9mZnNldDsKICBfX3N5c2NhbGxf
c2xvbmdfdCBmcmVxOwogIF9fc3lzY2FsbF9zbG9uZ190IG1heGVycm9yOwogIF9fc3lzY2FsbF9z
bG9uZ190IGVzdGVycm9yOwogIGludCBzdGF0dXM7CiAgX19zeXNjYWxsX3Nsb25nX3QgY29uc3Rh
bnQ7CiAgX19zeXNjYWxsX3Nsb25nX3QgcHJlY2lzaW9uOwogIF9fc3lzY2FsbF9zbG9uZ190IHRv
bGVyYW5jZTsKICBzdHJ1Y3QgdGltZXZhbCB0aW1lOwogIF9fc3lzY2FsbF9zbG9uZ190IHRpY2s7
CiAgX19zeXNjYWxsX3Nsb25nX3QgcHBzZnJlcTsKICBfX3N5c2NhbGxfc2xvbmdfdCBqaXR0ZXI7
CiAgaW50IHNoaWZ0OwogIF9fc3lzY2FsbF9zbG9uZ190IHN0YWJpbDsKICBfX3N5c2NhbGxfc2xv
bmdfdCBqaXRjbnQ7CiAgX19zeXNjYWxsX3Nsb25nX3QgY2FsY250OwogIF9fc3lzY2FsbF9zbG9u
Z190IGVycmNudDsKICBfX3N5c2NhbGxfc2xvbmdfdCBzdGJjbnQ7CgogIGludCB0YWk7CgoKICBp
bnQgOjMyOyBpbnQgOjMyOyBpbnQgOjMyOyBpbnQgOjMyOwogIGludCA6MzI7IGludCA6MzI7IGlu
dCA6MzI7IGludCA6MzI7CiAgaW50IDozMjsgaW50IDozMjsgaW50IDozMjsKfTsKIyA4OSAiL3Vz
ci9pbmNsdWRlL2JpdHMvdGltZS5oIiAyIDMgNAoKZXh0ZXJuICJDIiB7CgoKZXh0ZXJuIGludCBj
bG9ja19hZGp0aW1lIChfX2Nsb2NraWRfdCBfX2Nsb2NrX2lkLCBzdHJ1Y3QgdGltZXggKl9fdXR4
KSB0aHJvdyAoKTsKCn0KIyA0MiAiL3Vzci9pbmNsdWRlL3RpbWUuaCIgMiAzIDQKIyAxMzEgIi91
c3IvaW5jbHVkZS90aW1lLmgiIDMgNAoKCnN0cnVjdCB0bQp7CiAgaW50IHRtX3NlYzsKICBpbnQg
dG1fbWluOwogIGludCB0bV9ob3VyOwogIGludCB0bV9tZGF5OwogIGludCB0bV9tb247CiAgaW50
IHRtX3llYXI7CiAgaW50IHRtX3dkYXk7CiAgaW50IHRtX3lkYXk7CiAgaW50IHRtX2lzZHN0OwoK
CiAgbG9uZyBpbnQgdG1fZ210b2ZmOwogIGNvbnN0IGNoYXIgKnRtX3pvbmU7CgoKCgp9OwoKCgoK
CgoKCnN0cnVjdCBpdGltZXJzcGVjCiAgewogICAgc3RydWN0IHRpbWVzcGVjIGl0X2ludGVydmFs
OwogICAgc3RydWN0IHRpbWVzcGVjIGl0X3ZhbHVlOwogIH07CgoKc3RydWN0IHNpZ2V2ZW50Owoj
IDE4NiAiL3Vzci9pbmNsdWRlL3RpbWUuaCIgMyA0CgoKCmV4dGVybiBjbG9ja190IGNsb2NrICh2
b2lkKSB0aHJvdyAoKTsKCgpleHRlcm4gdGltZV90IHRpbWUgKHRpbWVfdCAqX190aW1lcikgdGhy
b3cgKCk7CgoKZXh0ZXJuIGRvdWJsZSBkaWZmdGltZSAodGltZV90IF9fdGltZTEsIHRpbWVfdCBf
X3RpbWUwKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX2NvbnN0X18pKTsKCgpleHRl
cm4gdGltZV90IG1rdGltZSAoc3RydWN0IHRtICpfX3RwKSB0aHJvdyAoKTsKCgoKCgpleHRlcm4g
c2l6ZV90IHN0cmZ0aW1lIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fbWF4c2l6ZSwK
ICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwKICAgY29uc3Qgc3RydWN0IHRtICpf
X3Jlc3RyaWN0IF9fdHApIHRocm93ICgpOwoKCgoKCmV4dGVybiBjaGFyICpzdHJwdGltZSAoY29u
c3QgY2hhciAqX19yZXN0cmljdCBfX3MsCiAgICAgICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3Qg
X19mbXQsIHN0cnVjdCB0bSAqX190cCkKICAgICB0aHJvdyAoKTsKCgoKCgoKCmV4dGVybiBzaXpl
X3Qgc3RyZnRpbWVfbCAoY2hhciAqX19yZXN0cmljdCBfX3MsIHNpemVfdCBfX21heHNpemUsCiAg
ICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwKICAgICBjb25zdCBzdHJ1Y3QgdG0g
Kl9fcmVzdHJpY3QgX190cCwKICAgICBfX2xvY2FsZV90IF9fbG9jKSB0aHJvdyAoKTsKCgoKZXh0
ZXJuIGNoYXIgKnN0cnB0aW1lX2wgKGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19zLAogICAgY29u
c3QgY2hhciAqX19yZXN0cmljdCBfX2ZtdCwgc3RydWN0IHRtICpfX3RwLAogICAgX19sb2NhbGVf
dCBfX2xvYykgdGhyb3cgKCk7CgoKCgoKCmV4dGVybiBzdHJ1Y3QgdG0gKmdtdGltZSAoY29uc3Qg
dGltZV90ICpfX3RpbWVyKSB0aHJvdyAoKTsKCgoKZXh0ZXJuIHN0cnVjdCB0bSAqbG9jYWx0aW1l
IChjb25zdCB0aW1lX3QgKl9fdGltZXIpIHRocm93ICgpOwoKCgoKCmV4dGVybiBzdHJ1Y3QgdG0g
KmdtdGltZV9yIChjb25zdCB0aW1lX3QgKl9fcmVzdHJpY3QgX190aW1lciwKICAgICAgIHN0cnVj
dCB0bSAqX19yZXN0cmljdCBfX3RwKSB0aHJvdyAoKTsKCgoKZXh0ZXJuIHN0cnVjdCB0bSAqbG9j
YWx0aW1lX3IgKGNvbnN0IHRpbWVfdCAqX19yZXN0cmljdCBfX3RpbWVyLAogICAgICAgICAgc3Ry
dWN0IHRtICpfX3Jlc3RyaWN0IF9fdHApIHRocm93ICgpOwoKCgoKCmV4dGVybiBjaGFyICphc2N0
aW1lIChjb25zdCBzdHJ1Y3QgdG0gKl9fdHApIHRocm93ICgpOwoKCmV4dGVybiBjaGFyICpjdGlt
ZSAoY29uc3QgdGltZV90ICpfX3RpbWVyKSB0aHJvdyAoKTsKCgoKCgoKCmV4dGVybiBjaGFyICph
c2N0aW1lX3IgKGNvbnN0IHN0cnVjdCB0bSAqX19yZXN0cmljdCBfX3RwLAogICBjaGFyICpfX3Jl
c3RyaWN0IF9fYnVmKSB0aHJvdyAoKTsKCgpleHRlcm4gY2hhciAqY3RpbWVfciAoY29uc3QgdGlt
ZV90ICpfX3Jlc3RyaWN0IF9fdGltZXIsCiAgICAgICAgY2hhciAqX19yZXN0cmljdCBfX2J1Zikg
dGhyb3cgKCk7CgoKCgpleHRlcm4gY2hhciAqX190em5hbWVbMl07CmV4dGVybiBpbnQgX19kYXls
aWdodDsKZXh0ZXJuIGxvbmcgaW50IF9fdGltZXpvbmU7CgoKCgpleHRlcm4gY2hhciAqdHpuYW1l
WzJdOwoKCgpleHRlcm4gdm9pZCB0enNldCAodm9pZCkgdGhyb3cgKCk7CgoKCmV4dGVybiBpbnQg
ZGF5bGlnaHQ7CmV4dGVybiBsb25nIGludCB0aW1lem9uZTsKCgoKCgpleHRlcm4gaW50IHN0aW1l
IChjb25zdCB0aW1lX3QgKl9fd2hlbikgdGhyb3cgKCk7CiMgMzE5ICIvdXNyL2luY2x1ZGUvdGlt
ZS5oIiAzIDQKZXh0ZXJuIHRpbWVfdCB0aW1lZ20gKHN0cnVjdCB0bSAqX190cCkgdGhyb3cgKCk7
CgoKZXh0ZXJuIHRpbWVfdCB0aW1lbG9jYWwgKHN0cnVjdCB0bSAqX190cCkgdGhyb3cgKCk7CgoK
ZXh0ZXJuIGludCBkeXNpemUgKGludCBfX3llYXIpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChf
X2NvbnN0X18pKTsKIyAzMzQgIi91c3IvaW5jbHVkZS90aW1lLmgiIDMgNApleHRlcm4gaW50IG5h
bm9zbGVlcCAoY29uc3Qgc3RydWN0IHRpbWVzcGVjICpfX3JlcXVlc3RlZF90aW1lLAogICAgICAg
IHN0cnVjdCB0aW1lc3BlYyAqX19yZW1haW5pbmcpOwoKCgpleHRlcm4gaW50IGNsb2NrX2dldHJl
cyAoY2xvY2tpZF90IF9fY2xvY2tfaWQsIHN0cnVjdCB0aW1lc3BlYyAqX19yZXMpIHRocm93ICgp
OwoKCmV4dGVybiBpbnQgY2xvY2tfZ2V0dGltZSAoY2xvY2tpZF90IF9fY2xvY2tfaWQsIHN0cnVj
dCB0aW1lc3BlYyAqX190cCkgdGhyb3cgKCk7CgoKZXh0ZXJuIGludCBjbG9ja19zZXR0aW1lIChj
bG9ja2lkX3QgX19jbG9ja19pZCwgY29uc3Qgc3RydWN0IHRpbWVzcGVjICpfX3RwKQogICAgIHRo
cm93ICgpOwoKCgoKCgpleHRlcm4gaW50IGNsb2NrX25hbm9zbGVlcCAoY2xvY2tpZF90IF9fY2xv
Y2tfaWQsIGludCBfX2ZsYWdzLAogICAgICAgY29uc3Qgc3RydWN0IHRpbWVzcGVjICpfX3JlcSwK
ICAgICAgIHN0cnVjdCB0aW1lc3BlYyAqX19yZW0pOwoKCmV4dGVybiBpbnQgY2xvY2tfZ2V0Y3B1
Y2xvY2tpZCAocGlkX3QgX19waWQsIGNsb2NraWRfdCAqX19jbG9ja19pZCkgdGhyb3cgKCk7CgoK
CgpleHRlcm4gaW50IHRpbWVyX2NyZWF0ZSAoY2xvY2tpZF90IF9fY2xvY2tfaWQsCiAgICBzdHJ1
Y3Qgc2lnZXZlbnQgKl9fcmVzdHJpY3QgX19ldnAsCiAgICB0aW1lcl90ICpfX3Jlc3RyaWN0IF9f
dGltZXJpZCkgdGhyb3cgKCk7CgoKZXh0ZXJuIGludCB0aW1lcl9kZWxldGUgKHRpbWVyX3QgX190
aW1lcmlkKSB0aHJvdyAoKTsKCgpleHRlcm4gaW50IHRpbWVyX3NldHRpbWUgKHRpbWVyX3QgX190
aW1lcmlkLCBpbnQgX19mbGFncywKICAgICBjb25zdCBzdHJ1Y3QgaXRpbWVyc3BlYyAqX19yZXN0
cmljdCBfX3ZhbHVlLAogICAgIHN0cnVjdCBpdGltZXJzcGVjICpfX3Jlc3RyaWN0IF9fb3ZhbHVl
KSB0aHJvdyAoKTsKCgpleHRlcm4gaW50IHRpbWVyX2dldHRpbWUgKHRpbWVyX3QgX190aW1lcmlk
LCBzdHJ1Y3QgaXRpbWVyc3BlYyAqX192YWx1ZSkKICAgICB0aHJvdyAoKTsKCgpleHRlcm4gaW50
IHRpbWVyX2dldG92ZXJydW4gKHRpbWVyX3QgX190aW1lcmlkKSB0aHJvdyAoKTsKCgoKCgpleHRl
cm4gaW50IHRpbWVzcGVjX2dldCAoc3RydWN0IHRpbWVzcGVjICpfX3RzLCBpbnQgX19iYXNlKQog
ICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKIyA0MDMgIi91
c3IvaW5jbHVkZS90aW1lLmgiIDMgNApleHRlcm4gaW50IGdldGRhdGVfZXJyOwojIDQxMiAiL3Vz
ci9pbmNsdWRlL3RpbWUuaCIgMyA0CmV4dGVybiBzdHJ1Y3QgdG0gKmdldGRhdGUgKGNvbnN0IGNo
YXIgKl9fc3RyaW5nKTsKIyA0MjYgIi91c3IvaW5jbHVkZS90aW1lLmgiIDMgNApleHRlcm4gaW50
IGdldGRhdGVfciAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3N0cmluZywKICAgICAgICBzdHJ1
Y3QgdG0gKl9fcmVzdHJpY3QgX19yZXNidWZwKTsKCgp9CiMgMjUgIi91c3IvaW5jbHVkZS9wdGhy
ZWFkLmgiIDIgMyA0CgoKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9zZXRqbXAuaCIgMSAzIDQKIyAy
NyAiL3Vzci9pbmNsdWRlL2JpdHMvc2V0am1wLmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRz
L3dvcmRzaXplLmgiIDEgMyA0CiMgMjggIi91c3IvaW5jbHVkZS9iaXRzL3NldGptcC5oIiAyIDMg
NAoKCgp0eXBlZGVmIHN0cnVjdCBfX3MzOTBfam1wX2J1Zgp7CgogIGxvbmcgaW50IF9fZ3JlZ3Nb
MTBdOwoKCgogIGxvbmcgX19mcHJlZ3NbOF07CgoKCgp9IF9fam1wX2J1ZlsxXTsKIyAyOCAiL3Vz
ci9pbmNsdWRlL3B0aHJlYWQuaCIgMiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy93b3Jkc2l6
ZS5oIiAxIDMgNAojIDI5ICIvdXNyL2luY2x1ZGUvcHRocmVhZC5oIiAyIDMgNAoKCgplbnVtCnsK
ICBQVEhSRUFEX0NSRUFURV9KT0lOQUJMRSwKCiAgUFRIUkVBRF9DUkVBVEVfREVUQUNIRUQKCn07
CgoKCmVudW0KewogIFBUSFJFQURfTVVURVhfVElNRURfTlAsCiAgUFRIUkVBRF9NVVRFWF9SRUNV
UlNJVkVfTlAsCiAgUFRIUkVBRF9NVVRFWF9FUlJPUkNIRUNLX05QLAogIFBUSFJFQURfTVVURVhf
QURBUFRJVkVfTlAKCiAgLAogIFBUSFJFQURfTVVURVhfTk9STUFMID0gUFRIUkVBRF9NVVRFWF9U
SU1FRF9OUCwKICBQVEhSRUFEX01VVEVYX1JFQ1VSU0lWRSA9IFBUSFJFQURfTVVURVhfUkVDVVJT
SVZFX05QLAogIFBUSFJFQURfTVVURVhfRVJST1JDSEVDSyA9IFBUSFJFQURfTVVURVhfRVJST1JD
SEVDS19OUCwKICBQVEhSRUFEX01VVEVYX0RFRkFVTFQgPSBQVEhSRUFEX01VVEVYX05PUk1BTAoK
CgogICwgUFRIUkVBRF9NVVRFWF9GQVNUX05QID0gUFRIUkVBRF9NVVRFWF9USU1FRF9OUAoKfTsK
CgoKCmVudW0KewogIFBUSFJFQURfTVVURVhfU1RBTExFRCwKICBQVEhSRUFEX01VVEVYX1NUQUxM
RURfTlAgPSBQVEhSRUFEX01VVEVYX1NUQUxMRUQsCiAgUFRIUkVBRF9NVVRFWF9ST0JVU1QsCiAg
UFRIUkVBRF9NVVRFWF9ST0JVU1RfTlAgPSBQVEhSRUFEX01VVEVYX1JPQlVTVAp9OwoKCgoKCmVu
dW0KewogIFBUSFJFQURfUFJJT19OT05FLAogIFBUSFJFQURfUFJJT19JTkhFUklULAogIFBUSFJF
QURfUFJJT19QUk9URUNUCn07CiMgMTE0ICIvdXNyL2luY2x1ZGUvcHRocmVhZC5oIiAzIDQKZW51
bQp7CiAgUFRIUkVBRF9SV0xPQ0tfUFJFRkVSX1JFQURFUl9OUCwKICBQVEhSRUFEX1JXTE9DS19Q
UkVGRVJfV1JJVEVSX05QLAogIFBUSFJFQURfUldMT0NLX1BSRUZFUl9XUklURVJfTk9OUkVDVVJT
SVZFX05QLAogIFBUSFJFQURfUldMT0NLX0RFRkFVTFRfTlAgPSBQVEhSRUFEX1JXTE9DS19QUkVG
RVJfUkVBREVSX05QCn07CiMgMTU1ICIvdXNyL2luY2x1ZGUvcHRocmVhZC5oIiAzIDQKZW51bQp7
CiAgUFRIUkVBRF9JTkhFUklUX1NDSEVELAoKICBQVEhSRUFEX0VYUExJQ0lUX1NDSEVECgp9OwoK
CgplbnVtCnsKICBQVEhSRUFEX1NDT1BFX1NZU1RFTSwKCiAgUFRIUkVBRF9TQ09QRV9QUk9DRVNT
Cgp9OwoKCgplbnVtCnsKICBQVEhSRUFEX1BST0NFU1NfUFJJVkFURSwKCiAgUFRIUkVBRF9QUk9D
RVNTX1NIQVJFRAoKfTsKIyAxOTAgIi91c3IvaW5jbHVkZS9wdGhyZWFkLmgiIDMgNApzdHJ1Y3Qg
X3B0aHJlYWRfY2xlYW51cF9idWZmZXIKewogIHZvaWQgKCpfX3JvdXRpbmUpICh2b2lkICopOwog
IHZvaWQgKl9fYXJnOwogIGludCBfX2NhbmNlbHR5cGU7CiAgc3RydWN0IF9wdGhyZWFkX2NsZWFu
dXBfYnVmZmVyICpfX3ByZXY7Cn07CgoKZW51bQp7CiAgUFRIUkVBRF9DQU5DRUxfRU5BQkxFLAoK
ICBQVEhSRUFEX0NBTkNFTF9ESVNBQkxFCgp9OwplbnVtCnsKICBQVEhSRUFEX0NBTkNFTF9ERUZF
UlJFRCwKCiAgUFRIUkVBRF9DQU5DRUxfQVNZTkNIUk9OT1VTCgp9OwojIDIyOCAiL3Vzci9pbmNs
dWRlL3B0aHJlYWQuaCIgMyA0CmV4dGVybiAiQyIgewoKCgoKZXh0ZXJuIGludCBwdGhyZWFkX2Ny
ZWF0ZSAocHRocmVhZF90ICpfX3Jlc3RyaWN0IF9fbmV3dGhyZWFkLAogICAgICBjb25zdCBwdGhy
ZWFkX2F0dHJfdCAqX19yZXN0cmljdCBfX2F0dHIsCiAgICAgIHZvaWQgKigqX19zdGFydF9yb3V0
aW5lKSAodm9pZCAqKSwKICAgICAgdm9pZCAqX19yZXN0cmljdCBfX2FyZykgdGhyb3cgKCkgX19h
dHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAzKSkpOwoKCgoKCmV4dGVybiB2b2lkIHB0aHJl
YWRfZXhpdCAodm9pZCAqX19yZXR2YWwpIF9fYXR0cmlidXRlX18gKChfX25vcmV0dXJuX18pKTsK
CgoKCgoKCmV4dGVybiBpbnQgcHRocmVhZF9qb2luIChwdGhyZWFkX3QgX190aCwgdm9pZCAqKl9f
dGhyZWFkX3JldHVybik7CgoKCgpleHRlcm4gaW50IHB0aHJlYWRfdHJ5am9pbl9ucCAocHRocmVh
ZF90IF9fdGgsIHZvaWQgKipfX3RocmVhZF9yZXR1cm4pIHRocm93ICgpOwoKCgoKCgoKZXh0ZXJu
IGludCBwdGhyZWFkX3RpbWVkam9pbl9ucCAocHRocmVhZF90IF9fdGgsIHZvaWQgKipfX3RocmVh
ZF9yZXR1cm4sCiAgICAgY29uc3Qgc3RydWN0IHRpbWVzcGVjICpfX2Fic3RpbWUpOwoKCgoKCgpl
eHRlcm4gaW50IHB0aHJlYWRfZGV0YWNoIChwdGhyZWFkX3QgX190aCkgdGhyb3cgKCk7CgoKCmV4
dGVybiBwdGhyZWFkX3QgcHRocmVhZF9zZWxmICh2b2lkKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9f
ICgoX19jb25zdF9fKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX2VxdWFsIChwdGhyZWFkX3QgX190
aHJlYWQxLCBwdGhyZWFkX3QgX190aHJlYWQyKQogIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChf
X2NvbnN0X18pKTsKCgoKCgoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX2luaXQgKHB0aHJlYWRf
YXR0cl90ICpfX2F0dHIpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkp
KTsKCgpleHRlcm4gaW50IHB0aHJlYWRfYXR0cl9kZXN0cm95IChwdGhyZWFkX2F0dHJfdCAqX19h
dHRyKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpl
eHRlcm4gaW50IHB0aHJlYWRfYXR0cl9nZXRkZXRhY2hzdGF0ZSAoY29uc3QgcHRocmVhZF9hdHRy
X3QgKl9fYXR0ciwKICAgICBpbnQgKl9fZGV0YWNoc3RhdGUpCiAgICAgdGhyb3cgKCkgX19hdHRy
aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRy
X3NldGRldGFjaHN0YXRlIChwdGhyZWFkX2F0dHJfdCAqX19hdHRyLAogICAgIGludCBfX2RldGFj
aHN0YXRlKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsK
CgoKZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfZ2V0Z3VhcmRzaXplIChjb25zdCBwdGhyZWFkX2F0
dHJfdCAqX19hdHRyLAogICAgICAgICAgc2l6ZV90ICpfX2d1YXJkc2l6ZSkKICAgICB0aHJvdyAo
KSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKZXh0ZXJuIGludCBwdGhy
ZWFkX2F0dHJfc2V0Z3VhcmRzaXplIChwdGhyZWFkX2F0dHJfdCAqX19hdHRyLAogICAgICAgICAg
c2l6ZV90IF9fZ3VhcmRzaXplKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51
bGxfXyAoMSkpKTsKCgoKZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfZ2V0c2NoZWRwYXJhbSAoY29u
c3QgcHRocmVhZF9hdHRyX3QgKl9fcmVzdHJpY3QgX19hdHRyLAogICAgICAgICAgIHN0cnVjdCBz
Y2hlZF9wYXJhbSAqX19yZXN0cmljdCBfX3BhcmFtKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRl
X18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfYXR0cl9zZXRz
Y2hlZHBhcmFtIChwdGhyZWFkX2F0dHJfdCAqX19yZXN0cmljdCBfX2F0dHIsCiAgICAgICAgICAg
Y29uc3Qgc3RydWN0IHNjaGVkX3BhcmFtICpfX3Jlc3RyaWN0CiAgICAgICAgICAgX19wYXJhbSkg
dGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCmV4dGVybiBp
bnQgcHRocmVhZF9hdHRyX2dldHNjaGVkcG9saWN5IChjb25zdCBwdGhyZWFkX2F0dHJfdCAqX19y
ZXN0cmljdAogICAgIF9fYXR0ciwgaW50ICpfX3Jlc3RyaWN0IF9fcG9saWN5KQogICAgIHRocm93
ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHB0
aHJlYWRfYXR0cl9zZXRzY2hlZHBvbGljeSAocHRocmVhZF9hdHRyX3QgKl9fYXR0ciwgaW50IF9f
cG9saWN5KQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsK
CgpleHRlcm4gaW50IHB0aHJlYWRfYXR0cl9nZXRpbmhlcml0c2NoZWQgKGNvbnN0IHB0aHJlYWRf
YXR0cl90ICpfX3Jlc3RyaWN0CiAgICAgIF9fYXR0ciwgaW50ICpfX3Jlc3RyaWN0IF9faW5oZXJp
dCkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoK
ZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfc2V0aW5oZXJpdHNjaGVkIChwdGhyZWFkX2F0dHJfdCAq
X19hdHRyLAogICAgICBpbnQgX19pbmhlcml0KQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18g
KChfX25vbm51bGxfXyAoMSkpKTsKCgoKZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfZ2V0c2NvcGUg
KGNvbnN0IHB0aHJlYWRfYXR0cl90ICpfX3Jlc3RyaWN0IF9fYXR0ciwKICAgICAgaW50ICpfX3Jl
c3RyaWN0IF9fc2NvcGUpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgxLCAyKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX3NldHNjb3BlIChwdGhyZWFkX2F0
dHJfdCAqX19hdHRyLCBpbnQgX19zY29wZSkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgo
X19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfZ2V0c3RhY2thZGRy
IChjb25zdCBwdGhyZWFkX2F0dHJfdCAqX19yZXN0cmljdAogICAgICAgICAgX19hdHRyLCB2b2lk
ICoqX19yZXN0cmljdCBfX3N0YWNrYWRkcikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgo
X19ub25udWxsX18gKDEsIDIpKSkgX19hdHRyaWJ1dGVfXyAoKF9fZGVwcmVjYXRlZF9fKSk7CgoK
CgoKZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfc2V0c3RhY2thZGRyIChwdGhyZWFkX2F0dHJfdCAq
X19hdHRyLAogICAgICAgICAgdm9pZCAqX19zdGFja2FkZHIpCiAgICAgdGhyb3cgKCkgX19hdHRy
aWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX2RlcHJlY2F0ZWRf
XykpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX2dldHN0YWNrc2l6ZSAoY29uc3QgcHRocmVh
ZF9hdHRyX3QgKl9fcmVzdHJpY3QKICAgICAgICAgIF9fYXR0ciwgc2l6ZV90ICpfX3Jlc3RyaWN0
IF9fc3RhY2tzaXplKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo
MSwgMikpKTsKCgoKCmV4dGVybiBpbnQgcHRocmVhZF9hdHRyX3NldHN0YWNrc2l6ZSAocHRocmVh
ZF9hdHRyX3QgKl9fYXR0ciwKICAgICAgICAgIHNpemVfdCBfX3N0YWNrc2l6ZSkKICAgICB0aHJv
dyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCmV4dGVybiBpbnQgcHRo
cmVhZF9hdHRyX2dldHN0YWNrIChjb25zdCBwdGhyZWFkX2F0dHJfdCAqX19yZXN0cmljdCBfX2F0
dHIsCiAgICAgIHZvaWQgKipfX3Jlc3RyaWN0IF9fc3RhY2thZGRyLAogICAgICBzaXplX3QgKl9f
cmVzdHJpY3QgX19zdGFja3NpemUpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgxLCAyLCAzKSkpOwoKCgoKZXh0ZXJuIGludCBwdGhyZWFkX2F0dHJfc2V0c3RhY2sg
KHB0aHJlYWRfYXR0cl90ICpfX2F0dHIsIHZvaWQgKl9fc3RhY2thZGRyLAogICAgICBzaXplX3Qg
X19zdGFja3NpemUpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsK
CgoKCgpleHRlcm4gaW50IHB0aHJlYWRfYXR0cl9zZXRhZmZpbml0eV9ucCAocHRocmVhZF9hdHRy
X3QgKl9fYXR0ciwKICAgICBzaXplX3QgX19jcHVzZXRzaXplLAogICAgIGNvbnN0IGNwdV9zZXRf
dCAqX19jcHVzZXQpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx
LCAzKSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRfYXR0cl9nZXRhZmZpbml0eV9ucCAoY29uc3Qg
cHRocmVhZF9hdHRyX3QgKl9fYXR0ciwKICAgICBzaXplX3QgX19jcHVzZXRzaXplLAogICAgIGNw
dV9zZXRfdCAqX19jcHVzZXQpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs
bF9fICgxLCAzKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9nZXRhdHRyX2RlZmF1bHRfbnAgKHB0
aHJlYWRfYXR0cl90ICpfX2F0dHIpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgxKSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRfc2V0YXR0cl9kZWZhdWx0X25wIChj
b25zdCBwdGhyZWFkX2F0dHJfdCAqX19hdHRyKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18g
KChfX25vbm51bGxfXyAoMSkpKTsKCgoKCmV4dGVybiBpbnQgcHRocmVhZF9nZXRhdHRyX25wIChw
dGhyZWFkX3QgX190aCwgcHRocmVhZF9hdHRyX3QgKl9fYXR0cikKICAgICB0aHJvdyAoKSBfX2F0
dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIpKSk7CgoKCgoKCgpleHRlcm4gaW50IHB0aHJlYWRf
c2V0c2NoZWRwYXJhbSAocHRocmVhZF90IF9fdGFyZ2V0X3RocmVhZCwgaW50IF9fcG9saWN5LAog
ICAgICBjb25zdCBzdHJ1Y3Qgc2NoZWRfcGFyYW0gKl9fcGFyYW0pCiAgICAgdGhyb3cgKCkgX19h
dHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgzKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9nZXRz
Y2hlZHBhcmFtIChwdGhyZWFkX3QgX190YXJnZXRfdGhyZWFkLAogICAgICBpbnQgKl9fcmVzdHJp
Y3QgX19wb2xpY3ksCiAgICAgIHN0cnVjdCBzY2hlZF9wYXJhbSAqX19yZXN0cmljdCBfX3BhcmFt
KQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMiwgMykpKTsKCgpl
eHRlcm4gaW50IHB0aHJlYWRfc2V0c2NoZWRwcmlvIChwdGhyZWFkX3QgX190YXJnZXRfdGhyZWFk
LCBpbnQgX19wcmlvKQogICAgIHRocm93ICgpOwoKCgoKZXh0ZXJuIGludCBwdGhyZWFkX2dldG5h
bWVfbnAgKHB0aHJlYWRfdCBfX3RhcmdldF90aHJlYWQsIGNoYXIgKl9fYnVmLAogICAgICAgICAg
c2l6ZV90IF9fYnVmbGVuKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxf
XyAoMikpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfc2V0bmFtZV9ucCAocHRocmVhZF90IF9fdGFy
Z2V0X3RocmVhZCwgY29uc3QgY2hhciAqX19uYW1lKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRl
X18gKChfX25vbm51bGxfXyAoMikpKTsKCgoKCgpleHRlcm4gaW50IHB0aHJlYWRfZ2V0Y29uY3Vy
cmVuY3kgKHZvaWQpIHRocm93ICgpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9zZXRjb25jdXJyZW5j
eSAoaW50IF9fbGV2ZWwpIHRocm93ICgpOwoKCgoKCgoKZXh0ZXJuIGludCBwdGhyZWFkX3lpZWxk
ICh2b2lkKSB0aHJvdyAoKTsKCgoKCmV4dGVybiBpbnQgcHRocmVhZF9zZXRhZmZpbml0eV9ucCAo
cHRocmVhZF90IF9fdGgsIHNpemVfdCBfX2NwdXNldHNpemUsCiAgICAgICBjb25zdCBjcHVfc2V0
X3QgKl9fY3B1c2V0KQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo
MykpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfZ2V0YWZmaW5pdHlfbnAgKHB0aHJlYWRfdCBfX3Ro
LCBzaXplX3QgX19jcHVzZXRzaXplLAogICAgICAgY3B1X3NldF90ICpfX2NwdXNldCkKICAgICB0
aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDMpKSk7CiMgNDk0ICIvdXNyL2lu
Y2x1ZGUvcHRocmVhZC5oIiAzIDQKZXh0ZXJuIGludCBwdGhyZWFkX29uY2UgKHB0aHJlYWRfb25j
ZV90ICpfX29uY2VfY29udHJvbCwKICAgIHZvaWQgKCpfX2luaXRfcm91dGluZSkgKHZvaWQpKSBf
X2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CiMgNTA2ICIvdXNyL2luY2x1ZGUv
cHRocmVhZC5oIiAzIDQKZXh0ZXJuIGludCBwdGhyZWFkX3NldGNhbmNlbHN0YXRlIChpbnQgX19z
dGF0ZSwgaW50ICpfX29sZHN0YXRlKTsKCgoKZXh0ZXJuIGludCBwdGhyZWFkX3NldGNhbmNlbHR5
cGUgKGludCBfX3R5cGUsIGludCAqX19vbGR0eXBlKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfY2Fu
Y2VsIChwdGhyZWFkX3QgX190aCk7CgoKCgpleHRlcm4gdm9pZCBwdGhyZWFkX3Rlc3RjYW5jZWwg
KHZvaWQpOwoKCgoKdHlwZWRlZiBzdHJ1Y3QKewogIHN0cnVjdAogIHsKICAgIF9fam1wX2J1ZiBf
X2NhbmNlbF9qbXBfYnVmOwogICAgaW50IF9fbWFza193YXNfc2F2ZWQ7CiAgfSBfX2NhbmNlbF9q
bXBfYnVmWzFdOwogIHZvaWQgKl9fcGFkWzRdOwp9IF9fcHRocmVhZF91bndpbmRfYnVmX3QgX19h
dHRyaWJ1dGVfXyAoKF9fYWxpZ25lZF9fKSk7CiMgNTQwICIvdXNyL2luY2x1ZGUvcHRocmVhZC5o
IiAzIDQKc3RydWN0IF9fcHRocmVhZF9jbGVhbnVwX2ZyYW1lCnsKICB2b2lkICgqX19jYW5jZWxf
cm91dGluZSkgKHZvaWQgKik7CiAgdm9pZCAqX19jYW5jZWxfYXJnOwogIGludCBfX2RvX2l0Owog
IGludCBfX2NhbmNlbF90eXBlOwp9OwoKCgoKY2xhc3MgX19wdGhyZWFkX2NsZWFudXBfY2xhc3MK
ewogIHZvaWQgKCpfX2NhbmNlbF9yb3V0aW5lKSAodm9pZCAqKTsKICB2b2lkICpfX2NhbmNlbF9h
cmc7CiAgaW50IF9fZG9faXQ7CiAgaW50IF9fY2FuY2VsX3R5cGU7CgogcHVibGljOgogIF9fcHRo
cmVhZF9jbGVhbnVwX2NsYXNzICh2b2lkICgqX19mY3QpICh2b2lkICopLCB2b2lkICpfX2FyZykK
ICAgIDogX19jYW5jZWxfcm91dGluZSAoX19mY3QpLCBfX2NhbmNlbF9hcmcgKF9fYXJnKSwgX19k
b19pdCAoMSkgeyB9CiAgfl9fcHRocmVhZF9jbGVhbnVwX2NsYXNzICgpIHsgaWYgKF9fZG9faXQp
IF9fY2FuY2VsX3JvdXRpbmUgKF9fY2FuY2VsX2FyZyk7IH0KICB2b2lkIF9fc2V0ZG9pdCAoaW50
IF9fbmV3dmFsKSB7IF9fZG9faXQgPSBfX25ld3ZhbDsgfQogIHZvaWQgX19kZWZlciAoKSB7IHB0
aHJlYWRfc2V0Y2FuY2VsdHlwZSAoUFRIUkVBRF9DQU5DRUxfREVGRVJSRUQsCiAgICAgICAgJl9f
Y2FuY2VsX3R5cGUpOyB9CiAgdm9pZCBfX3Jlc3RvcmUgKCkgY29uc3QgeyBwdGhyZWFkX3NldGNh
bmNlbHR5cGUgKF9fY2FuY2VsX3R5cGUsIDApOyB9Cn07CiMgNzQyICIvdXNyL2luY2x1ZGUvcHRo
cmVhZC5oIiAzIDQKc3RydWN0IF9fam1wX2J1Zl90YWc7CmV4dGVybiBpbnQgX19zaWdzZXRqbXAg
KHN0cnVjdCBfX2ptcF9idWZfdGFnICpfX2VudiwgaW50IF9fc2F2ZW1hc2spIHRocm93ICgpOwoK
CgoKCmV4dGVybiBpbnQgcHRocmVhZF9tdXRleF9pbml0IChwdGhyZWFkX211dGV4X3QgKl9fbXV0
ZXgsCiAgICAgICAgICBjb25zdCBwdGhyZWFkX211dGV4YXR0cl90ICpfX211dGV4YXR0cikKICAg
ICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGlu
dCBwdGhyZWFkX211dGV4X2Rlc3Ryb3kgKHB0aHJlYWRfbXV0ZXhfdCAqX19tdXRleCkKICAgICB0
aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBw
dGhyZWFkX211dGV4X3RyeWxvY2sgKHB0aHJlYWRfbXV0ZXhfdCAqX19tdXRleCkKICAgICB0aHJv
dyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhy
ZWFkX211dGV4X2xvY2sgKHB0aHJlYWRfbXV0ZXhfdCAqX19tdXRleCkKICAgICB0aHJvdyAoKSBf
X2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCmV4dGVybiBpbnQgcHRocmVhZF9t
dXRleF90aW1lZGxvY2sgKHB0aHJlYWRfbXV0ZXhfdCAqX19yZXN0cmljdCBfX211dGV4LAogICAg
ICAgIGNvbnN0IHN0cnVjdCB0aW1lc3BlYyAqX19yZXN0cmljdAogICAgICAgIF9fYWJzdGltZSkg
dGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCgpleHRlcm4g
aW50IHB0aHJlYWRfbXV0ZXhfdW5sb2NrIChwdGhyZWFkX211dGV4X3QgKl9fbXV0ZXgpCiAgICAg
dGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgpleHRlcm4gaW50
IHB0aHJlYWRfbXV0ZXhfZ2V0cHJpb2NlaWxpbmcgKGNvbnN0IHB0aHJlYWRfbXV0ZXhfdCAqCiAg
ICAgIF9fcmVzdHJpY3QgX19tdXRleCwKICAgICAgaW50ICpfX3Jlc3RyaWN0IF9fcHJpb2NlaWxp
bmcpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoK
CgpleHRlcm4gaW50IHB0aHJlYWRfbXV0ZXhfc2V0cHJpb2NlaWxpbmcgKHB0aHJlYWRfbXV0ZXhf
dCAqX19yZXN0cmljdCBfX211dGV4LAogICAgICBpbnQgX19wcmlvY2VpbGluZywKICAgICAgaW50
ICpfX3Jlc3RyaWN0IF9fb2xkX2NlaWxpbmcpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAo
KF9fbm9ubnVsbF9fICgxLCAzKSkpOwoKCgoKZXh0ZXJuIGludCBwdGhyZWFkX211dGV4X2NvbnNp
c3RlbnQgKHB0aHJlYWRfbXV0ZXhfdCAqX19tdXRleCkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0
ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgpleHRlcm4gaW50IHB0aHJlYWRfbXV0ZXhfY29uc2lz
dGVudF9ucCAocHRocmVhZF9tdXRleF90ICpfX211dGV4KQogICAgIHRocm93ICgpIF9fYXR0cmli
dXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKIyA4MDYgIi91c3IvaW5jbHVkZS9wdGhyZWFkLmgi
IDMgNApleHRlcm4gaW50IHB0aHJlYWRfbXV0ZXhhdHRyX2luaXQgKHB0aHJlYWRfbXV0ZXhhdHRy
X3QgKl9fYXR0cikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEp
KSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX211dGV4YXR0cl9kZXN0cm95IChwdGhyZWFkX211dGV4
YXR0cl90ICpfX2F0dHIpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgxKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9tdXRleGF0dHJfZ2V0cHNoYXJlZCAoY29uc3Qg
cHRocmVhZF9tdXRleGF0dHJfdCAqCiAgICAgIF9fcmVzdHJpY3QgX19hdHRyLAogICAgICBpbnQg
Kl9fcmVzdHJpY3QgX19wc2hhcmVkKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfbXV0ZXhhdHRyX3NldHBzaGFy
ZWQgKHB0aHJlYWRfbXV0ZXhhdHRyX3QgKl9fYXR0ciwKICAgICAgaW50IF9fcHNoYXJlZCkKICAg
ICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCmV4dGVybiBp
bnQgcHRocmVhZF9tdXRleGF0dHJfZ2V0dHlwZSAoY29uc3QgcHRocmVhZF9tdXRleGF0dHJfdCAq
X19yZXN0cmljdAogICAgICAgICAgX19hdHRyLCBpbnQgKl9fcmVzdHJpY3QgX19raW5kKQogICAg
IHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgoKCmV4dGVy
biBpbnQgcHRocmVhZF9tdXRleGF0dHJfc2V0dHlwZSAocHRocmVhZF9tdXRleGF0dHJfdCAqX19h
dHRyLCBpbnQgX19raW5kKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxf
XyAoMSkpKTsKCgoKZXh0ZXJuIGludCBwdGhyZWFkX211dGV4YXR0cl9nZXRwcm90b2NvbCAoY29u
c3QgcHRocmVhZF9tdXRleGF0dHJfdCAqCiAgICAgICBfX3Jlc3RyaWN0IF9fYXR0ciwKICAgICAg
IGludCAqX19yZXN0cmljdCBfX3Byb3RvY29sKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18g
KChfX25vbm51bGxfXyAoMSwgMikpKTsKCgoKZXh0ZXJuIGludCBwdGhyZWFkX211dGV4YXR0cl9z
ZXRwcm90b2NvbCAocHRocmVhZF9tdXRleGF0dHJfdCAqX19hdHRyLAogICAgICAgaW50IF9fcHJv
dG9jb2wpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoK
CmV4dGVybiBpbnQgcHRocmVhZF9tdXRleGF0dHJfZ2V0cHJpb2NlaWxpbmcgKGNvbnN0IHB0aHJl
YWRfbXV0ZXhhdHRyX3QgKgogICAgICAgICAgX19yZXN0cmljdCBfX2F0dHIsCiAgICAgICAgICBp
bnQgKl9fcmVzdHJpY3QgX19wcmlvY2VpbGluZykKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9f
ICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX211dGV4YXR0cl9z
ZXRwcmlvY2VpbGluZyAocHRocmVhZF9tdXRleGF0dHJfdCAqX19hdHRyLAogICAgICAgICAgaW50
IF9fcHJpb2NlaWxpbmcpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgxKSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRfbXV0ZXhhdHRyX2dldHJvYnVzdCAoY29uc3Qg
cHRocmVhZF9tdXRleGF0dHJfdCAqX19hdHRyLAogICAgIGludCAqX19yb2J1c3RuZXNzKQogICAg
IHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCmV4dGVybiBp
bnQgcHRocmVhZF9tdXRleGF0dHJfZ2V0cm9idXN0X25wIChjb25zdCBwdGhyZWFkX211dGV4YXR0
cl90ICpfX2F0dHIsCiAgICAgICAgaW50ICpfX3JvYnVzdG5lc3MpCiAgICAgdGhyb3cgKCkgX19h
dHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRf
bXV0ZXhhdHRyX3NldHJvYnVzdCAocHRocmVhZF9tdXRleGF0dHJfdCAqX19hdHRyLAogICAgIGlu
dCBfX3JvYnVzdG5lc3MpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgxKSkpOwoKZXh0ZXJuIGludCBwdGhyZWFkX211dGV4YXR0cl9zZXRyb2J1c3RfbnAgKHB0aHJl
YWRfbXV0ZXhhdHRyX3QgKl9fYXR0ciwKICAgICAgICBpbnQgX19yb2J1c3RuZXNzKQogICAgIHRo
cm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKIyA4ODggIi91c3IvaW5j
bHVkZS9wdGhyZWFkLmgiIDMgNApleHRlcm4gaW50IHB0aHJlYWRfcndsb2NrX2luaXQgKHB0aHJl
YWRfcndsb2NrX3QgKl9fcmVzdHJpY3QgX19yd2xvY2ssCiAgICBjb25zdCBwdGhyZWFkX3J3bG9j
a2F0dHJfdCAqX19yZXN0cmljdAogICAgX19hdHRyKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgo
X19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX3J3bG9ja19kZXN0cm95IChw
dGhyZWFkX3J3bG9ja190ICpfX3J3bG9jaykKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgo
X19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX3J3bG9ja19yZGxvY2sgKHB0
aHJlYWRfcndsb2NrX3QgKl9fcndsb2NrKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChf
X25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfcndsb2NrX3RyeXJkbG9jayAo
cHRocmVhZF9yd2xvY2tfdCAqX19yd2xvY2spCiAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9f
bm9ubnVsbF9fICgxKSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRfcndsb2NrX3RpbWVkcmRsb2Nr
IChwdGhyZWFkX3J3bG9ja190ICpfX3Jlc3RyaWN0IF9fcndsb2NrLAogICAgICAgICAgIGNvbnN0
IHN0cnVjdCB0aW1lc3BlYyAqX19yZXN0cmljdAogICAgICAgICAgIF9fYWJzdGltZSkgdGhyb3cg
KCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCgpleHRlcm4gaW50IHB0
aHJlYWRfcndsb2NrX3dybG9jayAocHRocmVhZF9yd2xvY2tfdCAqX19yd2xvY2spCiAgICAgdGhy
b3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBpbnQgcHRo
cmVhZF9yd2xvY2tfdHJ5d3Jsb2NrIChwdGhyZWFkX3J3bG9ja190ICpfX3J3bG9jaykKICAgICB0
aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCmV4dGVybiBpbnQg
cHRocmVhZF9yd2xvY2tfdGltZWR3cmxvY2sgKHB0aHJlYWRfcndsb2NrX3QgKl9fcmVzdHJpY3Qg
X19yd2xvY2ssCiAgICAgICAgICAgY29uc3Qgc3RydWN0IHRpbWVzcGVjICpfX3Jlc3RyaWN0CiAg
ICAgICAgICAgX19hYnN0aW1lKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18g
KDEsIDIpKSk7CgoKCmV4dGVybiBpbnQgcHRocmVhZF9yd2xvY2tfdW5sb2NrIChwdGhyZWFkX3J3
bG9ja190ICpfX3J3bG9jaykKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxs
X18gKDEpKSk7CgoKCgoKZXh0ZXJuIGludCBwdGhyZWFkX3J3bG9ja2F0dHJfaW5pdCAocHRocmVh
ZF9yd2xvY2thdHRyX3QgKl9fYXR0cikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19u
b25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX3J3bG9ja2F0dHJfZGVzdHJveSAo
cHRocmVhZF9yd2xvY2thdHRyX3QgKl9fYXR0cikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9f
ICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX3J3bG9ja2F0dHJfZ2V0
cHNoYXJlZCAoY29uc3QgcHRocmVhZF9yd2xvY2thdHRyX3QgKgogICAgICAgX19yZXN0cmljdCBf
X2F0dHIsCiAgICAgICBpbnQgKl9fcmVzdHJpY3QgX19wc2hhcmVkKQogICAgIHRocm93ICgpIF9f
YXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRf
cndsb2NrYXR0cl9zZXRwc2hhcmVkIChwdGhyZWFkX3J3bG9ja2F0dHJfdCAqX19hdHRyLAogICAg
ICAgaW50IF9fcHNoYXJlZCkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxs
X18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX3J3bG9ja2F0dHJfZ2V0a2luZF9ucCAoY29u
c3QgcHRocmVhZF9yd2xvY2thdHRyX3QgKgogICAgICAgX19yZXN0cmljdCBfX2F0dHIsCiAgICAg
ICBpbnQgKl9fcmVzdHJpY3QgX19wcmVmKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChf
X25vbm51bGxfXyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfcndsb2NrYXR0cl9zZXRr
aW5kX25wIChwdGhyZWFkX3J3bG9ja2F0dHJfdCAqX19hdHRyLAogICAgICAgaW50IF9fcHJlZikg
dGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKCgoKZXh0ZXJu
IGludCBwdGhyZWFkX2NvbmRfaW5pdCAocHRocmVhZF9jb25kX3QgKl9fcmVzdHJpY3QgX19jb25k
LAogICAgICAgICBjb25zdCBwdGhyZWFkX2NvbmRhdHRyX3QgKl9fcmVzdHJpY3QgX19jb25kX2F0
dHIpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4
dGVybiBpbnQgcHRocmVhZF9jb25kX2Rlc3Ryb3kgKHB0aHJlYWRfY29uZF90ICpfX2NvbmQpCiAg
ICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBp
bnQgcHRocmVhZF9jb25kX3NpZ25hbCAocHRocmVhZF9jb25kX3QgKl9fY29uZCkKICAgICB0aHJv
dyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhy
ZWFkX2NvbmRfYnJvYWRjYXN0IChwdGhyZWFkX2NvbmRfdCAqX19jb25kKQogICAgIHRocm93ICgp
IF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoKCgoKZXh0ZXJuIGludCBwdGhy
ZWFkX2NvbmRfd2FpdCAocHRocmVhZF9jb25kX3QgKl9fcmVzdHJpY3QgX19jb25kLAogICAgICAg
ICBwdGhyZWFkX211dGV4X3QgKl9fcmVzdHJpY3QgX19tdXRleCkKICAgICBfX2F0dHJpYnV0ZV9f
ICgoX19ub25udWxsX18gKDEsIDIpKSk7CiMgMTAwMCAiL3Vzci9pbmNsdWRlL3B0aHJlYWQuaCIg
MyA0CmV4dGVybiBpbnQgcHRocmVhZF9jb25kX3RpbWVkd2FpdCAocHRocmVhZF9jb25kX3QgKl9f
cmVzdHJpY3QgX19jb25kLAogICAgICAgcHRocmVhZF9tdXRleF90ICpfX3Jlc3RyaWN0IF9fbXV0
ZXgsCiAgICAgICBjb25zdCBzdHJ1Y3QgdGltZXNwZWMgKl9fcmVzdHJpY3QgX19hYnN0aW1lKQog
ICAgIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMiwgMykpKTsKCgoKCmV4dGVybiBp
bnQgcHRocmVhZF9jb25kYXR0cl9pbml0IChwdGhyZWFkX2NvbmRhdHRyX3QgKl9fYXR0cikKICAg
ICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGlu
dCBwdGhyZWFkX2NvbmRhdHRyX2Rlc3Ryb3kgKHB0aHJlYWRfY29uZGF0dHJfdCAqX19hdHRyKQog
ICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRlcm4g
aW50IHB0aHJlYWRfY29uZGF0dHJfZ2V0cHNoYXJlZCAoY29uc3QgcHRocmVhZF9jb25kYXR0cl90
ICoKICAgICBfX3Jlc3RyaWN0IF9fYXR0ciwKICAgICBpbnQgKl9fcmVzdHJpY3QgX19wc2hhcmVk
KQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKCgpl
eHRlcm4gaW50IHB0aHJlYWRfY29uZGF0dHJfc2V0cHNoYXJlZCAocHRocmVhZF9jb25kYXR0cl90
ICpfX2F0dHIsCiAgICAgaW50IF9fcHNoYXJlZCkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9f
bm9ubnVsbF9fICgxKSkpOwoKCgpleHRlcm4gaW50IHB0aHJlYWRfY29uZGF0dHJfZ2V0Y2xvY2sg
KGNvbnN0IHB0aHJlYWRfY29uZGF0dHJfdCAqCiAgICAgICAgICBfX3Jlc3RyaWN0IF9fYXR0ciwK
ICAgICAgICAgIF9fY2xvY2tpZF90ICpfX3Jlc3RyaWN0IF9fY2xvY2tfaWQpCiAgICAgdGhyb3cg
KCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCmV4dGVybiBpbnQgcHRo
cmVhZF9jb25kYXR0cl9zZXRjbG9jayAocHRocmVhZF9jb25kYXR0cl90ICpfX2F0dHIsCiAgICAg
ICAgICBfX2Nsb2NraWRfdCBfX2Nsb2NrX2lkKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18g
KChfX25vbm51bGxfXyAoMSkpKTsKIyAxMDQ0ICIvdXNyL2luY2x1ZGUvcHRocmVhZC5oIiAzIDQK
ZXh0ZXJuIGludCBwdGhyZWFkX3NwaW5faW5pdCAocHRocmVhZF9zcGlubG9ja190ICpfX2xvY2ss
IGludCBfX3BzaGFyZWQpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgxKSkpOwoKCmV4dGVybiBpbnQgcHRocmVhZF9zcGluX2Rlc3Ryb3kgKHB0aHJlYWRfc3Bpbmxv
Y2tfdCAqX19sb2NrKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo
MSkpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfc3Bpbl9sb2NrIChwdGhyZWFkX3NwaW5sb2NrX3Qg
Kl9fbG9jaykKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7
CgoKZXh0ZXJuIGludCBwdGhyZWFkX3NwaW5fdHJ5bG9jayAocHRocmVhZF9zcGlubG9ja190ICpf
X2xvY2spCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoK
CmV4dGVybiBpbnQgcHRocmVhZF9zcGluX3VubG9jayAocHRocmVhZF9zcGlubG9ja190ICpfX2xv
Y2spCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoK
CgpleHRlcm4gaW50IHB0aHJlYWRfYmFycmllcl9pbml0IChwdGhyZWFkX2JhcnJpZXJfdCAqX19y
ZXN0cmljdCBfX2JhcnJpZXIsCiAgICAgY29uc3QgcHRocmVhZF9iYXJyaWVyYXR0cl90ICpfX3Jl
c3RyaWN0CiAgICAgX19hdHRyLCB1bnNpZ25lZCBpbnQgX19jb3VudCkKICAgICB0aHJvdyAoKSBf
X2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFkX2Jh
cnJpZXJfZGVzdHJveSAocHRocmVhZF9iYXJyaWVyX3QgKl9fYmFycmllcikKICAgICB0aHJvdyAo
KSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBwdGhyZWFk
X2JhcnJpZXJfd2FpdCAocHRocmVhZF9iYXJyaWVyX3QgKl9fYmFycmllcikKICAgICB0aHJvdyAo
KSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCmV4dGVybiBpbnQgcHRocmVh
ZF9iYXJyaWVyYXR0cl9pbml0IChwdGhyZWFkX2JhcnJpZXJhdHRyX3QgKl9fYXR0cikKICAgICB0
aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGludCBw
dGhyZWFkX2JhcnJpZXJhdHRyX2Rlc3Ryb3kgKHB0aHJlYWRfYmFycmllcmF0dHJfdCAqX19hdHRy
KQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgpleHRl
cm4gaW50IHB0aHJlYWRfYmFycmllcmF0dHJfZ2V0cHNoYXJlZCAoY29uc3QgcHRocmVhZF9iYXJy
aWVyYXR0cl90ICoKICAgICAgICBfX3Jlc3RyaWN0IF9fYXR0ciwKICAgICAgICBpbnQgKl9fcmVz
dHJpY3QgX19wc2hhcmVkKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxf
XyAoMSwgMikpKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfYmFycmllcmF0dHJfc2V0cHNoYXJlZCAo
cHRocmVhZF9iYXJyaWVyYXR0cl90ICpfX2F0dHIsCiAgICAgICAgaW50IF9fcHNoYXJlZCkKICAg
ICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CiMgMTExMSAiL3Vz
ci9pbmNsdWRlL3B0aHJlYWQuaCIgMyA0CmV4dGVybiBpbnQgcHRocmVhZF9rZXlfY3JlYXRlIChw
dGhyZWFkX2tleV90ICpfX2tleSwKICAgICAgICAgIHZvaWQgKCpfX2Rlc3RyX2Z1bmN0aW9uKSAo
dm9pZCAqKSkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7
CgoKZXh0ZXJuIGludCBwdGhyZWFkX2tleV9kZWxldGUgKHB0aHJlYWRfa2V5X3QgX19rZXkpIHRo
cm93ICgpOwoKCmV4dGVybiB2b2lkICpwdGhyZWFkX2dldHNwZWNpZmljIChwdGhyZWFkX2tleV90
IF9fa2V5KSB0aHJvdyAoKTsKCgpleHRlcm4gaW50IHB0aHJlYWRfc2V0c3BlY2lmaWMgKHB0aHJl
YWRfa2V5X3QgX19rZXksCiAgICBjb25zdCB2b2lkICpfX3BvaW50ZXIpIHRocm93ICgpIDsKCgoK
CmV4dGVybiBpbnQgcHRocmVhZF9nZXRjcHVjbG9ja2lkIChwdGhyZWFkX3QgX190aHJlYWRfaWQs
CiAgICAgIF9fY2xvY2tpZF90ICpfX2Nsb2NrX2lkKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRl
X18gKChfX25vbm51bGxfXyAoMikpKTsKIyAxMTQ1ICIvdXNyL2luY2x1ZGUvcHRocmVhZC5oIiAz
IDQKZXh0ZXJuIGludCBwdGhyZWFkX2F0Zm9yayAodm9pZCAoKl9fcHJlcGFyZSkgKHZvaWQpLAog
ICAgICB2b2lkICgqX19wYXJlbnQpICh2b2lkKSwKICAgICAgdm9pZCAoKl9fY2hpbGQpICh2b2lk
KSkgdGhyb3cgKCk7CgoKCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lu
bGluZV9fKSkgaW50Cl9fYXR0cmlidXRlX18gKChfX2xlYWZfXykpIHB0aHJlYWRfZXF1YWwgKHB0
aHJlYWRfdCBfX3RocmVhZDEsIHB0aHJlYWRfdCBfX3RocmVhZDIpIHRocm93ICgpCnsKICByZXR1
cm4gX190aHJlYWQxID09IF9fdGhyZWFkMjsKfQoKCn0KIyAzNiAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9ndGhyLWRlZmF1bHQuaCIgMiAzCiMgNDcgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvczM5MHgtcmVkaGF0LWxpbnV4L2JpdHMvZ3Roci1kZWZhdWx0
LmgiIDMKdHlwZWRlZiBwdGhyZWFkX3QgX19ndGhyZWFkX3Q7CnR5cGVkZWYgcHRocmVhZF9rZXlf
dCBfX2d0aHJlYWRfa2V5X3Q7CnR5cGVkZWYgcHRocmVhZF9vbmNlX3QgX19ndGhyZWFkX29uY2Vf
dDsKdHlwZWRlZiBwdGhyZWFkX211dGV4X3QgX19ndGhyZWFkX211dGV4X3Q7CnR5cGVkZWYgcHRo
cmVhZF9tdXRleF90IF9fZ3RocmVhZF9yZWN1cnNpdmVfbXV0ZXhfdDsKdHlwZWRlZiBwdGhyZWFk
X2NvbmRfdCBfX2d0aHJlYWRfY29uZF90Owp0eXBlZGVmIHN0cnVjdCB0aW1lc3BlYyBfX2d0aHJl
YWRfdGltZV90OwojIDEwMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGlu
dXgvYml0cy9ndGhyLWRlZmF1bHQuaCIgMwpzdGF0aWMgX190eXBlb2YocHRocmVhZF9vbmNlKSBf
X2d0aHJ3X3B0aHJlYWRfb25jZSBfX2F0dHJpYnV0ZV9fICgoX193ZWFrcmVmX18oInB0aHJlYWRf
b25jZSIpKSk7CnN0YXRpYyBfX3R5cGVvZihwdGhyZWFkX2dldHNwZWNpZmljKSBfX2d0aHJ3X3B0
aHJlYWRfZ2V0c3BlY2lmaWMgX19hdHRyaWJ1dGVfXyAoKF9fd2Vha3JlZl9fKCJwdGhyZWFkX2dl
dHNwZWNpZmljIikpKTsKc3RhdGljIF9fdHlwZW9mKHB0aHJlYWRfc2V0c3BlY2lmaWMpIF9fZ3Ro
cndfcHRocmVhZF9zZXRzcGVjaWZpYyBfX2F0dHJpYnV0ZV9fICgoX193ZWFrcmVmX18oInB0aHJl
YWRfc2V0c3BlY2lmaWMiKSkpOwoKc3RhdGljIF9fdHlwZW9mKHB0aHJlYWRfY3JlYXRlKSBfX2d0
aHJ3X3B0aHJlYWRfY3JlYXRlIF9fYXR0cmlidXRlX18gKChfX3dlYWtyZWZfXygicHRocmVhZF9j
cmVhdGUiKSkpOwpzdGF0aWMgX190eXBlb2YocHRocmVhZF9qb2luKSBfX2d0aHJ3X3B0aHJlYWRf
am9pbiBfX2F0dHJpYnV0ZV9fICgoX193ZWFrcmVmX18oInB0aHJlYWRfam9pbiIpKSk7CnN0YXRp
YyBfX3R5cGVvZihwdGhyZWFkX2VxdWFsKSBfX2d0aHJ3X3B0aHJlYWRfZXF1YWwgX19hdHRyaWJ1
dGVfXyAoKF9fd2Vha3JlZl9fKCJwdGhyZWFkX2VxdWFsIikpKTsKc3RhdGljIF9fdHlwZW9mKHB0
aHJlYWRfc2VsZikgX19ndGhyd19wdGhyZWFkX3NlbGYgX19hdHRyaWJ1dGVfXyAoKF9fd2Vha3Jl
Zl9fKCJwdGhyZWFkX3NlbGYiKSkpOwpzdGF0aWMgX190eXBlb2YocHRocmVhZF9kZXRhY2gpIF9f
Z3RocndfcHRocmVhZF9kZXRhY2ggX19hdHRyaWJ1dGVfXyAoKF9fd2Vha3JlZl9fKCJwdGhyZWFk
X2RldGFjaCIpKSk7CgpzdGF0aWMgX190eXBlb2YocHRocmVhZF9jYW5jZWwpIF9fZ3RocndfcHRo
cmVhZF9jYW5jZWwgX19hdHRyaWJ1dGVfXyAoKF9fd2Vha3JlZl9fKCJwdGhyZWFkX2NhbmNlbCIp
KSk7CgpzdGF0aWMgX190eXBlb2Yoc2NoZWRfeWllbGQpIF9fZ3Rocndfc2NoZWRfeWllbGQgX19h
dHRyaWJ1dGVfXyAoKF9fd2Vha3JlZl9fKCJzY2hlZF95aWVsZCIpKSk7CgpzdGF0aWMgX190eXBl
b2YocHRocmVhZF9tdXRleF9sb2NrKSBfX2d0aHJ3X3B0aHJlYWRfbXV0ZXhfbG9jayBfX2F0dHJp
YnV0ZV9fICgoX193ZWFrcmVmX18oInB0aHJlYWRfbXV0ZXhfbG9jayIpKSk7CnN0YXRpYyBfX3R5
cGVvZihwdGhyZWFkX211dGV4X3RyeWxvY2spIF9fZ3RocndfcHRocmVhZF9tdXRleF90cnlsb2Nr
IF9fYXR0cmlidXRlX18gKChfX3dlYWtyZWZfXygicHRocmVhZF9tdXRleF90cnlsb2NrIikpKTsK
CnN0YXRpYyBfX3R5cGVvZihwdGhyZWFkX211dGV4X3RpbWVkbG9jaykgX19ndGhyd19wdGhyZWFk
X211dGV4X3RpbWVkbG9jayBfX2F0dHJpYnV0ZV9fICgoX193ZWFrcmVmX18oInB0aHJlYWRfbXV0
ZXhfdGltZWRsb2NrIikpKTsKCnN0YXRpYyBfX3R5cGVvZihwdGhyZWFkX211dGV4X3VubG9jaykg
X19ndGhyd19wdGhyZWFkX211dGV4X3VubG9jayBfX2F0dHJpYnV0ZV9fICgoX193ZWFrcmVmX18o
InB0aHJlYWRfbXV0ZXhfdW5sb2NrIikpKTsKc3RhdGljIF9fdHlwZW9mKHB0aHJlYWRfbXV0ZXhf
aW5pdCkgX19ndGhyd19wdGhyZWFkX211dGV4X2luaXQgX19hdHRyaWJ1dGVfXyAoKF9fd2Vha3Jl
Zl9fKCJwdGhyZWFkX211dGV4X2luaXQiKSkpOwpzdGF0aWMgX190eXBlb2YocHRocmVhZF9tdXRl
eF9kZXN0cm95KSBfX2d0aHJ3X3B0aHJlYWRfbXV0ZXhfZGVzdHJveSBfX2F0dHJpYnV0ZV9fICgo
X193ZWFrcmVmX18oInB0aHJlYWRfbXV0ZXhfZGVzdHJveSIpKSk7CgpzdGF0aWMgX190eXBlb2Yo
cHRocmVhZF9jb25kX2luaXQpIF9fZ3RocndfcHRocmVhZF9jb25kX2luaXQgX19hdHRyaWJ1dGVf
XyAoKF9fd2Vha3JlZl9fKCJwdGhyZWFkX2NvbmRfaW5pdCIpKSk7CnN0YXRpYyBfX3R5cGVvZihw
dGhyZWFkX2NvbmRfYnJvYWRjYXN0KSBfX2d0aHJ3X3B0aHJlYWRfY29uZF9icm9hZGNhc3QgX19h
dHRyaWJ1dGVfXyAoKF9fd2Vha3JlZl9fKCJwdGhyZWFkX2NvbmRfYnJvYWRjYXN0IikpKTsKc3Rh
dGljIF9fdHlwZW9mKHB0aHJlYWRfY29uZF9zaWduYWwpIF9fZ3RocndfcHRocmVhZF9jb25kX3Np
Z25hbCBfX2F0dHJpYnV0ZV9fICgoX193ZWFrcmVmX18oInB0aHJlYWRfY29uZF9zaWduYWwiKSkp
OwpzdGF0aWMgX190eXBlb2YocHRocmVhZF9jb25kX3dhaXQpIF9fZ3RocndfcHRocmVhZF9jb25k
X3dhaXQgX19hdHRyaWJ1dGVfXyAoKF9fd2Vha3JlZl9fKCJwdGhyZWFkX2NvbmRfd2FpdCIpKSk7
CnN0YXRpYyBfX3R5cGVvZihwdGhyZWFkX2NvbmRfdGltZWR3YWl0KSBfX2d0aHJ3X3B0aHJlYWRf
Y29uZF90aW1lZHdhaXQgX19hdHRyaWJ1dGVfXyAoKF9fd2Vha3JlZl9fKCJwdGhyZWFkX2NvbmRf
dGltZWR3YWl0IikpKTsKc3RhdGljIF9fdHlwZW9mKHB0aHJlYWRfY29uZF9kZXN0cm95KSBfX2d0
aHJ3X3B0aHJlYWRfY29uZF9kZXN0cm95IF9fYXR0cmlidXRlX18gKChfX3dlYWtyZWZfXygicHRo
cmVhZF9jb25kX2Rlc3Ryb3kiKSkpOwoKc3RhdGljIF9fdHlwZW9mKHB0aHJlYWRfa2V5X2NyZWF0
ZSkgX19ndGhyd19wdGhyZWFkX2tleV9jcmVhdGUgX19hdHRyaWJ1dGVfXyAoKF9fd2Vha3JlZl9f
KCJwdGhyZWFkX2tleV9jcmVhdGUiKSkpOwpzdGF0aWMgX190eXBlb2YocHRocmVhZF9rZXlfZGVs
ZXRlKSBfX2d0aHJ3X3B0aHJlYWRfa2V5X2RlbGV0ZSBfX2F0dHJpYnV0ZV9fICgoX193ZWFrcmVm
X18oInB0aHJlYWRfa2V5X2RlbGV0ZSIpKSk7CnN0YXRpYyBfX3R5cGVvZihwdGhyZWFkX211dGV4
YXR0cl9pbml0KSBfX2d0aHJ3X3B0aHJlYWRfbXV0ZXhhdHRyX2luaXQgX19hdHRyaWJ1dGVfXyAo
KF9fd2Vha3JlZl9fKCJwdGhyZWFkX211dGV4YXR0cl9pbml0IikpKTsKc3RhdGljIF9fdHlwZW9m
KHB0aHJlYWRfbXV0ZXhhdHRyX3NldHR5cGUpIF9fZ3RocndfcHRocmVhZF9tdXRleGF0dHJfc2V0
dHlwZSBfX2F0dHJpYnV0ZV9fICgoX193ZWFrcmVmX18oInB0aHJlYWRfbXV0ZXhhdHRyX3NldHR5
cGUiKSkpOwpzdGF0aWMgX190eXBlb2YocHRocmVhZF9tdXRleGF0dHJfZGVzdHJveSkgX19ndGhy
d19wdGhyZWFkX211dGV4YXR0cl9kZXN0cm95IF9fYXR0cmlidXRlX18gKChfX3dlYWtyZWZfXygi
cHRocmVhZF9tdXRleGF0dHJfZGVzdHJveSIpKSk7CiMgMjM2ICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2d0aHItZGVmYXVsdC5oIiAzCnN0YXRpYyBfX3R5
cGVvZihwdGhyZWFkX2tleV9jcmVhdGUpIF9fZ3RocndfX19wdGhyZWFkX2tleV9jcmVhdGUgX19h
dHRyaWJ1dGVfXyAoKF9fd2Vha3JlZl9fKCJfX3B0aHJlYWRfa2V5X2NyZWF0ZSIpKSk7CiMgMjQ2
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2d0aHItZGVm
YXVsdC5oIiAzCnN0YXRpYyBpbmxpbmUgaW50Cl9fZ3RocmVhZF9hY3RpdmVfcCAodm9pZCkKewog
IHN0YXRpYyB2b2lkICpjb25zdCBfX2d0aHJlYWRfYWN0aXZlX3B0cgogICAgPSBfX2V4dGVuc2lv
bl9fICh2b2lkICopICZfX2d0aHJ3X19fcHRocmVhZF9rZXlfY3JlYXRlOwogIHJldHVybiBfX2d0
aHJlYWRfYWN0aXZlX3B0ciAhPSAwOwp9CiMgNjU4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3Mz
OTB4LXJlZGhhdC1saW51eC9iaXRzL2d0aHItZGVmYXVsdC5oIiAzCnN0YXRpYyBpbmxpbmUgaW50
Cl9fZ3RocmVhZF9jcmVhdGUgKF9fZ3RocmVhZF90ICpfX3RocmVhZGlkLCB2b2lkICooKl9fZnVu
YykgKHZvaWQqKSwKICAgIHZvaWQgKl9fYXJncykKewogIHJldHVybiBfX2d0aHJ3X3B0aHJlYWRf
Y3JlYXRlIChfX3RocmVhZGlkLCBfX251bGwsIF9fZnVuYywgX19hcmdzKTsKfQoKc3RhdGljIGlu
bGluZSBpbnQKX19ndGhyZWFkX2pvaW4gKF9fZ3RocmVhZF90IF9fdGhyZWFkaWQsIHZvaWQgKipf
X3ZhbHVlX3B0cikKewogIHJldHVybiBfX2d0aHJ3X3B0aHJlYWRfam9pbiAoX190aHJlYWRpZCwg
X192YWx1ZV9wdHIpOwp9CgpzdGF0aWMgaW5saW5lIGludApfX2d0aHJlYWRfZGV0YWNoIChfX2d0
aHJlYWRfdCBfX3RocmVhZGlkKQp7CiAgcmV0dXJuIF9fZ3RocndfcHRocmVhZF9kZXRhY2ggKF9f
dGhyZWFkaWQpOwp9CgpzdGF0aWMgaW5saW5lIGludApfX2d0aHJlYWRfZXF1YWwgKF9fZ3RocmVh
ZF90IF9fdDEsIF9fZ3RocmVhZF90IF9fdDIpCnsKICByZXR1cm4gX19ndGhyd19wdGhyZWFkX2Vx
dWFsIChfX3QxLCBfX3QyKTsKfQoKc3RhdGljIGlubGluZSBfX2d0aHJlYWRfdApfX2d0aHJlYWRf
c2VsZiAodm9pZCkKewogIHJldHVybiBfX2d0aHJ3X3B0aHJlYWRfc2VsZiAoKTsKfQoKc3RhdGlj
IGlubGluZSBpbnQKX19ndGhyZWFkX3lpZWxkICh2b2lkKQp7CiAgcmV0dXJuIF9fZ3Rocndfc2No
ZWRfeWllbGQgKCk7Cn0KCnN0YXRpYyBpbmxpbmUgaW50Cl9fZ3RocmVhZF9vbmNlIChfX2d0aHJl
YWRfb25jZV90ICpfX29uY2UsIHZvaWQgKCpfX2Z1bmMpICh2b2lkKSkKewogIGlmIChfX2d0aHJl
YWRfYWN0aXZlX3AgKCkpCiAgICByZXR1cm4gX19ndGhyd19wdGhyZWFkX29uY2UgKF9fb25jZSwg
X19mdW5jKTsKICBlbHNlCiAgICByZXR1cm4gLTE7Cn0KCnN0YXRpYyBpbmxpbmUgaW50Cl9fZ3Ro
cmVhZF9rZXlfY3JlYXRlIChfX2d0aHJlYWRfa2V5X3QgKl9fa2V5LCB2b2lkICgqX19kdG9yKSAo
dm9pZCAqKSkKewogIHJldHVybiBfX2d0aHJ3X3B0aHJlYWRfa2V5X2NyZWF0ZSAoX19rZXksIF9f
ZHRvcik7Cn0KCnN0YXRpYyBpbmxpbmUgaW50Cl9fZ3RocmVhZF9rZXlfZGVsZXRlIChfX2d0aHJl
YWRfa2V5X3QgX19rZXkpCnsKICByZXR1cm4gX19ndGhyd19wdGhyZWFkX2tleV9kZWxldGUgKF9f
a2V5KTsKfQoKc3RhdGljIGlubGluZSB2b2lkICoKX19ndGhyZWFkX2dldHNwZWNpZmljIChfX2d0
aHJlYWRfa2V5X3QgX19rZXkpCnsKICByZXR1cm4gX19ndGhyd19wdGhyZWFkX2dldHNwZWNpZmlj
IChfX2tleSk7Cn0KCnN0YXRpYyBpbmxpbmUgaW50Cl9fZ3RocmVhZF9zZXRzcGVjaWZpYyAoX19n
dGhyZWFkX2tleV90IF9fa2V5LCBjb25zdCB2b2lkICpfX3B0cikKewogIHJldHVybiBfX2d0aHJ3
X3B0aHJlYWRfc2V0c3BlY2lmaWMgKF9fa2V5LCBfX3B0cik7Cn0KCnN0YXRpYyBpbmxpbmUgdm9p
ZApfX2d0aHJlYWRfbXV0ZXhfaW5pdF9mdW5jdGlvbiAoX19ndGhyZWFkX211dGV4X3QgKl9fbXV0
ZXgpCnsKICBpZiAoX19ndGhyZWFkX2FjdGl2ZV9wICgpKQogICAgX19ndGhyd19wdGhyZWFkX211
dGV4X2luaXQgKF9fbXV0ZXgsIF9fbnVsbCk7Cn0KCnN0YXRpYyBpbmxpbmUgaW50Cl9fZ3RocmVh
ZF9tdXRleF9kZXN0cm95IChfX2d0aHJlYWRfbXV0ZXhfdCAqX19tdXRleCkKewogIGlmIChfX2d0
aHJlYWRfYWN0aXZlX3AgKCkpCiAgICByZXR1cm4gX19ndGhyd19wdGhyZWFkX211dGV4X2Rlc3Ry
b3kgKF9fbXV0ZXgpOwogIGVsc2UKICAgIHJldHVybiAwOwp9CgpzdGF0aWMgaW5saW5lIGludApf
X2d0aHJlYWRfbXV0ZXhfbG9jayAoX19ndGhyZWFkX211dGV4X3QgKl9fbXV0ZXgpCnsKICBpZiAo
X19ndGhyZWFkX2FjdGl2ZV9wICgpKQogICAgcmV0dXJuIF9fZ3RocndfcHRocmVhZF9tdXRleF9s
b2NrIChfX211dGV4KTsKICBlbHNlCiAgICByZXR1cm4gMDsKfQoKc3RhdGljIGlubGluZSBpbnQK
X19ndGhyZWFkX211dGV4X3RyeWxvY2sgKF9fZ3RocmVhZF9tdXRleF90ICpfX211dGV4KQp7CiAg
aWYgKF9fZ3RocmVhZF9hY3RpdmVfcCAoKSkKICAgIHJldHVybiBfX2d0aHJ3X3B0aHJlYWRfbXV0
ZXhfdHJ5bG9jayAoX19tdXRleCk7CiAgZWxzZQogICAgcmV0dXJuIDA7Cn0KCgpzdGF0aWMgaW5s
aW5lIGludApfX2d0aHJlYWRfbXV0ZXhfdGltZWRsb2NrIChfX2d0aHJlYWRfbXV0ZXhfdCAqX19t
dXRleCwKICAgICAgY29uc3QgX19ndGhyZWFkX3RpbWVfdCAqX19hYnNfdGltZW91dCkKewogIGlm
IChfX2d0aHJlYWRfYWN0aXZlX3AgKCkpCiAgICByZXR1cm4gX19ndGhyd19wdGhyZWFkX211dGV4
X3RpbWVkbG9jayAoX19tdXRleCwgX19hYnNfdGltZW91dCk7CiAgZWxzZQogICAgcmV0dXJuIDA7
Cn0KCgpzdGF0aWMgaW5saW5lIGludApfX2d0aHJlYWRfbXV0ZXhfdW5sb2NrIChfX2d0aHJlYWRf
bXV0ZXhfdCAqX19tdXRleCkKewogIGlmIChfX2d0aHJlYWRfYWN0aXZlX3AgKCkpCiAgICByZXR1
cm4gX19ndGhyd19wdGhyZWFkX211dGV4X3VubG9jayAoX19tdXRleCk7CiAgZWxzZQogICAgcmV0
dXJuIDA7Cn0KIyA4MDcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvczM5MHgtcmVkaGF0LWxpbnV4
L2JpdHMvZ3Roci1kZWZhdWx0LmgiIDMKc3RhdGljIGlubGluZSBpbnQKX19ndGhyZWFkX3JlY3Vy
c2l2ZV9tdXRleF9sb2NrIChfX2d0aHJlYWRfcmVjdXJzaXZlX211dGV4X3QgKl9fbXV0ZXgpCnsK
ICByZXR1cm4gX19ndGhyZWFkX211dGV4X2xvY2sgKF9fbXV0ZXgpOwp9CgpzdGF0aWMgaW5saW5l
IGludApfX2d0aHJlYWRfcmVjdXJzaXZlX211dGV4X3RyeWxvY2sgKF9fZ3RocmVhZF9yZWN1cnNp
dmVfbXV0ZXhfdCAqX19tdXRleCkKewogIHJldHVybiBfX2d0aHJlYWRfbXV0ZXhfdHJ5bG9jayAo
X19tdXRleCk7Cn0KCgpzdGF0aWMgaW5saW5lIGludApfX2d0aHJlYWRfcmVjdXJzaXZlX211dGV4
X3RpbWVkbG9jayAoX19ndGhyZWFkX3JlY3Vyc2l2ZV9tdXRleF90ICpfX211dGV4LAogICAgICAg
ICBjb25zdCBfX2d0aHJlYWRfdGltZV90ICpfX2Fic190aW1lb3V0KQp7CiAgcmV0dXJuIF9fZ3Ro
cmVhZF9tdXRleF90aW1lZGxvY2sgKF9fbXV0ZXgsIF9fYWJzX3RpbWVvdXQpOwp9CgoKc3RhdGlj
IGlubGluZSBpbnQKX19ndGhyZWFkX3JlY3Vyc2l2ZV9tdXRleF91bmxvY2sgKF9fZ3RocmVhZF9y
ZWN1cnNpdmVfbXV0ZXhfdCAqX19tdXRleCkKewogIHJldHVybiBfX2d0aHJlYWRfbXV0ZXhfdW5s
b2NrIChfX211dGV4KTsKfQoKc3RhdGljIGlubGluZSBpbnQKX19ndGhyZWFkX3JlY3Vyc2l2ZV9t
dXRleF9kZXN0cm95IChfX2d0aHJlYWRfcmVjdXJzaXZlX211dGV4X3QgKl9fbXV0ZXgpCnsKICBy
ZXR1cm4gX19ndGhyZWFkX211dGV4X2Rlc3Ryb3kgKF9fbXV0ZXgpOwp9CiMgODQ5ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2d0aHItZGVmYXVsdC5oIiAz
CnN0YXRpYyBpbmxpbmUgaW50Cl9fZ3RocmVhZF9jb25kX2Jyb2FkY2FzdCAoX19ndGhyZWFkX2Nv
bmRfdCAqX19jb25kKQp7CiAgcmV0dXJuIF9fZ3RocndfcHRocmVhZF9jb25kX2Jyb2FkY2FzdCAo
X19jb25kKTsKfQoKc3RhdGljIGlubGluZSBpbnQKX19ndGhyZWFkX2NvbmRfc2lnbmFsIChfX2d0
aHJlYWRfY29uZF90ICpfX2NvbmQpCnsKICByZXR1cm4gX19ndGhyd19wdGhyZWFkX2NvbmRfc2ln
bmFsIChfX2NvbmQpOwp9CgpzdGF0aWMgaW5saW5lIGludApfX2d0aHJlYWRfY29uZF93YWl0IChf
X2d0aHJlYWRfY29uZF90ICpfX2NvbmQsIF9fZ3RocmVhZF9tdXRleF90ICpfX211dGV4KQp7CiAg
cmV0dXJuIF9fZ3RocndfcHRocmVhZF9jb25kX3dhaXQgKF9fY29uZCwgX19tdXRleCk7Cn0KCnN0
YXRpYyBpbmxpbmUgaW50Cl9fZ3RocmVhZF9jb25kX3RpbWVkd2FpdCAoX19ndGhyZWFkX2NvbmRf
dCAqX19jb25kLCBfX2d0aHJlYWRfbXV0ZXhfdCAqX19tdXRleCwKICAgICBjb25zdCBfX2d0aHJl
YWRfdGltZV90ICpfX2Fic190aW1lb3V0KQp7CiAgcmV0dXJuIF9fZ3RocndfcHRocmVhZF9jb25k
X3RpbWVkd2FpdCAoX19jb25kLCBfX211dGV4LCBfX2Fic190aW1lb3V0KTsKfQoKc3RhdGljIGlu
bGluZSBpbnQKX19ndGhyZWFkX2NvbmRfd2FpdF9yZWN1cnNpdmUgKF9fZ3RocmVhZF9jb25kX3Qg
Kl9fY29uZCwKICAgICAgICAgIF9fZ3RocmVhZF9yZWN1cnNpdmVfbXV0ZXhfdCAqX19tdXRleCkK
ewogIHJldHVybiBfX2d0aHJlYWRfY29uZF93YWl0IChfX2NvbmQsIF9fbXV0ZXgpOwp9CgpzdGF0
aWMgaW5saW5lIGludApfX2d0aHJlYWRfY29uZF9kZXN0cm95IChfX2d0aHJlYWRfY29uZF90KiBf
X2NvbmQpCnsKICByZXR1cm4gX19ndGhyd19wdGhyZWFkX2NvbmRfZGVzdHJveSAoX19jb25kKTsK
fQojIDE0OSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9n
dGhyLmgiIDIgMwoKCiNwcmFnbWEgR0NDIHZpc2liaWxpdHkgcG9wCiMgMzYgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvZXh0L2F0b21pY2l0eS5oIiAyIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2F0b21pY193b3JkLmgiIDEgMwojIDMyICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2F0b21pY193b3JkLmgi
IDMKdHlwZWRlZiBpbnQgX0F0b21pY193b3JkOwojIDM3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2V4dC9hdG9taWNpdHkuaCIgMiAzCgpuYW1lc3BhY2UgX19nbnVfY3h4IF9fYXR0cmlidXRlX18g
KChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCiMgNTUgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvZXh0L2F0b21pY2l0eS5oIiAzCiAgX0F0b21pY193b3JkCiAgX19hdHRyaWJ1dGVfXyAo
KF9fdW51c2VkX18pKQogIF9fZXhjaGFuZ2VfYW5kX2FkZCh2b2xhdGlsZSBfQXRvbWljX3dvcmQq
LCBpbnQpIHRocm93ICgpOwoKICB2b2lkCiAgX19hdHRyaWJ1dGVfXyAoKF9fdW51c2VkX18pKQog
IF9fYXRvbWljX2FkZCh2b2xhdGlsZSBfQXRvbWljX3dvcmQqLCBpbnQpIHRocm93ICgpOwoKCiAg
c3RhdGljIGlubGluZSBfQXRvbWljX3dvcmQKICBfX2V4Y2hhbmdlX2FuZF9hZGRfc2luZ2xlKF9B
dG9taWNfd29yZCogX19tZW0sIGludCBfX3ZhbCkKICB7CiAgICBfQXRvbWljX3dvcmQgX19yZXN1
bHQgPSAqX19tZW07CiAgICAqX19tZW0gKz0gX192YWw7CiAgICByZXR1cm4gX19yZXN1bHQ7CiAg
fQoKICBzdGF0aWMgaW5saW5lIHZvaWQKICBfX2F0b21pY19hZGRfc2luZ2xlKF9BdG9taWNfd29y
ZCogX19tZW0sIGludCBfX3ZhbCkKICB7ICpfX21lbSArPSBfX3ZhbDsgfQoKICBzdGF0aWMgaW5s
aW5lIF9BdG9taWNfd29yZAogIF9fYXR0cmlidXRlX18gKChfX3VudXNlZF9fKSkKICBfX2V4Y2hh
bmdlX2FuZF9hZGRfZGlzcGF0Y2goX0F0b21pY193b3JkKiBfX21lbSwgaW50IF9fdmFsKQogIHsK
CiAgICBpZiAoX19ndGhyZWFkX2FjdGl2ZV9wKCkpCiAgICAgIHJldHVybiBfX2V4Y2hhbmdlX2Fu
ZF9hZGQoX19tZW0sIF9fdmFsKTsKICAgIGVsc2UKICAgICAgcmV0dXJuIF9fZXhjaGFuZ2VfYW5k
X2FkZF9zaW5nbGUoX19tZW0sIF9fdmFsKTsKCgoKICB9CgogIHN0YXRpYyBpbmxpbmUgdm9pZAog
IF9fYXR0cmlidXRlX18gKChfX3VudXNlZF9fKSkKICBfX2F0b21pY19hZGRfZGlzcGF0Y2goX0F0
b21pY193b3JkKiBfX21lbSwgaW50IF9fdmFsKQogIHsKCiAgICBpZiAoX19ndGhyZWFkX2FjdGl2
ZV9wKCkpCiAgICAgIF9fYXRvbWljX2FkZChfX21lbSwgX192YWwpOwogICAgZWxzZQogICAgICBf
X2F0b21pY19hZGRfc2luZ2xlKF9fbWVtLCBfX3ZhbCk7CgoKCiAgfQoKCn0KIyA0MCAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9iaXRzL2lvc19iYXNlLmgiIDIgMwoKIyAxICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvbG9jYWxlX2NsYXNzZXMuaCIgMSAzCiMgMzcgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9sb2NhbGVfY2xhc3Nlcy5oIiAzCiAgICAgICAKIyAzOCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9jbGFzc2VzLmgiIDMKCgojIDEgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvc3RyaW5nIiAxIDMKIyAzNiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zdHJp
bmciIDMKICAgICAgIAojIDM3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmluZyIgMwoKCgoK
CgoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvb3N0cmVhbV9pbnNlcnQuaCIgMSAz
CiMgMzMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9vc3RyZWFtX2luc2VydC5oIiAzCiAg
ICAgICAKIyAzNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL29zdHJlYW1faW5zZXJ0Lmgi
IDMKCgojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9jeHhhYmlfZm9yY2VkLmgiIDEg
MwojIDM0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvY3h4YWJpX2ZvcmNlZC5oIiAzCiAg
ICAgICAKIyAzNSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2N4eGFiaV9mb3JjZWQuaCIg
MwoKI3ByYWdtYSBHQ0MgdmlzaWJpbGl0eSBwdXNoKGRlZmF1bHQpCgoKbmFtZXNwYWNlIF9fY3h4
YWJpdjEKewoKCgoKCgoKICBjbGFzcyBfX2ZvcmNlZF91bndpbmQKICB7CiAgICB2aXJ0dWFsIH5f
X2ZvcmNlZF91bndpbmQoKSB0aHJvdygpOwoKCiAgICB2aXJ0dWFsIHZvaWQgX19wdXJlX2R1bW15
KCkgPSAwOwogIH07Cn0KCgojcHJhZ21hIEdDQyB2aXNpYmlsaXR5IHBvcAojIDM3ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvb3N0cmVhbV9pbnNlcnQuaCIgMiAzCgpuYW1lc3BhY2Ugc3Rk
IF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIGlubGluZSB2b2lkCiAg
ICBfX29zdHJlYW1fd3JpdGUoYmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JiBfX291dCwK
ICAgICAgY29uc3QgX0NoYXJUKiBfX3MsIHN0cmVhbXNpemUgX19uKQogICAgewogICAgICB0eXBl
ZGVmIGJhc2ljX29zdHJlYW08X0NoYXJULCBfVHJhaXRzPiBfX29zdHJlYW1fdHlwZTsKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBfX29zdHJlYW1fdHlwZTo6aW9zX2Jhc2UgX19pb3NfYmFzZTsKCiAg
ICAgIGNvbnN0IHN0cmVhbXNpemUgX19wdXQgPSBfX291dC5yZGJ1ZigpLT5zcHV0bihfX3MsIF9f
bik7CiAgICAgIGlmIChfX3B1dCAhPSBfX24pCiBfX291dC5zZXRzdGF0ZShfX2lvc19iYXNlOjpi
YWRiaXQpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFp
dHM+CiAgICBpbmxpbmUgdm9pZAogICAgX19vc3RyZWFtX2ZpbGwoYmFzaWNfb3N0cmVhbTxfQ2hh
clQsIF9UcmFpdHM+JiBfX291dCwgc3RyZWFtc2l6ZSBfX24pCiAgICB7CiAgICAgIHR5cGVkZWYg
YmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFpdHM+IF9fb3N0cmVhbV90eXBlOwogICAgICB0eXBl
ZGVmIHR5cGVuYW1lIF9fb3N0cmVhbV90eXBlOjppb3NfYmFzZSBfX2lvc19iYXNlOwoKICAgICAg
Y29uc3QgX0NoYXJUIF9fYyA9IF9fb3V0LmZpbGwoKTsKICAgICAgZm9yICg7IF9fbiA+IDA7IC0t
X19uKQogewogICBjb25zdCB0eXBlbmFtZSBfVHJhaXRzOjppbnRfdHlwZSBfX3B1dCA9IF9fb3V0
LnJkYnVmKCktPnNwdXRjKF9fYyk7CiAgIGlmIChfVHJhaXRzOjplcV9pbnRfdHlwZShfX3B1dCwg
X1RyYWl0czo6ZW9mKCkpKQogICAgIHsKICAgICAgIF9fb3V0LnNldHN0YXRlKF9faW9zX2Jhc2U6
OmJhZGJpdCk7CiAgICAgICBicmVhazsKICAgICB9CiB9CiAgICB9CgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIGJhc2ljX29zdHJlYW08X0NoYXJULCBf
VHJhaXRzPiYKICAgIF9fb3N0cmVhbV9pbnNlcnQoYmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFp
dHM+JiBfX291dCwKICAgICAgIGNvbnN0IF9DaGFyVCogX19zLCBzdHJlYW1zaXplIF9fbikKICAg
IHsKICAgICAgdHlwZWRlZiBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4gX19vc3RyZWFt
X3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19vc3RyZWFtX3R5cGU6Omlvc19iYXNlIF9f
aW9zX2Jhc2U7CgogICAgICB0eXBlbmFtZSBfX29zdHJlYW1fdHlwZTo6c2VudHJ5IF9fY2VyYihf
X291dCk7CiAgICAgIGlmIChfX2NlcmIpCiB7CiAgIHRyeQogICAgIHsKICAgICAgIGNvbnN0IHN0
cmVhbXNpemUgX193ID0gX19vdXQud2lkdGgoKTsKICAgICAgIGlmIChfX3cgPiBfX24pCiAgewog
ICAgY29uc3QgYm9vbCBfX2xlZnQgPSAoKF9fb3V0LmZsYWdzKCkKICAgICAmIF9faW9zX2Jhc2U6
OmFkanVzdGZpZWxkKQogICAgICAgICAgID09IF9faW9zX2Jhc2U6OmxlZnQpOwogICAgaWYgKCFf
X2xlZnQpCiAgICAgIF9fb3N0cmVhbV9maWxsKF9fb3V0LCBfX3cgLSBfX24pOwogICAgaWYgKF9f
b3V0Lmdvb2QoKSkKICAgICAgX19vc3RyZWFtX3dyaXRlKF9fb3V0LCBfX3MsIF9fbik7CiAgICBp
ZiAoX19sZWZ0ICYmIF9fb3V0Lmdvb2QoKSkKICAgICAgX19vc3RyZWFtX2ZpbGwoX19vdXQsIF9f
dyAtIF9fbik7CiAgfQogICAgICAgZWxzZQogIF9fb3N0cmVhbV93cml0ZShfX291dCwgX19zLCBf
X24pOwogICAgICAgX19vdXQud2lkdGgoMCk7CiAgICAgfQogICBjYXRjaChfX2N4eGFiaXYxOjpf
X2ZvcmNlZF91bndpbmQmKQogICAgIHsKICAgICAgIF9fb3V0Ll9NX3NldHN0YXRlKF9faW9zX2Jh
c2U6OmJhZGJpdCk7CiAgICAgICB0aHJvdzsKICAgICB9CiAgIGNhdGNoKC4uLikKICAgICB7IF9f
b3V0Ll9NX3NldHN0YXRlKF9faW9zX2Jhc2U6OmJhZGJpdCk7IH0KIH0KICAgICAgcmV0dXJuIF9f
b3V0OwogICAgfQoKCgoKICBleHRlcm4gdGVtcGxhdGUgb3N0cmVhbSYgX19vc3RyZWFtX2luc2Vy
dChvc3RyZWFtJiwgY29uc3QgY2hhciosIHN0cmVhbXNpemUpOwoKCiAgZXh0ZXJuIHRlbXBsYXRl
IHdvc3RyZWFtJiBfX29zdHJlYW1faW5zZXJ0KHdvc3RyZWFtJiwgY29uc3Qgd2NoYXJfdCosCiAg
ICAgICAgICBzdHJlYW1zaXplKTsKCgoKCn0KIyA0NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9z
dHJpbmciIDIgMwoKCgojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfZnVuY3Rp
b24uaCIgMSAzCiMgNjMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfZnVuY3Rpb24u
aCIgMwpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1
bHQiKSkpCnsKCiMgMTA0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2Z1bmN0aW9u
LmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQXJnLCB0eXBlbmFtZSBfUmVzdWx0PgogICAgc3Ry
dWN0IHVuYXJ5X2Z1bmN0aW9uCiAgICB7CgogICAgICB0eXBlZGVmIF9BcmcgYXJndW1lbnRfdHlw
ZTsKCgogICAgICB0eXBlZGVmIF9SZXN1bHQgcmVzdWx0X3R5cGU7CiAgICB9OwoKCgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfQXJnMSwgdHlwZW5hbWUgX0FyZzIsIHR5cGVuYW1lIF9SZXN1bHQ+CiAg
ICBzdHJ1Y3QgYmluYXJ5X2Z1bmN0aW9uCiAgICB7CgogICAgICB0eXBlZGVmIF9BcmcxIGZpcnN0
X2FyZ3VtZW50X3R5cGU7CgoKICAgICAgdHlwZWRlZiBfQXJnMiBzZWNvbmRfYXJndW1lbnRfdHlw
ZTsKCgogICAgICB0eXBlZGVmIF9SZXN1bHQgcmVzdWx0X3R5cGU7CiAgICB9OwojIDE2NiAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9mdW5jdGlvbi5oIiAzCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwPgogICAgc3RydWN0IHBsdXMgOiBwdWJsaWMgYmluYXJ5X2Z1bmN0aW9uPF9UcCwg
X1RwLCBfVHA+CiAgICB7CiAgICAgCiAgICAgIF9UcAogICAgICBvcGVyYXRvcigpKGNvbnN0IF9U
cCYgX194LCBjb25zdCBfVHAmIF9feSkgY29uc3QKICAgICAgeyByZXR1cm4gX194ICsgX195OyB9
CiAgICB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IG1pbnVzIDogcHVi
bGljIGJpbmFyeV9mdW5jdGlvbjxfVHAsIF9UcCwgX1RwPgogICAgewogICAgIAogICAgICBfVHAK
ICAgICAgb3BlcmF0b3IoKShjb25zdCBfVHAmIF9feCwgY29uc3QgX1RwJiBfX3kpIGNvbnN0CiAg
ICAgIHsgcmV0dXJuIF9feCAtIF9feTsgfQogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cD4KICAgIHN0cnVjdCBtdWx0aXBsaWVzIDogcHVibGljIGJpbmFyeV9mdW5jdGlvbjxfVHAsIF9U
cCwgX1RwPgogICAgewogICAgIAogICAgICBfVHAKICAgICAgb3BlcmF0b3IoKShjb25zdCBfVHAm
IF9feCwgY29uc3QgX1RwJiBfX3kpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9feCAqIF9feTsgfQog
ICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBkaXZpZGVzIDogcHVi
bGljIGJpbmFyeV9mdW5jdGlvbjxfVHAsIF9UcCwgX1RwPgogICAgewogICAgIAogICAgICBfVHAK
ICAgICAgb3BlcmF0b3IoKShjb25zdCBfVHAmIF9feCwgY29uc3QgX1RwJiBfX3kpIGNvbnN0CiAg
ICAgIHsgcmV0dXJuIF9feCAvIF9feTsgfQogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cD4KICAgIHN0cnVjdCBtb2R1bHVzIDogcHVibGljIGJpbmFyeV9mdW5jdGlvbjxfVHAsIF9UcCwg
X1RwPgogICAgewogICAgIAogICAgICBfVHAKICAgICAgb3BlcmF0b3IoKShjb25zdCBfVHAmIF9f
eCwgY29uc3QgX1RwJiBfX3kpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9feCAlIF9feTsgfQogICAg
fTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBuZWdhdGUgOiBwdWJsaWMg
dW5hcnlfZnVuY3Rpb248X1RwLCBfVHA+CiAgICB7CiAgICAgCiAgICAgIF9UcAogICAgICBvcGVy
YXRvcigpKGNvbnN0IF9UcCYgX194KSBjb25zdAogICAgICB7IHJldHVybiAtX194OyB9CiAgICB9
OwojIDM1MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9mdW5jdGlvbi5oIiAzCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGVxdWFsX3RvIDogcHVibGljIGJpbmFy
eV9mdW5jdGlvbjxfVHAsIF9UcCwgYm9vbD4KICAgIHsKICAgICAKICAgICAgYm9vbAogICAgICBv
cGVyYXRvcigpKGNvbnN0IF9UcCYgX194LCBjb25zdCBfVHAmIF9feSkgY29uc3QKICAgICAgeyBy
ZXR1cm4gX194ID09IF9feTsgfQogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
IHN0cnVjdCBub3RfZXF1YWxfdG8gOiBwdWJsaWMgYmluYXJ5X2Z1bmN0aW9uPF9UcCwgX1RwLCBi
b29sPgogICAgewogICAgIAogICAgICBib29sCiAgICAgIG9wZXJhdG9yKCkoY29uc3QgX1RwJiBf
X3gsIGNvbnN0IF9UcCYgX195KSBjb25zdAogICAgICB7IHJldHVybiBfX3ggIT0gX195OyB9CiAg
ICB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGdyZWF0ZXIgOiBwdWJs
aWMgYmluYXJ5X2Z1bmN0aW9uPF9UcCwgX1RwLCBib29sPgogICAgewogICAgIAogICAgICBib29s
CiAgICAgIG9wZXJhdG9yKCkoY29uc3QgX1RwJiBfX3gsIGNvbnN0IF9UcCYgX195KSBjb25zdAog
ICAgICB7IHJldHVybiBfX3ggPiBfX3k7IH0KICAgIH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHA+CiAgICBzdHJ1Y3QgbGVzcyA6IHB1YmxpYyBiaW5hcnlfZnVuY3Rpb248X1RwLCBfVHAsIGJv
b2w+CiAgICB7CiAgICAgCiAgICAgIGJvb2wKICAgICAgb3BlcmF0b3IoKShjb25zdCBfVHAmIF9f
eCwgY29uc3QgX1RwJiBfX3kpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9feCA8IF9feTsgfQogICAg
fTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBncmVhdGVyX2VxdWFsIDog
cHVibGljIGJpbmFyeV9mdW5jdGlvbjxfVHAsIF9UcCwgYm9vbD4KICAgIHsKICAgICAKICAgICAg
Ym9vbAogICAgICBvcGVyYXRvcigpKGNvbnN0IF9UcCYgX194LCBjb25zdCBfVHAmIF9feSkgY29u
c3QKICAgICAgeyByZXR1cm4gX194ID49IF9feTsgfQogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcD4KICAgIHN0cnVjdCBsZXNzX2VxdWFsIDogcHVibGljIGJpbmFyeV9mdW5jdGlvbjxf
VHAsIF9UcCwgYm9vbD4KICAgIHsKICAgICAKICAgICAgYm9vbAogICAgICBvcGVyYXRvcigpKGNv
bnN0IF9UcCYgX194LCBjb25zdCBfVHAmIF9feSkgY29uc3QKICAgICAgeyByZXR1cm4gX194IDw9
IF9feTsgfQogICAgfTsKIyA1MjQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfZnVu
Y3Rpb24uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBsb2dpY2FsX2Fu
ZCA6IHB1YmxpYyBiaW5hcnlfZnVuY3Rpb248X1RwLCBfVHAsIGJvb2w+CiAgICB7CiAgICAgCiAg
ICAgIGJvb2wKICAgICAgb3BlcmF0b3IoKShjb25zdCBfVHAmIF9feCwgY29uc3QgX1RwJiBfX3kp
IGNvbnN0CiAgICAgIHsgcmV0dXJuIF9feCAmJiBfX3k7IH0KICAgIH07CgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgbG9naWNhbF9vciA6IHB1YmxpYyBiaW5hcnlfZnVuY3Rp
b248X1RwLCBfVHAsIGJvb2w+CiAgICB7CiAgICAgCiAgICAgIGJvb2wKICAgICAgb3BlcmF0b3Io
KShjb25zdCBfVHAmIF9feCwgY29uc3QgX1RwJiBfX3kpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9f
eCB8fCBfX3k7IH0KICAgIH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3Qg
bG9naWNhbF9ub3QgOiBwdWJsaWMgdW5hcnlfZnVuY3Rpb248X1RwLCBib29sPgogICAgewogICAg
IAogICAgICBib29sCiAgICAgIG9wZXJhdG9yKCkoY29uc3QgX1RwJiBfX3gpIGNvbnN0CiAgICAg
IHsgcmV0dXJuICFfX3g7IH0KICAgIH07CiMgNjE3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX2Z1bmN0aW9uLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3Qg
Yml0X2FuZCA6IHB1YmxpYyBiaW5hcnlfZnVuY3Rpb248X1RwLCBfVHAsIF9UcD4KICAgIHsKICAg
ICAKICAgICAgX1RwCiAgICAgIG9wZXJhdG9yKCkoY29uc3QgX1RwJiBfX3gsIGNvbnN0IF9UcCYg
X195KSBjb25zdAogICAgICB7IHJldHVybiBfX3ggJiBfX3k7IH0KICAgIH07CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBiaXRfb3IgOiBwdWJsaWMgYmluYXJ5X2Z1bmN0aW9u
PF9UcCwgX1RwLCBfVHA+CiAgICB7CiAgICAgCiAgICAgIF9UcAogICAgICBvcGVyYXRvcigpKGNv
bnN0IF9UcCYgX194LCBjb25zdCBfVHAmIF9feSkgY29uc3QKICAgICAgeyByZXR1cm4gX194IHwg
X195OyB9CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgYml0X3hv
ciA6IHB1YmxpYyBiaW5hcnlfZnVuY3Rpb248X1RwLCBfVHAsIF9UcD4KICAgIHsKICAgICAKICAg
ICAgX1RwCiAgICAgIG9wZXJhdG9yKCkoY29uc3QgX1RwJiBfX3gsIGNvbnN0IF9UcCYgX195KSBj
b25zdAogICAgICB7IHJldHVybiBfX3ggXiBfX3k7IH0KICAgIH07CgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcD4KICAgIHN0cnVjdCBiaXRfbm90IDogcHVibGljIHVuYXJ5X2Z1bmN0aW9uPF9UcCwg
X1RwPgogICAgewogICAKICAgICAgX1RwCiAgICAgIG9wZXJhdG9yKCkoY29uc3QgX1RwJiBfX3gp
IGNvbnN0CiAgICAgIHsgcmV0dXJuIH5fX3g7IH0KICAgIH07CiMgNzQxICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RsX2Z1bmN0aW9uLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUHJl
ZGljYXRlPgogICAgY2xhc3MgdW5hcnlfbmVnYXRlCiAgICA6IHB1YmxpYyB1bmFyeV9mdW5jdGlv
bjx0eXBlbmFtZSBfUHJlZGljYXRlOjphcmd1bWVudF90eXBlLCBib29sPgogICAgewogICAgcHJv
dGVjdGVkOgogICAgICBfUHJlZGljYXRlIF9NX3ByZWQ7CgogICAgcHVibGljOgogICAgIAogICAg
ICBleHBsaWNpdAogICAgICB1bmFyeV9uZWdhdGUoY29uc3QgX1ByZWRpY2F0ZSYgX194KSA6IF9N
X3ByZWQoX194KSB7IH0KCiAgICAgCiAgICAgIGJvb2wKICAgICAgb3BlcmF0b3IoKShjb25zdCB0
eXBlbmFtZSBfUHJlZGljYXRlOjphcmd1bWVudF90eXBlJiBfX3gpIGNvbnN0CiAgICAgIHsgcmV0
dXJuICFfTV9wcmVkKF9feCk7IH0KICAgIH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUHJlZGlj
YXRlPgogICAKICAgIGlubGluZSB1bmFyeV9uZWdhdGU8X1ByZWRpY2F0ZT4KICAgIG5vdDEoY29u
c3QgX1ByZWRpY2F0ZSYgX19wcmVkKQogICAgeyByZXR1cm4gdW5hcnlfbmVnYXRlPF9QcmVkaWNh
dGU+KF9fcHJlZCk7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9QcmVkaWNhdGU+CiAgICBjbGFz
cyBiaW5hcnlfbmVnYXRlCiAgICA6IHB1YmxpYyBiaW5hcnlfZnVuY3Rpb248dHlwZW5hbWUgX1By
ZWRpY2F0ZTo6Zmlyc3RfYXJndW1lbnRfdHlwZSwKICAgICAgICB0eXBlbmFtZSBfUHJlZGljYXRl
OjpzZWNvbmRfYXJndW1lbnRfdHlwZSwgYm9vbD4KICAgIHsKICAgIHByb3RlY3RlZDoKICAgICAg
X1ByZWRpY2F0ZSBfTV9wcmVkOwoKICAgIHB1YmxpYzoKICAgICAKICAgICAgZXhwbGljaXQKICAg
ICAgYmluYXJ5X25lZ2F0ZShjb25zdCBfUHJlZGljYXRlJiBfX3gpIDogX01fcHJlZChfX3gpIHsg
fQoKICAgICAKICAgICAgYm9vbAogICAgICBvcGVyYXRvcigpKGNvbnN0IHR5cGVuYW1lIF9QcmVk
aWNhdGU6OmZpcnN0X2FyZ3VtZW50X3R5cGUmIF9feCwKICAgY29uc3QgdHlwZW5hbWUgX1ByZWRp
Y2F0ZTo6c2Vjb25kX2FyZ3VtZW50X3R5cGUmIF9feSkgY29uc3QKICAgICAgeyByZXR1cm4gIV9N
X3ByZWQoX194LCBfX3kpOyB9CiAgICB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1ByZWRpY2F0
ZT4KICAgCiAgICBpbmxpbmUgYmluYXJ5X25lZ2F0ZTxfUHJlZGljYXRlPgogICAgbm90Mihjb25z
dCBfUHJlZGljYXRlJiBfX3ByZWQpCiAgICB7IHJldHVybiBiaW5hcnlfbmVnYXRlPF9QcmVkaWNh
dGU+KF9fcHJlZCk7IH0KIyA4MTggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfZnVu
Y3Rpb24uaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9BcmcsIHR5cGVuYW1lIF9SZXN1bHQ+CiAg
ICBjbGFzcyBwb2ludGVyX3RvX3VuYXJ5X2Z1bmN0aW9uIDogcHVibGljIHVuYXJ5X2Z1bmN0aW9u
PF9BcmcsIF9SZXN1bHQ+CiAgICB7CiAgICBwcm90ZWN0ZWQ6CiAgICAgIF9SZXN1bHQgKCpfTV9w
dHIpKF9BcmcpOwoKICAgIHB1YmxpYzoKICAgICAgcG9pbnRlcl90b191bmFyeV9mdW5jdGlvbigp
IHsgfQoKICAgICAgZXhwbGljaXQKICAgICAgcG9pbnRlcl90b191bmFyeV9mdW5jdGlvbihfUmVz
dWx0ICgqX194KShfQXJnKSkKICAgICAgOiBfTV9wdHIoX194KSB7IH0KCiAgICAgIF9SZXN1bHQK
ICAgICAgb3BlcmF0b3IoKShfQXJnIF9feCkgY29uc3QKICAgICAgeyByZXR1cm4gX01fcHRyKF9f
eCk7IH0KICAgIH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQXJnLCB0eXBlbmFtZSBfUmVzdWx0
PgogICAgaW5saW5lIHBvaW50ZXJfdG9fdW5hcnlfZnVuY3Rpb248X0FyZywgX1Jlc3VsdD4KICAg
IHB0cl9mdW4oX1Jlc3VsdCAoKl9feCkoX0FyZykpCiAgICB7IHJldHVybiBwb2ludGVyX3RvX3Vu
YXJ5X2Z1bmN0aW9uPF9BcmcsIF9SZXN1bHQ+KF9feCk7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9BcmcxLCB0eXBlbmFtZSBfQXJnMiwgdHlwZW5hbWUgX1Jlc3VsdD4KICAgIGNsYXNzIHBvaW50
ZXJfdG9fYmluYXJ5X2Z1bmN0aW9uCiAgICA6IHB1YmxpYyBiaW5hcnlfZnVuY3Rpb248X0FyZzEs
IF9BcmcyLCBfUmVzdWx0PgogICAgewogICAgcHJvdGVjdGVkOgogICAgICBfUmVzdWx0ICgqX01f
cHRyKShfQXJnMSwgX0FyZzIpOwoKICAgIHB1YmxpYzoKICAgICAgcG9pbnRlcl90b19iaW5hcnlf
ZnVuY3Rpb24oKSB7IH0KCiAgICAgIGV4cGxpY2l0CiAgICAgIHBvaW50ZXJfdG9fYmluYXJ5X2Z1
bmN0aW9uKF9SZXN1bHQgKCpfX3gpKF9BcmcxLCBfQXJnMikpCiAgICAgIDogX01fcHRyKF9feCkg
eyB9CgogICAgICBfUmVzdWx0CiAgICAgIG9wZXJhdG9yKCkoX0FyZzEgX194LCBfQXJnMiBfX3kp
IGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX3B0cihfX3gsIF9feSk7IH0KICAgIH07CgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfQXJnMSwgdHlwZW5hbWUgX0FyZzIsIHR5cGVuYW1lIF9SZXN1bHQ+CiAg
ICBpbmxpbmUgcG9pbnRlcl90b19iaW5hcnlfZnVuY3Rpb248X0FyZzEsIF9BcmcyLCBfUmVzdWx0
PgogICAgcHRyX2Z1bihfUmVzdWx0ICgqX194KShfQXJnMSwgX0FyZzIpKQogICAgeyByZXR1cm4g
cG9pbnRlcl90b19iaW5hcnlfZnVuY3Rpb248X0FyZzEsIF9BcmcyLCBfUmVzdWx0PihfX3gpOyB9
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX0lkZW50aXR5CiAgICA6IHB1
YmxpYyB1bmFyeV9mdW5jdGlvbjxfVHAsX1RwPgogICAgewogICAgICBfVHAmCiAgICAgIG9wZXJh
dG9yKCkoX1RwJiBfX3gpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9feDsgfQoKICAgICAgY29uc3Qg
X1RwJgogICAgICBvcGVyYXRvcigpKGNvbnN0IF9UcCYgX194KSBjb25zdAogICAgICB7IHJldHVy
biBfX3g7IH0KICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9QYWlyPgogICAgc3RydWN0IF9T
ZWxlY3Qxc3QKICAgIDogcHVibGljIHVuYXJ5X2Z1bmN0aW9uPF9QYWlyLCB0eXBlbmFtZSBfUGFp
cjo6Zmlyc3RfdHlwZT4KICAgIHsKICAgICAgdHlwZW5hbWUgX1BhaXI6OmZpcnN0X3R5cGUmCiAg
ICAgIG9wZXJhdG9yKCkoX1BhaXImIF9feCkgY29uc3QKICAgICAgeyByZXR1cm4gX194LmZpcnN0
OyB9CgogICAgICBjb25zdCB0eXBlbmFtZSBfUGFpcjo6Zmlyc3RfdHlwZSYKICAgICAgb3BlcmF0
b3IoKShjb25zdCBfUGFpciYgX194KSBjb25zdAogICAgICB7IHJldHVybiBfX3guZmlyc3Q7IH0K
CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUGFpcjI+CiAgICAgICAgdHlwZW5hbWUgX1BhaXIy
OjpmaXJzdF90eXBlJgogICAgICAgIG9wZXJhdG9yKCkoX1BhaXIyJiBfX3gpIGNvbnN0CiAgICAg
ICAgeyByZXR1cm4gX194LmZpcnN0OyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUGFpcjI+
CiAgICAgICAgY29uc3QgdHlwZW5hbWUgX1BhaXIyOjpmaXJzdF90eXBlJgogICAgICAgIG9wZXJh
dG9yKCkoY29uc3QgX1BhaXIyJiBfX3gpIGNvbnN0CiAgICAgICAgeyByZXR1cm4gX194LmZpcnN0
OyB9CgogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1BhaXI+CiAgICBzdHJ1Y3QgX1NlbGVj
dDJuZAogICAgOiBwdWJsaWMgdW5hcnlfZnVuY3Rpb248X1BhaXIsIHR5cGVuYW1lIF9QYWlyOjpz
ZWNvbmRfdHlwZT4KICAgIHsKICAgICAgdHlwZW5hbWUgX1BhaXI6OnNlY29uZF90eXBlJgogICAg
ICBvcGVyYXRvcigpKF9QYWlyJiBfX3gpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9feC5zZWNvbmQ7
IH0KCiAgICAgIGNvbnN0IHR5cGVuYW1lIF9QYWlyOjpzZWNvbmRfdHlwZSYKICAgICAgb3BlcmF0
b3IoKShjb25zdCBfUGFpciYgX194KSBjb25zdAogICAgICB7IHJldHVybiBfX3guc2Vjb25kOyB9
CiAgICB9OwojIDkzOCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9mdW5jdGlvbi5o
IiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JldCwgdHlwZW5hbWUgX1RwPgogICAgY2xhc3MgbWVt
X2Z1bl90IDogcHVibGljIHVuYXJ5X2Z1bmN0aW9uPF9UcCosIF9SZXQ+CiAgICB7CiAgICBwdWJs
aWM6CiAgICAgIGV4cGxpY2l0CiAgICAgIG1lbV9mdW5fdChfUmV0IChfVHA6OipfX3BmKSgpKQog
ICAgICA6IF9NX2YoX19wZikgeyB9CgogICAgICBfUmV0CiAgICAgIG9wZXJhdG9yKCkoX1RwKiBf
X3ApIGNvbnN0CiAgICAgIHsgcmV0dXJuIChfX3AtPipfTV9mKSgpOyB9CgogICAgcHJpdmF0ZToK
ICAgICAgX1JldCAoX1RwOjoqX01fZikoKTsKICAgIH07CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1JldCwgdHlwZW5hbWUgX1RwPgogICAgY2xhc3MgY29uc3RfbWVtX2Z1bl90IDogcHVibGljIHVu
YXJ5X2Z1bmN0aW9uPGNvbnN0IF9UcCosIF9SZXQ+CiAgICB7CiAgICBwdWJsaWM6CiAgICAgIGV4
cGxpY2l0CiAgICAgIGNvbnN0X21lbV9mdW5fdChfUmV0IChfVHA6OipfX3BmKSgpIGNvbnN0KQog
ICAgICA6IF9NX2YoX19wZikgeyB9CgogICAgICBfUmV0CiAgICAgIG9wZXJhdG9yKCkoY29uc3Qg
X1RwKiBfX3ApIGNvbnN0CiAgICAgIHsgcmV0dXJuIChfX3AtPipfTV9mKSgpOyB9CgogICAgcHJp
dmF0ZToKICAgICAgX1JldCAoX1RwOjoqX01fZikoKSBjb25zdDsKICAgIH07CgoKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1JldCwgdHlwZW5hbWUgX1RwPgogICAgY2xhc3MgbWVtX2Z1bl9yZWZfdCA6
IHB1YmxpYyB1bmFyeV9mdW5jdGlvbjxfVHAsIF9SZXQ+CiAgICB7CiAgICBwdWJsaWM6CiAgICAg
IGV4cGxpY2l0CiAgICAgIG1lbV9mdW5fcmVmX3QoX1JldCAoX1RwOjoqX19wZikoKSkKICAgICAg
OiBfTV9mKF9fcGYpIHsgfQoKICAgICAgX1JldAogICAgICBvcGVyYXRvcigpKF9UcCYgX19yKSBj
b25zdAogICAgICB7IHJldHVybiAoX19yLipfTV9mKSgpOyB9CgogICAgcHJpdmF0ZToKICAgICAg
X1JldCAoX1RwOjoqX01fZikoKTsKICB9OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXQsIHR5
cGVuYW1lIF9UcD4KICAgIGNsYXNzIGNvbnN0X21lbV9mdW5fcmVmX3QgOiBwdWJsaWMgdW5hcnlf
ZnVuY3Rpb248X1RwLCBfUmV0PgogICAgewogICAgcHVibGljOgogICAgICBleHBsaWNpdAogICAg
ICBjb25zdF9tZW1fZnVuX3JlZl90KF9SZXQgKF9UcDo6Kl9fcGYpKCkgY29uc3QpCiAgICAgIDog
X01fZihfX3BmKSB7IH0KCiAgICAgIF9SZXQKICAgICAgb3BlcmF0b3IoKShjb25zdCBfVHAmIF9f
cikgY29uc3QKICAgICAgeyByZXR1cm4gKF9fci4qX01fZikoKTsgfQoKICAgIHByaXZhdGU6CiAg
ICAgIF9SZXQgKF9UcDo6Kl9NX2YpKCkgY29uc3Q7CiAgICB9OwoKCgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9SZXQsIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FyZz4KICAgIGNsYXNzIG1lbV9mdW4x
X3QgOiBwdWJsaWMgYmluYXJ5X2Z1bmN0aW9uPF9UcCosIF9BcmcsIF9SZXQ+CiAgICB7CiAgICBw
dWJsaWM6CiAgICAgIGV4cGxpY2l0CiAgICAgIG1lbV9mdW4xX3QoX1JldCAoX1RwOjoqX19wZiko
X0FyZykpCiAgICAgIDogX01fZihfX3BmKSB7IH0KCiAgICAgIF9SZXQKICAgICAgb3BlcmF0b3Io
KShfVHAqIF9fcCwgX0FyZyBfX3gpIGNvbnN0CiAgICAgIHsgcmV0dXJuIChfX3AtPipfTV9mKShf
X3gpOyB9CgogICAgcHJpdmF0ZToKICAgICAgX1JldCAoX1RwOjoqX01fZikoX0FyZyk7CiAgICB9
OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXQsIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0Fy
Zz4KICAgIGNsYXNzIGNvbnN0X21lbV9mdW4xX3QgOiBwdWJsaWMgYmluYXJ5X2Z1bmN0aW9uPGNv
bnN0IF9UcCosIF9BcmcsIF9SZXQ+CiAgICB7CiAgICBwdWJsaWM6CiAgICAgIGV4cGxpY2l0CiAg
ICAgIGNvbnN0X21lbV9mdW4xX3QoX1JldCAoX1RwOjoqX19wZikoX0FyZykgY29uc3QpCiAgICAg
IDogX01fZihfX3BmKSB7IH0KCiAgICAgIF9SZXQKICAgICAgb3BlcmF0b3IoKShjb25zdCBfVHAq
IF9fcCwgX0FyZyBfX3gpIGNvbnN0CiAgICAgIHsgcmV0dXJuIChfX3AtPipfTV9mKShfX3gpOyB9
CgogICAgcHJpdmF0ZToKICAgICAgX1JldCAoX1RwOjoqX01fZikoX0FyZykgY29uc3Q7CiAgICB9
OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXQsIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0Fy
Zz4KICAgIGNsYXNzIG1lbV9mdW4xX3JlZl90IDogcHVibGljIGJpbmFyeV9mdW5jdGlvbjxfVHAs
IF9BcmcsIF9SZXQ+CiAgICB7CiAgICBwdWJsaWM6CiAgICAgIGV4cGxpY2l0CiAgICAgIG1lbV9m
dW4xX3JlZl90KF9SZXQgKF9UcDo6Kl9fcGYpKF9BcmcpKQogICAgICA6IF9NX2YoX19wZikgeyB9
CgogICAgICBfUmV0CiAgICAgIG9wZXJhdG9yKCkoX1RwJiBfX3IsIF9BcmcgX194KSBjb25zdAog
ICAgICB7IHJldHVybiAoX19yLipfTV9mKShfX3gpOyB9CgogICAgcHJpdmF0ZToKICAgICAgX1Jl
dCAoX1RwOjoqX01fZikoX0FyZyk7CiAgICB9OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXQs
IHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FyZz4KICAgIGNsYXNzIGNvbnN0X21lbV9mdW4xX3Jl
Zl90IDogcHVibGljIGJpbmFyeV9mdW5jdGlvbjxfVHAsIF9BcmcsIF9SZXQ+CiAgICB7CiAgICBw
dWJsaWM6CiAgICAgIGV4cGxpY2l0CiAgICAgIGNvbnN0X21lbV9mdW4xX3JlZl90KF9SZXQgKF9U
cDo6Kl9fcGYpKF9BcmcpIGNvbnN0KQogICAgICA6IF9NX2YoX19wZikgeyB9CgogICAgICBfUmV0
CiAgICAgIG9wZXJhdG9yKCkoY29uc3QgX1RwJiBfX3IsIF9BcmcgX194KSBjb25zdAogICAgICB7
IHJldHVybiAoX19yLipfTV9mKShfX3gpOyB9CgogICAgcHJpdmF0ZToKICAgICAgX1JldCAoX1Rw
OjoqX01fZikoX0FyZykgY29uc3Q7CiAgICB9OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXQs
IHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBtZW1fZnVuX3Q8X1JldCwgX1RwPgogICAgbWVtX2Z1
bihfUmV0IChfVHA6OipfX2YpKCkpCiAgICB7IHJldHVybiBtZW1fZnVuX3Q8X1JldCwgX1RwPihf
X2YpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXQsIHR5cGVuYW1lIF9UcD4KICAgIGlubGlu
ZSBjb25zdF9tZW1fZnVuX3Q8X1JldCwgX1RwPgogICAgbWVtX2Z1bihfUmV0IChfVHA6OipfX2Yp
KCkgY29uc3QpCiAgICB7IHJldHVybiBjb25zdF9tZW1fZnVuX3Q8X1JldCwgX1RwPihfX2YpOyB9
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXQsIHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBtZW1f
ZnVuX3JlZl90PF9SZXQsIF9UcD4KICAgIG1lbV9mdW5fcmVmKF9SZXQgKF9UcDo6Kl9fZikoKSkK
ICAgIHsgcmV0dXJuIG1lbV9mdW5fcmVmX3Q8X1JldCwgX1RwPihfX2YpOyB9CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9SZXQsIHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBjb25zdF9tZW1fZnVuX3Jl
Zl90PF9SZXQsIF9UcD4KICAgIG1lbV9mdW5fcmVmKF9SZXQgKF9UcDo6Kl9fZikoKSBjb25zdCkK
ICAgIHsgcmV0dXJuIGNvbnN0X21lbV9mdW5fcmVmX3Q8X1JldCwgX1RwPihfX2YpOyB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9SZXQsIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FyZz4KICAgIGlu
bGluZSBtZW1fZnVuMV90PF9SZXQsIF9UcCwgX0FyZz4KICAgIG1lbV9mdW4oX1JldCAoX1RwOjoq
X19mKShfQXJnKSkKICAgIHsgcmV0dXJuIG1lbV9mdW4xX3Q8X1JldCwgX1RwLCBfQXJnPihfX2Yp
OyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXQsIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0Fy
Zz4KICAgIGlubGluZSBjb25zdF9tZW1fZnVuMV90PF9SZXQsIF9UcCwgX0FyZz4KICAgIG1lbV9m
dW4oX1JldCAoX1RwOjoqX19mKShfQXJnKSBjb25zdCkKICAgIHsgcmV0dXJuIGNvbnN0X21lbV9m
dW4xX3Q8X1JldCwgX1RwLCBfQXJnPihfX2YpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXQs
IHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FyZz4KICAgIGlubGluZSBtZW1fZnVuMV9yZWZfdDxf
UmV0LCBfVHAsIF9Bcmc+CiAgICBtZW1fZnVuX3JlZihfUmV0IChfVHA6OipfX2YpKF9BcmcpKQog
ICAgeyByZXR1cm4gbWVtX2Z1bjFfcmVmX3Q8X1JldCwgX1RwLCBfQXJnPihfX2YpOyB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9SZXQsIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FyZz4KICAgIGlu
bGluZSBjb25zdF9tZW1fZnVuMV9yZWZfdDxfUmV0LCBfVHAsIF9Bcmc+CiAgICBtZW1fZnVuX3Jl
ZihfUmV0IChfVHA6OipfX2YpKF9BcmcpIGNvbnN0KQogICAgeyByZXR1cm4gY29uc3RfbWVtX2Z1
bjFfcmVmX3Q8X1JldCwgX1RwLCBfQXJnPihfX2YpOyB9CgoKCgp9CgoKIyAxICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JhY2t3YXJkL2JpbmRlcnMuaCIgMSAzCiMgNjAgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYmFja3dhcmQvYmluZGVycy5oIiAzCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgcHVz
aAojcHJhZ21hIEdDQyBkaWFnbm9zdGljIGlnbm9yZWQgIi1XZGVwcmVjYXRlZC1kZWNsYXJhdGlv
bnMiCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1
bHQiKSkpCnsKCiMgMTA3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JhY2t3YXJkL2JpbmRlcnMu
aCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9PcGVyYXRpb24+CiAgICBjbGFzcyBiaW5kZXIxc3QK
ICAgIDogcHVibGljIHVuYXJ5X2Z1bmN0aW9uPHR5cGVuYW1lIF9PcGVyYXRpb246OnNlY29uZF9h
cmd1bWVudF90eXBlLAogICAgICAgdHlwZW5hbWUgX09wZXJhdGlvbjo6cmVzdWx0X3R5cGU+CiAg
ICB7CiAgICBwcm90ZWN0ZWQ6CiAgICAgIF9PcGVyYXRpb24gb3A7CiAgICAgIHR5cGVuYW1lIF9P
cGVyYXRpb246OmZpcnN0X2FyZ3VtZW50X3R5cGUgdmFsdWU7CgogICAgcHVibGljOgogICAgICBi
aW5kZXIxc3QoY29uc3QgX09wZXJhdGlvbiYgX194LAogIGNvbnN0IHR5cGVuYW1lIF9PcGVyYXRp
b246OmZpcnN0X2FyZ3VtZW50X3R5cGUmIF9feSkKICAgICAgOiBvcChfX3gpLCB2YWx1ZShfX3kp
IHsgfQoKICAgICAgdHlwZW5hbWUgX09wZXJhdGlvbjo6cmVzdWx0X3R5cGUKICAgICAgb3BlcmF0
b3IoKShjb25zdCB0eXBlbmFtZSBfT3BlcmF0aW9uOjpzZWNvbmRfYXJndW1lbnRfdHlwZSYgX194
KSBjb25zdAogICAgICB7IHJldHVybiBvcCh2YWx1ZSwgX194KTsgfQoKCgogICAgICB0eXBlbmFt
ZSBfT3BlcmF0aW9uOjpyZXN1bHRfdHlwZQogICAgICBvcGVyYXRvcigpKHR5cGVuYW1lIF9PcGVy
YXRpb246OnNlY29uZF9hcmd1bWVudF90eXBlJiBfX3gpIGNvbnN0CiAgICAgIHsgcmV0dXJuIG9w
KHZhbHVlLCBfX3gpOyB9CiAgICB9IF9fYXR0cmlidXRlX18gKChfX2RlcHJlY2F0ZWRfXykpOwoK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX09wZXJhdGlvbiwgdHlwZW5hbWUgX1RwPgogICAgaW5saW5l
IGJpbmRlcjFzdDxfT3BlcmF0aW9uPgogICAgYmluZDFzdChjb25zdCBfT3BlcmF0aW9uJiBfX2Zu
LCBjb25zdCBfVHAmIF9feCkKICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfT3BlcmF0aW9u
OjpmaXJzdF9hcmd1bWVudF90eXBlIF9BcmcxX3R5cGU7CiAgICAgIHJldHVybiBiaW5kZXIxc3Q8
X09wZXJhdGlvbj4oX19mbiwgX0FyZzFfdHlwZShfX3gpKTsKICAgIH0KCgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9PcGVyYXRpb24+CiAgICBjbGFzcyBiaW5kZXIybmQKICAgIDogcHVibGljIHVuYXJ5
X2Z1bmN0aW9uPHR5cGVuYW1lIF9PcGVyYXRpb246OmZpcnN0X2FyZ3VtZW50X3R5cGUsCiAgICAg
ICB0eXBlbmFtZSBfT3BlcmF0aW9uOjpyZXN1bHRfdHlwZT4KICAgIHsKICAgIHByb3RlY3RlZDoK
ICAgICAgX09wZXJhdGlvbiBvcDsKICAgICAgdHlwZW5hbWUgX09wZXJhdGlvbjo6c2Vjb25kX2Fy
Z3VtZW50X3R5cGUgdmFsdWU7CgogICAgcHVibGljOgogICAgICBiaW5kZXIybmQoY29uc3QgX09w
ZXJhdGlvbiYgX194LAogIGNvbnN0IHR5cGVuYW1lIF9PcGVyYXRpb246OnNlY29uZF9hcmd1bWVu
dF90eXBlJiBfX3kpCiAgICAgIDogb3AoX194KSwgdmFsdWUoX195KSB7IH0KCiAgICAgIHR5cGVu
YW1lIF9PcGVyYXRpb246OnJlc3VsdF90eXBlCiAgICAgIG9wZXJhdG9yKCkoY29uc3QgdHlwZW5h
bWUgX09wZXJhdGlvbjo6Zmlyc3RfYXJndW1lbnRfdHlwZSYgX194KSBjb25zdAogICAgICB7IHJl
dHVybiBvcChfX3gsIHZhbHVlKTsgfQoKCgogICAgICB0eXBlbmFtZSBfT3BlcmF0aW9uOjpyZXN1
bHRfdHlwZQogICAgICBvcGVyYXRvcigpKHR5cGVuYW1lIF9PcGVyYXRpb246OmZpcnN0X2FyZ3Vt
ZW50X3R5cGUmIF9feCkgY29uc3QKICAgICAgeyByZXR1cm4gb3AoX194LCB2YWx1ZSk7IH0KICAg
IH0gX19hdHRyaWJ1dGVfXyAoKF9fZGVwcmVjYXRlZF9fKSk7CgoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfT3BlcmF0aW9uLCB0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgYmluZGVyMm5kPF9PcGVyYXRp
b24+CiAgICBiaW5kMm5kKGNvbnN0IF9PcGVyYXRpb24mIF9fZm4sIGNvbnN0IF9UcCYgX194KQog
ICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9PcGVyYXRpb246OnNlY29uZF9hcmd1bWVudF90
eXBlIF9BcmcyX3R5cGU7CiAgICAgIHJldHVybiBiaW5kZXIybmQ8X09wZXJhdGlvbj4oX19mbiwg
X0FyZzJfdHlwZShfX3gpKTsKICAgIH0KCgoKfQoKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBwb3AK
IyAxMTI5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2Z1bmN0aW9uLmgiIDIgMwoj
IDQ5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmluZyIgMiAzCgoKCiMgMSAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAxIDMKIyAzNyAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgICAKIyAzOCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiMgNDcgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRl
X18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgoKbmFtZXNwYWNlIF9fY3h4MTEg
ewojIDcxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxv
Yz4KICAgIGNsYXNzIGJhc2ljX3N0cmluZwogICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9f
Z251X2N4eDo6X19hbGxvY190cmFpdHM8X0FsbG9jPjo6dGVtcGxhdGUKIHJlYmluZDxfQ2hhclQ+
OjpvdGhlciBfQ2hhcl9hbGxvY190eXBlOwogICAgICB0eXBlZGVmIF9fZ251X2N4eDo6X19hbGxv
Y190cmFpdHM8X0NoYXJfYWxsb2NfdHlwZT4gX0FsbG9jX3RyYWl0czsKCgogICAgcHVibGljOgog
ICAgICB0eXBlZGVmIF9UcmFpdHMgdHJhaXRzX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUg
X1RyYWl0czo6Y2hhcl90eXBlIHZhbHVlX3R5cGU7CiAgICAgIHR5cGVkZWYgX0NoYXJfYWxsb2Nf
dHlwZSBhbGxvY2F0b3JfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQWxsb2NfdHJhaXRz
OjpzaXplX3R5cGUgc2l6ZV90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9BbGxvY190cmFp
dHM6OmRpZmZlcmVuY2VfdHlwZSBkaWZmZXJlbmNlX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5h
bWUgX0FsbG9jX3RyYWl0czo6cmVmZXJlbmNlIHJlZmVyZW5jZTsKICAgICAgdHlwZWRlZiB0eXBl
bmFtZSBfQWxsb2NfdHJhaXRzOjpjb25zdF9yZWZlcmVuY2UgY29uc3RfcmVmZXJlbmNlOwogICAg
ICB0eXBlZGVmIHR5cGVuYW1lIF9BbGxvY190cmFpdHM6OnBvaW50ZXIgcG9pbnRlcjsKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBfQWxsb2NfdHJhaXRzOjpjb25zdF9wb2ludGVyIGNvbnN0X3BvaW50
ZXI7CiAgICAgIHR5cGVkZWYgX19nbnVfY3h4OjpfX25vcm1hbF9pdGVyYXRvcjxwb2ludGVyLCBi
YXNpY19zdHJpbmc+IGl0ZXJhdG9yOwogICAgICB0eXBlZGVmIF9fZ251X2N4eDo6X19ub3JtYWxf
aXRlcmF0b3I8Y29uc3RfcG9pbnRlciwgYmFzaWNfc3RyaW5nPgogICAgICAgY29uc3RfaXRlcmF0
b3I7CiAgICAgIHR5cGVkZWYgc3RkOjpyZXZlcnNlX2l0ZXJhdG9yPGNvbnN0X2l0ZXJhdG9yPiBj
b25zdF9yZXZlcnNlX2l0ZXJhdG9yOwogICAgICB0eXBlZGVmIHN0ZDo6cmV2ZXJzZV9pdGVyYXRv
cjxpdGVyYXRvcj4gcmV2ZXJzZV9pdGVyYXRvcjsKCgogICAgICBzdGF0aWMgY29uc3Qgc2l6ZV90
eXBlIG5wb3MgPSBzdGF0aWNfY2FzdDxzaXplX3R5cGU+KC0xKTsKCiAgICBwcml2YXRlOgoKCgoK
ICAgICAgdHlwZWRlZiBjb25zdF9pdGVyYXRvciBfX2NvbnN0X2l0ZXJhdG9yOwoKCgogICAgICBz
dHJ1Y3QgX0FsbG9jX2hpZGVyIDogYWxsb2NhdG9yX3R5cGUKICAgICAgewogX0FsbG9jX2hpZGVy
KHBvaW50ZXIgX19kYXQsIGNvbnN0IF9BbGxvYyYgX19hID0gX0FsbG9jKCkpCiA6IGFsbG9jYXRv
cl90eXBlKF9fYSksIF9NX3AoX19kYXQpIHsgfQoKIHBvaW50ZXIgX01fcDsKICAgICAgfTsKCiAg
ICAgIF9BbGxvY19oaWRlciBfTV9kYXRhcGx1czsKICAgICAgc2l6ZV90eXBlIF9NX3N0cmluZ19s
ZW5ndGg7CgogICAgICBlbnVtIHsgX1NfbG9jYWxfY2FwYWNpdHkgPSAxNSAvIHNpemVvZihfQ2hh
clQpIH07CgogICAgICB1bmlvbgogICAgICB7CiBfQ2hhclQgX01fbG9jYWxfYnVmW19TX2xvY2Fs
X2NhcGFjaXR5ICsgMV07CiBzaXplX3R5cGUgX01fYWxsb2NhdGVkX2NhcGFjaXR5OwogICAgICB9
OwoKICAgICAgdm9pZAogICAgICBfTV9kYXRhKHBvaW50ZXIgX19wKQogICAgICB7IF9NX2RhdGFw
bHVzLl9NX3AgPSBfX3A7IH0KCiAgICAgIHZvaWQKICAgICAgX01fbGVuZ3RoKHNpemVfdHlwZSBf
X2xlbmd0aCkKICAgICAgeyBfTV9zdHJpbmdfbGVuZ3RoID0gX19sZW5ndGg7IH0KCiAgICAgIHBv
aW50ZXIKICAgICAgX01fZGF0YSgpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX2RhdGFwbHVzLl9N
X3A7IH0KCiAgICAgIHBvaW50ZXIKICAgICAgX01fbG9jYWxfZGF0YSgpCiAgICAgIHsKCiByZXR1
cm4gc3RkOjpwb2ludGVyX3RyYWl0czxwb2ludGVyPjo6cG9pbnRlcl90bygqX01fbG9jYWxfYnVm
KTsKCgoKICAgICAgfQoKICAgICAgY29uc3RfcG9pbnRlcgogICAgICBfTV9sb2NhbF9kYXRhKCkg
Y29uc3QKICAgICAgewoKIHJldHVybiBzdGQ6OnBvaW50ZXJfdHJhaXRzPGNvbnN0X3BvaW50ZXI+
Ojpwb2ludGVyX3RvKCpfTV9sb2NhbF9idWYpOwoKCgogICAgICB9CgogICAgICB2b2lkCiAgICAg
IF9NX2NhcGFjaXR5KHNpemVfdHlwZSBfX2NhcGFjaXR5KQogICAgICB7IF9NX2FsbG9jYXRlZF9j
YXBhY2l0eSA9IF9fY2FwYWNpdHk7IH0KCiAgICAgIHZvaWQKICAgICAgX01fc2V0X2xlbmd0aChz
aXplX3R5cGUgX19uKQogICAgICB7CiBfTV9sZW5ndGgoX19uKTsKIHRyYWl0c190eXBlOjphc3Np
Z24oX01fZGF0YSgpW19fbl0sIF9DaGFyVCgpKTsKICAgICAgfQoKICAgICAgYm9vbAogICAgICBf
TV9pc19sb2NhbCgpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX2RhdGEoKSA9PSBfTV9sb2NhbF9k
YXRhKCk7IH0KCgogICAgICBwb2ludGVyCiAgICAgIF9NX2NyZWF0ZShzaXplX3R5cGUmLCBzaXpl
X3R5cGUpOwoKICAgICAgdm9pZAogICAgICBfTV9kaXNwb3NlKCkKICAgICAgewogaWYgKCFfTV9p
c19sb2NhbCgpKQogICBfTV9kZXN0cm95KF9NX2FsbG9jYXRlZF9jYXBhY2l0eSk7CiAgICAgIH0K
CiAgICAgIHZvaWQKICAgICAgX01fZGVzdHJveShzaXplX3R5cGUgX19zaXplKSB0aHJvdygpCiAg
ICAgIHsgX0FsbG9jX3RyYWl0czo6ZGVhbGxvY2F0ZShfTV9nZXRfYWxsb2NhdG9yKCksIF9NX2Rh
dGEoKSwgX19zaXplICsgMSk7IH0KCgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0luSXRlcmF0
b3I+CiAgICAgICAgdm9pZAogICAgICAgIF9NX2NvbnN0cnVjdF9hdXgoX0luSXRlcmF0b3IgX19i
ZWcsIF9Jbkl0ZXJhdG9yIF9fZW5kLAogICAgc3RkOjpfX2ZhbHNlX3R5cGUpCiB7CiAgICAgICAg
ICB0eXBlZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfSW5JdGVyYXRvcj46Oml0ZXJhdG9y
X2NhdGVnb3J5IF9UYWc7CiAgICAgICAgICBfTV9jb25zdHJ1Y3QoX19iZWcsIF9fZW5kLCBfVGFn
KCkpOwogfQoKCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW50ZWdlcj4KICAgICAgICB2b2lk
CiAgICAgICAgX01fY29uc3RydWN0X2F1eChfSW50ZWdlciBfX2JlZywgX0ludGVnZXIgX19lbmQs
IHN0ZDo6X190cnVlX3R5cGUpCiB7IF9NX2NvbnN0cnVjdF9hdXhfMihzdGF0aWNfY2FzdDxzaXpl
X3R5cGU+KF9fYmVnKSwgX19lbmQpOyB9CgogICAgICB2b2lkCiAgICAgIF9NX2NvbnN0cnVjdF9h
dXhfMihzaXplX3R5cGUgX19yZXEsIF9DaGFyVCBfX2MpCiAgICAgIHsgX01fY29uc3RydWN0KF9f
cmVxLCBfX2MpOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5JdGVyYXRvcj4KICAgICAg
ICB2b2lkCiAgICAgICAgX01fY29uc3RydWN0KF9Jbkl0ZXJhdG9yIF9fYmVnLCBfSW5JdGVyYXRv
ciBfX2VuZCkKIHsKICAgdHlwZWRlZiB0eXBlbmFtZSBzdGQ6Ol9faXNfaW50ZWdlcjxfSW5JdGVy
YXRvcj46Ol9fdHlwZSBfSW50ZWdyYWw7CiAgIF9NX2NvbnN0cnVjdF9hdXgoX19iZWcsIF9fZW5k
LCBfSW50ZWdyYWwoKSk7CiAgICAgICAgfQoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Jbkl0
ZXJhdG9yPgogICAgICAgIHZvaWQKICAgICAgICBfTV9jb25zdHJ1Y3QoX0luSXRlcmF0b3IgX19i
ZWcsIF9Jbkl0ZXJhdG9yIF9fZW5kLAogICAgICAgc3RkOjppbnB1dF9pdGVyYXRvcl90YWcpOwoK
CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRndkSXRlcmF0b3I+CiAgICAgICAgdm9pZAogICAg
ICAgIF9NX2NvbnN0cnVjdChfRndkSXRlcmF0b3IgX19iZWcsIF9Gd2RJdGVyYXRvciBfX2VuZCwK
ICAgICAgIHN0ZDo6Zm9yd2FyZF9pdGVyYXRvcl90YWcpOwoKICAgICAgdm9pZAogICAgICBfTV9j
b25zdHJ1Y3Qoc2l6ZV90eXBlIF9fcmVxLCBfQ2hhclQgX19jKTsKCiAgICAgIGFsbG9jYXRvcl90
eXBlJgogICAgICBfTV9nZXRfYWxsb2NhdG9yKCkKICAgICAgeyByZXR1cm4gX01fZGF0YXBsdXM7
IH0KCiAgICAgIGNvbnN0IGFsbG9jYXRvcl90eXBlJgogICAgICBfTV9nZXRfYWxsb2NhdG9yKCkg
Y29uc3QKICAgICAgeyByZXR1cm4gX01fZGF0YXBsdXM7IH0KCiAgICBwcml2YXRlOgojIDI1OCAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIHNpemVf
dHlwZQogICAgICBfTV9jaGVjayhzaXplX3R5cGUgX19wb3MsIGNvbnN0IGNoYXIqIF9fcykgY29u
c3QKICAgICAgewogaWYgKF9fcG9zID4gdGhpcy0+c2l6ZSgpKQogICBfX3Rocm93X291dF9vZl9y
YW5nZV9mbXQoKCIlczogX19wb3MgKHdoaWNoIGlzICV6dSkgPiAiICJ0aGlzLT5zaXplKCkgKHdo
aWNoIGlzICV6dSkiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwK
ICAgICAgIF9fcywgX19wb3MsIHRoaXMtPnNpemUoKSk7CiByZXR1cm4gX19wb3M7CiAgICAgIH0K
CiAgICAgIHZvaWQKICAgICAgX01fY2hlY2tfbGVuZ3RoKHNpemVfdHlwZSBfX24xLCBzaXplX3R5
cGUgX19uMiwgY29uc3QgY2hhciogX19zKSBjb25zdAogICAgICB7CiBpZiAodGhpcy0+bWF4X3Np
emUoKSAtICh0aGlzLT5zaXplKCkgLSBfX24xKSA8IF9fbjIpCiAgIF9fdGhyb3dfbGVuZ3RoX2Vy
cm9yKChfX3MpKTsKICAgICAgfQoKCgogICAgICBzaXplX3R5cGUKICAgICAgX01fbGltaXQoc2l6
ZV90eXBlIF9fcG9zLCBzaXplX3R5cGUgX19vZmYpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsKIGNv
bnN0IGJvb2wgX190ZXN0b2ZmID0gX19vZmYgPCB0aGlzLT5zaXplKCkgLSBfX3BvczsKIHJldHVy
biBfX3Rlc3RvZmYgPyBfX29mZiA6IHRoaXMtPnNpemUoKSAtIF9fcG9zOwogICAgICB9CgoKICAg
ICAgYm9vbAogICAgICBfTV9kaXNqdW5jdChjb25zdCBfQ2hhclQqIF9fcykgY29uc3Qgbm9leGNl
cHQKICAgICAgewogcmV0dXJuIChsZXNzPGNvbnN0IF9DaGFyVCo+KCkoX19zLCBfTV9kYXRhKCkp
CiAgfHwgbGVzczxjb25zdCBfQ2hhclQqPigpKF9NX2RhdGEoKSArIHRoaXMtPnNpemUoKSwgX19z
KSk7CiAgICAgIH0KCgoKICAgICAgc3RhdGljIHZvaWQKICAgICAgX1NfY29weShfQ2hhclQqIF9f
ZCwgY29uc3QgX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX24pCiAgICAgIHsKIGlmIChfX24gPT0g
MSkKICAgdHJhaXRzX3R5cGU6OmFzc2lnbigqX19kLCAqX19zKTsKIGVsc2UKICAgdHJhaXRzX3R5
cGU6OmNvcHkoX19kLCBfX3MsIF9fbik7CiAgICAgIH0KCiAgICAgIHN0YXRpYyB2b2lkCiAgICAg
IF9TX21vdmUoX0NoYXJUKiBfX2QsIGNvbnN0IF9DaGFyVCogX19zLCBzaXplX3R5cGUgX19uKQog
ICAgICB7CiBpZiAoX19uID09IDEpCiAgIHRyYWl0c190eXBlOjphc3NpZ24oKl9fZCwgKl9fcyk7
CiBlbHNlCiAgIHRyYWl0c190eXBlOjptb3ZlKF9fZCwgX19zLCBfX24pOwogICAgICB9CgogICAg
ICBzdGF0aWMgdm9pZAogICAgICBfU19hc3NpZ24oX0NoYXJUKiBfX2QsIHNpemVfdHlwZSBfX24s
IF9DaGFyVCBfX2MpCiAgICAgIHsKIGlmIChfX24gPT0gMSkKICAgdHJhaXRzX3R5cGU6OmFzc2ln
bigqX19kLCBfX2MpOwogZWxzZQogICB0cmFpdHNfdHlwZTo6YXNzaWduKF9fZCwgX19uLCBfX2Mp
OwogICAgICB9CgoKCiAgICAgIHRlbXBsYXRlPGNsYXNzIF9JdGVyYXRvcj4KICAgICAgICBzdGF0
aWMgdm9pZAogICAgICAgIF9TX2NvcHlfY2hhcnMoX0NoYXJUKiBfX3AsIF9JdGVyYXRvciBfX2sx
LCBfSXRlcmF0b3IgX19rMikKICAgICAgICB7CiAgIGZvciAoOyBfX2sxICE9IF9fazI7ICsrX19r
MSwgKHZvaWQpKytfX3ApCiAgICAgdHJhaXRzX3R5cGU6OmFzc2lnbigqX19wLCAqX19rMSk7CiB9
CgogICAgICBzdGF0aWMgdm9pZAogICAgICBfU19jb3B5X2NoYXJzKF9DaGFyVCogX19wLCBpdGVy
YXRvciBfX2sxLCBpdGVyYXRvciBfX2syKSBub2V4Y2VwdAogICAgICB7IF9TX2NvcHlfY2hhcnMo
X19wLCBfX2sxLmJhc2UoKSwgX19rMi5iYXNlKCkpOyB9CgogICAgICBzdGF0aWMgdm9pZAogICAg
ICBfU19jb3B5X2NoYXJzKF9DaGFyVCogX19wLCBjb25zdF9pdGVyYXRvciBfX2sxLCBjb25zdF9p
dGVyYXRvciBfX2syKQogICAgICBub2V4Y2VwdAogICAgICB7IF9TX2NvcHlfY2hhcnMoX19wLCBf
X2sxLmJhc2UoKSwgX19rMi5iYXNlKCkpOyB9CgogICAgICBzdGF0aWMgdm9pZAogICAgICBfU19j
b3B5X2NoYXJzKF9DaGFyVCogX19wLCBfQ2hhclQqIF9fazEsIF9DaGFyVCogX19rMikgbm9leGNl
cHQKICAgICAgeyBfU19jb3B5KF9fcCwgX19rMSwgX19rMiAtIF9fazEpOyB9CgogICAgICBzdGF0
aWMgdm9pZAogICAgICBfU19jb3B5X2NoYXJzKF9DaGFyVCogX19wLCBjb25zdCBfQ2hhclQqIF9f
azEsIGNvbnN0IF9DaGFyVCogX19rMikKICAgICAgbm9leGNlcHQKICAgICAgeyBfU19jb3B5KF9f
cCwgX19rMSwgX19rMiAtIF9fazEpOyB9CgogICAgICBzdGF0aWMgaW50CiAgICAgIF9TX2NvbXBh
cmUoc2l6ZV90eXBlIF9fbjEsIHNpemVfdHlwZSBfX24yKSBub2V4Y2VwdAogICAgICB7CiBjb25z
dCBkaWZmZXJlbmNlX3R5cGUgX19kID0gZGlmZmVyZW5jZV90eXBlKF9fbjEgLSBfX24yKTsKCiBp
ZiAoX19kID4gX19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPGludD46Ol9fbWF4KQogICByZXR1
cm4gX19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPGludD46Ol9fbWF4OwogZWxzZSBpZiAoX19k
IDwgX19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPGludD46Ol9fbWluKQogICByZXR1cm4gX19n
bnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPGludD46Ol9fbWluOwogZWxzZQogICByZXR1cm4gaW50
KF9fZCk7CiAgICAgIH0KCiAgICAgIHZvaWQKICAgICAgX01fYXNzaWduKGNvbnN0IGJhc2ljX3N0
cmluZyYgX19yY3MpOwoKICAgICAgdm9pZAogICAgICBfTV9tdXRhdGUoc2l6ZV90eXBlIF9fcG9z
LCBzaXplX3R5cGUgX19sZW4xLCBjb25zdCBfQ2hhclQqIF9fcywKICBzaXplX3R5cGUgX19sZW4y
KTsKCiAgICAgIHZvaWQKICAgICAgX01fZXJhc2Uoc2l6ZV90eXBlIF9fcG9zLCBzaXplX3R5cGUg
X19uKTsKCiAgICBwdWJsaWM6CgoKCgoKCgogICAgICBiYXNpY19zdHJpbmcoKQogICAgICBub2V4
Y2VwdChpc19ub3Rocm93X2RlZmF1bHRfY29uc3RydWN0aWJsZTxfQWxsb2M+Ojp2YWx1ZSkKICAg
ICAgOiBfTV9kYXRhcGx1cyhfTV9sb2NhbF9kYXRhKCkpCiAgICAgIHsgX01fc2V0X2xlbmd0aCgw
KTsgfQoKCgoKICAgICAgZXhwbGljaXQKICAgICAgYmFzaWNfc3RyaW5nKGNvbnN0IF9BbGxvYyYg
X19hKSBub2V4Y2VwdAogICAgICA6IF9NX2RhdGFwbHVzKF9NX2xvY2FsX2RhdGEoKSwgX19hKQog
ICAgICB7IF9NX3NldF9sZW5ndGgoMCk7IH0KCgoKCgogICAgICBiYXNpY19zdHJpbmcoY29uc3Qg
YmFzaWNfc3RyaW5nJiBfX3N0cikKICAgICAgOiBfTV9kYXRhcGx1cyhfTV9sb2NhbF9kYXRhKCks
CiAgICAgIF9BbGxvY190cmFpdHM6Ol9TX3NlbGVjdF9vbl9jb3B5KF9fc3RyLl9NX2dldF9hbGxv
Y2F0b3IoKSkpCiAgICAgIHsgX01fY29uc3RydWN0KF9fc3RyLl9NX2RhdGEoKSwgX19zdHIuX01f
ZGF0YSgpICsgX19zdHIubGVuZ3RoKCkpOyB9CiMgNDEwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgYmFzaWNfc3RyaW5nKGNvbnN0IGJhc2ljX3N0
cmluZyYgX19zdHIsIHNpemVfdHlwZSBfX3BvcywKICAgICBzaXplX3R5cGUgX19uID0gbnBvcykK
ICAgICAgOiBfTV9kYXRhcGx1cyhfTV9sb2NhbF9kYXRhKCkpCiAgICAgIHsKIGNvbnN0IF9DaGFy
VCogX19zdGFydCA9IF9fc3RyLl9NX2RhdGEoKQogICArIF9fc3RyLl9NX2NoZWNrKF9fcG9zLCAi
YmFzaWNfc3RyaW5nOjpiYXNpY19zdHJpbmciKTsKIF9NX2NvbnN0cnVjdChfX3N0YXJ0LCBfX3N0
YXJ0ICsgX19zdHIuX01fbGltaXQoX19wb3MsIF9fbikpOwogICAgICB9CiMgNDI2ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgYmFzaWNfc3RyaW5n
KGNvbnN0IGJhc2ljX3N0cmluZyYgX19zdHIsIHNpemVfdHlwZSBfX3BvcywKICAgICBzaXplX3R5
cGUgX19uLCBjb25zdCBfQWxsb2MmIF9fYSkKICAgICAgOiBfTV9kYXRhcGx1cyhfTV9sb2NhbF9k
YXRhKCksIF9fYSkKICAgICAgewogY29uc3QgX0NoYXJUKiBfX3N0YXJ0CiAgID0gX19zdHIuX01f
ZGF0YSgpICsgX19zdHIuX01fY2hlY2soX19wb3MsICJzdHJpbmc6OnN0cmluZyIpOwogX01fY29u
c3RydWN0KF9fc3RhcnQsIF9fc3RhcnQgKyBfX3N0ci5fTV9saW1pdChfX3BvcywgX19uKSk7CiAg
ICAgIH0KIyA0NDQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIg
MwogICAgICBiYXNpY19zdHJpbmcoY29uc3QgX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX24sCiAg
ICAgY29uc3QgX0FsbG9jJiBfX2EgPSBfQWxsb2MoKSkKICAgICAgOiBfTV9kYXRhcGx1cyhfTV9s
b2NhbF9kYXRhKCksIF9fYSkKICAgICAgeyBfTV9jb25zdHJ1Y3QoX19zLCBfX3MgKyBfX24pOyB9
CgoKCgoKCiAgICAgIGJhc2ljX3N0cmluZyhjb25zdCBfQ2hhclQqIF9fcywgY29uc3QgX0FsbG9j
JiBfX2EgPSBfQWxsb2MoKSkKICAgICAgOiBfTV9kYXRhcGx1cyhfTV9sb2NhbF9kYXRhKCksIF9f
YSkKICAgICAgeyBfTV9jb25zdHJ1Y3QoX19zLCBfX3MgPyBfX3MgKyB0cmFpdHNfdHlwZTo6bGVu
Z3RoKF9fcykgOiBfX3MrbnBvcyk7IH0KCgoKCgoKCiAgICAgIGJhc2ljX3N0cmluZyhzaXplX3R5
cGUgX19uLCBfQ2hhclQgX19jLCBjb25zdCBfQWxsb2MmIF9fYSA9IF9BbGxvYygpKQogICAgICA6
IF9NX2RhdGFwbHVzKF9NX2xvY2FsX2RhdGEoKSwgX19hKQogICAgICB7IF9NX2NvbnN0cnVjdChf
X24sIF9fYyk7IH0KIyA0NzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJp
bmcuaCIgMwogICAgICBiYXNpY19zdHJpbmcoYmFzaWNfc3RyaW5nJiYgX19zdHIpIG5vZXhjZXB0
CiAgICAgIDogX01fZGF0YXBsdXMoX01fbG9jYWxfZGF0YSgpLCBzdGQ6Om1vdmUoX19zdHIuX01f
Z2V0X2FsbG9jYXRvcigpKSkKICAgICAgewogaWYgKF9fc3RyLl9NX2lzX2xvY2FsKCkpCiAgIHsK
ICAgICB0cmFpdHNfdHlwZTo6Y29weShfTV9sb2NhbF9idWYsIF9fc3RyLl9NX2xvY2FsX2J1ZiwK
ICAgICAgICAgX1NfbG9jYWxfY2FwYWNpdHkgKyAxKTsKICAgfQogZWxzZQogICB7CiAgICAgX01f
ZGF0YShfX3N0ci5fTV9kYXRhKCkpOwogICAgIF9NX2NhcGFjaXR5KF9fc3RyLl9NX2FsbG9jYXRl
ZF9jYXBhY2l0eSk7CiAgIH0KCgoKCiBfTV9sZW5ndGgoX19zdHIubGVuZ3RoKCkpOwogX19zdHIu
X01fZGF0YShfX3N0ci5fTV9sb2NhbF9kYXRhKCkpOwogX19zdHIuX01fc2V0X2xlbmd0aCgwKTsK
ICAgICAgfQoKCgoKCgogICAgICBiYXNpY19zdHJpbmcoaW5pdGlhbGl6ZXJfbGlzdDxfQ2hhclQ+
IF9fbCwgY29uc3QgX0FsbG9jJiBfX2EgPSBfQWxsb2MoKSkKICAgICAgOiBfTV9kYXRhcGx1cyhf
TV9sb2NhbF9kYXRhKCksIF9fYSkKICAgICAgeyBfTV9jb25zdHJ1Y3QoX19sLmJlZ2luKCksIF9f
bC5lbmQoKSk7IH0KCiAgICAgIGJhc2ljX3N0cmluZyhjb25zdCBiYXNpY19zdHJpbmcmIF9fc3Ry
LCBjb25zdCBfQWxsb2MmIF9fYSkKICAgICAgOiBfTV9kYXRhcGx1cyhfTV9sb2NhbF9kYXRhKCks
IF9fYSkKICAgICAgeyBfTV9jb25zdHJ1Y3QoX19zdHIuYmVnaW4oKSwgX19zdHIuZW5kKCkpOyB9
CgogICAgICBiYXNpY19zdHJpbmcoYmFzaWNfc3RyaW5nJiYgX19zdHIsIGNvbnN0IF9BbGxvYyYg
X19hKQogICAgICBub2V4Y2VwdChfQWxsb2NfdHJhaXRzOjpfU19hbHdheXNfZXF1YWwoKSkKICAg
ICAgOiBfTV9kYXRhcGx1cyhfTV9sb2NhbF9kYXRhKCksIF9fYSkKICAgICAgewogaWYgKF9fc3Ry
Ll9NX2lzX2xvY2FsKCkpCiAgIHsKICAgICB0cmFpdHNfdHlwZTo6Y29weShfTV9sb2NhbF9idWYs
IF9fc3RyLl9NX2xvY2FsX2J1ZiwKICAgICAgICAgX1NfbG9jYWxfY2FwYWNpdHkgKyAxKTsKICAg
ICBfTV9sZW5ndGgoX19zdHIubGVuZ3RoKCkpOwogICAgIF9fc3RyLl9NX3NldF9sZW5ndGgoMCk7
CiAgIH0KIGVsc2UgaWYgKF9BbGxvY190cmFpdHM6Ol9TX2Fsd2F5c19lcXVhbCgpCiAgICAgfHwg
X19zdHIuZ2V0X2FsbG9jYXRvcigpID09IF9fYSkKICAgewogICAgIF9NX2RhdGEoX19zdHIuX01f
ZGF0YSgpKTsKICAgICBfTV9sZW5ndGgoX19zdHIubGVuZ3RoKCkpOwogICAgIF9NX2NhcGFjaXR5
KF9fc3RyLl9NX2FsbG9jYXRlZF9jYXBhY2l0eSk7CiAgICAgX19zdHIuX01fZGF0YShfX3N0ci5f
TV9sb2NhbF9idWYpOwogICAgIF9fc3RyLl9NX3NldF9sZW5ndGgoMCk7CiAgIH0KIGVsc2UKICAg
X01fY29uc3RydWN0KF9fc3RyLmJlZ2luKCksIF9fc3RyLmVuZCgpKTsKICAgICAgfQojIDU0NCAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIHRlbXBs
YXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLAogICAgICAgIHR5cGVuYW1lID0gc3RkOjpfUmVx
dWlyZUlucHV0SXRlcjxfSW5wdXRJdGVyYXRvcj4+CgoKCiAgICAgICAgYmFzaWNfc3RyaW5nKF9J
bnB1dEl0ZXJhdG9yIF9fYmVnLCBfSW5wdXRJdGVyYXRvciBfX2VuZCwKICAgICAgIGNvbnN0IF9B
bGxvYyYgX19hID0gX0FsbG9jKCkpCiA6IF9NX2RhdGFwbHVzKF9NX2xvY2FsX2RhdGEoKSwgX19h
KQogeyBfTV9jb25zdHJ1Y3QoX19iZWcsIF9fZW5kKTsgfQoKCgoKICAgICAgfmJhc2ljX3N0cmlu
ZygpCiAgICAgIHsgX01fZGlzcG9zZSgpOyB9CgoKCgoKICAgICAgYmFzaWNfc3RyaW5nJgogICAg
ICBvcGVyYXRvcj0oY29uc3QgYmFzaWNfc3RyaW5nJiBfX3N0cikKICAgICAgewoKIGlmIChfQWxs
b2NfdHJhaXRzOjpfU19wcm9wYWdhdGVfb25fY29weV9hc3NpZ24oKSkKICAgewogICAgIGlmICgh
X0FsbG9jX3RyYWl0czo6X1NfYWx3YXlzX2VxdWFsKCkgJiYgIV9NX2lzX2xvY2FsKCkKICAmJiBf
TV9nZXRfYWxsb2NhdG9yKCkgIT0gX19zdHIuX01fZ2V0X2FsbG9jYXRvcigpKQogICAgICAgewoK
ICBfTV9kZXN0cm95KF9NX2FsbG9jYXRlZF9jYXBhY2l0eSk7CiAgX01fZGF0YShfTV9sb2NhbF9k
YXRhKCkpOwogIF9NX3NldF9sZW5ndGgoMCk7CiAgICAgICB9CiAgICAgc3RkOjpfX2FsbG9jX29u
X2NvcHkoX01fZ2V0X2FsbG9jYXRvcigpLCBfX3N0ci5fTV9nZXRfYWxsb2NhdG9yKCkpOwogICB9
CgogcmV0dXJuIHRoaXMtPmFzc2lnbihfX3N0cik7CiAgICAgIH0KCgoKCgogICAgICBiYXNpY19z
dHJpbmcmCiAgICAgIG9wZXJhdG9yPShjb25zdCBfQ2hhclQqIF9fcykKICAgICAgeyByZXR1cm4g
dGhpcy0+YXNzaWduKF9fcyk7IH0KIyA1OTkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9i
YXNpY19zdHJpbmcuaCIgMwogICAgICBiYXNpY19zdHJpbmcmCiAgICAgIG9wZXJhdG9yPShfQ2hh
clQgX19jKQogICAgICB7CiB0aGlzLT5hc3NpZ24oMSwgX19jKTsKIHJldHVybiAqdGhpczsKICAg
ICAgfQojIDYxNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAz
CiAgICAgIGJhc2ljX3N0cmluZyYKICAgICAgb3BlcmF0b3I9KGJhc2ljX3N0cmluZyYmIF9fc3Ry
KQogICAgICBub2V4Y2VwdChfQWxsb2NfdHJhaXRzOjpfU19ub3Rocm93X21vdmUoKSkKICAgICAg
ewogaWYgKCFfTV9pc19sb2NhbCgpICYmIF9BbGxvY190cmFpdHM6Ol9TX3Byb3BhZ2F0ZV9vbl9t
b3ZlX2Fzc2lnbigpCiAgICAgJiYgIV9BbGxvY190cmFpdHM6Ol9TX2Fsd2F5c19lcXVhbCgpCiAg
ICAgJiYgX01fZ2V0X2FsbG9jYXRvcigpICE9IF9fc3RyLl9NX2dldF9hbGxvY2F0b3IoKSkKICAg
ewoKICAgICBfTV9kZXN0cm95KF9NX2FsbG9jYXRlZF9jYXBhY2l0eSk7CiAgICAgX01fZGF0YShf
TV9sb2NhbF9kYXRhKCkpOwogICAgIF9NX3NldF9sZW5ndGgoMCk7CiAgIH0KCiBzdGQ6Ol9fYWxs
b2Nfb25fbW92ZShfTV9nZXRfYWxsb2NhdG9yKCksIF9fc3RyLl9NX2dldF9hbGxvY2F0b3IoKSk7
CgogaWYgKCFfX3N0ci5fTV9pc19sb2NhbCgpCiAgICAgJiYgKF9BbGxvY190cmFpdHM6Ol9TX3By
b3BhZ2F0ZV9vbl9tb3ZlX2Fzc2lnbigpCiAgICAgICB8fCBfQWxsb2NfdHJhaXRzOjpfU19hbHdh
eXNfZXF1YWwoKSkpCiAgIHsKICAgICBwb2ludGVyIF9fZGF0YSA9IG51bGxwdHI7CiAgICAgc2l6
ZV90eXBlIF9fY2FwYWNpdHk7CiAgICAgaWYgKCFfTV9pc19sb2NhbCgpKQogICAgICAgewogIGlm
IChfQWxsb2NfdHJhaXRzOjpfU19hbHdheXNfZXF1YWwoKSkKICAgIHsKICAgICAgX19kYXRhID0g
X01fZGF0YSgpOwogICAgICBfX2NhcGFjaXR5ID0gX01fYWxsb2NhdGVkX2NhcGFjaXR5OwogICAg
fQogIGVsc2UKICAgIF9NX2Rlc3Ryb3koX01fYWxsb2NhdGVkX2NhcGFjaXR5KTsKICAgICAgIH0K
CiAgICAgX01fZGF0YShfX3N0ci5fTV9kYXRhKCkpOwogICAgIF9NX2xlbmd0aChfX3N0ci5sZW5n
dGgoKSk7CiAgICAgX01fY2FwYWNpdHkoX19zdHIuX01fYWxsb2NhdGVkX2NhcGFjaXR5KTsKICAg
ICBpZiAoX19kYXRhKQogICAgICAgewogIF9fc3RyLl9NX2RhdGEoX19kYXRhKTsKICBfX3N0ci5f
TV9jYXBhY2l0eShfX2NhcGFjaXR5KTsKICAgICAgIH0KICAgICBlbHNlCiAgICAgICBfX3N0ci5f
TV9kYXRhKF9fc3RyLl9NX2xvY2FsX2J1Zik7CiAgIH0KIGVsc2UKICAgICBhc3NpZ24oX19zdHIp
OwogX19zdHIuY2xlYXIoKTsKIHJldHVybiAqdGhpczsKICAgICAgfQoKCgoKCiAgICAgIGJhc2lj
X3N0cmluZyYKICAgICAgb3BlcmF0b3I9KGluaXRpYWxpemVyX2xpc3Q8X0NoYXJUPiBfX2wpCiAg
ICAgIHsKIHRoaXMtPmFzc2lnbihfX2wuYmVnaW4oKSwgX19sLnNpemUoKSk7CiByZXR1cm4gKnRo
aXM7CiAgICAgIH0KCgoKCgoKCiAgICAgIGl0ZXJhdG9yCiAgICAgIGJlZ2luKCkgbm9leGNlcHQK
ICAgICAgeyByZXR1cm4gaXRlcmF0b3IoX01fZGF0YSgpKTsgfQoKCgoKCiAgICAgIGNvbnN0X2l0
ZXJhdG9yCiAgICAgIGJlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gY29uc3Rf
aXRlcmF0b3IoX01fZGF0YSgpKTsgfQoKCgoKCiAgICAgIGl0ZXJhdG9yCiAgICAgIGVuZCgpIG5v
ZXhjZXB0CiAgICAgIHsgcmV0dXJuIGl0ZXJhdG9yKF9NX2RhdGEoKSArIHRoaXMtPnNpemUoKSk7
IH0KCgoKCgogICAgICBjb25zdF9pdGVyYXRvcgogICAgICBlbmQoKSBjb25zdCBub2V4Y2VwdAog
ICAgICB7IHJldHVybiBjb25zdF9pdGVyYXRvcihfTV9kYXRhKCkgKyB0aGlzLT5zaXplKCkpOyB9
CgoKCgoKCiAgICAgIHJldmVyc2VfaXRlcmF0b3IKICAgICAgcmJlZ2luKCkgbm9leGNlcHQKICAg
ICAgeyByZXR1cm4gcmV2ZXJzZV9pdGVyYXRvcih0aGlzLT5lbmQoKSk7IH0KCgoKCgoKICAgICAg
Y29uc3RfcmV2ZXJzZV9pdGVyYXRvcgogICAgICByYmVnaW4oKSBjb25zdCBub2V4Y2VwdAogICAg
ICB7IHJldHVybiBjb25zdF9yZXZlcnNlX2l0ZXJhdG9yKHRoaXMtPmVuZCgpKTsgfQoKCgoKCgog
ICAgICByZXZlcnNlX2l0ZXJhdG9yCiAgICAgIHJlbmQoKSBub2V4Y2VwdAogICAgICB7IHJldHVy
biByZXZlcnNlX2l0ZXJhdG9yKHRoaXMtPmJlZ2luKCkpOyB9CgoKCgoKCiAgICAgIGNvbnN0X3Jl
dmVyc2VfaXRlcmF0b3IKICAgICAgcmVuZCgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJu
IGNvbnN0X3JldmVyc2VfaXRlcmF0b3IodGhpcy0+YmVnaW4oKSk7IH0KCgoKCgoKICAgICAgY29u
c3RfaXRlcmF0b3IKICAgICAgY2JlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4g
Y29uc3RfaXRlcmF0b3IodGhpcy0+X01fZGF0YSgpKTsgfQoKCgoKCiAgICAgIGNvbnN0X2l0ZXJh
dG9yCiAgICAgIGNlbmQoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBjb25zdF9pdGVy
YXRvcih0aGlzLT5fTV9kYXRhKCkgKyB0aGlzLT5zaXplKCkpOyB9CgoKCgoKCiAgICAgIGNvbnN0
X3JldmVyc2VfaXRlcmF0b3IKICAgICAgY3JiZWdpbigpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsg
cmV0dXJuIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IodGhpcy0+ZW5kKCkpOyB9CgoKCgoKCiAgICAg
IGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAgICAgY3JlbmQoKSBjb25zdCBub2V4Y2VwdAogICAg
ICB7IHJldHVybiBjb25zdF9yZXZlcnNlX2l0ZXJhdG9yKHRoaXMtPmJlZ2luKCkpOyB9CgoKICAg
IHB1YmxpYzoKCgoKICAgICAgc2l6ZV90eXBlCiAgICAgIHNpemUoKSBjb25zdCBub2V4Y2VwdAog
ICAgICB7IHJldHVybiBfTV9zdHJpbmdfbGVuZ3RoOyB9CgoKCiAgICAgIHNpemVfdHlwZQogICAg
ICBsZW5ndGgoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV9zdHJpbmdfbGVuZ3Ro
OyB9CgoKICAgICAgc2l6ZV90eXBlCiAgICAgIG1heF9zaXplKCkgY29uc3Qgbm9leGNlcHQKICAg
ICAgeyByZXR1cm4gKF9BbGxvY190cmFpdHM6Om1heF9zaXplKF9NX2dldF9hbGxvY2F0b3IoKSkg
LSAxKSAvIDI7IH0KIyA4MTMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJp
bmcuaCIgMwogICAgICB2b2lkCiAgICAgIHJlc2l6ZShzaXplX3R5cGUgX19uLCBfQ2hhclQgX19j
KTsKIyA4MjYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwog
ICAgICB2b2lkCiAgICAgIHJlc2l6ZShzaXplX3R5cGUgX19uKQogICAgICB7IHRoaXMtPnJlc2l6
ZShfX24sIF9DaGFyVCgpKTsgfQoKCgogICAgICB2b2lkCiAgICAgIHNocmlua190b19maXQoKSBu
b2V4Y2VwdAogICAgICB7CgogaWYgKGNhcGFjaXR5KCkgPiBzaXplKCkpCiAgIHsKICAgICB0cnkK
ICAgICAgIHsgcmVzZXJ2ZSgwKTsgfQogICAgIGNhdGNoKC4uLikKICAgICAgIHsgfQogICB9Cgog
ICAgICB9CgoKCgoKCiAgICAgIHNpemVfdHlwZQogICAgICBjYXBhY2l0eSgpIGNvbnN0IG5vZXhj
ZXB0CiAgICAgIHsKIHJldHVybiBfTV9pc19sb2NhbCgpID8gc2l6ZV90eXBlKF9TX2xvY2FsX2Nh
cGFjaXR5KQogICAgICAgICAgICAgICAgICAgICAgOiBfTV9hbGxvY2F0ZWRfY2FwYWNpdHk7CiAg
ICAgIH0KIyA4NzUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIg
MwogICAgICB2b2lkCiAgICAgIHJlc2VydmUoc2l6ZV90eXBlIF9fcmVzX2FyZyA9IDApOwoKCgoK
ICAgICAgdm9pZAogICAgICBjbGVhcigpIG5vZXhjZXB0CiAgICAgIHsgX01fc2V0X2xlbmd0aCgw
KTsgfQoKCgoKCiAgICAgIGJvb2wKICAgICAgZW1wdHkoKSBjb25zdCBub2V4Y2VwdAogICAgICB7
IHJldHVybiB0aGlzLT5zaXplKCkgPT0gMDsgfQojIDkwNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIGNvbnN0X3JlZmVyZW5jZQogICAgICBvcGVy
YXRvcltdIChzaXplX3R5cGUgX19wb3MpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsKIDsKIHJldHVy
biBfTV9kYXRhKClbX19wb3NdOwogICAgICB9CiMgOTIxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgcmVmZXJlbmNlCiAgICAgIG9wZXJhdG9yW10o
c2l6ZV90eXBlIF9fcG9zKQogICAgICB7CgoKIDsKCiA7CiByZXR1cm4gX01fZGF0YSgpW19fcG9z
XTsKICAgICAgfQojIDk0MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmlu
Zy5oIiAzCiAgICAgIGNvbnN0X3JlZmVyZW5jZQogICAgICBhdChzaXplX3R5cGUgX19uKSBjb25z
dAogICAgICB7CiBpZiAoX19uID49IHRoaXMtPnNpemUoKSkKICAgX190aHJvd19vdXRfb2ZfcmFu
Z2VfZm10KCgiYmFzaWNfc3RyaW5nOjphdDogX19uICIgIih3aGljaCBpcyAlenUpID49IHRoaXMt
PnNpemUoKSAiICIod2hpY2ggaXMgJXp1KSIpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAg
LAogICAgICAgX19uLCB0aGlzLT5zaXplKCkpOwogcmV0dXJuIF9NX2RhdGEoKVtfX25dOwogICAg
ICB9CiMgOTYzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMK
ICAgICAgcmVmZXJlbmNlCiAgICAgIGF0KHNpemVfdHlwZSBfX24pCiAgICAgIHsKIGlmIChfX24g
Pj0gc2l6ZSgpKQogICBfX3Rocm93X291dF9vZl9yYW5nZV9mbXQoKCJiYXNpY19zdHJpbmc6OmF0
OiBfX24gIiAiKHdoaWNoIGlzICV6dSkgPj0gdGhpcy0+c2l6ZSgpICIgIih3aGljaCBpcyAlenUp
IikKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsCiAgICAgICBfX24sIHRoaXMtPnNpemUo
KSk7CiByZXR1cm4gX01fZGF0YSgpW19fbl07CiAgICAgIH0KCgoKCgoKICAgICAgcmVmZXJlbmNl
CiAgICAgIGZyb250KCkgbm9leGNlcHQKICAgICAgewogOwogcmV0dXJuIG9wZXJhdG9yW10oMCk7
CiAgICAgIH0KCgoKCgogICAgICBjb25zdF9yZWZlcmVuY2UKICAgICAgZnJvbnQoKSBjb25zdCBu
b2V4Y2VwdAogICAgICB7CiA7CiByZXR1cm4gb3BlcmF0b3JbXSgwKTsKICAgICAgfQoKCgoKCiAg
ICAgIHJlZmVyZW5jZQogICAgICBiYWNrKCkgbm9leGNlcHQKICAgICAgewogOwogcmV0dXJuIG9w
ZXJhdG9yW10odGhpcy0+c2l6ZSgpIC0gMSk7CiAgICAgIH0KCgoKCgogICAgICBjb25zdF9yZWZl
cmVuY2UKICAgICAgYmFjaygpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsKIDsKIHJldHVybiBvcGVy
YXRvcltdKHRoaXMtPnNpemUoKSAtIDEpOwogICAgICB9CiMgMTAyNiAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIGJhc2ljX3N0cmluZyYKICAgICAg
b3BlcmF0b3IrPShjb25zdCBiYXNpY19zdHJpbmcmIF9fc3RyKQogICAgICB7IHJldHVybiB0aGlz
LT5hcHBlbmQoX19zdHIpOyB9CgoKCgoKCiAgICAgIGJhc2ljX3N0cmluZyYKICAgICAgb3BlcmF0
b3IrPShjb25zdCBfQ2hhclQqIF9fcykKICAgICAgeyByZXR1cm4gdGhpcy0+YXBwZW5kKF9fcyk7
IH0KCgoKCgoKICAgICAgYmFzaWNfc3RyaW5nJgogICAgICBvcGVyYXRvcis9KF9DaGFyVCBfX2Mp
CiAgICAgIHsKIHRoaXMtPnB1c2hfYmFjayhfX2MpOwogcmV0dXJuICp0aGlzOwogICAgICB9CgoK
CgoKCgogICAgICBiYXNpY19zdHJpbmcmCiAgICAgIG9wZXJhdG9yKz0oaW5pdGlhbGl6ZXJfbGlz
dDxfQ2hhclQ+IF9fbCkKICAgICAgeyByZXR1cm4gdGhpcy0+YXBwZW5kKF9fbC5iZWdpbigpLCBf
X2wuc2l6ZSgpKTsgfQoKCgoKCgoKICAgICAgYmFzaWNfc3RyaW5nJgogICAgICBhcHBlbmQoY29u
c3QgYmFzaWNfc3RyaW5nJiBfX3N0cikKICAgICAgeyByZXR1cm4gX01fYXBwZW5kKF9fc3RyLl9N
X2RhdGEoKSwgX19zdHIuc2l6ZSgpKTsgfQojIDEwODQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICBiYXNpY19zdHJpbmcmCiAgICAgIGFwcGVuZChj
b25zdCBiYXNpY19zdHJpbmcmIF9fc3RyLCBzaXplX3R5cGUgX19wb3MsIHNpemVfdHlwZSBfX24p
CiAgICAgIHsgcmV0dXJuIF9NX2FwcGVuZChfX3N0ci5fTV9kYXRhKCkKICAgICsgX19zdHIuX01f
Y2hlY2soX19wb3MsICJiYXNpY19zdHJpbmc6OmFwcGVuZCIpLAogICAgX19zdHIuX01fbGltaXQo
X19wb3MsIF9fbikpOyB9CgoKCgoKCgogICAgICBiYXNpY19zdHJpbmcmCiAgICAgIGFwcGVuZChj
b25zdCBfQ2hhclQqIF9fcywgc2l6ZV90eXBlIF9fbikKICAgICAgewogOwogX01fY2hlY2tfbGVu
Z3RoKHNpemVfdHlwZSgwKSwgX19uLCAiYmFzaWNfc3RyaW5nOjphcHBlbmQiKTsKIHJldHVybiBf
TV9hcHBlbmQoX19zLCBfX24pOwogICAgICB9CgoKCgoKCiAgICAgIGJhc2ljX3N0cmluZyYKICAg
ICAgYXBwZW5kKGNvbnN0IF9DaGFyVCogX19zKQogICAgICB7CiA7CiBjb25zdCBzaXplX3R5cGUg
X19uID0gdHJhaXRzX3R5cGU6Omxlbmd0aChfX3MpOwogX01fY2hlY2tfbGVuZ3RoKHNpemVfdHlw
ZSgwKSwgX19uLCAiYmFzaWNfc3RyaW5nOjphcHBlbmQiKTsKIHJldHVybiBfTV9hcHBlbmQoX19z
LCBfX24pOwogICAgICB9CiMgMTEyNiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2lj
X3N0cmluZy5oIiAzCiAgICAgIGJhc2ljX3N0cmluZyYKICAgICAgYXBwZW5kKHNpemVfdHlwZSBf
X24sIF9DaGFyVCBfX2MpCiAgICAgIHsgcmV0dXJuIF9NX3JlcGxhY2VfYXV4KHRoaXMtPnNpemUo
KSwgc2l6ZV90eXBlKDApLCBfX24sIF9fYyk7IH0KCgoKCgoKCiAgICAgIGJhc2ljX3N0cmluZyYK
ICAgICAgYXBwZW5kKGluaXRpYWxpemVyX2xpc3Q8X0NoYXJUPiBfX2wpCiAgICAgIHsgcmV0dXJu
IHRoaXMtPmFwcGVuZChfX2wuYmVnaW4oKSwgX19sLnNpemUoKSk7IH0KIyAxMTUwICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgdGVtcGxhdGU8Y2xh
c3MgX0lucHV0SXRlcmF0b3IsCiAgICAgICAgdHlwZW5hbWUgPSBzdGQ6Ol9SZXF1aXJlSW5wdXRJ
dGVyPF9JbnB1dEl0ZXJhdG9yPj4KCgoKICAgICAgICBiYXNpY19zdHJpbmcmCiAgICAgICAgYXBw
ZW5kKF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCkKICAgICAg
ICB7IHJldHVybiB0aGlzLT5yZXBsYWNlKGVuZCgpLCBlbmQoKSwgX19maXJzdCwgX19sYXN0KTsg
fQoKCgoKCiAgICAgIHZvaWQKICAgICAgcHVzaF9iYWNrKF9DaGFyVCBfX2MpCiAgICAgIHsKIGNv
bnN0IHNpemVfdHlwZSBfX3NpemUgPSB0aGlzLT5zaXplKCk7CiBpZiAoX19zaXplICsgMSA+IHRo
aXMtPmNhcGFjaXR5KCkpCiAgIHRoaXMtPl9NX211dGF0ZShfX3NpemUsIHNpemVfdHlwZSgwKSwg
MCwgc2l6ZV90eXBlKDEpKTsKIHRyYWl0c190eXBlOjphc3NpZ24odGhpcy0+X01fZGF0YSgpW19f
c2l6ZV0sIF9fYyk7CiB0aGlzLT5fTV9zZXRfbGVuZ3RoKF9fc2l6ZSArIDEpOwogICAgICB9CgoK
CgoKCiAgICAgIGJhc2ljX3N0cmluZyYKICAgICAgYXNzaWduKGNvbnN0IGJhc2ljX3N0cmluZyYg
X19zdHIpCiAgICAgIHsKIHRoaXMtPl9NX2Fzc2lnbihfX3N0cik7CiByZXR1cm4gKnRoaXM7CiAg
ICAgIH0KIyAxMTk0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgi
IDMKICAgICAgYmFzaWNfc3RyaW5nJgogICAgICBhc3NpZ24oYmFzaWNfc3RyaW5nJiYgX19zdHIp
CiAgICAgIG5vZXhjZXB0KF9BbGxvY190cmFpdHM6Ol9TX25vdGhyb3dfbW92ZSgpKQogICAgICB7
CgoKIHJldHVybiAqdGhpcyA9IHN0ZDo6bW92ZShfX3N0cik7CiAgICAgIH0KIyAxMjE3ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgYmFzaWNfc3Ry
aW5nJgogICAgICBhc3NpZ24oY29uc3QgYmFzaWNfc3RyaW5nJiBfX3N0ciwgc2l6ZV90eXBlIF9f
cG9zLCBzaXplX3R5cGUgX19uKQogICAgICB7IHJldHVybiBfTV9yZXBsYWNlKHNpemVfdHlwZSgw
KSwgdGhpcy0+c2l6ZSgpLCBfX3N0ci5fTV9kYXRhKCkKICAgICArIF9fc3RyLl9NX2NoZWNrKF9f
cG9zLCAiYmFzaWNfc3RyaW5nOjphc3NpZ24iKSwKICAgICBfX3N0ci5fTV9saW1pdChfX3Bvcywg
X19uKSk7IH0KIyAxMjMzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5n
LmgiIDMKICAgICAgYmFzaWNfc3RyaW5nJgogICAgICBhc3NpZ24oY29uc3QgX0NoYXJUKiBfX3Ms
IHNpemVfdHlwZSBfX24pCiAgICAgIHsKIDsKIHJldHVybiBfTV9yZXBsYWNlKHNpemVfdHlwZSgw
KSwgdGhpcy0+c2l6ZSgpLCBfX3MsIF9fbik7CiAgICAgIH0KIyAxMjQ5ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgYmFzaWNfc3RyaW5nJgogICAg
ICBhc3NpZ24oY29uc3QgX0NoYXJUKiBfX3MpCiAgICAgIHsKIDsKIHJldHVybiBfTV9yZXBsYWNl
KHNpemVfdHlwZSgwKSwgdGhpcy0+c2l6ZSgpLCBfX3MsCiAgICAgdHJhaXRzX3R5cGU6Omxlbmd0
aChfX3MpKTsKICAgICAgfQojIDEyNjYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNp
Y19zdHJpbmcuaCIgMwogICAgICBiYXNpY19zdHJpbmcmCiAgICAgIGFzc2lnbihzaXplX3R5cGUg
X19uLCBfQ2hhclQgX19jKQogICAgICB7IHJldHVybiBfTV9yZXBsYWNlX2F1eChzaXplX3R5cGUo
MCksIHRoaXMtPnNpemUoKSwgX19uLCBfX2MpOyB9CiMgMTI3OSAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIHRlbXBsYXRlPGNsYXNzIF9JbnB1dEl0
ZXJhdG9yLAogICAgICAgIHR5cGVuYW1lID0gc3RkOjpfUmVxdWlyZUlucHV0SXRlcjxfSW5wdXRJ
dGVyYXRvcj4+CgoKCiAgICAgICAgYmFzaWNfc3RyaW5nJgogICAgICAgIGFzc2lnbihfSW5wdXRJ
dGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QpCiAgICAgICAgeyByZXR1cm4g
dGhpcy0+cmVwbGFjZShiZWdpbigpLCBlbmQoKSwgX19maXJzdCwgX19sYXN0KTsgfQoKCgoKCgoK
ICAgICAgYmFzaWNfc3RyaW5nJgogICAgICBhc3NpZ24oaW5pdGlhbGl6ZXJfbGlzdDxfQ2hhclQ+
IF9fbCkKICAgICAgeyByZXR1cm4gdGhpcy0+YXNzaWduKF9fbC5iZWdpbigpLCBfX2wuc2l6ZSgp
KTsgfQojIDEzMTUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIg
MwogICAgICBpdGVyYXRvcgogICAgICBpbnNlcnQoY29uc3RfaXRlcmF0b3IgX19wLCBzaXplX3R5
cGUgX19uLCBfQ2hhclQgX19jKQogICAgICB7CiA7CiBjb25zdCBzaXplX3R5cGUgX19wb3MgPSBf
X3AgLSBiZWdpbigpOwogdGhpcy0+cmVwbGFjZShfX3AsIF9fcCwgX19uLCBfX2MpOwogcmV0dXJu
IGl0ZXJhdG9yKHRoaXMtPl9NX2RhdGEoKSArIF9fcG9zKTsKICAgICAgfQojIDEzNTcgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICB0ZW1wbGF0ZTxj
bGFzcyBfSW5wdXRJdGVyYXRvciwKICAgICAgICB0eXBlbmFtZSA9IHN0ZDo6X1JlcXVpcmVJbnB1
dEl0ZXI8X0lucHV0SXRlcmF0b3I+PgogaXRlcmF0b3IKICAgICAgICBpbnNlcnQoY29uc3RfaXRl
cmF0b3IgX19wLCBfSW5wdXRJdGVyYXRvciBfX2JlZywgX0lucHV0SXRlcmF0b3IgX19lbmQpCiAg
ICAgICAgewogICA7CiAgIGNvbnN0IHNpemVfdHlwZSBfX3BvcyA9IF9fcCAtIGJlZ2luKCk7CiAg
IHRoaXMtPnJlcGxhY2UoX19wLCBfX3AsIF9fYmVnLCBfX2VuZCk7CiAgIHJldHVybiBpdGVyYXRv
cih0aGlzLT5fTV9kYXRhKCkgKyBfX3Bvcyk7CiB9CiMgMTM5MyAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIHZvaWQKICAgICAgaW5zZXJ0KGl0ZXJh
dG9yIF9fcCwgaW5pdGlhbGl6ZXJfbGlzdDxfQ2hhclQ+IF9fbCkKICAgICAgewogOwogdGhpcy0+
aW5zZXJ0KF9fcCAtIGJlZ2luKCksIF9fbC5iZWdpbigpLCBfX2wuc2l6ZSgpKTsKICAgICAgfQoj
IDE0MTMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAg
ICBiYXNpY19zdHJpbmcmCiAgICAgIGluc2VydChzaXplX3R5cGUgX19wb3MxLCBjb25zdCBiYXNp
Y19zdHJpbmcmIF9fc3RyKQogICAgICB7IHJldHVybiB0aGlzLT5yZXBsYWNlKF9fcG9zMSwgc2l6
ZV90eXBlKDApLAogICAgICAgIF9fc3RyLl9NX2RhdGEoKSwgX19zdHIuc2l6ZSgpKTsgfQojIDE0
MzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICBi
YXNpY19zdHJpbmcmCiAgICAgIGluc2VydChzaXplX3R5cGUgX19wb3MxLCBjb25zdCBiYXNpY19z
dHJpbmcmIF9fc3RyLAogICAgICBzaXplX3R5cGUgX19wb3MyLCBzaXplX3R5cGUgX19uKQogICAg
ICB7IHJldHVybiB0aGlzLT5yZXBsYWNlKF9fcG9zMSwgc2l6ZV90eXBlKDApLCBfX3N0ci5fTV9k
YXRhKCkKICAgICAgICArIF9fc3RyLl9NX2NoZWNrKF9fcG9zMiwgImJhc2ljX3N0cmluZzo6aW5z
ZXJ0IiksCiAgICAgICAgX19zdHIuX01fbGltaXQoX19wb3MyLCBfX24pKTsgfQojIDE0NTkgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICBiYXNpY19z
dHJpbmcmCiAgICAgIGluc2VydChzaXplX3R5cGUgX19wb3MsIGNvbnN0IF9DaGFyVCogX19zLCBz
aXplX3R5cGUgX19uKQogICAgICB7IHJldHVybiB0aGlzLT5yZXBsYWNlKF9fcG9zLCBzaXplX3R5
cGUoMCksIF9fcywgX19uKTsgfQojIDE0NzggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9i
YXNpY19zdHJpbmcuaCIgMwogICAgICBiYXNpY19zdHJpbmcmCiAgICAgIGluc2VydChzaXplX3R5
cGUgX19wb3MsIGNvbnN0IF9DaGFyVCogX19zKQogICAgICB7CiA7CiByZXR1cm4gdGhpcy0+cmVw
bGFjZShfX3Bvcywgc2l6ZV90eXBlKDApLCBfX3MsCiAgICAgICAgdHJhaXRzX3R5cGU6Omxlbmd0
aChfX3MpKTsKICAgICAgfQojIDE1MDIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNp
Y19zdHJpbmcuaCIgMwogICAgICBiYXNpY19zdHJpbmcmCiAgICAgIGluc2VydChzaXplX3R5cGUg
X19wb3MsIHNpemVfdHlwZSBfX24sIF9DaGFyVCBfX2MpCiAgICAgIHsgcmV0dXJuIF9NX3JlcGxh
Y2VfYXV4KF9NX2NoZWNrKF9fcG9zLCAiYmFzaWNfc3RyaW5nOjppbnNlcnQiKSwKICAgICAgICAg
c2l6ZV90eXBlKDApLCBfX24sIF9fYyk7IH0KIyAxNTIwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgaXRlcmF0b3IKICAgICAgaW5zZXJ0KF9fY29u
c3RfaXRlcmF0b3IgX19wLCBfQ2hhclQgX19jKQogICAgICB7CiA7CiBjb25zdCBzaXplX3R5cGUg
X19wb3MgPSBfX3AgLSBiZWdpbigpOwogX01fcmVwbGFjZV9hdXgoX19wb3MsIHNpemVfdHlwZSgw
KSwgc2l6ZV90eXBlKDEpLCBfX2MpOwogcmV0dXJuIGl0ZXJhdG9yKF9NX2RhdGEoKSArIF9fcG9z
KTsKICAgICAgfQojIDE1NDQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJp
bmcuaCIgMwogICAgICBiYXNpY19zdHJpbmcmCiAgICAgIGVyYXNlKHNpemVfdHlwZSBfX3BvcyA9
IDAsIHNpemVfdHlwZSBfX24gPSBucG9zKQogICAgICB7CiB0aGlzLT5fTV9lcmFzZShfTV9jaGVj
ayhfX3BvcywgImJhc2ljX3N0cmluZzo6ZXJhc2UiKSwKICAgICAgICAgX01fbGltaXQoX19wb3Ms
IF9fbikpOwogcmV0dXJuICp0aGlzOwogICAgICB9CiMgMTU2MCAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIGl0ZXJhdG9yCiAgICAgIGVyYXNlKF9f
Y29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbikKICAgICAgewoKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgOwogY29uc3Qgc2l6ZV90eXBlIF9fcG9zID0gX19wb3NpdGlvbiAtIGJlZ2luKCk7CiB0
aGlzLT5fTV9lcmFzZShfX3Bvcywgc2l6ZV90eXBlKDEpKTsKIHJldHVybiBpdGVyYXRvcihfTV9k
YXRhKCkgKyBfX3Bvcyk7CiAgICAgIH0KIyAxNTc5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgaXRlcmF0b3IKICAgICAgZXJhc2UoX19jb25zdF9p
dGVyYXRvciBfX2ZpcnN0LCBfX2NvbnN0X2l0ZXJhdG9yIF9fbGFzdCkKICAgICAgewoKICAgICAg
ICAgICAgICAgICAgICAgICAgOwogICAgICAgIGNvbnN0IHNpemVfdHlwZSBfX3BvcyA9IF9fZmly
c3QgLSBiZWdpbigpOwogdGhpcy0+X01fZXJhc2UoX19wb3MsIF9fbGFzdCAtIF9fZmlyc3QpOwog
cmV0dXJuIGl0ZXJhdG9yKHRoaXMtPl9NX2RhdGEoKSArIF9fcG9zKTsKICAgICAgfQoKCgoKCgoK
ICAgICAgdm9pZAogICAgICBwb3BfYmFjaygpIG5vZXhjZXB0CiAgICAgIHsKIDsKIF9NX2VyYXNl
KHNpemUoKSAtIDEsIDEpOwogICAgICB9CiMgMTYyMCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIGJhc2ljX3N0cmluZyYKICAgICAgcmVwbGFjZShz
aXplX3R5cGUgX19wb3MsIHNpemVfdHlwZSBfX24sIGNvbnN0IGJhc2ljX3N0cmluZyYgX19zdHIp
CiAgICAgIHsgcmV0dXJuIHRoaXMtPnJlcGxhY2UoX19wb3MsIF9fbiwgX19zdHIuX01fZGF0YSgp
LCBfX3N0ci5zaXplKCkpOyB9CiMgMTY0MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jh
c2ljX3N0cmluZy5oIiAzCiAgICAgIGJhc2ljX3N0cmluZyYKICAgICAgcmVwbGFjZShzaXplX3R5
cGUgX19wb3MxLCBzaXplX3R5cGUgX19uMSwgY29uc3QgYmFzaWNfc3RyaW5nJiBfX3N0ciwKICAg
ICAgIHNpemVfdHlwZSBfX3BvczIsIHNpemVfdHlwZSBfX24yKQogICAgICB7IHJldHVybiB0aGlz
LT5yZXBsYWNlKF9fcG9zMSwgX19uMSwgX19zdHIuX01fZGF0YSgpCiAgICAgICAgKyBfX3N0ci5f
TV9jaGVjayhfX3BvczIsICJiYXNpY19zdHJpbmc6OnJlcGxhY2UiKSwKICAgICAgICBfX3N0ci5f
TV9saW1pdChfX3BvczIsIF9fbjIpKTsgfQojIDE2NjcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICBiYXNpY19zdHJpbmcmCiAgICAgIHJlcGxhY2Uo
c2l6ZV90eXBlIF9fcG9zLCBzaXplX3R5cGUgX19uMSwgY29uc3QgX0NoYXJUKiBfX3MsCiAgICAg
ICBzaXplX3R5cGUgX19uMikKICAgICAgewogOwogcmV0dXJuIF9NX3JlcGxhY2UoX01fY2hlY2so
X19wb3MsICJiYXNpY19zdHJpbmc6OnJlcGxhY2UiKSwKICAgICBfTV9saW1pdChfX3BvcywgX19u
MSksIF9fcywgX19uMik7CiAgICAgIH0KIyAxNjkyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgYmFzaWNfc3RyaW5nJgogICAgICByZXBsYWNlKHNp
emVfdHlwZSBfX3Bvcywgc2l6ZV90eXBlIF9fbjEsIGNvbnN0IF9DaGFyVCogX19zKQogICAgICB7
CiA7CiByZXR1cm4gdGhpcy0+cmVwbGFjZShfX3BvcywgX19uMSwgX19zLCB0cmFpdHNfdHlwZTo6
bGVuZ3RoKF9fcykpOwogICAgICB9CiMgMTcxNiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIGJhc2ljX3N0cmluZyYKICAgICAgcmVwbGFjZShzaXpl
X3R5cGUgX19wb3MsIHNpemVfdHlwZSBfX24xLCBzaXplX3R5cGUgX19uMiwgX0NoYXJUIF9fYykK
ICAgICAgeyByZXR1cm4gX01fcmVwbGFjZV9hdXgoX01fY2hlY2soX19wb3MsICJiYXNpY19zdHJp
bmc6OnJlcGxhY2UiKSwKICAgICAgICAgX01fbGltaXQoX19wb3MsIF9fbjEpLCBfX24yLCBfX2Mp
OyB9CiMgMTczNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAz
CiAgICAgIGJhc2ljX3N0cmluZyYKICAgICAgcmVwbGFjZShfX2NvbnN0X2l0ZXJhdG9yIF9faTEs
IF9fY29uc3RfaXRlcmF0b3IgX19pMiwKICAgICAgIGNvbnN0IGJhc2ljX3N0cmluZyYgX19zdHIp
CiAgICAgIHsgcmV0dXJuIHRoaXMtPnJlcGxhY2UoX19pMSwgX19pMiwgX19zdHIuX01fZGF0YSgp
LCBfX3N0ci5zaXplKCkpOyB9CiMgMTc1NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jh
c2ljX3N0cmluZy5oIiAzCiAgICAgIGJhc2ljX3N0cmluZyYKICAgICAgcmVwbGFjZShfX2NvbnN0
X2l0ZXJhdG9yIF9faTEsIF9fY29uc3RfaXRlcmF0b3IgX19pMiwKICAgICAgIGNvbnN0IF9DaGFy
VCogX19zLCBzaXplX3R5cGUgX19uKQogICAgICB7CgogICAgICAgICAgICAgICAgICAgICAgOwog
cmV0dXJuIHRoaXMtPnJlcGxhY2UoX19pMSAtIGJlZ2luKCksIF9faTIgLSBfX2kxLCBfX3MsIF9f
bik7CiAgICAgIH0KIyAxNzc2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3Ry
aW5nLmgiIDMKICAgICAgYmFzaWNfc3RyaW5nJgogICAgICByZXBsYWNlKF9fY29uc3RfaXRlcmF0
b3IgX19pMSwgX19jb25zdF9pdGVyYXRvciBfX2kyLCBjb25zdCBfQ2hhclQqIF9fcykKICAgICAg
ewogOwogcmV0dXJuIHRoaXMtPnJlcGxhY2UoX19pMSwgX19pMiwgX19zLCB0cmFpdHNfdHlwZTo6
bGVuZ3RoKF9fcykpOwogICAgICB9CiMgMTc5NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIGJhc2ljX3N0cmluZyYKICAgICAgcmVwbGFjZShfX2Nv
bnN0X2l0ZXJhdG9yIF9faTEsIF9fY29uc3RfaXRlcmF0b3IgX19pMiwgc2l6ZV90eXBlIF9fbiwK
ICAgICAgIF9DaGFyVCBfX2MpCiAgICAgIHsKCiAgICAgICAgICAgICAgICAgICAgICA7CiByZXR1
cm4gX01fcmVwbGFjZV9hdXgoX19pMSAtIGJlZ2luKCksIF9faTIgLSBfX2kxLCBfX24sIF9fYyk7
CiAgICAgIH0KIyAxODIyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5n
LmgiIDMKICAgICAgdGVtcGxhdGU8Y2xhc3MgX0lucHV0SXRlcmF0b3IsCiAgICAgICAgdHlwZW5h
bWUgPSBzdGQ6Ol9SZXF1aXJlSW5wdXRJdGVyPF9JbnB1dEl0ZXJhdG9yPj4KICAgICAgICBiYXNp
Y19zdHJpbmcmCiAgICAgICAgcmVwbGFjZShjb25zdF9pdGVyYXRvciBfX2kxLCBjb25zdF9pdGVy
YXRvciBfX2kyLAogIF9JbnB1dEl0ZXJhdG9yIF9fazEsIF9JbnB1dEl0ZXJhdG9yIF9fazIpCiAg
ICAgICAgewogIAogICAgICAgICAgICAgICAgICAgICAgICA7CiAgIDsKICAgcmV0dXJuIHRoaXMt
Pl9NX3JlcGxhY2VfZGlzcGF0Y2goX19pMSwgX19pMiwgX19rMSwgX19rMiwKICAgICAgICBzdGQ6
Ol9fZmFsc2VfdHlwZSgpKTsKIH0KIyAxODU0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
YmFzaWNfc3RyaW5nLmgiIDMKICAgICAgYmFzaWNfc3RyaW5nJgogICAgICByZXBsYWNlKF9fY29u
c3RfaXRlcmF0b3IgX19pMSwgX19jb25zdF9pdGVyYXRvciBfX2kyLAogICAgICAgX0NoYXJUKiBf
X2sxLCBfQ2hhclQqIF9fazIpCiAgICAgIHsKCiAgICAgICAgICAgICAgICAgICAgICA7CiA7CiBy
ZXR1cm4gdGhpcy0+cmVwbGFjZShfX2kxIC0gYmVnaW4oKSwgX19pMiAtIF9faTEsCiAgICAgICAg
X19rMSwgX19rMiAtIF9fazEpOwogICAgICB9CgogICAgICBiYXNpY19zdHJpbmcmCiAgICAgIHJl
cGxhY2UoX19jb25zdF9pdGVyYXRvciBfX2kxLCBfX2NvbnN0X2l0ZXJhdG9yIF9faTIsCiAgICAg
ICBjb25zdCBfQ2hhclQqIF9fazEsIGNvbnN0IF9DaGFyVCogX19rMikKICAgICAgewoKICAgICAg
ICAgICAgICAgICAgICAgIDsKIDsKIHJldHVybiB0aGlzLT5yZXBsYWNlKF9faTEgLSBiZWdpbigp
LCBfX2kyIC0gX19pMSwKICAgICAgICBfX2sxLCBfX2syIC0gX19rMSk7CiAgICAgIH0KCiAgICAg
IGJhc2ljX3N0cmluZyYKICAgICAgcmVwbGFjZShfX2NvbnN0X2l0ZXJhdG9yIF9faTEsIF9fY29u
c3RfaXRlcmF0b3IgX19pMiwKICAgICAgIGl0ZXJhdG9yIF9fazEsIGl0ZXJhdG9yIF9fazIpCiAg
ICAgIHsKCiAgICAgICAgICAgICAgICAgICAgICA7CiA7CiByZXR1cm4gdGhpcy0+cmVwbGFjZShf
X2kxIC0gYmVnaW4oKSwgX19pMiAtIF9faTEsCiAgICAgICAgX19rMS5iYXNlKCksIF9fazIgLSBf
X2sxKTsKICAgICAgfQoKICAgICAgYmFzaWNfc3RyaW5nJgogICAgICByZXBsYWNlKF9fY29uc3Rf
aXRlcmF0b3IgX19pMSwgX19jb25zdF9pdGVyYXRvciBfX2kyLAogICAgICAgY29uc3RfaXRlcmF0
b3IgX19rMSwgY29uc3RfaXRlcmF0b3IgX19rMikKICAgICAgewoKICAgICAgICAgICAgICAgICAg
ICAgIDsKIDsKIHJldHVybiB0aGlzLT5yZXBsYWNlKF9faTEgLSBiZWdpbigpLCBfX2kyIC0gX19p
MSwKICAgICAgICBfX2sxLmJhc2UoKSwgX19rMiAtIF9fazEpOwogICAgICB9CiMgMTkxMyAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIGJhc2ljX3N0
cmluZyYgcmVwbGFjZShjb25zdF9pdGVyYXRvciBfX2kxLCBjb25zdF9pdGVyYXRvciBfX2kyLAog
ICAgICAgaW5pdGlhbGl6ZXJfbGlzdDxfQ2hhclQ+IF9fbCkKICAgICAgeyByZXR1cm4gdGhpcy0+
cmVwbGFjZShfX2kxLCBfX2kyLCBfX2wuYmVnaW4oKSwgX19sLmVuZCgpKTsgfQoKCiAgICBwcml2
YXRlOgogICAgICB0ZW1wbGF0ZTxjbGFzcyBfSW50ZWdlcj4KIGJhc2ljX3N0cmluZyYKIF9NX3Jl
cGxhY2VfZGlzcGF0Y2goY29uc3RfaXRlcmF0b3IgX19pMSwgY29uc3RfaXRlcmF0b3IgX19pMiwK
ICAgICAgIF9JbnRlZ2VyIF9fbiwgX0ludGVnZXIgX192YWwsIF9fdHJ1ZV90eXBlKQogICAgICAg
IHsgcmV0dXJuIF9NX3JlcGxhY2VfYXV4KF9faTEgLSBiZWdpbigpLCBfX2kyIC0gX19pMSwgX19u
LCBfX3ZhbCk7IH0KCiAgICAgIHRlbXBsYXRlPGNsYXNzIF9JbnB1dEl0ZXJhdG9yPgogYmFzaWNf
c3RyaW5nJgogX01fcmVwbGFjZV9kaXNwYXRjaChjb25zdF9pdGVyYXRvciBfX2kxLCBjb25zdF9p
dGVyYXRvciBfX2kyLAogICAgICAgX0lucHV0SXRlcmF0b3IgX19rMSwgX0lucHV0SXRlcmF0b3Ig
X19rMiwKICAgICAgIF9fZmFsc2VfdHlwZSk7CgogICAgICBiYXNpY19zdHJpbmcmCiAgICAgIF9N
X3JlcGxhY2VfYXV4KHNpemVfdHlwZSBfX3BvczEsIHNpemVfdHlwZSBfX24xLCBzaXplX3R5cGUg
X19uMiwKICAgICAgIF9DaGFyVCBfX2MpOwoKICAgICAgYmFzaWNfc3RyaW5nJgogICAgICBfTV9y
ZXBsYWNlKHNpemVfdHlwZSBfX3Bvcywgc2l6ZV90eXBlIF9fbGVuMSwgY29uc3QgX0NoYXJUKiBf
X3MsCiAgIGNvbnN0IHNpemVfdHlwZSBfX2xlbjIpOwoKICAgICAgYmFzaWNfc3RyaW5nJgogICAg
ICBfTV9hcHBlbmQoY29uc3QgX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX24pOwoKICAgIHB1Ymxp
YzoKIyAxOTU2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMK
ICAgICAgc2l6ZV90eXBlCiAgICAgIGNvcHkoX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX24sIHNp
emVfdHlwZSBfX3BvcyA9IDApIGNvbnN0OwojIDE5NjYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICB2b2lkCiAgICAgIHN3YXAoYmFzaWNfc3RyaW5n
JiBfX3MpIG5vZXhjZXB0OwojIDE5NzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNp
Y19zdHJpbmcuaCIgMwogICAgICBjb25zdCBfQ2hhclQqCiAgICAgIGNfc3RyKCkgY29uc3Qgbm9l
eGNlcHQKICAgICAgeyByZXR1cm4gX01fZGF0YSgpOyB9CgoKCgoKCgogICAgICBjb25zdCBfQ2hh
clQqCiAgICAgIGRhdGEoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV9kYXRhKCk7
IH0KCgoKCiAgICAgIGFsbG9jYXRvcl90eXBlCiAgICAgIGdldF9hbGxvY2F0b3IoKSBjb25zdCBu
b2V4Y2VwdAogICAgICB7IHJldHVybiBfTV9nZXRfYWxsb2NhdG9yKCk7IH0KIyAyMDA5ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgc2l6ZV90eXBl
CiAgICAgIGZpbmQoY29uc3QgX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX3Bvcywgc2l6ZV90eXBl
IF9fbikgY29uc3Q7CiMgMjAyMiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0
cmluZy5oIiAzCiAgICAgIHNpemVfdHlwZQogICAgICBmaW5kKGNvbnN0IGJhc2ljX3N0cmluZyYg
X19zdHIsIHNpemVfdHlwZSBfX3BvcyA9IDApIGNvbnN0CiBub2V4Y2VwdAogICAgICB7IHJldHVy
biB0aGlzLT5maW5kKF9fc3RyLmRhdGEoKSwgX19wb3MsIF9fc3RyLnNpemUoKSk7IH0KIyAyMDM3
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgc2l6
ZV90eXBlCiAgICAgIGZpbmQoY29uc3QgX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX3BvcyA9IDAp
IGNvbnN0CiAgICAgIHsKIDsKIHJldHVybiB0aGlzLT5maW5kKF9fcywgX19wb3MsIHRyYWl0c190
eXBlOjpsZW5ndGgoX19zKSk7CiAgICAgIH0KIyAyMDU0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgc2l6ZV90eXBlCiAgICAgIGZpbmQoX0NoYXJU
IF9fYywgc2l6ZV90eXBlIF9fcG9zID0gMCkgY29uc3Qgbm9leGNlcHQ7CiMgMjA2NyAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIHNpemVfdHlwZQog
ICAgICByZmluZChjb25zdCBiYXNpY19zdHJpbmcmIF9fc3RyLCBzaXplX3R5cGUgX19wb3MgPSBu
cG9zKSBjb25zdAogbm9leGNlcHQKICAgICAgeyByZXR1cm4gdGhpcy0+cmZpbmQoX19zdHIuZGF0
YSgpLCBfX3BvcywgX19zdHIuc2l6ZSgpKTsgfQojIDIwODQgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICBzaXplX3R5cGUKICAgICAgcmZpbmQoY29u
c3QgX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX3Bvcywgc2l6ZV90eXBlIF9fbikgY29uc3Q7CiMg
MjA5NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAg
IHNpemVfdHlwZQogICAgICByZmluZChjb25zdCBfQ2hhclQqIF9fcywgc2l6ZV90eXBlIF9fcG9z
ID0gbnBvcykgY29uc3QKICAgICAgewogOwogcmV0dXJuIHRoaXMtPnJmaW5kKF9fcywgX19wb3Ms
IHRyYWl0c190eXBlOjpsZW5ndGgoX19zKSk7CiAgICAgIH0KIyAyMTE0ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgc2l6ZV90eXBlCiAgICAgIHJm
aW5kKF9DaGFyVCBfX2MsIHNpemVfdHlwZSBfX3BvcyA9IG5wb3MpIGNvbnN0IG5vZXhjZXB0Owoj
IDIxMjggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAg
ICBzaXplX3R5cGUKICAgICAgZmluZF9maXJzdF9vZihjb25zdCBiYXNpY19zdHJpbmcmIF9fc3Ry
LCBzaXplX3R5cGUgX19wb3MgPSAwKSBjb25zdAogbm9leGNlcHQKICAgICAgeyByZXR1cm4gdGhp
cy0+ZmluZF9maXJzdF9vZihfX3N0ci5kYXRhKCksIF9fcG9zLCBfX3N0ci5zaXplKCkpOyB9CiMg
MjE0NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAg
IHNpemVfdHlwZQogICAgICBmaW5kX2ZpcnN0X29mKGNvbnN0IF9DaGFyVCogX19zLCBzaXplX3R5
cGUgX19wb3MsIHNpemVfdHlwZSBfX24pIGNvbnN0OwojIDIxNTggIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICBzaXplX3R5cGUKICAgICAgZmluZF9m
aXJzdF9vZihjb25zdCBfQ2hhclQqIF9fcywgc2l6ZV90eXBlIF9fcG9zID0gMCkgY29uc3QKICAg
ICAgewogOwogcmV0dXJuIHRoaXMtPmZpbmRfZmlyc3Rfb2YoX19zLCBfX3BvcywgdHJhaXRzX3R5
cGU6Omxlbmd0aChfX3MpKTsKICAgICAgfQojIDIxNzcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICBzaXplX3R5cGUKICAgICAgZmluZF9maXJzdF9v
ZihfQ2hhclQgX19jLCBzaXplX3R5cGUgX19wb3MgPSAwKSBjb25zdCBub2V4Y2VwdAogICAgICB7
IHJldHVybiB0aGlzLT5maW5kKF9fYywgX19wb3MpOyB9CiMgMjE5MiAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIHNpemVfdHlwZQogICAgICBmaW5k
X2xhc3Rfb2YoY29uc3QgYmFzaWNfc3RyaW5nJiBfX3N0ciwgc2l6ZV90eXBlIF9fcG9zID0gbnBv
cykgY29uc3QKIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHRoaXMtPmZpbmRfbGFzdF9vZihfX3N0
ci5kYXRhKCksIF9fcG9zLCBfX3N0ci5zaXplKCkpOyB9CiMgMjIwOSAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIHNpemVfdHlwZQogICAgICBmaW5k
X2xhc3Rfb2YoY29uc3QgX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX3Bvcywgc2l6ZV90eXBlIF9f
bikgY29uc3Q7CiMgMjIyMiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmlu
Zy5oIiAzCiAgICAgIHNpemVfdHlwZQogICAgICBmaW5kX2xhc3Rfb2YoY29uc3QgX0NoYXJUKiBf
X3MsIHNpemVfdHlwZSBfX3BvcyA9IG5wb3MpIGNvbnN0CiAgICAgIHsKIDsKIHJldHVybiB0aGlz
LT5maW5kX2xhc3Rfb2YoX19zLCBfX3BvcywgdHJhaXRzX3R5cGU6Omxlbmd0aChfX3MpKTsKICAg
ICAgfQojIDIyNDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIg
MwogICAgICBzaXplX3R5cGUKICAgICAgZmluZF9sYXN0X29mKF9DaGFyVCBfX2MsIHNpemVfdHlw
ZSBfX3BvcyA9IG5wb3MpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHRoaXMtPnJmaW5k
KF9fYywgX19wb3MpOyB9CiMgMjI1NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2lj
X3N0cmluZy5oIiAzCiAgICAgIHNpemVfdHlwZQogICAgICBmaW5kX2ZpcnN0X25vdF9vZihjb25z
dCBiYXNpY19zdHJpbmcmIF9fc3RyLCBzaXplX3R5cGUgX19wb3MgPSAwKSBjb25zdAogbm9leGNl
cHQKICAgICAgeyByZXR1cm4gdGhpcy0+ZmluZF9maXJzdF9ub3Rfb2YoX19zdHIuZGF0YSgpLCBf
X3BvcywgX19zdHIuc2l6ZSgpKTsgfQojIDIyNzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICBzaXplX3R5cGUKICAgICAgZmluZF9maXJzdF9ub3Rf
b2YoY29uc3QgX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX3BvcywKICAgc2l6ZV90eXBlIF9fbikg
Y29uc3Q7CiMgMjI4NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5o
IiAzCiAgICAgIHNpemVfdHlwZQogICAgICBmaW5kX2ZpcnN0X25vdF9vZihjb25zdCBfQ2hhclQq
IF9fcywgc2l6ZV90eXBlIF9fcG9zID0gMCkgY29uc3QKICAgICAgewogOwogcmV0dXJuIHRoaXMt
PmZpbmRfZmlyc3Rfbm90X29mKF9fcywgX19wb3MsIHRyYWl0c190eXBlOjpsZW5ndGgoX19zKSk7
CiAgICAgIH0KIyAyMzAzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5n
LmgiIDMKICAgICAgc2l6ZV90eXBlCiAgICAgIGZpbmRfZmlyc3Rfbm90X29mKF9DaGFyVCBfX2Ms
IHNpemVfdHlwZSBfX3BvcyA9IDApIGNvbnN0CiBub2V4Y2VwdDsKIyAyMzE4ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgc2l6ZV90eXBlCiAgICAg
IGZpbmRfbGFzdF9ub3Rfb2YoY29uc3QgYmFzaWNfc3RyaW5nJiBfX3N0ciwgc2l6ZV90eXBlIF9f
cG9zID0gbnBvcykgY29uc3QKIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHRoaXMtPmZpbmRfbGFz
dF9ub3Rfb2YoX19zdHIuZGF0YSgpLCBfX3BvcywgX19zdHIuc2l6ZSgpKTsgfQojIDIzMzUgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICBzaXplX3R5
cGUKICAgICAgZmluZF9sYXN0X25vdF9vZihjb25zdCBfQ2hhclQqIF9fcywgc2l6ZV90eXBlIF9f
cG9zLAogICAgICAgICBzaXplX3R5cGUgX19uKSBjb25zdDsKIyAyMzQ5ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgc2l6ZV90eXBlCiAgICAgIGZp
bmRfbGFzdF9ub3Rfb2YoY29uc3QgX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX3BvcyA9IG5wb3Mp
IGNvbnN0CiAgICAgIHsKIDsKIHJldHVybiB0aGlzLT5maW5kX2xhc3Rfbm90X29mKF9fcywgX19w
b3MsIHRyYWl0c190eXBlOjpsZW5ndGgoX19zKSk7CiAgICAgIH0KIyAyMzY2ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICAgICAgc2l6ZV90eXBlCiAgICAg
IGZpbmRfbGFzdF9ub3Rfb2YoX0NoYXJUIF9fYywgc2l6ZV90eXBlIF9fcG9zID0gbnBvcykgY29u
c3QKIG5vZXhjZXB0OwojIDIzODIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19z
dHJpbmcuaCIgMwogICAgICBiYXNpY19zdHJpbmcKICAgICAgc3Vic3RyKHNpemVfdHlwZSBfX3Bv
cyA9IDAsIHNpemVfdHlwZSBfX24gPSBucG9zKSBjb25zdAogICAgICB7IHJldHVybiBiYXNpY19z
dHJpbmcoKnRoaXMsCiAgICAgICBfTV9jaGVjayhfX3BvcywgImJhc2ljX3N0cmluZzo6c3Vic3Ry
IiksIF9fbik7IH0KIyAyNDAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3Ry
aW5nLmgiIDMKICAgICAgaW50CiAgICAgIGNvbXBhcmUoY29uc3QgYmFzaWNfc3RyaW5nJiBfX3N0
cikgY29uc3QKICAgICAgewogY29uc3Qgc2l6ZV90eXBlIF9fc2l6ZSA9IHRoaXMtPnNpemUoKTsK
IGNvbnN0IHNpemVfdHlwZSBfX29zaXplID0gX19zdHIuc2l6ZSgpOwogY29uc3Qgc2l6ZV90eXBl
IF9fbGVuID0gc3RkOjptaW4oX19zaXplLCBfX29zaXplKTsKCiBpbnQgX19yID0gdHJhaXRzX3R5
cGU6OmNvbXBhcmUoX01fZGF0YSgpLCBfX3N0ci5kYXRhKCksIF9fbGVuKTsKIGlmICghX19yKQog
ICBfX3IgPSBfU19jb21wYXJlKF9fc2l6ZSwgX19vc2l6ZSk7CiByZXR1cm4gX19yOwogICAgICB9
CiMgMjQzMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAg
ICAgIGludAogICAgICBjb21wYXJlKHNpemVfdHlwZSBfX3Bvcywgc2l6ZV90eXBlIF9fbiwgY29u
c3QgYmFzaWNfc3RyaW5nJiBfX3N0cikgY29uc3Q7CiMgMjQ1OSAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIGludAogICAgICBjb21wYXJlKHNpemVf
dHlwZSBfX3BvczEsIHNpemVfdHlwZSBfX24xLCBjb25zdCBiYXNpY19zdHJpbmcmIF9fc3RyLAog
ICAgICAgc2l6ZV90eXBlIF9fcG9zMiwgc2l6ZV90eXBlIF9fbjIpIGNvbnN0OwojIDI0NzcgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogICAgICBpbnQKICAg
ICAgY29tcGFyZShjb25zdCBfQ2hhclQqIF9fcykgY29uc3Q7CiMgMjUwMSAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgICAgIGludAogICAgICBjb21wYXJl
KHNpemVfdHlwZSBfX3Bvcywgc2l6ZV90eXBlIF9fbjEsIGNvbnN0IF9DaGFyVCogX19zKSBjb25z
dDsKIyAyNTI4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMK
ICAgICAgaW50CiAgICAgIGNvbXBhcmUoc2l6ZV90eXBlIF9fcG9zLCBzaXplX3R5cGUgX19uMSwg
Y29uc3QgX0NoYXJUKiBfX3MsCiAgICAgICBzaXplX3R5cGUgX19uMikgY29uc3Q7CiAgfTsKfQoj
IDQ5MjcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogIHRl
bXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9j
PgogICAgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPgogICAgb3BlcmF0b3Ir
KGNvbnN0IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mIF9fbGhzLAogICAg
ICAgY29uc3QgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPiYgX19yaHMpCiAg
ICB7CiAgICAgIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4gX19zdHIoX19s
aHMpOwogICAgICBfX3N0ci5hcHBlbmQoX19yaHMpOwogICAgICByZXR1cm4gX19zdHI7CiAgICB9
CgoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlw
ZW5hbWUgX0FsbG9jPgogICAgYmFzaWNfc3RyaW5nPF9DaGFyVCxfVHJhaXRzLF9BbGxvYz4KICAg
IG9wZXJhdG9yKyhjb25zdCBfQ2hhclQqIF9fbGhzLAogICAgICAgY29uc3QgYmFzaWNfc3RyaW5n
PF9DaGFyVCxfVHJhaXRzLF9BbGxvYz4mIF9fcmhzKTsKCgoKCgoKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBiYXNpY19z
dHJpbmc8X0NoYXJULF9UcmFpdHMsX0FsbG9jPgogICAgb3BlcmF0b3IrKF9DaGFyVCBfX2xocywg
Y29uc3QgYmFzaWNfc3RyaW5nPF9DaGFyVCxfVHJhaXRzLF9BbGxvYz4mIF9fcmhzKTsKCgoKCgoK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBf
QWxsb2M+CiAgICBpbmxpbmUgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPgog
ICAgb3BlcmF0b3IrKGNvbnN0IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4m
IF9fbGhzLAogICAgICAgY29uc3QgX0NoYXJUKiBfX3JocykKICAgIHsKICAgICAgYmFzaWNfc3Ry
aW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPiBfX3N0cihfX2xocyk7CiAgICAgIF9fc3RyLmFw
cGVuZChfX3Jocyk7CiAgICAgIHJldHVybiBfX3N0cjsKICAgIH0KCgoKCgoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBp
bmxpbmUgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPgogICAgb3BlcmF0b3Ir
KGNvbnN0IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mIF9fbGhzLCBfQ2hh
clQgX19yaHMpCiAgICB7CiAgICAgIHR5cGVkZWYgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0
cywgX0FsbG9jPiBfX3N0cmluZ190eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fc3RyaW5n
X3R5cGU6OnNpemVfdHlwZSBfX3NpemVfdHlwZTsKICAgICAgX19zdHJpbmdfdHlwZSBfX3N0cihf
X2xocyk7CiAgICAgIF9fc3RyLmFwcGVuZChfX3NpemVfdHlwZSgxKSwgX19yaHMpOwogICAgICBy
ZXR1cm4gX19zdHI7CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1l
IF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBiYXNpY19zdHJpbmc8X0NoYXJU
LCBfVHJhaXRzLCBfQWxsb2M+CiAgICBvcGVyYXRvcisoYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1Ry
YWl0cywgX0FsbG9jPiYmIF9fbGhzLAogICAgICAgY29uc3QgYmFzaWNfc3RyaW5nPF9DaGFyVCwg
X1RyYWl0cywgX0FsbG9jPiYgX19yaHMpCiAgICB7IHJldHVybiBzdGQ6Om1vdmUoX19saHMuYXBw
ZW5kKF9fcmhzKSk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJh
aXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1Ry
YWl0cywgX0FsbG9jPgogICAgb3BlcmF0b3IrKGNvbnN0IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9U
cmFpdHMsIF9BbGxvYz4mIF9fbGhzLAogICAgICAgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0
cywgX0FsbG9jPiYmIF9fcmhzKQogICAgeyByZXR1cm4gc3RkOjptb3ZlKF9fcmhzLmluc2VydCgw
LCBfX2xocykpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0
cywgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFp
dHMsIF9BbGxvYz4KICAgIG9wZXJhdG9yKyhiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBf
QWxsb2M+JiYgX19saHMsCiAgICAgICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxs
b2M+JiYgX19yaHMpCiAgICB7CiAgICAgIGNvbnN0IGF1dG8gX19zaXplID0gX19saHMuc2l6ZSgp
ICsgX19yaHMuc2l6ZSgpOwogICAgICBjb25zdCBib29sIF9fY29uZCA9IChfX3NpemUgPiBfX2xo
cy5jYXBhY2l0eSgpCiAgICAgICYmIF9fc2l6ZSA8PSBfX3Jocy5jYXBhY2l0eSgpKTsKICAgICAg
cmV0dXJuIF9fY29uZCA/IHN0ZDo6bW92ZShfX3Jocy5pbnNlcnQoMCwgX19saHMpKQogICAgICAg
ICAgICAgOiBzdGQ6Om1vdmUoX19saHMuYXBwZW5kKF9fcmhzKSk7CiAgICB9CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9jPgogICAg
aW5saW5lIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4KICAgIG9wZXJhdG9y
Kyhjb25zdCBfQ2hhclQqIF9fbGhzLAogICAgICAgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0
cywgX0FsbG9jPiYmIF9fcmhzKQogICAgeyByZXR1cm4gc3RkOjptb3ZlKF9fcmhzLmluc2VydCgw
LCBfX2xocykpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0
cywgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFp
dHMsIF9BbGxvYz4KICAgIG9wZXJhdG9yKyhfQ2hhclQgX19saHMsCiAgICAgICBiYXNpY19zdHJp
bmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+JiYgX19yaHMpCiAgICB7IHJldHVybiBzdGQ6Om1v
dmUoX19yaHMuaW5zZXJ0KDAsIDEsIF9fbGhzKSk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0No
YXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYmFzaWNf
c3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPgogICAgb3BlcmF0b3IrKGJhc2ljX3N0cmlu
ZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mJiBfX2xocywKICAgICAgIGNvbnN0IF9DaGFyVCog
X19yaHMpCiAgICB7IHJldHVybiBzdGQ6Om1vdmUoX19saHMuYXBwZW5kKF9fcmhzKSk7IH0KCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxs
b2M+CiAgICBpbmxpbmUgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPgogICAg
b3BlcmF0b3IrKGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mJiBfX2xocywK
ICAgICAgIF9DaGFyVCBfX3JocykKICAgIHsgcmV0dXJuIHN0ZDo6bW92ZShfX2xocy5hcHBlbmQo
MSwgX19yaHMpKTsgfQojIDUwNDggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19z
dHJpbmcuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywg
dHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPT0oY29uc3QgYmFz
aWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPiYgX19saHMsCiAgICAgICAgY29uc3Qg
YmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPiYgX19yaHMpCiAgICBub2V4Y2Vw
dAogICAgeyByZXR1cm4gX19saHMuY29tcGFyZShfX3JocykgPT0gMDsgfQoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfQ2hhclQ+CiAgICBpbmxpbmUKICAgIHR5cGVuYW1lIF9fZ251X2N4eDo6X19lbmFi
bGVfaWY8X19pc19jaGFyPF9DaGFyVD46Ol9fdmFsdWUsIGJvb2w+OjpfX3R5cGUKICAgIG9wZXJh
dG9yPT0oY29uc3QgYmFzaWNfc3RyaW5nPF9DaGFyVD4mIF9fbGhzLAogICAgICAgIGNvbnN0IGJh
c2ljX3N0cmluZzxfQ2hhclQ+JiBfX3Jocykgbm9leGNlcHQKICAgIHsgcmV0dXJuIChfX2xocy5z
aXplKCkgPT0gX19yaHMuc2l6ZSgpCiAgICAgICAmJiAhc3RkOjpjaGFyX3RyYWl0czxfQ2hhclQ+
Ojpjb21wYXJlKF9fbGhzLmRhdGEoKSwgX19yaHMuZGF0YSgpLAogICAgICAgICAgX19saHMuc2l6
ZSgpKSk7IH0KCgoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJh
aXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I9PShjb25z
dCBfQ2hhclQqIF9fbGhzLAogICAgICAgIGNvbnN0IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFp
dHMsIF9BbGxvYz4mIF9fcmhzKQogICAgeyByZXR1cm4gX19yaHMuY29tcGFyZShfX2xocykgPT0g
MDsgfQoKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMs
IHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj09KGNvbnN0IGJh
c2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mIF9fbGhzLAogICAgICAgIGNvbnN0
IF9DaGFyVCogX19yaHMpCiAgICB7IHJldHVybiBfX2xocy5jb21wYXJlKF9fcmhzKSA9PSAwOyB9
CiMgNTA5NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxs
b2M+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3IhPShjb25zdCBiYXNpY19zdHJpbmc8X0No
YXJULCBfVHJhaXRzLCBfQWxsb2M+JiBfX2xocywKICAgICAgICBjb25zdCBiYXNpY19zdHJpbmc8
X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+JiBfX3JocykKICAgIG5vZXhjZXB0CiAgICB7IHJldHVy
biAhKF9fbGhzID09IF9fcmhzKTsgfQoKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQs
IHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBv
cGVyYXRvciE9KGNvbnN0IF9DaGFyVCogX19saHMsCiAgICAgICAgY29uc3QgYmFzaWNfc3RyaW5n
PF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPiYgX19yaHMpCiAgICB7IHJldHVybiAhKF9fbGhzID09
IF9fcmhzKTsgfQoKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9U
cmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvciE9KGNv
bnN0IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mIF9fbGhzLAogICAgICAg
IGNvbnN0IF9DaGFyVCogX19yaHMpCiAgICB7IHJldHVybiAhKF9fbGhzID09IF9fcmhzKTsgfQoj
IDUxMzMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogIHRl
bXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9j
PgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPChjb25zdCBiYXNpY19zdHJpbmc8X0NoYXJU
LCBfVHJhaXRzLCBfQWxsb2M+JiBfX2xocywKICAgICAgIGNvbnN0IGJhc2ljX3N0cmluZzxfQ2hh
clQsIF9UcmFpdHMsIF9BbGxvYz4mIF9fcmhzKQogICAgbm9leGNlcHQKICAgIHsgcmV0dXJuIF9f
bGhzLmNvbXBhcmUoX19yaHMpIDwgMDsgfQoKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hh
clQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAg
ICBvcGVyYXRvcjwoY29uc3QgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPiYg
X19saHMsCiAgICAgICBjb25zdCBfQ2hhclQqIF9fcmhzKQogICAgeyByZXR1cm4gX19saHMuY29t
cGFyZShfX3JocykgPCAwOyB9CgoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlw
ZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJh
dG9yPChjb25zdCBfQ2hhclQqIF9fbGhzLAogICAgICAgY29uc3QgYmFzaWNfc3RyaW5nPF9DaGFy
VCwgX1RyYWl0cywgX0FsbG9jPiYgX19yaHMpCiAgICB7IHJldHVybiBfX3Jocy5jb21wYXJlKF9f
bGhzKSA+IDA7IH0KIyA1MTcxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3Ry
aW5nLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5
cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj4oY29uc3QgYmFzaWNf
c3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPiYgX19saHMsCiAgICAgICBjb25zdCBiYXNp
Y19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+JiBfX3JocykKICAgIG5vZXhjZXB0CiAg
ICB7IHJldHVybiBfX2xocy5jb21wYXJlKF9fcmhzKSA+IDA7IH0KCgoKCgoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBp
bmxpbmUgYm9vbAogICAgb3BlcmF0b3I+KGNvbnN0IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFp
dHMsIF9BbGxvYz4mIF9fbGhzLAogICAgICAgY29uc3QgX0NoYXJUKiBfX3JocykKICAgIHsgcmV0
dXJuIF9fbGhzLmNvbXBhcmUoX19yaHMpID4gMDsgfQoKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBi
b29sCiAgICBvcGVyYXRvcj4oY29uc3QgX0NoYXJUKiBfX2xocywKICAgICAgIGNvbnN0IGJhc2lj
X3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mIF9fcmhzKQogICAgeyByZXR1cm4gX19y
aHMuY29tcGFyZShfX2xocykgPCAwOyB9CiMgNTIwOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFt
ZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I8
PShjb25zdCBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+JiBfX2xocywKICAg
ICAgICBjb25zdCBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+JiBfX3JocykK
ICAgIG5vZXhjZXB0CiAgICB7IHJldHVybiBfX2xocy5jb21wYXJlKF9fcmhzKSA8PSAwOyB9CgoK
CgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlwZW5h
bWUgX0FsbG9jPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPD0oY29uc3QgYmFzaWNfc3Ry
aW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPiYgX19saHMsCiAgICAgICAgY29uc3QgX0NoYXJU
KiBfX3JocykKICAgIHsgcmV0dXJuIF9fbGhzLmNvbXBhcmUoX19yaHMpIDw9IDA7IH0KCgoKCgoK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBf
QWxsb2M+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I8PShjb25zdCBfQ2hhclQqIF9fbGhz
LAogICAgICAgIGNvbnN0IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mIF9f
cmhzKQogICAgeyByZXR1cm4gX19yaHMuY29tcGFyZShfX2xocykgPj0gMDsgfQojIDUyNDcgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMwogIHRlbXBsYXRlPHR5
cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5s
aW5lIGJvb2wKICAgIG9wZXJhdG9yPj0oY29uc3QgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0
cywgX0FsbG9jPiYgX19saHMsCiAgICAgICAgY29uc3QgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1Ry
YWl0cywgX0FsbG9jPiYgX19yaHMpCiAgICBub2V4Y2VwdAogICAgeyByZXR1cm4gX19saHMuY29t
cGFyZShfX3JocykgPj0gMDsgfQoKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5
cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVy
YXRvcj49KGNvbnN0IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mIF9fbGhz
LAogICAgICAgIGNvbnN0IF9DaGFyVCogX19yaHMpCiAgICB7IHJldHVybiBfX2xocy5jb21wYXJl
KF9fcmhzKSA+PSAwOyB9CgoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5h
bWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9y
Pj0oY29uc3QgX0NoYXJUKiBfX2xocywKICAgICAgY29uc3QgYmFzaWNfc3RyaW5nPF9DaGFyVCwg
X1RyYWl0cywgX0FsbG9jPiYgX19yaHMpCiAgICB7IHJldHVybiBfX3Jocy5jb21wYXJlKF9fbGhz
KSA8PSAwOyB9CiMgNTI4NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmlu
Zy5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBl
bmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgdm9pZAogICAgc3dhcChiYXNpY19zdHJpbmc8X0NoYXJU
LCBfVHJhaXRzLCBfQWxsb2M+JiBfX2xocywKICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRz
LCBfQWxsb2M+JiBfX3JocykKICAgIG5vZXhjZXB0KG5vZXhjZXB0KF9fbGhzLnN3YXAoX19yaHMp
KSkKICAgIHsgX19saHMuc3dhcChfX3Jocyk7IH0KIyA1MzA1ICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5
cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGJhc2ljX2lzdHJlYW08X0NoYXJU
LCBfVHJhaXRzPiYKICAgIG9wZXJhdG9yPj4oYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+
JiBfX2lzLAogICAgICAgIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mIF9f
c3RyKTsKCiAgdGVtcGxhdGU8PgogICAgYmFzaWNfaXN0cmVhbTxjaGFyPiYKICAgIG9wZXJhdG9y
Pj4oYmFzaWNfaXN0cmVhbTxjaGFyPiYgX19pcywgYmFzaWNfc3RyaW5nPGNoYXI+JiBfX3N0cik7
CiMgNTMyMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy5oIiAzCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxs
b2M+CiAgICBpbmxpbmUgYmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JgogICAgb3BlcmF0
b3I8PChiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mIF9fb3MsCiAgICAgICAgY29uc3Qg
YmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPiYgX19zdHIpCiAgICB7CgoKICAg
ICAgcmV0dXJuIF9fb3N0cmVhbV9pbnNlcnQoX19vcywgX19zdHIuZGF0YSgpLCBfX3N0ci5zaXpl
KCkpOwogICAgfQojIDUzNDYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJp
bmcuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlw
ZW5hbWUgX0FsbG9jPgogICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JgogICAgZ2V0
bGluZShiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mIF9faXMsCiAgICAgYmFzaWNfc3Ry
aW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPiYgX19zdHIsIF9DaGFyVCBfX2RlbGltKTsKIyA1
MzYzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLmgiIDMKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4K
ICAgIGlubGluZSBiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBnZXRsaW5lKGJh
c2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiYgX19pcywKICAgICBiYXNpY19zdHJpbmc8X0No
YXJULCBfVHJhaXRzLCBfQWxsb2M+JiBfX3N0cikKICAgIHsgcmV0dXJuIHN0ZDo6Z2V0bGluZShf
X2lzLCBfX3N0ciwgX19pcy53aWRlbignXG4nKSk7IH0KCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
Q2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBiYXNp
Y19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBnZXRsaW5lKGJhc2ljX2lzdHJlYW08X0No
YXJULCBfVHJhaXRzPiYmIF9faXMsCiAgICAgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywg
X0FsbG9jPiYgX19zdHIsIF9DaGFyVCBfX2RlbGltKQogICAgeyByZXR1cm4gc3RkOjpnZXRsaW5l
KF9faXMsIF9fc3RyLCBfX2RlbGltKTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0
eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYmFzaWNfaXN0cmVh
bTxfQ2hhclQsIF9UcmFpdHM+JgogICAgZ2V0bGluZShiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1Ry
YWl0cz4mJiBfX2lzLAogICAgIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4m
IF9fc3RyKQogICAgeyByZXR1cm4gc3RkOjpnZXRsaW5lKF9faXMsIF9fc3RyKTsgfQoKCiAgdGVt
cGxhdGU8PgogICAgYmFzaWNfaXN0cmVhbTxjaGFyPiYKICAgIGdldGxpbmUoYmFzaWNfaXN0cmVh
bTxjaGFyPiYgX19pbiwgYmFzaWNfc3RyaW5nPGNoYXI+JiBfX3N0ciwKICAgICBjaGFyIF9fZGVs
aW0pOwoKCiAgdGVtcGxhdGU8PgogICAgYmFzaWNfaXN0cmVhbTx3Y2hhcl90PiYKICAgIGdldGxp
bmUoYmFzaWNfaXN0cmVhbTx3Y2hhcl90PiYgX19pbiwgYmFzaWNfc3RyaW5nPHdjaGFyX3Q+JiBf
X3N0ciwKICAgICB3Y2hhcl90IF9fZGVsaW0pOwoKCgp9CgoKCiMgMSAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9leHQvc3RyaW5nX2NvbnZlcnNpb25zLmgiIDEgMwojIDMyICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2V4dC9zdHJpbmdfY29udmVyc2lvbnMuaCIgMwogICAgICAgCiMgMzMgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvZXh0L3N0cmluZ19jb252ZXJzaW9ucy5oIiAzCiMgNDEgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvZXh0L3N0cmluZ19jb252ZXJzaW9ucy5oIiAzCiMgMSAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9jc3RkbGliIiAxIDMKIyAzOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9jc3RkbGliIiAzCiAgICAgICAKIyA0MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jc3RkbGli
IiAzCiMgNDIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZXh0L3N0cmluZ19jb252ZXJzaW9ucy5o
IiAyIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2N3Y2hhciIgMSAzCiMgMzkgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvY3djaGFyIiAzCiAgICAgICAKIyA0MCAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9jd2NoYXIiIDMKCgoKCiMgMSAiL3Vzci9pbmNsdWRlL3djaGFyLmgiIDEgMyA0CiMg
NDUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3djaGFyIiAyIDMKIyA0MyAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9leHQvc3RyaW5nX2NvbnZlcnNpb25zLmgiIDIgMwojIDEgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvY3N0ZGlvIiAxIDMKIyAzOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jc3Rk
aW8iIDMKICAgICAgIAojIDQwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2NzdGRpbyIgMwoKCiMg
MSAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDEgMyA0CiMgMjkgIi91c3IvaW5jbHVkZS9zdGRpby5o
IiAzIDQKZXh0ZXJuICJDIiB7CgoKCiMgMSAiL3Vzci9saWIvZ2NjL3MzOTB4LXJlZGhhdC1saW51
eC82LjAuMC9pbmNsdWRlL3N0ZGRlZi5oIiAxIDMgNAojIDM0ICIvdXNyL2luY2x1ZGUvc3RkaW8u
aCIgMiAzIDQKIyA3NCAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDMgNAojIDEgIi91c3IvaW5jbHVk
ZS9saWJpby5oIiAxIDMgNAojIDMxICIvdXNyL2luY2x1ZGUvbGliaW8uaCIgMyA0CiMgMSAiL3Vz
ci9pbmNsdWRlL19HX2NvbmZpZy5oIiAxIDMgNAojIDE1ICIvdXNyL2luY2x1ZGUvX0dfY29uZmln
LmgiIDMgNAojIDEgIi91c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVk
ZS9zdGRkZWYuaCIgMSAzIDQKIyAxNiAiL3Vzci9pbmNsdWRlL19HX2NvbmZpZy5oIiAyIDMgNAoK
CgoKIyAxICIvdXNyL2luY2x1ZGUvd2NoYXIuaCIgMSAzIDQKIyAyMSAiL3Vzci9pbmNsdWRlL19H
X2NvbmZpZy5oIiAyIDMgNAp0eXBlZGVmIHN0cnVjdAp7CiAgX19vZmZfdCBfX3BvczsKICBfX21i
c3RhdGVfdCBfX3N0YXRlOwp9IF9HX2Zwb3NfdDsKdHlwZWRlZiBzdHJ1Y3QKewogIF9fb2ZmNjRf
dCBfX3BvczsKICBfX21ic3RhdGVfdCBfX3N0YXRlOwp9IF9HX2Zwb3M2NF90OwojIDMyICIvdXNy
L2luY2x1ZGUvbGliaW8uaCIgMiAzIDQKIyA0OSAiL3Vzci9pbmNsdWRlL2xpYmlvLmgiIDMgNAoj
IDEgIi91c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVkZS9zdGRhcmcu
aCIgMSAzIDQKIyA1MCAiL3Vzci9pbmNsdWRlL2xpYmlvLmgiIDIgMyA0CiMgMTQ0ICIvdXNyL2lu
Y2x1ZGUvbGliaW8uaCIgMyA0CnN0cnVjdCBfSU9fanVtcF90OyBzdHJ1Y3QgX0lPX0ZJTEU7CgoK
CgoKdHlwZWRlZiB2b2lkIF9JT19sb2NrX3Q7CgoKCgoKc3RydWN0IF9JT19tYXJrZXIgewogIHN0
cnVjdCBfSU9fbWFya2VyICpfbmV4dDsKICBzdHJ1Y3QgX0lPX0ZJTEUgKl9zYnVmOwoKCgogIGlu
dCBfcG9zOwojIDE3MyAiL3Vzci9pbmNsdWRlL2xpYmlvLmgiIDMgNAp9OwoKCmVudW0gX19jb2Rl
Y3Z0X3Jlc3VsdAp7CiAgX19jb2RlY3Z0X29rLAogIF9fY29kZWN2dF9wYXJ0aWFsLAogIF9fY29k
ZWN2dF9lcnJvciwKICBfX2NvZGVjdnRfbm9jb252Cn07CiMgMjQxICIvdXNyL2luY2x1ZGUvbGli
aW8uaCIgMyA0CnN0cnVjdCBfSU9fRklMRSB7CiAgaW50IF9mbGFnczsKCgoKCiAgY2hhciogX0lP
X3JlYWRfcHRyOwogIGNoYXIqIF9JT19yZWFkX2VuZDsKICBjaGFyKiBfSU9fcmVhZF9iYXNlOwog
IGNoYXIqIF9JT193cml0ZV9iYXNlOwogIGNoYXIqIF9JT193cml0ZV9wdHI7CiAgY2hhciogX0lP
X3dyaXRlX2VuZDsKICBjaGFyKiBfSU9fYnVmX2Jhc2U7CiAgY2hhciogX0lPX2J1Zl9lbmQ7Cgog
IGNoYXIgKl9JT19zYXZlX2Jhc2U7CiAgY2hhciAqX0lPX2JhY2t1cF9iYXNlOwogIGNoYXIgKl9J
T19zYXZlX2VuZDsKCiAgc3RydWN0IF9JT19tYXJrZXIgKl9tYXJrZXJzOwoKICBzdHJ1Y3QgX0lP
X0ZJTEUgKl9jaGFpbjsKCiAgaW50IF9maWxlbm87CgoKCiAgaW50IF9mbGFnczI7CgogIF9fb2Zm
X3QgX29sZF9vZmZzZXQ7CgoKCiAgdW5zaWduZWQgc2hvcnQgX2N1cl9jb2x1bW47CiAgc2lnbmVk
IGNoYXIgX3Z0YWJsZV9vZmZzZXQ7CiAgY2hhciBfc2hvcnRidWZbMV07CgoKCiAgX0lPX2xvY2tf
dCAqX2xvY2s7CiMgMjg5ICIvdXNyL2luY2x1ZGUvbGliaW8uaCIgMyA0CiAgX19vZmY2NF90IF9v
ZmZzZXQ7CgoKCgoKCgogIHZvaWQgKl9fcGFkMTsKICB2b2lkICpfX3BhZDI7CiAgdm9pZCAqX19w
YWQzOwogIHZvaWQgKl9fcGFkNDsKCiAgc2l6ZV90IF9fcGFkNTsKICBpbnQgX21vZGU7CgogIGNo
YXIgX3VudXNlZDJbMTUgKiBzaXplb2YgKGludCkgLSA0ICogc2l6ZW9mICh2b2lkICopIC0gc2l6
ZW9mIChzaXplX3QpXTsKCn07CgoKCgoKc3RydWN0IF9JT19GSUxFX3BsdXM7CgpleHRlcm4gc3Ry
dWN0IF9JT19GSUxFX3BsdXMgX0lPXzJfMV9zdGRpbl87CmV4dGVybiBzdHJ1Y3QgX0lPX0ZJTEVf
cGx1cyBfSU9fMl8xX3N0ZG91dF87CmV4dGVybiBzdHJ1Y3QgX0lPX0ZJTEVfcGx1cyBfSU9fMl8x
X3N0ZGVycl87CiMgMzMzICIvdXNyL2luY2x1ZGUvbGliaW8uaCIgMyA0CnR5cGVkZWYgX19zc2l6
ZV90IF9faW9fcmVhZF9mbiAodm9pZCAqX19jb29raWUsIGNoYXIgKl9fYnVmLCBzaXplX3QgX19u
Ynl0ZXMpOwoKCgoKCgoKdHlwZWRlZiBfX3NzaXplX3QgX19pb193cml0ZV9mbiAodm9pZCAqX19j
b29raWUsIGNvbnN0IGNoYXIgKl9fYnVmLAogICAgIHNpemVfdCBfX24pOwoKCgoKCgoKdHlwZWRl
ZiBpbnQgX19pb19zZWVrX2ZuICh2b2lkICpfX2Nvb2tpZSwgX19vZmY2NF90ICpfX3BvcywgaW50
IF9fdyk7CgoKdHlwZWRlZiBpbnQgX19pb19jbG9zZV9mbiAodm9pZCAqX19jb29raWUpOwoKCgoK
dHlwZWRlZiBfX2lvX3JlYWRfZm4gY29va2llX3JlYWRfZnVuY3Rpb25fdDsKdHlwZWRlZiBfX2lv
X3dyaXRlX2ZuIGNvb2tpZV93cml0ZV9mdW5jdGlvbl90Owp0eXBlZGVmIF9faW9fc2Vla19mbiBj
b29raWVfc2Vla19mdW5jdGlvbl90Owp0eXBlZGVmIF9faW9fY2xvc2VfZm4gY29va2llX2Nsb3Nl
X2Z1bmN0aW9uX3Q7CgoKdHlwZWRlZiBzdHJ1Y3QKewogIF9faW9fcmVhZF9mbiAqcmVhZDsKICBf
X2lvX3dyaXRlX2ZuICp3cml0ZTsKICBfX2lvX3NlZWtfZm4gKnNlZWs7CiAgX19pb19jbG9zZV9m
biAqY2xvc2U7Cn0gX0lPX2Nvb2tpZV9pb19mdW5jdGlvbnNfdDsKdHlwZWRlZiBfSU9fY29va2ll
X2lvX2Z1bmN0aW9uc190IGNvb2tpZV9pb19mdW5jdGlvbnNfdDsKCnN0cnVjdCBfSU9fY29va2ll
X2ZpbGU7CgoKZXh0ZXJuIHZvaWQgX0lPX2Nvb2tpZV9pbml0IChzdHJ1Y3QgX0lPX2Nvb2tpZV9m
aWxlICpfX2NmaWxlLCBpbnQgX19yZWFkX3dyaXRlLAogICAgICAgIHZvaWQgKl9fY29va2llLCBf
SU9fY29va2llX2lvX2Z1bmN0aW9uc190IF9fZm5zKTsKCgoKCmV4dGVybiAiQyIgewoKCmV4dGVy
biBpbnQgX191bmRlcmZsb3cgKF9JT19GSUxFICopOwpleHRlcm4gaW50IF9fdWZsb3cgKF9JT19G
SUxFICopOwpleHRlcm4gaW50IF9fb3ZlcmZsb3cgKF9JT19GSUxFICosIGludCk7CiMgNDI5ICIv
dXNyL2luY2x1ZGUvbGliaW8uaCIgMyA0CmV4dGVybiBpbnQgX0lPX2dldGMgKF9JT19GSUxFICpf
X2ZwKTsKZXh0ZXJuIGludCBfSU9fcHV0YyAoaW50IF9fYywgX0lPX0ZJTEUgKl9fZnApOwpleHRl
cm4gaW50IF9JT19mZW9mIChfSU9fRklMRSAqX19mcCkgdGhyb3cgKCk7CmV4dGVybiBpbnQgX0lP
X2ZlcnJvciAoX0lPX0ZJTEUgKl9fZnApIHRocm93ICgpOwoKZXh0ZXJuIGludCBfSU9fcGVla2Nf
bG9ja2VkIChfSU9fRklMRSAqX19mcCk7CgoKCgoKZXh0ZXJuIHZvaWQgX0lPX2Zsb2NrZmlsZSAo
X0lPX0ZJTEUgKikgdGhyb3cgKCk7CmV4dGVybiB2b2lkIF9JT19mdW5sb2NrZmlsZSAoX0lPX0ZJ
TEUgKikgdGhyb3cgKCk7CmV4dGVybiBpbnQgX0lPX2Z0cnlsb2NrZmlsZSAoX0lPX0ZJTEUgKikg
dGhyb3cgKCk7CiMgNDU5ICIvdXNyL2luY2x1ZGUvbGliaW8uaCIgMyA0CmV4dGVybiBpbnQgX0lP
X3Zmc2NhbmYgKF9JT19GSUxFICogX19yZXN0cmljdCwgY29uc3QgY2hhciAqIF9fcmVzdHJpY3Qs
CiAgIF9fZ251Y192YV9saXN0LCBpbnQgKl9fcmVzdHJpY3QpOwpleHRlcm4gaW50IF9JT192ZnBy
aW50ZiAoX0lPX0ZJTEUgKl9fcmVzdHJpY3QsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QsCiAgICBf
X2dudWNfdmFfbGlzdCk7CmV4dGVybiBfX3NzaXplX3QgX0lPX3BhZG4gKF9JT19GSUxFICosIGlu
dCwgX19zc2l6ZV90KTsKZXh0ZXJuIHNpemVfdCBfSU9fc2dldG4gKF9JT19GSUxFICosIHZvaWQg
Kiwgc2l6ZV90KTsKCmV4dGVybiBfX29mZjY0X3QgX0lPX3NlZWtvZmYgKF9JT19GSUxFICosIF9f
b2ZmNjRfdCwgaW50LCBpbnQpOwpleHRlcm4gX19vZmY2NF90IF9JT19zZWVrcG9zIChfSU9fRklM
RSAqLCBfX29mZjY0X3QsIGludCk7CgpleHRlcm4gdm9pZCBfSU9fZnJlZV9iYWNrdXBfYXJlYSAo
X0lPX0ZJTEUgKikgdGhyb3cgKCk7CiMgNTIxICIvdXNyL2luY2x1ZGUvbGliaW8uaCIgMyA0Cn0K
IyA3NSAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDIgMyA0CgoKCgp0eXBlZGVmIF9fZ251Y192YV9s
aXN0IHZhX2xpc3Q7CiMgMTA4ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CgoKdHlwZWRlZiBf
R19mcG9zX3QgZnBvc190OwoKCgoKCnR5cGVkZWYgX0dfZnBvczY0X3QgZnBvczY0X3Q7CiMgMTY0
ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvc3RkaW9f
bGltLmgiIDEgMyA0CiMgMTY1ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMiAzIDQKCgoKZXh0ZXJu
IHN0cnVjdCBfSU9fRklMRSAqc3RkaW47CmV4dGVybiBzdHJ1Y3QgX0lPX0ZJTEUgKnN0ZG91dDsK
ZXh0ZXJuIHN0cnVjdCBfSU9fRklMRSAqc3RkZXJyOwoKCgoKCgoKZXh0ZXJuIGludCByZW1vdmUg
KGNvbnN0IGNoYXIgKl9fZmlsZW5hbWUpIHRocm93ICgpOwoKZXh0ZXJuIGludCByZW5hbWUgKGNv
bnN0IGNoYXIgKl9fb2xkLCBjb25zdCBjaGFyICpfX25ldykgdGhyb3cgKCk7CgoKCgpleHRlcm4g
aW50IHJlbmFtZWF0IChpbnQgX19vbGRmZCwgY29uc3QgY2hhciAqX19vbGQsIGludCBfX25ld2Zk
LAogICAgICAgY29uc3QgY2hhciAqX19uZXcpIHRocm93ICgpOwoKCgoKCgoKCmV4dGVybiBGSUxF
ICp0bXBmaWxlICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykp
OwojIDIwNSAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDMgNApleHRlcm4gRklMRSAqdG1wZmlsZTY0
ICh2b2lkKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgpleHRl
cm4gY2hhciAqdG1wbmFtIChjaGFyICpfX3MpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dh
cm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKZXh0ZXJuIGNoYXIgKnRtcG5hbV9yIChjaGFyICpf
X3MpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CiMg
MjI3ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CmV4dGVybiBjaGFyICp0ZW1wbmFtIChjb25z
dCBjaGFyICpfX2RpciwgY29uc3QgY2hhciAqX19wZngpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1
dGVfXyAoKF9fbWFsbG9jX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRf
XykpOwoKCgoKCgoKCmV4dGVybiBpbnQgZmNsb3NlIChGSUxFICpfX3N0cmVhbSk7CgoKCgpleHRl
cm4gaW50IGZmbHVzaCAoRklMRSAqX19zdHJlYW0pOwoKIyAyNTIgIi91c3IvaW5jbHVkZS9zdGRp
by5oIiAzIDQKZXh0ZXJuIGludCBmZmx1c2hfdW5sb2NrZWQgKEZJTEUgKl9fc3RyZWFtKTsKIyAy
NjIgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAzIDQKZXh0ZXJuIGludCBmY2xvc2VhbGwgKHZvaWQp
OwoKCgoKCgoKCgpleHRlcm4gRklMRSAqZm9wZW4gKGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19m
aWxlbmFtZSwKICAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX21vZGVzKSBfX2F0dHJpYnV0
ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKZXh0ZXJuIEZJTEUgKmZyZW9wZW4g
KGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19maWxlbmFtZSwKICAgICAgICBjb25zdCBjaGFyICpf
X3Jlc3RyaWN0IF9fbW9kZXMsCiAgICAgICAgRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSkgX19h
dHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKIyAyOTUgIi91c3IvaW5jbHVk
ZS9zdGRpby5oIiAzIDQKCgpleHRlcm4gRklMRSAqZm9wZW42NCAoY29uc3QgY2hhciAqX19yZXN0
cmljdCBfX2ZpbGVuYW1lLAogICAgICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19tb2Rlcykg
X19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIEZJTEUgKmZy
ZW9wZW42NCAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2ZpbGVuYW1lLAogICBjb25zdCBjaGFy
ICpfX3Jlc3RyaWN0IF9fbW9kZXMsCiAgIEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0pIF9fYXR0
cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gRklMRSAqZmRv
cGVuIChpbnQgX19mZCwgY29uc3QgY2hhciAqX19tb2RlcykgdGhyb3cgKCkgX19hdHRyaWJ1dGVf
XyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCgpleHRlcm4gRklMRSAqZm9wZW5jb29r
aWUgKHZvaWQgKl9fcmVzdHJpY3QgX19tYWdpY19jb29raWUsCiAgICAgY29uc3QgY2hhciAqX19y
ZXN0cmljdCBfX21vZGVzLAogICAgIF9JT19jb29raWVfaW9fZnVuY3Rpb25zX3QgX19pb19mdW5j
cykgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoK
CmV4dGVybiBGSUxFICpmbWVtb3BlbiAodm9pZCAqX19zLCBzaXplX3QgX19sZW4sIGNvbnN0IGNo
YXIgKl9fbW9kZXMpCiAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVz
dWx0X18pKTsKCgoKCmV4dGVybiBGSUxFICpvcGVuX21lbXN0cmVhbSAoY2hhciAqKl9fYnVmbG9j
LCBzaXplX3QgKl9fc2l6ZWxvYykgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVz
ZWRfcmVzdWx0X18pKTsKCgoKCgoKZXh0ZXJuIHZvaWQgc2V0YnVmIChGSUxFICpfX3Jlc3RyaWN0
IF9fc3RyZWFtLCBjaGFyICpfX3Jlc3RyaWN0IF9fYnVmKSB0aHJvdyAoKTsKCgoKZXh0ZXJuIGlu
dCBzZXR2YnVmIChGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtLCBjaGFyICpfX3Jlc3RyaWN0IF9f
YnVmLAogICAgICBpbnQgX19tb2Rlcywgc2l6ZV90IF9fbikgdGhyb3cgKCk7CgoKCgoKZXh0ZXJu
IHZvaWQgc2V0YnVmZmVyIChGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtLCBjaGFyICpfX3Jlc3Ry
aWN0IF9fYnVmLAogICAgICAgICBzaXplX3QgX19zaXplKSB0aHJvdyAoKTsKCgpleHRlcm4gdm9p
ZCBzZXRsaW5lYnVmIChGSUxFICpfX3N0cmVhbSkgdGhyb3cgKCk7CgoKCgoKCgoKZXh0ZXJuIGlu
dCBmcHJpbnRmIChGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtLAogICAgICBjb25zdCBjaGFyICpf
X3Jlc3RyaWN0IF9fZm9ybWF0LCAuLi4pOwoKCgoKZXh0ZXJuIGludCBwcmludGYgKGNvbnN0IGNo
YXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4uLik7CgpleHRlcm4gaW50IHNwcmludGYgKGNoYXIg
Kl9fcmVzdHJpY3QgX19zLAogICAgICBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCAu
Li4pIHRocm93ICgpOwoKCgoKCmV4dGVybiBpbnQgdmZwcmludGYgKEZJTEUgKl9fcmVzdHJpY3Qg
X19zLCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0LAogICAgICAgX19nbnVjX3ZhX2xp
c3QgX19hcmcpOwoKCgoKZXh0ZXJuIGludCB2cHJpbnRmIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0
IF9fZm9ybWF0LCBfX2dudWNfdmFfbGlzdCBfX2FyZyk7CgpleHRlcm4gaW50IHZzcHJpbnRmIChj
aGFyICpfX3Jlc3RyaWN0IF9fcywgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwKICAg
ICAgIF9fZ251Y192YV9saXN0IF9fYXJnKSB0aHJvdyAoKTsKCgoKCgpleHRlcm4gaW50IHNucHJp
bnRmIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fbWF4bGVuLAogICAgICAgY29uc3Qg
Y2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwgLi4uKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRl
X18gKChfX2Zvcm1hdF9fIChfX3ByaW50Zl9fLCAzLCA0KSkpOwoKZXh0ZXJuIGludCB2c25wcmlu
dGYgKGNoYXIgKl9fcmVzdHJpY3QgX19zLCBzaXplX3QgX19tYXhsZW4sCiAgICAgICAgY29uc3Qg
Y2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwgX19nbnVjX3ZhX2xpc3QgX19hcmcpCiAgICAgdGhy
b3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fZm9ybWF0X18gKF9fcHJpbnRmX18sIDMsIDApKSk7CgoK
CgoKCmV4dGVybiBpbnQgdmFzcHJpbnRmIChjaGFyICoqX19yZXN0cmljdCBfX3B0ciwgY29uc3Qg
Y2hhciAqX19yZXN0cmljdCBfX2YsCiAgICAgICAgX19nbnVjX3ZhX2xpc3QgX19hcmcpCiAgICAg
dGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fZm9ybWF0X18gKF9fcHJpbnRmX18sIDIsIDApKSkg
X19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIGludCBfX2Fz
cHJpbnRmIChjaGFyICoqX19yZXN0cmljdCBfX3B0ciwKICAgICAgICAgY29uc3QgY2hhciAqX19y
ZXN0cmljdCBfX2ZtdCwgLi4uKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX2Zvcm1h
dF9fIChfX3ByaW50Zl9fLCAyLCAzKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jl
c3VsdF9fKSk7CmV4dGVybiBpbnQgYXNwcmludGYgKGNoYXIgKipfX3Jlc3RyaWN0IF9fcHRyLAog
ICAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2ZtdCwgLi4uKQogICAgIHRocm93ICgpIF9f
YXR0cmlidXRlX18gKChfX2Zvcm1hdF9fIChfX3ByaW50Zl9fLCAyLCAzKSkpIF9fYXR0cmlidXRl
X18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gaW50IHZkcHJpbnRmIChp
bnQgX19mZCwgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2ZtdCwKICAgICAgIF9fZ251Y192YV9s
aXN0IF9fYXJnKQogICAgIF9fYXR0cmlidXRlX18gKChfX2Zvcm1hdF9fIChfX3ByaW50Zl9fLCAy
LCAwKSkpOwpleHRlcm4gaW50IGRwcmludGYgKGludCBfX2ZkLCBjb25zdCBjaGFyICpfX3Jlc3Ry
aWN0IF9fZm10LCAuLi4pCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fZm9ybWF0X18gKF9fcHJpbnRm
X18sIDIsIDMpKSk7CgoKCgoKCgoKZXh0ZXJuIGludCBmc2NhbmYgKEZJTEUgKl9fcmVzdHJpY3Qg
X19zdHJlYW0sCiAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwgLi4uKSBfX2F0
dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKZXh0ZXJuIGludCBzY2Fu
ZiAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwgLi4uKSBfX2F0dHJpYnV0ZV9fICgo
X193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKZXh0ZXJuIGludCBzc2NhbmYgKGNvbnN0IGNoYXIg
Kl9fcmVzdHJpY3QgX19zLAogICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4u
LikgdGhyb3cgKCk7CiMgNDYzICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CgoKCgoKCgoKZXh0
ZXJuIGludCB2ZnNjYW5mIChGSUxFICpfX3Jlc3RyaWN0IF9fcywgY29uc3QgY2hhciAqX19yZXN0
cmljdCBfX2Zvcm1hdCwKICAgICAgX19nbnVjX3ZhX2xpc3QgX19hcmcpCiAgICAgX19hdHRyaWJ1
dGVfXyAoKF9fZm9ybWF0X18gKF9fc2NhbmZfXywgMiwgMCkpKSBfX2F0dHJpYnV0ZV9fICgoX193
YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKCmV4dGVybiBpbnQgdnNjYW5mIChjb25zdCBjaGFy
ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCBfX2dudWNfdmFfbGlzdCBfX2FyZykKICAgICBfX2F0dHJp
YnV0ZV9fICgoX19mb3JtYXRfXyAoX19zY2FuZl9fLCAxLCAwKSkpIF9fYXR0cmlidXRlX18gKChf
X3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKZXh0ZXJuIGludCB2c3NjYW5mIChjb25zdCBjaGFy
ICpfX3Jlc3RyaWN0IF9fcywKICAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwg
X19nbnVjX3ZhX2xpc3QgX19hcmcpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fZm9y
bWF0X18gKF9fc2NhbmZfXywgMiwgMCkpKTsKIyA1MjIgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAz
IDQKCgoKCgoKCgoKZXh0ZXJuIGludCBmZ2V0YyAoRklMRSAqX19zdHJlYW0pOwpleHRlcm4gaW50
IGdldGMgKEZJTEUgKl9fc3RyZWFtKTsKCgoKCgpleHRlcm4gaW50IGdldGNoYXIgKHZvaWQpOwoK
IyA1NTAgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAzIDQKZXh0ZXJuIGludCBnZXRjX3VubG9ja2Vk
IChGSUxFICpfX3N0cmVhbSk7CmV4dGVybiBpbnQgZ2V0Y2hhcl91bmxvY2tlZCAodm9pZCk7CiMg
NTYxICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CmV4dGVybiBpbnQgZmdldGNfdW5sb2NrZWQg
KEZJTEUgKl9fc3RyZWFtKTsKCgoKCgoKCgoKCgpleHRlcm4gaW50IGZwdXRjIChpbnQgX19jLCBG
SUxFICpfX3N0cmVhbSk7CmV4dGVybiBpbnQgcHV0YyAoaW50IF9fYywgRklMRSAqX19zdHJlYW0p
OwoKCgoKCmV4dGVybiBpbnQgcHV0Y2hhciAoaW50IF9fYyk7CgojIDU5NCAiL3Vzci9pbmNsdWRl
L3N0ZGlvLmgiIDMgNApleHRlcm4gaW50IGZwdXRjX3VubG9ja2VkIChpbnQgX19jLCBGSUxFICpf
X3N0cmVhbSk7CgoKCgoKCgpleHRlcm4gaW50IHB1dGNfdW5sb2NrZWQgKGludCBfX2MsIEZJTEUg
Kl9fc3RyZWFtKTsKZXh0ZXJuIGludCBwdXRjaGFyX3VubG9ja2VkIChpbnQgX19jKTsKCgoKCgoK
ZXh0ZXJuIGludCBnZXR3IChGSUxFICpfX3N0cmVhbSk7CgoKZXh0ZXJuIGludCBwdXR3IChpbnQg
X193LCBGSUxFICpfX3N0cmVhbSk7CgoKCgoKCgoKZXh0ZXJuIGNoYXIgKmZnZXRzIChjaGFyICpf
X3Jlc3RyaWN0IF9fcywgaW50IF9fbiwgRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSkKICAgICBf
X2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDYzOCAiL3Vzci9pbmNs
dWRlL3N0ZGlvLmgiIDMgNApleHRlcm4gY2hhciAqZ2V0cyAoY2hhciAqX19zKSBfX2F0dHJpYnV0
ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIF9fYXR0cmlidXRlX18gKChfX2RlcHJlY2F0
ZWRfXykpOwoKCiMgNjQ5ICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CmV4dGVybiBjaGFyICpm
Z2V0c191bmxvY2tlZCAoY2hhciAqX19yZXN0cmljdCBfX3MsIGludCBfX24sCiAgICAgICAgRklM
RSAqX19yZXN0cmljdCBfX3N0cmVhbSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVz
dWx0X18pKTsKIyA2NjUgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAzIDQKZXh0ZXJuIF9fc3NpemVf
dCBfX2dldGRlbGltIChjaGFyICoqX19yZXN0cmljdCBfX2xpbmVwdHIsCiAgICAgICAgICBzaXpl
X3QgKl9fcmVzdHJpY3QgX19uLCBpbnQgX19kZWxpbWl0ZXIsCiAgICAgICAgICBGSUxFICpfX3Jl
c3RyaWN0IF9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykp
OwpleHRlcm4gX19zc2l6ZV90IGdldGRlbGltIChjaGFyICoqX19yZXN0cmljdCBfX2xpbmVwdHIs
CiAgICAgICAgc2l6ZV90ICpfX3Jlc3RyaWN0IF9fbiwgaW50IF9fZGVsaW1pdGVyLAogICAgICAg
IEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0pIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2Vk
X3Jlc3VsdF9fKSk7CgoKCgoKCgpleHRlcm4gX19zc2l6ZV90IGdldGxpbmUgKGNoYXIgKipfX3Jl
c3RyaWN0IF9fbGluZXB0ciwKICAgICAgIHNpemVfdCAqX19yZXN0cmljdCBfX24sCiAgICAgICBG
SUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9y
ZXN1bHRfXykpOwoKCgoKCgoKCmV4dGVybiBpbnQgZnB1dHMgKGNvbnN0IGNoYXIgKl9fcmVzdHJp
Y3QgX19zLCBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKTsKCgoKCgpleHRlcm4gaW50IHB1dHMg
KGNvbnN0IGNoYXIgKl9fcyk7CgoKCgoKCmV4dGVybiBpbnQgdW5nZXRjIChpbnQgX19jLCBGSUxF
ICpfX3N0cmVhbSk7CgoKCgoKCmV4dGVybiBzaXplX3QgZnJlYWQgKHZvaWQgKl9fcmVzdHJpY3Qg
X19wdHIsIHNpemVfdCBfX3NpemUsCiAgICAgICBzaXplX3QgX19uLCBGSUxFICpfX3Jlc3RyaWN0
IF9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoK
ZXh0ZXJuIHNpemVfdCBmd3JpdGUgKGNvbnN0IHZvaWQgKl9fcmVzdHJpY3QgX19wdHIsIHNpemVf
dCBfX3NpemUsCiAgICAgICAgc2l6ZV90IF9fbiwgRklMRSAqX19yZXN0cmljdCBfX3MpOwoKIyA3
MjYgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAzIDQKZXh0ZXJuIGludCBmcHV0c191bmxvY2tlZCAo
Y29uc3QgY2hhciAqX19yZXN0cmljdCBfX3MsCiAgICAgIEZJTEUgKl9fcmVzdHJpY3QgX19zdHJl
YW0pOwojIDczNyAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDMgNApleHRlcm4gc2l6ZV90IGZyZWFk
X3VubG9ja2VkICh2b2lkICpfX3Jlc3RyaWN0IF9fcHRyLCBzaXplX3QgX19zaXplLAogICAgICAg
ICBzaXplX3QgX19uLCBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2F0dHJpYnV0ZV9fICgo
X193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gc2l6ZV90IGZ3cml0ZV91bmxvY2tlZCAo
Y29uc3Qgdm9pZCAqX19yZXN0cmljdCBfX3B0ciwgc2l6ZV90IF9fc2l6ZSwKICAgICAgICAgIHNp
emVfdCBfX24sIEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0pOwoKCgoKCgoKCmV4dGVybiBpbnQg
ZnNlZWsgKEZJTEUgKl9fc3RyZWFtLCBsb25nIGludCBfX29mZiwgaW50IF9fd2hlbmNlKTsKCgoK
CmV4dGVybiBsb25nIGludCBmdGVsbCAoRklMRSAqX19zdHJlYW0pIF9fYXR0cmlidXRlX18gKChf
X3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gdm9pZCByZXdpbmQgKEZJTEUgKl9f
c3RyZWFtKTsKCiMgNzczICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CmV4dGVybiBpbnQgZnNl
ZWtvIChGSUxFICpfX3N0cmVhbSwgX19vZmZfdCBfX29mZiwgaW50IF9fd2hlbmNlKTsKCgoKCmV4
dGVybiBfX29mZl90IGZ0ZWxsbyAoRklMRSAqX19zdHJlYW0pIF9fYXR0cmlidXRlX18gKChfX3dh
cm5fdW51c2VkX3Jlc3VsdF9fKSk7CiMgNzkyICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CgoK
CgoKCmV4dGVybiBpbnQgZmdldHBvcyAoRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSwgZnBvc190
ICpfX3Jlc3RyaWN0IF9fcG9zKTsKCgoKCmV4dGVybiBpbnQgZnNldHBvcyAoRklMRSAqX19zdHJl
YW0sIGNvbnN0IGZwb3NfdCAqX19wb3MpOwojIDgxNSAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDMg
NAoKCgpleHRlcm4gaW50IGZzZWVrbzY0IChGSUxFICpfX3N0cmVhbSwgX19vZmY2NF90IF9fb2Zm
LCBpbnQgX193aGVuY2UpOwpleHRlcm4gX19vZmY2NF90IGZ0ZWxsbzY0IChGSUxFICpfX3N0cmVh
bSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIGludCBm
Z2V0cG9zNjQgKEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0sIGZwb3M2NF90ICpfX3Jlc3RyaWN0
IF9fcG9zKTsKZXh0ZXJuIGludCBmc2V0cG9zNjQgKEZJTEUgKl9fc3RyZWFtLCBjb25zdCBmcG9z
NjRfdCAqX19wb3MpOwoKCgoKZXh0ZXJuIHZvaWQgY2xlYXJlcnIgKEZJTEUgKl9fc3RyZWFtKSB0
aHJvdyAoKTsKCmV4dGVybiBpbnQgZmVvZiAoRklMRSAqX19zdHJlYW0pIHRocm93ICgpIF9fYXR0
cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgpleHRlcm4gaW50IGZlcnJvciAo
RklMRSAqX19zdHJlYW0pIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jl
c3VsdF9fKSk7CgoKCgpleHRlcm4gdm9pZCBjbGVhcmVycl91bmxvY2tlZCAoRklMRSAqX19zdHJl
YW0pIHRocm93ICgpOwpleHRlcm4gaW50IGZlb2ZfdW5sb2NrZWQgKEZJTEUgKl9fc3RyZWFtKSB0
aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4g
aW50IGZlcnJvcl91bmxvY2tlZCAoRklMRSAqX19zdHJlYW0pIHRocm93ICgpIF9fYXR0cmlidXRl
X18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKCgoKZXh0ZXJuIHZvaWQgcGVycm9y
IChjb25zdCBjaGFyICpfX3MpOwoKCgoKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3N5c19lcnJs
aXN0LmgiIDEgMyA0CiMgMjYgIi91c3IvaW5jbHVkZS9iaXRzL3N5c19lcnJsaXN0LmgiIDMgNApl
eHRlcm4gaW50IHN5c19uZXJyOwpleHRlcm4gY29uc3QgY2hhciAqY29uc3Qgc3lzX2Vycmxpc3Rb
XTsKCgpleHRlcm4gaW50IF9zeXNfbmVycjsKZXh0ZXJuIGNvbnN0IGNoYXIgKmNvbnN0IF9zeXNf
ZXJybGlzdFtdOwojIDg1NCAiL3Vzci9pbmNsdWRlL3N0ZGlvLmgiIDIgMyA0CgoKCgpleHRlcm4g
aW50IGZpbGVubyAoRklMRSAqX19zdHJlYW0pIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dh
cm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gaW50IGZpbGVub191bmxvY2tlZCAoRklM
RSAqX19zdHJlYW0pIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3Vs
dF9fKSk7CiMgODcyICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CmV4dGVybiBGSUxFICpwb3Bl
biAoY29uc3QgY2hhciAqX19jb21tYW5kLCBjb25zdCBjaGFyICpfX21vZGVzKSBfX2F0dHJpYnV0
ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKCmV4dGVybiBpbnQgcGNsb3NlIChG
SUxFICpfX3N0cmVhbSk7CgoKCgoKZXh0ZXJuIGNoYXIgKmN0ZXJtaWQgKGNoYXIgKl9fcykgdGhy
b3cgKCk7CgoKCgoKZXh0ZXJuIGNoYXIgKmN1c2VyaWQgKGNoYXIgKl9fcyk7CgoKCgpzdHJ1Y3Qg
b2JzdGFjazsKCgpleHRlcm4gaW50IG9ic3RhY2tfcHJpbnRmIChzdHJ1Y3Qgb2JzdGFjayAqX19y
ZXN0cmljdCBfX29ic3RhY2ssCiAgICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQs
IC4uLikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19mb3JtYXRfXyAoX19wcmludGZf
XywgMiwgMykpKTsKZXh0ZXJuIGludCBvYnN0YWNrX3ZwcmludGYgKHN0cnVjdCBvYnN0YWNrICpf
X3Jlc3RyaWN0IF9fb2JzdGFjaywKICAgICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3Jt
YXQsCiAgICAgICBfX2dudWNfdmFfbGlzdCBfX2FyZ3MpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1
dGVfXyAoKF9fZm9ybWF0X18gKF9fcHJpbnRmX18sIDIsIDApKSk7CgoKCgoKCgpleHRlcm4gdm9p
ZCBmbG9ja2ZpbGUgKEZJTEUgKl9fc3RyZWFtKSB0aHJvdyAoKTsKCgoKZXh0ZXJuIGludCBmdHJ5
bG9ja2ZpbGUgKEZJTEUgKl9fc3RyZWFtKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX193YXJu
X3VudXNlZF9yZXN1bHRfXykpOwoKCmV4dGVybiB2b2lkIGZ1bmxvY2tmaWxlIChGSUxFICpfX3N0
cmVhbSkgdGhyb3cgKCk7CiMgOTMzICIvdXNyL2luY2x1ZGUvc3RkaW8uaCIgMyA0CiMgMSAiL3Vz
ci9pbmNsdWRlL2JpdHMvc3RkaW8uaCIgMSAzIDQKIyA0MyAiL3Vzci9pbmNsdWRlL2JpdHMvc3Rk
aW8uaCIgMyA0CmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18p
KSBpbnQKZ2V0Y2hhciAodm9pZCkKewogIHJldHVybiBfSU9fZ2V0YyAoc3RkaW4pOwp9CgoKCgpl
eHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgaW50CmZnZXRj
X3VubG9ja2VkIChGSUxFICpfX2ZwKQp7CiAgcmV0dXJuIChfX2J1aWx0aW5fZXhwZWN0ICgoKF9f
ZnApLT5fSU9fcmVhZF9wdHIgPj0gKF9fZnApLT5fSU9fcmVhZF9lbmQpLCAwKSA/IF9fdWZsb3cg
KF9fZnApIDogKih1bnNpZ25lZCBjaGFyICopIChfX2ZwKS0+X0lPX3JlYWRfcHRyKyspOwp9CgoK
CgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGludApn
ZXRjX3VubG9ja2VkIChGSUxFICpfX2ZwKQp7CiAgcmV0dXJuIChfX2J1aWx0aW5fZXhwZWN0ICgo
KF9fZnApLT5fSU9fcmVhZF9wdHIgPj0gKF9fZnApLT5fSU9fcmVhZF9lbmQpLCAwKSA/IF9fdWZs
b3cgKF9fZnApIDogKih1bnNpZ25lZCBjaGFyICopIChfX2ZwKS0+X0lPX3JlYWRfcHRyKyspOwp9
CgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGludApn
ZXRjaGFyX3VubG9ja2VkICh2b2lkKQp7CiAgcmV0dXJuIChfX2J1aWx0aW5fZXhwZWN0ICgoKHN0
ZGluKS0+X0lPX3JlYWRfcHRyID49IChzdGRpbiktPl9JT19yZWFkX2VuZCksIDApID8gX191Zmxv
dyAoc3RkaW4pIDogKih1bnNpZ25lZCBjaGFyICopIChzdGRpbiktPl9JT19yZWFkX3B0cisrKTsK
fQoKCgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIGlu
dApwdXRjaGFyIChpbnQgX19jKQp7CiAgcmV0dXJuIF9JT19wdXRjIChfX2MsIHN0ZG91dCk7Cn0K
CgoKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBpbnQK
ZnB1dGNfdW5sb2NrZWQgKGludCBfX2MsIEZJTEUgKl9fc3RyZWFtKQp7CiAgcmV0dXJuIChfX2J1
aWx0aW5fZXhwZWN0ICgoKF9fc3RyZWFtKS0+X0lPX3dyaXRlX3B0ciA+PSAoX19zdHJlYW0pLT5f
SU9fd3JpdGVfZW5kKSwgMCkgPyBfX292ZXJmbG93IChfX3N0cmVhbSwgKHVuc2lnbmVkIGNoYXIp
IChfX2MpKSA6ICh1bnNpZ25lZCBjaGFyKSAoKihfX3N0cmVhbSktPl9JT193cml0ZV9wdHIrKyA9
IChfX2MpKSk7Cn0KCgoKCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lu
bGluZV9fKSkgaW50CnB1dGNfdW5sb2NrZWQgKGludCBfX2MsIEZJTEUgKl9fc3RyZWFtKQp7CiAg
cmV0dXJuIChfX2J1aWx0aW5fZXhwZWN0ICgoKF9fc3RyZWFtKS0+X0lPX3dyaXRlX3B0ciA+PSAo
X19zdHJlYW0pLT5fSU9fd3JpdGVfZW5kKSwgMCkgPyBfX292ZXJmbG93IChfX3N0cmVhbSwgKHVu
c2lnbmVkIGNoYXIpIChfX2MpKSA6ICh1bnNpZ25lZCBjaGFyKSAoKihfX3N0cmVhbSktPl9JT193
cml0ZV9wdHIrKyA9IChfX2MpKSk7Cn0KCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAo
KF9fZ251X2lubGluZV9fKSkgaW50CnB1dGNoYXJfdW5sb2NrZWQgKGludCBfX2MpCnsKICByZXR1
cm4gKF9fYnVpbHRpbl9leHBlY3QgKCgoc3Rkb3V0KS0+X0lPX3dyaXRlX3B0ciA+PSAoc3Rkb3V0
KS0+X0lPX3dyaXRlX2VuZCksIDApID8gX19vdmVyZmxvdyAoc3Rkb3V0LCAodW5zaWduZWQgY2hh
cikgKF9fYykpIDogKHVuc2lnbmVkIGNoYXIpICgqKHN0ZG91dCktPl9JT193cml0ZV9wdHIrKyA9
IChfX2MpKSk7Cn0KCgoKCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lu
bGluZV9fKSkgX19zc2l6ZV90CmdldGxpbmUgKGNoYXIgKipfX2xpbmVwdHIsIHNpemVfdCAqX19u
LCBGSUxFICpfX3N0cmVhbSkKewogIHJldHVybiBfX2dldGRlbGltIChfX2xpbmVwdHIsIF9fbiwg
J1xuJywgX19zdHJlYW0pOwp9CgoKCgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChf
X2dudV9pbmxpbmVfXykpIGludApfX2F0dHJpYnV0ZV9fICgoX19sZWFmX18pKSBmZW9mX3VubG9j
a2VkIChGSUxFICpfX3N0cmVhbSkgdGhyb3cgKCkKewogIHJldHVybiAoKChfX3N0cmVhbSktPl9m
bGFncyAmIDB4MTApICE9IDApOwp9CgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChf
X2dudV9pbmxpbmVfXykpIGludApfX2F0dHJpYnV0ZV9fICgoX19sZWFmX18pKSBmZXJyb3JfdW5s
b2NrZWQgKEZJTEUgKl9fc3RyZWFtKSB0aHJvdyAoKQp7CiAgcmV0dXJuICgoKF9fc3RyZWFtKS0+
X2ZsYWdzICYgMHgyMCkgIT0gMCk7Cn0KIyA5MzQgIi91c3IvaW5jbHVkZS9zdGRpby5oIiAyIDMg
NAoKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvc3RkaW8yLmgiIDEgMyA0CiMgMjMgIi91c3IvaW5j
bHVkZS9iaXRzL3N0ZGlvMi5oIiAzIDQKZXh0ZXJuIGludCBfX3NwcmludGZfY2hrIChjaGFyICpf
X3Jlc3RyaWN0IF9fcywgaW50IF9fZmxhZywgc2l6ZV90IF9fc2xlbiwKICAgICBjb25zdCBjaGFy
ICpfX3Jlc3RyaWN0IF9fZm9ybWF0LCAuLi4pIHRocm93ICgpOwpleHRlcm4gaW50IF9fdnNwcmlu
dGZfY2hrIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgaW50IF9fZmxhZywgc2l6ZV90IF9fc2xlbiwK
ICAgICAgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwKICAgICAgX19nbnVjX3ZhX2xp
c3QgX19hcCkgdGhyb3cgKCk7CgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fs
d2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18gKChfX2FydGlmaWNpYWxfXykpIGludApfX2F0dHJpYnV0ZV9fICgoX19sZWFmX18pKSBz
cHJpbnRmIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zt
dCwgLi4uKSB0aHJvdyAoKQp7CiAgcmV0dXJuIF9fYnVpbHRpbl9fX3NwcmludGZfY2hrIChfX3Ms
IDIgLSAxLAogICAgICBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcywgMiA+IDEpLCBfX2ZtdCwg
X19idWlsdGluX3ZhX2FyZ19wYWNrICgpKTsKfQoKCgoKCgpleHRlcm4gX19pbmxpbmUgX19hdHRy
aWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgaW50Cl9fYXR0cmlidXRlX18g
KChfX2xlYWZfXykpIHZzcHJpbnRmIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgY29uc3QgY2hhciAq
X19yZXN0cmljdCBfX2ZtdCwgX19nbnVjX3ZhX2xpc3QgX19hcCkgdGhyb3cgKCkKCnsKICByZXR1
cm4gX19idWlsdGluX19fdnNwcmludGZfY2hrIChfX3MsIDIgLSAxLAogICAgICAgX19idWlsdGlu
X29iamVjdF9zaXplIChfX3MsIDIgPiAxKSwgX19mbXQsIF9fYXApOwp9CgoKCmV4dGVybiBpbnQg
X19zbnByaW50Zl9jaGsgKGNoYXIgKl9fcmVzdHJpY3QgX19zLCBzaXplX3QgX19uLCBpbnQgX19m
bGFnLAogICAgICBzaXplX3QgX19zbGVuLCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0
LAogICAgICAuLi4pIHRocm93ICgpOwpleHRlcm4gaW50IF9fdnNucHJpbnRmX2NoayAoY2hhciAq
X19yZXN0cmljdCBfX3MsIHNpemVfdCBfX24sIGludCBfX2ZsYWcsCiAgICAgICBzaXplX3QgX19z
bGVuLCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm9ybWF0LAogICAgICAgX19nbnVjX3ZhX2xp
c3QgX19hcCkgdGhyb3cgKCk7CgoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fs
d2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18gKChfX2FydGlmaWNpYWxfXykpIGludApfX2F0dHJpYnV0ZV9fICgoX19sZWFmX18pKSBz
bnByaW50ZiAoY2hhciAqX19yZXN0cmljdCBfX3MsIHNpemVfdCBfX24sIGNvbnN0IGNoYXIgKl9f
cmVzdHJpY3QgX19mbXQsIC4uLikgdGhyb3cgKCkKCnsKICByZXR1cm4gX19idWlsdGluX19fc25w
cmludGZfY2hrIChfX3MsIF9fbiwgMiAtIDEsCiAgICAgICBfX2J1aWx0aW5fb2JqZWN0X3NpemUg
KF9fcywgMiA+IDEpLCBfX2ZtdCwgX19idWlsdGluX3ZhX2FyZ19wYWNrICgpKTsKfQoKCgoKCgpl
eHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9f
KSkgaW50Cl9fYXR0cmlidXRlX18gKChfX2xlYWZfXykpIHZzbnByaW50ZiAoY2hhciAqX19yZXN0
cmljdCBfX3MsIHNpemVfdCBfX24sIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mbXQsIF9fZ251
Y192YV9saXN0IF9fYXApIHRocm93ICgpCgp7CiAgcmV0dXJuIF9fYnVpbHRpbl9fX3ZzbnByaW50
Zl9jaGsgKF9fcywgX19uLCAyIC0gMSwKICAgICAgICBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9f
cywgMiA+IDEpLCBfX2ZtdCwgX19hcCk7Cn0KCgoKCgpleHRlcm4gaW50IF9fZnByaW50Zl9jaGsg
KEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0sIGludCBfX2ZsYWcsCiAgICAgY29uc3QgY2hhciAq
X19yZXN0cmljdCBfX2Zvcm1hdCwgLi4uKTsKZXh0ZXJuIGludCBfX3ByaW50Zl9jaGsgKGludCBf
X2ZsYWcsIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsIC4uLik7CmV4dGVybiBpbnQg
X192ZnByaW50Zl9jaGsgKEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0sIGludCBfX2ZsYWcsCiAg
ICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsIF9fZ251Y192YV9saXN0IF9fYXAp
OwpleHRlcm4gaW50IF9fdnByaW50Zl9jaGsgKGludCBfX2ZsYWcsIGNvbnN0IGNoYXIgKl9fcmVz
dHJpY3QgX19mb3JtYXQsCiAgICAgX19nbnVjX3ZhX2xpc3QgX19hcCk7CgoKZXh0ZXJuIF9faW5s
aW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChf
X2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGludApmcHJp
bnRmIChGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtLCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9f
Zm10LCAuLi4pCnsKICByZXR1cm4gX19mcHJpbnRmX2NoayAoX19zdHJlYW0sIDIgLSAxLCBfX2Zt
dCwKICAgX19idWlsdGluX3ZhX2FyZ19wYWNrICgpKTsKfQoKZXh0ZXJuIF9faW5saW5lIF9fYXR0
cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGludApwcmludGYgKGNvbnN0
IGNoYXIgKl9fcmVzdHJpY3QgX19mbXQsIC4uLikKewogIHJldHVybiBfX3ByaW50Zl9jaGsgKDIg
LSAxLCBfX2ZtdCwgX19idWlsdGluX3ZhX2FyZ19wYWNrICgpKTsKfQoKCgoKCgoKZXh0ZXJuIF9f
aW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18g
KChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGludAp2
cHJpbnRmIChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm10LCBfX2dudWNfdmFfbGlzdCBfX2Fw
KQp7CgogIHJldHVybiBfX3ZmcHJpbnRmX2NoayAoc3Rkb3V0LCAyIC0gMSwgX19mbXQsIF9fYXAp
OwoKCgp9CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9f
KSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0
aWZpY2lhbF9fKSkgaW50CnZmcHJpbnRmIChGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtLAogICBj
b25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm10LCBfX2dudWNfdmFfbGlzdCBfX2FwKQp7CiAgcmV0
dXJuIF9fdmZwcmludGZfY2hrIChfX3N0cmVhbSwgMiAtIDEsIF9fZm10LCBfX2FwKTsKfQoKCmV4
dGVybiBpbnQgX19kcHJpbnRmX2NoayAoaW50IF9fZmQsIGludCBfX2ZsYWcsIGNvbnN0IGNoYXIg
Kl9fcmVzdHJpY3QgX19mbXQsCiAgICAgLi4uKSBfX2F0dHJpYnV0ZV9fICgoX19mb3JtYXRfXyAo
X19wcmludGZfXywgMywgNCkpKTsKZXh0ZXJuIGludCBfX3ZkcHJpbnRmX2NoayAoaW50IF9fZmQs
IGludCBfX2ZsYWcsCiAgICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mbXQsIF9fZ251Y192
YV9saXN0IF9fYXJnKQogICAgIF9fYXR0cmlidXRlX18gKChfX2Zvcm1hdF9fIChfX3ByaW50Zl9f
LCAzLCAwKSkpOwoKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgo
X19hcnRpZmljaWFsX18pKSBpbnQKZHByaW50ZiAoaW50IF9fZmQsIGNvbnN0IGNoYXIgKl9fcmVz
dHJpY3QgX19mbXQsIC4uLikKewogIHJldHVybiBfX2RwcmludGZfY2hrIChfX2ZkLCAyIC0gMSwg
X19mbXQsCiAgIF9fYnVpbHRpbl92YV9hcmdfcGFjayAoKSk7Cn0KCgoKCgpleHRlcm4gX19pbmxp
bmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f
Z251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgaW50CnZkcHJp
bnRmIChpbnQgX19mZCwgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2ZtdCwgX19nbnVjX3ZhX2xp
c3QgX19hcCkKewogIHJldHVybiBfX3ZkcHJpbnRmX2NoayAoX19mZCwgMiAtIDEsIF9fZm10LCBf
X2FwKTsKfQoKCgoKZXh0ZXJuIGludCBfX2FzcHJpbnRmX2NoayAoY2hhciAqKl9fcmVzdHJpY3Qg
X19wdHIsIGludCBfX2ZsYWcsCiAgICAgIGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mbXQsIC4u
LikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19mb3JtYXRfXyAoX19wcmludGZfXywg
MywgNCkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4g
aW50IF9fdmFzcHJpbnRmX2NoayAoY2hhciAqKl9fcmVzdHJpY3QgX19wdHIsIGludCBfX2ZsYWcs
CiAgICAgICBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZm10LCBfX2dudWNfdmFfbGlzdCBfX2Fy
ZykKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19mb3JtYXRfXyAoX19wcmludGZfXywg
MywgMCkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4g
aW50IF9fb2JzdGFja19wcmludGZfY2hrIChzdHJ1Y3Qgb2JzdGFjayAqX19yZXN0cmljdCBfX29i
c3RhY2ssCiAgICAgaW50IF9fZmxhZywgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2Zvcm1hdCwK
ICAgICAuLi4pCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fZm9ybWF0X18gKF9fcHJp
bnRmX18sIDMsIDQpKSk7CmV4dGVybiBpbnQgX19vYnN0YWNrX3ZwcmludGZfY2hrIChzdHJ1Y3Qg
b2JzdGFjayAqX19yZXN0cmljdCBfX29ic3RhY2ssCiAgICAgIGludCBfX2ZsYWcsCiAgICAgIGNv
bnN0IGNoYXIgKl9fcmVzdHJpY3QgX19mb3JtYXQsCiAgICAgIF9fZ251Y192YV9saXN0IF9fYXJn
cykKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19mb3JtYXRfXyAoX19wcmludGZfXywg
MywgMCkpKTsKCgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f
YXJ0aWZpY2lhbF9fKSkgaW50Cl9fYXR0cmlidXRlX18gKChfX2xlYWZfXykpIGFzcHJpbnRmIChj
aGFyICoqX19yZXN0cmljdCBfX3B0ciwgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2ZtdCwgLi4u
KSB0aHJvdyAoKQp7CiAgcmV0dXJuIF9fYXNwcmludGZfY2hrIChfX3B0ciwgMiAtIDEsIF9fZm10
LAogICAgX19idWlsdGluX3ZhX2FyZ19wYWNrICgpKTsKfQoKZXh0ZXJuIF9faW5saW5lIF9fYXR0
cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIGludApfX2F0dHJpYnV0ZV9f
ICgoX19sZWFmX18pKSBfX2FzcHJpbnRmIChjaGFyICoqX19yZXN0cmljdCBfX3B0ciwgY29uc3Qg
Y2hhciAqX19yZXN0cmljdCBfX2ZtdCwgLi4uKSB0aHJvdyAoKQoKewogIHJldHVybiBfX2FzcHJp
bnRmX2NoayAoX19wdHIsIDIgLSAxLCBfX2ZtdCwKICAgIF9fYnVpbHRpbl92YV9hcmdfcGFjayAo
KSk7Cn0KCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18p
KSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRp
ZmljaWFsX18pKSBpbnQKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkgb2JzdGFja19wcmludGYg
KHN0cnVjdCBvYnN0YWNrICpfX3Jlc3RyaWN0IF9fb2JzdGFjaywgY29uc3QgY2hhciAqX19yZXN0
cmljdCBfX2ZtdCwgLi4uKSB0aHJvdyAoKQoKewogIHJldHVybiBfX29ic3RhY2tfcHJpbnRmX2No
ayAoX19vYnN0YWNrLCAyIC0gMSwgX19mbXQsCiAgICAgICAgICBfX2J1aWx0aW5fdmFfYXJnX3Bh
Y2sgKCkpOwp9CiMgMjA2ICIvdXNyL2luY2x1ZGUvYml0cy9zdGRpbzIuaCIgMyA0CmV4dGVybiBf
X2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9f
ICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBpbnQK
X19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkgdmFzcHJpbnRmIChjaGFyICoqX19yZXN0cmljdCBf
X3B0ciwgY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2ZtdCwgX19nbnVjX3ZhX2xpc3QgX19hcCkg
dGhyb3cgKCkKCnsKICByZXR1cm4gX192YXNwcmludGZfY2hrIChfX3B0ciwgMiAtIDEsIF9fZm10
LCBfX2FwKTsKfQoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxp
bmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChf
X2FydGlmaWNpYWxfXykpIGludApfX2F0dHJpYnV0ZV9fICgoX19sZWFmX18pKSBvYnN0YWNrX3Zw
cmludGYgKHN0cnVjdCBvYnN0YWNrICpfX3Jlc3RyaWN0IF9fb2JzdGFjaywgY29uc3QgY2hhciAq
X19yZXN0cmljdCBfX2ZtdCwgX19nbnVjX3ZhX2xpc3QgX19hcCkgdGhyb3cgKCkKCnsKICByZXR1
cm4gX19vYnN0YWNrX3ZwcmludGZfY2hrIChfX29ic3RhY2ssIDIgLSAxLCBfX2ZtdCwKICAgIF9f
YXApOwp9CiMgMjQxICIvdXNyL2luY2x1ZGUvYml0cy9zdGRpbzIuaCIgMyA0CmV4dGVybiBjaGFy
ICpfX2ZnZXRzX2NoayAoY2hhciAqX19yZXN0cmljdCBfX3MsIHNpemVfdCBfX3NpemUsIGludCBf
X24sCiAgICAgRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIGNoYXIgKl9fZmdldHNfYWxpYXMgKGNoYXIgKl9f
cmVzdHJpY3QgX19zLCBpbnQgX19uLCBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2FzbV9f
ICgiIiAiZmdldHMiKQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9f
YXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBjaGFyICpfX2Zn
ZXRzX2Noa193YXJuIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgc2l6ZV90IF9fc2l6ZSwgaW50IF9f
biwgRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSkgX19hc21fXyAoIiIgIl9fZmdldHNfY2hrIikK
CgogICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgX19hdHRyaWJ1
dGVfXygoX193YXJuaW5nX18gKCJmZ2V0cyBjYWxsZWQgd2l0aCBiaWdnZXIgc2l6ZSB0aGFuIGxl
bmd0aCAiICJvZiBkZXN0aW5hdGlvbiBidWZmZXIiKSkpCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIDsKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgo
X19hcnRpZmljaWFsX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykp
IGNoYXIgKgpmZ2V0cyAoY2hhciAqX19yZXN0cmljdCBfX3MsIGludCBfX24sIEZJTEUgKl9fcmVz
dHJpY3QgX19zdHJlYW0pCnsKICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChfX3MsIDIgPiAx
KSAhPSAoc2l6ZV90KSAtMSkKICAgIHsKICAgICAgaWYgKCFfX2J1aWx0aW5fY29uc3RhbnRfcCAo
X19uKSB8fCBfX24gPD0gMCkKIHJldHVybiBfX2ZnZXRzX2NoayAoX19zLCBfX2J1aWx0aW5fb2Jq
ZWN0X3NpemUgKF9fcywgMiA+IDEpLCBfX24sIF9fc3RyZWFtKTsKCiAgICAgIGlmICgoc2l6ZV90
KSBfX24gPiBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcywgMiA+IDEpKQogcmV0dXJuIF9fZmdl
dHNfY2hrX3dhcm4gKF9fcywgX19idWlsdGluX29iamVjdF9zaXplIChfX3MsIDIgPiAxKSwgX19u
LCBfX3N0cmVhbSk7CiAgICB9CiAgcmV0dXJuIF9fZmdldHNfYWxpYXMgKF9fcywgX19uLCBfX3N0
cmVhbSk7Cn0KCmV4dGVybiBzaXplX3QgX19mcmVhZF9jaGsgKHZvaWQgKl9fcmVzdHJpY3QgX19w
dHIsIHNpemVfdCBfX3B0cmxlbiwKICAgICAgc2l6ZV90IF9fc2l6ZSwgc2l6ZV90IF9fbiwKICAg
ICAgRklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVz
ZWRfcmVzdWx0X18pKTsKZXh0ZXJuIHNpemVfdCBfX2ZyZWFkX2FsaWFzICh2b2lkICpfX3Jlc3Ry
aWN0IF9fcHRyLCBzaXplX3QgX19zaXplLCBzaXplX3QgX19uLCBGSUxFICpfX3Jlc3RyaWN0IF9f
c3RyZWFtKSBfX2FzbV9fICgiIiAiZnJlYWQiKQoKCiAgICAgICAgICAgIF9fYXR0cmlidXRlX18g
KChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBzaXplX3QgX19mcmVhZF9jaGtfd2Fy
biAodm9pZCAqX19yZXN0cmljdCBfX3B0ciwgc2l6ZV90IF9fcHRybGVuLCBzaXplX3QgX19zaXpl
LCBzaXplX3QgX19uLCBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2FzbV9fICgiIiAiX19m
cmVhZF9jaGsiKQoKCgoKICAgICBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRf
XykpIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgiZnJlYWQgY2FsbGVkIHdpdGggYmlnZ2Vy
IHNpemUgKiBubWVtYiB0aGFuIGxlbmd0aCAiICJvZiBkZXN0aW5hdGlvbiBidWZmZXIiKSkpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKCmV4dGVybiBfX2lubGluZSBfX2F0dHJp
YnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5l
X18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBfX2F0dHJpYnV0ZV9fICgoX193
YXJuX3VudXNlZF9yZXN1bHRfXykpIHNpemVfdApmcmVhZCAodm9pZCAqX19yZXN0cmljdCBfX3B0
ciwgc2l6ZV90IF9fc2l6ZSwgc2l6ZV90IF9fbiwKICAgICAgIEZJTEUgKl9fcmVzdHJpY3QgX19z
dHJlYW0pCnsKICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChfX3B0ciwgMCkgIT0gKHNpemVf
dCkgLTEpCiAgICB7CiAgICAgIGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fc2l6ZSkKICAg
fHwgIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX24pCiAgIHx8IChfX3NpemUgfCBfX24pID49ICgo
KHNpemVfdCkgMSkgPDwgKDggKiBzaXplb2YgKHNpemVfdCkgLyAyKSkpCiByZXR1cm4gX19mcmVh
ZF9jaGsgKF9fcHRyLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fcHRyLCAwKSwgX19zaXplLCBf
X24sIF9fc3RyZWFtKTsKCiAgICAgIGlmIChfX3NpemUgKiBfX24gPiBfX2J1aWx0aW5fb2JqZWN0
X3NpemUgKF9fcHRyLCAwKSkKIHJldHVybiBfX2ZyZWFkX2Noa193YXJuIChfX3B0ciwgX19idWls
dGluX29iamVjdF9zaXplIChfX3B0ciwgMCksIF9fc2l6ZSwgX19uLCBfX3N0cmVhbSk7CiAgICB9
CiAgcmV0dXJuIF9fZnJlYWRfYWxpYXMgKF9fcHRyLCBfX3NpemUsIF9fbiwgX19zdHJlYW0pOwp9
CgoKZXh0ZXJuIGNoYXIgKl9fZmdldHNfdW5sb2NrZWRfY2hrIChjaGFyICpfX3Jlc3RyaWN0IF9f
cywgc2l6ZV90IF9fc2l6ZSwKICAgICAgIGludCBfX24sIEZJTEUgKl9fcmVzdHJpY3QgX19zdHJl
YW0pIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBjaGFy
ICpfX2ZnZXRzX3VubG9ja2VkX2FsaWFzIChjaGFyICpfX3Jlc3RyaWN0IF9fcywgaW50IF9fbiwg
RklMRSAqX19yZXN0cmljdCBfX3N0cmVhbSkgX19hc21fXyAoIiIgImZnZXRzX3VubG9ja2VkIikK
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2F0dHJp
YnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gY2hhciAqX19mZ2V0c191
bmxvY2tlZF9jaGtfd2FybiAoY2hhciAqX19yZXN0cmljdCBfX3MsIHNpemVfdCBfX3NpemUsIGlu
dCBfX24sIEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0pIF9fYXNtX18gKCIiICJfX2ZnZXRzX3Vu
bG9ja2VkX2NoayIpCgoKICAgICBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRf
XykpIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgiZmdldHNfdW5sb2NrZWQgY2FsbGVkIHdp
dGggYmlnZ2VyIHNpemUgdGhhbiBsZW5ndGggIiAib2YgZGVzdGluYXRpb24gYnVmZmVyIikpKQog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRy
aWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGlu
ZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgX19hdHRyaWJ1dGVfXyAoKF9f
d2Fybl91bnVzZWRfcmVzdWx0X18pKSBjaGFyICoKZmdldHNfdW5sb2NrZWQgKGNoYXIgKl9fcmVz
dHJpY3QgX19zLCBpbnQgX19uLCBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKQp7CiAgaWYgKF9f
YnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19zLCAyID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICB7CiAg
ICAgIGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fbikgfHwgX19uIDw9IDApCiByZXR1cm4g
X19mZ2V0c191bmxvY2tlZF9jaGsgKF9fcywgX19idWlsdGluX29iamVjdF9zaXplIChfX3MsIDIg
PiAxKSwgX19uLCBfX3N0cmVhbSk7CgogICAgICBpZiAoKHNpemVfdCkgX19uID4gX19idWlsdGlu
X29iamVjdF9zaXplIChfX3MsIDIgPiAxKSkKIHJldHVybiBfX2ZnZXRzX3VubG9ja2VkX2Noa193
YXJuIChfX3MsIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19zLCAyID4gMSksIF9fbiwgX19zdHJl
YW0pOwogICAgfQogIHJldHVybiBfX2ZnZXRzX3VubG9ja2VkX2FsaWFzIChfX3MsIF9fbiwgX19z
dHJlYW0pOwp9CgoKCgpleHRlcm4gc2l6ZV90IF9fZnJlYWRfdW5sb2NrZWRfY2hrICh2b2lkICpf
X3Jlc3RyaWN0IF9fcHRyLCBzaXplX3QgX19wdHJsZW4sCiAgICAgICAgc2l6ZV90IF9fc2l6ZSwg
c2l6ZV90IF9fbiwKICAgICAgICBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKSBfX2F0dHJpYnV0
ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gc2l6ZV90IF9fZnJlYWRfdW5s
b2NrZWRfYWxpYXMgKHZvaWQgKl9fcmVzdHJpY3QgX19wdHIsIHNpemVfdCBfX3NpemUsIHNpemVf
dCBfX24sIEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0pIF9fYXNtX18gKCIiICJmcmVhZF91bmxv
Y2tlZCIpCgoKICAgICAgICAgICAgICAgICAgICAgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVz
ZWRfcmVzdWx0X18pKTsKZXh0ZXJuIHNpemVfdCBfX2ZyZWFkX3VubG9ja2VkX2Noa193YXJuICh2
b2lkICpfX3Jlc3RyaWN0IF9fcHRyLCBzaXplX3QgX19wdHJsZW4sIHNpemVfdCBfX3NpemUsIHNp
emVfdCBfX24sIEZJTEUgKl9fcmVzdHJpY3QgX19zdHJlYW0pIF9fYXNtX18gKCIiICJfX2ZyZWFk
X3VubG9ja2VkX2NoayIpCgoKCgogICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jl
c3VsdF9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuaW5nX18gKCJmcmVhZF91bmxvY2tlZCBjYWxs
ZWQgd2l0aCBiaWdnZXIgc2l6ZSAqIG5tZW1iIHRoYW4gIiAibGVuZ3RoIG9mIGRlc3RpbmF0aW9u
IGJ1ZmZlciIpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKCmV4
dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18p
KSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIHNpemVfdApmcmVhZF91
bmxvY2tlZCAodm9pZCAqX19yZXN0cmljdCBfX3B0ciwgc2l6ZV90IF9fc2l6ZSwgc2l6ZV90IF9f
biwKICBGSUxFICpfX3Jlc3RyaWN0IF9fc3RyZWFtKQp7CiAgaWYgKF9fYnVpbHRpbl9vYmplY3Rf
c2l6ZSAoX19wdHIsIDApICE9IChzaXplX3QpIC0xKQogICAgewogICAgICBpZiAoIV9fYnVpbHRp
bl9jb25zdGFudF9wIChfX3NpemUpCiAgIHx8ICFfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19uKQog
ICB8fCAoX19zaXplIHwgX19uKSA+PSAoKChzaXplX3QpIDEpIDw8ICg4ICogc2l6ZW9mIChzaXpl
X3QpIC8gMikpKQogcmV0dXJuIF9fZnJlYWRfdW5sb2NrZWRfY2hrIChfX3B0ciwgX19idWlsdGlu
X29iamVjdF9zaXplIChfX3B0ciwgMCksIF9fc2l6ZSwgX19uLAogICAgICAgICBfX3N0cmVhbSk7
CgogICAgICBpZiAoX19zaXplICogX19uID4gX19idWlsdGluX29iamVjdF9zaXplIChfX3B0ciwg
MCkpCiByZXR1cm4gX19mcmVhZF91bmxvY2tlZF9jaGtfd2FybiAoX19wdHIsIF9fYnVpbHRpbl9v
YmplY3Rfc2l6ZSAoX19wdHIsIDApLCBfX3NpemUsIF9fbiwKICAgICAgIF9fc3RyZWFtKTsKICAg
IH0KCgogIGlmIChfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19zaXplKQogICAgICAmJiBfX2J1aWx0
aW5fY29uc3RhbnRfcCAoX19uKQogICAgICAmJiAoX19zaXplIHwgX19uKSA8ICgoKHNpemVfdCkg
MSkgPDwgKDggKiBzaXplb2YgKHNpemVfdCkgLyAyKSkKICAgICAgJiYgX19zaXplICogX19uIDw9
IDgpCiAgICB7CiAgICAgIHNpemVfdCBfX2NudCA9IF9fc2l6ZSAqIF9fbjsKICAgICAgY2hhciAq
X19jcHRyID0gKGNoYXIgKikgX19wdHI7CiAgICAgIGlmIChfX2NudCA9PSAwKQogcmV0dXJuIDA7
CgogICAgICBmb3IgKDsgX19jbnQgPiAwOyAtLV9fY250KQogewogICBpbnQgX19jID0gKF9fYnVp
bHRpbl9leHBlY3QgKCgoX19zdHJlYW0pLT5fSU9fcmVhZF9wdHIgPj0gKF9fc3RyZWFtKS0+X0lP
X3JlYWRfZW5kKSwgMCkgPyBfX3VmbG93IChfX3N0cmVhbSkgOiAqKHVuc2lnbmVkIGNoYXIgKikg
KF9fc3RyZWFtKS0+X0lPX3JlYWRfcHRyKyspOwogICBpZiAoX19jID09ICgtMSkpCiAgICAgYnJl
YWs7CiAgICpfX2NwdHIrKyA9IF9fYzsKIH0KICAgICAgcmV0dXJuIChfX2NwdHIgLSAoY2hhciAq
KSBfX3B0cikgLyBfX3NpemU7CiAgICB9CgogIHJldHVybiBfX2ZyZWFkX3VubG9ja2VkX2FsaWFz
IChfX3B0ciwgX19zaXplLCBfX24sIF9fc3RyZWFtKTsKfQojIDkzNyAiL3Vzci9pbmNsdWRlL3N0
ZGlvLmgiIDIgMyA0CgoKCgoKfQojIDQzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2NzdGRpbyIg
MiAzCgoKCgoKZXh0ZXJuICJDIiBjaGFyKiBnZXRzIChjaGFyKiBfX3MpIF9fYXR0cmlidXRlX18o
KF9fZGVwcmVjYXRlZF9fKSk7CiMgOTYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3N0ZGlvIiAz
Cm5hbWVzcGFjZSBzdGQKewogIHVzaW5nIDo6RklMRTsKICB1c2luZyA6OmZwb3NfdDsKCiAgdXNp
bmcgOjpjbGVhcmVycjsKICB1c2luZyA6OmZjbG9zZTsKICB1c2luZyA6OmZlb2Y7CiAgdXNpbmcg
OjpmZXJyb3I7CiAgdXNpbmcgOjpmZmx1c2g7CiAgdXNpbmcgOjpmZ2V0YzsKICB1c2luZyA6OmZn
ZXRwb3M7CiAgdXNpbmcgOjpmZ2V0czsKICB1c2luZyA6OmZvcGVuOwogIHVzaW5nIDo6ZnByaW50
ZjsKICB1c2luZyA6OmZwdXRjOwogIHVzaW5nIDo6ZnB1dHM7CiAgdXNpbmcgOjpmcmVhZDsKICB1
c2luZyA6OmZyZW9wZW47CiAgdXNpbmcgOjpmc2NhbmY7CiAgdXNpbmcgOjpmc2VlazsKICB1c2lu
ZyA6OmZzZXRwb3M7CiAgdXNpbmcgOjpmdGVsbDsKICB1c2luZyA6OmZ3cml0ZTsKICB1c2luZyA6
OmdldGM7CiAgdXNpbmcgOjpnZXRjaGFyOwoKCiAgdXNpbmcgOjpnZXRzOwoKICB1c2luZyA6OnBl
cnJvcjsKICB1c2luZyA6OnByaW50ZjsKICB1c2luZyA6OnB1dGM7CiAgdXNpbmcgOjpwdXRjaGFy
OwogIHVzaW5nIDo6cHV0czsKICB1c2luZyA6OnJlbW92ZTsKICB1c2luZyA6OnJlbmFtZTsKICB1
c2luZyA6OnJld2luZDsKICB1c2luZyA6OnNjYW5mOwogIHVzaW5nIDo6c2V0YnVmOwogIHVzaW5n
IDo6c2V0dmJ1ZjsKICB1c2luZyA6OnNwcmludGY7CiAgdXNpbmcgOjpzc2NhbmY7CiAgdXNpbmcg
Ojp0bXBmaWxlOwoKICB1c2luZyA6OnRtcG5hbTsKCiAgdXNpbmcgOjp1bmdldGM7CiAgdXNpbmcg
Ojp2ZnByaW50ZjsKICB1c2luZyA6OnZwcmludGY7CiAgdXNpbmcgOjp2c3ByaW50ZjsKfQojIDE1
NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jc3RkaW8iIDMKbmFtZXNwYWNlIF9fZ251X2N4eAp7
CiMgMTc1ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2NzdGRpbyIgMwogIHVzaW5nIDo6c25wcmlu
dGY7CiAgdXNpbmcgOjp2ZnNjYW5mOwogIHVzaW5nIDo6dnNjYW5mOwogIHVzaW5nIDo6dnNucHJp
bnRmOwogIHVzaW5nIDo6dnNzY2FuZjsKCn0KCm5hbWVzcGFjZSBzdGQKewogIHVzaW5nIDo6X19n
bnVfY3h4OjpzbnByaW50ZjsKICB1c2luZyA6Ol9fZ251X2N4eDo6dmZzY2FuZjsKICB1c2luZyA6
Ol9fZ251X2N4eDo6dnNjYW5mOwogIHVzaW5nIDo6X19nbnVfY3h4Ojp2c25wcmludGY7CiAgdXNp
bmcgOjpfX2dudV9jeHg6OnZzc2NhbmY7Cn0KIyA0NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9l
eHQvc3RyaW5nX2NvbnZlcnNpb25zLmgiIDIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Y2Vycm5vIiAxIDMKIyAzOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jZXJybm8iIDMKICAgICAg
IAojIDQwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2NlcnJubyIgMwoKCiMgMSAiL3Vzci9pbmNs
dWRlL2Vycm5vLmgiIDEgMyA0CiMgMzEgIi91c3IvaW5jbHVkZS9lcnJuby5oIiAzIDQKZXh0ZXJu
ICJDIiB7CgoKCiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvZXJybm8uaCIgMSAzIDQKIyAyNCAiL3Vz
ci9pbmNsdWRlL2JpdHMvZXJybm8uaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2xpbnV4L2Vycm5v
LmgiIDEgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2FzbS9lcnJuby5oIiAxIDMgNAojIDkgIi91c3Iv
aW5jbHVkZS9hc20vZXJybm8uaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2FzbS1nZW5lcmljL2Vy
cm5vLmgiIDEgMyA0CgoKCiMgMSAiL3Vzci9pbmNsdWRlL2FzbS1nZW5lcmljL2Vycm5vLWJhc2Uu
aCIgMSAzIDQKIyA1ICIvdXNyL2luY2x1ZGUvYXNtLWdlbmVyaWMvZXJybm8uaCIgMiAzIDQKIyAx
MCAiL3Vzci9pbmNsdWRlL2FzbS9lcnJuby5oIiAyIDMgNAojIDEgIi91c3IvaW5jbHVkZS9saW51
eC9lcnJuby5oIiAyIDMgNAojIDI1ICIvdXNyL2luY2x1ZGUvYml0cy9lcnJuby5oIiAyIDMgNAoj
IDUwICIvdXNyL2luY2x1ZGUvYml0cy9lcnJuby5oIiAzIDQKZXh0ZXJuIGludCAqX19lcnJub19s
b2NhdGlvbiAodm9pZCkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fY29uc3RfXykpOwojIDM2
ICIvdXNyL2luY2x1ZGUvZXJybm8uaCIgMiAzIDQKIyA1NCAiL3Vzci9pbmNsdWRlL2Vycm5vLmgi
IDMgNApleHRlcm4gY2hhciAqcHJvZ3JhbV9pbnZvY2F0aW9uX25hbWUsICpwcm9ncmFtX2ludm9j
YXRpb25fc2hvcnRfbmFtZTsKCgoKfQojIDY4ICIvdXNyL2luY2x1ZGUvZXJybm8uaCIgMyA0CnR5
cGVkZWYgaW50IGVycm9yX3Q7CiMgNDMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY2Vycm5vIiAy
IDMKIyA0NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leHQvc3RyaW5nX2NvbnZlcnNpb25zLmgi
IDIgMwoKbmFtZXNwYWNlIF9fZ251X2N4eCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18g
KCJkZWZhdWx0IikpKQp7CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RSZXQsIHR5cGVuYW1lIF9S
ZXQgPSBfVFJldCwgdHlwZW5hbWUgX0NoYXJULAogICAgdHlwZW5hbWUuLi4gX0Jhc2U+CiAgICBf
UmV0CiAgICBfX3N0b2EoX1RSZXQgKCpfX2NvbnZmKSAoY29uc3QgX0NoYXJUKiwgX0NoYXJUKios
IF9CYXNlLi4uKSwKICAgIGNvbnN0IGNoYXIqIF9fbmFtZSwgY29uc3QgX0NoYXJUKiBfX3N0ciwg
c3RkOjpzaXplX3QqIF9faWR4LAogICAgX0Jhc2UuLi4gX19iYXNlKQogICAgewogICAgICBfUmV0
IF9fcmV0OwoKICAgICAgX0NoYXJUKiBfX2VuZHB0cjsKCiAgICAgIHN0cnVjdCBfU2F2ZV9lcnJu
byB7CiBfU2F2ZV9lcnJubygpIDogX01fZXJybm8oKCpfX2Vycm5vX2xvY2F0aW9uICgpKSkgeyAo
Kl9fZXJybm9fbG9jYXRpb24gKCkpID0gMDsgfQogfl9TYXZlX2Vycm5vKCkgeyBpZiAoKCpfX2Vy
cm5vX2xvY2F0aW9uICgpKSA9PSAwKSAoKl9fZXJybm9fbG9jYXRpb24gKCkpID0gX01fZXJybm87
IH0KIGludCBfTV9lcnJubzsKICAgICAgfSBjb25zdCBfX3NhdmVfZXJybm87CgogICAgICBjb25z
dCBfVFJldCBfX3RtcCA9IF9fY29udmYoX19zdHIsICZfX2VuZHB0ciwgX19iYXNlLi4uKTsKCiAg
ICAgIGlmIChfX2VuZHB0ciA9PSBfX3N0cikKIHN0ZDo6X190aHJvd19pbnZhbGlkX2FyZ3VtZW50
KF9fbmFtZSk7CiAgICAgIGVsc2UgaWYgKCgqX19lcnJub19sb2NhdGlvbiAoKSkgPT0gMzQKICAg
ICAgICB8fCAoc3RkOjpfX2FyZV9zYW1lPF9SZXQsIGludD46Ol9fdmFsdWUKICAgICAmJiAoX190
bXAgPCBfX251bWVyaWNfdHJhaXRzPGludD46Ol9fbWluCiAgICAgICAgIHx8IF9fdG1wID4gX19u
dW1lcmljX3RyYWl0czxpbnQ+OjpfX21heCkpKQogc3RkOjpfX3Rocm93X291dF9vZl9yYW5nZShf
X25hbWUpOwogICAgICBlbHNlCiBfX3JldCA9IF9fdG1wOwoKICAgICAgaWYgKF9faWR4KQogKl9f
aWR4ID0gX19lbmRwdHIgLSBfX3N0cjsKCiAgICAgIHJldHVybiBfX3JldDsKICAgIH0KCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9TdHJpbmcsIHR5cGVuYW1lIF9DaGFyVCA9IHR5cGVuYW1lIF9TdHJp
bmc6OnZhbHVlX3R5cGU+CiAgICBfU3RyaW5nCiAgICBfX3RvX3hzdHJpbmcoaW50ICgqX19jb252
ZikgKF9DaGFyVCosIHN0ZDo6c2l6ZV90LCBjb25zdCBfQ2hhclQqLAogICAgIF9fYnVpbHRpbl92
YV9saXN0KSwgc3RkOjpzaXplX3QgX19uLAogICBjb25zdCBfQ2hhclQqIF9fZm10LCAuLi4pCiAg
ICB7CgoKICAgICAgX0NoYXJUKiBfX3MgPSBzdGF0aWNfY2FzdDxfQ2hhclQqPihfX2J1aWx0aW5f
YWxsb2NhKHNpemVvZihfQ2hhclQpCiAgICAgICAgICogX19uKSk7CgogICAgICBfX2J1aWx0aW5f
dmFfbGlzdCBfX2FyZ3M7CiAgICAgIF9fYnVpbHRpbl92YV9zdGFydChfX2FyZ3MsIF9fZm10KTsK
CiAgICAgIGNvbnN0IGludCBfX2xlbiA9IF9fY29udmYoX19zLCBfX24sIF9fZm10LCBfX2FyZ3Mp
OwoKICAgICAgX19idWlsdGluX3ZhX2VuZChfX2FyZ3MpOwoKICAgICAgcmV0dXJuIF9TdHJpbmco
X19zLCBfX3MgKyBfX2xlbik7CiAgICB9CgoKfQojIDU0MDMgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9iYXNpY19zdHJpbmcuaCIgMiAzCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18g
KChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCm5hbWVzcGFjZSBfX2N4eDExIHsKCgoK
ICBpbmxpbmUgaW50CiAgc3RvaShjb25zdCBzdHJpbmcmIF9fc3RyLCBzaXplX3QqIF9faWR4ID0g
MCwgaW50IF9fYmFzZSA9IDEwKQogIHsgcmV0dXJuIF9fZ251X2N4eDo6X19zdG9hPGxvbmcsIGlu
dD4oJnN0ZDo6c3RydG9sLCAic3RvaSIsIF9fc3RyLmNfc3RyKCksCiAgICAgX19pZHgsIF9fYmFz
ZSk7IH0KCiAgaW5saW5lIGxvbmcKICBzdG9sKGNvbnN0IHN0cmluZyYgX19zdHIsIHNpemVfdCog
X19pZHggPSAwLCBpbnQgX19iYXNlID0gMTApCiAgeyByZXR1cm4gX19nbnVfY3h4OjpfX3N0b2Eo
JnN0ZDo6c3RydG9sLCAic3RvbCIsIF9fc3RyLmNfc3RyKCksCiAgICAgICAgX19pZHgsIF9fYmFz
ZSk7IH0KCiAgaW5saW5lIHVuc2lnbmVkIGxvbmcKICBzdG91bChjb25zdCBzdHJpbmcmIF9fc3Ry
LCBzaXplX3QqIF9faWR4ID0gMCwgaW50IF9fYmFzZSA9IDEwKQogIHsgcmV0dXJuIF9fZ251X2N4
eDo6X19zdG9hKCZzdGQ6OnN0cnRvdWwsICJzdG91bCIsIF9fc3RyLmNfc3RyKCksCiAgICAgICAg
X19pZHgsIF9fYmFzZSk7IH0KCiAgaW5saW5lIGxvbmcgbG9uZwogIHN0b2xsKGNvbnN0IHN0cmlu
ZyYgX19zdHIsIHNpemVfdCogX19pZHggPSAwLCBpbnQgX19iYXNlID0gMTApCiAgeyByZXR1cm4g
X19nbnVfY3h4OjpfX3N0b2EoJnN0ZDo6c3RydG9sbCwgInN0b2xsIiwgX19zdHIuY19zdHIoKSwK
ICAgICAgICBfX2lkeCwgX19iYXNlKTsgfQoKICBpbmxpbmUgdW5zaWduZWQgbG9uZyBsb25nCiAg
c3RvdWxsKGNvbnN0IHN0cmluZyYgX19zdHIsIHNpemVfdCogX19pZHggPSAwLCBpbnQgX19iYXNl
ID0gMTApCiAgeyByZXR1cm4gX19nbnVfY3h4OjpfX3N0b2EoJnN0ZDo6c3RydG91bGwsICJzdG91
bGwiLCBfX3N0ci5jX3N0cigpLAogICAgICAgIF9faWR4LCBfX2Jhc2UpOyB9CgoKICBpbmxpbmUg
ZmxvYXQKICBzdG9mKGNvbnN0IHN0cmluZyYgX19zdHIsIHNpemVfdCogX19pZHggPSAwKQogIHsg
cmV0dXJuIF9fZ251X2N4eDo6X19zdG9hKCZzdGQ6OnN0cnRvZiwgInN0b2YiLCBfX3N0ci5jX3N0
cigpLCBfX2lkeCk7IH0KCiAgaW5saW5lIGRvdWJsZQogIHN0b2QoY29uc3Qgc3RyaW5nJiBfX3N0
ciwgc2l6ZV90KiBfX2lkeCA9IDApCiAgeyByZXR1cm4gX19nbnVfY3h4OjpfX3N0b2EoJnN0ZDo6
c3RydG9kLCAic3RvZCIsIF9fc3RyLmNfc3RyKCksIF9faWR4KTsgfQoKICBpbmxpbmUgbG9uZyBk
b3VibGUKICBzdG9sZChjb25zdCBzdHJpbmcmIF9fc3RyLCBzaXplX3QqIF9faWR4ID0gMCkKICB7
IHJldHVybiBfX2dudV9jeHg6Ol9fc3RvYSgmc3RkOjpzdHJ0b2xkLCAic3RvbGQiLCBfX3N0ci5j
X3N0cigpLCBfX2lkeCk7IH0KCgoKCgoKICBpbmxpbmUgc3RyaW5nCiAgdG9fc3RyaW5nKGludCBf
X3ZhbCkKICB7IHJldHVybiBfX2dudV9jeHg6Ol9fdG9feHN0cmluZzxzdHJpbmc+KCZzdGQ6OnZz
bnByaW50ZiwgNCAqIHNpemVvZihpbnQpLAogICAgICAgICIlZCIsIF9fdmFsKTsgfQoKICBpbmxp
bmUgc3RyaW5nCiAgdG9fc3RyaW5nKHVuc2lnbmVkIF9fdmFsKQogIHsgcmV0dXJuIF9fZ251X2N4
eDo6X190b194c3RyaW5nPHN0cmluZz4oJnN0ZDo6dnNucHJpbnRmLAogICAgICAgIDQgKiBzaXpl
b2YodW5zaWduZWQpLAogICAgICAgICIldSIsIF9fdmFsKTsgfQoKICBpbmxpbmUgc3RyaW5nCiAg
dG9fc3RyaW5nKGxvbmcgX192YWwpCiAgeyByZXR1cm4gX19nbnVfY3h4OjpfX3RvX3hzdHJpbmc8
c3RyaW5nPigmc3RkOjp2c25wcmludGYsIDQgKiBzaXplb2YobG9uZyksCiAgICAgICAgIiVsZCIs
IF9fdmFsKTsgfQoKICBpbmxpbmUgc3RyaW5nCiAgdG9fc3RyaW5nKHVuc2lnbmVkIGxvbmcgX192
YWwpCiAgeyByZXR1cm4gX19nbnVfY3h4OjpfX3RvX3hzdHJpbmc8c3RyaW5nPigmc3RkOjp2c25w
cmludGYsCiAgICAgICAgNCAqIHNpemVvZih1bnNpZ25lZCBsb25nKSwKICAgICAgICAiJWx1Iiwg
X192YWwpOyB9CgogIGlubGluZSBzdHJpbmcKICB0b19zdHJpbmcobG9uZyBsb25nIF9fdmFsKQog
IHsgcmV0dXJuIF9fZ251X2N4eDo6X190b194c3RyaW5nPHN0cmluZz4oJnN0ZDo6dnNucHJpbnRm
LAogICAgICAgIDQgKiBzaXplb2YobG9uZyBsb25nKSwKICAgICAgICAiJWxsZCIsIF9fdmFsKTsg
fQoKICBpbmxpbmUgc3RyaW5nCiAgdG9fc3RyaW5nKHVuc2lnbmVkIGxvbmcgbG9uZyBfX3ZhbCkK
ICB7IHJldHVybiBfX2dudV9jeHg6Ol9fdG9feHN0cmluZzxzdHJpbmc+KCZzdGQ6OnZzbnByaW50
ZiwKICAgICAgICA0ICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcgbG9uZyksCiAgICAgICAgIiVsbHUi
LCBfX3ZhbCk7IH0KCiAgaW5saW5lIHN0cmluZwogIHRvX3N0cmluZyhmbG9hdCBfX3ZhbCkKICB7
CiAgICBjb25zdCBpbnQgX19uID0KICAgICAgX19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPGZs
b2F0Pjo6X19tYXhfZXhwb25lbnQxMCArIDIwOwogICAgcmV0dXJuIF9fZ251X2N4eDo6X190b194
c3RyaW5nPHN0cmluZz4oJnN0ZDo6dnNucHJpbnRmLCBfX24sCiAgICAgICAgIiVmIiwgX192YWwp
OwogIH0KCiAgaW5saW5lIHN0cmluZwogIHRvX3N0cmluZyhkb3VibGUgX192YWwpCiAgewogICAg
Y29uc3QgaW50IF9fbiA9CiAgICAgIF9fZ251X2N4eDo6X19udW1lcmljX3RyYWl0czxkb3VibGU+
OjpfX21heF9leHBvbmVudDEwICsgMjA7CiAgICByZXR1cm4gX19nbnVfY3h4OjpfX3RvX3hzdHJp
bmc8c3RyaW5nPigmc3RkOjp2c25wcmludGYsIF9fbiwKICAgICAgICAiJWYiLCBfX3ZhbCk7CiAg
fQoKICBpbmxpbmUgc3RyaW5nCiAgdG9fc3RyaW5nKGxvbmcgZG91YmxlIF9fdmFsKQogIHsKICAg
IGNvbnN0IGludCBfX24gPQogICAgICBfX2dudV9jeHg6Ol9fbnVtZXJpY190cmFpdHM8bG9uZyBk
b3VibGU+OjpfX21heF9leHBvbmVudDEwICsgMjA7CiAgICByZXR1cm4gX19nbnVfY3h4OjpfX3Rv
X3hzdHJpbmc8c3RyaW5nPigmc3RkOjp2c25wcmludGYsIF9fbiwKICAgICAgICAiJUxmIiwgX192
YWwpOwogIH0KCgoKICBpbmxpbmUgaW50CiAgc3RvaShjb25zdCB3c3RyaW5nJiBfX3N0ciwgc2l6
ZV90KiBfX2lkeCA9IDAsIGludCBfX2Jhc2UgPSAxMCkKICB7IHJldHVybiBfX2dudV9jeHg6Ol9f
c3RvYTxsb25nLCBpbnQ+KCZzdGQ6Ondjc3RvbCwgInN0b2kiLCBfX3N0ci5jX3N0cigpLAogICAg
IF9faWR4LCBfX2Jhc2UpOyB9CgogIGlubGluZSBsb25nCiAgc3RvbChjb25zdCB3c3RyaW5nJiBf
X3N0ciwgc2l6ZV90KiBfX2lkeCA9IDAsIGludCBfX2Jhc2UgPSAxMCkKICB7IHJldHVybiBfX2du
dV9jeHg6Ol9fc3RvYSgmc3RkOjp3Y3N0b2wsICJzdG9sIiwgX19zdHIuY19zdHIoKSwKICAgICAg
ICBfX2lkeCwgX19iYXNlKTsgfQoKICBpbmxpbmUgdW5zaWduZWQgbG9uZwogIHN0b3VsKGNvbnN0
IHdzdHJpbmcmIF9fc3RyLCBzaXplX3QqIF9faWR4ID0gMCwgaW50IF9fYmFzZSA9IDEwKQogIHsg
cmV0dXJuIF9fZ251X2N4eDo6X19zdG9hKCZzdGQ6Ondjc3RvdWwsICJzdG91bCIsIF9fc3RyLmNf
c3RyKCksCiAgICAgICAgX19pZHgsIF9fYmFzZSk7IH0KCiAgaW5saW5lIGxvbmcgbG9uZwogIHN0
b2xsKGNvbnN0IHdzdHJpbmcmIF9fc3RyLCBzaXplX3QqIF9faWR4ID0gMCwgaW50IF9fYmFzZSA9
IDEwKQogIHsgcmV0dXJuIF9fZ251X2N4eDo6X19zdG9hKCZzdGQ6Ondjc3RvbGwsICJzdG9sbCIs
IF9fc3RyLmNfc3RyKCksCiAgICAgICAgX19pZHgsIF9fYmFzZSk7IH0KCiAgaW5saW5lIHVuc2ln
bmVkIGxvbmcgbG9uZwogIHN0b3VsbChjb25zdCB3c3RyaW5nJiBfX3N0ciwgc2l6ZV90KiBfX2lk
eCA9IDAsIGludCBfX2Jhc2UgPSAxMCkKICB7IHJldHVybiBfX2dudV9jeHg6Ol9fc3RvYSgmc3Rk
Ojp3Y3N0b3VsbCwgInN0b3VsbCIsIF9fc3RyLmNfc3RyKCksCiAgICAgICAgX19pZHgsIF9fYmFz
ZSk7IH0KCgogIGlubGluZSBmbG9hdAogIHN0b2YoY29uc3Qgd3N0cmluZyYgX19zdHIsIHNpemVf
dCogX19pZHggPSAwKQogIHsgcmV0dXJuIF9fZ251X2N4eDo6X19zdG9hKCZzdGQ6Ondjc3RvZiwg
InN0b2YiLCBfX3N0ci5jX3N0cigpLCBfX2lkeCk7IH0KCiAgaW5saW5lIGRvdWJsZQogIHN0b2Qo
Y29uc3Qgd3N0cmluZyYgX19zdHIsIHNpemVfdCogX19pZHggPSAwKQogIHsgcmV0dXJuIF9fZ251
X2N4eDo6X19zdG9hKCZzdGQ6Ondjc3RvZCwgInN0b2QiLCBfX3N0ci5jX3N0cigpLCBfX2lkeCk7
IH0KCiAgaW5saW5lIGxvbmcgZG91YmxlCiAgc3RvbGQoY29uc3Qgd3N0cmluZyYgX19zdHIsIHNp
emVfdCogX19pZHggPSAwKQogIHsgcmV0dXJuIF9fZ251X2N4eDo6X19zdG9hKCZzdGQ6Ondjc3Rv
bGQsICJzdG9sZCIsIF9fc3RyLmNfc3RyKCksIF9faWR4KTsgfQoKCgogIGlubGluZSB3c3RyaW5n
CiAgdG9fd3N0cmluZyhpbnQgX192YWwpCiAgeyByZXR1cm4gX19nbnVfY3h4OjpfX3RvX3hzdHJp
bmc8d3N0cmluZz4oJnN0ZDo6dnN3cHJpbnRmLCA0ICogc2l6ZW9mKGludCksCiAgICAgICAgIEwi
JWQiLCBfX3ZhbCk7IH0KCiAgaW5saW5lIHdzdHJpbmcKICB0b193c3RyaW5nKHVuc2lnbmVkIF9f
dmFsKQogIHsgcmV0dXJuIF9fZ251X2N4eDo6X190b194c3RyaW5nPHdzdHJpbmc+KCZzdGQ6OnZz
d3ByaW50ZiwKICAgICAgICAgNCAqIHNpemVvZih1bnNpZ25lZCksCiAgICAgICAgIEwiJXUiLCBf
X3ZhbCk7IH0KCiAgaW5saW5lIHdzdHJpbmcKICB0b193c3RyaW5nKGxvbmcgX192YWwpCiAgeyBy
ZXR1cm4gX19nbnVfY3h4OjpfX3RvX3hzdHJpbmc8d3N0cmluZz4oJnN0ZDo6dnN3cHJpbnRmLCA0
ICogc2l6ZW9mKGxvbmcpLAogICAgICAgICBMIiVsZCIsIF9fdmFsKTsgfQoKICBpbmxpbmUgd3N0
cmluZwogIHRvX3dzdHJpbmcodW5zaWduZWQgbG9uZyBfX3ZhbCkKICB7IHJldHVybiBfX2dudV9j
eHg6Ol9fdG9feHN0cmluZzx3c3RyaW5nPigmc3RkOjp2c3dwcmludGYsCiAgICAgICAgIDQgKiBz
aXplb2YodW5zaWduZWQgbG9uZyksCiAgICAgICAgIEwiJWx1IiwgX192YWwpOyB9CgogIGlubGlu
ZSB3c3RyaW5nCiAgdG9fd3N0cmluZyhsb25nIGxvbmcgX192YWwpCiAgeyByZXR1cm4gX19nbnVf
Y3h4OjpfX3RvX3hzdHJpbmc8d3N0cmluZz4oJnN0ZDo6dnN3cHJpbnRmLAogICAgICAgICA0ICog
c2l6ZW9mKGxvbmcgbG9uZyksCiAgICAgICAgIEwiJWxsZCIsIF9fdmFsKTsgfQoKICBpbmxpbmUg
d3N0cmluZwogIHRvX3dzdHJpbmcodW5zaWduZWQgbG9uZyBsb25nIF9fdmFsKQogIHsgcmV0dXJu
IF9fZ251X2N4eDo6X190b194c3RyaW5nPHdzdHJpbmc+KCZzdGQ6OnZzd3ByaW50ZiwKICAgICAg
ICAgNCAqIHNpemVvZih1bnNpZ25lZCBsb25nIGxvbmcpLAogICAgICAgICBMIiVsbHUiLCBfX3Zh
bCk7IH0KCiAgaW5saW5lIHdzdHJpbmcKICB0b193c3RyaW5nKGZsb2F0IF9fdmFsKQogIHsKICAg
IGNvbnN0IGludCBfX24gPQogICAgICBfX2dudV9jeHg6Ol9fbnVtZXJpY190cmFpdHM8ZmxvYXQ+
OjpfX21heF9leHBvbmVudDEwICsgMjA7CiAgICByZXR1cm4gX19nbnVfY3h4OjpfX3RvX3hzdHJp
bmc8d3N0cmluZz4oJnN0ZDo6dnN3cHJpbnRmLCBfX24sCiAgICAgICAgIEwiJWYiLCBfX3ZhbCk7
CiAgfQoKICBpbmxpbmUgd3N0cmluZwogIHRvX3dzdHJpbmcoZG91YmxlIF9fdmFsKQogIHsKICAg
IGNvbnN0IGludCBfX24gPQogICAgICBfX2dudV9jeHg6Ol9fbnVtZXJpY190cmFpdHM8ZG91Ymxl
Pjo6X19tYXhfZXhwb25lbnQxMCArIDIwOwogICAgcmV0dXJuIF9fZ251X2N4eDo6X190b194c3Ry
aW5nPHdzdHJpbmc+KCZzdGQ6OnZzd3ByaW50ZiwgX19uLAogICAgICAgICBMIiVmIiwgX192YWwp
OwogIH0KCiAgaW5saW5lIHdzdHJpbmcKICB0b193c3RyaW5nKGxvbmcgZG91YmxlIF9fdmFsKQog
IHsKICAgIGNvbnN0IGludCBfX24gPQogICAgICBfX2dudV9jeHg6Ol9fbnVtZXJpY190cmFpdHM8
bG9uZyBkb3VibGU+OjpfX21heF9leHBvbmVudDEwICsgMjA7CiAgICByZXR1cm4gX19nbnVfY3h4
OjpfX3RvX3hzdHJpbmc8d3N0cmluZz4oJnN0ZDo6dnN3cHJpbnRmLCBfX24sCiAgICAgICAgIEwi
JUxmIiwgX192YWwpOwogIH0KCgoKfQoKfQoKCgoKCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL2Z1bmN0aW9uYWxfaGFzaC5oIiAxIDMKIyAzMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL2Z1bmN0aW9uYWxfaGFzaC5oIiAzCiAgICAgICAKIyAzNCAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL2Z1bmN0aW9uYWxfaGFzaC5oIiAzCgojIDEgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9oYXNoX2J5dGVzLmgiIDEgMwojIDMzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvaGFzaF9ieXRlcy5oIiAzCiAgICAgICAKIyAzNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL2hhc2hfYnl0ZXMuaCIgMwoKCgpuYW1lc3BhY2Ugc3RkCnsKCgoKCgoKCiAgc2l6ZV90
CiAgX0hhc2hfYnl0ZXMoY29uc3Qgdm9pZCogX19wdHIsIHNpemVfdCBfX2xlbiwgc2l6ZV90IF9f
c2VlZCk7CgoKCgoKICBzaXplX3QKICBfRm52X2hhc2hfYnl0ZXMoY29uc3Qgdm9pZCogX19wdHIs
IHNpemVfdCBfX2xlbiwgc2l6ZV90IF9fc2VlZCk7CgoKfQojIDM2ICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvZnVuY3Rpb25hbF9oYXNoLmgiIDIgMwoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJp
YnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgojIDQ5ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvZnVuY3Rpb25hbF9oYXNoLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfUmVzdWx0LCB0eXBlbmFtZSBfQXJnPgogICAgc3RydWN0IF9faGFzaF9iYXNlCiAgICB7CiAg
ICAgIHR5cGVkZWYgX1Jlc3VsdCByZXN1bHRfdHlwZTsKICAgICAgdHlwZWRlZiBfQXJnIGFyZ3Vt
ZW50X3R5cGU7CiAgICB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGhh
c2g7CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIGJvb2wgPSBpc19lbnVtPF9UcD46OnZhbHVl
PgogICAgc3RydWN0IF9faGFzaF9lbnVtCiAgICB7CiAgICBwcml2YXRlOgoKICAgICAgX19oYXNo
X2VudW0oX19oYXNoX2VudW0mJik7CiAgICAgIH5fX2hhc2hfZW51bSgpOwogICAgfTsKCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2hhc2hfZW51bTxfVHAsIHRydWU+IDog
cHVibGljIF9faGFzaF9iYXNlPHNpemVfdCwgX1RwPgogICAgewogICAgICBzaXplX3QKICAgICAg
b3BlcmF0b3IoKShfVHAgX192YWwpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsKICAgICAgIHVzaW5n
IF9fdHlwZSA9IHR5cGVuYW1lIHVuZGVybHlpbmdfdHlwZTxfVHA+Ojp0eXBlOwogICAgICAgcmV0
dXJuIGhhc2g8X190eXBlPnt9KHN0YXRpY19jYXN0PF9fdHlwZT4oX192YWwpKTsKICAgICAgfQog
ICAgfTsKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgaGFzaCA6IF9faGFz
aF9lbnVtPF9UcD4KICAgIHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVj
dCBoYXNoPF9UcCo+IDogcHVibGljIF9faGFzaF9iYXNlPHNpemVfdCwgX1RwKj4KICAgIHsKICAg
ICAgc2l6ZV90CiAgICAgIG9wZXJhdG9yKCkoX1RwKiBfX3ApIGNvbnN0IG5vZXhjZXB0CiAgICAg
IHsgcmV0dXJuIHJlaW50ZXJwcmV0X2Nhc3Q8c2l6ZV90PihfX3ApOyB9CiAgICB9OwojIDEwOCAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Z1bmN0aW9uYWxfaGFzaC5oIiAzCiAgdGVtcGxh
dGU8PiBzdHJ1Y3QgaGFzaDxib29sPiA6IHB1YmxpYyBfX2hhc2hfYmFzZTxzaXplX3QsIGJvb2w+
IHsgc2l6ZV90IG9wZXJhdG9yKCkoYm9vbCBfX3ZhbCkgY29uc3Qgbm9leGNlcHQgeyByZXR1cm4g
c3RhdGljX2Nhc3Q8c2l6ZV90PihfX3ZhbCk7IH0gfTsKCgogIHRlbXBsYXRlPD4gc3RydWN0IGhh
c2g8Y2hhcj4gOiBwdWJsaWMgX19oYXNoX2Jhc2U8c2l6ZV90LCBjaGFyPiB7IHNpemVfdCBvcGVy
YXRvcigpKGNoYXIgX192YWwpIGNvbnN0IG5vZXhjZXB0IHsgcmV0dXJuIHN0YXRpY19jYXN0PHNp
emVfdD4oX192YWwpOyB9IH07CgoKICB0ZW1wbGF0ZTw+IHN0cnVjdCBoYXNoPHNpZ25lZCBjaGFy
PiA6IHB1YmxpYyBfX2hhc2hfYmFzZTxzaXplX3QsIHNpZ25lZCBjaGFyPiB7IHNpemVfdCBvcGVy
YXRvcigpKHNpZ25lZCBjaGFyIF9fdmFsKSBjb25zdCBub2V4Y2VwdCB7IHJldHVybiBzdGF0aWNf
Y2FzdDxzaXplX3Q+KF9fdmFsKTsgfSB9OwoKCiAgdGVtcGxhdGU8PiBzdHJ1Y3QgaGFzaDx1bnNp
Z25lZCBjaGFyPiA6IHB1YmxpYyBfX2hhc2hfYmFzZTxzaXplX3QsIHVuc2lnbmVkIGNoYXI+IHsg
c2l6ZV90IG9wZXJhdG9yKCkodW5zaWduZWQgY2hhciBfX3ZhbCkgY29uc3Qgbm9leGNlcHQgeyBy
ZXR1cm4gc3RhdGljX2Nhc3Q8c2l6ZV90PihfX3ZhbCk7IH0gfTsKCgogIHRlbXBsYXRlPD4gc3Ry
dWN0IGhhc2g8d2NoYXJfdD4gOiBwdWJsaWMgX19oYXNoX2Jhc2U8c2l6ZV90LCB3Y2hhcl90PiB7
IHNpemVfdCBvcGVyYXRvcigpKHdjaGFyX3QgX192YWwpIGNvbnN0IG5vZXhjZXB0IHsgcmV0dXJu
IHN0YXRpY19jYXN0PHNpemVfdD4oX192YWwpOyB9IH07CgoKICB0ZW1wbGF0ZTw+IHN0cnVjdCBo
YXNoPGNoYXIxNl90PiA6IHB1YmxpYyBfX2hhc2hfYmFzZTxzaXplX3QsIGNoYXIxNl90PiB7IHNp
emVfdCBvcGVyYXRvcigpKGNoYXIxNl90IF9fdmFsKSBjb25zdCBub2V4Y2VwdCB7IHJldHVybiBz
dGF0aWNfY2FzdDxzaXplX3Q+KF9fdmFsKTsgfSB9OwoKCiAgdGVtcGxhdGU8PiBzdHJ1Y3QgaGFz
aDxjaGFyMzJfdD4gOiBwdWJsaWMgX19oYXNoX2Jhc2U8c2l6ZV90LCBjaGFyMzJfdD4geyBzaXpl
X3Qgb3BlcmF0b3IoKShjaGFyMzJfdCBfX3ZhbCkgY29uc3Qgbm9leGNlcHQgeyByZXR1cm4gc3Rh
dGljX2Nhc3Q8c2l6ZV90PihfX3ZhbCk7IH0gfTsKCgogIHRlbXBsYXRlPD4gc3RydWN0IGhhc2g8
c2hvcnQ+IDogcHVibGljIF9faGFzaF9iYXNlPHNpemVfdCwgc2hvcnQ+IHsgc2l6ZV90IG9wZXJh
dG9yKCkoc2hvcnQgX192YWwpIGNvbnN0IG5vZXhjZXB0IHsgcmV0dXJuIHN0YXRpY19jYXN0PHNp
emVfdD4oX192YWwpOyB9IH07CgoKICB0ZW1wbGF0ZTw+IHN0cnVjdCBoYXNoPGludD4gOiBwdWJs
aWMgX19oYXNoX2Jhc2U8c2l6ZV90LCBpbnQ+IHsgc2l6ZV90IG9wZXJhdG9yKCkoaW50IF9fdmFs
KSBjb25zdCBub2V4Y2VwdCB7IHJldHVybiBzdGF0aWNfY2FzdDxzaXplX3Q+KF9fdmFsKTsgfSB9
OwoKCiAgdGVtcGxhdGU8PiBzdHJ1Y3QgaGFzaDxsb25nPiA6IHB1YmxpYyBfX2hhc2hfYmFzZTxz
aXplX3QsIGxvbmc+IHsgc2l6ZV90IG9wZXJhdG9yKCkobG9uZyBfX3ZhbCkgY29uc3Qgbm9leGNl
cHQgeyByZXR1cm4gc3RhdGljX2Nhc3Q8c2l6ZV90PihfX3ZhbCk7IH0gfTsKCgogIHRlbXBsYXRl
PD4gc3RydWN0IGhhc2g8bG9uZyBsb25nPiA6IHB1YmxpYyBfX2hhc2hfYmFzZTxzaXplX3QsIGxv
bmcgbG9uZz4geyBzaXplX3Qgb3BlcmF0b3IoKShsb25nIGxvbmcgX192YWwpIGNvbnN0IG5vZXhj
ZXB0IHsgcmV0dXJuIHN0YXRpY19jYXN0PHNpemVfdD4oX192YWwpOyB9IH07CgoKICB0ZW1wbGF0
ZTw+IHN0cnVjdCBoYXNoPHVuc2lnbmVkIHNob3J0PiA6IHB1YmxpYyBfX2hhc2hfYmFzZTxzaXpl
X3QsIHVuc2lnbmVkIHNob3J0PiB7IHNpemVfdCBvcGVyYXRvcigpKHVuc2lnbmVkIHNob3J0IF9f
dmFsKSBjb25zdCBub2V4Y2VwdCB7IHJldHVybiBzdGF0aWNfY2FzdDxzaXplX3Q+KF9fdmFsKTsg
fSB9OwoKCiAgdGVtcGxhdGU8PiBzdHJ1Y3QgaGFzaDx1bnNpZ25lZCBpbnQ+IDogcHVibGljIF9f
aGFzaF9iYXNlPHNpemVfdCwgdW5zaWduZWQgaW50PiB7IHNpemVfdCBvcGVyYXRvcigpKHVuc2ln
bmVkIGludCBfX3ZhbCkgY29uc3Qgbm9leGNlcHQgeyByZXR1cm4gc3RhdGljX2Nhc3Q8c2l6ZV90
PihfX3ZhbCk7IH0gfTsKCgogIHRlbXBsYXRlPD4gc3RydWN0IGhhc2g8dW5zaWduZWQgbG9uZz4g
OiBwdWJsaWMgX19oYXNoX2Jhc2U8c2l6ZV90LCB1bnNpZ25lZCBsb25nPiB7IHNpemVfdCBvcGVy
YXRvcigpKHVuc2lnbmVkIGxvbmcgX192YWwpIGNvbnN0IG5vZXhjZXB0IHsgcmV0dXJuIHN0YXRp
Y19jYXN0PHNpemVfdD4oX192YWwpOyB9IH07CgoKICB0ZW1wbGF0ZTw+IHN0cnVjdCBoYXNoPHVu
c2lnbmVkIGxvbmcgbG9uZz4gOiBwdWJsaWMgX19oYXNoX2Jhc2U8c2l6ZV90LCB1bnNpZ25lZCBs
b25nIGxvbmc+IHsgc2l6ZV90IG9wZXJhdG9yKCkodW5zaWduZWQgbG9uZyBsb25nIF9fdmFsKSBj
b25zdCBub2V4Y2VwdCB7IHJldHVybiBzdGF0aWNfY2FzdDxzaXplX3Q+KF9fdmFsKTsgfSB9Owoj
IDE3MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Z1bmN0aW9uYWxfaGFzaC5oIiAzCiAg
c3RydWN0IF9IYXNoX2ltcGwKICB7CiAgICBzdGF0aWMgc2l6ZV90CiAgICBoYXNoKGNvbnN0IHZv
aWQqIF9fcHRyLCBzaXplX3QgX19jbGVuZ3RoLAogIHNpemVfdCBfX3NlZWQgPSBzdGF0aWNfY2Fz
dDxzaXplX3Q+KDB4YzcwZjY5MDdVTCkpCiAgICB7IHJldHVybiBfSGFzaF9ieXRlcyhfX3B0ciwg
X19jbGVuZ3RoLCBfX3NlZWQpOyB9CgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgICBz
dGF0aWMgc2l6ZV90CiAgICAgIGhhc2goY29uc3QgX1RwJiBfX3ZhbCkKICAgICAgeyByZXR1cm4g
aGFzaCgmX192YWwsIHNpemVvZihfX3ZhbCkpOyB9CgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX1Rw
PgogICAgICBzdGF0aWMgc2l6ZV90CiAgICAgIF9faGFzaF9jb21iaW5lKGNvbnN0IF9UcCYgX192
YWwsIHNpemVfdCBfX2hhc2gpCiAgICAgIHsgcmV0dXJuIGhhc2goJl9fdmFsLCBzaXplb2YoX192
YWwpLCBfX2hhc2gpOyB9CiAgfTsKCiAgc3RydWN0IF9GbnZfaGFzaF9pbXBsCiAgewogICAgc3Rh
dGljIHNpemVfdAogICAgaGFzaChjb25zdCB2b2lkKiBfX3B0ciwgc2l6ZV90IF9fY2xlbmd0aCwK
ICBzaXplX3QgX19zZWVkID0gc3RhdGljX2Nhc3Q8c2l6ZV90PigyMTY2MTM2MjYxVUwpKQogICAg
eyByZXR1cm4gX0Zudl9oYXNoX2J5dGVzKF9fcHRyLCBfX2NsZW5ndGgsIF9fc2VlZCk7IH0KCiAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICAgIHN0YXRpYyBzaXplX3QKICAgICAgaGFzaChj
b25zdCBfVHAmIF9fdmFsKQogICAgICB7IHJldHVybiBoYXNoKCZfX3ZhbCwgc2l6ZW9mKF9fdmFs
KSk7IH0KCiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICAgIHN0YXRpYyBzaXplX3QKICAg
ICAgX19oYXNoX2NvbWJpbmUoY29uc3QgX1RwJiBfX3ZhbCwgc2l6ZV90IF9faGFzaCkKICAgICAg
eyByZXR1cm4gaGFzaCgmX192YWwsIHNpemVvZihfX3ZhbCksIF9faGFzaCk7IH0KICB9OwoKCiAg
dGVtcGxhdGU8PgogICAgc3RydWN0IGhhc2g8ZmxvYXQ+IDogcHVibGljIF9faGFzaF9iYXNlPHNp
emVfdCwgZmxvYXQ+CiAgICB7CiAgICAgIHNpemVfdAogICAgICBvcGVyYXRvcigpKGZsb2F0IF9f
dmFsKSBjb25zdCBub2V4Y2VwdAogICAgICB7CgogcmV0dXJuIF9fdmFsICE9IDAuMGYgPyBzdGQ6
Ol9IYXNoX2ltcGw6Omhhc2goX192YWwpIDogMDsKICAgICAgfQogICAgfTsKCgogIHRlbXBsYXRl
PD4KICAgIHN0cnVjdCBoYXNoPGRvdWJsZT4gOiBwdWJsaWMgX19oYXNoX2Jhc2U8c2l6ZV90LCBk
b3VibGU+CiAgICB7CiAgICAgIHNpemVfdAogICAgICBvcGVyYXRvcigpKGRvdWJsZSBfX3ZhbCkg
Y29uc3Qgbm9leGNlcHQKICAgICAgewoKIHJldHVybiBfX3ZhbCAhPSAwLjAgPyBzdGQ6Ol9IYXNo
X2ltcGw6Omhhc2goX192YWwpIDogMDsKICAgICAgfQogICAgfTsKCgogIHRlbXBsYXRlPD4KICAg
IHN0cnVjdCBoYXNoPGxvbmcgZG91YmxlPgogICAgOiBwdWJsaWMgX19oYXNoX2Jhc2U8c2l6ZV90
LCBsb25nIGRvdWJsZT4KICAgIHsKICAgICAgX19hdHRyaWJ1dGVfXyAoKF9fcHVyZV9fKSkgc2l6
ZV90CiAgICAgIG9wZXJhdG9yKCkobG9uZyBkb3VibGUgX192YWwpIGNvbnN0IG5vZXhjZXB0Owog
ICAgfTsKCgoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0hhc2g+CiAgICBzdHJ1Y3QgX19pc19m
YXN0X2hhc2ggOiBwdWJsaWMgc3RkOjp0cnVlX3R5cGUKICAgIHsgfTsKCiAgdGVtcGxhdGU8Pgog
ICAgc3RydWN0IF9faXNfZmFzdF9oYXNoPGhhc2g8bG9uZyBkb3VibGU+PiA6IHB1YmxpYyBzdGQ6
OmZhbHNlX3R5cGUKICAgIHsgfTsKCgp9CiMgNTYyOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL2Jhc2ljX3N0cmluZy5oIiAyIDMKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9f
dmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCgoKCgogIHRlbXBsYXRlPD4KICAgIHN0cnVj
dCBoYXNoPHN0cmluZz4KICAgIDogcHVibGljIF9faGFzaF9iYXNlPHNpemVfdCwgc3RyaW5nPgog
ICAgewogICAgICBzaXplX3QKICAgICAgb3BlcmF0b3IoKShjb25zdCBzdHJpbmcmIF9fcykgY29u
c3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc3RkOjpfSGFzaF9pbXBsOjpoYXNoKF9fcy5kYXRh
KCksIF9fcy5sZW5ndGgoKSk7IH0KICAgIH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX2lz
X2Zhc3RfaGFzaDxoYXNoPHN0cmluZz4+IDogc3RkOjpmYWxzZV90eXBlCiAgICB7IH07CgoKCiAg
dGVtcGxhdGU8PgogICAgc3RydWN0IGhhc2g8d3N0cmluZz4KICAgIDogcHVibGljIF9faGFzaF9i
YXNlPHNpemVfdCwgd3N0cmluZz4KICAgIHsKICAgICAgc2l6ZV90CiAgICAgIG9wZXJhdG9yKCko
Y29uc3Qgd3N0cmluZyYgX19zKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGQ6Ol9I
YXNoX2ltcGw6Omhhc2goX19zLmRhdGEoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIF9fcy5sZW5ndGgoKSAqIHNpemVvZih3Y2hhcl90KSk7IH0KICAgIH07CgogIHRlbXBs
YXRlPD4KICAgIHN0cnVjdCBfX2lzX2Zhc3RfaGFzaDxoYXNoPHdzdHJpbmc+PiA6IHN0ZDo6ZmFs
c2VfdHlwZQogICAgeyB9OwoKCgoKCiAgdGVtcGxhdGU8PgogICAgc3RydWN0IGhhc2g8dTE2c3Ry
aW5nPgogICAgOiBwdWJsaWMgX19oYXNoX2Jhc2U8c2l6ZV90LCB1MTZzdHJpbmc+CiAgICB7CiAg
ICAgIHNpemVfdAogICAgICBvcGVyYXRvcigpKGNvbnN0IHUxNnN0cmluZyYgX19zKSBjb25zdCBu
b2V4Y2VwdAogICAgICB7IHJldHVybiBzdGQ6Ol9IYXNoX2ltcGw6Omhhc2goX19zLmRhdGEoKSwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9fcy5sZW5ndGgoKSAqIHNpemVv
ZihjaGFyMTZfdCkpOyB9CiAgICB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19pc19mYXN0
X2hhc2g8aGFzaDx1MTZzdHJpbmc+PiA6IHN0ZDo6ZmFsc2VfdHlwZQogICAgeyB9OwoKCiAgdGVt
cGxhdGU8PgogICAgc3RydWN0IGhhc2g8dTMyc3RyaW5nPgogICAgOiBwdWJsaWMgX19oYXNoX2Jh
c2U8c2l6ZV90LCB1MzJzdHJpbmc+CiAgICB7CiAgICAgIHNpemVfdAogICAgICBvcGVyYXRvcigp
KGNvbnN0IHUzMnN0cmluZyYgX19zKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGQ6
Ol9IYXNoX2ltcGw6Omhhc2goX19zLmRhdGEoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIF9fcy5sZW5ndGgoKSAqIHNpemVvZihjaGFyMzJfdCkpOyB9CiAgICB9OwoKICB0
ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX19pc19mYXN0X2hhc2g8aGFzaDx1MzJzdHJpbmc+PiA6IHN0
ZDo6ZmFsc2VfdHlwZQogICAgeyB9OwojIDU3MzkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9iYXNpY19zdHJpbmcuaCIgMwoKfQojIDUzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmlu
ZyIgMiAzCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX3N0cmluZy50Y2Mi
IDEgMwojIDQyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfc3RyaW5nLnRjYyIg
MwogICAgICAgCiMgNDMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19zdHJpbmcu
dGNjIiAzCgoKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgi
ZGVmYXVsdCIpKSkKewoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9U
cmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGNvbnN0IHR5cGVuYW1lIGJhc2ljX3N0cmluZzxf
Q2hhclQsIF9UcmFpdHMsIF9BbGxvYz46OnNpemVfdHlwZQogICAgYmFzaWNfc3RyaW5nPF9DaGFy
VCwgX1RyYWl0cywgX0FsbG9jPjo6bnBvczsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0
eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB2b2lkCiAgICBiYXNpY19zdHJp
bmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+OjoKICAgIHN3YXAoYmFzaWNfc3RyaW5nJiBfX3Mp
IG5vZXhjZXB0CiAgICB7CiAgICAgIGlmICh0aGlzID09ICZfX3MpCiByZXR1cm47CgogICAgICBf
QWxsb2NfdHJhaXRzOjpfU19vbl9zd2FwKF9NX2dldF9hbGxvY2F0b3IoKSwgX19zLl9NX2dldF9h
bGxvY2F0b3IoKSk7CgogICAgICBpZiAoX01faXNfbG9jYWwoKSkKIGlmIChfX3MuX01faXNfbG9j
YWwoKSkKICAgewogICAgIGlmIChsZW5ndGgoKSAmJiBfX3MubGVuZ3RoKCkpCiAgICAgICB7CiAg
X0NoYXJUIF9fdG1wX2RhdGFbX1NfbG9jYWxfY2FwYWNpdHkgKyAxXTsKICB0cmFpdHNfdHlwZTo6
Y29weShfX3RtcF9kYXRhLCBfX3MuX01fbG9jYWxfYnVmLAogICAgICBfU19sb2NhbF9jYXBhY2l0
eSArIDEpOwogIHRyYWl0c190eXBlOjpjb3B5KF9fcy5fTV9sb2NhbF9idWYsIF9NX2xvY2FsX2J1
ZiwKICAgICAgX1NfbG9jYWxfY2FwYWNpdHkgKyAxKTsKICB0cmFpdHNfdHlwZTo6Y29weShfTV9s
b2NhbF9idWYsIF9fdG1wX2RhdGEsCiAgICAgIF9TX2xvY2FsX2NhcGFjaXR5ICsgMSk7CiAgICAg
ICB9CiAgICAgZWxzZSBpZiAoX19zLmxlbmd0aCgpKQogICAgICAgewogIHRyYWl0c190eXBlOjpj
b3B5KF9NX2xvY2FsX2J1ZiwgX19zLl9NX2xvY2FsX2J1ZiwKICAgICAgX1NfbG9jYWxfY2FwYWNp
dHkgKyAxKTsKICBfTV9sZW5ndGgoX19zLmxlbmd0aCgpKTsKICBfX3MuX01fc2V0X2xlbmd0aCgw
KTsKICByZXR1cm47CiAgICAgICB9CiAgICAgZWxzZSBpZiAobGVuZ3RoKCkpCiAgICAgICB7CiAg
dHJhaXRzX3R5cGU6OmNvcHkoX19zLl9NX2xvY2FsX2J1ZiwgX01fbG9jYWxfYnVmLAogICAgICBf
U19sb2NhbF9jYXBhY2l0eSArIDEpOwogIF9fcy5fTV9sZW5ndGgobGVuZ3RoKCkpOwogIF9NX3Nl
dF9sZW5ndGgoMCk7CiAgcmV0dXJuOwogICAgICAgfQogICB9CiBlbHNlCiAgIHsKICAgICBjb25z
dCBzaXplX3R5cGUgX190bXBfY2FwYWNpdHkgPSBfX3MuX01fYWxsb2NhdGVkX2NhcGFjaXR5Owog
ICAgIHRyYWl0c190eXBlOjpjb3B5KF9fcy5fTV9sb2NhbF9idWYsIF9NX2xvY2FsX2J1ZiwKICAg
ICAgICAgX1NfbG9jYWxfY2FwYWNpdHkgKyAxKTsKICAgICBfTV9kYXRhKF9fcy5fTV9kYXRhKCkp
OwogICAgIF9fcy5fTV9kYXRhKF9fcy5fTV9sb2NhbF9idWYpOwogICAgIF9NX2NhcGFjaXR5KF9f
dG1wX2NhcGFjaXR5KTsKICAgfQogICAgICBlbHNlCiB7CiAgIGNvbnN0IHNpemVfdHlwZSBfX3Rt
cF9jYXBhY2l0eSA9IF9NX2FsbG9jYXRlZF9jYXBhY2l0eTsKICAgaWYgKF9fcy5fTV9pc19sb2Nh
bCgpKQogICAgIHsKICAgICAgIHRyYWl0c190eXBlOjpjb3B5KF9NX2xvY2FsX2J1ZiwgX19zLl9N
X2xvY2FsX2J1ZiwKICAgIF9TX2xvY2FsX2NhcGFjaXR5ICsgMSk7CiAgICAgICBfX3MuX01fZGF0
YShfTV9kYXRhKCkpOwogICAgICAgX01fZGF0YShfTV9sb2NhbF9idWYpOwogICAgIH0KICAgZWxz
ZQogICAgIHsKICAgICAgIHBvaW50ZXIgX190bXBfcHRyID0gX01fZGF0YSgpOwogICAgICAgX01f
ZGF0YShfX3MuX01fZGF0YSgpKTsKICAgICAgIF9fcy5fTV9kYXRhKF9fdG1wX3B0cik7CiAgICAg
ICBfTV9jYXBhY2l0eShfX3MuX01fYWxsb2NhdGVkX2NhcGFjaXR5KTsKICAgICB9CiAgIF9fcy5f
TV9jYXBhY2l0eShfX3RtcF9jYXBhY2l0eSk7CiB9CgogICAgICBjb25zdCBzaXplX3R5cGUgX190
bXBfbGVuZ3RoID0gbGVuZ3RoKCk7CiAgICAgIF9NX2xlbmd0aChfX3MubGVuZ3RoKCkpOwogICAg
ICBfX3MuX01fbGVuZ3RoKF9fdG1wX2xlbmd0aCk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9jPgogICAgdHlwZW5hbWUg
YmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPjo6cG9pbnRlcgogICAgYmFzaWNf
c3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPjo6CiAgICBfTV9jcmVhdGUoc2l6ZV90eXBl
JiBfX2NhcGFjaXR5LCBzaXplX3R5cGUgX19vbGRfY2FwYWNpdHkpCiAgICB7CgoKICAgICAgaWYg
KF9fY2FwYWNpdHkgPiBtYXhfc2l6ZSgpKQogc3RkOjpfX3Rocm93X2xlbmd0aF9lcnJvcigoImJh
c2ljX3N0cmluZzo6X01fY3JlYXRlIikpOwoKCgoKICAgICAgaWYgKF9fY2FwYWNpdHkgPiBfX29s
ZF9jYXBhY2l0eSAmJiBfX2NhcGFjaXR5IDwgMiAqIF9fb2xkX2NhcGFjaXR5KQogewogICBfX2Nh
cGFjaXR5ID0gMiAqIF9fb2xkX2NhcGFjaXR5OwoKICAgaWYgKF9fY2FwYWNpdHkgPiBtYXhfc2l6
ZSgpKQogICAgIF9fY2FwYWNpdHkgPSBtYXhfc2l6ZSgpOwogfQoKCgogICAgICByZXR1cm4gX0Fs
bG9jX3RyYWl0czo6YWxsb2NhdGUoX01fZ2V0X2FsbG9jYXRvcigpLCBfX2NhcGFjaXR5ICsgMSk7
CiAgICB9CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMs
IHR5cGVuYW1lIF9BbGxvYz4KICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Jbkl0ZXJhdG9yPgogICAg
ICB2b2lkCiAgICAgIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz46OgogICAg
ICBfTV9jb25zdHJ1Y3QoX0luSXRlcmF0b3IgX19iZWcsIF9Jbkl0ZXJhdG9yIF9fZW5kLAogICAg
IHN0ZDo6aW5wdXRfaXRlcmF0b3JfdGFnKQogICAgICB7CiBzaXplX3R5cGUgX19sZW4gPSAwOwog
c2l6ZV90eXBlIF9fY2FwYWNpdHkgPSBzaXplX3R5cGUoX1NfbG9jYWxfY2FwYWNpdHkpOwoKIHdo
aWxlIChfX2JlZyAhPSBfX2VuZCAmJiBfX2xlbiA8IF9fY2FwYWNpdHkpCiAgIHsKICAgICBfTV9k
YXRhKClbX19sZW4rK10gPSAqX19iZWc7CiAgICAgKytfX2JlZzsKICAgfQoKIHRyeQogICB7CiAg
ICAgd2hpbGUgKF9fYmVnICE9IF9fZW5kKQogICAgICAgewogIGlmIChfX2xlbiA9PSBfX2NhcGFj
aXR5KQogICAgewoKICAgICAgX19jYXBhY2l0eSA9IF9fbGVuICsgMTsKICAgICAgcG9pbnRlciBf
X2Fub3RoZXIgPSBfTV9jcmVhdGUoX19jYXBhY2l0eSwgX19sZW4pOwogICAgICB0aGlzLT5fU19j
b3B5KF9fYW5vdGhlciwgX01fZGF0YSgpLCBfX2xlbik7CiAgICAgIF9NX2Rpc3Bvc2UoKTsKICAg
ICAgX01fZGF0YShfX2Fub3RoZXIpOwogICAgICBfTV9jYXBhY2l0eShfX2NhcGFjaXR5KTsKICAg
IH0KICBfTV9kYXRhKClbX19sZW4rK10gPSAqX19iZWc7CiAgKytfX2JlZzsKICAgICAgIH0KICAg
fQogY2F0Y2goLi4uKQogICB7CiAgICAgX01fZGlzcG9zZSgpOwogICAgIHRocm93OwogICB9Cgog
X01fc2V0X2xlbmd0aChfX2xlbik7CiAgICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJU
LCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfSW5JdGVyYXRvcj4KICAgICAgdm9pZAogICAgICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJh
aXRzLCBfQWxsb2M+OjoKICAgICAgX01fY29uc3RydWN0KF9Jbkl0ZXJhdG9yIF9fYmVnLCBfSW5J
dGVyYXRvciBfX2VuZCwKICAgICBzdGQ6OmZvcndhcmRfaXRlcmF0b3JfdGFnKQogICAgICB7Cgog
aWYgKF9fZ251X2N4eDo6X19pc19udWxsX3BvaW50ZXIoX19iZWcpICYmIF9fYmVnICE9IF9fZW5k
KQogICBzdGQ6Ol9fdGhyb3dfbG9naWNfZXJyb3IoKCJiYXNpY19zdHJpbmc6OiIgIl9NX2NvbnN0
cnVjdCBudWxsIG5vdCB2YWxpZCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgKTsKCiBzaXplX3R5cGUgX19kbmV3ID0gc3RhdGljX2Nhc3Q8c2l6ZV90eXBlPihzdGQ6
OmRpc3RhbmNlKF9fYmVnLCBfX2VuZCkpOwoKIGlmIChfX2RuZXcgPiBzaXplX3R5cGUoX1NfbG9j
YWxfY2FwYWNpdHkpKQogICB7CiAgICAgX01fZGF0YShfTV9jcmVhdGUoX19kbmV3LCBzaXplX3R5
cGUoMCkpKTsKICAgICBfTV9jYXBhY2l0eShfX2RuZXcpOwogICB9CgoKIHRyeQogICB7IHRoaXMt
Pl9TX2NvcHlfY2hhcnMoX01fZGF0YSgpLCBfX2JlZywgX19lbmQpOyB9CiBjYXRjaCguLi4pCiAg
IHsKICAgICBfTV9kaXNwb3NlKCk7CiAgICAgdGhyb3c7CiAgIH0KCiBfTV9zZXRfbGVuZ3RoKF9f
ZG5ldyk7CiAgICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJh
aXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB2b2lkCiAgICBiYXNpY19zdHJpbmc8X0NoYXJULCBf
VHJhaXRzLCBfQWxsb2M+OjoKICAgIF9NX2NvbnN0cnVjdChzaXplX3R5cGUgX19uLCBfQ2hhclQg
X19jKQogICAgewogICAgICBpZiAoX19uID4gc2l6ZV90eXBlKF9TX2xvY2FsX2NhcGFjaXR5KSkK
IHsKICAgX01fZGF0YShfTV9jcmVhdGUoX19uLCBzaXplX3R5cGUoMCkpKTsKICAgX01fY2FwYWNp
dHkoX19uKTsKIH0KCiAgICAgIGlmIChfX24pCiB0aGlzLT5fU19hc3NpZ24oX01fZGF0YSgpLCBf
X24sIF9fYyk7CgogICAgICBfTV9zZXRfbGVuZ3RoKF9fbik7CiAgICB9CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9jPgogICAgdm9p
ZAogICAgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPjo6CiAgICBfTV9hc3Np
Z24oY29uc3QgYmFzaWNfc3RyaW5nJiBfX3N0cikKICAgIHsKICAgICAgaWYgKHRoaXMgIT0gJl9f
c3RyKQogewogICBjb25zdCBzaXplX3R5cGUgX19yc2l6ZSA9IF9fc3RyLmxlbmd0aCgpOwogICBj
b25zdCBzaXplX3R5cGUgX19jYXBhY2l0eSA9IGNhcGFjaXR5KCk7CgogICBpZiAoX19yc2l6ZSA+
IF9fY2FwYWNpdHkpCiAgICAgewogICAgICAgc2l6ZV90eXBlIF9fbmV3X2NhcGFjaXR5ID0gX19y
c2l6ZTsKICAgICAgIHBvaW50ZXIgX190bXAgPSBfTV9jcmVhdGUoX19uZXdfY2FwYWNpdHksIF9f
Y2FwYWNpdHkpOwogICAgICAgX01fZGlzcG9zZSgpOwogICAgICAgX01fZGF0YShfX3RtcCk7CiAg
ICAgICBfTV9jYXBhY2l0eShfX25ld19jYXBhY2l0eSk7CiAgICAgfQoKICAgaWYgKF9fcnNpemUp
CiAgICAgdGhpcy0+X1NfY29weShfTV9kYXRhKCksIF9fc3RyLl9NX2RhdGEoKSwgX19yc2l6ZSk7
CgogICBfTV9zZXRfbGVuZ3RoKF9fcnNpemUpOwogfQogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHZvaWQKICAg
IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz46OgogICAgcmVzZXJ2ZShzaXpl
X3R5cGUgX19yZXMpCiAgICB7CgogICAgICBpZiAoX19yZXMgPCBsZW5ndGgoKSkKIF9fcmVzID0g
bGVuZ3RoKCk7CgogICAgICBjb25zdCBzaXplX3R5cGUgX19jYXBhY2l0eSA9IGNhcGFjaXR5KCk7
CiAgICAgIGlmIChfX3JlcyAhPSBfX2NhcGFjaXR5KQogewogICBpZiAoX19yZXMgPiBfX2NhcGFj
aXR5CiAgICAgICB8fCBfX3JlcyA+IHNpemVfdHlwZShfU19sb2NhbF9jYXBhY2l0eSkpCiAgICAg
ewogICAgICAgcG9pbnRlciBfX3RtcCA9IF9NX2NyZWF0ZShfX3JlcywgX19jYXBhY2l0eSk7CiAg
ICAgICB0aGlzLT5fU19jb3B5KF9fdG1wLCBfTV9kYXRhKCksIGxlbmd0aCgpICsgMSk7CiAgICAg
ICBfTV9kaXNwb3NlKCk7CiAgICAgICBfTV9kYXRhKF9fdG1wKTsKICAgICAgIF9NX2NhcGFjaXR5
KF9fcmVzKTsKICAgICB9CiAgIGVsc2UgaWYgKCFfTV9pc19sb2NhbCgpKQogICAgIHsKICAgICAg
IHRoaXMtPl9TX2NvcHkoX01fbG9jYWxfZGF0YSgpLCBfTV9kYXRhKCksIGxlbmd0aCgpICsgMSk7
CiAgICAgICBfTV9kZXN0cm95KF9fY2FwYWNpdHkpOwogICAgICAgX01fZGF0YShfTV9sb2NhbF9k
YXRhKCkpOwogICAgIH0KIH0KICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBl
bmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB2b2lkCiAgICBiYXNpY19zdHJpbmc8
X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+OjoKICAgIF9NX211dGF0ZShzaXplX3R5cGUgX19wb3Ms
IHNpemVfdHlwZSBfX2xlbjEsIGNvbnN0IF9DaGFyVCogX19zLAogICAgICAgc2l6ZV90eXBlIF9f
bGVuMikKICAgIHsKICAgICAgY29uc3Qgc2l6ZV90eXBlIF9faG93X211Y2ggPSBsZW5ndGgoKSAt
IF9fcG9zIC0gX19sZW4xOwoKICAgICAgc2l6ZV90eXBlIF9fbmV3X2NhcGFjaXR5ID0gbGVuZ3Ro
KCkgKyBfX2xlbjIgLSBfX2xlbjE7CiAgICAgIHBvaW50ZXIgX19yID0gX01fY3JlYXRlKF9fbmV3
X2NhcGFjaXR5LCBjYXBhY2l0eSgpKTsKCiAgICAgIGlmIChfX3BvcykKIHRoaXMtPl9TX2NvcHko
X19yLCBfTV9kYXRhKCksIF9fcG9zKTsKICAgICAgaWYgKF9fcyAmJiBfX2xlbjIpCiB0aGlzLT5f
U19jb3B5KF9fciArIF9fcG9zLCBfX3MsIF9fbGVuMik7CiAgICAgIGlmIChfX2hvd19tdWNoKQog
dGhpcy0+X1NfY29weShfX3IgKyBfX3BvcyArIF9fbGVuMiwKICAgICAgICBfTV9kYXRhKCkgKyBf
X3BvcyArIF9fbGVuMSwgX19ob3dfbXVjaCk7CgogICAgICBfTV9kaXNwb3NlKCk7CiAgICAgIF9N
X2RhdGEoX19yKTsKICAgICAgX01fY2FwYWNpdHkoX19uZXdfY2FwYWNpdHkpOwogICAgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxv
Yz4KICAgIHZvaWQKICAgIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz46Ogog
ICAgX01fZXJhc2Uoc2l6ZV90eXBlIF9fcG9zLCBzaXplX3R5cGUgX19uKQogICAgewogICAgICBj
b25zdCBzaXplX3R5cGUgX19ob3dfbXVjaCA9IGxlbmd0aCgpIC0gX19wb3MgLSBfX247CgogICAg
ICBpZiAoX19ob3dfbXVjaCAmJiBfX24pCiB0aGlzLT5fU19tb3ZlKF9NX2RhdGEoKSArIF9fcG9z
LCBfTV9kYXRhKCkgKyBfX3BvcyArIF9fbiwgX19ob3dfbXVjaCk7CgogICAgICBfTV9zZXRfbGVu
Z3RoKGxlbmd0aCgpIC0gX19uKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0
eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB2b2lkCiAgICBiYXNpY19zdHJp
bmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+OjoKICAgIHJlc2l6ZShzaXplX3R5cGUgX19uLCBf
Q2hhclQgX19jKQogICAgewogICAgICBjb25zdCBzaXplX3R5cGUgX19zaXplID0gdGhpcy0+c2l6
ZSgpOwogICAgICBpZiAoX19zaXplIDwgX19uKQogdGhpcy0+YXBwZW5kKF9fbiAtIF9fc2l6ZSwg
X19jKTsKICAgICAgZWxzZSBpZiAoX19uIDwgX19zaXplKQogdGhpcy0+X01fZXJhc2UoX19uLCBf
X3NpemUgLSBfX24pOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1l
IF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFp
dHMsIF9BbGxvYz4mCiAgICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+OjoK
ICAgIF9NX2FwcGVuZChjb25zdCBfQ2hhclQqIF9fcywgc2l6ZV90eXBlIF9fbikKICAgIHsKICAg
ICAgY29uc3Qgc2l6ZV90eXBlIF9fbGVuID0gX19uICsgdGhpcy0+c2l6ZSgpOwoKICAgICAgaWYg
KF9fbGVuIDw9IHRoaXMtPmNhcGFjaXR5KCkpCiB7CiAgIGlmIChfX24pCiAgICAgdGhpcy0+X1Nf
Y29weSh0aGlzLT5fTV9kYXRhKCkgKyB0aGlzLT5zaXplKCksIF9fcywgX19uKTsKIH0KICAgICAg
ZWxzZQogdGhpcy0+X01fbXV0YXRlKHRoaXMtPnNpemUoKSwgc2l6ZV90eXBlKDApLCBfX3MsIF9f
bik7CgogICAgICB0aGlzLT5fTV9zZXRfbGVuZ3RoKF9fbGVuKTsKICAgICAgcmV0dXJuICp0aGlz
OwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5
cGVuYW1lIF9BbGxvYz4KICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yPgogICAg
ICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+JgogICAgICBiYXNpY19zdHJp
bmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+OjoKICAgICAgX01fcmVwbGFjZV9kaXNwYXRjaChj
b25zdF9pdGVyYXRvciBfX2kxLCBjb25zdF9pdGVyYXRvciBfX2kyLAogICAgIF9JbnB1dEl0ZXJh
dG9yIF9fazEsIF9JbnB1dEl0ZXJhdG9yIF9fazIsCiAgICAgc3RkOjpfX2ZhbHNlX3R5cGUpCiAg
ICAgIHsKIGNvbnN0IGJhc2ljX3N0cmluZyBfX3MoX19rMSwgX19rMik7CiBjb25zdCBzaXplX3R5
cGUgX19uMSA9IF9faTIgLSBfX2kxOwogcmV0dXJuIF9NX3JlcGxhY2UoX19pMSAtIGJlZ2luKCks
IF9fbjEsIF9fcy5fTV9kYXRhKCksCiAgICAgX19zLnNpemUoKSk7CiAgICAgIH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAg
ICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+JgogICAgYmFzaWNfc3RyaW5n
PF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPjo6CiAgICBfTV9yZXBsYWNlX2F1eChzaXplX3R5cGUg
X19wb3MxLCBzaXplX3R5cGUgX19uMSwgc2l6ZV90eXBlIF9fbjIsCiAgICAgX0NoYXJUIF9fYykK
ICAgIHsKICAgICAgX01fY2hlY2tfbGVuZ3RoKF9fbjEsIF9fbjIsICJiYXNpY19zdHJpbmc6Ol9N
X3JlcGxhY2VfYXV4Iik7CgogICAgICBjb25zdCBzaXplX3R5cGUgX19vbGRfc2l6ZSA9IHRoaXMt
PnNpemUoKTsKICAgICAgY29uc3Qgc2l6ZV90eXBlIF9fbmV3X3NpemUgPSBfX29sZF9zaXplICsg
X19uMiAtIF9fbjE7CgogICAgICBpZiAoX19uZXdfc2l6ZSA8PSB0aGlzLT5jYXBhY2l0eSgpKQog
ewogICBwb2ludGVyIF9fcCA9IHRoaXMtPl9NX2RhdGEoKSArIF9fcG9zMTsKCiAgIGNvbnN0IHNp
emVfdHlwZSBfX2hvd19tdWNoID0gX19vbGRfc2l6ZSAtIF9fcG9zMSAtIF9fbjE7CiAgIGlmIChf
X2hvd19tdWNoICYmIF9fbjEgIT0gX19uMikKICAgICB0aGlzLT5fU19tb3ZlKF9fcCArIF9fbjIs
IF9fcCArIF9fbjEsIF9faG93X211Y2gpOwogfQogICAgICBlbHNlCiB0aGlzLT5fTV9tdXRhdGUo
X19wb3MxLCBfX24xLCAwLCBfX24yKTsKCiAgICAgIGlmIChfX24yKQogdGhpcy0+X1NfYXNzaWdu
KHRoaXMtPl9NX2RhdGEoKSArIF9fcG9zMSwgX19uMiwgX19jKTsKCiAgICAgIHRoaXMtPl9NX3Nl
dF9sZW5ndGgoX19uZXdfc2l6ZSk7CiAgICAgIHJldHVybiAqdGhpczsKICAgIH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAg
ICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+JgogICAgYmFzaWNfc3RyaW5n
PF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPjo6CiAgICBfTV9yZXBsYWNlKHNpemVfdHlwZSBfX3Bv
cywgc2l6ZV90eXBlIF9fbGVuMSwgY29uc3QgX0NoYXJUKiBfX3MsCiAgICAgICAgY29uc3Qgc2l6
ZV90eXBlIF9fbGVuMikKICAgIHsKICAgICAgX01fY2hlY2tfbGVuZ3RoKF9fbGVuMSwgX19sZW4y
LCAiYmFzaWNfc3RyaW5nOjpfTV9yZXBsYWNlIik7CgogICAgICBjb25zdCBzaXplX3R5cGUgX19v
bGRfc2l6ZSA9IHRoaXMtPnNpemUoKTsKICAgICAgY29uc3Qgc2l6ZV90eXBlIF9fbmV3X3NpemUg
PSBfX29sZF9zaXplICsgX19sZW4yIC0gX19sZW4xOwoKICAgICAgaWYgKF9fbmV3X3NpemUgPD0g
dGhpcy0+Y2FwYWNpdHkoKSkKIHsKICAgcG9pbnRlciBfX3AgPSB0aGlzLT5fTV9kYXRhKCkgKyBf
X3BvczsKCiAgIGNvbnN0IHNpemVfdHlwZSBfX2hvd19tdWNoID0gX19vbGRfc2l6ZSAtIF9fcG9z
IC0gX19sZW4xOwogICBpZiAoX01fZGlzanVuY3QoX19zKSkKICAgICB7CiAgICAgICBpZiAoX19o
b3dfbXVjaCAmJiBfX2xlbjEgIT0gX19sZW4yKQogIHRoaXMtPl9TX21vdmUoX19wICsgX19sZW4y
LCBfX3AgKyBfX2xlbjEsIF9faG93X211Y2gpOwogICAgICAgaWYgKF9fbGVuMikKICB0aGlzLT5f
U19jb3B5KF9fcCwgX19zLCBfX2xlbjIpOwogICAgIH0KICAgZWxzZQogICAgIHsKCiAgICAgICBp
ZiAoX19sZW4yICYmIF9fbGVuMiA8PSBfX2xlbjEpCiAgdGhpcy0+X1NfbW92ZShfX3AsIF9fcywg
X19sZW4yKTsKICAgICAgIGlmIChfX2hvd19tdWNoICYmIF9fbGVuMSAhPSBfX2xlbjIpCiAgdGhp
cy0+X1NfbW92ZShfX3AgKyBfX2xlbjIsIF9fcCArIF9fbGVuMSwgX19ob3dfbXVjaCk7CiAgICAg
ICBpZiAoX19sZW4yID4gX19sZW4xKQogIHsKICAgIGlmIChfX3MgKyBfX2xlbjIgPD0gX19wICsg
X19sZW4xKQogICAgICB0aGlzLT5fU19tb3ZlKF9fcCwgX19zLCBfX2xlbjIpOwogICAgZWxzZSBp
ZiAoX19zID49IF9fcCArIF9fbGVuMSkKICAgICAgdGhpcy0+X1NfY29weShfX3AsIF9fcyArIF9f
bGVuMiAtIF9fbGVuMSwgX19sZW4yKTsKICAgIGVsc2UKICAgICAgewogICAgICAgIGNvbnN0IHNp
emVfdHlwZSBfX25sZWZ0ID0gKF9fcCArIF9fbGVuMSkgLSBfX3M7CiAgICAgICAgdGhpcy0+X1Nf
bW92ZShfX3AsIF9fcywgX19ubGVmdCk7CiAgICAgICAgdGhpcy0+X1NfY29weShfX3AgKyBfX25s
ZWZ0LCBfX3AgKyBfX2xlbjIsCiAgICAgICAgX19sZW4yIC0gX19ubGVmdCk7CiAgICAgIH0KICB9
CiAgICAgfQogfQogICAgICBlbHNlCiB0aGlzLT5fTV9tdXRhdGUoX19wb3MsIF9fbGVuMSwgX19z
LCBfX2xlbjIpOwoKICAgICAgdGhpcy0+X01fc2V0X2xlbmd0aChfX25ld19zaXplKTsKICAgICAg
cmV0dXJuICp0aGlzOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1l
IF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHR5cGVuYW1lIGJhc2ljX3N0cmluZzxfQ2hh
clQsIF9UcmFpdHMsIF9BbGxvYz46OnNpemVfdHlwZQogICAgYmFzaWNfc3RyaW5nPF9DaGFyVCwg
X1RyYWl0cywgX0FsbG9jPjo6CiAgICBjb3B5KF9DaGFyVCogX19zLCBzaXplX3R5cGUgX19uLCBz
aXplX3R5cGUgX19wb3MpIGNvbnN0CiAgICB7CiAgICAgIF9NX2NoZWNrKF9fcG9zLCAiYmFzaWNf
c3RyaW5nOjpjb3B5Iik7CiAgICAgIF9fbiA9IF9NX2xpbWl0KF9fcG9zLCBfX24pOwogICAgICA7
CiAgICAgIGlmIChfX24pCiBfU19jb3B5KF9fcywgX01fZGF0YSgpICsgX19wb3MsIF9fbik7Cgog
ICAgICByZXR1cm4gX19uOwogICAgfQojIDExNDUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9iYXNpY19zdHJpbmcudGNjIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFt
ZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJh
aXRzLCBfQWxsb2M+CiAgICBvcGVyYXRvcisoY29uc3QgX0NoYXJUKiBfX2xocywKICAgICAgIGNv
bnN0IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mIF9fcmhzKQogICAgewog
ICAgICA7CiAgICAgIHR5cGVkZWYgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9j
PiBfX3N0cmluZ190eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fc3RyaW5nX3R5cGU6OnNp
emVfdHlwZSBfX3NpemVfdHlwZTsKICAgICAgY29uc3QgX19zaXplX3R5cGUgX19sZW4gPSBfVHJh
aXRzOjpsZW5ndGgoX19saHMpOwogICAgICBfX3N0cmluZ190eXBlIF9fc3RyOwogICAgICBfX3N0
ci5yZXNlcnZlKF9fbGVuICsgX19yaHMuc2l6ZSgpKTsKICAgICAgX19zdHIuYXBwZW5kKF9fbGhz
LCBfX2xlbik7CiAgICAgIF9fc3RyLmFwcGVuZChfX3Jocyk7CiAgICAgIHJldHVybiBfX3N0cjsK
ICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBl
bmFtZSBfQWxsb2M+CiAgICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+CiAg
ICBvcGVyYXRvcisoX0NoYXJUIF9fbGhzLCBjb25zdCBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJh
aXRzLCBfQWxsb2M+JiBfX3JocykKICAgIHsKICAgICAgdHlwZWRlZiBiYXNpY19zdHJpbmc8X0No
YXJULCBfVHJhaXRzLCBfQWxsb2M+IF9fc3RyaW5nX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5h
bWUgX19zdHJpbmdfdHlwZTo6c2l6ZV90eXBlIF9fc2l6ZV90eXBlOwogICAgICBfX3N0cmluZ190
eXBlIF9fc3RyOwogICAgICBjb25zdCBfX3NpemVfdHlwZSBfX2xlbiA9IF9fcmhzLnNpemUoKTsK
ICAgICAgX19zdHIucmVzZXJ2ZShfX2xlbiArIDEpOwogICAgICBfX3N0ci5hcHBlbmQoX19zaXpl
X3R5cGUoMSksIF9fbGhzKTsKICAgICAgX19zdHIuYXBwZW5kKF9fcmhzKTsKICAgICAgcmV0dXJu
IF9fc3RyOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFp
dHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHR5cGVuYW1lIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9U
cmFpdHMsIF9BbGxvYz46OnNpemVfdHlwZQogICAgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0
cywgX0FsbG9jPjo6CiAgICBmaW5kKGNvbnN0IF9DaGFyVCogX19zLCBzaXplX3R5cGUgX19wb3Ms
IHNpemVfdHlwZSBfX24pIGNvbnN0CiAgICB7CiAgICAgIDsKICAgICAgY29uc3Qgc2l6ZV90eXBl
IF9fc2l6ZSA9IHRoaXMtPnNpemUoKTsKICAgICAgY29uc3QgX0NoYXJUKiBfX2RhdGEgPSBfTV9k
YXRhKCk7CgogICAgICBpZiAoX19uID09IDApCiByZXR1cm4gX19wb3MgPD0gX19zaXplID8gX19w
b3MgOiBucG9zOwoKICAgICAgaWYgKF9fbiA8PSBfX3NpemUpCiB7CiAgIGZvciAoOyBfX3BvcyA8
PSBfX3NpemUgLSBfX247ICsrX19wb3MpCiAgICAgaWYgKHRyYWl0c190eXBlOjplcShfX2RhdGFb
X19wb3NdLCBfX3NbMF0pCiAgJiYgdHJhaXRzX3R5cGU6OmNvbXBhcmUoX19kYXRhICsgX19wb3Mg
KyAxLAogICAgIF9fcyArIDEsIF9fbiAtIDEpID09IDApCiAgICAgICByZXR1cm4gX19wb3M7CiB9
CiAgICAgIHJldHVybiBucG9zOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5
cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHR5cGVuYW1lIGJhc2ljX3N0cmlu
ZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz46OnNpemVfdHlwZQogICAgYmFzaWNfc3RyaW5nPF9D
aGFyVCwgX1RyYWl0cywgX0FsbG9jPjo6CiAgICBmaW5kKF9DaGFyVCBfX2MsIHNpemVfdHlwZSBf
X3BvcykgY29uc3Qgbm9leGNlcHQKICAgIHsKICAgICAgc2l6ZV90eXBlIF9fcmV0ID0gbnBvczsK
ICAgICAgY29uc3Qgc2l6ZV90eXBlIF9fc2l6ZSA9IHRoaXMtPnNpemUoKTsKICAgICAgaWYgKF9f
cG9zIDwgX19zaXplKQogewogICBjb25zdCBfQ2hhclQqIF9fZGF0YSA9IF9NX2RhdGEoKTsKICAg
Y29uc3Qgc2l6ZV90eXBlIF9fbiA9IF9fc2l6ZSAtIF9fcG9zOwogICBjb25zdCBfQ2hhclQqIF9f
cCA9IHRyYWl0c190eXBlOjpmaW5kKF9fZGF0YSArIF9fcG9zLCBfX24sIF9fYyk7CiAgIGlmIChf
X3ApCiAgICAgX19yZXQgPSBfX3AgLSBfX2RhdGE7CiB9CiAgICAgIHJldHVybiBfX3JldDsKICAg
IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFt
ZSBfQWxsb2M+CiAgICB0eXBlbmFtZSBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxs
b2M+OjpzaXplX3R5cGUKICAgIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz46
OgogICAgcmZpbmQoY29uc3QgX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX3Bvcywgc2l6ZV90eXBl
IF9fbikgY29uc3QKICAgIHsKICAgICAgOwogICAgICBjb25zdCBzaXplX3R5cGUgX19zaXplID0g
dGhpcy0+c2l6ZSgpOwogICAgICBpZiAoX19uIDw9IF9fc2l6ZSkKIHsKICAgX19wb3MgPSBzdGQ6
Om1pbihzaXplX3R5cGUoX19zaXplIC0gX19uKSwgX19wb3MpOwogICBjb25zdCBfQ2hhclQqIF9f
ZGF0YSA9IF9NX2RhdGEoKTsKICAgZG8KICAgICB7CiAgICAgICBpZiAodHJhaXRzX3R5cGU6OmNv
bXBhcmUoX19kYXRhICsgX19wb3MsIF9fcywgX19uKSA9PSAwKQogIHJldHVybiBfX3BvczsKICAg
ICB9CiAgIHdoaWxlIChfX3Bvcy0tID4gMCk7CiB9CiAgICAgIHJldHVybiBucG9zOwogICAgfQoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9B
bGxvYz4KICAgIHR5cGVuYW1lIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz46
OnNpemVfdHlwZQogICAgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPjo6CiAg
ICByZmluZChfQ2hhclQgX19jLCBzaXplX3R5cGUgX19wb3MpIGNvbnN0IG5vZXhjZXB0CiAgICB7
CiAgICAgIHNpemVfdHlwZSBfX3NpemUgPSB0aGlzLT5zaXplKCk7CiAgICAgIGlmIChfX3NpemUp
CiB7CiAgIGlmICgtLV9fc2l6ZSA+IF9fcG9zKQogICAgIF9fc2l6ZSA9IF9fcG9zOwogICBmb3Ig
KCsrX19zaXplOyBfX3NpemUtLSA+IDA7ICkKICAgICBpZiAodHJhaXRzX3R5cGU6OmVxKF9NX2Rh
dGEoKVtfX3NpemVdLCBfX2MpKQogICAgICAgcmV0dXJuIF9fc2l6ZTsKIH0KICAgICAgcmV0dXJu
IG5wb3M7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0
cywgdHlwZW5hbWUgX0FsbG9jPgogICAgdHlwZW5hbWUgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1Ry
YWl0cywgX0FsbG9jPjo6c2l6ZV90eXBlCiAgICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRz
LCBfQWxsb2M+OjoKICAgIGZpbmRfZmlyc3Rfb2YoY29uc3QgX0NoYXJUKiBfX3MsIHNpemVfdHlw
ZSBfX3Bvcywgc2l6ZV90eXBlIF9fbikgY29uc3QKICAgIHsKICAgICAgOwogICAgICBmb3IgKDsg
X19uICYmIF9fcG9zIDwgdGhpcy0+c2l6ZSgpOyArK19fcG9zKQogewogICBjb25zdCBfQ2hhclQq
IF9fcCA9IHRyYWl0c190eXBlOjpmaW5kKF9fcywgX19uLCBfTV9kYXRhKClbX19wb3NdKTsKICAg
aWYgKF9fcCkKICAgICByZXR1cm4gX19wb3M7CiB9CiAgICAgIHJldHVybiBucG9zOwogICAgfQoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9B
bGxvYz4KICAgIHR5cGVuYW1lIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz46
OnNpemVfdHlwZQogICAgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPjo6CiAg
ICBmaW5kX2xhc3Rfb2YoY29uc3QgX0NoYXJUKiBfX3MsIHNpemVfdHlwZSBfX3Bvcywgc2l6ZV90
eXBlIF9fbikgY29uc3QKICAgIHsKICAgICAgOwogICAgICBzaXplX3R5cGUgX19zaXplID0gdGhp
cy0+c2l6ZSgpOwogICAgICBpZiAoX19zaXplICYmIF9fbikKIHsKICAgaWYgKC0tX19zaXplID4g
X19wb3MpCiAgICAgX19zaXplID0gX19wb3M7CiAgIGRvCiAgICAgewogICAgICAgaWYgKHRyYWl0
c190eXBlOjpmaW5kKF9fcywgX19uLCBfTV9kYXRhKClbX19zaXplXSkpCiAgcmV0dXJuIF9fc2l6
ZTsKICAgICB9CiAgIHdoaWxlIChfX3NpemUtLSAhPSAwKTsKIH0KICAgICAgcmV0dXJuIG5wb3M7
CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlw
ZW5hbWUgX0FsbG9jPgogICAgdHlwZW5hbWUgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywg
X0FsbG9jPjo6c2l6ZV90eXBlCiAgICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxs
b2M+OjoKICAgIGZpbmRfZmlyc3Rfbm90X29mKGNvbnN0IF9DaGFyVCogX19zLCBzaXplX3R5cGUg
X19wb3MsIHNpemVfdHlwZSBfX24pIGNvbnN0CiAgICB7CiAgICAgIDsKICAgICAgZm9yICg7IF9f
cG9zIDwgdGhpcy0+c2l6ZSgpOyArK19fcG9zKQogaWYgKCF0cmFpdHNfdHlwZTo6ZmluZChfX3Ms
IF9fbiwgX01fZGF0YSgpW19fcG9zXSkpCiAgIHJldHVybiBfX3BvczsKICAgICAgcmV0dXJuIG5w
b3M7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywg
dHlwZW5hbWUgX0FsbG9jPgogICAgdHlwZW5hbWUgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0
cywgX0FsbG9jPjo6c2l6ZV90eXBlCiAgICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBf
QWxsb2M+OjoKICAgIGZpbmRfZmlyc3Rfbm90X29mKF9DaGFyVCBfX2MsIHNpemVfdHlwZSBfX3Bv
cykgY29uc3Qgbm9leGNlcHQKICAgIHsKICAgICAgZm9yICg7IF9fcG9zIDwgdGhpcy0+c2l6ZSgp
OyArK19fcG9zKQogaWYgKCF0cmFpdHNfdHlwZTo6ZXEoX01fZGF0YSgpW19fcG9zXSwgX19jKSkK
ICAgcmV0dXJuIF9fcG9zOwogICAgICByZXR1cm4gbnBvczsKICAgIH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB0eXBl
bmFtZSBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+OjpzaXplX3R5cGUKICAg
IGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz46OgogICAgZmluZF9sYXN0X25v
dF9vZihjb25zdCBfQ2hhclQqIF9fcywgc2l6ZV90eXBlIF9fcG9zLCBzaXplX3R5cGUgX19uKSBj
b25zdAogICAgewogICAgICA7CiAgICAgIHNpemVfdHlwZSBfX3NpemUgPSB0aGlzLT5zaXplKCk7
CiAgICAgIGlmIChfX3NpemUpCiB7CiAgIGlmICgtLV9fc2l6ZSA+IF9fcG9zKQogICAgIF9fc2l6
ZSA9IF9fcG9zOwogICBkbwogICAgIHsKICAgICAgIGlmICghdHJhaXRzX3R5cGU6OmZpbmQoX19z
LCBfX24sIF9NX2RhdGEoKVtfX3NpemVdKSkKICByZXR1cm4gX19zaXplOwogICAgIH0KICAgd2hp
bGUgKF9fc2l6ZS0tKTsKIH0KICAgICAgcmV0dXJuIG5wb3M7CiAgICB9CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9jPgogICAgdHlw
ZW5hbWUgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPjo6c2l6ZV90eXBlCiAg
ICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+OjoKICAgIGZpbmRfbGFzdF9u
b3Rfb2YoX0NoYXJUIF9fYywgc2l6ZV90eXBlIF9fcG9zKSBjb25zdCBub2V4Y2VwdAogICAgewog
ICAgICBzaXplX3R5cGUgX19zaXplID0gdGhpcy0+c2l6ZSgpOwogICAgICBpZiAoX19zaXplKQog
ewogICBpZiAoLS1fX3NpemUgPiBfX3BvcykKICAgICBfX3NpemUgPSBfX3BvczsKICAgZG8KICAg
ICB7CiAgICAgICBpZiAoIXRyYWl0c190eXBlOjplcShfTV9kYXRhKClbX19zaXplXSwgX19jKSkK
ICByZXR1cm4gX19zaXplOwogICAgIH0KICAgd2hpbGUgKF9fc2l6ZS0tKTsKIH0KICAgICAgcmV0
dXJuIG5wb3M7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1Ry
YWl0cywgdHlwZW5hbWUgX0FsbG9jPgogICAgaW50CiAgICBiYXNpY19zdHJpbmc8X0NoYXJULCBf
VHJhaXRzLCBfQWxsb2M+OjoKICAgIGNvbXBhcmUoc2l6ZV90eXBlIF9fcG9zLCBzaXplX3R5cGUg
X19uLCBjb25zdCBiYXNpY19zdHJpbmcmIF9fc3RyKSBjb25zdAogICAgewogICAgICBfTV9jaGVj
ayhfX3BvcywgImJhc2ljX3N0cmluZzo6Y29tcGFyZSIpOwogICAgICBfX24gPSBfTV9saW1pdChf
X3BvcywgX19uKTsKICAgICAgY29uc3Qgc2l6ZV90eXBlIF9fb3NpemUgPSBfX3N0ci5zaXplKCk7
CiAgICAgIGNvbnN0IHNpemVfdHlwZSBfX2xlbiA9IHN0ZDo6bWluKF9fbiwgX19vc2l6ZSk7CiAg
ICAgIGludCBfX3IgPSB0cmFpdHNfdHlwZTo6Y29tcGFyZShfTV9kYXRhKCkgKyBfX3BvcywgX19z
dHIuZGF0YSgpLCBfX2xlbik7CiAgICAgIGlmICghX19yKQogX19yID0gX1NfY29tcGFyZShfX24s
IF9fb3NpemUpOwogICAgICByZXR1cm4gX19yOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
Q2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGludAogICAgYmFz
aWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPjo6CiAgICBjb21wYXJlKHNpemVfdHlw
ZSBfX3BvczEsIHNpemVfdHlwZSBfX24xLCBjb25zdCBiYXNpY19zdHJpbmcmIF9fc3RyLAogICAg
IHNpemVfdHlwZSBfX3BvczIsIHNpemVfdHlwZSBfX24yKSBjb25zdAogICAgewogICAgICBfTV9j
aGVjayhfX3BvczEsICJiYXNpY19zdHJpbmc6OmNvbXBhcmUiKTsKICAgICAgX19zdHIuX01fY2hl
Y2soX19wb3MyLCAiYmFzaWNfc3RyaW5nOjpjb21wYXJlIik7CiAgICAgIF9fbjEgPSBfTV9saW1p
dChfX3BvczEsIF9fbjEpOwogICAgICBfX24yID0gX19zdHIuX01fbGltaXQoX19wb3MyLCBfX24y
KTsKICAgICAgY29uc3Qgc2l6ZV90eXBlIF9fbGVuID0gc3RkOjptaW4oX19uMSwgX19uMik7CiAg
ICAgIGludCBfX3IgPSB0cmFpdHNfdHlwZTo6Y29tcGFyZShfTV9kYXRhKCkgKyBfX3BvczEsCiAg
ICAgICAgIF9fc3RyLmRhdGEoKSArIF9fcG9zMiwgX19sZW4pOwogICAgICBpZiAoIV9fcikKIF9f
ciA9IF9TX2NvbXBhcmUoX19uMSwgX19uMik7CiAgICAgIHJldHVybiBfX3I7CiAgICB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9j
PgogICAgaW50CiAgICBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+OjoKICAg
IGNvbXBhcmUoY29uc3QgX0NoYXJUKiBfX3MpIGNvbnN0CiAgICB7CiAgICAgIDsKICAgICAgY29u
c3Qgc2l6ZV90eXBlIF9fc2l6ZSA9IHRoaXMtPnNpemUoKTsKICAgICAgY29uc3Qgc2l6ZV90eXBl
IF9fb3NpemUgPSB0cmFpdHNfdHlwZTo6bGVuZ3RoKF9fcyk7CiAgICAgIGNvbnN0IHNpemVfdHlw
ZSBfX2xlbiA9IHN0ZDo6bWluKF9fc2l6ZSwgX19vc2l6ZSk7CiAgICAgIGludCBfX3IgPSB0cmFp
dHNfdHlwZTo6Y29tcGFyZShfTV9kYXRhKCksIF9fcywgX19sZW4pOwogICAgICBpZiAoIV9fcikK
IF9fciA9IF9TX2NvbXBhcmUoX19zaXplLCBfX29zaXplKTsKICAgICAgcmV0dXJuIF9fcjsKICAg
IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFt
ZSBfQWxsb2M+CiAgICBpbnQKICAgIGJhc2ljX3N0cmluZyA8X0NoYXJULCBfVHJhaXRzLCBfQWxs
b2M+OjoKICAgIGNvbXBhcmUoc2l6ZV90eXBlIF9fcG9zLCBzaXplX3R5cGUgX19uMSwgY29uc3Qg
X0NoYXJUKiBfX3MpIGNvbnN0CiAgICB7CiAgICAgIDsKICAgICAgX01fY2hlY2soX19wb3MsICJi
YXNpY19zdHJpbmc6OmNvbXBhcmUiKTsKICAgICAgX19uMSA9IF9NX2xpbWl0KF9fcG9zLCBfX24x
KTsKICAgICAgY29uc3Qgc2l6ZV90eXBlIF9fb3NpemUgPSB0cmFpdHNfdHlwZTo6bGVuZ3RoKF9f
cyk7CiAgICAgIGNvbnN0IHNpemVfdHlwZSBfX2xlbiA9IHN0ZDo6bWluKF9fbjEsIF9fb3NpemUp
OwogICAgICBpbnQgX19yID0gdHJhaXRzX3R5cGU6OmNvbXBhcmUoX01fZGF0YSgpICsgX19wb3Ms
IF9fcywgX19sZW4pOwogICAgICBpZiAoIV9fcikKIF9fciA9IF9TX2NvbXBhcmUoX19uMSwgX19v
c2l6ZSk7CiAgICAgIHJldHVybiBfX3I7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFy
VCwgdHlwZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9jPgogICAgaW50CiAgICBiYXNpY19z
dHJpbmcgPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPjo6CiAgICBjb21wYXJlKHNpemVfdHlwZSBf
X3Bvcywgc2l6ZV90eXBlIF9fbjEsIGNvbnN0IF9DaGFyVCogX19zLAogICAgIHNpemVfdHlwZSBf
X24yKSBjb25zdAogICAgewogICAgICA7CiAgICAgIF9NX2NoZWNrKF9fcG9zLCAiYmFzaWNfc3Ry
aW5nOjpjb21wYXJlIik7CiAgICAgIF9fbjEgPSBfTV9saW1pdChfX3BvcywgX19uMSk7CiAgICAg
IGNvbnN0IHNpemVfdHlwZSBfX2xlbiA9IHN0ZDo6bWluKF9fbjEsIF9fbjIpOwogICAgICBpbnQg
X19yID0gdHJhaXRzX3R5cGU6OmNvbXBhcmUoX01fZGF0YSgpICsgX19wb3MsIF9fcywgX19sZW4p
OwogICAgICBpZiAoIV9fcikKIF9fciA9IF9TX2NvbXBhcmUoX19uMSwgX19uMik7CiAgICAgIHJl
dHVybiBfX3I7CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9U
cmFpdHMsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRz
PiYKICAgIG9wZXJhdG9yPj4oYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JiBfX2luLAog
ICAgICAgIGJhc2ljX3N0cmluZzxfQ2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mIF9fc3RyKQogICAg
ewogICAgICB0eXBlZGVmIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiBfX2lzdHJlYW1f
dHlwZTsKICAgICAgdHlwZWRlZiBiYXNpY19zdHJpbmc8X0NoYXJULCBfVHJhaXRzLCBfQWxsb2M+
IF9fc3RyaW5nX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19pc3RyZWFtX3R5cGU6Omlv
c19iYXNlIF9faW9zX2Jhc2U7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19pc3RyZWFtX3R5cGU6
OmludF90eXBlIF9faW50X3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19zdHJpbmdfdHlw
ZTo6c2l6ZV90eXBlIF9fc2l6ZV90eXBlOwogICAgICB0eXBlZGVmIGN0eXBlPF9DaGFyVD4gX19j
dHlwZV90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fY3R5cGVfdHlwZTo6Y3R5cGVfYmFz
ZSBfX2N0eXBlX2Jhc2U7CgogICAgICBfX3NpemVfdHlwZSBfX2V4dHJhY3RlZCA9IDA7CiAgICAg
IHR5cGVuYW1lIF9faW9zX2Jhc2U6Omlvc3RhdGUgX19lcnIgPSBfX2lvc19iYXNlOjpnb29kYml0
OwogICAgICB0eXBlbmFtZSBfX2lzdHJlYW1fdHlwZTo6c2VudHJ5IF9fY2VyYihfX2luLCBmYWxz
ZSk7CiAgICAgIGlmIChfX2NlcmIpCiB7CiAgIHRyeQogICAgIHsKCiAgICAgICBfX3N0ci5lcmFz
ZSgpOwogICAgICAgX0NoYXJUIF9fYnVmWzEyOF07CiAgICAgICBfX3NpemVfdHlwZSBfX2xlbiA9
IDA7CiAgICAgICBjb25zdCBzdHJlYW1zaXplIF9fdyA9IF9faW4ud2lkdGgoKTsKICAgICAgIGNv
bnN0IF9fc2l6ZV90eXBlIF9fbiA9IF9fdyA+IDAgPyBzdGF0aWNfY2FzdDxfX3NpemVfdHlwZT4o
X193KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogX19zdHIubWF4X3NpemUoKTsK
ICAgICAgIGNvbnN0IF9fY3R5cGVfdHlwZSYgX19jdCA9IHVzZV9mYWNldDxfX2N0eXBlX3R5cGU+
KF9faW4uZ2V0bG9jKCkpOwogICAgICAgY29uc3QgX19pbnRfdHlwZSBfX2VvZiA9IF9UcmFpdHM6
OmVvZigpOwogICAgICAgX19pbnRfdHlwZSBfX2MgPSBfX2luLnJkYnVmKCktPnNnZXRjKCk7Cgog
ICAgICAgd2hpbGUgKF9fZXh0cmFjdGVkIDwgX19uCiAgICAgICAmJiAhX1RyYWl0czo6ZXFfaW50
X3R5cGUoX19jLCBfX2VvZikKICAgICAgICYmICFfX2N0LmlzKF9fY3R5cGVfYmFzZTo6c3BhY2Us
CiAgICAgX1RyYWl0czo6dG9fY2hhcl90eXBlKF9fYykpKQogIHsKICAgIGlmIChfX2xlbiA9PSBz
aXplb2YoX19idWYpIC8gc2l6ZW9mKF9DaGFyVCkpCiAgICAgIHsKICAgICAgICBfX3N0ci5hcHBl
bmQoX19idWYsIHNpemVvZihfX2J1ZikgLyBzaXplb2YoX0NoYXJUKSk7CiAgICAgICAgX19sZW4g
PSAwOwogICAgICB9CiAgICBfX2J1ZltfX2xlbisrXSA9IF9UcmFpdHM6OnRvX2NoYXJfdHlwZShf
X2MpOwogICAgKytfX2V4dHJhY3RlZDsKICAgIF9fYyA9IF9faW4ucmRidWYoKS0+c25leHRjKCk7
CiAgfQogICAgICAgX19zdHIuYXBwZW5kKF9fYnVmLCBfX2xlbik7CgogICAgICAgaWYgKF9UcmFp
dHM6OmVxX2ludF90eXBlKF9fYywgX19lb2YpKQogIF9fZXJyIHw9IF9faW9zX2Jhc2U6OmVvZmJp
dDsKICAgICAgIF9faW4ud2lkdGgoMCk7CiAgICAgfQogICBjYXRjaChfX2N4eGFiaXYxOjpfX2Zv
cmNlZF91bndpbmQmKQogICAgIHsKICAgICAgIF9faW4uX01fc2V0c3RhdGUoX19pb3NfYmFzZTo6
YmFkYml0KTsKICAgICAgIHRocm93OwogICAgIH0KICAgY2F0Y2goLi4uKQogICAgIHsKCgoKICAg
ICAgIF9faW4uX01fc2V0c3RhdGUoX19pb3NfYmFzZTo6YmFkYml0KTsKICAgICB9CiB9CgogICAg
ICBpZiAoIV9fZXh0cmFjdGVkKQogX19lcnIgfD0gX19pb3NfYmFzZTo6ZmFpbGJpdDsKICAgICAg
aWYgKF9fZXJyKQogX19pbi5zZXRzdGF0ZShfX2Vycik7CiAgICAgIHJldHVybiBfX2luOwogICAg
fQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMsIHR5cGVuYW1l
IF9BbGxvYz4KICAgIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiYKICAgIGdldGxpbmUo
YmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JiBfX2luLAogICAgIGJhc2ljX3N0cmluZzxf
Q2hhclQsIF9UcmFpdHMsIF9BbGxvYz4mIF9fc3RyLCBfQ2hhclQgX19kZWxpbSkKICAgIHsKICAg
ICAgdHlwZWRlZiBiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4gX19pc3RyZWFtX3R5cGU7
CiAgICAgIHR5cGVkZWYgYmFzaWNfc3RyaW5nPF9DaGFyVCwgX1RyYWl0cywgX0FsbG9jPiBfX3N0
cmluZ190eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9faXN0cmVhbV90eXBlOjppb3NfYmFz
ZSBfX2lvc19iYXNlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9faXN0cmVhbV90eXBlOjppbnRf
dHlwZSBfX2ludF90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fc3RyaW5nX3R5cGU6OnNp
emVfdHlwZSBfX3NpemVfdHlwZTsKCiAgICAgIF9fc2l6ZV90eXBlIF9fZXh0cmFjdGVkID0gMDsK
ICAgICAgY29uc3QgX19zaXplX3R5cGUgX19uID0gX19zdHIubWF4X3NpemUoKTsKICAgICAgdHlw
ZW5hbWUgX19pb3NfYmFzZTo6aW9zdGF0ZSBfX2VyciA9IF9faW9zX2Jhc2U6Omdvb2RiaXQ7CiAg
ICAgIHR5cGVuYW1lIF9faXN0cmVhbV90eXBlOjpzZW50cnkgX19jZXJiKF9faW4sIHRydWUpOwog
ICAgICBpZiAoX19jZXJiKQogewogICB0cnkKICAgICB7CiAgICAgICBfX3N0ci5lcmFzZSgpOwog
ICAgICAgY29uc3QgX19pbnRfdHlwZSBfX2lkZWxpbSA9IF9UcmFpdHM6OnRvX2ludF90eXBlKF9f
ZGVsaW0pOwogICAgICAgY29uc3QgX19pbnRfdHlwZSBfX2VvZiA9IF9UcmFpdHM6OmVvZigpOwog
ICAgICAgX19pbnRfdHlwZSBfX2MgPSBfX2luLnJkYnVmKCktPnNnZXRjKCk7CgogICAgICAgd2hp
bGUgKF9fZXh0cmFjdGVkIDwgX19uCiAgICAgICAmJiAhX1RyYWl0czo6ZXFfaW50X3R5cGUoX19j
LCBfX2VvZikKICAgICAgICYmICFfVHJhaXRzOjplcV9pbnRfdHlwZShfX2MsIF9faWRlbGltKSkK
ICB7CiAgICBfX3N0ciArPSBfVHJhaXRzOjp0b19jaGFyX3R5cGUoX19jKTsKICAgICsrX19leHRy
YWN0ZWQ7CiAgICBfX2MgPSBfX2luLnJkYnVmKCktPnNuZXh0YygpOwogIH0KCiAgICAgICBpZiAo
X1RyYWl0czo6ZXFfaW50X3R5cGUoX19jLCBfX2VvZikpCiAgX19lcnIgfD0gX19pb3NfYmFzZTo6
ZW9mYml0OwogICAgICAgZWxzZSBpZiAoX1RyYWl0czo6ZXFfaW50X3R5cGUoX19jLCBfX2lkZWxp
bSkpCiAgewogICAgKytfX2V4dHJhY3RlZDsKICAgIF9faW4ucmRidWYoKS0+c2J1bXBjKCk7CiAg
fQogICAgICAgZWxzZQogIF9fZXJyIHw9IF9faW9zX2Jhc2U6OmZhaWxiaXQ7CiAgICAgfQogICBj
YXRjaChfX2N4eGFiaXYxOjpfX2ZvcmNlZF91bndpbmQmKQogICAgIHsKICAgICAgIF9faW4uX01f
c2V0c3RhdGUoX19pb3NfYmFzZTo6YmFkYml0KTsKICAgICAgIHRocm93OwogICAgIH0KICAgY2F0
Y2goLi4uKQogICAgIHsKCgoKICAgICAgIF9faW4uX01fc2V0c3RhdGUoX19pb3NfYmFzZTo6YmFk
Yml0KTsKICAgICB9CiB9CiAgICAgIGlmICghX19leHRyYWN0ZWQpCiBfX2VyciB8PSBfX2lvc19i
YXNlOjpmYWlsYml0OwogICAgICBpZiAoX19lcnIpCiBfX2luLnNldHN0YXRlKF9fZXJyKTsKICAg
ICAgcmV0dXJuIF9faW47CiAgICB9CgoKCgogIGV4dGVybiB0ZW1wbGF0ZSBjbGFzcyBiYXNpY19z
dHJpbmc8Y2hhcj47CiAgZXh0ZXJuIHRlbXBsYXRlCiAgICBiYXNpY19pc3RyZWFtPGNoYXI+Jgog
ICAgb3BlcmF0b3I+PihiYXNpY19pc3RyZWFtPGNoYXI+Jiwgc3RyaW5nJik7CiAgZXh0ZXJuIHRl
bXBsYXRlCiAgICBiYXNpY19vc3RyZWFtPGNoYXI+JgogICAgb3BlcmF0b3I8PChiYXNpY19vc3Ry
ZWFtPGNoYXI+JiwgY29uc3Qgc3RyaW5nJik7CiAgZXh0ZXJuIHRlbXBsYXRlCiAgICBiYXNpY19p
c3RyZWFtPGNoYXI+JgogICAgZ2V0bGluZShiYXNpY19pc3RyZWFtPGNoYXI+Jiwgc3RyaW5nJiwg
Y2hhcik7CiAgZXh0ZXJuIHRlbXBsYXRlCiAgICBiYXNpY19pc3RyZWFtPGNoYXI+JgogICAgZ2V0
bGluZShiYXNpY19pc3RyZWFtPGNoYXI+Jiwgc3RyaW5nJik7CgoKICBleHRlcm4gdGVtcGxhdGUg
Y2xhc3MgYmFzaWNfc3RyaW5nPHdjaGFyX3Q+OwogIGV4dGVybiB0ZW1wbGF0ZQogICAgYmFzaWNf
aXN0cmVhbTx3Y2hhcl90PiYKICAgIG9wZXJhdG9yPj4oYmFzaWNfaXN0cmVhbTx3Y2hhcl90PiYs
IHdzdHJpbmcmKTsKICBleHRlcm4gdGVtcGxhdGUKICAgIGJhc2ljX29zdHJlYW08d2NoYXJfdD4m
CiAgICBvcGVyYXRvcjw8KGJhc2ljX29zdHJlYW08d2NoYXJfdD4mLCBjb25zdCB3c3RyaW5nJik7
CiAgZXh0ZXJuIHRlbXBsYXRlCiAgICBiYXNpY19pc3RyZWFtPHdjaGFyX3Q+JgogICAgZ2V0bGlu
ZShiYXNpY19pc3RyZWFtPHdjaGFyX3Q+Jiwgd3N0cmluZyYsIHdjaGFyX3QpOwogIGV4dGVybiB0
ZW1wbGF0ZQogICAgYmFzaWNfaXN0cmVhbTx3Y2hhcl90PiYKICAgIGdldGxpbmUoYmFzaWNfaXN0
cmVhbTx3Y2hhcl90PiYsIHdzdHJpbmcmKTsKCgoKCn0KIyA1NCAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9zdHJpbmciIDIgMwojIDQxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxl
X2NsYXNzZXMuaCIgMiAzCgoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmls
aXR5X18gKCJkZWZhdWx0IikpKQp7CgojIDYyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
bG9jYWxlX2NsYXNzZXMuaCIgMwogIGNsYXNzIGxvY2FsZQogIHsKICBwdWJsaWM6CgoKICAgIHR5
cGVkZWYgaW50IGNhdGVnb3J5OwoKCiAgICBjbGFzcyBmYWNldDsKICAgIGNsYXNzIGlkOwogICAg
Y2xhc3MgX0ltcGw7CgogICAgZnJpZW5kIGNsYXNzIGZhY2V0OwogICAgZnJpZW5kIGNsYXNzIF9J
bXBsOwoKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9GYWNldD4KICAgICAgZnJpZW5kIGJvb2wKICAg
ICAgaGFzX2ZhY2V0KGNvbnN0IGxvY2FsZSYpIHRocm93KCk7CgogICAgdGVtcGxhdGU8dHlwZW5h
bWUgX0ZhY2V0PgogICAgICBmcmllbmQgY29uc3QgX0ZhY2V0JgogICAgICB1c2VfZmFjZXQoY29u
c3QgbG9jYWxlJik7CgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0NhY2hlPgogICAgICBmcmllbmQg
c3RydWN0IF9fdXNlX2NhY2hlOwojIDk4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9j
YWxlX2NsYXNzZXMuaCIgMwogICAgc3RhdGljIGNvbnN0IGNhdGVnb3J5IG5vbmUgPSAwOwogICAg
c3RhdGljIGNvbnN0IGNhdGVnb3J5IGN0eXBlID0gMUwgPDwgMDsKICAgIHN0YXRpYyBjb25zdCBj
YXRlZ29yeSBudW1lcmljID0gMUwgPDwgMTsKICAgIHN0YXRpYyBjb25zdCBjYXRlZ29yeSBjb2xs
YXRlID0gMUwgPDwgMjsKICAgIHN0YXRpYyBjb25zdCBjYXRlZ29yeSB0aW1lID0gMUwgPDwgMzsK
ICAgIHN0YXRpYyBjb25zdCBjYXRlZ29yeSBtb25ldGFyeSA9IDFMIDw8IDQ7CiAgICBzdGF0aWMg
Y29uc3QgY2F0ZWdvcnkgbWVzc2FnZXMgPSAxTCA8PCA1OwogICAgc3RhdGljIGNvbnN0IGNhdGVn
b3J5IGFsbCA9IChjdHlwZSB8IG51bWVyaWMgfCBjb2xsYXRlIHwKICAgICAgICB0aW1lIHwgbW9u
ZXRhcnkgfCBtZXNzYWdlcyk7CiMgMTE3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9j
YWxlX2NsYXNzZXMuaCIgMwogICAgbG9jYWxlKCkgdGhyb3coKTsKIyAxMjYgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfY2xhc3Nlcy5oIiAzCiAgICBsb2NhbGUoY29uc3QgbG9j
YWxlJiBfX290aGVyKSB0aHJvdygpOwojIDEzNiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L2xvY2FsZV9jbGFzc2VzLmgiIDMKICAgIGV4cGxpY2l0CiAgICBsb2NhbGUoY29uc3QgY2hhciog
X19zKTsKIyAxNTEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfY2xhc3Nlcy5o
IiAzCiAgICBsb2NhbGUoY29uc3QgbG9jYWxlJiBfX2Jhc2UsIGNvbnN0IGNoYXIqIF9fcywgY2F0
ZWdvcnkgX19jYXQpOwojIDE2MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9j
bGFzc2VzLmgiIDMKICAgIGV4cGxpY2l0CiAgICBsb2NhbGUoY29uc3Qgc3RkOjpzdHJpbmcmIF9f
cykgOiBsb2NhbGUoX19zLmNfc3RyKCkpIHsgfQojIDE3NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL2xvY2FsZV9jbGFzc2VzLmgiIDMKICAgIGxvY2FsZShjb25zdCBsb2NhbGUmIF9fYmFz
ZSwgY29uc3Qgc3RkOjpzdHJpbmcmIF9fcywgY2F0ZWdvcnkgX19jYXQpCiAgICA6IGxvY2FsZShf
X2Jhc2UsIF9fcy5jX3N0cigpLCBfX2NhdCkgeyB9CiMgMTkyICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvbG9jYWxlX2NsYXNzZXMuaCIgMwogICAgbG9jYWxlKGNvbnN0IGxvY2FsZSYgX19i
YXNlLCBjb25zdCBsb2NhbGUmIF9fYWRkLCBjYXRlZ29yeSBfX2NhdCk7CiMgMjA1ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2NsYXNzZXMuaCIgMwogICAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0ZhY2V0PgogICAgICBsb2NhbGUoY29uc3QgbG9jYWxlJiBfX290aGVyLCBfRmFjZXQq
IF9fZik7CgoKICAgIH5sb2NhbGUoKSB0aHJvdygpOwojIDIxOSAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL2xvY2FsZV9jbGFzc2VzLmgiIDMKICAgIGNvbnN0IGxvY2FsZSYKICAgIG9wZXJh
dG9yPShjb25zdCBsb2NhbGUmIF9fb3RoZXIpIHRocm93KCk7CiMgMjM0ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvbG9jYWxlX2NsYXNzZXMuaCIgMwogICAgdGVtcGxhdGU8dHlwZW5hbWUg
X0ZhY2V0PgogICAgICBsb2NhbGUKICAgICAgY29tYmluZShjb25zdCBsb2NhbGUmIF9fb3RoZXIp
IGNvbnN0OwoKCgoKCgogICAgX19hdHRyaWJ1dGUgKChfX2FiaV90YWdfXyAoImN4eDExIikpKQog
ICAgc3RyaW5nCiAgICBuYW1lKCkgY29uc3Q7CiMgMjU0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvbG9jYWxlX2NsYXNzZXMuaCIgMwogICAgYm9vbAogICAgb3BlcmF0b3I9PShjb25zdCBs
b2NhbGUmIF9fb3RoZXIpIGNvbnN0IHRocm93KCk7CgoKCgoKCgogICAgYm9vbAogICAgb3BlcmF0
b3IhPShjb25zdCBsb2NhbGUmIF9fb3RoZXIpIGNvbnN0IHRocm93KCkKICAgIHsgcmV0dXJuICEo
dGhpcy0+b3BlcmF0b3I9PShfX290aGVyKSk7IH0KIyAyODIgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9sb2NhbGVfY2xhc3Nlcy5oIiAzCiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhciwg
dHlwZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX0FsbG9jPgogICAgICBib29sCiAgICAgIG9wZXJh
dG9yKCkoY29uc3QgYmFzaWNfc3RyaW5nPF9DaGFyLCBfVHJhaXRzLCBfQWxsb2M+JiBfX3MxLAog
ICBjb25zdCBiYXNpY19zdHJpbmc8X0NoYXIsIF9UcmFpdHMsIF9BbGxvYz4mIF9fczIpIGNvbnN0
OwojIDI5OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9jbGFzc2VzLmgiIDMK
ICAgIHN0YXRpYyBsb2NhbGUKICAgIGdsb2JhbChjb25zdCBsb2NhbGUmIF9fbG9jKTsKCgoKCiAg
ICBzdGF0aWMgY29uc3QgbG9jYWxlJgogICAgY2xhc3NpYygpOwoKICBwcml2YXRlOgoKICAgIF9J
bXBsKiBfTV9pbXBsOwoKCiAgICBzdGF0aWMgX0ltcGwqIF9TX2NsYXNzaWM7CgoKICAgIHN0YXRp
YyBfSW1wbCogX1NfZ2xvYmFsOwoKCgoKCiAgICBzdGF0aWMgY29uc3QgY2hhciogY29uc3QqIGNv
bnN0IF9TX2NhdGVnb3JpZXM7CiMgMzMzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9j
YWxlX2NsYXNzZXMuaCIgMwogICAgZW51bSB7IF9TX2NhdGVnb3JpZXNfc2l6ZSA9IDYgKyA2IH07
CgoKICAgIHN0YXRpYyBfX2d0aHJlYWRfb25jZV90IF9TX29uY2U7CgoKICAgIGV4cGxpY2l0CiAg
ICBsb2NhbGUoX0ltcGwqKSB0aHJvdygpOwoKICAgIHN0YXRpYyB2b2lkCiAgICBfU19pbml0aWFs
aXplKCk7CgogICAgc3RhdGljIHZvaWQKICAgIF9TX2luaXRpYWxpemVfb25jZSgpIHRocm93KCk7
CgogICAgc3RhdGljIGNhdGVnb3J5CiAgICBfU19ub3JtYWxpemVfY2F0ZWdvcnkoY2F0ZWdvcnkp
OwoKICAgIHZvaWQKICAgIF9NX2NvYWxlc2NlKGNvbnN0IGxvY2FsZSYgX19iYXNlLCBjb25zdCBs
b2NhbGUmIF9fYWRkLCBjYXRlZ29yeSBfX2NhdCk7CgoKICAgIHN0YXRpYyBjb25zdCBpZCogY29u
c3QgX1NfdHdpbm5lZF9mYWNldHNbXTsKCiAgfTsKIyAzNzEgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9sb2NhbGVfY2xhc3Nlcy5oIiAzCiAgY2xhc3MgbG9jYWxlOjpmYWNldAogIHsKICBw
cml2YXRlOgogICAgZnJpZW5kIGNsYXNzIGxvY2FsZTsKICAgIGZyaWVuZCBjbGFzcyBsb2NhbGU6
Ol9JbXBsOwoKICAgIG11dGFibGUgX0F0b21pY193b3JkIF9NX3JlZmNvdW50OwoKCiAgICBzdGF0
aWMgX19jX2xvY2FsZSBfU19jX2xvY2FsZTsKCgogICAgc3RhdGljIGNvbnN0IGNoYXIgX1NfY19u
YW1lWzJdOwoKCiAgICBzdGF0aWMgX19ndGhyZWFkX29uY2VfdCBfU19vbmNlOwoKCiAgICBzdGF0
aWMgdm9pZAogICAgX1NfaW5pdGlhbGl6ZV9vbmNlKCk7CgogIHByb3RlY3RlZDoKIyA0MDIgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfY2xhc3Nlcy5oIiAzCiAgICBleHBsaWNp
dAogICAgZmFjZXQoc2l6ZV90IF9fcmVmcyA9IDApIHRocm93KCkgOiBfTV9yZWZjb3VudChfX3Jl
ZnMgPyAxIDogMCkKICAgIHsgfQoKCiAgICB2aXJ0dWFsCiAgICB+ZmFjZXQoKTsKCiAgICBzdGF0
aWMgdm9pZAogICAgX1NfY3JlYXRlX2NfbG9jYWxlKF9fY19sb2NhbGUmIF9fY2xvYywgY29uc3Qg
Y2hhciogX19zLAogICAgICAgICBfX2NfbG9jYWxlIF9fb2xkID0gMCk7CgogICAgc3RhdGljIF9f
Y19sb2NhbGUKICAgIF9TX2Nsb25lX2NfbG9jYWxlKF9fY19sb2NhbGUmIF9fY2xvYykgdGhyb3co
KTsKCiAgICBzdGF0aWMgdm9pZAogICAgX1NfZGVzdHJveV9jX2xvY2FsZShfX2NfbG9jYWxlJiBf
X2Nsb2MpOwoKICAgIHN0YXRpYyBfX2NfbG9jYWxlCiAgICBfU19sY19jdHlwZV9jX2xvY2FsZShf
X2NfbG9jYWxlIF9fY2xvYywgY29uc3QgY2hhciogX19zKTsKCgoKICAgIHN0YXRpYyBfX2NfbG9j
YWxlCiAgICBfU19nZXRfY19sb2NhbGUoKTsKCiAgICBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9f
KSkgc3RhdGljIGNvbnN0IGNoYXIqCiAgICBfU19nZXRfY19uYW1lKCkgdGhyb3coKTsKIyA0Mzgg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfY2xhc3Nlcy5oIiAzCiAgICBmYWNl
dChjb25zdCBmYWNldCYpID0gZGVsZXRlOwoKICAgIGZhY2V0JgogICAgb3BlcmF0b3I9KGNvbnN0
IGZhY2V0JikgPSBkZWxldGU7CgoKICBwcml2YXRlOgogICAgdm9pZAogICAgX01fYWRkX3JlZmVy
ZW5jZSgpIGNvbnN0IHRocm93KCkKICAgIHsgX19nbnVfY3h4OjpfX2F0b21pY19hZGRfZGlzcGF0
Y2goJl9NX3JlZmNvdW50LCAxKTsgfQoKICAgIHZvaWQKICAgIF9NX3JlbW92ZV9yZWZlcmVuY2Uo
KSBjb25zdCB0aHJvdygpCiAgICB7CgogICAgICA7CiAgICAgIGlmIChfX2dudV9jeHg6Ol9fZXhj
aGFuZ2VfYW5kX2FkZF9kaXNwYXRjaCgmX01fcmVmY291bnQsIC0xKSA9PSAxKQogewogICAgICAg
ICAgOwogICB0cnkKICAgICB7IGRlbGV0ZSB0aGlzOyB9CiAgIGNhdGNoKC4uLikKICAgICB7IH0K
IH0KICAgIH0KCiAgICBjbGFzcyBfX3NoaW07CgogICAgY29uc3QgZmFjZXQqIF9NX3Nzb19zaGlt
KGNvbnN0IGlkKikgY29uc3Q7CiAgICBjb25zdCBmYWNldCogX01fY293X3NoaW0oY29uc3QgaWQq
KSBjb25zdDsKICB9OwojIDQ4MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9j
bGFzc2VzLmgiIDMKICBjbGFzcyBsb2NhbGU6OmlkCiAgewogIHByaXZhdGU6CiAgICBmcmllbmQg
Y2xhc3MgbG9jYWxlOwogICAgZnJpZW5kIGNsYXNzIGxvY2FsZTo6X0ltcGw7CgogICAgdGVtcGxh
dGU8dHlwZW5hbWUgX0ZhY2V0PgogICAgICBmcmllbmQgY29uc3QgX0ZhY2V0JgogICAgICB1c2Vf
ZmFjZXQoY29uc3QgbG9jYWxlJik7CgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZhY2V0PgogICAg
ICBmcmllbmQgYm9vbAogICAgICBoYXNfZmFjZXQoY29uc3QgbG9jYWxlJikgdGhyb3coKTsKCgoK
CiAgICBtdXRhYmxlIHNpemVfdCBfTV9pbmRleDsKCgogICAgc3RhdGljIF9BdG9taWNfd29yZCBf
U19yZWZjb3VudDsKCiAgICB2b2lkCiAgICBvcGVyYXRvcj0oY29uc3QgaWQmKTsKCiAgICBpZChj
b25zdCBpZCYpOwoKICBwdWJsaWM6CgoKCiAgICBpZCgpIHsgfQoKICAgIHNpemVfdAogICAgX01f
aWQoKSBjb25zdCB0aHJvdygpOwogIH07CgoKCiAgY2xhc3MgbG9jYWxlOjpfSW1wbAogIHsKICBw
dWJsaWM6CgogICAgZnJpZW5kIGNsYXNzIGxvY2FsZTsKICAgIGZyaWVuZCBjbGFzcyBsb2NhbGU6
OmZhY2V0OwoKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9GYWNldD4KICAgICAgZnJpZW5kIGJvb2wK
ICAgICAgaGFzX2ZhY2V0KGNvbnN0IGxvY2FsZSYpIHRocm93KCk7CgogICAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0ZhY2V0PgogICAgICBmcmllbmQgY29uc3QgX0ZhY2V0JgogICAgICB1c2VfZmFjZXQo
Y29uc3QgbG9jYWxlJik7CgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0NhY2hlPgogICAgICBmcmll
bmQgc3RydWN0IF9fdXNlX2NhY2hlOwoKICBwcml2YXRlOgoKICAgIF9BdG9taWNfd29yZCBfTV9y
ZWZjb3VudDsKICAgIGNvbnN0IGZhY2V0KiogX01fZmFjZXRzOwogICAgc2l6ZV90IF9NX2ZhY2V0
c19zaXplOwogICAgY29uc3QgZmFjZXQqKiBfTV9jYWNoZXM7CiAgICBjaGFyKiogX01fbmFtZXM7
CiAgICBzdGF0aWMgY29uc3QgbG9jYWxlOjppZCogY29uc3QgX1NfaWRfY3R5cGVbXTsKICAgIHN0
YXRpYyBjb25zdCBsb2NhbGU6OmlkKiBjb25zdCBfU19pZF9udW1lcmljW107CiAgICBzdGF0aWMg
Y29uc3QgbG9jYWxlOjppZCogY29uc3QgX1NfaWRfY29sbGF0ZVtdOwogICAgc3RhdGljIGNvbnN0
IGxvY2FsZTo6aWQqIGNvbnN0IF9TX2lkX3RpbWVbXTsKICAgIHN0YXRpYyBjb25zdCBsb2NhbGU6
OmlkKiBjb25zdCBfU19pZF9tb25ldGFyeVtdOwogICAgc3RhdGljIGNvbnN0IGxvY2FsZTo6aWQq
IGNvbnN0IF9TX2lkX21lc3NhZ2VzW107CiAgICBzdGF0aWMgY29uc3QgbG9jYWxlOjppZCogY29u
c3QqIGNvbnN0IF9TX2ZhY2V0X2NhdGVnb3JpZXNbXTsKCiAgICB2b2lkCiAgICBfTV9hZGRfcmVm
ZXJlbmNlKCkgdGhyb3coKQogICAgeyBfX2dudV9jeHg6Ol9fYXRvbWljX2FkZF9kaXNwYXRjaCgm
X01fcmVmY291bnQsIDEpOyB9CgogICAgdm9pZAogICAgX01fcmVtb3ZlX3JlZmVyZW5jZSgpIHRo
cm93KCkKICAgIHsKCiAgICAgIDsKICAgICAgaWYgKF9fZ251X2N4eDo6X19leGNoYW5nZV9hbmRf
YWRkX2Rpc3BhdGNoKCZfTV9yZWZjb3VudCwgLTEpID09IDEpCiB7CiAgICAgICAgICA7CiAgIHRy
eQogICAgIHsgZGVsZXRlIHRoaXM7IH0KICAgY2F0Y2goLi4uKQogICAgIHsgfQogfQogICAgfQoK
ICAgIF9JbXBsKGNvbnN0IF9JbXBsJiwgc2l6ZV90KTsKICAgIF9JbXBsKGNvbnN0IGNoYXIqLCBz
aXplX3QpOwogICAgX0ltcGwoc2l6ZV90KSB0aHJvdygpOwoKICAgfl9JbXBsKCkgdGhyb3coKTsK
CiAgICBfSW1wbChjb25zdCBfSW1wbCYpOwoKICAgIHZvaWQKICAgIG9wZXJhdG9yPShjb25zdCBf
SW1wbCYpOwoKICAgIGJvb2wKICAgIF9NX2NoZWNrX3NhbWVfbmFtZSgpCiAgICB7CiAgICAgIGJv
b2wgX19yZXQgPSB0cnVlOwogICAgICBpZiAoX01fbmFtZXNbMV0pCgogZm9yIChzaXplX3QgX19p
ID0gMDsgX19yZXQgJiYgX19pIDwgX1NfY2F0ZWdvcmllc19zaXplIC0gMTsgKytfX2kpCiAgIF9f
cmV0ID0gX19idWlsdGluX3N0cmNtcChfTV9uYW1lc1tfX2ldLCBfTV9uYW1lc1tfX2kgKyAxXSkg
PT0gMDsKICAgICAgcmV0dXJuIF9fcmV0OwogICAgfQoKICAgIHZvaWQKICAgIF9NX3JlcGxhY2Vf
Y2F0ZWdvcmllcyhjb25zdCBfSW1wbCosIGNhdGVnb3J5KTsKCiAgICB2b2lkCiAgICBfTV9yZXBs
YWNlX2NhdGVnb3J5KGNvbnN0IF9JbXBsKiwgY29uc3QgbG9jYWxlOjppZCogY29uc3QqKTsKCiAg
ICB2b2lkCiAgICBfTV9yZXBsYWNlX2ZhY2V0KGNvbnN0IF9JbXBsKiwgY29uc3QgbG9jYWxlOjpp
ZCopOwoKICAgIHZvaWQKICAgIF9NX2luc3RhbGxfZmFjZXQoY29uc3QgbG9jYWxlOjppZCosIGNv
bnN0IGZhY2V0Kik7CgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZhY2V0PgogICAgICB2b2lkCiAg
ICAgIF9NX2luaXRfZmFjZXQoX0ZhY2V0KiBfX2ZhY2V0KQogICAgICB7IF9NX2luc3RhbGxfZmFj
ZXQoJl9GYWNldDo6aWQsIF9fZmFjZXQpOyB9CgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZhY2V0
PgogICAgICB2b2lkCiAgICAgIF9NX2luaXRfZmFjZXRfdW5jaGVja2VkKF9GYWNldCogX19mYWNl
dCkKICAgICAgewogX19mYWNldC0+X01fYWRkX3JlZmVyZW5jZSgpOwogX01fZmFjZXRzW19GYWNl
dDo6aWQuX01faWQoKV0gPSBfX2ZhY2V0OwogICAgICB9CgogICAgdm9pZAogICAgX01faW5zdGFs
bF9jYWNoZShjb25zdCBmYWNldCosIHNpemVfdCk7CgogICAgdm9pZCBfTV9pbml0X2V4dHJhKGZh
Y2V0KiopOwogICAgdm9pZCBfTV9pbml0X2V4dHJhKHZvaWQqLCB2b2lkKiwgY29uc3QgY2hhcios
IGNvbnN0IGNoYXIqKTsKICB9OwojIDY0MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xv
Y2FsZV9jbGFzc2VzLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBjbGFzcyBf
X2N4eDExOjogY29sbGF0ZSA6IHB1YmxpYyBsb2NhbGU6OmZhY2V0CiAgICB7CiAgICBwdWJsaWM6
CgoKCiAgICAgIHR5cGVkZWYgX0NoYXJUIGNoYXJfdHlwZTsKICAgICAgdHlwZWRlZiBiYXNpY19z
dHJpbmc8X0NoYXJUPiBzdHJpbmdfdHlwZTsKCgogICAgcHJvdGVjdGVkOgoKCiAgICAgIF9fY19s
b2NhbGUgX01fY19sb2NhbGVfY29sbGF0ZTsKCiAgICBwdWJsaWM6CgogICAgICBzdGF0aWMgbG9j
YWxlOjppZCBpZDsKIyA2NjcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfY2xh
c3Nlcy5oIiAzCiAgICAgIGV4cGxpY2l0CiAgICAgIGNvbGxhdGUoc2l6ZV90IF9fcmVmcyA9IDAp
CiAgICAgIDogZmFjZXQoX19yZWZzKSwgX01fY19sb2NhbGVfY29sbGF0ZShfU19nZXRfY19sb2Nh
bGUoKSkKICAgICAgeyB9CiMgNjgxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxl
X2NsYXNzZXMuaCIgMwogICAgICBleHBsaWNpdAogICAgICBjb2xsYXRlKF9fY19sb2NhbGUgX19j
bG9jLCBzaXplX3QgX19yZWZzID0gMCkKICAgICAgOiBmYWNldChfX3JlZnMpLCBfTV9jX2xvY2Fs
ZV9jb2xsYXRlKF9TX2Nsb25lX2NfbG9jYWxlKF9fY2xvYykpCiAgICAgIHsgfQojIDY5OCAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9jbGFzc2VzLmgiIDMKICAgICAgaW50CiAg
ICAgIGNvbXBhcmUoY29uc3QgX0NoYXJUKiBfX2xvMSwgY29uc3QgX0NoYXJUKiBfX2hpMSwKICAg
ICAgIGNvbnN0IF9DaGFyVCogX19sbzIsIGNvbnN0IF9DaGFyVCogX19oaTIpIGNvbnN0CiAgICAg
IHsgcmV0dXJuIHRoaXMtPmRvX2NvbXBhcmUoX19sbzEsIF9faGkxLCBfX2xvMiwgX19oaTIpOyB9
CiMgNzE3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2NsYXNzZXMuaCIgMwog
ICAgICBzdHJpbmdfdHlwZQogICAgICB0cmFuc2Zvcm0oY29uc3QgX0NoYXJUKiBfX2xvLCBjb25z
dCBfQ2hhclQqIF9faGkpIGNvbnN0CiAgICAgIHsgcmV0dXJuIHRoaXMtPmRvX3RyYW5zZm9ybShf
X2xvLCBfX2hpKTsgfQojIDczMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9j
bGFzc2VzLmgiIDMKICAgICAgbG9uZwogICAgICBoYXNoKGNvbnN0IF9DaGFyVCogX19sbywgY29u
c3QgX0NoYXJUKiBfX2hpKSBjb25zdAogICAgICB7IHJldHVybiB0aGlzLT5kb19oYXNoKF9fbG8s
IF9faGkpOyB9CgoKICAgICAgaW50CiAgICAgIF9NX2NvbXBhcmUoY29uc3QgX0NoYXJUKiwgY29u
c3QgX0NoYXJUKikgY29uc3QgdGhyb3coKTsKCiAgICAgIHNpemVfdAogICAgICBfTV90cmFuc2Zv
cm0oX0NoYXJUKiwgY29uc3QgX0NoYXJUKiwgc2l6ZV90KSBjb25zdCB0aHJvdygpOwoKICBwcm90
ZWN0ZWQ6CgogICAgICB2aXJ0dWFsCiAgICAgIH5jb2xsYXRlKCkKICAgICAgeyBfU19kZXN0cm95
X2NfbG9jYWxlKF9NX2NfbG9jYWxlX2NvbGxhdGUpOyB9CiMgNzYwICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvbG9jYWxlX2NsYXNzZXMuaCIgMwogICAgICB2aXJ0dWFsIGludAogICAgICBk
b19jb21wYXJlKGNvbnN0IF9DaGFyVCogX19sbzEsIGNvbnN0IF9DaGFyVCogX19oaTEsCiAgIGNv
bnN0IF9DaGFyVCogX19sbzIsIGNvbnN0IF9DaGFyVCogX19oaTIpIGNvbnN0OwojIDc3NCAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9jbGFzc2VzLmgiIDMKICAgICAgdmlydHVh
bCBzdHJpbmdfdHlwZQogICAgICBkb190cmFuc2Zvcm0oY29uc3QgX0NoYXJUKiBfX2xvLCBjb25z
dCBfQ2hhclQqIF9faGkpIGNvbnN0OwojIDc4NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L2xvY2FsZV9jbGFzc2VzLmgiIDMKICAgICAgdmlydHVhbCBsb25nCiAgICAgIGRvX2hhc2goY29u
c3QgX0NoYXJUKiBfX2xvLCBjb25zdCBfQ2hhclQqIF9faGkpIGNvbnN0OwogICAgfTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgbG9jYWxlOjppZCBjb2xsYXRlPF9DaGFyVD46Omlk
OwoKCiAgdGVtcGxhdGU8PgogICAgaW50CiAgICBjb2xsYXRlPGNoYXI+OjpfTV9jb21wYXJlKGNv
bnN0IGNoYXIqLCBjb25zdCBjaGFyKikgY29uc3QgdGhyb3coKTsKCiAgdGVtcGxhdGU8PgogICAg
c2l6ZV90CiAgICBjb2xsYXRlPGNoYXI+OjpfTV90cmFuc2Zvcm0oY2hhciosIGNvbnN0IGNoYXIq
LCBzaXplX3QpIGNvbnN0IHRocm93KCk7CgoKICB0ZW1wbGF0ZTw+CiAgICBpbnQKICAgIGNvbGxh
dGU8d2NoYXJfdD46Ol9NX2NvbXBhcmUoY29uc3Qgd2NoYXJfdCosIGNvbnN0IHdjaGFyX3QqKSBj
b25zdCB0aHJvdygpOwoKICB0ZW1wbGF0ZTw+CiAgICBzaXplX3QKICAgIGNvbGxhdGU8d2NoYXJf
dD46Ol9NX3RyYW5zZm9ybSh3Y2hhcl90KiwgY29uc3Qgd2NoYXJfdCosIHNpemVfdCkgY29uc3Qg
dGhyb3coKTsKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBjbGFzcyBfX2N4eDEx
OjogY29sbGF0ZV9ieW5hbWUgOiBwdWJsaWMgY29sbGF0ZTxfQ2hhclQ+CiAgICB7CiAgICBwdWJs
aWM6CgoKICAgICAgdHlwZWRlZiBfQ2hhclQgY2hhcl90eXBlOwogICAgICB0eXBlZGVmIGJhc2lj
X3N0cmluZzxfQ2hhclQ+IHN0cmluZ190eXBlOwoKCiAgICAgIGV4cGxpY2l0CiAgICAgIGNvbGxh
dGVfYnluYW1lKGNvbnN0IGNoYXIqIF9fcywgc2l6ZV90IF9fcmVmcyA9IDApCiAgICAgIDogY29s
bGF0ZTxfQ2hhclQ+KF9fcmVmcykKICAgICAgewogaWYgKF9fYnVpbHRpbl9zdHJjbXAoX19zLCAi
QyIpICE9IDAKICAgICAmJiBfX2J1aWx0aW5fc3RyY21wKF9fcywgIlBPU0lYIikgIT0gMCkKICAg
ewogICAgIHRoaXMtPl9TX2Rlc3Ryb3lfY19sb2NhbGUodGhpcy0+X01fY19sb2NhbGVfY29sbGF0
ZSk7CiAgICAgdGhpcy0+X1NfY3JlYXRlX2NfbG9jYWxlKHRoaXMtPl9NX2NfbG9jYWxlX2NvbGxh
dGUsIF9fcyk7CiAgIH0KICAgICAgfQoKCiAgICAgIGV4cGxpY2l0CiAgICAgIGNvbGxhdGVfYnlu
YW1lKGNvbnN0IHN0cmluZyYgX19zLCBzaXplX3QgX19yZWZzID0gMCkKICAgICAgOiBjb2xsYXRl
X2J5bmFtZShfX3MuY19zdHIoKSwgX19yZWZzKSB7IH0KCgogICAgcHJvdGVjdGVkOgogICAgICB2
aXJ0dWFsCiAgICAgIH5jb2xsYXRlX2J5bmFtZSgpIHsgfQogICAgfTsKCgp9CgojIDEgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfY2xhc3Nlcy50Y2MiIDEgMwojIDM3ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2NsYXNzZXMudGNjIiAzCiAgICAgICAKIyAz
OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9jbGFzc2VzLnRjYyIgMwoKbmFt
ZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRmFjZXQ+CiAgICBsb2NhbGU6OgogICAgbG9jYWxlKGNv
bnN0IGxvY2FsZSYgX19vdGhlciwgX0ZhY2V0KiBfX2YpCiAgICB7CiAgICAgIF9NX2ltcGwgPSBu
ZXcgX0ltcGwoKl9fb3RoZXIuX01faW1wbCwgMSk7CgogICAgICB0cnkKIHsgX01faW1wbC0+X01f
aW5zdGFsbF9mYWNldCgmX0ZhY2V0OjppZCwgX19mKTsgfQogICAgICBjYXRjaCguLi4pCiB7CiAg
IF9NX2ltcGwtPl9NX3JlbW92ZV9yZWZlcmVuY2UoKTsKICAgdGhyb3c7CiB9CiAgICAgIGRlbGV0
ZSBbXSBfTV9pbXBsLT5fTV9uYW1lc1swXTsKICAgICAgX01faW1wbC0+X01fbmFtZXNbMF0gPSAw
OwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRmFjZXQ+CiAgICBsb2NhbGUKICAgIGxvY2Fs
ZTo6CiAgICBjb21iaW5lKGNvbnN0IGxvY2FsZSYgX19vdGhlcikgY29uc3QKICAgIHsKICAgICAg
X0ltcGwqIF9fdG1wID0gbmV3IF9JbXBsKCpfTV9pbXBsLCAxKTsKICAgICAgdHJ5CiB7CiAgIF9f
dG1wLT5fTV9yZXBsYWNlX2ZhY2V0KF9fb3RoZXIuX01faW1wbCwgJl9GYWNldDo6aWQpOwogfQog
ICAgICBjYXRjaCguLi4pCiB7CiAgIF9fdG1wLT5fTV9yZW1vdmVfcmVmZXJlbmNlKCk7CiAgIHRo
cm93OwogfQogICAgICByZXR1cm4gbG9jYWxlKF9fdG1wKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBib29s
CiAgICBsb2NhbGU6OgogICAgb3BlcmF0b3IoKShjb25zdCBiYXNpY19zdHJpbmc8X0NoYXJULCBf
VHJhaXRzLCBfQWxsb2M+JiBfX3MxLAogICAgICAgIGNvbnN0IGJhc2ljX3N0cmluZzxfQ2hhclQs
IF9UcmFpdHMsIF9BbGxvYz4mIF9fczIpIGNvbnN0CiAgICB7CiAgICAgIHR5cGVkZWYgc3RkOjpj
b2xsYXRlPF9DaGFyVD4gX19jb2xsYXRlX3R5cGU7CiAgICAgIGNvbnN0IF9fY29sbGF0ZV90eXBl
JiBfX2NvbGxhdGUgPSB1c2VfZmFjZXQ8X19jb2xsYXRlX3R5cGU+KCp0aGlzKTsKICAgICAgcmV0
dXJuIChfX2NvbGxhdGUuY29tcGFyZShfX3MxLmRhdGEoKSwgX19zMS5kYXRhKCkgKyBfX3MxLmxl
bmd0aCgpLAogICAgX19zMi5kYXRhKCksIF9fczIuZGF0YSgpICsgX19zMi5sZW5ndGgoKSkgPCAw
KTsKICAgIH0KIyAxMDIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfY2xhc3Nl
cy50Y2MiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRmFjZXQ+CiAgICBib29sCiAgICBoYXNfZmFj
ZXQoY29uc3QgbG9jYWxlJiBfX2xvYykgdGhyb3coKQogICAgewogICAgICBjb25zdCBzaXplX3Qg
X19pID0gX0ZhY2V0OjppZC5fTV9pZCgpOwogICAgICBjb25zdCBsb2NhbGU6OmZhY2V0KiogX19m
YWNldHMgPSBfX2xvYy5fTV9pbXBsLT5fTV9mYWNldHM7CiAgICAgIHJldHVybiAoX19pIDwgX19s
b2MuX01faW1wbC0+X01fZmFjZXRzX3NpemUKCiAgICAgICAmJiBkeW5hbWljX2Nhc3Q8Y29uc3Qg
X0ZhY2V0Kj4oX19mYWNldHNbX19pXSkpOwoKCgogICAgfQojIDEzMCAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL2xvY2FsZV9jbGFzc2VzLnRjYyIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9G
YWNldD4KICAgIGNvbnN0IF9GYWNldCYKICAgIHVzZV9mYWNldChjb25zdCBsb2NhbGUmIF9fbG9j
KQogICAgewogICAgICBjb25zdCBzaXplX3QgX19pID0gX0ZhY2V0OjppZC5fTV9pZCgpOwogICAg
ICBjb25zdCBsb2NhbGU6OmZhY2V0KiogX19mYWNldHMgPSBfX2xvYy5fTV9pbXBsLT5fTV9mYWNl
dHM7CiAgICAgIGlmIChfX2kgPj0gX19sb2MuX01faW1wbC0+X01fZmFjZXRzX3NpemUgfHwgIV9f
ZmFjZXRzW19faV0pCiAgICAgICAgX190aHJvd19iYWRfY2FzdCgpOwoKICAgICAgcmV0dXJuIGR5
bmFtaWNfY2FzdDxjb25zdCBfRmFjZXQmPigqX19mYWNldHNbX19pXSk7CgoKCiAgICB9CgoKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgaW50CiAgICBjb2xsYXRlPF9DaGFyVD46Ol9N
X2NvbXBhcmUoY29uc3QgX0NoYXJUKiwgY29uc3QgX0NoYXJUKikgY29uc3QgdGhyb3cgKCkKICAg
IHsgcmV0dXJuIDA7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIHNpemVfdAog
ICAgY29sbGF0ZTxfQ2hhclQ+OjpfTV90cmFuc2Zvcm0oX0NoYXJUKiwgY29uc3QgX0NoYXJUKiwg
c2l6ZV90KSBjb25zdCB0aHJvdyAoKQogICAgeyByZXR1cm4gMDsgfQoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfQ2hhclQ+CiAgICBpbnQKICAgIGNvbGxhdGU8X0NoYXJUPjo6CiAgICBkb19jb21wYXJl
KGNvbnN0IF9DaGFyVCogX19sbzEsIGNvbnN0IF9DaGFyVCogX19oaTEsCiAgICAgICAgY29uc3Qg
X0NoYXJUKiBfX2xvMiwgY29uc3QgX0NoYXJUKiBfX2hpMikgY29uc3QKICAgIHsKCgogICAgICBj
b25zdCBzdHJpbmdfdHlwZSBfX29uZShfX2xvMSwgX19oaTEpOwogICAgICBjb25zdCBzdHJpbmdf
dHlwZSBfX3R3byhfX2xvMiwgX19oaTIpOwoKICAgICAgY29uc3QgX0NoYXJUKiBfX3AgPSBfX29u
ZS5jX3N0cigpOwogICAgICBjb25zdCBfQ2hhclQqIF9fcGVuZCA9IF9fb25lLmRhdGEoKSArIF9f
b25lLmxlbmd0aCgpOwogICAgICBjb25zdCBfQ2hhclQqIF9fcSA9IF9fdHdvLmNfc3RyKCk7CiAg
ICAgIGNvbnN0IF9DaGFyVCogX19xZW5kID0gX190d28uZGF0YSgpICsgX190d28ubGVuZ3RoKCk7
CgoKCgogICAgICBmb3IgKDs7KQogewogICBjb25zdCBpbnQgX19yZXMgPSBfTV9jb21wYXJlKF9f
cCwgX19xKTsKICAgaWYgKF9fcmVzKQogICAgIHJldHVybiBfX3JlczsKCiAgIF9fcCArPSBjaGFy
X3RyYWl0czxfQ2hhclQ+OjpsZW5ndGgoX19wKTsKICAgX19xICs9IGNoYXJfdHJhaXRzPF9DaGFy
VD46Omxlbmd0aChfX3EpOwogICBpZiAoX19wID09IF9fcGVuZCAmJiBfX3EgPT0gX19xZW5kKQog
ICAgIHJldHVybiAwOwogICBlbHNlIGlmIChfX3AgPT0gX19wZW5kKQogICAgIHJldHVybiAtMTsK
ICAgZWxzZSBpZiAoX19xID09IF9fcWVuZCkKICAgICByZXR1cm4gMTsKCiAgIF9fcCsrOwogICBf
X3ErKzsKIH0KICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgdHlwZW5hbWUg
Y29sbGF0ZTxfQ2hhclQ+OjpzdHJpbmdfdHlwZQogICAgY29sbGF0ZTxfQ2hhclQ+OjoKICAgIGRv
X3RyYW5zZm9ybShjb25zdCBfQ2hhclQqIF9fbG8sIGNvbnN0IF9DaGFyVCogX19oaSkgY29uc3QK
ICAgIHsKICAgICAgc3RyaW5nX3R5cGUgX19yZXQ7CgoKICAgICAgY29uc3Qgc3RyaW5nX3R5cGUg
X19zdHIoX19sbywgX19oaSk7CgogICAgICBjb25zdCBfQ2hhclQqIF9fcCA9IF9fc3RyLmNfc3Ry
KCk7CiAgICAgIGNvbnN0IF9DaGFyVCogX19wZW5kID0gX19zdHIuZGF0YSgpICsgX19zdHIubGVu
Z3RoKCk7CgogICAgICBzaXplX3QgX19sZW4gPSAoX19oaSAtIF9fbG8pICogMjsKCiAgICAgIF9D
aGFyVCogX19jID0gbmV3IF9DaGFyVFtfX2xlbl07CgogICAgICB0cnkKIHsKCgoKICAgZm9yICg7
OykKICAgICB7CgogICAgICAgc2l6ZV90IF9fcmVzID0gX01fdHJhbnNmb3JtKF9fYywgX19wLCBf
X2xlbik7CgoKICAgICAgIGlmIChfX3JlcyA+PSBfX2xlbikKICB7CiAgICBfX2xlbiA9IF9fcmVz
ICsgMTsKICAgIGRlbGV0ZSBbXSBfX2MsIF9fYyA9IDA7CiAgICBfX2MgPSBuZXcgX0NoYXJUW19f
bGVuXTsKICAgIF9fcmVzID0gX01fdHJhbnNmb3JtKF9fYywgX19wLCBfX2xlbik7CiAgfQoKICAg
ICAgIF9fcmV0LmFwcGVuZChfX2MsIF9fcmVzKTsKICAgICAgIF9fcCArPSBjaGFyX3RyYWl0czxf
Q2hhclQ+OjpsZW5ndGgoX19wKTsKICAgICAgIGlmIChfX3AgPT0gX19wZW5kKQogIGJyZWFrOwoK
ICAgICAgIF9fcCsrOwogICAgICAgX19yZXQucHVzaF9iYWNrKF9DaGFyVCgpKTsKICAgICB9CiB9
CiAgICAgIGNhdGNoKC4uLikKIHsKICAgZGVsZXRlIFtdIF9fYzsKICAgdGhyb3c7CiB9CgogICAg
ICBkZWxldGUgW10gX19jOwoKICAgICAgcmV0dXJuIF9fcmV0OwogICAgfQoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfQ2hhclQ+CiAgICBsb25nCiAgICBjb2xsYXRlPF9DaGFyVD46OgogICAgZG9faGFz
aChjb25zdCBfQ2hhclQqIF9fbG8sIGNvbnN0IF9DaGFyVCogX19oaSkgY29uc3QKICAgIHsKICAg
ICAgdW5zaWduZWQgbG9uZyBfX3ZhbCA9IDA7CiAgICAgIGZvciAoOyBfX2xvIDwgX19oaTsgKytf
X2xvKQogX192YWwgPQogICAqX19sbyArICgoX192YWwgPDwgNykKICAgICB8IChfX3ZhbCA+PiAo
X19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPHVuc2lnbmVkIGxvbmc+OjoKICAgIF9fZGlnaXRz
IC0gNykpKTsKICAgICAgcmV0dXJuIHN0YXRpY19jYXN0PGxvbmc+KF9fdmFsKTsKICAgIH0KCgoK
CiAgZXh0ZXJuIHRlbXBsYXRlIGNsYXNzIGNvbGxhdGU8Y2hhcj47CiAgZXh0ZXJuIHRlbXBsYXRl
IGNsYXNzIGNvbGxhdGVfYnluYW1lPGNoYXI+OwoKICBleHRlcm4gdGVtcGxhdGUKICAgIGNvbnN0
IGNvbGxhdGU8Y2hhcj4mCiAgICB1c2VfZmFjZXQ8Y29sbGF0ZTxjaGFyPiA+KGNvbnN0IGxvY2Fs
ZSYpOwoKICBleHRlcm4gdGVtcGxhdGUKICAgIGJvb2wKICAgIGhhc19mYWNldDxjb2xsYXRlPGNo
YXI+ID4oY29uc3QgbG9jYWxlJik7CgoKICBleHRlcm4gdGVtcGxhdGUgY2xhc3MgY29sbGF0ZTx3
Y2hhcl90PjsKICBleHRlcm4gdGVtcGxhdGUgY2xhc3MgY29sbGF0ZV9ieW5hbWU8d2NoYXJfdD47
CgogIGV4dGVybiB0ZW1wbGF0ZQogICAgY29uc3QgY29sbGF0ZTx3Y2hhcl90PiYKICAgIHVzZV9m
YWNldDxjb2xsYXRlPHdjaGFyX3Q+ID4oY29uc3QgbG9jYWxlJik7CgogIGV4dGVybiB0ZW1wbGF0
ZQogICAgYm9vbAogICAgaGFzX2ZhY2V0PGNvbGxhdGU8d2NoYXJfdD4gPihjb25zdCBsb2NhbGUm
KTsKCgoKCn0KIyA4NTEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfY2xhc3Nl
cy5oIiAyIDMKIyA0MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lvc19iYXNlLmgiIDIg
MwoKCgoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N5c3RlbV9lcnJvciIgMSAzCiMgMzIg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3lzdGVtX2Vycm9yIiAzCiAgICAgICAKIyAzMyAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9zeXN0ZW1fZXJyb3IiIDMKCgoKCgoKIyAxICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2Vycm9yX2NvbnN0YW50cy5oIiAx
IDMKIyAzNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9l
cnJvcl9jb25zdGFudHMuaCIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY2Vycm5vIiAx
IDMKIyAzOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jZXJybm8iIDMKICAgICAgIAojIDQwICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2NlcnJubyIgMwoKCiMgMSAiL3Vzci9pbmNsdWRlL2Vycm5v
LmgiIDEgMyA0CiMgNDMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY2Vycm5vIiAyIDMKIyAzNSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9lcnJvcl9jb25z
dGFudHMuaCIgMiAzCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlf
XyAoImRlZmF1bHQiKSkpCnsKCgogIGVudW0gY2xhc3MgZXJyYwogICAgewogICAgICBhZGRyZXNz
X2ZhbWlseV9ub3Rfc3VwcG9ydGVkID0gOTcsCiAgICAgIGFkZHJlc3NfaW5fdXNlID0gOTgsCiAg
ICAgIGFkZHJlc3Nfbm90X2F2YWlsYWJsZSA9IDk5LAogICAgICBhbHJlYWR5X2Nvbm5lY3RlZCA9
IDEwNiwKICAgICAgYXJndW1lbnRfbGlzdF90b29fbG9uZyA9IDcsCiAgICAgIGFyZ3VtZW50X291
dF9vZl9kb21haW4gPSAzMywKICAgICAgYmFkX2FkZHJlc3MgPSAxNCwKICAgICAgYmFkX2ZpbGVf
ZGVzY3JpcHRvciA9IDksCgoKICAgICAgYmFkX21lc3NhZ2UgPSA3NCwKCgogICAgICBicm9rZW5f
cGlwZSA9IDMyLAogICAgICBjb25uZWN0aW9uX2Fib3J0ZWQgPSAxMDMsCiAgICAgIGNvbm5lY3Rp
b25fYWxyZWFkeV9pbl9wcm9ncmVzcyA9IDExNCwKICAgICAgY29ubmVjdGlvbl9yZWZ1c2VkID0g
MTExLAogICAgICBjb25uZWN0aW9uX3Jlc2V0ID0gMTA0LAogICAgICBjcm9zc19kZXZpY2VfbGlu
ayA9IDE4LAogICAgICBkZXN0aW5hdGlvbl9hZGRyZXNzX3JlcXVpcmVkID0gODksCiAgICAgIGRl
dmljZV9vcl9yZXNvdXJjZV9idXN5ID0gMTYsCiAgICAgIGRpcmVjdG9yeV9ub3RfZW1wdHkgPSAz
OSwKICAgICAgZXhlY3V0YWJsZV9mb3JtYXRfZXJyb3IgPSA4LAogICAgICBmaWxlX2V4aXN0cyA9
IDE3LAogICAgICBmaWxlX3Rvb19sYXJnZSA9IDI3LAogICAgICBmaWxlbmFtZV90b29fbG9uZyA9
IDM2LAogICAgICBmdW5jdGlvbl9ub3Rfc3VwcG9ydGVkID0gMzgsCiAgICAgIGhvc3RfdW5yZWFj
aGFibGUgPSAxMTMsCgoKICAgICAgaWRlbnRpZmllcl9yZW1vdmVkID0gNDMsCgoKICAgICAgaWxs
ZWdhbF9ieXRlX3NlcXVlbmNlID0gODQsCiAgICAgIGluYXBwcm9wcmlhdGVfaW9fY29udHJvbF9v
cGVyYXRpb24gPSAyNSwKICAgICAgaW50ZXJydXB0ZWQgPSA0LAogICAgICBpbnZhbGlkX2FyZ3Vt
ZW50ID0gMjIsCiAgICAgIGludmFsaWRfc2VlayA9IDI5LAogICAgICBpb19lcnJvciA9IDUsCiAg
ICAgIGlzX2FfZGlyZWN0b3J5ID0gMjEsCiAgICAgIG1lc3NhZ2Vfc2l6ZSA9IDkwLAogICAgICBu
ZXR3b3JrX2Rvd24gPSAxMDAsCiAgICAgIG5ldHdvcmtfcmVzZXQgPSAxMDIsCiAgICAgIG5ldHdv
cmtfdW5yZWFjaGFibGUgPSAxMDEsCiAgICAgIG5vX2J1ZmZlcl9zcGFjZSA9IDEwNSwKICAgICAg
bm9fY2hpbGRfcHJvY2VzcyA9IDEwLAoKCiAgICAgIG5vX2xpbmsgPSA2NywKCgogICAgICBub19s
b2NrX2F2YWlsYWJsZSA9IDM3LAoKCiAgICAgIG5vX21lc3NhZ2VfYXZhaWxhYmxlID0gNjEsCgoK
ICAgICAgbm9fbWVzc2FnZSA9IDQyLAogICAgICBub19wcm90b2NvbF9vcHRpb24gPSA5MiwKICAg
ICAgbm9fc3BhY2Vfb25fZGV2aWNlID0gMjgsCgoKICAgICAgbm9fc3RyZWFtX3Jlc291cmNlcyA9
IDYzLAoKCiAgICAgIG5vX3N1Y2hfZGV2aWNlX29yX2FkZHJlc3MgPSA2LAogICAgICBub19zdWNo
X2RldmljZSA9IDE5LAogICAgICBub19zdWNoX2ZpbGVfb3JfZGlyZWN0b3J5ID0gMiwKICAgICAg
bm9fc3VjaF9wcm9jZXNzID0gMywKICAgICAgbm90X2FfZGlyZWN0b3J5ID0gMjAsCiAgICAgIG5v
dF9hX3NvY2tldCA9IDg4LAoKCiAgICAgIG5vdF9hX3N0cmVhbSA9IDYwLAoKCiAgICAgIG5vdF9j
b25uZWN0ZWQgPSAxMDcsCiAgICAgIG5vdF9lbm91Z2hfbWVtb3J5ID0gMTIsCgoKICAgICAgbm90
X3N1cHBvcnRlZCA9IDk1LAoKCgogICAgICBvcGVyYXRpb25fY2FuY2VsZWQgPSAxMjUsCgoKICAg
ICAgb3BlcmF0aW9uX2luX3Byb2dyZXNzID0gMTE1LAogICAgICBvcGVyYXRpb25fbm90X3Blcm1p
dHRlZCA9IDEsCiAgICAgIG9wZXJhdGlvbl9ub3Rfc3VwcG9ydGVkID0gOTUsCiAgICAgIG9wZXJh
dGlvbl93b3VsZF9ibG9jayA9IDExLAoKCiAgICAgIG93bmVyX2RlYWQgPSAxMzAsCgoKICAgICAg
cGVybWlzc2lvbl9kZW5pZWQgPSAxMywKCgogICAgICBwcm90b2NvbF9lcnJvciA9IDcxLAoKCiAg
ICAgIHByb3RvY29sX25vdF9zdXBwb3J0ZWQgPSA5MywKICAgICAgcmVhZF9vbmx5X2ZpbGVfc3lz
dGVtID0gMzAsCiAgICAgIHJlc291cmNlX2RlYWRsb2NrX3dvdWxkX29jY3VyID0gMzUsCiAgICAg
IHJlc291cmNlX3VuYXZhaWxhYmxlX3RyeV9hZ2FpbiA9IDExLAogICAgICByZXN1bHRfb3V0X29m
X3JhbmdlID0gMzQsCgoKICAgICAgc3RhdGVfbm90X3JlY292ZXJhYmxlID0gMTMxLAoKCgogICAg
ICBzdHJlYW1fdGltZW91dCA9IDYyLAoKCgogICAgICB0ZXh0X2ZpbGVfYnVzeSA9IDI2LAoKCiAg
ICAgIHRpbWVkX291dCA9IDExMCwKICAgICAgdG9vX21hbnlfZmlsZXNfb3Blbl9pbl9zeXN0ZW0g
PSAyMywKICAgICAgdG9vX21hbnlfZmlsZXNfb3BlbiA9IDI0LAogICAgICB0b29fbWFueV9saW5r
cyA9IDMxLAogICAgICB0b29fbWFueV9zeW1ib2xpY19saW5rX2xldmVscyA9IDQwLAoKCiAgICAg
IHZhbHVlX3Rvb19sYXJnZSA9IDc1LAoKCiAgICAgIHdyb25nX3Byb3RvY29sX3R5cGUgPSA5MQog
ICAgfTsKCgp9CiMgNDAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3lzdGVtX2Vycm9yIiAyIDMK
CiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zdGRleGNlcHQiIDEgMwojIDM2ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL3N0ZGV4Y2VwdCIgMwogICAgICAgCiMgMzcgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvc3RkZXhjZXB0IiAzCgoKCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChf
X3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgoKCgogIHN0cnVjdCBfX2Nvd19zdHJpbmcK
ICB7CiAgICB1bmlvbiB7CiAgICAgIGNvbnN0IGNoYXIqIF9NX3A7CiAgICAgIGNoYXIgX01fYnl0
ZXNbc2l6ZW9mKGNvbnN0IGNoYXIqKV07CiAgICB9OwoKICAgIF9fY293X3N0cmluZygpOwogICAg
X19jb3dfc3RyaW5nKGNvbnN0IHN0ZDo6c3RyaW5nJik7CiAgICBfX2Nvd19zdHJpbmcoY29uc3Qg
Y2hhciosIHNpemVfdCk7CiAgICBfX2Nvd19zdHJpbmcoY29uc3QgX19jb3dfc3RyaW5nJikgbm9l
eGNlcHQ7CiAgICBfX2Nvd19zdHJpbmcmIG9wZXJhdG9yPShjb25zdCBfX2Nvd19zdHJpbmcmKSBu
b2V4Y2VwdDsKICAgIH5fX2Nvd19zdHJpbmcoKTsKCiAgICBfX2Nvd19zdHJpbmcoX19jb3dfc3Ry
aW5nJiYpIG5vZXhjZXB0OwogICAgX19jb3dfc3RyaW5nJiBvcGVyYXRvcj0oX19jb3dfc3RyaW5n
JiYpIG5vZXhjZXB0OwoKICB9OwoKICB0eXBlZGVmIGJhc2ljX3N0cmluZzxjaGFyPiBfX3Nzb19z
dHJpbmc7CiMgMTEzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0ZGV4Y2VwdCIgMwogIGNsYXNz
IGxvZ2ljX2Vycm9yIDogcHVibGljIGV4Y2VwdGlvbgogIHsKICAgIF9fY293X3N0cmluZyBfTV9t
c2c7CgogIHB1YmxpYzoKCiAgICBleHBsaWNpdAogICAgbG9naWNfZXJyb3IoY29uc3Qgc3RyaW5n
JiBfX2FyZykgOwoKCiAgICBleHBsaWNpdAogICAgbG9naWNfZXJyb3IoY29uc3QgY2hhciopIDsK
CgoKICAgIGxvZ2ljX2Vycm9yKGNvbnN0IGxvZ2ljX2Vycm9yJikgbm9leGNlcHQ7CiAgICBsb2dp
Y19lcnJvciYgb3BlcmF0b3I9KGNvbnN0IGxvZ2ljX2Vycm9yJikgbm9leGNlcHQ7CgoKICAgIHZp
cnR1YWwgfmxvZ2ljX2Vycm9yKCkgbm9leGNlcHQ7CgoKCiAgICB2aXJ0dWFsIGNvbnN0IGNoYXIq
CiAgICB3aGF0KCkgY29uc3Qgbm9leGNlcHQ7CgoKCgoKICB9OwoKCgogIGNsYXNzIGRvbWFpbl9l
cnJvciA6IHB1YmxpYyBsb2dpY19lcnJvcgogIHsKICBwdWJsaWM6CiAgICBleHBsaWNpdCBkb21h
aW5fZXJyb3IoY29uc3Qgc3RyaW5nJiBfX2FyZykgOwoKICAgIGV4cGxpY2l0IGRvbWFpbl9lcnJv
cihjb25zdCBjaGFyKikgOwoKICAgIHZpcnR1YWwgfmRvbWFpbl9lcnJvcigpIG5vZXhjZXB0Owog
IH07CgoKICBjbGFzcyBpbnZhbGlkX2FyZ3VtZW50IDogcHVibGljIGxvZ2ljX2Vycm9yCiAgewog
IHB1YmxpYzoKICAgIGV4cGxpY2l0IGludmFsaWRfYXJndW1lbnQoY29uc3Qgc3RyaW5nJiBfX2Fy
ZykgOwoKICAgIGV4cGxpY2l0IGludmFsaWRfYXJndW1lbnQoY29uc3QgY2hhciopIDsKCiAgICB2
aXJ0dWFsIH5pbnZhbGlkX2FyZ3VtZW50KCkgbm9leGNlcHQ7CiAgfTsKCgoKICBjbGFzcyBsZW5n
dGhfZXJyb3IgOiBwdWJsaWMgbG9naWNfZXJyb3IKICB7CiAgcHVibGljOgogICAgZXhwbGljaXQg
bGVuZ3RoX2Vycm9yKGNvbnN0IHN0cmluZyYgX19hcmcpIDsKCiAgICBleHBsaWNpdCBsZW5ndGhf
ZXJyb3IoY29uc3QgY2hhciopIDsKCiAgICB2aXJ0dWFsIH5sZW5ndGhfZXJyb3IoKSBub2V4Y2Vw
dDsKICB9OwoKCgogIGNsYXNzIG91dF9vZl9yYW5nZSA6IHB1YmxpYyBsb2dpY19lcnJvcgogIHsK
ICBwdWJsaWM6CiAgICBleHBsaWNpdCBvdXRfb2ZfcmFuZ2UoY29uc3Qgc3RyaW5nJiBfX2FyZykg
OwoKICAgIGV4cGxpY2l0IG91dF9vZl9yYW5nZShjb25zdCBjaGFyKikgOwoKICAgIHZpcnR1YWwg
fm91dF9vZl9yYW5nZSgpIG5vZXhjZXB0OwogIH07CgoKCgoKCiAgY2xhc3MgcnVudGltZV9lcnJv
ciA6IHB1YmxpYyBleGNlcHRpb24KICB7CiAgICBfX2Nvd19zdHJpbmcgX01fbXNnOwoKICBwdWJs
aWM6CgogICAgZXhwbGljaXQKICAgIHJ1bnRpbWVfZXJyb3IoY29uc3Qgc3RyaW5nJiBfX2FyZykg
OwoKCiAgICBleHBsaWNpdAogICAgcnVudGltZV9lcnJvcihjb25zdCBjaGFyKikgOwoKCgogICAg
cnVudGltZV9lcnJvcihjb25zdCBydW50aW1lX2Vycm9yJikgbm9leGNlcHQ7CiAgICBydW50aW1l
X2Vycm9yJiBvcGVyYXRvcj0oY29uc3QgcnVudGltZV9lcnJvciYpIG5vZXhjZXB0OwoKCiAgICB2
aXJ0dWFsIH5ydW50aW1lX2Vycm9yKCkgbm9leGNlcHQ7CgoKCiAgICB2aXJ0dWFsIGNvbnN0IGNo
YXIqCiAgICB3aGF0KCkgY29uc3Qgbm9leGNlcHQ7CgoKCgoKICB9OwoKCiAgY2xhc3MgcmFuZ2Vf
ZXJyb3IgOiBwdWJsaWMgcnVudGltZV9lcnJvcgogIHsKICBwdWJsaWM6CiAgICBleHBsaWNpdCBy
YW5nZV9lcnJvcihjb25zdCBzdHJpbmcmIF9fYXJnKSA7CgogICAgZXhwbGljaXQgcmFuZ2VfZXJy
b3IoY29uc3QgY2hhciopIDsKCiAgICB2aXJ0dWFsIH5yYW5nZV9lcnJvcigpIG5vZXhjZXB0Owog
IH07CgoKICBjbGFzcyBvdmVyZmxvd19lcnJvciA6IHB1YmxpYyBydW50aW1lX2Vycm9yCiAgewog
IHB1YmxpYzoKICAgIGV4cGxpY2l0IG92ZXJmbG93X2Vycm9yKGNvbnN0IHN0cmluZyYgX19hcmcp
IDsKCiAgICBleHBsaWNpdCBvdmVyZmxvd19lcnJvcihjb25zdCBjaGFyKikgOwoKICAgIHZpcnR1
YWwgfm92ZXJmbG93X2Vycm9yKCkgbm9leGNlcHQ7CiAgfTsKCgogIGNsYXNzIHVuZGVyZmxvd19l
cnJvciA6IHB1YmxpYyBydW50aW1lX2Vycm9yCiAgewogIHB1YmxpYzoKICAgIGV4cGxpY2l0IHVu
ZGVyZmxvd19lcnJvcihjb25zdCBzdHJpbmcmIF9fYXJnKSA7CgogICAgZXhwbGljaXQgdW5kZXJm
bG93X2Vycm9yKGNvbnN0IGNoYXIqKSA7CgogICAgdmlydHVhbCB+dW5kZXJmbG93X2Vycm9yKCkg
bm9leGNlcHQ7CiAgfTsKCgoKCn0KIyA0MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zeXN0ZW1f
ZXJyb3IiIDIgMwoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18g
KCJkZWZhdWx0IikpKQp7CgoKICBjbGFzcyBlcnJvcl9jb2RlOwogIGNsYXNzIGVycm9yX2NvbmRp
dGlvbjsKICBjbGFzcyBzeXN0ZW1fZXJyb3I7CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAg
ICBzdHJ1Y3QgaXNfZXJyb3JfY29kZV9lbnVtIDogcHVibGljIGZhbHNlX3R5cGUgeyB9OwoKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGlzX2Vycm9yX2NvbmRpdGlvbl9lbnVt
IDogcHVibGljIGZhbHNlX3R5cGUgeyB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgaXNfZXJy
b3JfY29uZGl0aW9uX2VudW08ZXJyYz4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIGlu
bGluZSBuYW1lc3BhY2UgX1YyIHsKCgogIGNsYXNzIGVycm9yX2NhdGVnb3J5CiAgewogIHB1Ymxp
YzoKICAgIGNvbnN0ZXhwciBlcnJvcl9jYXRlZ29yeSgpIG5vZXhjZXB0ID0gZGVmYXVsdDsKCiAg
ICB2aXJ0dWFsIH5lcnJvcl9jYXRlZ29yeSgpOwoKICAgIGVycm9yX2NhdGVnb3J5KGNvbnN0IGVy
cm9yX2NhdGVnb3J5JikgPSBkZWxldGU7CiAgICBlcnJvcl9jYXRlZ29yeSYgb3BlcmF0b3I9KGNv
bnN0IGVycm9yX2NhdGVnb3J5JikgPSBkZWxldGU7CgogICAgdmlydHVhbCBjb25zdCBjaGFyKgog
ICAgbmFtZSgpIGNvbnN0IG5vZXhjZXB0ID0gMDsKCgoKCgoKICBwcml2YXRlOgogICAgX19hdHRy
aWJ1dGUgKChfX2FiaV90YWdfXyAoImN4eDExIikpKQogICAgdmlydHVhbCBfX2Nvd19zdHJpbmcK
ICAgIF9NX21lc3NhZ2UoaW50KSBjb25zdDsKCiAgcHVibGljOgogICAgX19hdHRyaWJ1dGUgKChf
X2FiaV90YWdfXyAoImN4eDExIikpKQogICAgdmlydHVhbCBzdHJpbmcKICAgIG1lc3NhZ2UoaW50
KSBjb25zdCA9IDA7CiMgMTAyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N5c3RlbV9lcnJvciIg
MwogIHB1YmxpYzoKICAgIHZpcnR1YWwgZXJyb3JfY29uZGl0aW9uCiAgICBkZWZhdWx0X2Vycm9y
X2NvbmRpdGlvbihpbnQgX19pKSBjb25zdCBub2V4Y2VwdDsKCiAgICB2aXJ0dWFsIGJvb2wKICAg
IGVxdWl2YWxlbnQoaW50IF9faSwgY29uc3QgZXJyb3JfY29uZGl0aW9uJiBfX2NvbmQpIGNvbnN0
IG5vZXhjZXB0OwoKICAgIHZpcnR1YWwgYm9vbAogICAgZXF1aXZhbGVudChjb25zdCBlcnJvcl9j
b2RlJiBfX2NvZGUsIGludCBfX2kpIGNvbnN0IG5vZXhjZXB0OwoKICAgIGJvb2wKICAgIG9wZXJh
dG9yPChjb25zdCBlcnJvcl9jYXRlZ29yeSYgX19vdGhlcikgY29uc3Qgbm9leGNlcHQKICAgIHsg
cmV0dXJuIGxlc3M8Y29uc3QgZXJyb3JfY2F0ZWdvcnkqPigpKHRoaXMsICZfX290aGVyKTsgfQoK
ICAgIGJvb2wKICAgIG9wZXJhdG9yPT0oY29uc3QgZXJyb3JfY2F0ZWdvcnkmIF9fb3RoZXIpIGNv
bnN0IG5vZXhjZXB0CiAgICB7IHJldHVybiB0aGlzID09ICZfX290aGVyOyB9CgogICAgYm9vbAog
ICAgb3BlcmF0b3IhPShjb25zdCBlcnJvcl9jYXRlZ29yeSYgX19vdGhlcikgY29uc3Qgbm9leGNl
cHQKICAgIHsgcmV0dXJuIHRoaXMgIT0gJl9fb3RoZXI7IH0KICB9OwoKCiAgX19hdHRyaWJ1dGVf
XyAoKF9fY29uc3RfXykpIGNvbnN0IGVycm9yX2NhdGVnb3J5JiBzeXN0ZW1fY2F0ZWdvcnkoKSBu
b2V4Y2VwdDsKICBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSkgY29uc3QgZXJyb3JfY2F0ZWdv
cnkmIGdlbmVyaWNfY2F0ZWdvcnkoKSBub2V4Y2VwdDsKCiAgfQoKICBlcnJvcl9jb2RlIG1ha2Vf
ZXJyb3JfY29kZShlcnJjKSBub2V4Y2VwdDsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAg
c3RydWN0IGhhc2g7CgoKCiAgc3RydWN0IGVycm9yX2NvZGUKICB7CiAgICBlcnJvcl9jb2RlKCkg
bm9leGNlcHQKICAgIDogX01fdmFsdWUoMCksIF9NX2NhdCgmc3lzdGVtX2NhdGVnb3J5KCkpIHsg
fQoKICAgIGVycm9yX2NvZGUoaW50IF9fdiwgY29uc3QgZXJyb3JfY2F0ZWdvcnkmIF9fY2F0KSBu
b2V4Y2VwdAogICAgOiBfTV92YWx1ZShfX3YpLCBfTV9jYXQoJl9fY2F0KSB7IH0KCiAgICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfRXJyb3JDb2RlRW51bSwgdHlwZW5hbWUgPSB0eXBlbmFtZQogICAgICBl
bmFibGVfaWY8aXNfZXJyb3JfY29kZV9lbnVtPF9FcnJvckNvZGVFbnVtPjo6dmFsdWU+Ojp0eXBl
PgogICAgICBlcnJvcl9jb2RlKF9FcnJvckNvZGVFbnVtIF9fZSkgbm9leGNlcHQKICAgICAgeyAq
dGhpcyA9IG1ha2VfZXJyb3JfY29kZShfX2UpOyB9CgogICAgdm9pZAogICAgYXNzaWduKGludCBf
X3YsIGNvbnN0IGVycm9yX2NhdGVnb3J5JiBfX2NhdCkgbm9leGNlcHQKICAgIHsKICAgICAgX01f
dmFsdWUgPSBfX3Y7CiAgICAgIF9NX2NhdCA9ICZfX2NhdDsKICAgIH0KCiAgICB2b2lkCiAgICBj
bGVhcigpIG5vZXhjZXB0CiAgICB7IGFzc2lnbigwLCBzeXN0ZW1fY2F0ZWdvcnkoKSk7IH0KCgog
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX0Vycm9yQ29kZUVudW0+CiAgICAgIHR5cGVuYW1lIGVuYWJs
ZV9pZjxpc19lcnJvcl9jb2RlX2VudW08X0Vycm9yQ29kZUVudW0+Ojp2YWx1ZSwKICAgIGVycm9y
X2NvZGUmPjo6dHlwZQogICAgICBvcGVyYXRvcj0oX0Vycm9yQ29kZUVudW0gX19lKSBub2V4Y2Vw
dAogICAgICB7IHJldHVybiAqdGhpcyA9IG1ha2VfZXJyb3JfY29kZShfX2UpOyB9CgogICAgaW50
CiAgICB2YWx1ZSgpIGNvbnN0IG5vZXhjZXB0IHsgcmV0dXJuIF9NX3ZhbHVlOyB9CgogICAgY29u
c3QgZXJyb3JfY2F0ZWdvcnkmCiAgICBjYXRlZ29yeSgpIGNvbnN0IG5vZXhjZXB0IHsgcmV0dXJu
ICpfTV9jYXQ7IH0KCiAgICBlcnJvcl9jb25kaXRpb24KICAgIGRlZmF1bHRfZXJyb3JfY29uZGl0
aW9uKCkgY29uc3Qgbm9leGNlcHQ7CgogICAgX19hdHRyaWJ1dGUgKChfX2FiaV90YWdfXyAoImN4
eDExIikpKQogICAgc3RyaW5nCiAgICBtZXNzYWdlKCkgY29uc3QKICAgIHsgcmV0dXJuIGNhdGVn
b3J5KCkubWVzc2FnZSh2YWx1ZSgpKTsgfQoKICAgIGV4cGxpY2l0IG9wZXJhdG9yIGJvb2woKSBj
b25zdCBub2V4Y2VwdAogICAgeyByZXR1cm4gX01fdmFsdWUgIT0gMDsgfQoKCiAgcHJpdmF0ZToK
ICAgIGZyaWVuZCBjbGFzcyBoYXNoPGVycm9yX2NvZGU+OwoKICAgIGludCBfTV92YWx1ZTsKICAg
IGNvbnN0IGVycm9yX2NhdGVnb3J5KiBfTV9jYXQ7CiAgfTsKCgogIGlubGluZSBlcnJvcl9jb2Rl
CiAgbWFrZV9lcnJvcl9jb2RlKGVycmMgX19lKSBub2V4Y2VwdAogIHsgcmV0dXJuIGVycm9yX2Nv
ZGUoc3RhdGljX2Nhc3Q8aW50PihfX2UpLCBnZW5lcmljX2NhdGVnb3J5KCkpOyB9CgogIGlubGlu
ZSBib29sCiAgb3BlcmF0b3I8KGNvbnN0IGVycm9yX2NvZGUmIF9fbGhzLCBjb25zdCBlcnJvcl9j
b2RlJiBfX3Jocykgbm9leGNlcHQKICB7CiAgICByZXR1cm4gKF9fbGhzLmNhdGVnb3J5KCkgPCBf
X3Jocy5jYXRlZ29yeSgpCiAgICAgfHwgKF9fbGhzLmNhdGVnb3J5KCkgPT0gX19yaHMuY2F0ZWdv
cnkoKQogICYmIF9fbGhzLnZhbHVlKCkgPCBfX3Jocy52YWx1ZSgpKSk7CiAgfQoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBiYXNpY19vc3RyZWFtPF9D
aGFyVCwgX1RyYWl0cz4mCiAgICBvcGVyYXRvcjw8KGJhc2ljX29zdHJlYW08X0NoYXJULCBfVHJh
aXRzPiYgX19vcywgY29uc3QgZXJyb3JfY29kZSYgX19lKQogICAgeyByZXR1cm4gKF9fb3MgPDwg
X19lLmNhdGVnb3J5KCkubmFtZSgpIDw8ICc6JyA8PCBfX2UudmFsdWUoKSk7IH0KCiAgZXJyb3Jf
Y29uZGl0aW9uIG1ha2VfZXJyb3JfY29uZGl0aW9uKGVycmMpIG5vZXhjZXB0OwoKCgogIHN0cnVj
dCBlcnJvcl9jb25kaXRpb24KICB7CiAgICBlcnJvcl9jb25kaXRpb24oKSBub2V4Y2VwdAogICAg
OiBfTV92YWx1ZSgwKSwgX01fY2F0KCZnZW5lcmljX2NhdGVnb3J5KCkpIHsgfQoKICAgIGVycm9y
X2NvbmRpdGlvbihpbnQgX192LCBjb25zdCBlcnJvcl9jYXRlZ29yeSYgX19jYXQpIG5vZXhjZXB0
CiAgICA6IF9NX3ZhbHVlKF9fdiksIF9NX2NhdCgmX19jYXQpIHsgfQoKICAgIHRlbXBsYXRlPHR5
cGVuYW1lIF9FcnJvckNvbmRpdGlvbkVudW0sIHR5cGVuYW1lID0gdHlwZW5hbWUKICBlbmFibGVf
aWY8aXNfZXJyb3JfY29uZGl0aW9uX2VudW08X0Vycm9yQ29uZGl0aW9uRW51bT46OnZhbHVlPjo6
dHlwZT4KICAgICAgZXJyb3JfY29uZGl0aW9uKF9FcnJvckNvbmRpdGlvbkVudW0gX19lKSBub2V4
Y2VwdAogICAgICB7ICp0aGlzID0gbWFrZV9lcnJvcl9jb25kaXRpb24oX19lKTsgfQoKICAgIHZv
aWQKICAgIGFzc2lnbihpbnQgX192LCBjb25zdCBlcnJvcl9jYXRlZ29yeSYgX19jYXQpIG5vZXhj
ZXB0CiAgICB7CiAgICAgIF9NX3ZhbHVlID0gX192OwogICAgICBfTV9jYXQgPSAmX19jYXQ7CiAg
ICB9CgoKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9FcnJvckNvbmRpdGlvbkVudW0+CiAgICAgIHR5
cGVuYW1lIGVuYWJsZV9pZjxpc19lcnJvcl9jb25kaXRpb25fZW51bQogICAgPF9FcnJvckNvbmRp
dGlvbkVudW0+Ojp2YWx1ZSwgZXJyb3JfY29uZGl0aW9uJj46OnR5cGUKICAgICAgb3BlcmF0b3I9
KF9FcnJvckNvbmRpdGlvbkVudW0gX19lKSBub2V4Y2VwdAogICAgICB7IHJldHVybiAqdGhpcyA9
IG1ha2VfZXJyb3JfY29uZGl0aW9uKF9fZSk7IH0KCiAgICB2b2lkCiAgICBjbGVhcigpIG5vZXhj
ZXB0CiAgICB7IGFzc2lnbigwLCBnZW5lcmljX2NhdGVnb3J5KCkpOyB9CgoKICAgIGludAogICAg
dmFsdWUoKSBjb25zdCBub2V4Y2VwdCB7IHJldHVybiBfTV92YWx1ZTsgfQoKICAgIGNvbnN0IGVy
cm9yX2NhdGVnb3J5JgogICAgY2F0ZWdvcnkoKSBjb25zdCBub2V4Y2VwdCB7IHJldHVybiAqX01f
Y2F0OyB9CgogICAgX19hdHRyaWJ1dGUgKChfX2FiaV90YWdfXyAoImN4eDExIikpKQogICAgc3Ry
aW5nCiAgICBtZXNzYWdlKCkgY29uc3QKICAgIHsgcmV0dXJuIGNhdGVnb3J5KCkubWVzc2FnZSh2
YWx1ZSgpKTsgfQoKICAgIGV4cGxpY2l0IG9wZXJhdG9yIGJvb2woKSBjb25zdCBub2V4Y2VwdAog
ICAgeyByZXR1cm4gX01fdmFsdWUgIT0gMDsgfQoKCiAgcHJpdmF0ZToKICAgIGludCBfTV92YWx1
ZTsKICAgIGNvbnN0IGVycm9yX2NhdGVnb3J5KiBfTV9jYXQ7CiAgfTsKCgogIGlubGluZSBlcnJv
cl9jb25kaXRpb24KICBtYWtlX2Vycm9yX2NvbmRpdGlvbihlcnJjIF9fZSkgbm9leGNlcHQKICB7
IHJldHVybiBlcnJvcl9jb25kaXRpb24oc3RhdGljX2Nhc3Q8aW50PihfX2UpLCBnZW5lcmljX2Nh
dGVnb3J5KCkpOyB9CgogIGlubGluZSBib29sCiAgb3BlcmF0b3I8KGNvbnN0IGVycm9yX2NvbmRp
dGlvbiYgX19saHMsCiAgICAgY29uc3QgZXJyb3JfY29uZGl0aW9uJiBfX3Jocykgbm9leGNlcHQK
ICB7CiAgICByZXR1cm4gKF9fbGhzLmNhdGVnb3J5KCkgPCBfX3Jocy5jYXRlZ29yeSgpCiAgICAg
fHwgKF9fbGhzLmNhdGVnb3J5KCkgPT0gX19yaHMuY2F0ZWdvcnkoKQogICYmIF9fbGhzLnZhbHVl
KCkgPCBfX3Jocy52YWx1ZSgpKSk7CiAgfQoKCiAgaW5saW5lIGJvb2wKICBvcGVyYXRvcj09KGNv
bnN0IGVycm9yX2NvZGUmIF9fbGhzLCBjb25zdCBlcnJvcl9jb2RlJiBfX3Jocykgbm9leGNlcHQK
ICB7IHJldHVybiAoX19saHMuY2F0ZWdvcnkoKSA9PSBfX3Jocy5jYXRlZ29yeSgpCiAgICAgJiYg
X19saHMudmFsdWUoKSA9PSBfX3Jocy52YWx1ZSgpKTsgfQoKICBpbmxpbmUgYm9vbAogIG9wZXJh
dG9yPT0oY29uc3QgZXJyb3JfY29kZSYgX19saHMsIGNvbnN0IGVycm9yX2NvbmRpdGlvbiYgX19y
aHMpIG5vZXhjZXB0CiAgewogICAgcmV0dXJuIChfX2xocy5jYXRlZ29yeSgpLmVxdWl2YWxlbnQo
X19saHMudmFsdWUoKSwgX19yaHMpCiAgICAgfHwgX19yaHMuY2F0ZWdvcnkoKS5lcXVpdmFsZW50
KF9fbGhzLCBfX3Jocy52YWx1ZSgpKSk7CiAgfQoKICBpbmxpbmUgYm9vbAogIG9wZXJhdG9yPT0o
Y29uc3QgZXJyb3JfY29uZGl0aW9uJiBfX2xocywgY29uc3QgZXJyb3JfY29kZSYgX19yaHMpIG5v
ZXhjZXB0CiAgewogICAgcmV0dXJuIChfX3Jocy5jYXRlZ29yeSgpLmVxdWl2YWxlbnQoX19yaHMu
dmFsdWUoKSwgX19saHMpCiAgICAgfHwgX19saHMuY2F0ZWdvcnkoKS5lcXVpdmFsZW50KF9fcmhz
LCBfX2xocy52YWx1ZSgpKSk7CiAgfQoKICBpbmxpbmUgYm9vbAogIG9wZXJhdG9yPT0oY29uc3Qg
ZXJyb3JfY29uZGl0aW9uJiBfX2xocywKICAgICAgY29uc3QgZXJyb3JfY29uZGl0aW9uJiBfX3Jo
cykgbm9leGNlcHQKICB7CiAgICByZXR1cm4gKF9fbGhzLmNhdGVnb3J5KCkgPT0gX19yaHMuY2F0
ZWdvcnkoKQogICAgICYmIF9fbGhzLnZhbHVlKCkgPT0gX19yaHMudmFsdWUoKSk7CiAgfQoKICBp
bmxpbmUgYm9vbAogIG9wZXJhdG9yIT0oY29uc3QgZXJyb3JfY29kZSYgX19saHMsIGNvbnN0IGVy
cm9yX2NvZGUmIF9fcmhzKSBub2V4Y2VwdAogIHsgcmV0dXJuICEoX19saHMgPT0gX19yaHMpOyB9
CgogIGlubGluZSBib29sCiAgb3BlcmF0b3IhPShjb25zdCBlcnJvcl9jb2RlJiBfX2xocywgY29u
c3QgZXJyb3JfY29uZGl0aW9uJiBfX3Jocykgbm9leGNlcHQKICB7IHJldHVybiAhKF9fbGhzID09
IF9fcmhzKTsgfQoKICBpbmxpbmUgYm9vbAogIG9wZXJhdG9yIT0oY29uc3QgZXJyb3JfY29uZGl0
aW9uJiBfX2xocywgY29uc3QgZXJyb3JfY29kZSYgX19yaHMpIG5vZXhjZXB0CiAgeyByZXR1cm4g
IShfX2xocyA9PSBfX3Jocyk7IH0KCiAgaW5saW5lIGJvb2wKICBvcGVyYXRvciE9KGNvbnN0IGVy
cm9yX2NvbmRpdGlvbiYgX19saHMsCiAgICAgIGNvbnN0IGVycm9yX2NvbmRpdGlvbiYgX19yaHMp
IG5vZXhjZXB0CiAgeyByZXR1cm4gIShfX2xocyA9PSBfX3Jocyk7IH0KCgoKCgoKCiAgY2xhc3Mg
c3lzdGVtX2Vycm9yIDogcHVibGljIHN0ZDo6cnVudGltZV9lcnJvcgogIHsKICBwcml2YXRlOgog
ICAgZXJyb3JfY29kZSBfTV9jb2RlOwoKICBwdWJsaWM6CiAgICBzeXN0ZW1fZXJyb3IoZXJyb3Jf
Y29kZSBfX2VjID0gZXJyb3JfY29kZSgpKQogICAgOiBydW50aW1lX2Vycm9yKF9fZWMubWVzc2Fn
ZSgpKSwgX01fY29kZShfX2VjKSB7IH0KCiAgICBzeXN0ZW1fZXJyb3IoZXJyb3JfY29kZSBfX2Vj
LCBjb25zdCBzdHJpbmcmIF9fd2hhdCkKICAgIDogcnVudGltZV9lcnJvcihfX3doYXQgKyAiOiAi
ICsgX19lYy5tZXNzYWdlKCkpLCBfTV9jb2RlKF9fZWMpIHsgfQoKICAgIHN5c3RlbV9lcnJvcihl
cnJvcl9jb2RlIF9fZWMsIGNvbnN0IGNoYXIqIF9fd2hhdCkKICAgIDogcnVudGltZV9lcnJvcihf
X3doYXQgKyAoIjogIiArIF9fZWMubWVzc2FnZSgpKSksIF9NX2NvZGUoX19lYykgeyB9CgogICAg
c3lzdGVtX2Vycm9yKGludCBfX3YsIGNvbnN0IGVycm9yX2NhdGVnb3J5JiBfX2VjYXQsIGNvbnN0
IGNoYXIqIF9fd2hhdCkKICAgIDogc3lzdGVtX2Vycm9yKGVycm9yX2NvZGUoX192LCBfX2VjYXQp
LCBfX3doYXQpIHsgfQoKICAgIHN5c3RlbV9lcnJvcihpbnQgX192LCBjb25zdCBlcnJvcl9jYXRl
Z29yeSYgX19lY2F0KQogICAgOiBydW50aW1lX2Vycm9yKGVycm9yX2NvZGUoX192LCBfX2VjYXQp
Lm1lc3NhZ2UoKSksCiAgICAgIF9NX2NvZGUoX192LCBfX2VjYXQpIHsgfQoKICAgIHN5c3RlbV9l
cnJvcihpbnQgX192LCBjb25zdCBlcnJvcl9jYXRlZ29yeSYgX19lY2F0LCBjb25zdCBzdHJpbmcm
IF9fd2hhdCkKICAgIDogcnVudGltZV9lcnJvcihfX3doYXQgKyAiOiAiICsgZXJyb3JfY29kZShf
X3YsIF9fZWNhdCkubWVzc2FnZSgpKSwKICAgICAgX01fY29kZShfX3YsIF9fZWNhdCkgeyB9Cgog
ICAgdmlydHVhbCB+c3lzdGVtX2Vycm9yKCkgbm9leGNlcHQ7CgogICAgY29uc3QgZXJyb3JfY29k
ZSYKICAgIGNvZGUoKSBjb25zdCBub2V4Y2VwdCB7IHJldHVybiBfTV9jb2RlOyB9CiAgfTsKCgp9
CgoKCgoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZh
dWx0IikpKQp7CgoKCgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBoYXNoPGVycm9yX2NvZGU+CiAg
ICA6IHB1YmxpYyBfX2hhc2hfYmFzZTxzaXplX3QsIGVycm9yX2NvZGU+CiAgICB7CiAgICAgIHNp
emVfdAogICAgICBvcGVyYXRvcigpKGNvbnN0IGVycm9yX2NvZGUmIF9fZSkgY29uc3Qgbm9leGNl
cHQKICAgICAgewogY29uc3Qgc2l6ZV90IF9fdG1wID0gc3RkOjpfSGFzaF9pbXBsOjpoYXNoKF9f
ZS5fTV92YWx1ZSk7CiByZXR1cm4gc3RkOjpfSGFzaF9pbXBsOjpfX2hhc2hfY29tYmluZShfX2Uu
X01fY2F0LCBfX3RtcCk7CiAgICAgIH0KICAgIH07CgoKfQojIDQ3ICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvaW9zX2Jhc2UuaCIgMiAzCgoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9f
ICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoKCgoKCiAgZW51bSBfSW9zX0ZtdGZs
YWdzCiAgICB7CiAgICAgIF9TX2Jvb2xhbHBoYSA9IDFMIDw8IDAsCiAgICAgIF9TX2RlYyA9IDFM
IDw8IDEsCiAgICAgIF9TX2ZpeGVkID0gMUwgPDwgMiwKICAgICAgX1NfaGV4ID0gMUwgPDwgMywK
ICAgICAgX1NfaW50ZXJuYWwgPSAxTCA8PCA0LAogICAgICBfU19sZWZ0ID0gMUwgPDwgNSwKICAg
ICAgX1Nfb2N0ID0gMUwgPDwgNiwKICAgICAgX1NfcmlnaHQgPSAxTCA8PCA3LAogICAgICBfU19z
Y2llbnRpZmljID0gMUwgPDwgOCwKICAgICAgX1Nfc2hvd2Jhc2UgPSAxTCA8PCA5LAogICAgICBf
U19zaG93cG9pbnQgPSAxTCA8PCAxMCwKICAgICAgX1Nfc2hvd3BvcyA9IDFMIDw8IDExLAogICAg
ICBfU19za2lwd3MgPSAxTCA8PCAxMiwKICAgICAgX1NfdW5pdGJ1ZiA9IDFMIDw8IDEzLAogICAg
ICBfU191cHBlcmNhc2UgPSAxTCA8PCAxNCwKICAgICAgX1NfYWRqdXN0ZmllbGQgPSBfU19sZWZ0
IHwgX1NfcmlnaHQgfCBfU19pbnRlcm5hbCwKICAgICAgX1NfYmFzZWZpZWxkID0gX1NfZGVjIHwg
X1Nfb2N0IHwgX1NfaGV4LAogICAgICBfU19mbG9hdGZpZWxkID0gX1Nfc2NpZW50aWZpYyB8IF9T
X2ZpeGVkLAogICAgICBfU19pb3NfZm10ZmxhZ3NfZW5kID0gMUwgPDwgMTYsCiAgICAgIF9TX2lv
c19mbXRmbGFnc19tYXggPSAweDdmZmZmZmZmLAogICAgICBfU19pb3NfZm10ZmxhZ3NfbWluID0g
fjB4N2ZmZmZmZmYKICAgIH07CgogIGlubGluZSBjb25zdGV4cHIgX0lvc19GbXRmbGFncwogIG9w
ZXJhdG9yJihfSW9zX0ZtdGZsYWdzIF9fYSwgX0lvc19GbXRmbGFncyBfX2IpCiAgeyByZXR1cm4g
X0lvc19GbXRmbGFncyhzdGF0aWNfY2FzdDxpbnQ+KF9fYSkgJiBzdGF0aWNfY2FzdDxpbnQ+KF9f
YikpOyB9CgogIGlubGluZSBjb25zdGV4cHIgX0lvc19GbXRmbGFncwogIG9wZXJhdG9yfChfSW9z
X0ZtdGZsYWdzIF9fYSwgX0lvc19GbXRmbGFncyBfX2IpCiAgeyByZXR1cm4gX0lvc19GbXRmbGFn
cyhzdGF0aWNfY2FzdDxpbnQ+KF9fYSkgfCBzdGF0aWNfY2FzdDxpbnQ+KF9fYikpOyB9CgogIGlu
bGluZSBjb25zdGV4cHIgX0lvc19GbXRmbGFncwogIG9wZXJhdG9yXihfSW9zX0ZtdGZsYWdzIF9f
YSwgX0lvc19GbXRmbGFncyBfX2IpCiAgeyByZXR1cm4gX0lvc19GbXRmbGFncyhzdGF0aWNfY2Fz
dDxpbnQ+KF9fYSkgXiBzdGF0aWNfY2FzdDxpbnQ+KF9fYikpOyB9CgogIGlubGluZSBjb25zdGV4
cHIgX0lvc19GbXRmbGFncwogIG9wZXJhdG9yfihfSW9zX0ZtdGZsYWdzIF9fYSkKICB7IHJldHVy
biBfSW9zX0ZtdGZsYWdzKH5zdGF0aWNfY2FzdDxpbnQ+KF9fYSkpOyB9CgogIGlubGluZSBjb25z
dCBfSW9zX0ZtdGZsYWdzJgogIG9wZXJhdG9yfD0oX0lvc19GbXRmbGFncyYgX19hLCBfSW9zX0Zt
dGZsYWdzIF9fYikKICB7IHJldHVybiBfX2EgPSBfX2EgfCBfX2I7IH0KCiAgaW5saW5lIGNvbnN0
IF9Jb3NfRm10ZmxhZ3MmCiAgb3BlcmF0b3ImPShfSW9zX0ZtdGZsYWdzJiBfX2EsIF9Jb3NfRm10
ZmxhZ3MgX19iKQogIHsgcmV0dXJuIF9fYSA9IF9fYSAmIF9fYjsgfQoKICBpbmxpbmUgY29uc3Qg
X0lvc19GbXRmbGFncyYKICBvcGVyYXRvcl49KF9Jb3NfRm10ZmxhZ3MmIF9fYSwgX0lvc19GbXRm
bGFncyBfX2IpCiAgeyByZXR1cm4gX19hID0gX19hIF4gX19iOyB9CgoKICBlbnVtIF9Jb3NfT3Bl
bm1vZGUKICAgIHsKICAgICAgX1NfYXBwID0gMUwgPDwgMCwKICAgICAgX1NfYXRlID0gMUwgPDwg
MSwKICAgICAgX1NfYmluID0gMUwgPDwgMiwKICAgICAgX1NfaW4gPSAxTCA8PCAzLAogICAgICBf
U19vdXQgPSAxTCA8PCA0LAogICAgICBfU190cnVuYyA9IDFMIDw8IDUsCiAgICAgIF9TX2lvc19v
cGVubW9kZV9lbmQgPSAxTCA8PCAxNiwKICAgICAgX1NfaW9zX29wZW5tb2RlX21heCA9IDB4N2Zm
ZmZmZmYsCiAgICAgIF9TX2lvc19vcGVubW9kZV9taW4gPSB+MHg3ZmZmZmZmZgogICAgfTsKCiAg
aW5saW5lIGNvbnN0ZXhwciBfSW9zX09wZW5tb2RlCiAgb3BlcmF0b3ImKF9Jb3NfT3Blbm1vZGUg
X19hLCBfSW9zX09wZW5tb2RlIF9fYikKICB7IHJldHVybiBfSW9zX09wZW5tb2RlKHN0YXRpY19j
YXN0PGludD4oX19hKSAmIHN0YXRpY19jYXN0PGludD4oX19iKSk7IH0KCiAgaW5saW5lIGNvbnN0
ZXhwciBfSW9zX09wZW5tb2RlCiAgb3BlcmF0b3J8KF9Jb3NfT3Blbm1vZGUgX19hLCBfSW9zX09w
ZW5tb2RlIF9fYikKICB7IHJldHVybiBfSW9zX09wZW5tb2RlKHN0YXRpY19jYXN0PGludD4oX19h
KSB8IHN0YXRpY19jYXN0PGludD4oX19iKSk7IH0KCiAgaW5saW5lIGNvbnN0ZXhwciBfSW9zX09w
ZW5tb2RlCiAgb3BlcmF0b3JeKF9Jb3NfT3Blbm1vZGUgX19hLCBfSW9zX09wZW5tb2RlIF9fYikK
ICB7IHJldHVybiBfSW9zX09wZW5tb2RlKHN0YXRpY19jYXN0PGludD4oX19hKSBeIHN0YXRpY19j
YXN0PGludD4oX19iKSk7IH0KCiAgaW5saW5lIGNvbnN0ZXhwciBfSW9zX09wZW5tb2RlCiAgb3Bl
cmF0b3J+KF9Jb3NfT3Blbm1vZGUgX19hKQogIHsgcmV0dXJuIF9Jb3NfT3Blbm1vZGUofnN0YXRp
Y19jYXN0PGludD4oX19hKSk7IH0KCiAgaW5saW5lIGNvbnN0IF9Jb3NfT3Blbm1vZGUmCiAgb3Bl
cmF0b3J8PShfSW9zX09wZW5tb2RlJiBfX2EsIF9Jb3NfT3Blbm1vZGUgX19iKQogIHsgcmV0dXJu
IF9fYSA9IF9fYSB8IF9fYjsgfQoKICBpbmxpbmUgY29uc3QgX0lvc19PcGVubW9kZSYKICBvcGVy
YXRvciY9KF9Jb3NfT3Blbm1vZGUmIF9fYSwgX0lvc19PcGVubW9kZSBfX2IpCiAgeyByZXR1cm4g
X19hID0gX19hICYgX19iOyB9CgogIGlubGluZSBjb25zdCBfSW9zX09wZW5tb2RlJgogIG9wZXJh
dG9yXj0oX0lvc19PcGVubW9kZSYgX19hLCBfSW9zX09wZW5tb2RlIF9fYikKICB7IHJldHVybiBf
X2EgPSBfX2EgXiBfX2I7IH0KCgogIGVudW0gX0lvc19Jb3N0YXRlCiAgICB7CiAgICAgIF9TX2dv
b2RiaXQgPSAwLAogICAgICBfU19iYWRiaXQgPSAxTCA8PCAwLAogICAgICBfU19lb2ZiaXQgPSAx
TCA8PCAxLAogICAgICBfU19mYWlsYml0ID0gMUwgPDwgMiwKICAgICAgX1NfaW9zX2lvc3RhdGVf
ZW5kID0gMUwgPDwgMTYsCiAgICAgIF9TX2lvc19pb3N0YXRlX21heCA9IDB4N2ZmZmZmZmYsCiAg
ICAgIF9TX2lvc19pb3N0YXRlX21pbiA9IH4weDdmZmZmZmZmCiAgICB9OwoKICBpbmxpbmUgY29u
c3RleHByIF9Jb3NfSW9zdGF0ZQogIG9wZXJhdG9yJihfSW9zX0lvc3RhdGUgX19hLCBfSW9zX0lv
c3RhdGUgX19iKQogIHsgcmV0dXJuIF9Jb3NfSW9zdGF0ZShzdGF0aWNfY2FzdDxpbnQ+KF9fYSkg
JiBzdGF0aWNfY2FzdDxpbnQ+KF9fYikpOyB9CgogIGlubGluZSBjb25zdGV4cHIgX0lvc19Jb3N0
YXRlCiAgb3BlcmF0b3J8KF9Jb3NfSW9zdGF0ZSBfX2EsIF9Jb3NfSW9zdGF0ZSBfX2IpCiAgeyBy
ZXR1cm4gX0lvc19Jb3N0YXRlKHN0YXRpY19jYXN0PGludD4oX19hKSB8IHN0YXRpY19jYXN0PGlu
dD4oX19iKSk7IH0KCiAgaW5saW5lIGNvbnN0ZXhwciBfSW9zX0lvc3RhdGUKICBvcGVyYXRvcl4o
X0lvc19Jb3N0YXRlIF9fYSwgX0lvc19Jb3N0YXRlIF9fYikKICB7IHJldHVybiBfSW9zX0lvc3Rh
dGUoc3RhdGljX2Nhc3Q8aW50PihfX2EpIF4gc3RhdGljX2Nhc3Q8aW50PihfX2IpKTsgfQoKICBp
bmxpbmUgY29uc3RleHByIF9Jb3NfSW9zdGF0ZQogIG9wZXJhdG9yfihfSW9zX0lvc3RhdGUgX19h
KQogIHsgcmV0dXJuIF9Jb3NfSW9zdGF0ZSh+c3RhdGljX2Nhc3Q8aW50PihfX2EpKTsgfQoKICBp
bmxpbmUgY29uc3QgX0lvc19Jb3N0YXRlJgogIG9wZXJhdG9yfD0oX0lvc19Jb3N0YXRlJiBfX2Es
IF9Jb3NfSW9zdGF0ZSBfX2IpCiAgeyByZXR1cm4gX19hID0gX19hIHwgX19iOyB9CgogIGlubGlu
ZSBjb25zdCBfSW9zX0lvc3RhdGUmCiAgb3BlcmF0b3ImPShfSW9zX0lvc3RhdGUmIF9fYSwgX0lv
c19Jb3N0YXRlIF9fYikKICB7IHJldHVybiBfX2EgPSBfX2EgJiBfX2I7IH0KCiAgaW5saW5lIGNv
bnN0IF9Jb3NfSW9zdGF0ZSYKICBvcGVyYXRvcl49KF9Jb3NfSW9zdGF0ZSYgX19hLCBfSW9zX0lv
c3RhdGUgX19iKQogIHsgcmV0dXJuIF9fYSA9IF9fYSBeIF9fYjsgfQoKCiAgZW51bSBfSW9zX1Nl
ZWtkaXIKICAgIHsKICAgICAgX1NfYmVnID0gMCwKICAgICAgX1NfY3VyID0gMSwKICAgICAgX1Nf
ZW5kID0gMiwKICAgICAgX1NfaW9zX3NlZWtkaXJfZW5kID0gMUwgPDwgMTYKICAgIH07CgoKCiAg
ZW51bSBjbGFzcyBpb19lcnJjIHsgc3RyZWFtID0gMSB9OwoKICB0ZW1wbGF0ZSA8PiBzdHJ1Y3Qg
aXNfZXJyb3JfY29kZV9lbnVtPGlvX2VycmM+IDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIGNv
bnN0IGVycm9yX2NhdGVnb3J5JiBpb3N0cmVhbV9jYXRlZ29yeSgpIG5vZXhjZXB0OwoKICBpbmxp
bmUgZXJyb3JfY29kZQogIG1ha2VfZXJyb3JfY29kZShpb19lcnJjIGUpIG5vZXhjZXB0CiAgeyBy
ZXR1cm4gZXJyb3JfY29kZShzdGF0aWNfY2FzdDxpbnQ+KGUpLCBpb3N0cmVhbV9jYXRlZ29yeSgp
KTsgfQoKICBpbmxpbmUgZXJyb3JfY29uZGl0aW9uCiAgbWFrZV9lcnJvcl9jb25kaXRpb24oaW9f
ZXJyYyBlKSBub2V4Y2VwdAogIHsgcmV0dXJuIGVycm9yX2NvbmRpdGlvbihzdGF0aWNfY2FzdDxp
bnQ+KGUpLCBpb3N0cmVhbV9jYXRlZ29yeSgpKTsgfQojIDIyOCAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL2lvc19iYXNlLmgiIDMKICBjbGFzcyBpb3NfYmFzZQogIHsKIyAyNDYgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9pb3NfYmFzZS5oIiAzCiAgcHVibGljOgojIDI1NSAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lvc19iYXNlLmgiIDMKICAgIGNsYXNzIF9fYXR0cmli
dXRlICgoX19hYmlfdGFnX18gKCJjeHgxMSIpKSkgZmFpbHVyZSA6IHB1YmxpYyBzeXN0ZW1fZXJy
b3IKICAgIHsKICAgIHB1YmxpYzoKICAgICAgZXhwbGljaXQKICAgICAgZmFpbHVyZShjb25zdCBz
dHJpbmcmIF9fc3RyKTsKCgogICAgICBleHBsaWNpdAogICAgICBmYWlsdXJlKGNvbnN0IHN0cmlu
ZyYsIGNvbnN0IGVycm9yX2NvZGUmKTsKCiAgICAgIGV4cGxpY2l0CiAgICAgIGZhaWx1cmUoY29u
c3QgY2hhciosIGNvbnN0IGVycm9yX2NvZGUmID0gaW9fZXJyYzo6c3RyZWFtKTsKCgogICAgICB2
aXJ0dWFsCiAgICAgIH5mYWlsdXJlKCkgdGhyb3coKTsKCiAgICAgIHZpcnR1YWwgY29uc3QgY2hh
cioKICAgICAgd2hhdCgpIGNvbnN0IHRocm93KCk7CiAgICB9OwojIDMyMyAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9iaXRzL2lvc19iYXNlLmgiIDMKICAgIHR5cGVkZWYgX0lvc19GbXRmbGFncyBm
bXRmbGFnczsKCgogICAgc3RhdGljIGNvbnN0IGZtdGZsYWdzIGJvb2xhbHBoYSA9IF9TX2Jvb2xh
bHBoYTsKCgogICAgc3RhdGljIGNvbnN0IGZtdGZsYWdzIGRlYyA9IF9TX2RlYzsKCgogICAgc3Rh
dGljIGNvbnN0IGZtdGZsYWdzIGZpeGVkID0gX1NfZml4ZWQ7CgoKICAgIHN0YXRpYyBjb25zdCBm
bXRmbGFncyBoZXggPSBfU19oZXg7CgoKCgogICAgc3RhdGljIGNvbnN0IGZtdGZsYWdzIGludGVy
bmFsID0gX1NfaW50ZXJuYWw7CgoKCiAgICBzdGF0aWMgY29uc3QgZm10ZmxhZ3MgbGVmdCA9IF9T
X2xlZnQ7CgoKICAgIHN0YXRpYyBjb25zdCBmbXRmbGFncyBvY3QgPSBfU19vY3Q7CgoKCiAgICBz
dGF0aWMgY29uc3QgZm10ZmxhZ3MgcmlnaHQgPSBfU19yaWdodDsKCgogICAgc3RhdGljIGNvbnN0
IGZtdGZsYWdzIHNjaWVudGlmaWMgPSBfU19zY2llbnRpZmljOwoKCgogICAgc3RhdGljIGNvbnN0
IGZtdGZsYWdzIHNob3diYXNlID0gX1Nfc2hvd2Jhc2U7CgoKCiAgICBzdGF0aWMgY29uc3QgZm10
ZmxhZ3Mgc2hvd3BvaW50ID0gX1Nfc2hvd3BvaW50OwoKCiAgICBzdGF0aWMgY29uc3QgZm10Zmxh
Z3Mgc2hvd3BvcyA9IF9TX3Nob3dwb3M7CgoKICAgIHN0YXRpYyBjb25zdCBmbXRmbGFncyBza2lw
d3MgPSBfU19za2lwd3M7CgoKICAgIHN0YXRpYyBjb25zdCBmbXRmbGFncyB1bml0YnVmID0gX1Nf
dW5pdGJ1ZjsKCgoKICAgIHN0YXRpYyBjb25zdCBmbXRmbGFncyB1cHBlcmNhc2UgPSBfU191cHBl
cmNhc2U7CgoKICAgIHN0YXRpYyBjb25zdCBmbXRmbGFncyBhZGp1c3RmaWVsZCA9IF9TX2FkanVz
dGZpZWxkOwoKCiAgICBzdGF0aWMgY29uc3QgZm10ZmxhZ3MgYmFzZWZpZWxkID0gX1NfYmFzZWZp
ZWxkOwoKCiAgICBzdGF0aWMgY29uc3QgZm10ZmxhZ3MgZmxvYXRmaWVsZCA9IF9TX2Zsb2F0Zmll
bGQ7CiMgMzk4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvaW9zX2Jhc2UuaCIgMwogICAg
dHlwZWRlZiBfSW9zX0lvc3RhdGUgaW9zdGF0ZTsKCgoKICAgIHN0YXRpYyBjb25zdCBpb3N0YXRl
IGJhZGJpdCA9IF9TX2JhZGJpdDsKCgogICAgc3RhdGljIGNvbnN0IGlvc3RhdGUgZW9mYml0ID0g
X1NfZW9mYml0OwoKCgoKICAgIHN0YXRpYyBjb25zdCBpb3N0YXRlIGZhaWxiaXQgPSBfU19mYWls
Yml0OwoKCiAgICBzdGF0aWMgY29uc3QgaW9zdGF0ZSBnb29kYml0ID0gX1NfZ29vZGJpdDsKIyA0
MjkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9pb3NfYmFzZS5oIiAzCiAgICB0eXBlZGVm
IF9Jb3NfT3Blbm1vZGUgb3Blbm1vZGU7CgoKICAgIHN0YXRpYyBjb25zdCBvcGVubW9kZSBhcHAg
PSBfU19hcHA7CgoKICAgIHN0YXRpYyBjb25zdCBvcGVubW9kZSBhdGUgPSBfU19hdGU7CgoKCgog
ICAgc3RhdGljIGNvbnN0IG9wZW5tb2RlIGJpbmFyeSA9IF9TX2JpbjsKCgogICAgc3RhdGljIGNv
bnN0IG9wZW5tb2RlIGluID0gX1NfaW47CgoKICAgIHN0YXRpYyBjb25zdCBvcGVubW9kZSBvdXQg
PSBfU19vdXQ7CgoKICAgIHN0YXRpYyBjb25zdCBvcGVubW9kZSB0cnVuYyA9IF9TX3RydW5jOwoj
IDQ2MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lvc19iYXNlLmgiIDMKICAgIHR5cGVk
ZWYgX0lvc19TZWVrZGlyIHNlZWtkaXI7CgoKICAgIHN0YXRpYyBjb25zdCBzZWVrZGlyIGJlZyA9
IF9TX2JlZzsKCgogICAgc3RhdGljIGNvbnN0IHNlZWtkaXIgY3VyID0gX1NfY3VyOwoKCiAgICBz
dGF0aWMgY29uc3Qgc2Vla2RpciBlbmQgPSBfU19lbmQ7CgoKICAgIHR5cGVkZWYgaW50IGlvX3N0
YXRlOwogICAgdHlwZWRlZiBpbnQgb3Blbl9tb2RlOwogICAgdHlwZWRlZiBpbnQgc2Vla19kaXI7
CgogICAgdHlwZWRlZiBzdGQ6OnN0cmVhbXBvcyBzdHJlYW1wb3M7CiAgICB0eXBlZGVmIHN0ZDo6
c3RyZWFtb2ZmIHN0cmVhbW9mZjsKIyA0ODcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9p
b3NfYmFzZS5oIiAzCiAgICBlbnVtIGV2ZW50CiAgICB7CiAgICAgIGVyYXNlX2V2ZW50LAogICAg
ICBpbWJ1ZV9ldmVudCwKICAgICAgY29weWZtdF9ldmVudAogICAgfTsKIyA1MDQgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9pb3NfYmFzZS5oIiAzCiAgICB0eXBlZGVmIHZvaWQgKCpldmVu
dF9jYWxsYmFjaykgKGV2ZW50IF9fZSwgaW9zX2Jhc2UmIF9fYiwgaW50IF9faSk7CiMgNTE2ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvaW9zX2Jhc2UuaCIgMwogICAgdm9pZAogICAgcmVn
aXN0ZXJfY2FsbGJhY2soZXZlbnRfY2FsbGJhY2sgX19mbiwgaW50IF9faW5kZXgpOwoKICBwcm90
ZWN0ZWQ6CiAgICBzdHJlYW1zaXplIF9NX3ByZWNpc2lvbjsKICAgIHN0cmVhbXNpemUgX01fd2lk
dGg7CiAgICBmbXRmbGFncyBfTV9mbGFnczsKICAgIGlvc3RhdGUgX01fZXhjZXB0aW9uOwogICAg
aW9zdGF0ZSBfTV9zdHJlYW1idWZfc3RhdGU7CgoKCiAgICBzdHJ1Y3QgX0NhbGxiYWNrX2xpc3QK
ICAgIHsKCiAgICAgIF9DYWxsYmFja19saXN0KiBfTV9uZXh0OwogICAgICBpb3NfYmFzZTo6ZXZl
bnRfY2FsbGJhY2sgX01fZm47CiAgICAgIGludCBfTV9pbmRleDsKICAgICAgX0F0b21pY193b3Jk
IF9NX3JlZmNvdW50OwoKICAgICAgX0NhbGxiYWNrX2xpc3QoaW9zX2Jhc2U6OmV2ZW50X2NhbGxi
YWNrIF9fZm4sIGludCBfX2luZGV4LAogICAgICAgX0NhbGxiYWNrX2xpc3QqIF9fY2IpCiAgICAg
IDogX01fbmV4dChfX2NiKSwgX01fZm4oX19mbiksIF9NX2luZGV4KF9faW5kZXgpLCBfTV9yZWZj
b3VudCgwKSB7IH0KCiAgICAgIHZvaWQKICAgICAgX01fYWRkX3JlZmVyZW5jZSgpIHsgX19nbnVf
Y3h4OjpfX2F0b21pY19hZGRfZGlzcGF0Y2goJl9NX3JlZmNvdW50LCAxKTsgfQoKCiAgICAgIGlu
dAogICAgICBfTV9yZW1vdmVfcmVmZXJlbmNlKCkKICAgICAgewoKICAgICAgICA7CiAgICAgICAg
aW50IF9fcmVzID0gX19nbnVfY3h4OjpfX2V4Y2hhbmdlX2FuZF9hZGRfZGlzcGF0Y2goJl9NX3Jl
ZmNvdW50LCAtMSk7CiAgICAgICAgaWYgKF9fcmVzID09IDApCiAgICAgICAgICB7CiAgICAgICAg
ICAgIDsKICAgICAgICAgIH0KICAgICAgICByZXR1cm4gX19yZXM7CiAgICAgIH0KICAgIH07Cgog
ICAgIF9DYWxsYmFja19saXN0KiBfTV9jYWxsYmFja3M7CgogICAgdm9pZAogICAgX01fY2FsbF9j
YWxsYmFja3MoZXZlbnQgX19ldikgdGhyb3coKTsKCiAgICB2b2lkCiAgICBfTV9kaXNwb3NlX2Nh
bGxiYWNrcyh2b2lkKSB0aHJvdygpOwoKCiAgICBzdHJ1Y3QgX1dvcmRzCiAgICB7CiAgICAgIHZv
aWQqIF9NX3B3b3JkOwogICAgICBsb25nIF9NX2l3b3JkOwogICAgICBfV29yZHMoKSA6IF9NX3B3
b3JkKDApLCBfTV9pd29yZCgwKSB7IH0KICAgIH07CgoKICAgIF9Xb3JkcyBfTV93b3JkX3plcm87
CgoKCiAgICBlbnVtIHsgX1NfbG9jYWxfd29yZF9zaXplID0gOCB9OwogICAgX1dvcmRzIF9NX2xv
Y2FsX3dvcmRbX1NfbG9jYWxfd29yZF9zaXplXTsKCgogICAgaW50IF9NX3dvcmRfc2l6ZTsKICAg
IF9Xb3JkcyogX01fd29yZDsKCiAgICBfV29yZHMmCiAgICBfTV9ncm93X3dvcmRzKGludCBfX2lu
ZGV4LCBib29sIF9faXdvcmQpOwoKCiAgICBsb2NhbGUgX01faW9zX2xvY2FsZTsKCiAgICB2b2lk
CiAgICBfTV9pbml0KCkgdGhyb3coKTsKCiAgcHVibGljOgoKCgoKCiAgICBjbGFzcyBJbml0CiAg
ICB7CiAgICAgIGZyaWVuZCBjbGFzcyBpb3NfYmFzZTsKICAgIHB1YmxpYzoKICAgICAgSW5pdCgp
OwogICAgICB+SW5pdCgpOwoKICAgIHByaXZhdGU6CiAgICAgIHN0YXRpYyBfQXRvbWljX3dvcmQg
X1NfcmVmY291bnQ7CiAgICAgIHN0YXRpYyBib29sIF9TX3N5bmNlZF93aXRoX3N0ZGlvOwogICAg
fTsKCgoKCgoKICAgIGZtdGZsYWdzCiAgICBmbGFncygpIGNvbnN0CiAgICB7IHJldHVybiBfTV9m
bGFnczsgfQojIDYyOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lvc19iYXNlLmgiIDMK
ICAgIGZtdGZsYWdzCiAgICBmbGFncyhmbXRmbGFncyBfX2ZtdGZsKQogICAgewogICAgICBmbXRm
bGFncyBfX29sZCA9IF9NX2ZsYWdzOwogICAgICBfTV9mbGFncyA9IF9fZm10Zmw7CiAgICAgIHJl
dHVybiBfX29sZDsKICAgIH0KIyA2NDUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9pb3Nf
YmFzZS5oIiAzCiAgICBmbXRmbGFncwogICAgc2V0ZihmbXRmbGFncyBfX2ZtdGZsKQogICAgewog
ICAgICBmbXRmbGFncyBfX29sZCA9IF9NX2ZsYWdzOwogICAgICBfTV9mbGFncyB8PSBfX2ZtdGZs
OwogICAgICByZXR1cm4gX19vbGQ7CiAgICB9CiMgNjYyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvaW9zX2Jhc2UuaCIgMwogICAgZm10ZmxhZ3MKICAgIHNldGYoZm10ZmxhZ3MgX19mbXRm
bCwgZm10ZmxhZ3MgX19tYXNrKQogICAgewogICAgICBmbXRmbGFncyBfX29sZCA9IF9NX2ZsYWdz
OwogICAgICBfTV9mbGFncyAmPSB+X19tYXNrOwogICAgICBfTV9mbGFncyB8PSAoX19mbXRmbCAm
IF9fbWFzayk7CiAgICAgIHJldHVybiBfX29sZDsKICAgIH0KCgoKCgoKCiAgICB2b2lkCiAgICB1
bnNldGYoZm10ZmxhZ3MgX19tYXNrKQogICAgeyBfTV9mbGFncyAmPSB+X19tYXNrOyB9CiMgNjg4
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvaW9zX2Jhc2UuaCIgMwogICAgc3RyZWFtc2l6
ZQogICAgcHJlY2lzaW9uKCkgY29uc3QKICAgIHsgcmV0dXJuIF9NX3ByZWNpc2lvbjsgfQoKCgoK
CgogICAgc3RyZWFtc2l6ZQogICAgcHJlY2lzaW9uKHN0cmVhbXNpemUgX19wcmVjKQogICAgewog
ICAgICBzdHJlYW1zaXplIF9fb2xkID0gX01fcHJlY2lzaW9uOwogICAgICBfTV9wcmVjaXNpb24g
PSBfX3ByZWM7CiAgICAgIHJldHVybiBfX29sZDsKICAgIH0KCgoKCgoKCiAgICBzdHJlYW1zaXpl
CiAgICB3aWR0aCgpIGNvbnN0CiAgICB7IHJldHVybiBfTV93aWR0aDsgfQoKCgoKCgogICAgc3Ry
ZWFtc2l6ZQogICAgd2lkdGgoc3RyZWFtc2l6ZSBfX3dpZGUpCiAgICB7CiAgICAgIHN0cmVhbXNp
emUgX19vbGQgPSBfTV93aWR0aDsKICAgICAgX01fd2lkdGggPSBfX3dpZGU7CiAgICAgIHJldHVy
biBfX29sZDsKICAgIH0KIyA3MzkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9pb3NfYmFz
ZS5oIiAzCiAgICBzdGF0aWMgYm9vbAogICAgc3luY193aXRoX3N0ZGlvKGJvb2wgX19zeW5jID0g
dHJ1ZSk7CiMgNzUxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvaW9zX2Jhc2UuaCIgMwog
ICAgbG9jYWxlCiAgICBpbWJ1ZShjb25zdCBsb2NhbGUmIF9fbG9jKSB0aHJvdygpOwojIDc2MiAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lvc19iYXNlLmgiIDMKICAgIGxvY2FsZQogICAg
Z2V0bG9jKCkgY29uc3QKICAgIHsgcmV0dXJuIF9NX2lvc19sb2NhbGU7IH0KIyA3NzMgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9pb3NfYmFzZS5oIiAzCiAgICBjb25zdCBsb2NhbGUmCiAg
ICBfTV9nZXRsb2MoKSBjb25zdAogICAgeyByZXR1cm4gX01faW9zX2xvY2FsZTsgfQojIDc5MiAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lvc19iYXNlLmgiIDMKICAgIHN0YXRpYyBpbnQK
ICAgIHhhbGxvYygpIHRocm93KCk7CiMgODA4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
aW9zX2Jhc2UuaCIgMwogICAgbG9uZyYKICAgIGl3b3JkKGludCBfX2l4KQogICAgewogICAgICBf
V29yZHMmIF9fd29yZCA9IChfX2l4IDwgX01fd29yZF9zaXplKQogICA/IF9NX3dvcmRbX19peF0g
OiBfTV9ncm93X3dvcmRzKF9faXgsIHRydWUpOwogICAgICByZXR1cm4gX193b3JkLl9NX2l3b3Jk
OwogICAgfQojIDgyOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lvc19iYXNlLmgiIDMK
ICAgIHZvaWQqJgogICAgcHdvcmQoaW50IF9faXgpCiAgICB7CiAgICAgIF9Xb3JkcyYgX193b3Jk
ID0gKF9faXggPCBfTV93b3JkX3NpemUpCiAgID8gX01fd29yZFtfX2l4XSA6IF9NX2dyb3dfd29y
ZHMoX19peCwgZmFsc2UpOwogICAgICByZXR1cm4gX193b3JkLl9NX3B3b3JkOwogICAgfQojIDg0
NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lvc19iYXNlLmgiIDMKICAgIHZpcnR1YWwg
fmlvc19iYXNlKCk7CgogIHByb3RlY3RlZDoKICAgIGlvc19iYXNlKCkgdGhyb3cgKCk7CiMgODYw
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvaW9zX2Jhc2UuaCIgMwogIHB1YmxpYzoKICAg
IGlvc19iYXNlKGNvbnN0IGlvc19iYXNlJikgPSBkZWxldGU7CgogICAgaW9zX2Jhc2UmCiAgICBv
cGVyYXRvcj0oY29uc3QgaW9zX2Jhc2UmKSA9IGRlbGV0ZTsKCiAgcHJvdGVjdGVkOgogICAgdm9p
ZAogICAgX01fbW92ZShpb3NfYmFzZSYpIG5vZXhjZXB0OwoKICAgIHZvaWQKICAgIF9NX3N3YXAo
aW9zX2Jhc2UmIF9fcmhzKSBub2V4Y2VwdDsKCiAgfTsKCgoKICBpbmxpbmUgaW9zX2Jhc2UmCiAg
Ym9vbGFscGhhKGlvc19iYXNlJiBfX2Jhc2UpCiAgewogICAgX19iYXNlLnNldGYoaW9zX2Jhc2U6
OmJvb2xhbHBoYSk7CiAgICByZXR1cm4gX19iYXNlOwogIH0KCgogIGlubGluZSBpb3NfYmFzZSYK
ICBub2Jvb2xhbHBoYShpb3NfYmFzZSYgX19iYXNlKQogIHsKICAgIF9fYmFzZS51bnNldGYoaW9z
X2Jhc2U6OmJvb2xhbHBoYSk7CiAgICByZXR1cm4gX19iYXNlOwogIH0KCgogIGlubGluZSBpb3Nf
YmFzZSYKICBzaG93YmFzZShpb3NfYmFzZSYgX19iYXNlKQogIHsKICAgIF9fYmFzZS5zZXRmKGlv
c19iYXNlOjpzaG93YmFzZSk7CiAgICByZXR1cm4gX19iYXNlOwogIH0KCgogIGlubGluZSBpb3Nf
YmFzZSYKICBub3Nob3diYXNlKGlvc19iYXNlJiBfX2Jhc2UpCiAgewogICAgX19iYXNlLnVuc2V0
Zihpb3NfYmFzZTo6c2hvd2Jhc2UpOwogICAgcmV0dXJuIF9fYmFzZTsKICB9CgoKICBpbmxpbmUg
aW9zX2Jhc2UmCiAgc2hvd3BvaW50KGlvc19iYXNlJiBfX2Jhc2UpCiAgewogICAgX19iYXNlLnNl
dGYoaW9zX2Jhc2U6OnNob3dwb2ludCk7CiAgICByZXR1cm4gX19iYXNlOwogIH0KCgogIGlubGlu
ZSBpb3NfYmFzZSYKICBub3Nob3dwb2ludChpb3NfYmFzZSYgX19iYXNlKQogIHsKICAgIF9fYmFz
ZS51bnNldGYoaW9zX2Jhc2U6OnNob3dwb2ludCk7CiAgICByZXR1cm4gX19iYXNlOwogIH0KCgog
IGlubGluZSBpb3NfYmFzZSYKICBzaG93cG9zKGlvc19iYXNlJiBfX2Jhc2UpCiAgewogICAgX19i
YXNlLnNldGYoaW9zX2Jhc2U6OnNob3dwb3MpOwogICAgcmV0dXJuIF9fYmFzZTsKICB9CgoKICBp
bmxpbmUgaW9zX2Jhc2UmCiAgbm9zaG93cG9zKGlvc19iYXNlJiBfX2Jhc2UpCiAgewogICAgX19i
YXNlLnVuc2V0Zihpb3NfYmFzZTo6c2hvd3Bvcyk7CiAgICByZXR1cm4gX19iYXNlOwogIH0KCgog
IGlubGluZSBpb3NfYmFzZSYKICBza2lwd3MoaW9zX2Jhc2UmIF9fYmFzZSkKICB7CiAgICBfX2Jh
c2Uuc2V0Zihpb3NfYmFzZTo6c2tpcHdzKTsKICAgIHJldHVybiBfX2Jhc2U7CiAgfQoKCiAgaW5s
aW5lIGlvc19iYXNlJgogIG5vc2tpcHdzKGlvc19iYXNlJiBfX2Jhc2UpCiAgewogICAgX19iYXNl
LnVuc2V0Zihpb3NfYmFzZTo6c2tpcHdzKTsKICAgIHJldHVybiBfX2Jhc2U7CiAgfQoKCiAgaW5s
aW5lIGlvc19iYXNlJgogIHVwcGVyY2FzZShpb3NfYmFzZSYgX19iYXNlKQogIHsKICAgIF9fYmFz
ZS5zZXRmKGlvc19iYXNlOjp1cHBlcmNhc2UpOwogICAgcmV0dXJuIF9fYmFzZTsKICB9CgoKICBp
bmxpbmUgaW9zX2Jhc2UmCiAgbm91cHBlcmNhc2UoaW9zX2Jhc2UmIF9fYmFzZSkKICB7CiAgICBf
X2Jhc2UudW5zZXRmKGlvc19iYXNlOjp1cHBlcmNhc2UpOwogICAgcmV0dXJuIF9fYmFzZTsKICB9
CgoKICBpbmxpbmUgaW9zX2Jhc2UmCiAgdW5pdGJ1Zihpb3NfYmFzZSYgX19iYXNlKQogIHsKICAg
ICBfX2Jhc2Uuc2V0Zihpb3NfYmFzZTo6dW5pdGJ1Zik7CiAgICAgcmV0dXJuIF9fYmFzZTsKICB9
CgoKICBpbmxpbmUgaW9zX2Jhc2UmCiAgbm91bml0YnVmKGlvc19iYXNlJiBfX2Jhc2UpCiAgewog
ICAgIF9fYmFzZS51bnNldGYoaW9zX2Jhc2U6OnVuaXRidWYpOwogICAgIHJldHVybiBfX2Jhc2U7
CiAgfQoKCgogIGlubGluZSBpb3NfYmFzZSYKICBpbnRlcm5hbChpb3NfYmFzZSYgX19iYXNlKQog
IHsKICAgICBfX2Jhc2Uuc2V0Zihpb3NfYmFzZTo6aW50ZXJuYWwsIGlvc19iYXNlOjphZGp1c3Rm
aWVsZCk7CiAgICAgcmV0dXJuIF9fYmFzZTsKICB9CgoKICBpbmxpbmUgaW9zX2Jhc2UmCiAgbGVm
dChpb3NfYmFzZSYgX19iYXNlKQogIHsKICAgIF9fYmFzZS5zZXRmKGlvc19iYXNlOjpsZWZ0LCBp
b3NfYmFzZTo6YWRqdXN0ZmllbGQpOwogICAgcmV0dXJuIF9fYmFzZTsKICB9CgoKICBpbmxpbmUg
aW9zX2Jhc2UmCiAgcmlnaHQoaW9zX2Jhc2UmIF9fYmFzZSkKICB7CiAgICBfX2Jhc2Uuc2V0Zihp
b3NfYmFzZTo6cmlnaHQsIGlvc19iYXNlOjphZGp1c3RmaWVsZCk7CiAgICByZXR1cm4gX19iYXNl
OwogIH0KCgoKICBpbmxpbmUgaW9zX2Jhc2UmCiAgZGVjKGlvc19iYXNlJiBfX2Jhc2UpCiAgewog
ICAgX19iYXNlLnNldGYoaW9zX2Jhc2U6OmRlYywgaW9zX2Jhc2U6OmJhc2VmaWVsZCk7CiAgICBy
ZXR1cm4gX19iYXNlOwogIH0KCgogIGlubGluZSBpb3NfYmFzZSYKICBoZXgoaW9zX2Jhc2UmIF9f
YmFzZSkKICB7CiAgICBfX2Jhc2Uuc2V0Zihpb3NfYmFzZTo6aGV4LCBpb3NfYmFzZTo6YmFzZWZp
ZWxkKTsKICAgIHJldHVybiBfX2Jhc2U7CiAgfQoKCiAgaW5saW5lIGlvc19iYXNlJgogIG9jdChp
b3NfYmFzZSYgX19iYXNlKQogIHsKICAgIF9fYmFzZS5zZXRmKGlvc19iYXNlOjpvY3QsIGlvc19i
YXNlOjpiYXNlZmllbGQpOwogICAgcmV0dXJuIF9fYmFzZTsKICB9CgoKCiAgaW5saW5lIGlvc19i
YXNlJgogIGZpeGVkKGlvc19iYXNlJiBfX2Jhc2UpCiAgewogICAgX19iYXNlLnNldGYoaW9zX2Jh
c2U6OmZpeGVkLCBpb3NfYmFzZTo6ZmxvYXRmaWVsZCk7CiAgICByZXR1cm4gX19iYXNlOwogIH0K
CgogIGlubGluZSBpb3NfYmFzZSYKICBzY2llbnRpZmljKGlvc19iYXNlJiBfX2Jhc2UpCiAgewog
ICAgX19iYXNlLnNldGYoaW9zX2Jhc2U6OnNjaWVudGlmaWMsIGlvc19iYXNlOjpmbG9hdGZpZWxk
KTsKICAgIHJldHVybiBfX2Jhc2U7CiAgfQoKCgoKCgogIGlubGluZSBpb3NfYmFzZSYKICBoZXhm
bG9hdChpb3NfYmFzZSYgX19iYXNlKQogIHsKICAgIF9fYmFzZS5zZXRmKGlvc19iYXNlOjpmaXhl
ZCB8IGlvc19iYXNlOjpzY2llbnRpZmljLCBpb3NfYmFzZTo6ZmxvYXRmaWVsZCk7CiAgICByZXR1
cm4gX19iYXNlOwogIH0KCgogIGlubGluZSBpb3NfYmFzZSYKICBkZWZhdWx0ZmxvYXQoaW9zX2Jh
c2UmIF9fYmFzZSkKICB7CiAgICBfX2Jhc2UudW5zZXRmKGlvc19iYXNlOjpmbG9hdGZpZWxkKTsK
ICAgIHJldHVybiBfX2Jhc2U7CiAgfQoKCgp9CiMgNDMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
aW9zIiAyIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmVhbWJ1ZiIgMSAzCiMgMzYg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFtYnVmIiAzCiAgICAgICAKIyAzNyAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9zdHJlYW1idWYiIDMKIyA0NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9zdHJlYW1idWYiIDMKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5
X18gKCJkZWZhdWx0IikpKQp7CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1l
IF9UcmFpdHM+CiAgICBzdHJlYW1zaXplCiAgICBfX2NvcHlfc3RyZWFtYnVmc19lb2YoYmFzaWNf
c3RyZWFtYnVmPF9DaGFyVCwgX1RyYWl0cz4qLAogICAgIGJhc2ljX3N0cmVhbWJ1ZjxfQ2hhclQs
IF9UcmFpdHM+KiwgYm9vbCYpOwojIDExOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zdHJlYW1i
dWYiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBj
bGFzcyBiYXNpY19zdHJlYW1idWYKICAgIHsKICAgIHB1YmxpYzoKCgoKCgoKICAgICAgdHlwZWRl
ZiBfQ2hhclQgY2hhcl90eXBlOwogICAgICB0eXBlZGVmIF9UcmFpdHMgdHJhaXRzX3R5cGU7CiAg
ICAgIHR5cGVkZWYgdHlwZW5hbWUgdHJhaXRzX3R5cGU6OmludF90eXBlIGludF90eXBlOwogICAg
ICB0eXBlZGVmIHR5cGVuYW1lIHRyYWl0c190eXBlOjpwb3NfdHlwZSBwb3NfdHlwZTsKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSB0cmFpdHNfdHlwZTo6b2ZmX3R5cGUgb2ZmX3R5cGU7CgoKCgogICAg
ICB0eXBlZGVmIGJhc2ljX3N0cmVhbWJ1ZjxjaGFyX3R5cGUsIHRyYWl0c190eXBlPiBfX3N0cmVh
bWJ1Zl90eXBlOwoKCiAgICAgIGZyaWVuZCBjbGFzcyBiYXNpY19pb3M8Y2hhcl90eXBlLCB0cmFp
dHNfdHlwZT47CiAgICAgIGZyaWVuZCBjbGFzcyBiYXNpY19pc3RyZWFtPGNoYXJfdHlwZSwgdHJh
aXRzX3R5cGU+OwogICAgICBmcmllbmQgY2xhc3MgYmFzaWNfb3N0cmVhbTxjaGFyX3R5cGUsIHRy
YWl0c190eXBlPjsKICAgICAgZnJpZW5kIGNsYXNzIGlzdHJlYW1idWZfaXRlcmF0b3I8Y2hhcl90
eXBlLCB0cmFpdHNfdHlwZT47CiAgICAgIGZyaWVuZCBjbGFzcyBvc3RyZWFtYnVmX2l0ZXJhdG9y
PGNoYXJfdHlwZSwgdHJhaXRzX3R5cGU+OwoKICAgICAgZnJpZW5kIHN0cmVhbXNpemUKICAgICAg
X19jb3B5X3N0cmVhbWJ1ZnNfZW9mPD4oYmFzaWNfc3RyZWFtYnVmKiwgYmFzaWNfc3RyZWFtYnVm
KiwgYm9vbCYpOwoKICAgICAgdGVtcGxhdGU8Ym9vbCBfSXNNb3ZlLCB0eXBlbmFtZSBfQ2hhclQy
PgogICAgICAgIGZyaWVuZCB0eXBlbmFtZSBfX2dudV9jeHg6Ol9fZW5hYmxlX2lmPF9faXNfY2hh
cjxfQ2hhclQyPjo6X192YWx1ZSwKICAgICAgICAgICAgX0NoYXJUMio+OjpfX3R5cGUKICAgICAg
ICBfX2NvcHlfbW92ZV9hMihpc3RyZWFtYnVmX2l0ZXJhdG9yPF9DaGFyVDI+LAogICAgICAgICBp
c3RyZWFtYnVmX2l0ZXJhdG9yPF9DaGFyVDI+LCBfQ2hhclQyKik7CgogICAgICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfQ2hhclQyPgogICAgICAgIGZyaWVuZCB0eXBlbmFtZSBfX2dudV9jeHg6Ol9fZW5h
YmxlX2lmPF9faXNfY2hhcjxfQ2hhclQyPjo6X192YWx1ZSwKICAgICAgaXN0cmVhbWJ1Zl9pdGVy
YXRvcjxfQ2hhclQyPiA+OjpfX3R5cGUKICAgICAgICBmaW5kKGlzdHJlYW1idWZfaXRlcmF0b3I8
X0NoYXJUMj4sIGlzdHJlYW1idWZfaXRlcmF0b3I8X0NoYXJUMj4sCiAgICAgIGNvbnN0IF9DaGFy
VDImKTsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVDIsIHR5cGVuYW1lIF9UcmFpdHMy
PgogICAgICAgIGZyaWVuZCBiYXNpY19pc3RyZWFtPF9DaGFyVDIsIF9UcmFpdHMyPiYKICAgICAg
ICBvcGVyYXRvcj4+KGJhc2ljX2lzdHJlYW08X0NoYXJUMiwgX1RyYWl0czI+JiwgX0NoYXJUMiop
OwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUMiwgdHlwZW5hbWUgX1RyYWl0czIsIHR5
cGVuYW1lIF9BbGxvYz4KICAgICAgICBmcmllbmQgYmFzaWNfaXN0cmVhbTxfQ2hhclQyLCBfVHJh
aXRzMj4mCiAgICAgICAgb3BlcmF0b3I+PihiYXNpY19pc3RyZWFtPF9DaGFyVDIsIF9UcmFpdHMy
PiYsCiAgICAgYmFzaWNfc3RyaW5nPF9DaGFyVDIsIF9UcmFpdHMyLCBfQWxsb2M+Jik7CgogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQyLCB0eXBlbmFtZSBfVHJhaXRzMiwgdHlwZW5hbWUg
X0FsbG9jPgogICAgICAgIGZyaWVuZCBiYXNpY19pc3RyZWFtPF9DaGFyVDIsIF9UcmFpdHMyPiYK
ICAgICAgICBnZXRsaW5lKGJhc2ljX2lzdHJlYW08X0NoYXJUMiwgX1RyYWl0czI+JiwKICBiYXNp
Y19zdHJpbmc8X0NoYXJUMiwgX1RyYWl0czIsIF9BbGxvYz4mLCBfQ2hhclQyKTsKCiAgICBwcm90
ZWN0ZWQ6CgoKCgoKCgogICAgICBjaGFyX3R5cGUqIF9NX2luX2JlZzsKICAgICAgY2hhcl90eXBl
KiBfTV9pbl9jdXI7CiAgICAgIGNoYXJfdHlwZSogX01faW5fZW5kOwogICAgICBjaGFyX3R5cGUq
IF9NX291dF9iZWc7CiAgICAgIGNoYXJfdHlwZSogX01fb3V0X2N1cjsKICAgICAgY2hhcl90eXBl
KiBfTV9vdXRfZW5kOwoKCiAgICAgIGxvY2FsZSBfTV9idWZfbG9jYWxlOwoKICBwdWJsaWM6Cgog
ICAgICB2aXJ0dWFsCiAgICAgIH5iYXNpY19zdHJlYW1idWYoKQogICAgICB7IH0KIyAyMDggIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFtYnVmIiAzCiAgICAgIGxvY2FsZQogICAgICBwdWJp
bWJ1ZShjb25zdCBsb2NhbGUmIF9fbG9jKQogICAgICB7CiBsb2NhbGUgX190bXAodGhpcy0+Z2V0
bG9jKCkpOwogdGhpcy0+aW1idWUoX19sb2MpOwogX01fYnVmX2xvY2FsZSA9IF9fbG9jOwogcmV0
dXJuIF9fdG1wOwogICAgICB9CiMgMjI1ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmVhbWJ1
ZiIgMwogICAgICBsb2NhbGUKICAgICAgZ2V0bG9jKCkgY29uc3QKICAgICAgeyByZXR1cm4gX01f
YnVmX2xvY2FsZTsgfQojIDIzOCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zdHJlYW1idWYiIDMK
ICAgICAgYmFzaWNfc3RyZWFtYnVmKgogICAgICBwdWJzZXRidWYoY2hhcl90eXBlKiBfX3MsIHN0
cmVhbXNpemUgX19uKQogICAgICB7IHJldHVybiB0aGlzLT5zZXRidWYoX19zLCBfX24pOyB9CiMg
MjUwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmVhbWJ1ZiIgMwogICAgICBwb3NfdHlwZQog
ICAgICBwdWJzZWVrb2ZmKG9mZl90eXBlIF9fb2ZmLCBpb3NfYmFzZTo6c2Vla2RpciBfX3dheSwK
ICAgaW9zX2Jhc2U6Om9wZW5tb2RlIF9fbW9kZSA9IGlvc19iYXNlOjppbiB8IGlvc19iYXNlOjpv
dXQpCiAgICAgIHsgcmV0dXJuIHRoaXMtPnNlZWtvZmYoX19vZmYsIF9fd2F5LCBfX21vZGUpOyB9
CiMgMjYyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmVhbWJ1ZiIgMwogICAgICBwb3NfdHlw
ZQogICAgICBwdWJzZWVrcG9zKHBvc190eXBlIF9fc3AsCiAgIGlvc19iYXNlOjpvcGVubW9kZSBf
X21vZGUgPSBpb3NfYmFzZTo6aW4gfCBpb3NfYmFzZTo6b3V0KQogICAgICB7IHJldHVybiB0aGlz
LT5zZWVrcG9zKF9fc3AsIF9fbW9kZSk7IH0KCgoKCiAgICAgIGludAogICAgICBwdWJzeW5jKCkg
eyByZXR1cm4gdGhpcy0+c3luYygpOyB9CiMgMjgzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0
cmVhbWJ1ZiIgMwogICAgICBzdHJlYW1zaXplCiAgICAgIGluX2F2YWlsKCkKICAgICAgewogY29u
c3Qgc3RyZWFtc2l6ZSBfX3JldCA9IHRoaXMtPmVncHRyKCkgLSB0aGlzLT5ncHRyKCk7CiByZXR1
cm4gX19yZXQgPyBfX3JldCA6IHRoaXMtPnNob3dtYW55YygpOwogICAgICB9CiMgMjk3ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL3N0cmVhbWJ1ZiIgMwogICAgICBpbnRfdHlwZQogICAgICBzbmV4
dGMoKQogICAgICB7CiBpbnRfdHlwZSBfX3JldCA9IHRyYWl0c190eXBlOjplb2YoKTsKIGlmIChf
X2J1aWx0aW5fZXhwZWN0KCF0cmFpdHNfdHlwZTo6ZXFfaW50X3R5cGUodGhpcy0+c2J1bXBjKCks
CiAgICAgICAgICAgICBfX3JldCksIHRydWUpKQogICBfX3JldCA9IHRoaXMtPnNnZXRjKCk7CiBy
ZXR1cm4gX19yZXQ7CiAgICAgIH0KIyAzMTUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFt
YnVmIiAzCiAgICAgIGludF90eXBlCiAgICAgIHNidW1wYygpCiAgICAgIHsKIGludF90eXBlIF9f
cmV0OwogaWYgKF9fYnVpbHRpbl9leHBlY3QodGhpcy0+Z3B0cigpIDwgdGhpcy0+ZWdwdHIoKSwg
dHJ1ZSkpCiAgIHsKICAgICBfX3JldCA9IHRyYWl0c190eXBlOjp0b19pbnRfdHlwZSgqdGhpcy0+
Z3B0cigpKTsKICAgICB0aGlzLT5nYnVtcCgxKTsKICAgfQogZWxzZQogICBfX3JldCA9IHRoaXMt
PnVmbG93KCk7CiByZXR1cm4gX19yZXQ7CiAgICAgIH0KIyAzMzcgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvc3RyZWFtYnVmIiAzCiAgICAgIGludF90eXBlCiAgICAgIHNnZXRjKCkKICAgICAgewog
aW50X3R5cGUgX19yZXQ7CiBpZiAoX19idWlsdGluX2V4cGVjdCh0aGlzLT5ncHRyKCkgPCB0aGlz
LT5lZ3B0cigpLCB0cnVlKSkKICAgX19yZXQgPSB0cmFpdHNfdHlwZTo6dG9faW50X3R5cGUoKnRo
aXMtPmdwdHIoKSk7CiBlbHNlCiAgIF9fcmV0ID0gdGhpcy0+dW5kZXJmbG93KCk7CiByZXR1cm4g
X19yZXQ7CiAgICAgIH0KIyAzNTYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFtYnVmIiAz
CiAgICAgIHN0cmVhbXNpemUKICAgICAgc2dldG4oY2hhcl90eXBlKiBfX3MsIHN0cmVhbXNpemUg
X19uKQogICAgICB7IHJldHVybiB0aGlzLT54c2dldG4oX19zLCBfX24pOyB9CiMgMzcxICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL3N0cmVhbWJ1ZiIgMwogICAgICBpbnRfdHlwZQogICAgICBzcHV0
YmFja2MoY2hhcl90eXBlIF9fYykKICAgICAgewogaW50X3R5cGUgX19yZXQ7CiBjb25zdCBib29s
IF9fdGVzdHBvcyA9IHRoaXMtPmViYWNrKCkgPCB0aGlzLT5ncHRyKCk7CiBpZiAoX19idWlsdGlu
X2V4cGVjdCghX190ZXN0cG9zIHx8CiAgICAgICAgIXRyYWl0c190eXBlOjplcShfX2MsIHRoaXMt
PmdwdHIoKVstMV0pLCBmYWxzZSkpCiAgIF9fcmV0ID0gdGhpcy0+cGJhY2tmYWlsKHRyYWl0c190
eXBlOjp0b19pbnRfdHlwZShfX2MpKTsKIGVsc2UKICAgewogICAgIHRoaXMtPmdidW1wKC0xKTsK
ICAgICBfX3JldCA9IHRyYWl0c190eXBlOjp0b19pbnRfdHlwZSgqdGhpcy0+Z3B0cigpKTsKICAg
fQogcmV0dXJuIF9fcmV0OwogICAgICB9CiMgMzk2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0
cmVhbWJ1ZiIgMwogICAgICBpbnRfdHlwZQogICAgICBzdW5nZXRjKCkKICAgICAgewogaW50X3R5
cGUgX19yZXQ7CiBpZiAoX19idWlsdGluX2V4cGVjdCh0aGlzLT5lYmFjaygpIDwgdGhpcy0+Z3B0
cigpLCB0cnVlKSkKICAgewogICAgIHRoaXMtPmdidW1wKC0xKTsKICAgICBfX3JldCA9IHRyYWl0
c190eXBlOjp0b19pbnRfdHlwZSgqdGhpcy0+Z3B0cigpKTsKICAgfQogZWxzZQogICBfX3JldCA9
IHRoaXMtPnBiYWNrZmFpbCgpOwogcmV0dXJuIF9fcmV0OwogICAgICB9CiMgNDIzICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL3N0cmVhbWJ1ZiIgMwogICAgICBpbnRfdHlwZQogICAgICBzcHV0Yyhj
aGFyX3R5cGUgX19jKQogICAgICB7CiBpbnRfdHlwZSBfX3JldDsKIGlmIChfX2J1aWx0aW5fZXhw
ZWN0KHRoaXMtPnBwdHIoKSA8IHRoaXMtPmVwcHRyKCksIHRydWUpKQogICB7CiAgICAgKnRoaXMt
PnBwdHIoKSA9IF9fYzsKICAgICB0aGlzLT5wYnVtcCgxKTsKICAgICBfX3JldCA9IHRyYWl0c190
eXBlOjp0b19pbnRfdHlwZShfX2MpOwogICB9CiBlbHNlCiAgIF9fcmV0ID0gdGhpcy0+b3ZlcmZs
b3codHJhaXRzX3R5cGU6OnRvX2ludF90eXBlKF9fYykpOwogcmV0dXJuIF9fcmV0OwogICAgICB9
CiMgNDQ5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmVhbWJ1ZiIgMwogICAgICBzdHJlYW1z
aXplCiAgICAgIHNwdXRuKGNvbnN0IGNoYXJfdHlwZSogX19zLCBzdHJlYW1zaXplIF9fbikKICAg
ICAgeyByZXR1cm4gdGhpcy0+eHNwdXRuKF9fcywgX19uKTsgfQoKICAgIHByb3RlY3RlZDoKIyA0
NjMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFtYnVmIiAzCiAgICAgIGJhc2ljX3N0cmVh
bWJ1ZigpCiAgICAgIDogX01faW5fYmVnKDApLCBfTV9pbl9jdXIoMCksIF9NX2luX2VuZCgwKSwK
ICAgICAgX01fb3V0X2JlZygwKSwgX01fb3V0X2N1cigwKSwgX01fb3V0X2VuZCgwKSwKICAgICAg
X01fYnVmX2xvY2FsZShsb2NhbGUoKSkKICAgICAgeyB9CiMgNDgxICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL3N0cmVhbWJ1ZiIgMwogICAgICBjaGFyX3R5cGUqCiAgICAgIGViYWNrKCkgY29uc3Qg
eyByZXR1cm4gX01faW5fYmVnOyB9CgogICAgICBjaGFyX3R5cGUqCiAgICAgIGdwdHIoKSBjb25z
dCB7IHJldHVybiBfTV9pbl9jdXI7IH0KCiAgICAgIGNoYXJfdHlwZSoKICAgICAgZWdwdHIoKSBj
b25zdCB7IHJldHVybiBfTV9pbl9lbmQ7IH0KIyA0OTcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
c3RyZWFtYnVmIiAzCiAgICAgIHZvaWQKICAgICAgZ2J1bXAoaW50IF9fbikgeyBfTV9pbl9jdXIg
Kz0gX19uOyB9CiMgNTA4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmVhbWJ1ZiIgMwogICAg
ICB2b2lkCiAgICAgIHNldGcoY2hhcl90eXBlKiBfX2diZWcsIGNoYXJfdHlwZSogX19nbmV4dCwg
Y2hhcl90eXBlKiBfX2dlbmQpCiAgICAgIHsKIF9NX2luX2JlZyA9IF9fZ2JlZzsKIF9NX2luX2N1
ciA9IF9fZ25leHQ7CiBfTV9pbl9lbmQgPSBfX2dlbmQ7CiAgICAgIH0KIyA1MjggIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvc3RyZWFtYnVmIiAzCiAgICAgIGNoYXJfdHlwZSoKICAgICAgcGJhc2Uo
KSBjb25zdCB7IHJldHVybiBfTV9vdXRfYmVnOyB9CgogICAgICBjaGFyX3R5cGUqCiAgICAgIHBw
dHIoKSBjb25zdCB7IHJldHVybiBfTV9vdXRfY3VyOyB9CgogICAgICBjaGFyX3R5cGUqCiAgICAg
IGVwcHRyKCkgY29uc3QgeyByZXR1cm4gX01fb3V0X2VuZDsgfQojIDU0NCAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9zdHJlYW1idWYiIDMKICAgICAgdm9pZAogICAgICBwYnVtcChpbnQgX19uKSB7
IF9NX291dF9jdXIgKz0gX19uOyB9CiMgNTU0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmVh
bWJ1ZiIgMwogICAgICB2b2lkCiAgICAgIHNldHAoY2hhcl90eXBlKiBfX3BiZWcsIGNoYXJfdHlw
ZSogX19wZW5kKQogICAgICB7CiBfTV9vdXRfYmVnID0gX01fb3V0X2N1ciA9IF9fcGJlZzsKIF9N
X291dF9lbmQgPSBfX3BlbmQ7CiAgICAgIH0KIyA1NzUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
c3RyZWFtYnVmIiAzCiAgICAgIHZpcnR1YWwgdm9pZAogICAgICBpbWJ1ZShjb25zdCBsb2NhbGUm
IF9fbG9jKQogICAgICB7IH0KIyA1OTAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFtYnVm
IiAzCiAgICAgIHZpcnR1YWwgYmFzaWNfc3RyZWFtYnVmPGNoYXJfdHlwZSxfVHJhaXRzPioKICAg
ICAgc2V0YnVmKGNoYXJfdHlwZSosIHN0cmVhbXNpemUpCiAgICAgIHsgcmV0dXJuIHRoaXM7IH0K
IyA2MDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFtYnVmIiAzCiAgICAgIHZpcnR1YWwg
cG9zX3R5cGUKICAgICAgc2Vla29mZihvZmZfdHlwZSwgaW9zX2Jhc2U6OnNlZWtkaXIsCiAgICAg
ICBpb3NfYmFzZTo6b3Blbm1vZGUgPSBpb3NfYmFzZTo6aW4gfCBpb3NfYmFzZTo6b3V0KQogICAg
ICB7IHJldHVybiBwb3NfdHlwZShvZmZfdHlwZSgtMSkpOyB9CiMgNjEzICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL3N0cmVhbWJ1ZiIgMwogICAgICB2aXJ0dWFsIHBvc190eXBlCiAgICAgIHNlZWtw
b3MocG9zX3R5cGUsCiAgICAgICBpb3NfYmFzZTo6b3Blbm1vZGUgPSBpb3NfYmFzZTo6aW4gfCBp
b3NfYmFzZTo6b3V0KQogICAgICB7IHJldHVybiBwb3NfdHlwZShvZmZfdHlwZSgtMSkpOyB9CiMg
NjI2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmVhbWJ1ZiIgMwogICAgICB2aXJ0dWFsIGlu
dAogICAgICBzeW5jKCkgeyByZXR1cm4gMDsgfQojIDY0OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9zdHJlYW1idWYiIDMKICAgICAgdmlydHVhbCBzdHJlYW1zaXplCiAgICAgIHNob3dtYW55Yygp
IHsgcmV0dXJuIDA7IH0KIyA2NjQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFtYnVmIiAz
CiAgICAgIHZpcnR1YWwgc3RyZWFtc2l6ZQogICAgICB4c2dldG4oY2hhcl90eXBlKiBfX3MsIHN0
cmVhbXNpemUgX19uKTsKIyA2ODYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFtYnVmIiAz
CiAgICAgIHZpcnR1YWwgaW50X3R5cGUKICAgICAgdW5kZXJmbG93KCkKICAgICAgeyByZXR1cm4g
dHJhaXRzX3R5cGU6OmVvZigpOyB9CiMgNjk5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmVh
bWJ1ZiIgMwogICAgICB2aXJ0dWFsIGludF90eXBlCiAgICAgIHVmbG93KCkKICAgICAgewogaW50
X3R5cGUgX19yZXQgPSB0cmFpdHNfdHlwZTo6ZW9mKCk7CiBjb25zdCBib29sIF9fdGVzdGVvZiA9
IHRyYWl0c190eXBlOjplcV9pbnRfdHlwZSh0aGlzLT51bmRlcmZsb3coKSwKICAgICAgIF9fcmV0
KTsKIGlmICghX190ZXN0ZW9mKQogICB7CiAgICAgX19yZXQgPSB0cmFpdHNfdHlwZTo6dG9faW50
X3R5cGUoKnRoaXMtPmdwdHIoKSk7CiAgICAgdGhpcy0+Z2J1bXAoMSk7CiAgIH0KIHJldHVybiBf
X3JldDsKICAgICAgfQojIDcyMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zdHJlYW1idWYiIDMK
ICAgICAgdmlydHVhbCBpbnRfdHlwZQogICAgICBwYmFja2ZhaWwoaW50X3R5cGUgX19jID0gdHJh
aXRzX3R5cGU6OmVvZigpKQogICAgICB7IHJldHVybiB0cmFpdHNfdHlwZTo6ZW9mKCk7IH0KIyA3
NDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFtYnVmIiAzCiAgICAgIHZpcnR1YWwgc3Ry
ZWFtc2l6ZQogICAgICB4c3B1dG4oY29uc3QgY2hhcl90eXBlKiBfX3MsIHN0cmVhbXNpemUgX19u
KTsKIyA3NjcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFtYnVmIiAzCiAgICAgIHZpcnR1
YWwgaW50X3R5cGUKICAgICAgb3ZlcmZsb3coaW50X3R5cGUgX19jID0gdHJhaXRzX3R5cGU6OmVv
ZigpKQogICAgICB7IHJldHVybiB0cmFpdHNfdHlwZTo6ZW9mKCk7IH0KCgoKICAgIHB1YmxpYzoK
IyA3ODIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RyZWFtYnVmIiAzCiAgICAgIHZvaWQKICAg
ICAgc3Rvc3NjKCkKICAgICAgewogaWYgKHRoaXMtPmdwdHIoKSA8IHRoaXMtPmVncHRyKCkpCiAg
IHRoaXMtPmdidW1wKDEpOwogZWxzZQogICB0aGlzLT51ZmxvdygpOwogICAgICB9CgoKCiAgICAg
IHZvaWQKICAgICAgX19zYWZlX2didW1wKHN0cmVhbXNpemUgX19uKSB7IF9NX2luX2N1ciArPSBf
X247IH0KCiAgICAgIHZvaWQKICAgICAgX19zYWZlX3BidW1wKHN0cmVhbXNpemUgX19uKSB7IF9N
X291dF9jdXIgKz0gX19uOyB9CgoKCgogICAgcHJvdGVjdGVkOgoKICAgICAgYmFzaWNfc3RyZWFt
YnVmKGNvbnN0IGJhc2ljX3N0cmVhbWJ1ZiYpOwoKICAgICAgYmFzaWNfc3RyZWFtYnVmJgogICAg
ICBvcGVyYXRvcj0oY29uc3QgYmFzaWNfc3RyZWFtYnVmJik7CgoKICAgICAgdm9pZAogICAgICBz
d2FwKGJhc2ljX3N0cmVhbWJ1ZiYgX19zYikKICAgICAgewogc3RkOjpzd2FwKF9NX2luX2JlZywg
X19zYi5fTV9pbl9iZWcpOwogc3RkOjpzd2FwKF9NX2luX2N1ciwgX19zYi5fTV9pbl9jdXIpOwog
c3RkOjpzd2FwKF9NX2luX2VuZCwgX19zYi5fTV9pbl9lbmQpOwogc3RkOjpzd2FwKF9NX291dF9i
ZWcsIF9fc2IuX01fb3V0X2JlZyk7CiBzdGQ6OnN3YXAoX01fb3V0X2N1ciwgX19zYi5fTV9vdXRf
Y3VyKTsKIHN0ZDo6c3dhcChfTV9vdXRfZW5kLCBfX3NiLl9NX291dF9lbmQpOwogc3RkOjpzd2Fw
KF9NX2J1Zl9sb2NhbGUsIF9fc2IuX01fYnVmX2xvY2FsZSk7CiAgICAgIH0KCiAgICB9OwoKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgc3RkOjpiYXNp
Y19zdHJlYW1idWY8X0NoYXJULCBfVHJhaXRzPjo6CiAgICBiYXNpY19zdHJlYW1idWYoY29uc3Qg
YmFzaWNfc3RyZWFtYnVmJikgPSBkZWZhdWx0OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQs
IHR5cGVuYW1lIF9UcmFpdHM+CiAgICBzdGQ6OmJhc2ljX3N0cmVhbWJ1ZjxfQ2hhclQsIF9UcmFp
dHM+JgogICAgc3RkOjpiYXNpY19zdHJlYW1idWY8X0NoYXJULCBfVHJhaXRzPjo6CiAgICBvcGVy
YXRvcj0oY29uc3QgYmFzaWNfc3RyZWFtYnVmJikgPSBkZWZhdWx0OwoKCgogIHRlbXBsYXRlPD4K
ICAgIHN0cmVhbXNpemUKICAgIF9fY29weV9zdHJlYW1idWZzX2VvZihiYXNpY19zdHJlYW1idWY8
Y2hhcj4qIF9fc2JpbiwKICAgICBiYXNpY19zdHJlYW1idWY8Y2hhcj4qIF9fc2JvdXQsIGJvb2wm
IF9faW5lb2YpOwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJlYW1zaXplCiAgICBfX2NvcHlfc3RyZWFt
YnVmc19lb2YoYmFzaWNfc3RyZWFtYnVmPHdjaGFyX3Q+KiBfX3NiaW4sCiAgICAgYmFzaWNfc3Ry
ZWFtYnVmPHdjaGFyX3Q+KiBfX3Nib3V0LCBib29sJiBfX2luZW9mKTsKCgoKfQoKIyAxICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RyZWFtYnVmLnRjYyIgMSAzCiMgMzcgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdHJlYW1idWYudGNjIiAzCiAgICAgICAKIyAzOCAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0cmVhbWJ1Zi50Y2MiIDMKCm5hbWVzcGFjZSBzdGQgX19h
dHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgc3RyZWFtc2l6ZQogICAgYmFz
aWNfc3RyZWFtYnVmPF9DaGFyVCwgX1RyYWl0cz46OgogICAgeHNnZXRuKGNoYXJfdHlwZSogX19z
LCBzdHJlYW1zaXplIF9fbikKICAgIHsKICAgICAgc3RyZWFtc2l6ZSBfX3JldCA9IDA7CiAgICAg
IHdoaWxlIChfX3JldCA8IF9fbikKIHsKICAgY29uc3Qgc3RyZWFtc2l6ZSBfX2J1Zl9sZW4gPSB0
aGlzLT5lZ3B0cigpIC0gdGhpcy0+Z3B0cigpOwogICBpZiAoX19idWZfbGVuKQogICAgIHsKICAg
ICAgIGNvbnN0IHN0cmVhbXNpemUgX19yZW1haW5pbmcgPSBfX24gLSBfX3JldDsKICAgICAgIGNv
bnN0IHN0cmVhbXNpemUgX19sZW4gPSBzdGQ6Om1pbihfX2J1Zl9sZW4sIF9fcmVtYWluaW5nKTsK
ICAgICAgIHRyYWl0c190eXBlOjpjb3B5KF9fcywgdGhpcy0+Z3B0cigpLCBfX2xlbik7CiAgICAg
ICBfX3JldCArPSBfX2xlbjsKICAgICAgIF9fcyArPSBfX2xlbjsKICAgICAgIHRoaXMtPl9fc2Fm
ZV9nYnVtcChfX2xlbik7CiAgICAgfQoKICAgaWYgKF9fcmV0IDwgX19uKQogICAgIHsKICAgICAg
IGNvbnN0IGludF90eXBlIF9fYyA9IHRoaXMtPnVmbG93KCk7CiAgICAgICBpZiAoIXRyYWl0c190
eXBlOjplcV9pbnRfdHlwZShfX2MsIHRyYWl0c190eXBlOjplb2YoKSkpCiAgewogICAgdHJhaXRz
X3R5cGU6OmFzc2lnbigqX19zKyssIHRyYWl0c190eXBlOjp0b19jaGFyX3R5cGUoX19jKSk7CiAg
ICArK19fcmV0OwogIH0KICAgICAgIGVsc2UKICBicmVhazsKICAgICB9CiB9CiAgICAgIHJldHVy
biBfX3JldDsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJh
aXRzPgogICAgc3RyZWFtc2l6ZQogICAgYmFzaWNfc3RyZWFtYnVmPF9DaGFyVCwgX1RyYWl0cz46
OgogICAgeHNwdXRuKGNvbnN0IGNoYXJfdHlwZSogX19zLCBzdHJlYW1zaXplIF9fbikKICAgIHsK
ICAgICAgc3RyZWFtc2l6ZSBfX3JldCA9IDA7CiAgICAgIHdoaWxlIChfX3JldCA8IF9fbikKIHsK
ICAgY29uc3Qgc3RyZWFtc2l6ZSBfX2J1Zl9sZW4gPSB0aGlzLT5lcHB0cigpIC0gdGhpcy0+cHB0
cigpOwogICBpZiAoX19idWZfbGVuKQogICAgIHsKICAgICAgIGNvbnN0IHN0cmVhbXNpemUgX19y
ZW1haW5pbmcgPSBfX24gLSBfX3JldDsKICAgICAgIGNvbnN0IHN0cmVhbXNpemUgX19sZW4gPSBz
dGQ6Om1pbihfX2J1Zl9sZW4sIF9fcmVtYWluaW5nKTsKICAgICAgIHRyYWl0c190eXBlOjpjb3B5
KHRoaXMtPnBwdHIoKSwgX19zLCBfX2xlbik7CiAgICAgICBfX3JldCArPSBfX2xlbjsKICAgICAg
IF9fcyArPSBfX2xlbjsKICAgICAgIHRoaXMtPl9fc2FmZV9wYnVtcChfX2xlbik7CiAgICAgfQoK
ICAgaWYgKF9fcmV0IDwgX19uKQogICAgIHsKICAgICAgIGludF90eXBlIF9fYyA9IHRoaXMtPm92
ZXJmbG93KHRyYWl0c190eXBlOjp0b19pbnRfdHlwZSgqX19zKSk7CiAgICAgICBpZiAoIXRyYWl0
c190eXBlOjplcV9pbnRfdHlwZShfX2MsIHRyYWl0c190eXBlOjplb2YoKSkpCiAgewogICAgKytf
X3JldDsKICAgICsrX19zOwogIH0KICAgICAgIGVsc2UKICBicmVhazsKICAgICB9CiB9CiAgICAg
IHJldHVybiBfX3JldDsKICAgIH0KCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBl
bmFtZSBfVHJhaXRzPgogICAgc3RyZWFtc2l6ZQogICAgX19jb3B5X3N0cmVhbWJ1ZnNfZW9mKGJh
c2ljX3N0cmVhbWJ1ZjxfQ2hhclQsIF9UcmFpdHM+KiBfX3NiaW4sCiAgICAgYmFzaWNfc3RyZWFt
YnVmPF9DaGFyVCwgX1RyYWl0cz4qIF9fc2JvdXQsCiAgICAgYm9vbCYgX19pbmVvZikKICAgIHsK
ICAgICAgc3RyZWFtc2l6ZSBfX3JldCA9IDA7CiAgICAgIF9faW5lb2YgPSB0cnVlOwogICAgICB0
eXBlbmFtZSBfVHJhaXRzOjppbnRfdHlwZSBfX2MgPSBfX3NiaW4tPnNnZXRjKCk7CiAgICAgIHdo
aWxlICghX1RyYWl0czo6ZXFfaW50X3R5cGUoX19jLCBfVHJhaXRzOjplb2YoKSkpCiB7CiAgIF9f
YyA9IF9fc2JvdXQtPnNwdXRjKF9UcmFpdHM6OnRvX2NoYXJfdHlwZShfX2MpKTsKICAgaWYgKF9U
cmFpdHM6OmVxX2ludF90eXBlKF9fYywgX1RyYWl0czo6ZW9mKCkpKQogICAgIHsKICAgICAgIF9f
aW5lb2YgPSBmYWxzZTsKICAgICAgIGJyZWFrOwogICAgIH0KICAgKytfX3JldDsKICAgX19jID0g
X19zYmluLT5zbmV4dGMoKTsKIH0KICAgICAgcmV0dXJuIF9fcmV0OwogICAgfQoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBpbmxpbmUgc3RyZWFtc2l6
ZQogICAgX19jb3B5X3N0cmVhbWJ1ZnMoYmFzaWNfc3RyZWFtYnVmPF9DaGFyVCwgX1RyYWl0cz4q
IF9fc2JpbiwKICAgICAgICBiYXNpY19zdHJlYW1idWY8X0NoYXJULCBfVHJhaXRzPiogX19zYm91
dCkKICAgIHsKICAgICAgYm9vbCBfX2luZW9mOwogICAgICByZXR1cm4gX19jb3B5X3N0cmVhbWJ1
ZnNfZW9mKF9fc2JpbiwgX19zYm91dCwgX19pbmVvZik7CiAgICB9CgoKCgogIGV4dGVybiB0ZW1w
bGF0ZSBjbGFzcyBiYXNpY19zdHJlYW1idWY8Y2hhcj47CiAgZXh0ZXJuIHRlbXBsYXRlCiAgICBz
dHJlYW1zaXplCiAgICBfX2NvcHlfc3RyZWFtYnVmcyhiYXNpY19zdHJlYW1idWY8Y2hhcj4qLAog
ICAgICAgIGJhc2ljX3N0cmVhbWJ1ZjxjaGFyPiopOwogIGV4dGVybiB0ZW1wbGF0ZQogICAgc3Ry
ZWFtc2l6ZQogICAgX19jb3B5X3N0cmVhbWJ1ZnNfZW9mKGJhc2ljX3N0cmVhbWJ1ZjxjaGFyPios
CiAgICAgYmFzaWNfc3RyZWFtYnVmPGNoYXI+KiwgYm9vbCYpOwoKCiAgZXh0ZXJuIHRlbXBsYXRl
IGNsYXNzIGJhc2ljX3N0cmVhbWJ1Zjx3Y2hhcl90PjsKICBleHRlcm4gdGVtcGxhdGUKICAgIHN0
cmVhbXNpemUKICAgIF9fY29weV9zdHJlYW1idWZzKGJhc2ljX3N0cmVhbWJ1Zjx3Y2hhcl90Pios
CiAgICAgICAgYmFzaWNfc3RyZWFtYnVmPHdjaGFyX3Q+Kik7CiAgZXh0ZXJuIHRlbXBsYXRlCiAg
ICBzdHJlYW1zaXplCiAgICBfX2NvcHlfc3RyZWFtYnVmc19lb2YoYmFzaWNfc3RyZWFtYnVmPHdj
aGFyX3Q+KiwKICAgICBiYXNpY19zdHJlYW1idWY8d2NoYXJfdD4qLCBib29sJik7CgoKCgp9CiMg
ODUxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3N0cmVhbWJ1ZiIgMiAzCiMgNDQgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvaW9zIiAyIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
YmFzaWNfaW9zLmgiIDEgMwojIDMzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNf
aW9zLmgiIDMKICAgICAgIAojIDM0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNf
aW9zLmgiIDMKCgoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0
cy5oIiAxIDMKIyAzNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMu
aCIgMwogICAgICAgCiMgMzggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFj
ZXRzLmgiIDMKCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jd2N0eXBlIiAxIDMKIyAzOSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jd2N0eXBlIiAzCiAgICAgICAKIyA0MCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9jd2N0eXBlIiAzCiMgNTAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3dj
dHlwZSIgMwojIDEgIi91c3IvaW5jbHVkZS93Y3R5cGUuaCIgMSAzIDQKIyAzMyAiL3Vzci9pbmNs
dWRlL3djdHlwZS5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvd2NoYXIuaCIgMSAzIDQKIyAzNCAi
L3Vzci9pbmNsdWRlL3djdHlwZS5oIiAyIDMgNAojIDQ5ICIvdXNyL2luY2x1ZGUvd2N0eXBlLmgi
IDMgNAoKCgp0eXBlZGVmIHVuc2lnbmVkIGxvbmcgaW50IHdjdHlwZV90OwoKIyA3MSAiL3Vzci9p
bmNsdWRlL3djdHlwZS5oIiAzIDQKZW51bQp7CiAgX19JU3d1cHBlciA9IDAsCiAgX19JU3dsb3dl
ciA9IDEsCiAgX19JU3dhbHBoYSA9IDIsCiAgX19JU3dkaWdpdCA9IDMsCiAgX19JU3d4ZGlnaXQg
PSA0LAogIF9fSVN3c3BhY2UgPSA1LAogIF9fSVN3cHJpbnQgPSA2LAogIF9fSVN3Z3JhcGggPSA3
LAogIF9fSVN3YmxhbmsgPSA4LAogIF9fSVN3Y250cmwgPSA5LAogIF9fSVN3cHVuY3QgPSAxMCwK
ICBfX0lTd2FsbnVtID0gMTEsCgogIF9JU3d1cHBlciA9ICgxIDw8IChfX0lTd3VwcGVyKSksCiAg
X0lTd2xvd2VyID0gKDEgPDwgKF9fSVN3bG93ZXIpKSwKICBfSVN3YWxwaGEgPSAoMSA8PCAoX19J
U3dhbHBoYSkpLAogIF9JU3dkaWdpdCA9ICgxIDw8IChfX0lTd2RpZ2l0KSksCiAgX0lTd3hkaWdp
dCA9ICgxIDw8IChfX0lTd3hkaWdpdCkpLAogIF9JU3dzcGFjZSA9ICgxIDw8IChfX0lTd3NwYWNl
KSksCiAgX0lTd3ByaW50ID0gKDEgPDwgKF9fSVN3cHJpbnQpKSwKICBfSVN3Z3JhcGggPSAoMSA8
PCAoX19JU3dncmFwaCkpLAogIF9JU3dibGFuayA9ICgxIDw8IChfX0lTd2JsYW5rKSksCiAgX0lT
d2NudHJsID0gKDEgPDwgKF9fSVN3Y250cmwpKSwKICBfSVN3cHVuY3QgPSAoMSA8PCAoX19JU3dw
dW5jdCkpLAogIF9JU3dhbG51bSA9ICgxIDw8IChfX0lTd2FsbnVtKSkKfTsKCgoKZXh0ZXJuICJD
IiB7CgoKCgoKCgoKZXh0ZXJuIGludCBpc3dhbG51bSAod2ludF90IF9fd2MpIHRocm93ICgpOwoK
CgoKCmV4dGVybiBpbnQgaXN3YWxwaGEgKHdpbnRfdCBfX3djKSB0aHJvdyAoKTsKCgpleHRlcm4g
aW50IGlzd2NudHJsICh3aW50X3QgX193YykgdGhyb3cgKCk7CgoKCmV4dGVybiBpbnQgaXN3ZGln
aXQgKHdpbnRfdCBfX3djKSB0aHJvdyAoKTsKCgoKZXh0ZXJuIGludCBpc3dncmFwaCAod2ludF90
IF9fd2MpIHRocm93ICgpOwoKCgoKZXh0ZXJuIGludCBpc3dsb3dlciAod2ludF90IF9fd2MpIHRo
cm93ICgpOwoKCmV4dGVybiBpbnQgaXN3cHJpbnQgKHdpbnRfdCBfX3djKSB0aHJvdyAoKTsKCgoK
CmV4dGVybiBpbnQgaXN3cHVuY3QgKHdpbnRfdCBfX3djKSB0aHJvdyAoKTsKCgoKCmV4dGVybiBp
bnQgaXN3c3BhY2UgKHdpbnRfdCBfX3djKSB0aHJvdyAoKTsKCgoKCmV4dGVybiBpbnQgaXN3dXBw
ZXIgKHdpbnRfdCBfX3djKSB0aHJvdyAoKTsKCgoKCmV4dGVybiBpbnQgaXN3eGRpZ2l0ICh3aW50
X3QgX193YykgdGhyb3cgKCk7CgoKCgoKZXh0ZXJuIGludCBpc3dibGFuayAod2ludF90IF9fd2Mp
IHRocm93ICgpOwojIDE3MSAiL3Vzci9pbmNsdWRlL3djdHlwZS5oIiAzIDQKZXh0ZXJuIHdjdHlw
ZV90IHdjdHlwZSAoY29uc3QgY2hhciAqX19wcm9wZXJ0eSkgdGhyb3cgKCk7CgoKCmV4dGVybiBp
bnQgaXN3Y3R5cGUgKHdpbnRfdCBfX3djLCB3Y3R5cGVfdCBfX2Rlc2MpIHRocm93ICgpOwoKCgoK
CgoKCgoKdHlwZWRlZiBjb25zdCBfX2ludDMyX3QgKndjdHJhbnNfdDsKCgoKCgoKCmV4dGVybiB3
aW50X3QgdG93bG93ZXIgKHdpbnRfdCBfX3djKSB0aHJvdyAoKTsKCgpleHRlcm4gd2ludF90IHRv
d3VwcGVyICh3aW50X3QgX193YykgdGhyb3cgKCk7CgoKfQojIDIxMyAiL3Vzci9pbmNsdWRlL3dj
dHlwZS5oIiAzIDQKZXh0ZXJuICJDIiB7CgoKCgpleHRlcm4gd2N0cmFuc190IHdjdHJhbnMgKGNv
bnN0IGNoYXIgKl9fcHJvcGVydHkpIHRocm93ICgpOwoKCmV4dGVybiB3aW50X3QgdG93Y3RyYW5z
ICh3aW50X3QgX193Yywgd2N0cmFuc190IF9fZGVzYykgdGhyb3cgKCk7CgoKCgoKCgoKZXh0ZXJu
IGludCBpc3dhbG51bV9sICh3aW50X3QgX193YywgX19sb2NhbGVfdCBfX2xvY2FsZSkgdGhyb3cg
KCk7CgoKCgoKZXh0ZXJuIGludCBpc3dhbHBoYV9sICh3aW50X3QgX193YywgX19sb2NhbGVfdCBf
X2xvY2FsZSkgdGhyb3cgKCk7CgoKZXh0ZXJuIGludCBpc3djbnRybF9sICh3aW50X3QgX193Yywg
X19sb2NhbGVfdCBfX2xvY2FsZSkgdGhyb3cgKCk7CgoKCmV4dGVybiBpbnQgaXN3ZGlnaXRfbCAo
d2ludF90IF9fd2MsIF9fbG9jYWxlX3QgX19sb2NhbGUpIHRocm93ICgpOwoKCgpleHRlcm4gaW50
IGlzd2dyYXBoX2wgKHdpbnRfdCBfX3djLCBfX2xvY2FsZV90IF9fbG9jYWxlKSB0aHJvdyAoKTsK
CgoKCmV4dGVybiBpbnQgaXN3bG93ZXJfbCAod2ludF90IF9fd2MsIF9fbG9jYWxlX3QgX19sb2Nh
bGUpIHRocm93ICgpOwoKCmV4dGVybiBpbnQgaXN3cHJpbnRfbCAod2ludF90IF9fd2MsIF9fbG9j
YWxlX3QgX19sb2NhbGUpIHRocm93ICgpOwoKCgoKZXh0ZXJuIGludCBpc3dwdW5jdF9sICh3aW50
X3QgX193YywgX19sb2NhbGVfdCBfX2xvY2FsZSkgdGhyb3cgKCk7CgoKCgpleHRlcm4gaW50IGlz
d3NwYWNlX2wgKHdpbnRfdCBfX3djLCBfX2xvY2FsZV90IF9fbG9jYWxlKSB0aHJvdyAoKTsKCgoK
CmV4dGVybiBpbnQgaXN3dXBwZXJfbCAod2ludF90IF9fd2MsIF9fbG9jYWxlX3QgX19sb2NhbGUp
IHRocm93ICgpOwoKCgoKZXh0ZXJuIGludCBpc3d4ZGlnaXRfbCAod2ludF90IF9fd2MsIF9fbG9j
YWxlX3QgX19sb2NhbGUpIHRocm93ICgpOwoKCgoKZXh0ZXJuIGludCBpc3dibGFua19sICh3aW50
X3QgX193YywgX19sb2NhbGVfdCBfX2xvY2FsZSkgdGhyb3cgKCk7CgoKCmV4dGVybiB3Y3R5cGVf
dCB3Y3R5cGVfbCAoY29uc3QgY2hhciAqX19wcm9wZXJ0eSwgX19sb2NhbGVfdCBfX2xvY2FsZSkK
ICAgICB0aHJvdyAoKTsKCgoKZXh0ZXJuIGludCBpc3djdHlwZV9sICh3aW50X3QgX193Yywgd2N0
eXBlX3QgX19kZXNjLCBfX2xvY2FsZV90IF9fbG9jYWxlKQogICAgIHRocm93ICgpOwoKCgoKCgoK
ZXh0ZXJuIHdpbnRfdCB0b3dsb3dlcl9sICh3aW50X3QgX193YywgX19sb2NhbGVfdCBfX2xvY2Fs
ZSkgdGhyb3cgKCk7CgoKZXh0ZXJuIHdpbnRfdCB0b3d1cHBlcl9sICh3aW50X3QgX193YywgX19s
b2NhbGVfdCBfX2xvY2FsZSkgdGhyb3cgKCk7CgoKCmV4dGVybiB3Y3RyYW5zX3Qgd2N0cmFuc19s
IChjb25zdCBjaGFyICpfX3Byb3BlcnR5LCBfX2xvY2FsZV90IF9fbG9jYWxlKQogICAgIHRocm93
ICgpOwoKCmV4dGVybiB3aW50X3QgdG93Y3RyYW5zX2wgKHdpbnRfdCBfX3djLCB3Y3RyYW5zX3Qg
X19kZXNjLAogICAgICBfX2xvY2FsZV90IF9fbG9jYWxlKSB0aHJvdyAoKTsKCgoKfQojIDUxICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2N3Y3R5cGUiIDIgMwojIDgwICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2N3Y3R5cGUiIDMKbmFtZXNwYWNlIHN0ZAp7CiAgdXNpbmcgOjp3Y3RyYW5zX3Q7CiAg
dXNpbmcgOjp3Y3R5cGVfdDsKICB1c2luZyA6OndpbnRfdDsKCiAgdXNpbmcgOjppc3dhbG51bTsK
ICB1c2luZyA6Omlzd2FscGhhOwoKICB1c2luZyA6Omlzd2JsYW5rOwoKICB1c2luZyA6Omlzd2Nu
dHJsOwogIHVzaW5nIDo6aXN3Y3R5cGU7CiAgdXNpbmcgOjppc3dkaWdpdDsKICB1c2luZyA6Omlz
d2dyYXBoOwogIHVzaW5nIDo6aXN3bG93ZXI7CiAgdXNpbmcgOjppc3dwcmludDsKICB1c2luZyA6
Omlzd3B1bmN0OwogIHVzaW5nIDo6aXN3c3BhY2U7CiAgdXNpbmcgOjppc3d1cHBlcjsKICB1c2lu
ZyA6Omlzd3hkaWdpdDsKICB1c2luZyA6OnRvd2N0cmFuczsKICB1c2luZyA6OnRvd2xvd2VyOwog
IHVzaW5nIDo6dG93dXBwZXI7CiAgdXNpbmcgOjp3Y3RyYW5zOwogIHVzaW5nIDo6d2N0eXBlOwp9
CiMgNDAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDIgMwoj
IDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY2N0eXBlIiAxIDMKIyAzOSAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9jY3R5cGUiIDMKICAgICAgIAojIDQwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2NjdHlwZSIgMwojIDQxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0
cy5oIiAyIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9i
aXRzL2N0eXBlX2Jhc2UuaCIgMSAzCiMgMzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvczM5MHgt
cmVkaGF0LWxpbnV4L2JpdHMvY3R5cGVfYmFzZS5oIiAzCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1
dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCgogIHN0cnVjdCBjdHlwZV9i
YXNlCiAgewoKICAgIHR5cGVkZWYgY29uc3QgaW50KiBfX3RvX3R5cGU7CgoKCiAgICB0eXBlZGVm
IHVuc2lnbmVkIHNob3J0IG1hc2s7CiAgICBzdGF0aWMgY29uc3QgbWFzayB1cHBlciA9IF9JU3Vw
cGVyOwogICAgc3RhdGljIGNvbnN0IG1hc2sgbG93ZXIgPSBfSVNsb3dlcjsKICAgIHN0YXRpYyBj
b25zdCBtYXNrIGFscGhhID0gX0lTYWxwaGE7CiAgICBzdGF0aWMgY29uc3QgbWFzayBkaWdpdCA9
IF9JU2RpZ2l0OwogICAgc3RhdGljIGNvbnN0IG1hc2sgeGRpZ2l0ID0gX0lTeGRpZ2l0OwogICAg
c3RhdGljIGNvbnN0IG1hc2sgc3BhY2UgPSBfSVNzcGFjZTsKICAgIHN0YXRpYyBjb25zdCBtYXNr
IHByaW50ID0gX0lTcHJpbnQ7CiAgICBzdGF0aWMgY29uc3QgbWFzayBncmFwaCA9IF9JU2FscGhh
IHwgX0lTZGlnaXQgfCBfSVNwdW5jdDsKICAgIHN0YXRpYyBjb25zdCBtYXNrIGNudHJsID0gX0lT
Y250cmw7CiAgICBzdGF0aWMgY29uc3QgbWFzayBwdW5jdCA9IF9JU3B1bmN0OwogICAgc3RhdGlj
IGNvbnN0IG1hc2sgYWxudW0gPSBfSVNhbHBoYSB8IF9JU2RpZ2l0OwoKICAgIHN0YXRpYyBjb25z
dCBtYXNrIGJsYW5rID0gX0lTYmxhbms7CgogIH07CgoKfQojIDQyICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAyIDMKCgoKCgoKIyAxICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RyZWFtYnVmX2l0ZXJhdG9yLmgiIDEgMwojIDMzICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvc3RyZWFtYnVmX2l0ZXJhdG9yLmgiIDMKICAgICAgIAojIDM0ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RyZWFtYnVmX2l0ZXJhdG9yLmgiIDMKCgoKCm5h
bWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkK
ewoKIyA0OSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0cmVhbWJ1Zl9pdGVyYXRvci5o
IiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgY2xh
c3MgaXN0cmVhbWJ1Zl9pdGVyYXRvcgogICAgOiBwdWJsaWMgaXRlcmF0b3I8aW5wdXRfaXRlcmF0
b3JfdGFnLCBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM6Om9mZl90eXBlLAogICAgICAgICAgICAg
ICAgICAgICAgX0NoYXJUKiwKCgogICAgICAgIF9DaGFyVD4KCgoKICAgIHsKICAgIHB1YmxpYzoK
CgoKICAgICAgdHlwZWRlZiBfQ2hhclQgY2hhcl90eXBlOwogICAgICB0eXBlZGVmIF9UcmFpdHMg
dHJhaXRzX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX1RyYWl0czo6aW50X3R5cGUgaW50
X3R5cGU7CiAgICAgIHR5cGVkZWYgYmFzaWNfc3RyZWFtYnVmPF9DaGFyVCwgX1RyYWl0cz4gc3Ry
ZWFtYnVmX3R5cGU7CiAgICAgIHR5cGVkZWYgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+
IGlzdHJlYW1fdHlwZTsKCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQyPgogZnJpZW5k
IHR5cGVuYW1lIF9fZ251X2N4eDo6X19lbmFibGVfaWY8X19pc19jaGFyPF9DaGFyVDI+OjpfX3Zh
bHVlLAogICAgICAgICAgICAgICAgICAgICAgb3N0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQyPiA+
OjpfX3R5cGUKIGNvcHkoaXN0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQyPiwgaXN0cmVhbWJ1Zl9p
dGVyYXRvcjxfQ2hhclQyPiwKICAgICAgb3N0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQyPik7Cgog
ICAgICB0ZW1wbGF0ZTxib29sIF9Jc01vdmUsIHR5cGVuYW1lIF9DaGFyVDI+CiBmcmllbmQgdHlw
ZW5hbWUgX19nbnVfY3h4OjpfX2VuYWJsZV9pZjxfX2lzX2NoYXI8X0NoYXJUMj46Ol9fdmFsdWUs
CiAgICAgICAgICAgIF9DaGFyVDIqPjo6X190eXBlCiBfX2NvcHlfbW92ZV9hMihpc3RyZWFtYnVm
X2l0ZXJhdG9yPF9DaGFyVDI+LAogICAgICAgICBpc3RyZWFtYnVmX2l0ZXJhdG9yPF9DaGFyVDI+
LCBfQ2hhclQyKik7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQyPgogZnJpZW5kIHR5
cGVuYW1lIF9fZ251X2N4eDo6X19lbmFibGVfaWY8X19pc19jaGFyPF9DaGFyVDI+OjpfX3ZhbHVl
LAogICAgICAgICAgICAgICBpc3RyZWFtYnVmX2l0ZXJhdG9yPF9DaGFyVDI+ID46Ol9fdHlwZQog
ZmluZChpc3RyZWFtYnVmX2l0ZXJhdG9yPF9DaGFyVDI+LCBpc3RyZWFtYnVmX2l0ZXJhdG9yPF9D
aGFyVDI+LAogICAgICBjb25zdCBfQ2hhclQyJik7CgogICAgcHJpdmF0ZToKCgoKCgoKCiAgICAg
IG11dGFibGUgc3RyZWFtYnVmX3R5cGUqIF9NX3NidWY7CiAgICAgIG11dGFibGUgaW50X3R5cGUg
X01fYzsKCiAgICBwdWJsaWM6CgogICAgICBjb25zdGV4cHIgaXN0cmVhbWJ1Zl9pdGVyYXRvcigp
IG5vZXhjZXB0CiAgICAgIDogX01fc2J1ZigwKSwgX01fYyh0cmFpdHNfdHlwZTo6ZW9mKCkpIHsg
fQoKCiAgICAgIGlzdHJlYW1idWZfaXRlcmF0b3IoY29uc3QgaXN0cmVhbWJ1Zl9pdGVyYXRvciYp
IG5vZXhjZXB0ID0gZGVmYXVsdDsKCiAgICAgIH5pc3RyZWFtYnVmX2l0ZXJhdG9yKCkgPSBkZWZh
dWx0OwoKCgogICAgICBpc3RyZWFtYnVmX2l0ZXJhdG9yKGlzdHJlYW1fdHlwZSYgX19zKSBub2V4
Y2VwdAogICAgICA6IF9NX3NidWYoX19zLnJkYnVmKCkpLCBfTV9jKHRyYWl0c190eXBlOjplb2Yo
KSkgeyB9CgoKICAgICAgaXN0cmVhbWJ1Zl9pdGVyYXRvcihzdHJlYW1idWZfdHlwZSogX19zKSBu
b2V4Y2VwdAogICAgICA6IF9NX3NidWYoX19zKSwgX01fYyh0cmFpdHNfdHlwZTo6ZW9mKCkpIHsg
fQoKCgoKICAgICAgY2hhcl90eXBlCiAgICAgIG9wZXJhdG9yKigpIGNvbnN0CiAgICAgIHsKCgoK
CgoKCiByZXR1cm4gdHJhaXRzX3R5cGU6OnRvX2NoYXJfdHlwZShfTV9nZXQoKSk7CiAgICAgIH0K
CgogICAgICBpc3RyZWFtYnVmX2l0ZXJhdG9yJgogICAgICBvcGVyYXRvcisrKCkKICAgICAgewoK
CiAgICAgICAgICAgICAgICAgICAgICAgIDsKIGlmIChfTV9zYnVmKQogICB7CiAgICAgX01fc2J1
Zi0+c2J1bXBjKCk7CiAgICAgX01fYyA9IHRyYWl0c190eXBlOjplb2YoKTsKICAgfQogcmV0dXJu
ICp0aGlzOwogICAgICB9CgoKICAgICAgaXN0cmVhbWJ1Zl9pdGVyYXRvcgogICAgICBvcGVyYXRv
cisrKGludCkKICAgICAgewoKCiAgICAgICAgICAgICAgICAgICAgICAgIDsKCiBpc3RyZWFtYnVm
X2l0ZXJhdG9yIF9fb2xkID0gKnRoaXM7CiBpZiAoX01fc2J1ZikKICAgewogICAgIF9fb2xkLl9N
X2MgPSBfTV9zYnVmLT5zYnVtcGMoKTsKICAgICBfTV9jID0gdHJhaXRzX3R5cGU6OmVvZigpOwog
ICB9CiByZXR1cm4gX19vbGQ7CiAgICAgIH0KCgoKCgogICAgICBib29sCiAgICAgIGVxdWFsKGNv
bnN0IGlzdHJlYW1idWZfaXRlcmF0b3ImIF9fYikgY29uc3QKICAgICAgeyByZXR1cm4gX01fYXRf
ZW9mKCkgPT0gX19iLl9NX2F0X2VvZigpOyB9CgogICAgcHJpdmF0ZToKICAgICAgaW50X3R5cGUK
ICAgICAgX01fZ2V0KCkgY29uc3QKICAgICAgewogY29uc3QgaW50X3R5cGUgX19lb2YgPSB0cmFp
dHNfdHlwZTo6ZW9mKCk7CiBpbnRfdHlwZSBfX3JldCA9IF9fZW9mOwogaWYgKF9NX3NidWYpCiAg
IHsKICAgICBpZiAoIXRyYWl0c190eXBlOjplcV9pbnRfdHlwZShfTV9jLCBfX2VvZikpCiAgICAg
ICBfX3JldCA9IF9NX2M7CiAgICAgZWxzZSBpZiAoIXRyYWl0c190eXBlOjplcV9pbnRfdHlwZSgo
X19yZXQgPSBfTV9zYnVmLT5zZ2V0YygpKSwKICAgICAgICAgICAgX19lb2YpKQogICAgICAgX01f
YyA9IF9fcmV0OwogICAgIGVsc2UKICAgICAgIF9NX3NidWYgPSAwOwogICB9CiByZXR1cm4gX19y
ZXQ7CiAgICAgIH0KCiAgICAgIGJvb2wKICAgICAgX01fYXRfZW9mKCkgY29uc3QKICAgICAgewog
Y29uc3QgaW50X3R5cGUgX19lb2YgPSB0cmFpdHNfdHlwZTo6ZW9mKCk7CiByZXR1cm4gdHJhaXRz
X3R5cGU6OmVxX2ludF90eXBlKF9NX2dldCgpLCBfX2VvZik7CiAgICAgIH0KICAgIH07CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIGlubGluZSBib29s
CiAgICBvcGVyYXRvcj09KGNvbnN0IGlzdHJlYW1idWZfaXRlcmF0b3I8X0NoYXJULCBfVHJhaXRz
PiYgX19hLAogICAgICAgIGNvbnN0IGlzdHJlYW1idWZfaXRlcmF0b3I8X0NoYXJULCBfVHJhaXRz
PiYgX19iKQogICAgeyByZXR1cm4gX19hLmVxdWFsKF9fYik7IH0KCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9y
IT0oY29uc3QgaXN0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQsIF9UcmFpdHM+JiBfX2EsCiAgICAg
ICAgY29uc3QgaXN0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQsIF9UcmFpdHM+JiBfX2IpCiAgICB7
IHJldHVybiAhX19hLmVxdWFsKF9fYik7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwg
dHlwZW5hbWUgX1RyYWl0cz4KICAgIGNsYXNzIG9zdHJlYW1idWZfaXRlcmF0b3IKICAgIDogcHVi
bGljIGl0ZXJhdG9yPG91dHB1dF9pdGVyYXRvcl90YWcsIHZvaWQsIHZvaWQsIHZvaWQsIHZvaWQ+
CiAgICB7CiAgICBwdWJsaWM6CgoKCiAgICAgIHR5cGVkZWYgX0NoYXJUIGNoYXJfdHlwZTsKICAg
ICAgdHlwZWRlZiBfVHJhaXRzIHRyYWl0c190eXBlOwogICAgICB0eXBlZGVmIGJhc2ljX3N0cmVh
bWJ1ZjxfQ2hhclQsIF9UcmFpdHM+IHN0cmVhbWJ1Zl90eXBlOwogICAgICB0eXBlZGVmIGJhc2lj
X29zdHJlYW08X0NoYXJULCBfVHJhaXRzPiBvc3RyZWFtX3R5cGU7CgoKICAgICAgdGVtcGxhdGU8
dHlwZW5hbWUgX0NoYXJUMj4KIGZyaWVuZCB0eXBlbmFtZSBfX2dudV9jeHg6Ol9fZW5hYmxlX2lm
PF9faXNfY2hhcjxfQ2hhclQyPjo6X192YWx1ZSwKICAgICAgICAgICAgICAgICAgICAgIG9zdHJl
YW1idWZfaXRlcmF0b3I8X0NoYXJUMj4gPjo6X190eXBlCiBjb3B5KGlzdHJlYW1idWZfaXRlcmF0
b3I8X0NoYXJUMj4sIGlzdHJlYW1idWZfaXRlcmF0b3I8X0NoYXJUMj4sCiAgICAgIG9zdHJlYW1i
dWZfaXRlcmF0b3I8X0NoYXJUMj4pOwoKICAgIHByaXZhdGU6CiAgICAgIHN0cmVhbWJ1Zl90eXBl
KiBfTV9zYnVmOwogICAgICBib29sIF9NX2ZhaWxlZDsKCiAgICBwdWJsaWM6CgogICAgICBvc3Ry
ZWFtYnVmX2l0ZXJhdG9yKG9zdHJlYW1fdHlwZSYgX19zKSBub2V4Y2VwdAogICAgICA6IF9NX3Ni
dWYoX19zLnJkYnVmKCkpLCBfTV9mYWlsZWQoIV9NX3NidWYpIHsgfQoKCiAgICAgIG9zdHJlYW1i
dWZfaXRlcmF0b3Ioc3RyZWFtYnVmX3R5cGUqIF9fcykgbm9leGNlcHQKICAgICAgOiBfTV9zYnVm
KF9fcyksIF9NX2ZhaWxlZCghX01fc2J1ZikgeyB9CgoKICAgICAgb3N0cmVhbWJ1Zl9pdGVyYXRv
ciYKICAgICAgb3BlcmF0b3I9KF9DaGFyVCBfX2MpCiAgICAgIHsKIGlmICghX01fZmFpbGVkICYm
CiAgICAgX1RyYWl0czo6ZXFfaW50X3R5cGUoX01fc2J1Zi0+c3B1dGMoX19jKSwgX1RyYWl0czo6
ZW9mKCkpKQogICBfTV9mYWlsZWQgPSB0cnVlOwogcmV0dXJuICp0aGlzOwogICAgICB9CgoKICAg
ICAgb3N0cmVhbWJ1Zl9pdGVyYXRvciYKICAgICAgb3BlcmF0b3IqKCkKICAgICAgeyByZXR1cm4g
KnRoaXM7IH0KCgogICAgICBvc3RyZWFtYnVmX2l0ZXJhdG9yJgogICAgICBvcGVyYXRvcisrKGlu
dCkKICAgICAgeyByZXR1cm4gKnRoaXM7IH0KCgogICAgICBvc3RyZWFtYnVmX2l0ZXJhdG9yJgog
ICAgICBvcGVyYXRvcisrKCkKICAgICAgeyByZXR1cm4gKnRoaXM7IH0KCgogICAgICBib29sCiAg
ICAgIGZhaWxlZCgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX2ZhaWxlZDsgfQoK
ICAgICAgb3N0cmVhbWJ1Zl9pdGVyYXRvciYKICAgICAgX01fcHV0KGNvbnN0IF9DaGFyVCogX193
cywgc3RyZWFtc2l6ZSBfX2xlbikKICAgICAgewogaWYgKF9fYnVpbHRpbl9leHBlY3QoIV9NX2Zh
aWxlZCwgdHJ1ZSkKICAgICAmJiBfX2J1aWx0aW5fZXhwZWN0KHRoaXMtPl9NX3NidWYtPnNwdXRu
KF9fd3MsIF9fbGVuKSAhPSBfX2xlbiwKICAgIGZhbHNlKSkKICAgX01fZmFpbGVkID0gdHJ1ZTsK
IHJldHVybiAqdGhpczsKICAgICAgfQogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFy
VD4KICAgIHR5cGVuYW1lIF9fZ251X2N4eDo6X19lbmFibGVfaWY8X19pc19jaGFyPF9DaGFyVD46
Ol9fdmFsdWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zdHJlYW1idWZfaXRlcmF0b3I8
X0NoYXJUPiA+OjpfX3R5cGUKICAgIGNvcHkoaXN0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQ+IF9f
Zmlyc3QsCiAgaXN0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQ+IF9fbGFzdCwKICBvc3RyZWFtYnVm
X2l0ZXJhdG9yPF9DaGFyVD4gX19yZXN1bHQpCiAgICB7CiAgICAgIGlmIChfX2ZpcnN0Ll9NX3Ni
dWYgJiYgIV9fbGFzdC5fTV9zYnVmICYmICFfX3Jlc3VsdC5fTV9mYWlsZWQpCiB7CiAgIGJvb2wg
X19pbmVvZjsKICAgX19jb3B5X3N0cmVhbWJ1ZnNfZW9mKF9fZmlyc3QuX01fc2J1ZiwgX19yZXN1
bHQuX01fc2J1ZiwgX19pbmVvZik7CiAgIGlmICghX19pbmVvZikKICAgICBfX3Jlc3VsdC5fTV9m
YWlsZWQgPSB0cnVlOwogfQogICAgICByZXR1cm4gX19yZXN1bHQ7CiAgICB9CgogIHRlbXBsYXRl
PGJvb2wgX0lzTW92ZSwgdHlwZW5hbWUgX0NoYXJUPgogICAgdHlwZW5hbWUgX19nbnVfY3h4Ojpf
X2VuYWJsZV9pZjxfX2lzX2NoYXI8X0NoYXJUPjo6X192YWx1ZSwKICAgICAgICAgICAgb3N0cmVh
bWJ1Zl9pdGVyYXRvcjxfQ2hhclQ+ID46Ol9fdHlwZQogICAgX19jb3B5X21vdmVfYTIoX0NoYXJU
KiBfX2ZpcnN0LCBfQ2hhclQqIF9fbGFzdCwKICAgICBvc3RyZWFtYnVmX2l0ZXJhdG9yPF9DaGFy
VD4gX19yZXN1bHQpCiAgICB7CiAgICAgIGNvbnN0IHN0cmVhbXNpemUgX19udW0gPSBfX2xhc3Qg
LSBfX2ZpcnN0OwogICAgICBpZiAoX19udW0gPiAwKQogX19yZXN1bHQuX01fcHV0KF9fZmlyc3Qs
IF9fbnVtKTsKICAgICAgcmV0dXJuIF9fcmVzdWx0OwogICAgfQoKICB0ZW1wbGF0ZTxib29sIF9J
c01vdmUsIHR5cGVuYW1lIF9DaGFyVD4KICAgIHR5cGVuYW1lIF9fZ251X2N4eDo6X19lbmFibGVf
aWY8X19pc19jaGFyPF9DaGFyVD46Ol9fdmFsdWUsCiAgICAgICAgb3N0cmVhbWJ1Zl9pdGVyYXRv
cjxfQ2hhclQ+ID46Ol9fdHlwZQogICAgX19jb3B5X21vdmVfYTIoY29uc3QgX0NoYXJUKiBfX2Zp
cnN0LCBjb25zdCBfQ2hhclQqIF9fbGFzdCwKICAgICBvc3RyZWFtYnVmX2l0ZXJhdG9yPF9DaGFy
VD4gX19yZXN1bHQpCiAgICB7CiAgICAgIGNvbnN0IHN0cmVhbXNpemUgX19udW0gPSBfX2xhc3Qg
LSBfX2ZpcnN0OwogICAgICBpZiAoX19udW0gPiAwKQogX19yZXN1bHQuX01fcHV0KF9fZmlyc3Qs
IF9fbnVtKTsKICAgICAgcmV0dXJuIF9fcmVzdWx0OwogICAgfQoKICB0ZW1wbGF0ZTxib29sIF9J
c01vdmUsIHR5cGVuYW1lIF9DaGFyVD4KICAgIHR5cGVuYW1lIF9fZ251X2N4eDo6X19lbmFibGVf
aWY8X19pc19jaGFyPF9DaGFyVD46Ol9fdmFsdWUsCiAgICAgICAgICAgIF9DaGFyVCo+OjpfX3R5
cGUKICAgIF9fY29weV9tb3ZlX2EyKGlzdHJlYW1idWZfaXRlcmF0b3I8X0NoYXJUPiBfX2ZpcnN0
LAogICAgIGlzdHJlYW1idWZfaXRlcmF0b3I8X0NoYXJUPiBfX2xhc3QsIF9DaGFyVCogX19yZXN1
bHQpCiAgICB7CiAgICAgIHR5cGVkZWYgaXN0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQ+IF9faXNf
aXRlcmF0b3JfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX2lzX2l0ZXJhdG9yX3R5cGU6
OnRyYWl0c190eXBlIHRyYWl0c190eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9faXNfaXRl
cmF0b3JfdHlwZTo6c3RyZWFtYnVmX3R5cGUgc3RyZWFtYnVmX3R5cGU7CiAgICAgIHR5cGVkZWYg
dHlwZW5hbWUgdHJhaXRzX3R5cGU6OmludF90eXBlIGludF90eXBlOwoKICAgICAgaWYgKF9fZmly
c3QuX01fc2J1ZiAmJiAhX19sYXN0Ll9NX3NidWYpCiB7CiAgIHN0cmVhbWJ1Zl90eXBlKiBfX3Ni
ID0gX19maXJzdC5fTV9zYnVmOwogICBpbnRfdHlwZSBfX2MgPSBfX3NiLT5zZ2V0YygpOwogICB3
aGlsZSAoIXRyYWl0c190eXBlOjplcV9pbnRfdHlwZShfX2MsIHRyYWl0c190eXBlOjplb2YoKSkp
CiAgICAgewogICAgICAgY29uc3Qgc3RyZWFtc2l6ZSBfX24gPSBfX3NiLT5lZ3B0cigpIC0gX19z
Yi0+Z3B0cigpOwogICAgICAgaWYgKF9fbiA+IDEpCiAgewogICAgdHJhaXRzX3R5cGU6OmNvcHko
X19yZXN1bHQsIF9fc2ItPmdwdHIoKSwgX19uKTsKICAgIF9fc2ItPl9fc2FmZV9nYnVtcChfX24p
OwogICAgX19yZXN1bHQgKz0gX19uOwogICAgX19jID0gX19zYi0+dW5kZXJmbG93KCk7CiAgfQog
ICAgICAgZWxzZQogIHsKICAgICpfX3Jlc3VsdCsrID0gdHJhaXRzX3R5cGU6OnRvX2NoYXJfdHlw
ZShfX2MpOwogICAgX19jID0gX19zYi0+c25leHRjKCk7CiAgfQogICAgIH0KIH0KICAgICAgcmV0
dXJuIF9fcmVzdWx0OwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICB0eXBl
bmFtZSBfX2dudV9jeHg6Ol9fZW5hYmxlX2lmPF9faXNfY2hhcjxfQ2hhclQ+OjpfX3ZhbHVlLAog
ICAgICAgICAgaXN0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQ+ID46Ol9fdHlwZQogICAgZmluZChp
c3RyZWFtYnVmX2l0ZXJhdG9yPF9DaGFyVD4gX19maXJzdCwKICBpc3RyZWFtYnVmX2l0ZXJhdG9y
PF9DaGFyVD4gX19sYXN0LCBjb25zdCBfQ2hhclQmIF9fdmFsKQogICAgewogICAgICB0eXBlZGVm
IGlzdHJlYW1idWZfaXRlcmF0b3I8X0NoYXJUPiBfX2lzX2l0ZXJhdG9yX3R5cGU7CiAgICAgIHR5
cGVkZWYgdHlwZW5hbWUgX19pc19pdGVyYXRvcl90eXBlOjp0cmFpdHNfdHlwZSB0cmFpdHNfdHlw
ZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX2lzX2l0ZXJhdG9yX3R5cGU6OnN0cmVhbWJ1Zl90
eXBlIHN0cmVhbWJ1Zl90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIHRyYWl0c190eXBlOjpp
bnRfdHlwZSBpbnRfdHlwZTsKCiAgICAgIGlmIChfX2ZpcnN0Ll9NX3NidWYgJiYgIV9fbGFzdC5f
TV9zYnVmKQogewogICBjb25zdCBpbnRfdHlwZSBfX2l2YWwgPSB0cmFpdHNfdHlwZTo6dG9faW50
X3R5cGUoX192YWwpOwogICBzdHJlYW1idWZfdHlwZSogX19zYiA9IF9fZmlyc3QuX01fc2J1ZjsK
ICAgaW50X3R5cGUgX19jID0gX19zYi0+c2dldGMoKTsKICAgd2hpbGUgKCF0cmFpdHNfdHlwZTo6
ZXFfaW50X3R5cGUoX19jLCB0cmFpdHNfdHlwZTo6ZW9mKCkpCiAgICYmICF0cmFpdHNfdHlwZTo6
ZXFfaW50X3R5cGUoX19jLCBfX2l2YWwpKQogICAgIHsKICAgICAgIHN0cmVhbXNpemUgX19uID0g
X19zYi0+ZWdwdHIoKSAtIF9fc2ItPmdwdHIoKTsKICAgICAgIGlmIChfX24gPiAxKQogIHsKICAg
IGNvbnN0IF9DaGFyVCogX19wID0gdHJhaXRzX3R5cGU6OmZpbmQoX19zYi0+Z3B0cigpLAogICAg
ICAgX19uLCBfX3ZhbCk7CiAgICBpZiAoX19wKQogICAgICBfX24gPSBfX3AgLSBfX3NiLT5ncHRy
KCk7CiAgICBfX3NiLT5fX3NhZmVfZ2J1bXAoX19uKTsKICAgIF9fYyA9IF9fc2ItPnNnZXRjKCk7
CiAgfQogICAgICAgZWxzZQogIF9fYyA9IF9fc2ItPnNuZXh0YygpOwogICAgIH0KCiAgIGlmICgh
dHJhaXRzX3R5cGU6OmVxX2ludF90eXBlKF9fYywgdHJhaXRzX3R5cGU6OmVvZigpKSkKICAgICBf
X2ZpcnN0Ll9NX2MgPSBfX2M7CiAgIGVsc2UKICAgICBfX2ZpcnN0Ll9NX3NidWYgPSAwOwogfQog
ICAgICByZXR1cm4gX19maXJzdDsKICAgIH0KCgoKCn0KIyA0OSAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMiAzCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRl
X18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCiMgNzEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+
CiAgICB2b2lkCiAgICBfX2NvbnZlcnRfdG9fdihjb25zdCBjaGFyKiwgX1RwJiwgaW9zX2Jhc2U6
Omlvc3RhdGUmLAogICAgIGNvbnN0IF9fY19sb2NhbGUmKSB0aHJvdygpOwoKCiAgdGVtcGxhdGU8
PgogICAgdm9pZAogICAgX19jb252ZXJ0X3RvX3YoY29uc3QgY2hhciosIGZsb2F0JiwgaW9zX2Jh
c2U6Omlvc3RhdGUmLAogICAgIGNvbnN0IF9fY19sb2NhbGUmKSB0aHJvdygpOwoKICB0ZW1wbGF0
ZTw+CiAgICB2b2lkCiAgICBfX2NvbnZlcnRfdG9fdihjb25zdCBjaGFyKiwgZG91YmxlJiwgaW9z
X2Jhc2U6Omlvc3RhdGUmLAogICAgIGNvbnN0IF9fY19sb2NhbGUmKSB0aHJvdygpOwoKICB0ZW1w
bGF0ZTw+CiAgICB2b2lkCiAgICBfX2NvbnZlcnRfdG9fdihjb25zdCBjaGFyKiwgbG9uZyBkb3Vi
bGUmLCBpb3NfYmFzZTo6aW9zdGF0ZSYsCiAgICAgY29uc3QgX19jX2xvY2FsZSYpIHRocm93KCk7
CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgc3Ry
dWN0IF9fcGFkCiAgICB7CiAgICAgIHN0YXRpYyB2b2lkCiAgICAgIF9TX3BhZChpb3NfYmFzZSYg
X19pbywgX0NoYXJUIF9fZmlsbCwgX0NoYXJUKiBfX25ld3MsCiAgICAgIGNvbnN0IF9DaGFyVCog
X19vbGRzLCBzdHJlYW1zaXplIF9fbmV3bGVuLCBzdHJlYW1zaXplIF9fb2xkbGVuKTsKICAgIH07
CgoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgX0NoYXJUKgogICAgX19hZGRf
Z3JvdXBpbmcoX0NoYXJUKiBfX3MsIF9DaGFyVCBfX3NlcCwKICAgICBjb25zdCBjaGFyKiBfX2di
ZWcsIHNpemVfdCBfX2dzaXplLAogICAgIGNvbnN0IF9DaGFyVCogX19maXJzdCwgY29uc3QgX0No
YXJUKiBfX2xhc3QpOwoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBpbmxpbmUK
ICAgIG9zdHJlYW1idWZfaXRlcmF0b3I8X0NoYXJUPgogICAgX193cml0ZShvc3RyZWFtYnVmX2l0
ZXJhdG9yPF9DaGFyVD4gX19zLCBjb25zdCBfQ2hhclQqIF9fd3MsIGludCBfX2xlbikKICAgIHsK
ICAgICAgX19zLl9NX3B1dChfX3dzLCBfX2xlbik7CiAgICAgIHJldHVybiBfX3M7CiAgICB9CgoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9PdXRJdGVyPgogICAgaW5saW5l
CiAgICBfT3V0SXRlcgogICAgX193cml0ZShfT3V0SXRlciBfX3MsIGNvbnN0IF9DaGFyVCogX193
cywgaW50IF9fbGVuKQogICAgewogICAgICBmb3IgKGludCBfX2ogPSAwOyBfX2ogPCBfX2xlbjsg
X19qKyssICsrX19zKQogKl9fcyA9IF9fd3NbX19qXTsKICAgICAgcmV0dXJuIF9fczsKICAgIH0K
IyAxNDkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBjbGFzcyBfX2N0eXBlX2Fic3RyYWN0X2Jhc2Ug
OiBwdWJsaWMgbG9jYWxlOjpmYWNldCwgcHVibGljIGN0eXBlX2Jhc2UKICAgIHsKICAgIHB1Ymxp
YzoKCgogICAgICB0eXBlZGVmIF9DaGFyVCBjaGFyX3R5cGU7CiMgMTY4ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIGJvb2wKICAgICAgaXMobWFz
ayBfX20sIGNoYXJfdHlwZSBfX2MpIGNvbnN0CiAgICAgIHsgcmV0dXJuIHRoaXMtPmRvX2lzKF9f
bSwgX19jKTsgfQojIDE4NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNl
dHMuaCIgMwogICAgICBjb25zdCBjaGFyX3R5cGUqCiAgICAgIGlzKGNvbnN0IGNoYXJfdHlwZSAq
X19sbywgY29uc3QgY2hhcl90eXBlICpfX2hpLCBtYXNrICpfX3ZlYykgY29uc3QKICAgICAgeyBy
ZXR1cm4gdGhpcy0+ZG9faXMoX19sbywgX19oaSwgX192ZWMpOyB9CiMgMjAxICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIGNvbnN0IGNoYXJfdHlw
ZSoKICAgICAgc2Nhbl9pcyhtYXNrIF9fbSwgY29uc3QgY2hhcl90eXBlKiBfX2xvLCBjb25zdCBj
aGFyX3R5cGUqIF9faGkpIGNvbnN0CiAgICAgIHsgcmV0dXJuIHRoaXMtPmRvX3NjYW5faXMoX19t
LCBfX2xvLCBfX2hpKTsgfQojIDIxNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2Fs
ZV9mYWNldHMuaCIgMwogICAgICBjb25zdCBjaGFyX3R5cGUqCiAgICAgIHNjYW5fbm90KG1hc2sg
X19tLCBjb25zdCBjaGFyX3R5cGUqIF9fbG8sIGNvbnN0IGNoYXJfdHlwZSogX19oaSkgY29uc3QK
ICAgICAgeyByZXR1cm4gdGhpcy0+ZG9fc2Nhbl9ub3QoX19tLCBfX2xvLCBfX2hpKTsgfQojIDIz
MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICBj
aGFyX3R5cGUKICAgICAgdG91cHBlcihjaGFyX3R5cGUgX19jKSBjb25zdAogICAgICB7IHJldHVy
biB0aGlzLT5kb190b3VwcGVyKF9fYyk7IH0KIyAyNDYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgY29uc3QgY2hhcl90eXBlKgogICAgICB0b3Vw
cGVyKGNoYXJfdHlwZSAqX19sbywgY29uc3QgY2hhcl90eXBlKiBfX2hpKSBjb25zdAogICAgICB7
IHJldHVybiB0aGlzLT5kb190b3VwcGVyKF9fbG8sIF9faGkpOyB9CiMgMjYwICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIGNoYXJfdHlwZQogICAg
ICB0b2xvd2VyKGNoYXJfdHlwZSBfX2MpIGNvbnN0CiAgICAgIHsgcmV0dXJuIHRoaXMtPmRvX3Rv
bG93ZXIoX19jKTsgfQojIDI3NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9m
YWNldHMuaCIgMwogICAgICBjb25zdCBjaGFyX3R5cGUqCiAgICAgIHRvbG93ZXIoY2hhcl90eXBl
KiBfX2xvLCBjb25zdCBjaGFyX3R5cGUqIF9faGkpIGNvbnN0CiAgICAgIHsgcmV0dXJuIHRoaXMt
PmRvX3RvbG93ZXIoX19sbywgX19oaSk7IH0KIyAyOTIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgY2hhcl90eXBlCiAgICAgIHdpZGVuKGNoYXIg
X19jKSBjb25zdAogICAgICB7IHJldHVybiB0aGlzLT5kb193aWRlbihfX2MpOyB9CiMgMzExICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIGNvbnN0
IGNoYXIqCiAgICAgIHdpZGVuKGNvbnN0IGNoYXIqIF9fbG8sIGNvbnN0IGNoYXIqIF9faGksIGNo
YXJfdHlwZSogX190bykgY29uc3QKICAgICAgeyByZXR1cm4gdGhpcy0+ZG9fd2lkZW4oX19sbywg
X19oaSwgX190byk7IH0KIyAzMzAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVf
ZmFjZXRzLmgiIDMKICAgICAgY2hhcgogICAgICBuYXJyb3coY2hhcl90eXBlIF9fYywgY2hhciBf
X2RmYXVsdCkgY29uc3QKICAgICAgeyByZXR1cm4gdGhpcy0+ZG9fbmFycm93KF9fYywgX19kZmF1
bHQpOyB9CiMgMzUyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5o
IiAzCiAgICAgIGNvbnN0IGNoYXJfdHlwZSoKICAgICAgbmFycm93KGNvbnN0IGNoYXJfdHlwZSog
X19sbywgY29uc3QgY2hhcl90eXBlKiBfX2hpLAogICAgICAgY2hhciBfX2RmYXVsdCwgY2hhciog
X190bykgY29uc3QKICAgICAgeyByZXR1cm4gdGhpcy0+ZG9fbmFycm93KF9fbG8sIF9faGksIF9f
ZGZhdWx0LCBfX3RvKTsgfQoKICAgIHByb3RlY3RlZDoKICAgICAgZXhwbGljaXQKICAgICAgX19j
dHlwZV9hYnN0cmFjdF9iYXNlKHNpemVfdCBfX3JlZnMgPSAwKTogZmFjZXQoX19yZWZzKSB7IH0K
CiAgICAgIHZpcnR1YWwKICAgICAgfl9fY3R5cGVfYWJzdHJhY3RfYmFzZSgpIHsgfQojIDM3NyAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICB2aXJ0
dWFsIGJvb2wKICAgICAgZG9faXMobWFzayBfX20sIGNoYXJfdHlwZSBfX2MpIGNvbnN0ID0gMDsK
IyAzOTYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAg
ICAgdmlydHVhbCBjb25zdCBjaGFyX3R5cGUqCiAgICAgIGRvX2lzKGNvbnN0IGNoYXJfdHlwZSog
X19sbywgY29uc3QgY2hhcl90eXBlKiBfX2hpLAogICAgIG1hc2sqIF9fdmVjKSBjb25zdCA9IDA7
CiMgNDE1ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAg
ICAgIHZpcnR1YWwgY29uc3QgY2hhcl90eXBlKgogICAgICBkb19zY2FuX2lzKG1hc2sgX19tLCBj
b25zdCBjaGFyX3R5cGUqIF9fbG8sCiAgIGNvbnN0IGNoYXJfdHlwZSogX19oaSkgY29uc3QgPSAw
OwojIDQzNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwog
ICAgICB2aXJ0dWFsIGNvbnN0IGNoYXJfdHlwZSoKICAgICAgZG9fc2Nhbl9ub3QobWFzayBfX20s
IGNvbnN0IGNoYXJfdHlwZSogX19sbywKICAgIGNvbnN0IGNoYXJfdHlwZSogX19oaSkgY29uc3Qg
PSAwOwojIDQ1MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIg
MwogICAgICB2aXJ0dWFsIGNoYXJfdHlwZQogICAgICBkb190b3VwcGVyKGNoYXJfdHlwZSBfX2Mp
IGNvbnN0ID0gMDsKIyA0NjkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFj
ZXRzLmgiIDMKICAgICAgdmlydHVhbCBjb25zdCBjaGFyX3R5cGUqCiAgICAgIGRvX3RvdXBwZXIo
Y2hhcl90eXBlKiBfX2xvLCBjb25zdCBjaGFyX3R5cGUqIF9faGkpIGNvbnN0ID0gMDsKIyA0ODUg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgdmly
dHVhbCBjaGFyX3R5cGUKICAgICAgZG9fdG9sb3dlcihjaGFyX3R5cGUgX19jKSBjb25zdCA9IDA7
CiMgNTAyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAg
ICAgIHZpcnR1YWwgY29uc3QgY2hhcl90eXBlKgogICAgICBkb190b2xvd2VyKGNoYXJfdHlwZSog
X19sbywgY29uc3QgY2hhcl90eXBlKiBfX2hpKSBjb25zdCA9IDA7CiMgNTIxICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIHZpcnR1YWwgY2hhcl90
eXBlCiAgICAgIGRvX3dpZGVuKGNoYXIgX19jKSBjb25zdCA9IDA7CiMgNTQyICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIHZpcnR1YWwgY29uc3Qg
Y2hhcioKICAgICAgZG9fd2lkZW4oY29uc3QgY2hhciogX19sbywgY29uc3QgY2hhciogX19oaSwg
Y2hhcl90eXBlKiBfX3RvKSBjb25zdCA9IDA7CiMgNTYzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIHZpcnR1YWwgY2hhcgogICAgICBkb19uYXJy
b3coY2hhcl90eXBlIF9fYywgY2hhciBfX2RmYXVsdCkgY29uc3QgPSAwOwojIDU4OCAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICB2aXJ0dWFsIGNv
bnN0IGNoYXJfdHlwZSoKICAgICAgZG9fbmFycm93KGNvbnN0IGNoYXJfdHlwZSogX19sbywgY29u
c3QgY2hhcl90eXBlKiBfX2hpLAogIGNoYXIgX19kZmF1bHQsIGNoYXIqIF9fdG8pIGNvbnN0ID0g
MDsKICAgIH07CiMgNjExICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0
cy5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgY2xhc3MgY3R5cGUgOiBwdWJs
aWMgX19jdHlwZV9hYnN0cmFjdF9iYXNlPF9DaGFyVD4KICAgIHsKICAgIHB1YmxpYzoKCiAgICAg
IHR5cGVkZWYgX0NoYXJUIGNoYXJfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX2N0eXBl
X2Fic3RyYWN0X2Jhc2U8X0NoYXJUPjo6bWFzayBtYXNrOwoKCiAgICAgIHN0YXRpYyBsb2NhbGU6
OmlkIGlkOwoKICAgICAgZXhwbGljaXQKICAgICAgY3R5cGUoc2l6ZV90IF9fcmVmcyA9IDApIDog
X19jdHlwZV9hYnN0cmFjdF9iYXNlPF9DaGFyVD4oX19yZWZzKSB7IH0KCiAgIHByb3RlY3RlZDoK
ICAgICAgdmlydHVhbAogICAgICB+Y3R5cGUoKTsKCiAgICAgIHZpcnR1YWwgYm9vbAogICAgICBk
b19pcyhtYXNrIF9fbSwgY2hhcl90eXBlIF9fYykgY29uc3Q7CgogICAgICB2aXJ0dWFsIGNvbnN0
IGNoYXJfdHlwZSoKICAgICAgZG9faXMoY29uc3QgY2hhcl90eXBlKiBfX2xvLCBjb25zdCBjaGFy
X3R5cGUqIF9faGksIG1hc2sqIF9fdmVjKSBjb25zdDsKCiAgICAgIHZpcnR1YWwgY29uc3QgY2hh
cl90eXBlKgogICAgICBkb19zY2FuX2lzKG1hc2sgX19tLCBjb25zdCBjaGFyX3R5cGUqIF9fbG8s
IGNvbnN0IGNoYXJfdHlwZSogX19oaSkgY29uc3Q7CgogICAgICB2aXJ0dWFsIGNvbnN0IGNoYXJf
dHlwZSoKICAgICAgZG9fc2Nhbl9ub3QobWFzayBfX20sIGNvbnN0IGNoYXJfdHlwZSogX19sbywK
ICAgIGNvbnN0IGNoYXJfdHlwZSogX19oaSkgY29uc3Q7CgogICAgICB2aXJ0dWFsIGNoYXJfdHlw
ZQogICAgICBkb190b3VwcGVyKGNoYXJfdHlwZSBfX2MpIGNvbnN0OwoKICAgICAgdmlydHVhbCBj
b25zdCBjaGFyX3R5cGUqCiAgICAgIGRvX3RvdXBwZXIoY2hhcl90eXBlKiBfX2xvLCBjb25zdCBj
aGFyX3R5cGUqIF9faGkpIGNvbnN0OwoKICAgICAgdmlydHVhbCBjaGFyX3R5cGUKICAgICAgZG9f
dG9sb3dlcihjaGFyX3R5cGUgX19jKSBjb25zdDsKCiAgICAgIHZpcnR1YWwgY29uc3QgY2hhcl90
eXBlKgogICAgICBkb190b2xvd2VyKGNoYXJfdHlwZSogX19sbywgY29uc3QgY2hhcl90eXBlKiBf
X2hpKSBjb25zdDsKCiAgICAgIHZpcnR1YWwgY2hhcl90eXBlCiAgICAgIGRvX3dpZGVuKGNoYXIg
X19jKSBjb25zdDsKCiAgICAgIHZpcnR1YWwgY29uc3QgY2hhcioKICAgICAgZG9fd2lkZW4oY29u
c3QgY2hhciogX19sbywgY29uc3QgY2hhciogX19oaSwgY2hhcl90eXBlKiBfX2Rlc3QpIGNvbnN0
OwoKICAgICAgdmlydHVhbCBjaGFyCiAgICAgIGRvX25hcnJvdyhjaGFyX3R5cGUsIGNoYXIgX19k
ZmF1bHQpIGNvbnN0OwoKICAgICAgdmlydHVhbCBjb25zdCBjaGFyX3R5cGUqCiAgICAgIGRvX25h
cnJvdyhjb25zdCBjaGFyX3R5cGUqIF9fbG8sIGNvbnN0IGNoYXJfdHlwZSogX19oaSwKICBjaGFy
IF9fZGZhdWx0LCBjaGFyKiBfX3RvKSBjb25zdDsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9DaGFyVD4KICAgIGxvY2FsZTo6aWQgY3R5cGU8X0NoYXJUPjo6aWQ7CiMgNjgwICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgdGVtcGxhdGU8PgogICAg
Y2xhc3MgY3R5cGU8Y2hhcj4gOiBwdWJsaWMgbG9jYWxlOjpmYWNldCwgcHVibGljIGN0eXBlX2Jh
c2UKICAgIHsKICAgIHB1YmxpYzoKCgogICAgICB0eXBlZGVmIGNoYXIgY2hhcl90eXBlOwoKICAg
IHByb3RlY3RlZDoKCiAgICAgIF9fY19sb2NhbGUgX01fY19sb2NhbGVfY3R5cGU7CiAgICAgIGJv
b2wgX01fZGVsOwogICAgICBfX3RvX3R5cGUgX01fdG91cHBlcjsKICAgICAgX190b190eXBlIF9N
X3RvbG93ZXI7CiAgICAgIGNvbnN0IG1hc2sqIF9NX3RhYmxlOwogICAgICBtdXRhYmxlIGNoYXIg
X01fd2lkZW5fb2s7CiAgICAgIG11dGFibGUgY2hhciBfTV93aWRlblsxICsgc3RhdGljX2Nhc3Q8
dW5zaWduZWQgY2hhcj4oLTEpXTsKICAgICAgbXV0YWJsZSBjaGFyIF9NX25hcnJvd1sxICsgc3Rh
dGljX2Nhc3Q8dW5zaWduZWQgY2hhcj4oLTEpXTsKICAgICAgbXV0YWJsZSBjaGFyIF9NX25hcnJv
d19vazsKCgogICAgcHVibGljOgoKICAgICAgc3RhdGljIGxvY2FsZTo6aWQgaWQ7CgogICAgICBz
dGF0aWMgY29uc3Qgc2l6ZV90IHRhYmxlX3NpemUgPSAxICsgc3RhdGljX2Nhc3Q8dW5zaWduZWQg
Y2hhcj4oLTEpOwojIDcxNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNl
dHMuaCIgMwogICAgICBleHBsaWNpdAogICAgICBjdHlwZShjb25zdCBtYXNrKiBfX3RhYmxlID0g
MCwgYm9vbCBfX2RlbCA9IGZhbHNlLCBzaXplX3QgX19yZWZzID0gMCk7CiMgNzMwICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIGV4cGxpY2l0CiAg
ICAgIGN0eXBlKF9fY19sb2NhbGUgX19jbG9jLCBjb25zdCBtYXNrKiBfX3RhYmxlID0gMCwgYm9v
bCBfX2RlbCA9IGZhbHNlLAogICAgIHNpemVfdCBfX3JlZnMgPSAwKTsKIyA3NDMgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgaW5saW5lIGJvb2wK
ICAgICAgaXMobWFzayBfX20sIGNoYXIgX19jKSBjb25zdDsKIyA3NTggIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgaW5saW5lIGNvbnN0IGNoYXIq
CiAgICAgIGlzKGNvbnN0IGNoYXIqIF9fbG8sIGNvbnN0IGNoYXIqIF9faGksIG1hc2sqIF9fdmVj
KSBjb25zdDsKIyA3NzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRz
LmgiIDMKICAgICAgaW5saW5lIGNvbnN0IGNoYXIqCiAgICAgIHNjYW5faXMobWFzayBfX20sIGNv
bnN0IGNoYXIqIF9fbG8sIGNvbnN0IGNoYXIqIF9faGkpIGNvbnN0OwojIDc4NiAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICBpbmxpbmUgY29uc3Qg
Y2hhcioKICAgICAgc2Nhbl9ub3QobWFzayBfX20sIGNvbnN0IGNoYXIqIF9fbG8sIGNvbnN0IGNo
YXIqIF9faGkpIGNvbnN0OwojIDgwMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2Fs
ZV9mYWNldHMuaCIgMwogICAgICBjaGFyX3R5cGUKICAgICAgdG91cHBlcihjaGFyX3R5cGUgX19j
KSBjb25zdAogICAgICB7IHJldHVybiB0aGlzLT5kb190b3VwcGVyKF9fYyk7IH0KIyA4MTggIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgY29uc3Qg
Y2hhcl90eXBlKgogICAgICB0b3VwcGVyKGNoYXJfdHlwZSAqX19sbywgY29uc3QgY2hhcl90eXBl
KiBfX2hpKSBjb25zdAogICAgICB7IHJldHVybiB0aGlzLT5kb190b3VwcGVyKF9fbG8sIF9faGkp
OyB9CiMgODM0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAz
CiAgICAgIGNoYXJfdHlwZQogICAgICB0b2xvd2VyKGNoYXJfdHlwZSBfX2MpIGNvbnN0CiAgICAg
IHsgcmV0dXJuIHRoaXMtPmRvX3RvbG93ZXIoX19jKTsgfQojIDg1MSAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICBjb25zdCBjaGFyX3R5cGUqCiAg
ICAgIHRvbG93ZXIoY2hhcl90eXBlKiBfX2xvLCBjb25zdCBjaGFyX3R5cGUqIF9faGkpIGNvbnN0
CiAgICAgIHsgcmV0dXJuIHRoaXMtPmRvX3RvbG93ZXIoX19sbywgX19oaSk7IH0KIyA4NzEgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgY2hhcl90
eXBlCiAgICAgIHdpZGVuKGNoYXIgX19jKSBjb25zdAogICAgICB7CiBpZiAoX01fd2lkZW5fb2sp
CiAgIHJldHVybiBfTV93aWRlbltzdGF0aWNfY2FzdDx1bnNpZ25lZCBjaGFyPihfX2MpXTsKIHRo
aXMtPl9NX3dpZGVuX2luaXQoKTsKIHJldHVybiB0aGlzLT5kb193aWRlbihfX2MpOwogICAgICB9
CiMgODk4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAg
ICAgIGNvbnN0IGNoYXIqCiAgICAgIHdpZGVuKGNvbnN0IGNoYXIqIF9fbG8sIGNvbnN0IGNoYXIq
IF9faGksIGNoYXJfdHlwZSogX190bykgY29uc3QKICAgICAgewogaWYgKF9NX3dpZGVuX29rID09
IDEpCiAgIHsKICAgICBfX2J1aWx0aW5fbWVtY3B5KF9fdG8sIF9fbG8sIF9faGkgLSBfX2xvKTsK
ICAgICByZXR1cm4gX19oaTsKICAgfQogaWYgKCFfTV93aWRlbl9vaykKICAgX01fd2lkZW5faW5p
dCgpOwogcmV0dXJuIHRoaXMtPmRvX3dpZGVuKF9fbG8sIF9faGksIF9fdG8pOwogICAgICB9CiMg
OTI5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAg
IGNoYXIKICAgICAgbmFycm93KGNoYXJfdHlwZSBfX2MsIGNoYXIgX19kZmF1bHQpIGNvbnN0CiAg
ICAgIHsKIGlmIChfTV9uYXJyb3dbc3RhdGljX2Nhc3Q8dW5zaWduZWQgY2hhcj4oX19jKV0pCiAg
IHJldHVybiBfTV9uYXJyb3dbc3RhdGljX2Nhc3Q8dW5zaWduZWQgY2hhcj4oX19jKV07CiBjb25z
dCBjaGFyIF9fdCA9IGRvX25hcnJvdyhfX2MsIF9fZGZhdWx0KTsKIGlmIChfX3QgIT0gX19kZmF1
bHQpCiAgIF9NX25hcnJvd1tzdGF0aWNfY2FzdDx1bnNpZ25lZCBjaGFyPihfX2MpXSA9IF9fdDsK
IHJldHVybiBfX3Q7CiAgICAgIH0KIyA5NjIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9s
b2NhbGVfZmFjZXRzLmgiIDMKICAgICAgY29uc3QgY2hhcl90eXBlKgogICAgICBuYXJyb3coY29u
c3QgY2hhcl90eXBlKiBfX2xvLCBjb25zdCBjaGFyX3R5cGUqIF9faGksCiAgICAgIGNoYXIgX19k
ZmF1bHQsIGNoYXIqIF9fdG8pIGNvbnN0CiAgICAgIHsKIGlmIChfX2J1aWx0aW5fZXhwZWN0KF9N
X25hcnJvd19vayA9PSAxLCB0cnVlKSkKICAgewogICAgIF9fYnVpbHRpbl9tZW1jcHkoX190bywg
X19sbywgX19oaSAtIF9fbG8pOwogICAgIHJldHVybiBfX2hpOwogICB9CiBpZiAoIV9NX25hcnJv
d19vaykKICAgX01fbmFycm93X2luaXQoKTsKIHJldHVybiB0aGlzLT5kb19uYXJyb3coX19sbywg
X19oaSwgX19kZmF1bHQsIF9fdG8pOwogICAgICB9CgoKCgoKICAgICAgY29uc3QgbWFzayoKICAg
ICAgdGFibGUoKSBjb25zdCB0aHJvdygpCiAgICAgIHsgcmV0dXJuIF9NX3RhYmxlOyB9CgoKICAg
ICAgc3RhdGljIGNvbnN0IG1hc2sqCiAgICAgIGNsYXNzaWNfdGFibGUoKSB0aHJvdygpOwogICAg
cHJvdGVjdGVkOgoKCgoKCgoKICAgICAgdmlydHVhbAogICAgICB+Y3R5cGUoKTsKIyAxMDExICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIHZpcnR1
YWwgY2hhcl90eXBlCiAgICAgIGRvX3RvdXBwZXIoY2hhcl90eXBlIF9fYykgY29uc3Q7CiMgMTAy
OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICB2
aXJ0dWFsIGNvbnN0IGNoYXJfdHlwZSoKICAgICAgZG9fdG91cHBlcihjaGFyX3R5cGUqIF9fbG8s
IGNvbnN0IGNoYXJfdHlwZSogX19oaSkgY29uc3Q7CiMgMTA0NCAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICB2aXJ0dWFsIGNoYXJfdHlwZQogICAg
ICBkb190b2xvd2VyKGNoYXJfdHlwZSBfX2MpIGNvbnN0OwojIDEwNjEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgdmlydHVhbCBjb25zdCBjaGFy
X3R5cGUqCiAgICAgIGRvX3RvbG93ZXIoY2hhcl90eXBlKiBfX2xvLCBjb25zdCBjaGFyX3R5cGUq
IF9faGkpIGNvbnN0OwojIDEwODEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVf
ZmFjZXRzLmgiIDMKICAgICAgdmlydHVhbCBjaGFyX3R5cGUKICAgICAgZG9fd2lkZW4oY2hhciBf
X2MpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9fYzsgfQojIDExMDQgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgdmlydHVhbCBjb25zdCBjaGFyKgog
ICAgICBkb193aWRlbihjb25zdCBjaGFyKiBfX2xvLCBjb25zdCBjaGFyKiBfX2hpLCBjaGFyX3R5
cGUqIF9fdG8pIGNvbnN0CiAgICAgIHsKIF9fYnVpbHRpbl9tZW1jcHkoX190bywgX19sbywgX19o
aSAtIF9fbG8pOwogcmV0dXJuIF9faGk7CiAgICAgIH0KIyAxMTMwICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIHZpcnR1YWwgY2hhcgogICAgICBk
b19uYXJyb3coY2hhcl90eXBlIF9fYywgY2hhciBfX2RmYXVsdCkgY29uc3QKICAgICAgeyByZXR1
cm4gX19jOyB9CiMgMTE1NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNl
dHMuaCIgMwogICAgICB2aXJ0dWFsIGNvbnN0IGNoYXJfdHlwZSoKICAgICAgZG9fbmFycm93KGNv
bnN0IGNoYXJfdHlwZSogX19sbywgY29uc3QgY2hhcl90eXBlKiBfX2hpLAogIGNoYXIgX19kZmF1
bHQsIGNoYXIqIF9fdG8pIGNvbnN0CiAgICAgIHsKIF9fYnVpbHRpbl9tZW1jcHkoX190bywgX19s
bywgX19oaSAtIF9fbG8pOwogcmV0dXJuIF9faGk7CiAgICAgIH0KCiAgICBwcml2YXRlOgogICAg
ICB2b2lkIF9NX25hcnJvd19pbml0KCkgY29uc3Q7CiAgICAgIHZvaWQgX01fd2lkZW5faW5pdCgp
IGNvbnN0OwogICAgfTsKIyAxMTgxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxl
X2ZhY2V0cy5oIiAzCiAgdGVtcGxhdGU8PgogICAgY2xhc3MgY3R5cGU8d2NoYXJfdD4gOiBwdWJs
aWMgX19jdHlwZV9hYnN0cmFjdF9iYXNlPHdjaGFyX3Q+CiAgICB7CiAgICBwdWJsaWM6CgoKICAg
ICAgdHlwZWRlZiB3Y2hhcl90IGNoYXJfdHlwZTsKICAgICAgdHlwZWRlZiB3Y3R5cGVfdCBfX3dt
YXNrX3R5cGU7CgogICAgcHJvdGVjdGVkOgogICAgICBfX2NfbG9jYWxlIF9NX2NfbG9jYWxlX2N0
eXBlOwoKCiAgICAgIGJvb2wgX01fbmFycm93X29rOwogICAgICBjaGFyIF9NX25hcnJvd1sxMjhd
OwogICAgICB3aW50X3QgX01fd2lkZW5bMSArIHN0YXRpY19jYXN0PHVuc2lnbmVkIGNoYXI+KC0x
KV07CgoKICAgICAgbWFzayBfTV9iaXRbMTZdOwogICAgICBfX3dtYXNrX3R5cGUgX01fd21hc2tb
MTZdOwoKICAgIHB1YmxpYzoKCgogICAgICBzdGF0aWMgbG9jYWxlOjppZCBpZDsKIyAxMjE0ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIGV4cGxp
Y2l0CiAgICAgIGN0eXBlKHNpemVfdCBfX3JlZnMgPSAwKTsKIyAxMjI1ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIGV4cGxpY2l0CiAgICAgIGN0
eXBlKF9fY19sb2NhbGUgX19jbG9jLCBzaXplX3QgX19yZWZzID0gMCk7CgogICAgcHJvdGVjdGVk
OgogICAgICBfX3dtYXNrX3R5cGUKICAgICAgX01fY29udmVydF90b193bWFzayhjb25zdCBtYXNr
IF9fbSkgY29uc3QgdGhyb3coKTsKCgogICAgICB2aXJ0dWFsCiAgICAgIH5jdHlwZSgpOwojIDEy
NDkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAg
dmlydHVhbCBib29sCiAgICAgIGRvX2lzKG1hc2sgX19tLCBjaGFyX3R5cGUgX19jKSBjb25zdDsK
IyAxMjY4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAg
ICAgIHZpcnR1YWwgY29uc3QgY2hhcl90eXBlKgogICAgICBkb19pcyhjb25zdCBjaGFyX3R5cGUq
IF9fbG8sIGNvbnN0IGNoYXJfdHlwZSogX19oaSwgbWFzayogX192ZWMpIGNvbnN0OwojIDEyODYg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgdmly
dHVhbCBjb25zdCBjaGFyX3R5cGUqCiAgICAgIGRvX3NjYW5faXMobWFzayBfX20sIGNvbnN0IGNo
YXJfdHlwZSogX19sbywgY29uc3QgY2hhcl90eXBlKiBfX2hpKSBjb25zdDsKIyAxMzA0ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIHZpcnR1YWwg
Y29uc3QgY2hhcl90eXBlKgogICAgICBkb19zY2FuX25vdChtYXNrIF9fbSwgY29uc3QgY2hhcl90
eXBlKiBfX2xvLAogICAgY29uc3QgY2hhcl90eXBlKiBfX2hpKSBjb25zdDsKIyAxMzIxICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIHZpcnR1YWwg
Y2hhcl90eXBlCiAgICAgIGRvX3RvdXBwZXIoY2hhcl90eXBlIF9fYykgY29uc3Q7CiMgMTMzOCAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICB2aXJ0
dWFsIGNvbnN0IGNoYXJfdHlwZSoKICAgICAgZG9fdG91cHBlcihjaGFyX3R5cGUqIF9fbG8sIGNv
bnN0IGNoYXJfdHlwZSogX19oaSkgY29uc3Q7CiMgMTM1NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICB2aXJ0dWFsIGNoYXJfdHlwZQogICAgICBk
b190b2xvd2VyKGNoYXJfdHlwZSBfX2MpIGNvbnN0OwojIDEzNzEgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgdmlydHVhbCBjb25zdCBjaGFyX3R5
cGUqCiAgICAgIGRvX3RvbG93ZXIoY2hhcl90eXBlKiBfX2xvLCBjb25zdCBjaGFyX3R5cGUqIF9f
aGkpIGNvbnN0OwojIDEzOTEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFj
ZXRzLmgiIDMKICAgICAgdmlydHVhbCBjaGFyX3R5cGUKICAgICAgZG9fd2lkZW4oY2hhciBfX2Mp
IGNvbnN0OwojIDE0MTMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRz
LmgiIDMKICAgICAgdmlydHVhbCBjb25zdCBjaGFyKgogICAgICBkb193aWRlbihjb25zdCBjaGFy
KiBfX2xvLCBjb25zdCBjaGFyKiBfX2hpLCBjaGFyX3R5cGUqIF9fdG8pIGNvbnN0OwojIDE0MzYg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgdmly
dHVhbCBjaGFyCiAgICAgIGRvX25hcnJvdyhjaGFyX3R5cGUgX19jLCBjaGFyIF9fZGZhdWx0KSBj
b25zdDsKIyAxNDYyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5o
IiAzCiAgICAgIHZpcnR1YWwgY29uc3QgY2hhcl90eXBlKgogICAgICBkb19uYXJyb3coY29uc3Qg
Y2hhcl90eXBlKiBfX2xvLCBjb25zdCBjaGFyX3R5cGUqIF9faGksCiAgY2hhciBfX2RmYXVsdCwg
Y2hhciogX190bykgY29uc3Q7CgoKICAgICAgdm9pZAogICAgICBfTV9pbml0aWFsaXplX2N0eXBl
KCkgdGhyb3coKTsKICAgIH07CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgY2xh
c3MgY3R5cGVfYnluYW1lIDogcHVibGljIGN0eXBlPF9DaGFyVD4KICAgIHsKICAgIHB1YmxpYzoK
ICAgICAgdHlwZWRlZiB0eXBlbmFtZSBjdHlwZTxfQ2hhclQ+OjptYXNrIG1hc2s7CgogICAgICBl
eHBsaWNpdAogICAgICBjdHlwZV9ieW5hbWUoY29uc3QgY2hhciogX19zLCBzaXplX3QgX19yZWZz
ID0gMCk7CgoKICAgICAgZXhwbGljaXQKICAgICAgY3R5cGVfYnluYW1lKGNvbnN0IHN0cmluZyYg
X19zLCBzaXplX3QgX19yZWZzID0gMCkKICAgICAgOiBjdHlwZV9ieW5hbWUoX19zLmNfc3RyKCks
IF9fcmVmcykgeyB9CgoKICAgIHByb3RlY3RlZDoKICAgICAgdmlydHVhbAogICAgICB+Y3R5cGVf
YnluYW1lKCkgeyB9OwogICAgfTsKCgogIHRlbXBsYXRlPD4KICAgIGNsYXNzIGN0eXBlX2J5bmFt
ZTxjaGFyPiA6IHB1YmxpYyBjdHlwZTxjaGFyPgogICAgewogICAgcHVibGljOgogICAgICBleHBs
aWNpdAogICAgICBjdHlwZV9ieW5hbWUoY29uc3QgY2hhciogX19zLCBzaXplX3QgX19yZWZzID0g
MCk7CgoKICAgICAgZXhwbGljaXQKICAgICAgY3R5cGVfYnluYW1lKGNvbnN0IHN0cmluZyYgX19z
LCBzaXplX3QgX19yZWZzID0gMCk7CgoKICAgIHByb3RlY3RlZDoKICAgICAgdmlydHVhbAogICAg
ICB+Y3R5cGVfYnluYW1lKCk7CiAgICB9OwoKCiAgdGVtcGxhdGU8PgogICAgY2xhc3MgY3R5cGVf
YnluYW1lPHdjaGFyX3Q+IDogcHVibGljIGN0eXBlPHdjaGFyX3Q+CiAgICB7CiAgICBwdWJsaWM6
CiAgICAgIGV4cGxpY2l0CiAgICAgIGN0eXBlX2J5bmFtZShjb25zdCBjaGFyKiBfX3MsIHNpemVf
dCBfX3JlZnMgPSAwKTsKCgogICAgICBleHBsaWNpdAogICAgICBjdHlwZV9ieW5hbWUoY29uc3Qg
c3RyaW5nJiBfX3MsIHNpemVfdCBfX3JlZnMgPSAwKTsKCgogICAgcHJvdGVjdGVkOgogICAgICB2
aXJ0dWFsCiAgICAgIH5jdHlwZV9ieW5hbWUoKTsKICAgIH07CgoKCn0KCgojIDEgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvczM5MHgtcmVkaGF0LWxpbnV4L2JpdHMvY3R5cGVfaW5saW5lLmgiIDEg
MwojIDM3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2N0
eXBlX2lubGluZS5oIiAzCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0
eV9fICgiZGVmYXVsdCIpKSkKewoKCiAgYm9vbAogIGN0eXBlPGNoYXI+OjoKICBpcyhtYXNrIF9f
bSwgY2hhciBfX2MpIGNvbnN0CiAgeyByZXR1cm4gX01fdGFibGVbc3RhdGljX2Nhc3Q8dW5zaWdu
ZWQgY2hhcj4oX19jKV0gJiBfX207IH0KCiAgY29uc3QgY2hhcioKICBjdHlwZTxjaGFyPjo6CiAg
aXMoY29uc3QgY2hhciogX19sb3csIGNvbnN0IGNoYXIqIF9faGlnaCwgbWFzayogX192ZWMpIGNv
bnN0CiAgewogICAgd2hpbGUgKF9fbG93IDwgX19oaWdoKQogICAgICAqX192ZWMrKyA9IF9NX3Rh
YmxlW3N0YXRpY19jYXN0PHVuc2lnbmVkIGNoYXI+KCpfX2xvdysrKV07CiAgICByZXR1cm4gX19o
aWdoOwogIH0KCiAgY29uc3QgY2hhcioKICBjdHlwZTxjaGFyPjo6CiAgc2Nhbl9pcyhtYXNrIF9f
bSwgY29uc3QgY2hhciogX19sb3csIGNvbnN0IGNoYXIqIF9faGlnaCkgY29uc3QKICB7CiAgICB3
aGlsZSAoX19sb3cgPCBfX2hpZ2gKICAgICYmICEoX01fdGFibGVbc3RhdGljX2Nhc3Q8dW5zaWdu
ZWQgY2hhcj4oKl9fbG93KV0gJiBfX20pKQogICAgICArK19fbG93OwogICAgcmV0dXJuIF9fbG93
OwogIH0KCiAgY29uc3QgY2hhcioKICBjdHlwZTxjaGFyPjo6CiAgc2Nhbl9ub3QobWFzayBfX20s
IGNvbnN0IGNoYXIqIF9fbG93LCBjb25zdCBjaGFyKiBfX2hpZ2gpIGNvbnN0CiAgewogICAgd2hp
bGUgKF9fbG93IDwgX19oaWdoCiAgICAmJiAoX01fdGFibGVbc3RhdGljX2Nhc3Q8dW5zaWduZWQg
Y2hhcj4oKl9fbG93KV0gJiBfX20pICE9IDApCiAgICAgICsrX19sb3c7CiAgICByZXR1cm4gX19s
b3c7CiAgfQoKCn0KIyAxNTM1ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2Zh
Y2V0cy5oIiAyIDMKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9f
ICgiZGVmYXVsdCIpKSkKewoKCgogIGNsYXNzIF9fbnVtX2Jhc2UKICB7CiAgcHVibGljOgoKCiAg
ICBlbnVtCiAgICAgIHsKIF9TX29taW51cywKIF9TX29wbHVzLAogX1Nfb3gsCiBfU19vWCwKIF9T
X29kaWdpdHMsCiBfU19vZGlnaXRzX2VuZCA9IF9TX29kaWdpdHMgKyAxNiwKIF9TX291ZGlnaXRz
ID0gX1Nfb2RpZ2l0c19lbmQsCiBfU19vdWRpZ2l0c19lbmQgPSBfU19vdWRpZ2l0cyArIDE2LAog
X1Nfb2UgPSBfU19vZGlnaXRzICsgMTQsCiBfU19vRSA9IF9TX291ZGlnaXRzICsgMTQsCiBfU19v
ZW5kID0gX1Nfb3VkaWdpdHNfZW5kCiAgICAgIH07CgoKCgoKCiAgICBzdGF0aWMgY29uc3QgY2hh
ciogX1NfYXRvbXNfb3V0OwoKCgogICAgc3RhdGljIGNvbnN0IGNoYXIqIF9TX2F0b21zX2luOwoK
ICAgIGVudW0KICAgIHsKICAgICAgX1NfaW1pbnVzLAogICAgICBfU19pcGx1cywKICAgICAgX1Nf
aXgsCiAgICAgIF9TX2lYLAogICAgICBfU19pemVybywKICAgICAgX1NfaWUgPSBfU19pemVybyAr
IDE0LAogICAgICBfU19pRSA9IF9TX2l6ZXJvICsgMjAsCiAgICAgIF9TX2llbmQgPSAyNgogICAg
fTsKCgoKICAgIHN0YXRpYyB2b2lkCiAgICBfU19mb3JtYXRfZmxvYXQoY29uc3QgaW9zX2Jhc2Um
IF9faW8sIGNoYXIqIF9fZnB0ciwgY2hhciBfX21vZCkgdGhyb3coKTsKICB9OwoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBzdHJ1Y3QgX19udW1wdW5jdF9jYWNoZSA6IHB1YmxpYyBs
b2NhbGU6OmZhY2V0CiAgICB7CiAgICAgIGNvbnN0IGNoYXIqIF9NX2dyb3VwaW5nOwogICAgICBz
aXplX3QgX01fZ3JvdXBpbmdfc2l6ZTsKICAgICAgYm9vbCBfTV91c2VfZ3JvdXBpbmc7CiAgICAg
IGNvbnN0IF9DaGFyVCogX01fdHJ1ZW5hbWU7CiAgICAgIHNpemVfdCBfTV90cnVlbmFtZV9zaXpl
OwogICAgICBjb25zdCBfQ2hhclQqIF9NX2ZhbHNlbmFtZTsKICAgICAgc2l6ZV90IF9NX2ZhbHNl
bmFtZV9zaXplOwogICAgICBfQ2hhclQgX01fZGVjaW1hbF9wb2ludDsKICAgICAgX0NoYXJUIF9N
X3Rob3VzYW5kc19zZXA7CgoKCgoKICAgICAgX0NoYXJUIF9NX2F0b21zX291dFtfX251bV9iYXNl
OjpfU19vZW5kXTsKCgoKCgogICAgICBfQ2hhclQgX01fYXRvbXNfaW5bX19udW1fYmFzZTo6X1Nf
aWVuZF07CgogICAgICBib29sIF9NX2FsbG9jYXRlZDsKCiAgICAgIF9fbnVtcHVuY3RfY2FjaGUo
c2l6ZV90IF9fcmVmcyA9IDApCiAgICAgIDogZmFjZXQoX19yZWZzKSwgX01fZ3JvdXBpbmcoMCks
IF9NX2dyb3VwaW5nX3NpemUoMCksCiBfTV91c2VfZ3JvdXBpbmcoZmFsc2UpLAogX01fdHJ1ZW5h
bWUoMCksIF9NX3RydWVuYW1lX3NpemUoMCksIF9NX2ZhbHNlbmFtZSgwKSwKIF9NX2ZhbHNlbmFt
ZV9zaXplKDApLCBfTV9kZWNpbWFsX3BvaW50KF9DaGFyVCgpKSwKIF9NX3Rob3VzYW5kc19zZXAo
X0NoYXJUKCkpLCBfTV9hbGxvY2F0ZWQoZmFsc2UpCiB7IH0KCiAgICAgIH5fX251bXB1bmN0X2Nh
Y2hlKCk7CgogICAgICB2b2lkCiAgICAgIF9NX2NhY2hlKGNvbnN0IGxvY2FsZSYgX19sb2MpOwoK
ICAgIHByaXZhdGU6CiAgICAgIF9fbnVtcHVuY3RfY2FjaGUmCiAgICAgIG9wZXJhdG9yPShjb25z
dCBfX251bXB1bmN0X2NhY2hlJik7CgogICAgICBleHBsaWNpdAogICAgICBfX251bXB1bmN0X2Nh
Y2hlKGNvbnN0IF9fbnVtcHVuY3RfY2FjaGUmKTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9DaGFyVD4KICAgIF9fbnVtcHVuY3RfY2FjaGU8X0NoYXJUPjo6fl9fbnVtcHVuY3RfY2FjaGUo
KQogICAgewogICAgICBpZiAoX01fYWxsb2NhdGVkKQogewogICBkZWxldGUgW10gX01fZ3JvdXBp
bmc7CiAgIGRlbGV0ZSBbXSBfTV90cnVlbmFtZTsKICAgZGVsZXRlIFtdIF9NX2ZhbHNlbmFtZTsK
IH0KICAgIH0KCm5hbWVzcGFjZSBfX2N4eDExIHsKIyAxNjY1ICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgog
ICAgY2xhc3MgbnVtcHVuY3QgOiBwdWJsaWMgbG9jYWxlOjpmYWNldAogICAgewogICAgcHVibGlj
OgoKCgogICAgICB0eXBlZGVmIF9DaGFyVCBjaGFyX3R5cGU7CiAgICAgIHR5cGVkZWYgYmFzaWNf
c3RyaW5nPF9DaGFyVD4gc3RyaW5nX3R5cGU7CgogICAgICB0eXBlZGVmIF9fbnVtcHVuY3RfY2Fj
aGU8X0NoYXJUPiBfX2NhY2hlX3R5cGU7CgogICAgcHJvdGVjdGVkOgogICAgICBfX2NhY2hlX3R5
cGUqIF9NX2RhdGE7CgogICAgcHVibGljOgoKICAgICAgc3RhdGljIGxvY2FsZTo6aWQgaWQ7CgoK
CgoKCiAgICAgIGV4cGxpY2l0CiAgICAgIG51bXB1bmN0KHNpemVfdCBfX3JlZnMgPSAwKQogICAg
ICA6IGZhY2V0KF9fcmVmcyksIF9NX2RhdGEoMCkKICAgICAgeyBfTV9pbml0aWFsaXplX251bXB1
bmN0KCk7IH0KIyAxNzAzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0
cy5oIiAzCiAgICAgIGV4cGxpY2l0CiAgICAgIG51bXB1bmN0KF9fY2FjaGVfdHlwZSogX19jYWNo
ZSwgc2l6ZV90IF9fcmVmcyA9IDApCiAgICAgIDogZmFjZXQoX19yZWZzKSwgX01fZGF0YShfX2Nh
Y2hlKQogICAgICB7IF9NX2luaXRpYWxpemVfbnVtcHVuY3QoKTsgfQojIDE3MTcgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgZXhwbGljaXQKICAg
ICAgbnVtcHVuY3QoX19jX2xvY2FsZSBfX2Nsb2MsIHNpemVfdCBfX3JlZnMgPSAwKQogICAgICA6
IGZhY2V0KF9fcmVmcyksIF9NX2RhdGEoMCkKICAgICAgeyBfTV9pbml0aWFsaXplX251bXB1bmN0
KF9fY2xvYyk7IH0KIyAxNzMxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2Zh
Y2V0cy5oIiAzCiAgICAgIGNoYXJfdHlwZQogICAgICBkZWNpbWFsX3BvaW50KCkgY29uc3QKICAg
ICAgeyByZXR1cm4gdGhpcy0+ZG9fZGVjaW1hbF9wb2ludCgpOyB9CiMgMTc0NCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICBjaGFyX3R5cGUKICAg
ICAgdGhvdXNhbmRzX3NlcCgpIGNvbnN0CiAgICAgIHsgcmV0dXJuIHRoaXMtPmRvX3Rob3VzYW5k
c19zZXAoKTsgfQojIDE3NzUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFj
ZXRzLmgiIDMKICAgICAgc3RyaW5nCiAgICAgIGdyb3VwaW5nKCkgY29uc3QKICAgICAgeyByZXR1
cm4gdGhpcy0+ZG9fZ3JvdXBpbmcoKTsgfQojIDE3ODggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgc3RyaW5nX3R5cGUKICAgICAgdHJ1ZW5hbWUo
KSBjb25zdAogICAgICB7IHJldHVybiB0aGlzLT5kb190cnVlbmFtZSgpOyB9CiMgMTgwMSAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICBzdHJpbmdf
dHlwZQogICAgICBmYWxzZW5hbWUoKSBjb25zdAogICAgICB7IHJldHVybiB0aGlzLT5kb19mYWxz
ZW5hbWUoKTsgfQoKICAgIHByb3RlY3RlZDoKCiAgICAgIHZpcnR1YWwKICAgICAgfm51bXB1bmN0
KCk7CiMgMTgxOCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIg
MwogICAgICB2aXJ0dWFsIGNoYXJfdHlwZQogICAgICBkb19kZWNpbWFsX3BvaW50KCkgY29uc3QK
ICAgICAgeyByZXR1cm4gX01fZGF0YS0+X01fZGVjaW1hbF9wb2ludDsgfQojIDE4MzAgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgdmlydHVhbCBj
aGFyX3R5cGUKICAgICAgZG9fdGhvdXNhbmRzX3NlcCgpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9N
X2RhdGEtPl9NX3Rob3VzYW5kc19zZXA7IH0KIyAxODQzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIHZpcnR1YWwgc3RyaW5nCiAgICAgIGRvX2dy
b3VwaW5nKCkgY29uc3QKICAgICAgeyByZXR1cm4gX01fZGF0YS0+X01fZ3JvdXBpbmc7IH0KIyAx
ODU2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAg
IHZpcnR1YWwgc3RyaW5nX3R5cGUKICAgICAgZG9fdHJ1ZW5hbWUoKSBjb25zdAogICAgICB7IHJl
dHVybiBfTV9kYXRhLT5fTV90cnVlbmFtZTsgfQojIDE4NjkgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgdmlydHVhbCBzdHJpbmdfdHlwZQogICAg
ICBkb19mYWxzZW5hbWUoKSBjb25zdAogICAgICB7IHJldHVybiBfTV9kYXRhLT5fTV9mYWxzZW5h
bWU7IH0KCgogICAgICB2b2lkCiAgICAgIF9NX2luaXRpYWxpemVfbnVtcHVuY3QoX19jX2xvY2Fs
ZSBfX2Nsb2MgPSAwKTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIGxv
Y2FsZTo6aWQgbnVtcHVuY3Q8X0NoYXJUPjo6aWQ7CgogIHRlbXBsYXRlPD4KICAgIG51bXB1bmN0
PGNoYXI+Ojp+bnVtcHVuY3QoKTsKCiAgdGVtcGxhdGU8PgogICAgdm9pZAogICAgbnVtcHVuY3Q8
Y2hhcj46Ol9NX2luaXRpYWxpemVfbnVtcHVuY3QoX19jX2xvY2FsZSBfX2Nsb2MpOwoKCiAgdGVt
cGxhdGU8PgogICAgbnVtcHVuY3Q8d2NoYXJfdD46On5udW1wdW5jdCgpOwoKICB0ZW1wbGF0ZTw+
CiAgICB2b2lkCiAgICBudW1wdW5jdDx3Y2hhcl90Pjo6X01faW5pdGlhbGl6ZV9udW1wdW5jdChf
X2NfbG9jYWxlIF9fY2xvYyk7CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgY2xh
c3MgbnVtcHVuY3RfYnluYW1lIDogcHVibGljIG51bXB1bmN0PF9DaGFyVD4KICAgIHsKICAgIHB1
YmxpYzoKICAgICAgdHlwZWRlZiBfQ2hhclQgY2hhcl90eXBlOwogICAgICB0eXBlZGVmIGJhc2lj
X3N0cmluZzxfQ2hhclQ+IHN0cmluZ190eXBlOwoKICAgICAgZXhwbGljaXQKICAgICAgbnVtcHVu
Y3RfYnluYW1lKGNvbnN0IGNoYXIqIF9fcywgc2l6ZV90IF9fcmVmcyA9IDApCiAgICAgIDogbnVt
cHVuY3Q8X0NoYXJUPihfX3JlZnMpCiAgICAgIHsKIGlmIChfX2J1aWx0aW5fc3RyY21wKF9fcywg
IkMiKSAhPSAwCiAgICAgJiYgX19idWlsdGluX3N0cmNtcChfX3MsICJQT1NJWCIpICE9IDApCiAg
IHsKICAgICBfX2NfbG9jYWxlIF9fdG1wOwogICAgIHRoaXMtPl9TX2NyZWF0ZV9jX2xvY2FsZShf
X3RtcCwgX19zKTsKICAgICB0aGlzLT5fTV9pbml0aWFsaXplX251bXB1bmN0KF9fdG1wKTsKICAg
ICB0aGlzLT5fU19kZXN0cm95X2NfbG9jYWxlKF9fdG1wKTsKICAgfQogICAgICB9CgoKICAgICAg
ZXhwbGljaXQKICAgICAgbnVtcHVuY3RfYnluYW1lKGNvbnN0IHN0cmluZyYgX19zLCBzaXplX3Qg
X19yZWZzID0gMCkKICAgICAgOiBudW1wdW5jdF9ieW5hbWUoX19zLmNfc3RyKCksIF9fcmVmcykg
eyB9CgoKICAgIHByb3RlY3RlZDoKICAgICAgdmlydHVhbAogICAgICB+bnVtcHVuY3RfYnluYW1l
KCkgeyB9CiAgICB9OwoKfQoKbmFtZXNwYWNlIF9fZ251X2N4eF9sZGJsMTI4IHsKIyAxOTQ3ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfSW5JdGVyPgogICAgY2xhc3MgbnVtX2dldCA6IHB1
YmxpYyBsb2NhbGU6OmZhY2V0CiAgICB7CiAgICBwdWJsaWM6CgoKCiAgICAgIHR5cGVkZWYgX0No
YXJUIGNoYXJfdHlwZTsKICAgICAgdHlwZWRlZiBfSW5JdGVyIGl0ZXJfdHlwZTsKCgoKICAgICAg
c3RhdGljIGxvY2FsZTo6aWQgaWQ7CiMgMTk2OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L2xvY2FsZV9mYWNldHMuaCIgMwogICAgICBleHBsaWNpdAogICAgICBudW1fZ2V0KHNpemVfdCBf
X3JlZnMgPSAwKSA6IGZhY2V0KF9fcmVmcykgeyB9CiMgMTk5NCAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICBpdGVyX3R5cGUKICAgICAgZ2V0KGl0
ZXJfdHlwZSBfX2luLCBpdGVyX3R5cGUgX19lbmQsIGlvc19iYXNlJiBfX2lvLAogICBpb3NfYmFz
ZTo6aW9zdGF0ZSYgX19lcnIsIGJvb2wmIF9fdikgY29uc3QKICAgICAgeyByZXR1cm4gdGhpcy0+
ZG9fZ2V0KF9faW4sIF9fZW5kLCBfX2lvLCBfX2VyciwgX192KTsgfQojIDIwMzEgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgaXRlcl90eXBlCiAg
ICAgIGdldChpdGVyX3R5cGUgX19pbiwgaXRlcl90eXBlIF9fZW5kLCBpb3NfYmFzZSYgX19pbywK
ICAgaW9zX2Jhc2U6Omlvc3RhdGUmIF9fZXJyLCBsb25nJiBfX3YpIGNvbnN0CiAgICAgIHsgcmV0
dXJuIHRoaXMtPmRvX2dldChfX2luLCBfX2VuZCwgX19pbywgX19lcnIsIF9fdik7IH0KCiAgICAg
IGl0ZXJfdHlwZQogICAgICBnZXQoaXRlcl90eXBlIF9faW4sIGl0ZXJfdHlwZSBfX2VuZCwgaW9z
X2Jhc2UmIF9faW8sCiAgIGlvc19iYXNlOjppb3N0YXRlJiBfX2VyciwgdW5zaWduZWQgc2hvcnQm
IF9fdikgY29uc3QKICAgICAgeyByZXR1cm4gdGhpcy0+ZG9fZ2V0KF9faW4sIF9fZW5kLCBfX2lv
LCBfX2VyciwgX192KTsgfQoKICAgICAgaXRlcl90eXBlCiAgICAgIGdldChpdGVyX3R5cGUgX19p
biwgaXRlcl90eXBlIF9fZW5kLCBpb3NfYmFzZSYgX19pbywKICAgaW9zX2Jhc2U6Omlvc3RhdGUm
IF9fZXJyLCB1bnNpZ25lZCBpbnQmIF9fdikgY29uc3QKICAgICAgeyByZXR1cm4gdGhpcy0+ZG9f
Z2V0KF9faW4sIF9fZW5kLCBfX2lvLCBfX2VyciwgX192KTsgfQoKICAgICAgaXRlcl90eXBlCiAg
ICAgIGdldChpdGVyX3R5cGUgX19pbiwgaXRlcl90eXBlIF9fZW5kLCBpb3NfYmFzZSYgX19pbywK
ICAgaW9zX2Jhc2U6Omlvc3RhdGUmIF9fZXJyLCB1bnNpZ25lZCBsb25nJiBfX3YpIGNvbnN0CiAg
ICAgIHsgcmV0dXJuIHRoaXMtPmRvX2dldChfX2luLCBfX2VuZCwgX19pbywgX19lcnIsIF9fdik7
IH0KCgogICAgICBpdGVyX3R5cGUKICAgICAgZ2V0KGl0ZXJfdHlwZSBfX2luLCBpdGVyX3R5cGUg
X19lbmQsIGlvc19iYXNlJiBfX2lvLAogICBpb3NfYmFzZTo6aW9zdGF0ZSYgX19lcnIsIGxvbmcg
bG9uZyYgX192KSBjb25zdAogICAgICB7IHJldHVybiB0aGlzLT5kb19nZXQoX19pbiwgX19lbmQs
IF9faW8sIF9fZXJyLCBfX3YpOyB9CgogICAgICBpdGVyX3R5cGUKICAgICAgZ2V0KGl0ZXJfdHlw
ZSBfX2luLCBpdGVyX3R5cGUgX19lbmQsIGlvc19iYXNlJiBfX2lvLAogICBpb3NfYmFzZTo6aW9z
dGF0ZSYgX19lcnIsIHVuc2lnbmVkIGxvbmcgbG9uZyYgX192KSBjb25zdAogICAgICB7IHJldHVy
biB0aGlzLT5kb19nZXQoX19pbiwgX19lbmQsIF9faW8sIF9fZXJyLCBfX3YpOyB9CiMgMjA5MSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2FsZV9mYWNldHMuaCIgMwogICAgICBpdGVy
X3R5cGUKICAgICAgZ2V0KGl0ZXJfdHlwZSBfX2luLCBpdGVyX3R5cGUgX19lbmQsIGlvc19iYXNl
JiBfX2lvLAogICBpb3NfYmFzZTo6aW9zdGF0ZSYgX19lcnIsIGZsb2F0JiBfX3YpIGNvbnN0CiAg
ICAgIHsgcmV0dXJuIHRoaXMtPmRvX2dldChfX2luLCBfX2VuZCwgX19pbywgX19lcnIsIF9fdik7
IH0KCiAgICAgIGl0ZXJfdHlwZQogICAgICBnZXQoaXRlcl90eXBlIF9faW4sIGl0ZXJfdHlwZSBf
X2VuZCwgaW9zX2Jhc2UmIF9faW8sCiAgIGlvc19iYXNlOjppb3N0YXRlJiBfX2VyciwgZG91Ymxl
JiBfX3YpIGNvbnN0CiAgICAgIHsgcmV0dXJuIHRoaXMtPmRvX2dldChfX2luLCBfX2VuZCwgX19p
bywgX19lcnIsIF9fdik7IH0KCiAgICAgIGl0ZXJfdHlwZQogICAgICBnZXQoaXRlcl90eXBlIF9f
aW4sIGl0ZXJfdHlwZSBfX2VuZCwgaW9zX2Jhc2UmIF9faW8sCiAgIGlvc19iYXNlOjppb3N0YXRl
JiBfX2VyciwgbG9uZyBkb3VibGUmIF9fdikgY29uc3QKICAgICAgeyByZXR1cm4gdGhpcy0+ZG9f
Z2V0KF9faW4sIF9fZW5kLCBfX2lvLCBfX2VyciwgX192KTsgfQojIDIxMzQgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgaXRlcl90eXBlCiAgICAg
IGdldChpdGVyX3R5cGUgX19pbiwgaXRlcl90eXBlIF9fZW5kLCBpb3NfYmFzZSYgX19pbywKICAg
aW9zX2Jhc2U6Omlvc3RhdGUmIF9fZXJyLCB2b2lkKiYgX192KSBjb25zdAogICAgICB7IHJldHVy
biB0aGlzLT5kb19nZXQoX19pbiwgX19lbmQsIF9faW8sIF9fZXJyLCBfX3YpOyB9CgogICAgcHJv
dGVjdGVkOgoKICAgICAgdmlydHVhbCB+bnVtX2dldCgpIHsgfQoKICAgICAgX19hdHRyaWJ1dGUg
KChfX2FiaV90YWdfXyAoImN4eDExIikpKQogICAgICBpdGVyX3R5cGUKICAgICAgX01fZXh0cmFj
dF9mbG9hdChpdGVyX3R5cGUsIGl0ZXJfdHlwZSwgaW9zX2Jhc2UmLCBpb3NfYmFzZTo6aW9zdGF0
ZSYsCiAgICAgICAgIHN0cmluZyYpIGNvbnN0OwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1Zh
bHVlVD4KIF9fYXR0cmlidXRlICgoX19hYmlfdGFnX18gKCJjeHgxMSIpKSkKIGl0ZXJfdHlwZQog
X01fZXh0cmFjdF9pbnQoaXRlcl90eXBlLCBpdGVyX3R5cGUsIGlvc19iYXNlJiwgaW9zX2Jhc2U6
Omlvc3RhdGUmLAogICAgICAgICBfVmFsdWVUJikgY29uc3Q7CgogICAgICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfQ2hhclQyPgogICAgICB0eXBlbmFtZSBfX2dudV9jeHg6Ol9fZW5hYmxlX2lmPF9faXNf
Y2hhcjxfQ2hhclQyPjo6X192YWx1ZSwgaW50Pjo6X190eXBlCiBfTV9maW5kKGNvbnN0IF9DaGFy
VDIqLCBzaXplX3QgX19sZW4sIF9DaGFyVDIgX19jKSBjb25zdAogewogICBpbnQgX19yZXQgPSAt
MTsKICAgaWYgKF9fbGVuIDw9IDEwKQogICAgIHsKICAgICAgIGlmIChfX2MgPj0gX0NoYXJUMign
MCcpICYmIF9fYyA8IF9DaGFyVDIoX0NoYXJUMignMCcpICsgX19sZW4pKQogIF9fcmV0ID0gX19j
IC0gX0NoYXJUMignMCcpOwogICAgIH0KICAgZWxzZQogICAgIHsKICAgICAgIGlmIChfX2MgPj0g
X0NoYXJUMignMCcpICYmIF9fYyA8PSBfQ2hhclQyKCc5JykpCiAgX19yZXQgPSBfX2MgLSBfQ2hh
clQyKCcwJyk7CiAgICAgICBlbHNlIGlmIChfX2MgPj0gX0NoYXJUMignYScpICYmIF9fYyA8PSBf
Q2hhclQyKCdmJykpCiAgX19yZXQgPSAxMCArIChfX2MgLSBfQ2hhclQyKCdhJykpOwogICAgICAg
ZWxzZSBpZiAoX19jID49IF9DaGFyVDIoJ0EnKSAmJiBfX2MgPD0gX0NoYXJUMignRicpKQogIF9f
cmV0ID0gMTAgKyAoX19jIC0gX0NoYXJUMignQScpKTsKICAgICB9CiAgIHJldHVybiBfX3JldDsK
IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVDI+CiAgICAgIHR5cGVuYW1lIF9fZ251
X2N4eDo6X19lbmFibGVfaWY8IV9faXNfY2hhcjxfQ2hhclQyPjo6X192YWx1ZSwKICAgICAgICAg
IGludD46Ol9fdHlwZQogX01fZmluZChjb25zdCBfQ2hhclQyKiBfX3plcm8sIHNpemVfdCBfX2xl
biwgX0NoYXJUMiBfX2MpIGNvbnN0CiB7CiAgIGludCBfX3JldCA9IC0xOwogICBjb25zdCBjaGFy
X3R5cGUqIF9fcSA9IGNoYXJfdHJhaXRzPF9DaGFyVDI+OjpmaW5kKF9femVybywgX19sZW4sIF9f
Yyk7CiAgIGlmIChfX3EpCiAgICAgewogICAgICAgX19yZXQgPSBfX3EgLSBfX3plcm87CiAgICAg
ICBpZiAoX19yZXQgPiAxNSkKICBfX3JldCAtPSA2OwogICAgIH0KICAgcmV0dXJuIF9fcmV0Owog
fQojIDIyMDcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMK
ICAgICAgdmlydHVhbCBpdGVyX3R5cGUKICAgICAgZG9fZ2V0KGl0ZXJfdHlwZSwgaXRlcl90eXBl
LCBpb3NfYmFzZSYsIGlvc19iYXNlOjppb3N0YXRlJiwgYm9vbCYpIGNvbnN0OwoKICAgICAgdmly
dHVhbCBpdGVyX3R5cGUKICAgICAgZG9fZ2V0KGl0ZXJfdHlwZSBfX2JlZywgaXRlcl90eXBlIF9f
ZW5kLCBpb3NfYmFzZSYgX19pbywKICAgICAgaW9zX2Jhc2U6Omlvc3RhdGUmIF9fZXJyLCBsb25n
JiBfX3YpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX2V4dHJhY3RfaW50KF9fYmVnLCBfX2VuZCwg
X19pbywgX19lcnIsIF9fdik7IH0KCiAgICAgIHZpcnR1YWwgaXRlcl90eXBlCiAgICAgIGRvX2dl
dChpdGVyX3R5cGUgX19iZWcsIGl0ZXJfdHlwZSBfX2VuZCwgaW9zX2Jhc2UmIF9faW8sCiAgICAg
IGlvc19iYXNlOjppb3N0YXRlJiBfX2VyciwgdW5zaWduZWQgc2hvcnQmIF9fdikgY29uc3QKICAg
ICAgeyByZXR1cm4gX01fZXh0cmFjdF9pbnQoX19iZWcsIF9fZW5kLCBfX2lvLCBfX2VyciwgX192
KTsgfQoKICAgICAgdmlydHVhbCBpdGVyX3R5cGUKICAgICAgZG9fZ2V0KGl0ZXJfdHlwZSBfX2Jl
ZywgaXRlcl90eXBlIF9fZW5kLCBpb3NfYmFzZSYgX19pbywKICAgICAgaW9zX2Jhc2U6Omlvc3Rh
dGUmIF9fZXJyLCB1bnNpZ25lZCBpbnQmIF9fdikgY29uc3QKICAgICAgeyByZXR1cm4gX01fZXh0
cmFjdF9pbnQoX19iZWcsIF9fZW5kLCBfX2lvLCBfX2VyciwgX192KTsgfQoKICAgICAgdmlydHVh
bCBpdGVyX3R5cGUKICAgICAgZG9fZ2V0KGl0ZXJfdHlwZSBfX2JlZywgaXRlcl90eXBlIF9fZW5k
LCBpb3NfYmFzZSYgX19pbywKICAgICAgaW9zX2Jhc2U6Omlvc3RhdGUmIF9fZXJyLCB1bnNpZ25l
ZCBsb25nJiBfX3YpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX2V4dHJhY3RfaW50KF9fYmVnLCBf
X2VuZCwgX19pbywgX19lcnIsIF9fdik7IH0KCgogICAgICB2aXJ0dWFsIGl0ZXJfdHlwZQogICAg
ICBkb19nZXQoaXRlcl90eXBlIF9fYmVnLCBpdGVyX3R5cGUgX19lbmQsIGlvc19iYXNlJiBfX2lv
LAogICAgICBpb3NfYmFzZTo6aW9zdGF0ZSYgX19lcnIsIGxvbmcgbG9uZyYgX192KSBjb25zdAog
ICAgICB7IHJldHVybiBfTV9leHRyYWN0X2ludChfX2JlZywgX19lbmQsIF9faW8sIF9fZXJyLCBf
X3YpOyB9CgogICAgICB2aXJ0dWFsIGl0ZXJfdHlwZQogICAgICBkb19nZXQoaXRlcl90eXBlIF9f
YmVnLCBpdGVyX3R5cGUgX19lbmQsIGlvc19iYXNlJiBfX2lvLAogICAgICBpb3NfYmFzZTo6aW9z
dGF0ZSYgX19lcnIsIHVuc2lnbmVkIGxvbmcgbG9uZyYgX192KSBjb25zdAogICAgICB7IHJldHVy
biBfTV9leHRyYWN0X2ludChfX2JlZywgX19lbmQsIF9faW8sIF9fZXJyLCBfX3YpOyB9CgoKICAg
ICAgdmlydHVhbCBpdGVyX3R5cGUKICAgICAgZG9fZ2V0KGl0ZXJfdHlwZSwgaXRlcl90eXBlLCBp
b3NfYmFzZSYsIGlvc19iYXNlOjppb3N0YXRlJiwgZmxvYXQmKSBjb25zdDsKCiAgICAgIHZpcnR1
YWwgaXRlcl90eXBlCiAgICAgIGRvX2dldChpdGVyX3R5cGUsIGl0ZXJfdHlwZSwgaW9zX2Jhc2Um
LCBpb3NfYmFzZTo6aW9zdGF0ZSYsCiAgICAgIGRvdWJsZSYpIGNvbnN0OwoKCgogICAgICB2aXJ0
dWFsIGl0ZXJfdHlwZQogICAgICBfX2RvX2dldChpdGVyX3R5cGUsIGl0ZXJfdHlwZSwgaW9zX2Jh
c2UmLCBpb3NfYmFzZTo6aW9zdGF0ZSYsCiAgICAgICAgZG91YmxlJikgY29uc3Q7CgoKCgoKCiAg
ICAgIHZpcnR1YWwgaXRlcl90eXBlCiAgICAgIGRvX2dldChpdGVyX3R5cGUsIGl0ZXJfdHlwZSwg
aW9zX2Jhc2UmLCBpb3NfYmFzZTo6aW9zdGF0ZSYsIHZvaWQqJikgY29uc3Q7CgoKCiAgICAgIHZp
cnR1YWwgaXRlcl90eXBlCiAgICAgIGRvX2dldChpdGVyX3R5cGUsIGl0ZXJfdHlwZSwgaW9zX2Jh
c2UmLCBpb3NfYmFzZTo6aW9zdGF0ZSYsCiAgICAgIGxvbmcgZG91YmxlJikgY29uc3Q7CgoKICAg
IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX0luSXRlcj4KICAgIGxv
Y2FsZTo6aWQgbnVtX2dldDxfQ2hhclQsIF9Jbkl0ZXI+OjppZDsKIyAyMjg4ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0NoYXJULCB0eXBlbmFtZSBfT3V0SXRlcj4KICAgIGNsYXNzIG51bV9wdXQgOiBwdWJsaWMgbG9j
YWxlOjpmYWNldAogICAgewogICAgcHVibGljOgoKCgogICAgICB0eXBlZGVmIF9DaGFyVCBjaGFy
X3R5cGU7CiAgICAgIHR5cGVkZWYgX091dEl0ZXIgaXRlcl90eXBlOwoKCgogICAgICBzdGF0aWMg
bG9jYWxlOjppZCBpZDsKIyAyMzA5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxl
X2ZhY2V0cy5oIiAzCiAgICAgIGV4cGxpY2l0CiAgICAgIG51bV9wdXQoc2l6ZV90IF9fcmVmcyA9
IDApIDogZmFjZXQoX19yZWZzKSB7IH0KIyAyMzI3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAgIGl0ZXJfdHlwZQogICAgICBwdXQoaXRlcl90eXBl
IF9fcywgaW9zX2Jhc2UmIF9faW8sIGNoYXJfdHlwZSBfX2ZpbGwsIGJvb2wgX192KSBjb25zdAog
ICAgICB7IHJldHVybiB0aGlzLT5kb19wdXQoX19zLCBfX2lvLCBfX2ZpbGwsIF9fdik7IH0KIyAy
MzY5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2ZhY2V0cy5oIiAzCiAgICAg
IGl0ZXJfdHlwZQogICAgICBwdXQoaXRlcl90eXBlIF9fcywgaW9zX2Jhc2UmIF9faW8sIGNoYXJf
dHlwZSBfX2ZpbGwsIGxvbmcgX192KSBjb25zdAogICAgICB7IHJldHVybiB0aGlzLT5kb19wdXQo
X19zLCBfX2lvLCBfX2ZpbGwsIF9fdik7IH0KCiAgICAgIGl0ZXJfdHlwZQogICAgICBwdXQoaXRl
cl90eXBlIF9fcywgaW9zX2Jhc2UmIF9faW8sIGNoYXJfdHlwZSBfX2ZpbGwsCiAgIHVuc2lnbmVk
IGxvbmcgX192KSBjb25zdAogICAgICB7IHJldHVybiB0aGlzLT5kb19wdXQoX19zLCBfX2lvLCBf
X2ZpbGwsIF9fdik7IH0KCgogICAgICBpdGVyX3R5cGUKICAgICAgcHV0KGl0ZXJfdHlwZSBfX3Ms
IGlvc19iYXNlJiBfX2lvLCBjaGFyX3R5cGUgX19maWxsLCBsb25nIGxvbmcgX192KSBjb25zdAog
ICAgICB7IHJldHVybiB0aGlzLT5kb19wdXQoX19zLCBfX2lvLCBfX2ZpbGwsIF9fdik7IH0KCiAg
ICAgIGl0ZXJfdHlwZQogICAgICBwdXQoaXRlcl90eXBlIF9fcywgaW9zX2Jhc2UmIF9faW8sIGNo
YXJfdHlwZSBfX2ZpbGwsCiAgIHVuc2lnbmVkIGxvbmcgbG9uZyBfX3YpIGNvbnN0CiAgICAgIHsg
cmV0dXJuIHRoaXMtPmRvX3B1dChfX3MsIF9faW8sIF9fZmlsbCwgX192KTsgfQojIDI0MzIgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgaXRlcl90
eXBlCiAgICAgIHB1dChpdGVyX3R5cGUgX19zLCBpb3NfYmFzZSYgX19pbywgY2hhcl90eXBlIF9f
ZmlsbCwgZG91YmxlIF9fdikgY29uc3QKICAgICAgeyByZXR1cm4gdGhpcy0+ZG9fcHV0KF9fcywg
X19pbywgX19maWxsLCBfX3YpOyB9CgogICAgICBpdGVyX3R5cGUKICAgICAgcHV0KGl0ZXJfdHlw
ZSBfX3MsIGlvc19iYXNlJiBfX2lvLCBjaGFyX3R5cGUgX19maWxsLAogICBsb25nIGRvdWJsZSBf
X3YpIGNvbnN0CiAgICAgIHsgcmV0dXJuIHRoaXMtPmRvX3B1dChfX3MsIF9faW8sIF9fZmlsbCwg
X192KTsgfQojIDI0NTcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRz
LmgiIDMKICAgICAgaXRlcl90eXBlCiAgICAgIHB1dChpdGVyX3R5cGUgX19zLCBpb3NfYmFzZSYg
X19pbywgY2hhcl90eXBlIF9fZmlsbCwKICAgY29uc3Qgdm9pZCogX192KSBjb25zdAogICAgICB7
IHJldHVybiB0aGlzLT5kb19wdXQoX19zLCBfX2lvLCBfX2ZpbGwsIF9fdik7IH0KCiAgICBwcm90
ZWN0ZWQ6CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9WYWx1ZVQ+CiBpdGVyX3R5cGUKIF9NX2lu
c2VydF9mbG9hdChpdGVyX3R5cGUsIGlvc19iYXNlJiBfX2lvLCBjaGFyX3R5cGUgX19maWxsLAog
ICBjaGFyIF9fbW9kLCBfVmFsdWVUIF9fdikgY29uc3Q7CgogICAgICB2b2lkCiAgICAgIF9NX2dy
b3VwX2Zsb2F0KGNvbnN0IGNoYXIqIF9fZ3JvdXBpbmcsIHNpemVfdCBfX2dyb3VwaW5nX3NpemUs
CiAgICAgICBjaGFyX3R5cGUgX19zZXAsIGNvbnN0IGNoYXJfdHlwZSogX19wLCBjaGFyX3R5cGUq
IF9fbmV3LAogICAgICAgY2hhcl90eXBlKiBfX2NzLCBpbnQmIF9fbGVuKSBjb25zdDsKCiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9WYWx1ZVQ+CiBpdGVyX3R5cGUKIF9NX2luc2VydF9pbnQoaXRl
cl90eXBlLCBpb3NfYmFzZSYgX19pbywgY2hhcl90eXBlIF9fZmlsbCwKICAgICAgICBfVmFsdWVU
IF9fdikgY29uc3Q7CgogICAgICB2b2lkCiAgICAgIF9NX2dyb3VwX2ludChjb25zdCBjaGFyKiBf
X2dyb3VwaW5nLCBzaXplX3QgX19ncm91cGluZ19zaXplLAogICAgIGNoYXJfdHlwZSBfX3NlcCwg
aW9zX2Jhc2UmIF9faW8sIGNoYXJfdHlwZSogX19uZXcsCiAgICAgY2hhcl90eXBlKiBfX2NzLCBp
bnQmIF9fbGVuKSBjb25zdDsKCiAgICAgIHZvaWQKICAgICAgX01fcGFkKGNoYXJfdHlwZSBfX2Zp
bGwsIHN0cmVhbXNpemUgX193LCBpb3NfYmFzZSYgX19pbywKICAgICAgY2hhcl90eXBlKiBfX25l
dywgY29uc3QgY2hhcl90eXBlKiBfX2NzLCBpbnQmIF9fbGVuKSBjb25zdDsKCgogICAgICB2aXJ0
dWFsCiAgICAgIH5udW1fcHV0KCkgeyB9OwojIDI1MDUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9sb2NhbGVfZmFjZXRzLmgiIDMKICAgICAgdmlydHVhbCBpdGVyX3R5cGUKICAgICAgZG9f
cHV0KGl0ZXJfdHlwZSBfX3MsIGlvc19iYXNlJiBfX2lvLCBjaGFyX3R5cGUgX19maWxsLCBib29s
IF9fdikgY29uc3Q7CgogICAgICB2aXJ0dWFsIGl0ZXJfdHlwZQogICAgICBkb19wdXQoaXRlcl90
eXBlIF9fcywgaW9zX2Jhc2UmIF9faW8sIGNoYXJfdHlwZSBfX2ZpbGwsIGxvbmcgX192KSBjb25z
dAogICAgICB7IHJldHVybiBfTV9pbnNlcnRfaW50KF9fcywgX19pbywgX19maWxsLCBfX3YpOyB9
CgogICAgICB2aXJ0dWFsIGl0ZXJfdHlwZQogICAgICBkb19wdXQoaXRlcl90eXBlIF9fcywgaW9z
X2Jhc2UmIF9faW8sIGNoYXJfdHlwZSBfX2ZpbGwsCiAgICAgIHVuc2lnbmVkIGxvbmcgX192KSBj
b25zdAogICAgICB7IHJldHVybiBfTV9pbnNlcnRfaW50KF9fcywgX19pbywgX19maWxsLCBfX3Yp
OyB9CgoKICAgICAgdmlydHVhbCBpdGVyX3R5cGUKICAgICAgZG9fcHV0KGl0ZXJfdHlwZSBfX3Ms
IGlvc19iYXNlJiBfX2lvLCBjaGFyX3R5cGUgX19maWxsLAogICAgICBsb25nIGxvbmcgX192KSBj
b25zdAogICAgICB7IHJldHVybiBfTV9pbnNlcnRfaW50KF9fcywgX19pbywgX19maWxsLCBfX3Yp
OyB9CgogICAgICB2aXJ0dWFsIGl0ZXJfdHlwZQogICAgICBkb19wdXQoaXRlcl90eXBlIF9fcywg
aW9zX2Jhc2UmIF9faW8sIGNoYXJfdHlwZSBfX2ZpbGwsCiAgICAgIHVuc2lnbmVkIGxvbmcgbG9u
ZyBfX3YpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX2luc2VydF9pbnQoX19zLCBfX2lvLCBfX2Zp
bGwsIF9fdik7IH0KCgogICAgICB2aXJ0dWFsIGl0ZXJfdHlwZQogICAgICBkb19wdXQoaXRlcl90
eXBlLCBpb3NfYmFzZSYsIGNoYXJfdHlwZSwgZG91YmxlKSBjb25zdDsKCgoKICAgICAgdmlydHVh
bCBpdGVyX3R5cGUKICAgICAgX19kb19wdXQoaXRlcl90eXBlLCBpb3NfYmFzZSYsIGNoYXJfdHlw
ZSwgZG91YmxlKSBjb25zdDsKCgoKCgogICAgICB2aXJ0dWFsIGl0ZXJfdHlwZQogICAgICBkb19w
dXQoaXRlcl90eXBlLCBpb3NfYmFzZSYsIGNoYXJfdHlwZSwgY29uc3Qgdm9pZCopIGNvbnN0OwoK
CgogICAgICB2aXJ0dWFsIGl0ZXJfdHlwZQogICAgICBkb19wdXQoaXRlcl90eXBlLCBpb3NfYmFz
ZSYsIGNoYXJfdHlwZSwgbG9uZyBkb3VibGUpIGNvbnN0OwoKCiAgICB9OwoKICB0ZW1wbGF0ZSA8
dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfT3V0SXRlcj4KICAgIGxvY2FsZTo6aWQgbnVtX3B1
dDxfQ2hhclQsIF9PdXRJdGVyPjo6aWQ7Cgp9CgoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9D
aGFyVD4KICAgIGlubGluZSBib29sCiAgICBpc3NwYWNlKF9DaGFyVCBfX2MsIGNvbnN0IGxvY2Fs
ZSYgX19sb2MpCiAgICB7IHJldHVybiB1c2VfZmFjZXQ8Y3R5cGU8X0NoYXJUPiA+KF9fbG9jKS5p
cyhjdHlwZV9iYXNlOjpzcGFjZSwgX19jKTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJU
PgogICAgaW5saW5lIGJvb2wKICAgIGlzcHJpbnQoX0NoYXJUIF9fYywgY29uc3QgbG9jYWxlJiBf
X2xvYykKICAgIHsgcmV0dXJuIHVzZV9mYWNldDxjdHlwZTxfQ2hhclQ+ID4oX19sb2MpLmlzKGN0
eXBlX2Jhc2U6OnByaW50LCBfX2MpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAg
ICBpbmxpbmUgYm9vbAogICAgaXNjbnRybChfQ2hhclQgX19jLCBjb25zdCBsb2NhbGUmIF9fbG9j
KQogICAgeyByZXR1cm4gdXNlX2ZhY2V0PGN0eXBlPF9DaGFyVD4gPihfX2xvYykuaXMoY3R5cGVf
YmFzZTo6Y250cmwsIF9fYyk7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIGlu
bGluZSBib29sCiAgICBpc3VwcGVyKF9DaGFyVCBfX2MsIGNvbnN0IGxvY2FsZSYgX19sb2MpCiAg
ICB7IHJldHVybiB1c2VfZmFjZXQ8Y3R5cGU8X0NoYXJUPiA+KF9fbG9jKS5pcyhjdHlwZV9iYXNl
Ojp1cHBlciwgX19jKTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgaW5saW5l
IGJvb2wKICAgIGlzbG93ZXIoX0NoYXJUIF9fYywgY29uc3QgbG9jYWxlJiBfX2xvYykKICAgIHsg
cmV0dXJuIHVzZV9mYWNldDxjdHlwZTxfQ2hhclQ+ID4oX19sb2MpLmlzKGN0eXBlX2Jhc2U6Omxv
d2VyLCBfX2MpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBpbmxpbmUgYm9v
bAogICAgaXNhbHBoYShfQ2hhclQgX19jLCBjb25zdCBsb2NhbGUmIF9fbG9jKQogICAgeyByZXR1
cm4gdXNlX2ZhY2V0PGN0eXBlPF9DaGFyVD4gPihfX2xvYykuaXMoY3R5cGVfYmFzZTo6YWxwaGEs
IF9fYyk7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIGlubGluZSBib29sCiAg
ICBpc2RpZ2l0KF9DaGFyVCBfX2MsIGNvbnN0IGxvY2FsZSYgX19sb2MpCiAgICB7IHJldHVybiB1
c2VfZmFjZXQ8Y3R5cGU8X0NoYXJUPiA+KF9fbG9jKS5pcyhjdHlwZV9iYXNlOjpkaWdpdCwgX19j
KTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgaW5saW5lIGJvb2wKICAgIGlz
cHVuY3QoX0NoYXJUIF9fYywgY29uc3QgbG9jYWxlJiBfX2xvYykKICAgIHsgcmV0dXJuIHVzZV9m
YWNldDxjdHlwZTxfQ2hhclQ+ID4oX19sb2MpLmlzKGN0eXBlX2Jhc2U6OnB1bmN0LCBfX2MpOyB9
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBpbmxpbmUgYm9vbAogICAgaXN4ZGln
aXQoX0NoYXJUIF9fYywgY29uc3QgbG9jYWxlJiBfX2xvYykKICAgIHsgcmV0dXJuIHVzZV9mYWNl
dDxjdHlwZTxfQ2hhclQ+ID4oX19sb2MpLmlzKGN0eXBlX2Jhc2U6OnhkaWdpdCwgX19jKTsgfQoK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgaW5saW5lIGJvb2wKICAgIGlzYWxudW0o
X0NoYXJUIF9fYywgY29uc3QgbG9jYWxlJiBfX2xvYykKICAgIHsgcmV0dXJuIHVzZV9mYWNldDxj
dHlwZTxfQ2hhclQ+ID4oX19sb2MpLmlzKGN0eXBlX2Jhc2U6OmFsbnVtLCBfX2MpOyB9CgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBpbmxpbmUgYm9vbAogICAgaXNncmFwaChfQ2hh
clQgX19jLCBjb25zdCBsb2NhbGUmIF9fbG9jKQogICAgeyByZXR1cm4gdXNlX2ZhY2V0PGN0eXBl
PF9DaGFyVD4gPihfX2xvYykuaXMoY3R5cGVfYmFzZTo6Z3JhcGgsIF9fYyk7IH0KCgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBpbmxpbmUgYm9vbAogICAgaXNibGFuayhfQ2hhclQg
X19jLCBjb25zdCBsb2NhbGUmIF9fbG9jKQogICAgeyByZXR1cm4gdXNlX2ZhY2V0PGN0eXBlPF9D
aGFyVD4gPihfX2xvYykuaXMoY3R5cGVfYmFzZTo6YmxhbmssIF9fYyk7IH0KCgoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfQ2hhclQ+CiAgICBpbmxpbmUgX0NoYXJUCiAgICB0b3VwcGVyKF9DaGFyVCBf
X2MsIGNvbnN0IGxvY2FsZSYgX19sb2MpCiAgICB7IHJldHVybiB1c2VfZmFjZXQ8Y3R5cGU8X0No
YXJUPiA+KF9fbG9jKS50b3VwcGVyKF9fYyk7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFy
VD4KICAgIGlubGluZSBfQ2hhclQKICAgIHRvbG93ZXIoX0NoYXJUIF9fYywgY29uc3QgbG9jYWxl
JiBfX2xvYykKICAgIHsgcmV0dXJuIHVzZV9mYWNldDxjdHlwZTxfQ2hhclQ+ID4oX19sb2MpLnRv
bG93ZXIoX19jKTsgfQoKCn0KCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2Fs
ZV9mYWNldHMudGNjIiAxIDMKIyAzMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2xvY2Fs
ZV9mYWNldHMudGNjIiAzCiAgICAgICAKIyAzNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L2xvY2FsZV9mYWNldHMudGNjIiAzCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zp
c2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZhY2V0
PgogICAgc3RydWN0IF9fdXNlX2NhY2hlCiAgICB7CiAgICAgIGNvbnN0IF9GYWNldCoKICAgICAg
b3BlcmF0b3IoKSAoY29uc3QgbG9jYWxlJiBfX2xvYykgY29uc3Q7CiAgICB9OwoKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0NoYXJUPgogICAgc3RydWN0IF9fdXNlX2NhY2hlPF9fbnVtcHVuY3RfY2Fj
aGU8X0NoYXJUPiA+CiAgICB7CiAgICAgIGNvbnN0IF9fbnVtcHVuY3RfY2FjaGU8X0NoYXJUPioK
ICAgICAgb3BlcmF0b3IoKSAoY29uc3QgbG9jYWxlJiBfX2xvYykgY29uc3QKICAgICAgewogY29u
c3Qgc2l6ZV90IF9faSA9IG51bXB1bmN0PF9DaGFyVD46OmlkLl9NX2lkKCk7CiBjb25zdCBsb2Nh
bGU6OmZhY2V0KiogX19jYWNoZXMgPSBfX2xvYy5fTV9pbXBsLT5fTV9jYWNoZXM7CiBpZiAoIV9f
Y2FjaGVzW19faV0pCiAgIHsKICAgICBfX251bXB1bmN0X2NhY2hlPF9DaGFyVD4qIF9fdG1wID0g
MDsKICAgICB0cnkKICAgICAgIHsKICBfX3RtcCA9IG5ldyBfX251bXB1bmN0X2NhY2hlPF9DaGFy
VD47CiAgX190bXAtPl9NX2NhY2hlKF9fbG9jKTsKICAgICAgIH0KICAgICBjYXRjaCguLi4pCiAg
ICAgICB7CiAgZGVsZXRlIF9fdG1wOwogIHRocm93OwogICAgICAgfQogICAgIF9fbG9jLl9NX2lt
cGwtPl9NX2luc3RhbGxfY2FjaGUoX190bXAsIF9faSk7CiAgIH0KIHJldHVybiBzdGF0aWNfY2Fz
dDxjb25zdCBfX251bXB1bmN0X2NhY2hlPF9DaGFyVD4qPihfX2NhY2hlc1tfX2ldKTsKICAgICAg
fQogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJUPgogICAgdm9pZAogICAgX19udW1w
dW5jdF9jYWNoZTxfQ2hhclQ+OjpfTV9jYWNoZShjb25zdCBsb2NhbGUmIF9fbG9jKQogICAgewog
ICAgICBjb25zdCBudW1wdW5jdDxfQ2hhclQ+JiBfX25wID0gdXNlX2ZhY2V0PG51bXB1bmN0PF9D
aGFyVD4gPihfX2xvYyk7CgogICAgICBjaGFyKiBfX2dyb3VwaW5nID0gMDsKICAgICAgX0NoYXJU
KiBfX3RydWVuYW1lID0gMDsKICAgICAgX0NoYXJUKiBfX2ZhbHNlbmFtZSA9IDA7CiAgICAgIHRy
eQogewogICBjb25zdCBzdHJpbmcmIF9fZyA9IF9fbnAuZ3JvdXBpbmcoKTsKICAgX01fZ3JvdXBp
bmdfc2l6ZSA9IF9fZy5zaXplKCk7CiAgIF9fZ3JvdXBpbmcgPSBuZXcgY2hhcltfTV9ncm91cGlu
Z19zaXplXTsKICAgX19nLmNvcHkoX19ncm91cGluZywgX01fZ3JvdXBpbmdfc2l6ZSk7CiAgIF9N
X3VzZV9ncm91cGluZyA9IChfTV9ncm91cGluZ19zaXplCiAgICAgICAgJiYgc3RhdGljX2Nhc3Q8
c2lnbmVkIGNoYXI+KF9fZ3JvdXBpbmdbMF0pID4gMAogICAgICAgICYmIChfX2dyb3VwaW5nWzBd
CiAgICAgIT0gX19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPGNoYXI+OjpfX21heCkpOwoKICAg
Y29uc3QgYmFzaWNfc3RyaW5nPF9DaGFyVD4mIF9fdG4gPSBfX25wLnRydWVuYW1lKCk7CiAgIF9N
X3RydWVuYW1lX3NpemUgPSBfX3RuLnNpemUoKTsKICAgX190cnVlbmFtZSA9IG5ldyBfQ2hhclRb
X01fdHJ1ZW5hbWVfc2l6ZV07CiAgIF9fdG4uY29weShfX3RydWVuYW1lLCBfTV90cnVlbmFtZV9z
aXplKTsKCiAgIGNvbnN0IGJhc2ljX3N0cmluZzxfQ2hhclQ+JiBfX2ZuID0gX19ucC5mYWxzZW5h
bWUoKTsKICAgX01fZmFsc2VuYW1lX3NpemUgPSBfX2ZuLnNpemUoKTsKICAgX19mYWxzZW5hbWUg
PSBuZXcgX0NoYXJUW19NX2ZhbHNlbmFtZV9zaXplXTsKICAgX19mbi5jb3B5KF9fZmFsc2VuYW1l
LCBfTV9mYWxzZW5hbWVfc2l6ZSk7CgogICBfTV9kZWNpbWFsX3BvaW50ID0gX19ucC5kZWNpbWFs
X3BvaW50KCk7CiAgIF9NX3Rob3VzYW5kc19zZXAgPSBfX25wLnRob3VzYW5kc19zZXAoKTsKCiAg
IGNvbnN0IGN0eXBlPF9DaGFyVD4mIF9fY3QgPSB1c2VfZmFjZXQ8Y3R5cGU8X0NoYXJUPiA+KF9f
bG9jKTsKICAgX19jdC53aWRlbihfX251bV9iYXNlOjpfU19hdG9tc19vdXQsCiAgICAgICBfX251
bV9iYXNlOjpfU19hdG9tc19vdXQKICAgICAgICsgX19udW1fYmFzZTo6X1Nfb2VuZCwgX01fYXRv
bXNfb3V0KTsKICAgX19jdC53aWRlbihfX251bV9iYXNlOjpfU19hdG9tc19pbiwKICAgICAgIF9f
bnVtX2Jhc2U6Ol9TX2F0b21zX2luCiAgICAgICArIF9fbnVtX2Jhc2U6Ol9TX2llbmQsIF9NX2F0
b21zX2luKTsKCiAgIF9NX2dyb3VwaW5nID0gX19ncm91cGluZzsKICAgX01fdHJ1ZW5hbWUgPSBf
X3RydWVuYW1lOwogICBfTV9mYWxzZW5hbWUgPSBfX2ZhbHNlbmFtZTsKICAgX01fYWxsb2NhdGVk
ID0gdHJ1ZTsKIH0KICAgICAgY2F0Y2goLi4uKQogewogICBkZWxldGUgW10gX19ncm91cGluZzsK
ICAgZGVsZXRlIFtdIF9fdHJ1ZW5hbWU7CiAgIGRlbGV0ZSBbXSBfX2ZhbHNlbmFtZTsKICAgdGhy
b3c7CiB9CiAgICB9CiMgMTM5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2Zh
Y2V0cy50Y2MiIDMKICBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBib29sCiAgX192ZXJpZnlf
Z3JvdXBpbmcoY29uc3QgY2hhciogX19ncm91cGluZywgc2l6ZV90IF9fZ3JvdXBpbmdfc2l6ZSwK
ICAgICAgY29uc3Qgc3RyaW5nJiBfX2dyb3VwaW5nX3RtcCkgdGhyb3cgKCk7CgpuYW1lc3BhY2Ug
X19nbnVfY3h4X2xkYmwxMjggewoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1l
IF9Jbkl0ZXI+CiAgICBfX2F0dHJpYnV0ZSAoKF9fYWJpX3RhZ19fICgiY3h4MTEiKSkpCiAgICBf
SW5JdGVyCiAgICBudW1fZ2V0PF9DaGFyVCwgX0luSXRlcj46OgogICAgX01fZXh0cmFjdF9mbG9h
dChfSW5JdGVyIF9fYmVnLCBfSW5JdGVyIF9fZW5kLCBpb3NfYmFzZSYgX19pbywKICAgICAgIGlv
c19iYXNlOjppb3N0YXRlJiBfX2Vyciwgc3RyaW5nJiBfX3h0cmMpIGNvbnN0CiAgICB7CiAgICAg
IHR5cGVkZWYgY2hhcl90cmFpdHM8X0NoYXJUPiBfX3RyYWl0c190eXBlOwogICAgICB0eXBlZGVm
IF9fbnVtcHVuY3RfY2FjaGU8X0NoYXJUPiBfX2NhY2hlX3R5cGU7CiAgICAgIF9fdXNlX2NhY2hl
PF9fY2FjaGVfdHlwZT4gX191YzsKICAgICAgY29uc3QgbG9jYWxlJiBfX2xvYyA9IF9faW8uX01f
Z2V0bG9jKCk7CiAgICAgIGNvbnN0IF9fY2FjaGVfdHlwZSogX19sYyA9IF9fdWMoX19sb2MpOwog
ICAgICBjb25zdCBfQ2hhclQqIF9fbGl0ID0gX19sYy0+X01fYXRvbXNfaW47CiAgICAgIGNoYXJf
dHlwZSBfX2MgPSBjaGFyX3R5cGUoKTsKCgogICAgICBib29sIF9fdGVzdGVvZiA9IF9fYmVnID09
IF9fZW5kOwoKCiAgICAgIGlmICghX190ZXN0ZW9mKQogewogICBfX2MgPSAqX19iZWc7CiAgIGNv
bnN0IGJvb2wgX19wbHVzID0gX19jID09IF9fbGl0W19fbnVtX2Jhc2U6Ol9TX2lwbHVzXTsKICAg
aWYgKChfX3BsdXMgfHwgX19jID09IF9fbGl0W19fbnVtX2Jhc2U6Ol9TX2ltaW51c10pCiAgICAg
ICAmJiAhKF9fbGMtPl9NX3VzZV9ncm91cGluZyAmJiBfX2MgPT0gX19sYy0+X01fdGhvdXNhbmRz
X3NlcCkKICAgICAgICYmICEoX19jID09IF9fbGMtPl9NX2RlY2ltYWxfcG9pbnQpKQogICAgIHsK
ICAgICAgIF9feHRyYyArPSBfX3BsdXMgPyAnKycgOiAnLSc7CiAgICAgICBpZiAoKytfX2JlZyAh
PSBfX2VuZCkKICBfX2MgPSAqX19iZWc7CiAgICAgICBlbHNlCiAgX190ZXN0ZW9mID0gdHJ1ZTsK
ICAgICB9CiB9CgoKICAgICAgYm9vbCBfX2ZvdW5kX21hbnRpc3NhID0gZmFsc2U7CiAgICAgIGlu
dCBfX3NlcF9wb3MgPSAwOwogICAgICB3aGlsZSAoIV9fdGVzdGVvZikKIHsKICAgaWYgKChfX2xj
LT5fTV91c2VfZ3JvdXBpbmcgJiYgX19jID09IF9fbGMtPl9NX3Rob3VzYW5kc19zZXApCiAgICAg
ICB8fCBfX2MgPT0gX19sYy0+X01fZGVjaW1hbF9wb2ludCkKICAgICBicmVhazsKICAgZWxzZSBp
ZiAoX19jID09IF9fbGl0W19fbnVtX2Jhc2U6Ol9TX2l6ZXJvXSkKICAgICB7CiAgICAgICBpZiAo
IV9fZm91bmRfbWFudGlzc2EpCiAgewogICAgX194dHJjICs9ICcwJzsKICAgIF9fZm91bmRfbWFu
dGlzc2EgPSB0cnVlOwogIH0KICAgICAgICsrX19zZXBfcG9zOwoKICAgICAgIGlmICgrK19fYmVn
ICE9IF9fZW5kKQogIF9fYyA9ICpfX2JlZzsKICAgICAgIGVsc2UKICBfX3Rlc3Rlb2YgPSB0cnVl
OwogICAgIH0KICAgZWxzZQogICAgIGJyZWFrOwogfQoKCiAgICAgIGJvb2wgX19mb3VuZF9kZWMg
PSBmYWxzZTsKICAgICAgYm9vbCBfX2ZvdW5kX3NjaSA9IGZhbHNlOwogICAgICBzdHJpbmcgX19m
b3VuZF9ncm91cGluZzsKICAgICAgaWYgKF9fbGMtPl9NX3VzZV9ncm91cGluZykKIF9fZm91bmRf
Z3JvdXBpbmcucmVzZXJ2ZSgzMik7CiAgICAgIGNvbnN0IGNoYXJfdHlwZSogX19saXRfemVybyA9
IF9fbGl0ICsgX19udW1fYmFzZTo6X1NfaXplcm87CgogICAgICBpZiAoIV9fbGMtPl9NX2FsbG9j
YXRlZCkKCiB3aGlsZSAoIV9fdGVzdGVvZikKICAgewogICAgIGNvbnN0IGludCBfX2RpZ2l0ID0g
X01fZmluZChfX2xpdF96ZXJvLCAxMCwgX19jKTsKICAgICBpZiAoX19kaWdpdCAhPSAtMSkKICAg
ICAgIHsKICBfX3h0cmMgKz0gJzAnICsgX19kaWdpdDsKICBfX2ZvdW5kX21hbnRpc3NhID0gdHJ1
ZTsKICAgICAgIH0KICAgICBlbHNlIGlmIChfX2MgPT0gX19sYy0+X01fZGVjaW1hbF9wb2ludAog
ICAgICAgJiYgIV9fZm91bmRfZGVjICYmICFfX2ZvdW5kX3NjaSkKICAgICAgIHsKICBfX3h0cmMg
Kz0gJy4nOwogIF9fZm91bmRfZGVjID0gdHJ1ZTsKICAgICAgIH0KICAgICBlbHNlIGlmICgoX19j
ID09IF9fbGl0W19fbnVtX2Jhc2U6Ol9TX2llXQogICAgICAgIHx8IF9fYyA9PSBfX2xpdFtfX251
bV9iYXNlOjpfU19pRV0pCiAgICAgICAmJiAhX19mb3VuZF9zY2kgJiYgX19mb3VuZF9tYW50aXNz
YSkKICAgICAgIHsKCiAgX194dHJjICs9ICdlJzsKICBfX2ZvdW5kX3NjaSA9IHRydWU7CgoKICBp
ZiAoKytfX2JlZyAhPSBfX2VuZCkKICAgIHsKICAgICAgX19jID0gKl9fYmVnOwogICAgICBjb25z
dCBib29sIF9fcGx1cyA9IF9fYyA9PSBfX2xpdFtfX251bV9iYXNlOjpfU19pcGx1c107CiAgICAg
IGlmIChfX3BsdXMgfHwgX19jID09IF9fbGl0W19fbnVtX2Jhc2U6Ol9TX2ltaW51c10pCiAgICAg
ICAgX194dHJjICs9IF9fcGx1cyA/ICcrJyA6ICctJzsKICAgICAgZWxzZQogICAgICAgIGNvbnRp
bnVlOwogICAgfQogIGVsc2UKICAgIHsKICAgICAgX190ZXN0ZW9mID0gdHJ1ZTsKICAgICAgYnJl
YWs7CiAgICB9CiAgICAgICB9CiAgICAgZWxzZQogICAgICAgYnJlYWs7CgogICAgIGlmICgrK19f
YmVnICE9IF9fZW5kKQogICAgICAgX19jID0gKl9fYmVnOwogICAgIGVsc2UKICAgICAgIF9fdGVz
dGVvZiA9IHRydWU7CiAgIH0KICAgICAgZWxzZQogd2hpbGUgKCFfX3Rlc3Rlb2YpCiAgIHsKCgog
ICAgIGlmIChfX2xjLT5fTV91c2VfZ3JvdXBpbmcgJiYgX19jID09IF9fbGMtPl9NX3Rob3VzYW5k
c19zZXApCiAgICAgICB7CiAgaWYgKCFfX2ZvdW5kX2RlYyAmJiAhX19mb3VuZF9zY2kpCiAgICB7
CgoKICAgICAgaWYgKF9fc2VwX3BvcykKICAgICAgICB7CiAgIF9fZm91bmRfZ3JvdXBpbmcgKz0g
c3RhdGljX2Nhc3Q8Y2hhcj4oX19zZXBfcG9zKTsKICAgX19zZXBfcG9zID0gMDsKICAgICAgICB9
CiAgICAgIGVsc2UKICAgICAgICB7CgoKICAgX194dHJjLmNsZWFyKCk7CiAgIGJyZWFrOwogICAg
ICAgIH0KICAgIH0KICBlbHNlCiAgICBicmVhazsKICAgICAgIH0KICAgICBlbHNlIGlmIChfX2Mg
PT0gX19sYy0+X01fZGVjaW1hbF9wb2ludCkKICAgICAgIHsKICBpZiAoIV9fZm91bmRfZGVjICYm
ICFfX2ZvdW5kX3NjaSkKICAgIHsKCgoKICAgICAgaWYgKF9fZm91bmRfZ3JvdXBpbmcuc2l6ZSgp
KQogICAgICAgIF9fZm91bmRfZ3JvdXBpbmcgKz0gc3RhdGljX2Nhc3Q8Y2hhcj4oX19zZXBfcG9z
KTsKICAgICAgX194dHJjICs9ICcuJzsKICAgICAgX19mb3VuZF9kZWMgPSB0cnVlOwogICAgfQog
IGVsc2UKICAgIGJyZWFrOwogICAgICAgfQogICAgIGVsc2UKICAgICAgIHsKICBjb25zdCBjaGFy
X3R5cGUqIF9fcSA9CiAgICBfX3RyYWl0c190eXBlOjpmaW5kKF9fbGl0X3plcm8sIDEwLCBfX2Mp
OwogIGlmIChfX3EpCiAgICB7CiAgICAgIF9feHRyYyArPSAnMCcgKyAoX19xIC0gX19saXRfemVy
byk7CiAgICAgIF9fZm91bmRfbWFudGlzc2EgPSB0cnVlOwogICAgICArK19fc2VwX3BvczsKICAg
IH0KICBlbHNlIGlmICgoX19jID09IF9fbGl0W19fbnVtX2Jhc2U6Ol9TX2llXQogICAgIHx8IF9f
YyA9PSBfX2xpdFtfX251bV9iYXNlOjpfU19pRV0pCiAgICAmJiAhX19mb3VuZF9zY2kgJiYgX19m
b3VuZF9tYW50aXNzYSkKICAgIHsKCiAgICAgIGlmIChfX2ZvdW5kX2dyb3VwaW5nLnNpemUoKSAm
JiAhX19mb3VuZF9kZWMpCiAgICAgICAgX19mb3VuZF9ncm91cGluZyArPSBzdGF0aWNfY2FzdDxj
aGFyPihfX3NlcF9wb3MpOwogICAgICBfX3h0cmMgKz0gJ2UnOwogICAgICBfX2ZvdW5kX3NjaSA9
IHRydWU7CgoKICAgICAgaWYgKCsrX19iZWcgIT0gX19lbmQpCiAgICAgICAgewogICBfX2MgPSAq
X19iZWc7CiAgIGNvbnN0IGJvb2wgX19wbHVzID0gX19jID09IF9fbGl0W19fbnVtX2Jhc2U6Ol9T
X2lwbHVzXTsKICAgaWYgKChfX3BsdXMgfHwgX19jID09IF9fbGl0W19fbnVtX2Jhc2U6Ol9TX2lt
aW51c10pCiAgICAgICAmJiAhKF9fbGMtPl9NX3VzZV9ncm91cGluZwogICAgICYmIF9fYyA9PSBf
X2xjLT5fTV90aG91c2FuZHNfc2VwKQogICAgICAgJiYgIShfX2MgPT0gX19sYy0+X01fZGVjaW1h
bF9wb2ludCkpCiAgICAgICAgX194dHJjICs9IF9fcGx1cyA/ICcrJyA6ICctJzsKICAgZWxzZQog
ICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgZWxzZQogICAgICAgIHsKICAgX190ZXN0ZW9m
ID0gdHJ1ZTsKICAgYnJlYWs7CiAgICAgICAgfQogICAgfQogIGVsc2UKICAgIGJyZWFrOwogICAg
ICAgfQoKICAgICBpZiAoKytfX2JlZyAhPSBfX2VuZCkKICAgICAgIF9fYyA9ICpfX2JlZzsKICAg
ICBlbHNlCiAgICAgICBfX3Rlc3Rlb2YgPSB0cnVlOwogICB9CgoKCiAgICAgIGlmIChfX2ZvdW5k
X2dyb3VwaW5nLnNpemUoKSkKICAgICAgICB7CgogICBpZiAoIV9fZm91bmRfZGVjICYmICFfX2Zv
dW5kX3NjaSkKICAgICBfX2ZvdW5kX2dyb3VwaW5nICs9IHN0YXRpY19jYXN0PGNoYXI+KF9fc2Vw
X3Bvcyk7CgogICAgICAgICAgaWYgKCFzdGQ6Ol9fdmVyaWZ5X2dyb3VwaW5nKF9fbGMtPl9NX2dy
b3VwaW5nLAogICAgICAgICAgX19sYy0+X01fZ3JvdXBpbmdfc2l6ZSwKICAgICAgICAgIF9fZm91
bmRfZ3JvdXBpbmcpKQogICAgIF9fZXJyID0gaW9zX2Jhc2U6OmZhaWxiaXQ7CiAgICAgICAgfQoK
ICAgICAgcmV0dXJuIF9fYmVnOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5
cGVuYW1lIF9Jbkl0ZXI+CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVmFsdWVUPgogICAgICBfX2F0
dHJpYnV0ZSAoKF9fYWJpX3RhZ19fICgiY3h4MTEiKSkpCiAgICAgIF9Jbkl0ZXIKICAgICAgbnVt
X2dldDxfQ2hhclQsIF9Jbkl0ZXI+OjoKICAgICAgX01fZXh0cmFjdF9pbnQoX0luSXRlciBfX2Jl
ZywgX0luSXRlciBfX2VuZCwgaW9zX2Jhc2UmIF9faW8sCiAgICAgICBpb3NfYmFzZTo6aW9zdGF0
ZSYgX19lcnIsIF9WYWx1ZVQmIF9fdikgY29uc3QKICAgICAgewogICAgICAgIHR5cGVkZWYgY2hh
cl90cmFpdHM8X0NoYXJUPiBfX3RyYWl0c190eXBlOwogdXNpbmcgX19nbnVfY3h4OjpfX2FkZF91
bnNpZ25lZDsKIHR5cGVkZWYgdHlwZW5hbWUgX19hZGRfdW5zaWduZWQ8X1ZhbHVlVD46Ol9fdHlw
ZSBfX3Vuc2lnbmVkX3R5cGU7CiB0eXBlZGVmIF9fbnVtcHVuY3RfY2FjaGU8X0NoYXJUPiBfX2Nh
Y2hlX3R5cGU7CiBfX3VzZV9jYWNoZTxfX2NhY2hlX3R5cGU+IF9fdWM7CiBjb25zdCBsb2NhbGUm
IF9fbG9jID0gX19pby5fTV9nZXRsb2MoKTsKIGNvbnN0IF9fY2FjaGVfdHlwZSogX19sYyA9IF9f
dWMoX19sb2MpOwogY29uc3QgX0NoYXJUKiBfX2xpdCA9IF9fbGMtPl9NX2F0b21zX2luOwogY2hh
cl90eXBlIF9fYyA9IGNoYXJfdHlwZSgpOwoKCiBjb25zdCBpb3NfYmFzZTo6Zm10ZmxhZ3MgX19i
YXNlZmllbGQgPSBfX2lvLmZsYWdzKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICYgaW9zX2Jhc2U6OmJhc2VmaWVsZDsKIGNvbnN0IGJvb2wgX19vY3QgPSBfX2Jhc2Vm
aWVsZCA9PSBpb3NfYmFzZTo6b2N0OwogaW50IF9fYmFzZSA9IF9fb2N0ID8gOCA6IChfX2Jhc2Vm
aWVsZCA9PSBpb3NfYmFzZTo6aGV4ID8gMTYgOiAxMCk7CgoKIGJvb2wgX190ZXN0ZW9mID0gX19i
ZWcgPT0gX19lbmQ7CgoKIGJvb2wgX19uZWdhdGl2ZSA9IGZhbHNlOwogaWYgKCFfX3Rlc3Rlb2Yp
CiAgIHsKICAgICBfX2MgPSAqX19iZWc7CiAgICAgX19uZWdhdGl2ZSA9IF9fYyA9PSBfX2xpdFtf
X251bV9iYXNlOjpfU19pbWludXNdOwogICAgIGlmICgoX19uZWdhdGl2ZSB8fCBfX2MgPT0gX19s
aXRbX19udW1fYmFzZTo6X1NfaXBsdXNdKQogICYmICEoX19sYy0+X01fdXNlX2dyb3VwaW5nICYm
IF9fYyA9PSBfX2xjLT5fTV90aG91c2FuZHNfc2VwKQogICYmICEoX19jID09IF9fbGMtPl9NX2Rl
Y2ltYWxfcG9pbnQpKQogICAgICAgewogIGlmICgrK19fYmVnICE9IF9fZW5kKQogICAgX19jID0g
Kl9fYmVnOwogIGVsc2UKICAgIF9fdGVzdGVvZiA9IHRydWU7CiAgICAgICB9CiAgIH0KCgoKIGJv
b2wgX19mb3VuZF96ZXJvID0gZmFsc2U7CiBpbnQgX19zZXBfcG9zID0gMDsKIHdoaWxlICghX190
ZXN0ZW9mKQogICB7CiAgICAgaWYgKChfX2xjLT5fTV91c2VfZ3JvdXBpbmcgJiYgX19jID09IF9f
bGMtPl9NX3Rob3VzYW5kc19zZXApCiAgfHwgX19jID09IF9fbGMtPl9NX2RlY2ltYWxfcG9pbnQp
CiAgICAgICBicmVhazsKICAgICBlbHNlIGlmIChfX2MgPT0gX19saXRbX19udW1fYmFzZTo6X1Nf
aXplcm9dCiAgICAgICAmJiAoIV9fZm91bmRfemVybyB8fCBfX2Jhc2UgPT0gMTApKQogICAgICAg
ewogIF9fZm91bmRfemVybyA9IHRydWU7CiAgKytfX3NlcF9wb3M7CiAgaWYgKF9fYmFzZWZpZWxk
ID09IDApCiAgICBfX2Jhc2UgPSA4OwogIGlmIChfX2Jhc2UgPT0gOCkKICAgIF9fc2VwX3BvcyA9
IDA7CiAgICAgICB9CiAgICAgZWxzZSBpZiAoX19mb3VuZF96ZXJvCiAgICAgICAmJiAoX19jID09
IF9fbGl0W19fbnVtX2Jhc2U6Ol9TX2l4XQogICAgfHwgX19jID09IF9fbGl0W19fbnVtX2Jhc2U6
Ol9TX2lYXSkpCiAgICAgICB7CiAgaWYgKF9fYmFzZWZpZWxkID09IDApCiAgICBfX2Jhc2UgPSAx
NjsKICBpZiAoX19iYXNlID09IDE2KQogICAgewogICAgICBfX2ZvdW5kX3plcm8gPSBmYWxzZTsK
ICAgICAgX19zZXBfcG9zID0gMDsKICAgIH0KICBlbHNlCiAgICBicmVhazsKICAgICAgIH0KICAg
ICBlbHNlCiAgICAgICBicmVhazsKCiAgICAgaWYgKCsrX19iZWcgIT0gX19lbmQpCiAgICAgICB7
CiAgX19jID0gKl9fYmVnOwogIGlmICghX19mb3VuZF96ZXJvKQogICAgYnJlYWs7CiAgICAgICB9
CiAgICAgZWxzZQogICAgICAgX190ZXN0ZW9mID0gdHJ1ZTsKICAgfQoKCgogY29uc3Qgc2l6ZV90
IF9fbGVuID0gKF9fYmFzZSA9PSAxNiA/IF9fbnVtX2Jhc2U6Ol9TX2llbmQKICAgICAgICAgLSBf
X251bV9iYXNlOjpfU19pemVybyA6IF9fYmFzZSk7CgoKIHN0cmluZyBfX2ZvdW5kX2dyb3VwaW5n
OwogaWYgKF9fbGMtPl9NX3VzZV9ncm91cGluZykKICAgX19mb3VuZF9ncm91cGluZy5yZXNlcnZl
KDMyKTsKIGJvb2wgX190ZXN0ZmFpbCA9IGZhbHNlOwogYm9vbCBfX3Rlc3RvdmVyZmxvdyA9IGZh
bHNlOwogY29uc3QgX191bnNpZ25lZF90eXBlIF9fbWF4ID0KICAgKF9fbmVnYXRpdmUgJiYgX19n
bnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPF9WYWx1ZVQ+OjpfX2lzX3NpZ25lZCkKICAgPyAtX19n
bnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPF9WYWx1ZVQ+OjpfX21pbgogICA6IF9fZ251X2N4eDo6
X19udW1lcmljX3RyYWl0czxfVmFsdWVUPjo6X19tYXg7CiBjb25zdCBfX3Vuc2lnbmVkX3R5cGUg
X19zbWF4ID0gX19tYXggLyBfX2Jhc2U7CiBfX3Vuc2lnbmVkX3R5cGUgX19yZXN1bHQgPSAwOwog
aW50IF9fZGlnaXQgPSAwOwogY29uc3QgY2hhcl90eXBlKiBfX2xpdF96ZXJvID0gX19saXQgKyBf
X251bV9iYXNlOjpfU19pemVybzsKCiBpZiAoIV9fbGMtPl9NX2FsbG9jYXRlZCkKCiAgIHdoaWxl
ICghX190ZXN0ZW9mKQogICAgIHsKICAgICAgIF9fZGlnaXQgPSBfTV9maW5kKF9fbGl0X3plcm8s
IF9fbGVuLCBfX2MpOwogICAgICAgaWYgKF9fZGlnaXQgPT0gLTEpCiAgYnJlYWs7CgogICAgICAg
aWYgKF9fcmVzdWx0ID4gX19zbWF4KQogIF9fdGVzdG92ZXJmbG93ID0gdHJ1ZTsKICAgICAgIGVs
c2UKICB7CiAgICBfX3Jlc3VsdCAqPSBfX2Jhc2U7CiAgICBfX3Rlc3RvdmVyZmxvdyB8PSBfX3Jl
c3VsdCA+IF9fbWF4IC0gX19kaWdpdDsKICAgIF9fcmVzdWx0ICs9IF9fZGlnaXQ7CiAgICArK19f
c2VwX3BvczsKICB9CgogICAgICAgaWYgKCsrX19iZWcgIT0gX19lbmQpCiAgX19jID0gKl9fYmVn
OwogICAgICAgZWxzZQogIF9fdGVzdGVvZiA9IHRydWU7CiAgICAgfQogZWxzZQogICB3aGlsZSAo
IV9fdGVzdGVvZikKICAgICB7CgoKICAgICAgIGlmIChfX2xjLT5fTV91c2VfZ3JvdXBpbmcgJiYg
X19jID09IF9fbGMtPl9NX3Rob3VzYW5kc19zZXApCiAgewoKCiAgICBpZiAoX19zZXBfcG9zKQog
ICAgICB7CiAgICAgICAgX19mb3VuZF9ncm91cGluZyArPSBzdGF0aWNfY2FzdDxjaGFyPihfX3Nl
cF9wb3MpOwogICAgICAgIF9fc2VwX3BvcyA9IDA7CiAgICAgIH0KICAgIGVsc2UKICAgICAgewog
ICAgICAgIF9fdGVzdGZhaWwgPSB0cnVlOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgfQogICAg
ICAgZWxzZSBpZiAoX19jID09IF9fbGMtPl9NX2RlY2ltYWxfcG9pbnQpCiAgYnJlYWs7CiAgICAg
ICBlbHNlCiAgewogICAgY29uc3QgY2hhcl90eXBlKiBfX3EgPQogICAgICBfX3RyYWl0c190eXBl
OjpmaW5kKF9fbGl0X3plcm8sIF9fbGVuLCBfX2MpOwogICAgaWYgKCFfX3EpCiAgICAgIGJyZWFr
OwoKICAgIF9fZGlnaXQgPSBfX3EgLSBfX2xpdF96ZXJvOwogICAgaWYgKF9fZGlnaXQgPiAxNSkK
ICAgICAgX19kaWdpdCAtPSA2OwogICAgaWYgKF9fcmVzdWx0ID4gX19zbWF4KQogICAgICBfX3Rl
c3RvdmVyZmxvdyA9IHRydWU7CiAgICBlbHNlCiAgICAgIHsKICAgICAgICBfX3Jlc3VsdCAqPSBf
X2Jhc2U7CiAgICAgICAgX190ZXN0b3ZlcmZsb3cgfD0gX19yZXN1bHQgPiBfX21heCAtIF9fZGln
aXQ7CiAgICAgICAgX19yZXN1bHQgKz0gX19kaWdpdDsKICAgICAgICArK19fc2VwX3BvczsKICAg
ICAgfQogIH0KCiAgICAgICBpZiAoKytfX2JlZyAhPSBfX2VuZCkKICBfX2MgPSAqX19iZWc7CiAg
ICAgICBlbHNlCiAgX190ZXN0ZW9mID0gdHJ1ZTsKICAgICB9CgoKCiBpZiAoX19mb3VuZF9ncm91
cGluZy5zaXplKCkpCiAgIHsKCiAgICAgX19mb3VuZF9ncm91cGluZyArPSBzdGF0aWNfY2FzdDxj
aGFyPihfX3NlcF9wb3MpOwoKICAgICBpZiAoIXN0ZDo6X192ZXJpZnlfZ3JvdXBpbmcoX19sYy0+
X01fZ3JvdXBpbmcsCiAgICAgX19sYy0+X01fZ3JvdXBpbmdfc2l6ZSwKICAgICBfX2ZvdW5kX2dy
b3VwaW5nKSkKICAgICAgIF9fZXJyID0gaW9zX2Jhc2U6OmZhaWxiaXQ7CiAgIH0KCgoKIGlmICgo
IV9fc2VwX3BvcyAmJiAhX19mb3VuZF96ZXJvICYmICFfX2ZvdW5kX2dyb3VwaW5nLnNpemUoKSkK
ICAgICB8fCBfX3Rlc3RmYWlsKQogICB7CiAgICAgX192ID0gMDsKICAgICBfX2VyciA9IGlvc19i
YXNlOjpmYWlsYml0OwogICB9CiBlbHNlIGlmIChfX3Rlc3RvdmVyZmxvdykKICAgewogICAgIGlm
IChfX25lZ2F0aXZlCiAgJiYgX19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPF9WYWx1ZVQ+Ojpf
X2lzX3NpZ25lZCkKICAgICAgIF9fdiA9IF9fZ251X2N4eDo6X19udW1lcmljX3RyYWl0czxfVmFs
dWVUPjo6X19taW47CiAgICAgZWxzZQogICAgICAgX192ID0gX19nbnVfY3h4OjpfX251bWVyaWNf
dHJhaXRzPF9WYWx1ZVQ+OjpfX21heDsKICAgICBfX2VyciA9IGlvc19iYXNlOjpmYWlsYml0Owog
ICB9CiBlbHNlCiAgIF9fdiA9IF9fbmVnYXRpdmUgPyAtX19yZXN1bHQgOiBfX3Jlc3VsdDsKCiBp
ZiAoX190ZXN0ZW9mKQogICBfX2VyciB8PSBpb3NfYmFzZTo6ZW9mYml0OwogcmV0dXJuIF9fYmVn
OwogICAgICB9CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfSW5JdGVy
PgogICAgX0luSXRlcgogICAgbnVtX2dldDxfQ2hhclQsIF9Jbkl0ZXI+OjoKICAgIGRvX2dldChp
dGVyX3R5cGUgX19iZWcsIGl0ZXJfdHlwZSBfX2VuZCwgaW9zX2Jhc2UmIF9faW8sCiAgICAgICAg
ICAgaW9zX2Jhc2U6Omlvc3RhdGUmIF9fZXJyLCBib29sJiBfX3YpIGNvbnN0CiAgICB7CiAgICAg
IGlmICghKF9faW8uZmxhZ3MoKSAmIGlvc19iYXNlOjpib29sYWxwaGEpKQogICAgICAgIHsKCgoK
ICAgbG9uZyBfX2wgPSAtMTsKICAgICAgICAgIF9fYmVnID0gX01fZXh0cmFjdF9pbnQoX19iZWcs
IF9fZW5kLCBfX2lvLCBfX2VyciwgX19sKTsKICAgaWYgKF9fbCA9PSAwIHx8IF9fbCA9PSAxKQog
ICAgIF9fdiA9IGJvb2woX19sKTsKICAgZWxzZQogICAgIHsKCgogICAgICAgX192ID0gdHJ1ZTsK
ICAgICAgIF9fZXJyID0gaW9zX2Jhc2U6OmZhaWxiaXQ7CiAgICAgICBpZiAoX19iZWcgPT0gX19l
bmQpCiAgX19lcnIgfD0gaW9zX2Jhc2U6OmVvZmJpdDsKICAgICB9CiAgICAgICAgfQogICAgICBl
bHNlCiAgICAgICAgewoKICAgdHlwZWRlZiBfX251bXB1bmN0X2NhY2hlPF9DaGFyVD4gX19jYWNo
ZV90eXBlOwogICBfX3VzZV9jYWNoZTxfX2NhY2hlX3R5cGU+IF9fdWM7CiAgIGNvbnN0IGxvY2Fs
ZSYgX19sb2MgPSBfX2lvLl9NX2dldGxvYygpOwogICBjb25zdCBfX2NhY2hlX3R5cGUqIF9fbGMg
PSBfX3VjKF9fbG9jKTsKCiAgIGJvb2wgX190ZXN0ZiA9IHRydWU7CiAgIGJvb2wgX190ZXN0dCA9
IHRydWU7CiAgIGJvb2wgX19kb25lZiA9IF9fbGMtPl9NX2ZhbHNlbmFtZV9zaXplID09IDA7CiAg
IGJvb2wgX19kb25ldCA9IF9fbGMtPl9NX3RydWVuYW1lX3NpemUgPT0gMDsKICAgYm9vbCBfX3Rl
c3Rlb2YgPSBmYWxzZTsKICAgc2l6ZV90IF9fbiA9IDA7CiAgIHdoaWxlICghX19kb25lZiB8fCAh
X19kb25ldCkKICAgICB7CiAgICAgICBpZiAoX19iZWcgPT0gX19lbmQpCiAgewogICAgX190ZXN0
ZW9mID0gdHJ1ZTsKICAgIGJyZWFrOwogIH0KCiAgICAgICBjb25zdCBjaGFyX3R5cGUgX19jID0g
Kl9fYmVnOwoKICAgICAgIGlmICghX19kb25lZikKICBfX3Rlc3RmID0gX19jID09IF9fbGMtPl9N
X2ZhbHNlbmFtZVtfX25dOwoKICAgICAgIGlmICghX190ZXN0ZiAmJiBfX2RvbmV0KQogIGJyZWFr
OwoKICAgICAgIGlmICghX19kb25ldCkKICBfX3Rlc3R0ID0gX19jID09IF9fbGMtPl9NX3RydWVu
YW1lW19fbl07CgogICAgICAgaWYgKCFfX3Rlc3R0ICYmIF9fZG9uZWYpCiAgYnJlYWs7CgogICAg
ICAgaWYgKCFfX3Rlc3R0ICYmICFfX3Rlc3RmKQogIGJyZWFrOwoKICAgICAgICsrX19uOwogICAg
ICAgKytfX2JlZzsKCiAgICAgICBfX2RvbmVmID0gIV9fdGVzdGYgfHwgX19uID49IF9fbGMtPl9N
X2ZhbHNlbmFtZV9zaXplOwogICAgICAgX19kb25ldCA9ICFfX3Rlc3R0IHx8IF9fbiA+PSBfX2xj
LT5fTV90cnVlbmFtZV9zaXplOwogICAgIH0KICAgaWYgKF9fdGVzdGYgJiYgX19uID09IF9fbGMt
Pl9NX2ZhbHNlbmFtZV9zaXplICYmIF9fbikKICAgICB7CiAgICAgICBfX3YgPSBmYWxzZTsKICAg
ICAgIGlmIChfX3Rlc3R0ICYmIF9fbiA9PSBfX2xjLT5fTV90cnVlbmFtZV9zaXplKQogIF9fZXJy
ID0gaW9zX2Jhc2U6OmZhaWxiaXQ7CiAgICAgICBlbHNlCiAgX19lcnIgPSBfX3Rlc3Rlb2YgPyBp
b3NfYmFzZTo6ZW9mYml0IDogaW9zX2Jhc2U6Omdvb2RiaXQ7CiAgICAgfQogICBlbHNlIGlmIChf
X3Rlc3R0ICYmIF9fbiA9PSBfX2xjLT5fTV90cnVlbmFtZV9zaXplICYmIF9fbikKICAgICB7CiAg
ICAgICBfX3YgPSB0cnVlOwogICAgICAgX19lcnIgPSBfX3Rlc3Rlb2YgPyBpb3NfYmFzZTo6ZW9m
Yml0IDogaW9zX2Jhc2U6Omdvb2RiaXQ7CiAgICAgfQogICBlbHNlCiAgICAgewoKCiAgICAgICBf
X3YgPSBmYWxzZTsKICAgICAgIF9fZXJyID0gaW9zX2Jhc2U6OmZhaWxiaXQ7CiAgICAgICBpZiAo
X190ZXN0ZW9mKQogIF9fZXJyIHw9IGlvc19iYXNlOjplb2ZiaXQ7CiAgICAgfQogfQogICAgICBy
ZXR1cm4gX19iZWc7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUg
X0luSXRlcj4KICAgIF9Jbkl0ZXIKICAgIG51bV9nZXQ8X0NoYXJULCBfSW5JdGVyPjo6CiAgICBk
b19nZXQoaXRlcl90eXBlIF9fYmVnLCBpdGVyX3R5cGUgX19lbmQsIGlvc19iYXNlJiBfX2lvLAog
ICAgaW9zX2Jhc2U6Omlvc3RhdGUmIF9fZXJyLCBmbG9hdCYgX192KSBjb25zdAogICAgewogICAg
ICBzdHJpbmcgX194dHJjOwogICAgICBfX3h0cmMucmVzZXJ2ZSgzMik7CiAgICAgIF9fYmVnID0g
X01fZXh0cmFjdF9mbG9hdChfX2JlZywgX19lbmQsIF9faW8sIF9fZXJyLCBfX3h0cmMpOwogICAg
ICBzdGQ6Ol9fY29udmVydF90b192KF9feHRyYy5jX3N0cigpLCBfX3YsIF9fZXJyLCBfU19nZXRf
Y19sb2NhbGUoKSk7CiAgICAgIGlmIChfX2JlZyA9PSBfX2VuZCkKIF9fZXJyIHw9IGlvc19iYXNl
Ojplb2ZiaXQ7CiAgICAgIHJldHVybiBfX2JlZzsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0NoYXJULCB0eXBlbmFtZSBfSW5JdGVyPgogICAgX0luSXRlcgogICAgbnVtX2dldDxfQ2hhclQs
IF9Jbkl0ZXI+OjoKICAgIGRvX2dldChpdGVyX3R5cGUgX19iZWcsIGl0ZXJfdHlwZSBfX2VuZCwg
aW9zX2Jhc2UmIF9faW8sCiAgICAgICAgICAgaW9zX2Jhc2U6Omlvc3RhdGUmIF9fZXJyLCBkb3Vi
bGUmIF9fdikgY29uc3QKICAgIHsKICAgICAgc3RyaW5nIF9feHRyYzsKICAgICAgX194dHJjLnJl
c2VydmUoMzIpOwogICAgICBfX2JlZyA9IF9NX2V4dHJhY3RfZmxvYXQoX19iZWcsIF9fZW5kLCBf
X2lvLCBfX2VyciwgX194dHJjKTsKICAgICAgc3RkOjpfX2NvbnZlcnRfdG9fdihfX3h0cmMuY19z
dHIoKSwgX192LCBfX2VyciwgX1NfZ2V0X2NfbG9jYWxlKCkpOwogICAgICBpZiAoX19iZWcgPT0g
X19lbmQpCiBfX2VyciB8PSBpb3NfYmFzZTo6ZW9mYml0OwogICAgICByZXR1cm4gX19iZWc7CiAg
ICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9Jbkl0ZXI+CiAgICBf
SW5JdGVyCiAgICBudW1fZ2V0PF9DaGFyVCwgX0luSXRlcj46OgogICAgX19kb19nZXQoaXRlcl90
eXBlIF9fYmVnLCBpdGVyX3R5cGUgX19lbmQsIGlvc19iYXNlJiBfX2lvLAogICAgICBpb3NfYmFz
ZTo6aW9zdGF0ZSYgX19lcnIsIGRvdWJsZSYgX192KSBjb25zdAogICAgewogICAgICBzdHJpbmcg
X194dHJjOwogICAgICBfX3h0cmMucmVzZXJ2ZSgzMik7CiAgICAgIF9fYmVnID0gX01fZXh0cmFj
dF9mbG9hdChfX2JlZywgX19lbmQsIF9faW8sIF9fZXJyLCBfX3h0cmMpOwogICAgICBzdGQ6Ol9f
Y29udmVydF90b192KF9feHRyYy5jX3N0cigpLCBfX3YsIF9fZXJyLCBfU19nZXRfY19sb2NhbGUo
KSk7CiAgICAgIGlmIChfX2JlZyA9PSBfX2VuZCkKIF9fZXJyIHw9IGlvc19iYXNlOjplb2ZiaXQ7
CiAgICAgIHJldHVybiBfX2JlZzsKICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwg
dHlwZW5hbWUgX0luSXRlcj4KICAgIF9Jbkl0ZXIKICAgIG51bV9nZXQ8X0NoYXJULCBfSW5JdGVy
Pjo6CiAgICBkb19nZXQoaXRlcl90eXBlIF9fYmVnLCBpdGVyX3R5cGUgX19lbmQsIGlvc19iYXNl
JiBfX2lvLAogICAgICAgICAgIGlvc19iYXNlOjppb3N0YXRlJiBfX2VyciwgbG9uZyBkb3VibGUm
IF9fdikgY29uc3QKICAgIHsKICAgICAgc3RyaW5nIF9feHRyYzsKICAgICAgX194dHJjLnJlc2Vy
dmUoMzIpOwogICAgICBfX2JlZyA9IF9NX2V4dHJhY3RfZmxvYXQoX19iZWcsIF9fZW5kLCBfX2lv
LCBfX2VyciwgX194dHJjKTsKICAgICAgc3RkOjpfX2NvbnZlcnRfdG9fdihfX3h0cmMuY19zdHIo
KSwgX192LCBfX2VyciwgX1NfZ2V0X2NfbG9jYWxlKCkpOwogICAgICBpZiAoX19iZWcgPT0gX19l
bmQpCiBfX2VyciB8PSBpb3NfYmFzZTo6ZW9mYml0OwogICAgICByZXR1cm4gX19iZWc7CiAgICB9
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX0luSXRlcj4KICAgIF9Jbkl0
ZXIKICAgIG51bV9nZXQ8X0NoYXJULCBfSW5JdGVyPjo6CiAgICBkb19nZXQoaXRlcl90eXBlIF9f
YmVnLCBpdGVyX3R5cGUgX19lbmQsIGlvc19iYXNlJiBfX2lvLAogICAgICAgICAgIGlvc19iYXNl
Ojppb3N0YXRlJiBfX2Vyciwgdm9pZComIF9fdikgY29uc3QKICAgIHsKCiAgICAgIHR5cGVkZWYg
aW9zX2Jhc2U6OmZtdGZsYWdzIGZtdGZsYWdzOwogICAgICBjb25zdCBmbXRmbGFncyBfX2ZtdCA9
IF9faW8uZmxhZ3MoKTsKICAgICAgX19pby5mbGFncygoX19mbXQgJiB+aW9zX2Jhc2U6OmJhc2Vm
aWVsZCkgfCBpb3NfYmFzZTo6aGV4KTsKCiAgICAgIHR5cGVkZWYgX19nbnVfY3h4OjpfX2NvbmRp
dGlvbmFsX3R5cGU8KHNpemVvZih2b2lkKikKICAgICAgICAgIDw9IHNpemVvZih1bnNpZ25lZCBs
b25nKSksCiB1bnNpZ25lZCBsb25nLCB1bnNpZ25lZCBsb25nIGxvbmc+OjpfX3R5cGUgX1VJbnRQ
dHJUeXBlOwoKICAgICAgX1VJbnRQdHJUeXBlIF9fdWw7CiAgICAgIF9fYmVnID0gX01fZXh0cmFj
dF9pbnQoX19iZWcsIF9fZW5kLCBfX2lvLCBfX2VyciwgX191bCk7CgoKICAgICAgX19pby5mbGFn
cyhfX2ZtdCk7CgogICAgICBfX3YgPSByZWludGVycHJldF9jYXN0PHZvaWQqPihfX3VsKTsKICAg
ICAgcmV0dXJuIF9fYmVnOwogICAgfQoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlw
ZW5hbWUgX091dEl0ZXI+CiAgICB2b2lkCiAgICBudW1fcHV0PF9DaGFyVCwgX091dEl0ZXI+OjoK
ICAgIF9NX3BhZChfQ2hhclQgX19maWxsLCBzdHJlYW1zaXplIF9fdywgaW9zX2Jhc2UmIF9faW8s
CiAgICBfQ2hhclQqIF9fbmV3LCBjb25zdCBfQ2hhclQqIF9fY3MsIGludCYgX19sZW4pIGNvbnN0
CiAgICB7CgoKICAgICAgX19wYWQ8X0NoYXJULCBjaGFyX3RyYWl0czxfQ2hhclQ+ID46Ol9TX3Bh
ZChfX2lvLCBfX2ZpbGwsIF9fbmV3LAogICAgICAgIF9fY3MsIF9fdywgX19sZW4pOwogICAgICBf
X2xlbiA9IHN0YXRpY19jYXN0PGludD4oX193KTsKICAgIH0KCn0KCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0NoYXJULCB0eXBlbmFtZSBfVmFsdWVUPgogICAgaW50CiAgICBfX2ludF90b19jaGFyKF9D
aGFyVCogX19idWZlbmQsIF9WYWx1ZVQgX192LCBjb25zdCBfQ2hhclQqIF9fbGl0LAogICAgaW9z
X2Jhc2U6OmZtdGZsYWdzIF9fZmxhZ3MsIGJvb2wgX19kZWMpCiAgICB7CiAgICAgIF9DaGFyVCog
X19idWYgPSBfX2J1ZmVuZDsKICAgICAgaWYgKF9fYnVpbHRpbl9leHBlY3QoX19kZWMsIHRydWUp
KQogewoKICAgZG8KICAgICB7CiAgICAgICAqLS1fX2J1ZiA9IF9fbGl0WyhfX3YgJSAxMCkgKyBf
X251bV9iYXNlOjpfU19vZGlnaXRzXTsKICAgICAgIF9fdiAvPSAxMDsKICAgICB9CiAgIHdoaWxl
IChfX3YgIT0gMCk7CiB9CiAgICAgIGVsc2UgaWYgKChfX2ZsYWdzICYgaW9zX2Jhc2U6OmJhc2Vm
aWVsZCkgPT0gaW9zX2Jhc2U6Om9jdCkKIHsKCiAgIGRvCiAgICAgewogICAgICAgKi0tX19idWYg
PSBfX2xpdFsoX192ICYgMHg3KSArIF9fbnVtX2Jhc2U6Ol9TX29kaWdpdHNdOwogICAgICAgX192
ID4+PSAzOwogICAgIH0KICAgd2hpbGUgKF9fdiAhPSAwKTsKIH0KICAgICAgZWxzZQogewoKICAg
Y29uc3QgYm9vbCBfX3VwcGVyY2FzZSA9IF9fZmxhZ3MgJiBpb3NfYmFzZTo6dXBwZXJjYXNlOwog
ICBjb25zdCBpbnQgX19jYXNlX29mZnNldCA9IF9fdXBwZXJjYXNlID8gX19udW1fYmFzZTo6X1Nf
b3VkaWdpdHMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IF9fbnVt
X2Jhc2U6Ol9TX29kaWdpdHM7CiAgIGRvCiAgICAgewogICAgICAgKi0tX19idWYgPSBfX2xpdFso
X192ICYgMHhmKSArIF9fY2FzZV9vZmZzZXRdOwogICAgICAgX192ID4+PSA0OwogICAgIH0KICAg
d2hpbGUgKF9fdiAhPSAwKTsKIH0KICAgICAgcmV0dXJuIF9fYnVmZW5kIC0gX19idWY7CiAgICB9
CgpuYW1lc3BhY2UgX19nbnVfY3h4X2xkYmwxMjggewoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hh
clQsIHR5cGVuYW1lIF9PdXRJdGVyPgogICAgdm9pZAogICAgbnVtX3B1dDxfQ2hhclQsIF9PdXRJ
dGVyPjo6CiAgICBfTV9ncm91cF9pbnQoY29uc3QgY2hhciogX19ncm91cGluZywgc2l6ZV90IF9f
Z3JvdXBpbmdfc2l6ZSwgX0NoYXJUIF9fc2VwLAogICBpb3NfYmFzZSYsIF9DaGFyVCogX19uZXcs
IF9DaGFyVCogX19jcywgaW50JiBfX2xlbikgY29uc3QKICAgIHsKICAgICAgX0NoYXJUKiBfX3Ag
PSBzdGQ6Ol9fYWRkX2dyb3VwaW5nKF9fbmV3LCBfX3NlcCwgX19ncm91cGluZywKICAgICBfX2dy
b3VwaW5nX3NpemUsIF9fY3MsIF9fY3MgKyBfX2xlbik7CiAgICAgIF9fbGVuID0gX19wIC0gX19u
ZXc7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX091dEl0ZXI+
CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVmFsdWVUPgogICAgICBfT3V0SXRlcgogICAgICBudW1f
cHV0PF9DaGFyVCwgX091dEl0ZXI+OjoKICAgICAgX01faW5zZXJ0X2ludChfT3V0SXRlciBfX3Ms
IGlvc19iYXNlJiBfX2lvLCBfQ2hhclQgX19maWxsLAogICAgICBfVmFsdWVUIF9fdikgY29uc3QK
ICAgICAgewogdXNpbmcgX19nbnVfY3h4OjpfX2FkZF91bnNpZ25lZDsKIHR5cGVkZWYgdHlwZW5h
bWUgX19hZGRfdW5zaWduZWQ8X1ZhbHVlVD46Ol9fdHlwZSBfX3Vuc2lnbmVkX3R5cGU7CiB0eXBl
ZGVmIF9fbnVtcHVuY3RfY2FjaGU8X0NoYXJUPiBfX2NhY2hlX3R5cGU7CiBfX3VzZV9jYWNoZTxf
X2NhY2hlX3R5cGU+IF9fdWM7CiBjb25zdCBsb2NhbGUmIF9fbG9jID0gX19pby5fTV9nZXRsb2Mo
KTsKIGNvbnN0IF9fY2FjaGVfdHlwZSogX19sYyA9IF9fdWMoX19sb2MpOwogY29uc3QgX0NoYXJU
KiBfX2xpdCA9IF9fbGMtPl9NX2F0b21zX291dDsKIGNvbnN0IGlvc19iYXNlOjpmbXRmbGFncyBf
X2ZsYWdzID0gX19pby5mbGFncygpOwoKCiBjb25zdCBpbnQgX19pbGVuID0gNSAqIHNpemVvZihf
VmFsdWVUKTsKIF9DaGFyVCogX19jcyA9IHN0YXRpY19jYXN0PF9DaGFyVCo+KF9fYnVpbHRpbl9h
bGxvY2Eoc2l6ZW9mKF9DaGFyVCkKICAgICAgICAgICAgKiBfX2lsZW4pKTsKCgoKIGNvbnN0IGlv
c19iYXNlOjpmbXRmbGFncyBfX2Jhc2VmaWVsZCA9IF9fZmxhZ3MgJiBpb3NfYmFzZTo6YmFzZWZp
ZWxkOwogY29uc3QgYm9vbCBfX2RlYyA9IChfX2Jhc2VmaWVsZCAhPSBpb3NfYmFzZTo6b2N0CiAg
ICAgICAmJiBfX2Jhc2VmaWVsZCAhPSBpb3NfYmFzZTo6aGV4KTsKIGNvbnN0IF9fdW5zaWduZWRf
dHlwZSBfX3UgPSAoKF9fdiA+IDAgfHwgIV9fZGVjKQogICAgICAgICA/IF9fdW5zaWduZWRfdHlw
ZShfX3YpCiAgICAgICAgIDogLV9fdW5zaWduZWRfdHlwZShfX3YpKTsKICBpbnQgX19sZW4gPSBf
X2ludF90b19jaGFyKF9fY3MgKyBfX2lsZW4sIF9fdSwgX19saXQsIF9fZmxhZ3MsIF9fZGVjKTsK
IF9fY3MgKz0gX19pbGVuIC0gX19sZW47CgoKIGlmIChfX2xjLT5fTV91c2VfZ3JvdXBpbmcpCiAg
IHsKCgogICAgIF9DaGFyVCogX19jczIgPSBzdGF0aWNfY2FzdDxfQ2hhclQqPihfX2J1aWx0aW5f
YWxsb2NhKHNpemVvZihfQ2hhclQpCiAgICAgICAgICAqIChfX2xlbiArIDEpCiAgICAgICAgICAq
IDIpKTsKICAgICBfTV9ncm91cF9pbnQoX19sYy0+X01fZ3JvdXBpbmcsIF9fbGMtPl9NX2dyb3Vw
aW5nX3NpemUsCiAgICBfX2xjLT5fTV90aG91c2FuZHNfc2VwLCBfX2lvLCBfX2NzMiArIDIsIF9f
Y3MsIF9fbGVuKTsKICAgICBfX2NzID0gX19jczIgKyAyOwogICB9CgoKIGlmIChfX2J1aWx0aW5f
ZXhwZWN0KF9fZGVjLCB0cnVlKSkKICAgewoKICAgICBpZiAoX192ID49IDApCiAgICAgICB7CiAg
aWYgKGJvb2woX19mbGFncyAmIGlvc19iYXNlOjpzaG93cG9zKQogICAgICAmJiBfX2dudV9jeHg6
Ol9fbnVtZXJpY190cmFpdHM8X1ZhbHVlVD46Ol9faXNfc2lnbmVkKQogICAgKi0tX19jcyA9IF9f
bGl0W19fbnVtX2Jhc2U6Ol9TX29wbHVzXSwgKytfX2xlbjsKICAgICAgIH0KICAgICBlbHNlCiAg
ICAgICAqLS1fX2NzID0gX19saXRbX19udW1fYmFzZTo6X1Nfb21pbnVzXSwgKytfX2xlbjsKICAg
fQogZWxzZSBpZiAoYm9vbChfX2ZsYWdzICYgaW9zX2Jhc2U6OnNob3diYXNlKSAmJiBfX3YpCiAg
IHsKICAgICBpZiAoX19iYXNlZmllbGQgPT0gaW9zX2Jhc2U6Om9jdCkKICAgICAgICotLV9fY3Mg
PSBfX2xpdFtfX251bV9iYXNlOjpfU19vZGlnaXRzXSwgKytfX2xlbjsKICAgICBlbHNlCiAgICAg
ICB7CgogIGNvbnN0IGJvb2wgX191cHBlcmNhc2UgPSBfX2ZsYWdzICYgaW9zX2Jhc2U6OnVwcGVy
Y2FzZTsKICAqLS1fX2NzID0gX19saXRbX19udW1fYmFzZTo6X1Nfb3ggKyBfX3VwcGVyY2FzZV07
CgogICotLV9fY3MgPSBfX2xpdFtfX251bV9iYXNlOjpfU19vZGlnaXRzXTsKICBfX2xlbiArPSAy
OwogICAgICAgfQogICB9CgoKIGNvbnN0IHN0cmVhbXNpemUgX193ID0gX19pby53aWR0aCgpOwog
aWYgKF9fdyA+IHN0YXRpY19jYXN0PHN0cmVhbXNpemU+KF9fbGVuKSkKICAgewogICAgIF9DaGFy
VCogX19jczMgPSBzdGF0aWNfY2FzdDxfQ2hhclQqPihfX2J1aWx0aW5fYWxsb2NhKHNpemVvZihf
Q2hhclQpCiAgICAgICAgICAqIF9fdykpOwogICAgIF9NX3BhZChfX2ZpbGwsIF9fdywgX19pbywg
X19jczMsIF9fY3MsIF9fbGVuKTsKICAgICBfX2NzID0gX19jczM7CiAgIH0KIF9faW8ud2lkdGgo
MCk7CgoKCiByZXR1cm4gc3RkOjpfX3dyaXRlKF9fcywgX19jcywgX19sZW4pOwogICAgICB9Cgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX091dEl0ZXI+CiAgICB2b2lkCiAg
ICBudW1fcHV0PF9DaGFyVCwgX091dEl0ZXI+OjoKICAgIF9NX2dyb3VwX2Zsb2F0KGNvbnN0IGNo
YXIqIF9fZ3JvdXBpbmcsIHNpemVfdCBfX2dyb3VwaW5nX3NpemUsCiAgICAgX0NoYXJUIF9fc2Vw
LCBjb25zdCBfQ2hhclQqIF9fcCwgX0NoYXJUKiBfX25ldywKICAgICBfQ2hhclQqIF9fY3MsIGlu
dCYgX19sZW4pIGNvbnN0CiAgICB7CgoKCiAgICAgIGNvbnN0IGludCBfX2RlY2xlbiA9IF9fcCA/
IF9fcCAtIF9fY3MgOiBfX2xlbjsKICAgICAgX0NoYXJUKiBfX3AyID0gc3RkOjpfX2FkZF9ncm91
cGluZyhfX25ldywgX19zZXAsIF9fZ3JvdXBpbmcsCiAgICAgIF9fZ3JvdXBpbmdfc2l6ZSwKICAg
ICAgX19jcywgX19jcyArIF9fZGVjbGVuKTsKCgogICAgICBpbnQgX19uZXdsZW4gPSBfX3AyIC0g
X19uZXc7CiAgICAgIGlmIChfX3ApCiB7CiAgIGNoYXJfdHJhaXRzPF9DaGFyVD46OmNvcHkoX19w
MiwgX19wLCBfX2xlbiAtIF9fZGVjbGVuKTsKICAgX19uZXdsZW4gKz0gX19sZW4gLSBfX2RlY2xl
bjsKIH0KICAgICAgX19sZW4gPSBfX25ld2xlbjsKICAgIH0KIyA5NzEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9sb2NhbGVfZmFjZXRzLnRjYyIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9D
aGFyVCwgdHlwZW5hbWUgX091dEl0ZXI+CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVmFsdWVUPgog
ICAgICBfT3V0SXRlcgogICAgICBudW1fcHV0PF9DaGFyVCwgX091dEl0ZXI+OjoKICAgICAgX01f
aW5zZXJ0X2Zsb2F0KF9PdXRJdGVyIF9fcywgaW9zX2Jhc2UmIF9faW8sIF9DaGFyVCBfX2ZpbGws
IGNoYXIgX19tb2QsCiAgICAgICAgIF9WYWx1ZVQgX192KSBjb25zdAogICAgICB7CiB0eXBlZGVm
IF9fbnVtcHVuY3RfY2FjaGU8X0NoYXJUPiBfX2NhY2hlX3R5cGU7CiBfX3VzZV9jYWNoZTxfX2Nh
Y2hlX3R5cGU+IF9fdWM7CiBjb25zdCBsb2NhbGUmIF9fbG9jID0gX19pby5fTV9nZXRsb2MoKTsK
IGNvbnN0IF9fY2FjaGVfdHlwZSogX19sYyA9IF9fdWMoX19sb2MpOwoKCiBjb25zdCBzdHJlYW1z
aXplIF9fcHJlYyA9IF9faW8ucHJlY2lzaW9uKCkgPCAwID8gNiA6IF9faW8ucHJlY2lzaW9uKCk7
CgogY29uc3QgaW50IF9fbWF4X2RpZ2l0cyA9CiAgIF9fZ251X2N4eDo6X19udW1lcmljX3RyYWl0
czxfVmFsdWVUPjo6X19kaWdpdHMxMDsKCgogaW50IF9fbGVuOwoKIGNoYXIgX19mYnVmWzE2XTsK
IF9fbnVtX2Jhc2U6Ol9TX2Zvcm1hdF9mbG9hdChfX2lvLCBfX2ZidWYsIF9fbW9kKTsKCgoKIGNv
bnN0IGJvb2wgX191c2VfcHJlYyA9CiAgIChfX2lvLmZsYWdzKCkgJiBpb3NfYmFzZTo6ZmxvYXRm
aWVsZCkgIT0gaW9zX2Jhc2U6OmZsb2F0ZmllbGQ7CgoKCiBpbnQgX19jc19zaXplID0gX19tYXhf
ZGlnaXRzICogMzsKIGNoYXIqIF9fY3MgPSBzdGF0aWNfY2FzdDxjaGFyKj4oX19idWlsdGluX2Fs
bG9jYShfX2NzX3NpemUpKTsKIGlmIChfX3VzZV9wcmVjKQogICBfX2xlbiA9IHN0ZDo6X19jb252
ZXJ0X2Zyb21fdihfU19nZXRfY19sb2NhbGUoKSwgX19jcywgX19jc19zaXplLAogICAgIF9fZmJ1
ZiwgX19wcmVjLCBfX3YpOwogZWxzZQogICBfX2xlbiA9IHN0ZDo6X19jb252ZXJ0X2Zyb21fdihf
U19nZXRfY19sb2NhbGUoKSwgX19jcywgX19jc19zaXplLAogICAgIF9fZmJ1ZiwgX192KTsKCgog
aWYgKF9fbGVuID49IF9fY3Nfc2l6ZSkKICAgewogICAgIF9fY3Nfc2l6ZSA9IF9fbGVuICsgMTsK
ICAgICBfX2NzID0gc3RhdGljX2Nhc3Q8Y2hhcio+KF9fYnVpbHRpbl9hbGxvY2EoX19jc19zaXpl
KSk7CiAgICAgaWYgKF9fdXNlX3ByZWMpCiAgICAgICBfX2xlbiA9IHN0ZDo6X19jb252ZXJ0X2Zy
b21fdihfU19nZXRfY19sb2NhbGUoKSwgX19jcywgX19jc19zaXplLAogICAgICAgICBfX2ZidWYs
IF9fcHJlYywgX192KTsKICAgICBlbHNlCiAgICAgICBfX2xlbiA9IHN0ZDo6X19jb252ZXJ0X2Zy
b21fdihfU19nZXRfY19sb2NhbGUoKSwgX19jcywgX19jc19zaXplLAogICAgICAgICBfX2ZidWYs
IF9fdik7CiAgIH0KIyAxMDQ0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvbG9jYWxlX2Zh
Y2V0cy50Y2MiIDMKIGNvbnN0IGN0eXBlPF9DaGFyVD4mIF9fY3R5cGUgPSB1c2VfZmFjZXQ8Y3R5
cGU8X0NoYXJUPiA+KF9fbG9jKTsKCiBfQ2hhclQqIF9fd3MgPSBzdGF0aWNfY2FzdDxfQ2hhclQq
PihfX2J1aWx0aW5fYWxsb2NhKHNpemVvZihfQ2hhclQpCiAgICAgICAgICAgICogX19sZW4pKTsK
IF9fY3R5cGUud2lkZW4oX19jcywgX19jcyArIF9fbGVuLCBfX3dzKTsKCgogX0NoYXJUKiBfX3dw
ID0gMDsKIGNvbnN0IGNoYXIqIF9fcCA9IGNoYXJfdHJhaXRzPGNoYXI+OjpmaW5kKF9fY3MsIF9f
bGVuLCAnLicpOwogaWYgKF9fcCkKICAgewogICAgIF9fd3AgPSBfX3dzICsgKF9fcCAtIF9fY3Mp
OwogICAgICpfX3dwID0gX19sYy0+X01fZGVjaW1hbF9wb2ludDsKICAgfQoKCgoKIGlmIChfX2xj
LT5fTV91c2VfZ3JvdXBpbmcKICAgICAmJiAoX193cCB8fCBfX2xlbiA8IDMgfHwgKF9fY3NbMV0g
PD0gJzknICYmIF9fY3NbMl0gPD0gJzknCiAgICAgICAgICAmJiBfX2NzWzFdID49ICcwJyAmJiBf
X2NzWzJdID49ICcwJykpKQogICB7CgoKICAgICBfQ2hhclQqIF9fd3MyID0gc3RhdGljX2Nhc3Q8
X0NoYXJUKj4oX19idWlsdGluX2FsbG9jYShzaXplb2YoX0NoYXJUKQogICAgICAgICAgKiBfX2xl
biAqIDIpKTsKCiAgICAgc3RyZWFtc2l6ZSBfX29mZiA9IDA7CiAgICAgaWYgKF9fY3NbMF0gPT0g
Jy0nIHx8IF9fY3NbMF0gPT0gJysnKQogICAgICAgewogIF9fb2ZmID0gMTsKICBfX3dzMlswXSA9
IF9fd3NbMF07CiAgX19sZW4gLT0gMTsKICAgICAgIH0KCiAgICAgX01fZ3JvdXBfZmxvYXQoX19s
Yy0+X01fZ3JvdXBpbmcsIF9fbGMtPl9NX2dyb3VwaW5nX3NpemUsCiAgICAgIF9fbGMtPl9NX3Ro
b3VzYW5kc19zZXAsIF9fd3AsIF9fd3MyICsgX19vZmYsCiAgICAgIF9fd3MgKyBfX29mZiwgX19s
ZW4pOwogICAgIF9fbGVuICs9IF9fb2ZmOwoKICAgICBfX3dzID0gX193czI7CiAgIH0KCgogY29u
c3Qgc3RyZWFtc2l6ZSBfX3cgPSBfX2lvLndpZHRoKCk7CiBpZiAoX193ID4gc3RhdGljX2Nhc3Q8
c3RyZWFtc2l6ZT4oX19sZW4pKQogICB7CiAgICAgX0NoYXJUKiBfX3dzMyA9IHN0YXRpY19jYXN0
PF9DaGFyVCo+KF9fYnVpbHRpbl9hbGxvY2Eoc2l6ZW9mKF9DaGFyVCkKICAgICAgICAgICogX193
KSk7CiAgICAgX01fcGFkKF9fZmlsbCwgX193LCBfX2lvLCBfX3dzMywgX193cywgX19sZW4pOwog
ICAgIF9fd3MgPSBfX3dzMzsKICAgfQogX19pby53aWR0aCgwKTsKCgoKIHJldHVybiBzdGQ6Ol9f
d3JpdGUoX19zLCBfX3dzLCBfX2xlbik7CiAgICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0No
YXJULCB0eXBlbmFtZSBfT3V0SXRlcj4KICAgIF9PdXRJdGVyCiAgICBudW1fcHV0PF9DaGFyVCwg
X091dEl0ZXI+OjoKICAgIGRvX3B1dChpdGVyX3R5cGUgX19zLCBpb3NfYmFzZSYgX19pbywgY2hh
cl90eXBlIF9fZmlsbCwgYm9vbCBfX3YpIGNvbnN0CiAgICB7CiAgICAgIGNvbnN0IGlvc19iYXNl
OjpmbXRmbGFncyBfX2ZsYWdzID0gX19pby5mbGFncygpOwogICAgICBpZiAoKF9fZmxhZ3MgJiBp
b3NfYmFzZTo6Ym9vbGFscGhhKSA9PSAwKQogICAgICAgIHsKICAgICAgICAgIGNvbnN0IGxvbmcg
X19sID0gX192OwogICAgICAgICAgX19zID0gX01faW5zZXJ0X2ludChfX3MsIF9faW8sIF9fZmls
bCwgX19sKTsKICAgICAgICB9CiAgICAgIGVsc2UKICAgICAgICB7CiAgIHR5cGVkZWYgX19udW1w
dW5jdF9jYWNoZTxfQ2hhclQ+IF9fY2FjaGVfdHlwZTsKICAgX191c2VfY2FjaGU8X19jYWNoZV90
eXBlPiBfX3VjOwogICBjb25zdCBsb2NhbGUmIF9fbG9jID0gX19pby5fTV9nZXRsb2MoKTsKICAg
Y29uc3QgX19jYWNoZV90eXBlKiBfX2xjID0gX191YyhfX2xvYyk7CgogICBjb25zdCBfQ2hhclQq
IF9fbmFtZSA9IF9fdiA/IF9fbGMtPl9NX3RydWVuYW1lCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIDogX19sYy0+X01fZmFsc2VuYW1lOwogICBpbnQgX19sZW4gPSBfX3YgPyBfX2xjLT5f
TV90cnVlbmFtZV9zaXplCiAgICAgICAgICAgICAgICAgICA6IF9fbGMtPl9NX2ZhbHNlbmFtZV9z
aXplOwoKICAgY29uc3Qgc3RyZWFtc2l6ZSBfX3cgPSBfX2lvLndpZHRoKCk7CiAgIGlmIChfX3cg
PiBzdGF0aWNfY2FzdDxzdHJlYW1zaXplPihfX2xlbikpCiAgICAgewogICAgICAgY29uc3Qgc3Ry
ZWFtc2l6ZSBfX3BsZW4gPSBfX3cgLSBfX2xlbjsKICAgICAgIF9DaGFyVCogX19wcwogID0gc3Rh
dGljX2Nhc3Q8X0NoYXJUKj4oX19idWlsdGluX2FsbG9jYShzaXplb2YoX0NoYXJUKQogICAgICAg
KiBfX3BsZW4pKTsKCiAgICAgICBjaGFyX3RyYWl0czxfQ2hhclQ+Ojphc3NpZ24oX19wcywgX19w
bGVuLCBfX2ZpbGwpOwogICAgICAgX19pby53aWR0aCgwKTsKCiAgICAgICBpZiAoKF9fZmxhZ3Mg
JiBpb3NfYmFzZTo6YWRqdXN0ZmllbGQpID09IGlvc19iYXNlOjpsZWZ0KQogIHsKICAgIF9fcyA9
IHN0ZDo6X193cml0ZShfX3MsIF9fbmFtZSwgX19sZW4pOwogICAgX19zID0gc3RkOjpfX3dyaXRl
KF9fcywgX19wcywgX19wbGVuKTsKICB9CiAgICAgICBlbHNlCiAgewogICAgX19zID0gc3RkOjpf
X3dyaXRlKF9fcywgX19wcywgX19wbGVuKTsKICAgIF9fcyA9IHN0ZDo6X193cml0ZShfX3MsIF9f
bmFtZSwgX19sZW4pOwogIH0KICAgICAgIHJldHVybiBfX3M7CiAgICAgfQogICBfX2lvLndpZHRo
KDApOwogICBfX3MgPSBzdGQ6Ol9fd3JpdGUoX19zLCBfX25hbWUsIF9fbGVuKTsKIH0KICAgICAg
cmV0dXJuIF9fczsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBf
T3V0SXRlcj4KICAgIF9PdXRJdGVyCiAgICBudW1fcHV0PF9DaGFyVCwgX091dEl0ZXI+OjoKICAg
IGRvX3B1dChpdGVyX3R5cGUgX19zLCBpb3NfYmFzZSYgX19pbywgY2hhcl90eXBlIF9fZmlsbCwg
ZG91YmxlIF9fdikgY29uc3QKICAgIHsgcmV0dXJuIF9NX2luc2VydF9mbG9hdChfX3MsIF9faW8s
IF9fZmlsbCwgY2hhcigpLCBfX3YpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5
cGVuYW1lIF9PdXRJdGVyPgogICAgX091dEl0ZXIKICAgIG51bV9wdXQ8X0NoYXJULCBfT3V0SXRl
cj46OgogICAgX19kb19wdXQoaXRlcl90eXBlIF9fcywgaW9zX2Jhc2UmIF9faW8sIGNoYXJfdHlw
ZSBfX2ZpbGwsIGRvdWJsZSBfX3YpIGNvbnN0CiAgICB7IHJldHVybiBfTV9pbnNlcnRfZmxvYXQo
X19zLCBfX2lvLCBfX2ZpbGwsIGNoYXIoKSwgX192KTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0NoYXJULCB0eXBlbmFtZSBfT3V0SXRlcj4KICAgIF9PdXRJdGVyCiAgICBudW1fcHV0PF9DaGFy
VCwgX091dEl0ZXI+OjoKICAgIGRvX3B1dChpdGVyX3R5cGUgX19zLCBpb3NfYmFzZSYgX19pbywg
Y2hhcl90eXBlIF9fZmlsbCwKICAgIGxvbmcgZG91YmxlIF9fdikgY29uc3QKICAgIHsgcmV0dXJu
IF9NX2luc2VydF9mbG9hdChfX3MsIF9faW8sIF9fZmlsbCwgJ0wnLCBfX3YpOyB9CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX091dEl0ZXI+CiAgICBfT3V0SXRlcgogICAg
bnVtX3B1dDxfQ2hhclQsIF9PdXRJdGVyPjo6CiAgICBkb19wdXQoaXRlcl90eXBlIF9fcywgaW9z
X2Jhc2UmIF9faW8sIGNoYXJfdHlwZSBfX2ZpbGwsCiAgICAgICAgICAgY29uc3Qgdm9pZCogX192
KSBjb25zdAogICAgewogICAgICBjb25zdCBpb3NfYmFzZTo6Zm10ZmxhZ3MgX19mbGFncyA9IF9f
aW8uZmxhZ3MoKTsKICAgICAgY29uc3QgaW9zX2Jhc2U6OmZtdGZsYWdzIF9fZm10ID0gfihpb3Nf
YmFzZTo6YmFzZWZpZWxkCiAgICAgIHwgaW9zX2Jhc2U6OnVwcGVyY2FzZSk7CiAgICAgIF9faW8u
ZmxhZ3MoKF9fZmxhZ3MgJiBfX2ZtdCkgfCAoaW9zX2Jhc2U6OmhleCB8IGlvc19iYXNlOjpzaG93
YmFzZSkpOwoKICAgICAgdHlwZWRlZiBfX2dudV9jeHg6Ol9fY29uZGl0aW9uYWxfdHlwZTwoc2l6
ZW9mKGNvbnN0IHZvaWQqKQogICAgICAgICAgPD0gc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKSwKIHVu
c2lnbmVkIGxvbmcsIHVuc2lnbmVkIGxvbmcgbG9uZz46Ol9fdHlwZSBfVUludFB0clR5cGU7Cgog
ICAgICBfX3MgPSBfTV9pbnNlcnRfaW50KF9fcywgX19pbywgX19maWxsLAogICAgIHJlaW50ZXJw
cmV0X2Nhc3Q8X1VJbnRQdHJUeXBlPihfX3YpKTsKICAgICAgX19pby5mbGFncyhfX2ZsYWdzKTsK
ICAgICAgcmV0dXJuIF9fczsKICAgIH0KCn0KIyAxMjA2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvbG9jYWxlX2ZhY2V0cy50Y2MiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5
cGVuYW1lIF9UcmFpdHM+CiAgICB2b2lkCiAgICBfX3BhZDxfQ2hhclQsIF9UcmFpdHM+OjpfU19w
YWQoaW9zX2Jhc2UmIF9faW8sIF9DaGFyVCBfX2ZpbGwsCiAgICAgICBfQ2hhclQqIF9fbmV3cywg
Y29uc3QgX0NoYXJUKiBfX29sZHMsCiAgICAgICBzdHJlYW1zaXplIF9fbmV3bGVuLCBzdHJlYW1z
aXplIF9fb2xkbGVuKQogICAgewogICAgICBjb25zdCBzaXplX3QgX19wbGVuID0gc3RhdGljX2Nh
c3Q8c2l6ZV90PihfX25ld2xlbiAtIF9fb2xkbGVuKTsKICAgICAgY29uc3QgaW9zX2Jhc2U6OmZt
dGZsYWdzIF9fYWRqdXN0ID0gX19pby5mbGFncygpICYgaW9zX2Jhc2U6OmFkanVzdGZpZWxkOwoK
CiAgICAgIGlmIChfX2FkanVzdCA9PSBpb3NfYmFzZTo6bGVmdCkKIHsKICAgX1RyYWl0czo6Y29w
eShfX25ld3MsIF9fb2xkcywgX19vbGRsZW4pOwogICBfVHJhaXRzOjphc3NpZ24oX19uZXdzICsg
X19vbGRsZW4sIF9fcGxlbiwgX19maWxsKTsKICAgcmV0dXJuOwogfQoKICAgICAgc2l6ZV90IF9f
bW9kID0gMDsKICAgICAgaWYgKF9fYWRqdXN0ID09IGlvc19iYXNlOjppbnRlcm5hbCkKIHsKCgoK
ICAgICAgICAgIGNvbnN0IGxvY2FsZSYgX19sb2MgPSBfX2lvLl9NX2dldGxvYygpOwogICBjb25z
dCBjdHlwZTxfQ2hhclQ+JiBfX2N0eXBlID0gdXNlX2ZhY2V0PGN0eXBlPF9DaGFyVD4gPihfX2xv
Yyk7CgogICBpZiAoX19jdHlwZS53aWRlbignLScpID09IF9fb2xkc1swXQogICAgICAgfHwgX19j
dHlwZS53aWRlbignKycpID09IF9fb2xkc1swXSkKICAgICB7CiAgICAgICBfX25ld3NbMF0gPSBf
X29sZHNbMF07CiAgICAgICBfX21vZCA9IDE7CiAgICAgICArK19fbmV3czsKICAgICB9CiAgIGVs
c2UgaWYgKF9fY3R5cGUud2lkZW4oJzAnKSA9PSBfX29sZHNbMF0KICAgICAmJiBfX29sZGxlbiA+
IDEKICAgICAmJiAoX19jdHlwZS53aWRlbigneCcpID09IF9fb2xkc1sxXQogICAgICAgICB8fCBf
X2N0eXBlLndpZGVuKCdYJykgPT0gX19vbGRzWzFdKSkKICAgICB7CiAgICAgICBfX25ld3NbMF0g
PSBfX29sZHNbMF07CiAgICAgICBfX25ld3NbMV0gPSBfX29sZHNbMV07CiAgICAgICBfX21vZCA9
IDI7CiAgICAgICBfX25ld3MgKz0gMjsKICAgICB9CgogfQogICAgICBfVHJhaXRzOjphc3NpZ24o
X19uZXdzLCBfX3BsZW4sIF9fZmlsbCk7CiAgICAgIF9UcmFpdHM6OmNvcHkoX19uZXdzICsgX19w
bGVuLCBfX29sZHMgKyBfX21vZCwgX19vbGRsZW4gLSBfX21vZCk7CiAgICB9CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9DaGFyVD4KICAgIF9DaGFyVCoKICAgIF9fYWRkX2dyb3VwaW5nKF9DaGFyVCog
X19zLCBfQ2hhclQgX19zZXAsCiAgICAgY29uc3QgY2hhciogX19nYmVnLCBzaXplX3QgX19nc2l6
ZSwKICAgICBjb25zdCBfQ2hhclQqIF9fZmlyc3QsIGNvbnN0IF9DaGFyVCogX19sYXN0KQogICAg
ewogICAgICBzaXplX3QgX19pZHggPSAwOwogICAgICBzaXplX3QgX19jdHIgPSAwOwoKICAgICAg
d2hpbGUgKF9fbGFzdCAtIF9fZmlyc3QgPiBfX2diZWdbX19pZHhdCiAgICAgICYmIHN0YXRpY19j
YXN0PHNpZ25lZCBjaGFyPihfX2diZWdbX19pZHhdKSA+IDAKICAgICAgJiYgX19nYmVnW19faWR4
XSAhPSBfX2dudV9jeHg6Ol9fbnVtZXJpY190cmFpdHM8Y2hhcj46Ol9fbWF4KQogewogICBfX2xh
c3QgLT0gX19nYmVnW19faWR4XTsKICAgX19pZHggPCBfX2dzaXplIC0gMSA/ICsrX19pZHggOiAr
K19fY3RyOwogfQoKICAgICAgd2hpbGUgKF9fZmlyc3QgIT0gX19sYXN0KQogKl9fcysrID0gKl9f
Zmlyc3QrKzsKCiAgICAgIHdoaWxlIChfX2N0ci0tKQogewogICAqX19zKysgPSBfX3NlcDsKICAg
Zm9yIChjaGFyIF9faSA9IF9fZ2JlZ1tfX2lkeF07IF9faSA+IDA7IC0tX19pKQogICAgICpfX3Mr
KyA9ICpfX2ZpcnN0Kys7CiB9CgogICAgICB3aGlsZSAoX19pZHgtLSkKIHsKICAgKl9fcysrID0g
X19zZXA7CiAgIGZvciAoY2hhciBfX2kgPSBfX2diZWdbX19pZHhdOyBfX2kgPiAwOyAtLV9faSkK
ICAgICAqX19zKysgPSAqX19maXJzdCsrOwogfQoKICAgICAgcmV0dXJuIF9fczsKICAgIH0KCgoK
CiAgZXh0ZXJuIHRlbXBsYXRlIGNsYXNzIF9fY3h4MTE6OiBudW1wdW5jdDxjaGFyPjsKICBleHRl
cm4gdGVtcGxhdGUgY2xhc3MgX19jeHgxMTo6IG51bXB1bmN0X2J5bmFtZTxjaGFyPjsKICBleHRl
cm4gdGVtcGxhdGUgY2xhc3MgX19nbnVfY3h4X2xkYmwxMjg6OiBudW1fZ2V0PGNoYXI+OwogIGV4
dGVybiB0ZW1wbGF0ZSBjbGFzcyBfX2dudV9jeHhfbGRibDEyODo6IG51bV9wdXQ8Y2hhcj47CiAg
ZXh0ZXJuIHRlbXBsYXRlIGNsYXNzIGN0eXBlX2J5bmFtZTxjaGFyPjsKCiAgZXh0ZXJuIHRlbXBs
YXRlCiAgICBjb25zdCBjdHlwZTxjaGFyPiYKICAgIHVzZV9mYWNldDxjdHlwZTxjaGFyPiA+KGNv
bnN0IGxvY2FsZSYpOwoKICBleHRlcm4gdGVtcGxhdGUKICAgIGNvbnN0IG51bXB1bmN0PGNoYXI+
JgogICAgdXNlX2ZhY2V0PG51bXB1bmN0PGNoYXI+ID4oY29uc3QgbG9jYWxlJik7CgogIGV4dGVy
biB0ZW1wbGF0ZQogICAgY29uc3QgbnVtX3B1dDxjaGFyPiYKICAgIHVzZV9mYWNldDxudW1fcHV0
PGNoYXI+ID4oY29uc3QgbG9jYWxlJik7CgogIGV4dGVybiB0ZW1wbGF0ZQogICAgY29uc3QgbnVt
X2dldDxjaGFyPiYKICAgIHVzZV9mYWNldDxudW1fZ2V0PGNoYXI+ID4oY29uc3QgbG9jYWxlJik7
CgogIGV4dGVybiB0ZW1wbGF0ZQogICAgYm9vbAogICAgaGFzX2ZhY2V0PGN0eXBlPGNoYXI+ID4o
Y29uc3QgbG9jYWxlJik7CgogIGV4dGVybiB0ZW1wbGF0ZQogICAgYm9vbAogICAgaGFzX2ZhY2V0
PG51bXB1bmN0PGNoYXI+ID4oY29uc3QgbG9jYWxlJik7CgogIGV4dGVybiB0ZW1wbGF0ZQogICAg
Ym9vbAogICAgaGFzX2ZhY2V0PG51bV9wdXQ8Y2hhcj4gPihjb25zdCBsb2NhbGUmKTsKCiAgZXh0
ZXJuIHRlbXBsYXRlCiAgICBib29sCiAgICBoYXNfZmFjZXQ8bnVtX2dldDxjaGFyPiA+KGNvbnN0
IGxvY2FsZSYpOwoKCiAgZXh0ZXJuIHRlbXBsYXRlIGNsYXNzIF9fY3h4MTE6OiBudW1wdW5jdDx3
Y2hhcl90PjsKICBleHRlcm4gdGVtcGxhdGUgY2xhc3MgX19jeHgxMTo6IG51bXB1bmN0X2J5bmFt
ZTx3Y2hhcl90PjsKICBleHRlcm4gdGVtcGxhdGUgY2xhc3MgX19nbnVfY3h4X2xkYmwxMjg6OiBu
dW1fZ2V0PHdjaGFyX3Q+OwogIGV4dGVybiB0ZW1wbGF0ZSBjbGFzcyBfX2dudV9jeHhfbGRibDEy
ODo6IG51bV9wdXQ8d2NoYXJfdD47CiAgZXh0ZXJuIHRlbXBsYXRlIGNsYXNzIGN0eXBlX2J5bmFt
ZTx3Y2hhcl90PjsKCiAgZXh0ZXJuIHRlbXBsYXRlCiAgICBjb25zdCBjdHlwZTx3Y2hhcl90PiYK
ICAgIHVzZV9mYWNldDxjdHlwZTx3Y2hhcl90PiA+KGNvbnN0IGxvY2FsZSYpOwoKICBleHRlcm4g
dGVtcGxhdGUKICAgIGNvbnN0IG51bXB1bmN0PHdjaGFyX3Q+JgogICAgdXNlX2ZhY2V0PG51bXB1
bmN0PHdjaGFyX3Q+ID4oY29uc3QgbG9jYWxlJik7CgogIGV4dGVybiB0ZW1wbGF0ZQogICAgY29u
c3QgbnVtX3B1dDx3Y2hhcl90PiYKICAgIHVzZV9mYWNldDxudW1fcHV0PHdjaGFyX3Q+ID4oY29u
c3QgbG9jYWxlJik7CgogIGV4dGVybiB0ZW1wbGF0ZQogICAgY29uc3QgbnVtX2dldDx3Y2hhcl90
PiYKICAgIHVzZV9mYWNldDxudW1fZ2V0PHdjaGFyX3Q+ID4oY29uc3QgbG9jYWxlJik7CgogZXh0
ZXJuIHRlbXBsYXRlCiAgICBib29sCiAgICBoYXNfZmFjZXQ8Y3R5cGU8d2NoYXJfdD4gPihjb25z
dCBsb2NhbGUmKTsKCiAgZXh0ZXJuIHRlbXBsYXRlCiAgICBib29sCiAgICBoYXNfZmFjZXQ8bnVt
cHVuY3Q8d2NoYXJfdD4gPihjb25zdCBsb2NhbGUmKTsKCiAgZXh0ZXJuIHRlbXBsYXRlCiAgICBi
b29sCiAgICBoYXNfZmFjZXQ8bnVtX3B1dDx3Y2hhcl90PiA+KGNvbnN0IGxvY2FsZSYpOwoKICBl
eHRlcm4gdGVtcGxhdGUKICAgIGJvb2wKICAgIGhhc19mYWNldDxudW1fZ2V0PHdjaGFyX3Q+ID4o
Y29uc3QgbG9jYWxlJik7CgoKCgp9CiMgMjY1MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L2xvY2FsZV9mYWNldHMuaCIgMiAzCiMgMzggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9i
YXNpY19pb3MuaCIgMiAzCgoKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJp
bGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZhY2V0PgogICAg
aW5saW5lIGNvbnN0IF9GYWNldCYKICAgIF9fY2hlY2tfZmFjZXQoY29uc3QgX0ZhY2V0KiBfX2Yp
CiAgICB7CiAgICAgIGlmICghX19mKQogX190aHJvd19iYWRfY2FzdCgpOwogICAgICByZXR1cm4g
Kl9fZjsKICAgIH0KIyA2NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX2lvcy5o
IiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgY2xh
c3MgYmFzaWNfaW9zIDogcHVibGljIGlvc19iYXNlCiAgICB7CiAgICBwdWJsaWM6CgoKCgoKCiAg
ICAgIHR5cGVkZWYgX0NoYXJUIGNoYXJfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfVHJh
aXRzOjppbnRfdHlwZSBpbnRfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfVHJhaXRzOjpw
b3NfdHlwZSBwb3NfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfVHJhaXRzOjpvZmZfdHlw
ZSBvZmZfdHlwZTsKICAgICAgdHlwZWRlZiBfVHJhaXRzIHRyYWl0c190eXBlOwoKCgoKCgogICAg
ICB0eXBlZGVmIGN0eXBlPF9DaGFyVD4gX19jdHlwZV90eXBlOwogICAgICB0eXBlZGVmIG51bV9w
dXQ8X0NoYXJULCBvc3RyZWFtYnVmX2l0ZXJhdG9yPF9DaGFyVCwgX1RyYWl0cz4gPgogICAgICAg
ICAgIF9fbnVtX3B1dF90eXBlOwogICAgICB0eXBlZGVmIG51bV9nZXQ8X0NoYXJULCBpc3RyZWFt
YnVmX2l0ZXJhdG9yPF9DaGFyVCwgX1RyYWl0cz4gPgogICAgICAgICAgIF9fbnVtX2dldF90eXBl
OwoKCgogICAgcHJvdGVjdGVkOgogICAgICBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4q
IF9NX3RpZTsKICAgICAgbXV0YWJsZSBjaGFyX3R5cGUgX01fZmlsbDsKICAgICAgbXV0YWJsZSBi
b29sIF9NX2ZpbGxfaW5pdDsKICAgICAgYmFzaWNfc3RyZWFtYnVmPF9DaGFyVCwgX1RyYWl0cz4q
IF9NX3N0cmVhbWJ1ZjsKCgogICAgICBjb25zdCBfX2N0eXBlX3R5cGUqIF9NX2N0eXBlOwoKICAg
ICAgY29uc3QgX19udW1fcHV0X3R5cGUqIF9NX251bV9wdXQ7CgogICAgICBjb25zdCBfX251bV9n
ZXRfdHlwZSogX01fbnVtX2dldDsKCiAgICBwdWJsaWM6CiMgMTE3ICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvYmFzaWNfaW9zLmgiIDMKICAgICAgZXhwbGljaXQgb3BlcmF0b3IgYm9vbCgp
IGNvbnN0CiAgICAgIHsgcmV0dXJuICF0aGlzLT5mYWlsKCk7IH0KCgoKCgogICAgICBib29sCiAg
ICAgIG9wZXJhdG9yISgpIGNvbnN0CiAgICAgIHsgcmV0dXJuIHRoaXMtPmZhaWwoKTsgfQojIDEz
NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX2lvcy5oIiAzCiAgICAgIGlvc3Rh
dGUKICAgICAgcmRzdGF0ZSgpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX3N0cmVhbWJ1Zl9zdGF0
ZTsgfQojIDE0NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX2lvcy5oIiAzCiAg
ICAgIHZvaWQKICAgICAgY2xlYXIoaW9zdGF0ZSBfX3N0YXRlID0gZ29vZGJpdCk7CgoKCgoKCgog
ICAgICB2b2lkCiAgICAgIHNldHN0YXRlKGlvc3RhdGUgX19zdGF0ZSkKICAgICAgeyB0aGlzLT5j
bGVhcih0aGlzLT5yZHN0YXRlKCkgfCBfX3N0YXRlKTsgfQoKCgoKICAgICAgdm9pZAogICAgICBf
TV9zZXRzdGF0ZShpb3N0YXRlIF9fc3RhdGUpCiAgICAgIHsKCgogX01fc3RyZWFtYnVmX3N0YXRl
IHw9IF9fc3RhdGU7CiBpZiAodGhpcy0+ZXhjZXB0aW9ucygpICYgX19zdGF0ZSkKICAgdGhyb3c7
CiAgICAgIH0KCgoKCgoKCiAgICAgIGJvb2wKICAgICAgZ29vZCgpIGNvbnN0CiAgICAgIHsgcmV0
dXJuIHRoaXMtPnJkc3RhdGUoKSA9PSAwOyB9CgoKCgoKCgogICAgICBib29sCiAgICAgIGVvZigp
IGNvbnN0CiAgICAgIHsgcmV0dXJuICh0aGlzLT5yZHN0YXRlKCkgJiBlb2ZiaXQpICE9IDA7IH0K
IyAyMDAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19pb3MuaCIgMwogICAgICBi
b29sCiAgICAgIGZhaWwoKSBjb25zdAogICAgICB7IHJldHVybiAodGhpcy0+cmRzdGF0ZSgpICYg
KGJhZGJpdCB8IGZhaWxiaXQpKSAhPSAwOyB9CgoKCgoKCgogICAgICBib29sCiAgICAgIGJhZCgp
IGNvbnN0CiAgICAgIHsgcmV0dXJuICh0aGlzLT5yZHN0YXRlKCkgJiBiYWRiaXQpICE9IDA7IH0K
IyAyMjEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19pb3MuaCIgMwogICAgICBp
b3N0YXRlCiAgICAgIGV4Y2VwdGlvbnMoKSBjb25zdAogICAgICB7IHJldHVybiBfTV9leGNlcHRp
b247IH0KIyAyNTYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19pb3MuaCIgMwog
ICAgICB2b2lkCiAgICAgIGV4Y2VwdGlvbnMoaW9zdGF0ZSBfX2V4Y2VwdCkKICAgICAgewogICAg
ICAgIF9NX2V4Y2VwdGlvbiA9IF9fZXhjZXB0OwogICAgICAgIHRoaXMtPmNsZWFyKF9NX3N0cmVh
bWJ1Zl9zdGF0ZSk7CiAgICAgIH0KCgoKCgoKCiAgICAgIGV4cGxpY2l0CiAgICAgIGJhc2ljX2lv
cyhiYXNpY19zdHJlYW1idWY8X0NoYXJULCBfVHJhaXRzPiogX19zYikKICAgICAgOiBpb3NfYmFz
ZSgpLCBfTV90aWUoMCksIF9NX2ZpbGwoKSwgX01fZmlsbF9pbml0KGZhbHNlKSwgX01fc3RyZWFt
YnVmKDApLAogX01fY3R5cGUoMCksIF9NX251bV9wdXQoMCksIF9NX251bV9nZXQoMCkKICAgICAg
eyB0aGlzLT5pbml0KF9fc2IpOyB9CgoKCgoKCgogICAgICB2aXJ0dWFsCiAgICAgIH5iYXNpY19p
b3MoKSB7IH0KIyAyOTQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19pb3MuaCIg
MwogICAgICBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4qCiAgICAgIHRpZSgpIGNvbnN0
CiAgICAgIHsgcmV0dXJuIF9NX3RpZTsgfQojIDMwNiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL2Jhc2ljX2lvcy5oIiAzCiAgICAgIGJhc2ljX29zdHJlYW08X0NoYXJULCBfVHJhaXRzPioK
ICAgICAgdGllKGJhc2ljX29zdHJlYW08X0NoYXJULCBfVHJhaXRzPiogX190aWVzdHIpCiAgICAg
IHsKICAgICAgICBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4qIF9fb2xkID0gX01fdGll
OwogICAgICAgIF9NX3RpZSA9IF9fdGllc3RyOwogICAgICAgIHJldHVybiBfX29sZDsKICAgICAg
fQoKCgoKCgoKICAgICAgYmFzaWNfc3RyZWFtYnVmPF9DaGFyVCwgX1RyYWl0cz4qCiAgICAgIHJk
YnVmKCkgY29uc3QKICAgICAgeyByZXR1cm4gX01fc3RyZWFtYnVmOyB9CiMgMzQ2ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfaW9zLmgiIDMKICAgICAgYmFzaWNfc3RyZWFtYnVm
PF9DaGFyVCwgX1RyYWl0cz4qCiAgICAgIHJkYnVmKGJhc2ljX3N0cmVhbWJ1ZjxfQ2hhclQsIF9U
cmFpdHM+KiBfX3NiKTsKIyAzNjAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19p
b3MuaCIgMwogICAgICBiYXNpY19pb3MmCiAgICAgIGNvcHlmbXQoY29uc3QgYmFzaWNfaW9zJiBf
X3Jocyk7CgoKCgoKCgogICAgICBjaGFyX3R5cGUKICAgICAgZmlsbCgpIGNvbnN0CiAgICAgIHsK
IGlmICghX01fZmlsbF9pbml0KQogICB7CiAgICAgX01fZmlsbCA9IHRoaXMtPndpZGVuKCcgJyk7
CiAgICAgX01fZmlsbF9pbml0ID0gdHJ1ZTsKICAgfQogcmV0dXJuIF9NX2ZpbGw7CiAgICAgIH0K
IyAzODkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19pb3MuaCIgMwogICAgICBj
aGFyX3R5cGUKICAgICAgZmlsbChjaGFyX3R5cGUgX19jaCkKICAgICAgewogY2hhcl90eXBlIF9f
b2xkID0gdGhpcy0+ZmlsbCgpOwogX01fZmlsbCA9IF9fY2g7CiByZXR1cm4gX19vbGQ7CiAgICAg
IH0KIyA0MDkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19pb3MuaCIgMwogICAg
ICBsb2NhbGUKICAgICAgaW1idWUoY29uc3QgbG9jYWxlJiBfX2xvYyk7CiMgNDI5ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfaW9zLmgiIDMKICAgICAgY2hhcgogICAgICBuYXJy
b3coY2hhcl90eXBlIF9fYywgY2hhciBfX2RmYXVsdCkgY29uc3QKICAgICAgeyByZXR1cm4gX19j
aGVja19mYWNldChfTV9jdHlwZSkubmFycm93KF9fYywgX19kZmF1bHQpOyB9CiMgNDQ4ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfaW9zLmgiIDMKICAgICAgY2hhcl90eXBlCiAg
ICAgIHdpZGVuKGNoYXIgX19jKSBjb25zdAogICAgICB7IHJldHVybiBfX2NoZWNrX2ZhY2V0KF9N
X2N0eXBlKS53aWRlbihfX2MpOyB9CgogICAgcHJvdGVjdGVkOgoKCgoKCgoKICAgICAgYmFzaWNf
aW9zKCkKICAgICAgOiBpb3NfYmFzZSgpLCBfTV90aWUoMCksIF9NX2ZpbGwoY2hhcl90eXBlKCkp
LCBfTV9maWxsX2luaXQoZmFsc2UpLAogX01fc3RyZWFtYnVmKDApLCBfTV9jdHlwZSgwKSwgX01f
bnVtX3B1dCgwKSwgX01fbnVtX2dldCgwKQogICAgICB7IH0KCgoKCgoKCiAgICAgIHZvaWQKICAg
ICAgaW5pdChiYXNpY19zdHJlYW1idWY8X0NoYXJULCBfVHJhaXRzPiogX19zYik7CgoKICAgICAg
YmFzaWNfaW9zKGNvbnN0IGJhc2ljX2lvcyYpID0gZGVsZXRlOwogICAgICBiYXNpY19pb3MmIG9w
ZXJhdG9yPShjb25zdCBiYXNpY19pb3MmKSA9IGRlbGV0ZTsKCiAgICAgIHZvaWQKICAgICAgbW92
ZShiYXNpY19pb3MmIF9fcmhzKQogICAgICB7CiBpb3NfYmFzZTo6X01fbW92ZShfX3Jocyk7CiBf
TV9jYWNoZV9sb2NhbGUoX01faW9zX2xvY2FsZSk7CiB0aGlzLT50aWUoX19yaHMudGllKG51bGxw
dHIpKTsKIF9NX2ZpbGwgPSBfX3Jocy5fTV9maWxsOwogX01fZmlsbF9pbml0ID0gX19yaHMuX01f
ZmlsbF9pbml0OwogX01fc3RyZWFtYnVmID0gbnVsbHB0cjsKICAgICAgfQoKICAgICAgdm9pZAog
ICAgICBtb3ZlKGJhc2ljX2lvcyYmIF9fcmhzKQogICAgICB7IHRoaXMtPm1vdmUoX19yaHMpOyB9
CgogICAgICB2b2lkCiAgICAgIHN3YXAoYmFzaWNfaW9zJiBfX3Jocykgbm9leGNlcHQKICAgICAg
ewogaW9zX2Jhc2U6Ol9NX3N3YXAoX19yaHMpOwogX01fY2FjaGVfbG9jYWxlKF9NX2lvc19sb2Nh
bGUpOwogX19yaHMuX01fY2FjaGVfbG9jYWxlKF9fcmhzLl9NX2lvc19sb2NhbGUpOwogc3RkOjpz
d2FwKF9NX3RpZSwgX19yaHMuX01fdGllKTsKIHN0ZDo6c3dhcChfTV9maWxsLCBfX3Jocy5fTV9m
aWxsKTsKIHN0ZDo6c3dhcChfTV9maWxsX2luaXQsIF9fcmhzLl9NX2ZpbGxfaW5pdCk7CiAgICAg
IH0KCiAgICAgIHZvaWQKICAgICAgc2V0X3JkYnVmKGJhc2ljX3N0cmVhbWJ1ZjxfQ2hhclQsIF9U
cmFpdHM+KiBfX3NiKQogICAgICB7IF9NX3N0cmVhbWJ1ZiA9IF9fc2I7IH0KCgogICAgICB2b2lk
CiAgICAgIF9NX2NhY2hlX2xvY2FsZShjb25zdCBsb2NhbGUmIF9fbG9jKTsKICAgIH07CgoKfQoK
IyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfaW9zLnRjYyIgMSAzCiMgMzMg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9iYXNpY19pb3MudGNjIiAzCiAgICAgICAKIyAz
NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2Jhc2ljX2lvcy50Y2MiIDMKCm5hbWVzcGFj
ZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgdm9pZAogICAg
YmFzaWNfaW9zPF9DaGFyVCwgX1RyYWl0cz46OmNsZWFyKGlvc3RhdGUgX19zdGF0ZSkKICAgIHsK
ICAgICAgaWYgKHRoaXMtPnJkYnVmKCkpCiBfTV9zdHJlYW1idWZfc3RhdGUgPSBfX3N0YXRlOwog
ICAgICBlbHNlCiAgIF9NX3N0cmVhbWJ1Zl9zdGF0ZSA9IF9fc3RhdGUgfCBiYWRiaXQ7CiAgICAg
IGlmICh0aGlzLT5leGNlcHRpb25zKCkgJiB0aGlzLT5yZHN0YXRlKCkpCiBfX3Rocm93X2lvc19m
YWlsdXJlKCgiYmFzaWNfaW9zOjpjbGVhciIpKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNfc3RyZWFtYnVmPF9DaGFyVCwgX1Ry
YWl0cz4qCiAgICBiYXNpY19pb3M8X0NoYXJULCBfVHJhaXRzPjo6cmRidWYoYmFzaWNfc3RyZWFt
YnVmPF9DaGFyVCwgX1RyYWl0cz4qIF9fc2IpCiAgICB7CiAgICAgIGJhc2ljX3N0cmVhbWJ1Zjxf
Q2hhclQsIF9UcmFpdHM+KiBfX29sZCA9IF9NX3N0cmVhbWJ1ZjsKICAgICAgX01fc3RyZWFtYnVm
ID0gX19zYjsKICAgICAgdGhpcy0+Y2xlYXIoKTsKICAgICAgcmV0dXJuIF9fb2xkOwogICAgfQoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBiYXNpY19p
b3M8X0NoYXJULCBfVHJhaXRzPiYKICAgIGJhc2ljX2lvczxfQ2hhclQsIF9UcmFpdHM+Ojpjb3B5
Zm10KGNvbnN0IGJhc2ljX2lvcyYgX19yaHMpCiAgICB7CgoKICAgICAgaWYgKHRoaXMgIT0gJl9f
cmhzKQogewoKCgoKICAgX1dvcmRzKiBfX3dvcmRzID0gKF9fcmhzLl9NX3dvcmRfc2l6ZSA8PSBf
U19sb2NhbF93b3JkX3NpemUpID8KICAgICAgICAgICAgICAgICAgICAgIF9NX2xvY2FsX3dvcmQg
OiBuZXcgX1dvcmRzW19fcmhzLl9NX3dvcmRfc2l6ZV07CgoKICAgX0NhbGxiYWNrX2xpc3QqIF9f
Y2IgPSBfX3Jocy5fTV9jYWxsYmFja3M7CiAgIGlmIChfX2NiKQogICAgIF9fY2ItPl9NX2FkZF9y
ZWZlcmVuY2UoKTsKICAgX01fY2FsbF9jYWxsYmFja3MoZXJhc2VfZXZlbnQpOwogICBpZiAoX01f
d29yZCAhPSBfTV9sb2NhbF93b3JkKQogICAgIHsKICAgICAgIGRlbGV0ZSBbXSBfTV93b3JkOwog
ICAgICAgX01fd29yZCA9IDA7CiAgICAgfQogICBfTV9kaXNwb3NlX2NhbGxiYWNrcygpOwoKCiAg
IF9NX2NhbGxiYWNrcyA9IF9fY2I7CiAgIGZvciAoaW50IF9faSA9IDA7IF9faSA8IF9fcmhzLl9N
X3dvcmRfc2l6ZTsgKytfX2kpCiAgICAgX193b3Jkc1tfX2ldID0gX19yaHMuX01fd29yZFtfX2ld
OwogICBfTV93b3JkID0gX193b3JkczsKICAgX01fd29yZF9zaXplID0gX19yaHMuX01fd29yZF9z
aXplOwoKICAgdGhpcy0+ZmxhZ3MoX19yaHMuZmxhZ3MoKSk7CiAgIHRoaXMtPndpZHRoKF9fcmhz
LndpZHRoKCkpOwogICB0aGlzLT5wcmVjaXNpb24oX19yaHMucHJlY2lzaW9uKCkpOwogICB0aGlz
LT50aWUoX19yaHMudGllKCkpOwogICB0aGlzLT5maWxsKF9fcmhzLmZpbGwoKSk7CiAgIF9NX2lv
c19sb2NhbGUgPSBfX3Jocy5nZXRsb2MoKTsKICAgX01fY2FjaGVfbG9jYWxlKF9NX2lvc19sb2Nh
bGUpOwoKICAgX01fY2FsbF9jYWxsYmFja3MoY29weWZtdF9ldmVudCk7CgoKICAgdGhpcy0+ZXhj
ZXB0aW9ucyhfX3Jocy5leGNlcHRpb25zKCkpOwogfQogICAgICByZXR1cm4gKnRoaXM7CiAgICB9
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBsb2Nh
bGUKICAgIGJhc2ljX2lvczxfQ2hhclQsIF9UcmFpdHM+OjppbWJ1ZShjb25zdCBsb2NhbGUmIF9f
bG9jKQogICAgewogICAgICBsb2NhbGUgX19vbGQodGhpcy0+Z2V0bG9jKCkpOwogICAgICBpb3Nf
YmFzZTo6aW1idWUoX19sb2MpOwogICAgICBfTV9jYWNoZV9sb2NhbGUoX19sb2MpOwogICAgICBp
ZiAodGhpcy0+cmRidWYoKSAhPSAwKQogdGhpcy0+cmRidWYoKS0+cHViaW1idWUoX19sb2MpOwog
ICAgICByZXR1cm4gX19vbGQ7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlw
ZW5hbWUgX1RyYWl0cz4KICAgIHZvaWQKICAgIGJhc2ljX2lvczxfQ2hhclQsIF9UcmFpdHM+Ojpp
bml0KGJhc2ljX3N0cmVhbWJ1ZjxfQ2hhclQsIF9UcmFpdHM+KiBfX3NiKQogICAgewoKICAgICAg
aW9zX2Jhc2U6Ol9NX2luaXQoKTsKCgogICAgICBfTV9jYWNoZV9sb2NhbGUoX01faW9zX2xvY2Fs
ZSk7CiMgMTQ2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfaW9zLnRjYyIgMwog
ICAgICBfTV9maWxsID0gX0NoYXJUKCk7CiAgICAgIF9NX2ZpbGxfaW5pdCA9IGZhbHNlOwoKICAg
ICAgX01fdGllID0gMDsKICAgICAgX01fZXhjZXB0aW9uID0gZ29vZGJpdDsKICAgICAgX01fc3Ry
ZWFtYnVmID0gX19zYjsKICAgICAgX01fc3RyZWFtYnVmX3N0YXRlID0gX19zYiA/IGdvb2RiaXQg
OiBiYWRiaXQ7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1Ry
YWl0cz4KICAgIHZvaWQKICAgIGJhc2ljX2lvczxfQ2hhclQsIF9UcmFpdHM+OjpfTV9jYWNoZV9s
b2NhbGUoY29uc3QgbG9jYWxlJiBfX2xvYykKICAgIHsKICAgICAgaWYgKF9fYnVpbHRpbl9leHBl
Y3QoaGFzX2ZhY2V0PF9fY3R5cGVfdHlwZT4oX19sb2MpLCB0cnVlKSkKIF9NX2N0eXBlID0gJnVz
ZV9mYWNldDxfX2N0eXBlX3R5cGU+KF9fbG9jKTsKICAgICAgZWxzZQogX01fY3R5cGUgPSAwOwoK
ICAgICAgaWYgKF9fYnVpbHRpbl9leHBlY3QoaGFzX2ZhY2V0PF9fbnVtX3B1dF90eXBlPihfX2xv
YyksIHRydWUpKQogX01fbnVtX3B1dCA9ICZ1c2VfZmFjZXQ8X19udW1fcHV0X3R5cGU+KF9fbG9j
KTsKICAgICAgZWxzZQogX01fbnVtX3B1dCA9IDA7CgogICAgICBpZiAoX19idWlsdGluX2V4cGVj
dChoYXNfZmFjZXQ8X19udW1fZ2V0X3R5cGU+KF9fbG9jKSwgdHJ1ZSkpCiBfTV9udW1fZ2V0ID0g
JnVzZV9mYWNldDxfX251bV9nZXRfdHlwZT4oX19sb2MpOwogICAgICBlbHNlCiBfTV9udW1fZ2V0
ID0gMDsKICAgIH0KCgoKCiAgZXh0ZXJuIHRlbXBsYXRlIGNsYXNzIGJhc2ljX2lvczxjaGFyPjsK
CgogIGV4dGVybiB0ZW1wbGF0ZSBjbGFzcyBiYXNpY19pb3M8d2NoYXJfdD47CgoKCgp9CiMgNTE3
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYmFzaWNfaW9zLmgiIDIgMwojIDQ1ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2lvcyIgMiAzCiMgMzkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
b3N0cmVhbSIgMiAzCgoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5
X18gKCJkZWZhdWx0IikpKQp7CgojIDU3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL29zdHJlYW0i
IDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBjbGFz
cyBiYXNpY19vc3RyZWFtIDogdmlydHVhbCBwdWJsaWMgYmFzaWNfaW9zPF9DaGFyVCwgX1RyYWl0
cz4KICAgIHsKICAgIHB1YmxpYzoKCiAgICAgIHR5cGVkZWYgX0NoYXJUIGNoYXJfdHlwZTsKICAg
ICAgdHlwZWRlZiB0eXBlbmFtZSBfVHJhaXRzOjppbnRfdHlwZSBpbnRfdHlwZTsKICAgICAgdHlw
ZWRlZiB0eXBlbmFtZSBfVHJhaXRzOjpwb3NfdHlwZSBwb3NfdHlwZTsKICAgICAgdHlwZWRlZiB0
eXBlbmFtZSBfVHJhaXRzOjpvZmZfdHlwZSBvZmZfdHlwZTsKICAgICAgdHlwZWRlZiBfVHJhaXRz
IHRyYWl0c190eXBlOwoKCiAgICAgIHR5cGVkZWYgYmFzaWNfc3RyZWFtYnVmPF9DaGFyVCwgX1Ry
YWl0cz4gX19zdHJlYW1idWZfdHlwZTsKICAgICAgdHlwZWRlZiBiYXNpY19pb3M8X0NoYXJULCBf
VHJhaXRzPiBfX2lvc190eXBlOwogICAgICB0eXBlZGVmIGJhc2ljX29zdHJlYW08X0NoYXJULCBf
VHJhaXRzPiBfX29zdHJlYW1fdHlwZTsKICAgICAgdHlwZWRlZiBudW1fcHV0PF9DaGFyVCwgb3N0
cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQsIF9UcmFpdHM+ID4KICAgICAgICAgICAgIF9fbnVtX3B1
dF90eXBlOwogICAgICB0eXBlZGVmIGN0eXBlPF9DaGFyVD4gX19jdHlwZV90eXBlOwojIDgzICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL29zdHJlYW0iIDMKICAgICAgZXhwbGljaXQKICAgICAgYmFz
aWNfb3N0cmVhbShfX3N0cmVhbWJ1Zl90eXBlKiBfX3NiKQogICAgICB7IHRoaXMtPmluaXQoX19z
Yik7IH0KCgoKCgoKICAgICAgdmlydHVhbAogICAgICB+YmFzaWNfb3N0cmVhbSgpIHsgfQoKCiAg
ICAgIGNsYXNzIHNlbnRyeTsKICAgICAgZnJpZW5kIGNsYXNzIHNlbnRyeTsKIyAxMDcgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvb3N0cmVhbSIgMwogICAgICBfX29zdHJlYW1fdHlwZSYKICAgICAg
b3BlcmF0b3I8PChfX29zdHJlYW1fdHlwZSYgKCpfX3BmKShfX29zdHJlYW1fdHlwZSYpKQogICAg
ICB7CgoKCiByZXR1cm4gX19wZigqdGhpcyk7CiAgICAgIH0KCiAgICAgIF9fb3N0cmVhbV90eXBl
JgogICAgICBvcGVyYXRvcjw8KF9faW9zX3R5cGUmICgqX19wZikoX19pb3NfdHlwZSYpKQogICAg
ICB7CgoKCiBfX3BmKCp0aGlzKTsKIHJldHVybiAqdGhpczsKICAgICAgfQoKICAgICAgX19vc3Ry
ZWFtX3R5cGUmCiAgICAgIG9wZXJhdG9yPDwoaW9zX2Jhc2UmICgqX19wZikgKGlvc19iYXNlJikp
CiAgICAgIHsKCgoKIF9fcGYoKnRoaXMpOwogcmV0dXJuICp0aGlzOwogICAgICB9CiMgMTY1ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL29zdHJlYW0iIDMKICAgICAgX19vc3RyZWFtX3R5cGUmCiAg
ICAgIG9wZXJhdG9yPDwobG9uZyBfX24pCiAgICAgIHsgcmV0dXJuIF9NX2luc2VydChfX24pOyB9
CgogICAgICBfX29zdHJlYW1fdHlwZSYKICAgICAgb3BlcmF0b3I8PCh1bnNpZ25lZCBsb25nIF9f
bikKICAgICAgeyByZXR1cm4gX01faW5zZXJ0KF9fbik7IH0KCiAgICAgIF9fb3N0cmVhbV90eXBl
JgogICAgICBvcGVyYXRvcjw8KGJvb2wgX19uKQogICAgICB7IHJldHVybiBfTV9pbnNlcnQoX19u
KTsgfQoKICAgICAgX19vc3RyZWFtX3R5cGUmCiAgICAgIG9wZXJhdG9yPDwoc2hvcnQgX19uKTsK
CiAgICAgIF9fb3N0cmVhbV90eXBlJgogICAgICBvcGVyYXRvcjw8KHVuc2lnbmVkIHNob3J0IF9f
bikKICAgICAgewoKCiByZXR1cm4gX01faW5zZXJ0KHN0YXRpY19jYXN0PHVuc2lnbmVkIGxvbmc+
KF9fbikpOwogICAgICB9CgogICAgICBfX29zdHJlYW1fdHlwZSYKICAgICAgb3BlcmF0b3I8PChp
bnQgX19uKTsKCiAgICAgIF9fb3N0cmVhbV90eXBlJgogICAgICBvcGVyYXRvcjw8KHVuc2lnbmVk
IGludCBfX24pCiAgICAgIHsKCgogcmV0dXJuIF9NX2luc2VydChzdGF0aWNfY2FzdDx1bnNpZ25l
ZCBsb25nPihfX24pKTsKICAgICAgfQoKCiAgICAgIF9fb3N0cmVhbV90eXBlJgogICAgICBvcGVy
YXRvcjw8KGxvbmcgbG9uZyBfX24pCiAgICAgIHsgcmV0dXJuIF9NX2luc2VydChfX24pOyB9Cgog
ICAgICBfX29zdHJlYW1fdHlwZSYKICAgICAgb3BlcmF0b3I8PCh1bnNpZ25lZCBsb25nIGxvbmcg
X19uKQogICAgICB7IHJldHVybiBfTV9pbnNlcnQoX19uKTsgfQojIDIxOSAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9vc3RyZWFtIiAzCiAgICAgIF9fb3N0cmVhbV90eXBlJgogICAgICBvcGVyYXRv
cjw8KGRvdWJsZSBfX2YpCiAgICAgIHsgcmV0dXJuIF9NX2luc2VydChfX2YpOyB9CgogICAgICBf
X29zdHJlYW1fdHlwZSYKICAgICAgb3BlcmF0b3I8PChmbG9hdCBfX2YpCiAgICAgIHsKCgogcmV0
dXJuIF9NX2luc2VydChzdGF0aWNfY2FzdDxkb3VibGU+KF9fZikpOwogICAgICB9CgogICAgICBf
X29zdHJlYW1fdHlwZSYKICAgICAgb3BlcmF0b3I8PChsb25nIGRvdWJsZSBfX2YpCiAgICAgIHsg
cmV0dXJuIF9NX2luc2VydChfX2YpOyB9CiMgMjQ0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL29z
dHJlYW0iIDMKICAgICAgX19vc3RyZWFtX3R5cGUmCiAgICAgIG9wZXJhdG9yPDwoY29uc3Qgdm9p
ZCogX19wKQogICAgICB7IHJldHVybiBfTV9pbnNlcnQoX19wKTsgfQojIDI2OSAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9vc3RyZWFtIiAzCiAgICAgIF9fb3N0cmVhbV90eXBlJgogICAgICBvcGVy
YXRvcjw8KF9fc3RyZWFtYnVmX3R5cGUqIF9fc2IpOwojIDMwMiAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9vc3RyZWFtIiAzCiAgICAgIF9fb3N0cmVhbV90eXBlJgogICAgICBwdXQoY2hhcl90eXBl
IF9fYyk7CgoKCgoKCiAgICAgIHZvaWQKICAgICAgX01fd3JpdGUoY29uc3QgY2hhcl90eXBlKiBf
X3MsIHN0cmVhbXNpemUgX19uKQogICAgICB7CiBjb25zdCBzdHJlYW1zaXplIF9fcHV0ID0gdGhp
cy0+cmRidWYoKS0+c3B1dG4oX19zLCBfX24pOwogaWYgKF9fcHV0ICE9IF9fbikKICAgdGhpcy0+
c2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJpdCk7CiAgICAgIH0KIyAzMzQgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvb3N0cmVhbSIgMwogICAgICBfX29zdHJlYW1fdHlwZSYKICAgICAgd3JpdGUoY29u
c3QgY2hhcl90eXBlKiBfX3MsIHN0cmVhbXNpemUgX19uKTsKIyAzNDcgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvb3N0cmVhbSIgMwogICAgICBfX29zdHJlYW1fdHlwZSYKICAgICAgZmx1c2goKTsK
IyAzNTcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvb3N0cmVhbSIgMwogICAgICBwb3NfdHlwZQog
ICAgICB0ZWxscCgpOwojIDM2OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9vc3RyZWFtIiAzCiAg
ICAgIF9fb3N0cmVhbV90eXBlJgogICAgICBzZWVrcChwb3NfdHlwZSk7CiMgMzgwICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL29zdHJlYW0iIDMKICAgICAgIF9fb3N0cmVhbV90eXBlJgogICAgICBz
ZWVrcChvZmZfdHlwZSwgaW9zX2Jhc2U6OnNlZWtkaXIpOwoKICAgIHByb3RlY3RlZDoKICAgICAg
YmFzaWNfb3N0cmVhbSgpCiAgICAgIHsgdGhpcy0+aW5pdCgwKTsgfQoKCgogICAgICBiYXNpY19v
c3RyZWFtKGJhc2ljX2lvc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mKSB7IH0KCiAgICAgIGJhc2lj
X29zdHJlYW0oY29uc3QgYmFzaWNfb3N0cmVhbSYpID0gZGVsZXRlOwoKICAgICAgYmFzaWNfb3N0
cmVhbShiYXNpY19vc3RyZWFtJiYgX19yaHMpCiAgICAgIDogX19pb3NfdHlwZSgpCiAgICAgIHsg
X19pb3NfdHlwZTo6bW92ZShfX3Jocyk7IH0KCgoKICAgICAgYmFzaWNfb3N0cmVhbSYgb3BlcmF0
b3I9KGNvbnN0IGJhc2ljX29zdHJlYW0mKSA9IGRlbGV0ZTsKCiAgICAgIGJhc2ljX29zdHJlYW0m
CiAgICAgIG9wZXJhdG9yPShiYXNpY19vc3RyZWFtJiYgX19yaHMpCiAgICAgIHsKIHN3YXAoX19y
aHMpOwogcmV0dXJuICp0aGlzOwogICAgICB9CgogICAgICB2b2lkCiAgICAgIHN3YXAoYmFzaWNf
b3N0cmVhbSYgX19yaHMpCiAgICAgIHsgX19pb3NfdHlwZTo6c3dhcChfX3Jocyk7IH0KCgogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVmFsdWVUPgogX19vc3RyZWFtX3R5cGUmCiBfTV9pbnNlcnQo
X1ZhbHVlVCBfX3YpOwogICAgfTsKIyA0MjUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvb3N0cmVh
bSIgMwogIHRlbXBsYXRlIDx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBj
bGFzcyBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz46OnNlbnRyeQogICAgewoKICAgICAg
Ym9vbCBfTV9vazsKICAgICAgYmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JiBfTV9vczsK
CiAgICBwdWJsaWM6CiMgNDQ0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL29zdHJlYW0iIDMKICAg
ICAgZXhwbGljaXQKICAgICAgc2VudHJ5KGJhc2ljX29zdHJlYW08X0NoYXJULCBfVHJhaXRzPiYg
X19vcyk7CiMgNDU0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL29zdHJlYW0iIDMKICAgICAgfnNl
bnRyeSgpCiAgICAgIHsKCiBpZiAoYm9vbChfTV9vcy5mbGFncygpICYgaW9zX2Jhc2U6OnVuaXRi
dWYpICYmICF1bmNhdWdodF9leGNlcHRpb24oKSkKICAgewoKICAgICBpZiAoX01fb3MucmRidWYo
KSAmJiBfTV9vcy5yZGJ1ZigpLT5wdWJzeW5jKCkgPT0gLTEpCiAgICAgICBfTV9vcy5zZXRzdGF0
ZShpb3NfYmFzZTo6YmFkYml0KTsKICAgfQogICAgICB9CiMgNDczICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL29zdHJlYW0iIDMKICAgICAgZXhwbGljaXQKCiAgICAgIG9wZXJhdG9yIGJvb2woKSBj
b25zdAogICAgICB7IHJldHVybiBfTV9vazsgfQogICAgfTsKIyA0OTUgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvb3N0cmVhbSIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUg
X1RyYWl0cz4KICAgIGlubGluZSBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBv
cGVyYXRvcjw8KGJhc2ljX29zdHJlYW08X0NoYXJULCBfVHJhaXRzPiYgX19vdXQsIF9DaGFyVCBf
X2MpCiAgICB7IHJldHVybiBfX29zdHJlYW1faW5zZXJ0KF9fb3V0LCAmX19jLCAxKTsgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBpbmxpbmUgYmFz
aWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JgogICAgb3BlcmF0b3I8PChiYXNpY19vc3RyZWFt
PF9DaGFyVCwgX1RyYWl0cz4mIF9fb3V0LCBjaGFyIF9fYykKICAgIHsgcmV0dXJuIChfX291dCA8
PCBfX291dC53aWRlbihfX2MpKTsgfQoKCiAgdGVtcGxhdGUgPGNsYXNzIF9UcmFpdHM+CiAgICBp
bmxpbmUgYmFzaWNfb3N0cmVhbTxjaGFyLCBfVHJhaXRzPiYKICAgIG9wZXJhdG9yPDwoYmFzaWNf
b3N0cmVhbTxjaGFyLCBfVHJhaXRzPiYgX19vdXQsIGNoYXIgX19jKQogICAgeyByZXR1cm4gX19v
c3RyZWFtX2luc2VydChfX291dCwgJl9fYywgMSk7IH0KCgogIHRlbXBsYXRlPGNsYXNzIF9UcmFp
dHM+CiAgICBpbmxpbmUgYmFzaWNfb3N0cmVhbTxjaGFyLCBfVHJhaXRzPiYKICAgIG9wZXJhdG9y
PDwoYmFzaWNfb3N0cmVhbTxjaGFyLCBfVHJhaXRzPiYgX19vdXQsIHNpZ25lZCBjaGFyIF9fYykK
ICAgIHsgcmV0dXJuIChfX291dCA8PCBzdGF0aWNfY2FzdDxjaGFyPihfX2MpKTsgfQoKICB0ZW1w
bGF0ZTxjbGFzcyBfVHJhaXRzPgogICAgaW5saW5lIGJhc2ljX29zdHJlYW08Y2hhciwgX1RyYWl0
cz4mCiAgICBvcGVyYXRvcjw8KGJhc2ljX29zdHJlYW08Y2hhciwgX1RyYWl0cz4mIF9fb3V0LCB1
bnNpZ25lZCBjaGFyIF9fYykKICAgIHsgcmV0dXJuIChfX291dCA8PCBzdGF0aWNfY2FzdDxjaGFy
PihfX2MpKTsgfQojIDUzNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9vc3RyZWFtIiAzCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgaW5saW5lIGJhc2lj
X29zdHJlYW08X0NoYXJULCBfVHJhaXRzPiYKICAgIG9wZXJhdG9yPDwoYmFzaWNfb3N0cmVhbTxf
Q2hhclQsIF9UcmFpdHM+JiBfX291dCwgY29uc3QgX0NoYXJUKiBfX3MpCiAgICB7CiAgICAgIGlm
ICghX19zKQogX19vdXQuc2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJpdCk7CiAgICAgIGVsc2UKIF9f
b3N0cmVhbV9pbnNlcnQoX19vdXQsIF9fcywKICAgIHN0YXRpY19jYXN0PHN0cmVhbXNpemU+KF9U
cmFpdHM6Omxlbmd0aChfX3MpKSk7CiAgICAgIHJldHVybiBfX291dDsKICAgIH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNfb3N0cmVhbTxf
Q2hhclQsIF9UcmFpdHM+ICYKICAgIG9wZXJhdG9yPDwoYmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9U
cmFpdHM+JiBfX291dCwgY29uc3QgY2hhciogX19zKTsKCgogIHRlbXBsYXRlPGNsYXNzIF9UcmFp
dHM+CiAgICBpbmxpbmUgYmFzaWNfb3N0cmVhbTxjaGFyLCBfVHJhaXRzPiYKICAgIG9wZXJhdG9y
PDwoYmFzaWNfb3N0cmVhbTxjaGFyLCBfVHJhaXRzPiYgX19vdXQsIGNvbnN0IGNoYXIqIF9fcykK
ICAgIHsKICAgICAgaWYgKCFfX3MpCiBfX291dC5zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsK
ICAgICAgZWxzZQogX19vc3RyZWFtX2luc2VydChfX291dCwgX19zLAogICAgc3RhdGljX2Nhc3Q8
c3RyZWFtc2l6ZT4oX1RyYWl0czo6bGVuZ3RoKF9fcykpKTsKICAgICAgcmV0dXJuIF9fb3V0Owog
ICAgfQoKCiAgdGVtcGxhdGU8Y2xhc3MgX1RyYWl0cz4KICAgIGlubGluZSBiYXNpY19vc3RyZWFt
PGNoYXIsIF9UcmFpdHM+JgogICAgb3BlcmF0b3I8PChiYXNpY19vc3RyZWFtPGNoYXIsIF9UcmFp
dHM+JiBfX291dCwgY29uc3Qgc2lnbmVkIGNoYXIqIF9fcykKICAgIHsgcmV0dXJuIChfX291dCA8
PCByZWludGVycHJldF9jYXN0PGNvbnN0IGNoYXIqPihfX3MpKTsgfQoKICB0ZW1wbGF0ZTxjbGFz
cyBfVHJhaXRzPgogICAgaW5saW5lIGJhc2ljX29zdHJlYW08Y2hhciwgX1RyYWl0cz4gJgogICAg
b3BlcmF0b3I8PChiYXNpY19vc3RyZWFtPGNoYXIsIF9UcmFpdHM+JiBfX291dCwgY29uc3QgdW5z
aWduZWQgY2hhciogX19zKQogICAgeyByZXR1cm4gKF9fb3V0IDw8IHJlaW50ZXJwcmV0X2Nhc3Q8
Y29uc3QgY2hhcio+KF9fcykpOyB9CiMgNTg4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL29zdHJl
YW0iIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBp
bmxpbmUgYmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JgogICAgZW5kbChiYXNpY19vc3Ry
ZWFtPF9DaGFyVCwgX1RyYWl0cz4mIF9fb3MpCiAgICB7IHJldHVybiBmbHVzaChfX29zLnB1dChf
X29zLndpZGVuKCdcbicpKSk7IH0KIyA2MDAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvb3N0cmVh
bSIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIGlu
bGluZSBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBlbmRzKGJhc2ljX29zdHJl
YW08X0NoYXJULCBfVHJhaXRzPiYgX19vcykKICAgIHsgcmV0dXJuIF9fb3MucHV0KF9DaGFyVCgp
KTsgfQoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4K
ICAgIGlubGluZSBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBmbHVzaChiYXNp
Y19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mIF9fb3MpCiAgICB7IHJldHVybiBfX29zLmZsdXNo
KCk7IH0KIyA2MjYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvb3N0cmVhbSIgMwogIHRlbXBsYXRl
PHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cywgdHlwZW5hbWUgX1RwPgogICAgaW5s
aW5lIGJhc2ljX29zdHJlYW08X0NoYXJULCBfVHJhaXRzPiYKICAgIG9wZXJhdG9yPDwoYmFzaWNf
b3N0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JiYgX19vcywgY29uc3QgX1RwJiBfX3gpCiAgICB7CiAg
ICAgIF9fb3MgPDwgX194OwogICAgICByZXR1cm4gX19vczsKICAgIH0KCgoKfQoKIyAxICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvb3N0cmVhbS50Y2MiIDEgMwojIDM3ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvb3N0cmVhbS50Y2MiIDMKICAgICAgIAojIDM4ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvb3N0cmVhbS50Y2MiIDMKCgoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJp
YnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBiYXNpY19vc3RyZWFtPF9DaGFyVCwg
X1RyYWl0cz46OnNlbnRyeTo6CiAgICBzZW50cnkoYmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFp
dHM+JiBfX29zKQogICAgOiBfTV9vayhmYWxzZSksIF9NX29zKF9fb3MpCiAgICB7CgogICAgICBp
ZiAoX19vcy50aWUoKSAmJiBfX29zLmdvb2QoKSkKIF9fb3MudGllKCktPmZsdXNoKCk7CgogICAg
ICBpZiAoX19vcy5nb29kKCkpCiBfTV9vayA9IHRydWU7CiAgICAgIGVsc2UKIF9fb3Muc2V0c3Rh
dGUoaW9zX2Jhc2U6OmZhaWxiaXQpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQs
IHR5cGVuYW1lIF9UcmFpdHM+CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVmFsdWVUPgogICAgICBi
YXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICAgIGJhc2ljX29zdHJlYW08X0NoYXJU
LCBfVHJhaXRzPjo6CiAgICAgIF9NX2luc2VydChfVmFsdWVUIF9fdikKICAgICAgewogc2VudHJ5
IF9fY2VyYigqdGhpcyk7CiBpZiAoX19jZXJiKQogICB7CiAgICAgaW9zX2Jhc2U6Omlvc3RhdGUg
X19lcnIgPSBpb3NfYmFzZTo6Z29vZGJpdDsKICAgICB0cnkKICAgICAgIHsKICBjb25zdCBfX251
bV9wdXRfdHlwZSYgX19ucCA9IF9fY2hlY2tfZmFjZXQodGhpcy0+X01fbnVtX3B1dCk7CiAgaWYg
KF9fbnAucHV0KCp0aGlzLCAqdGhpcywgdGhpcy0+ZmlsbCgpLCBfX3YpLmZhaWxlZCgpKQogICAg
X19lcnIgfD0gaW9zX2Jhc2U6OmJhZGJpdDsKICAgICAgIH0KICAgICBjYXRjaChfX2N4eGFiaXYx
OjpfX2ZvcmNlZF91bndpbmQmKQogICAgICAgewogIHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNl
OjpiYWRiaXQpOwogIHRocm93OwogICAgICAgfQogICAgIGNhdGNoKC4uLikKICAgICAgIHsgdGhp
cy0+X01fc2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJpdCk7IH0KICAgICBpZiAoX19lcnIpCiAgICAg
ICB0aGlzLT5zZXRzdGF0ZShfX2Vycik7CiAgIH0KIHJldHVybiAqdGhpczsKICAgICAgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBiYXNpY19vc3Ry
ZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz46
OgogICAgb3BlcmF0b3I8PChzaG9ydCBfX24pCiAgICB7CgoKICAgICAgY29uc3QgaW9zX2Jhc2U6
OmZtdGZsYWdzIF9fZm10ID0gdGhpcy0+ZmxhZ3MoKSAmIGlvc19iYXNlOjpiYXNlZmllbGQ7CiAg
ICAgIGlmIChfX2ZtdCA9PSBpb3NfYmFzZTo6b2N0IHx8IF9fZm10ID09IGlvc19iYXNlOjpoZXgp
CiByZXR1cm4gX01faW5zZXJ0KHN0YXRpY19jYXN0PGxvbmc+KHN0YXRpY19jYXN0PHVuc2lnbmVk
IHNob3J0PihfX24pKSk7CiAgICAgIGVsc2UKIHJldHVybiBfTV9pbnNlcnQoc3RhdGljX2Nhc3Q8
bG9uZz4oX19uKSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUg
X1RyYWl0cz4KICAgIGJhc2ljX29zdHJlYW08X0NoYXJULCBfVHJhaXRzPiYKICAgIGJhc2ljX29z
dHJlYW08X0NoYXJULCBfVHJhaXRzPjo6CiAgICBvcGVyYXRvcjw8KGludCBfX24pCiAgICB7CgoK
ICAgICAgY29uc3QgaW9zX2Jhc2U6OmZtdGZsYWdzIF9fZm10ID0gdGhpcy0+ZmxhZ3MoKSAmIGlv
c19iYXNlOjpiYXNlZmllbGQ7CiAgICAgIGlmIChfX2ZtdCA9PSBpb3NfYmFzZTo6b2N0IHx8IF9f
Zm10ID09IGlvc19iYXNlOjpoZXgpCiByZXR1cm4gX01faW5zZXJ0KHN0YXRpY19jYXN0PGxvbmc+
KHN0YXRpY19jYXN0PHVuc2lnbmVkIGludD4oX19uKSkpOwogICAgICBlbHNlCiByZXR1cm4gX01f
aW5zZXJ0KHN0YXRpY19jYXN0PGxvbmc+KF9fbikpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1Ry
YWl0cz4mCiAgICBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz46OgogICAgb3BlcmF0b3I8
PChfX3N0cmVhbWJ1Zl90eXBlKiBfX3NiaW4pCiAgICB7CiAgICAgIGlvc19iYXNlOjppb3N0YXRl
IF9fZXJyID0gaW9zX2Jhc2U6Omdvb2RiaXQ7CiAgICAgIHNlbnRyeSBfX2NlcmIoKnRoaXMpOwog
ICAgICBpZiAoX19jZXJiICYmIF9fc2JpbikKIHsKICAgdHJ5CiAgICAgewogICAgICAgaWYgKCFf
X2NvcHlfc3RyZWFtYnVmcyhfX3NiaW4sIHRoaXMtPnJkYnVmKCkpKQogIF9fZXJyIHw9IGlvc19i
YXNlOjpmYWlsYml0OwogICAgIH0KICAgY2F0Y2goX19jeHhhYml2MTo6X19mb3JjZWRfdW53aW5k
JikKICAgICB7CiAgICAgICB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsKICAg
ICAgIHRocm93OwogICAgIH0KICAgY2F0Y2goLi4uKQogICAgIHsgdGhpcy0+X01fc2V0c3RhdGUo
aW9zX2Jhc2U6OmZhaWxiaXQpOyB9CiB9CiAgICAgIGVsc2UgaWYgKCFfX3NiaW4pCiBfX2VyciB8
PSBpb3NfYmFzZTo6YmFkYml0OwogICAgICBpZiAoX19lcnIpCiB0aGlzLT5zZXRzdGF0ZShfX2Vy
cik7CiAgICAgIHJldHVybiAqdGhpczsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJU
LCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFpdHM+Jgog
ICAgYmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIHB1dChjaGFyX3R5cGUgX19j
KQogICAgewoKCgoKCgogICAgICBzZW50cnkgX19jZXJiKCp0aGlzKTsKICAgICAgaWYgKF9fY2Vy
YikKIHsKICAgaW9zX2Jhc2U6Omlvc3RhdGUgX19lcnIgPSBpb3NfYmFzZTo6Z29vZGJpdDsKICAg
dHJ5CiAgICAgewogICAgICAgY29uc3QgaW50X3R5cGUgX19wdXQgPSB0aGlzLT5yZGJ1ZigpLT5z
cHV0YyhfX2MpOwogICAgICAgaWYgKHRyYWl0c190eXBlOjplcV9pbnRfdHlwZShfX3B1dCwgdHJh
aXRzX3R5cGU6OmVvZigpKSkKICBfX2VyciB8PSBpb3NfYmFzZTo6YmFkYml0OwogICAgIH0KICAg
Y2F0Y2goX19jeHhhYml2MTo6X19mb3JjZWRfdW53aW5kJikKICAgICB7CiAgICAgICB0aGlzLT5f
TV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsKICAgICAgIHRocm93OwogICAgIH0KICAgY2F0
Y2goLi4uKQogICAgIHsgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJpdCk7IH0KICAg
aWYgKF9fZXJyKQogICAgIHRoaXMtPnNldHN0YXRlKF9fZXJyKTsKIH0KICAgICAgcmV0dXJuICp0
aGlzOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+
CiAgICBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBiYXNpY19vc3RyZWFtPF9D
aGFyVCwgX1RyYWl0cz46OgogICAgd3JpdGUoY29uc3QgX0NoYXJUKiBfX3MsIHN0cmVhbXNpemUg
X19uKQogICAgewoKCgoKCgoKICAgICAgc2VudHJ5IF9fY2VyYigqdGhpcyk7CiAgICAgIGlmIChf
X2NlcmIpCiB7CiAgIHRyeQogICAgIHsgX01fd3JpdGUoX19zLCBfX24pOyB9CiAgIGNhdGNoKF9f
Y3h4YWJpdjE6Ol9fZm9yY2VkX3Vud2luZCYpCiAgICAgewogICAgICAgdGhpcy0+X01fc2V0c3Rh
dGUoaW9zX2Jhc2U6OmJhZGJpdCk7CiAgICAgICB0aHJvdzsKICAgICB9CiAgIGNhdGNoKC4uLikK
ICAgICB7IHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOyB9CiB9CiAgICAgIHJl
dHVybiAqdGhpczsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBf
VHJhaXRzPgogICAgYmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JgogICAgYmFzaWNfb3N0
cmVhbTxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIGZsdXNoKCkKICAgIHsKCgoKICAgICAgaW9zX2Jh
c2U6Omlvc3RhdGUgX19lcnIgPSBpb3NfYmFzZTo6Z29vZGJpdDsKICAgICAgdHJ5CiB7CiAgIGlm
ICh0aGlzLT5yZGJ1ZigpICYmIHRoaXMtPnJkYnVmKCktPnB1YnN5bmMoKSA9PSAtMSkKICAgICBf
X2VyciB8PSBpb3NfYmFzZTo6YmFkYml0OwogfQogICAgICBjYXRjaChfX2N4eGFiaXYxOjpfX2Zv
cmNlZF91bndpbmQmKQogewogICB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsK
ICAgdGhyb3c7CiB9CiAgICAgIGNhdGNoKC4uLikKIHsgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jh
c2U6OmJhZGJpdCk7IH0KICAgICAgaWYgKF9fZXJyKQogdGhpcy0+c2V0c3RhdGUoX19lcnIpOwog
ICAgICByZXR1cm4gKnRoaXM7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlw
ZW5hbWUgX1RyYWl0cz4KICAgIHR5cGVuYW1lIGJhc2ljX29zdHJlYW08X0NoYXJULCBfVHJhaXRz
Pjo6cG9zX3R5cGUKICAgIGJhc2ljX29zdHJlYW08X0NoYXJULCBfVHJhaXRzPjo6CiAgICB0ZWxs
cCgpCiAgICB7CiAgICAgIHBvc190eXBlIF9fcmV0ID0gcG9zX3R5cGUoLTEpOwogICAgICB0cnkK
IHsKICAgaWYgKCF0aGlzLT5mYWlsKCkpCiAgICAgX19yZXQgPSB0aGlzLT5yZGJ1ZigpLT5wdWJz
ZWVrb2ZmKDAsIGlvc19iYXNlOjpjdXIsIGlvc19iYXNlOjpvdXQpOwogfQogICAgICBjYXRjaChf
X2N4eGFiaXYxOjpfX2ZvcmNlZF91bndpbmQmKQogewogICB0aGlzLT5fTV9zZXRzdGF0ZShpb3Nf
YmFzZTo6YmFkYml0KTsKICAgdGhyb3c7CiB9CiAgICAgIGNhdGNoKC4uLikKIHsgdGhpcy0+X01f
c2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJpdCk7IH0KICAgICAgcmV0dXJuIF9fcmV0OwogICAgfQoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBiYXNpY19v
c3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0
cz46OgogICAgc2Vla3AocG9zX3R5cGUgX19wb3MpCiAgICB7CiAgICAgIGlvc19iYXNlOjppb3N0
YXRlIF9fZXJyID0gaW9zX2Jhc2U6Omdvb2RiaXQ7CiAgICAgIHRyeQogewogICBpZiAoIXRoaXMt
PmZhaWwoKSkKICAgICB7CgoKICAgICAgIGNvbnN0IHBvc190eXBlIF9fcCA9IHRoaXMtPnJkYnVm
KCktPnB1YnNlZWtwb3MoX19wb3MsCiAgICAgICAgICAgIGlvc19iYXNlOjpvdXQpOwoKCiAgICAg
ICBpZiAoX19wID09IHBvc190eXBlKG9mZl90eXBlKC0xKSkpCiAgX19lcnIgfD0gaW9zX2Jhc2U6
OmZhaWxiaXQ7CiAgICAgfQogfQogICAgICBjYXRjaChfX2N4eGFiaXYxOjpfX2ZvcmNlZF91bndp
bmQmKQogewogICB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsKICAgdGhyb3c7
CiB9CiAgICAgIGNhdGNoKC4uLikKIHsgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJp
dCk7IH0KICAgICAgaWYgKF9fZXJyKQogdGhpcy0+c2V0c3RhdGUoX19lcnIpOwogICAgICByZXR1
cm4gKnRoaXM7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1Ry
YWl0cz4KICAgIGJhc2ljX29zdHJlYW08X0NoYXJULCBfVHJhaXRzPiYKICAgIGJhc2ljX29zdHJl
YW08X0NoYXJULCBfVHJhaXRzPjo6CiAgICBzZWVrcChvZmZfdHlwZSBfX29mZiwgaW9zX2Jhc2U6
OnNlZWtkaXIgX19kaXIpCiAgICB7CiAgICAgIGlvc19iYXNlOjppb3N0YXRlIF9fZXJyID0gaW9z
X2Jhc2U6Omdvb2RiaXQ7CiAgICAgIHRyeQogewogICBpZiAoIXRoaXMtPmZhaWwoKSkKICAgICB7
CgoKICAgICAgIGNvbnN0IHBvc190eXBlIF9fcCA9IHRoaXMtPnJkYnVmKCktPnB1YnNlZWtvZmYo
X19vZmYsIF9fZGlyLAogICAgICAgICAgICBpb3NfYmFzZTo6b3V0KTsKCgogICAgICAgaWYgKF9f
cCA9PSBwb3NfdHlwZShvZmZfdHlwZSgtMSkpKQogIF9fZXJyIHw9IGlvc19iYXNlOjpmYWlsYml0
OwogICAgIH0KIH0KICAgICAgY2F0Y2goX19jeHhhYml2MTo6X19mb3JjZWRfdW53aW5kJikKIHsK
ICAgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJpdCk7CiAgIHRocm93OwogfQogICAg
ICBjYXRjaCguLi4pCiB7IHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOyB9CiAg
ICAgIGlmIChfX2VycikKIHRoaXMtPnNldHN0YXRlKF9fZXJyKTsKICAgICAgcmV0dXJuICp0aGlz
OwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAg
ICBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBvcGVyYXRvcjw8KGJhc2ljX29z
dHJlYW08X0NoYXJULCBfVHJhaXRzPiYgX19vdXQsIGNvbnN0IGNoYXIqIF9fcykKICAgIHsKICAg
ICAgaWYgKCFfX3MpCiBfX291dC5zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsKICAgICAgZWxz
ZQogewoKCiAgIGNvbnN0IHNpemVfdCBfX2NsZW4gPSBjaGFyX3RyYWl0czxjaGFyPjo6bGVuZ3Ro
KF9fcyk7CiAgIHRyeQogICAgIHsKICAgICAgIHN0cnVjdCBfX3B0cl9ndWFyZAogICAgICAgewog
IF9DaGFyVCAqX19wOwogIF9fcHRyX2d1YXJkIChfQ2hhclQgKl9faXApOiBfX3AoX19pcCkgeyB9
CiAgfl9fcHRyX2d1YXJkKCkgeyBkZWxldGVbXSBfX3A7IH0KICBfQ2hhclQqIF9fZ2V0KCkgeyBy
ZXR1cm4gX19wOyB9CiAgICAgICB9IF9fcGcgKG5ldyBfQ2hhclRbX19jbGVuXSk7CgogICAgICAg
X0NoYXJUICpfX3dzID0gX19wZy5fX2dldCgpOwogICAgICAgZm9yIChzaXplX3QgX19pID0gMDsg
X19pIDwgX19jbGVuOyArK19faSkKICBfX3dzW19faV0gPSBfX291dC53aWRlbihfX3NbX19pXSk7
CiAgICAgICBfX29zdHJlYW1faW5zZXJ0KF9fb3V0LCBfX3dzLCBfX2NsZW4pOwogICAgIH0KICAg
Y2F0Y2goX19jeHhhYml2MTo6X19mb3JjZWRfdW53aW5kJikKICAgICB7CiAgICAgICBfX291dC5f
TV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsKICAgICAgIHRocm93OwogICAgIH0KICAgY2F0
Y2goLi4uKQogICAgIHsgX19vdXQuX01fc2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJpdCk7IH0KIH0K
ICAgICAgcmV0dXJuIF9fb3V0OwogICAgfQoKCgoKICBleHRlcm4gdGVtcGxhdGUgY2xhc3MgYmFz
aWNfb3N0cmVhbTxjaGFyPjsKICBleHRlcm4gdGVtcGxhdGUgb3N0cmVhbSYgZW5kbChvc3RyZWFt
Jik7CiAgZXh0ZXJuIHRlbXBsYXRlIG9zdHJlYW0mIGVuZHMob3N0cmVhbSYpOwogIGV4dGVybiB0
ZW1wbGF0ZSBvc3RyZWFtJiBmbHVzaChvc3RyZWFtJik7CiAgZXh0ZXJuIHRlbXBsYXRlIG9zdHJl
YW0mIG9wZXJhdG9yPDwob3N0cmVhbSYsIGNoYXIpOwogIGV4dGVybiB0ZW1wbGF0ZSBvc3RyZWFt
JiBvcGVyYXRvcjw8KG9zdHJlYW0mLCB1bnNpZ25lZCBjaGFyKTsKICBleHRlcm4gdGVtcGxhdGUg
b3N0cmVhbSYgb3BlcmF0b3I8PChvc3RyZWFtJiwgc2lnbmVkIGNoYXIpOwogIGV4dGVybiB0ZW1w
bGF0ZSBvc3RyZWFtJiBvcGVyYXRvcjw8KG9zdHJlYW0mLCBjb25zdCBjaGFyKik7CiAgZXh0ZXJu
IHRlbXBsYXRlIG9zdHJlYW0mIG9wZXJhdG9yPDwob3N0cmVhbSYsIGNvbnN0IHVuc2lnbmVkIGNo
YXIqKTsKICBleHRlcm4gdGVtcGxhdGUgb3N0cmVhbSYgb3BlcmF0b3I8PChvc3RyZWFtJiwgY29u
c3Qgc2lnbmVkIGNoYXIqKTsKCiAgZXh0ZXJuIHRlbXBsYXRlIG9zdHJlYW0mIG9zdHJlYW06Ol9N
X2luc2VydChsb25nKTsKICBleHRlcm4gdGVtcGxhdGUgb3N0cmVhbSYgb3N0cmVhbTo6X01faW5z
ZXJ0KHVuc2lnbmVkIGxvbmcpOwogIGV4dGVybiB0ZW1wbGF0ZSBvc3RyZWFtJiBvc3RyZWFtOjpf
TV9pbnNlcnQoYm9vbCk7CgogIGV4dGVybiB0ZW1wbGF0ZSBvc3RyZWFtJiBvc3RyZWFtOjpfTV9p
bnNlcnQobG9uZyBsb25nKTsKICBleHRlcm4gdGVtcGxhdGUgb3N0cmVhbSYgb3N0cmVhbTo6X01f
aW5zZXJ0KHVuc2lnbmVkIGxvbmcgbG9uZyk7CgogIGV4dGVybiB0ZW1wbGF0ZSBvc3RyZWFtJiBv
c3RyZWFtOjpfTV9pbnNlcnQoZG91YmxlKTsKICBleHRlcm4gdGVtcGxhdGUgb3N0cmVhbSYgb3N0
cmVhbTo6X01faW5zZXJ0KGxvbmcgZG91YmxlKTsKICBleHRlcm4gdGVtcGxhdGUgb3N0cmVhbSYg
b3N0cmVhbTo6X01faW5zZXJ0KGNvbnN0IHZvaWQqKTsKCgogIGV4dGVybiB0ZW1wbGF0ZSBjbGFz
cyBiYXNpY19vc3RyZWFtPHdjaGFyX3Q+OwogIGV4dGVybiB0ZW1wbGF0ZSB3b3N0cmVhbSYgZW5k
bCh3b3N0cmVhbSYpOwogIGV4dGVybiB0ZW1wbGF0ZSB3b3N0cmVhbSYgZW5kcyh3b3N0cmVhbSYp
OwogIGV4dGVybiB0ZW1wbGF0ZSB3b3N0cmVhbSYgZmx1c2god29zdHJlYW0mKTsKICBleHRlcm4g
dGVtcGxhdGUgd29zdHJlYW0mIG9wZXJhdG9yPDwod29zdHJlYW0mLCB3Y2hhcl90KTsKICBleHRl
cm4gdGVtcGxhdGUgd29zdHJlYW0mIG9wZXJhdG9yPDwod29zdHJlYW0mLCBjaGFyKTsKICBleHRl
cm4gdGVtcGxhdGUgd29zdHJlYW0mIG9wZXJhdG9yPDwod29zdHJlYW0mLCBjb25zdCB3Y2hhcl90
Kik7CiAgZXh0ZXJuIHRlbXBsYXRlIHdvc3RyZWFtJiBvcGVyYXRvcjw8KHdvc3RyZWFtJiwgY29u
c3QgY2hhciopOwoKICBleHRlcm4gdGVtcGxhdGUgd29zdHJlYW0mIHdvc3RyZWFtOjpfTV9pbnNl
cnQobG9uZyk7CiAgZXh0ZXJuIHRlbXBsYXRlIHdvc3RyZWFtJiB3b3N0cmVhbTo6X01faW5zZXJ0
KHVuc2lnbmVkIGxvbmcpOwogIGV4dGVybiB0ZW1wbGF0ZSB3b3N0cmVhbSYgd29zdHJlYW06Ol9N
X2luc2VydChib29sKTsKCiAgZXh0ZXJuIHRlbXBsYXRlIHdvc3RyZWFtJiB3b3N0cmVhbTo6X01f
aW5zZXJ0KGxvbmcgbG9uZyk7CiAgZXh0ZXJuIHRlbXBsYXRlIHdvc3RyZWFtJiB3b3N0cmVhbTo6
X01faW5zZXJ0KHVuc2lnbmVkIGxvbmcgbG9uZyk7CgogIGV4dGVybiB0ZW1wbGF0ZSB3b3N0cmVh
bSYgd29zdHJlYW06Ol9NX2luc2VydChkb3VibGUpOwogIGV4dGVybiB0ZW1wbGF0ZSB3b3N0cmVh
bSYgd29zdHJlYW06Ol9NX2luc2VydChsb25nIGRvdWJsZSk7CiAgZXh0ZXJuIHRlbXBsYXRlIHdv
c3RyZWFtJiB3b3N0cmVhbTo6X01faW5zZXJ0KGNvbnN0IHZvaWQqKTsKCgoKCn0KIyA2MzkgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvb3N0cmVhbSIgMiAzCiMgNDAgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvaW9zdHJlYW0iIDIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaXN0cmVhbSIg
MSAzCiMgMzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaXN0cmVhbSIgMwogICAgICAgCiMgMzcg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvaXN0cmVhbSIgMwoKCgoKbmFtZXNwYWNlIHN0ZCBfX2F0
dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgojIDU3ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2lzdHJlYW0iIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5
cGVuYW1lIF9UcmFpdHM+CiAgICBjbGFzcyBiYXNpY19pc3RyZWFtIDogdmlydHVhbCBwdWJsaWMg
YmFzaWNfaW9zPF9DaGFyVCwgX1RyYWl0cz4KICAgIHsKICAgIHB1YmxpYzoKCiAgICAgIHR5cGVk
ZWYgX0NoYXJUIGNoYXJfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfVHJhaXRzOjppbnRf
dHlwZSBpbnRfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfVHJhaXRzOjpwb3NfdHlwZSBw
b3NfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfVHJhaXRzOjpvZmZfdHlwZSBvZmZfdHlw
ZTsKICAgICAgdHlwZWRlZiBfVHJhaXRzIHRyYWl0c190eXBlOwoKCiAgICAgIHR5cGVkZWYgYmFz
aWNfc3RyZWFtYnVmPF9DaGFyVCwgX1RyYWl0cz4gX19zdHJlYW1idWZfdHlwZTsKICAgICAgdHlw
ZWRlZiBiYXNpY19pb3M8X0NoYXJULCBfVHJhaXRzPiBfX2lvc190eXBlOwogICAgICB0eXBlZGVm
IGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiBfX2lzdHJlYW1fdHlwZTsKICAgICAgdHlw
ZWRlZiBudW1fZ2V0PF9DaGFyVCwgaXN0cmVhbWJ1Zl9pdGVyYXRvcjxfQ2hhclQsIF9UcmFpdHM+
ID4KICAgICAgICBfX251bV9nZXRfdHlwZTsKICAgICAgdHlwZWRlZiBjdHlwZTxfQ2hhclQ+IF9f
Y3R5cGVfdHlwZTsKCiAgICBwcm90ZWN0ZWQ6CgoKCgoKICAgICAgc3RyZWFtc2l6ZSBfTV9nY291
bnQ7CgogICAgcHVibGljOgoKCgoKCgoKICAgICAgZXhwbGljaXQKICAgICAgYmFzaWNfaXN0cmVh
bShfX3N0cmVhbWJ1Zl90eXBlKiBfX3NiKQogICAgICA6IF9NX2djb3VudChzdHJlYW1zaXplKDAp
KQogICAgICB7IHRoaXMtPmluaXQoX19zYik7IH0KCgoKCgoKICAgICAgdmlydHVhbAogICAgICB+
YmFzaWNfaXN0cmVhbSgpCiAgICAgIHsgX01fZ2NvdW50ID0gc3RyZWFtc2l6ZSgwKTsgfQoKCiAg
ICAgIGNsYXNzIHNlbnRyeTsKICAgICAgZnJpZW5kIGNsYXNzIHNlbnRyeTsKIyAxMTkgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvaXN0cmVhbSIgMwogICAgICBfX2lzdHJlYW1fdHlwZSYKICAgICAg
b3BlcmF0b3I+PihfX2lzdHJlYW1fdHlwZSYgKCpfX3BmKShfX2lzdHJlYW1fdHlwZSYpKQogICAg
ICB7IHJldHVybiBfX3BmKCp0aGlzKTsgfQoKICAgICAgX19pc3RyZWFtX3R5cGUmCiAgICAgIG9w
ZXJhdG9yPj4oX19pb3NfdHlwZSYgKCpfX3BmKShfX2lvc190eXBlJikpCiAgICAgIHsKIF9fcGYo
KnRoaXMpOwogcmV0dXJuICp0aGlzOwogICAgICB9CgogICAgICBfX2lzdHJlYW1fdHlwZSYKICAg
ICAgb3BlcmF0b3I+Pihpb3NfYmFzZSYgKCpfX3BmKShpb3NfYmFzZSYpKQogICAgICB7CiBfX3Bm
KCp0aGlzKTsKIHJldHVybiAqdGhpczsKICAgICAgfQojIDE2NyAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9pc3RyZWFtIiAzCiAgICAgIF9faXN0cmVhbV90eXBlJgogICAgICBvcGVyYXRvcj4+KGJv
b2wmIF9fbikKICAgICAgeyByZXR1cm4gX01fZXh0cmFjdChfX24pOyB9CgogICAgICBfX2lzdHJl
YW1fdHlwZSYKICAgICAgb3BlcmF0b3I+PihzaG9ydCYgX19uKTsKCiAgICAgIF9faXN0cmVhbV90
eXBlJgogICAgICBvcGVyYXRvcj4+KHVuc2lnbmVkIHNob3J0JiBfX24pCiAgICAgIHsgcmV0dXJu
IF9NX2V4dHJhY3QoX19uKTsgfQoKICAgICAgX19pc3RyZWFtX3R5cGUmCiAgICAgIG9wZXJhdG9y
Pj4oaW50JiBfX24pOwoKICAgICAgX19pc3RyZWFtX3R5cGUmCiAgICAgIG9wZXJhdG9yPj4odW5z
aWduZWQgaW50JiBfX24pCiAgICAgIHsgcmV0dXJuIF9NX2V4dHJhY3QoX19uKTsgfQoKICAgICAg
X19pc3RyZWFtX3R5cGUmCiAgICAgIG9wZXJhdG9yPj4obG9uZyYgX19uKQogICAgICB7IHJldHVy
biBfTV9leHRyYWN0KF9fbik7IH0KCiAgICAgIF9faXN0cmVhbV90eXBlJgogICAgICBvcGVyYXRv
cj4+KHVuc2lnbmVkIGxvbmcmIF9fbikKICAgICAgeyByZXR1cm4gX01fZXh0cmFjdChfX24pOyB9
CgoKICAgICAgX19pc3RyZWFtX3R5cGUmCiAgICAgIG9wZXJhdG9yPj4obG9uZyBsb25nJiBfX24p
CiAgICAgIHsgcmV0dXJuIF9NX2V4dHJhY3QoX19uKTsgfQoKICAgICAgX19pc3RyZWFtX3R5cGUm
CiAgICAgIG9wZXJhdG9yPj4odW5zaWduZWQgbG9uZyBsb25nJiBfX24pCiAgICAgIHsgcmV0dXJu
IF9NX2V4dHJhY3QoX19uKTsgfQojIDIxMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9pc3RyZWFt
IiAzCiAgICAgIF9faXN0cmVhbV90eXBlJgogICAgICBvcGVyYXRvcj4+KGZsb2F0JiBfX2YpCiAg
ICAgIHsgcmV0dXJuIF9NX2V4dHJhY3QoX19mKTsgfQoKICAgICAgX19pc3RyZWFtX3R5cGUmCiAg
ICAgIG9wZXJhdG9yPj4oZG91YmxlJiBfX2YpCiAgICAgIHsgcmV0dXJuIF9NX2V4dHJhY3QoX19m
KTsgfQoKICAgICAgX19pc3RyZWFtX3R5cGUmCiAgICAgIG9wZXJhdG9yPj4obG9uZyBkb3VibGUm
IF9fZikKICAgICAgeyByZXR1cm4gX01fZXh0cmFjdChfX2YpOyB9CiMgMjM0ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2lzdHJlYW0iIDMKICAgICAgX19pc3RyZWFtX3R5cGUmCiAgICAgIG9wZXJh
dG9yPj4odm9pZComIF9fcCkKICAgICAgeyByZXR1cm4gX01fZXh0cmFjdChfX3ApOyB9CiMgMjU4
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2lzdHJlYW0iIDMKICAgICAgX19pc3RyZWFtX3R5cGUm
CiAgICAgIG9wZXJhdG9yPj4oX19zdHJlYW1idWZfdHlwZSogX19zYik7CiMgMjY4ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2lzdHJlYW0iIDMKICAgICAgc3RyZWFtc2l6ZQogICAgICBnY291bnQo
KSBjb25zdAogICAgICB7IHJldHVybiBfTV9nY291bnQ7IH0KIyAzMDEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvaXN0cmVhbSIgMwogICAgICBpbnRfdHlwZQogICAgICBnZXQoKTsKIyAzMTUgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvaXN0cmVhbSIgMwogICAgICBfX2lzdHJlYW1fdHlwZSYKICAg
ICAgZ2V0KGNoYXJfdHlwZSYgX19jKTsKIyAzNDIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaXN0
cmVhbSIgMwogICAgICBfX2lzdHJlYW1fdHlwZSYKICAgICAgZ2V0KGNoYXJfdHlwZSogX19zLCBz
dHJlYW1zaXplIF9fbiwgY2hhcl90eXBlIF9fZGVsaW0pOwojIDM1MyAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9pc3RyZWFtIiAzCiAgICAgIF9faXN0cmVhbV90eXBlJgogICAgICBnZXQoY2hhcl90
eXBlKiBfX3MsIHN0cmVhbXNpemUgX19uKQogICAgICB7IHJldHVybiB0aGlzLT5nZXQoX19zLCBf
X24sIHRoaXMtPndpZGVuKCdcbicpKTsgfQojIDM3NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9p
c3RyZWFtIiAzCiAgICAgIF9faXN0cmVhbV90eXBlJgogICAgICBnZXQoX19zdHJlYW1idWZfdHlw
ZSYgX19zYiwgY2hhcl90eXBlIF9fZGVsaW0pOwojIDM4NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9pc3RyZWFtIiAzCiAgICAgIF9faXN0cmVhbV90eXBlJgogICAgICBnZXQoX19zdHJlYW1idWZf
dHlwZSYgX19zYikKICAgICAgeyByZXR1cm4gdGhpcy0+Z2V0KF9fc2IsIHRoaXMtPndpZGVuKCdc
bicpKTsgfQojIDQxNSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9pc3RyZWFtIiAzCiAgICAgIF9f
aXN0cmVhbV90eXBlJgogICAgICBnZXRsaW5lKGNoYXJfdHlwZSogX19zLCBzdHJlYW1zaXplIF9f
biwgY2hhcl90eXBlIF9fZGVsaW0pOwojIDQyNiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9pc3Ry
ZWFtIiAzCiAgICAgIF9faXN0cmVhbV90eXBlJgogICAgICBnZXRsaW5lKGNoYXJfdHlwZSogX19z
LCBzdHJlYW1zaXplIF9fbikKICAgICAgeyByZXR1cm4gdGhpcy0+Z2V0bGluZShfX3MsIF9fbiwg
dGhpcy0+d2lkZW4oJ1xuJykpOyB9CiMgNDUwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2lzdHJl
YW0iIDMKICAgICAgX19pc3RyZWFtX3R5cGUmCiAgICAgIGlnbm9yZShzdHJlYW1zaXplIF9fbiwg
aW50X3R5cGUgX19kZWxpbSk7CgogICAgICBfX2lzdHJlYW1fdHlwZSYKICAgICAgaWdub3JlKHN0
cmVhbXNpemUgX19uKTsKCiAgICAgIF9faXN0cmVhbV90eXBlJgogICAgICBpZ25vcmUoKTsKIyA0
NjcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaXN0cmVhbSIgMwogICAgICBpbnRfdHlwZQogICAg
ICBwZWVrKCk7CiMgNDg1ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2lzdHJlYW0iIDMKICAgICAg
X19pc3RyZWFtX3R5cGUmCiAgICAgIHJlYWQoY2hhcl90eXBlKiBfX3MsIHN0cmVhbXNpemUgX19u
KTsKIyA1MDQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaXN0cmVhbSIgMwogICAgICBzdHJlYW1z
aXplCiAgICAgIHJlYWRzb21lKGNoYXJfdHlwZSogX19zLCBzdHJlYW1zaXplIF9fbik7CiMgNTIx
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2lzdHJlYW0iIDMKICAgICAgX19pc3RyZWFtX3R5cGUm
CiAgICAgIHB1dGJhY2soY2hhcl90eXBlIF9fYyk7CiMgNTM3ICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2lzdHJlYW0iIDMKICAgICAgX19pc3RyZWFtX3R5cGUmCiAgICAgIHVuZ2V0KCk7CiMgNTU1
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2lzdHJlYW0iIDMKICAgICAgaW50CiAgICAgIHN5bmMo
KTsKIyA1NzAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaXN0cmVhbSIgMwogICAgICBwb3NfdHlw
ZQogICAgICB0ZWxsZygpOwojIDU4NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9pc3RyZWFtIiAz
CiAgICAgIF9faXN0cmVhbV90eXBlJgogICAgICBzZWVrZyhwb3NfdHlwZSk7CiMgNjAxICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2lzdHJlYW0iIDMKICAgICAgX19pc3RyZWFtX3R5cGUmCiAgICAg
IHNlZWtnKG9mZl90eXBlLCBpb3NfYmFzZTo6c2Vla2Rpcik7CgoKICAgIHByb3RlY3RlZDoKICAg
ICAgYmFzaWNfaXN0cmVhbSgpCiAgICAgIDogX01fZ2NvdW50KHN0cmVhbXNpemUoMCkpCiAgICAg
IHsgdGhpcy0+aW5pdCgwKTsgfQoKCiAgICAgIGJhc2ljX2lzdHJlYW0oY29uc3QgYmFzaWNfaXN0
cmVhbSYpID0gZGVsZXRlOwoKICAgICAgYmFzaWNfaXN0cmVhbShiYXNpY19pc3RyZWFtJiYgX19y
aHMpCiAgICAgIDogX19pb3NfdHlwZSgpLCBfTV9nY291bnQoX19yaHMuX01fZ2NvdW50KQogICAg
ICB7CiBfX2lvc190eXBlOjptb3ZlKF9fcmhzKTsKIF9fcmhzLl9NX2djb3VudCA9IDA7CiAgICAg
IH0KCgoKICAgICAgYmFzaWNfaXN0cmVhbSYgb3BlcmF0b3I9KGNvbnN0IGJhc2ljX2lzdHJlYW0m
KSA9IGRlbGV0ZTsKCiAgICAgIGJhc2ljX2lzdHJlYW0mCiAgICAgIG9wZXJhdG9yPShiYXNpY19p
c3RyZWFtJiYgX19yaHMpCiAgICAgIHsKIHN3YXAoX19yaHMpOwogcmV0dXJuICp0aGlzOwogICAg
ICB9CgogICAgICB2b2lkCiAgICAgIHN3YXAoYmFzaWNfaXN0cmVhbSYgX19yaHMpCiAgICAgIHsK
IF9faW9zX3R5cGU6OnN3YXAoX19yaHMpOwogc3RkOjpzd2FwKF9NX2djb3VudCwgX19yaHMuX01f
Z2NvdW50KTsKICAgICAgfQoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9WYWx1ZVQ+CiBfX2lz
dHJlYW1fdHlwZSYKIF9NX2V4dHJhY3QoX1ZhbHVlVCYgX192KTsKICAgIH07CgoKICB0ZW1wbGF0
ZTw+CiAgICBiYXNpY19pc3RyZWFtPGNoYXI+JgogICAgYmFzaWNfaXN0cmVhbTxjaGFyPjo6CiAg
ICBnZXRsaW5lKGNoYXJfdHlwZSogX19zLCBzdHJlYW1zaXplIF9fbiwgY2hhcl90eXBlIF9fZGVs
aW0pOwoKICB0ZW1wbGF0ZTw+CiAgICBiYXNpY19pc3RyZWFtPGNoYXI+JgogICAgYmFzaWNfaXN0
cmVhbTxjaGFyPjo6CiAgICBpZ25vcmUoc3RyZWFtc2l6ZSBfX24pOwoKICB0ZW1wbGF0ZTw+CiAg
ICBiYXNpY19pc3RyZWFtPGNoYXI+JgogICAgYmFzaWNfaXN0cmVhbTxjaGFyPjo6CiAgICBpZ25v
cmUoc3RyZWFtc2l6ZSBfX24sIGludF90eXBlIF9fZGVsaW0pOwoKCiAgdGVtcGxhdGU8PgogICAg
YmFzaWNfaXN0cmVhbTx3Y2hhcl90PiYKICAgIGJhc2ljX2lzdHJlYW08d2NoYXJfdD46OgogICAg
Z2V0bGluZShjaGFyX3R5cGUqIF9fcywgc3RyZWFtc2l6ZSBfX24sIGNoYXJfdHlwZSBfX2RlbGlt
KTsKCiAgdGVtcGxhdGU8PgogICAgYmFzaWNfaXN0cmVhbTx3Y2hhcl90PiYKICAgIGJhc2ljX2lz
dHJlYW08d2NoYXJfdD46OgogICAgaWdub3JlKHN0cmVhbXNpemUgX19uKTsKCiAgdGVtcGxhdGU8
PgogICAgYmFzaWNfaXN0cmVhbTx3Y2hhcl90PiYKICAgIGJhc2ljX2lzdHJlYW08d2NoYXJfdD46
OgogICAgaWdub3JlKHN0cmVhbXNpemUgX19uLCBpbnRfdHlwZSBfX2RlbGltKTsKIyA2ODUgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvaXN0cmVhbSIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFy
VCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIGNsYXNzIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJh
aXRzPjo6c2VudHJ5CiAgICB7CgogICAgICBib29sIF9NX29rOwoKICAgIHB1YmxpYzoKCiAgICAg
IHR5cGVkZWYgX1RyYWl0cyB0cmFpdHNfdHlwZTsKICAgICAgdHlwZWRlZiBiYXNpY19zdHJlYW1i
dWY8X0NoYXJULCBfVHJhaXRzPiBfX3N0cmVhbWJ1Zl90eXBlOwogICAgICB0eXBlZGVmIGJhc2lj
X2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiBfX2lzdHJlYW1fdHlwZTsKICAgICAgdHlwZWRlZiB0
eXBlbmFtZSBfX2lzdHJlYW1fdHlwZTo6X19jdHlwZV90eXBlIF9fY3R5cGVfdHlwZTsKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBfVHJhaXRzOjppbnRfdHlwZSBfX2ludF90eXBlOwojIDcyMSAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9pc3RyZWFtIiAzCiAgICAgIGV4cGxpY2l0CiAgICAgIHNlbnRy
eShiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mIF9faXMsIGJvb2wgX19ub3NraXB3cyA9
IGZhbHNlKTsKIyA3MzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaXN0cmVhbSIgMwogICAgICBl
eHBsaWNpdAoKICAgICAgb3BlcmF0b3IgYm9vbCgpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX29r
OyB9CiAgICB9OwojIDc1MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9pc3RyZWFtIiAzCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNfaXN0cmVh
bTxfQ2hhclQsIF9UcmFpdHM+JgogICAgb3BlcmF0b3I+PihiYXNpY19pc3RyZWFtPF9DaGFyVCwg
X1RyYWl0cz4mIF9faW4sIF9DaGFyVCYgX19jKTsKCiAgdGVtcGxhdGU8Y2xhc3MgX1RyYWl0cz4K
ICAgIGlubGluZSBiYXNpY19pc3RyZWFtPGNoYXIsIF9UcmFpdHM+JgogICAgb3BlcmF0b3I+Pihi
YXNpY19pc3RyZWFtPGNoYXIsIF9UcmFpdHM+JiBfX2luLCB1bnNpZ25lZCBjaGFyJiBfX2MpCiAg
ICB7IHJldHVybiAoX19pbiA+PiByZWludGVycHJldF9jYXN0PGNoYXImPihfX2MpKTsgfQoKICB0
ZW1wbGF0ZTxjbGFzcyBfVHJhaXRzPgogICAgaW5saW5lIGJhc2ljX2lzdHJlYW08Y2hhciwgX1Ry
YWl0cz4mCiAgICBvcGVyYXRvcj4+KGJhc2ljX2lzdHJlYW08Y2hhciwgX1RyYWl0cz4mIF9faW4s
IHNpZ25lZCBjaGFyJiBfX2MpCiAgICB7IHJldHVybiAoX19pbiA+PiByZWludGVycHJldF9jYXN0
PGNoYXImPihfX2MpKTsgfQojIDc5MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9pc3RyZWFtIiAz
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNf
aXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JgogICAgb3BlcmF0b3I+PihiYXNpY19pc3RyZWFtPF9D
aGFyVCwgX1RyYWl0cz4mIF9faW4sIF9DaGFyVCogX19zKTsKCgogIHRlbXBsYXRlPD4KICAgIGJh
c2ljX2lzdHJlYW08Y2hhcj4mCiAgICBvcGVyYXRvcj4+KGJhc2ljX2lzdHJlYW08Y2hhcj4mIF9f
aW4sIGNoYXIqIF9fcyk7CgogIHRlbXBsYXRlPGNsYXNzIF9UcmFpdHM+CiAgICBpbmxpbmUgYmFz
aWNfaXN0cmVhbTxjaGFyLCBfVHJhaXRzPiYKICAgIG9wZXJhdG9yPj4oYmFzaWNfaXN0cmVhbTxj
aGFyLCBfVHJhaXRzPiYgX19pbiwgdW5zaWduZWQgY2hhciogX19zKQogICAgeyByZXR1cm4gKF9f
aW4gPj4gcmVpbnRlcnByZXRfY2FzdDxjaGFyKj4oX19zKSk7IH0KCiAgdGVtcGxhdGU8Y2xhc3Mg
X1RyYWl0cz4KICAgIGlubGluZSBiYXNpY19pc3RyZWFtPGNoYXIsIF9UcmFpdHM+JgogICAgb3Bl
cmF0b3I+PihiYXNpY19pc3RyZWFtPGNoYXIsIF9UcmFpdHM+JiBfX2luLCBzaWduZWQgY2hhciog
X19zKQogICAgeyByZXR1cm4gKF9faW4gPj4gcmVpbnRlcnByZXRfY2FzdDxjaGFyKj4oX19zKSk7
IH0KIyA4MjMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaXN0cmVhbSIgMwogIHRlbXBsYXRlPHR5
cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIGNsYXNzIGJhc2ljX2lvc3RyZWFt
CiAgICA6IHB1YmxpYyBiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4sCiAgICAgIHB1Ymxp
YyBiYXNpY19vc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4KICAgIHsKICAgIHB1YmxpYzoKCgoKICAg
ICAgdHlwZWRlZiBfQ2hhclQgY2hhcl90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9UcmFp
dHM6OmludF90eXBlIGludF90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9UcmFpdHM6OnBv
c190eXBlIHBvc190eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9UcmFpdHM6Om9mZl90eXBl
IG9mZl90eXBlOwogICAgICB0eXBlZGVmIF9UcmFpdHMgdHJhaXRzX3R5cGU7CgoKICAgICAgdHlw
ZWRlZiBiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4gX19pc3RyZWFtX3R5cGU7CiAgICAg
IHR5cGVkZWYgYmFzaWNfb3N0cmVhbTxfQ2hhclQsIF9UcmFpdHM+IF9fb3N0cmVhbV90eXBlOwoK
CgoKCgoKICAgICAgZXhwbGljaXQKICAgICAgYmFzaWNfaW9zdHJlYW0oYmFzaWNfc3RyZWFtYnVm
PF9DaGFyVCwgX1RyYWl0cz4qIF9fc2IpCiAgICAgIDogX19pc3RyZWFtX3R5cGUoX19zYiksIF9f
b3N0cmVhbV90eXBlKF9fc2IpIHsgfQoKCgoKICAgICAgdmlydHVhbAogICAgICB+YmFzaWNfaW9z
dHJlYW0oKSB7IH0KCiAgICBwcm90ZWN0ZWQ6CiAgICAgIGJhc2ljX2lvc3RyZWFtKCkKICAgICAg
OiBfX2lzdHJlYW1fdHlwZSgpLCBfX29zdHJlYW1fdHlwZSgpIHsgfQoKCiAgICAgIGJhc2ljX2lv
c3RyZWFtKGNvbnN0IGJhc2ljX2lvc3RyZWFtJikgPSBkZWxldGU7CgogICAgICBiYXNpY19pb3N0
cmVhbShiYXNpY19pb3N0cmVhbSYmIF9fcmhzKQogICAgICA6IF9faXN0cmVhbV90eXBlKHN0ZDo6
bW92ZShfX3JocykpLCBfX29zdHJlYW1fdHlwZSgqdGhpcykKICAgICAgeyB9CgoKCiAgICAgIGJh
c2ljX2lvc3RyZWFtJiBvcGVyYXRvcj0oY29uc3QgYmFzaWNfaW9zdHJlYW0mKSA9IGRlbGV0ZTsK
CiAgICAgIGJhc2ljX2lvc3RyZWFtJgogICAgICBvcGVyYXRvcj0oYmFzaWNfaW9zdHJlYW0mJiBf
X3JocykKICAgICAgewogc3dhcChfX3Jocyk7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCiAgICAg
IHZvaWQKICAgICAgc3dhcChiYXNpY19pb3N0cmVhbSYgX19yaHMpCiAgICAgIHsgX19pc3RyZWFt
X3R5cGU6OnN3YXAoX19yaHMpOyB9CgogICAgfTsKIyA5MDYgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvaXN0cmVhbSIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0
cz4KICAgIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiYKICAgIHdzKGJhc2ljX2lzdHJl
YW08X0NoYXJULCBfVHJhaXRzPiYgX19pcyk7CiMgOTIyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2lzdHJlYW0iIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHMs
IHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4m
CiAgICBvcGVyYXRvcj4+KGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiYmIF9faXMsIF9U
cCYgX194KQogICAgewogICAgICBfX2lzID4+IF9feDsKICAgICAgcmV0dXJuIF9faXM7CiAgICB9
CgoKCn0KCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lzdHJlYW0udGNjIiAxIDMK
IyAzNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lzdHJlYW0udGNjIiAzCiAgICAgICAK
IyAzOCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2lzdHJlYW0udGNjIiAzCgoKCm5hbWVz
cGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNf
aXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+OjpzZW50cnk6OgogICAgc2VudHJ5KGJhc2ljX2lzdHJl
YW08X0NoYXJULCBfVHJhaXRzPiYgX19pbiwgYm9vbCBfX25vc2tpcCkgOiBfTV9vayhmYWxzZSkK
ICAgIHsKICAgICAgaW9zX2Jhc2U6Omlvc3RhdGUgX19lcnIgPSBpb3NfYmFzZTo6Z29vZGJpdDsK
ICAgICAgaWYgKF9faW4uZ29vZCgpKQogewogICBpZiAoX19pbi50aWUoKSkKICAgICBfX2luLnRp
ZSgpLT5mbHVzaCgpOwogICBpZiAoIV9fbm9za2lwICYmIGJvb2woX19pbi5mbGFncygpICYgaW9z
X2Jhc2U6OnNraXB3cykpCiAgICAgewogICAgICAgY29uc3QgX19pbnRfdHlwZSBfX2VvZiA9IHRy
YWl0c190eXBlOjplb2YoKTsKICAgICAgIF9fc3RyZWFtYnVmX3R5cGUqIF9fc2IgPSBfX2luLnJk
YnVmKCk7CiAgICAgICBfX2ludF90eXBlIF9fYyA9IF9fc2ItPnNnZXRjKCk7CgogICAgICAgY29u
c3QgX19jdHlwZV90eXBlJiBfX2N0ID0gX19jaGVja19mYWNldChfX2luLl9NX2N0eXBlKTsKICAg
ICAgIHdoaWxlICghdHJhaXRzX3R5cGU6OmVxX2ludF90eXBlKF9fYywgX19lb2YpCiAgICAgICAm
JiBfX2N0LmlzKGN0eXBlX2Jhc2U6OnNwYWNlLAogICAgdHJhaXRzX3R5cGU6OnRvX2NoYXJfdHlw
ZShfX2MpKSkKICBfX2MgPSBfX3NiLT5zbmV4dGMoKTsKCgoKCiAgICAgICBpZiAodHJhaXRzX3R5
cGU6OmVxX2ludF90eXBlKF9fYywgX19lb2YpKQogIF9fZXJyIHw9IGlvc19iYXNlOjplb2ZiaXQ7
CiAgICAgfQogfQoKICAgICAgaWYgKF9faW4uZ29vZCgpICYmIF9fZXJyID09IGlvc19iYXNlOjpn
b29kYml0KQogX01fb2sgPSB0cnVlOwogICAgICBlbHNlCiB7CiAgIF9fZXJyIHw9IGlvc19iYXNl
OjpmYWlsYml0OwogICBfX2luLnNldHN0YXRlKF9fZXJyKTsKIH0KICAgIH0KCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgdGVtcGxhdGU8dHlwZW5hbWUg
X1ZhbHVlVD4KICAgICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JgogICAgICBiYXNp
Y19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz46OgogICAgICBfTV9leHRyYWN0KF9WYWx1ZVQmIF9f
dikKICAgICAgewogc2VudHJ5IF9fY2VyYigqdGhpcywgZmFsc2UpOwogaWYgKF9fY2VyYikKICAg
ewogICAgIGlvc19iYXNlOjppb3N0YXRlIF9fZXJyID0gaW9zX2Jhc2U6Omdvb2RiaXQ7CiAgICAg
dHJ5CiAgICAgICB7CiAgY29uc3QgX19udW1fZ2V0X3R5cGUmIF9fbmcgPSBfX2NoZWNrX2ZhY2V0
KHRoaXMtPl9NX251bV9nZXQpOwogIF9fbmcuZ2V0KCp0aGlzLCAwLCAqdGhpcywgX19lcnIsIF9f
dik7CiAgICAgICB9CiAgICAgY2F0Y2goX19jeHhhYml2MTo6X19mb3JjZWRfdW53aW5kJikKICAg
ICAgIHsKICB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsKICB0aHJvdzsKICAg
ICAgIH0KICAgICBjYXRjaCguLi4pCiAgICAgICB7IHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNl
OjpiYWRiaXQpOyB9CiAgICAgaWYgKF9fZXJyKQogICAgICAgdGhpcy0+c2V0c3RhdGUoX19lcnIp
OwogICB9CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJU
LCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+Jgog
ICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIG9wZXJhdG9yPj4oc2hvcnQm
IF9fbikKICAgIHsKCgogICAgICBzZW50cnkgX19jZXJiKCp0aGlzLCBmYWxzZSk7CiAgICAgIGlm
IChfX2NlcmIpCiB7CiAgIGlvc19iYXNlOjppb3N0YXRlIF9fZXJyID0gaW9zX2Jhc2U6Omdvb2Ri
aXQ7CiAgIHRyeQogICAgIHsKICAgICAgIGxvbmcgX19sOwogICAgICAgY29uc3QgX19udW1fZ2V0
X3R5cGUmIF9fbmcgPSBfX2NoZWNrX2ZhY2V0KHRoaXMtPl9NX251bV9nZXQpOwogICAgICAgX19u
Zy5nZXQoKnRoaXMsIDAsICp0aGlzLCBfX2VyciwgX19sKTsKCgoKICAgICAgIGlmIChfX2wgPCBf
X2dudV9jeHg6Ol9fbnVtZXJpY190cmFpdHM8c2hvcnQ+OjpfX21pbikKICB7CiAgICBfX2VyciB8
PSBpb3NfYmFzZTo6ZmFpbGJpdDsKICAgIF9fbiA9IF9fZ251X2N4eDo6X19udW1lcmljX3RyYWl0
czxzaG9ydD46Ol9fbWluOwogIH0KICAgICAgIGVsc2UgaWYgKF9fbCA+IF9fZ251X2N4eDo6X19u
dW1lcmljX3RyYWl0czxzaG9ydD46Ol9fbWF4KQogIHsKICAgIF9fZXJyIHw9IGlvc19iYXNlOjpm
YWlsYml0OwogICAgX19uID0gX19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPHNob3J0Pjo6X19t
YXg7CiAgfQogICAgICAgZWxzZQogIF9fbiA9IHNob3J0KF9fbCk7CiAgICAgfQogICBjYXRjaChf
X2N4eGFiaXYxOjpfX2ZvcmNlZF91bndpbmQmKQogICAgIHsKICAgICAgIHRoaXMtPl9NX3NldHN0
YXRlKGlvc19iYXNlOjpiYWRiaXQpOwogICAgICAgdGhyb3c7CiAgICAgfQogICBjYXRjaCguLi4p
CiAgICAgeyB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsgfQogICBpZiAoX19l
cnIpCiAgICAgdGhpcy0+c2V0c3RhdGUoX19lcnIpOwogfQogICAgICByZXR1cm4gKnRoaXM7CiAg
ICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIGJh
c2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiYKICAgIGJhc2ljX2lzdHJlYW08X0NoYXJULCBf
VHJhaXRzPjo6CiAgICBvcGVyYXRvcj4+KGludCYgX19uKQogICAgewoKCiAgICAgIHNlbnRyeSBf
X2NlcmIoKnRoaXMsIGZhbHNlKTsKICAgICAgaWYgKF9fY2VyYikKIHsKICAgaW9zX2Jhc2U6Omlv
c3RhdGUgX19lcnIgPSBpb3NfYmFzZTo6Z29vZGJpdDsKICAgdHJ5CiAgICAgewogICAgICAgbG9u
ZyBfX2w7CiAgICAgICBjb25zdCBfX251bV9nZXRfdHlwZSYgX19uZyA9IF9fY2hlY2tfZmFjZXQo
dGhpcy0+X01fbnVtX2dldCk7CiAgICAgICBfX25nLmdldCgqdGhpcywgMCwgKnRoaXMsIF9fZXJy
LCBfX2wpOwoKCgogICAgICAgaWYgKF9fbCA8IF9fZ251X2N4eDo6X19udW1lcmljX3RyYWl0czxp
bnQ+OjpfX21pbikKICB7CiAgICBfX2VyciB8PSBpb3NfYmFzZTo6ZmFpbGJpdDsKICAgIF9fbiA9
IF9fZ251X2N4eDo6X19udW1lcmljX3RyYWl0czxpbnQ+OjpfX21pbjsKICB9CiAgICAgICBlbHNl
IGlmIChfX2wgPiBfX2dudV9jeHg6Ol9fbnVtZXJpY190cmFpdHM8aW50Pjo6X19tYXgpCiAgewog
ICAgX19lcnIgfD0gaW9zX2Jhc2U6OmZhaWxiaXQ7CiAgICBfX24gPSBfX2dudV9jeHg6Ol9fbnVt
ZXJpY190cmFpdHM8aW50Pjo6X19tYXg7CiAgfQogICAgICAgZWxzZQogIF9fbiA9IGludChfX2wp
OwogICAgIH0KICAgY2F0Y2goX19jeHhhYml2MTo6X19mb3JjZWRfdW53aW5kJikKICAgICB7CiAg
ICAgICB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsKICAgICAgIHRocm93Owog
ICAgIH0KICAgY2F0Y2goLi4uKQogICAgIHsgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jhc2U6OmJh
ZGJpdCk7IH0KICAgaWYgKF9fZXJyKQogICAgIHRoaXMtPnNldHN0YXRlKF9fZXJyKTsKIH0KICAg
ICAgcmV0dXJuICp0aGlzOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVu
YW1lIF9UcmFpdHM+CiAgICBiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBiYXNp
Y19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz46OgogICAgb3BlcmF0b3I+PihfX3N0cmVhbWJ1Zl90
eXBlKiBfX3Nib3V0KQogICAgewogICAgICBpb3NfYmFzZTo6aW9zdGF0ZSBfX2VyciA9IGlvc19i
YXNlOjpnb29kYml0OwogICAgICBzZW50cnkgX19jZXJiKCp0aGlzLCBmYWxzZSk7CiAgICAgIGlm
IChfX2NlcmIgJiYgX19zYm91dCkKIHsKICAgdHJ5CiAgICAgewogICAgICAgYm9vbCBfX2luZW9m
OwogICAgICAgaWYgKCFfX2NvcHlfc3RyZWFtYnVmc19lb2YodGhpcy0+cmRidWYoKSwgX19zYm91
dCwgX19pbmVvZikpCiAgX19lcnIgfD0gaW9zX2Jhc2U6OmZhaWxiaXQ7CiAgICAgICBpZiAoX19p
bmVvZikKICBfX2VyciB8PSBpb3NfYmFzZTo6ZW9mYml0OwogICAgIH0KICAgY2F0Y2goX19jeHhh
Yml2MTo6X19mb3JjZWRfdW53aW5kJikKICAgICB7CiAgICAgICB0aGlzLT5fTV9zZXRzdGF0ZShp
b3NfYmFzZTo6ZmFpbGJpdCk7CiAgICAgICB0aHJvdzsKICAgICB9CiAgIGNhdGNoKC4uLikKICAg
ICB7IHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNlOjpmYWlsYml0KTsgfQogfQogICAgICBlbHNl
IGlmICghX19zYm91dCkKIF9fZXJyIHw9IGlvc19iYXNlOjpmYWlsYml0OwogICAgICBpZiAoX19l
cnIpCiB0aGlzLT5zZXRzdGF0ZShfX2Vycik7CiAgICAgIHJldHVybiAqdGhpczsKICAgIH0KCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgdHlwZW5hbWUg
YmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+OjppbnRfdHlwZQogICAgYmFzaWNfaXN0cmVh
bTxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIGdldCh2b2lkKQogICAgewogICAgICBjb25zdCBpbnRf
dHlwZSBfX2VvZiA9IHRyYWl0c190eXBlOjplb2YoKTsKICAgICAgaW50X3R5cGUgX19jID0gX19l
b2Y7CiAgICAgIF9NX2djb3VudCA9IDA7CiAgICAgIGlvc19iYXNlOjppb3N0YXRlIF9fZXJyID0g
aW9zX2Jhc2U6Omdvb2RiaXQ7CiAgICAgIHNlbnRyeSBfX2NlcmIoKnRoaXMsIHRydWUpOwogICAg
ICBpZiAoX19jZXJiKQogewogICB0cnkKICAgICB7CiAgICAgICBfX2MgPSB0aGlzLT5yZGJ1Zigp
LT5zYnVtcGMoKTsKCiAgICAgICBpZiAoIXRyYWl0c190eXBlOjplcV9pbnRfdHlwZShfX2MsIF9f
ZW9mKSkKICBfTV9nY291bnQgPSAxOwogICAgICAgZWxzZQogIF9fZXJyIHw9IGlvc19iYXNlOjpl
b2ZiaXQ7CiAgICAgfQogICBjYXRjaChfX2N4eGFiaXYxOjpfX2ZvcmNlZF91bndpbmQmKQogICAg
IHsKICAgICAgIHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOwogICAgICAgdGhy
b3c7CiAgICAgfQogICBjYXRjaCguLi4pCiAgICAgeyB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFz
ZTo6YmFkYml0KTsgfQogfQogICAgICBpZiAoIV9NX2djb3VudCkKIF9fZXJyIHw9IGlvc19iYXNl
OjpmYWlsYml0OwogICAgICBpZiAoX19lcnIpCiB0aGlzLT5zZXRzdGF0ZShfX2Vycik7CiAgICAg
IHJldHVybiBfX2M7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUg
X1RyYWl0cz4KICAgIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiYKICAgIGJhc2ljX2lz
dHJlYW08X0NoYXJULCBfVHJhaXRzPjo6CiAgICBnZXQoY2hhcl90eXBlJiBfX2MpCiAgICB7CiAg
ICAgIF9NX2djb3VudCA9IDA7CiAgICAgIGlvc19iYXNlOjppb3N0YXRlIF9fZXJyID0gaW9zX2Jh
c2U6Omdvb2RiaXQ7CiAgICAgIHNlbnRyeSBfX2NlcmIoKnRoaXMsIHRydWUpOwogICAgICBpZiAo
X19jZXJiKQogewogICB0cnkKICAgICB7CiAgICAgICBjb25zdCBpbnRfdHlwZSBfX2NiID0gdGhp
cy0+cmRidWYoKS0+c2J1bXBjKCk7CgogICAgICAgaWYgKCF0cmFpdHNfdHlwZTo6ZXFfaW50X3R5
cGUoX19jYiwgdHJhaXRzX3R5cGU6OmVvZigpKSkKICB7CiAgICBfTV9nY291bnQgPSAxOwogICAg
X19jID0gdHJhaXRzX3R5cGU6OnRvX2NoYXJfdHlwZShfX2NiKTsKICB9CiAgICAgICBlbHNlCiAg
X19lcnIgfD0gaW9zX2Jhc2U6OmVvZmJpdDsKICAgICB9CiAgIGNhdGNoKF9fY3h4YWJpdjE6Ol9f
Zm9yY2VkX3Vud2luZCYpCiAgICAgewogICAgICAgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jhc2U6
OmJhZGJpdCk7CiAgICAgICB0aHJvdzsKICAgICB9CiAgIGNhdGNoKC4uLikKICAgICB7IHRoaXMt
Pl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOyB9CiB9CiAgICAgIGlmICghX01fZ2NvdW50
KQogX19lcnIgfD0gaW9zX2Jhc2U6OmZhaWxiaXQ7CiAgICAgIGlmIChfX2VycikKIHRoaXMtPnNl
dHN0YXRlKF9fZXJyKTsKICAgICAgcmV0dXJuICp0aGlzOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBiYXNpY19pc3RyZWFtPF9DaGFyVCwg
X1RyYWl0cz4mCiAgICBiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz46OgogICAgZ2V0KGNo
YXJfdHlwZSogX19zLCBzdHJlYW1zaXplIF9fbiwgY2hhcl90eXBlIF9fZGVsaW0pCiAgICB7CiAg
ICAgIF9NX2djb3VudCA9IDA7CiAgICAgIGlvc19iYXNlOjppb3N0YXRlIF9fZXJyID0gaW9zX2Jh
c2U6Omdvb2RiaXQ7CiAgICAgIHNlbnRyeSBfX2NlcmIoKnRoaXMsIHRydWUpOwogICAgICBpZiAo
X19jZXJiKQogewogICB0cnkKICAgICB7CiAgICAgICBjb25zdCBpbnRfdHlwZSBfX2lkZWxpbSA9
IHRyYWl0c190eXBlOjp0b19pbnRfdHlwZShfX2RlbGltKTsKICAgICAgIGNvbnN0IGludF90eXBl
IF9fZW9mID0gdHJhaXRzX3R5cGU6OmVvZigpOwogICAgICAgX19zdHJlYW1idWZfdHlwZSogX19z
YiA9IHRoaXMtPnJkYnVmKCk7CiAgICAgICBpbnRfdHlwZSBfX2MgPSBfX3NiLT5zZ2V0YygpOwoK
ICAgICAgIHdoaWxlIChfTV9nY291bnQgKyAxIDwgX19uCiAgICAgICAmJiAhdHJhaXRzX3R5cGU6
OmVxX2ludF90eXBlKF9fYywgX19lb2YpCiAgICAgICAmJiAhdHJhaXRzX3R5cGU6OmVxX2ludF90
eXBlKF9fYywgX19pZGVsaW0pKQogIHsKICAgICpfX3MrKyA9IHRyYWl0c190eXBlOjp0b19jaGFy
X3R5cGUoX19jKTsKICAgICsrX01fZ2NvdW50OwogICAgX19jID0gX19zYi0+c25leHRjKCk7CiAg
fQogICAgICAgaWYgKHRyYWl0c190eXBlOjplcV9pbnRfdHlwZShfX2MsIF9fZW9mKSkKICBfX2Vy
ciB8PSBpb3NfYmFzZTo6ZW9mYml0OwogICAgIH0KICAgY2F0Y2goX19jeHhhYml2MTo6X19mb3Jj
ZWRfdW53aW5kJikKICAgICB7CiAgICAgICB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFk
Yml0KTsKICAgICAgIHRocm93OwogICAgIH0KICAgY2F0Y2goLi4uKQogICAgIHsgdGhpcy0+X01f
c2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJpdCk7IH0KIH0KCgogICAgICBpZiAoX19uID4gMCkKICpf
X3MgPSBjaGFyX3R5cGUoKTsKICAgICAgaWYgKCFfTV9nY291bnQpCiBfX2VyciB8PSBpb3NfYmFz
ZTo6ZmFpbGJpdDsKICAgICAgaWYgKF9fZXJyKQogdGhpcy0+c2V0c3RhdGUoX19lcnIpOwogICAg
ICByZXR1cm4gKnRoaXM7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5h
bWUgX1RyYWl0cz4KICAgIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiYKICAgIGJhc2lj
X2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPjo6CiAgICBnZXQoX19zdHJlYW1idWZfdHlwZSYgX19z
YiwgY2hhcl90eXBlIF9fZGVsaW0pCiAgICB7CiAgICAgIF9NX2djb3VudCA9IDA7CiAgICAgIGlv
c19iYXNlOjppb3N0YXRlIF9fZXJyID0gaW9zX2Jhc2U6Omdvb2RiaXQ7CiAgICAgIHNlbnRyeSBf
X2NlcmIoKnRoaXMsIHRydWUpOwogICAgICBpZiAoX19jZXJiKQogewogICB0cnkKICAgICB7CiAg
ICAgICBjb25zdCBpbnRfdHlwZSBfX2lkZWxpbSA9IHRyYWl0c190eXBlOjp0b19pbnRfdHlwZShf
X2RlbGltKTsKICAgICAgIGNvbnN0IGludF90eXBlIF9fZW9mID0gdHJhaXRzX3R5cGU6OmVvZigp
OwogICAgICAgX19zdHJlYW1idWZfdHlwZSogX190aGlzX3NiID0gdGhpcy0+cmRidWYoKTsKICAg
ICAgIGludF90eXBlIF9fYyA9IF9fdGhpc19zYi0+c2dldGMoKTsKICAgICAgIGNoYXJfdHlwZSBf
X2MyID0gdHJhaXRzX3R5cGU6OnRvX2NoYXJfdHlwZShfX2MpOwoKICAgICAgIHdoaWxlICghdHJh
aXRzX3R5cGU6OmVxX2ludF90eXBlKF9fYywgX19lb2YpCiAgICAgICAmJiAhdHJhaXRzX3R5cGU6
OmVxX2ludF90eXBlKF9fYywgX19pZGVsaW0pCiAgICAgICAmJiAhdHJhaXRzX3R5cGU6OmVxX2lu
dF90eXBlKF9fc2Iuc3B1dGMoX19jMiksIF9fZW9mKSkKICB7CiAgICArK19NX2djb3VudDsKICAg
IF9fYyA9IF9fdGhpc19zYi0+c25leHRjKCk7CiAgICBfX2MyID0gdHJhaXRzX3R5cGU6OnRvX2No
YXJfdHlwZShfX2MpOwogIH0KICAgICAgIGlmICh0cmFpdHNfdHlwZTo6ZXFfaW50X3R5cGUoX19j
LCBfX2VvZikpCiAgX19lcnIgfD0gaW9zX2Jhc2U6OmVvZmJpdDsKICAgICB9CiAgIGNhdGNoKF9f
Y3h4YWJpdjE6Ol9fZm9yY2VkX3Vud2luZCYpCiAgICAgewogICAgICAgdGhpcy0+X01fc2V0c3Rh
dGUoaW9zX2Jhc2U6OmJhZGJpdCk7CiAgICAgICB0aHJvdzsKICAgICB9CiAgIGNhdGNoKC4uLikK
ICAgICB7IHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOyB9CiB9CiAgICAgIGlm
ICghX01fZ2NvdW50KQogX19lcnIgfD0gaW9zX2Jhc2U6OmZhaWxiaXQ7CiAgICAgIGlmIChfX2Vy
cikKIHRoaXMtPnNldHN0YXRlKF9fZXJyKTsKICAgICAgcmV0dXJuICp0aGlzOwogICAgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBiYXNpY19pc3Ry
ZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz46
OgogICAgZ2V0bGluZShjaGFyX3R5cGUqIF9fcywgc3RyZWFtc2l6ZSBfX24sIGNoYXJfdHlwZSBf
X2RlbGltKQogICAgewogICAgICBfTV9nY291bnQgPSAwOwogICAgICBpb3NfYmFzZTo6aW9zdGF0
ZSBfX2VyciA9IGlvc19iYXNlOjpnb29kYml0OwogICAgICBzZW50cnkgX19jZXJiKCp0aGlzLCB0
cnVlKTsKICAgICAgaWYgKF9fY2VyYikKICAgICAgICB7CiAgICAgICAgICB0cnkKICAgICAgICAg
ICAgewogICAgICAgICAgICAgIGNvbnN0IGludF90eXBlIF9faWRlbGltID0gdHJhaXRzX3R5cGU6
OnRvX2ludF90eXBlKF9fZGVsaW0pOwogICAgICAgICAgICAgIGNvbnN0IGludF90eXBlIF9fZW9m
ID0gdHJhaXRzX3R5cGU6OmVvZigpOwogICAgICAgICAgICAgIF9fc3RyZWFtYnVmX3R5cGUqIF9f
c2IgPSB0aGlzLT5yZGJ1ZigpOwogICAgICAgICAgICAgIGludF90eXBlIF9fYyA9IF9fc2ItPnNn
ZXRjKCk7CgogICAgICAgICAgICAgIHdoaWxlIChfTV9nY291bnQgKyAxIDwgX19uCiAgICAgICAg
ICAgICAgICAgICAgICYmICF0cmFpdHNfdHlwZTo6ZXFfaW50X3R5cGUoX19jLCBfX2VvZikKICAg
ICAgICAgICAgICAgICAgICAgJiYgIXRyYWl0c190eXBlOjplcV9pbnRfdHlwZShfX2MsIF9faWRl
bGltKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgKl9fcysrID0gdHJhaXRz
X3R5cGU6OnRvX2NoYXJfdHlwZShfX2MpOwogICAgICAgICAgICAgICAgICBfX2MgPSBfX3NiLT5z
bmV4dGMoKTsKICAgICAgICAgICAgICAgICAgKytfTV9nY291bnQ7CiAgICAgICAgICAgICAgICB9
CiAgICAgICAgICAgICAgaWYgKHRyYWl0c190eXBlOjplcV9pbnRfdHlwZShfX2MsIF9fZW9mKSkK
ICAgICAgICAgICAgICAgIF9fZXJyIHw9IGlvc19iYXNlOjplb2ZiaXQ7CiAgICAgICAgICAgICAg
ZWxzZQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICBpZiAodHJhaXRzX3R5cGU6
OmVxX2ludF90eXBlKF9fYywgX19pZGVsaW0pKQogICAgICAgICAgICAgICAgICAgIHsKICAgICAg
ICAgICAgICAgICAgICAgIF9fc2ItPnNidW1wYygpOwogICAgICAgICAgICAgICAgICAgICAgKytf
TV9nY291bnQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBlbHNlCiAg
ICAgICAgICAgICAgICAgICAgX19lcnIgfD0gaW9zX2Jhc2U6OmZhaWxiaXQ7CiAgICAgICAgICAg
ICAgICB9CiAgICAgICAgICAgIH0KICAgY2F0Y2goX19jeHhhYml2MTo6X19mb3JjZWRfdW53aW5k
JikKICAgICB7CiAgICAgICB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsKICAg
ICAgIHRocm93OwogICAgIH0KICAgICAgICAgIGNhdGNoKC4uLikKICAgICAgICAgICAgeyB0aGlz
LT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsgfQogICAgICAgIH0KCgogICAgICBpZiAo
X19uID4gMCkKICpfX3MgPSBjaGFyX3R5cGUoKTsKICAgICAgaWYgKCFfTV9nY291bnQpCiAgICAg
ICAgX19lcnIgfD0gaW9zX2Jhc2U6OmZhaWxiaXQ7CiAgICAgIGlmIChfX2VycikKICAgICAgICB0
aGlzLT5zZXRzdGF0ZShfX2Vycik7CiAgICAgIHJldHVybiAqdGhpczsKICAgIH0KCgoKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNfaXN0cmVh
bTxfQ2hhclQsIF9UcmFpdHM+JgogICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+OjoK
ICAgIGlnbm9yZSh2b2lkKQogICAgewogICAgICBfTV9nY291bnQgPSAwOwogICAgICBzZW50cnkg
X19jZXJiKCp0aGlzLCB0cnVlKTsKICAgICAgaWYgKF9fY2VyYikKIHsKICAgaW9zX2Jhc2U6Omlv
c3RhdGUgX19lcnIgPSBpb3NfYmFzZTo6Z29vZGJpdDsKICAgdHJ5CiAgICAgewogICAgICAgY29u
c3QgaW50X3R5cGUgX19lb2YgPSB0cmFpdHNfdHlwZTo6ZW9mKCk7CiAgICAgICBfX3N0cmVhbWJ1
Zl90eXBlKiBfX3NiID0gdGhpcy0+cmRidWYoKTsKCiAgICAgICBpZiAodHJhaXRzX3R5cGU6OmVx
X2ludF90eXBlKF9fc2ItPnNidW1wYygpLCBfX2VvZikpCiAgX19lcnIgfD0gaW9zX2Jhc2U6OmVv
ZmJpdDsKICAgICAgIGVsc2UKICBfTV9nY291bnQgPSAxOwogICAgIH0KICAgY2F0Y2goX19jeHhh
Yml2MTo6X19mb3JjZWRfdW53aW5kJikKICAgICB7CiAgICAgICB0aGlzLT5fTV9zZXRzdGF0ZShp
b3NfYmFzZTo6YmFkYml0KTsKICAgICAgIHRocm93OwogICAgIH0KICAgY2F0Y2goLi4uKQogICAg
IHsgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJpdCk7IH0KICAgaWYgKF9fZXJyKQog
ICAgIHRoaXMtPnNldHN0YXRlKF9fZXJyKTsKIH0KICAgICAgcmV0dXJuICp0aGlzOwogICAgfQoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBiYXNpY19p
c3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0
cz46OgogICAgaWdub3JlKHN0cmVhbXNpemUgX19uKQogICAgewogICAgICBfTV9nY291bnQgPSAw
OwogICAgICBzZW50cnkgX19jZXJiKCp0aGlzLCB0cnVlKTsKICAgICAgaWYgKF9fY2VyYiAmJiBf
X24gPiAwKQogICAgICAgIHsKICAgICAgICAgIGlvc19iYXNlOjppb3N0YXRlIF9fZXJyID0gaW9z
X2Jhc2U6Omdvb2RiaXQ7CiAgICAgICAgICB0cnkKICAgICAgICAgICAgewogICAgICAgICAgICAg
IGNvbnN0IGludF90eXBlIF9fZW9mID0gdHJhaXRzX3R5cGU6OmVvZigpOwogICAgICAgICAgICAg
IF9fc3RyZWFtYnVmX3R5cGUqIF9fc2IgPSB0aGlzLT5yZGJ1ZigpOwogICAgICAgICAgICAgIGlu
dF90eXBlIF9fYyA9IF9fc2ItPnNnZXRjKCk7CiMgNTEzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvaXN0cmVhbS50Y2MiIDMKICAgICAgIGJvb2wgX19sYXJnZV9pZ25vcmUgPSBmYWxzZTsK
ICAgICAgIHdoaWxlICh0cnVlKQogIHsKICAgIHdoaWxlIChfTV9nY291bnQgPCBfX24KICAgICYm
ICF0cmFpdHNfdHlwZTo6ZXFfaW50X3R5cGUoX19jLCBfX2VvZikpCiAgICAgIHsKICAgICAgICAr
K19NX2djb3VudDsKICAgICAgICBfX2MgPSBfX3NiLT5zbmV4dGMoKTsKICAgICAgfQogICAgaWYg
KF9fbiA9PSBfX2dudV9jeHg6Ol9fbnVtZXJpY190cmFpdHM8c3RyZWFtc2l6ZT46Ol9fbWF4CiAg
ICAgICAgJiYgIXRyYWl0c190eXBlOjplcV9pbnRfdHlwZShfX2MsIF9fZW9mKSkKICAgICAgewog
ICAgICAgIF9NX2djb3VudCA9CiAgIF9fZ251X2N4eDo6X19udW1lcmljX3RyYWl0czxzdHJlYW1z
aXplPjo6X19taW47CiAgICAgICAgX19sYXJnZV9pZ25vcmUgPSB0cnVlOwogICAgICB9CiAgICBl
bHNlCiAgICAgIGJyZWFrOwogIH0KCiAgICAgICBpZiAoX19sYXJnZV9pZ25vcmUpCiAgX01fZ2Nv
dW50ID0gX19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPHN0cmVhbXNpemU+OjpfX21heDsKCiAg
ICAgICBpZiAodHJhaXRzX3R5cGU6OmVxX2ludF90eXBlKF9fYywgX19lb2YpKQogICAgICAgICAg
ICAgICAgX19lcnIgfD0gaW9zX2Jhc2U6OmVvZmJpdDsKICAgICAgICAgICAgfQogICBjYXRjaChf
X2N4eGFiaXYxOjpfX2ZvcmNlZF91bndpbmQmKQogICAgIHsKICAgICAgIHRoaXMtPl9NX3NldHN0
YXRlKGlvc19iYXNlOjpiYWRiaXQpOwogICAgICAgdGhyb3c7CiAgICAgfQogICAgICAgICAgY2F0
Y2goLi4uKQogICAgICAgICAgICB7IHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQp
OyB9CiAgICAgICAgICBpZiAoX19lcnIpCiAgICAgICAgICAgIHRoaXMtPnNldHN0YXRlKF9fZXJy
KTsKICAgICAgICB9CiAgICAgIHJldHVybiAqdGhpczsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9U
cmFpdHM+JgogICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIGlnbm9yZShz
dHJlYW1zaXplIF9fbiwgaW50X3R5cGUgX19kZWxpbSkKICAgIHsKICAgICAgX01fZ2NvdW50ID0g
MDsKICAgICAgc2VudHJ5IF9fY2VyYigqdGhpcywgdHJ1ZSk7CiAgICAgIGlmIChfX2NlcmIgJiYg
X19uID4gMCkKICAgICAgICB7CiAgICAgICAgICBpb3NfYmFzZTo6aW9zdGF0ZSBfX2VyciA9IGlv
c19iYXNlOjpnb29kYml0OwogICAgICAgICAgdHJ5CiAgICAgICAgICAgIHsKICAgICAgICAgICAg
ICBjb25zdCBpbnRfdHlwZSBfX2VvZiA9IHRyYWl0c190eXBlOjplb2YoKTsKICAgICAgICAgICAg
ICBfX3N0cmVhbWJ1Zl90eXBlKiBfX3NiID0gdGhpcy0+cmRidWYoKTsKICAgICAgICAgICAgICBp
bnRfdHlwZSBfX2MgPSBfX3NiLT5zZ2V0YygpOwoKCiAgICAgICBib29sIF9fbGFyZ2VfaWdub3Jl
ID0gZmFsc2U7CiAgICAgICB3aGlsZSAodHJ1ZSkKICB7CiAgICB3aGlsZSAoX01fZ2NvdW50IDwg
X19uCiAgICAmJiAhdHJhaXRzX3R5cGU6OmVxX2ludF90eXBlKF9fYywgX19lb2YpCiAgICAmJiAh
dHJhaXRzX3R5cGU6OmVxX2ludF90eXBlKF9fYywgX19kZWxpbSkpCiAgICAgIHsKICAgICAgICAr
K19NX2djb3VudDsKICAgICAgICBfX2MgPSBfX3NiLT5zbmV4dGMoKTsKICAgICAgfQogICAgaWYg
KF9fbiA9PSBfX2dudV9jeHg6Ol9fbnVtZXJpY190cmFpdHM8c3RyZWFtc2l6ZT46Ol9fbWF4CiAg
ICAgICAgJiYgIXRyYWl0c190eXBlOjplcV9pbnRfdHlwZShfX2MsIF9fZW9mKQogICAgICAgICYm
ICF0cmFpdHNfdHlwZTo6ZXFfaW50X3R5cGUoX19jLCBfX2RlbGltKSkKICAgICAgewogICAgICAg
IF9NX2djb3VudCA9CiAgIF9fZ251X2N4eDo6X19udW1lcmljX3RyYWl0czxzdHJlYW1zaXplPjo6
X19taW47CiAgICAgICAgX19sYXJnZV9pZ25vcmUgPSB0cnVlOwogICAgICB9CiAgICBlbHNlCiAg
ICAgIGJyZWFrOwogIH0KCiAgICAgICBpZiAoX19sYXJnZV9pZ25vcmUpCiAgX01fZ2NvdW50ID0g
X19nbnVfY3h4OjpfX251bWVyaWNfdHJhaXRzPHN0cmVhbXNpemU+OjpfX21heDsKCiAgICAgICAg
ICAgICAgaWYgKHRyYWl0c190eXBlOjplcV9pbnRfdHlwZShfX2MsIF9fZW9mKSkKICAgICAgICAg
ICAgICAgIF9fZXJyIHw9IGlvc19iYXNlOjplb2ZiaXQ7CiAgICAgICBlbHNlIGlmICh0cmFpdHNf
dHlwZTo6ZXFfaW50X3R5cGUoX19jLCBfX2RlbGltKSkKICB7CiAgICBpZiAoX01fZ2NvdW50CiAg
ICAgICAgPCBfX2dudV9jeHg6Ol9fbnVtZXJpY190cmFpdHM8c3RyZWFtc2l6ZT46Ol9fbWF4KQog
ICAgICArK19NX2djb3VudDsKICAgIF9fc2ItPnNidW1wYygpOwogIH0KICAgICAgICAgICAgfQog
ICBjYXRjaChfX2N4eGFiaXYxOjpfX2ZvcmNlZF91bndpbmQmKQogICAgIHsKICAgICAgIHRoaXMt
Pl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOwogICAgICAgdGhyb3c7CiAgICAgfQogICAg
ICAgICAgY2F0Y2goLi4uKQogICAgICAgICAgICB7IHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNl
OjpiYWRiaXQpOyB9CiAgICAgICAgICBpZiAoX19lcnIpCiAgICAgICAgICAgIHRoaXMtPnNldHN0
YXRlKF9fZXJyKTsKICAgICAgICB9CiAgICAgIHJldHVybiAqdGhpczsKICAgIH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgdHlwZW5hbWUgYmFzaWNf
aXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+OjppbnRfdHlwZQogICAgYmFzaWNfaXN0cmVhbTxfQ2hh
clQsIF9UcmFpdHM+OjoKICAgIHBlZWsodm9pZCkKICAgIHsKICAgICAgaW50X3R5cGUgX19jID0g
dHJhaXRzX3R5cGU6OmVvZigpOwogICAgICBfTV9nY291bnQgPSAwOwogICAgICBzZW50cnkgX19j
ZXJiKCp0aGlzLCB0cnVlKTsKICAgICAgaWYgKF9fY2VyYikKIHsKICAgaW9zX2Jhc2U6Omlvc3Rh
dGUgX19lcnIgPSBpb3NfYmFzZTo6Z29vZGJpdDsKICAgdHJ5CiAgICAgewogICAgICAgX19jID0g
dGhpcy0+cmRidWYoKS0+c2dldGMoKTsKICAgICAgIGlmICh0cmFpdHNfdHlwZTo6ZXFfaW50X3R5
cGUoX19jLCB0cmFpdHNfdHlwZTo6ZW9mKCkpKQogIF9fZXJyIHw9IGlvc19iYXNlOjplb2ZiaXQ7
CiAgICAgfQogICBjYXRjaChfX2N4eGFiaXYxOjpfX2ZvcmNlZF91bndpbmQmKQogICAgIHsKICAg
ICAgIHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOwogICAgICAgdGhyb3c7CiAg
ICAgfQogICBjYXRjaCguLi4pCiAgICAgeyB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFk
Yml0KTsgfQogICBpZiAoX19lcnIpCiAgICAgdGhpcy0+c2V0c3RhdGUoX19lcnIpOwogfQogICAg
ICByZXR1cm4gX19jOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1l
IF9UcmFpdHM+CiAgICBiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4mCiAgICBiYXNpY19p
c3RyZWFtPF9DaGFyVCwgX1RyYWl0cz46OgogICAgcmVhZChjaGFyX3R5cGUqIF9fcywgc3RyZWFt
c2l6ZSBfX24pCiAgICB7CiAgICAgIF9NX2djb3VudCA9IDA7CiAgICAgIHNlbnRyeSBfX2NlcmIo
KnRoaXMsIHRydWUpOwogICAgICBpZiAoX19jZXJiKQogewogICBpb3NfYmFzZTo6aW9zdGF0ZSBf
X2VyciA9IGlvc19iYXNlOjpnb29kYml0OwogICB0cnkKICAgICB7CiAgICAgICBfTV9nY291bnQg
PSB0aGlzLT5yZGJ1ZigpLT5zZ2V0bihfX3MsIF9fbik7CiAgICAgICBpZiAoX01fZ2NvdW50ICE9
IF9fbikKICBfX2VyciB8PSAoaW9zX2Jhc2U6OmVvZmJpdCB8IGlvc19iYXNlOjpmYWlsYml0KTsK
ICAgICB9CiAgIGNhdGNoKF9fY3h4YWJpdjE6Ol9fZm9yY2VkX3Vud2luZCYpCiAgICAgewogICAg
ICAgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJpdCk7CiAgICAgICB0aHJvdzsKICAg
ICB9CiAgIGNhdGNoKC4uLikKICAgICB7IHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRi
aXQpOyB9CiAgIGlmIChfX2VycikKICAgICB0aGlzLT5zZXRzdGF0ZShfX2Vycik7CiB9CiAgICAg
IHJldHVybiAqdGhpczsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFt
ZSBfVHJhaXRzPgogICAgc3RyZWFtc2l6ZQogICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFp
dHM+OjoKICAgIHJlYWRzb21lKGNoYXJfdHlwZSogX19zLCBzdHJlYW1zaXplIF9fbikKICAgIHsK
ICAgICAgX01fZ2NvdW50ID0gMDsKICAgICAgc2VudHJ5IF9fY2VyYigqdGhpcywgdHJ1ZSk7CiAg
ICAgIGlmIChfX2NlcmIpCiB7CiAgIGlvc19iYXNlOjppb3N0YXRlIF9fZXJyID0gaW9zX2Jhc2U6
Omdvb2RiaXQ7CiAgIHRyeQogICAgIHsKCiAgICAgICBjb25zdCBzdHJlYW1zaXplIF9fbnVtID0g
dGhpcy0+cmRidWYoKS0+aW5fYXZhaWwoKTsKICAgICAgIGlmIChfX251bSA+IDApCiAgX01fZ2Nv
dW50ID0gdGhpcy0+cmRidWYoKS0+c2dldG4oX19zLCBzdGQ6Om1pbihfX251bSwgX19uKSk7CiAg
ICAgICBlbHNlIGlmIChfX251bSA9PSAtMSkKICBfX2VyciB8PSBpb3NfYmFzZTo6ZW9mYml0Owog
ICAgIH0KICAgY2F0Y2goX19jeHhhYml2MTo6X19mb3JjZWRfdW53aW5kJikKICAgICB7CiAgICAg
ICB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsKICAgICAgIHRocm93OwogICAg
IH0KICAgY2F0Y2goLi4uKQogICAgIHsgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJp
dCk7IH0KICAgaWYgKF9fZXJyKQogICAgIHRoaXMtPnNldHN0YXRlKF9fZXJyKTsKIH0KICAgICAg
cmV0dXJuIF9NX2djb3VudDsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBl
bmFtZSBfVHJhaXRzPgogICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JgogICAgYmFz
aWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIHB1dGJhY2soY2hhcl90eXBlIF9fYykK
ICAgIHsKCgogICAgICBfTV9nY291bnQgPSAwOwoKICAgICAgdGhpcy0+Y2xlYXIodGhpcy0+cmRz
dGF0ZSgpICYgfmlvc19iYXNlOjplb2ZiaXQpOwogICAgICBzZW50cnkgX19jZXJiKCp0aGlzLCB0
cnVlKTsKICAgICAgaWYgKF9fY2VyYikKIHsKICAgaW9zX2Jhc2U6Omlvc3RhdGUgX19lcnIgPSBp
b3NfYmFzZTo6Z29vZGJpdDsKICAgdHJ5CiAgICAgewogICAgICAgY29uc3QgaW50X3R5cGUgX19l
b2YgPSB0cmFpdHNfdHlwZTo6ZW9mKCk7CiAgICAgICBfX3N0cmVhbWJ1Zl90eXBlKiBfX3NiID0g
dGhpcy0+cmRidWYoKTsKICAgICAgIGlmICghX19zYgogICAgfHwgdHJhaXRzX3R5cGU6OmVxX2lu
dF90eXBlKF9fc2ItPnNwdXRiYWNrYyhfX2MpLCBfX2VvZikpCiAgX19lcnIgfD0gaW9zX2Jhc2U6
OmJhZGJpdDsKICAgICB9CiAgIGNhdGNoKF9fY3h4YWJpdjE6Ol9fZm9yY2VkX3Vud2luZCYpCiAg
ICAgewogICAgICAgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJpdCk7CiAgICAgICB0
aHJvdzsKICAgICB9CiAgIGNhdGNoKC4uLikKICAgICB7IHRoaXMtPl9NX3NldHN0YXRlKGlvc19i
YXNlOjpiYWRiaXQpOyB9CiAgIGlmIChfX2VycikKICAgICB0aGlzLT5zZXRzdGF0ZShfX2Vycik7
CiB9CiAgICAgIHJldHVybiAqdGhpczsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJU
LCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+Jgog
ICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIHVuZ2V0KHZvaWQpCiAgICB7
CgoKICAgICAgX01fZ2NvdW50ID0gMDsKCiAgICAgIHRoaXMtPmNsZWFyKHRoaXMtPnJkc3RhdGUo
KSAmIH5pb3NfYmFzZTo6ZW9mYml0KTsKICAgICAgc2VudHJ5IF9fY2VyYigqdGhpcywgdHJ1ZSk7
CiAgICAgIGlmIChfX2NlcmIpCiB7CiAgIGlvc19iYXNlOjppb3N0YXRlIF9fZXJyID0gaW9zX2Jh
c2U6Omdvb2RiaXQ7CiAgIHRyeQogICAgIHsKICAgICAgIGNvbnN0IGludF90eXBlIF9fZW9mID0g
dHJhaXRzX3R5cGU6OmVvZigpOwogICAgICAgX19zdHJlYW1idWZfdHlwZSogX19zYiA9IHRoaXMt
PnJkYnVmKCk7CiAgICAgICBpZiAoIV9fc2IKICAgIHx8IHRyYWl0c190eXBlOjplcV9pbnRfdHlw
ZShfX3NiLT5zdW5nZXRjKCksIF9fZW9mKSkKICBfX2VyciB8PSBpb3NfYmFzZTo6YmFkYml0Owog
ICAgIH0KICAgY2F0Y2goX19jeHhhYml2MTo6X19mb3JjZWRfdW53aW5kJikKICAgICB7CiAgICAg
ICB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsKICAgICAgIHRocm93OwogICAg
IH0KICAgY2F0Y2goLi4uKQogICAgIHsgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jhc2U6OmJhZGJp
dCk7IH0KICAgaWYgKF9fZXJyKQogICAgIHRoaXMtPnNldHN0YXRlKF9fZXJyKTsKIH0KICAgICAg
cmV0dXJuICp0aGlzOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1l
IF9UcmFpdHM+CiAgICBpbnQKICAgIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPjo6CiAg
ICBzeW5jKHZvaWQpCiAgICB7CgoKICAgICAgaW50IF9fcmV0ID0gLTE7CiAgICAgIHNlbnRyeSBf
X2NlcmIoKnRoaXMsIHRydWUpOwogICAgICBpZiAoX19jZXJiKQogewogICBpb3NfYmFzZTo6aW9z
dGF0ZSBfX2VyciA9IGlvc19iYXNlOjpnb29kYml0OwogICB0cnkKICAgICB7CiAgICAgICBfX3N0
cmVhbWJ1Zl90eXBlKiBfX3NiID0gdGhpcy0+cmRidWYoKTsKICAgICAgIGlmIChfX3NiKQogIHsK
ICAgIGlmIChfX3NiLT5wdWJzeW5jKCkgPT0gLTEpCiAgICAgIF9fZXJyIHw9IGlvc19iYXNlOjpi
YWRiaXQ7CiAgICBlbHNlCiAgICAgIF9fcmV0ID0gMDsKICB9CiAgICAgfQogICBjYXRjaChfX2N4
eGFiaXYxOjpfX2ZvcmNlZF91bndpbmQmKQogICAgIHsKICAgICAgIHRoaXMtPl9NX3NldHN0YXRl
KGlvc19iYXNlOjpiYWRiaXQpOwogICAgICAgdGhyb3c7CiAgICAgfQogICBjYXRjaCguLi4pCiAg
ICAgeyB0aGlzLT5fTV9zZXRzdGF0ZShpb3NfYmFzZTo6YmFkYml0KTsgfQogICBpZiAoX19lcnIp
CiAgICAgdGhpcy0+c2V0c3RhdGUoX19lcnIpOwogfQogICAgICByZXR1cm4gX19yZXQ7CiAgICB9
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIHR5cGVu
YW1lIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPjo6cG9zX3R5cGUKICAgIGJhc2ljX2lz
dHJlYW08X0NoYXJULCBfVHJhaXRzPjo6CiAgICB0ZWxsZyh2b2lkKQogICAgewoKCiAgICAgIHBv
c190eXBlIF9fcmV0ID0gcG9zX3R5cGUoLTEpOwogICAgICBzZW50cnkgX19jZXJiKCp0aGlzLCB0
cnVlKTsKICAgICAgaWYgKF9fY2VyYikKIHsKICAgdHJ5CiAgICAgewogICAgICAgaWYgKCF0aGlz
LT5mYWlsKCkpCiAgX19yZXQgPSB0aGlzLT5yZGJ1ZigpLT5wdWJzZWVrb2ZmKDAsIGlvc19iYXNl
OjpjdXIsCiAgICAgICAgaW9zX2Jhc2U6OmluKTsKICAgICB9CiAgIGNhdGNoKF9fY3h4YWJpdjE6
Ol9fZm9yY2VkX3Vud2luZCYpCiAgICAgewogICAgICAgdGhpcy0+X01fc2V0c3RhdGUoaW9zX2Jh
c2U6OmJhZGJpdCk7CiAgICAgICB0aHJvdzsKICAgICB9CiAgIGNhdGNoKC4uLikKICAgICB7IHRo
aXMtPl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOyB9CiB9CiAgICAgIHJldHVybiBfX3Jl
dDsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgog
ICAgYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JgogICAgYmFzaWNfaXN0cmVhbTxfQ2hh
clQsIF9UcmFpdHM+OjoKICAgIHNlZWtnKHBvc190eXBlIF9fcG9zKQogICAgewoKCgogICAgICB0
aGlzLT5jbGVhcih0aGlzLT5yZHN0YXRlKCkgJiB+aW9zX2Jhc2U6OmVvZmJpdCk7CiAgICAgIHNl
bnRyeSBfX2NlcmIoKnRoaXMsIHRydWUpOwogICAgICBpZiAoX19jZXJiKQogewogICBpb3NfYmFz
ZTo6aW9zdGF0ZSBfX2VyciA9IGlvc19iYXNlOjpnb29kYml0OwogICB0cnkKICAgICB7CiAgICAg
ICBpZiAoIXRoaXMtPmZhaWwoKSkKICB7CgogICAgY29uc3QgcG9zX3R5cGUgX19wID0gdGhpcy0+
cmRidWYoKS0+cHVic2Vla3BvcyhfX3BvcywKICAgICAgICAgaW9zX2Jhc2U6OmluKTsKCgogICAg
aWYgKF9fcCA9PSBwb3NfdHlwZShvZmZfdHlwZSgtMSkpKQogICAgICBfX2VyciB8PSBpb3NfYmFz
ZTo6ZmFpbGJpdDsKICB9CiAgICAgfQogICBjYXRjaChfX2N4eGFiaXYxOjpfX2ZvcmNlZF91bndp
bmQmKQogICAgIHsKICAgICAgIHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOwog
ICAgICAgdGhyb3c7CiAgICAgfQogICBjYXRjaCguLi4pCiAgICAgeyB0aGlzLT5fTV9zZXRzdGF0
ZShpb3NfYmFzZTo6YmFkYml0KTsgfQogICBpZiAoX19lcnIpCiAgICAgdGhpcy0+c2V0c3RhdGUo
X19lcnIpOwogfQogICAgICByZXR1cm4gKnRoaXM7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJh
aXRzPiYKICAgIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPjo6CiAgICBzZWVrZyhvZmZf
dHlwZSBfX29mZiwgaW9zX2Jhc2U6OnNlZWtkaXIgX19kaXIpCiAgICB7CgoKCiAgICAgIHRoaXMt
PmNsZWFyKHRoaXMtPnJkc3RhdGUoKSAmIH5pb3NfYmFzZTo6ZW9mYml0KTsKICAgICAgc2VudHJ5
IF9fY2VyYigqdGhpcywgdHJ1ZSk7CiAgICAgIGlmIChfX2NlcmIpCiB7CiAgIGlvc19iYXNlOjpp
b3N0YXRlIF9fZXJyID0gaW9zX2Jhc2U6Omdvb2RiaXQ7CiAgIHRyeQogICAgIHsKICAgICAgIGlm
ICghdGhpcy0+ZmFpbCgpKQogIHsKCiAgICBjb25zdCBwb3NfdHlwZSBfX3AgPSB0aGlzLT5yZGJ1
ZigpLT5wdWJzZWVrb2ZmKF9fb2ZmLCBfX2RpciwKICAgICAgICAgaW9zX2Jhc2U6OmluKTsKCgog
ICAgaWYgKF9fcCA9PSBwb3NfdHlwZShvZmZfdHlwZSgtMSkpKQogICAgICBfX2VyciB8PSBpb3Nf
YmFzZTo6ZmFpbGJpdDsKICB9CiAgICAgfQogICBjYXRjaChfX2N4eGFiaXYxOjpfX2ZvcmNlZF91
bndpbmQmKQogICAgIHsKICAgICAgIHRoaXMtPl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQp
OwogICAgICAgdGhyb3c7CiAgICAgfQogICBjYXRjaCguLi4pCiAgICAgeyB0aGlzLT5fTV9zZXRz
dGF0ZShpb3NfYmFzZTo6YmFkYml0KTsgfQogICBpZiAoX19lcnIpCiAgICAgdGhpcy0+c2V0c3Rh
dGUoX19lcnIpOwogfQogICAgICByZXR1cm4gKnRoaXM7CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBiYXNpY19pc3RyZWFtPF9DaGFyVCwg
X1RyYWl0cz4mCiAgICBvcGVyYXRvcj4+KGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiYg
X19pbiwgX0NoYXJUJiBfX2MpCiAgICB7CiAgICAgIHR5cGVkZWYgYmFzaWNfaXN0cmVhbTxfQ2hh
clQsIF9UcmFpdHM+IF9faXN0cmVhbV90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9faXN0
cmVhbV90eXBlOjppbnRfdHlwZSBfX2ludF90eXBlOwoKICAgICAgdHlwZW5hbWUgX19pc3RyZWFt
X3R5cGU6OnNlbnRyeSBfX2NlcmIoX19pbiwgZmFsc2UpOwogICAgICBpZiAoX19jZXJiKQogewog
ICBpb3NfYmFzZTo6aW9zdGF0ZSBfX2VyciA9IGlvc19iYXNlOjpnb29kYml0OwogICB0cnkKICAg
ICB7CiAgICAgICBjb25zdCBfX2ludF90eXBlIF9fY2IgPSBfX2luLnJkYnVmKCktPnNidW1wYygp
OwogICAgICAgaWYgKCFfVHJhaXRzOjplcV9pbnRfdHlwZShfX2NiLCBfVHJhaXRzOjplb2YoKSkp
CiAgX19jID0gX1RyYWl0czo6dG9fY2hhcl90eXBlKF9fY2IpOwogICAgICAgZWxzZQogIF9fZXJy
IHw9IChpb3NfYmFzZTo6ZW9mYml0IHwgaW9zX2Jhc2U6OmZhaWxiaXQpOwogICAgIH0KICAgY2F0
Y2goX19jeHhhYml2MTo6X19mb3JjZWRfdW53aW5kJikKICAgICB7CiAgICAgICBfX2luLl9NX3Nl
dHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOwogICAgICAgdGhyb3c7CiAgICAgfQogICBjYXRjaCgu
Li4pCiAgICAgeyBfX2luLl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOyB9CiAgIGlmIChf
X2VycikKICAgICBfX2luLnNldHN0YXRlKF9fZXJyKTsKIH0KICAgICAgcmV0dXJuIF9faW47CiAg
ICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIGJh
c2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRzPiYKICAgIG9wZXJhdG9yPj4oYmFzaWNfaXN0cmVh
bTxfQ2hhclQsIF9UcmFpdHM+JiBfX2luLCBfQ2hhclQqIF9fcykKICAgIHsKICAgICAgdHlwZWRl
ZiBiYXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4gX19pc3RyZWFtX3R5cGU7CiAgICAgIHR5
cGVkZWYgYmFzaWNfc3RyZWFtYnVmPF9DaGFyVCwgX1RyYWl0cz4gX19zdHJlYW1idWZfdHlwZTsK
ICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfVHJhaXRzOjppbnRfdHlwZSBpbnRfdHlwZTsKICAgICAg
dHlwZWRlZiBfQ2hhclQgY2hhcl90eXBlOwogICAgICB0eXBlZGVmIGN0eXBlPF9DaGFyVD4gX19j
dHlwZV90eXBlOwoKICAgICAgc3RyZWFtc2l6ZSBfX2V4dHJhY3RlZCA9IDA7CiAgICAgIGlvc19i
YXNlOjppb3N0YXRlIF9fZXJyID0gaW9zX2Jhc2U6Omdvb2RiaXQ7CiAgICAgIHR5cGVuYW1lIF9f
aXN0cmVhbV90eXBlOjpzZW50cnkgX19jZXJiKF9faW4sIGZhbHNlKTsKICAgICAgaWYgKF9fY2Vy
YikKIHsKICAgdHJ5CiAgICAgewoKICAgICAgIHN0cmVhbXNpemUgX19udW0gPSBfX2luLndpZHRo
KCk7CiAgICAgICBpZiAoX19udW0gPD0gMCkKICBfX251bSA9IF9fZ251X2N4eDo6X19udW1lcmlj
X3RyYWl0czxzdHJlYW1zaXplPjo6X19tYXg7CgogICAgICAgY29uc3QgX19jdHlwZV90eXBlJiBf
X2N0ID0gdXNlX2ZhY2V0PF9fY3R5cGVfdHlwZT4oX19pbi5nZXRsb2MoKSk7CgogICAgICAgY29u
c3QgaW50X3R5cGUgX19lb2YgPSBfVHJhaXRzOjplb2YoKTsKICAgICAgIF9fc3RyZWFtYnVmX3R5
cGUqIF9fc2IgPSBfX2luLnJkYnVmKCk7CiAgICAgICBpbnRfdHlwZSBfX2MgPSBfX3NiLT5zZ2V0
YygpOwoKICAgICAgIHdoaWxlIChfX2V4dHJhY3RlZCA8IF9fbnVtIC0gMQogICAgICAgJiYgIV9U
cmFpdHM6OmVxX2ludF90eXBlKF9fYywgX19lb2YpCiAgICAgICAmJiAhX19jdC5pcyhjdHlwZV9i
YXNlOjpzcGFjZSwKICAgICBfVHJhaXRzOjp0b19jaGFyX3R5cGUoX19jKSkpCiAgewogICAgKl9f
cysrID0gX1RyYWl0czo6dG9fY2hhcl90eXBlKF9fYyk7CiAgICArK19fZXh0cmFjdGVkOwogICAg
X19jID0gX19zYi0+c25leHRjKCk7CiAgfQogICAgICAgaWYgKF9UcmFpdHM6OmVxX2ludF90eXBl
KF9fYywgX19lb2YpKQogIF9fZXJyIHw9IGlvc19iYXNlOjplb2ZiaXQ7CgoKCiAgICAgICAqX19z
ID0gY2hhcl90eXBlKCk7CiAgICAgICBfX2luLndpZHRoKDApOwogICAgIH0KICAgY2F0Y2goX19j
eHhhYml2MTo6X19mb3JjZWRfdW53aW5kJikKICAgICB7CiAgICAgICBfX2luLl9NX3NldHN0YXRl
KGlvc19iYXNlOjpiYWRiaXQpOwogICAgICAgdGhyb3c7CiAgICAgfQogICBjYXRjaCguLi4pCiAg
ICAgeyBfX2luLl9NX3NldHN0YXRlKGlvc19iYXNlOjpiYWRiaXQpOyB9CiB9CiAgICAgIGlmICgh
X19leHRyYWN0ZWQpCiBfX2VyciB8PSBpb3NfYmFzZTo6ZmFpbGJpdDsKICAgICAgaWYgKF9fZXJy
KQogX19pbi5zZXRzdGF0ZShfX2Vycik7CiAgICAgIHJldHVybiBfX2luOwogICAgfQoKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNfaXN0cmVh
bTxfQ2hhclQsIF9UcmFpdHM+JgogICAgd3MoYmFzaWNfaXN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+
JiBfX2luKQogICAgewogICAgICB0eXBlZGVmIGJhc2ljX2lzdHJlYW08X0NoYXJULCBfVHJhaXRz
PiBfX2lzdHJlYW1fdHlwZTsKICAgICAgdHlwZWRlZiBiYXNpY19zdHJlYW1idWY8X0NoYXJULCBf
VHJhaXRzPiBfX3N0cmVhbWJ1Zl90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9faXN0cmVh
bV90eXBlOjppbnRfdHlwZSBfX2ludF90eXBlOwogICAgICB0eXBlZGVmIGN0eXBlPF9DaGFyVD4g
X19jdHlwZV90eXBlOwoKICAgICAgY29uc3QgX19jdHlwZV90eXBlJiBfX2N0ID0gdXNlX2ZhY2V0
PF9fY3R5cGVfdHlwZT4oX19pbi5nZXRsb2MoKSk7CiAgICAgIGNvbnN0IF9faW50X3R5cGUgX19l
b2YgPSBfVHJhaXRzOjplb2YoKTsKICAgICAgX19zdHJlYW1idWZfdHlwZSogX19zYiA9IF9faW4u
cmRidWYoKTsKICAgICAgX19pbnRfdHlwZSBfX2MgPSBfX3NiLT5zZ2V0YygpOwoKICAgICAgd2hp
bGUgKCFfVHJhaXRzOjplcV9pbnRfdHlwZShfX2MsIF9fZW9mKQogICAgICAmJiBfX2N0LmlzKGN0
eXBlX2Jhc2U6OnNwYWNlLCBfVHJhaXRzOjp0b19jaGFyX3R5cGUoX19jKSkpCiBfX2MgPSBfX3Ni
LT5zbmV4dGMoKTsKCiAgICAgICBpZiAoX1RyYWl0czo6ZXFfaW50X3R5cGUoX19jLCBfX2VvZikp
CiAgX19pbi5zZXRzdGF0ZShpb3NfYmFzZTo6ZW9mYml0KTsKICAgICAgcmV0dXJuIF9faW47CiAg
ICB9CgoKCgogIGV4dGVybiB0ZW1wbGF0ZSBjbGFzcyBiYXNpY19pc3RyZWFtPGNoYXI+OwogIGV4
dGVybiB0ZW1wbGF0ZSBpc3RyZWFtJiB3cyhpc3RyZWFtJik7CiAgZXh0ZXJuIHRlbXBsYXRlIGlz
dHJlYW0mIG9wZXJhdG9yPj4oaXN0cmVhbSYsIGNoYXImKTsKICBleHRlcm4gdGVtcGxhdGUgaXN0
cmVhbSYgb3BlcmF0b3I+Pihpc3RyZWFtJiwgY2hhciopOwogIGV4dGVybiB0ZW1wbGF0ZSBpc3Ry
ZWFtJiBvcGVyYXRvcj4+KGlzdHJlYW0mLCB1bnNpZ25lZCBjaGFyJik7CiAgZXh0ZXJuIHRlbXBs
YXRlIGlzdHJlYW0mIG9wZXJhdG9yPj4oaXN0cmVhbSYsIHNpZ25lZCBjaGFyJik7CiAgZXh0ZXJu
IHRlbXBsYXRlIGlzdHJlYW0mIG9wZXJhdG9yPj4oaXN0cmVhbSYsIHVuc2lnbmVkIGNoYXIqKTsK
ICBleHRlcm4gdGVtcGxhdGUgaXN0cmVhbSYgb3BlcmF0b3I+Pihpc3RyZWFtJiwgc2lnbmVkIGNo
YXIqKTsKCiAgZXh0ZXJuIHRlbXBsYXRlIGlzdHJlYW0mIGlzdHJlYW06Ol9NX2V4dHJhY3QodW5z
aWduZWQgc2hvcnQmKTsKICBleHRlcm4gdGVtcGxhdGUgaXN0cmVhbSYgaXN0cmVhbTo6X01fZXh0
cmFjdCh1bnNpZ25lZCBpbnQmKTsKICBleHRlcm4gdGVtcGxhdGUgaXN0cmVhbSYgaXN0cmVhbTo6
X01fZXh0cmFjdChsb25nJik7CiAgZXh0ZXJuIHRlbXBsYXRlIGlzdHJlYW0mIGlzdHJlYW06Ol9N
X2V4dHJhY3QodW5zaWduZWQgbG9uZyYpOwogIGV4dGVybiB0ZW1wbGF0ZSBpc3RyZWFtJiBpc3Ry
ZWFtOjpfTV9leHRyYWN0KGJvb2wmKTsKCiAgZXh0ZXJuIHRlbXBsYXRlIGlzdHJlYW0mIGlzdHJl
YW06Ol9NX2V4dHJhY3QobG9uZyBsb25nJik7CiAgZXh0ZXJuIHRlbXBsYXRlIGlzdHJlYW0mIGlz
dHJlYW06Ol9NX2V4dHJhY3QodW5zaWduZWQgbG9uZyBsb25nJik7CgogIGV4dGVybiB0ZW1wbGF0
ZSBpc3RyZWFtJiBpc3RyZWFtOjpfTV9leHRyYWN0KGZsb2F0Jik7CiAgZXh0ZXJuIHRlbXBsYXRl
IGlzdHJlYW0mIGlzdHJlYW06Ol9NX2V4dHJhY3QoZG91YmxlJik7CiAgZXh0ZXJuIHRlbXBsYXRl
IGlzdHJlYW0mIGlzdHJlYW06Ol9NX2V4dHJhY3QobG9uZyBkb3VibGUmKTsKICBleHRlcm4gdGVt
cGxhdGUgaXN0cmVhbSYgaXN0cmVhbTo6X01fZXh0cmFjdCh2b2lkKiYpOwoKICBleHRlcm4gdGVt
cGxhdGUgY2xhc3MgYmFzaWNfaW9zdHJlYW08Y2hhcj47CgoKICBleHRlcm4gdGVtcGxhdGUgY2xh
c3MgYmFzaWNfaXN0cmVhbTx3Y2hhcl90PjsKICBleHRlcm4gdGVtcGxhdGUgd2lzdHJlYW0mIHdz
KHdpc3RyZWFtJik7CiAgZXh0ZXJuIHRlbXBsYXRlIHdpc3RyZWFtJiBvcGVyYXRvcj4+KHdpc3Ry
ZWFtJiwgd2NoYXJfdCYpOwogIGV4dGVybiB0ZW1wbGF0ZSB3aXN0cmVhbSYgb3BlcmF0b3I+Pih3
aXN0cmVhbSYsIHdjaGFyX3QqKTsKCiAgZXh0ZXJuIHRlbXBsYXRlIHdpc3RyZWFtJiB3aXN0cmVh
bTo6X01fZXh0cmFjdCh1bnNpZ25lZCBzaG9ydCYpOwogIGV4dGVybiB0ZW1wbGF0ZSB3aXN0cmVh
bSYgd2lzdHJlYW06Ol9NX2V4dHJhY3QodW5zaWduZWQgaW50Jik7CiAgZXh0ZXJuIHRlbXBsYXRl
IHdpc3RyZWFtJiB3aXN0cmVhbTo6X01fZXh0cmFjdChsb25nJik7CiAgZXh0ZXJuIHRlbXBsYXRl
IHdpc3RyZWFtJiB3aXN0cmVhbTo6X01fZXh0cmFjdCh1bnNpZ25lZCBsb25nJik7CiAgZXh0ZXJu
IHRlbXBsYXRlIHdpc3RyZWFtJiB3aXN0cmVhbTo6X01fZXh0cmFjdChib29sJik7CgogIGV4dGVy
biB0ZW1wbGF0ZSB3aXN0cmVhbSYgd2lzdHJlYW06Ol9NX2V4dHJhY3QobG9uZyBsb25nJik7CiAg
ZXh0ZXJuIHRlbXBsYXRlIHdpc3RyZWFtJiB3aXN0cmVhbTo6X01fZXh0cmFjdCh1bnNpZ25lZCBs
b25nIGxvbmcmKTsKCiAgZXh0ZXJuIHRlbXBsYXRlIHdpc3RyZWFtJiB3aXN0cmVhbTo6X01fZXh0
cmFjdChmbG9hdCYpOwogIGV4dGVybiB0ZW1wbGF0ZSB3aXN0cmVhbSYgd2lzdHJlYW06Ol9NX2V4
dHJhY3QoZG91YmxlJik7CiAgZXh0ZXJuIHRlbXBsYXRlIHdpc3RyZWFtJiB3aXN0cmVhbTo6X01f
ZXh0cmFjdChsb25nIGRvdWJsZSYpOwogIGV4dGVybiB0ZW1wbGF0ZSB3aXN0cmVhbSYgd2lzdHJl
YW06Ol9NX2V4dHJhY3Qodm9pZComKTsKCiAgZXh0ZXJuIHRlbXBsYXRlIGNsYXNzIGJhc2ljX2lv
c3RyZWFtPHdjaGFyX3Q+OwoKCgoKfQojIDkzNSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9pc3Ry
ZWFtIiAyIDMKIyA0MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9pb3N0cmVhbSIgMiAzCgpuYW1l
c3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsK
CiMgNjAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvaW9zdHJlYW0iIDMKICBleHRlcm4gaXN0cmVh
bSBjaW47CiAgZXh0ZXJuIG9zdHJlYW0gY291dDsKICBleHRlcm4gb3N0cmVhbSBjZXJyOwogIGV4
dGVybiBvc3RyZWFtIGNsb2c7CgoKICBleHRlcm4gd2lzdHJlYW0gd2NpbjsKICBleHRlcm4gd29z
dHJlYW0gd2NvdXQ7CiAgZXh0ZXJuIHdvc3RyZWFtIHdjZXJyOwogIGV4dGVybiB3b3N0cmVhbSB3
Y2xvZzsKCgoKCiAgc3RhdGljIGlvc19iYXNlOjpJbml0IF9faW9pbml0OwoKCn0KIyAzMiAiL2hv
bWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lVSUxvZy5o
IiAyCgoKIyAxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIu
MS9zcmMvSW1wbFB0ci5oIiAxCiMgMjggIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5
dWktbWFzdGVyLTMuMi4xL3NyYy9JbXBsUHRyLmgiCiMgMSAiL3Vzci9pbmNsdWRlL2Jvb3N0L25v
bmNvcHlhYmxlLmhwcCIgMSAzIDQKIyAxNSAiL3Vzci9pbmNsdWRlL2Jvb3N0L25vbmNvcHlhYmxl
LmhwcCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2Jvb3N0L2NvcmUvbm9uY29weWFibGUuaHBwIiAx
IDMgNAojIDEyICIvdXNyL2luY2x1ZGUvYm9vc3QvY29yZS9ub25jb3B5YWJsZS5ocHAiIDMgNAoj
IDEgIi91c3IvaW5jbHVkZS9ib29zdC9jb25maWcuaHBwIiAxIDMgNAojIDMwICIvdXNyL2luY2x1
ZGUvYm9vc3QvY29uZmlnLmhwcCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2Jvb3N0L2NvbmZpZy91
c2VyLmhwcCIgMSAzIDQKIyAzMSAiL3Vzci9pbmNsdWRlL2Jvb3N0L2NvbmZpZy5ocHAiIDIgMyA0
CgoKCgojIDEgIi91c3IvaW5jbHVkZS9ib29zdC9jb25maWcvc2VsZWN0X2NvbXBpbGVyX2NvbmZp
Zy5ocHAiIDEgMyA0CiMgMzYgIi91c3IvaW5jbHVkZS9ib29zdC9jb25maWcuaHBwIiAyIDMgNAoK
CgojIDEgIi91c3IvaW5jbHVkZS9ib29zdC9jb25maWcvY29tcGlsZXIvZ2NjLmhwcCIgMSAzIDQK
IyAxNTIgIi91c3IvaW5jbHVkZS9ib29zdC9jb25maWcvY29tcGlsZXIvZ2NjLmhwcCIgMyA0CiMg
MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jc3RkZGVmIiAxIDMgNAojIDQyICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2NzdGRkZWYiIDMgNAogICAgICAgCiMgNDMgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvY3N0ZGRlZiIgMwoKCgoKCgoKIyAxICIvdXNyL2xpYi9nY2MvczM5MHgtcmVkaGF0LWxp
bnV4LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDEgMyA0CiMgMTQ5ICIvdXNyL2xpYi9nY2MvczM5
MHgtcmVkaGF0LWxpbnV4LzYuMC4wL2luY2x1ZGUvc3RkZGVmLmgiIDMgNAp0eXBlZGVmIGxvbmcg
aW50IHB0cmRpZmZfdDsKIyA0MjYgIi91c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4w
LjAvaW5jbHVkZS9zdGRkZWYuaCIgMyA0CnR5cGVkZWYgc3RydWN0IHsKICBsb25nIGxvbmcgX19t
YXhfYWxpZ25fbGwgX19hdHRyaWJ1dGVfXygoX19hbGlnbmVkX18oX19hbGlnbm9mX18obG9uZyBs
b25nKSkpKTsKICBsb25nIGRvdWJsZSBfX21heF9hbGlnbl9sZCBfX2F0dHJpYnV0ZV9fKChfX2Fs
aWduZWRfXyhfX2FsaWdub2ZfXyhsb25nIGRvdWJsZSkpKSk7Cn0gbWF4X2FsaWduX3Q7CgoKCgoK
CiAgdHlwZWRlZiBkZWNsdHlwZShudWxscHRyKSBudWxscHRyX3Q7CiMgNTEgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvY3N0ZGRlZiIgMiAzCgoKbmFtZXNwYWNlIHN0ZAp7CgogIHVzaW5nIDo6bWF4
X2FsaWduX3Q7Cn0KIyAxNTMgIi91c3IvaW5jbHVkZS9ib29zdC9jb25maWcvY29tcGlsZXIvZ2Nj
LmhwcCIgMiAzIDQKIyA0MCAiL3Vzci9pbmNsdWRlL2Jvb3N0L2NvbmZpZy5ocHAiIDIgMyA0CgoK
CgojIDEgIi91c3IvaW5jbHVkZS9ib29zdC9jb25maWcvc2VsZWN0X3N0ZGxpYl9jb25maWcuaHBw
IiAxIDMgNAojIDQ1ICIvdXNyL2luY2x1ZGUvYm9vc3QvY29uZmlnLmhwcCIgMiAzIDQKCgoKIyAx
ICIvdXNyL2luY2x1ZGUvYm9vc3QvY29uZmlnL3N0ZGxpYi9saWJzdGRjcHAzLmhwcCIgMSAzIDQK
IyA3OCAiL3Vzci9pbmNsdWRlL2Jvb3N0L2NvbmZpZy9zdGRsaWIvbGlic3RkY3BwMy5ocHAiIDMg
NAojIDEgIi91c3IvaW5jbHVkZS91bmlzdGQuaCIgMSAzIDQKIyAyNyAiL3Vzci9pbmNsdWRlL3Vu
aXN0ZC5oIiAzIDQKZXh0ZXJuICJDIiB7CiMgMjA1ICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDMg
NAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL3Bvc2l4X29wdC5oIiAxIDMgNAojIDIwNiAiL3Vzci9p
bmNsdWRlL3VuaXN0ZC5oIiAyIDMgNAoKCgojIDEgIi91c3IvaW5jbHVkZS9iaXRzL2Vudmlyb25t
ZW50cy5oIiAxIDMgNAojIDIyICIvdXNyL2luY2x1ZGUvYml0cy9lbnZpcm9ubWVudHMuaCIgMyA0
CiMgMSAiL3Vzci9pbmNsdWRlL2JpdHMvd29yZHNpemUuaCIgMSAzIDQKIyAyMyAiL3Vzci9pbmNs
dWRlL2JpdHMvZW52aXJvbm1lbnRzLmgiIDIgMyA0CiMgMjEwICIvdXNyL2luY2x1ZGUvdW5pc3Rk
LmgiIDIgMyA0CiMgMjI5ICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDMgNAojIDEgIi91c3IvbGli
L2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4wLjAvaW5jbHVkZS9zdGRkZWYuaCIgMSAzIDQKIyAy
MzAgIi91c3IvaW5jbHVkZS91bmlzdGQuaCIgMiAzIDQKIyAyNzcgIi91c3IvaW5jbHVkZS91bmlz
dGQuaCIgMyA0CnR5cGVkZWYgX19zb2NrbGVuX3Qgc29ja2xlbl90OwojIDI5MCAiL3Vzci9pbmNs
dWRlL3VuaXN0ZC5oIiAzIDQKZXh0ZXJuIGludCBhY2Nlc3MgKGNvbnN0IGNoYXIgKl9fbmFtZSwg
aW50IF9fdHlwZSkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoK
CgoKZXh0ZXJuIGludCBldWlkYWNjZXNzIChjb25zdCBjaGFyICpfX25hbWUsIGludCBfX3R5cGUp
CiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVy
biBpbnQgZWFjY2VzcyAoY29uc3QgY2hhciAqX19uYW1lLCBpbnQgX190eXBlKQogICAgIHRocm93
ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoKCgoKZXh0ZXJuIGludCBm
YWNjZXNzYXQgKGludCBfX2ZkLCBjb25zdCBjaGFyICpfX2ZpbGUsIGludCBfX3R5cGUsIGludCBf
X2ZsYWcpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyKSkpIF9f
YXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CiMgMzM3ICIvdXNyL2luY2x1
ZGUvdW5pc3RkLmgiIDMgNApleHRlcm4gX19vZmZfdCBsc2VlayAoaW50IF9fZmQsIF9fb2ZmX3Qg
X19vZmZzZXQsIGludCBfX3doZW5jZSkgdGhyb3cgKCk7CiMgMzQ4ICIvdXNyL2luY2x1ZGUvdW5p
c3RkLmgiIDMgNApleHRlcm4gX19vZmY2NF90IGxzZWVrNjQgKGludCBfX2ZkLCBfX29mZjY0X3Qg
X19vZmZzZXQsIGludCBfX3doZW5jZSkKICAgICB0aHJvdyAoKTsKCgoKCgoKZXh0ZXJuIGludCBj
bG9zZSAoaW50IF9fZmQpOwoKCgoKCgpleHRlcm4gc3NpemVfdCByZWFkIChpbnQgX19mZCwgdm9p
ZCAqX19idWYsIHNpemVfdCBfX25ieXRlcykgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKTsKCgoKCgpleHRlcm4gc3NpemVfdCB3cml0ZSAoaW50IF9fZmQsIGNvbnN0IHZv
aWQgKl9fYnVmLCBzaXplX3QgX19uKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1
bHRfXykpOwojIDM3OSAiL3Vzci9pbmNsdWRlL3VuaXN0ZC5oIiAzIDQKZXh0ZXJuIHNzaXplX3Qg
cHJlYWQgKGludCBfX2ZkLCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbmJ5dGVzLAogICAgICAgIF9f
b2ZmX3QgX19vZmZzZXQpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7
CgoKCgoKCmV4dGVybiBzc2l6ZV90IHB3cml0ZSAoaW50IF9fZmQsIGNvbnN0IHZvaWQgKl9fYnVm
LCBzaXplX3QgX19uLAogICAgICAgICBfX29mZl90IF9fb2Zmc2V0KSBfX2F0dHJpYnV0ZV9fICgo
X193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDQwNyAiL3Vzci9pbmNsdWRlL3VuaXN0ZC5oIiAz
IDQKZXh0ZXJuIHNzaXplX3QgcHJlYWQ2NCAoaW50IF9fZmQsIHZvaWQgKl9fYnVmLCBzaXplX3Qg
X19uYnl0ZXMsCiAgIF9fb2ZmNjRfdCBfX29mZnNldCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91
bnVzZWRfcmVzdWx0X18pKTsKCgpleHRlcm4gc3NpemVfdCBwd3JpdGU2NCAoaW50IF9fZmQsIGNv
bnN0IHZvaWQgKl9fYnVmLCBzaXplX3QgX19uLAogICAgX19vZmY2NF90IF9fb2Zmc2V0KSBfX2F0
dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKCgoKZXh0ZXJuIGludCBw
aXBlIChpbnQgX19waXBlZGVzWzJdKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3Vu
dXNlZF9yZXN1bHRfXykpOwoKCgoKZXh0ZXJuIGludCBwaXBlMiAoaW50IF9fcGlwZWRlc1syXSwg
aW50IF9fZmxhZ3MpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3Vs
dF9fKSk7CiMgNDM1ICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDMgNApleHRlcm4gdW5zaWduZWQg
aW50IGFsYXJtICh1bnNpZ25lZCBpbnQgX19zZWNvbmRzKSB0aHJvdyAoKTsKIyA0NDcgIi91c3Iv
aW5jbHVkZS91bmlzdGQuaCIgMyA0CmV4dGVybiB1bnNpZ25lZCBpbnQgc2xlZXAgKHVuc2lnbmVk
IGludCBfX3NlY29uZHMpOwoKCgoKCgoKZXh0ZXJuIF9fdXNlY29uZHNfdCB1YWxhcm0gKF9fdXNl
Y29uZHNfdCBfX3ZhbHVlLCBfX3VzZWNvbmRzX3QgX19pbnRlcnZhbCkKICAgICB0aHJvdyAoKTsK
CgoKCgoKZXh0ZXJuIGludCB1c2xlZXAgKF9fdXNlY29uZHNfdCBfX3VzZWNvbmRzKTsKIyA0NzIg
Ii91c3IvaW5jbHVkZS91bmlzdGQuaCIgMyA0CmV4dGVybiBpbnQgcGF1c2UgKHZvaWQpOwoKCgpl
eHRlcm4gaW50IGNob3duIChjb25zdCBjaGFyICpfX2ZpbGUsIF9fdWlkX3QgX19vd25lciwgX19n
aWRfdCBfX2dyb3VwKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAo
MSkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgpleHRlcm4g
aW50IGZjaG93biAoaW50IF9fZmQsIF9fdWlkX3QgX19vd25lciwgX19naWRfdCBfX2dyb3VwKSB0
aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKZXh0
ZXJuIGludCBsY2hvd24gKGNvbnN0IGNoYXIgKl9fZmlsZSwgX191aWRfdCBfX293bmVyLCBfX2dp
ZF90IF9fZ3JvdXApCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgx
KSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKCmV4dGVy
biBpbnQgZmNob3duYXQgKGludCBfX2ZkLCBjb25zdCBjaGFyICpfX2ZpbGUsIF9fdWlkX3QgX19v
d25lciwKICAgICAgIF9fZ2lkX3QgX19ncm91cCwgaW50IF9fZmxhZykKICAgICB0aHJvdyAoKSBf
X2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91
bnVzZWRfcmVzdWx0X18pKTsKCgoKZXh0ZXJuIGludCBjaGRpciAoY29uc3QgY2hhciAqX19wYXRo
KSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVf
XyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKZXh0ZXJuIGludCBmY2hkaXIgKGludCBf
X2ZkKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoj
IDUxNCAiL3Vzci9pbmNsdWRlL3VuaXN0ZC5oIiAzIDQKZXh0ZXJuIGNoYXIgKmdldGN3ZCAoY2hh
ciAqX19idWYsIHNpemVfdCBfX3NpemUpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dhcm5f
dW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKZXh0ZXJuIGNoYXIgKmdldF9jdXJyZW50X2Rpcl9uYW1l
ICh2b2lkKSB0aHJvdyAoKTsKCgoKCgoKCmV4dGVybiBjaGFyICpnZXR3ZCAoY2hhciAqX19idWYp
CiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmli
dXRlX18gKChfX2RlcHJlY2F0ZWRfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jl
c3VsdF9fKSk7CgoKCgpleHRlcm4gaW50IGR1cCAoaW50IF9fZmQpIHRocm93ICgpIF9fYXR0cmli
dXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKZXh0ZXJuIGludCBkdXAyIChpbnQg
X19mZCwgaW50IF9fZmQyKSB0aHJvdyAoKTsKCgoKCmV4dGVybiBpbnQgZHVwMyAoaW50IF9fZmQs
IGludCBfX2ZkMiwgaW50IF9fZmxhZ3MpIHRocm93ICgpOwoKCgpleHRlcm4gY2hhciAqKl9fZW52
aXJvbjsKCmV4dGVybiBjaGFyICoqZW52aXJvbjsKCgoKCgpleHRlcm4gaW50IGV4ZWN2ZSAoY29u
c3QgY2hhciAqX19wYXRoLCBjaGFyICpjb25zdCBfX2FyZ3ZbXSwKICAgICBjaGFyICpjb25zdCBf
X2VudnBbXSkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpOwoK
CgoKZXh0ZXJuIGludCBmZXhlY3ZlIChpbnQgX19mZCwgY2hhciAqY29uc3QgX19hcmd2W10sIGNo
YXIgKmNvbnN0IF9fZW52cFtdKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51
bGxfXyAoMikpKTsKCgoKCmV4dGVybiBpbnQgZXhlY3YgKGNvbnN0IGNoYXIgKl9fcGF0aCwgY2hh
ciAqY29uc3QgX19hcmd2W10pCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs
bF9fICgxLCAyKSkpOwoKCgpleHRlcm4gaW50IGV4ZWNsZSAoY29uc3QgY2hhciAqX19wYXRoLCBj
b25zdCBjaGFyICpfX2FyZywgLi4uKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMSwgMikpKTsKCgoKZXh0ZXJuIGludCBleGVjbCAoY29uc3QgY2hhciAqX19wYXRo
LCBjb25zdCBjaGFyICpfX2FyZywgLi4uKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChf
X25vbm51bGxfXyAoMSwgMikpKTsKCgoKZXh0ZXJuIGludCBleGVjdnAgKGNvbnN0IGNoYXIgKl9f
ZmlsZSwgY2hhciAqY29uc3QgX19hcmd2W10pCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAo
KF9fbm9ubnVsbF9fICgxLCAyKSkpOwoKCgoKZXh0ZXJuIGludCBleGVjbHAgKGNvbnN0IGNoYXIg
Kl9fZmlsZSwgY29uc3QgY2hhciAqX19hcmcsIC4uLikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0
ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKCgpleHRlcm4gaW50IGV4ZWN2cGUgKGNvbnN0
IGNoYXIgKl9fZmlsZSwgY2hhciAqY29uc3QgX19hcmd2W10sCiAgICAgIGNoYXIgKmNvbnN0IF9f
ZW52cFtdKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikp
KTsKCgoKCgpleHRlcm4gaW50IG5pY2UgKGludCBfX2luYykgdGhyb3cgKCkgX19hdHRyaWJ1dGVf
XyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCmV4dGVybiB2b2lkIF9leGl0IChpbnQg
X19zdGF0dXMpIF9fYXR0cmlidXRlX18gKChfX25vcmV0dXJuX18pKTsKCgoKCgojIDEgIi91c3Iv
aW5jbHVkZS9iaXRzL2NvbmZuYW1lLmgiIDEgMyA0CiMgMjQgIi91c3IvaW5jbHVkZS9iaXRzL2Nv
bmZuYW1lLmgiIDMgNAplbnVtCiAgewogICAgX1BDX0xJTktfTUFYLAoKICAgIF9QQ19NQVhfQ0FO
T04sCgogICAgX1BDX01BWF9JTlBVVCwKCiAgICBfUENfTkFNRV9NQVgsCgogICAgX1BDX1BBVEhf
TUFYLAoKICAgIF9QQ19QSVBFX0JVRiwKCiAgICBfUENfQ0hPV05fUkVTVFJJQ1RFRCwKCiAgICBf
UENfTk9fVFJVTkMsCgogICAgX1BDX1ZESVNBQkxFLAoKICAgIF9QQ19TWU5DX0lPLAoKICAgIF9Q
Q19BU1lOQ19JTywKCiAgICBfUENfUFJJT19JTywKCiAgICBfUENfU09DS19NQVhCVUYsCgogICAg
X1BDX0ZJTEVTSVpFQklUUywKCiAgICBfUENfUkVDX0lOQ1JfWEZFUl9TSVpFLAoKICAgIF9QQ19S
RUNfTUFYX1hGRVJfU0laRSwKCiAgICBfUENfUkVDX01JTl9YRkVSX1NJWkUsCgogICAgX1BDX1JF
Q19YRkVSX0FMSUdOLAoKICAgIF9QQ19BTExPQ19TSVpFX01JTiwKCiAgICBfUENfU1lNTElOS19N
QVgsCgogICAgX1BDXzJfU1lNTElOS1MKCiAgfTsKCgplbnVtCiAgewogICAgX1NDX0FSR19NQVgs
CgogICAgX1NDX0NISUxEX01BWCwKCiAgICBfU0NfQ0xLX1RDSywKCiAgICBfU0NfTkdST1VQU19N
QVgsCgogICAgX1NDX09QRU5fTUFYLAoKICAgIF9TQ19TVFJFQU1fTUFYLAoKICAgIF9TQ19UWk5B
TUVfTUFYLAoKICAgIF9TQ19KT0JfQ09OVFJPTCwKCiAgICBfU0NfU0FWRURfSURTLAoKICAgIF9T
Q19SRUFMVElNRV9TSUdOQUxTLAoKICAgIF9TQ19QUklPUklUWV9TQ0hFRFVMSU5HLAoKICAgIF9T
Q19USU1FUlMsCgogICAgX1NDX0FTWU5DSFJPTk9VU19JTywKCiAgICBfU0NfUFJJT1JJVElaRURf
SU8sCgogICAgX1NDX1NZTkNIUk9OSVpFRF9JTywKCiAgICBfU0NfRlNZTkMsCgogICAgX1NDX01B
UFBFRF9GSUxFUywKCiAgICBfU0NfTUVNTE9DSywKCiAgICBfU0NfTUVNTE9DS19SQU5HRSwKCiAg
ICBfU0NfTUVNT1JZX1BST1RFQ1RJT04sCgogICAgX1NDX01FU1NBR0VfUEFTU0lORywKCiAgICBf
U0NfU0VNQVBIT1JFUywKCiAgICBfU0NfU0hBUkVEX01FTU9SWV9PQkpFQ1RTLAoKICAgIF9TQ19B
SU9fTElTVElPX01BWCwKCiAgICBfU0NfQUlPX01BWCwKCiAgICBfU0NfQUlPX1BSSU9fREVMVEFf
TUFYLAoKICAgIF9TQ19ERUxBWVRJTUVSX01BWCwKCiAgICBfU0NfTVFfT1BFTl9NQVgsCgogICAg
X1NDX01RX1BSSU9fTUFYLAoKICAgIF9TQ19WRVJTSU9OLAoKICAgIF9TQ19QQUdFU0laRSwKCgog
ICAgX1NDX1JUU0lHX01BWCwKCiAgICBfU0NfU0VNX05TRU1TX01BWCwKCiAgICBfU0NfU0VNX1ZB
TFVFX01BWCwKCiAgICBfU0NfU0lHUVVFVUVfTUFYLAoKICAgIF9TQ19USU1FUl9NQVgsCgoKCgog
ICAgX1NDX0JDX0JBU0VfTUFYLAoKICAgIF9TQ19CQ19ESU1fTUFYLAoKICAgIF9TQ19CQ19TQ0FM
RV9NQVgsCgogICAgX1NDX0JDX1NUUklOR19NQVgsCgogICAgX1NDX0NPTExfV0VJR0hUU19NQVgs
CgogICAgX1NDX0VRVUlWX0NMQVNTX01BWCwKCiAgICBfU0NfRVhQUl9ORVNUX01BWCwKCiAgICBf
U0NfTElORV9NQVgsCgogICAgX1NDX1JFX0RVUF9NQVgsCgogICAgX1NDX0NIQVJDTEFTU19OQU1F
X01BWCwKCgogICAgX1NDXzJfVkVSU0lPTiwKCiAgICBfU0NfMl9DX0JJTkQsCgogICAgX1NDXzJf
Q19ERVYsCgogICAgX1NDXzJfRk9SVF9ERVYsCgogICAgX1NDXzJfRk9SVF9SVU4sCgogICAgX1ND
XzJfU1dfREVWLAoKICAgIF9TQ18yX0xPQ0FMRURFRiwKCgogICAgX1NDX1BJSSwKCiAgICBfU0Nf
UElJX1hUSSwKCiAgICBfU0NfUElJX1NPQ0tFVCwKCiAgICBfU0NfUElJX0lOVEVSTkVULAoKICAg
IF9TQ19QSUlfT1NJLAoKICAgIF9TQ19QT0xMLAoKICAgIF9TQ19TRUxFQ1QsCgogICAgX1NDX1VJ
T19NQVhJT1YsCgogICAgX1NDX0lPVl9NQVggPSBfU0NfVUlPX01BWElPViwKCiAgICBfU0NfUElJ
X0lOVEVSTkVUX1NUUkVBTSwKCiAgICBfU0NfUElJX0lOVEVSTkVUX0RHUkFNLAoKICAgIF9TQ19Q
SUlfT1NJX0NPVFMsCgogICAgX1NDX1BJSV9PU0lfQ0xUUywKCiAgICBfU0NfUElJX09TSV9NLAoK
ICAgIF9TQ19UX0lPVl9NQVgsCgoKCiAgICBfU0NfVEhSRUFEUywKCiAgICBfU0NfVEhSRUFEX1NB
RkVfRlVOQ1RJT05TLAoKICAgIF9TQ19HRVRHUl9SX1NJWkVfTUFYLAoKICAgIF9TQ19HRVRQV19S
X1NJWkVfTUFYLAoKICAgIF9TQ19MT0dJTl9OQU1FX01BWCwKCiAgICBfU0NfVFRZX05BTUVfTUFY
LAoKICAgIF9TQ19USFJFQURfREVTVFJVQ1RPUl9JVEVSQVRJT05TLAoKICAgIF9TQ19USFJFQURf
S0VZU19NQVgsCgogICAgX1NDX1RIUkVBRF9TVEFDS19NSU4sCgogICAgX1NDX1RIUkVBRF9USFJF
QURTX01BWCwKCiAgICBfU0NfVEhSRUFEX0FUVFJfU1RBQ0tBRERSLAoKICAgIF9TQ19USFJFQURf
QVRUUl9TVEFDS1NJWkUsCgogICAgX1NDX1RIUkVBRF9QUklPUklUWV9TQ0hFRFVMSU5HLAoKICAg
IF9TQ19USFJFQURfUFJJT19JTkhFUklULAoKICAgIF9TQ19USFJFQURfUFJJT19QUk9URUNULAoK
ICAgIF9TQ19USFJFQURfUFJPQ0VTU19TSEFSRUQsCgoKICAgIF9TQ19OUFJPQ0VTU09SU19DT05G
LAoKICAgIF9TQ19OUFJPQ0VTU09SU19PTkxOLAoKICAgIF9TQ19QSFlTX1BBR0VTLAoKICAgIF9T
Q19BVlBIWVNfUEFHRVMsCgogICAgX1NDX0FURVhJVF9NQVgsCgogICAgX1NDX1BBU1NfTUFYLAoK
CiAgICBfU0NfWE9QRU5fVkVSU0lPTiwKCiAgICBfU0NfWE9QRU5fWENVX1ZFUlNJT04sCgogICAg
X1NDX1hPUEVOX1VOSVgsCgogICAgX1NDX1hPUEVOX0NSWVBULAoKICAgIF9TQ19YT1BFTl9FTkhf
STE4TiwKCiAgICBfU0NfWE9QRU5fU0hNLAoKCiAgICBfU0NfMl9DSEFSX1RFUk0sCgogICAgX1ND
XzJfQ19WRVJTSU9OLAoKICAgIF9TQ18yX1VQRSwKCgogICAgX1NDX1hPUEVOX1hQRzIsCgogICAg
X1NDX1hPUEVOX1hQRzMsCgogICAgX1NDX1hPUEVOX1hQRzQsCgoKICAgIF9TQ19DSEFSX0JJVCwK
CiAgICBfU0NfQ0hBUl9NQVgsCgogICAgX1NDX0NIQVJfTUlOLAoKICAgIF9TQ19JTlRfTUFYLAoK
ICAgIF9TQ19JTlRfTUlOLAoKICAgIF9TQ19MT05HX0JJVCwKCiAgICBfU0NfV09SRF9CSVQsCgog
ICAgX1NDX01CX0xFTl9NQVgsCgogICAgX1NDX05aRVJPLAoKICAgIF9TQ19TU0laRV9NQVgsCgog
ICAgX1NDX1NDSEFSX01BWCwKCiAgICBfU0NfU0NIQVJfTUlOLAoKICAgIF9TQ19TSFJUX01BWCwK
CiAgICBfU0NfU0hSVF9NSU4sCgogICAgX1NDX1VDSEFSX01BWCwKCiAgICBfU0NfVUlOVF9NQVgs
CgogICAgX1NDX1VMT05HX01BWCwKCiAgICBfU0NfVVNIUlRfTUFYLAoKCiAgICBfU0NfTkxfQVJH
TUFYLAoKICAgIF9TQ19OTF9MQU5HTUFYLAoKICAgIF9TQ19OTF9NU0dNQVgsCgogICAgX1NDX05M
X05NQVgsCgogICAgX1NDX05MX1NFVE1BWCwKCiAgICBfU0NfTkxfVEVYVE1BWCwKCgogICAgX1ND
X1hCUzVfSUxQMzJfT0ZGMzIsCgogICAgX1NDX1hCUzVfSUxQMzJfT0ZGQklHLAoKICAgIF9TQ19Y
QlM1X0xQNjRfT0ZGNjQsCgogICAgX1NDX1hCUzVfTFBCSUdfT0ZGQklHLAoKCiAgICBfU0NfWE9Q
RU5fTEVHQUNZLAoKICAgIF9TQ19YT1BFTl9SRUFMVElNRSwKCiAgICBfU0NfWE9QRU5fUkVBTFRJ
TUVfVEhSRUFEUywKCgogICAgX1NDX0FEVklTT1JZX0lORk8sCgogICAgX1NDX0JBUlJJRVJTLAoK
ICAgIF9TQ19CQVNFLAoKICAgIF9TQ19DX0xBTkdfU1VQUE9SVCwKCiAgICBfU0NfQ19MQU5HX1NV
UFBPUlRfUiwKCiAgICBfU0NfQ0xPQ0tfU0VMRUNUSU9OLAoKICAgIF9TQ19DUFVUSU1FLAoKICAg
IF9TQ19USFJFQURfQ1BVVElNRSwKCiAgICBfU0NfREVWSUNFX0lPLAoKICAgIF9TQ19ERVZJQ0Vf
U1BFQ0lGSUMsCgogICAgX1NDX0RFVklDRV9TUEVDSUZJQ19SLAoKICAgIF9TQ19GRF9NR01ULAoK
ICAgIF9TQ19GSUZPLAoKICAgIF9TQ19QSVBFLAoKICAgIF9TQ19GSUxFX0FUVFJJQlVURVMsCgog
ICAgX1NDX0ZJTEVfTE9DS0lORywKCiAgICBfU0NfRklMRV9TWVNURU0sCgogICAgX1NDX01PTk9U
T05JQ19DTE9DSywKCiAgICBfU0NfTVVMVElfUFJPQ0VTUywKCiAgICBfU0NfU0lOR0xFX1BST0NF
U1MsCgogICAgX1NDX05FVFdPUktJTkcsCgogICAgX1NDX1JFQURFUl9XUklURVJfTE9DS1MsCgog
ICAgX1NDX1NQSU5fTE9DS1MsCgogICAgX1NDX1JFR0VYUCwKCiAgICBfU0NfUkVHRVhfVkVSU0lP
TiwKCiAgICBfU0NfU0hFTEwsCgogICAgX1NDX1NJR05BTFMsCgogICAgX1NDX1NQQVdOLAoKICAg
IF9TQ19TUE9SQURJQ19TRVJWRVIsCgogICAgX1NDX1RIUkVBRF9TUE9SQURJQ19TRVJWRVIsCgog
ICAgX1NDX1NZU1RFTV9EQVRBQkFTRSwKCiAgICBfU0NfU1lTVEVNX0RBVEFCQVNFX1IsCgogICAg
X1NDX1RJTUVPVVRTLAoKICAgIF9TQ19UWVBFRF9NRU1PUllfT0JKRUNUUywKCiAgICBfU0NfVVNF
Ul9HUk9VUFMsCgogICAgX1NDX1VTRVJfR1JPVVBTX1IsCgogICAgX1NDXzJfUEJTLAoKICAgIF9T
Q18yX1BCU19BQ0NPVU5USU5HLAoKICAgIF9TQ18yX1BCU19MT0NBVEUsCgogICAgX1NDXzJfUEJT
X01FU1NBR0UsCgogICAgX1NDXzJfUEJTX1RSQUNLLAoKICAgIF9TQ19TWU1MT09QX01BWCwKCiAg
ICBfU0NfU1RSRUFNUywKCiAgICBfU0NfMl9QQlNfQ0hFQ0tQT0lOVCwKCgogICAgX1NDX1Y2X0lM
UDMyX09GRjMyLAoKICAgIF9TQ19WNl9JTFAzMl9PRkZCSUcsCgogICAgX1NDX1Y2X0xQNjRfT0ZG
NjQsCgogICAgX1NDX1Y2X0xQQklHX09GRkJJRywKCgogICAgX1NDX0hPU1RfTkFNRV9NQVgsCgog
ICAgX1NDX1RSQUNFLAoKICAgIF9TQ19UUkFDRV9FVkVOVF9GSUxURVIsCgogICAgX1NDX1RSQUNF
X0lOSEVSSVQsCgogICAgX1NDX1RSQUNFX0xPRywKCgogICAgX1NDX0xFVkVMMV9JQ0FDSEVfU0la
RSwKCiAgICBfU0NfTEVWRUwxX0lDQUNIRV9BU1NPQywKCiAgICBfU0NfTEVWRUwxX0lDQUNIRV9M
SU5FU0laRSwKCiAgICBfU0NfTEVWRUwxX0RDQUNIRV9TSVpFLAoKICAgIF9TQ19MRVZFTDFfRENB
Q0hFX0FTU09DLAoKICAgIF9TQ19MRVZFTDFfRENBQ0hFX0xJTkVTSVpFLAoKICAgIF9TQ19MRVZF
TDJfQ0FDSEVfU0laRSwKCiAgICBfU0NfTEVWRUwyX0NBQ0hFX0FTU09DLAoKICAgIF9TQ19MRVZF
TDJfQ0FDSEVfTElORVNJWkUsCgogICAgX1NDX0xFVkVMM19DQUNIRV9TSVpFLAoKICAgIF9TQ19M
RVZFTDNfQ0FDSEVfQVNTT0MsCgogICAgX1NDX0xFVkVMM19DQUNIRV9MSU5FU0laRSwKCiAgICBf
U0NfTEVWRUw0X0NBQ0hFX1NJWkUsCgogICAgX1NDX0xFVkVMNF9DQUNIRV9BU1NPQywKCiAgICBf
U0NfTEVWRUw0X0NBQ0hFX0xJTkVTSVpFLAoKCgogICAgX1NDX0lQVjYgPSBfU0NfTEVWRUwxX0lD
QUNIRV9TSVpFICsgNTAsCgogICAgX1NDX1JBV19TT0NLRVRTLAoKCiAgICBfU0NfVjdfSUxQMzJf
T0ZGMzIsCgogICAgX1NDX1Y3X0lMUDMyX09GRkJJRywKCiAgICBfU0NfVjdfTFA2NF9PRkY2NCwK
CiAgICBfU0NfVjdfTFBCSUdfT0ZGQklHLAoKCiAgICBfU0NfU1NfUkVQTF9NQVgsCgoKICAgIF9T
Q19UUkFDRV9FVkVOVF9OQU1FX01BWCwKCiAgICBfU0NfVFJBQ0VfTkFNRV9NQVgsCgogICAgX1ND
X1RSQUNFX1NZU19NQVgsCgogICAgX1NDX1RSQUNFX1VTRVJfRVZFTlRfTUFYLAoKCiAgICBfU0Nf
WE9QRU5fU1RSRUFNUywKCgogICAgX1NDX1RIUkVBRF9ST0JVU1RfUFJJT19JTkhFUklULAoKICAg
IF9TQ19USFJFQURfUk9CVVNUX1BSSU9fUFJPVEVDVAoKICB9OwoKCmVudW0KICB7CiAgICBfQ1Nf
UEFUSCwKCgogICAgX0NTX1Y2X1dJRFRIX1JFU1RSSUNURURfRU5WUywKCgoKICAgIF9DU19HTlVf
TElCQ19WRVJTSU9OLAoKICAgIF9DU19HTlVfTElCUFRIUkVBRF9WRVJTSU9OLAoKCiAgICBfQ1Nf
VjVfV0lEVEhfUkVTVFJJQ1RFRF9FTlZTLAoKCgogICAgX0NTX1Y3X1dJRFRIX1JFU1RSSUNURURf
RU5WUywKCgoKICAgIF9DU19MRlNfQ0ZMQUdTID0gMTAwMCwKCiAgICBfQ1NfTEZTX0xERkxBR1Ms
CgogICAgX0NTX0xGU19MSUJTLAoKICAgIF9DU19MRlNfTElOVEZMQUdTLAoKICAgIF9DU19MRlM2
NF9DRkxBR1MsCgogICAgX0NTX0xGUzY0X0xERkxBR1MsCgogICAgX0NTX0xGUzY0X0xJQlMsCgog
ICAgX0NTX0xGUzY0X0xJTlRGTEFHUywKCgogICAgX0NTX1hCUzVfSUxQMzJfT0ZGMzJfQ0ZMQUdT
ID0gMTEwMCwKCiAgICBfQ1NfWEJTNV9JTFAzMl9PRkYzMl9MREZMQUdTLAoKICAgIF9DU19YQlM1
X0lMUDMyX09GRjMyX0xJQlMsCgogICAgX0NTX1hCUzVfSUxQMzJfT0ZGMzJfTElOVEZMQUdTLAoK
ICAgIF9DU19YQlM1X0lMUDMyX09GRkJJR19DRkxBR1MsCgogICAgX0NTX1hCUzVfSUxQMzJfT0ZG
QklHX0xERkxBR1MsCgogICAgX0NTX1hCUzVfSUxQMzJfT0ZGQklHX0xJQlMsCgogICAgX0NTX1hC
UzVfSUxQMzJfT0ZGQklHX0xJTlRGTEFHUywKCiAgICBfQ1NfWEJTNV9MUDY0X09GRjY0X0NGTEFH
UywKCiAgICBfQ1NfWEJTNV9MUDY0X09GRjY0X0xERkxBR1MsCgogICAgX0NTX1hCUzVfTFA2NF9P
RkY2NF9MSUJTLAoKICAgIF9DU19YQlM1X0xQNjRfT0ZGNjRfTElOVEZMQUdTLAoKICAgIF9DU19Y
QlM1X0xQQklHX09GRkJJR19DRkxBR1MsCgogICAgX0NTX1hCUzVfTFBCSUdfT0ZGQklHX0xERkxB
R1MsCgogICAgX0NTX1hCUzVfTFBCSUdfT0ZGQklHX0xJQlMsCgogICAgX0NTX1hCUzVfTFBCSUdf
T0ZGQklHX0xJTlRGTEFHUywKCgogICAgX0NTX1BPU0lYX1Y2X0lMUDMyX09GRjMyX0NGTEFHUywK
CiAgICBfQ1NfUE9TSVhfVjZfSUxQMzJfT0ZGMzJfTERGTEFHUywKCiAgICBfQ1NfUE9TSVhfVjZf
SUxQMzJfT0ZGMzJfTElCUywKCiAgICBfQ1NfUE9TSVhfVjZfSUxQMzJfT0ZGMzJfTElOVEZMQUdT
LAoKICAgIF9DU19QT1NJWF9WNl9JTFAzMl9PRkZCSUdfQ0ZMQUdTLAoKICAgIF9DU19QT1NJWF9W
Nl9JTFAzMl9PRkZCSUdfTERGTEFHUywKCiAgICBfQ1NfUE9TSVhfVjZfSUxQMzJfT0ZGQklHX0xJ
QlMsCgogICAgX0NTX1BPU0lYX1Y2X0lMUDMyX09GRkJJR19MSU5URkxBR1MsCgogICAgX0NTX1BP
U0lYX1Y2X0xQNjRfT0ZGNjRfQ0ZMQUdTLAoKICAgIF9DU19QT1NJWF9WNl9MUDY0X09GRjY0X0xE
RkxBR1MsCgogICAgX0NTX1BPU0lYX1Y2X0xQNjRfT0ZGNjRfTElCUywKCiAgICBfQ1NfUE9TSVhf
VjZfTFA2NF9PRkY2NF9MSU5URkxBR1MsCgogICAgX0NTX1BPU0lYX1Y2X0xQQklHX09GRkJJR19D
RkxBR1MsCgogICAgX0NTX1BPU0lYX1Y2X0xQQklHX09GRkJJR19MREZMQUdTLAoKICAgIF9DU19Q
T1NJWF9WNl9MUEJJR19PRkZCSUdfTElCUywKCiAgICBfQ1NfUE9TSVhfVjZfTFBCSUdfT0ZGQklH
X0xJTlRGTEFHUywKCgogICAgX0NTX1BPU0lYX1Y3X0lMUDMyX09GRjMyX0NGTEFHUywKCiAgICBf
Q1NfUE9TSVhfVjdfSUxQMzJfT0ZGMzJfTERGTEFHUywKCiAgICBfQ1NfUE9TSVhfVjdfSUxQMzJf
T0ZGMzJfTElCUywKCiAgICBfQ1NfUE9TSVhfVjdfSUxQMzJfT0ZGMzJfTElOVEZMQUdTLAoKICAg
IF9DU19QT1NJWF9WN19JTFAzMl9PRkZCSUdfQ0ZMQUdTLAoKICAgIF9DU19QT1NJWF9WN19JTFAz
Ml9PRkZCSUdfTERGTEFHUywKCiAgICBfQ1NfUE9TSVhfVjdfSUxQMzJfT0ZGQklHX0xJQlMsCgog
ICAgX0NTX1BPU0lYX1Y3X0lMUDMyX09GRkJJR19MSU5URkxBR1MsCgogICAgX0NTX1BPU0lYX1Y3
X0xQNjRfT0ZGNjRfQ0ZMQUdTLAoKICAgIF9DU19QT1NJWF9WN19MUDY0X09GRjY0X0xERkxBR1Ms
CgogICAgX0NTX1BPU0lYX1Y3X0xQNjRfT0ZGNjRfTElCUywKCiAgICBfQ1NfUE9TSVhfVjdfTFA2
NF9PRkY2NF9MSU5URkxBR1MsCgogICAgX0NTX1BPU0lYX1Y3X0xQQklHX09GRkJJR19DRkxBR1Ms
CgogICAgX0NTX1BPU0lYX1Y3X0xQQklHX09GRkJJR19MREZMQUdTLAoKICAgIF9DU19QT1NJWF9W
N19MUEJJR19PRkZCSUdfTElCUywKCiAgICBfQ1NfUE9TSVhfVjdfTFBCSUdfT0ZGQklHX0xJTlRG
TEFHUywKCgogICAgX0NTX1Y2X0VOViwKCiAgICBfQ1NfVjdfRU5WCgogIH07CiMgNjEzICIvdXNy
L2luY2x1ZGUvdW5pc3RkLmgiIDIgMyA0CgoKZXh0ZXJuIGxvbmcgaW50IHBhdGhjb25mIChjb25z
dCBjaGFyICpfX3BhdGgsIGludCBfX25hbWUpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAo
KF9fbm9ubnVsbF9fICgxKSkpOwoKCmV4dGVybiBsb25nIGludCBmcGF0aGNvbmYgKGludCBfX2Zk
LCBpbnQgX19uYW1lKSB0aHJvdyAoKTsKCgpleHRlcm4gbG9uZyBpbnQgc3lzY29uZiAoaW50IF9f
bmFtZSkgdGhyb3cgKCk7CgoKCmV4dGVybiBzaXplX3QgY29uZnN0ciAoaW50IF9fbmFtZSwgY2hh
ciAqX19idWYsIHNpemVfdCBfX2xlbikgdGhyb3cgKCk7CgoKCgpleHRlcm4gX19waWRfdCBnZXRw
aWQgKHZvaWQpIHRocm93ICgpOwoKCmV4dGVybiBfX3BpZF90IGdldHBwaWQgKHZvaWQpIHRocm93
ICgpOwoKCmV4dGVybiBfX3BpZF90IGdldHBncnAgKHZvaWQpIHRocm93ICgpOwoKCmV4dGVybiBf
X3BpZF90IF9fZ2V0cGdpZCAoX19waWRfdCBfX3BpZCkgdGhyb3cgKCk7CgpleHRlcm4gX19waWRf
dCBnZXRwZ2lkIChfX3BpZF90IF9fcGlkKSB0aHJvdyAoKTsKCgoKCgoKZXh0ZXJuIGludCBzZXRw
Z2lkIChfX3BpZF90IF9fcGlkLCBfX3BpZF90IF9fcGdpZCkgdGhyb3cgKCk7CiMgNjYzICIvdXNy
L2luY2x1ZGUvdW5pc3RkLmgiIDMgNApleHRlcm4gaW50IHNldHBncnAgKHZvaWQpIHRocm93ICgp
OwoKCgoKCgpleHRlcm4gX19waWRfdCBzZXRzaWQgKHZvaWQpIHRocm93ICgpOwoKCgpleHRlcm4g
X19waWRfdCBnZXRzaWQgKF9fcGlkX3QgX19waWQpIHRocm93ICgpOwoKCgpleHRlcm4gX191aWRf
dCBnZXR1aWQgKHZvaWQpIHRocm93ICgpOwoKCmV4dGVybiBfX3VpZF90IGdldGV1aWQgKHZvaWQp
IHRocm93ICgpOwoKCmV4dGVybiBfX2dpZF90IGdldGdpZCAodm9pZCkgdGhyb3cgKCk7CgoKZXh0
ZXJuIF9fZ2lkX3QgZ2V0ZWdpZCAodm9pZCkgdGhyb3cgKCk7CgoKCgpleHRlcm4gaW50IGdldGdy
b3VwcyAoaW50IF9fc2l6ZSwgX19naWRfdCBfX2xpc3RbXSkgdGhyb3cgKCkgX19hdHRyaWJ1dGVf
XyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKZXh0ZXJuIGludCBncm91cF9tZW1iZXIg
KF9fZ2lkX3QgX19naWQpIHRocm93ICgpOwoKCgoKCgpleHRlcm4gaW50IHNldHVpZCAoX191aWRf
dCBfX3VpZCkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18p
KTsKCgoKCmV4dGVybiBpbnQgc2V0cmV1aWQgKF9fdWlkX3QgX19ydWlkLCBfX3VpZF90IF9fZXVp
ZCkgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoK
CmV4dGVybiBpbnQgc2V0ZXVpZCAoX191aWRfdCBfX3VpZCkgdGhyb3cgKCkgX19hdHRyaWJ1dGVf
XyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKCgoKZXh0ZXJuIGludCBzZXRnaWQgKF9f
Z2lkX3QgX19naWQpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3Vs
dF9fKSk7CgoKCgpleHRlcm4gaW50IHNldHJlZ2lkIChfX2dpZF90IF9fcmdpZCwgX19naWRfdCBf
X2VnaWQpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7
CgoKCgpleHRlcm4gaW50IHNldGVnaWQgKF9fZ2lkX3QgX19naWQpIHRocm93ICgpIF9fYXR0cmli
dXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgoKZXh0ZXJuIGludCBnZXRyZXN1
aWQgKF9fdWlkX3QgKl9fcnVpZCwgX191aWRfdCAqX19ldWlkLCBfX3VpZF90ICpfX3N1aWQpCiAg
ICAgdGhyb3cgKCk7CgoKCmV4dGVybiBpbnQgZ2V0cmVzZ2lkIChfX2dpZF90ICpfX3JnaWQsIF9f
Z2lkX3QgKl9fZWdpZCwgX19naWRfdCAqX19zZ2lkKQogICAgIHRocm93ICgpOwoKCgpleHRlcm4g
aW50IHNldHJlc3VpZCAoX191aWRfdCBfX3J1aWQsIF9fdWlkX3QgX19ldWlkLCBfX3VpZF90IF9f
c3VpZCkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRf
XykpOwoKCgpleHRlcm4gaW50IHNldHJlc2dpZCAoX19naWRfdCBfX3JnaWQsIF9fZ2lkX3QgX19l
Z2lkLCBfX2dpZF90IF9fc2dpZCkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX193YXJu
X3VudXNlZF9yZXN1bHRfXykpOwoKCgoKCgpleHRlcm4gX19waWRfdCBmb3JrICh2b2lkKSB0aHJv
dyAoKTsKCgoKCgoKCmV4dGVybiBfX3BpZF90IHZmb3JrICh2b2lkKSB0aHJvdyAoKTsKCgoKCgpl
eHRlcm4gY2hhciAqdHR5bmFtZSAoaW50IF9fZmQpIHRocm93ICgpOwoKCgpleHRlcm4gaW50IHR0
eW5hbWVfciAoaW50IF9fZmQsIGNoYXIgKl9fYnVmLCBzaXplX3QgX19idWZsZW4pCiAgICAgdGhy
b3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyKSkpIF9fYXR0cmlidXRlX18gKChf
X3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCmV4dGVybiBpbnQgaXNhdHR5IChpbnQgX19mZCkg
dGhyb3cgKCk7CgoKCgoKZXh0ZXJuIGludCB0dHlzbG90ICh2b2lkKSB0aHJvdyAoKTsKCgoKCmV4
dGVybiBpbnQgbGluayAoY29uc3QgY2hhciAqX19mcm9tLCBjb25zdCBjaGFyICpfX3RvKQogICAg
IHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKSBfX2F0dHJpYnV0
ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgoKZXh0ZXJuIGludCBsaW5rYXQgKGlu
dCBfX2Zyb21mZCwgY29uc3QgY2hhciAqX19mcm9tLCBpbnQgX190b2ZkLAogICAgIGNvbnN0IGNo
YXIgKl9fdG8sIGludCBfX2ZsYWdzKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMiwgNCkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykp
OwoKCgoKZXh0ZXJuIGludCBzeW1saW5rIChjb25zdCBjaGFyICpfX2Zyb20sIGNvbnN0IGNoYXIg
Kl9fdG8pCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkp
IF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CgoKCgpleHRlcm4gc3Np
emVfdCByZWFkbGluayAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3BhdGgsCiAgICBjaGFyICpf
X3Jlc3RyaWN0IF9fYnVmLCBzaXplX3QgX19sZW4pCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVf
XyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jl
c3VsdF9fKSk7CgoKCgpleHRlcm4gaW50IHN5bWxpbmthdCAoY29uc3QgY2hhciAqX19mcm9tLCBp
bnQgX190b2ZkLAogICAgICAgIGNvbnN0IGNoYXIgKl9fdG8pIHRocm93ICgpIF9fYXR0cmlidXRl
X18gKChfX25vbm51bGxfXyAoMSwgMykpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9y
ZXN1bHRfXykpOwoKCmV4dGVybiBzc2l6ZV90IHJlYWRsaW5rYXQgKGludCBfX2ZkLCBjb25zdCBj
aGFyICpfX3Jlc3RyaWN0IF9fcGF0aCwKICAgICAgY2hhciAqX19yZXN0cmljdCBfX2J1Ziwgc2l6
ZV90IF9fbGVuKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMiwg
MykpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgpleHRlcm4g
aW50IHVubGluayAoY29uc3QgY2hhciAqX19uYW1lKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgo
X19ub25udWxsX18gKDEpKSk7CgoKCmV4dGVybiBpbnQgdW5saW5rYXQgKGludCBfX2ZkLCBjb25z
dCBjaGFyICpfX25hbWUsIGludCBfX2ZsYWcpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAo
KF9fbm9ubnVsbF9fICgyKSkpOwoKCgpleHRlcm4gaW50IHJtZGlyIChjb25zdCBjaGFyICpfX3Bh
dGgpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoKZXh0ZXJu
IF9fcGlkX3QgdGNnZXRwZ3JwIChpbnQgX19mZCkgdGhyb3cgKCk7CgoKZXh0ZXJuIGludCB0Y3Nl
dHBncnAgKGludCBfX2ZkLCBfX3BpZF90IF9fcGdycF9pZCkgdGhyb3cgKCk7CgoKCgoKCmV4dGVy
biBjaGFyICpnZXRsb2dpbiAodm9pZCk7CgoKCgoKCgpleHRlcm4gaW50IGdldGxvZ2luX3IgKGNo
YXIgKl9fbmFtZSwgc2l6ZV90IF9fbmFtZV9sZW4pIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxf
XyAoMSkpKTsKCgoKCmV4dGVybiBpbnQgc2V0bG9naW4gKGNvbnN0IGNoYXIgKl9fbmFtZSkgdGhy
b3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwojIDg3NCAiL3Vzci9pbmNs
dWRlL3VuaXN0ZC5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvZ2V0b3B0LmgiIDEgMyA0CiMgNDgg
Ii91c3IvaW5jbHVkZS9nZXRvcHQuaCIgMyA0CmV4dGVybiAiQyIgewojIDU3ICIvdXNyL2luY2x1
ZGUvZ2V0b3B0LmgiIDMgNApleHRlcm4gY2hhciAqb3B0YXJnOwojIDcxICIvdXNyL2luY2x1ZGUv
Z2V0b3B0LmgiIDMgNApleHRlcm4gaW50IG9wdGluZDsKCgoKCmV4dGVybiBpbnQgb3B0ZXJyOwoK
CgpleHRlcm4gaW50IG9wdG9wdDsKIyAxNTAgIi91c3IvaW5jbHVkZS9nZXRvcHQuaCIgMyA0CmV4
dGVybiBpbnQgZ2V0b3B0IChpbnQgX19fYXJnYywgY2hhciAqY29uc3QgKl9fX2FyZ3YsIGNvbnN0
IGNoYXIgKl9fc2hvcnRvcHRzKQogICAgICAgdGhyb3cgKCk7CiMgMTg1ICIvdXNyL2luY2x1ZGUv
Z2V0b3B0LmgiIDMgNAp9CiMgODc1ICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDIgMyA0CgoKCgoK
CgpleHRlcm4gaW50IGdldGhvc3RuYW1lIChjaGFyICpfX25hbWUsIHNpemVfdCBfX2xlbikgdGhy
b3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKCgpleHRlcm4gaW50
IHNldGhvc3RuYW1lIChjb25zdCBjaGFyICpfX25hbWUsIHNpemVfdCBfX2xlbikKICAgICB0aHJv
dyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVfXyAoKF9f
d2Fybl91bnVzZWRfcmVzdWx0X18pKTsKCgoKZXh0ZXJuIGludCBzZXRob3N0aWQgKGxvbmcgaW50
IF9faWQpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7
CgoKCgoKZXh0ZXJuIGludCBnZXRkb21haW5uYW1lIChjaGFyICpfX25hbWUsIHNpemVfdCBfX2xl
bikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSkgX19hdHRy
aWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIGludCBzZXRkb21haW5u
YW1lIChjb25zdCBjaGFyICpfX25hbWUsIHNpemVfdCBfX2xlbikKICAgICB0aHJvdyAoKSBfX2F0
dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVz
ZWRfcmVzdWx0X18pKTsKCgoKCgpleHRlcm4gaW50IHZoYW5ndXAgKHZvaWQpIHRocm93ICgpOwoK
CmV4dGVybiBpbnQgcmV2b2tlIChjb25zdCBjaGFyICpfX2ZpbGUpIHRocm93ICgpIF9fYXR0cmli
dXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9y
ZXN1bHRfXykpOwoKCgoKCgoKZXh0ZXJuIGludCBwcm9maWwgKHVuc2lnbmVkIHNob3J0IGludCAq
X19zYW1wbGVfYnVmZmVyLCBzaXplX3QgX19zaXplLAogICAgIHNpemVfdCBfX29mZnNldCwgdW5z
aWduZWQgaW50IF9fc2NhbGUpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVs
bF9fICgxKSkpOwoKCgoKCmV4dGVybiBpbnQgYWNjdCAoY29uc3QgY2hhciAqX19uYW1lKSB0aHJv
dyAoKTsKCgoKZXh0ZXJuIGNoYXIgKmdldHVzZXJzaGVsbCAodm9pZCkgdGhyb3cgKCk7CmV4dGVy
biB2b2lkIGVuZHVzZXJzaGVsbCAodm9pZCkgdGhyb3cgKCk7CmV4dGVybiB2b2lkIHNldHVzZXJz
aGVsbCAodm9pZCkgdGhyb3cgKCk7CgoKCgoKZXh0ZXJuIGludCBkYWVtb24gKGludCBfX25vY2hk
aXIsIGludCBfX25vY2xvc2UpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2Vk
X3Jlc3VsdF9fKSk7CgoKCgoKCmV4dGVybiBpbnQgY2hyb290IChjb25zdCBjaGFyICpfX3BhdGgp
IHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0ZV9f
ICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoKCgpleHRlcm4gY2hhciAqZ2V0cGFzcyAoY29u
c3QgY2hhciAqX19wcm9tcHQpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKCgoK
CgoKCmV4dGVybiBpbnQgZnN5bmMgKGludCBfX2ZkKTsKCgoKCgpleHRlcm4gaW50IHN5bmNmcyAo
aW50IF9fZmQpIHRocm93ICgpOwoKCgoKCgpleHRlcm4gbG9uZyBpbnQgZ2V0aG9zdGlkICh2b2lk
KTsKCgpleHRlcm4gdm9pZCBzeW5jICh2b2lkKSB0aHJvdyAoKTsKCgoKCgpleHRlcm4gaW50IGdl
dHBhZ2VzaXplICh2b2lkKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19jb25zdF9fKSk7CgoK
CgpleHRlcm4gaW50IGdldGR0YWJsZXNpemUgKHZvaWQpIHRocm93ICgpOwojIDk5NiAiL3Vzci9p
bmNsdWRlL3VuaXN0ZC5oIiAzIDQKZXh0ZXJuIGludCB0cnVuY2F0ZSAoY29uc3QgY2hhciAqX19m
aWxlLCBfX29mZl90IF9fbGVuZ3RoKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwoj
IDEwMDggIi91c3IvaW5jbHVkZS91bmlzdGQuaCIgMyA0CmV4dGVybiBpbnQgdHJ1bmNhdGU2NCAo
Y29uc3QgY2hhciAqX19maWxlLCBfX29mZjY0X3QgX19sZW5ndGgpCiAgICAgdGhyb3cgKCkgX19h
dHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51
c2VkX3Jlc3VsdF9fKSk7CiMgMTAxOSAiL3Vzci9pbmNsdWRlL3VuaXN0ZC5oIiAzIDQKZXh0ZXJu
IGludCBmdHJ1bmNhdGUgKGludCBfX2ZkLCBfX29mZl90IF9fbGVuZ3RoKSB0aHJvdyAoKSBfX2F0
dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwojIDEwMjkgIi91c3IvaW5jbHVk
ZS91bmlzdGQuaCIgMyA0CmV4dGVybiBpbnQgZnRydW5jYXRlNjQgKGludCBfX2ZkLCBfX29mZjY0
X3QgX19sZW5ndGgpIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3Vs
dF9fKSk7CiMgMTA0MCAiL3Vzci9pbmNsdWRlL3VuaXN0ZC5oIiAzIDQKZXh0ZXJuIGludCBicmsg
KHZvaWQgKl9fYWRkcikgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVz
dWx0X18pKTsKCgoKCgpleHRlcm4gdm9pZCAqc2JyayAoaW50cHRyX3QgX19kZWx0YSkgdGhyb3cg
KCk7CiMgMTA2MSAiL3Vzci9pbmNsdWRlL3VuaXN0ZC5oIiAzIDQKZXh0ZXJuIGxvbmcgaW50IHN5
c2NhbGwgKGxvbmcgaW50IF9fc3lzbm8sIC4uLikgdGhyb3cgKCk7CiMgMTA4NCAiL3Vzci9pbmNs
dWRlL3VuaXN0ZC5oIiAzIDQKZXh0ZXJuIGludCBsb2NrZiAoaW50IF9fZmQsIGludCBfX2NtZCwg
X19vZmZfdCBfX2xlbikgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsK
IyAxMDk0ICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDMgNApleHRlcm4gaW50IGxvY2tmNjQgKGlu
dCBfX2ZkLCBpbnQgX19jbWQsIF9fb2ZmNjRfdCBfX2xlbikgX19hdHRyaWJ1dGVfXyAoKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKTsKIyAxMTE1ICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDMgNApl
eHRlcm4gaW50IGZkYXRhc3luYyAoaW50IF9fZmlsZGVzKTsKCgoKCgoKCmV4dGVybiBjaGFyICpj
cnlwdCAoY29uc3QgY2hhciAqX19rZXksIGNvbnN0IGNoYXIgKl9fc2FsdCkKICAgICB0aHJvdyAo
KSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CgoKCmV4dGVybiB2b2lkIGVu
Y3J5cHQgKGNoYXIgKl9fZ2xpYmNfYmxvY2ssIGludCBfX2VkZmxhZykKICAgICB0aHJvdyAoKSBf
X2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoKCmV4dGVybiB2b2lkIHN3YWIg
KGNvbnN0IHZvaWQgKl9fcmVzdHJpY3QgX19mcm9tLCB2b2lkICpfX3Jlc3RyaWN0IF9fdG8sCiAg
ICBzc2l6ZV90IF9fbikgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAy
KSkpOwojIDExNTEgIi91c3IvaW5jbHVkZS91bmlzdGQuaCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRl
L2JpdHMvdW5pc3RkLmgiIDEgMyA0CiMgMjMgIi91c3IvaW5jbHVkZS9iaXRzL3VuaXN0ZC5oIiAz
IDQKZXh0ZXJuIHNzaXplX3QgX19yZWFkX2NoayAoaW50IF9fZmQsIHZvaWQgKl9fYnVmLCBzaXpl
X3QgX19uYnl0ZXMsCiAgICAgIHNpemVfdCBfX2J1ZmxlbikgX19hdHRyaWJ1dGVfXyAoKF9fd2Fy
bl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIHNzaXplX3QgX19yZWFkX2FsaWFzIChpbnQgX19m
ZCwgdm9pZCAqX19idWYsIHNpemVfdCBfX25ieXRlcykgX19hc21fXyAoIiIgInJlYWQiKQogICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKTsKZXh0ZXJuIHNzaXplX3QgX19yZWFkX2Noa193YXJuIChpbnQgX19mZCwgdm9p
ZCAqX19idWYsIHNpemVfdCBfX25ieXRlcywgc2l6ZV90IF9fYnVmbGVuKSBfX2FzbV9fICgiIiAi
X19yZWFkX2NoayIpCgoKICAgICBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRf
XykpIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgicmVhZCBjYWxsZWQgd2l0aCBiaWdnZXIg
bGVuZ3RoIHRoYW4gc2l6ZSBvZiAiICJ0aGUgZGVzdGluYXRpb24gYnVmZmVyIikpKQogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRl
X18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykp
IF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIF9fYXR0cmlidXRlX18gKChfX3dhcm5f
dW51c2VkX3Jlc3VsdF9fKSkgc3NpemVfdApyZWFkIChpbnQgX19mZCwgdm9pZCAqX19idWYsIHNp
emVfdCBfX25ieXRlcykKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAwKSAh
PSAoc2l6ZV90KSAtMSkKICAgIHsKICAgICAgaWYgKCFfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19u
Ynl0ZXMpKQogcmV0dXJuIF9fcmVhZF9jaGsgKF9fZmQsIF9fYnVmLCBfX25ieXRlcywgX19idWls
dGluX29iamVjdF9zaXplIChfX2J1ZiwgMCkpOwoKICAgICAgaWYgKF9fbmJ5dGVzID4gX19idWls
dGluX29iamVjdF9zaXplIChfX2J1ZiwgMCkpCiByZXR1cm4gX19yZWFkX2Noa193YXJuIChfX2Zk
LCBfX2J1ZiwgX19uYnl0ZXMsIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDApKTsKICAg
IH0KICByZXR1cm4gX19yZWFkX2FsaWFzIChfX2ZkLCBfX2J1ZiwgX19uYnl0ZXMpOwp9CgoKZXh0
ZXJuIHNzaXplX3QgX19wcmVhZF9jaGsgKGludCBfX2ZkLCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9f
bmJ5dGVzLAogICAgICAgX19vZmZfdCBfX29mZnNldCwgc2l6ZV90IF9fYnVmc2l6ZSkgX19hdHRy
aWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIHNzaXplX3QgX19wcmVh
ZDY0X2NoayAoaW50IF9fZmQsIHZvaWQgKl9fYnVmLCBzaXplX3QgX19uYnl0ZXMsCiAgICAgICAg
IF9fb2ZmNjRfdCBfX29mZnNldCwgc2l6ZV90IF9fYnVmc2l6ZSkgX19hdHRyaWJ1dGVfXyAoKF9f
d2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIHNzaXplX3QgX19wcmVhZF9hbGlhcyAoaW50
IF9fZmQsIHZvaWQgKl9fYnVmLCBzaXplX3QgX19uYnl0ZXMsIF9fb2ZmX3QgX19vZmZzZXQpIF9f
YXNtX18gKCIiICJwcmVhZCIpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX2F0
dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gc3NpemVfdCBfX3By
ZWFkNjRfYWxpYXMgKGludCBfX2ZkLCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbmJ5dGVzLCBfX29m
ZjY0X3QgX19vZmZzZXQpIF9fYXNtX18gKCIiICJwcmVhZDY0IikKCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRf
XykpOwpleHRlcm4gc3NpemVfdCBfX3ByZWFkX2Noa193YXJuIChpbnQgX19mZCwgdm9pZCAqX19i
dWYsIHNpemVfdCBfX25ieXRlcywgX19vZmZfdCBfX29mZnNldCwgc2l6ZV90IF9fYnVmc2l6ZSkg
X19hc21fXyAoIiIgIl9fcHJlYWRfY2hrIikKCgogICAgIF9fYXR0cmlidXRlX18gKChfX3dhcm5f
dW51c2VkX3Jlc3VsdF9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuaW5nX18gKCJwcmVhZCBjYWxs
ZWQgd2l0aCBiaWdnZXIgbGVuZ3RoIHRoYW4gc2l6ZSBvZiAiICJ0aGUgZGVzdGluYXRpb24gYnVm
ZmVyIikpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwpleHRlcm4gc3NpemVf
dCBfX3ByZWFkNjRfY2hrX3dhcm4gKGludCBfX2ZkLCB2b2lkICpfX2J1Ziwgc2l6ZV90IF9fbmJ5
dGVzLCBfX29mZjY0X3QgX19vZmZzZXQsIHNpemVfdCBfX2J1ZnNpemUpIF9fYXNtX18gKCIiICJf
X3ByZWFkNjRfY2hrIikKCgoKICAgICBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1
bHRfXykpIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgicHJlYWQ2NCBjYWxsZWQgd2l0aCBi
aWdnZXIgbGVuZ3RoIHRoYW4gc2l6ZSBvZiAiICJ0aGUgZGVzdGluYXRpb24gYnVmZmVyIikpKQog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOwoKCmV4dGVybiBfX2lubGluZSBfX2F0
dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5s
aW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBfX2F0dHJpYnV0ZV9fICgo
X193YXJuX3VudXNlZF9yZXN1bHRfXykpIHNzaXplX3QKcHJlYWQgKGludCBfX2ZkLCB2b2lkICpf
X2J1Ziwgc2l6ZV90IF9fbmJ5dGVzLCBfX29mZl90IF9fb2Zmc2V0KQp7CiAgaWYgKF9fYnVpbHRp
bl9vYmplY3Rfc2l6ZSAoX19idWYsIDApICE9IChzaXplX3QpIC0xKQogICAgewogICAgICBpZiAo
IV9fYnVpbHRpbl9jb25zdGFudF9wIChfX25ieXRlcykpCiByZXR1cm4gX19wcmVhZF9jaGsgKF9f
ZmQsIF9fYnVmLCBfX25ieXRlcywgX19vZmZzZXQsIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19i
dWYsIDApKTsKCiAgICAgIGlmICggX19uYnl0ZXMgPiBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9f
YnVmLCAwKSkKIHJldHVybiBfX3ByZWFkX2Noa193YXJuIChfX2ZkLCBfX2J1ZiwgX19uYnl0ZXMs
IF9fb2Zmc2V0LAogICAgIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDApKTsKICAgIH0K
ICByZXR1cm4gX19wcmVhZF9hbGlhcyAoX19mZCwgX19idWYsIF9fbmJ5dGVzLCBfX29mZnNldCk7
Cn0KIyAxMDQgIi91c3IvaW5jbHVkZS9iaXRzL3VuaXN0ZC5oIiAzIDQKZXh0ZXJuIF9faW5saW5l
IF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2du
dV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2FydGlmaWNpYWxfXykpIF9fYXR0cmlidXRl
X18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgc3NpemVfdApwcmVhZDY0IChpbnQgX19mZCwg
dm9pZCAqX19idWYsIHNpemVfdCBfX25ieXRlcywgX19vZmY2NF90IF9fb2Zmc2V0KQp7CiAgaWYg
KF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDApICE9IChzaXplX3QpIC0xKQogICAgewog
ICAgICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX25ieXRlcykpCiByZXR1cm4gX19wcmVh
ZDY0X2NoayAoX19mZCwgX19idWYsIF9fbmJ5dGVzLCBfX29mZnNldCwgX19idWlsdGluX29iamVj
dF9zaXplIChfX2J1ZiwgMCkpOwoKICAgICAgaWYgKCBfX25ieXRlcyA+IF9fYnVpbHRpbl9vYmpl
Y3Rfc2l6ZSAoX19idWYsIDApKQogcmV0dXJuIF9fcHJlYWQ2NF9jaGtfd2FybiAoX19mZCwgX19i
dWYsIF9fbmJ5dGVzLCBfX29mZnNldCwKICAgICAgIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19i
dWYsIDApKTsKICAgIH0KCiAgcmV0dXJuIF9fcHJlYWQ2NF9hbGlhcyAoX19mZCwgX19idWYsIF9f
bmJ5dGVzLCBfX29mZnNldCk7Cn0KCgoKCmV4dGVybiBzc2l6ZV90IF9fcmVhZGxpbmtfY2hrIChj
b25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fcGF0aCwKICAgICAgICAgIGNoYXIgKl9fcmVzdHJpY3Qg
X19idWYsIHNpemVfdCBfX2xlbiwKICAgICAgICAgIHNpemVfdCBfX2J1ZmxlbikKICAgICB0aHJv
dyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSkgX19hdHRyaWJ1dGVfXyAo
KF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIHNzaXplX3QgX19yZWFkbGlua19hbGlh
cyAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX3BhdGgsIGNoYXIgKl9fcmVzdHJpY3QgX19idWYs
IHNpemVfdCBfX2xlbikgdGhyb3cgKCkgX19hc21fXyAoIiIgInJlYWRsaW5rIikKCgogICAgIF9f
YXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJu
X3VudXNlZF9yZXN1bHRfXykpOwpleHRlcm4gc3NpemVfdCBfX3JlYWRsaW5rX2Noa193YXJuIChj
b25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fcGF0aCwgY2hhciAqX19yZXN0cmljdCBfX2J1Ziwgc2l6
ZV90IF9fbGVuLCBzaXplX3QgX19idWZsZW4pIHRocm93ICgpIF9fYXNtX18gKCIiICJfX3JlYWRs
aW5rX2NoayIpCgoKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxLCAyKSkpIF9f
YXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgX19hdHRyaWJ1dGVfXygoX193
YXJuaW5nX18gKCJyZWFkbGluayBjYWxsZWQgd2l0aCBiaWdnZXIgbGVuZ3RoICIgInRoYW4gc2l6
ZSBvZiBkZXN0aW5hdGlvbiBidWZmZXIiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5c19p
bmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRlX18g
KChfX2FydGlmaWNpYWxfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKSBf
X2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1bHRfXykpIHNzaXplX3QKX19hdHRyaWJ1
dGVfXyAoKF9fbGVhZl9fKSkgcmVhZGxpbmsgKGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19wYXRo
LCBjaGFyICpfX3Jlc3RyaWN0IF9fYnVmLCBzaXplX3QgX19sZW4pIHRocm93ICgpCgp7CiAgaWYg
KF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSAhPSAoc2l6ZV90KSAtMSkKICAg
IHsKICAgICAgaWYgKCFfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19sZW4pKQogcmV0dXJuIF9fcmVh
ZGxpbmtfY2hrIChfX3BhdGgsIF9fYnVmLCBfX2xlbiwgX19idWlsdGluX29iamVjdF9zaXplIChf
X2J1ZiwgMiA+IDEpKTsKCiAgICAgIGlmICggX19sZW4gPiBfX2J1aWx0aW5fb2JqZWN0X3NpemUg
KF9fYnVmLCAyID4gMSkpCiByZXR1cm4gX19yZWFkbGlua19jaGtfd2FybiAoX19wYXRoLCBfX2J1
ZiwgX19sZW4sIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSk7CiAgICB9CiAg
cmV0dXJuIF9fcmVhZGxpbmtfYWxpYXMgKF9fcGF0aCwgX19idWYsIF9fbGVuKTsKfQoKCgpleHRl
cm4gc3NpemVfdCBfX3JlYWRsaW5rYXRfY2hrIChpbnQgX19mZCwgY29uc3QgY2hhciAqX19yZXN0
cmljdCBfX3BhdGgsCiAgICAgY2hhciAqX19yZXN0cmljdCBfX2J1Ziwgc2l6ZV90IF9fbGVuLAog
ICAgIHNpemVfdCBfX2J1ZmxlbikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25u
dWxsX18gKDIsIDMpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsK
ZXh0ZXJuIHNzaXplX3QgX19yZWFkbGlua2F0X2FsaWFzIChpbnQgX19mZCwgY29uc3QgY2hhciAq
X19yZXN0cmljdCBfX3BhdGgsIGNoYXIgKl9fcmVzdHJpY3QgX19idWYsIHNpemVfdCBfX2xlbikg
dGhyb3cgKCkgX19hc21fXyAoIiIgInJlYWRsaW5rYXQiKQoKCgogICAgIF9fYXR0cmlidXRlX18g
KChfX25vbm51bGxfXyAoMiwgMykpKSBfX2F0dHJpYnV0ZV9fICgoX193YXJuX3VudXNlZF9yZXN1
bHRfXykpOwpleHRlcm4gc3NpemVfdCBfX3JlYWRsaW5rYXRfY2hrX3dhcm4gKGludCBfX2ZkLCBj
b25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fcGF0aCwgY2hhciAqX19yZXN0cmljdCBfX2J1Ziwgc2l6
ZV90IF9fbGVuLCBzaXplX3QgX19idWZsZW4pIHRocm93ICgpIF9fYXNtX18gKCIiICJfX3JlYWRs
aW5rYXRfY2hrIikKCgoKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIsIDMpKSkg
X19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBfX2F0dHJpYnV0ZV9fKChf
X3dhcm5pbmdfXyAoInJlYWRsaW5rYXQgY2FsbGVkIHdpdGggYmlnZ2VyICIgImxlbmd0aCB0aGFu
IHNpemUgb2YgZGVzdGluYXRpb24gIiAiYnVmZmVyIikpKQoKICAgICAgICAgICAgICAgIDsKCmV4
dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJp
YnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18p
KSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIsIDMpKSkgX19hdHRyaWJ1dGVfXyAoKF9f
d2Fybl91bnVzZWRfcmVzdWx0X18pKSBzc2l6ZV90Cl9fYXR0cmlidXRlX18gKChfX2xlYWZfXykp
IHJlYWRsaW5rYXQgKGludCBfX2ZkLCBjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fcGF0aCwgY2hh
ciAqX19yZXN0cmljdCBfX2J1Ziwgc2l6ZV90IF9fbGVuKSB0aHJvdyAoKQoKewogIGlmIChfX2J1
aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICB7CiAg
ICAgIGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fbGVuKSkKIHJldHVybiBfX3JlYWRsaW5r
YXRfY2hrIChfX2ZkLCBfX3BhdGgsIF9fYnVmLCBfX2xlbiwgX19idWlsdGluX29iamVjdF9zaXpl
IChfX2J1ZiwgMiA+IDEpKTsKCiAgICAgIGlmIChfX2xlbiA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6
ZSAoX19idWYsIDIgPiAxKSkKIHJldHVybiBfX3JlYWRsaW5rYXRfY2hrX3dhcm4gKF9fZmQsIF9f
cGF0aCwgX19idWYsIF9fbGVuLAogICAgICAgICAgX19idWlsdGluX29iamVjdF9zaXplIChfX2J1
ZiwgMiA+IDEpKTsKICAgIH0KICByZXR1cm4gX19yZWFkbGlua2F0X2FsaWFzIChfX2ZkLCBfX3Bh
dGgsIF9fYnVmLCBfX2xlbik7Cn0KCgpleHRlcm4gY2hhciAqX19nZXRjd2RfY2hrIChjaGFyICpf
X2J1Ziwgc2l6ZV90IF9fc2l6ZSwgc2l6ZV90IF9fYnVmbGVuKQogICAgIHRocm93ICgpIF9fYXR0
cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBjaGFyICpfX2dldGN3
ZF9hbGlhcyAoY2hhciAqX19idWYsIHNpemVfdCBfX3NpemUpIHRocm93ICgpIF9fYXNtX18gKCIi
ICJnZXRjd2QiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
X19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIGNoYXIgKl9f
Z2V0Y3dkX2Noa193YXJuIChjaGFyICpfX2J1Ziwgc2l6ZV90IF9fc2l6ZSwgc2l6ZV90IF9fYnVm
bGVuKSB0aHJvdyAoKSBfX2FzbV9fICgiIiAiX19nZXRjd2RfY2hrIikKCgogICAgIF9fYXR0cmli
dXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgX19hdHRyaWJ1dGVfXygoX193YXJuaW5n
X18gKCJnZXRjd2QgY2FsbGVyIHdpdGggYmlnZ2VyIGxlbmd0aCB0aGFuIHNpemUgb2YgIiAiZGVz
dGluYXRpb24gYnVmZmVyIikpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7CgpleHRl
cm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1
dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkg
X19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBjaGFyICoKX19hdHRyaWJ1
dGVfXyAoKF9fbGVhZl9fKSkgZ2V0Y3dkIChjaGFyICpfX2J1Ziwgc2l6ZV90IF9fc2l6ZSkgdGhy
b3cgKCkKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkgIT0gKHNp
emVfdCkgLTEpCiAgICB7CiAgICAgIGlmICghX19idWlsdGluX2NvbnN0YW50X3AgKF9fc2l6ZSkp
CiByZXR1cm4gX19nZXRjd2RfY2hrIChfX2J1ZiwgX19zaXplLCBfX2J1aWx0aW5fb2JqZWN0X3Np
emUgKF9fYnVmLCAyID4gMSkpOwoKICAgICAgaWYgKF9fc2l6ZSA+IF9fYnVpbHRpbl9vYmplY3Rf
c2l6ZSAoX19idWYsIDIgPiAxKSkKIHJldHVybiBfX2dldGN3ZF9jaGtfd2FybiAoX19idWYsIF9f
c2l6ZSwgX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpKTsKICAgIH0KICByZXR1
cm4gX19nZXRjd2RfYWxpYXMgKF9fYnVmLCBfX3NpemUpOwp9CgoKZXh0ZXJuIGNoYXIgKl9fZ2V0
d2RfY2hrIChjaGFyICpfX2J1Ziwgc2l6ZV90IGJ1ZmxlbikKICAgICB0aHJvdyAoKSBfX2F0dHJp
YnV0ZV9fICgoX19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRf
cmVzdWx0X18pKTsKZXh0ZXJuIGNoYXIgKl9fZ2V0d2Rfd2FybiAoY2hhciAqX19idWYpIHRocm93
ICgpIF9fYXNtX18gKCIiICJnZXR3ZCIpCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSkgX19hdHRyaWJ1
dGVfXygoX193YXJuaW5nX18gKCJwbGVhc2UgdXNlIGdldGN3ZCBpbnN0ZWFkLCBhcyBnZXR3ZCAi
ICJkb2Vzbid0IHNwZWNpZnkgYnVmZmVyIHNpemUiKSkpCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fs
d2F5c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmli
dXRlX18gKChfX2FydGlmaWNpYWxfXykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkp
KSBfX2F0dHJpYnV0ZV9fICgoX19kZXByZWNhdGVkX18pKSBfX2F0dHJpYnV0ZV9fICgoX193YXJu
X3VudXNlZF9yZXN1bHRfXykpIGNoYXIgKgpfX2F0dHJpYnV0ZV9fICgoX19sZWFmX18pKSBnZXR3
ZCAoY2hhciAqX19idWYpIHRocm93ICgpCnsKICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChf
X2J1ZiwgMiA+IDEpICE9IChzaXplX3QpIC0xKQogICAgcmV0dXJuIF9fZ2V0d2RfY2hrIChfX2J1
ZiwgX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpKTsKICByZXR1cm4gX19nZXR3
ZF93YXJuIChfX2J1Zik7Cn0KCgpleHRlcm4gc2l6ZV90IF9fY29uZnN0cl9jaGsgKGludCBfX25h
bWUsIGNoYXIgKl9fYnVmLCBzaXplX3QgX19sZW4sCiAgICAgICAgc2l6ZV90IF9fYnVmbGVuKSB0
aHJvdyAoKTsKZXh0ZXJuIHNpemVfdCBfX2NvbmZzdHJfYWxpYXMgKGludCBfX25hbWUsIGNoYXIg
Kl9fYnVmLCBzaXplX3QgX19sZW4pIHRocm93ICgpIF9fYXNtX18gKCIiICJjb25mc3RyIikKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICA7CmV4dGVybiBzaXplX3QgX19jb25mc3RyX2Noa193
YXJuIChpbnQgX19uYW1lLCBjaGFyICpfX2J1Ziwgc2l6ZV90IF9fbGVuLCBzaXplX3QgX19idWZs
ZW4pIHRocm93ICgpIF9fYXNtX18gKCIiICJfX2NvbmZzdHJfY2hrIikKCgogICAgIF9fYXR0cmli
dXRlX18oKF9fd2FybmluZ19fICgiY29uZnN0ciBjYWxsZWQgd2l0aCBiaWdnZXIgbGVuZ3RoIHRo
YW4gc2l6ZSBvZiBkZXN0aW5hdGlvbiAiICJidWZmZXIiKSkpCiAgICAgICAgICAgIDsKCmV4dGVy
biBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0
ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBz
aXplX3QKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9fKSkgY29uZnN0ciAoaW50IF9fbmFtZSwgY2hh
ciAqX19idWYsIHNpemVfdCBfX2xlbikgdGhyb3cgKCkKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0
X3NpemUgKF9fYnVmLCAyID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICB7CiAgICAgIGlmICghX19i
dWlsdGluX2NvbnN0YW50X3AgKF9fbGVuKSkKIHJldHVybiBfX2NvbmZzdHJfY2hrIChfX25hbWUs
IF9fYnVmLCBfX2xlbiwgX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpKTsKCiAg
ICAgIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkgPCBfX2xlbikKIHJl
dHVybiBfX2NvbmZzdHJfY2hrX3dhcm4gKF9fbmFtZSwgX19idWYsIF9fbGVuLCBfX2J1aWx0aW5f
b2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkpOwogICAgfQogIHJldHVybiBfX2NvbmZzdHJfYWxp
YXMgKF9fbmFtZSwgX19idWYsIF9fbGVuKTsKfQoKCmV4dGVybiBpbnQgX19nZXRncm91cHNfY2hr
IChpbnQgX19zaXplLCBfX2dpZF90IF9fbGlzdFtdLCBzaXplX3QgX19saXN0bGVuKQogICAgIHRo
cm93ICgpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBp
bnQgX19nZXRncm91cHNfYWxpYXMgKGludCBfX3NpemUsIF9fZ2lkX3QgX19saXN0W10pIHRocm93
ICgpIF9fYXNtX18gKCIiICJnZXRncm91cHMiKQogICAgICAgICAgICAgICAgIF9fYXR0cmlidXRl
X18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4dGVybiBpbnQgX19nZXRncm91cHNfY2hr
X3dhcm4gKGludCBfX3NpemUsIF9fZ2lkX3QgX19saXN0W10sIHNpemVfdCBfX2xpc3RsZW4pIHRo
cm93ICgpIF9fYXNtX18gKCIiICJfX2dldGdyb3Vwc19jaGsiKQoKCiAgICAgX19hdHRyaWJ1dGVf
XyAoKF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKSBfX2F0dHJpYnV0ZV9fKChfX3dhcm5pbmdfXyAo
ImdldGdyb3VwcyBjYWxsZWQgd2l0aCBiaWdnZXIgZ3JvdXAgY291bnQgdGhhbiB3aGF0ICIgImNh
biBmaXQgaW50byBkZXN0aW5hdGlvbiBidWZmZXIiKSkpCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVfXyAoKF9f
YWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkgX19hdHRy
aWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgaW50Cl9fYXR0cmlidXRlX18gKChfX2xlYWZfXykp
IGdldGdyb3VwcyAoaW50IF9fc2l6ZSwgX19naWRfdCBfX2xpc3RbXSkgdGhyb3cgKCkKewogIGlm
IChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fbGlzdCwgMiA+IDEpICE9IChzaXplX3QpIC0xKQog
ICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX3NpemUpIHx8IF9fc2l6ZSA8
IDApCiByZXR1cm4gX19nZXRncm91cHNfY2hrIChfX3NpemUsIF9fbGlzdCwgX19idWlsdGluX29i
amVjdF9zaXplIChfX2xpc3QsIDIgPiAxKSk7CgogICAgICBpZiAoX19zaXplICogc2l6ZW9mIChf
X2dpZF90KSA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19saXN0LCAyID4gMSkpCiByZXR1cm4g
X19nZXRncm91cHNfY2hrX3dhcm4gKF9fc2l6ZSwgX19saXN0LCBfX2J1aWx0aW5fb2JqZWN0X3Np
emUgKF9fbGlzdCwgMiA+IDEpKTsKICAgIH0KICByZXR1cm4gX19nZXRncm91cHNfYWxpYXMgKF9f
c2l6ZSwgX19saXN0KTsKfQoKCmV4dGVybiBpbnQgX190dHluYW1lX3JfY2hrIChpbnQgX19mZCwg
Y2hhciAqX19idWYsIHNpemVfdCBfX2J1ZmxlbiwKICAgICAgIHNpemVfdCBfX25yZWFsKSB0aHJv
dyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDIpKSk7CmV4dGVybiBpbnQgX190dHlu
YW1lX3JfYWxpYXMgKGludCBfX2ZkLCBjaGFyICpfX2J1Ziwgc2l6ZV90IF9fYnVmbGVuKSB0aHJv
dyAoKSBfX2FzbV9fICgiIiAidHR5bmFtZV9yIikKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgyKSkpOwpleHRlcm4gaW50IF9fdHR5bmFtZV9yX2Noa193YXJuIChpbnQgX19mZCwg
Y2hhciAqX19idWYsIHNpemVfdCBfX2J1Zmxlbiwgc2l6ZV90IF9fbnJlYWwpIHRocm93ICgpIF9f
YXNtX18gKCIiICJfX3R0eW5hbWVfcl9jaGsiKQoKCiAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgyKSkpIF9fYXR0cmlidXRlX18oKF9fd2FybmluZ19fICgidHR5bmFtZV9yIGNhbGxl
ZCB3aXRoIGJpZ2dlciBidWZsZW4gdGhhbiAiICJzaXplIG9mIGRlc3RpbmF0aW9uIGJ1ZmZlciIp
KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKCmV4dGVybiBfX2lubGluZSBf
X2F0dHJpYnV0ZV9fICgoX19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVf
aW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBpbnQKX19hdHRyaWJ1
dGVfXyAoKF9fbGVhZl9fKSkgdHR5bmFtZV9yIChpbnQgX19mZCwgY2hhciAqX19idWYsIHNpemVf
dCBfX2J1ZmxlbikgdGhyb3cgKCkKewogIGlmIChfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVm
LCAyID4gMSkgIT0gKHNpemVfdCkgLTEpCiAgICB7CiAgICAgIGlmICghX19idWlsdGluX2NvbnN0
YW50X3AgKF9fYnVmbGVuKSkKIHJldHVybiBfX3R0eW5hbWVfcl9jaGsgKF9fZmQsIF9fYnVmLCBf
X2J1ZmxlbiwgX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpKTsKCiAgICAgIGlm
IChfX2J1ZmxlbiA+IF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSkKIHJldHVy
biBfX3R0eW5hbWVfcl9jaGtfd2FybiAoX19mZCwgX19idWYsIF9fYnVmbGVuLCBfX2J1aWx0aW5f
b2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkpOwogICAgfQogIHJldHVybiBfX3R0eW5hbWVfcl9h
bGlhcyAoX19mZCwgX19idWYsIF9fYnVmbGVuKTsKfQoKCgpleHRlcm4gaW50IF9fZ2V0bG9naW5f
cl9jaGsgKGNoYXIgKl9fYnVmLCBzaXplX3QgX19idWZsZW4sIHNpemVfdCBfX25yZWFsKQogICAg
IF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKZXh0ZXJuIGludCBfX2dldGxvZ2lu
X3JfYWxpYXMgKGNoYXIgKl9fYnVmLCBzaXplX3QgX19idWZsZW4pIF9fYXNtX18gKCIiICJnZXRs
b2dpbl9yIikKICAgICAgICAgICAgICAgICAgICAgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9f
ICgxKSkpOwpleHRlcm4gaW50IF9fZ2V0bG9naW5fcl9jaGtfd2FybiAoY2hhciAqX19idWYsIHNp
emVfdCBfX2J1Zmxlbiwgc2l6ZV90IF9fbnJlYWwpIF9fYXNtX18gKCIiICJfX2dldGxvZ2luX3Jf
Y2hrIikKCgogICAgIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0dHJpYnV0
ZV9fKChfX3dhcm5pbmdfXyAoImdldGxvZ2luX3IgY2FsbGVkIHdpdGggYmlnZ2VyIGJ1ZmxlbiB0
aGFuICIgInNpemUgb2YgZGVzdGluYXRpb24gYnVmZmVyIikpKQogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgOwoKZXh0ZXJuIF9faW5saW5lIF9fYXR0cmlidXRlX18gKChfX2Fsd2F5
c19pbmxpbmVfXykpIF9fYXR0cmlidXRlX18gKChfX2dudV9pbmxpbmVfXykpIF9fYXR0cmlidXRl
X18gKChfX2FydGlmaWNpYWxfXykpIGludApnZXRsb2dpbl9yIChjaGFyICpfX2J1Ziwgc2l6ZV90
IF9fYnVmbGVuKQp7CiAgaWYgKF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSAh
PSAoc2l6ZV90KSAtMSkKICAgIHsKICAgICAgaWYgKCFfX2J1aWx0aW5fY29uc3RhbnRfcCAoX19i
dWZsZW4pKQogcmV0dXJuIF9fZ2V0bG9naW5fcl9jaGsgKF9fYnVmLCBfX2J1ZmxlbiwgX19idWls
dGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpKTsKCiAgICAgIGlmIChfX2J1ZmxlbiA+IF9f
YnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSkKIHJldHVybiBfX2dldGxvZ2luX3Jf
Y2hrX3dhcm4gKF9fYnVmLCBfX2J1ZmxlbiwgX19idWlsdGluX29iamVjdF9zaXplIChfX2J1Ziwg
MiA+IDEpKTsKICAgIH0KICByZXR1cm4gX19nZXRsb2dpbl9yX2FsaWFzIChfX2J1ZiwgX19idWZs
ZW4pOwp9CgoKCgpleHRlcm4gaW50IF9fZ2V0aG9zdG5hbWVfY2hrIChjaGFyICpfX2J1Ziwgc2l6
ZV90IF9fYnVmbGVuLCBzaXplX3QgX19ucmVhbCkKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9f
ICgoX19ub25udWxsX18gKDEpKSk7CmV4dGVybiBpbnQgX19nZXRob3N0bmFtZV9hbGlhcyAoY2hh
ciAqX19idWYsIHNpemVfdCBfX2J1ZmxlbikgdGhyb3cgKCkgX19hc21fXyAoIiIgImdldGhvc3Ru
YW1lIikKICAgICAgICAgICAgICAgICAgIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkp
KTsKZXh0ZXJuIGludCBfX2dldGhvc3RuYW1lX2Noa193YXJuIChjaGFyICpfX2J1Ziwgc2l6ZV90
IF9fYnVmbGVuLCBzaXplX3QgX19ucmVhbCkgdGhyb3cgKCkgX19hc21fXyAoIiIgIl9fZ2V0aG9z
dG5hbWVfY2hrIikKCgogICAgIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKSBfX2F0
dHJpYnV0ZV9fKChfX3dhcm5pbmdfXyAoImdldGhvc3RuYW1lIGNhbGxlZCB3aXRoIGJpZ2dlciBi
dWZsZW4gdGhhbiAiICJzaXplIG9mIGRlc3RpbmF0aW9uIGJ1ZmZlciIpKSkKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIDsKCmV4dGVybiBfX2lubGluZSBfX2F0dHJpYnV0ZV9fICgo
X19hbHdheXNfaW5saW5lX18pKSBfX2F0dHJpYnV0ZV9fICgoX19nbnVfaW5saW5lX18pKSBfX2F0
dHJpYnV0ZV9fICgoX19hcnRpZmljaWFsX18pKSBpbnQKX19hdHRyaWJ1dGVfXyAoKF9fbGVhZl9f
KSkgZ2V0aG9zdG5hbWUgKGNoYXIgKl9fYnVmLCBzaXplX3QgX19idWZsZW4pIHRocm93ICgpCnsK
ICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpICE9IChzaXplX3QpIC0x
KQogICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX2J1ZmxlbikpCiByZXR1
cm4gX19nZXRob3N0bmFtZV9jaGsgKF9fYnVmLCBfX2J1ZmxlbiwgX19idWlsdGluX29iamVjdF9z
aXplIChfX2J1ZiwgMiA+IDEpKTsKCiAgICAgIGlmIChfX2J1ZmxlbiA+IF9fYnVpbHRpbl9vYmpl
Y3Rfc2l6ZSAoX19idWYsIDIgPiAxKSkKIHJldHVybiBfX2dldGhvc3RuYW1lX2Noa193YXJuIChf
X2J1ZiwgX19idWZsZW4sIF9fYnVpbHRpbl9vYmplY3Rfc2l6ZSAoX19idWYsIDIgPiAxKSk7CiAg
ICB9CiAgcmV0dXJuIF9fZ2V0aG9zdG5hbWVfYWxpYXMgKF9fYnVmLCBfX2J1Zmxlbik7Cn0KCgoK
CmV4dGVybiBpbnQgX19nZXRkb21haW5uYW1lX2NoayAoY2hhciAqX19idWYsIHNpemVfdCBfX2J1
Zmxlbiwgc2l6ZV90IF9fbnJlYWwpCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9u
bnVsbF9fICgxKSkpIF9fYXR0cmlidXRlX18gKChfX3dhcm5fdW51c2VkX3Jlc3VsdF9fKSk7CmV4
dGVybiBpbnQgX19nZXRkb21haW5uYW1lX2FsaWFzIChjaGFyICpfX2J1Ziwgc2l6ZV90IF9fYnVm
bGVuKSB0aHJvdyAoKSBfX2FzbV9fICgiIiAiZ2V0ZG9tYWlubmFtZSIpCgogICAgICAgICAgICAg
ICAgICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVfXyAo
KF9fd2Fybl91bnVzZWRfcmVzdWx0X18pKTsKZXh0ZXJuIGludCBfX2dldGRvbWFpbm5hbWVfY2hr
X3dhcm4gKGNoYXIgKl9fYnVmLCBzaXplX3QgX19idWZsZW4sIHNpemVfdCBfX25yZWFsKSB0aHJv
dyAoKSBfX2FzbV9fICgiIiAiX19nZXRkb21haW5uYW1lX2NoayIpCgoKICAgICBfX2F0dHJpYnV0
ZV9fICgoX19ub25udWxsX18gKDEpKSkgX19hdHRyaWJ1dGVfXyAoKF9fd2Fybl91bnVzZWRfcmVz
dWx0X18pKSBfX2F0dHJpYnV0ZV9fKChfX3dhcm5pbmdfXyAoImdldGRvbWFpbm5hbWUgY2FsbGVk
IHdpdGggYmlnZ2VyICIgImJ1ZmxlbiB0aGFuIHNpemUgb2YgZGVzdGluYXRpb24gIiAiYnVmZmVy
IikpKQoKICAgICAgICAgICAgICAgICAgICA7CgpleHRlcm4gX19pbmxpbmUgX19hdHRyaWJ1dGVf
XyAoKF9fYWx3YXlzX2lubGluZV9fKSkgX19hdHRyaWJ1dGVfXyAoKF9fZ251X2lubGluZV9fKSkg
X19hdHRyaWJ1dGVfXyAoKF9fYXJ0aWZpY2lhbF9fKSkgaW50Cl9fYXR0cmlidXRlX18gKChfX2xl
YWZfXykpIGdldGRvbWFpbm5hbWUgKGNoYXIgKl9fYnVmLCBzaXplX3QgX19idWZsZW4pIHRocm93
ICgpCnsKICBpZiAoX19idWlsdGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpICE9IChzaXpl
X3QpIC0xKQogICAgewogICAgICBpZiAoIV9fYnVpbHRpbl9jb25zdGFudF9wIChfX2J1Zmxlbikp
CiByZXR1cm4gX19nZXRkb21haW5uYW1lX2NoayAoX19idWYsIF9fYnVmbGVuLCBfX2J1aWx0aW5f
b2JqZWN0X3NpemUgKF9fYnVmLCAyID4gMSkpOwoKICAgICAgaWYgKF9fYnVmbGVuID4gX19idWls
dGluX29iamVjdF9zaXplIChfX2J1ZiwgMiA+IDEpKQogcmV0dXJuIF9fZ2V0ZG9tYWlubmFtZV9j
aGtfd2FybiAoX19idWYsIF9fYnVmbGVuLCBfX2J1aWx0aW5fb2JqZWN0X3NpemUgKF9fYnVmLCAy
ID4gMSkpOwogICAgfQogIHJldHVybiBfX2dldGRvbWFpbm5hbWVfYWxpYXMgKF9fYnVmLCBfX2J1
Zmxlbik7Cn0KIyAxMTUyICIvdXNyL2luY2x1ZGUvdW5pc3RkLmgiIDIgMyA0CgoKfQojIDc5ICIv
dXNyL2luY2x1ZGUvYm9vc3QvY29uZmlnL3N0ZGxpYi9saWJzdGRjcHAzLmhwcCIgMiAzIDQKIyA0
OSAiL3Vzci9pbmNsdWRlL2Jvb3N0L2NvbmZpZy5ocHAiIDIgMyA0CgoKCgojIDEgIi91c3IvaW5j
bHVkZS9ib29zdC9jb25maWcvc2VsZWN0X3BsYXRmb3JtX2NvbmZpZy5ocHAiIDEgMyA0CiMgNTQg
Ii91c3IvaW5jbHVkZS9ib29zdC9jb25maWcuaHBwIiAyIDMgNAoKCgojIDEgIi91c3IvaW5jbHVk
ZS9ib29zdC9jb25maWcvcGxhdGZvcm0vbGludXguaHBwIiAxIDMgNAojIDE1ICIvdXNyL2luY2x1
ZGUvYm9vc3QvY29uZmlnL3BsYXRmb3JtL2xpbnV4LmhwcCIgMyA0CiMgMSAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9jc3RkbGliIiAxIDMgNAojIDM5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Nz
dGRsaWIiIDMgNAogICAgICAgCiMgNDAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3N0ZGxpYiIg
MwojIDE2ICIvdXNyL2luY2x1ZGUvYm9vc3QvY29uZmlnL3BsYXRmb3JtL2xpbnV4LmhwcCIgMiAz
IDQKIyA3NCAiL3Vzci9pbmNsdWRlL2Jvb3N0L2NvbmZpZy9wbGF0Zm9ybS9saW51eC5ocHAiIDMg
NAojIDEgIi91c3IvaW5jbHVkZS9ib29zdC9jb25maWcvcG9zaXhfZmVhdHVyZXMuaHBwIiAxIDMg
NAojIDc1ICIvdXNyL2luY2x1ZGUvYm9vc3QvY29uZmlnL3BsYXRmb3JtL2xpbnV4LmhwcCIgMiAz
IDQKIyA1OCAiL3Vzci9pbmNsdWRlL2Jvb3N0L2NvbmZpZy5ocHAiIDIgMyA0CgoKCiMgMSAiL3Vz
ci9pbmNsdWRlL2Jvb3N0L2NvbmZpZy9zdWZmaXguaHBwIiAxIDMgNAojIDM0ICIvdXNyL2luY2x1
ZGUvYm9vc3QvY29uZmlnL3N1ZmZpeC5ocHAiIDMgNAogICAgICAgCiMgMzUgIi91c3IvaW5jbHVk
ZS9ib29zdC9jb25maWcvc3VmZml4LmhwcCIgMwojIDQ4NCAiL3Vzci9pbmNsdWRlL2Jvb3N0L2Nv
bmZpZy9zdWZmaXguaHBwIiAzCm5hbWVzcGFjZSBib29zdHsKCiAgIF9fZXh0ZW5zaW9uX18gdHlw
ZWRlZiBsb25nIGxvbmcgbG9uZ19sb25nX3R5cGU7CiAgIF9fZXh0ZW5zaW9uX18gdHlwZWRlZiB1
bnNpZ25lZCBsb25nIGxvbmcgdWxvbmdfbG9uZ190eXBlOwoKCgoKfQoKCgpuYW1lc3BhY2UgYm9v
c3R7CgogICBfX2V4dGVuc2lvbl9fIHR5cGVkZWYgX19pbnQxMjggaW50MTI4X3R5cGU7CiAgIF9f
ZXh0ZW5zaW9uX18gdHlwZWRlZiB1bnNpZ25lZCBfX2ludDEyOCB1aW50MTI4X3R5cGU7CgoKCgp9
CiMgNjIgIi91c3IvaW5jbHVkZS9ib29zdC9jb25maWcuaHBwIiAyIDMgNAoKCiAgICAgICAKIyAx
MyAiL3Vzci9pbmNsdWRlL2Jvb3N0L2NvcmUvbm9uY29weWFibGUuaHBwIiAyIDMgNAoKbmFtZXNw
YWNlIGJvb3N0IHsKCgoKCgoKbmFtZXNwYWNlIG5vbmNvcHlhYmxlXwp7CiAgY2xhc3Mgbm9uY29w
eWFibGUKICB7CiAgcHJvdGVjdGVkOgoKICAgICAgY29uc3RleHByIG5vbmNvcHlhYmxlKCkgPSBk
ZWZhdWx0OwogICAgICB+bm9uY29weWFibGUoKSA9IGRlZmF1bHQ7CgoKCgoKICAgICAgbm9uY29w
eWFibGUoIGNvbnN0IG5vbmNvcHlhYmxlJiApID0gZGVsZXRlOwogICAgICBub25jb3B5YWJsZSYg
b3BlcmF0b3I9KCBjb25zdCBub25jb3B5YWJsZSYgKSA9IGRlbGV0ZTsKCgoKCgogIH07Cn0KCnR5
cGVkZWYgbm9uY29weWFibGVfOjpub25jb3B5YWJsZSBub25jb3B5YWJsZTsKCn0KIyAxNiAiL3Vz
ci9pbmNsdWRlL2Jvb3N0L25vbmNvcHlhYmxlLmhwcCIgMiAzIDQKIyAyOSAiL2hvbWUvc2hhcmtj
ei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL0ltcGxQdHIuaCIgMgojIDEg
Ii91c3IvaW5jbHVkZS9ib29zdC9zY29wZWRfcHRyLmhwcCIgMSAzIDQKIyAxNCAiL3Vzci9pbmNs
dWRlL2Jvb3N0L3Njb3BlZF9wdHIuaHBwIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYm9vc3Qvc21h
cnRfcHRyL3Njb3BlZF9wdHIuaHBwIiAxIDMgNAojIDE1ICIvdXNyL2luY2x1ZGUvYm9vc3Qvc21h
cnRfcHRyL3Njb3BlZF9wdHIuaHBwIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYm9vc3QvYXNzZXJ0
LmhwcCIgMSAzIDQKIyA1OCAiL3Vzci9pbmNsdWRlL2Jvb3N0L2Fzc2VydC5ocHAiIDMgNAojIDEg
Ii91c3IvaW5jbHVkZS9hc3NlcnQuaCIgMSAzIDQKIyA2NCAiL3Vzci9pbmNsdWRlL2Fzc2VydC5o
IiAzIDQKZXh0ZXJuICJDIiB7CgoKZXh0ZXJuIHZvaWQgX19hc3NlcnRfZmFpbCAoY29uc3QgY2hh
ciAqX19hc3NlcnRpb24sIGNvbnN0IGNoYXIgKl9fZmlsZSwKICAgICAgdW5zaWduZWQgaW50IF9f
bGluZSwgY29uc3QgY2hhciAqX19mdW5jdGlvbikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9f
ICgoX19ub3JldHVybl9fKSk7CgoKZXh0ZXJuIHZvaWQgX19hc3NlcnRfcGVycm9yX2ZhaWwgKGlu
dCBfX2Vycm51bSwgY29uc3QgY2hhciAqX19maWxlLAogICAgICB1bnNpZ25lZCBpbnQgX19saW5l
LCBjb25zdCBjaGFyICpfX2Z1bmN0aW9uKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChf
X25vcmV0dXJuX18pKTsKCgoKCmV4dGVybiB2b2lkIF9fYXNzZXJ0IChjb25zdCBjaGFyICpfX2Fz
c2VydGlvbiwgY29uc3QgY2hhciAqX19maWxlLCBpbnQgX19saW5lKQogICAgIHRocm93ICgpIF9f
YXR0cmlidXRlX18gKChfX25vcmV0dXJuX18pKTsKCgp9CiMgNTkgIi91c3IvaW5jbHVkZS9ib29z
dC9hc3NlcnQuaHBwIiAyIDMgNAojIDE2ICIvdXNyL2luY2x1ZGUvYm9vc3Qvc21hcnRfcHRyL3Nj
b3BlZF9wdHIuaHBwIiAyIDMgNAojIDEgIi91c3IvaW5jbHVkZS9ib29zdC9jaGVja2VkX2RlbGV0
ZS5ocHAiIDEgMyA0CiMgMTUgIi91c3IvaW5jbHVkZS9ib29zdC9jaGVja2VkX2RlbGV0ZS5ocHAi
IDMgNAojIDEgIi91c3IvaW5jbHVkZS9ib29zdC9jb3JlL2NoZWNrZWRfZGVsZXRlLmhwcCIgMSAz
IDQKIyAyNCAiL3Vzci9pbmNsdWRlL2Jvb3N0L2NvcmUvY2hlY2tlZF9kZWxldGUuaHBwIiAzIDQK
bmFtZXNwYWNlIGJvb3N0CnsKCgoKdGVtcGxhdGU8Y2xhc3MgVD4gaW5saW5lIHZvaWQgY2hlY2tl
ZF9kZWxldGUoVCAqIHgpCnsKCiAgICB0eXBlZGVmIGNoYXIgdHlwZV9tdXN0X2JlX2NvbXBsZXRl
WyBzaXplb2YoVCk/IDE6IC0xIF07CiAgICAodm9pZCkgc2l6ZW9mKHR5cGVfbXVzdF9iZV9jb21w
bGV0ZSk7CiAgICBkZWxldGUgeDsKfQoKdGVtcGxhdGU8Y2xhc3MgVD4gaW5saW5lIHZvaWQgY2hl
Y2tlZF9hcnJheV9kZWxldGUoVCAqIHgpCnsKICAgIHR5cGVkZWYgY2hhciB0eXBlX211c3RfYmVf
Y29tcGxldGVbIHNpemVvZihUKT8gMTogLTEgXTsKICAgICh2b2lkKSBzaXplb2YodHlwZV9tdXN0
X2JlX2NvbXBsZXRlKTsKICAgIGRlbGV0ZSBbXSB4Owp9Cgp0ZW1wbGF0ZTxjbGFzcyBUPiBzdHJ1
Y3QgY2hlY2tlZF9kZWxldGVyCnsKICAgIHR5cGVkZWYgdm9pZCByZXN1bHRfdHlwZTsKICAgIHR5
cGVkZWYgVCAqIGFyZ3VtZW50X3R5cGU7CgogICAgdm9pZCBvcGVyYXRvcigpKFQgKiB4KSBjb25z
dAogICAgewoKICAgICAgICBib29zdDo6Y2hlY2tlZF9kZWxldGUoeCk7CiAgICB9Cn07Cgp0ZW1w
bGF0ZTxjbGFzcyBUPiBzdHJ1Y3QgY2hlY2tlZF9hcnJheV9kZWxldGVyCnsKICAgIHR5cGVkZWYg
dm9pZCByZXN1bHRfdHlwZTsKICAgIHR5cGVkZWYgVCAqIGFyZ3VtZW50X3R5cGU7CgogICAgdm9p
ZCBvcGVyYXRvcigpKFQgKiB4KSBjb25zdAogICAgewogICAgICAgIGJvb3N0OjpjaGVja2VkX2Fy
cmF5X2RlbGV0ZSh4KTsKICAgIH0KfTsKCn0KIyAxNiAiL3Vzci9pbmNsdWRlL2Jvb3N0L2NoZWNr
ZWRfZGVsZXRlLmhwcCIgMiAzIDQKIyAxNyAiL3Vzci9pbmNsdWRlL2Jvb3N0L3NtYXJ0X3B0ci9z
Y29wZWRfcHRyLmhwcCIgMiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYm9vc3Qvc21hcnRfcHRyL2Rl
dGFpbC9zcF9udWxscHRyX3QuaHBwIiAxIDMgNAojIDIzICIvdXNyL2luY2x1ZGUvYm9vc3Qvc21h
cnRfcHRyL2RldGFpbC9zcF9udWxscHRyX3QuaHBwIiAzIDQKbmFtZXNwYWNlIGJvb3N0CnsKCm5h
bWVzcGFjZSBkZXRhaWwKewoKCgoKCgoKICAgIHR5cGVkZWYgc3RkOjpudWxscHRyX3Qgc3BfbnVs
bHB0cl90OwoKCgp9Cgp9CiMgMTggIi91c3IvaW5jbHVkZS9ib29zdC9zbWFydF9wdHIvc2NvcGVk
X3B0ci5ocHAiIDIgMyA0CiMgMSAiL3Vzci9pbmNsdWRlL2Jvb3N0L3NtYXJ0X3B0ci9kZXRhaWwv
c3BfZGlzYWJsZV9kZXByZWNhdGVkLmhwcCIgMSAzIDQKIyAxOSAiL3Vzci9pbmNsdWRlL2Jvb3N0
L3NtYXJ0X3B0ci9zY29wZWRfcHRyLmhwcCIgMiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYm9vc3Qv
ZGV0YWlsL3dvcmthcm91bmQuaHBwIiAxIDMgNAojIDIwICIvdXNyL2luY2x1ZGUvYm9vc3Qvc21h
cnRfcHRyL3Njb3BlZF9wdHIuaHBwIiAyIDMgNAoKCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9tZW1vcnkiIDEgMyA0CiMgNDYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvbWVtb3J5IiAzIDQK
ICAgICAgIAojIDQ3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL21lbW9yeSIgMwojIDY1ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL21lbW9yeSIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfdW5pbml0aWFsaXplZC5oIiAxIDMKIyA1OSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL3N0bF91bmluaXRpYWxpemVkLmgiIDMKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9f
ICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoKICB0ZW1wbGF0ZTxib29sIF9Ucml2
aWFsVmFsdWVUeXBlcz4KICAgIHN0cnVjdCBfX3VuaW5pdGlhbGl6ZWRfY29weQogICAgewogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvciwgdHlwZW5hbWUgX0ZvcndhcmRJdGVy
YXRvcj4KICAgICAgICBzdGF0aWMgX0ZvcndhcmRJdGVyYXRvcgogICAgICAgIF9fdW5pbml0X2Nv
cHkoX0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgICAg
IF9Gb3J3YXJkSXRlcmF0b3IgX19yZXN1bHQpCiAgICAgICAgewogICBfRm9yd2FyZEl0ZXJhdG9y
IF9fY3VyID0gX19yZXN1bHQ7CiAgIHRyeQogICAgIHsKICAgICAgIGZvciAoOyBfX2ZpcnN0ICE9
IF9fbGFzdDsgKytfX2ZpcnN0LCAodm9pZCkrK19fY3VyKQogIHN0ZDo6X0NvbnN0cnVjdChzdGQ6
Ol9fYWRkcmVzc29mKCpfX2N1ciksICpfX2ZpcnN0KTsKICAgICAgIHJldHVybiBfX2N1cjsKICAg
ICB9CiAgIGNhdGNoKC4uLikKICAgICB7CiAgICAgICBzdGQ6Ol9EZXN0cm95KF9fcmVzdWx0LCBf
X2N1cik7CiAgICAgICB0aHJvdzsKICAgICB9CiB9CiAgICB9OwoKICB0ZW1wbGF0ZTw+CiAgICBz
dHJ1Y3QgX191bmluaXRpYWxpemVkX2NvcHk8dHJ1ZT4KICAgIHsKICAgICAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3I+CiAgICAgICAg
c3RhdGljIF9Gb3J3YXJkSXRlcmF0b3IKICAgICAgICBfX3VuaW5pdF9jb3B5KF9JbnB1dEl0ZXJh
dG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgICBfRm9yd2FyZEl0ZXJh
dG9yIF9fcmVzdWx0KQogICAgICAgIHsgcmV0dXJuIHN0ZDo6Y29weShfX2ZpcnN0LCBfX2xhc3Qs
IF9fcmVzdWx0KTsgfQogICAgfTsKIyAxMDUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9z
dGxfdW5pbml0aWFsaXplZC5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3Is
IHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3I+CiAgICBpbmxpbmUgX0ZvcndhcmRJdGVyYXRvcgog
ICAgdW5pbml0aWFsaXplZF9jb3B5KF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJh
dG9yIF9fbGFzdCwKICAgICAgICAgX0ZvcndhcmRJdGVyYXRvciBfX3Jlc3VsdCkKICAgIHsKICAg
ICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0lucHV0SXRlcmF0b3I+Ojp2YWx1
ZV90eXBlCiBfVmFsdWVUeXBlMTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFp
dHM8X0ZvcndhcmRJdGVyYXRvcj46OnZhbHVlX3R5cGUKIF9WYWx1ZVR5cGUyOwoKCgoKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0lucHV0SXRlcmF0b3I+OjpyZWZlcmVu
Y2UgX1JlZlR5cGUxOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfRm9y
d2FyZEl0ZXJhdG9yPjo6cmVmZXJlbmNlIF9SZWZUeXBlMjsKICAgICAgY29uc3QgYm9vbCBfX2Fz
c2lnbmFibGUgPSBpc19hc3NpZ25hYmxlPF9SZWZUeXBlMiwgX1JlZlR5cGUxPjo6dmFsdWU7CgoK
ICAgICAgcmV0dXJuIHN0ZDo6X191bmluaXRpYWxpemVkX2NvcHk8X19pc190cml2aWFsKF9WYWx1
ZVR5cGUxKQogICAgICAgICAgICYmIF9faXNfdHJpdmlhbChfVmFsdWVUeXBlMikKICAgICAgICAg
ICAmJiBfX2Fzc2lnbmFibGU+OjoKIF9fdW5pbml0X2NvcHkoX19maXJzdCwgX19sYXN0LCBfX3Jl
c3VsdCk7CiAgICB9CgoKICB0ZW1wbGF0ZTxib29sIF9Ucml2aWFsVmFsdWVUeXBlPgogICAgc3Ry
dWN0IF9fdW5pbml0aWFsaXplZF9maWxsCiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9G
b3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9UcD4KICAgICAgICBzdGF0aWMgdm9pZAogICAgICAg
IF9fdW5pbml0X2ZpbGwoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9y
IF9fbGFzdCwKICAgICAgICBjb25zdCBfVHAmIF9feCkKICAgICAgICB7CiAgIF9Gb3J3YXJkSXRl
cmF0b3IgX19jdXIgPSBfX2ZpcnN0OwogICB0cnkKICAgICB7CiAgICAgICBmb3IgKDsgX19jdXIg
IT0gX19sYXN0OyArK19fY3VyKQogIHN0ZDo6X0NvbnN0cnVjdChzdGQ6Ol9fYWRkcmVzc29mKCpf
X2N1ciksIF9feCk7CiAgICAgfQogICBjYXRjaCguLi4pCiAgICAgewogICAgICAgc3RkOjpfRGVz
dHJveShfX2ZpcnN0LCBfX2N1cik7CiAgICAgICB0aHJvdzsKICAgICB9CiB9CiAgICB9OwoKICB0
ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX191bmluaXRpYWxpemVkX2ZpbGw8dHJ1ZT4KICAgIHsKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX1RwPgogICAg
ICAgIHN0YXRpYyB2b2lkCiAgICAgICAgX191bmluaXRfZmlsbChfRm9yd2FyZEl0ZXJhdG9yIF9f
Zmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0LAogICAgICAgIGNvbnN0IF9UcCYgX194KQog
ICAgICAgIHsgc3RkOjpmaWxsKF9fZmlyc3QsIF9fbGFzdCwgX194KTsgfQogICAgfTsKIyAxNzEg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfdW5pbml0aWFsaXplZC5oIiAzCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX1RwPgogICAgaW5saW5l
IHZvaWQKICAgIHVuaW5pdGlhbGl6ZWRfZmlsbChfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9G
b3J3YXJkSXRlcmF0b3IgX19sYXN0LAogICAgICAgICBjb25zdCBfVHAmIF9feCkKICAgIHsKICAg
ICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0ZvcndhcmRJdGVyYXRvcj46OnZh
bHVlX3R5cGUKIF9WYWx1ZVR5cGU7CgoKCgogICAgICBjb25zdCBib29sIF9fYXNzaWduYWJsZSA9
IGlzX2NvcHlfYXNzaWduYWJsZTxfVmFsdWVUeXBlPjo6dmFsdWU7CgoKICAgICAgc3RkOjpfX3Vu
aW5pdGlhbGl6ZWRfZmlsbDxfX2lzX3RyaXZpYWwoX1ZhbHVlVHlwZSkgJiYgX19hc3NpZ25hYmxl
Pjo6CiBfX3VuaW5pdF9maWxsKF9fZmlyc3QsIF9fbGFzdCwgX194KTsKICAgIH0KCgogIHRlbXBs
YXRlPGJvb2wgX1RyaXZpYWxWYWx1ZVR5cGU+CiAgICBzdHJ1Y3QgX191bmluaXRpYWxpemVkX2Zp
bGxfbgogICAgewogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBl
bmFtZSBfU2l6ZSwgdHlwZW5hbWUgX1RwPgogICAgICAgIHN0YXRpYyBfRm9yd2FyZEl0ZXJhdG9y
CiAgICAgICAgX191bmluaXRfZmlsbF9uKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX1NpemUg
X19uLAogICBjb25zdCBfVHAmIF9feCkKICAgICAgICB7CiAgIF9Gb3J3YXJkSXRlcmF0b3IgX19j
dXIgPSBfX2ZpcnN0OwogICB0cnkKICAgICB7CiAgICAgICBmb3IgKDsgX19uID4gMDsgLS1fX24s
ICsrX19jdXIpCiAgc3RkOjpfQ29uc3RydWN0KHN0ZDo6X19hZGRyZXNzb2YoKl9fY3VyKSwgX194
KTsKICAgICAgIHJldHVybiBfX2N1cjsKICAgICB9CiAgIGNhdGNoKC4uLikKICAgICB7CiAgICAg
ICBzdGQ6Ol9EZXN0cm95KF9fZmlyc3QsIF9fY3VyKTsKICAgICAgIHRocm93OwogICAgIH0KIH0K
ICAgIH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX3VuaW5pdGlhbGl6ZWRfZmlsbF9uPHRy
dWU+CiAgICB7CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVu
YW1lIF9TaXplLCB0eXBlbmFtZSBfVHA+CiAgICAgICAgc3RhdGljIF9Gb3J3YXJkSXRlcmF0b3IK
ICAgICAgICBfX3VuaW5pdF9maWxsX24oX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfU2l6ZSBf
X24sCiAgIGNvbnN0IF9UcCYgX194KQogICAgICAgIHsgcmV0dXJuIHN0ZDo6ZmlsbF9uKF9fZmly
c3QsIF9fbiwgX194KTsgfQogICAgfTsKIyAyMzQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9zdGxfdW5pbml0aWFsaXplZC5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVy
YXRvciwgdHlwZW5hbWUgX1NpemUsIHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBfRm9yd2FyZEl0
ZXJhdG9yCiAgICB1bmluaXRpYWxpemVkX2ZpbGxfbihfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3Qs
IF9TaXplIF9fbiwgY29uc3QgX1RwJiBfX3gpCiAgICB7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUg
aXRlcmF0b3JfdHJhaXRzPF9Gb3J3YXJkSXRlcmF0b3I+Ojp2YWx1ZV90eXBlCiBfVmFsdWVUeXBl
OwoKCgoKICAgICAgY29uc3QgYm9vbCBfX2Fzc2lnbmFibGUgPSBpc19jb3B5X2Fzc2lnbmFibGU8
X1ZhbHVlVHlwZT46OnZhbHVlOwoKICAgICAgcmV0dXJuIF9fdW5pbml0aWFsaXplZF9maWxsX248
X19pc190cml2aWFsKF9WYWx1ZVR5cGUpICYmIF9fYXNzaWduYWJsZT46OgogX191bmluaXRfZmls
bF9uKF9fZmlyc3QsIF9fbiwgX194KTsKICAgIH0KCgoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0lucHV0SXRlcmF0b3IsIHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsCiAgICB0eXBlbmFtZSBf
QWxsb2NhdG9yPgogICAgX0ZvcndhcmRJdGVyYXRvcgogICAgX191bmluaXRpYWxpemVkX2NvcHlf
YShfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QsCiAgICAgIF9G
b3J3YXJkSXRlcmF0b3IgX19yZXN1bHQsIF9BbGxvY2F0b3ImIF9fYWxsb2MpCiAgICB7CiAgICAg
IF9Gb3J3YXJkSXRlcmF0b3IgX19jdXIgPSBfX3Jlc3VsdDsKICAgICAgdHJ5CiB7CiAgIHR5cGVk
ZWYgX19nbnVfY3h4OjpfX2FsbG9jX3RyYWl0czxfQWxsb2NhdG9yPiBfX3RyYWl0czsKICAgZm9y
ICg7IF9fZmlyc3QgIT0gX19sYXN0OyArK19fZmlyc3QsICh2b2lkKSsrX19jdXIpCiAgICAgX190
cmFpdHM6OmNvbnN0cnVjdChfX2FsbG9jLCBzdGQ6Ol9fYWRkcmVzc29mKCpfX2N1ciksICpfX2Zp
cnN0KTsKICAgcmV0dXJuIF9fY3VyOwogfQogICAgICBjYXRjaCguLi4pCiB7CiAgIHN0ZDo6X0Rl
c3Ryb3koX19yZXN1bHQsIF9fY3VyLCBfX2FsbG9jKTsKICAgdGhyb3c7CiB9CiAgICB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9y
LCB0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgX0ZvcndhcmRJdGVyYXRvcgogICAgX191bmluaXRp
YWxpemVkX2NvcHlfYShfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xh
c3QsCiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19yZXN1bHQsIGFsbG9jYXRvcjxfVHA+JikKICAg
IHsgcmV0dXJuIHN0ZDo6dW5pbml0aWFsaXplZF9jb3B5KF9fZmlyc3QsIF9fbGFzdCwgX19yZXN1
bHQpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLCB0eXBlbmFtZSBfRm9y
d2FyZEl0ZXJhdG9yLAogICAgdHlwZW5hbWUgX0FsbG9jYXRvcj4KICAgIGlubGluZSBfRm9yd2Fy
ZEl0ZXJhdG9yCiAgICBfX3VuaW5pdGlhbGl6ZWRfbW92ZV9hKF9JbnB1dEl0ZXJhdG9yIF9fZmly
c3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgX0ZvcndhcmRJdGVyYXRvciBfX3Jlc3Vs
dCwgX0FsbG9jYXRvciYgX19hbGxvYykKICAgIHsKICAgICAgcmV0dXJuIHN0ZDo6X191bmluaXRp
YWxpemVkX2NvcHlfYShzdGQ6Om1ha2VfbW92ZV9pdGVyYXRvcihfX2ZpcnN0KSwKICAgICAgc3Rk
OjptYWtlX21vdmVfaXRlcmF0b3IoX19sYXN0KSwKICAgICAgX19yZXN1bHQsIF9fYWxsb2MpOwog
ICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvciwgdHlwZW5hbWUgX0Zvcndh
cmRJdGVyYXRvciwKICAgIHR5cGVuYW1lIF9BbGxvY2F0b3I+CiAgICBpbmxpbmUgX0ZvcndhcmRJ
dGVyYXRvcgogICAgX191bmluaXRpYWxpemVkX21vdmVfaWZfbm9leGNlcHRfYShfSW5wdXRJdGVy
YXRvciBfX2ZpcnN0LAogICAgICAgICAgIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgICAg
ICBfRm9yd2FyZEl0ZXJhdG9yIF9fcmVzdWx0LAogICAgICAgICAgIF9BbGxvY2F0b3ImIF9fYWxs
b2MpCiAgICB7CiAgICAgIHJldHVybiBzdGQ6Ol9fdW5pbml0aWFsaXplZF9jb3B5X2EKIChzdGQ6
Ol9fbWFrZV9tb3ZlX2lmX25vZXhjZXB0X2l0ZXJhdG9yKF9fZmlyc3QpLAogIHN0ZDo6X19tYWtl
X21vdmVfaWZfbm9leGNlcHRfaXRlcmF0b3IoX19sYXN0KSwgX19yZXN1bHQsIF9fYWxsb2MpOwog
ICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfVHAs
IHR5cGVuYW1lIF9BbGxvY2F0b3I+CiAgICB2b2lkCiAgICBfX3VuaW5pdGlhbGl6ZWRfZmlsbF9h
KF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QsCiAgICAg
IGNvbnN0IF9UcCYgX194LCBfQWxsb2NhdG9yJiBfX2FsbG9jKQogICAgewogICAgICBfRm9yd2Fy
ZEl0ZXJhdG9yIF9fY3VyID0gX19maXJzdDsKICAgICAgdHJ5CiB7CiAgIHR5cGVkZWYgX19nbnVf
Y3h4OjpfX2FsbG9jX3RyYWl0czxfQWxsb2NhdG9yPiBfX3RyYWl0czsKICAgZm9yICg7IF9fY3Vy
ICE9IF9fbGFzdDsgKytfX2N1cikKICAgICBfX3RyYWl0czo6Y29uc3RydWN0KF9fYWxsb2MsIHN0
ZDo6X19hZGRyZXNzb2YoKl9fY3VyKSwgX194KTsKIH0KICAgICAgY2F0Y2goLi4uKQogewogICBz
dGQ6Ol9EZXN0cm95KF9fZmlyc3QsIF9fY3VyLCBfX2FsbG9jKTsKICAgdGhyb3c7CiB9CiAgICB9
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9UcCwgdHlw
ZW5hbWUgX1RwMj4KICAgIGlubGluZSB2b2lkCiAgICBfX3VuaW5pdGlhbGl6ZWRfZmlsbF9hKF9G
b3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QsCiAgICAgIGNv
bnN0IF9UcCYgX194LCBhbGxvY2F0b3I8X1RwMj4mKQogICAgeyBzdGQ6OnVuaW5pdGlhbGl6ZWRf
ZmlsbChfX2ZpcnN0LCBfX2xhc3QsIF9feCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0Zvcndh
cmRJdGVyYXRvciwgdHlwZW5hbWUgX1NpemUsIHR5cGVuYW1lIF9UcCwKICAgIHR5cGVuYW1lIF9B
bGxvY2F0b3I+CiAgICBfRm9yd2FyZEl0ZXJhdG9yCiAgICBfX3VuaW5pdGlhbGl6ZWRfZmlsbF9u
X2EoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfU2l6ZSBfX24sCiAgICAgICAgY29uc3QgX1Rw
JiBfX3gsIF9BbGxvY2F0b3ImIF9fYWxsb2MpCiAgICB7CiAgICAgIF9Gb3J3YXJkSXRlcmF0b3Ig
X19jdXIgPSBfX2ZpcnN0OwogICAgICB0cnkKIHsKICAgdHlwZWRlZiBfX2dudV9jeHg6Ol9fYWxs
b2NfdHJhaXRzPF9BbGxvY2F0b3I+IF9fdHJhaXRzOwogICBmb3IgKDsgX19uID4gMDsgLS1fX24s
ICsrX19jdXIpCiAgICAgX190cmFpdHM6OmNvbnN0cnVjdChfX2FsbG9jLCBzdGQ6Ol9fYWRkcmVz
c29mKCpfX2N1ciksIF9feCk7CiAgIHJldHVybiBfX2N1cjsKIH0KICAgICAgY2F0Y2goLi4uKQog
ewogICBzdGQ6Ol9EZXN0cm95KF9fZmlyc3QsIF9fY3VyLCBfX2FsbG9jKTsKICAgdGhyb3c7CiB9
CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9T
aXplLCB0eXBlbmFtZSBfVHAsCiAgICB0eXBlbmFtZSBfVHAyPgogICAgaW5saW5lIF9Gb3J3YXJk
SXRlcmF0b3IKICAgIF9fdW5pbml0aWFsaXplZF9maWxsX25fYShfRm9yd2FyZEl0ZXJhdG9yIF9f
Zmlyc3QsIF9TaXplIF9fbiwKICAgICAgICBjb25zdCBfVHAmIF9feCwgYWxsb2NhdG9yPF9UcDI+
JikKICAgIHsgcmV0dXJuIHN0ZDo6dW5pbml0aWFsaXplZF9maWxsX24oX19maXJzdCwgX19uLCBf
X3gpOyB9CiMgMzcwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3VuaW5pdGlhbGl6
ZWQuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yMSwgdHlwZW5hbWUgX0lu
cHV0SXRlcmF0b3IyLAogICAgdHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX0Fs
bG9jYXRvcj4KICAgIGlubGluZSBfRm9yd2FyZEl0ZXJhdG9yCiAgICBfX3VuaW5pdGlhbGl6ZWRf
Y29weV9tb3ZlKF9JbnB1dEl0ZXJhdG9yMSBfX2ZpcnN0MSwKICAgICAgICAgX0lucHV0SXRlcmF0
b3IxIF9fbGFzdDEsCiAgICAgICAgIF9JbnB1dEl0ZXJhdG9yMiBfX2ZpcnN0MiwKICAgICAgICAg
X0lucHV0SXRlcmF0b3IyIF9fbGFzdDIsCiAgICAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19yZXN1
bHQsCiAgICAgICAgIF9BbGxvY2F0b3ImIF9fYWxsb2MpCiAgICB7CiAgICAgIF9Gb3J3YXJkSXRl
cmF0b3IgX19taWQgPSBzdGQ6Ol9fdW5pbml0aWFsaXplZF9jb3B5X2EoX19maXJzdDEsIF9fbGFz
dDEsCiAgICAgICAgICBfX3Jlc3VsdCwKICAgICAgICAgIF9fYWxsb2MpOwogICAgICB0cnkKIHsK
ICAgcmV0dXJuIHN0ZDo6X191bmluaXRpYWxpemVkX21vdmVfYShfX2ZpcnN0MiwgX19sYXN0Miwg
X19taWQsIF9fYWxsb2MpOwogfQogICAgICBjYXRjaCguLi4pCiB7CiAgIHN0ZDo6X0Rlc3Ryb3ko
X19yZXN1bHQsIF9fbWlkLCBfX2FsbG9jKTsKICAgdGhyb3c7CiB9CiAgICB9CgoKCgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcjEsIHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yMiwK
ICAgIHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9BbGxvY2F0b3I+CiAgICBp
bmxpbmUgX0ZvcndhcmRJdGVyYXRvcgogICAgX191bmluaXRpYWxpemVkX21vdmVfY29weShfSW5w
dXRJdGVyYXRvcjEgX19maXJzdDEsCiAgICAgICAgIF9JbnB1dEl0ZXJhdG9yMSBfX2xhc3QxLAog
ICAgICAgICBfSW5wdXRJdGVyYXRvcjIgX19maXJzdDIsCiAgICAgICAgIF9JbnB1dEl0ZXJhdG9y
MiBfX2xhc3QyLAogICAgICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fcmVzdWx0LAogICAgICAgICBf
QWxsb2NhdG9yJiBfX2FsbG9jKQogICAgewogICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fbWlkID0g
c3RkOjpfX3VuaW5pdGlhbGl6ZWRfbW92ZV9hKF9fZmlyc3QxLCBfX2xhc3QxLAogICAgICAgICAg
X19yZXN1bHQsCiAgICAgICAgICBfX2FsbG9jKTsKICAgICAgdHJ5CiB7CiAgIHJldHVybiBzdGQ6
Ol9fdW5pbml0aWFsaXplZF9jb3B5X2EoX19maXJzdDIsIF9fbGFzdDIsIF9fbWlkLCBfX2FsbG9j
KTsKIH0KICAgICAgY2F0Y2goLi4uKQogewogICBzdGQ6Ol9EZXN0cm95KF9fcmVzdWx0LCBfX21p
ZCwgX19hbGxvYyk7CiAgIHRocm93OwogfQogICAgfQoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
Rm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLAog
ICAgdHlwZW5hbWUgX0FsbG9jYXRvcj4KICAgIGlubGluZSBfRm9yd2FyZEl0ZXJhdG9yCiAgICBf
X3VuaW5pdGlhbGl6ZWRfZmlsbF9tb3ZlKF9Gb3J3YXJkSXRlcmF0b3IgX19yZXN1bHQsIF9Gb3J3
YXJkSXRlcmF0b3IgX19taWQsCiAgICAgICAgIGNvbnN0IF9UcCYgX194LCBfSW5wdXRJdGVyYXRv
ciBfX2ZpcnN0LAogICAgICAgICBfSW5wdXRJdGVyYXRvciBfX2xhc3QsIF9BbGxvY2F0b3ImIF9f
YWxsb2MpCiAgICB7CiAgICAgIHN0ZDo6X191bmluaXRpYWxpemVkX2ZpbGxfYShfX3Jlc3VsdCwg
X19taWQsIF9feCwgX19hbGxvYyk7CiAgICAgIHRyeQogewogICByZXR1cm4gc3RkOjpfX3VuaW5p
dGlhbGl6ZWRfbW92ZV9hKF9fZmlyc3QsIF9fbGFzdCwgX19taWQsIF9fYWxsb2MpOwogfQogICAg
ICBjYXRjaCguLi4pCiB7CiAgIHN0ZDo6X0Rlc3Ryb3koX19yZXN1bHQsIF9fbWlkLCBfX2FsbG9j
KTsKICAgdGhyb3c7CiB9CiAgICB9CgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJh
dG9yLCB0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yLCB0eXBlbmFtZSBfVHAsCiAgICB0eXBlbmFt
ZSBfQWxsb2NhdG9yPgogICAgaW5saW5lIHZvaWQKICAgIF9fdW5pbml0aWFsaXplZF9tb3ZlX2Zp
bGwoX0lucHV0SXRlcmF0b3IgX19maXJzdDEsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdDEsCiAgICAg
ICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdDIsCiAgICAgICAgIF9Gb3J3YXJkSXRlcmF0b3Ig
X19sYXN0MiwgY29uc3QgX1RwJiBfX3gsCiAgICAgICAgIF9BbGxvY2F0b3ImIF9fYWxsb2MpCiAg
ICB7CiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19taWQyID0gc3RkOjpfX3VuaW5pdGlhbGl6ZWRf
bW92ZV9hKF9fZmlyc3QxLCBfX2xhc3QxLAogICAgICAgICAgIF9fZmlyc3QyLAogICAgICAgICAg
IF9fYWxsb2MpOwogICAgICB0cnkKIHsKICAgc3RkOjpfX3VuaW5pdGlhbGl6ZWRfZmlsbF9hKF9f
bWlkMiwgX19sYXN0MiwgX194LCBfX2FsbG9jKTsKIH0KICAgICAgY2F0Y2goLi4uKQogewogICBz
dGQ6Ol9EZXN0cm95KF9fZmlyc3QyLCBfX21pZDIsIF9fYWxsb2MpOwogICB0aHJvdzsKIH0KICAg
IH0KCgoKCgogIHRlbXBsYXRlPGJvb2wgX1RyaXZpYWxWYWx1ZVR5cGU+CiAgICBzdHJ1Y3QgX191
bmluaXRpYWxpemVkX2RlZmF1bHRfMQogICAgewogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9y
d2FyZEl0ZXJhdG9yPgogICAgICAgIHN0YXRpYyB2b2lkCiAgICAgICAgX191bmluaXRfZGVmYXVs
dChfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0KQogICAg
ICAgIHsKICAgX0ZvcndhcmRJdGVyYXRvciBfX2N1ciA9IF9fZmlyc3Q7CiAgIHRyeQogICAgIHsK
ICAgICAgIGZvciAoOyBfX2N1ciAhPSBfX2xhc3Q7ICsrX19jdXIpCiAgc3RkOjpfQ29uc3RydWN0
KHN0ZDo6X19hZGRyZXNzb2YoKl9fY3VyKSk7CiAgICAgfQogICBjYXRjaCguLi4pCiAgICAgewog
ICAgICAgc3RkOjpfRGVzdHJveShfX2ZpcnN0LCBfX2N1cik7CiAgICAgICB0aHJvdzsKICAgICB9
CiB9CiAgICB9OwoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX191bmluaXRpYWxpemVkX2RlZmF1
bHRfMTx0cnVlPgogICAgewogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9y
PgogICAgICAgIHN0YXRpYyB2b2lkCiAgICAgICAgX191bmluaXRfZGVmYXVsdChfRm9yd2FyZEl0
ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0KQogICAgICAgIHsKICAgdHlw
ZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0ZvcndhcmRJdGVyYXRvcj46OnZhbHVlX3R5
cGUKICAgICBfVmFsdWVUeXBlOwoKICAgc3RkOjpmaWxsKF9fZmlyc3QsIF9fbGFzdCwgX1ZhbHVl
VHlwZSgpKTsKIH0KICAgIH07CgogIHRlbXBsYXRlPGJvb2wgX1RyaXZpYWxWYWx1ZVR5cGU+CiAg
ICBzdHJ1Y3QgX191bmluaXRpYWxpemVkX2RlZmF1bHRfbl8xCiAgICB7CiAgICAgIHRlbXBsYXRl
PHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9TaXplPgogICAgICAgIHN0YXRp
YyBfRm9yd2FyZEl0ZXJhdG9yCiAgICAgICAgX191bmluaXRfZGVmYXVsdF9uKF9Gb3J3YXJkSXRl
cmF0b3IgX19maXJzdCwgX1NpemUgX19uKQogICAgICAgIHsKICAgX0ZvcndhcmRJdGVyYXRvciBf
X2N1ciA9IF9fZmlyc3Q7CiAgIHRyeQogICAgIHsKICAgICAgIGZvciAoOyBfX24gPiAwOyAtLV9f
biwgKytfX2N1cikKICBzdGQ6Ol9Db25zdHJ1Y3Qoc3RkOjpfX2FkZHJlc3NvZigqX19jdXIpKTsK
ICAgICAgIHJldHVybiBfX2N1cjsKICAgICB9CiAgIGNhdGNoKC4uLikKICAgICB7CiAgICAgICBz
dGQ6Ol9EZXN0cm95KF9fZmlyc3QsIF9fY3VyKTsKICAgICAgIHRocm93OwogICAgIH0KIH0KICAg
IH07CgogIHRlbXBsYXRlPD4KICAgIHN0cnVjdCBfX3VuaW5pdGlhbGl6ZWRfZGVmYXVsdF9uXzE8
dHJ1ZT4KICAgIHsKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlw
ZW5hbWUgX1NpemU+CiAgICAgICAgc3RhdGljIF9Gb3J3YXJkSXRlcmF0b3IKICAgICAgICBfX3Vu
aW5pdF9kZWZhdWx0X24oX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfU2l6ZSBfX24pCiAgICAg
ICAgewogICB0eXBlZGVmIHR5cGVuYW1lIGl0ZXJhdG9yX3RyYWl0czxfRm9yd2FyZEl0ZXJhdG9y
Pjo6dmFsdWVfdHlwZQogICAgIF9WYWx1ZVR5cGU7CgogICByZXR1cm4gc3RkOjpmaWxsX24oX19m
aXJzdCwgX19uLCBfVmFsdWVUeXBlKCkpOwogfQogICAgfTsKCgoKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0ZvcndhcmRJdGVyYXRvcj4KICAgIGlubGluZSB2b2lkCiAgICBfX3VuaW5pdGlhbGl6ZWRf
ZGVmYXVsdChfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsCiAgICAgICBfRm9yd2FyZEl0ZXJhdG9y
IF9fbGFzdCkKICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcl90cmFpdHM8X0Zv
cndhcmRJdGVyYXRvcj46OnZhbHVlX3R5cGUKIF9WYWx1ZVR5cGU7CgogICAgICBjb25zdCBib29s
IF9fYXNzaWduYWJsZSA9IGlzX2NvcHlfYXNzaWduYWJsZTxfVmFsdWVUeXBlPjo6dmFsdWU7Cgog
ICAgICBzdGQ6Ol9fdW5pbml0aWFsaXplZF9kZWZhdWx0XzE8X19pc190cml2aWFsKF9WYWx1ZVR5
cGUpCiAgICAgICAgICYmIF9fYXNzaWduYWJsZT46OgogX191bmluaXRfZGVmYXVsdChfX2ZpcnN0
LCBfX2xhc3QpOwogICAgfQoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3Is
IHR5cGVuYW1lIF9TaXplPgogICAgaW5saW5lIF9Gb3J3YXJkSXRlcmF0b3IKICAgIF9fdW5pbml0
aWFsaXplZF9kZWZhdWx0X24oX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfU2l6ZSBfX24pCiAg
ICB7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgaXRlcmF0b3JfdHJhaXRzPF9Gb3J3YXJkSXRlcmF0
b3I+Ojp2YWx1ZV90eXBlCiBfVmFsdWVUeXBlOwoKICAgICAgY29uc3QgYm9vbCBfX2Fzc2lnbmFi
bGUgPSBpc19jb3B5X2Fzc2lnbmFibGU8X1ZhbHVlVHlwZT46OnZhbHVlOwoKICAgICAgcmV0dXJu
IF9fdW5pbml0aWFsaXplZF9kZWZhdWx0X25fMTxfX2lzX3RyaXZpYWwoX1ZhbHVlVHlwZSkKICAg
ICAgICAgICAmJiBfX2Fzc2lnbmFibGU+OjoKIF9fdW5pbml0X2RlZmF1bHRfbihfX2ZpcnN0LCBf
X24pOwogICAgfQoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlw
ZW5hbWUgX0FsbG9jYXRvcj4KICAgIHZvaWQKICAgIF9fdW5pbml0aWFsaXplZF9kZWZhdWx0X2Eo
X0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LAogICAgICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFz
dCwKICAgICAgICAgX0FsbG9jYXRvciYgX19hbGxvYykKICAgIHsKICAgICAgX0ZvcndhcmRJdGVy
YXRvciBfX2N1ciA9IF9fZmlyc3Q7CiAgICAgIHRyeQogewogICB0eXBlZGVmIF9fZ251X2N4eDo6
X19hbGxvY190cmFpdHM8X0FsbG9jYXRvcj4gX190cmFpdHM7CiAgIGZvciAoOyBfX2N1ciAhPSBf
X2xhc3Q7ICsrX19jdXIpCiAgICAgX190cmFpdHM6OmNvbnN0cnVjdChfX2FsbG9jLCBzdGQ6Ol9f
YWRkcmVzc29mKCpfX2N1cikpOwogfQogICAgICBjYXRjaCguLi4pCiB7CiAgIHN0ZDo6X0Rlc3Ry
b3koX19maXJzdCwgX19jdXIsIF9fYWxsb2MpOwogICB0aHJvdzsKIH0KICAgIH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvciwgdHlwZW5hbWUgX1RwPgogICAgaW5saW5lIHZv
aWQKICAgIF9fdW5pbml0aWFsaXplZF9kZWZhdWx0X2EoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0
LAogICAgICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgICAgYWxsb2NhdG9yPF9U
cD4mKQogICAgeyBzdGQ6Ol9fdW5pbml0aWFsaXplZF9kZWZhdWx0KF9fZmlyc3QsIF9fbGFzdCk7
IH0KCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9T
aXplLCB0eXBlbmFtZSBfQWxsb2NhdG9yPgogICAgX0ZvcndhcmRJdGVyYXRvcgogICAgX191bmlu
aXRpYWxpemVkX2RlZmF1bHRfbl9hKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX1NpemUgX19u
LAogICAgX0FsbG9jYXRvciYgX19hbGxvYykKICAgIHsKICAgICAgX0ZvcndhcmRJdGVyYXRvciBf
X2N1ciA9IF9fZmlyc3Q7CiAgICAgIHRyeQogewogICB0eXBlZGVmIF9fZ251X2N4eDo6X19hbGxv
Y190cmFpdHM8X0FsbG9jYXRvcj4gX190cmFpdHM7CiAgIGZvciAoOyBfX24gPiAwOyAtLV9fbiwg
KytfX2N1cikKICAgICBfX3RyYWl0czo6Y29uc3RydWN0KF9fYWxsb2MsIHN0ZDo6X19hZGRyZXNz
b2YoKl9fY3VyKSk7CiAgIHJldHVybiBfX2N1cjsKIH0KICAgICAgY2F0Y2goLi4uKQogewogICBz
dGQ6Ol9EZXN0cm95KF9fZmlyc3QsIF9fY3VyLCBfX2FsbG9jKTsKICAgdGhyb3c7CiB9CiAgICB9
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3IsIHR5cGVuYW1lIF9TaXplLCB0
eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgX0ZvcndhcmRJdGVyYXRvcgogICAgX191bmluaXRpYWxp
emVkX2RlZmF1bHRfbl9hKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX1NpemUgX19uLAogICAg
YWxsb2NhdG9yPF9UcD4mKQogICAgeyByZXR1cm4gc3RkOjpfX3VuaW5pdGlhbGl6ZWRfZGVmYXVs
dF9uKF9fZmlyc3QsIF9fbik7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9y
LCB0eXBlbmFtZSBfU2l6ZSwKICAgIHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3I+CiAgICBfRm9y
d2FyZEl0ZXJhdG9yCiAgICBfX3VuaW5pdGlhbGl6ZWRfY29weV9uKF9JbnB1dEl0ZXJhdG9yIF9f
Zmlyc3QsIF9TaXplIF9fbiwKICAgICAgX0ZvcndhcmRJdGVyYXRvciBfX3Jlc3VsdCwgaW5wdXRf
aXRlcmF0b3JfdGFnKQogICAgewogICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fY3VyID0gX19yZXN1
bHQ7CiAgICAgIHRyeQogewogICBmb3IgKDsgX19uID4gMDsgLS1fX24sICsrX19maXJzdCwgKytf
X2N1cikKICAgICBzdGQ6Ol9Db25zdHJ1Y3Qoc3RkOjpfX2FkZHJlc3NvZigqX19jdXIpLCAqX19m
aXJzdCk7CiAgIHJldHVybiBfX2N1cjsKIH0KICAgICAgY2F0Y2goLi4uKQogewogICBzdGQ6Ol9E
ZXN0cm95KF9fcmVzdWx0LCBfX2N1cik7CiAgIHRocm93OwogfQogICAgfQoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfUmFuZG9tQWNjZXNzSXRlcmF0b3IsIHR5cGVuYW1lIF9TaXplLAogICAgdHlwZW5h
bWUgX0ZvcndhcmRJdGVyYXRvcj4KICAgIGlubGluZSBfRm9yd2FyZEl0ZXJhdG9yCiAgICBfX3Vu
aW5pdGlhbGl6ZWRfY29weV9uKF9SYW5kb21BY2Nlc3NJdGVyYXRvciBfX2ZpcnN0LCBfU2l6ZSBf
X24sCiAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19yZXN1bHQsCiAgICAgIHJhbmRvbV9hY2Nlc3Nf
aXRlcmF0b3JfdGFnKQogICAgeyByZXR1cm4gc3RkOjp1bmluaXRpYWxpemVkX2NvcHkoX19maXJz
dCwgX19maXJzdCArIF9fbiwgX19yZXN1bHQpOyB9CiMgNjc3ICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvc3RsX3VuaW5pdGlhbGl6ZWQuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1
dEl0ZXJhdG9yLCB0eXBlbmFtZSBfU2l6ZSwgdHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvcj4KICAg
IGlubGluZSBfRm9yd2FyZEl0ZXJhdG9yCiAgICB1bmluaXRpYWxpemVkX2NvcHlfbihfSW5wdXRJ
dGVyYXRvciBfX2ZpcnN0LCBfU2l6ZSBfX24sCiAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fcmVzdWx0
KQogICAgeyByZXR1cm4gc3RkOjpfX3VuaW5pdGlhbGl6ZWRfY29weV9uKF9fZmlyc3QsIF9fbiwg
X19yZXN1bHQsCiAgICAgIHN0ZDo6X19pdGVyYXRvcl9jYXRlZ29yeShfX2ZpcnN0KSk7IH0KCgoK
fQojIDY2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL21lbW9yeSIgMiAzCgojIDEgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfcmF3X3N0b3JhZ2VfaXRlci5oIiAxIDMKIyA1OSAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9yYXdfc3RvcmFnZV9pdGVyLmgiIDMKbmFtZXNw
YWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoK
CgoKCiAgdGVtcGxhdGUgPGNsYXNzIF9PdXRwdXRJdGVyYXRvciwgY2xhc3MgX1RwPgogICAgY2xh
c3MgcmF3X3N0b3JhZ2VfaXRlcmF0b3IKICAgIDogcHVibGljIGl0ZXJhdG9yPG91dHB1dF9pdGVy
YXRvcl90YWcsIHZvaWQsIHZvaWQsIHZvaWQsIHZvaWQ+CiAgICB7CiAgICBwcm90ZWN0ZWQ6CiAg
ICAgIF9PdXRwdXRJdGVyYXRvciBfTV9pdGVyOwoKICAgIHB1YmxpYzoKICAgICAgZXhwbGljaXQK
ICAgICAgcmF3X3N0b3JhZ2VfaXRlcmF0b3IoX091dHB1dEl0ZXJhdG9yIF9feCkKICAgICAgOiBf
TV9pdGVyKF9feCkge30KCiAgICAgIHJhd19zdG9yYWdlX2l0ZXJhdG9yJgogICAgICBvcGVyYXRv
ciooKSB7IHJldHVybiAqdGhpczsgfQoKICAgICAgcmF3X3N0b3JhZ2VfaXRlcmF0b3ImCiAgICAg
IG9wZXJhdG9yPShjb25zdCBfVHAmIF9fZWxlbWVudCkKICAgICAgewogc3RkOjpfQ29uc3RydWN0
KHN0ZDo6X19hZGRyZXNzb2YoKl9NX2l0ZXIpLCBfX2VsZW1lbnQpOwogcmV0dXJuICp0aGlzOwog
ICAgICB9CgogICAgICByYXdfc3RvcmFnZV9pdGVyYXRvcjxfT3V0cHV0SXRlcmF0b3IsIF9UcD4m
CiAgICAgIG9wZXJhdG9yKysoKQogICAgICB7CiArK19NX2l0ZXI7CiByZXR1cm4gKnRoaXM7CiAg
ICAgIH0KCiAgICAgIHJhd19zdG9yYWdlX2l0ZXJhdG9yPF9PdXRwdXRJdGVyYXRvciwgX1RwPgog
ICAgICBvcGVyYXRvcisrKGludCkKICAgICAgewogcmF3X3N0b3JhZ2VfaXRlcmF0b3I8X091dHB1
dEl0ZXJhdG9yLCBfVHA+IF9fdG1wID0gKnRoaXM7CiArK19NX2l0ZXI7CiByZXR1cm4gX190bXA7
CiAgICAgIH0KCgoKICAgICAgX091dHB1dEl0ZXJhdG9yIGJhc2UoKSBjb25zdCB7IHJldHVybiBf
TV9pdGVyOyB9CiAgICB9OwoKCn0KIyA2OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9tZW1vcnki
IDIgMwoKCgojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdHlwZWluZm8iIDEgMwojIDMyICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL3R5cGVpbmZvIiAzCiAgICAgICAKIyAzMyAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC90eXBlaW5mbyIgMwoKCgoKCgojcHJhZ21hIEdDQyB2aXNpYmlsaXR5IHB1
c2goZGVmYXVsdCkKCmV4dGVybiAiQysrIiB7CgpuYW1lc3BhY2UgX19jeHhhYml2MQp7CiAgY2xh
c3MgX19jbGFzc190eXBlX2luZm87Cn0KIyA4MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC90eXBl
aW5mbyIgMwpuYW1lc3BhY2Ugc3RkCnsKCgoKCgoKICBjbGFzcyB0eXBlX2luZm8KICB7CiAgcHVi
bGljOgoKCgoKICAgIHZpcnR1YWwgfnR5cGVfaW5mbygpOwoKCgogICAgY29uc3QgY2hhciogbmFt
ZSgpIGNvbnN0IG5vZXhjZXB0CiAgICB7IHJldHVybiBfX25hbWVbMF0gPT0gJyonID8gX19uYW1l
ICsgMSA6IF9fbmFtZTsgfQojIDExNSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC90eXBlaW5mbyIg
MwogICAgYm9vbCBiZWZvcmUoY29uc3QgdHlwZV9pbmZvJiBfX2FyZykgY29uc3Qgbm9leGNlcHQK
ICAgIHsgcmV0dXJuIChfX25hbWVbMF0gPT0gJyonICYmIF9fYXJnLl9fbmFtZVswXSA9PSAnKicp
CiA/IF9fbmFtZSA8IF9fYXJnLl9fbmFtZQogOiBfX2J1aWx0aW5fc3RyY21wIChfX25hbWUsIF9f
YXJnLl9fbmFtZSkgPCAwOyB9CgogICAgYm9vbCBvcGVyYXRvcj09KGNvbnN0IHR5cGVfaW5mbyYg
X19hcmcpIGNvbnN0IG5vZXhjZXB0CiAgICB7CiAgICAgIHJldHVybiAoKF9fbmFtZSA9PSBfX2Fy
Zy5fX25hbWUpCiAgICAgICB8fCAoX19uYW1lWzBdICE9ICcqJyAmJgogICAgX19idWlsdGluX3N0
cmNtcCAoX19uYW1lLCBfX2FyZy5fX25hbWUpID09IDApKTsKICAgIH0KIyAxMzYgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvdHlwZWluZm8iIDMKICAgIGJvb2wgb3BlcmF0b3IhPShjb25zdCB0eXBl
X2luZm8mIF9fYXJnKSBjb25zdCBub2V4Y2VwdAogICAgeyByZXR1cm4gIW9wZXJhdG9yPT0oX19h
cmcpOyB9CgoKICAgIHNpemVfdCBoYXNoX2NvZGUoKSBjb25zdCBub2V4Y2VwdAogICAgewoKICAg
ICAgcmV0dXJuIF9IYXNoX2J5dGVzKG5hbWUoKSwgX19idWlsdGluX3N0cmxlbihuYW1lKCkpLAog
ICAgc3RhdGljX2Nhc3Q8c2l6ZV90PigweGM3MGY2OTA3VUwpKTsKCgoKICAgIH0KCgoKICAgIHZp
cnR1YWwgYm9vbCBfX2lzX3BvaW50ZXJfcCgpIGNvbnN0OwoKCiAgICB2aXJ0dWFsIGJvb2wgX19p
c19mdW5jdGlvbl9wKCkgY29uc3Q7CgoKCgoKCgogICAgdmlydHVhbCBib29sIF9fZG9fY2F0Y2go
Y29uc3QgdHlwZV9pbmZvICpfX3Rocl90eXBlLCB2b2lkICoqX190aHJfb2JqLAogICAgICAgdW5z
aWduZWQgX19vdXRlcikgY29uc3Q7CgoKICAgIHZpcnR1YWwgYm9vbCBfX2RvX3VwY2FzdChjb25z
dCBfX2N4eGFiaXYxOjpfX2NsYXNzX3R5cGVfaW5mbyAqX190YXJnZXQsCiAgICAgICAgdm9pZCAq
Kl9fb2JqX3B0cikgY29uc3Q7CgogIHByb3RlY3RlZDoKICAgIGNvbnN0IGNoYXIgKl9fbmFtZTsK
CiAgICBleHBsaWNpdCB0eXBlX2luZm8oY29uc3QgY2hhciAqX19uKTogX19uYW1lKF9fbikgeyB9
CgogIHByaXZhdGU6CgogICAgdHlwZV9pbmZvJiBvcGVyYXRvcj0oY29uc3QgdHlwZV9pbmZvJik7
CiAgICB0eXBlX2luZm8oY29uc3QgdHlwZV9pbmZvJik7CiAgfTsKCgoKCgoKCiAgY2xhc3MgYmFk
X2Nhc3QgOiBwdWJsaWMgZXhjZXB0aW9uCiAgewogIHB1YmxpYzoKICAgIGJhZF9jYXN0KCkgbm9l
eGNlcHQgeyB9CgoKCiAgICB2aXJ0dWFsIH5iYWRfY2FzdCgpIG5vZXhjZXB0OwoKCiAgICB2aXJ0
dWFsIGNvbnN0IGNoYXIqIHdoYXQoKSBjb25zdCBub2V4Y2VwdDsKICB9OwoKCgoKCiAgY2xhc3Mg
YmFkX3R5cGVpZCA6IHB1YmxpYyBleGNlcHRpb24KICB7CiAgcHVibGljOgogICAgYmFkX3R5cGVp
ZCAoKSBub2V4Y2VwdCB7IH0KCgoKICAgIHZpcnR1YWwgfmJhZF90eXBlaWQoKSBub2V4Y2VwdDsK
CgogICAgdmlydHVhbCBjb25zdCBjaGFyKiB3aGF0KCkgY29uc3Qgbm9leGNlcHQ7CiAgfTsKfQoK
fQoKI3ByYWdtYSBHQ0MgdmlzaWJpbGl0eSBwb3AKIyA3MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9tZW1vcnkiIDIgMwoKCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leHQvY29uY3VycmVu
Y2UuaCIgMSAzCiMgMzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZXh0L2NvbmN1cnJlbmNlLmgi
IDMKICAgICAgIAojIDMzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2V4dC9jb25jdXJyZW5jZS5o
IiAzCgoKCgoKCgpuYW1lc3BhY2UgX19nbnVfY3h4IF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxp
dHlfXyAoImRlZmF1bHQiKSkpCnsKCgoKCgoKCiAgZW51bSBfTG9ja19wb2xpY3kgeyBfU19zaW5n
bGUsIF9TX211dGV4LCBfU19hdG9taWMgfTsKCgoKICBzdGF0aWMgY29uc3QgX0xvY2tfcG9saWN5
IF9fZGVmYXVsdF9sb2NrX3BvbGljeSA9CgoKCiAgX1NfYXRvbWljOwojIDY3ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2V4dC9jb25jdXJyZW5jZS5oIiAzCiAgY2xhc3MgX19jb25jdXJyZW5jZV9s
b2NrX2Vycm9yIDogcHVibGljIHN0ZDo6ZXhjZXB0aW9uCiAgewogIHB1YmxpYzoKICAgIHZpcnR1
YWwgY2hhciBjb25zdCoKICAgIHdoYXQoKSBjb25zdCB0aHJvdygpCiAgICB7IHJldHVybiAiX19n
bnVfY3h4OjpfX2NvbmN1cnJlbmNlX2xvY2tfZXJyb3IiOyB9CiAgfTsKCiAgY2xhc3MgX19jb25j
dXJyZW5jZV91bmxvY2tfZXJyb3IgOiBwdWJsaWMgc3RkOjpleGNlcHRpb24KICB7CiAgcHVibGlj
OgogICAgdmlydHVhbCBjaGFyIGNvbnN0KgogICAgd2hhdCgpIGNvbnN0IHRocm93KCkKICAgIHsg
cmV0dXJuICJfX2dudV9jeHg6Ol9fY29uY3VycmVuY2VfdW5sb2NrX2Vycm9yIjsgfQogIH07Cgog
IGNsYXNzIF9fY29uY3VycmVuY2VfYnJvYWRjYXN0X2Vycm9yIDogcHVibGljIHN0ZDo6ZXhjZXB0
aW9uCiAgewogIHB1YmxpYzoKICAgIHZpcnR1YWwgY2hhciBjb25zdCoKICAgIHdoYXQoKSBjb25z
dCB0aHJvdygpCiAgICB7IHJldHVybiAiX19nbnVfY3h4OjpfX2NvbmN1cnJlbmNlX2Jyb2FkY2Fz
dF9lcnJvciI7IH0KICB9OwoKICBjbGFzcyBfX2NvbmN1cnJlbmNlX3dhaXRfZXJyb3IgOiBwdWJs
aWMgc3RkOjpleGNlcHRpb24KICB7CiAgcHVibGljOgogICAgdmlydHVhbCBjaGFyIGNvbnN0Kgog
ICAgd2hhdCgpIGNvbnN0IHRocm93KCkKICAgIHsgcmV0dXJuICJfX2dudV9jeHg6Ol9fY29uY3Vy
cmVuY2Vfd2FpdF9lcnJvciI7IH0KICB9OwoKCiAgaW5saW5lIHZvaWQKICBfX3Rocm93X2NvbmN1
cnJlbmNlX2xvY2tfZXJyb3IoKQogIHsgKHRocm93IChfX2NvbmN1cnJlbmNlX2xvY2tfZXJyb3Io
KSkpOyB9CgogIGlubGluZSB2b2lkCiAgX190aHJvd19jb25jdXJyZW5jZV91bmxvY2tfZXJyb3Io
KQogIHsgKHRocm93IChfX2NvbmN1cnJlbmNlX3VubG9ja19lcnJvcigpKSk7IH0KCgogIGlubGlu
ZSB2b2lkCiAgX190aHJvd19jb25jdXJyZW5jZV9icm9hZGNhc3RfZXJyb3IoKQogIHsgKHRocm93
IChfX2NvbmN1cnJlbmNlX2Jyb2FkY2FzdF9lcnJvcigpKSk7IH0KCiAgaW5saW5lIHZvaWQKICBf
X3Rocm93X2NvbmN1cnJlbmNlX3dhaXRfZXJyb3IoKQogIHsgKHRocm93IChfX2NvbmN1cnJlbmNl
X3dhaXRfZXJyb3IoKSkpOyB9CgoKICBjbGFzcyBfX211dGV4CiAgewogIHByaXZhdGU6CgogICAg
X19ndGhyZWFkX211dGV4X3QgX01fbXV0ZXggPSB7IHsgMCwgMCwgMCwgMCwgMCwgMCwgeyAwLCAw
IH0gfSB9OwoKCgoKICAgIF9fbXV0ZXgoY29uc3QgX19tdXRleCYpOwogICAgX19tdXRleCYgb3Bl
cmF0b3I9KGNvbnN0IF9fbXV0ZXgmKTsKCiAgcHVibGljOgogICAgX19tdXRleCgpCiAgICB7CgoK
CgogICAgfQojIDE0NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leHQvY29uY3VycmVuY2UuaCIg
MwogICAgdm9pZCBsb2NrKCkKICAgIHsKCiAgICAgIGlmIChfX2d0aHJlYWRfYWN0aXZlX3AoKSkK
IHsKICAgaWYgKF9fZ3RocmVhZF9tdXRleF9sb2NrKCZfTV9tdXRleCkgIT0gMCkKICAgICBfX3Ro
cm93X2NvbmN1cnJlbmNlX2xvY2tfZXJyb3IoKTsKIH0KCiAgICB9CgogICAgdm9pZCB1bmxvY2so
KQogICAgewoKICAgICAgaWYgKF9fZ3RocmVhZF9hY3RpdmVfcCgpKQogewogICBpZiAoX19ndGhy
ZWFkX211dGV4X3VubG9jaygmX01fbXV0ZXgpICE9IDApCiAgICAgX190aHJvd19jb25jdXJyZW5j
ZV91bmxvY2tfZXJyb3IoKTsKIH0KCiAgICB9CgogICAgX19ndGhyZWFkX211dGV4X3QqIGd0aHJl
YWRfbXV0ZXgodm9pZCkKICAgICAgeyByZXR1cm4gJl9NX211dGV4OyB9CiAgfTsKCiAgY2xhc3Mg
X19yZWN1cnNpdmVfbXV0ZXgKICB7CiAgcHJpdmF0ZToKCiAgICBfX2d0aHJlYWRfcmVjdXJzaXZl
X211dGV4X3QgX01fbXV0ZXggPSB7IHsgMCwgMCwgMCwgMCwgUFRIUkVBRF9NVVRFWF9SRUNVUlNJ
VkVfTlAsIDAsIHsgMCwgMCB9IH0gfTsKCgoKCiAgICBfX3JlY3Vyc2l2ZV9tdXRleChjb25zdCBf
X3JlY3Vyc2l2ZV9tdXRleCYpOwogICAgX19yZWN1cnNpdmVfbXV0ZXgmIG9wZXJhdG9yPShjb25z
dCBfX3JlY3Vyc2l2ZV9tdXRleCYpOwoKICBwdWJsaWM6CiAgICBfX3JlY3Vyc2l2ZV9tdXRleCgp
CiAgICB7CgoKCgogICAgfQojIDIwMiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9leHQvY29uY3Vy
cmVuY2UuaCIgMwogICAgdm9pZCBsb2NrKCkKICAgIHsKCiAgICAgIGlmIChfX2d0aHJlYWRfYWN0
aXZlX3AoKSkKIHsKICAgaWYgKF9fZ3RocmVhZF9yZWN1cnNpdmVfbXV0ZXhfbG9jaygmX01fbXV0
ZXgpICE9IDApCiAgICAgX190aHJvd19jb25jdXJyZW5jZV9sb2NrX2Vycm9yKCk7CiB9CgogICAg
fQoKICAgIHZvaWQgdW5sb2NrKCkKICAgIHsKCiAgICAgIGlmIChfX2d0aHJlYWRfYWN0aXZlX3Ao
KSkKIHsKICAgaWYgKF9fZ3RocmVhZF9yZWN1cnNpdmVfbXV0ZXhfdW5sb2NrKCZfTV9tdXRleCkg
IT0gMCkKICAgICBfX3Rocm93X2NvbmN1cnJlbmNlX3VubG9ja19lcnJvcigpOwogfQoKICAgIH0K
CiAgICBfX2d0aHJlYWRfcmVjdXJzaXZlX211dGV4X3QqIGd0aHJlYWRfcmVjdXJzaXZlX211dGV4
KHZvaWQpCiAgICB7IHJldHVybiAmX01fbXV0ZXg7IH0KICB9OwoKCgoKICBjbGFzcyBfX3Njb3Bl
ZF9sb2NrCiAgewogIHB1YmxpYzoKICAgIHR5cGVkZWYgX19tdXRleCBfX211dGV4X3R5cGU7Cgog
IHByaXZhdGU6CiAgICBfX211dGV4X3R5cGUmIF9NX2RldmljZTsKCiAgICBfX3Njb3BlZF9sb2Nr
KGNvbnN0IF9fc2NvcGVkX2xvY2smKTsKICAgIF9fc2NvcGVkX2xvY2smIG9wZXJhdG9yPShjb25z
dCBfX3Njb3BlZF9sb2NrJik7CgogIHB1YmxpYzoKICAgIGV4cGxpY2l0IF9fc2NvcGVkX2xvY2so
X19tdXRleF90eXBlJiBfX25hbWUpIDogX01fZGV2aWNlKF9fbmFtZSkKICAgIHsgX01fZGV2aWNl
LmxvY2soKTsgfQoKICAgIH5fX3Njb3BlZF9sb2NrKCkgdGhyb3coKQogICAgeyBfTV9kZXZpY2Uu
dW5sb2NrKCk7IH0KICB9OwoKCiAgY2xhc3MgX19jb25kCiAgewogIHByaXZhdGU6CgogICAgX19n
dGhyZWFkX2NvbmRfdCBfTV9jb25kID0geyB7IDAsIDAsIDAsIDAsIDAsICh2b2lkICopIDAsIDAs
IDAgfSB9OwoKCgoKICAgIF9fY29uZChjb25zdCBfX2NvbmQmKTsKICAgIF9fY29uZCYgb3BlcmF0
b3I9KGNvbnN0IF9fY29uZCYpOwoKICBwdWJsaWM6CiAgICBfX2NvbmQoKQogICAgewoKCgoKICAg
IH0KIyAyODAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZXh0L2NvbmN1cnJlbmNlLmgiIDMKICAg
IHZvaWQgYnJvYWRjYXN0KCkKICAgIHsKCiAgICAgIGlmIChfX2d0aHJlYWRfYWN0aXZlX3AoKSkK
IHsKICAgaWYgKF9fZ3RocmVhZF9jb25kX2Jyb2FkY2FzdCgmX01fY29uZCkgIT0gMCkKICAgICBf
X3Rocm93X2NvbmN1cnJlbmNlX2Jyb2FkY2FzdF9lcnJvcigpOwogfQoKICAgIH0KCiAgICB2b2lk
IHdhaXQoX19tdXRleCAqbXV0ZXgpCiAgICB7CgogICAgICB7CiAgIGlmIChfX2d0aHJlYWRfY29u
ZF93YWl0KCZfTV9jb25kLCBtdXRleC0+Z3RocmVhZF9tdXRleCgpKSAhPSAwKQogICAgIF9fdGhy
b3dfY29uY3VycmVuY2Vfd2FpdF9lcnJvcigpOwogICAgICB9CgogICAgfQoKICAgIHZvaWQgd2Fp
dF9yZWN1cnNpdmUoX19yZWN1cnNpdmVfbXV0ZXggKm11dGV4KQogICAgewoKICAgICAgewogICBp
ZiAoX19ndGhyZWFkX2NvbmRfd2FpdF9yZWN1cnNpdmUoJl9NX2NvbmQsCiAgICAgICAgIG11dGV4
LT5ndGhyZWFkX3JlY3Vyc2l2ZV9tdXRleCgpKQogICAgICAgIT0gMCkKICAgICBfX3Rocm93X2Nv
bmN1cnJlbmNlX3dhaXRfZXJyb3IoKTsKICAgICAgfQoKICAgIH0KICB9OwoKCgp9CiMgNzUgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvbWVtb3J5IiAyIDMKCgojIDEgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy91c2VzX2FsbG9jYXRvci5oIiAxIDMKIyAzNSAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3VzZXNfYWxsb2NhdG9yLmgiIDMKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9f
ICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoKICBzdHJ1Y3QgX19lcmFzZWRfdHlw
ZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUgX1RwPgogICAgdXNp
bmcgX19pc19lcmFzZWRfb3JfY29udmVydGlibGUKICAgICAgPSBfX29yXzxpc19zYW1lPF9UcCwg
X19lcmFzZWRfdHlwZT4sIGlzX2NvbnZlcnRpYmxlPF9BbGxvYywgX1RwPj47CgoKICBzdHJ1Y3Qg
YWxsb2NhdG9yX2FyZ190IHsgZXhwbGljaXQgYWxsb2NhdG9yX2FyZ190KCkgPSBkZWZhdWx0OyB9
OwoKICBjb25zdGV4cHIgYWxsb2NhdG9yX2FyZ190IGFsbG9jYXRvcl9hcmcgPSBhbGxvY2F0b3Jf
YXJnX3QoKTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2MsIHR5cGVu
YW1lID0gX192b2lkX3Q8Pj4KICAgIHN0cnVjdCBfX3VzZXNfYWxsb2NhdG9yX2hlbHBlcgogICAg
OiBmYWxzZV90eXBlIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxs
b2M+CiAgICBzdHJ1Y3QgX191c2VzX2FsbG9jYXRvcl9oZWxwZXI8X1RwLCBfQWxsb2MsCiAgICAg
ICBfX3ZvaWRfdDx0eXBlbmFtZSBfVHA6OmFsbG9jYXRvcl90eXBlPj4KICAgIDogX19pc19lcmFz
ZWRfb3JfY29udmVydGlibGU8X0FsbG9jLCB0eXBlbmFtZSBfVHA6OmFsbG9jYXRvcl90eXBlPjo6
dHlwZQogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+
CiAgICBzdHJ1Y3QgdXNlc19hbGxvY2F0b3IKICAgIDogX191c2VzX2FsbG9jYXRvcl9oZWxwZXI8
X1RwLCBfQWxsb2M+Ojp0eXBlCiAgICB7IH07CgogIHN0cnVjdCBfX3VzZXNfYWxsb2NfYmFzZSB7
IH07CgogIHN0cnVjdCBfX3VzZXNfYWxsb2MwIDogX191c2VzX2FsbG9jX2Jhc2UKICB7CiAgICBz
dHJ1Y3QgX1NpbmsgeyB2b2lkIG9wZXJhdG9yPShjb25zdCB2b2lkKikgeyB9IH0gX01fYTsKICB9
OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2M+CiAgICBzdHJ1Y3QgX191c2VzX2FsbG9jMSA6
IF9fdXNlc19hbGxvY19iYXNlIHsgY29uc3QgX0FsbG9jKiBfTV9hOyB9OwoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfQWxsb2M+CiAgICBzdHJ1Y3QgX191c2VzX2FsbG9jMiA6IF9fdXNlc19hbGxvY19i
YXNlIHsgY29uc3QgX0FsbG9jKiBfTV9hOyB9OwoKICB0ZW1wbGF0ZTxib29sLCB0eXBlbmFtZSBf
VHAsIHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUuLi4gX0FyZ3M+CiAgICBzdHJ1Y3QgX191c2Vz
X2FsbG9jOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYywgdHlwZW5h
bWUuLi4gX0FyZ3M+CiAgICBzdHJ1Y3QgX191c2VzX2FsbG9jPHRydWUsIF9UcCwgX0FsbG9jLCBf
QXJncy4uLj4KICAgIDogY29uZGl0aW9uYWw8CiAgICAgICAgaXNfY29uc3RydWN0aWJsZTxfVHAs
IGFsbG9jYXRvcl9hcmdfdCwgX0FsbG9jLCBfQXJncy4uLj46OnZhbHVlLAogICAgICAgIF9fdXNl
c19hbGxvYzE8X0FsbG9jPiwKICAgICAgICBfX3VzZXNfYWxsb2MyPF9BbGxvYz4+Ojp0eXBlCiAg
ICB7CiAgICAgIHN0YXRpY19hc3NlcnQoX19vcl88CiAgIGlzX2NvbnN0cnVjdGlibGU8X1RwLCBh
bGxvY2F0b3JfYXJnX3QsIF9BbGxvYywgX0FyZ3MuLi4+LAogICBpc19jb25zdHJ1Y3RpYmxlPF9U
cCwgX0FyZ3MuLi4sIF9BbGxvYz4+Ojp2YWx1ZSwgImNvbnN0cnVjdGlvbiB3aXRoIgogICAiIGFu
IGFsbG9jYXRvciBtdXN0IGJlIHBvc3NpYmxlIGlmIHVzZXNfYWxsb2NhdG9yIGlzIHRydWUiKTsK
ICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFt
ZS4uLiBfQXJncz4KICAgIHN0cnVjdCBfX3VzZXNfYWxsb2M8ZmFsc2UsIF9UcCwgX0FsbG9jLCBf
QXJncy4uLj4KICAgIDogX191c2VzX2FsbG9jMCB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cCwgdHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgIHVzaW5nIF9fdXNlc19h
bGxvY190ID0KICAgICAgX191c2VzX2FsbG9jPHVzZXNfYWxsb2NhdG9yPF9UcCwgX0FsbG9jPjo6
dmFsdWUsIF9UcCwgX0FsbG9jLCBfQXJncy4uLj47CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwg
dHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgIGlubGluZSBfX3VzZXNfYWxs
b2NfdDxfVHAsIF9BbGxvYywgX0FyZ3MuLi4+CiAgICBfX3VzZV9hbGxvYyhjb25zdCBfQWxsb2Mm
IF9fYSkKICAgIHsKICAgICAgX191c2VzX2FsbG9jX3Q8X1RwLCBfQWxsb2MsIF9BcmdzLi4uPiBf
X3JldDsKICAgICAgX19yZXQuX01fYSA9IHN0ZDo6X19hZGRyZXNzb2YoX19hKTsKICAgICAgcmV0
dXJuIF9fcmV0OwogICAgfQoKCn0KIyA3OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9tZW1vcnki
IDIgMwoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Z1bmN0aW9uYWwiIDEgMwojIDQ2ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2Z1bmN0aW9uYWwiIDMKICAgICAgIAojIDQ3ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2Z1bmN0aW9uYWwiIDMKIyA1NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9mdW5jdGlvbmFsIiAzCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC90dXBsZSIgMSAzCiMg
MzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdHVwbGUiIDMKICAgICAgIAojIDMzICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL3R1cGxlIiAzCgoKCgoKCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9hcnJheSIgMSAzCiMgMzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYXJyYXkiIDMKICAgICAg
IAojIDMzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2FycmF5IiAzCiMgNDMgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYXJyYXkiIDMKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNp
YmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHN0ZDo6
c2l6ZV90IF9ObT4KICAgIHN0cnVjdCBfX2FycmF5X3RyYWl0cwogICAgewogICAgICB0eXBlZGVm
IF9UcCBfVHlwZVtfTm1dOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBfVHAmCiAgICAgIF9TX3Jl
Zihjb25zdCBfVHlwZSYgX190LCBzdGQ6OnNpemVfdCBfX24pIG5vZXhjZXB0CiAgICAgIHsgcmV0
dXJuIGNvbnN0X2Nhc3Q8X1RwJj4oX190W19fbl0pOyB9CgogICAgICBzdGF0aWMgY29uc3RleHBy
IF9UcCoKICAgICAgX1NfcHRyKGNvbnN0IF9UeXBlJiBfX3QpIG5vZXhjZXB0CiAgICAgIHsgcmV0
dXJuIGNvbnN0X2Nhc3Q8X1RwKj4oX190KTsgfQogICAgfTsKCiB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHA+CiAgIHN0cnVjdCBfX2FycmF5X3RyYWl0czxfVHAsIDA+CiAgIHsKICAgICBzdHJ1Y3QgX1R5
cGUgeyB9OwoKICAgICBzdGF0aWMgY29uc3RleHByIF9UcCYKICAgICBfU19yZWYoY29uc3QgX1R5
cGUmLCBzdGQ6OnNpemVfdCkgbm9leGNlcHQKICAgICB7IHJldHVybiAqc3RhdGljX2Nhc3Q8X1Rw
Kj4obnVsbHB0cik7IH0KCiAgICAgc3RhdGljIGNvbnN0ZXhwciBfVHAqCiAgICAgX1NfcHRyKGNv
bnN0IF9UeXBlJikgbm9leGNlcHQKICAgICB7IHJldHVybiBudWxscHRyOyB9CiAgIH07CiMgODkg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYXJyYXkiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAs
IHN0ZDo6c2l6ZV90IF9ObT4KICAgIHN0cnVjdCBhcnJheQogICAgewogICAgICB0eXBlZGVmIF9U
cCB2YWx1ZV90eXBlOwogICAgICB0eXBlZGVmIHZhbHVlX3R5cGUqIHBvaW50ZXI7CiAgICAgIHR5
cGVkZWYgY29uc3QgdmFsdWVfdHlwZSogY29uc3RfcG9pbnRlcjsKICAgICAgdHlwZWRlZiB2YWx1
ZV90eXBlJiByZWZlcmVuY2U7CiAgICAgIHR5cGVkZWYgY29uc3QgdmFsdWVfdHlwZSYgY29uc3Rf
cmVmZXJlbmNlOwogICAgICB0eXBlZGVmIHZhbHVlX3R5cGUqIGl0ZXJhdG9yOwogICAgICB0eXBl
ZGVmIGNvbnN0IHZhbHVlX3R5cGUqIGNvbnN0X2l0ZXJhdG9yOwogICAgICB0eXBlZGVmIHN0ZDo6
c2l6ZV90IHNpemVfdHlwZTsKICAgICAgdHlwZWRlZiBzdGQ6OnB0cmRpZmZfdCBkaWZmZXJlbmNl
X3R5cGU7CiAgICAgIHR5cGVkZWYgc3RkOjpyZXZlcnNlX2l0ZXJhdG9yPGl0ZXJhdG9yPiByZXZl
cnNlX2l0ZXJhdG9yOwogICAgICB0eXBlZGVmIHN0ZDo6cmV2ZXJzZV9pdGVyYXRvcjxjb25zdF9p
dGVyYXRvcj4gY29uc3RfcmV2ZXJzZV9pdGVyYXRvcjsKCgogICAgICB0eXBlZGVmIHN0ZDo6X19h
cnJheV90cmFpdHM8X1RwLCBfTm0+IF9BVF9UeXBlOwogICAgICB0eXBlbmFtZSBfQVRfVHlwZTo6
X1R5cGUgX01fZWxlbXM7CgoKCgogICAgICB2b2lkCiAgICAgIGZpbGwoY29uc3QgdmFsdWVfdHlw
ZSYgX191KQogICAgICB7IHN0ZDo6ZmlsbF9uKGJlZ2luKCksIHNpemUoKSwgX191KTsgfQoKICAg
ICAgdm9pZAogICAgICBzd2FwKGFycmF5JiBfX290aGVyKQogICAgICBub2V4Y2VwdChfX2lzX25v
dGhyb3dfc3dhcHBhYmxlPF9UcD46OnZhbHVlKQogICAgICB7IHN0ZDo6c3dhcF9yYW5nZXMoYmVn
aW4oKSwgZW5kKCksIF9fb3RoZXIuYmVnaW4oKSk7IH0KCgogICAgICBpdGVyYXRvcgogICAgICBi
ZWdpbigpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGl0ZXJhdG9yKGRhdGEoKSk7IH0KCiAgICAg
IGNvbnN0X2l0ZXJhdG9yCiAgICAgIGJlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1
cm4gY29uc3RfaXRlcmF0b3IoZGF0YSgpKTsgfQoKICAgICAgaXRlcmF0b3IKICAgICAgZW5kKCkg
bm9leGNlcHQKICAgICAgeyByZXR1cm4gaXRlcmF0b3IoZGF0YSgpICsgX05tKTsgfQoKICAgICAg
Y29uc3RfaXRlcmF0b3IKICAgICAgZW5kKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4g
Y29uc3RfaXRlcmF0b3IoZGF0YSgpICsgX05tKTsgfQoKICAgICAgcmV2ZXJzZV9pdGVyYXRvcgog
ICAgICByYmVnaW4oKSBub2V4Y2VwdAogICAgICB7IHJldHVybiByZXZlcnNlX2l0ZXJhdG9yKGVu
ZCgpKTsgfQoKICAgICAgY29uc3RfcmV2ZXJzZV9pdGVyYXRvcgogICAgICByYmVnaW4oKSBjb25z
dCBub2V4Y2VwdAogICAgICB7IHJldHVybiBjb25zdF9yZXZlcnNlX2l0ZXJhdG9yKGVuZCgpKTsg
fQoKICAgICAgcmV2ZXJzZV9pdGVyYXRvcgogICAgICByZW5kKCkgbm9leGNlcHQKICAgICAgeyBy
ZXR1cm4gcmV2ZXJzZV9pdGVyYXRvcihiZWdpbigpKTsgfQoKICAgICAgY29uc3RfcmV2ZXJzZV9p
dGVyYXRvcgogICAgICByZW5kKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gY29uc3Rf
cmV2ZXJzZV9pdGVyYXRvcihiZWdpbigpKTsgfQoKICAgICAgY29uc3RfaXRlcmF0b3IKICAgICAg
Y2JlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gY29uc3RfaXRlcmF0b3IoZGF0
YSgpKTsgfQoKICAgICAgY29uc3RfaXRlcmF0b3IKICAgICAgY2VuZCgpIGNvbnN0IG5vZXhjZXB0
CiAgICAgIHsgcmV0dXJuIGNvbnN0X2l0ZXJhdG9yKGRhdGEoKSArIF9ObSk7IH0KCiAgICAgIGNv
bnN0X3JldmVyc2VfaXRlcmF0b3IKICAgICAgY3JiZWdpbigpIGNvbnN0IG5vZXhjZXB0CiAgICAg
IHsgcmV0dXJuIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IoZW5kKCkpOyB9CgogICAgICBjb25zdF9y
ZXZlcnNlX2l0ZXJhdG9yCiAgICAgIGNyZW5kKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1
cm4gY29uc3RfcmV2ZXJzZV9pdGVyYXRvcihiZWdpbigpKTsgfQoKCiAgICAgIGNvbnN0ZXhwciBz
aXplX3R5cGUKICAgICAgc2l6ZSgpIGNvbnN0IG5vZXhjZXB0IHsgcmV0dXJuIF9ObTsgfQoKICAg
ICAgY29uc3RleHByIHNpemVfdHlwZQogICAgICBtYXhfc2l6ZSgpIGNvbnN0IG5vZXhjZXB0IHsg
cmV0dXJuIF9ObTsgfQoKICAgICAgY29uc3RleHByIGJvb2wKICAgICAgZW1wdHkoKSBjb25zdCBu
b2V4Y2VwdCB7IHJldHVybiBzaXplKCkgPT0gMDsgfQoKCiAgICAgIHJlZmVyZW5jZQogICAgICBv
cGVyYXRvcltdKHNpemVfdHlwZSBfX24pIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9BVF9UeXBl
OjpfU19yZWYoX01fZWxlbXMsIF9fbik7IH0KCiAgICAgIGNvbnN0ZXhwciBjb25zdF9yZWZlcmVu
Y2UKICAgICAgb3BlcmF0b3JbXShzaXplX3R5cGUgX19uKSBjb25zdCBub2V4Y2VwdAogICAgICB7
IHJldHVybiBfQVRfVHlwZTo6X1NfcmVmKF9NX2VsZW1zLCBfX24pOyB9CgogICAgICByZWZlcmVu
Y2UKICAgICAgYXQoc2l6ZV90eXBlIF9fbikKICAgICAgewogaWYgKF9fbiA+PSBfTm0pCiAgIHN0
ZDo6X190aHJvd19vdXRfb2ZfcmFuZ2VfZm10KCgiYXJyYXk6OmF0OiBfX24gKHdoaWNoIGlzICV6
dSkgIiAiPj0gX05tICh3aGljaCBpcyAlenUpIikKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgLAogICAgIF9fbiwgX05tKTsKIHJldHVybiBfQVRfVHlwZTo6X1NfcmVmKF9NX2VsZW1z
LCBfX24pOwogICAgICB9CgogICAgICBjb25zdGV4cHIgY29uc3RfcmVmZXJlbmNlCiAgICAgIGF0
KHNpemVfdHlwZSBfX24pIGNvbnN0CiAgICAgIHsKCgogcmV0dXJuIF9fbiA8IF9ObSA/IF9BVF9U
eXBlOjpfU19yZWYoX01fZWxlbXMsIF9fbikKICAgOiAoc3RkOjpfX3Rocm93X291dF9vZl9yYW5n
ZV9mbXQoKCJhcnJheTo6YXQ6IF9fbiAod2hpY2ggaXMgJXp1KSAiICI+PSBfTm0gKHdoaWNoIGlz
ICV6dSkiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsCiAgICAgICAgX19u
LCBfTm0pLAogICAgICBfQVRfVHlwZTo6X1NfcmVmKF9NX2VsZW1zLCAwKSk7CiAgICAgIH0KCiAg
ICAgIHJlZmVyZW5jZQogICAgICBmcm9udCgpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuICpiZWdp
bigpOyB9CgogICAgICBjb25zdGV4cHIgY29uc3RfcmVmZXJlbmNlCiAgICAgIGZyb250KCkgY29u
c3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX0FUX1R5cGU6Ol9TX3JlZihfTV9lbGVtcywgMCk7
IH0KCiAgICAgIHJlZmVyZW5jZQogICAgICBiYWNrKCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4g
X05tID8gKihlbmQoKSAtIDEpIDogKmVuZCgpOyB9CgogICAgICBjb25zdGV4cHIgY29uc3RfcmVm
ZXJlbmNlCiAgICAgIGJhY2soKSBjb25zdCBub2V4Y2VwdAogICAgICB7CiByZXR1cm4gX05tID8g
X0FUX1R5cGU6Ol9TX3JlZihfTV9lbGVtcywgX05tIC0gMSkKICAgICAgICAgICAgIDogX0FUX1R5
cGU6Ol9TX3JlZihfTV9lbGVtcywgMCk7CiAgICAgIH0KCiAgICAgIHBvaW50ZXIKICAgICAgZGF0
YSgpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9BVF9UeXBlOjpfU19wdHIoX01fZWxlbXMpOyB9
CgogICAgICBjb25zdF9wb2ludGVyCiAgICAgIGRhdGEoKSBjb25zdCBub2V4Y2VwdAogICAgICB7
IHJldHVybiBfQVRfVHlwZTo6X1NfcHRyKF9NX2VsZW1zKTsgfQogICAgfTsKCgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcCwgc3RkOjpzaXplX3QgX05tPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJh
dG9yPT0oY29uc3QgYXJyYXk8X1RwLCBfTm0+JiBfX29uZSwgY29uc3QgYXJyYXk8X1RwLCBfTm0+
JiBfX3R3bykKICAgIHsgcmV0dXJuIHN0ZDo6ZXF1YWwoX19vbmUuYmVnaW4oKSwgX19vbmUuZW5k
KCksIF9fdHdvLmJlZ2luKCkpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgc3RkOjpzaXpl
X3QgX05tPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yIT0oY29uc3QgYXJyYXk8X1RwLCBf
Tm0+JiBfX29uZSwgY29uc3QgYXJyYXk8X1RwLCBfTm0+JiBfX3R3bykKICAgIHsgcmV0dXJuICEo
X19vbmUgPT0gX190d28pOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgc3RkOjpzaXplX3Qg
X05tPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPChjb25zdCBhcnJheTxfVHAsIF9ObT4m
IF9fYSwgY29uc3QgYXJyYXk8X1RwLCBfTm0+JiBfX2IpCiAgICB7CiAgICAgIHJldHVybiBzdGQ6
OmxleGljb2dyYXBoaWNhbF9jb21wYXJlKF9fYS5iZWdpbigpLCBfX2EuZW5kKCksCiAgICAgICBf
X2IuYmVnaW4oKSwgX19iLmVuZCgpKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBz
dGQ6OnNpemVfdCBfTm0+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I+KGNvbnN0IGFycmF5
PF9UcCwgX05tPiYgX19vbmUsIGNvbnN0IGFycmF5PF9UcCwgX05tPiYgX190d28pCiAgICB7IHJl
dHVybiBfX3R3byA8IF9fb25lOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgc3RkOjpzaXpl
X3QgX05tPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPD0oY29uc3QgYXJyYXk8X1RwLCBf
Tm0+JiBfX29uZSwgY29uc3QgYXJyYXk8X1RwLCBfTm0+JiBfX3R3bykKICAgIHsgcmV0dXJuICEo
X19vbmUgPiBfX3R3byk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBzdGQ6OnNpemVfdCBf
Tm0+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I+PShjb25zdCBhcnJheTxfVHAsIF9ObT4m
IF9fb25lLCBjb25zdCBhcnJheTxfVHAsIF9ObT4mIF9fdHdvKQogICAgeyByZXR1cm4gIShfX29u
ZSA8IF9fdHdvKTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBzdGQ6OnNpemVfdCBfTm0+
CiAgICBpbmxpbmUgdm9pZAogICAgc3dhcChhcnJheTxfVHAsIF9ObT4mIF9fb25lLCBhcnJheTxf
VHAsIF9ObT4mIF9fdHdvKQogICAgbm9leGNlcHQobm9leGNlcHQoX19vbmUuc3dhcChfX3R3bykp
KQogICAgeyBfX29uZS5zd2FwKF9fdHdvKTsgfQoKICB0ZW1wbGF0ZTxzdGQ6OnNpemVfdCBfSW50
LCB0eXBlbmFtZSBfVHAsIHN0ZDo6c2l6ZV90IF9ObT4KICAgIGNvbnN0ZXhwciBfVHAmCiAgICBn
ZXQoYXJyYXk8X1RwLCBfTm0+JiBfX2Fycikgbm9leGNlcHQKICAgIHsKICAgICAgc3RhdGljX2Fz
c2VydChfSW50IDwgX05tLCAiaW5kZXggaXMgb3V0IG9mIGJvdW5kcyIpOwogICAgICByZXR1cm4g
c3RkOjpfX2FycmF5X3RyYWl0czxfVHAsIF9ObT46OgogX1NfcmVmKF9fYXJyLl9NX2VsZW1zLCBf
SW50KTsKICAgIH0KCiAgdGVtcGxhdGU8c3RkOjpzaXplX3QgX0ludCwgdHlwZW5hbWUgX1RwLCBz
dGQ6OnNpemVfdCBfTm0+CiAgICBjb25zdGV4cHIgX1RwJiYKICAgIGdldChhcnJheTxfVHAsIF9O
bT4mJiBfX2Fycikgbm9leGNlcHQKICAgIHsKICAgICAgc3RhdGljX2Fzc2VydChfSW50IDwgX05t
LCAiaW5kZXggaXMgb3V0IG9mIGJvdW5kcyIpOwogICAgICByZXR1cm4gc3RkOjptb3ZlKHN0ZDo6
Z2V0PF9JbnQ+KF9fYXJyKSk7CiAgICB9CgogIHRlbXBsYXRlPHN0ZDo6c2l6ZV90IF9JbnQsIHR5
cGVuYW1lIF9UcCwgc3RkOjpzaXplX3QgX05tPgogICAgY29uc3RleHByIGNvbnN0IF9UcCYKICAg
IGdldChjb25zdCBhcnJheTxfVHAsIF9ObT4mIF9fYXJyKSBub2V4Y2VwdAogICAgewogICAgICBz
dGF0aWNfYXNzZXJ0KF9JbnQgPCBfTm0sICJpbmRleCBpcyBvdXQgb2YgYm91bmRzIik7CiAgICAg
IHJldHVybiBzdGQ6Ol9fYXJyYXlfdHJhaXRzPF9UcCwgX05tPjo6CiBfU19yZWYoX19hcnIuX01f
ZWxlbXMsIF9JbnQpOwogICAgfQoKCn0KCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9f
dmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Rw
PgogICAgY2xhc3MgdHVwbGVfc2l6ZTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgc3RkOjpz
aXplX3QgX05tPgogICAgc3RydWN0IHR1cGxlX3NpemU8c3RkOjphcnJheTxfVHAsIF9ObT4+CiAg
ICA6IHB1YmxpYyBpbnRlZ3JhbF9jb25zdGFudDxzdGQ6OnNpemVfdCwgX05tPiB7IH07CgoKICB0
ZW1wbGF0ZTxzdGQ6OnNpemVfdCBfSW50LCB0eXBlbmFtZSBfVHA+CiAgICBjbGFzcyB0dXBsZV9l
bGVtZW50OwoKCiAgdGVtcGxhdGU8c3RkOjpzaXplX3QgX0ludCwgdHlwZW5hbWUgX1RwLCBzdGQ6
OnNpemVfdCBfTm0+CiAgICBzdHJ1Y3QgdHVwbGVfZWxlbWVudDxfSW50LCBzdGQ6OmFycmF5PF9U
cCwgX05tPj4KICAgIHsKICAgICAgc3RhdGljX2Fzc2VydChfSW50IDwgX05tLCAiaW5kZXggaXMg
b3V0IG9mIGJvdW5kcyIpOwogICAgICB0eXBlZGVmIF9UcCB0eXBlOwogICAgfTsKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwLCBzdGQ6OnNpemVfdCBfTm0+CiAgICBzdHJ1Y3QgX19pc190dXBsZV9s
aWtlX2ltcGw8c3RkOjphcnJheTxfVHAsIF9ObT4+IDogdHJ1ZV90eXBlCiAgICB7IH07CgoKfQoj
IDQwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3R1cGxlIiAyIDMKCgpuYW1lc3BhY2Ugc3RkIF9f
YXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgoKCgoKCiAgdGVt
cGxhdGU8c3RkOjpzaXplX3QgX0lkeCwgdHlwZW5hbWUgX0hlYWQsIGJvb2wgX0lzRW1wdHlOb3RG
aW5hbD4KICAgIHN0cnVjdCBfSGVhZF9iYXNlOwoKICB0ZW1wbGF0ZTxzdGQ6OnNpemVfdCBfSWR4
LCB0eXBlbmFtZSBfSGVhZD4KICAgIHN0cnVjdCBfSGVhZF9iYXNlPF9JZHgsIF9IZWFkLCB0cnVl
PgogICAgOiBwdWJsaWMgX0hlYWQKICAgIHsKICAgICAgY29uc3RleHByIF9IZWFkX2Jhc2UoKQog
ICAgICA6IF9IZWFkKCkgeyB9CgogICAgICBjb25zdGV4cHIgX0hlYWRfYmFzZShjb25zdCBfSGVh
ZCYgX19oKQogICAgICA6IF9IZWFkKF9faCkgeyB9CgogICAgICBjb25zdGV4cHIgX0hlYWRfYmFz
ZShjb25zdCBfSGVhZF9iYXNlJikgPSBkZWZhdWx0OwogICAgICBjb25zdGV4cHIgX0hlYWRfYmFz
ZShfSGVhZF9iYXNlJiYpID0gZGVmYXVsdDsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VSGVh
ZD4KICAgICAgICBjb25zdGV4cHIgX0hlYWRfYmFzZShfVUhlYWQmJiBfX2gpCiA6IF9IZWFkKHN0
ZDo6Zm9yd2FyZDxfVUhlYWQ+KF9faCkpIHsgfQoKICAgICAgX0hlYWRfYmFzZShhbGxvY2F0b3Jf
YXJnX3QsIF9fdXNlc19hbGxvYzApCiAgICAgIDogX0hlYWQoKSB7IH0KCiAgICAgIHRlbXBsYXRl
PHR5cGVuYW1lIF9BbGxvYz4KIF9IZWFkX2Jhc2UoYWxsb2NhdG9yX2FyZ190LCBfX3VzZXNfYWxs
b2MxPF9BbGxvYz4gX19hKQogOiBfSGVhZChhbGxvY2F0b3JfYXJnLCAqX19hLl9NX2EpIHsgfQoK
ICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogX0hlYWRfYmFzZShhbGxvY2F0b3JfYXJn
X3QsIF9fdXNlc19hbGxvYzI8X0FsbG9jPiBfX2EpCiA6IF9IZWFkKCpfX2EuX01fYSkgeyB9Cgog
ICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVUhlYWQ+CiBfSGVhZF9iYXNlKF9fdXNlc19hbGxvYzAs
IF9VSGVhZCYmIF9fdWhlYWQpCiA6IF9IZWFkKHN0ZDo6Zm9yd2FyZDxfVUhlYWQ+KF9fdWhlYWQp
KSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUgX1VIZWFkPgog
X0hlYWRfYmFzZShfX3VzZXNfYWxsb2MxPF9BbGxvYz4gX19hLCBfVUhlYWQmJiBfX3VoZWFkKQog
OiBfSGVhZChhbGxvY2F0b3JfYXJnLCAqX19hLl9NX2EsIHN0ZDo6Zm9yd2FyZDxfVUhlYWQ+KF9f
dWhlYWQpKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUgX1VI
ZWFkPgogX0hlYWRfYmFzZShfX3VzZXNfYWxsb2MyPF9BbGxvYz4gX19hLCBfVUhlYWQmJiBfX3Vo
ZWFkKQogOiBfSGVhZChzdGQ6OmZvcndhcmQ8X1VIZWFkPihfX3VoZWFkKSwgKl9fYS5fTV9hKSB7
IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIgX0hlYWQmCiAgICAgIF9NX2hlYWQoX0hlYWRfYmFz
ZSYgX19iKSBub2V4Y2VwdCB7IHJldHVybiBfX2I7IH0KCiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
Y29uc3QgX0hlYWQmCiAgICAgIF9NX2hlYWQoY29uc3QgX0hlYWRfYmFzZSYgX19iKSBub2V4Y2Vw
dCB7IHJldHVybiBfX2I7IH0KICAgIH07CgogIHRlbXBsYXRlPHN0ZDo6c2l6ZV90IF9JZHgsIHR5
cGVuYW1lIF9IZWFkPgogICAgc3RydWN0IF9IZWFkX2Jhc2U8X0lkeCwgX0hlYWQsIGZhbHNlPgog
ICAgewogICAgICBjb25zdGV4cHIgX0hlYWRfYmFzZSgpCiAgICAgIDogX01faGVhZF9pbXBsKCkg
eyB9CgogICAgICBjb25zdGV4cHIgX0hlYWRfYmFzZShjb25zdCBfSGVhZCYgX19oKQogICAgICA6
IF9NX2hlYWRfaW1wbChfX2gpIHsgfQoKICAgICAgY29uc3RleHByIF9IZWFkX2Jhc2UoY29uc3Qg
X0hlYWRfYmFzZSYpID0gZGVmYXVsdDsKICAgICAgY29uc3RleHByIF9IZWFkX2Jhc2UoX0hlYWRf
YmFzZSYmKSA9IGRlZmF1bHQ7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVUhlYWQ+CiAgICAg
ICAgY29uc3RleHByIF9IZWFkX2Jhc2UoX1VIZWFkJiYgX19oKQogOiBfTV9oZWFkX2ltcGwoc3Rk
Ojpmb3J3YXJkPF9VSGVhZD4oX19oKSkgeyB9CgogICAgICBfSGVhZF9iYXNlKGFsbG9jYXRvcl9h
cmdfdCwgX191c2VzX2FsbG9jMCkKICAgICAgOiBfTV9oZWFkX2ltcGwoKSB7IH0KCiAgICAgIHRl
bXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KIF9IZWFkX2Jhc2UoYWxsb2NhdG9yX2FyZ190LCBfX3Vz
ZXNfYWxsb2MxPF9BbGxvYz4gX19hKQogOiBfTV9oZWFkX2ltcGwoYWxsb2NhdG9yX2FyZywgKl9f
YS5fTV9hKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KIF9IZWFkX2Jhc2Uo
YWxsb2NhdG9yX2FyZ190LCBfX3VzZXNfYWxsb2MyPF9BbGxvYz4gX19hKQogOiBfTV9oZWFkX2lt
cGwoKl9fYS5fTV9hKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VSGVhZD4KIF9IZWFk
X2Jhc2UoX191c2VzX2FsbG9jMCwgX1VIZWFkJiYgX191aGVhZCkKIDogX01faGVhZF9pbXBsKHN0
ZDo6Zm9yd2FyZDxfVUhlYWQ+KF9fdWhlYWQpKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9BbGxvYywgdHlwZW5hbWUgX1VIZWFkPgogX0hlYWRfYmFzZShfX3VzZXNfYWxsb2MxPF9BbGxv
Yz4gX19hLCBfVUhlYWQmJiBfX3VoZWFkKQogOiBfTV9oZWFkX2ltcGwoYWxsb2NhdG9yX2FyZywg
Kl9fYS5fTV9hLCBzdGQ6OmZvcndhcmQ8X1VIZWFkPihfX3VoZWFkKSkKIHsgfQoKICAgICAgdGVt
cGxhdGU8dHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZSBfVUhlYWQ+CiBfSGVhZF9iYXNlKF9fdXNl
c19hbGxvYzI8X0FsbG9jPiBfX2EsIF9VSGVhZCYmIF9fdWhlYWQpCiA6IF9NX2hlYWRfaW1wbChz
dGQ6OmZvcndhcmQ8X1VIZWFkPihfX3VoZWFkKSwgKl9fYS5fTV9hKSB7IH0KCiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgX0hlYWQmCiAgICAgIF9NX2hlYWQoX0hlYWRfYmFzZSYgX19iKSBub2V4Y2Vw
dCB7IHJldHVybiBfX2IuX01faGVhZF9pbXBsOyB9CgogICAgICBzdGF0aWMgY29uc3RleHByIGNv
bnN0IF9IZWFkJgogICAgICBfTV9oZWFkKGNvbnN0IF9IZWFkX2Jhc2UmIF9fYikgbm9leGNlcHQg
eyByZXR1cm4gX19iLl9NX2hlYWRfaW1wbDsgfQoKICAgICAgX0hlYWQgX01faGVhZF9pbXBsOwog
ICAgfTsKIyAxNTggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdHVwbGUiIDMKICB0ZW1wbGF0ZTxz
dGQ6OnNpemVfdCBfSWR4LCB0eXBlbmFtZS4uLiBfRWxlbWVudHM+CiAgICBzdHJ1Y3QgX1R1cGxl
X2ltcGw7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX2VtcHR5X25v
bl90dXBsZSA6IGlzX2VtcHR5PF9UcD4geyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0VsMCwg
dHlwZW5hbWUuLi4gX0VsPgogICAgc3RydWN0IF9faXNfZW1wdHlfbm9uX3R1cGxlPHR1cGxlPF9F
bDAsIF9FbC4uLj4+IDogZmFsc2VfdHlwZSB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+
CiAgICB1c2luZyBfX2VtcHR5X25vdF9maW5hbAogICAgPSB0eXBlbmFtZSBjb25kaXRpb25hbDxf
X2lzX2ZpbmFsKF9UcCksIGZhbHNlX3R5cGUsCiAgICAgIF9faXNfZW1wdHlfbm9uX3R1cGxlPF9U
cD4+Ojp0eXBlOwoKCgoKCgogIHRlbXBsYXRlPHN0ZDo6c2l6ZV90IF9JZHgsIHR5cGVuYW1lIF9I
ZWFkLCB0eXBlbmFtZS4uLiBfVGFpbD4KICAgIHN0cnVjdCBfVHVwbGVfaW1wbDxfSWR4LCBfSGVh
ZCwgX1RhaWwuLi4+CiAgICA6IHB1YmxpYyBfVHVwbGVfaW1wbDxfSWR4ICsgMSwgX1RhaWwuLi4+
LAogICAgICBwcml2YXRlIF9IZWFkX2Jhc2U8X0lkeCwgX0hlYWQsIF9fZW1wdHlfbm90X2ZpbmFs
PF9IZWFkPjo6dmFsdWU+CiAgICB7CiAgICAgIHRlbXBsYXRlPHN0ZDo6c2l6ZV90LCB0eXBlbmFt
ZS4uLj4gZnJpZW5kIGNsYXNzIF9UdXBsZV9pbXBsOwoKICAgICAgdHlwZWRlZiBfVHVwbGVfaW1w
bDxfSWR4ICsgMSwgX1RhaWwuLi4+IF9Jbmhlcml0ZWQ7CiAgICAgIHR5cGVkZWYgX0hlYWRfYmFz
ZTxfSWR4LCBfSGVhZCwgX19lbXB0eV9ub3RfZmluYWw8X0hlYWQ+Ojp2YWx1ZT4gX0Jhc2U7Cgog
ICAgICBzdGF0aWMgY29uc3RleHByIF9IZWFkJgogICAgICBfTV9oZWFkKF9UdXBsZV9pbXBsJiBf
X3QpIG5vZXhjZXB0IHsgcmV0dXJuIF9CYXNlOjpfTV9oZWFkKF9fdCk7IH0KCiAgICAgIHN0YXRp
YyBjb25zdGV4cHIgY29uc3QgX0hlYWQmCiAgICAgIF9NX2hlYWQoY29uc3QgX1R1cGxlX2ltcGwm
IF9fdCkgbm9leGNlcHQgeyByZXR1cm4gX0Jhc2U6Ol9NX2hlYWQoX190KTsgfQoKICAgICAgc3Rh
dGljIGNvbnN0ZXhwciBfSW5oZXJpdGVkJgogICAgICBfTV90YWlsKF9UdXBsZV9pbXBsJiBfX3Qp
IG5vZXhjZXB0IHsgcmV0dXJuIF9fdDsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBjb25zdCBf
SW5oZXJpdGVkJgogICAgICBfTV90YWlsKGNvbnN0IF9UdXBsZV9pbXBsJiBfX3QpIG5vZXhjZXB0
IHsgcmV0dXJuIF9fdDsgfQoKICAgICAgY29uc3RleHByIF9UdXBsZV9pbXBsKCkKICAgICAgOiBf
SW5oZXJpdGVkKCksIF9CYXNlKCkgeyB9CgogICAgICBleHBsaWNpdAogICAgICBjb25zdGV4cHIg
X1R1cGxlX2ltcGwoY29uc3QgX0hlYWQmIF9faGVhZCwgY29uc3QgX1RhaWwmLi4uIF9fdGFpbCkK
ICAgICAgOiBfSW5oZXJpdGVkKF9fdGFpbC4uLiksIF9CYXNlKF9faGVhZCkgeyB9CgogICAgICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVUhlYWQsIHR5cGVuYW1lLi4uIF9VVGFpbCwgdHlwZW5hbWUgPSB0
eXBlbmFtZQogICAgICAgICAgICAgICBlbmFibGVfaWY8c2l6ZW9mLi4uKF9UYWlsKSA9PSBzaXpl
b2YuLi4oX1VUYWlsKT46OnR5cGU+CiAgICAgICAgZXhwbGljaXQKICAgICAgICBjb25zdGV4cHIg
X1R1cGxlX2ltcGwoX1VIZWFkJiYgX19oZWFkLCBfVVRhaWwmJi4uLiBfX3RhaWwpCiA6IF9Jbmhl
cml0ZWQoc3RkOjpmb3J3YXJkPF9VVGFpbD4oX190YWlsKS4uLiksCiAgIF9CYXNlKHN0ZDo6Zm9y
d2FyZDxfVUhlYWQ+KF9faGVhZCkpIHsgfQoKICAgICAgY29uc3RleHByIF9UdXBsZV9pbXBsKGNv
bnN0IF9UdXBsZV9pbXBsJikgPSBkZWZhdWx0OwoKICAgICAgY29uc3RleHByCiAgICAgIF9UdXBs
ZV9pbXBsKF9UdXBsZV9pbXBsJiYgX19pbikKICAgICAgbm9leGNlcHQoX19hbmRfPGlzX25vdGhy
b3dfbW92ZV9jb25zdHJ1Y3RpYmxlPF9IZWFkPiwKICAgICAgICAgICAgICAgaXNfbm90aHJvd19t
b3ZlX2NvbnN0cnVjdGlibGU8X0luaGVyaXRlZD4+Ojp2YWx1ZSkKICAgICAgOiBfSW5oZXJpdGVk
KHN0ZDo6bW92ZShfTV90YWlsKF9faW4pKSksCiBfQmFzZShzdGQ6OmZvcndhcmQ8X0hlYWQ+KF9N
X2hlYWQoX19pbikpKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9VRWxlbWVudHM+
CiAgICAgICAgY29uc3RleHByIF9UdXBsZV9pbXBsKGNvbnN0IF9UdXBsZV9pbXBsPF9JZHgsIF9V
RWxlbWVudHMuLi4+JiBfX2luKQogOiBfSW5oZXJpdGVkKF9UdXBsZV9pbXBsPF9JZHgsIF9VRWxl
bWVudHMuLi4+OjpfTV90YWlsKF9faW4pKSwKICAgX0Jhc2UoX1R1cGxlX2ltcGw8X0lkeCwgX1VF
bGVtZW50cy4uLj46Ol9NX2hlYWQoX19pbikpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUg
X1VIZWFkLCB0eXBlbmFtZS4uLiBfVVRhaWxzPgogICAgICAgIGNvbnN0ZXhwciBfVHVwbGVfaW1w
bChfVHVwbGVfaW1wbDxfSWR4LCBfVUhlYWQsIF9VVGFpbHMuLi4+JiYgX19pbikKIDogX0luaGVy
aXRlZChzdGQ6Om1vdmUKICAgICAgIChfVHVwbGVfaW1wbDxfSWR4LCBfVUhlYWQsIF9VVGFpbHMu
Li4+OjpfTV90YWlsKF9faW4pKSksCiAgIF9CYXNlKHN0ZDo6Zm9yd2FyZDxfVUhlYWQ+CiAgKF9U
dXBsZV9pbXBsPF9JZHgsIF9VSGVhZCwgX1VUYWlscy4uLj46Ol9NX2hlYWQoX19pbikpKSB7IH0K
CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KIF9UdXBsZV9pbXBsKGFsbG9jYXRvcl9h
cmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EpCiA6IF9Jbmhlcml0ZWQoX190YWcsIF9fYSks
CiAgICAgICAgICBfQmFzZShfX3RhZywgX191c2VfYWxsb2M8X0hlYWQ+KF9fYSkpIHsgfQoKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogX1R1cGxlX2ltcGwoYWxsb2NhdG9yX2FyZ190
IF9fdGFnLCBjb25zdCBfQWxsb2MmIF9fYSwKICAgICAgY29uc3QgX0hlYWQmIF9faGVhZCwgY29u
c3QgX1RhaWwmLi4uIF9fdGFpbCkKIDogX0luaGVyaXRlZChfX3RhZywgX19hLCBfX3RhaWwuLi4p
LAogICAgICAgICAgX0Jhc2UoX191c2VfYWxsb2M8X0hlYWQsIF9BbGxvYywgX0hlYWQ+KF9fYSks
IF9faGVhZCkgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2MsIHR5cGVuYW1lIF9V
SGVhZCwgdHlwZW5hbWUuLi4gX1VUYWlsLAogICAgICAgICAgICAgICB0eXBlbmFtZSA9IHR5cGVu
YW1lIGVuYWJsZV9pZjxzaXplb2YuLi4oX1RhaWwpCiAgICAgICAgICA9PSBzaXplb2YuLi4oX1VU
YWlsKT46OnR5cGU+CiBfVHVwbGVfaW1wbChhbGxvY2F0b3JfYXJnX3QgX190YWcsIGNvbnN0IF9B
bGxvYyYgX19hLAogICAgICAgICAgICAgX1VIZWFkJiYgX19oZWFkLCBfVVRhaWwmJi4uLiBfX3Rh
aWwpCiA6IF9Jbmhlcml0ZWQoX190YWcsIF9fYSwgc3RkOjpmb3J3YXJkPF9VVGFpbD4oX190YWls
KS4uLiksCiAgICAgICAgICBfQmFzZShfX3VzZV9hbGxvYzxfSGVhZCwgX0FsbG9jLCBfVUhlYWQ+
KF9fYSksCiAgICAgICAgIHN0ZDo6Zm9yd2FyZDxfVUhlYWQ+KF9faGVhZCkpIHsgfQoKICAgICAg
dGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogICAgICAgIF9UdXBsZV9pbXBsKGFsbG9jYXRvcl9h
cmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsCiAgICAgICAgICAgICBjb25zdCBfVHVwbGVf
aW1wbCYgX19pbikKIDogX0luaGVyaXRlZChfX3RhZywgX19hLCBfTV90YWlsKF9faW4pKSwKICAg
ICAgICAgIF9CYXNlKF9fdXNlX2FsbG9jPF9IZWFkLCBfQWxsb2MsIF9IZWFkPihfX2EpLCBfTV9o
ZWFkKF9faW4pKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KIF9UdXBsZV9p
bXBsKGFsbG9jYXRvcl9hcmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsCiAgICAgICAgICAg
ICBfVHVwbGVfaW1wbCYmIF9faW4pCiA6IF9Jbmhlcml0ZWQoX190YWcsIF9fYSwgc3RkOjptb3Zl
KF9NX3RhaWwoX19pbikpKSwKICAgX0Jhc2UoX191c2VfYWxsb2M8X0hlYWQsIF9BbGxvYywgX0hl
YWQ+KF9fYSksCiAgICAgICAgIHN0ZDo6Zm9yd2FyZDxfSGVhZD4oX01faGVhZChfX2luKSkpIHsg
fQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZS4uLiBfVUVsZW1lbnRz
PgogX1R1cGxlX2ltcGwoYWxsb2NhdG9yX2FyZ190IF9fdGFnLCBjb25zdCBfQWxsb2MmIF9fYSwK
ICAgICAgICAgICAgIGNvbnN0IF9UdXBsZV9pbXBsPF9JZHgsIF9VRWxlbWVudHMuLi4+JiBfX2lu
KQogOiBfSW5oZXJpdGVkKF9fdGFnLCBfX2EsCiAgICAgICBfVHVwbGVfaW1wbDxfSWR4LCBfVUVs
ZW1lbnRzLi4uPjo6X01fdGFpbChfX2luKSksCiAgIF9CYXNlKF9fdXNlX2FsbG9jPF9IZWFkLCBf
QWxsb2MsIF9IZWFkPihfX2EpLAogIF9UdXBsZV9pbXBsPF9JZHgsIF9VRWxlbWVudHMuLi4+Ojpf
TV9oZWFkKF9faW4pKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5h
bWUgX1VIZWFkLCB0eXBlbmFtZS4uLiBfVVRhaWxzPgogX1R1cGxlX2ltcGwoYWxsb2NhdG9yX2Fy
Z190IF9fdGFnLCBjb25zdCBfQWxsb2MmIF9fYSwKICAgICAgICAgICAgIF9UdXBsZV9pbXBsPF9J
ZHgsIF9VSGVhZCwgX1VUYWlscy4uLj4mJiBfX2luKQogOiBfSW5oZXJpdGVkKF9fdGFnLCBfX2Es
IHN0ZDo6bW92ZQogICAgICAgKF9UdXBsZV9pbXBsPF9JZHgsIF9VSGVhZCwgX1VUYWlscy4uLj46
Ol9NX3RhaWwoX19pbikpKSwKICAgX0Jhc2UoX191c2VfYWxsb2M8X0hlYWQsIF9BbGxvYywgX1VI
ZWFkPihfX2EpLAogICAgICAgICAgICAgICAgc3RkOjpmb3J3YXJkPF9VSGVhZD4KICAoX1R1cGxl
X2ltcGw8X0lkeCwgX1VIZWFkLCBfVVRhaWxzLi4uPjo6X01faGVhZChfX2luKSkpIHsgfQoKICAg
ICAgX1R1cGxlX2ltcGwmCiAgICAgIG9wZXJhdG9yPShjb25zdCBfVHVwbGVfaW1wbCYgX19pbikK
ICAgICAgewogX01faGVhZCgqdGhpcykgPSBfTV9oZWFkKF9faW4pOwogX01fdGFpbCgqdGhpcykg
PSBfTV90YWlsKF9faW4pOwogcmV0dXJuICp0aGlzOwogICAgICB9CgogICAgICBfVHVwbGVfaW1w
bCYKICAgICAgb3BlcmF0b3I9KF9UdXBsZV9pbXBsJiYgX19pbikKICAgICAgbm9leGNlcHQoX19h
bmRfPGlzX25vdGhyb3dfbW92ZV9hc3NpZ25hYmxlPF9IZWFkPiwKICAgICAgICAgICAgICAgaXNf
bm90aHJvd19tb3ZlX2Fzc2lnbmFibGU8X0luaGVyaXRlZD4+Ojp2YWx1ZSkKICAgICAgewogX01f
aGVhZCgqdGhpcykgPSBzdGQ6OmZvcndhcmQ8X0hlYWQ+KF9NX2hlYWQoX19pbikpOwogX01fdGFp
bCgqdGhpcykgPSBzdGQ6Om1vdmUoX01fdGFpbChfX2luKSk7CiByZXR1cm4gKnRoaXM7CiAgICAg
IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9VRWxlbWVudHM+CiAgICAgICAgX1R1cGxl
X2ltcGwmCiAgICAgICAgb3BlcmF0b3I9KGNvbnN0IF9UdXBsZV9pbXBsPF9JZHgsIF9VRWxlbWVu
dHMuLi4+JiBfX2luKQogICAgICAgIHsKICAgX01faGVhZCgqdGhpcykgPSBfVHVwbGVfaW1wbDxf
SWR4LCBfVUVsZW1lbnRzLi4uPjo6X01faGVhZChfX2luKTsKICAgX01fdGFpbCgqdGhpcykgPSBf
VHVwbGVfaW1wbDxfSWR4LCBfVUVsZW1lbnRzLi4uPjo6X01fdGFpbChfX2luKTsKICAgcmV0dXJu
ICp0aGlzOwogfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1VIZWFkLCB0eXBlbmFtZS4uLiBf
VVRhaWxzPgogICAgICAgIF9UdXBsZV9pbXBsJgogICAgICAgIG9wZXJhdG9yPShfVHVwbGVfaW1w
bDxfSWR4LCBfVUhlYWQsIF9VVGFpbHMuLi4+JiYgX19pbikKICAgICAgICB7CiAgIF9NX2hlYWQo
KnRoaXMpID0gc3RkOjpmb3J3YXJkPF9VSGVhZD4KICAgICAoX1R1cGxlX2ltcGw8X0lkeCwgX1VI
ZWFkLCBfVVRhaWxzLi4uPjo6X01faGVhZChfX2luKSk7CiAgIF9NX3RhaWwoKnRoaXMpID0gc3Rk
Ojptb3ZlCiAgICAgKF9UdXBsZV9pbXBsPF9JZHgsIF9VSGVhZCwgX1VUYWlscy4uLj46Ol9NX3Rh
aWwoX19pbikpOwogICByZXR1cm4gKnRoaXM7CiB9CgogICAgcHJvdGVjdGVkOgogICAgICB2b2lk
CiAgICAgIF9NX3N3YXAoX1R1cGxlX2ltcGwmIF9faW4pCiAgICAgIG5vZXhjZXB0KF9faXNfbm90
aHJvd19zd2FwcGFibGU8X0hlYWQ+Ojp2YWx1ZQogICAgICAgICAgICAgICAmJiBub2V4Y2VwdChf
TV90YWlsKF9faW4pLl9NX3N3YXAoX01fdGFpbChfX2luKSkpKQogICAgICB7CiB1c2luZyBzdGQ6
OnN3YXA7CiBzd2FwKF9NX2hlYWQoKnRoaXMpLCBfTV9oZWFkKF9faW4pKTsKIF9Jbmhlcml0ZWQ6
Ol9NX3N3YXAoX01fdGFpbChfX2luKSk7CiAgICAgIH0KICAgIH07CgoKICB0ZW1wbGF0ZTxzdGQ6
OnNpemVfdCBfSWR4LCB0eXBlbmFtZSBfSGVhZD4KICAgIHN0cnVjdCBfVHVwbGVfaW1wbDxfSWR4
LCBfSGVhZD4KICAgIDogcHJpdmF0ZSBfSGVhZF9iYXNlPF9JZHgsIF9IZWFkLCBfX2VtcHR5X25v
dF9maW5hbDxfSGVhZD46OnZhbHVlPgogICAgewogICAgICB0ZW1wbGF0ZTxzdGQ6OnNpemVfdCwg
dHlwZW5hbWUuLi4+IGZyaWVuZCBjbGFzcyBfVHVwbGVfaW1wbDsKCiAgICAgIHR5cGVkZWYgX0hl
YWRfYmFzZTxfSWR4LCBfSGVhZCwgX19lbXB0eV9ub3RfZmluYWw8X0hlYWQ+Ojp2YWx1ZT4gX0Jh
c2U7CgogICAgICBzdGF0aWMgY29uc3RleHByIF9IZWFkJgogICAgICBfTV9oZWFkKF9UdXBsZV9p
bXBsJiBfX3QpIG5vZXhjZXB0IHsgcmV0dXJuIF9CYXNlOjpfTV9oZWFkKF9fdCk7IH0KCiAgICAg
IHN0YXRpYyBjb25zdGV4cHIgY29uc3QgX0hlYWQmCiAgICAgIF9NX2hlYWQoY29uc3QgX1R1cGxl
X2ltcGwmIF9fdCkgbm9leGNlcHQgeyByZXR1cm4gX0Jhc2U6Ol9NX2hlYWQoX190KTsgfQoKICAg
ICAgY29uc3RleHByIF9UdXBsZV9pbXBsKCkKICAgICAgOiBfQmFzZSgpIHsgfQoKICAgICAgZXhw
bGljaXQKICAgICAgY29uc3RleHByIF9UdXBsZV9pbXBsKGNvbnN0IF9IZWFkJiBfX2hlYWQpCiAg
ICAgIDogX0Jhc2UoX19oZWFkKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VSGVhZD4K
ICAgICAgICBleHBsaWNpdAogICAgICAgIGNvbnN0ZXhwciBfVHVwbGVfaW1wbChfVUhlYWQmJiBf
X2hlYWQpCiA6IF9CYXNlKHN0ZDo6Zm9yd2FyZDxfVUhlYWQ+KF9faGVhZCkpIHsgfQoKICAgICAg
Y29uc3RleHByIF9UdXBsZV9pbXBsKGNvbnN0IF9UdXBsZV9pbXBsJikgPSBkZWZhdWx0OwoKICAg
ICAgY29uc3RleHByCiAgICAgIF9UdXBsZV9pbXBsKF9UdXBsZV9pbXBsJiYgX19pbikKICAgICAg
bm9leGNlcHQoaXNfbm90aHJvd19tb3ZlX2NvbnN0cnVjdGlibGU8X0hlYWQ+Ojp2YWx1ZSkKICAg
ICAgOiBfQmFzZShzdGQ6OmZvcndhcmQ8X0hlYWQ+KF9NX2hlYWQoX19pbikpKSB7IH0KCiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9VSGVhZD4KICAgICAgICBjb25zdGV4cHIgX1R1cGxlX2ltcGwo
Y29uc3QgX1R1cGxlX2ltcGw8X0lkeCwgX1VIZWFkPiYgX19pbikKIDogX0Jhc2UoX1R1cGxlX2lt
cGw8X0lkeCwgX1VIZWFkPjo6X01faGVhZChfX2luKSkgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVUhlYWQ+CiAgICAgICAgY29uc3RleHByIF9UdXBsZV9pbXBsKF9UdXBsZV9pbXBsPF9J
ZHgsIF9VSGVhZD4mJiBfX2luKQogOiBfQmFzZShzdGQ6OmZvcndhcmQ8X1VIZWFkPihfVHVwbGVf
aW1wbDxfSWR4LCBfVUhlYWQ+OjpfTV9oZWFkKF9faW4pKSkKIHsgfQoKICAgICAgdGVtcGxhdGU8
dHlwZW5hbWUgX0FsbG9jPgogX1R1cGxlX2ltcGwoYWxsb2NhdG9yX2FyZ190IF9fdGFnLCBjb25z
dCBfQWxsb2MmIF9fYSkKIDogX0Jhc2UoX190YWcsIF9fdXNlX2FsbG9jPF9IZWFkPihfX2EpKSB7
IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KIF9UdXBsZV9pbXBsKGFsbG9jYXRv
cl9hcmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsCiAgICAgIGNvbnN0IF9IZWFkJiBfX2hl
YWQpCiA6IF9CYXNlKF9fdXNlX2FsbG9jPF9IZWFkLCBfQWxsb2MsIF9IZWFkPihfX2EpLCBfX2hl
YWQpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZSBfVUhlYWQ+
CiBfVHVwbGVfaW1wbChhbGxvY2F0b3JfYXJnX3QgX190YWcsIGNvbnN0IF9BbGxvYyYgX19hLAog
ICAgICAgICAgICAgX1VIZWFkJiYgX19oZWFkKQogOiBfQmFzZShfX3VzZV9hbGxvYzxfSGVhZCwg
X0FsbG9jLCBfVUhlYWQ+KF9fYSksCiAgICAgICAgIHN0ZDo6Zm9yd2FyZDxfVUhlYWQ+KF9faGVh
ZCkpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogICAgICAgIF9UdXBsZV9p
bXBsKGFsbG9jYXRvcl9hcmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsCiAgICAgICAgICAg
ICBjb25zdCBfVHVwbGVfaW1wbCYgX19pbikKIDogX0Jhc2UoX191c2VfYWxsb2M8X0hlYWQsIF9B
bGxvYywgX0hlYWQ+KF9fYSksIF9NX2hlYWQoX19pbikpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0FsbG9jPgogX1R1cGxlX2ltcGwoYWxsb2NhdG9yX2FyZ190IF9fdGFnLCBjb25zdCBf
QWxsb2MmIF9fYSwKICAgICAgICAgICAgIF9UdXBsZV9pbXBsJiYgX19pbikKIDogX0Jhc2UoX191
c2VfYWxsb2M8X0hlYWQsIF9BbGxvYywgX0hlYWQ+KF9fYSksCiAgICAgICAgIHN0ZDo6Zm9yd2Fy
ZDxfSGVhZD4oX01faGVhZChfX2luKSkpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0Fs
bG9jLCB0eXBlbmFtZSBfVUhlYWQ+CiBfVHVwbGVfaW1wbChhbGxvY2F0b3JfYXJnX3QgX190YWcs
IGNvbnN0IF9BbGxvYyYgX19hLAogICAgICAgICAgICAgY29uc3QgX1R1cGxlX2ltcGw8X0lkeCwg
X1VIZWFkPiYgX19pbikKIDogX0Jhc2UoX191c2VfYWxsb2M8X0hlYWQsIF9BbGxvYywgX0hlYWQ+
KF9fYSksCiAgX1R1cGxlX2ltcGw8X0lkeCwgX1VIZWFkPjo6X01faGVhZChfX2luKSkgeyB9Cgog
ICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2MsIHR5cGVuYW1lIF9VSGVhZD4KIF9UdXBsZV9p
bXBsKGFsbG9jYXRvcl9hcmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsCiAgICAgICAgICAg
ICBfVHVwbGVfaW1wbDxfSWR4LCBfVUhlYWQ+JiYgX19pbikKIDogX0Jhc2UoX191c2VfYWxsb2M8
X0hlYWQsIF9BbGxvYywgX1VIZWFkPihfX2EpLAogICAgICAgICAgICAgICAgc3RkOjpmb3J3YXJk
PF9VSGVhZD4oX1R1cGxlX2ltcGw8X0lkeCwgX1VIZWFkPjo6X01faGVhZChfX2luKSkpCiB7IH0K
CiAgICAgIF9UdXBsZV9pbXBsJgogICAgICBvcGVyYXRvcj0oY29uc3QgX1R1cGxlX2ltcGwmIF9f
aW4pCiAgICAgIHsKIF9NX2hlYWQoKnRoaXMpID0gX01faGVhZChfX2luKTsKIHJldHVybiAqdGhp
czsKICAgICAgfQoKICAgICAgX1R1cGxlX2ltcGwmCiAgICAgIG9wZXJhdG9yPShfVHVwbGVfaW1w
bCYmIF9faW4pCiAgICAgIG5vZXhjZXB0KGlzX25vdGhyb3dfbW92ZV9hc3NpZ25hYmxlPF9IZWFk
Pjo6dmFsdWUpCiAgICAgIHsKIF9NX2hlYWQoKnRoaXMpID0gc3RkOjpmb3J3YXJkPF9IZWFkPihf
TV9oZWFkKF9faW4pKTsKIHJldHVybiAqdGhpczsKICAgICAgfQoKICAgICAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1VIZWFkPgogICAgICAgIF9UdXBsZV9pbXBsJgogICAgICAgIG9wZXJhdG9yPShjb25z
dCBfVHVwbGVfaW1wbDxfSWR4LCBfVUhlYWQ+JiBfX2luKQogICAgICAgIHsKICAgX01faGVhZCgq
dGhpcykgPSBfVHVwbGVfaW1wbDxfSWR4LCBfVUhlYWQ+OjpfTV9oZWFkKF9faW4pOwogICByZXR1
cm4gKnRoaXM7CiB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVUhlYWQ+CiAgICAgICAgX1R1
cGxlX2ltcGwmCiAgICAgICAgb3BlcmF0b3I9KF9UdXBsZV9pbXBsPF9JZHgsIF9VSGVhZD4mJiBf
X2luKQogICAgICAgIHsKICAgX01faGVhZCgqdGhpcykKICAgICA9IHN0ZDo6Zm9yd2FyZDxfVUhl
YWQ+KF9UdXBsZV9pbXBsPF9JZHgsIF9VSGVhZD46Ol9NX2hlYWQoX19pbikpOwogICByZXR1cm4g
KnRoaXM7CiB9CgogICAgcHJvdGVjdGVkOgogICAgICB2b2lkCiAgICAgIF9NX3N3YXAoX1R1cGxl
X2ltcGwmIF9faW4pCiAgICAgIG5vZXhjZXB0KF9faXNfbm90aHJvd19zd2FwcGFibGU8X0hlYWQ+
Ojp2YWx1ZSkKICAgICAgewogdXNpbmcgc3RkOjpzd2FwOwogc3dhcChfTV9oZWFkKCp0aGlzKSwg
X01faGVhZChfX2luKSk7CiAgICAgIH0KICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9F
bGVtZW50cz4KICAgIGNsYXNzIHR1cGxlOwoKCgogIHRlbXBsYXRlPGJvb2wsIHR5cGVuYW1lLi4u
IF9FbGVtZW50cz4KICBzdHJ1Y3QgX1RDCiAgewogICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1VF
bGVtZW50cz4KICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBfQ29uc3RydWN0aWJsZVR1cGxlKCkK
ICAgIHsKICAgICAgcmV0dXJuIF9fYW5kXzxpc19jb25zdHJ1Y3RpYmxlPF9FbGVtZW50cywgY29u
c3QgX1VFbGVtZW50cyY+Li4uPjo6dmFsdWU7CiAgICB9CgogICAgdGVtcGxhdGU8dHlwZW5hbWUu
Li4gX1VFbGVtZW50cz4KICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBfSW1wbGljaXRseUNvbnZl
cnRpYmxlVHVwbGUoKQogICAgewogICAgICByZXR1cm4gX19hbmRfPGlzX2NvbnZlcnRpYmxlPGNv
bnN0IF9VRWxlbWVudHMmLCBfRWxlbWVudHM+Li4uPjo6dmFsdWU7CiAgICB9CgogICAgdGVtcGxh
dGU8dHlwZW5hbWUuLi4gX1VFbGVtZW50cz4KICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBfTW92
ZUNvbnN0cnVjdGlibGVUdXBsZSgpCiAgICB7CiAgICAgIHJldHVybiBfX2FuZF88aXNfY29uc3Ry
dWN0aWJsZTxfRWxlbWVudHMsIF9VRWxlbWVudHMmJj4uLi4+Ojp2YWx1ZTsKICAgIH0KCiAgICB0
ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfVUVsZW1lbnRzPgogICAgc3RhdGljIGNvbnN0ZXhwciBib29s
IF9JbXBsaWNpdGx5TW92ZUNvbnZlcnRpYmxlVHVwbGUoKQogICAgewogICAgICByZXR1cm4gX19h
bmRfPGlzX2NvbnZlcnRpYmxlPF9VRWxlbWVudHMmJiwgX0VsZW1lbnRzPi4uLj46OnZhbHVlOwog
ICAgfQoKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9TcmNUdXBsZT4KICAgIHN0YXRpYyBjb25zdGV4
cHIgYm9vbCBfTm9uTmVzdGVkVHVwbGUoKQogICAgewogICAgICByZXR1cm4gX19hbmRfPF9fbm90
Xzxpc19zYW1lPHR1cGxlPF9FbGVtZW50cy4uLj4sCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdHlwZW5hbWUgcmVtb3ZlX2N2PAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdHlwZW5hbWUgcmVtb3ZlX3JlZmVyZW5jZTxfU3JjVHVwbGU+Ojp0eXBlCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPjo6dHlwZT4+LAogICAgICAgICAgICAgICAg
ICAgICBfX25vdF88aXNfY29udmVydGlibGU8X1NyY1R1cGxlLCBfRWxlbWVudHMuLi4+PiwKICAg
ICAgICAgICAgICAgICAgICAgX19ub3RfPGlzX2NvbnN0cnVjdGlibGU8X0VsZW1lbnRzLi4uLCBf
U3JjVHVwbGU+PgogICAgICAgICAgICAgID46OnZhbHVlOwogICAgfQogIH07CgogIHRlbXBsYXRl
PHR5cGVuYW1lLi4uIF9FbGVtZW50cz4KICBzdHJ1Y3QgX1RDPGZhbHNlLCBfRWxlbWVudHMuLi4+
CiAgewogICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1VFbGVtZW50cz4KICAgIHN0YXRpYyBjb25z
dGV4cHIgYm9vbCBfQ29uc3RydWN0aWJsZVR1cGxlKCkKICAgIHsKICAgICAgcmV0dXJuIGZhbHNl
OwogICAgfQoKICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9VRWxlbWVudHM+CiAgICBzdGF0aWMg
Y29uc3RleHByIGJvb2wgX0ltcGxpY2l0bHlDb252ZXJ0aWJsZVR1cGxlKCkKICAgIHsKICAgICAg
cmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9VRWxlbWVudHM+
CiAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgX01vdmVDb25zdHJ1Y3RpYmxlVHVwbGUoKQogICAg
ewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1VF
bGVtZW50cz4KICAgIHN0YXRpYyBjb25zdGV4cHIgYm9vbCBfSW1wbGljaXRseU1vdmVDb252ZXJ0
aWJsZVR1cGxlKCkKICAgIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHRlbXBsYXRl
PHR5cGVuYW1lLi4uIF9VRWxlbWVudHM+CiAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgX05vbk5l
c3RlZFR1cGxlKCkKICAgIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfTsKCgogIHRlbXBs
YXRlPHR5cGVuYW1lLi4uIF9FbGVtZW50cz4KICAgIGNsYXNzIHR1cGxlIDogcHVibGljIF9UdXBs
ZV9pbXBsPDAsIF9FbGVtZW50cy4uLj4KICAgIHsKICAgICAgdHlwZWRlZiBfVHVwbGVfaW1wbDww
LCBfRWxlbWVudHMuLi4+IF9Jbmhlcml0ZWQ7CgoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9E
dW1teT4KICAgICAgc3RydWN0IF9UQzIKICAgICAgewogICAgICAgIHN0YXRpYyBjb25zdGV4cHIg
Ym9vbCBfRGVmYXVsdENvbnN0cnVjdGlibGVUdXBsZSgpCiAgICAgICAgewogICAgICAgICAgcmV0
dXJuIF9fYW5kXzxpc19kZWZhdWx0X2NvbnN0cnVjdGlibGU8X0VsZW1lbnRzPi4uLj46OnZhbHVl
OwogICAgICAgIH0KICAgICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wgX0ltcGxpY2l0bHlEZWZh
dWx0Q29uc3RydWN0aWJsZVR1cGxlKCkKICAgICAgICB7CiAgICAgICAgICByZXR1cm4gX19hbmRf
PF9faXNfaW1wbGljaXRseV9kZWZhdWx0X2NvbnN0cnVjdGlibGU8X0VsZW1lbnRzPi4uLj4KICAg
ICAgICAgICAgOjp2YWx1ZTsKICAgICAgICB9CiAgICAgIH07CgogICAgcHVibGljOgogICAgICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfRHVtbXkgPSB2b2lkLAogICAgICAgICAgICAgICB0eXBlbmFtZSBl
bmFibGVfaWY8X1RDMjxfRHVtbXk+OjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgX0ltcGxpY2l0bHlEZWZhdWx0Q29uc3RydWN0aWJsZVR1cGxlKCksCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBib29sPjo6dHlwZSA9IHRydWU+CiAgICAgIGNvbnN0ZXhwciB0
dXBsZSgpCiAgICAgIDogX0luaGVyaXRlZCgpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUg
X0R1bW15ID0gdm9pZCwKICAgICAgICAgICAgICAgdHlwZW5hbWUgZW5hYmxlX2lmPF9UQzI8X0R1
bW15Pjo6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9EZWZhdWx0Q29uc3Ry
dWN0aWJsZVR1cGxlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhX1RDMjxfRHVtbXk+OjoKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgX0ltcGxpY2l0bHlEZWZhdWx0Q29uc3RydWN0aWJsZVR1
cGxlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sPjo6dHlwZSA9IGZh
bHNlPgogICAgICBleHBsaWNpdCBjb25zdGV4cHIgdHVwbGUoKQogICAgICA6IF9Jbmhlcml0ZWQo
KSB7IH0KCgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0R1bW15PiB1c2luZyBfVENDID0KICAg
ICAgICBfVEM8aXNfc2FtZTxfRHVtbXksIHZvaWQ+Ojp2YWx1ZSwKICAgICAgICAgICAgX0VsZW1l
bnRzLi4uPjsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9EdW1teSA9IHZvaWQsCiAgICAgICAg
ICAgICAgIHR5cGVuYW1lIGVuYWJsZV9pZjwKICAgICAgICAgICAgICAgICBfVENDPF9EdW1teT46
OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICBfQ29uc3RydWN0aWJsZVR1cGxlPF9FbGVtZW50
cy4uLj4oKQogICAgICAgICAgICAgICAgICYmIF9UQ0M8X0R1bW15Pjo6dGVtcGxhdGUKICAgICAg
ICAgICAgICAgICAgIF9JbXBsaWNpdGx5Q29udmVydGlibGVUdXBsZTxfRWxlbWVudHMuLi4+KCkK
ICAgICAgICAgICAgICAgICAmJiAoc2l6ZW9mLi4uKF9FbGVtZW50cykgPj0gMSksCiAgICAgICAg
ICAgICAgIGJvb2w+Ojp0eXBlPXRydWU+CiAgICAgICAgY29uc3RleHByIHR1cGxlKGNvbnN0IF9F
bGVtZW50cyYuLi4gX19lbGVtZW50cykKICAgICAgOiBfSW5oZXJpdGVkKF9fZWxlbWVudHMuLi4p
IHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0R1bW15ID0gdm9pZCwKICAgICAgICAgICAg
ICAgdHlwZW5hbWUgZW5hYmxlX2lmPAogICAgICAgICAgICAgICAgIF9UQ0M8X0R1bW15Pjo6dGVt
cGxhdGUKICAgICAgICAgICAgICAgICAgIF9Db25zdHJ1Y3RpYmxlVHVwbGU8X0VsZW1lbnRzLi4u
PigpCiAgICAgICAgICAgICAgICAgJiYgIV9UQ0M8X0R1bW15Pjo6dGVtcGxhdGUKICAgICAgICAg
ICAgICAgICAgIF9JbXBsaWNpdGx5Q29udmVydGlibGVUdXBsZTxfRWxlbWVudHMuLi4+KCkKICAg
ICAgICAgICAgICAgICAmJiAoc2l6ZW9mLi4uKF9FbGVtZW50cykgPj0gMSksCiAgICAgICAgICAg
ICAgIGJvb2w+Ojp0eXBlPWZhbHNlPgogICAgICBleHBsaWNpdCBjb25zdGV4cHIgdHVwbGUoY29u
c3QgX0VsZW1lbnRzJi4uLiBfX2VsZW1lbnRzKQogICAgICA6IF9Jbmhlcml0ZWQoX19lbGVtZW50
cy4uLikgeyB9CgoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9VRWxlbWVudHM+IHVzaW5n
IF9UTUMgPQogICAgICAgICAgICAgICAgICBfVEM8KHNpemVvZi4uLihfRWxlbWVudHMpID09IHNp
emVvZi4uLihfVUVsZW1lbnRzKSksCiAgICAgICAgICAgICAgICAgICAgICBfRWxlbWVudHMuLi4+
OwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1VFbGVtZW50cywgdHlwZW5hbWUKICAgICAg
ICBlbmFibGVfaWY8X1RNQzxfVUVsZW1lbnRzLi4uPjo6dGVtcGxhdGUKICAgICAgICAgICAgICAg
ICAgICBfTW92ZUNvbnN0cnVjdGlibGVUdXBsZTxfVUVsZW1lbnRzLi4uPigpCiAgICAgICAgICAg
ICAgICAgICYmIF9UTUM8X1VFbGVtZW50cy4uLj46OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAg
ICAgX0ltcGxpY2l0bHlNb3ZlQ29udmVydGlibGVUdXBsZTxfVUVsZW1lbnRzLi4uPigpCiAgICAg
ICAgICAgICAgICAgICYmIChzaXplb2YuLi4oX0VsZW1lbnRzKSA+PSAxKSwKICAgICAgICBib29s
Pjo6dHlwZT10cnVlPgogICAgICAgIGNvbnN0ZXhwciB0dXBsZShfVUVsZW1lbnRzJiYuLi4gX19l
bGVtZW50cykKICAgICAgICA6IF9Jbmhlcml0ZWQoc3RkOjpmb3J3YXJkPF9VRWxlbWVudHM+KF9f
ZWxlbWVudHMpLi4uKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9VRWxlbWVudHMs
IHR5cGVuYW1lCiAgICAgICAgZW5hYmxlX2lmPF9UTUM8X1VFbGVtZW50cy4uLj46OnRlbXBsYXRl
CiAgICAgICAgICAgICAgICAgICAgX01vdmVDb25zdHJ1Y3RpYmxlVHVwbGU8X1VFbGVtZW50cy4u
Lj4oKQogICAgICAgICAgICAgICAgICAmJiAhX1RNQzxfVUVsZW1lbnRzLi4uPjo6dGVtcGxhdGUK
ICAgICAgICAgICAgICAgICAgICBfSW1wbGljaXRseU1vdmVDb252ZXJ0aWJsZVR1cGxlPF9VRWxl
bWVudHMuLi4+KCkKICAgICAgICAgICAgICAgICAgJiYgKHNpemVvZi4uLihfRWxlbWVudHMpID49
IDEpLAogICAgICAgIGJvb2w+Ojp0eXBlPWZhbHNlPgogICAgICAgIGV4cGxpY2l0IGNvbnN0ZXhw
ciB0dXBsZShfVUVsZW1lbnRzJiYuLi4gX19lbGVtZW50cykKIDogX0luaGVyaXRlZChzdGQ6OmZv
cndhcmQ8X1VFbGVtZW50cz4oX19lbGVtZW50cykuLi4pIHsgfQoKICAgICAgY29uc3RleHByIHR1
cGxlKGNvbnN0IHR1cGxlJikgPSBkZWZhdWx0OwoKICAgICAgY29uc3RleHByIHR1cGxlKHR1cGxl
JiYpID0gZGVmYXVsdDsKCgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0R1bW15PiB1c2luZyBf
VE5UQyA9CiAgICAgICAgX1RDPGlzX3NhbWU8X0R1bW15LCB2b2lkPjo6dmFsdWUgJiYgc2l6ZW9m
Li4uKF9FbGVtZW50cykgPT0gMSwKICAgICAgICAgICAgX0VsZW1lbnRzLi4uPjsKCiAgICAgIHRl
bXBsYXRlPHR5cGVuYW1lLi4uIF9VRWxlbWVudHMsIHR5cGVuYW1lIF9EdW1teSA9IHZvaWQsIHR5
cGVuYW1lCiAgICAgICAgZW5hYmxlX2lmPF9UTUM8X1VFbGVtZW50cy4uLj46OnRlbXBsYXRlCiAg
ICAgICAgICAgICAgICAgICAgX0NvbnN0cnVjdGlibGVUdXBsZTxfVUVsZW1lbnRzLi4uPigpCiAg
ICAgICAgICAgICAgICAgICYmIF9UTUM8X1VFbGVtZW50cy4uLj46OnRlbXBsYXRlCiAgICAgICAg
ICAgICAgICAgICAgX0ltcGxpY2l0bHlDb252ZXJ0aWJsZVR1cGxlPF9VRWxlbWVudHMuLi4+KCkK
ICAgICAgICAgICAgICAgICAgJiYgX1ROVEM8X0R1bW15Pjo6dGVtcGxhdGUKICAgICAgICAgICAg
ICAgICAgICBfTm9uTmVzdGVkVHVwbGU8Y29uc3QgdHVwbGU8X1VFbGVtZW50cy4uLj4mPigpLAog
ICAgICAgIGJvb2w+Ojp0eXBlPXRydWU+CiAgICAgICAgY29uc3RleHByIHR1cGxlKGNvbnN0IHR1
cGxlPF9VRWxlbWVudHMuLi4+JiBfX2luKQogICAgICAgIDogX0luaGVyaXRlZChzdGF0aWNfY2Fz
dDxjb25zdCBfVHVwbGVfaW1wbDwwLCBfVUVsZW1lbnRzLi4uPiY+KF9faW4pKQogICAgICAgIHsg
fQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1VFbGVtZW50cywgdHlwZW5hbWUgX0R1bW15
ID0gdm9pZCwgdHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8X1RNQzxfVUVsZW1lbnRzLi4uPjo6
dGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICBfQ29uc3RydWN0aWJsZVR1cGxlPF9VRWxlbWVu
dHMuLi4+KCkKICAgICAgICAgICAgICAgICAgJiYgIV9UTUM8X1VFbGVtZW50cy4uLj46OnRlbXBs
YXRlCiAgICAgICAgICAgICAgICAgICAgX0ltcGxpY2l0bHlDb252ZXJ0aWJsZVR1cGxlPF9VRWxl
bWVudHMuLi4+KCkKICAgICAgICAgICAgICAgICAgJiYgX1ROVEM8X0R1bW15Pjo6dGVtcGxhdGUK
ICAgICAgICAgICAgICAgICAgICBfTm9uTmVzdGVkVHVwbGU8Y29uc3QgdHVwbGU8X1VFbGVtZW50
cy4uLj4mPigpLAogICAgICAgIGJvb2w+Ojp0eXBlPWZhbHNlPgogICAgICAgIGV4cGxpY2l0IGNv
bnN0ZXhwciB0dXBsZShjb25zdCB0dXBsZTxfVUVsZW1lbnRzLi4uPiYgX19pbikKICAgICAgICA6
IF9Jbmhlcml0ZWQoc3RhdGljX2Nhc3Q8Y29uc3QgX1R1cGxlX2ltcGw8MCwgX1VFbGVtZW50cy4u
Lj4mPihfX2luKSkKICAgICAgICB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9VRWxl
bWVudHMsIHR5cGVuYW1lIF9EdW1teSA9IHZvaWQsIHR5cGVuYW1lCiAgICAgICAgZW5hYmxlX2lm
PF9UTUM8X1VFbGVtZW50cy4uLj46OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICAgX01vdmVD
b25zdHJ1Y3RpYmxlVHVwbGU8X1VFbGVtZW50cy4uLj4oKQogICAgICAgICAgICAgICAgICAmJiBf
VE1DPF9VRWxlbWVudHMuLi4+Ojp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9JbXBsaWNp
dGx5TW92ZUNvbnZlcnRpYmxlVHVwbGU8X1VFbGVtZW50cy4uLj4oKQogICAgICAgICAgICAgICAg
ICAmJiBfVE5UQzxfRHVtbXk+Ojp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9Ob25OZXN0
ZWRUdXBsZTx0dXBsZTxfVUVsZW1lbnRzLi4uPiYmPigpLAogICAgICAgIGJvb2w+Ojp0eXBlPXRy
dWU+CiAgICAgICAgY29uc3RleHByIHR1cGxlKHR1cGxlPF9VRWxlbWVudHMuLi4+JiYgX19pbikK
ICAgICAgICA6IF9Jbmhlcml0ZWQoc3RhdGljX2Nhc3Q8X1R1cGxlX2ltcGw8MCwgX1VFbGVtZW50
cy4uLj4mJj4oX19pbikpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1VFbGVtZW50
cywgdHlwZW5hbWUgX0R1bW15ID0gdm9pZCwgdHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8X1RN
QzxfVUVsZW1lbnRzLi4uPjo6dGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICBfTW92ZUNvbnN0
cnVjdGlibGVUdXBsZTxfVUVsZW1lbnRzLi4uPigpCiAgICAgICAgICAgICAgICAgICYmICFfVE1D
PF9VRWxlbWVudHMuLi4+Ojp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9JbXBsaWNpdGx5
TW92ZUNvbnZlcnRpYmxlVHVwbGU8X1VFbGVtZW50cy4uLj4oKQogICAgICAgICAgICAgICAgICAm
JiBfVE5UQzxfRHVtbXk+Ojp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9Ob25OZXN0ZWRU
dXBsZTx0dXBsZTxfVUVsZW1lbnRzLi4uPiYmPigpLAogICAgICAgIGJvb2w+Ojp0eXBlPWZhbHNl
PgogICAgICAgIGV4cGxpY2l0IGNvbnN0ZXhwciB0dXBsZSh0dXBsZTxfVUVsZW1lbnRzLi4uPiYm
IF9faW4pCiAgICAgICAgOiBfSW5oZXJpdGVkKHN0YXRpY19jYXN0PF9UdXBsZV9pbXBsPDAsIF9V
RWxlbWVudHMuLi4+JiY+KF9faW4pKSB7IH0KCgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0Fs
bG9jPgogdHVwbGUoYWxsb2NhdG9yX2FyZ190IF9fdGFnLCBjb25zdCBfQWxsb2MmIF9fYSkKIDog
X0luaGVyaXRlZChfX3RhZywgX19hKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxv
YywgdHlwZW5hbWUgX0R1bW15ID0gdm9pZCwKICAgICAgICAgICAgICAgdHlwZW5hbWUgZW5hYmxl
X2lmPAogICAgICAgICAgICAgICAgIF9UQ0M8X0R1bW15Pjo6dGVtcGxhdGUKICAgICAgICAgICAg
ICAgICAgIF9Db25zdHJ1Y3RpYmxlVHVwbGU8X0VsZW1lbnRzLi4uPigpCiAgICAgICAgICAgICAg
ICAgJiYgX1RDQzxfRHVtbXk+Ojp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgX0ltcGxpY2l0
bHlDb252ZXJ0aWJsZVR1cGxlPF9FbGVtZW50cy4uLj4oKSwKICAgICAgICAgICAgICAgYm9vbD46
OnR5cGU9dHJ1ZT4KIHR1cGxlKGFsbG9jYXRvcl9hcmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBf
X2EsCiAgICAgICBjb25zdCBfRWxlbWVudHMmLi4uIF9fZWxlbWVudHMpCiA6IF9Jbmhlcml0ZWQo
X190YWcsIF9fYSwgX19lbGVtZW50cy4uLikgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
QWxsb2MsIHR5cGVuYW1lIF9EdW1teSA9IHZvaWQsCiAgICAgICAgICAgICAgIHR5cGVuYW1lIGVu
YWJsZV9pZjwKICAgICAgICAgICAgICAgICBfVENDPF9EdW1teT46OnRlbXBsYXRlCiAgICAgICAg
ICAgICAgICAgICBfQ29uc3RydWN0aWJsZVR1cGxlPF9FbGVtZW50cy4uLj4oKQogICAgICAgICAg
ICAgICAgICYmICFfVENDPF9EdW1teT46OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICBfSW1w
bGljaXRseUNvbnZlcnRpYmxlVHVwbGU8X0VsZW1lbnRzLi4uPigpLAogICAgICAgICAgICAgICBi
b29sPjo6dHlwZT1mYWxzZT4KIGV4cGxpY2l0IHR1cGxlKGFsbG9jYXRvcl9hcmdfdCBfX3RhZywg
Y29uc3QgX0FsbG9jJiBfX2EsCiAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgX0VsZW1lbnRz
Ji4uLiBfX2VsZW1lbnRzKQogOiBfSW5oZXJpdGVkKF9fdGFnLCBfX2EsIF9fZWxlbWVudHMuLi4p
IHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZS4uLiBfVUVsZW1l
bnRzLCB0eXBlbmFtZQogICAgICAgIGVuYWJsZV9pZjxfVE1DPF9VRWxlbWVudHMuLi4+Ojp0ZW1w
bGF0ZQogICAgICAgICAgICAgICAgICAgIF9Nb3ZlQ29uc3RydWN0aWJsZVR1cGxlPF9VRWxlbWVu
dHMuLi4+KCkKICAgICAgICAgICAgICAgICAgJiYgX1RNQzxfVUVsZW1lbnRzLi4uPjo6dGVtcGxh
dGUKICAgICAgICAgICAgICAgICAgICBfSW1wbGljaXRseU1vdmVDb252ZXJ0aWJsZVR1cGxlPF9V
RWxlbWVudHMuLi4+KCksCiAgICAgICAgYm9vbD46OnR5cGU9dHJ1ZT4KIHR1cGxlKGFsbG9jYXRv
cl9hcmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsCiAgICAgICBfVUVsZW1lbnRzJiYuLi4g
X19lbGVtZW50cykKIDogX0luaGVyaXRlZChfX3RhZywgX19hLCBzdGQ6OmZvcndhcmQ8X1VFbGVt
ZW50cz4oX19lbGVtZW50cykuLi4pCiAgICAgICAgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfQWxsb2MsIHR5cGVuYW1lLi4uIF9VRWxlbWVudHMsIHR5cGVuYW1lCiAgICAgICAgZW5hYmxl
X2lmPF9UTUM8X1VFbGVtZW50cy4uLj46OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICAgX01v
dmVDb25zdHJ1Y3RpYmxlVHVwbGU8X1VFbGVtZW50cy4uLj4oKQogICAgICAgICAgICAgICAgICAm
JiAhX1RNQzxfVUVsZW1lbnRzLi4uPjo6dGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICBfSW1w
bGljaXRseU1vdmVDb252ZXJ0aWJsZVR1cGxlPF9VRWxlbWVudHMuLi4+KCksCiAgICAgICAgYm9v
bD46OnR5cGU9ZmFsc2U+CiBleHBsaWNpdCB0dXBsZShhbGxvY2F0b3JfYXJnX3QgX190YWcsIGNv
bnN0IF9BbGxvYyYgX19hLAogICAgICAgX1VFbGVtZW50cyYmLi4uIF9fZWxlbWVudHMpCiA6IF9J
bmhlcml0ZWQoX190YWcsIF9fYSwgc3RkOjpmb3J3YXJkPF9VRWxlbWVudHM+KF9fZWxlbWVudHMp
Li4uKQogICAgICAgIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogdHVwbGUo
YWxsb2NhdG9yX2FyZ190IF9fdGFnLCBjb25zdCBfQWxsb2MmIF9fYSwgY29uc3QgdHVwbGUmIF9f
aW4pCiA6IF9Jbmhlcml0ZWQoX190YWcsIF9fYSwgc3RhdGljX2Nhc3Q8Y29uc3QgX0luaGVyaXRl
ZCY+KF9faW4pKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KIHR1cGxlKGFs
bG9jYXRvcl9hcmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsIHR1cGxlJiYgX19pbikKIDog
X0luaGVyaXRlZChfX3RhZywgX19hLCBzdGF0aWNfY2FzdDxfSW5oZXJpdGVkJiY+KF9faW4pKSB7
IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUuLi4gX1VFbGVtZW50
cywgdHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8X1RNQzxfVUVsZW1lbnRzLi4uPjo6dGVtcGxh
dGUKICAgICAgICAgICAgICAgICAgICBfQ29uc3RydWN0aWJsZVR1cGxlPF9VRWxlbWVudHMuLi4+
KCkKICAgICAgICAgICAgICAgICAgJiYgX1RNQzxfVUVsZW1lbnRzLi4uPjo6dGVtcGxhdGUKICAg
ICAgICAgICAgICAgICAgICBfSW1wbGljaXRseUNvbnZlcnRpYmxlVHVwbGU8X1VFbGVtZW50cy4u
Lj4oKSwKICAgICAgICBib29sPjo6dHlwZT10cnVlPgogdHVwbGUoYWxsb2NhdG9yX2FyZ190IF9f
dGFnLCBjb25zdCBfQWxsb2MmIF9fYSwKICAgICAgIGNvbnN0IHR1cGxlPF9VRWxlbWVudHMuLi4+
JiBfX2luKQogOiBfSW5oZXJpdGVkKF9fdGFnLCBfX2EsCiAgICAgICAgICAgICAgc3RhdGljX2Nh
c3Q8Y29uc3QgX1R1cGxlX2ltcGw8MCwgX1VFbGVtZW50cy4uLj4mPihfX2luKSkKIHsgfQoKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZS4uLiBfVUVsZW1lbnRzLCB0eXBl
bmFtZQogICAgICAgIGVuYWJsZV9pZjxfVE1DPF9VRWxlbWVudHMuLi4+Ojp0ZW1wbGF0ZQogICAg
ICAgICAgICAgICAgICAgIF9Db25zdHJ1Y3RpYmxlVHVwbGU8X1VFbGVtZW50cy4uLj4oKQogICAg
ICAgICAgICAgICAgICAmJiAhX1RNQzxfVUVsZW1lbnRzLi4uPjo6dGVtcGxhdGUKICAgICAgICAg
ICAgICAgICAgICBfSW1wbGljaXRseUNvbnZlcnRpYmxlVHVwbGU8X1VFbGVtZW50cy4uLj4oKSwK
ICAgICAgICBib29sPjo6dHlwZT1mYWxzZT4KIGV4cGxpY2l0IHR1cGxlKGFsbG9jYXRvcl9hcmdf
dCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsCiAgICAgICBjb25zdCB0dXBsZTxfVUVsZW1lbnRz
Li4uPiYgX19pbikKIDogX0luaGVyaXRlZChfX3RhZywgX19hLAogICAgICAgICAgICAgIHN0YXRp
Y19jYXN0PGNvbnN0IF9UdXBsZV9pbXBsPDAsIF9VRWxlbWVudHMuLi4+Jj4oX19pbikpCiB7IH0K
CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUuLi4gX1VFbGVtZW50cywg
dHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8X1RNQzxfVUVsZW1lbnRzLi4uPjo6dGVtcGxhdGUK
ICAgICAgICAgICAgICAgICAgICBfTW92ZUNvbnN0cnVjdGlibGVUdXBsZTxfVUVsZW1lbnRzLi4u
PigpCiAgICAgICAgICAgICAgICAgICYmIF9UTUM8X1VFbGVtZW50cy4uLj46OnRlbXBsYXRlCiAg
ICAgICAgICAgICAgICAgICAgX0ltcGxpY2l0bHlNb3ZlQ29udmVydGlibGVUdXBsZTxfVUVsZW1l
bnRzLi4uPigpLAogICAgICAgIGJvb2w+Ojp0eXBlPXRydWU+CiB0dXBsZShhbGxvY2F0b3JfYXJn
X3QgX190YWcsIGNvbnN0IF9BbGxvYyYgX19hLAogICAgICAgdHVwbGU8X1VFbGVtZW50cy4uLj4m
JiBfX2luKQogOiBfSW5oZXJpdGVkKF9fdGFnLCBfX2EsCiAgICAgICAgICAgICAgc3RhdGljX2Nh
c3Q8X1R1cGxlX2ltcGw8MCwgX1VFbGVtZW50cy4uLj4mJj4oX19pbikpCiB7IH0KCiAgICAgIHRl
bXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUuLi4gX1VFbGVtZW50cywgdHlwZW5hbWUK
ICAgICAgICBlbmFibGVfaWY8X1RNQzxfVUVsZW1lbnRzLi4uPjo6dGVtcGxhdGUKICAgICAgICAg
ICAgICAgICAgICBfTW92ZUNvbnN0cnVjdGlibGVUdXBsZTxfVUVsZW1lbnRzLi4uPigpCiAgICAg
ICAgICAgICAgICAgICYmICFfVE1DPF9VRWxlbWVudHMuLi4+Ojp0ZW1wbGF0ZQogICAgICAgICAg
ICAgICAgICAgIF9JbXBsaWNpdGx5TW92ZUNvbnZlcnRpYmxlVHVwbGU8X1VFbGVtZW50cy4uLj4o
KSwKICAgICAgICBib29sPjo6dHlwZT1mYWxzZT4KIGV4cGxpY2l0IHR1cGxlKGFsbG9jYXRvcl9h
cmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsCiAgICAgICB0dXBsZTxfVUVsZW1lbnRzLi4u
PiYmIF9faW4pCiA6IF9Jbmhlcml0ZWQoX190YWcsIF9fYSwKICAgICAgICAgICAgICBzdGF0aWNf
Y2FzdDxfVHVwbGVfaW1wbDwwLCBfVUVsZW1lbnRzLi4uPiYmPihfX2luKSkKIHsgfQoKICAgICAg
dHVwbGUmCiAgICAgIG9wZXJhdG9yPShjb25zdCB0dXBsZSYgX19pbikKICAgICAgewogc3RhdGlj
X2Nhc3Q8X0luaGVyaXRlZCY+KCp0aGlzKSA9IF9faW47CiByZXR1cm4gKnRoaXM7CiAgICAgIH0K
CiAgICAgIHR1cGxlJgogICAgICBvcGVyYXRvcj0odHVwbGUmJiBfX2luKQogICAgICBub2V4Y2Vw
dChpc19ub3Rocm93X21vdmVfYXNzaWduYWJsZTxfSW5oZXJpdGVkPjo6dmFsdWUpCiAgICAgIHsK
IHN0YXRpY19jYXN0PF9Jbmhlcml0ZWQmPigqdGhpcykgPSBzdGQ6Om1vdmUoX19pbik7CiByZXR1
cm4gKnRoaXM7CiAgICAgIH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9VRWxlbWVudHMs
IHR5cGVuYW1lID0gdHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8c2l6ZW9mLi4uKF9VRWxlbWVu
dHMpCiAgICA9PSBzaXplb2YuLi4oX0VsZW1lbnRzKT46OnR5cGU+CiAgICAgICAgdHVwbGUmCiAg
ICAgICAgb3BlcmF0b3I9KGNvbnN0IHR1cGxlPF9VRWxlbWVudHMuLi4+JiBfX2luKQogICAgICAg
IHsKICAgc3RhdGljX2Nhc3Q8X0luaGVyaXRlZCY+KCp0aGlzKSA9IF9faW47CiAgIHJldHVybiAq
dGhpczsKIH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9VRWxlbWVudHMsIHR5cGVuYW1l
ID0gdHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8c2l6ZW9mLi4uKF9VRWxlbWVudHMpCiAgICA9
PSBzaXplb2YuLi4oX0VsZW1lbnRzKT46OnR5cGU+CiAgICAgICAgdHVwbGUmCiAgICAgICAgb3Bl
cmF0b3I9KHR1cGxlPF9VRWxlbWVudHMuLi4+JiYgX19pbikKICAgICAgICB7CiAgIHN0YXRpY19j
YXN0PF9Jbmhlcml0ZWQmPigqdGhpcykgPSBzdGQ6Om1vdmUoX19pbik7CiAgIHJldHVybiAqdGhp
czsKIH0KCiAgICAgIHZvaWQKICAgICAgc3dhcCh0dXBsZSYgX19pbikKICAgICAgbm9leGNlcHQo
bm9leGNlcHQoX19pbi5fTV9zd2FwKF9faW4pKSkKICAgICAgeyBfSW5oZXJpdGVkOjpfTV9zd2Fw
KF9faW4pOyB9CiAgICB9OwoKCiAgdGVtcGxhdGU8PgogICAgY2xhc3MgdHVwbGU8PgogICAgewog
ICAgcHVibGljOgogICAgICB2b2lkIHN3YXAodHVwbGUmKSBub2V4Y2VwdCB7IH0KICAgIH07CgoK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1QxLCB0eXBlbmFtZSBfVDI+CiAgICBjbGFzcyB0dXBsZTxf
VDEsIF9UMj4gOiBwdWJsaWMgX1R1cGxlX2ltcGw8MCwgX1QxLCBfVDI+CiAgICB7CiAgICAgIHR5
cGVkZWYgX1R1cGxlX2ltcGw8MCwgX1QxLCBfVDI+IF9Jbmhlcml0ZWQ7CgogICAgcHVibGljOgog
ICAgICB0ZW1wbGF0ZSA8dHlwZW5hbWUgX1UxID0gX1QxLAogICAgICAgICAgICAgICAgdHlwZW5h
bWUgX1UyID0gX1QyLAogICAgICAgICAgICAgICAgdHlwZW5hbWUgZW5hYmxlX2lmPF9fYW5kXzwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9faXNfaW1wbGljaXRseV9kZWZh
dWx0X2NvbnN0cnVjdGlibGU8X1UxPiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIF9faXNfaW1wbGljaXRseV9kZWZhdWx0X2NvbnN0cnVjdGlibGU8X1UyPj4KICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICA6OnZhbHVlLCBib29sPjo6dHlwZSA9IHRydWU+Cgog
ICAgICBjb25zdGV4cHIgdHVwbGUoKQogICAgICA6IF9Jbmhlcml0ZWQoKSB7IH0KCiAgICAgIHRl
bXBsYXRlIDx0eXBlbmFtZSBfVTEgPSBfVDEsCiAgICAgICAgICAgICAgICB0eXBlbmFtZSBfVTIg
PSBfVDIsCiAgICAgICAgICAgICAgICB0eXBlbmFtZSBlbmFibGVfaWY8CiAgICAgICAgICAgICAg
ICAgIF9fYW5kXzwKICAgICAgICAgICAgICAgICAgICBpc19kZWZhdWx0X2NvbnN0cnVjdGlibGU8
X1UxPiwKICAgICAgICAgICAgICAgICAgICBpc19kZWZhdWx0X2NvbnN0cnVjdGlibGU8X1UyPiwK
ICAgICAgICAgICAgICAgICAgICBfX25vdF88CiAgICAgICAgICAgICAgICAgICAgICBfX2FuZF88
X19pc19pbXBsaWNpdGx5X2RlZmF1bHRfY29uc3RydWN0aWJsZTxfVTE+LAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIF9faXNfaW1wbGljaXRseV9kZWZhdWx0X2NvbnN0cnVjdGlibGU8X1Uy
Pj4+PgogICAgICAgICAgICAgICAgICA6OnZhbHVlLCBib29sPjo6dHlwZSA9IGZhbHNlPgoKICAg
ICAgZXhwbGljaXQgY29uc3RleHByIHR1cGxlKCkKICAgICAgOiBfSW5oZXJpdGVkKCkgeyB9CgoK
CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9EdW1teT4gdXNpbmcgX1RDQyA9CiAgICAgICAgX1RD
PGlzX3NhbWU8X0R1bW15LCB2b2lkPjo6dmFsdWUsIF9UMSwgX1QyPjsKCiAgICAgIHRlbXBsYXRl
PHR5cGVuYW1lIF9EdW1teSA9IHZvaWQsIHR5cGVuYW1lCiAgICAgICAgICAgICAgIGVuYWJsZV9p
ZjxfVENDPF9EdW1teT46OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICAgICAgICAgIF9Db25z
dHJ1Y3RpYmxlVHVwbGU8X1QxLCBfVDI+KCkKICAgICAgICAgICAgICAgICAgICAgICAgICYmIF9U
Q0M8X0R1bW15Pjo6dGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgX0ltcGxpY2l0
bHlDb252ZXJ0aWJsZVR1cGxlPF9UMSwgX1QyPigpLAogYm9vbD46OnR5cGUgPSB0cnVlPgogICAg
ICAgIGNvbnN0ZXhwciB0dXBsZShjb25zdCBfVDEmIF9fYTEsIGNvbnN0IF9UMiYgX19hMikKICAg
ICAgICA6IF9Jbmhlcml0ZWQoX19hMSwgX19hMikgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfRHVtbXkgPSB2b2lkLCB0eXBlbmFtZQogICAgICAgICAgICAgICBlbmFibGVfaWY8X1RDQzxf
RHVtbXk+Ojp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICBfQ29uc3RydWN0aWJs
ZVR1cGxlPF9UMSwgX1QyPigpCiAgICAgICAgICAgICAgICAgICAgICAgICAmJiAhX1RDQzxfRHVt
bXk+Ojp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgICAgICAgICBfSW1wbGljaXRseUNvbnZl
cnRpYmxlVHVwbGU8X1QxLCBfVDI+KCksCiBib29sPjo6dHlwZSA9IGZhbHNlPgogICAgICAgIGV4
cGxpY2l0IGNvbnN0ZXhwciB0dXBsZShjb25zdCBfVDEmIF9fYTEsIGNvbnN0IF9UMiYgX19hMikK
ICAgICAgICA6IF9Jbmhlcml0ZWQoX19hMSwgX19hMikgeyB9CgoKCiAgICAgIHVzaW5nIF9UTUMg
PSBfVEM8dHJ1ZSwgX1QxLCBfVDI+OwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1UxLCB0eXBl
bmFtZSBfVTIsIHR5cGVuYW1lCiAgICAgICAgZW5hYmxlX2lmPF9UTUM6OnRlbXBsYXRlCiAgICAg
ICAgICAgICAgICAgICAgX01vdmVDb25zdHJ1Y3RpYmxlVHVwbGU8X1UxLCBfVTI+KCkKICAgICAg
ICAgICAgICAgICAgJiYgX1RNQzo6dGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICBfSW1wbGlj
aXRseU1vdmVDb252ZXJ0aWJsZVR1cGxlPF9VMSwgX1UyPigpLAogYm9vbD46OnR5cGUgPSB0cnVl
PgogICAgICAgIGNvbnN0ZXhwciB0dXBsZShfVTEmJiBfX2ExLCBfVTImJiBfX2EyKQogOiBfSW5o
ZXJpdGVkKHN0ZDo6Zm9yd2FyZDxfVTE+KF9fYTEpLCBzdGQ6OmZvcndhcmQ8X1UyPihfX2EyKSkg
eyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVTEsIHR5cGVuYW1lIF9VMiwgdHlwZW5hbWUK
ICAgICAgICBlbmFibGVfaWY8X1RNQzo6dGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICBfTW92
ZUNvbnN0cnVjdGlibGVUdXBsZTxfVTEsIF9VMj4oKQogICAgICAgICAgICAgICAgICAmJiAhX1RN
Qzo6dGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICBfSW1wbGljaXRseU1vdmVDb252ZXJ0aWJs
ZVR1cGxlPF9VMSwgX1UyPigpLAogYm9vbD46OnR5cGUgPSBmYWxzZT4KICAgICAgICBleHBsaWNp
dCBjb25zdGV4cHIgdHVwbGUoX1UxJiYgX19hMSwgX1UyJiYgX19hMikKIDogX0luaGVyaXRlZChz
dGQ6OmZvcndhcmQ8X1UxPihfX2ExKSwgc3RkOjpmb3J3YXJkPF9VMj4oX19hMikpIHsgfQoKICAg
ICAgY29uc3RleHByIHR1cGxlKGNvbnN0IHR1cGxlJikgPSBkZWZhdWx0OwoKICAgICAgY29uc3Rl
eHByIHR1cGxlKHR1cGxlJiYpID0gZGVmYXVsdDsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9V
MSwgdHlwZW5hbWUgX1UyLCB0eXBlbmFtZQogICAgICAgIGVuYWJsZV9pZjxfVE1DOjp0ZW1wbGF0
ZQogICAgICAgICAgICAgICAgICAgIF9Db25zdHJ1Y3RpYmxlVHVwbGU8X1UxLCBfVTI+KCkKICAg
ICAgICAgICAgICAgICAgJiYgX1RNQzo6dGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICBfSW1w
bGljaXRseUNvbnZlcnRpYmxlVHVwbGU8X1UxLCBfVTI+KCksCiBib29sPjo6dHlwZSA9IHRydWU+
CiAgICAgICAgY29uc3RleHByIHR1cGxlKGNvbnN0IHR1cGxlPF9VMSwgX1UyPiYgX19pbikKIDog
X0luaGVyaXRlZChzdGF0aWNfY2FzdDxjb25zdCBfVHVwbGVfaW1wbDwwLCBfVTEsIF9VMj4mPihf
X2luKSkgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVTEsIHR5cGVuYW1lIF9VMiwgdHlw
ZW5hbWUKICAgICAgICBlbmFibGVfaWY8X1RNQzo6dGVtcGxhdGUKICAgICAgICAgICAgICAgICAg
ICBfQ29uc3RydWN0aWJsZVR1cGxlPF9VMSwgX1UyPigpCiAgICAgICAgICAgICAgICAgICYmICFf
VE1DOjp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9JbXBsaWNpdGx5Q29udmVydGlibGVU
dXBsZTxfVTEsIF9VMj4oKSwKIGJvb2w+Ojp0eXBlID0gZmFsc2U+CiAgICAgICAgZXhwbGljaXQg
Y29uc3RleHByIHR1cGxlKGNvbnN0IHR1cGxlPF9VMSwgX1UyPiYgX19pbikKIDogX0luaGVyaXRl
ZChzdGF0aWNfY2FzdDxjb25zdCBfVHVwbGVfaW1wbDwwLCBfVTEsIF9VMj4mPihfX2luKSkgeyB9
CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVTEsIHR5cGVuYW1lIF9VMiwgdHlwZW5hbWUKICAg
ICAgICBlbmFibGVfaWY8X1RNQzo6dGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICBfTW92ZUNv
bnN0cnVjdGlibGVUdXBsZTxfVTEsIF9VMj4oKQogICAgICAgICAgICAgICAgICAmJiBfVE1DOjp0
ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9JbXBsaWNpdGx5TW92ZUNvbnZlcnRpYmxlVHVw
bGU8X1UxLCBfVTI+KCksCiBib29sPjo6dHlwZSA9IHRydWU+CiAgICAgICAgY29uc3RleHByIHR1
cGxlKHR1cGxlPF9VMSwgX1UyPiYmIF9faW4pCiA6IF9Jbmhlcml0ZWQoc3RhdGljX2Nhc3Q8X1R1
cGxlX2ltcGw8MCwgX1UxLCBfVTI+JiY+KF9faW4pKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVu
YW1lIF9VMSwgdHlwZW5hbWUgX1UyLCB0eXBlbmFtZQogICAgICAgIGVuYWJsZV9pZjxfVE1DOjp0
ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9Nb3ZlQ29uc3RydWN0aWJsZVR1cGxlPF9VMSwg
X1UyPigpCiAgICAgICAgICAgICAgICAgICYmICFfVE1DOjp0ZW1wbGF0ZQogICAgICAgICAgICAg
ICAgICAgIF9JbXBsaWNpdGx5TW92ZUNvbnZlcnRpYmxlVHVwbGU8X1UxLCBfVTI+KCksCiBib29s
Pjo6dHlwZSA9IGZhbHNlPgogICAgICAgIGV4cGxpY2l0IGNvbnN0ZXhwciB0dXBsZSh0dXBsZTxf
VTEsIF9VMj4mJiBfX2luKQogOiBfSW5oZXJpdGVkKHN0YXRpY19jYXN0PF9UdXBsZV9pbXBsPDAs
IF9VMSwgX1UyPiYmPihfX2luKSkgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVTEsIHR5
cGVuYW1lIF9VMiwgdHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8X1RNQzo6dGVtcGxhdGUKICAg
ICAgICAgICAgICAgICAgICBfQ29uc3RydWN0aWJsZVR1cGxlPF9VMSwgX1UyPigpCiAgICAgICAg
ICAgICAgICAgICYmIF9UTUM6OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICAgX0ltcGxpY2l0
bHlDb252ZXJ0aWJsZVR1cGxlPF9VMSwgX1UyPigpLAogYm9vbD46OnR5cGUgPSB0cnVlPgogICAg
ICAgIGNvbnN0ZXhwciB0dXBsZShjb25zdCBwYWlyPF9VMSwgX1UyPiYgX19pbikKIDogX0luaGVy
aXRlZChfX2luLmZpcnN0LCBfX2luLnNlY29uZCkgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfVTEsIHR5cGVuYW1lIF9VMiwgdHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8X1RNQzo6dGVt
cGxhdGUKICAgICAgICAgICAgICAgICAgICBfQ29uc3RydWN0aWJsZVR1cGxlPF9VMSwgX1UyPigp
CiAgICAgICAgICAgICAgICAgICYmICFfVE1DOjp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAg
IF9JbXBsaWNpdGx5Q29udmVydGlibGVUdXBsZTxfVTEsIF9VMj4oKSwKIGJvb2w+Ojp0eXBlID0g
ZmFsc2U+CiAgICAgICAgZXhwbGljaXQgY29uc3RleHByIHR1cGxlKGNvbnN0IHBhaXI8X1UxLCBf
VTI+JiBfX2luKQogOiBfSW5oZXJpdGVkKF9faW4uZmlyc3QsIF9faW4uc2Vjb25kKSB7IH0KCiAg
ICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VMSwgdHlwZW5hbWUgX1UyLCB0eXBlbmFtZQogICAgICAg
IGVuYWJsZV9pZjxfVE1DOjp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9Nb3ZlQ29uc3Ry
dWN0aWJsZVR1cGxlPF9VMSwgX1UyPigpCiAgICAgICAgICAgICAgICAgICYmIF9UTUM6OnRlbXBs
YXRlCiAgICAgICAgICAgICAgICAgICAgX0ltcGxpY2l0bHlNb3ZlQ29udmVydGlibGVUdXBsZTxf
VTEsIF9VMj4oKSwKIGJvb2w+Ojp0eXBlID0gdHJ1ZT4KICAgICAgICBjb25zdGV4cHIgdHVwbGUo
cGFpcjxfVTEsIF9VMj4mJiBfX2luKQogOiBfSW5oZXJpdGVkKHN0ZDo6Zm9yd2FyZDxfVTE+KF9f
aW4uZmlyc3QpLAogICAgICAgc3RkOjpmb3J3YXJkPF9VMj4oX19pbi5zZWNvbmQpKSB7IH0KCiAg
ICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VMSwgdHlwZW5hbWUgX1UyLCB0eXBlbmFtZQogICAgICAg
IGVuYWJsZV9pZjxfVE1DOjp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9Nb3ZlQ29uc3Ry
dWN0aWJsZVR1cGxlPF9VMSwgX1UyPigpCiAgICAgICAgICAgICAgICAgICYmICFfVE1DOjp0ZW1w
bGF0ZQogICAgICAgICAgICAgICAgICAgIF9JbXBsaWNpdGx5TW92ZUNvbnZlcnRpYmxlVHVwbGU8
X1UxLCBfVTI+KCksCiBib29sPjo6dHlwZSA9IGZhbHNlPgogICAgICAgIGV4cGxpY2l0IGNvbnN0
ZXhwciB0dXBsZShwYWlyPF9VMSwgX1UyPiYmIF9faW4pCiA6IF9Jbmhlcml0ZWQoc3RkOjpmb3J3
YXJkPF9VMT4oX19pbi5maXJzdCksCiAgICAgICBzdGQ6OmZvcndhcmQ8X1UyPihfX2luLnNlY29u
ZCkpIHsgfQoKCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2M+CiB0dXBsZShhbGxvY2F0
b3JfYXJnX3QgX190YWcsIGNvbnN0IF9BbGxvYyYgX19hKQogOiBfSW5oZXJpdGVkKF9fdGFnLCBf
X2EpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZSBfRHVtbXkg
PSB2b2lkLAogICAgICAgICAgICAgICB0eXBlbmFtZSBlbmFibGVfaWY8CiAgICAgICAgICAgICAg
ICAgX1RDQzxfRHVtbXk+Ojp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgX0NvbnN0cnVjdGli
bGVUdXBsZTxfVDEsIF9UMj4oKQogICAgICAgICAgICAgICAgICYmIF9UQ0M8X0R1bW15Pjo6dGVt
cGxhdGUKICAgICAgICAgICAgICAgICAgIF9JbXBsaWNpdGx5Q29udmVydGlibGVUdXBsZTxfVDEs
IF9UMj4oKSwKICAgICAgICAgICAgICAgYm9vbD46OnR5cGU9dHJ1ZT4KCiB0dXBsZShhbGxvY2F0
b3JfYXJnX3QgX190YWcsIGNvbnN0IF9BbGxvYyYgX19hLAogICAgICAgY29uc3QgX1QxJiBfX2Ex
LCBjb25zdCBfVDImIF9fYTIpCiA6IF9Jbmhlcml0ZWQoX190YWcsIF9fYSwgX19hMSwgX19hMikg
eyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2MsIHR5cGVuYW1lIF9EdW1teSA9IHZv
aWQsCiAgICAgICAgICAgICAgIHR5cGVuYW1lIGVuYWJsZV9pZjwKICAgICAgICAgICAgICAgICBf
VENDPF9EdW1teT46OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICBfQ29uc3RydWN0aWJsZVR1
cGxlPF9UMSwgX1QyPigpCiAgICAgICAgICAgICAgICAgJiYgIV9UQ0M8X0R1bW15Pjo6dGVtcGxh
dGUKICAgICAgICAgICAgICAgICAgIF9JbXBsaWNpdGx5Q29udmVydGlibGVUdXBsZTxfVDEsIF9U
Mj4oKSwKICAgICAgICAgICAgICAgYm9vbD46OnR5cGU9ZmFsc2U+CgogZXhwbGljaXQgdHVwbGUo
YWxsb2NhdG9yX2FyZ190IF9fdGFnLCBjb25zdCBfQWxsb2MmIF9fYSwKICAgICAgIGNvbnN0IF9U
MSYgX19hMSwgY29uc3QgX1QyJiBfX2EyKQogOiBfSW5oZXJpdGVkKF9fdGFnLCBfX2EsIF9fYTEs
IF9fYTIpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZSBfVTEs
IHR5cGVuYW1lIF9VMiwgdHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8X1RNQzo6dGVtcGxhdGUK
ICAgICAgICAgICAgICAgICAgICBfTW92ZUNvbnN0cnVjdGlibGVUdXBsZTxfVTEsIF9VMj4oKQog
ICAgICAgICAgICAgICAgICAmJiBfVE1DOjp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9J
bXBsaWNpdGx5TW92ZUNvbnZlcnRpYmxlVHVwbGU8X1UxLCBfVTI+KCksCiBib29sPjo6dHlwZSA9
IHRydWU+CiB0dXBsZShhbGxvY2F0b3JfYXJnX3QgX190YWcsIGNvbnN0IF9BbGxvYyYgX19hLCBf
VTEmJiBfX2ExLCBfVTImJiBfX2EyKQogOiBfSW5oZXJpdGVkKF9fdGFnLCBfX2EsIHN0ZDo6Zm9y
d2FyZDxfVTE+KF9fYTEpLAogICAgICAgICAgICAgIHN0ZDo6Zm9yd2FyZDxfVTI+KF9fYTIpKSB7
IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUgX1UxLCB0eXBlbmFt
ZSBfVTIsIHR5cGVuYW1lCiAgICAgICAgZW5hYmxlX2lmPF9UTUM6OnRlbXBsYXRlCiAgICAgICAg
ICAgICAgICAgICAgX01vdmVDb25zdHJ1Y3RpYmxlVHVwbGU8X1UxLCBfVTI+KCkKICAgICAgICAg
ICAgICAgICAgJiYgIV9UTUM6OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICAgX0ltcGxpY2l0
bHlNb3ZlQ29udmVydGlibGVUdXBsZTxfVTEsIF9VMj4oKSwKIGJvb2w+Ojp0eXBlID0gZmFsc2U+
CiBleHBsaWNpdCB0dXBsZShhbGxvY2F0b3JfYXJnX3QgX190YWcsIGNvbnN0IF9BbGxvYyYgX19h
LAogICAgICAgICAgICAgICAgICAgICAgIF9VMSYmIF9fYTEsIF9VMiYmIF9fYTIpCiA6IF9Jbmhl
cml0ZWQoX190YWcsIF9fYSwgc3RkOjpmb3J3YXJkPF9VMT4oX19hMSksCiAgICAgICAgICAgICAg
c3RkOjpmb3J3YXJkPF9VMj4oX19hMikpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0Fs
bG9jPgogdHVwbGUoYWxsb2NhdG9yX2FyZ190IF9fdGFnLCBjb25zdCBfQWxsb2MmIF9fYSwgY29u
c3QgdHVwbGUmIF9faW4pCiA6IF9Jbmhlcml0ZWQoX190YWcsIF9fYSwgc3RhdGljX2Nhc3Q8Y29u
c3QgX0luaGVyaXRlZCY+KF9faW4pKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxv
Yz4KIHR1cGxlKGFsbG9jYXRvcl9hcmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsIHR1cGxl
JiYgX19pbikKIDogX0luaGVyaXRlZChfX3RhZywgX19hLCBzdGF0aWNfY2FzdDxfSW5oZXJpdGVk
JiY+KF9faW4pKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUg
X1UxLCB0eXBlbmFtZSBfVTIsIHR5cGVuYW1lCiAgICAgICAgZW5hYmxlX2lmPF9UTUM6OnRlbXBs
YXRlCiAgICAgICAgICAgICAgICAgICAgX0NvbnN0cnVjdGlibGVUdXBsZTxfVTEsIF9VMj4oKQog
ICAgICAgICAgICAgICAgICAmJiBfVE1DOjp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9J
bXBsaWNpdGx5Q29udmVydGlibGVUdXBsZTxfVTEsIF9VMj4oKSwKIGJvb2w+Ojp0eXBlID0gdHJ1
ZT4KIHR1cGxlKGFsbG9jYXRvcl9hcmdfdCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsCiAgICAg
ICBjb25zdCB0dXBsZTxfVTEsIF9VMj4mIF9faW4pCiA6IF9Jbmhlcml0ZWQoX190YWcsIF9fYSwK
ICAgICAgICAgICAgICBzdGF0aWNfY2FzdDxjb25zdCBfVHVwbGVfaW1wbDwwLCBfVTEsIF9VMj4m
PihfX2luKSkKIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZSBf
VTEsIHR5cGVuYW1lIF9VMiwgdHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8X1RNQzo6dGVtcGxh
dGUKICAgICAgICAgICAgICAgICAgICBfQ29uc3RydWN0aWJsZVR1cGxlPF9VMSwgX1UyPigpCiAg
ICAgICAgICAgICAgICAgICYmICFfVE1DOjp0ZW1wbGF0ZQogICAgICAgICAgICAgICAgICAgIF9J
bXBsaWNpdGx5Q29udmVydGlibGVUdXBsZTxfVTEsIF9VMj4oKSwKIGJvb2w+Ojp0eXBlID0gZmFs
c2U+CiBleHBsaWNpdCB0dXBsZShhbGxvY2F0b3JfYXJnX3QgX190YWcsIGNvbnN0IF9BbGxvYyYg
X19hLAogICAgICAgY29uc3QgdHVwbGU8X1UxLCBfVTI+JiBfX2luKQogOiBfSW5oZXJpdGVkKF9f
dGFnLCBfX2EsCiAgICAgICAgICAgICAgc3RhdGljX2Nhc3Q8Y29uc3QgX1R1cGxlX2ltcGw8MCwg
X1UxLCBfVTI+Jj4oX19pbikpCiB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywg
dHlwZW5hbWUgX1UxLCB0eXBlbmFtZSBfVTIsIHR5cGVuYW1lCiAgICAgICAgZW5hYmxlX2lmPF9U
TUM6OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICAgX01vdmVDb25zdHJ1Y3RpYmxlVHVwbGU8
X1UxLCBfVTI+KCkKICAgICAgICAgICAgICAgICAgJiYgX1RNQzo6dGVtcGxhdGUKICAgICAgICAg
ICAgICAgICAgICBfSW1wbGljaXRseU1vdmVDb252ZXJ0aWJsZVR1cGxlPF9VMSwgX1UyPigpLAog
Ym9vbD46OnR5cGUgPSB0cnVlPgogdHVwbGUoYWxsb2NhdG9yX2FyZ190IF9fdGFnLCBjb25zdCBf
QWxsb2MmIF9fYSwgdHVwbGU8X1UxLCBfVTI+JiYgX19pbikKIDogX0luaGVyaXRlZChfX3RhZywg
X19hLCBzdGF0aWNfY2FzdDxfVHVwbGVfaW1wbDwwLCBfVTEsIF9VMj4mJj4oX19pbikpCiB7IH0K
CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUgX1UxLCB0eXBlbmFtZSBf
VTIsIHR5cGVuYW1lCiAgICAgICAgZW5hYmxlX2lmPF9UTUM6OnRlbXBsYXRlCiAgICAgICAgICAg
ICAgICAgICAgX01vdmVDb25zdHJ1Y3RpYmxlVHVwbGU8X1UxLCBfVTI+KCkKICAgICAgICAgICAg
ICAgICAgJiYgIV9UTUM6OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICAgX0ltcGxpY2l0bHlN
b3ZlQ29udmVydGlibGVUdXBsZTxfVTEsIF9VMj4oKSwKIGJvb2w+Ojp0eXBlID0gZmFsc2U+CiBl
eHBsaWNpdCB0dXBsZShhbGxvY2F0b3JfYXJnX3QgX190YWcsIGNvbnN0IF9BbGxvYyYgX19hLAog
ICAgICAgICAgICAgICAgICAgICAgIHR1cGxlPF9VMSwgX1UyPiYmIF9faW4pCiA6IF9Jbmhlcml0
ZWQoX190YWcsIF9fYSwgc3RhdGljX2Nhc3Q8X1R1cGxlX2ltcGw8MCwgX1UxLCBfVTI+JiY+KF9f
aW4pKQogeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2MsIHR5cGVuYW1lIF9VMSwg
dHlwZW5hbWUgX1UyLCB0eXBlbmFtZQogICAgICAgIGVuYWJsZV9pZjxfVE1DOjp0ZW1wbGF0ZQog
ICAgICAgICAgICAgICAgICAgIF9Db25zdHJ1Y3RpYmxlVHVwbGU8X1UxLCBfVTI+KCkKICAgICAg
ICAgICAgICAgICAgJiYgX1RNQzo6dGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICBfSW1wbGlj
aXRseUNvbnZlcnRpYmxlVHVwbGU8X1UxLCBfVTI+KCksCiBib29sPjo6dHlwZSA9IHRydWU+CiAg
ICAgICAgdHVwbGUoYWxsb2NhdG9yX2FyZ190IF9fdGFnLCBjb25zdCBfQWxsb2MmIF9fYSwKICAg
ICAgIGNvbnN0IHBhaXI8X1UxLCBfVTI+JiBfX2luKQogOiBfSW5oZXJpdGVkKF9fdGFnLCBfX2Es
IF9faW4uZmlyc3QsIF9faW4uc2Vjb25kKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9B
bGxvYywgdHlwZW5hbWUgX1UxLCB0eXBlbmFtZSBfVTIsIHR5cGVuYW1lCiAgICAgICAgZW5hYmxl
X2lmPF9UTUM6OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICAgX0NvbnN0cnVjdGlibGVUdXBs
ZTxfVTEsIF9VMj4oKQogICAgICAgICAgICAgICAgICAmJiAhX1RNQzo6dGVtcGxhdGUKICAgICAg
ICAgICAgICAgICAgICBfSW1wbGljaXRseUNvbnZlcnRpYmxlVHVwbGU8X1UxLCBfVTI+KCksCiBi
b29sPjo6dHlwZSA9IGZhbHNlPgogICAgICAgIGV4cGxpY2l0IHR1cGxlKGFsbG9jYXRvcl9hcmdf
dCBfX3RhZywgY29uc3QgX0FsbG9jJiBfX2EsCiAgICAgICBjb25zdCBwYWlyPF9VMSwgX1UyPiYg
X19pbikKIDogX0luaGVyaXRlZChfX3RhZywgX19hLCBfX2luLmZpcnN0LCBfX2luLnNlY29uZCkg
eyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2MsIHR5cGVuYW1lIF9VMSwgdHlwZW5h
bWUgX1UyLCB0eXBlbmFtZQogICAgICAgIGVuYWJsZV9pZjxfVE1DOjp0ZW1wbGF0ZQogICAgICAg
ICAgICAgICAgICAgIF9Nb3ZlQ29uc3RydWN0aWJsZVR1cGxlPF9VMSwgX1UyPigpCiAgICAgICAg
ICAgICAgICAgICYmIF9UTUM6OnRlbXBsYXRlCiAgICAgICAgICAgICAgICAgICAgX0ltcGxpY2l0
bHlNb3ZlQ29udmVydGlibGVUdXBsZTxfVTEsIF9VMj4oKSwKIGJvb2w+Ojp0eXBlID0gdHJ1ZT4K
ICAgICAgICB0dXBsZShhbGxvY2F0b3JfYXJnX3QgX190YWcsIGNvbnN0IF9BbGxvYyYgX19hLCBw
YWlyPF9VMSwgX1UyPiYmIF9faW4pCiA6IF9Jbmhlcml0ZWQoX190YWcsIF9fYSwgc3RkOjpmb3J3
YXJkPF9VMT4oX19pbi5maXJzdCksCiAgICAgICBzdGQ6OmZvcndhcmQ8X1UyPihfX2luLnNlY29u
ZCkpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZSBfVTEsIHR5
cGVuYW1lIF9VMiwgdHlwZW5hbWUKICAgICAgICBlbmFibGVfaWY8X1RNQzo6dGVtcGxhdGUKICAg
ICAgICAgICAgICAgICAgICBfTW92ZUNvbnN0cnVjdGlibGVUdXBsZTxfVTEsIF9VMj4oKQogICAg
ICAgICAgICAgICAgICAmJiAhX1RNQzo6dGVtcGxhdGUKICAgICAgICAgICAgICAgICAgICBfSW1w
bGljaXRseU1vdmVDb252ZXJ0aWJsZVR1cGxlPF9VMSwgX1UyPigpLAogYm9vbD46OnR5cGUgPSBm
YWxzZT4KICAgICAgICBleHBsaWNpdCB0dXBsZShhbGxvY2F0b3JfYXJnX3QgX190YWcsIGNvbnN0
IF9BbGxvYyYgX19hLAogICAgICAgICAgICAgICAgICAgICAgIHBhaXI8X1UxLCBfVTI+JiYgX19p
bikKIDogX0luaGVyaXRlZChfX3RhZywgX19hLCBzdGQ6OmZvcndhcmQ8X1UxPihfX2luLmZpcnN0
KSwKICAgICAgIHN0ZDo6Zm9yd2FyZDxfVTI+KF9faW4uc2Vjb25kKSkgeyB9CgogICAgICB0dXBs
ZSYKICAgICAgb3BlcmF0b3I9KGNvbnN0IHR1cGxlJiBfX2luKQogICAgICB7CiBzdGF0aWNfY2Fz
dDxfSW5oZXJpdGVkJj4oKnRoaXMpID0gX19pbjsKIHJldHVybiAqdGhpczsKICAgICAgfQoKICAg
ICAgdHVwbGUmCiAgICAgIG9wZXJhdG9yPSh0dXBsZSYmIF9faW4pCiAgICAgIG5vZXhjZXB0KGlz
X25vdGhyb3dfbW92ZV9hc3NpZ25hYmxlPF9Jbmhlcml0ZWQ+Ojp2YWx1ZSkKICAgICAgewogc3Rh
dGljX2Nhc3Q8X0luaGVyaXRlZCY+KCp0aGlzKSA9IHN0ZDo6bW92ZShfX2luKTsKIHJldHVybiAq
dGhpczsKICAgICAgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1UxLCB0eXBlbmFtZSBfVTI+
CiAgICAgICAgdHVwbGUmCiAgICAgICAgb3BlcmF0b3I9KGNvbnN0IHR1cGxlPF9VMSwgX1UyPiYg
X19pbikKICAgICAgICB7CiAgIHN0YXRpY19jYXN0PF9Jbmhlcml0ZWQmPigqdGhpcykgPSBfX2lu
OwogICByZXR1cm4gKnRoaXM7CiB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVTEsIHR5cGVu
YW1lIF9VMj4KICAgICAgICB0dXBsZSYKICAgICAgICBvcGVyYXRvcj0odHVwbGU8X1UxLCBfVTI+
JiYgX19pbikKICAgICAgICB7CiAgIHN0YXRpY19jYXN0PF9Jbmhlcml0ZWQmPigqdGhpcykgPSBz
dGQ6Om1vdmUoX19pbik7CiAgIHJldHVybiAqdGhpczsKIH0KCiAgICAgIHRlbXBsYXRlPHR5cGVu
YW1lIF9VMSwgdHlwZW5hbWUgX1UyPgogICAgICAgIHR1cGxlJgogICAgICAgIG9wZXJhdG9yPShj
b25zdCBwYWlyPF9VMSwgX1UyPiYgX19pbikKICAgICAgICB7CiAgIHRoaXMtPl9NX2hlYWQoKnRo
aXMpID0gX19pbi5maXJzdDsKICAgdGhpcy0+X01fdGFpbCgqdGhpcykuX01faGVhZCgqdGhpcykg
PSBfX2luLnNlY29uZDsKICAgcmV0dXJuICp0aGlzOwogfQoKICAgICAgdGVtcGxhdGU8dHlwZW5h
bWUgX1UxLCB0eXBlbmFtZSBfVTI+CiAgICAgICAgdHVwbGUmCiAgICAgICAgb3BlcmF0b3I9KHBh
aXI8X1UxLCBfVTI+JiYgX19pbikKICAgICAgICB7CiAgIHRoaXMtPl9NX2hlYWQoKnRoaXMpID0g
c3RkOjpmb3J3YXJkPF9VMT4oX19pbi5maXJzdCk7CiAgIHRoaXMtPl9NX3RhaWwoKnRoaXMpLl9N
X2hlYWQoKnRoaXMpID0gc3RkOjpmb3J3YXJkPF9VMj4oX19pbi5zZWNvbmQpOwogICByZXR1cm4g
KnRoaXM7CiB9CgogICAgICB2b2lkCiAgICAgIHN3YXAodHVwbGUmIF9faW4pCiAgICAgIG5vZXhj
ZXB0KG5vZXhjZXB0KF9faW4uX01fc3dhcChfX2luKSkpCiAgICAgIHsgX0luaGVyaXRlZDo6X01f
c3dhcChfX2luKTsgfQogICAgfTsKCgoKCgoKICB0ZW1wbGF0ZTxzdGQ6OnNpemVfdCBfX2ksIHR5
cGVuYW1lIF9IZWFkLCB0eXBlbmFtZS4uLiBfVGFpbD4KICAgIHN0cnVjdCB0dXBsZV9lbGVtZW50
PF9faSwgdHVwbGU8X0hlYWQsIF9UYWlsLi4uPiA+CiAgICA6IHR1cGxlX2VsZW1lbnQ8X19pIC0g
MSwgdHVwbGU8X1RhaWwuLi4+ID4geyB9OwoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSGVhZCwg
dHlwZW5hbWUuLi4gX1RhaWw+CiAgICBzdHJ1Y3QgdHVwbGVfZWxlbWVudDwwLCB0dXBsZTxfSGVh
ZCwgX1RhaWwuLi4+ID4KICAgIHsKICAgICAgdHlwZWRlZiBfSGVhZCB0eXBlOwogICAgfTsKCgog
IHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9FbGVtZW50cz4KICAgIHN0cnVjdCB0dXBsZV9zaXplPHR1
cGxlPF9FbGVtZW50cy4uLj4+CiAgICA6IHB1YmxpYyBpbnRlZ3JhbF9jb25zdGFudDxzdGQ6OnNp
emVfdCwgc2l6ZW9mLi4uKF9FbGVtZW50cyk+IHsgfTsKCiAgdGVtcGxhdGU8c3RkOjpzaXplX3Qg
X19pLCB0eXBlbmFtZSBfSGVhZCwgdHlwZW5hbWUuLi4gX1RhaWw+CiAgICBjb25zdGV4cHIgX0hl
YWQmCiAgICBfX2dldF9oZWxwZXIoX1R1cGxlX2ltcGw8X19pLCBfSGVhZCwgX1RhaWwuLi4+JiBf
X3QpIG5vZXhjZXB0CiAgICB7IHJldHVybiBfVHVwbGVfaW1wbDxfX2ksIF9IZWFkLCBfVGFpbC4u
Lj46Ol9NX2hlYWQoX190KTsgfQoKICB0ZW1wbGF0ZTxzdGQ6OnNpemVfdCBfX2ksIHR5cGVuYW1l
IF9IZWFkLCB0eXBlbmFtZS4uLiBfVGFpbD4KICAgIGNvbnN0ZXhwciBjb25zdCBfSGVhZCYKICAg
IF9fZ2V0X2hlbHBlcihjb25zdCBfVHVwbGVfaW1wbDxfX2ksIF9IZWFkLCBfVGFpbC4uLj4mIF9f
dCkgbm9leGNlcHQKICAgIHsgcmV0dXJuIF9UdXBsZV9pbXBsPF9faSwgX0hlYWQsIF9UYWlsLi4u
Pjo6X01faGVhZChfX3QpOyB9CgoKICB0ZW1wbGF0ZTxzdGQ6OnNpemVfdCBfX2ksIHR5cGVuYW1l
Li4uIF9FbGVtZW50cz4KICAgIGNvbnN0ZXhwciBfX3R1cGxlX2VsZW1lbnRfdDxfX2ksIHR1cGxl
PF9FbGVtZW50cy4uLj4+JgogICAgZ2V0KHR1cGxlPF9FbGVtZW50cy4uLj4mIF9fdCkgbm9leGNl
cHQKICAgIHsgcmV0dXJuIHN0ZDo6X19nZXRfaGVscGVyPF9faT4oX190KTsgfQoKCiAgdGVtcGxh
dGU8c3RkOjpzaXplX3QgX19pLCB0eXBlbmFtZS4uLiBfRWxlbWVudHM+CiAgICBjb25zdGV4cHIg
Y29uc3QgX190dXBsZV9lbGVtZW50X3Q8X19pLCB0dXBsZTxfRWxlbWVudHMuLi4+PiYKICAgIGdl
dChjb25zdCB0dXBsZTxfRWxlbWVudHMuLi4+JiBfX3QpIG5vZXhjZXB0CiAgICB7IHJldHVybiBz
dGQ6Ol9fZ2V0X2hlbHBlcjxfX2k+KF9fdCk7IH0KCgogIHRlbXBsYXRlPHN0ZDo6c2l6ZV90IF9f
aSwgdHlwZW5hbWUuLi4gX0VsZW1lbnRzPgogICAgY29uc3RleHByIF9fdHVwbGVfZWxlbWVudF90
PF9faSwgdHVwbGU8X0VsZW1lbnRzLi4uPj4mJgogICAgZ2V0KHR1cGxlPF9FbGVtZW50cy4uLj4m
JiBfX3QpIG5vZXhjZXB0CiAgICB7CiAgICAgIHR5cGVkZWYgX190dXBsZV9lbGVtZW50X3Q8X19p
LCB0dXBsZTxfRWxlbWVudHMuLi4+PiBfX2VsZW1lbnRfdHlwZTsKICAgICAgcmV0dXJuIHN0ZDo6
Zm9yd2FyZDxfX2VsZW1lbnRfdHlwZSYmPihzdGQ6OmdldDxfX2k+KF9fdCkpOwogICAgfQojIDEy
ODcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdHVwbGUiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHAsIHR5cGVuYW1lIF9VcCwgc2l6ZV90IF9faSwgc2l6ZV90IF9fc2l6ZT4KICAgIHN0cnVjdCBf
X3R1cGxlX2NvbXBhcmUKICAgIHsKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sCiAgICAgIF9f
ZXEoY29uc3QgX1RwJiBfX3QsIGNvbnN0IF9VcCYgX191KQogICAgICB7CiByZXR1cm4gYm9vbChz
dGQ6OmdldDxfX2k+KF9fdCkgPT0gc3RkOjpnZXQ8X19pPihfX3UpKQogICAmJiBfX3R1cGxlX2Nv
bXBhcmU8X1RwLCBfVXAsIF9faSArIDEsIF9fc2l6ZT46Ol9fZXEoX190LCBfX3UpOwogICAgICB9
CgogICAgICBzdGF0aWMgY29uc3RleHByIGJvb2wKICAgICAgX19sZXNzKGNvbnN0IF9UcCYgX190
LCBjb25zdCBfVXAmIF9fdSkKICAgICAgewogcmV0dXJuIGJvb2woc3RkOjpnZXQ8X19pPihfX3Qp
IDwgc3RkOjpnZXQ8X19pPihfX3UpKQogICB8fCAoIWJvb2woc3RkOjpnZXQ8X19pPihfX3UpIDwg
c3RkOjpnZXQ8X19pPihfX3QpKQogICAgICAgJiYgX190dXBsZV9jb21wYXJlPF9UcCwgX1VwLCBf
X2kgKyAxLCBfX3NpemU+OjpfX2xlc3MoX190LCBfX3UpKTsKICAgICAgfQogICAgfTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfVXAsIHNpemVfdCBfX3NpemU+CiAgICBzdHJ1
Y3QgX190dXBsZV9jb21wYXJlPF9UcCwgX1VwLCBfX3NpemUsIF9fc2l6ZT4KICAgIHsKICAgICAg
c3RhdGljIGNvbnN0ZXhwciBib29sCiAgICAgIF9fZXEoY29uc3QgX1RwJiwgY29uc3QgX1VwJikg
eyByZXR1cm4gdHJ1ZTsgfQoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBib29sCiAgICAgIF9fbGVz
cyhjb25zdCBfVHAmLCBjb25zdCBfVXAmKSB7IHJldHVybiBmYWxzZTsgfQogICAgfTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUuLi4gX1RFbGVtZW50cywgdHlwZW5hbWUuLi4gX1VFbGVtZW50cz4KICAg
IGNvbnN0ZXhwciBib29sCiAgICBvcGVyYXRvcj09KGNvbnN0IHR1cGxlPF9URWxlbWVudHMuLi4+
JiBfX3QsCiAgICAgICAgY29uc3QgdHVwbGU8X1VFbGVtZW50cy4uLj4mIF9fdSkKICAgIHsKICAg
ICAgc3RhdGljX2Fzc2VydChzaXplb2YuLi4oX1RFbGVtZW50cykgPT0gc2l6ZW9mLi4uKF9VRWxl
bWVudHMpLAogICAidHVwbGUgb2JqZWN0cyBjYW4gb25seSBiZSBjb21wYXJlZCBpZiB0aGV5IGhh
dmUgZXF1YWwgc2l6ZXMuIik7CiAgICAgIHVzaW5nIF9fY29tcGFyZSA9IF9fdHVwbGVfY29tcGFy
ZTx0dXBsZTxfVEVsZW1lbnRzLi4uPiwKICAgICB0dXBsZTxfVUVsZW1lbnRzLi4uPiwKICAgICAw
LCBzaXplb2YuLi4oX1RFbGVtZW50cyk+OwogICAgICByZXR1cm4gX19jb21wYXJlOjpfX2VxKF9f
dCwgX191KTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1RFbGVtZW50cywgdHlwZW5h
bWUuLi4gX1VFbGVtZW50cz4KICAgIGNvbnN0ZXhwciBib29sCiAgICBvcGVyYXRvcjwoY29uc3Qg
dHVwbGU8X1RFbGVtZW50cy4uLj4mIF9fdCwKICAgICAgIGNvbnN0IHR1cGxlPF9VRWxlbWVudHMu
Li4+JiBfX3UpCiAgICB7CiAgICAgIHN0YXRpY19hc3NlcnQoc2l6ZW9mLi4uKF9URWxlbWVudHMp
ID09IHNpemVvZi4uLihfVUVsZW1lbnRzKSwKICAgInR1cGxlIG9iamVjdHMgY2FuIG9ubHkgYmUg
Y29tcGFyZWQgaWYgdGhleSBoYXZlIGVxdWFsIHNpemVzLiIpOwogICAgICB1c2luZyBfX2NvbXBh
cmUgPSBfX3R1cGxlX2NvbXBhcmU8dHVwbGU8X1RFbGVtZW50cy4uLj4sCiAgICAgdHVwbGU8X1VF
bGVtZW50cy4uLj4sCiAgICAgMCwgc2l6ZW9mLi4uKF9URWxlbWVudHMpPjsKICAgICAgcmV0dXJu
IF9fY29tcGFyZTo6X19sZXNzKF9fdCwgX191KTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUu
Li4gX1RFbGVtZW50cywgdHlwZW5hbWUuLi4gX1VFbGVtZW50cz4KICAgIGNvbnN0ZXhwciBib29s
CiAgICBvcGVyYXRvciE9KGNvbnN0IHR1cGxlPF9URWxlbWVudHMuLi4+JiBfX3QsCiAgICAgICAg
Y29uc3QgdHVwbGU8X1VFbGVtZW50cy4uLj4mIF9fdSkKICAgIHsgcmV0dXJuICEoX190ID09IF9f
dSk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1RFbGVtZW50cywgdHlwZW5hbWUuLi4gX1VF
bGVtZW50cz4KICAgIGNvbnN0ZXhwciBib29sCiAgICBvcGVyYXRvcj4oY29uc3QgdHVwbGU8X1RF
bGVtZW50cy4uLj4mIF9fdCwKICAgICAgIGNvbnN0IHR1cGxlPF9VRWxlbWVudHMuLi4+JiBfX3Up
CiAgICB7IHJldHVybiBfX3UgPCBfX3Q7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1RFbGVt
ZW50cywgdHlwZW5hbWUuLi4gX1VFbGVtZW50cz4KICAgIGNvbnN0ZXhwciBib29sCiAgICBvcGVy
YXRvcjw9KGNvbnN0IHR1cGxlPF9URWxlbWVudHMuLi4+JiBfX3QsCiAgICAgICAgY29uc3QgdHVw
bGU8X1VFbGVtZW50cy4uLj4mIF9fdSkKICAgIHsgcmV0dXJuICEoX191IDwgX190KTsgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfVEVsZW1lbnRzLCB0eXBlbmFtZS4uLiBfVUVsZW1lbnRzPgog
ICAgY29uc3RleHByIGJvb2wKICAgIG9wZXJhdG9yPj0oY29uc3QgdHVwbGU8X1RFbGVtZW50cy4u
Lj4mIF9fdCwKICAgICAgICBjb25zdCB0dXBsZTxfVUVsZW1lbnRzLi4uPiYgX191KQogICAgeyBy
ZXR1cm4gIShfX3QgPCBfX3UpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfRWxlbWVudHM+
CiAgICBjb25zdGV4cHIgdHVwbGU8dHlwZW5hbWUgX19kZWNheV9hbmRfc3RyaXA8X0VsZW1lbnRz
Pjo6X190eXBlLi4uPgogICAgbWFrZV90dXBsZShfRWxlbWVudHMmJi4uLiBfX2FyZ3MpCiAgICB7
CiAgICAgIHR5cGVkZWYgdHVwbGU8dHlwZW5hbWUgX19kZWNheV9hbmRfc3RyaXA8X0VsZW1lbnRz
Pjo6X190eXBlLi4uPgogX19yZXN1bHRfdHlwZTsKICAgICAgcmV0dXJuIF9fcmVzdWx0X3R5cGUo
c3RkOjpmb3J3YXJkPF9FbGVtZW50cz4oX19hcmdzKS4uLik7CiAgICB9CgoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUuLi4gX0VsZW1lbnRzPgogICAgY29uc3RleHByIHR1cGxlPF9FbGVtZW50cyYmLi4u
PgogICAgZm9yd2FyZF9hc190dXBsZShfRWxlbWVudHMmJi4uLiBfX2FyZ3MpIG5vZXhjZXB0CiAg
ICB7IHJldHVybiB0dXBsZTxfRWxlbWVudHMmJi4uLj4oc3RkOjpmb3J3YXJkPF9FbGVtZW50cz4o
X19hcmdzKS4uLik7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1Rwcz4KICAgIHN0cnVjdCBf
X2lzX3R1cGxlX2xpa2VfaW1wbDx0dXBsZTxfVHBzLi4uPj4gOiB0cnVlX3R5cGUKICAgIHsgfTsK
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfX2lzX3R1cGxlX2xpa2UKICAg
IDogcHVibGljIF9faXNfdHVwbGVfbGlrZV9pbXBsPHR5cGVuYW1lIHN0ZDo6cmVtb3ZlX2N2CiAg
ICAgICAgICAgIDx0eXBlbmFtZSBzdGQ6OnJlbW92ZV9yZWZlcmVuY2U8X1RwPjo6dHlwZT46OnR5
cGU+Ojp0eXBlCiAgICB7IH07CgogIHRlbXBsYXRlPHNpemVfdCwgdHlwZW5hbWUsIHR5cGVuYW1l
LCBzaXplX3Q+CiAgICBzdHJ1Y3QgX19tYWtlX3R1cGxlX2ltcGw7CgogIHRlbXBsYXRlPHNpemVf
dCBfSWR4LCB0eXBlbmFtZSBfVHVwbGUsIHR5cGVuYW1lLi4uIF9UcCwgc2l6ZV90IF9ObT4KICAg
IHN0cnVjdCBfX21ha2VfdHVwbGVfaW1wbDxfSWR4LCB0dXBsZTxfVHAuLi4+LCBfVHVwbGUsIF9O
bT4KICAgIDogX19tYWtlX3R1cGxlX2ltcGw8X0lkeCArIDEsCiAgIHR1cGxlPF9UcC4uLiwgX190
dXBsZV9lbGVtZW50X3Q8X0lkeCwgX1R1cGxlPj4sCiAgIF9UdXBsZSwgX05tPgogICAgeyB9OwoK
ICB0ZW1wbGF0ZTxzdGQ6OnNpemVfdCBfTm0sIHR5cGVuYW1lIF9UdXBsZSwgdHlwZW5hbWUuLi4g
X1RwPgogICAgc3RydWN0IF9fbWFrZV90dXBsZV9pbXBsPF9ObSwgdHVwbGU8X1RwLi4uPiwgX1R1
cGxlLCBfTm0+CiAgICB7CiAgICAgIHR5cGVkZWYgdHVwbGU8X1RwLi4uPiBfX3R5cGU7CiAgICB9
OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHVwbGU+CiAgICBzdHJ1Y3QgX19kb19tYWtlX3R1cGxl
CiAgICA6IF9fbWFrZV90dXBsZV9pbXBsPDAsIHR1cGxlPD4sIF9UdXBsZSwgc3RkOjp0dXBsZV9z
aXplPF9UdXBsZT46OnZhbHVlPgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1R1cGxl
PgogICAgc3RydWN0IF9fbWFrZV90dXBsZQogICAgOiBwdWJsaWMgX19kb19tYWtlX3R1cGxlPHR5
cGVuYW1lIHN0ZDo6cmVtb3ZlX2N2CiAgICAgICAgICAgIDx0eXBlbmFtZSBzdGQ6OnJlbW92ZV9y
ZWZlcmVuY2U8X1R1cGxlPjo6dHlwZT46OnR5cGU+CiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBl
bmFtZS4uLj4KICAgIHN0cnVjdCBfX2NvbWJpbmVfdHVwbGVzOwoKICB0ZW1wbGF0ZTw+CiAgICBz
dHJ1Y3QgX19jb21iaW5lX3R1cGxlczw+CiAgICB7CiAgICAgIHR5cGVkZWYgdHVwbGU8PiBfX3R5
cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfVHM+CiAgICBzdHJ1Y3QgX19jb21i
aW5lX3R1cGxlczx0dXBsZTxfVHMuLi4+PgogICAgewogICAgICB0eXBlZGVmIHR1cGxlPF9Ucy4u
Lj4gX190eXBlOwogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1QxcywgdHlwZW5hbWUu
Li4gX1QycywgdHlwZW5hbWUuLi4gX1JlbT4KICAgIHN0cnVjdCBfX2NvbWJpbmVfdHVwbGVzPHR1
cGxlPF9UMXMuLi4+LCB0dXBsZTxfVDJzLi4uPiwgX1JlbS4uLj4KICAgIHsKICAgICAgdHlwZWRl
ZiB0eXBlbmFtZSBfX2NvbWJpbmVfdHVwbGVzPHR1cGxlPF9UMXMuLi4sIF9UMnMuLi4+LAogICAg
IF9SZW0uLi4+OjpfX3R5cGUgX190eXBlOwogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lLi4u
IF9UcGxzPgogICAgc3RydWN0IF9fdHVwbGVfY2F0X3Jlc3VsdAogICAgewogICAgICB0eXBlZGVm
IHR5cGVuYW1lIF9fY29tYmluZV90dXBsZXMKICAgICAgICA8dHlwZW5hbWUgX19tYWtlX3R1cGxl
PF9UcGxzPjo6X190eXBlLi4uPjo6X190eXBlIF9fdHlwZTsKICAgIH07CgoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUuLi4+CiAgICBzdHJ1Y3QgX19tYWtlXzFzdF9pbmRpY2VzOwoKICB0ZW1wbGF0ZTw+
CiAgICBzdHJ1Y3QgX19tYWtlXzFzdF9pbmRpY2VzPD4KICAgIHsKICAgICAgdHlwZWRlZiBzdGQ6
Ol9JbmRleF90dXBsZTw+IF9fdHlwZTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwg
dHlwZW5hbWUuLi4gX1RwbHM+CiAgICBzdHJ1Y3QgX19tYWtlXzFzdF9pbmRpY2VzPF9UcCwgX1Rw
bHMuLi4+CiAgICB7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgc3RkOjpfQnVpbGRfaW5kZXhfdHVw
bGU8c3RkOjp0dXBsZV9zaXplPAogdHlwZW5hbWUgc3RkOjpyZW1vdmVfcmVmZXJlbmNlPF9UcD46
OnR5cGU+Ojp2YWx1ZT46Ol9fdHlwZSBfX3R5cGU7CiAgICB9OwoKCgoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfUmV0LCB0eXBlbmFtZSBfSW5kaWNlcywgdHlwZW5hbWUuLi4gX1RwbHM+CiAgICBzdHJ1
Y3QgX190dXBsZV9jb25jYXRlcjsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JldCwgc3RkOjpzaXpl
X3QuLi4gX0lzLCB0eXBlbmFtZSBfVHAsIHR5cGVuYW1lLi4uIF9UcGxzPgogICAgc3RydWN0IF9f
dHVwbGVfY29uY2F0ZXI8X1JldCwgc3RkOjpfSW5kZXhfdHVwbGU8X0lzLi4uPiwgX1RwLCBfVHBs
cy4uLj4KICAgIHsKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1VzPgogICAgICAgIHN0YXRp
YyBjb25zdGV4cHIgX1JldAogICAgICAgIF9TX2RvKF9UcCYmIF9fdHAsIF9UcGxzJiYuLi4gX190
cHMsIF9VcyYmLi4uIF9fdXMpCiAgICAgICAgewogICB0eXBlZGVmIHR5cGVuYW1lIF9fbWFrZV8x
c3RfaW5kaWNlczxfVHBscy4uLj46Ol9fdHlwZSBfX2lkeDsKICAgdHlwZWRlZiBfX3R1cGxlX2Nv
bmNhdGVyPF9SZXQsIF9faWR4LCBfVHBscy4uLj4gX19uZXh0OwogICByZXR1cm4gX19uZXh0Ojpf
U19kbyhzdGQ6OmZvcndhcmQ8X1RwbHM+KF9fdHBzKS4uLiwKICAgICAgICAgIHN0ZDo6Zm9yd2Fy
ZDxfVXM+KF9fdXMpLi4uLAogICAgICAgICAgc3RkOjpnZXQ8X0lzPihzdGQ6OmZvcndhcmQ8X1Rw
PihfX3RwKSkuLi4pOwogfQogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JldD4KICAgIHN0
cnVjdCBfX3R1cGxlX2NvbmNhdGVyPF9SZXQsIHN0ZDo6X0luZGV4X3R1cGxlPD4+CiAgICB7CiAg
ICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9Vcz4KIHN0YXRpYyBjb25zdGV4cHIgX1JldAogX1Nf
ZG8oX1VzJiYuLi4gX191cykKICAgICAgICB7CiAgIHJldHVybiBfUmV0KHN0ZDo6Zm9yd2FyZDxf
VXM+KF9fdXMpLi4uKTsKIH0KICAgIH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfVHBscywg
dHlwZW5hbWUgPSB0eXBlbmFtZQogICAgICAgICAgIGVuYWJsZV9pZjxfX2FuZF88X19pc190dXBs
ZV9saWtlPF9UcGxzPi4uLj46OnZhbHVlPjo6dHlwZT4KICAgIGNvbnN0ZXhwciBhdXRvCiAgICB0
dXBsZV9jYXQoX1RwbHMmJi4uLiBfX3RwbHMpCiAgICAtPiB0eXBlbmFtZSBfX3R1cGxlX2NhdF9y
ZXN1bHQ8X1RwbHMuLi4+OjpfX3R5cGUKICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX3R1
cGxlX2NhdF9yZXN1bHQ8X1RwbHMuLi4+OjpfX3R5cGUgX19yZXQ7CiAgICAgIHR5cGVkZWYgdHlw
ZW5hbWUgX19tYWtlXzFzdF9pbmRpY2VzPF9UcGxzLi4uPjo6X190eXBlIF9faWR4OwogICAgICB0
eXBlZGVmIF9fdHVwbGVfY29uY2F0ZXI8X19yZXQsIF9faWR4LCBfVHBscy4uLj4gX19jb25jYXRl
cjsKICAgICAgcmV0dXJuIF9fY29uY2F0ZXI6Ol9TX2RvKHN0ZDo6Zm9yd2FyZDxfVHBscz4oX190
cGxzKS4uLik7CiAgICB9CgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9FbGVtZW50cz4KICAg
IGNvbnN0ZXhwciB0dXBsZTxfRWxlbWVudHMmLi4uPgogICAgdGllKF9FbGVtZW50cyYuLi4gX19h
cmdzKSBub2V4Y2VwdAogICAgeyByZXR1cm4gdHVwbGU8X0VsZW1lbnRzJi4uLj4oX19hcmdzLi4u
KTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX0VsZW1lbnRzPgogICAgaW5saW5lIHZvaWQK
ICAgIHN3YXAodHVwbGU8X0VsZW1lbnRzLi4uPiYgX194LCB0dXBsZTxfRWxlbWVudHMuLi4+JiBf
X3kpCiAgICBub2V4Y2VwdChub2V4Y2VwdChfX3guc3dhcChfX3kpKSkKICAgIHsgX194LnN3YXAo
X195KTsgfQoKCgogIHN0cnVjdCBfU3dhbGxvd19hc3NpZ24KICB7CiAgICB0ZW1wbGF0ZTxjbGFz
cyBfVHA+CiAgICAgIGNvbnN0IF9Td2FsbG93X2Fzc2lnbiYKICAgICAgb3BlcmF0b3I9KGNvbnN0
IF9UcCYpIGNvbnN0CiAgICAgIHsgcmV0dXJuICp0aGlzOyB9CiAgfTsKCiAgY29uc3QgX1N3YWxs
b3dfYXNzaWduIGlnbm9yZXt9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX1R5cGVzLCB0eXBl
bmFtZSBfQWxsb2M+CiAgICBzdHJ1Y3QgdXNlc19hbGxvY2F0b3I8dHVwbGU8X1R5cGVzLi4uPiwg
X0FsbG9jPiA6IHRydWVfdHlwZSB7IH07CgoKICB0ZW1wbGF0ZTxjbGFzcyBfVDEsIGNsYXNzIF9U
Mj4KICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzMSwgdHlwZW5hbWUuLi4gX0FyZ3MyPgog
ICAgICBpbmxpbmUKICAgICAgcGFpcjxfVDEsIF9UMj46OgogICAgICBwYWlyKHBpZWNld2lzZV9j
b25zdHJ1Y3RfdCwKICAgIHR1cGxlPF9BcmdzMS4uLj4gX19maXJzdCwgdHVwbGU8X0FyZ3MyLi4u
PiBfX3NlY29uZCkKICAgICAgOiBwYWlyKF9fZmlyc3QsIF9fc2Vjb25kLAogICAgICB0eXBlbmFt
ZSBfQnVpbGRfaW5kZXhfdHVwbGU8c2l6ZW9mLi4uKF9BcmdzMSk+OjpfX3R5cGUoKSwKICAgICAg
dHlwZW5hbWUgX0J1aWxkX2luZGV4X3R1cGxlPHNpemVvZi4uLihfQXJnczIpPjo6X190eXBlKCkp
CiAgICAgIHsgfQoKICB0ZW1wbGF0ZTxjbGFzcyBfVDEsIGNsYXNzIF9UMj4KICAgIHRlbXBsYXRl
PHR5cGVuYW1lLi4uIF9BcmdzMSwgc3RkOjpzaXplX3QuLi4gX0luZGV4ZXMxLAogICAgICAgICAg
ICAgdHlwZW5hbWUuLi4gX0FyZ3MyLCBzdGQ6OnNpemVfdC4uLiBfSW5kZXhlczI+CiAgICAgIGlu
bGluZQogICAgICBwYWlyPF9UMSwgX1QyPjo6CiAgICAgIHBhaXIodHVwbGU8X0FyZ3MxLi4uPiYg
X190dXBsZTEsIHR1cGxlPF9BcmdzMi4uLj4mIF9fdHVwbGUyLAogICAgX0luZGV4X3R1cGxlPF9J
bmRleGVzMS4uLj4sIF9JbmRleF90dXBsZTxfSW5kZXhlczIuLi4+KQogICAgICA6IGZpcnN0KHN0
ZDo6Zm9yd2FyZDxfQXJnczE+KHN0ZDo6Z2V0PF9JbmRleGVzMT4oX190dXBsZTEpKS4uLiksCiAg
ICAgICAgc2Vjb25kKHN0ZDo6Zm9yd2FyZDxfQXJnczI+KHN0ZDo6Z2V0PF9JbmRleGVzMj4oX190
dXBsZTIpKS4uLikKICAgICAgeyB9CgoKCgp9CiMgNTYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
ZnVuY3Rpb25hbCIgMiAzCgoKCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2li
aWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9NZW1iZXJQb2lu
dGVyPgogICAgY2xhc3MgX01lbV9mbjsKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1l
IF9DbGFzcz4KICAgIF9NZW1fZm48X1RwIF9DbGFzczo6Kj4KICAgIG1lbV9mbihfVHAgX0NsYXNz
OjoqKSBub2V4Y2VwdDsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GdW5jdG9yLCB0eXBlbmFtZSA9
IF9fdm9pZF90PD4+CiAgICBzdHJ1Y3QgX01heWJlX2dldF9yZXN1bHRfdHlwZQogICAgeyB9OwoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnVuY3Rvcj4KICAgIHN0cnVjdCBfTWF5YmVfZ2V0X3Jlc3Vs
dF90eXBlPF9GdW5jdG9yLAogICAgICBfX3ZvaWRfdDx0eXBlbmFtZSBfRnVuY3Rvcjo6cmVzdWx0
X3R5cGU+PgogICAgeyB0eXBlZGVmIHR5cGVuYW1lIF9GdW5jdG9yOjpyZXN1bHRfdHlwZSByZXN1
bHRfdHlwZTsgfTsKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GdW5jdG9yPgogICAgc3RydWN0
IF9XZWFrX3Jlc3VsdF90eXBlX2ltcGwKICAgIDogX01heWJlX2dldF9yZXN1bHRfdHlwZTxfRnVu
Y3Rvcj4KICAgIHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9B
cmdUeXBlcz4KICAgIHN0cnVjdCBfV2Vha19yZXN1bHRfdHlwZV9pbXBsPF9SZXMoX0FyZ1R5cGVz
Li4uKT4KICAgIHsgdHlwZWRlZiBfUmVzIHJlc3VsdF90eXBlOyB9OwoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+CiAgICBzdHJ1Y3QgX1dlYWtfcmVzdWx0
X3R5cGVfaW1wbDxfUmVzKF9BcmdUeXBlcy4uLi4uLik+CiAgICB7IHR5cGVkZWYgX1JlcyByZXN1
bHRfdHlwZTsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUuLi4gX0FyZ1R5
cGVzPgogICAgc3RydWN0IF9XZWFrX3Jlc3VsdF90eXBlX2ltcGw8X1JlcyhfQXJnVHlwZXMuLi4p
IGNvbnN0PgogICAgeyB0eXBlZGVmIF9SZXMgcmVzdWx0X3R5cGU7IH07CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIHN0cnVjdCBfV2Vha19yZXN1
bHRfdHlwZV9pbXBsPF9SZXMoX0FyZ1R5cGVzLi4uLi4uKSBjb25zdD4KICAgIHsgdHlwZWRlZiBf
UmVzIHJlc3VsdF90eXBlOyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4u
LiBfQXJnVHlwZXM+CiAgICBzdHJ1Y3QgX1dlYWtfcmVzdWx0X3R5cGVfaW1wbDxfUmVzKF9BcmdU
eXBlcy4uLikgdm9sYXRpbGU+CiAgICB7IHR5cGVkZWYgX1JlcyByZXN1bHRfdHlwZTsgfTsKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPgogICAgc3RydWN0
IF9XZWFrX3Jlc3VsdF90eXBlX2ltcGw8X1JlcyhfQXJnVHlwZXMuLi4uLi4pIHZvbGF0aWxlPgog
ICAgeyB0eXBlZGVmIF9SZXMgcmVzdWx0X3R5cGU7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9S
ZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIHN0cnVjdCBfV2Vha19yZXN1bHRfdHlwZV9p
bXBsPF9SZXMoX0FyZ1R5cGVzLi4uKSBjb25zdCB2b2xhdGlsZT4KICAgIHsgdHlwZWRlZiBfUmVz
IHJlc3VsdF90eXBlOyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBf
QXJnVHlwZXM+CiAgICBzdHJ1Y3QgX1dlYWtfcmVzdWx0X3R5cGVfaW1wbDxfUmVzKF9BcmdUeXBl
cy4uLi4uLikgY29uc3Qgdm9sYXRpbGU+CiAgICB7IHR5cGVkZWYgX1JlcyByZXN1bHRfdHlwZTsg
fTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAg
IHN0cnVjdCBfV2Vha19yZXN1bHRfdHlwZV9pbXBsPF9SZXMoJikoX0FyZ1R5cGVzLi4uKT4KICAg
IHsgdHlwZWRlZiBfUmVzIHJlc3VsdF90eXBlOyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVz
LCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+CiAgICBzdHJ1Y3QgX1dlYWtfcmVzdWx0X3R5cGVfaW1w
bDxfUmVzKCYpKF9BcmdUeXBlcy4uLi4uLik+CiAgICB7IHR5cGVkZWYgX1JlcyByZXN1bHRfdHlw
ZTsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4K
ICAgIHN0cnVjdCBfV2Vha19yZXN1bHRfdHlwZV9pbXBsPF9SZXMoKikoX0FyZ1R5cGVzLi4uKT4K
ICAgIHsgdHlwZWRlZiBfUmVzIHJlc3VsdF90eXBlOyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
UmVzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+CiAgICBzdHJ1Y3QgX1dlYWtfcmVzdWx0X3R5cGVf
aW1wbDxfUmVzKCopKF9BcmdUeXBlcy4uLi4uLik+CiAgICB7IHR5cGVkZWYgX1JlcyByZXN1bHRf
dHlwZTsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlw
ZW5hbWUuLi4gX0FyZ1R5cGVzPgogICAgc3RydWN0IF9XZWFrX3Jlc3VsdF90eXBlX2ltcGw8X1Jl
cyAoX0NsYXNzOjoqKShfQXJnVHlwZXMuLi4pPgogICAgeyB0eXBlZGVmIF9SZXMgcmVzdWx0X3R5
cGU7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlwZW5h
bWUuLi4gX0FyZ1R5cGVzPgogICAgc3RydWN0IF9XZWFrX3Jlc3VsdF90eXBlX2ltcGw8X1JlcyAo
X0NsYXNzOjoqKShfQXJnVHlwZXMuLi4uLi4pPgogICAgeyB0eXBlZGVmIF9SZXMgcmVzdWx0X3R5
cGU7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfQ2xhc3MsIHR5cGVu
YW1lLi4uIF9BcmdUeXBlcz4KICAgIHN0cnVjdCBfV2Vha19yZXN1bHRfdHlwZV9pbXBsPF9SZXMg
KF9DbGFzczo6KikoX0FyZ1R5cGVzLi4uKSBjb25zdD4KICAgIHsgdHlwZWRlZiBfUmVzIHJlc3Vs
dF90eXBlOyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfQ2xhc3MsIHR5
cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIHN0cnVjdCBfV2Vha19yZXN1bHRfdHlwZV9pbXBsPF9S
ZXMgKF9DbGFzczo6KikoX0FyZ1R5cGVzLi4uLi4uKSBjb25zdD4KICAgIHsgdHlwZWRlZiBfUmVz
IHJlc3VsdF90eXBlOyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUgX0Ns
YXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+CiAgICBzdHJ1Y3QgX1dlYWtfcmVzdWx0X3R5cGVf
aW1wbDxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLikgdm9sYXRpbGU+CiAgICB7IHR5cGVk
ZWYgX1JlcyByZXN1bHRfdHlwZTsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5h
bWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+CiAgICBzdHJ1Y3QgX1dlYWtfcmVzdWx0
X3R5cGVfaW1wbDxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLi4uLikgdm9sYXRpbGU+CiAg
ICB7IHR5cGVkZWYgX1JlcyByZXN1bHRfdHlwZTsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9S
ZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPgogICAgc3RydWN0IF9X
ZWFrX3Jlc3VsdF90eXBlX2ltcGw8X1JlcyAoX0NsYXNzOjoqKShfQXJnVHlwZXMuLi4pCiAgICAg
IGNvbnN0IHZvbGF0aWxlPgogICAgeyB0eXBlZGVmIF9SZXMgcmVzdWx0X3R5cGU7IH07CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlwZW5hbWUuLi4gX0FyZ1R5
cGVzPgogICAgc3RydWN0IF9XZWFrX3Jlc3VsdF90eXBlX2ltcGw8X1JlcyAoX0NsYXNzOjoqKShf
QXJnVHlwZXMuLi4uLi4pCiAgICAgIGNvbnN0IHZvbGF0aWxlPgogICAgeyB0eXBlZGVmIF9SZXMg
cmVzdWx0X3R5cGU7IH07CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnVuY3Rvcj4KICAgIHN0
cnVjdCBfV2Vha19yZXN1bHRfdHlwZQogICAgOiBfV2Vha19yZXN1bHRfdHlwZV9pbXBsPHR5cGVu
YW1lIHJlbW92ZV9jdjxfRnVuY3Rvcj46OnR5cGU+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcCwgdHlwZW5hbWUgX1VwID0gdHlwZW5hbWUgZGVjYXk8X1RwPjo6dHlwZT4KICAgIHN0
cnVjdCBfVW53cmFwCiAgICB7CiAgICAgIHVzaW5nIHR5cGUgPSBfVHAmJjsKCgogICAgICBzdGF0
aWMgY29uc3RleHByIF9UcCYmCiAgICAgIF9TX2Z3ZChfVHAmIF9fdCkgbm9leGNlcHQgeyByZXR1
cm4gc3RhdGljX2Nhc3Q8X1RwJiY+KF9fdCk7IH0KICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcCwgdHlwZW5hbWUgX1VwPgogICAgc3RydWN0IF9VbndyYXA8X1RwLCByZWZlcmVuY2Vfd3Jh
cHBlcjxfVXA+PgogICAgewogICAgICB1c2luZyB0eXBlID0gX1VwJjsKCgogICAgICBzdGF0aWMg
X1VwJgogICAgICBfU19md2QoY29uc3QgX1RwJiBfX3QpIG5vZXhjZXB0IHsgX190LmdldCgpOyB9
CiAgICB9OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSB0eXBlbmFtZSBf
VW53cmFwPF9UcD46OnR5cGUKICAgIF9faW52ZndkKHR5cGVuYW1lIHJlbW92ZV9yZWZlcmVuY2U8
X1RwPjo6dHlwZSYgX190KSBub2V4Y2VwdAogICAgeyByZXR1cm4gX1Vud3JhcDxfVHA+OjpfU19m
d2QoX190KTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfRm4sIHR5cGVu
YW1lLi4uIF9BcmdzPgogICAgaW5saW5lIF9SZXMKICAgIF9faW52b2tlX2ltcGwoX19pbnZva2Vf
b3RoZXIsIF9GbiYmIF9fZiwgX0FyZ3MmJi4uLiBfX2FyZ3MpCiAgICBub2V4Y2VwdChub2V4Y2Vw
dChzdGQ6OmZvcndhcmQ8X0ZuPihfX2YpKHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLikp
KQogICAgeyByZXR1cm4gc3RkOjpmb3J3YXJkPF9Gbj4oX19mKShzdGQ6OmZvcndhcmQ8X0FyZ3M+
KF9fYXJncykuLi4pOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9NZW1G
dW4sIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUuLi4gX0FyZ3M+CiAgICBpbmxpbmUgX1JlcwogICAg
X19pbnZva2VfaW1wbChfX2ludm9rZV9tZW1mdW5fcmVmLCBfTWVtRnVuJiYgX19mLCBfVHAmJiBf
X3QsCiAgICBfQXJncyYmLi4uIF9fYXJncykKICAgIG5vZXhjZXB0KG5vZXhjZXB0KAogICAoX19p
bnZmd2Q8X1RwPihfX3QpLipfX2YpKHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLikpKQog
ICAgeyByZXR1cm4gKF9faW52ZndkPF9UcD4oX190KS4qX19mKShzdGQ6OmZvcndhcmQ8X0FyZ3M+
KF9fYXJncykuLi4pOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9NZW1G
dW4sIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUuLi4gX0FyZ3M+CiAgICBpbmxpbmUgX1JlcwogICAg
X19pbnZva2VfaW1wbChfX2ludm9rZV9tZW1mdW5fZGVyZWYsIF9NZW1GdW4mJiBfX2YsIF9UcCYm
IF9fdCwKICAgIF9BcmdzJiYuLi4gX19hcmdzKQogICAgbm9leGNlcHQobm9leGNlcHQoCiAgICgo
KnN0ZDo6Zm9yd2FyZDxfVHA+KF9fdCkpLipfX2YpKHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdz
KS4uLikpKQogICAgewogICAgICByZXR1cm4gKCgqc3RkOjpmb3J3YXJkPF9UcD4oX190KSkuKl9f
Zikoc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1JlcywgdHlwZW5hbWUgX01lbUZ1biwgdHlwZW5hbWUgX1RwLCB0eXBlbmFtZS4uLiBf
QXJncz4KICAgIGlubGluZSBfUmVzCiAgICBfX2ludm9rZV9pbXBsKF9faW52b2tlX21lbW9ial9y
ZWYsIF9NZW1GdW4mJiBfX2YsIF9UcCYmIF9fdCkKICAgIG5vZXhjZXB0KG5vZXhjZXB0KF9faW52
ZndkPF9UcD4oX190KS4qX19mKSkKICAgIHsgcmV0dXJuIF9faW52ZndkPF9UcD4oX190KS4qX19m
OyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9NZW1GdW4sIHR5cGVuYW1l
IF9UcCwgdHlwZW5hbWUuLi4gX0FyZ3M+CiAgICBpbmxpbmUgX1JlcwogICAgX19pbnZva2VfaW1w
bChfX2ludm9rZV9tZW1vYmpfZGVyZWYsIF9NZW1GdW4mJiBfX2YsIF9UcCYmIF9fdCwKICAgIF9B
cmdzJiYuLi4gX19hcmdzKQogICAgbm9leGNlcHQobm9leGNlcHQoKCpzdGQ6OmZvcndhcmQ8X1Rw
PihfX3QpKS4qX19mKSkKICAgIHsgcmV0dXJuICgqc3RkOjpmb3J3YXJkPF9UcD4oX190KSkuKl9f
ZjsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NhbGxhYmxlLCB0eXBlbmFtZS4uLiBfQXJncz4K
ICAgIGlubGluZSB0eXBlbmFtZSByZXN1bHRfb2Y8X0NhbGxhYmxlJiYoX0FyZ3MmJi4uLik+Ojp0
eXBlCiAgICBfX2ludm9rZShfQ2FsbGFibGUmJiBfX2ZuLCBfQXJncyYmLi4uIF9fYXJncykKICAg
IHsKICAgICAgdXNpbmcgX19yZXN1bHRfb2YgPSByZXN1bHRfb2Y8X0NhbGxhYmxlJiYoX0FyZ3Mm
Ji4uLik+OwogICAgICB1c2luZyBfX3R5cGUgPSB0eXBlbmFtZSBfX3Jlc3VsdF9vZjo6dHlwZTsK
ICAgICAgdXNpbmcgX190YWcgPSB0eXBlbmFtZSBfX3Jlc3VsdF9vZjo6X19pbnZva2VfdHlwZTsK
ICAgICAgcmV0dXJuIHN0ZDo6X19pbnZva2VfaW1wbDxfX3R5cGU+KF9fdGFne30sIHN0ZDo6Zm9y
d2FyZDxfQ2FsbGFibGU+KF9fZm4pLAogICAgIHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4u
Lik7CiAgICB9CiMgMjgxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Z1bmN0aW9uYWwiIDMKICB0
ZW1wbGF0ZTxib29sIF9VbmFyeSwgYm9vbCBfQmluYXJ5LCB0eXBlbmFtZSBfVHA+CiAgICBzdHJ1
Y3QgX1JlZmVyZW5jZV93cmFwcGVyX2Jhc2VfaW1wbDsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cD4KICAgIHN0cnVjdCBfUmVmZXJlbmNlX3dyYXBwZXJfYmFzZV9pbXBsPGZhbHNlLCBmYWxzZSwg
X1RwPgogICAgOiBfV2Vha19yZXN1bHRfdHlwZTxfVHA+CiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX1JlZmVyZW5jZV93cmFwcGVyX2Jhc2VfaW1wbDx0cnVl
LCBmYWxzZSwgX1RwPgogICAgOiBfV2Vha19yZXN1bHRfdHlwZTxfVHA+CiAgICB7CiAgICAgIHR5
cGVkZWYgdHlwZW5hbWUgX1RwOjphcmd1bWVudF90eXBlIGFyZ3VtZW50X3R5cGU7CiAgICB9OwoK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9SZWZlcmVuY2Vfd3JhcHBlcl9i
YXNlX2ltcGw8ZmFsc2UsIHRydWUsIF9UcD4KICAgIDogX1dlYWtfcmVzdWx0X3R5cGU8X1RwPgog
ICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9UcDo6Zmlyc3RfYXJndW1lbnRfdHlwZSBmaXJz
dF9hcmd1bWVudF90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9UcDo6c2Vjb25kX2FyZ3Vt
ZW50X3R5cGUgc2Vjb25kX2FyZ3VtZW50X3R5cGU7CiAgICB9OwoKCiAgIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcD4KICAgIHN0cnVjdCBfUmVmZXJlbmNlX3dyYXBwZXJfYmFzZV9pbXBsPHRydWUsIHRy
dWUsIF9UcD4KICAgIDogX1dlYWtfcmVzdWx0X3R5cGU8X1RwPgogICAgewogICAgICB0eXBlZGVm
IHR5cGVuYW1lIF9UcDo6YXJndW1lbnRfdHlwZSBhcmd1bWVudF90eXBlOwogICAgICB0eXBlZGVm
IHR5cGVuYW1lIF9UcDo6Zmlyc3RfYXJndW1lbnRfdHlwZSBmaXJzdF9hcmd1bWVudF90eXBlOwog
ICAgICB0eXBlZGVmIHR5cGVuYW1lIF9UcDo6c2Vjb25kX2FyZ3VtZW50X3R5cGUgc2Vjb25kX2Fy
Z3VtZW50X3R5cGU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lID0g
X192b2lkX3Q8Pj4gc3RydWN0IF9faGFzX2FyZ3VtZW50X3R5cGUgOiBmYWxzZV90eXBlIHsgfTsg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwPiBzdHJ1Y3QgX19oYXNfYXJndW1lbnRfdHlwZTxfVHAsIF9f
dm9pZF90PHR5cGVuYW1lIF9UcDo6YXJndW1lbnRfdHlwZT4+IDogdHJ1ZV90eXBlIHsgfTsKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lID0gX192b2lkX3Q8Pj4gc3RydWN0IF9faGFz
X2ZpcnN0X2FyZ3VtZW50X3R5cGUgOiBmYWxzZV90eXBlIHsgfTsgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwPiBzdHJ1Y3QgX19oYXNfZmlyc3RfYXJndW1lbnRfdHlwZTxfVHAsIF9fdm9pZF90PHR5cGVu
YW1lIF9UcDo6Zmlyc3RfYXJndW1lbnRfdHlwZT4+IDogdHJ1ZV90eXBlIHsgfTsKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lID0gX192b2lkX3Q8Pj4gc3RydWN0IF9faGFzX3NlY29u
ZF9hcmd1bWVudF90eXBlIDogZmFsc2VfdHlwZSB7IH07IHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4g
c3RydWN0IF9faGFzX3NlY29uZF9hcmd1bWVudF90eXBlPF9UcCwgX192b2lkX3Q8dHlwZW5hbWUg
X1RwOjpzZWNvbmRfYXJndW1lbnRfdHlwZT4+IDogdHJ1ZV90eXBlIHsgfTsKCgoKCgoKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9SZWZlcmVuY2Vfd3JhcHBlcl9iYXNlCiAg
ICA6IF9SZWZlcmVuY2Vfd3JhcHBlcl9iYXNlX2ltcGw8CiAgICAgIF9faGFzX2FyZ3VtZW50X3R5
cGU8X1RwPjo6dmFsdWUsCiAgICAgIF9faGFzX2ZpcnN0X2FyZ3VtZW50X3R5cGU8X1RwPjo6dmFs
dWUKICAgICAgJiYgX19oYXNfc2Vjb25kX2FyZ3VtZW50X3R5cGU8X1RwPjo6dmFsdWUsCiAgICAg
IF9UcD4KICAgIHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9UMT4K
ICAgIHN0cnVjdCBfUmVmZXJlbmNlX3dyYXBwZXJfYmFzZTxfUmVzKF9UMSk+CiAgICA6IHVuYXJ5
X2Z1bmN0aW9uPF9UMSwgX1Jlcz4KICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Jlcywg
dHlwZW5hbWUgX1QxPgogICAgc3RydWN0IF9SZWZlcmVuY2Vfd3JhcHBlcl9iYXNlPF9SZXMoX1Qx
KSBjb25zdD4KICAgIDogdW5hcnlfZnVuY3Rpb248X1QxLCBfUmVzPgogICAgeyB9OwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfVDE+CiAgICBzdHJ1Y3QgX1JlZmVyZW5jZV93
cmFwcGVyX2Jhc2U8X1JlcyhfVDEpIHZvbGF0aWxlPgogICAgOiB1bmFyeV9mdW5jdGlvbjxfVDEs
IF9SZXM+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9UMT4K
ICAgIHN0cnVjdCBfUmVmZXJlbmNlX3dyYXBwZXJfYmFzZTxfUmVzKF9UMSkgY29uc3Qgdm9sYXRp
bGU+CiAgICA6IHVuYXJ5X2Z1bmN0aW9uPF9UMSwgX1Jlcz4KICAgIHsgfTsKCgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9UMSwgdHlwZW5hbWUgX1QyPgogICAgc3RydWN0IF9S
ZWZlcmVuY2Vfd3JhcHBlcl9iYXNlPF9SZXMoX1QxLCBfVDIpPgogICAgOiBiaW5hcnlfZnVuY3Rp
b248X1QxLCBfVDIsIF9SZXM+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5
cGVuYW1lIF9UMSwgdHlwZW5hbWUgX1QyPgogICAgc3RydWN0IF9SZWZlcmVuY2Vfd3JhcHBlcl9i
YXNlPF9SZXMoX1QxLCBfVDIpIGNvbnN0PgogICAgOiBiaW5hcnlfZnVuY3Rpb248X1QxLCBfVDIs
IF9SZXM+CiAgICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9UMSwg
dHlwZW5hbWUgX1QyPgogICAgc3RydWN0IF9SZWZlcmVuY2Vfd3JhcHBlcl9iYXNlPF9SZXMoX1Qx
LCBfVDIpIHZvbGF0aWxlPgogICAgOiBiaW5hcnlfZnVuY3Rpb248X1QxLCBfVDIsIF9SZXM+CiAg
ICB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9UMSwgdHlwZW5hbWUg
X1QyPgogICAgc3RydWN0IF9SZWZlcmVuY2Vfd3JhcHBlcl9iYXNlPF9SZXMoX1QxLCBfVDIpIGNv
bnN0IHZvbGF0aWxlPgogICAgOiBiaW5hcnlfZnVuY3Rpb248X1QxLCBfVDIsIF9SZXM+CiAgICB7
IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfVDE+CiAgICBzdHJ1Y3Qg
X1JlZmVyZW5jZV93cmFwcGVyX2Jhc2U8X1JlcygqKShfVDEpPgogICAgOiB1bmFyeV9mdW5jdGlv
bjxfVDEsIF9SZXM+CiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFt
ZSBfVDEsIHR5cGVuYW1lIF9UMj4KICAgIHN0cnVjdCBfUmVmZXJlbmNlX3dyYXBwZXJfYmFzZTxf
UmVzKCopKF9UMSwgX1QyKT4KICAgIDogYmluYXJ5X2Z1bmN0aW9uPF9UMSwgX1QyLCBfUmVzPgog
ICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUgX1QxPgogICAgc3Ry
dWN0IF9SZWZlcmVuY2Vfd3JhcHBlcl9iYXNlPF9SZXMgKF9UMTo6KikoKT4KICAgIDogdW5hcnlf
ZnVuY3Rpb248X1QxKiwgX1Jlcz4KICAgIHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMs
IHR5cGVuYW1lIF9UMSwgdHlwZW5hbWUgX1QyPgogICAgc3RydWN0IF9SZWZlcmVuY2Vfd3JhcHBl
cl9iYXNlPF9SZXMgKF9UMTo6KikoX1QyKT4KICAgIDogYmluYXJ5X2Z1bmN0aW9uPF9UMSosIF9U
MiwgX1Jlcz4KICAgIHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9U
MT4KICAgIHN0cnVjdCBfUmVmZXJlbmNlX3dyYXBwZXJfYmFzZTxfUmVzIChfVDE6OiopKCkgY29u
c3Q+CiAgICA6IHVuYXJ5X2Z1bmN0aW9uPGNvbnN0IF9UMSosIF9SZXM+CiAgICB7IH07CgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfVDEsIHR5cGVuYW1lIF9UMj4KICAgIHN0
cnVjdCBfUmVmZXJlbmNlX3dyYXBwZXJfYmFzZTxfUmVzIChfVDE6OiopKF9UMikgY29uc3Q+CiAg
ICA6IGJpbmFyeV9mdW5jdGlvbjxjb25zdCBfVDEqLCBfVDIsIF9SZXM+CiAgICB7IH07CgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfVDE+CiAgICBzdHJ1Y3QgX1JlZmVyZW5j
ZV93cmFwcGVyX2Jhc2U8X1JlcyAoX1QxOjoqKSgpIHZvbGF0aWxlPgogICAgOiB1bmFyeV9mdW5j
dGlvbjx2b2xhdGlsZSBfVDEqLCBfUmVzPgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1JlcywgdHlwZW5hbWUgX1QxLCB0eXBlbmFtZSBfVDI+CiAgICBzdHJ1Y3QgX1JlZmVyZW5jZV93
cmFwcGVyX2Jhc2U8X1JlcyAoX1QxOjoqKShfVDIpIHZvbGF0aWxlPgogICAgOiBiaW5hcnlfZnVu
Y3Rpb248dm9sYXRpbGUgX1QxKiwgX1QyLCBfUmVzPgogICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1JlcywgdHlwZW5hbWUgX1QxPgogICAgc3RydWN0IF9SZWZlcmVuY2Vfd3JhcHBlcl9i
YXNlPF9SZXMgKF9UMTo6KikoKSBjb25zdCB2b2xhdGlsZT4KICAgIDogdW5hcnlfZnVuY3Rpb248
Y29uc3Qgdm9sYXRpbGUgX1QxKiwgX1Jlcz4KICAgIHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9SZXMsIHR5cGVuYW1lIF9UMSwgdHlwZW5hbWUgX1QyPgogICAgc3RydWN0IF9SZWZlcmVuY2Vf
d3JhcHBlcl9iYXNlPF9SZXMgKF9UMTo6KikoX1QyKSBjb25zdCB2b2xhdGlsZT4KICAgIDogYmlu
YXJ5X2Z1bmN0aW9uPGNvbnN0IHZvbGF0aWxlIF9UMSosIF9UMiwgX1Jlcz4KICAgIHsgfTsKCgoK
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBjbGFzcyByZWZlcmVuY2Vfd3JhcHBlcgog
ICAgOiBwdWJsaWMgX1JlZmVyZW5jZV93cmFwcGVyX2Jhc2U8dHlwZW5hbWUgcmVtb3ZlX2N2PF9U
cD46OnR5cGU+CiAgICB7CiAgICAgIF9UcCogX01fZGF0YTsKCiAgICBwdWJsaWM6CiAgICAgIHR5
cGVkZWYgX1RwIHR5cGU7CgogICAgICByZWZlcmVuY2Vfd3JhcHBlcihfVHAmIF9faW5kYXRhKSBu
b2V4Y2VwdAogICAgICA6IF9NX2RhdGEoc3RkOjpfX2FkZHJlc3NvZihfX2luZGF0YSkpCiAgICAg
IHsgfQoKICAgICAgcmVmZXJlbmNlX3dyYXBwZXIoX1RwJiYpID0gZGVsZXRlOwoKICAgICAgcmVm
ZXJlbmNlX3dyYXBwZXIoY29uc3QgcmVmZXJlbmNlX3dyYXBwZXImKSA9IGRlZmF1bHQ7CgogICAg
ICByZWZlcmVuY2Vfd3JhcHBlciYKICAgICAgb3BlcmF0b3I9KGNvbnN0IHJlZmVyZW5jZV93cmFw
cGVyJikgPSBkZWZhdWx0OwoKICAgICAgb3BlcmF0b3IgX1RwJigpIGNvbnN0IG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuIHRoaXMtPmdldCgpOyB9CgogICAgICBfVHAmCiAgICAgIGdldCgpIGNvbnN0
IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuICpfTV9kYXRhOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBl
bmFtZS4uLiBfQXJncz4KIHR5cGVuYW1lIHJlc3VsdF9vZjxfVHAmKF9BcmdzJiYuLi4pPjo6dHlw
ZQogb3BlcmF0b3IoKShfQXJncyYmLi4uIF9fYXJncykgY29uc3QKIHsKICAgcmV0dXJuIHN0ZDo6
X19pbnZva2UoZ2V0KCksIHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLik7CiB9CiAgICB9
OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSByZWZlcmVuY2Vfd3JhcHBl
cjxfVHA+CiAgICByZWYoX1RwJiBfX3QpIG5vZXhjZXB0CiAgICB7IHJldHVybiByZWZlcmVuY2Vf
d3JhcHBlcjxfVHA+KF9fdCk7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGlu
ZSByZWZlcmVuY2Vfd3JhcHBlcjxjb25zdCBfVHA+CiAgICBjcmVmKGNvbnN0IF9UcCYgX190KSBu
b2V4Y2VwdAogICAgeyByZXR1cm4gcmVmZXJlbmNlX3dyYXBwZXI8Y29uc3QgX1RwPihfX3QpOyB9
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHZvaWQgcmVmKGNvbnN0IF9UcCYmKSA9IGRl
bGV0ZTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgdm9pZCBjcmVmKGNvbnN0IF9UcCYm
KSA9IGRlbGV0ZTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSByZWZlcmVu
Y2Vfd3JhcHBlcjxfVHA+CiAgICByZWYocmVmZXJlbmNlX3dyYXBwZXI8X1RwPiBfX3QpIG5vZXhj
ZXB0CiAgICB7IHJldHVybiByZWYoX190LmdldCgpKTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwPgogICAgaW5saW5lIHJlZmVyZW5jZV93cmFwcGVyPGNvbnN0IF9UcD4KICAgIGNyZWYocmVm
ZXJlbmNlX3dyYXBwZXI8X1RwPiBfX3QpIG5vZXhjZXB0CiAgICB7IHJldHVybiBjcmVmKF9fdC5n
ZXQoKSk7IH0KCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfVHlwZXM+CiAgICBzdHJ1Y3QgX1Bh
Y2sgOiBpbnRlZ3JhbF9jb25zdGFudDxzaXplX3QsIHNpemVvZi4uLihfVHlwZXMpPgogICAgeyB9
OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnJvbSwgdHlwZW5hbWUgX1RvLCBib29sID0gX0Zyb206
OnZhbHVlID09IF9Ubzo6dmFsdWU+CiAgICBzdHJ1Y3QgX0FsbENvbnZlcnRpYmxlIDogZmFsc2Vf
dHlwZQogICAgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfRnJvbSwgdHlwZW5hbWUuLi4g
X1RvPgogICAgc3RydWN0IF9BbGxDb252ZXJ0aWJsZTxfUGFjazxfRnJvbS4uLj4sIF9QYWNrPF9U
by4uLj4sIHRydWU+CiAgICA6IF9fYW5kXzxpc19jb252ZXJ0aWJsZTxfRnJvbSwgX1RvPi4uLj4K
ICAgIHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMSwgdHlwZW5hbWUgX1RwMj4KICAgIHVz
aW5nIF9Ob3RTYW1lID0gX19ub3RfPGlzX3NhbWU8dHlwZW5hbWUgc3RkOjpkZWNheTxfVHAxPjo6
dHlwZSwKICAgICAgICB0eXBlbmFtZSBzdGQ6OmRlY2F5PF9UcDI+Ojp0eXBlPj47CgoKCgoKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPgogICAgc3RydWN0
IF9NYXliZV91bmFyeV9vcl9iaW5hcnlfZnVuY3Rpb24geyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1JlcywgdHlwZW5hbWUgX1QxPgogICAgc3RydWN0IF9NYXliZV91bmFyeV9vcl9iaW5hcnlf
ZnVuY3Rpb248X1JlcywgX1QxPgogICAgOiBzdGQ6OnVuYXJ5X2Z1bmN0aW9uPF9UMSwgX1Jlcz4g
eyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUgX1QxLCB0eXBlbmFtZSBf
VDI+CiAgICBzdHJ1Y3QgX01heWJlX3VuYXJ5X29yX2JpbmFyeV9mdW5jdGlvbjxfUmVzLCBfVDEs
IF9UMj4KICAgIDogc3RkOjpiaW5hcnlfZnVuY3Rpb248X1QxLCBfVDIsIF9SZXM+IHsgfTsKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1NpZ25hdHVyZT4KICAgIHN0cnVjdCBfTWVtX2ZuX3RyYWl0czsK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBf
QXJnVHlwZXM+CiAgICBzdHJ1Y3QgX01lbV9mbl90cmFpdHNfYmFzZQogICAgewogICAgICB1c2lu
ZyBfX3Jlc3VsdF90eXBlID0gX1JlczsKICAgICAgdXNpbmcgX19tYXliZV90eXBlCiA9IF9NYXli
ZV91bmFyeV9vcl9iaW5hcnlfZnVuY3Rpb248X1JlcywgX0NsYXNzKiwgX0FyZ1R5cGVzLi4uPjsK
ICAgICAgdXNpbmcgX19hcml0eSA9IGludGVncmFsX2NvbnN0YW50PHNpemVfdCwgc2l6ZW9mLi4u
KF9BcmdUeXBlcyk+OwogICAgfTsKIyA1NzggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnVuY3Rp
b25hbCIgMwp0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfQ2xhc3MsIHR5cGVuYW1l
Li4uIF9BcmdUeXBlcz4gc3RydWN0IF9NZW1fZm5fdHJhaXRzPF9SZXMgKF9DbGFzczo6KikoX0Fy
Z1R5cGVzLi4uKSA+IDogX01lbV9mbl90cmFpdHNfYmFzZTxfUmVzLCBfQ2xhc3MsIF9BcmdUeXBl
cy4uLj4geyB1c2luZyBfX3ZhcmFyZyA9IGZhbHNlX3R5cGU7IH07IHRlbXBsYXRlPHR5cGVuYW1l
IF9SZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPiBzdHJ1Y3QgX01l
bV9mbl90cmFpdHM8X1JlcyAoX0NsYXNzOjoqKShfQXJnVHlwZXMuLi4gLi4uKSA+IDogX01lbV9m
bl90cmFpdHNfYmFzZTxfUmVzLCBfQ2xhc3MsIF9BcmdUeXBlcy4uLj4geyB1c2luZyBfX3ZhcmFy
ZyA9IHRydWVfdHlwZTsgfTsgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUgX0NsYXNz
LCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+IHN0cnVjdCBfTWVtX2ZuX3RyYWl0czxfUmVzIChfQ2xh
c3M6OiopKF9BcmdUeXBlcy4uLikgY29uc3QgPiA6IF9NZW1fZm5fdHJhaXRzX2Jhc2U8X1Jlcywg
Y29uc3QgX0NsYXNzLCBfQXJnVHlwZXMuLi4+IHsgdXNpbmcgX192YXJhcmcgPSBmYWxzZV90eXBl
OyB9OyB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfQ2xhc3MsIHR5cGVuYW1lLi4u
IF9BcmdUeXBlcz4gc3RydWN0IF9NZW1fZm5fdHJhaXRzPF9SZXMgKF9DbGFzczo6KikoX0FyZ1R5
cGVzLi4uIC4uLikgY29uc3QgPiA6IF9NZW1fZm5fdHJhaXRzX2Jhc2U8X1JlcywgY29uc3QgX0Ns
YXNzLCBfQXJnVHlwZXMuLi4+IHsgdXNpbmcgX192YXJhcmcgPSB0cnVlX3R5cGU7IH07IHRlbXBs
YXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVz
PiBzdHJ1Y3QgX01lbV9mbl90cmFpdHM8X1JlcyAoX0NsYXNzOjoqKShfQXJnVHlwZXMuLi4pIHZv
bGF0aWxlID4gOiBfTWVtX2ZuX3RyYWl0c19iYXNlPF9SZXMsIHZvbGF0aWxlIF9DbGFzcywgX0Fy
Z1R5cGVzLi4uPiB7IHVzaW5nIF9fdmFyYXJnID0gZmFsc2VfdHlwZTsgfTsgdGVtcGxhdGU8dHlw
ZW5hbWUgX1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+IHN0cnVj
dCBfTWVtX2ZuX3RyYWl0czxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLiAuLi4pIHZvbGF0
aWxlID4gOiBfTWVtX2ZuX3RyYWl0c19iYXNlPF9SZXMsIHZvbGF0aWxlIF9DbGFzcywgX0FyZ1R5
cGVzLi4uPiB7IHVzaW5nIF9fdmFyYXJnID0gdHJ1ZV90eXBlOyB9OyB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfUmVzLCB0eXBlbmFtZSBfQ2xhc3MsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4gc3RydWN0IF9N
ZW1fZm5fdHJhaXRzPF9SZXMgKF9DbGFzczo6KikoX0FyZ1R5cGVzLi4uKSBjb25zdCB2b2xhdGls
ZSA+IDogX01lbV9mbl90cmFpdHNfYmFzZTxfUmVzLCBjb25zdCB2b2xhdGlsZSBfQ2xhc3MsIF9B
cmdUeXBlcy4uLj4geyB1c2luZyBfX3ZhcmFyZyA9IGZhbHNlX3R5cGU7IH07IHRlbXBsYXRlPHR5
cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPiBzdHJ1
Y3QgX01lbV9mbl90cmFpdHM8X1JlcyAoX0NsYXNzOjoqKShfQXJnVHlwZXMuLi4gLi4uKSBjb25z
dCB2b2xhdGlsZSA+IDogX01lbV9mbl90cmFpdHNfYmFzZTxfUmVzLCBjb25zdCB2b2xhdGlsZSBf
Q2xhc3MsIF9BcmdUeXBlcy4uLj4geyB1c2luZyBfX3ZhcmFyZyA9IHRydWVfdHlwZTsgfTsKdGVt
cGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlw
ZXM+IHN0cnVjdCBfTWVtX2ZuX3RyYWl0czxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLikg
Jj4gOiBfTWVtX2ZuX3RyYWl0c19iYXNlPF9SZXMsIF9DbGFzcywgX0FyZ1R5cGVzLi4uPiB7IHVz
aW5nIF9fdmFyYXJnID0gZmFsc2VfdHlwZTsgfTsgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlw
ZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+IHN0cnVjdCBfTWVtX2ZuX3RyYWl0
czxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLiAuLi4pICY+IDogX01lbV9mbl90cmFpdHNf
YmFzZTxfUmVzLCBfQ2xhc3MsIF9BcmdUeXBlcy4uLj4geyB1c2luZyBfX3ZhcmFyZyA9IHRydWVf
dHlwZTsgfTsgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFt
ZS4uLiBfQXJnVHlwZXM+IHN0cnVjdCBfTWVtX2ZuX3RyYWl0czxfUmVzIChfQ2xhc3M6OiopKF9B
cmdUeXBlcy4uLikgY29uc3QgJj4gOiBfTWVtX2ZuX3RyYWl0c19iYXNlPF9SZXMsIGNvbnN0IF9D
bGFzcywgX0FyZ1R5cGVzLi4uPiB7IHVzaW5nIF9fdmFyYXJnID0gZmFsc2VfdHlwZTsgfTsgdGVt
cGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlw
ZXM+IHN0cnVjdCBfTWVtX2ZuX3RyYWl0czxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLiAu
Li4pIGNvbnN0ICY+IDogX01lbV9mbl90cmFpdHNfYmFzZTxfUmVzLCBjb25zdCBfQ2xhc3MsIF9B
cmdUeXBlcy4uLj4geyB1c2luZyBfX3ZhcmFyZyA9IHRydWVfdHlwZTsgfTsgdGVtcGxhdGU8dHlw
ZW5hbWUgX1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+IHN0cnVj
dCBfTWVtX2ZuX3RyYWl0czxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLikgdm9sYXRpbGUg
Jj4gOiBfTWVtX2ZuX3RyYWl0c19iYXNlPF9SZXMsIHZvbGF0aWxlIF9DbGFzcywgX0FyZ1R5cGVz
Li4uPiB7IHVzaW5nIF9fdmFyYXJnID0gZmFsc2VfdHlwZTsgfTsgdGVtcGxhdGU8dHlwZW5hbWUg
X1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+IHN0cnVjdCBfTWVt
X2ZuX3RyYWl0czxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLiAuLi4pIHZvbGF0aWxlICY+
IDogX01lbV9mbl90cmFpdHNfYmFzZTxfUmVzLCB2b2xhdGlsZSBfQ2xhc3MsIF9BcmdUeXBlcy4u
Lj4geyB1c2luZyBfX3ZhcmFyZyA9IHRydWVfdHlwZTsgfTsgdGVtcGxhdGU8dHlwZW5hbWUgX1Jl
cywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+IHN0cnVjdCBfTWVtX2Zu
X3RyYWl0czxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLikgY29uc3Qgdm9sYXRpbGUgJj4g
OiBfTWVtX2ZuX3RyYWl0c19iYXNlPF9SZXMsIGNvbnN0IHZvbGF0aWxlIF9DbGFzcywgX0FyZ1R5
cGVzLi4uPiB7IHVzaW5nIF9fdmFyYXJnID0gZmFsc2VfdHlwZTsgfTsgdGVtcGxhdGU8dHlwZW5h
bWUgX1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+IHN0cnVjdCBf
TWVtX2ZuX3RyYWl0czxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLiAuLi4pIGNvbnN0IHZv
bGF0aWxlICY+IDogX01lbV9mbl90cmFpdHNfYmFzZTxfUmVzLCBjb25zdCB2b2xhdGlsZSBfQ2xh
c3MsIF9BcmdUeXBlcy4uLj4geyB1c2luZyBfX3ZhcmFyZyA9IHRydWVfdHlwZTsgfTsKdGVtcGxh
dGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+
IHN0cnVjdCBfTWVtX2ZuX3RyYWl0czxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLikgJiY+
IDogX01lbV9mbl90cmFpdHNfYmFzZTxfUmVzLCBfQ2xhc3MsIF9BcmdUeXBlcy4uLj4geyB1c2lu
ZyBfX3ZhcmFyZyA9IGZhbHNlX3R5cGU7IH07IHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVu
YW1lIF9DbGFzcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPiBzdHJ1Y3QgX01lbV9mbl90cmFpdHM8
X1JlcyAoX0NsYXNzOjoqKShfQXJnVHlwZXMuLi4gLi4uKSAmJj4gOiBfTWVtX2ZuX3RyYWl0c19i
YXNlPF9SZXMsIF9DbGFzcywgX0FyZ1R5cGVzLi4uPiB7IHVzaW5nIF9fdmFyYXJnID0gdHJ1ZV90
eXBlOyB9OyB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZSBfQ2xhc3MsIHR5cGVuYW1l
Li4uIF9BcmdUeXBlcz4gc3RydWN0IF9NZW1fZm5fdHJhaXRzPF9SZXMgKF9DbGFzczo6KikoX0Fy
Z1R5cGVzLi4uKSBjb25zdCAmJj4gOiBfTWVtX2ZuX3RyYWl0c19iYXNlPF9SZXMsIGNvbnN0IF9D
bGFzcywgX0FyZ1R5cGVzLi4uPiB7IHVzaW5nIF9fdmFyYXJnID0gZmFsc2VfdHlwZTsgfTsgdGVt
cGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlw
ZXM+IHN0cnVjdCBfTWVtX2ZuX3RyYWl0czxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLiAu
Li4pIGNvbnN0ICYmPiA6IF9NZW1fZm5fdHJhaXRzX2Jhc2U8X1JlcywgY29uc3QgX0NsYXNzLCBf
QXJnVHlwZXMuLi4+IHsgdXNpbmcgX192YXJhcmcgPSB0cnVlX3R5cGU7IH07IHRlbXBsYXRlPHR5
cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPiBzdHJ1
Y3QgX01lbV9mbl90cmFpdHM8X1JlcyAoX0NsYXNzOjoqKShfQXJnVHlwZXMuLi4pIHZvbGF0aWxl
ICYmPiA6IF9NZW1fZm5fdHJhaXRzX2Jhc2U8X1Jlcywgdm9sYXRpbGUgX0NsYXNzLCBfQXJnVHlw
ZXMuLi4+IHsgdXNpbmcgX192YXJhcmcgPSBmYWxzZV90eXBlOyB9OyB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfUmVzLCB0eXBlbmFtZSBfQ2xhc3MsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4gc3RydWN0IF9N
ZW1fZm5fdHJhaXRzPF9SZXMgKF9DbGFzczo6KikoX0FyZ1R5cGVzLi4uIC4uLikgdm9sYXRpbGUg
JiY+IDogX01lbV9mbl90cmFpdHNfYmFzZTxfUmVzLCB2b2xhdGlsZSBfQ2xhc3MsIF9BcmdUeXBl
cy4uLj4geyB1c2luZyBfX3ZhcmFyZyA9IHRydWVfdHlwZTsgfTsgdGVtcGxhdGU8dHlwZW5hbWUg
X1JlcywgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+IHN0cnVjdCBfTWVt
X2ZuX3RyYWl0czxfUmVzIChfQ2xhc3M6OiopKF9BcmdUeXBlcy4uLikgY29uc3Qgdm9sYXRpbGUg
JiY+IDogX01lbV9mbl90cmFpdHNfYmFzZTxfUmVzLCBjb25zdCB2b2xhdGlsZSBfQ2xhc3MsIF9B
cmdUeXBlcy4uLj4geyB1c2luZyBfX3ZhcmFyZyA9IGZhbHNlX3R5cGU7IH07IHRlbXBsYXRlPHR5
cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9DbGFzcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPiBzdHJ1
Y3QgX01lbV9mbl90cmFpdHM8X1JlcyAoX0NsYXNzOjoqKShfQXJnVHlwZXMuLi4gLi4uKSBjb25z
dCB2b2xhdGlsZSAmJj4gOiBfTWVtX2ZuX3RyYWl0c19iYXNlPF9SZXMsIGNvbnN0IHZvbGF0aWxl
IF9DbGFzcywgX0FyZ1R5cGVzLi4uPiB7IHVzaW5nIF9fdmFyYXJnID0gdHJ1ZV90eXBlOyB9OwoK
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfTWVtRnVuUHRyLAogICAgYm9vbCBfX2lzX21lbV9mbiA9
IGlzX21lbWJlcl9mdW5jdGlvbl9wb2ludGVyPF9NZW1GdW5QdHI+Ojp2YWx1ZT4KICAgIGNsYXNz
IF9NZW1fZm5fYmFzZQogICAgOiBwdWJsaWMgX01lbV9mbl90cmFpdHM8X01lbUZ1blB0cj46Ol9f
bWF5YmVfdHlwZQogICAgewogICAgICB1c2luZyBfVHJhaXRzID0gX01lbV9mbl90cmFpdHM8X01l
bUZ1blB0cj47CgogICAgICB1c2luZyBfQXJpdHkgPSB0eXBlbmFtZSBfVHJhaXRzOjpfX2FyaXR5
OwogICAgICB1c2luZyBfVmFyYXJncyA9IHR5cGVuYW1lIF9UcmFpdHM6Ol9fdmFyYXJnOwoKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX0Z1bmMsIHR5cGVuYW1lLi4uIF9Cb3VuZEFyZ3M+CiBmcmll
bmQgc3RydWN0IF9CaW5kX2NoZWNrX2FyaXR5OwoKICAgICAgX01lbUZ1blB0ciBfTV9wbWY7Cgog
ICAgcHVibGljOgoKICAgICAgdXNpbmcgcmVzdWx0X3R5cGUgPSB0eXBlbmFtZSBfVHJhaXRzOjpf
X3Jlc3VsdF90eXBlOwoKICAgICAgZXhwbGljaXQgY29uc3RleHByCiAgICAgIF9NZW1fZm5fYmFz
ZShfTWVtRnVuUHRyIF9fcG1mKSBub2V4Y2VwdCA6IF9NX3BtZihfX3BtZikgeyB9CgogICAgICB0
ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfQXJncz4KIGF1dG8KIG9wZXJhdG9yKCkoX0FyZ3MmJi4uLiBf
X2FyZ3MpIGNvbnN0CiBub2V4Y2VwdChub2V4Y2VwdCgKICAgICAgIHN0ZDo6X19pbnZva2UoX01f
cG1mLCBzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pKSkKIC0+IGRlY2x0eXBlKHN0ZDo6
X19pbnZva2UoX01fcG1mLCBzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pKQogeyByZXR1
cm4gc3RkOjpfX2ludm9rZShfTV9wbWYsIHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLik7
IH0KICAgIH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfTWVtT2JqUHRyPgogICAgY2xhc3MgX01l
bV9mbl9iYXNlPF9NZW1PYmpQdHIsIGZhbHNlPgogICAgewogICAgICB1c2luZyBfQXJpdHkgPSBp
bnRlZ3JhbF9jb25zdGFudDxzaXplX3QsIDA+OwogICAgICB1c2luZyBfVmFyYXJncyA9IGZhbHNl
X3R5cGU7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnVuYywgdHlwZW5hbWUuLi4gX0JvdW5k
QXJncz4KIGZyaWVuZCBzdHJ1Y3QgX0JpbmRfY2hlY2tfYXJpdHk7CgogICAgICBfTWVtT2JqUHRy
IF9NX3BtOwoKICAgIHB1YmxpYzoKICAgICAgZXhwbGljaXQgY29uc3RleHByCiAgICAgIF9NZW1f
Zm5fYmFzZShfTWVtT2JqUHRyIF9fcG0pIG5vZXhjZXB0IDogX01fcG0oX19wbSkgeyB9CgogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiBhdXRvCiBvcGVyYXRvcigpKF9UcCYmIF9fb2JqKSBj
b25zdAogbm9leGNlcHQobm9leGNlcHQoc3RkOjpfX2ludm9rZShfTV9wbSwgc3RkOjpmb3J3YXJk
PF9UcD4oX19vYmopKSkpCiAtPiBkZWNsdHlwZShzdGQ6Ol9faW52b2tlKF9NX3BtLCBzdGQ6OmZv
cndhcmQ8X1RwPihfX29iaikpKQogeyByZXR1cm4gc3RkOjpfX2ludm9rZShfTV9wbSwgc3RkOjpm
b3J3YXJkPF9UcD4oX19vYmopKTsgfQogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Jlcywg
dHlwZW5hbWUgX0NsYXNzPgogICAgc3RydWN0IF9NZW1fZm48X1JlcyBfQ2xhc3M6Oio+CiAgICA6
IF9NZW1fZm5fYmFzZTxfUmVzIF9DbGFzczo6Kj4KICAgIHsKICAgICAgdXNpbmcgX01lbV9mbl9i
YXNlPF9SZXMgX0NsYXNzOjoqPjo6X01lbV9mbl9iYXNlOwogICAgfTsKIyA2NTQgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvZnVuY3Rpb25hbCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlw
ZW5hbWUgX0NsYXNzPgogICAgaW5saW5lIF9NZW1fZm48X1RwIF9DbGFzczo6Kj4KICAgIG1lbV9m
bihfVHAgX0NsYXNzOjoqIF9fcG0pIG5vZXhjZXB0CiAgICB7CiAgICAgIHJldHVybiBfTWVtX2Zu
PF9UcCBfQ2xhc3M6Oio+KF9fcG0pOwogICAgfQojIDY2OSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9mdW5jdGlvbmFsIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGlzX2Jp
bmRfZXhwcmVzc2lvbgogICAgOiBwdWJsaWMgZmFsc2VfdHlwZSB7IH07CiMgNjgwICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2Z1bmN0aW9uYWwiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAg
ICBzdHJ1Y3QgaXNfcGxhY2Vob2xkZXIKICAgIDogcHVibGljIGludGVncmFsX2NvbnN0YW50PGlu
dCwgMD4KICAgIHsgfTsKCgoKCiAgdGVtcGxhdGU8aW50IF9OdW0+IHN0cnVjdCBfUGxhY2Vob2xk
ZXIgeyB9OwoKIAoKCgoKCiAgbmFtZXNwYWNlIHBsYWNlaG9sZGVycwogIHsKIAoKCgoKICAgIGV4
dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8MT4gXzE7CiAgICBleHRlcm4gY29uc3QgX1BsYWNlaG9s
ZGVyPDI+IF8yOwogICAgZXh0ZXJuIGNvbnN0IF9QbGFjZWhvbGRlcjwzPiBfMzsKICAgIGV4dGVy
biBjb25zdCBfUGxhY2Vob2xkZXI8ND4gXzQ7CiAgICBleHRlcm4gY29uc3QgX1BsYWNlaG9sZGVy
PDU+IF81OwogICAgZXh0ZXJuIGNvbnN0IF9QbGFjZWhvbGRlcjw2PiBfNjsKICAgIGV4dGVybiBj
b25zdCBfUGxhY2Vob2xkZXI8Nz4gXzc7CiAgICBleHRlcm4gY29uc3QgX1BsYWNlaG9sZGVyPDg+
IF84OwogICAgZXh0ZXJuIGNvbnN0IF9QbGFjZWhvbGRlcjw5PiBfOTsKICAgIGV4dGVybiBjb25z
dCBfUGxhY2Vob2xkZXI8MTA+IF8xMDsKICAgIGV4dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8MTE+
IF8xMTsKICAgIGV4dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8MTI+IF8xMjsKICAgIGV4dGVybiBj
b25zdCBfUGxhY2Vob2xkZXI8MTM+IF8xMzsKICAgIGV4dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8
MTQ+IF8xNDsKICAgIGV4dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8MTU+IF8xNTsKICAgIGV4dGVy
biBjb25zdCBfUGxhY2Vob2xkZXI8MTY+IF8xNjsKICAgIGV4dGVybiBjb25zdCBfUGxhY2Vob2xk
ZXI8MTc+IF8xNzsKICAgIGV4dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8MTg+IF8xODsKICAgIGV4
dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8MTk+IF8xOTsKICAgIGV4dGVybiBjb25zdCBfUGxhY2Vo
b2xkZXI8MjA+IF8yMDsKICAgIGV4dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8MjE+IF8yMTsKICAg
IGV4dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8MjI+IF8yMjsKICAgIGV4dGVybiBjb25zdCBfUGxh
Y2Vob2xkZXI8MjM+IF8yMzsKICAgIGV4dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8MjQ+IF8yNDsK
ICAgIGV4dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8MjU+IF8yNTsKICAgIGV4dGVybiBjb25zdCBf
UGxhY2Vob2xkZXI8MjY+IF8yNjsKICAgIGV4dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8Mjc+IF8y
NzsKICAgIGV4dGVybiBjb25zdCBfUGxhY2Vob2xkZXI8Mjg+IF8yODsKICAgIGV4dGVybiBjb25z
dCBfUGxhY2Vob2xkZXI8Mjk+IF8yOTsKIAogIH0KCiAKCgoKCgoKICB0ZW1wbGF0ZTxpbnQgX051
bT4KICAgIHN0cnVjdCBpc19wbGFjZWhvbGRlcjxfUGxhY2Vob2xkZXI8X051bT4gPgogICAgOiBw
dWJsaWMgaW50ZWdyYWxfY29uc3RhbnQ8aW50LCBfTnVtPgogICAgeyB9OwoKICB0ZW1wbGF0ZTxp
bnQgX051bT4KICAgIHN0cnVjdCBpc19wbGFjZWhvbGRlcjxjb25zdCBfUGxhY2Vob2xkZXI8X051
bT4gPgogICAgOiBwdWJsaWMgaW50ZWdyYWxfY29uc3RhbnQ8aW50LCBfTnVtPgogICAgeyB9OwoK
CgogdGVtcGxhdGU8c3RkOjpzaXplX3QgX19pLCB0eXBlbmFtZSBfVHVwbGU+CiAgIHVzaW5nIF9T
YWZlX3R1cGxlX2VsZW1lbnRfdAogICAgID0gdHlwZW5hbWUgZW5hYmxlX2lmPChfX2kgPCB0dXBs
ZV9zaXplPF9UdXBsZT46OnZhbHVlKSwKICAgICB0dXBsZV9lbGVtZW50PF9faSwgX1R1cGxlPj46
OnR5cGU6OnR5cGU7CiMgNzcwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Z1bmN0aW9uYWwiIDMK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQXJnLAogICAgYm9vbCBfSXNCaW5kRXhwID0gaXNfYmluZF9l
eHByZXNzaW9uPF9Bcmc+Ojp2YWx1ZSwKICAgIGJvb2wgX0lzUGxhY2Vob2xkZXIgPSAoaXNfcGxh
Y2Vob2xkZXI8X0FyZz46OnZhbHVlID4gMCk+CiAgICBjbGFzcyBfTXU7CgoKCgoKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwPgogICAgY2xhc3MgX011PHJlZmVyZW5jZV93cmFwcGVyPF9UcD4sIGZh
bHNlLCBmYWxzZT4KICAgIHsKICAgIHB1YmxpYzoKCgoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9DVlJlZiwgdHlwZW5hbWUgX1R1cGxlPgogX1RwJgogb3BlcmF0b3IoKShfQ1ZSZWYmIF9fYXJn
LCBfVHVwbGUmKSBjb25zdCB2b2xhdGlsZQogeyByZXR1cm4gX19hcmcuZ2V0KCk7IH0KICAgIH07
CgoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Bcmc+CiAgICBjbGFzcyBfTXU8X0FyZywgdHJ1
ZSwgZmFsc2U+CiAgICB7CiAgICBwdWJsaWM6CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9DVkFy
ZywgdHlwZW5hbWUuLi4gX0FyZ3M+CiBhdXRvCiBvcGVyYXRvcigpKF9DVkFyZyYgX19hcmcsCiAg
ICAgdHVwbGU8X0FyZ3MuLi4+JiBfX3R1cGxlKSBjb25zdCB2b2xhdGlsZQogLT4gZGVjbHR5cGUo
X19hcmcoZGVjbHZhbDxfQXJncz4oKS4uLikpCiB7CgogICB0eXBlZGVmIHR5cGVuYW1lIF9CdWls
ZF9pbmRleF90dXBsZTxzaXplb2YuLi4oX0FyZ3MpPjo6X190eXBlCiAgICAgX0luZGV4ZXM7CiAg
IHJldHVybiB0aGlzLT5fX2NhbGwoX19hcmcsIF9fdHVwbGUsIF9JbmRleGVzKCkpOwogfQoKICAg
IHByaXZhdGU6CgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0NWQXJnLCB0eXBlbmFtZS4uLiBf
QXJncywgc3RkOjpzaXplX3QuLi4gX0luZGV4ZXM+CiBhdXRvCiBfX2NhbGwoX0NWQXJnJiBfX2Fy
ZywgdHVwbGU8X0FyZ3MuLi4+JiBfX3R1cGxlLAogICAgICAgIGNvbnN0IF9JbmRleF90dXBsZTxf
SW5kZXhlcy4uLj4mKSBjb25zdCB2b2xhdGlsZQogLT4gZGVjbHR5cGUoX19hcmcoZGVjbHZhbDxf
QXJncz4oKS4uLikpCiB7CiAgIHJldHVybiBfX2FyZyhzdGQ6OmZvcndhcmQ8X0FyZ3M+KHN0ZDo6
Z2V0PF9JbmRleGVzPihfX3R1cGxlKSkuLi4pOwogfQogICAgfTsKCgoKCgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfQXJnPgogICAgY2xhc3MgX011PF9BcmcsIGZhbHNlLCB0cnVlPgogICAgewogICAg
cHVibGljOgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHVwbGU+CiBfU2FmZV90dXBsZV9lbGVt
ZW50X3Q8KGlzX3BsYWNlaG9sZGVyPF9Bcmc+Ojp2YWx1ZSAtIDEpLCBfVHVwbGU+JiYKIG9wZXJh
dG9yKCkoY29uc3Qgdm9sYXRpbGUgX0FyZyYsIF9UdXBsZSYgX190dXBsZSkgY29uc3Qgdm9sYXRp
bGUKIHsKICAgdXNpbmcgX190eXBlCiAgICAgPSBfX3R1cGxlX2VsZW1lbnRfdDwoaXNfcGxhY2Vo
b2xkZXI8X0FyZz46OnZhbHVlIC0gMSksIF9UdXBsZT47CiAgIHJldHVybiBzdGQ6OmZvcndhcmQ8
X190eXBlPigKICAgICAgIDo6c3RkOjpnZXQ8KGlzX3BsYWNlaG9sZGVyPF9Bcmc+Ojp2YWx1ZSAt
IDEpPihfX3R1cGxlKSk7CiB9CiAgICB9OwoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9Bcmc+
CiAgICBjbGFzcyBfTXU8X0FyZywgZmFsc2UsIGZhbHNlPgogICAgewogICAgcHVibGljOgogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ1ZBcmcsIHR5cGVuYW1lIF9UdXBsZT4KIF9DVkFyZyYmCiBv
cGVyYXRvcigpKF9DVkFyZyYmIF9fYXJnLCBfVHVwbGUmKSBjb25zdCB2b2xhdGlsZQogeyByZXR1
cm4gc3RkOjpmb3J3YXJkPF9DVkFyZz4oX19hcmcpOyB9CiAgICB9OwoKCgoKCgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfTWF5YmVfd3JhcF9tZW1iZXJfcG9pbnRlcgogICAg
ewogICAgICB0eXBlZGVmIF9UcCB0eXBlOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciBjb25zdCBf
VHAmCiAgICAgIF9fZG9fd3JhcChjb25zdCBfVHAmIF9feCkKICAgICAgeyByZXR1cm4gX194OyB9
CgogICAgICBzdGF0aWMgY29uc3RleHByIF9UcCYmCiAgICAgIF9fZG9fd3JhcChfVHAmJiBfX3gp
CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PF9UcCYmPihfX3gpOyB9CiAgICB9OwoKCgoKCgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0NsYXNzPgogICAgc3RydWN0IF9NYXli
ZV93cmFwX21lbWJlcl9wb2ludGVyPF9UcCBfQ2xhc3M6Oio+CiAgICB7CiAgICAgIHR5cGVkZWYg
X01lbV9mbjxfVHAgX0NsYXNzOjoqPiB0eXBlOwoKICAgICAgc3RhdGljIGNvbnN0ZXhwciB0eXBl
CiAgICAgIF9fZG9fd3JhcChfVHAgX0NsYXNzOjoqIF9fcG0pCiAgICAgIHsgcmV0dXJuIHR5cGUo
X19wbSk7IH0KICAgIH07CgoKCgoKICB0ZW1wbGF0ZTw+CiAgICBzdHJ1Y3QgX01heWJlX3dyYXBf
bWVtYmVyX3BvaW50ZXI8dm9pZD4KICAgIHsKICAgICAgdHlwZWRlZiB2b2lkIHR5cGU7CiAgICB9
OwoKCiAgdGVtcGxhdGU8c3RkOjpzaXplX3QgX0luZCwgdHlwZW5hbWUuLi4gX1RwPgogICAgaW5s
aW5lIGF1dG8KICAgIF9fdm9sZ2V0KHZvbGF0aWxlIHR1cGxlPF9UcC4uLj4mIF9fdHVwbGUpCiAg
ICAtPiBfX3R1cGxlX2VsZW1lbnRfdDxfSW5kLCB0dXBsZTxfVHAuLi4+PiB2b2xhdGlsZSYKICAg
IHsgcmV0dXJuIHN0ZDo6Z2V0PF9JbmQ+KGNvbnN0X2Nhc3Q8dHVwbGU8X1RwLi4uPiY+KF9fdHVw
bGUpKTsgfQoKCiAgdGVtcGxhdGU8c3RkOjpzaXplX3QgX0luZCwgdHlwZW5hbWUuLi4gX1RwPgog
ICAgaW5saW5lIGF1dG8KICAgIF9fdm9sZ2V0KGNvbnN0IHZvbGF0aWxlIHR1cGxlPF9UcC4uLj4m
IF9fdHVwbGUpCiAgICAtPiBfX3R1cGxlX2VsZW1lbnRfdDxfSW5kLCB0dXBsZTxfVHAuLi4+PiBj
b25zdCB2b2xhdGlsZSYKICAgIHsgcmV0dXJuIHN0ZDo6Z2V0PF9JbmQ+KGNvbnN0X2Nhc3Q8Y29u
c3QgdHVwbGU8X1RwLi4uPiY+KF9fdHVwbGUpKTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Np
Z25hdHVyZT4KICAgIHN0cnVjdCBfQmluZDsKCiAgIHRlbXBsYXRlPHR5cGVuYW1lIF9GdW5jdG9y
LCB0eXBlbmFtZS4uLiBfQm91bmRfYXJncz4KICAgIGNsYXNzIF9CaW5kPF9GdW5jdG9yKF9Cb3Vu
ZF9hcmdzLi4uKT4KICAgIDogcHVibGljIF9XZWFrX3Jlc3VsdF90eXBlPF9GdW5jdG9yPgogICAg
ewogICAgICB0eXBlZGVmIF9CaW5kIF9fc2VsZl90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1l
IF9CdWlsZF9pbmRleF90dXBsZTxzaXplb2YuLi4oX0JvdW5kX2FyZ3MpPjo6X190eXBlCiBfQm91
bmRfaW5kZXhlczsKCiAgICAgIF9GdW5jdG9yIF9NX2Y7CiAgICAgIHR1cGxlPF9Cb3VuZF9hcmdz
Li4uPiBfTV9ib3VuZF9hcmdzOwoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXN1bHQsIHR5
cGVuYW1lLi4uIF9BcmdzLCBzdGQ6OnNpemVfdC4uLiBfSW5kZXhlcz4KIF9SZXN1bHQKIF9fY2Fs
bCh0dXBsZTxfQXJncy4uLj4mJiBfX2FyZ3MsIF9JbmRleF90dXBsZTxfSW5kZXhlcy4uLj4pCiB7
CiAgIHJldHVybiBfTV9mKF9NdTxfQm91bmRfYXJncz4oKQogICAgICAgIChzdGQ6OmdldDxfSW5k
ZXhlcz4oX01fYm91bmRfYXJncyksIF9fYXJncykuLi4pOwogfQoKCiAgICAgIHRlbXBsYXRlPHR5
cGVuYW1lIF9SZXN1bHQsIHR5cGVuYW1lLi4uIF9BcmdzLCBzdGQ6OnNpemVfdC4uLiBfSW5kZXhl
cz4KIF9SZXN1bHQKIF9fY2FsbF9jKHR1cGxlPF9BcmdzLi4uPiYmIF9fYXJncywgX0luZGV4X3R1
cGxlPF9JbmRleGVzLi4uPikgY29uc3QKIHsKICAgcmV0dXJuIF9NX2YoX011PF9Cb3VuZF9hcmdz
PigpCiAgICAgICAgKHN0ZDo6Z2V0PF9JbmRleGVzPihfTV9ib3VuZF9hcmdzKSwgX19hcmdzKS4u
Lik7CiB9CgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1Jlc3VsdCwgdHlwZW5hbWUuLi4gX0Fy
Z3MsIHN0ZDo6c2l6ZV90Li4uIF9JbmRleGVzPgogX1Jlc3VsdAogX19jYWxsX3YodHVwbGU8X0Fy
Z3MuLi4+JiYgX19hcmdzLAogICBfSW5kZXhfdHVwbGU8X0luZGV4ZXMuLi4+KSB2b2xhdGlsZQog
ewogICByZXR1cm4gX01fZihfTXU8X0JvdW5kX2FyZ3M+KCkKICAgICAgICAoX192b2xnZXQ8X0lu
ZGV4ZXM+KF9NX2JvdW5kX2FyZ3MpLCBfX2FyZ3MpLi4uKTsKIH0KCgogICAgICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfUmVzdWx0LCB0eXBlbmFtZS4uLiBfQXJncywgc3RkOjpzaXplX3QuLi4gX0luZGV4
ZXM+CiBfUmVzdWx0CiBfX2NhbGxfY192KHR1cGxlPF9BcmdzLi4uPiYmIF9fYXJncywKICAgICBf
SW5kZXhfdHVwbGU8X0luZGV4ZXMuLi4+KSBjb25zdCB2b2xhdGlsZQogewogICByZXR1cm4gX01f
ZihfTXU8X0JvdW5kX2FyZ3M+KCkKICAgICAgICAoX192b2xnZXQ8X0luZGV4ZXM+KF9NX2JvdW5k
X2FyZ3MpLCBfX2FyZ3MpLi4uKTsKIH0KCiAgICAgcHVibGljOgogICAgICB0ZW1wbGF0ZTx0eXBl
bmFtZS4uLiBfQXJncz4KIGV4cGxpY2l0IF9CaW5kKGNvbnN0IF9GdW5jdG9yJiBfX2YsIF9Bcmdz
JiYuLi4gX19hcmdzKQogOiBfTV9mKF9fZiksIF9NX2JvdW5kX2FyZ3Moc3RkOjpmb3J3YXJkPF9B
cmdzPihfX2FyZ3MpLi4uKQogeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfQXJncz4K
IGV4cGxpY2l0IF9CaW5kKF9GdW5jdG9yJiYgX19mLCBfQXJncyYmLi4uIF9fYXJncykKIDogX01f
ZihzdGQ6Om1vdmUoX19mKSksIF9NX2JvdW5kX2FyZ3Moc3RkOjpmb3J3YXJkPF9BcmdzPihfX2Fy
Z3MpLi4uKQogeyB9CgogICAgICBfQmluZChjb25zdCBfQmluZCYpID0gZGVmYXVsdDsKCiAgICAg
IF9CaW5kKF9CaW5kJiYgX19iKQogICAgICA6IF9NX2Yoc3RkOjptb3ZlKF9fYi5fTV9mKSksIF9N
X2JvdW5kX2FyZ3Moc3RkOjptb3ZlKF9fYi5fTV9ib3VuZF9hcmdzKSkKICAgICAgeyB9CgoKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX0FyZ3MsIHR5cGVuYW1lIF9SZXN1bHQKID0gZGVjbHR5
cGUoIHN0ZDo6ZGVjbHZhbDxfRnVuY3RvciY+KCkoCiAgICAgICBfTXU8X0JvdW5kX2FyZ3M+KCko
IHN0ZDo6ZGVjbHZhbDxfQm91bmRfYXJncyY+KCksCiAgICAgIHN0ZDo6ZGVjbHZhbDx0dXBsZTxf
QXJncy4uLj4mPigpICkuLi4gKSApPgogX1Jlc3VsdAogb3BlcmF0b3IoKShfQXJncyYmLi4uIF9f
YXJncykKIHsKICAgcmV0dXJuIHRoaXMtPl9fY2FsbDxfUmVzdWx0PigKICAgICAgIHN0ZDo6Zm9y
d2FyZF9hc190dXBsZShzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pLAogICAgICAgX0Jv
dW5kX2luZGV4ZXMoKSk7CiB9CgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX0FyZ3MsIHR5
cGVuYW1lIF9SZXN1bHQKID0gZGVjbHR5cGUoIHN0ZDo6ZGVjbHZhbDx0eXBlbmFtZSBlbmFibGVf
aWY8KHNpemVvZi4uLihfQXJncykgPj0gMCksCiAgICAgICAgIHR5cGVuYW1lIGFkZF9jb25zdDxf
RnVuY3Rvcj46OnR5cGUmPjo6dHlwZT4oKSgKICAgICAgIF9NdTxfQm91bmRfYXJncz4oKSggc3Rk
OjpkZWNsdmFsPGNvbnN0IF9Cb3VuZF9hcmdzJj4oKSwKICAgICAgc3RkOjpkZWNsdmFsPHR1cGxl
PF9BcmdzLi4uPiY+KCkgKS4uLiApICk+CiBfUmVzdWx0CiBvcGVyYXRvcigpKF9BcmdzJiYuLi4g
X19hcmdzKSBjb25zdAogewogICByZXR1cm4gdGhpcy0+X19jYWxsX2M8X1Jlc3VsdD4oCiAgICAg
ICBzdGQ6OmZvcndhcmRfYXNfdHVwbGUoc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKSwK
ICAgICAgIF9Cb3VuZF9pbmRleGVzKCkpOwogfQoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4u
IF9BcmdzLCB0eXBlbmFtZSBfUmVzdWx0CiA9IGRlY2x0eXBlKCBzdGQ6OmRlY2x2YWw8dHlwZW5h
bWUgZW5hYmxlX2lmPChzaXplb2YuLi4oX0FyZ3MpID49IDApLAogICAgICAgICAgICAgICAgICAg
ICAgIHR5cGVuYW1lIGFkZF92b2xhdGlsZTxfRnVuY3Rvcj46OnR5cGUmPjo6dHlwZT4oKSgKICAg
ICAgIF9NdTxfQm91bmRfYXJncz4oKSggc3RkOjpkZWNsdmFsPHZvbGF0aWxlIF9Cb3VuZF9hcmdz
Jj4oKSwKICAgICAgc3RkOjpkZWNsdmFsPHR1cGxlPF9BcmdzLi4uPiY+KCkgKS4uLiApICk+CiBf
UmVzdWx0CiBvcGVyYXRvcigpKF9BcmdzJiYuLi4gX19hcmdzKSB2b2xhdGlsZQogewogICByZXR1
cm4gdGhpcy0+X19jYWxsX3Y8X1Jlc3VsdD4oCiAgICAgICBzdGQ6OmZvcndhcmRfYXNfdHVwbGUo
c3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKSwKICAgICAgIF9Cb3VuZF9pbmRleGVzKCkp
OwogfQoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzLCB0eXBlbmFtZSBfUmVzdWx0
CiA9IGRlY2x0eXBlKCBzdGQ6OmRlY2x2YWw8dHlwZW5hbWUgZW5hYmxlX2lmPChzaXplb2YuLi4o
X0FyZ3MpID49IDApLAogICAgICAgICAgICAgICAgICAgICAgIHR5cGVuYW1lIGFkZF9jdjxfRnVu
Y3Rvcj46OnR5cGUmPjo6dHlwZT4oKSgKICAgICAgIF9NdTxfQm91bmRfYXJncz4oKSggc3RkOjpk
ZWNsdmFsPGNvbnN0IHZvbGF0aWxlIF9Cb3VuZF9hcmdzJj4oKSwKICAgICAgc3RkOjpkZWNsdmFs
PHR1cGxlPF9BcmdzLi4uPiY+KCkgKS4uLiApICk+CiBfUmVzdWx0CiBvcGVyYXRvcigpKF9Bcmdz
JiYuLi4gX19hcmdzKSBjb25zdCB2b2xhdGlsZQogewogICByZXR1cm4gdGhpcy0+X19jYWxsX2Nf
djxfUmVzdWx0PigKICAgICAgIHN0ZDo6Zm9yd2FyZF9hc190dXBsZShzdGQ6OmZvcndhcmQ8X0Fy
Z3M+KF9fYXJncykuLi4pLAogICAgICAgX0JvdW5kX2luZGV4ZXMoKSk7CiB9CiAgICB9OwoKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1Jlc3VsdCwgdHlwZW5hbWUgX1NpZ25hdHVyZT4KICAgIHN0cnVj
dCBfQmluZF9yZXN1bHQ7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXN1bHQsIHR5cGVuYW1lIF9G
dW5jdG9yLCB0eXBlbmFtZS4uLiBfQm91bmRfYXJncz4KICAgIGNsYXNzIF9CaW5kX3Jlc3VsdDxf
UmVzdWx0LCBfRnVuY3RvcihfQm91bmRfYXJncy4uLik+CiAgICB7CiAgICAgIHR5cGVkZWYgX0Jp
bmRfcmVzdWx0IF9fc2VsZl90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9CdWlsZF9pbmRl
eF90dXBsZTxzaXplb2YuLi4oX0JvdW5kX2FyZ3MpPjo6X190eXBlCiBfQm91bmRfaW5kZXhlczsK
CiAgICAgIF9GdW5jdG9yIF9NX2Y7CiAgICAgIHR1cGxlPF9Cb3VuZF9hcmdzLi4uPiBfTV9ib3Vu
ZF9hcmdzOwoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXM+CiBzdHJ1Y3QgX19lbmFibGVf
aWZfdm9pZCA6IGVuYWJsZV9pZjxpc192b2lkPF9SZXM+Ojp2YWx1ZSwgaW50PiB7IH07CiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9SZXM+CiBzdHJ1Y3QgX19kaXNhYmxlX2lmX3ZvaWQgOiBlbmFi
bGVfaWY8IWlzX3ZvaWQ8X1Jlcz46OnZhbHVlLCBpbnQ+IHsgfTsKCgogICAgICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJncywgc3RkOjpzaXplX3QuLi4gX0luZGV4ZXM+
CiBfUmVzdWx0CiBfX2NhbGwodHVwbGU8X0FyZ3MuLi4+JiYgX19hcmdzLCBfSW5kZXhfdHVwbGU8
X0luZGV4ZXMuLi4+LAogICAgIHR5cGVuYW1lIF9fZGlzYWJsZV9pZl92b2lkPF9SZXM+Ojp0eXBl
ID0gMCkKIHsKICAgcmV0dXJuIF9NX2YoX011PF9Cb3VuZF9hcmdzPigpCiAgICAgICAgKHN0ZDo6
Z2V0PF9JbmRleGVzPihfTV9ib3VuZF9hcmdzKSwgX19hcmdzKS4uLik7CiB9CgoKICAgICAgdGVt
cGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUuLi4gX0FyZ3MsIHN0ZDo6c2l6ZV90Li4uIF9J
bmRleGVzPgogdm9pZAogX19jYWxsKHR1cGxlPF9BcmdzLi4uPiYmIF9fYXJncywgX0luZGV4X3R1
cGxlPF9JbmRleGVzLi4uPiwKICAgICB0eXBlbmFtZSBfX2VuYWJsZV9pZl92b2lkPF9SZXM+Ojp0
eXBlID0gMCkKIHsKICAgX01fZihfTXU8X0JvdW5kX2FyZ3M+KCkKICAgICAgICAoc3RkOjpnZXQ8
X0luZGV4ZXM+KF9NX2JvdW5kX2FyZ3MpLCBfX2FyZ3MpLi4uKTsKIH0KCgogICAgICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJncywgc3RkOjpzaXplX3QuLi4gX0luZGV4
ZXM+CiBfUmVzdWx0CiBfX2NhbGwodHVwbGU8X0FyZ3MuLi4+JiYgX19hcmdzLCBfSW5kZXhfdHVw
bGU8X0luZGV4ZXMuLi4+LAogICAgIHR5cGVuYW1lIF9fZGlzYWJsZV9pZl92b2lkPF9SZXM+Ojp0
eXBlID0gMCkgY29uc3QKIHsKICAgcmV0dXJuIF9NX2YoX011PF9Cb3VuZF9hcmdzPigpCiAgICAg
ICAgKHN0ZDo6Z2V0PF9JbmRleGVzPihfTV9ib3VuZF9hcmdzKSwgX19hcmdzKS4uLik7CiB9CgoK
ICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUuLi4gX0FyZ3MsIHN0ZDo6c2l6
ZV90Li4uIF9JbmRleGVzPgogdm9pZAogX19jYWxsKHR1cGxlPF9BcmdzLi4uPiYmIF9fYXJncywg
X0luZGV4X3R1cGxlPF9JbmRleGVzLi4uPiwKICAgICB0eXBlbmFtZSBfX2VuYWJsZV9pZl92b2lk
PF9SZXM+Ojp0eXBlID0gMCkgY29uc3QKIHsKICAgX01fZihfTXU8X0JvdW5kX2FyZ3M+KCkKICAg
ICAgICAoc3RkOjpnZXQ8X0luZGV4ZXM+KF9NX2JvdW5kX2FyZ3MpLCBfX2FyZ3MpLi4uKTsKIH0K
CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJncywgc3RkOjpz
aXplX3QuLi4gX0luZGV4ZXM+CiBfUmVzdWx0CiBfX2NhbGwodHVwbGU8X0FyZ3MuLi4+JiYgX19h
cmdzLCBfSW5kZXhfdHVwbGU8X0luZGV4ZXMuLi4+LAogICAgIHR5cGVuYW1lIF9fZGlzYWJsZV9p
Zl92b2lkPF9SZXM+Ojp0eXBlID0gMCkgdm9sYXRpbGUKIHsKICAgcmV0dXJuIF9NX2YoX011PF9C
b3VuZF9hcmdzPigpCiAgICAgICAgKF9fdm9sZ2V0PF9JbmRleGVzPihfTV9ib3VuZF9hcmdzKSwg
X19hcmdzKS4uLik7CiB9CgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUu
Li4gX0FyZ3MsIHN0ZDo6c2l6ZV90Li4uIF9JbmRleGVzPgogdm9pZAogX19jYWxsKHR1cGxlPF9B
cmdzLi4uPiYmIF9fYXJncywgX0luZGV4X3R1cGxlPF9JbmRleGVzLi4uPiwKICAgICB0eXBlbmFt
ZSBfX2VuYWJsZV9pZl92b2lkPF9SZXM+Ojp0eXBlID0gMCkgdm9sYXRpbGUKIHsKICAgX01fZihf
TXU8X0JvdW5kX2FyZ3M+KCkKICAgICAgICAoX192b2xnZXQ8X0luZGV4ZXM+KF9NX2JvdW5kX2Fy
Z3MpLCBfX2FyZ3MpLi4uKTsKIH0KCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBl
bmFtZS4uLiBfQXJncywgc3RkOjpzaXplX3QuLi4gX0luZGV4ZXM+CiBfUmVzdWx0CiBfX2NhbGwo
dHVwbGU8X0FyZ3MuLi4+JiYgX19hcmdzLCBfSW5kZXhfdHVwbGU8X0luZGV4ZXMuLi4+LAogICAg
IHR5cGVuYW1lIF9fZGlzYWJsZV9pZl92b2lkPF9SZXM+Ojp0eXBlID0gMCkgY29uc3Qgdm9sYXRp
bGUKIHsKICAgcmV0dXJuIF9NX2YoX011PF9Cb3VuZF9hcmdzPigpCiAgICAgICAgKF9fdm9sZ2V0
PF9JbmRleGVzPihfTV9ib3VuZF9hcmdzKSwgX19hcmdzKS4uLik7CiB9CgoKICAgICAgdGVtcGxh
dGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUuLi4gX0FyZ3MsIHN0ZDo6c2l6ZV90Li4uIF9JbmRl
eGVzPgogdm9pZAogX19jYWxsKHR1cGxlPF9BcmdzLi4uPiYmIF9fYXJncywKICAgICAgICBfSW5k
ZXhfdHVwbGU8X0luZGV4ZXMuLi4+LAogICAgIHR5cGVuYW1lIF9fZW5hYmxlX2lmX3ZvaWQ8X1Jl
cz46OnR5cGUgPSAwKSBjb25zdCB2b2xhdGlsZQogewogICBfTV9mKF9NdTxfQm91bmRfYXJncz4o
KQogICAgICAgIChfX3ZvbGdldDxfSW5kZXhlcz4oX01fYm91bmRfYXJncyksIF9fYXJncykuLi4p
OwogfQoKICAgIHB1YmxpYzoKICAgICAgdHlwZWRlZiBfUmVzdWx0IHJlc3VsdF90eXBlOwoKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX0FyZ3M+CiBleHBsaWNpdCBfQmluZF9yZXN1bHQoY29u
c3QgX0Z1bmN0b3ImIF9fZiwgX0FyZ3MmJi4uLiBfX2FyZ3MpCiA6IF9NX2YoX19mKSwgX01fYm91
bmRfYXJncyhzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pCiB7IH0KCiAgICAgIHRlbXBs
YXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogZXhwbGljaXQgX0JpbmRfcmVzdWx0KF9GdW5jdG9yJiYg
X19mLCBfQXJncyYmLi4uIF9fYXJncykKIDogX01fZihzdGQ6Om1vdmUoX19mKSksIF9NX2JvdW5k
X2FyZ3Moc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKQogeyB9CgogICAgICBfQmluZF9y
ZXN1bHQoY29uc3QgX0JpbmRfcmVzdWx0JikgPSBkZWZhdWx0OwoKICAgICAgX0JpbmRfcmVzdWx0
KF9CaW5kX3Jlc3VsdCYmIF9fYikKICAgICAgOiBfTV9mKHN0ZDo6bW92ZShfX2IuX01fZikpLCBf
TV9ib3VuZF9hcmdzKHN0ZDo6bW92ZShfX2IuX01fYm91bmRfYXJncykpCiAgICAgIHsgfQoKCiAg
ICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogcmVzdWx0X3R5cGUKIG9wZXJhdG9yKCko
X0FyZ3MmJi4uLiBfX2FyZ3MpCiB7CiAgIHJldHVybiB0aGlzLT5fX2NhbGw8X1Jlc3VsdD4oCiAg
ICAgICBzdGQ6OmZvcndhcmRfYXNfdHVwbGUoc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4u
KSwKICAgICAgIF9Cb3VuZF9pbmRleGVzKCkpOwogfQoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1l
Li4uIF9BcmdzPgogcmVzdWx0X3R5cGUKIG9wZXJhdG9yKCkoX0FyZ3MmJi4uLiBfX2FyZ3MpIGNv
bnN0CiB7CiAgIHJldHVybiB0aGlzLT5fX2NhbGw8X1Jlc3VsdD4oCiAgICAgICBzdGQ6OmZvcndh
cmRfYXNfdHVwbGUoc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKSwKICAgICAgIF9Cb3Vu
ZF9pbmRleGVzKCkpOwogfQoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogcmVz
dWx0X3R5cGUKIG9wZXJhdG9yKCkoX0FyZ3MmJi4uLiBfX2FyZ3MpIHZvbGF0aWxlCiB7CiAgIHJl
dHVybiB0aGlzLT5fX2NhbGw8X1Jlc3VsdD4oCiAgICAgICBzdGQ6OmZvcndhcmRfYXNfdHVwbGUo
c3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKSwKICAgICAgIF9Cb3VuZF9pbmRleGVzKCkp
OwogfQoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogcmVzdWx0X3R5cGUKIG9w
ZXJhdG9yKCkoX0FyZ3MmJi4uLiBfX2FyZ3MpIGNvbnN0IHZvbGF0aWxlCiB7CiAgIHJldHVybiB0
aGlzLT5fX2NhbGw8X1Jlc3VsdD4oCiAgICAgICBzdGQ6OmZvcndhcmRfYXNfdHVwbGUoc3RkOjpm
b3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKSwKICAgICAgIF9Cb3VuZF9pbmRleGVzKCkpOwogfQog
ICAgfTsKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9TaWduYXR1cmU+CiAgICBzdHJ1Y3QgaXNf
YmluZF9leHByZXNzaW9uPF9CaW5kPF9TaWduYXR1cmU+ID4KICAgIDogcHVibGljIHRydWVfdHlw
ZSB7IH07CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfU2lnbmF0dXJlPgogICAgc3RydWN0IGlz
X2JpbmRfZXhwcmVzc2lvbjxjb25zdCBfQmluZDxfU2lnbmF0dXJlPiA+CiAgICA6IHB1YmxpYyB0
cnVlX3R5cGUgeyB9OwoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1NpZ25hdHVyZT4KICAgIHN0
cnVjdCBpc19iaW5kX2V4cHJlc3Npb248dm9sYXRpbGUgX0JpbmQ8X1NpZ25hdHVyZT4gPgogICAg
OiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9TaWduYXR1
cmU+CiAgICBzdHJ1Y3QgaXNfYmluZF9leHByZXNzaW9uPGNvbnN0IHZvbGF0aWxlIF9CaW5kPF9T
aWduYXR1cmU+PgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCgoKCgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9SZXN1bHQsIHR5cGVuYW1lIF9TaWduYXR1cmU+CiAgICBzdHJ1Y3QgaXNfYmluZF9l
eHByZXNzaW9uPF9CaW5kX3Jlc3VsdDxfUmVzdWx0LCBfU2lnbmF0dXJlPj4KICAgIDogcHVibGlj
IHRydWVfdHlwZSB7IH07CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzdWx0LCB0eXBlbmFt
ZSBfU2lnbmF0dXJlPgogICAgc3RydWN0IGlzX2JpbmRfZXhwcmVzc2lvbjxjb25zdCBfQmluZF9y
ZXN1bHQ8X1Jlc3VsdCwgX1NpZ25hdHVyZT4+CiAgICA6IHB1YmxpYyB0cnVlX3R5cGUgeyB9OwoK
CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Jlc3VsdCwgdHlwZW5hbWUgX1NpZ25hdHVyZT4KICAg
IHN0cnVjdCBpc19iaW5kX2V4cHJlc3Npb248dm9sYXRpbGUgX0JpbmRfcmVzdWx0PF9SZXN1bHQs
IF9TaWduYXR1cmU+PgogICAgOiBwdWJsaWMgdHJ1ZV90eXBlIHsgfTsKCgoKCgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9SZXN1bHQsIHR5cGVuYW1lIF9TaWduYXR1cmU+CiAgICBzdHJ1Y3QgaXNfYmlu
ZF9leHByZXNzaW9uPGNvbnN0IHZvbGF0aWxlIF9CaW5kX3Jlc3VsdDxfUmVzdWx0LCBfU2lnbmF0
dXJlPj4KICAgIDogcHVibGljIHRydWVfdHlwZSB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9G
dW5jLCB0eXBlbmFtZS4uLiBfQm91bmRBcmdzPgogICAgc3RydWN0IF9CaW5kX2NoZWNrX2FyaXR5
IHsgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JldCwgdHlwZW5hbWUuLi4gX0FyZ3MsIHR5cGVu
YW1lLi4uIF9Cb3VuZEFyZ3M+CiAgICBzdHJ1Y3QgX0JpbmRfY2hlY2tfYXJpdHk8X1JldCAoKiko
X0FyZ3MuLi4pLCBfQm91bmRBcmdzLi4uPgogICAgewogICAgICBzdGF0aWNfYXNzZXJ0KHNpemVv
Zi4uLihfQm91bmRBcmdzKSA9PSBzaXplb2YuLi4oX0FyZ3MpLAogICAgICAgICAgICAgICAgICAg
Ildyb25nIG51bWJlciBvZiBhcmd1bWVudHMgZm9yIGZ1bmN0aW9uIik7CiAgICB9OwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfUmV0LCB0eXBlbmFtZS4uLiBfQXJncywgdHlwZW5hbWUuLi4gX0JvdW5k
QXJncz4KICAgIHN0cnVjdCBfQmluZF9jaGVja19hcml0eTxfUmV0ICgqKShfQXJncy4uLi4uLiks
IF9Cb3VuZEFyZ3MuLi4+CiAgICB7CiAgICAgIHN0YXRpY19hc3NlcnQoc2l6ZW9mLi4uKF9Cb3Vu
ZEFyZ3MpID49IHNpemVvZi4uLihfQXJncyksCiAgICAgICAgICAgICAgICAgICAiV3JvbmcgbnVt
YmVyIG9mIGFyZ3VtZW50cyBmb3IgZnVuY3Rpb24iKTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcCwgdHlwZW5hbWUgX0NsYXNzLCB0eXBlbmFtZS4uLiBfQm91bmRBcmdzPgogICAgc3Ry
dWN0IF9CaW5kX2NoZWNrX2FyaXR5PF9UcCBfQ2xhc3M6OiosIF9Cb3VuZEFyZ3MuLi4+CiAgICB7
CiAgICAgIHVzaW5nIF9Bcml0eSA9IHR5cGVuYW1lIF9NZW1fZm48X1RwIF9DbGFzczo6Kj46Ol9B
cml0eTsKICAgICAgdXNpbmcgX1ZhcmFyZ3MgPSB0eXBlbmFtZSBfTWVtX2ZuPF9UcCBfQ2xhc3M6
Oio+OjpfVmFyYXJnczsKICAgICAgc3RhdGljX2Fzc2VydChfVmFyYXJnczo6dmFsdWUKICAgICAg
PyBzaXplb2YuLi4oX0JvdW5kQXJncykgPj0gX0FyaXR5Ojp2YWx1ZSArIDEKICAgICAgOiBzaXpl
b2YuLi4oX0JvdW5kQXJncykgPT0gX0FyaXR5Ojp2YWx1ZSArIDEsCiAgICAgICJXcm9uZyBudW1i
ZXIgb2YgYXJndW1lbnRzIGZvciBwb2ludGVyLXRvLW1lbWJlciIpOwogICAgfTsKCgoKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfVHAyID0gdHlwZW5hbWUgZGVjYXk8X1RwPjo6
dHlwZT4KICAgIHVzaW5nIF9faXNfc29ja2V0bGlrZSA9IF9fb3JfPGlzX2ludGVncmFsPF9UcDI+
LCBpc19lbnVtPF9UcDI+PjsKCiAgdGVtcGxhdGU8Ym9vbCBfU29ja2V0TGlrZSwgdHlwZW5hbWUg
X0Z1bmMsIHR5cGVuYW1lLi4uIF9Cb3VuZEFyZ3M+CiAgICBzdHJ1Y3QgX0JpbmRfaGVscGVyCiAg
ICA6IF9CaW5kX2NoZWNrX2FyaXR5PHR5cGVuYW1lIGRlY2F5PF9GdW5jPjo6dHlwZSwgX0JvdW5k
QXJncy4uLj4KICAgIHsKICAgICAgdHlwZWRlZiBfTWF5YmVfd3JhcF9tZW1iZXJfcG9pbnRlcjx0
eXBlbmFtZSBkZWNheTxfRnVuYz46OnR5cGU+CiBfX21heWJlX3R5cGU7CiAgICAgIHR5cGVkZWYg
dHlwZW5hbWUgX19tYXliZV90eXBlOjp0eXBlIF9fZnVuY190eXBlOwogICAgICB0eXBlZGVmIF9C
aW5kPF9fZnVuY190eXBlKHR5cGVuYW1lIGRlY2F5PF9Cb3VuZEFyZ3M+Ojp0eXBlLi4uKT4gdHlw
ZTsKICAgIH07CgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GdW5jLCB0eXBlbmFtZS4uLiBfQm91
bmRBcmdzPgogICAgc3RydWN0IF9CaW5kX2hlbHBlcjx0cnVlLCBfRnVuYywgX0JvdW5kQXJncy4u
Lj4KICAgIHsgfTsKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9GdW5jLCB0eXBlbmFtZS4uLiBf
Qm91bmRBcmdzPgogICAgaW5saW5lIHR5cGVuYW1lCiAgICBfQmluZF9oZWxwZXI8X19pc19zb2Nr
ZXRsaWtlPF9GdW5jPjo6dmFsdWUsIF9GdW5jLCBfQm91bmRBcmdzLi4uPjo6dHlwZQogICAgYmlu
ZChfRnVuYyYmIF9fZiwgX0JvdW5kQXJncyYmLi4uIF9fYXJncykKICAgIHsKICAgICAgdHlwZWRl
ZiBfQmluZF9oZWxwZXI8ZmFsc2UsIF9GdW5jLCBfQm91bmRBcmdzLi4uPiBfX2hlbHBlcl90eXBl
OwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9faGVscGVyX3R5cGU6Ol9fbWF5YmVfdHlwZSBfX21h
eWJlX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19oZWxwZXJfdHlwZTo6dHlwZSBfX3Jl
c3VsdF90eXBlOwogICAgICByZXR1cm4gX19yZXN1bHRfdHlwZShfX21heWJlX3R5cGU6Ol9fZG9f
d3JhcChzdGQ6OmZvcndhcmQ8X0Z1bmM+KF9fZikpLAogICAgICBzdGQ6OmZvcndhcmQ8X0JvdW5k
QXJncz4oX19hcmdzKS4uLik7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXN1bHQsIHR5
cGVuYW1lIF9GdW5jLCB0eXBlbmFtZS4uLiBfQm91bmRBcmdzPgogICAgc3RydWN0IF9CaW5kcmVz
X2hlbHBlcgogICAgOiBfQmluZF9jaGVja19hcml0eTx0eXBlbmFtZSBkZWNheTxfRnVuYz46OnR5
cGUsIF9Cb3VuZEFyZ3MuLi4+CiAgICB7CiAgICAgIHR5cGVkZWYgX01heWJlX3dyYXBfbWVtYmVy
X3BvaW50ZXI8dHlwZW5hbWUgZGVjYXk8X0Z1bmM+Ojp0eXBlPgogX19tYXliZV90eXBlOwogICAg
ICB0eXBlZGVmIHR5cGVuYW1lIF9fbWF5YmVfdHlwZTo6dHlwZSBfX2Z1bmN0b3JfdHlwZTsKICAg
ICAgdHlwZWRlZiBfQmluZF9yZXN1bHQ8X1Jlc3VsdCwKICAgICAgX19mdW5jdG9yX3R5cGUodHlw
ZW5hbWUgZGVjYXk8X0JvdW5kQXJncz46OnR5cGUuLi4pPgogdHlwZTsKICAgIH07CgoKCgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzdWx0LCB0eXBlbmFtZSBfRnVuYywgdHlwZW5hbWUuLi4gX0Jv
dW5kQXJncz4KICAgIGlubGluZQogICAgdHlwZW5hbWUgX0JpbmRyZXNfaGVscGVyPF9SZXN1bHQs
IF9GdW5jLCBfQm91bmRBcmdzLi4uPjo6dHlwZQogICAgYmluZChfRnVuYyYmIF9fZiwgX0JvdW5k
QXJncyYmLi4uIF9fYXJncykKICAgIHsKICAgICAgdHlwZWRlZiBfQmluZHJlc19oZWxwZXI8X1Jl
c3VsdCwgX0Z1bmMsIF9Cb3VuZEFyZ3MuLi4+IF9faGVscGVyX3R5cGU7CiAgICAgIHR5cGVkZWYg
dHlwZW5hbWUgX19oZWxwZXJfdHlwZTo6X19tYXliZV90eXBlIF9fbWF5YmVfdHlwZTsKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBfX2hlbHBlcl90eXBlOjp0eXBlIF9fcmVzdWx0X3R5cGU7CiAgICAg
IHJldHVybiBfX3Jlc3VsdF90eXBlKF9fbWF5YmVfdHlwZTo6X19kb193cmFwKHN0ZDo6Zm9yd2Fy
ZDxfRnVuYz4oX19mKSksCiAgICAgIHN0ZDo6Zm9yd2FyZDxfQm91bmRBcmdzPihfX2FyZ3MpLi4u
KTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1NpZ25hdHVyZT4KICAgIHN0cnVjdCBfQmlu
ZF9zaW1wbGU7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DYWxsYWJsZSwgdHlwZW5hbWUuLi4gX0Fy
Z3M+CiAgICBzdHJ1Y3QgX0JpbmRfc2ltcGxlPF9DYWxsYWJsZShfQXJncy4uLik+CiAgICB7CiAg
ICAgIHR5cGVkZWYgdHlwZW5hbWUgcmVzdWx0X29mPF9DYWxsYWJsZShfQXJncy4uLik+Ojp0eXBl
IHJlc3VsdF90eXBlOwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZS4uLiBf
VXA+CiAgICAgICAgZXhwbGljaXQKICAgICAgICBfQmluZF9zaW1wbGUoX1RwJiYgX19mLCBfVXAm
Ji4uLiBfX2FyZ3MpCiAgICAgICAgOiBfTV9ib3VuZChzdGQ6OmZvcndhcmQ8X1RwPihfX2YpLCBz
dGQ6OmZvcndhcmQ8X1VwPihfX2FyZ3MpLi4uKQogICAgICAgIHsgfQoKICAgICAgX0JpbmRfc2lt
cGxlKGNvbnN0IF9CaW5kX3NpbXBsZSYpID0gZGVmYXVsdDsKICAgICAgX0JpbmRfc2ltcGxlKF9C
aW5kX3NpbXBsZSYmKSA9IGRlZmF1bHQ7CgogICAgICByZXN1bHRfdHlwZQogICAgICBvcGVyYXRv
cigpKCkKICAgICAgewogICAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0J1aWxkX2luZGV4X3R1cGxl
PHNpemVvZi4uLihfQXJncyk+OjpfX3R5cGUgX0luZGljZXM7CiAgICAgICAgcmV0dXJuIF9NX2lu
dm9rZShfSW5kaWNlcygpKTsKICAgICAgfQoKICAgIHByaXZhdGU6CiAgICAgIHRlbXBsYXRlPHN0
ZDo6c2l6ZV90Li4uIF9JbmRpY2VzPgogICAgICAgIHR5cGVuYW1lIHJlc3VsdF9vZjxfQ2FsbGFi
bGUoX0FyZ3MuLi4pPjo6dHlwZQogICAgICAgIF9NX2ludm9rZShfSW5kZXhfdHVwbGU8X0luZGlj
ZXMuLi4+KQogICAgICAgIHsKCgogICAgICAgICAgcmV0dXJuIHN0ZDo6Zm9yd2FyZDxfQ2FsbGFi
bGU+KHN0ZDo6Z2V0PDA+KF9NX2JvdW5kKSkoCiAgICAgICAgICAgICAgc3RkOjpmb3J3YXJkPF9B
cmdzPihzdGQ6OmdldDxfSW5kaWNlcysxPihfTV9ib3VuZCkpLi4uKTsKICAgICAgICB9CgogICAg
ICBzdGQ6OnR1cGxlPF9DYWxsYWJsZSwgX0FyZ3MuLi4+IF9NX2JvdW5kOwogICAgfTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0Z1bmMsIHR5cGVuYW1lLi4uIF9Cb3VuZEFyZ3M+CiAgICBzdHJ1Y3Qg
X0JpbmRfc2ltcGxlX2hlbHBlcgogICAgOiBfQmluZF9jaGVja19hcml0eTx0eXBlbmFtZSBkZWNh
eTxfRnVuYz46OnR5cGUsIF9Cb3VuZEFyZ3MuLi4+CiAgICB7CiAgICAgIHR5cGVkZWYgX01heWJl
X3dyYXBfbWVtYmVyX3BvaW50ZXI8dHlwZW5hbWUgZGVjYXk8X0Z1bmM+Ojp0eXBlPgogICAgICAg
IF9fbWF5YmVfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfX21heWJlX3R5cGU6OnR5cGUg
X19mdW5jX3R5cGU7CiAgICAgIHR5cGVkZWYgX0JpbmRfc2ltcGxlPF9fZnVuY190eXBlKHR5cGVu
YW1lIGRlY2F5PF9Cb3VuZEFyZ3M+Ojp0eXBlLi4uKT4KICAgICAgICBfX3R5cGU7CiAgICB9OwoK
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DYWxsYWJsZSwgdHlwZW5hbWUuLi4gX0FyZ3M+CiAgICB0
eXBlbmFtZSBfQmluZF9zaW1wbGVfaGVscGVyPF9DYWxsYWJsZSwgX0FyZ3MuLi4+OjpfX3R5cGUK
ICAgIF9fYmluZF9zaW1wbGUoX0NhbGxhYmxlJiYgX19jYWxsYWJsZSwgX0FyZ3MmJi4uLiBfX2Fy
Z3MpCiAgICB7CiAgICAgIHR5cGVkZWYgX0JpbmRfc2ltcGxlX2hlbHBlcjxfQ2FsbGFibGUsIF9B
cmdzLi4uPiBfX2hlbHBlcl90eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9faGVscGVyX3R5
cGU6Ol9fbWF5YmVfdHlwZSBfX21heWJlX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19o
ZWxwZXJfdHlwZTo6X190eXBlIF9fcmVzdWx0X3R5cGU7CiAgICAgIHJldHVybiBfX3Jlc3VsdF90
eXBlKAogICAgICAgICAgX19tYXliZV90eXBlOjpfX2RvX3dyYXAoIHN0ZDo6Zm9yd2FyZDxfQ2Fs
bGFibGU+KF9fY2FsbGFibGUpKSwKICAgICAgICAgIHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdz
KS4uLik7CiAgICB9CgoKCgoKCiAgY2xhc3MgYmFkX2Z1bmN0aW9uX2NhbGwgOiBwdWJsaWMgc3Rk
OjpleGNlcHRpb24KICB7CiAgcHVibGljOgogICAgdmlydHVhbCB+YmFkX2Z1bmN0aW9uX2NhbGwo
KSBub2V4Y2VwdDsKCiAgICBjb25zdCBjaGFyKiB3aGF0KCkgY29uc3Qgbm9leGNlcHQ7CiAgfTsK
CgoKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9faXNfbG9jYXRpb25f
aW52YXJpYW50CiAgICA6IGlzX3RyaXZpYWxseV9jb3B5YWJsZTxfVHA+Ojp0eXBlCiAgICB7IH07
CgogIGNsYXNzIF9VbmRlZmluZWRfY2xhc3M7CgogIHVuaW9uIF9Ob2NvcHlfdHlwZXMKICB7CiAg
ICB2b2lkKiBfTV9vYmplY3Q7CiAgICBjb25zdCB2b2lkKiBfTV9jb25zdF9vYmplY3Q7CiAgICB2
b2lkICgqX01fZnVuY3Rpb25fcG9pbnRlcikoKTsKICAgIHZvaWQgKF9VbmRlZmluZWRfY2xhc3M6
OipfTV9tZW1iZXJfcG9pbnRlcikoKTsKICB9OwoKICB1bmlvbiBfQW55X2RhdGEKICB7CiAgICB2
b2lkKiBfTV9hY2Nlc3MoKSB7IHJldHVybiAmX01fcG9kX2RhdGFbMF07IH0KICAgIGNvbnN0IHZv
aWQqIF9NX2FjY2VzcygpIGNvbnN0IHsgcmV0dXJuICZfTV9wb2RfZGF0YVswXTsgfQoKICAgIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgICAgX1RwJgogICAgICBfTV9hY2Nlc3MoKQogICAgICB7
IHJldHVybiAqc3RhdGljX2Nhc3Q8X1RwKj4oX01fYWNjZXNzKCkpOyB9CgogICAgdGVtcGxhdGU8
dHlwZW5hbWUgX1RwPgogICAgICBjb25zdCBfVHAmCiAgICAgIF9NX2FjY2VzcygpIGNvbnN0CiAg
ICAgIHsgcmV0dXJuICpzdGF0aWNfY2FzdDxjb25zdCBfVHAqPihfTV9hY2Nlc3MoKSk7IH0KCiAg
ICBfTm9jb3B5X3R5cGVzIF9NX3VudXNlZDsKICAgIGNoYXIgX01fcG9kX2RhdGFbc2l6ZW9mKF9O
b2NvcHlfdHlwZXMpXTsKICB9OwoKICBlbnVtIF9NYW5hZ2VyX29wZXJhdGlvbgogIHsKICAgIF9f
Z2V0X3R5cGVfaW5mbywKICAgIF9fZ2V0X2Z1bmN0b3JfcHRyLAogICAgX19jbG9uZV9mdW5jdG9y
LAogICAgX19kZXN0cm95X2Z1bmN0b3IKICB9OwoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4K
ICAgIHN0cnVjdCBfU2ltcGxlX3R5cGVfd3JhcHBlcgogICAgewogICAgICBfU2ltcGxlX3R5cGVf
d3JhcHBlcihfVHAgX192YWx1ZSkgOiBfX3ZhbHVlKF9fdmFsdWUpIHsgfQoKICAgICAgX1RwIF9f
dmFsdWU7CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX19pc19s
b2NhdGlvbl9pbnZhcmlhbnQ8X1NpbXBsZV90eXBlX3dyYXBwZXI8X1RwPiA+CiAgICA6IF9faXNf
bG9jYXRpb25faW52YXJpYW50PF9UcD4KICAgIHsgfTsKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
RnVuY3Rvcj4KICAgIGlubGluZSBfRnVuY3RvciYKICAgIF9fY2FsbGFibGVfZnVuY3RvcihfRnVu
Y3RvciYgX19mKQogICAgeyByZXR1cm4gX19mOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9NZW1i
ZXIsIHR5cGVuYW1lIF9DbGFzcz4KICAgIGlubGluZSBfTWVtX2ZuPF9NZW1iZXIgX0NsYXNzOjoq
PgogICAgX19jYWxsYWJsZV9mdW5jdG9yKF9NZW1iZXIgX0NsYXNzOjoqICZfX3ApCiAgICB7IHJl
dHVybiBzdGQ6Om1lbV9mbihfX3ApOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9NZW1iZXIsIHR5
cGVuYW1lIF9DbGFzcz4KICAgIGlubGluZSBfTWVtX2ZuPF9NZW1iZXIgX0NsYXNzOjoqPgogICAg
X19jYWxsYWJsZV9mdW5jdG9yKF9NZW1iZXIgX0NsYXNzOjoqIGNvbnN0ICZfX3ApCiAgICB7IHJl
dHVybiBzdGQ6Om1lbV9mbihfX3ApOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9NZW1iZXIsIHR5
cGVuYW1lIF9DbGFzcz4KICAgIGlubGluZSBfTWVtX2ZuPF9NZW1iZXIgX0NsYXNzOjoqPgogICAg
X19jYWxsYWJsZV9mdW5jdG9yKF9NZW1iZXIgX0NsYXNzOjoqIHZvbGF0aWxlICZfX3ApCiAgICB7
IHJldHVybiBzdGQ6Om1lbV9mbihfX3ApOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9NZW1iZXIs
IHR5cGVuYW1lIF9DbGFzcz4KICAgIGlubGluZSBfTWVtX2ZuPF9NZW1iZXIgX0NsYXNzOjoqPgog
ICAgX19jYWxsYWJsZV9mdW5jdG9yKF9NZW1iZXIgX0NsYXNzOjoqIGNvbnN0IHZvbGF0aWxlICZf
X3ApCiAgICB7IHJldHVybiBzdGQ6Om1lbV9mbihfX3ApOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9TaWduYXR1cmU+CiAgICBjbGFzcyBmdW5jdGlvbjsKCgogIGNsYXNzIF9GdW5jdGlvbl9iYXNl
CiAgewogIHB1YmxpYzoKICAgIHN0YXRpYyBjb25zdCBzdGQ6OnNpemVfdCBfTV9tYXhfc2l6ZSA9
IHNpemVvZihfTm9jb3B5X3R5cGVzKTsKICAgIHN0YXRpYyBjb25zdCBzdGQ6OnNpemVfdCBfTV9t
YXhfYWxpZ24gPSBfX2FsaWdub2ZfXyhfTm9jb3B5X3R5cGVzKTsKCiAgICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfRnVuY3Rvcj4KICAgICAgY2xhc3MgX0Jhc2VfbWFuYWdlcgogICAgICB7CiAgICAgIHBy
b3RlY3RlZDoKIHN0YXRpYyBjb25zdCBib29sIF9fc3RvcmVkX2xvY2FsbHkgPQogKF9faXNfbG9j
YXRpb25faW52YXJpYW50PF9GdW5jdG9yPjo6dmFsdWUKICAmJiBzaXplb2YoX0Z1bmN0b3IpIDw9
IF9NX21heF9zaXplCiAgJiYgX19hbGlnbm9mX18oX0Z1bmN0b3IpIDw9IF9NX21heF9hbGlnbgog
ICYmIChfTV9tYXhfYWxpZ24gJSBfX2FsaWdub2ZfXyhfRnVuY3RvcikgPT0gMCkpOwoKIHR5cGVk
ZWYgaW50ZWdyYWxfY29uc3RhbnQ8Ym9vbCwgX19zdG9yZWRfbG9jYWxseT4gX0xvY2FsX3N0b3Jh
Z2U7CgoKIHN0YXRpYyBfRnVuY3RvcioKIF9NX2dldF9wb2ludGVyKGNvbnN0IF9BbnlfZGF0YSYg
X19zb3VyY2UpCiB7CiAgIGNvbnN0IF9GdW5jdG9yKiBfX3B0ciA9CiAgICAgX19zdG9yZWRfbG9j
YWxseT8gc3RkOjpfX2FkZHJlc3NvZihfX3NvdXJjZS5fTV9hY2Nlc3M8X0Z1bmN0b3I+KCkpCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogX19zb3VyY2UuX01fYWNjZXNzPF9GdW5j
dG9yKj4oKTsKICAgcmV0dXJuIGNvbnN0X2Nhc3Q8X0Z1bmN0b3IqPihfX3B0cik7CiB9CgoKCiBz
dGF0aWMgdm9pZAogX01fY2xvbmUoX0FueV9kYXRhJiBfX2Rlc3QsIGNvbnN0IF9BbnlfZGF0YSYg
X19zb3VyY2UsIHRydWVfdHlwZSkKIHsKICAgbmV3IChfX2Rlc3QuX01fYWNjZXNzKCkpIF9GdW5j
dG9yKF9fc291cmNlLl9NX2FjY2VzczxfRnVuY3Rvcj4oKSk7CiB9CgoKCiBzdGF0aWMgdm9pZAog
X01fY2xvbmUoX0FueV9kYXRhJiBfX2Rlc3QsIGNvbnN0IF9BbnlfZGF0YSYgX19zb3VyY2UsIGZh
bHNlX3R5cGUpCiB7CiAgIF9fZGVzdC5fTV9hY2Nlc3M8X0Z1bmN0b3IqPigpID0KICAgICBuZXcg
X0Z1bmN0b3IoKl9fc291cmNlLl9NX2FjY2VzczxfRnVuY3Rvcio+KCkpOwogfQoKCgogc3RhdGlj
IHZvaWQKIF9NX2Rlc3Ryb3koX0FueV9kYXRhJiBfX3ZpY3RpbSwgdHJ1ZV90eXBlKQogewogICBf
X3ZpY3RpbS5fTV9hY2Nlc3M8X0Z1bmN0b3I+KCkufl9GdW5jdG9yKCk7CiB9CgoKIHN0YXRpYyB2
b2lkCiBfTV9kZXN0cm95KF9BbnlfZGF0YSYgX192aWN0aW0sIGZhbHNlX3R5cGUpCiB7CiAgIGRl
bGV0ZSBfX3ZpY3RpbS5fTV9hY2Nlc3M8X0Z1bmN0b3IqPigpOwogfQoKICAgICAgcHVibGljOgog
c3RhdGljIGJvb2wKIF9NX21hbmFnZXIoX0FueV9kYXRhJiBfX2Rlc3QsIGNvbnN0IF9BbnlfZGF0
YSYgX19zb3VyY2UsCiAgICAgX01hbmFnZXJfb3BlcmF0aW9uIF9fb3ApCiB7CiAgIHN3aXRjaCAo
X19vcCkKICAgICB7CgogICAgIGNhc2UgX19nZXRfdHlwZV9pbmZvOgogICAgICAgX19kZXN0Ll9N
X2FjY2Vzczxjb25zdCB0eXBlX2luZm8qPigpID0gJnR5cGVpZChfRnVuY3Rvcik7CiAgICAgICBi
cmVhazsKCiAgICAgY2FzZSBfX2dldF9mdW5jdG9yX3B0cjoKICAgICAgIF9fZGVzdC5fTV9hY2Nl
c3M8X0Z1bmN0b3IqPigpID0gX01fZ2V0X3BvaW50ZXIoX19zb3VyY2UpOwogICAgICAgYnJlYWs7
CgogICAgIGNhc2UgX19jbG9uZV9mdW5jdG9yOgogICAgICAgX01fY2xvbmUoX19kZXN0LCBfX3Nv
dXJjZSwgX0xvY2FsX3N0b3JhZ2UoKSk7CiAgICAgICBicmVhazsKCiAgICAgY2FzZSBfX2Rlc3Ry
b3lfZnVuY3RvcjoKICAgICAgIF9NX2Rlc3Ryb3koX19kZXN0LCBfTG9jYWxfc3RvcmFnZSgpKTsK
ICAgICAgIGJyZWFrOwogICAgIH0KICAgcmV0dXJuIGZhbHNlOwogfQoKIHN0YXRpYyB2b2lkCiBf
TV9pbml0X2Z1bmN0b3IoX0FueV9kYXRhJiBfX2Z1bmN0b3IsIF9GdW5jdG9yJiYgX19mKQogeyBf
TV9pbml0X2Z1bmN0b3IoX19mdW5jdG9yLCBzdGQ6Om1vdmUoX19mKSwgX0xvY2FsX3N0b3JhZ2Uo
KSk7IH0KCiB0ZW1wbGF0ZTx0eXBlbmFtZSBfU2lnbmF0dXJlPgogICBzdGF0aWMgYm9vbAogICBf
TV9ub3RfZW1wdHlfZnVuY3Rpb24oY29uc3QgZnVuY3Rpb248X1NpZ25hdHVyZT4mIF9fZikKICAg
eyByZXR1cm4gc3RhdGljX2Nhc3Q8Ym9vbD4oX19mKTsgfQoKIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cD4KICAgc3RhdGljIGJvb2wKICAgX01fbm90X2VtcHR5X2Z1bmN0aW9uKF9UcCogX19mcCkKICAg
eyByZXR1cm4gX19mcCAhPSBudWxscHRyOyB9CgogdGVtcGxhdGU8dHlwZW5hbWUgX0NsYXNzLCB0
eXBlbmFtZSBfVHA+CiAgIHN0YXRpYyBib29sCiAgIF9NX25vdF9lbXB0eV9mdW5jdGlvbihfVHAg
X0NsYXNzOjoqIF9fbXApCiAgIHsgcmV0dXJuIF9fbXAgIT0gbnVsbHB0cjsgfQoKIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcD4KICAgc3RhdGljIGJvb2wKICAgX01fbm90X2VtcHR5X2Z1bmN0aW9uKGNv
bnN0IF9UcCYpCiAgIHsgcmV0dXJuIHRydWU7IH0KCiAgICAgIHByaXZhdGU6CiBzdGF0aWMgdm9p
ZAogX01faW5pdF9mdW5jdG9yKF9BbnlfZGF0YSYgX19mdW5jdG9yLCBfRnVuY3RvciYmIF9fZiwg
dHJ1ZV90eXBlKQogeyBuZXcgKF9fZnVuY3Rvci5fTV9hY2Nlc3MoKSkgX0Z1bmN0b3Ioc3RkOjpt
b3ZlKF9fZikpOyB9Cgogc3RhdGljIHZvaWQKIF9NX2luaXRfZnVuY3RvcihfQW55X2RhdGEmIF9f
ZnVuY3RvciwgX0Z1bmN0b3ImJiBfX2YsIGZhbHNlX3R5cGUpCiB7IF9fZnVuY3Rvci5fTV9hY2Nl
c3M8X0Z1bmN0b3IqPigpID0gbmV3IF9GdW5jdG9yKHN0ZDo6bW92ZShfX2YpKTsgfQogICAgICB9
OwoKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9GdW5jdG9yPgogICAgICBjbGFzcyBfUmVmX21hbmFn
ZXIgOiBwdWJsaWMgX0Jhc2VfbWFuYWdlcjxfRnVuY3Rvcio+CiAgICAgIHsKIHR5cGVkZWYgX0Z1
bmN0aW9uX2Jhc2U6Ol9CYXNlX21hbmFnZXI8X0Z1bmN0b3IqPiBfQmFzZTsKCiAgICAgIHB1Ymxp
YzoKIHN0YXRpYyBib29sCiBfTV9tYW5hZ2VyKF9BbnlfZGF0YSYgX19kZXN0LCBjb25zdCBfQW55
X2RhdGEmIF9fc291cmNlLAogICAgIF9NYW5hZ2VyX29wZXJhdGlvbiBfX29wKQogewogICBzd2l0
Y2ggKF9fb3ApCiAgICAgewoKICAgICBjYXNlIF9fZ2V0X3R5cGVfaW5mbzoKICAgICAgIF9fZGVz
dC5fTV9hY2Nlc3M8Y29uc3QgdHlwZV9pbmZvKj4oKSA9ICZ0eXBlaWQoX0Z1bmN0b3IpOwogICAg
ICAgYnJlYWs7CgogICAgIGNhc2UgX19nZXRfZnVuY3Rvcl9wdHI6CiAgICAgICBfX2Rlc3QuX01f
YWNjZXNzPF9GdW5jdG9yKj4oKSA9ICpfQmFzZTo6X01fZ2V0X3BvaW50ZXIoX19zb3VyY2UpOwog
ICAgICAgcmV0dXJuIGlzX2NvbnN0PF9GdW5jdG9yPjo6dmFsdWU7CiAgICAgICBicmVhazsKCiAg
ICAgZGVmYXVsdDoKICAgICAgIF9CYXNlOjpfTV9tYW5hZ2VyKF9fZGVzdCwgX19zb3VyY2UsIF9f
b3ApOwogICAgIH0KICAgcmV0dXJuIGZhbHNlOwogfQoKIHN0YXRpYyB2b2lkCiBfTV9pbml0X2Z1
bmN0b3IoX0FueV9kYXRhJiBfX2Z1bmN0b3IsIHJlZmVyZW5jZV93cmFwcGVyPF9GdW5jdG9yPiBf
X2YpCiB7CiAgIF9CYXNlOjpfTV9pbml0X2Z1bmN0b3IoX19mdW5jdG9yLCBzdGQ6Ol9fYWRkcmVz
c29mKF9fZi5nZXQoKSkpOwogfQogICAgICB9OwoKICAgIF9GdW5jdGlvbl9iYXNlKCkgOiBfTV9t
YW5hZ2VyKG51bGxwdHIpIHsgfQoKICAgIH5fRnVuY3Rpb25fYmFzZSgpCiAgICB7CiAgICAgIGlm
IChfTV9tYW5hZ2VyKQogX01fbWFuYWdlcihfTV9mdW5jdG9yLCBfTV9mdW5jdG9yLCBfX2Rlc3Ry
b3lfZnVuY3Rvcik7CiAgICB9CgoKICAgIGJvb2wgX01fZW1wdHkoKSBjb25zdCB7IHJldHVybiAh
X01fbWFuYWdlcjsgfQoKICAgIHR5cGVkZWYgYm9vbCAoKl9NYW5hZ2VyX3R5cGUpKF9BbnlfZGF0
YSYsIGNvbnN0IF9BbnlfZGF0YSYsCiAgICAgIF9NYW5hZ2VyX29wZXJhdGlvbik7CgogICAgX0Fu
eV9kYXRhIF9NX2Z1bmN0b3I7CiAgICBfTWFuYWdlcl90eXBlIF9NX21hbmFnZXI7CiAgfTsKCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1NpZ25hdHVyZSwgdHlwZW5hbWUgX0Z1bmN0b3I+CiAgICBjbGFz
cyBfRnVuY3Rpb25faGFuZGxlcjsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUg
X0Z1bmN0b3IsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIGNsYXNzIF9GdW5jdGlvbl9oYW5k
bGVyPF9SZXMoX0FyZ1R5cGVzLi4uKSwgX0Z1bmN0b3I+CiAgICA6IHB1YmxpYyBfRnVuY3Rpb25f
YmFzZTo6X0Jhc2VfbWFuYWdlcjxfRnVuY3Rvcj4KICAgIHsKICAgICAgdHlwZWRlZiBfRnVuY3Rp
b25fYmFzZTo6X0Jhc2VfbWFuYWdlcjxfRnVuY3Rvcj4gX0Jhc2U7CgogICAgcHVibGljOgogICAg
ICBzdGF0aWMgX1JlcwogICAgICBfTV9pbnZva2UoY29uc3QgX0FueV9kYXRhJiBfX2Z1bmN0b3Is
IF9BcmdUeXBlcyYmLi4uIF9fYXJncykKICAgICAgewogcmV0dXJuICgqX0Jhc2U6Ol9NX2dldF9w
b2ludGVyKF9fZnVuY3RvcikpKAogICAgIHN0ZDo6Zm9yd2FyZDxfQXJnVHlwZXM+KF9fYXJncyku
Li4pOwogICAgICB9CiAgICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnVuY3RvciwgdHlwZW5h
bWUuLi4gX0FyZ1R5cGVzPgogICAgY2xhc3MgX0Z1bmN0aW9uX2hhbmRsZXI8dm9pZChfQXJnVHlw
ZXMuLi4pLCBfRnVuY3Rvcj4KICAgIDogcHVibGljIF9GdW5jdGlvbl9iYXNlOjpfQmFzZV9tYW5h
Z2VyPF9GdW5jdG9yPgogICAgewogICAgICB0eXBlZGVmIF9GdW5jdGlvbl9iYXNlOjpfQmFzZV9t
YW5hZ2VyPF9GdW5jdG9yPiBfQmFzZTsKCiAgICAgcHVibGljOgogICAgICBzdGF0aWMgdm9pZAog
ICAgICBfTV9pbnZva2UoY29uc3QgX0FueV9kYXRhJiBfX2Z1bmN0b3IsIF9BcmdUeXBlcyYmLi4u
IF9fYXJncykKICAgICAgewogKCpfQmFzZTo6X01fZ2V0X3BvaW50ZXIoX19mdW5jdG9yKSkoCiAg
ICAgc3RkOjpmb3J3YXJkPF9BcmdUeXBlcz4oX19hcmdzKS4uLik7CiAgICAgIH0KICAgIH07Cgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lIF9GdW5jdG9yLCB0eXBlbmFtZS4uLiBf
QXJnVHlwZXM+CiAgICBjbGFzcyBfRnVuY3Rpb25faGFuZGxlcjxfUmVzKF9BcmdUeXBlcy4uLiks
IHJlZmVyZW5jZV93cmFwcGVyPF9GdW5jdG9yPiA+CiAgICA6IHB1YmxpYyBfRnVuY3Rpb25fYmFz
ZTo6X1JlZl9tYW5hZ2VyPF9GdW5jdG9yPgogICAgewogICAgICB0eXBlZGVmIF9GdW5jdGlvbl9i
YXNlOjpfUmVmX21hbmFnZXI8X0Z1bmN0b3I+IF9CYXNlOwoKICAgICBwdWJsaWM6CiAgICAgIHN0
YXRpYyBfUmVzCiAgICAgIF9NX2ludm9rZShjb25zdCBfQW55X2RhdGEmIF9fZnVuY3RvciwgX0Fy
Z1R5cGVzJiYuLi4gX19hcmdzKQogICAgICB7CiByZXR1cm4gc3RkOjpfX2NhbGxhYmxlX2Z1bmN0
b3IoKipfQmFzZTo6X01fZ2V0X3BvaW50ZXIoX19mdW5jdG9yKSkoCiAgICAgICBzdGQ6OmZvcndh
cmQ8X0FyZ1R5cGVzPihfX2FyZ3MpLi4uKTsKICAgICAgfQogICAgfTsKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0Z1bmN0b3IsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIGNsYXNzIF9GdW5jdGlv
bl9oYW5kbGVyPHZvaWQoX0FyZ1R5cGVzLi4uKSwgcmVmZXJlbmNlX3dyYXBwZXI8X0Z1bmN0b3I+
ID4KICAgIDogcHVibGljIF9GdW5jdGlvbl9iYXNlOjpfUmVmX21hbmFnZXI8X0Z1bmN0b3I+CiAg
ICB7CiAgICAgIHR5cGVkZWYgX0Z1bmN0aW9uX2Jhc2U6Ol9SZWZfbWFuYWdlcjxfRnVuY3Rvcj4g
X0Jhc2U7CgogICAgIHB1YmxpYzoKICAgICAgc3RhdGljIHZvaWQKICAgICAgX01faW52b2tlKGNv
bnN0IF9BbnlfZGF0YSYgX19mdW5jdG9yLCBfQXJnVHlwZXMmJi4uLiBfX2FyZ3MpCiAgICAgIHsK
IHN0ZDo6X19jYWxsYWJsZV9mdW5jdG9yKCoqX0Jhc2U6Ol9NX2dldF9wb2ludGVyKF9fZnVuY3Rv
cikpKAogICAgIHN0ZDo6Zm9yd2FyZDxfQXJnVHlwZXM+KF9fYXJncykuLi4pOwogICAgICB9CiAg
ICB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2xhc3MsIHR5cGVuYW1lIF9NZW1iZXIsIHR5cGVu
YW1lIF9SZXMsCiAgICB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+CiAgICBjbGFzcyBfRnVuY3Rpb25f
aGFuZGxlcjxfUmVzKF9BcmdUeXBlcy4uLiksIF9NZW1iZXIgX0NsYXNzOjoqPgogICAgOiBwdWJs
aWMgX0Z1bmN0aW9uX2hhbmRsZXI8dm9pZChfQXJnVHlwZXMuLi4pLCBfTWVtYmVyIF9DbGFzczo6
Kj4KICAgIHsKICAgICAgdHlwZWRlZiBfRnVuY3Rpb25faGFuZGxlcjx2b2lkKF9BcmdUeXBlcy4u
LiksIF9NZW1iZXIgX0NsYXNzOjoqPgogX0Jhc2U7CgogICAgIHB1YmxpYzoKICAgICAgc3RhdGlj
IF9SZXMKICAgICAgX01faW52b2tlKGNvbnN0IF9BbnlfZGF0YSYgX19mdW5jdG9yLCBfQXJnVHlw
ZXMmJi4uLiBfX2FyZ3MpCiAgICAgIHsKIHJldHVybiBzdGQ6Om1lbV9mbihfQmFzZTo6X01fZ2V0
X3BvaW50ZXIoX19mdW5jdG9yKS0+X192YWx1ZSkoCiAgICAgc3RkOjpmb3J3YXJkPF9BcmdUeXBl
cz4oX19hcmdzKS4uLik7CiAgICAgIH0KICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DbGFz
cywgdHlwZW5hbWUgX01lbWJlciwgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPgogICAgY2xhc3MgX0Z1
bmN0aW9uX2hhbmRsZXI8dm9pZChfQXJnVHlwZXMuLi4pLCBfTWVtYmVyIF9DbGFzczo6Kj4KICAg
IDogcHVibGljIF9GdW5jdGlvbl9iYXNlOjpfQmFzZV9tYW5hZ2VyPAogICBfU2ltcGxlX3R5cGVf
d3JhcHBlcjwgX01lbWJlciBfQ2xhc3M6OiogPiA+CiAgICB7CiAgICAgIHR5cGVkZWYgX01lbWJl
ciBfQ2xhc3M6OiogX0Z1bmN0b3I7CiAgICAgIHR5cGVkZWYgX1NpbXBsZV90eXBlX3dyYXBwZXI8
X0Z1bmN0b3I+IF9XcmFwcGVyOwogICAgICB0eXBlZGVmIF9GdW5jdGlvbl9iYXNlOjpfQmFzZV9t
YW5hZ2VyPF9XcmFwcGVyPiBfQmFzZTsKCiAgICBwdWJsaWM6CiAgICAgIHN0YXRpYyBib29sCiAg
ICAgIF9NX21hbmFnZXIoX0FueV9kYXRhJiBfX2Rlc3QsIGNvbnN0IF9BbnlfZGF0YSYgX19zb3Vy
Y2UsCiAgIF9NYW5hZ2VyX29wZXJhdGlvbiBfX29wKQogICAgICB7CiBzd2l0Y2ggKF9fb3ApCiAg
IHsKCiAgIGNhc2UgX19nZXRfdHlwZV9pbmZvOgogICAgIF9fZGVzdC5fTV9hY2Nlc3M8Y29uc3Qg
dHlwZV9pbmZvKj4oKSA9ICZ0eXBlaWQoX0Z1bmN0b3IpOwogICAgIGJyZWFrOwoKICAgY2FzZSBf
X2dldF9mdW5jdG9yX3B0cjoKICAgICBfX2Rlc3QuX01fYWNjZXNzPF9GdW5jdG9yKj4oKSA9CiAg
ICAgICAmX0Jhc2U6Ol9NX2dldF9wb2ludGVyKF9fc291cmNlKS0+X192YWx1ZTsKICAgICBicmVh
azsKCiAgIGRlZmF1bHQ6CiAgICAgX0Jhc2U6Ol9NX21hbmFnZXIoX19kZXN0LCBfX3NvdXJjZSwg
X19vcCk7CiAgIH0KIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgc3RhdGljIHZvaWQKICAg
ICAgX01faW52b2tlKGNvbnN0IF9BbnlfZGF0YSYgX19mdW5jdG9yLCBfQXJnVHlwZXMmJi4uLiBf
X2FyZ3MpCiAgICAgIHsKIHN0ZDo6bWVtX2ZuKF9CYXNlOjpfTV9nZXRfcG9pbnRlcihfX2Z1bmN0
b3IpLT5fX3ZhbHVlKSgKICAgICBzdGQ6OmZvcndhcmQ8X0FyZ1R5cGVzPihfX2FyZ3MpLi4uKTsK
ICAgICAgfQogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0Zyb20sIHR5cGVuYW1lIF9Ubz4K
ICAgIHVzaW5nIF9fY2hlY2tfZnVuY19yZXR1cm5fdHlwZQogICAgICA9IF9fb3JfPGlzX3ZvaWQ8
X1RvPiwgaXNfc2FtZTxfRnJvbSwgX1RvPiwgaXNfY29udmVydGlibGU8X0Zyb20sIF9Ubz4+OwoK
CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJnVHlwZXM+CiAg
ICBjbGFzcyBmdW5jdGlvbjxfUmVzKF9BcmdUeXBlcy4uLik+CiAgICA6IHB1YmxpYyBfTWF5YmVf
dW5hcnlfb3JfYmluYXJ5X2Z1bmN0aW9uPF9SZXMsIF9BcmdUeXBlcy4uLj4sCiAgICAgIHByaXZh
dGUgX0Z1bmN0aW9uX2Jhc2UKICAgIHsKICAgICAgdHlwZWRlZiBfUmVzIF9TaWduYXR1cmVfdHlw
ZShfQXJnVHlwZXMuLi4pOwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0Z1bmMsCiAgICAgICAg
dHlwZW5hbWUgX1JlczIgPSB0eXBlbmFtZSByZXN1bHRfb2Y8X0Z1bmMoX0FyZ1R5cGVzLi4uKT46
OnR5cGU+CiBzdHJ1Y3QgX0NhbGxhYmxlIDogX19jaGVja19mdW5jX3JldHVybl90eXBlPF9SZXMy
LCBfUmVzPiB7IH07CgoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KIHN0cnVjdCBfQ2Fs
bGFibGU8ZnVuY3Rpb24sIF9UcD4gOiBmYWxzZV90eXBlIHsgfTsKCiAgICAgIHRlbXBsYXRlPHR5
cGVuYW1lIF9Db25kLCB0eXBlbmFtZSBfVHA+CiB1c2luZyBfUmVxdWlyZXMgPSB0eXBlbmFtZSBl
bmFibGVfaWY8X0NvbmQ6OnZhbHVlLCBfVHA+Ojp0eXBlOwoKICAgIHB1YmxpYzoKICAgICAgdHlw
ZWRlZiBfUmVzIHJlc3VsdF90eXBlOwoKCgoKCgoKICAgICAgZnVuY3Rpb24oKSBub2V4Y2VwdAog
ICAgICA6IF9GdW5jdGlvbl9iYXNlKCkgeyB9CgoKCgoKICAgICAgZnVuY3Rpb24obnVsbHB0cl90
KSBub2V4Y2VwdAogICAgICA6IF9GdW5jdGlvbl9iYXNlKCkgeyB9CiMgMTg4OCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9mdW5jdGlvbmFsIiAzCiAgICAgIGZ1bmN0aW9uKGNvbnN0IGZ1bmN0aW9u
JiBfX3gpOwojIDE4OTcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnVuY3Rpb25hbCIgMwogICAg
ICBmdW5jdGlvbihmdW5jdGlvbiYmIF9feCkgOiBfRnVuY3Rpb25fYmFzZSgpCiAgICAgIHsKIF9f
eC5zd2FwKCp0aGlzKTsKICAgICAgfQojIDE5MjAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnVu
Y3Rpb25hbCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRnVuY3RvciwKICAgICAgICB0eXBl
bmFtZSA9IF9SZXF1aXJlczxfX25vdF88aXNfc2FtZTxfRnVuY3RvciwgZnVuY3Rpb24+Piwgdm9p
ZD4sCiAgICAgICAgdHlwZW5hbWUgPSBfUmVxdWlyZXM8X0NhbGxhYmxlPF9GdW5jdG9yPiwgdm9p
ZD4+CiBmdW5jdGlvbihfRnVuY3Rvcik7CiMgMTkzNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9m
dW5jdGlvbmFsIiAzCiAgICAgIGZ1bmN0aW9uJgogICAgICBvcGVyYXRvcj0oY29uc3QgZnVuY3Rp
b24mIF9feCkKICAgICAgewogZnVuY3Rpb24oX194KS5zd2FwKCp0aGlzKTsKIHJldHVybiAqdGhp
czsKICAgICAgfQojIDE5NTUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnVuY3Rpb25hbCIgMwog
ICAgICBmdW5jdGlvbiYKICAgICAgb3BlcmF0b3I9KGZ1bmN0aW9uJiYgX194KQogICAgICB7CiBm
dW5jdGlvbihzdGQ6Om1vdmUoX194KSkuc3dhcCgqdGhpcyk7CiByZXR1cm4gKnRoaXM7CiAgICAg
IH0KIyAxOTY5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Z1bmN0aW9uYWwiIDMKICAgICAgZnVu
Y3Rpb24mCiAgICAgIG9wZXJhdG9yPShudWxscHRyX3QpIG5vZXhjZXB0CiAgICAgIHsKIGlmIChf
TV9tYW5hZ2VyKQogICB7CiAgICAgX01fbWFuYWdlcihfTV9mdW5jdG9yLCBfTV9mdW5jdG9yLCBf
X2Rlc3Ryb3lfZnVuY3Rvcik7CiAgICAgX01fbWFuYWdlciA9IG51bGxwdHI7CiAgICAgX01faW52
b2tlciA9IG51bGxwdHI7CiAgIH0KIHJldHVybiAqdGhpczsKICAgICAgfQojIDE5OTcgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvZnVuY3Rpb25hbCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
RnVuY3Rvcj4KIF9SZXF1aXJlczxfQ2FsbGFibGU8dHlwZW5hbWUgZGVjYXk8X0Z1bmN0b3I+Ojp0
eXBlPiwgZnVuY3Rpb24mPgogb3BlcmF0b3I9KF9GdW5jdG9yJiYgX19mKQogewogICBmdW5jdGlv
bihzdGQ6OmZvcndhcmQ8X0Z1bmN0b3I+KF9fZikpLnN3YXAoKnRoaXMpOwogICByZXR1cm4gKnRo
aXM7CiB9CgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0Z1bmN0b3I+CiBmdW5jdGlvbiYKIG9w
ZXJhdG9yPShyZWZlcmVuY2Vfd3JhcHBlcjxfRnVuY3Rvcj4gX19mKSBub2V4Y2VwdAogewogICBm
dW5jdGlvbihfX2YpLnN3YXAoKnRoaXMpOwogICByZXR1cm4gKnRoaXM7CiB9CiMgMjAyMyAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9mdW5jdGlvbmFsIiAzCiAgICAgIHZvaWQgc3dhcChmdW5jdGlv
biYgX194KQogICAgICB7CiBzdGQ6OnN3YXAoX01fZnVuY3RvciwgX194Ll9NX2Z1bmN0b3IpOwog
c3RkOjpzd2FwKF9NX21hbmFnZXIsIF9feC5fTV9tYW5hZ2VyKTsKIHN0ZDo6c3dhcChfTV9pbnZv
a2VyLCBfX3guX01faW52b2tlcik7CiAgICAgIH0KIyAyMDUxICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2Z1bmN0aW9uYWwiIDMKICAgICAgZXhwbGljaXQgb3BlcmF0b3IgYm9vbCgpIGNvbnN0IG5v
ZXhjZXB0CiAgICAgIHsgcmV0dXJuICFfTV9lbXB0eSgpOyB9CiMgMjA2NCAiL3Vzci9pbmNsdWRl
L2MrKy82LjAuMC9mdW5jdGlvbmFsIiAzCiAgICAgIF9SZXMgb3BlcmF0b3IoKShfQXJnVHlwZXMu
Li4gX19hcmdzKSBjb25zdDsKIyAyMDc3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Z1bmN0aW9u
YWwiIDMKICAgICAgY29uc3QgdHlwZV9pbmZvJiB0YXJnZXRfdHlwZSgpIGNvbnN0IG5vZXhjZXB0
OwojIDIwODggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnVuY3Rpb25hbCIgMwogICAgICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfRnVuY3Rvcj4gX0Z1bmN0b3IqIHRhcmdldCgpIG5vZXhjZXB0OwoKCiAg
ICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9GdW5jdG9yPiBjb25zdCBfRnVuY3RvciogdGFyZ2V0KCkg
Y29uc3Qgbm9leGNlcHQ7CgoKICAgIHByaXZhdGU6CiAgICAgIHVzaW5nIF9JbnZva2VyX3R5cGUg
PSBfUmVzICgqKShjb25zdCBfQW55X2RhdGEmLCBfQXJnVHlwZXMmJi4uLik7CiAgICAgIF9JbnZv
a2VyX3R5cGUgX01faW52b2tlcjsKICB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlw
ZW5hbWUuLi4gX0FyZ1R5cGVzPgogICAgZnVuY3Rpb248X1JlcyhfQXJnVHlwZXMuLi4pPjo6CiAg
ICBmdW5jdGlvbihjb25zdCBmdW5jdGlvbiYgX194KQogICAgOiBfRnVuY3Rpb25fYmFzZSgpCiAg
ICB7CiAgICAgIGlmIChzdGF0aWNfY2FzdDxib29sPihfX3gpKQogewogICBfX3guX01fbWFuYWdl
cihfTV9mdW5jdG9yLCBfX3guX01fZnVuY3RvciwgX19jbG9uZV9mdW5jdG9yKTsKICAgX01faW52
b2tlciA9IF9feC5fTV9pbnZva2VyOwogICBfTV9tYW5hZ2VyID0gX194Ll9NX21hbmFnZXI7CiB9
CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9SZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4K
ICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9GdW5jdG9yLCB0eXBlbmFtZSwgdHlwZW5hbWU+CiAgICAg
IGZ1bmN0aW9uPF9SZXMoX0FyZ1R5cGVzLi4uKT46OgogICAgICBmdW5jdGlvbihfRnVuY3RvciBf
X2YpCiAgICAgIDogX0Z1bmN0aW9uX2Jhc2UoKQogICAgICB7CiB0eXBlZGVmIF9GdW5jdGlvbl9o
YW5kbGVyPF9TaWduYXR1cmVfdHlwZSwgX0Z1bmN0b3I+IF9NeV9oYW5kbGVyOwoKIGlmIChfTXlf
aGFuZGxlcjo6X01fbm90X2VtcHR5X2Z1bmN0aW9uKF9fZikpCiAgIHsKICAgICBfTXlfaGFuZGxl
cjo6X01faW5pdF9mdW5jdG9yKF9NX2Z1bmN0b3IsIHN0ZDo6bW92ZShfX2YpKTsKICAgICBfTV9p
bnZva2VyID0gJl9NeV9oYW5kbGVyOjpfTV9pbnZva2U7CiAgICAgX01fbWFuYWdlciA9ICZfTXlf
aGFuZGxlcjo6X01fbWFuYWdlcjsKICAgfQogICAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9S
ZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIF9SZXMKICAgIGZ1bmN0aW9uPF9SZXMoX0Fy
Z1R5cGVzLi4uKT46OgogICAgb3BlcmF0b3IoKShfQXJnVHlwZXMuLi4gX19hcmdzKSBjb25zdAog
ICAgewogICAgICBpZiAoX01fZW1wdHkoKSkKIF9fdGhyb3dfYmFkX2Z1bmN0aW9uX2NhbGwoKTsK
ICAgICAgcmV0dXJuIF9NX2ludm9rZXIoX01fZnVuY3Rvciwgc3RkOjpmb3J3YXJkPF9BcmdUeXBl
cz4oX19hcmdzKS4uLik7CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFt
ZS4uLiBfQXJnVHlwZXM+CiAgICBjb25zdCB0eXBlX2luZm8mCiAgICBmdW5jdGlvbjxfUmVzKF9B
cmdUeXBlcy4uLik+OjoKICAgIHRhcmdldF90eXBlKCkgY29uc3Qgbm9leGNlcHQKICAgIHsKICAg
ICAgaWYgKF9NX21hbmFnZXIpCiB7CiAgIF9BbnlfZGF0YSBfX3R5cGVpbmZvX3Jlc3VsdDsKICAg
X01fbWFuYWdlcihfX3R5cGVpbmZvX3Jlc3VsdCwgX01fZnVuY3RvciwgX19nZXRfdHlwZV9pbmZv
KTsKICAgcmV0dXJuICpfX3R5cGVpbmZvX3Jlc3VsdC5fTV9hY2Nlc3M8Y29uc3QgdHlwZV9pbmZv
Kj4oKTsKIH0KICAgICAgZWxzZQogcmV0dXJuIHR5cGVpZCh2b2lkKTsKICAgIH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUuLi4gX0FyZ1R5cGVzPgogICAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0Z1bmN0b3I+CiAgICAgIF9GdW5jdG9yKgogICAgICBmdW5jdGlvbjxfUmVzKF9BcmdU
eXBlcy4uLik+OjoKICAgICAgdGFyZ2V0KCkgbm9leGNlcHQKICAgICAgewogaWYgKHR5cGVpZChf
RnVuY3RvcikgPT0gdGFyZ2V0X3R5cGUoKSAmJiBfTV9tYW5hZ2VyKQogICB7CiAgICAgX0FueV9k
YXRhIF9fcHRyOwogICAgIGlmIChfTV9tYW5hZ2VyKF9fcHRyLCBfTV9mdW5jdG9yLCBfX2dldF9m
dW5jdG9yX3B0cikKICAmJiAhaXNfY29uc3Q8X0Z1bmN0b3I+Ojp2YWx1ZSkKICAgICAgIHJldHVy
biAwOwogICAgIGVsc2UKICAgICAgIHJldHVybiBfX3B0ci5fTV9hY2Nlc3M8X0Z1bmN0b3IqPigp
OwogICB9CiBlbHNlCiAgIHJldHVybiAwOwogICAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9S
ZXMsIHR5cGVuYW1lLi4uIF9BcmdUeXBlcz4KICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9GdW5jdG9y
PgogICAgICBjb25zdCBfRnVuY3RvcioKICAgICAgZnVuY3Rpb248X1JlcyhfQXJnVHlwZXMuLi4p
Pjo6CiAgICAgIHRhcmdldCgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsKIGlmICh0eXBlaWQoX0Z1
bmN0b3IpID09IHRhcmdldF90eXBlKCkgJiYgX01fbWFuYWdlcikKICAgewogICAgIF9BbnlfZGF0
YSBfX3B0cjsKICAgICBfTV9tYW5hZ2VyKF9fcHRyLCBfTV9mdW5jdG9yLCBfX2dldF9mdW5jdG9y
X3B0cik7CiAgICAgcmV0dXJuIF9fcHRyLl9NX2FjY2Vzczxjb25zdCBfRnVuY3Rvcio+KCk7CiAg
IH0KIGVsc2UKICAgcmV0dXJuIDA7CiAgICAgIH0KIyAyMjAwICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2Z1bmN0aW9uYWwiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBf
QXJncz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj09KGNvbnN0IGZ1bmN0aW9uPF9SZXMo
X0FyZ3MuLi4pPiYgX19mLCBudWxscHRyX3QpIG5vZXhjZXB0CiAgICB7IHJldHVybiAhc3RhdGlj
X2Nhc3Q8Ym9vbD4oX19mKTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUu
Li4gX0FyZ3M+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I9PShudWxscHRyX3QsIGNvbnN0
IGZ1bmN0aW9uPF9SZXMoX0FyZ3MuLi4pPiYgX19mKSBub2V4Y2VwdAogICAgeyByZXR1cm4gIXN0
YXRpY19jYXN0PGJvb2w+KF9fZik7IH0KIyAyMjE4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Z1
bmN0aW9uYWwiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJncz4K
ICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvciE9KGNvbnN0IGZ1bmN0aW9uPF9SZXMoX0FyZ3Mu
Li4pPiYgX19mLCBudWxscHRyX3QpIG5vZXhjZXB0CiAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxi
b29sPihfX2YpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUmVzLCB0eXBlbmFtZS4uLiBfQXJn
cz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvciE9KG51bGxwdHJfdCwgY29uc3QgZnVuY3Rp
b248X1JlcyhfQXJncy4uLik+JiBfX2YpIG5vZXhjZXB0CiAgICB7IHJldHVybiBzdGF0aWNfY2Fz
dDxib29sPihfX2YpOyB9CiMgMjIzNiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9mdW5jdGlvbmFs
IiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1JlcywgdHlwZW5hbWUuLi4gX0FyZ3M+CiAgICBpbmxp
bmUgdm9pZAogICAgc3dhcChmdW5jdGlvbjxfUmVzKF9BcmdzLi4uKT4mIF9feCwgZnVuY3Rpb248
X1JlcyhfQXJncy4uLik+JiBfX3kpCiAgICB7IF9feC5zd2FwKF9feSk7IH0KCgp9CiMgODAgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvbWVtb3J5IiAyIDMKCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3VuaXF1ZV9wdHIuaCIgMSAzCiMgMzkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy91bmlxdWVfcHRyLmgiIDMKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNp
YmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZT4gY2xh
c3MgYXV0b19wdHI7CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGRlZmF1
bHRfZGVsZXRlCiAgICB7CgogICAgICBjb25zdGV4cHIgZGVmYXVsdF9kZWxldGUoKSBub2V4Y2Vw
dCA9IGRlZmF1bHQ7CgoKCgoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VcCwgdHlwZW5hbWUg
PSB0eXBlbmFtZQogICAgICAgIGVuYWJsZV9pZjxpc19jb252ZXJ0aWJsZTxfVXAqLCBfVHAqPjo6
dmFsdWU+Ojp0eXBlPgogICAgICAgIGRlZmF1bHRfZGVsZXRlKGNvbnN0IGRlZmF1bHRfZGVsZXRl
PF9VcD4mKSBub2V4Y2VwdCB7IH0KCgogICAgICB2b2lkCiAgICAgIG9wZXJhdG9yKCkoX1RwKiBf
X3B0cikgY29uc3QKICAgICAgewogc3RhdGljX2Fzc2VydCghaXNfdm9pZDxfVHA+Ojp2YWx1ZSwK
ICAgICAgICAiY2FuJ3QgZGVsZXRlIHBvaW50ZXIgdG8gaW5jb21wbGV0ZSB0eXBlIik7CiBzdGF0
aWNfYXNzZXJ0KHNpemVvZihfVHApPjAsCiAgICAgICAgImNhbid0IGRlbGV0ZSBwb2ludGVyIHRv
IGluY29tcGxldGUgdHlwZSIpOwogZGVsZXRlIF9fcHRyOwogICAgICB9CiAgICB9OwoKCgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgZGVmYXVsdF9kZWxldGU8X1RwW10+CiAg
ICB7CiAgICBwdWJsaWM6CgogICAgICBjb25zdGV4cHIgZGVmYXVsdF9kZWxldGUoKSBub2V4Y2Vw
dCA9IGRlZmF1bHQ7CiMgOTkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy91bmlxdWVfcHRy
LmgiIDMKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1VwLCB0eXBlbmFtZSA9IHR5cGVuYW1lCiAg
ICAgICAgZW5hYmxlX2lmPGlzX2NvbnZlcnRpYmxlPF9VcCgqKVtdLCBfVHAoKilbXT46OnZhbHVl
Pjo6dHlwZT4KICAgICAgICBkZWZhdWx0X2RlbGV0ZShjb25zdCBkZWZhdWx0X2RlbGV0ZTxfVXBb
XT4mKSBub2V4Y2VwdCB7IH0KCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVXA+CiAgICAgIHR5
cGVuYW1lIGVuYWJsZV9pZjxpc19jb252ZXJ0aWJsZTxfVXAoKilbXSwgX1RwKCopW10+Ojp2YWx1
ZT46OnR5cGUKIG9wZXJhdG9yKCkoX1VwKiBfX3B0cikgY29uc3QKICAgICAgewogc3RhdGljX2Fz
c2VydChzaXplb2YoX1RwKT4wLAogICAgICAgICJjYW4ndCBkZWxldGUgcG9pbnRlciB0byBpbmNv
bXBsZXRlIHR5cGUiKTsKIGRlbGV0ZSBbXSBfX3B0cjsKICAgICAgfQogICAgfTsKCgogIHRlbXBs
YXRlIDx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9EcCA9IGRlZmF1bHRfZGVsZXRlPF9UcD4gPgog
ICAgY2xhc3MgdW5pcXVlX3B0cgogICAgewoKICAgICAgY2xhc3MgX1BvaW50ZXIKICAgICAgewog
dGVtcGxhdGU8dHlwZW5hbWUgX1VwPgogICBzdGF0aWMgdHlwZW5hbWUgX1VwOjpwb2ludGVyIF9f
dGVzdCh0eXBlbmFtZSBfVXA6OnBvaW50ZXIqKTsKCiB0ZW1wbGF0ZTx0eXBlbmFtZSBfVXA+CiAg
IHN0YXRpYyBfVHAqIF9fdGVzdCguLi4pOwoKIHR5cGVkZWYgdHlwZW5hbWUgcmVtb3ZlX3JlZmVy
ZW5jZTxfRHA+Ojp0eXBlIF9EZWw7CgogICAgICBwdWJsaWM6CiB0eXBlZGVmIGRlY2x0eXBlKF9f
dGVzdDxfRGVsPigwKSkgdHlwZTsKICAgICAgfTsKCiAgICAgIHR5cGVkZWYgc3RkOjp0dXBsZTx0
eXBlbmFtZSBfUG9pbnRlcjo6dHlwZSwgX0RwPiBfX3R1cGxlX3R5cGU7CiAgICAgIF9fdHVwbGVf
dHlwZSBfTV90OwoKICAgIHB1YmxpYzoKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfUG9pbnRlcjo6
dHlwZSBwb2ludGVyOwogICAgICB0eXBlZGVmIF9UcCBlbGVtZW50X3R5cGU7CiAgICAgIHR5cGVk
ZWYgX0RwIGRlbGV0ZXJfdHlwZTsKCgoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VcCwgdHlw
ZW5hbWUgX0VwPgogdXNpbmcgX19zYWZlX2NvbnZlcnNpb25fdXAgPSBfX2FuZF88CiAgICAgICAg
IGlzX2NvbnZlcnRpYmxlPHR5cGVuYW1lIHVuaXF1ZV9wdHI8X1VwLCBfRXA+Ojpwb2ludGVyLCBw
b2ludGVyPiwKICAgICAgICAgICAgICAgIF9fbm90Xzxpc19hcnJheTxfVXA+PiwKICAgICAgICAg
ICAgICAgIF9fb3JfPF9fYW5kXzxpc19yZWZlcmVuY2U8ZGVsZXRlcl90eXBlPiwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBpc19zYW1lPGRlbGV0ZXJfdHlwZSwgX0VwPj4sCiAgICAgICAg
ICAgICAgICAgICAgICBfX2FuZF88X19ub3RfPGlzX3JlZmVyZW5jZTxkZWxldGVyX3R5cGU+PiwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc19jb252ZXJ0aWJsZTxfRXAsIGRlbGV0ZXJf
dHlwZT4+CiAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgPjsKCgoKCiAgICAgIGNvbnN0
ZXhwciB1bmlxdWVfcHRyKCkgbm9leGNlcHQKICAgICAgOiBfTV90KCkKICAgICAgeyBzdGF0aWNf
YXNzZXJ0KCFpc19wb2ludGVyPGRlbGV0ZXJfdHlwZT46OnZhbHVlLAogICAgICAgImNvbnN0cnVj
dGVkIHdpdGggbnVsbCBmdW5jdGlvbiBwb2ludGVyIGRlbGV0ZXIiKTsgfQoKCgoKCgoKICAgICAg
ZXhwbGljaXQKICAgICAgdW5pcXVlX3B0cihwb2ludGVyIF9fcCkgbm9leGNlcHQKICAgICAgOiBf
TV90KF9fcCwgZGVsZXRlcl90eXBlKCkpCiAgICAgIHsgc3RhdGljX2Fzc2VydCghaXNfcG9pbnRl
cjxkZWxldGVyX3R5cGU+Ojp2YWx1ZSwKICAgICAgICJjb25zdHJ1Y3RlZCB3aXRoIG51bGwgZnVu
Y3Rpb24gcG9pbnRlciBkZWxldGVyIik7IH0KIyAxODIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy91bmlxdWVfcHRyLmgiIDMKICAgICAgdW5pcXVlX3B0cihwb2ludGVyIF9fcCwKICAgdHlw
ZW5hbWUgY29uZGl0aW9uYWw8aXNfcmVmZXJlbmNlPGRlbGV0ZXJfdHlwZT46OnZhbHVlLAogICAg
IGRlbGV0ZXJfdHlwZSwgY29uc3QgZGVsZXRlcl90eXBlJj46OnR5cGUgX19kKSBub2V4Y2VwdAog
ICAgICA6IF9NX3QoX19wLCBfX2QpIHsgfQojIDE5NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3VuaXF1ZV9wdHIuaCIgMwogICAgICB1bmlxdWVfcHRyKHBvaW50ZXIgX19wLAogICB0eXBl
bmFtZSByZW1vdmVfcmVmZXJlbmNlPGRlbGV0ZXJfdHlwZT46OnR5cGUmJiBfX2QpIG5vZXhjZXB0
CiAgICAgIDogX01fdChzdGQ6Om1vdmUoX19wKSwgc3RkOjptb3ZlKF9fZCkpCiAgICAgIHsgc3Rh
dGljX2Fzc2VydCghc3RkOjppc19yZWZlcmVuY2U8ZGVsZXRlcl90eXBlPjo6dmFsdWUsCiAgICAg
ICAgInJ2YWx1ZSBkZWxldGVyIGJvdW5kIHRvIHJlZmVyZW5jZSIpOyB9CgoKICAgICAgY29uc3Rl
eHByIHVuaXF1ZV9wdHIobnVsbHB0cl90KSBub2V4Y2VwdCA6IHVuaXF1ZV9wdHIoKSB7IH0KCgoK
CiAgICAgIHVuaXF1ZV9wdHIodW5pcXVlX3B0ciYmIF9fdSkgbm9leGNlcHQKICAgICAgOiBfTV90
KF9fdS5yZWxlYXNlKCksIHN0ZDo6Zm9yd2FyZDxkZWxldGVyX3R5cGU+KF9fdS5nZXRfZGVsZXRl
cigpKSkgeyB9CgoKCgoKCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVXAsIHR5cGVuYW1lIF9F
cCwgdHlwZW5hbWUgPSBfUmVxdWlyZTwKICAgICAgICAgICAgICAgX19zYWZlX2NvbnZlcnNpb25f
dXA8X1VwLCBfRXA+LAogICAgICAgIHR5cGVuYW1lIGNvbmRpdGlvbmFsPGlzX3JlZmVyZW5jZTxf
RHA+Ojp2YWx1ZSwKICAgICAgICBpc19zYW1lPF9FcCwgX0RwPiwKICAgICAgICBpc19jb252ZXJ0
aWJsZTxfRXAsIF9EcD4+Ojp0eXBlPj4KIHVuaXF1ZV9wdHIodW5pcXVlX3B0cjxfVXAsIF9FcD4m
JiBfX3UpIG5vZXhjZXB0CiA6IF9NX3QoX191LnJlbGVhc2UoKSwgc3RkOjpmb3J3YXJkPF9FcD4o
X191LmdldF9kZWxldGVyKCkpKQogeyB9CgoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VcCwg
dHlwZW5hbWUgPSBfUmVxdWlyZTwKICAgICAgICBpc19jb252ZXJ0aWJsZTxfVXAqLCBfVHAqPiwg
aXNfc2FtZTxfRHAsIGRlZmF1bHRfZGVsZXRlPF9UcD4+Pj4KIHVuaXF1ZV9wdHIoYXV0b19wdHI8
X1VwPiYmIF9fdSkgbm9leGNlcHQ7CgoKCiAgICAgIH51bmlxdWVfcHRyKCkgbm9leGNlcHQKICAg
ICAgewogYXV0byYgX19wdHIgPSBzdGQ6OmdldDwwPihfTV90KTsKIGlmIChfX3B0ciAhPSBudWxs
cHRyKQogICBnZXRfZGVsZXRlcigpKF9fcHRyKTsKIF9fcHRyID0gcG9pbnRlcigpOwogICAgICB9
CiMgMjQ4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvdW5pcXVlX3B0ci5oIiAzCiAgICAg
IHVuaXF1ZV9wdHImCiAgICAgIG9wZXJhdG9yPSh1bmlxdWVfcHRyJiYgX191KSBub2V4Y2VwdAog
ICAgICB7CiByZXNldChfX3UucmVsZWFzZSgpKTsKIGdldF9kZWxldGVyKCkgPSBzdGQ6OmZvcndh
cmQ8ZGVsZXRlcl90eXBlPihfX3UuZ2V0X2RlbGV0ZXIoKSk7CiByZXR1cm4gKnRoaXM7CiAgICAg
IH0KIyAyNjMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy91bmlxdWVfcHRyLmgiIDMKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX1VwLCB0eXBlbmFtZSBfRXA+CiAgICAgICAgdHlwZW5hbWUg
ZW5hYmxlX2lmPCBfX2FuZF88CiAgICAgICAgICBfX3NhZmVfY29udmVyc2lvbl91cDxfVXAsIF9F
cD4sCiAgICAgICAgICBpc19hc3NpZ25hYmxlPGRlbGV0ZXJfdHlwZSYsIF9FcCYmPgogICAgICAg
ICAgPjo6dmFsdWUsCiAgICAgICAgICB1bmlxdWVfcHRyJj46OnR5cGUKIG9wZXJhdG9yPSh1bmlx
dWVfcHRyPF9VcCwgX0VwPiYmIF9fdSkgbm9leGNlcHQKIHsKICAgcmVzZXQoX191LnJlbGVhc2Uo
KSk7CiAgIGdldF9kZWxldGVyKCkgPSBzdGQ6OmZvcndhcmQ8X0VwPihfX3UuZ2V0X2RlbGV0ZXIo
KSk7CiAgIHJldHVybiAqdGhpczsKIH0KCgogICAgICB1bmlxdWVfcHRyJgogICAgICBvcGVyYXRv
cj0obnVsbHB0cl90KSBub2V4Y2VwdAogICAgICB7CiByZXNldCgpOwogcmV0dXJuICp0aGlzOwog
ICAgICB9CgoKCgogICAgICB0eXBlbmFtZSBhZGRfbHZhbHVlX3JlZmVyZW5jZTxlbGVtZW50X3R5
cGU+Ojp0eXBlCiAgICAgIG9wZXJhdG9yKigpIGNvbnN0CiAgICAgIHsKIDsKIHJldHVybiAqZ2V0
KCk7CiAgICAgIH0KCgogICAgICBwb2ludGVyCiAgICAgIG9wZXJhdG9yLT4oKSBjb25zdCBub2V4
Y2VwdAogICAgICB7CiA7CiByZXR1cm4gZ2V0KCk7CiAgICAgIH0KCgogICAgICBwb2ludGVyCiAg
ICAgIGdldCgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0ZDo6Z2V0PDA+KF9NX3Qp
OyB9CgoKICAgICAgZGVsZXRlcl90eXBlJgogICAgICBnZXRfZGVsZXRlcigpIG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuIHN0ZDo6Z2V0PDE+KF9NX3QpOyB9CgoKICAgICAgY29uc3QgZGVsZXRlcl90
eXBlJgogICAgICBnZXRfZGVsZXRlcigpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0
ZDo6Z2V0PDE+KF9NX3QpOyB9CgoKICAgICAgZXhwbGljaXQgb3BlcmF0b3IgYm9vbCgpIGNvbnN0
IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGdldCgpID09IHBvaW50ZXIoKSA/IGZhbHNlIDogdHJ1
ZTsgfQoKCgoKICAgICAgcG9pbnRlcgogICAgICByZWxlYXNlKCkgbm9leGNlcHQKICAgICAgewog
cG9pbnRlciBfX3AgPSBnZXQoKTsKIHN0ZDo6Z2V0PDA+KF9NX3QpID0gcG9pbnRlcigpOwogcmV0
dXJuIF9fcDsKICAgICAgfQoKCgoKCgoKICAgICAgdm9pZAogICAgICByZXNldChwb2ludGVyIF9f
cCA9IHBvaW50ZXIoKSkgbm9leGNlcHQKICAgICAgewogdXNpbmcgc3RkOjpzd2FwOwogc3dhcChz
dGQ6OmdldDwwPihfTV90KSwgX19wKTsKIGlmIChfX3AgIT0gcG9pbnRlcigpKQogICBnZXRfZGVs
ZXRlcigpKF9fcCk7CiAgICAgIH0KCgogICAgICB2b2lkCiAgICAgIHN3YXAodW5pcXVlX3B0ciYg
X191KSBub2V4Y2VwdAogICAgICB7CiB1c2luZyBzdGQ6OnN3YXA7CiBzd2FwKF9NX3QsIF9fdS5f
TV90KTsKICAgICAgfQoKCiAgICAgIHVuaXF1ZV9wdHIoY29uc3QgdW5pcXVlX3B0ciYpID0gZGVs
ZXRlOwogICAgICB1bmlxdWVfcHRyJiBvcGVyYXRvcj0oY29uc3QgdW5pcXVlX3B0ciYpID0gZGVs
ZXRlOwogIH07CgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9EcD4KICAg
IGNsYXNzIHVuaXF1ZV9wdHI8X1RwW10sIF9EcD4KICAgIHsKCiAgICAgIGNsYXNzIF9Qb2ludGVy
CiAgICAgIHsKIHRlbXBsYXRlPHR5cGVuYW1lIF9VcD4KICAgc3RhdGljIHR5cGVuYW1lIF9VcDo6
cG9pbnRlciBfX3Rlc3QodHlwZW5hbWUgX1VwOjpwb2ludGVyKik7CgogdGVtcGxhdGU8dHlwZW5h
bWUgX1VwPgogICBzdGF0aWMgX1RwKiBfX3Rlc3QoLi4uKTsKCiB0eXBlZGVmIHR5cGVuYW1lIHJl
bW92ZV9yZWZlcmVuY2U8X0RwPjo6dHlwZSBfRGVsOwoKICAgICAgcHVibGljOgogdHlwZWRlZiBk
ZWNsdHlwZShfX3Rlc3Q8X0RlbD4oMCkpIHR5cGU7CiAgICAgIH07CgogICAgICB0eXBlZGVmIHN0
ZDo6dHVwbGU8dHlwZW5hbWUgX1BvaW50ZXI6OnR5cGUsIF9EcD4gX190dXBsZV90eXBlOwogICAg
ICBfX3R1cGxlX3R5cGUgX01fdDsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VcD4KIHVzaW5n
IF9fcmVtb3ZlX2N2ID0gdHlwZW5hbWUgcmVtb3ZlX2N2PF9VcD46OnR5cGU7CgoKICAgICAgdGVt
cGxhdGU8dHlwZW5hbWUgX1VwPgogdXNpbmcgX19pc19kZXJpdmVkX1RwCiAgID0gX19hbmRfPCBp
c19iYXNlX29mPF9UcCwgX1VwPiwKICAgICAgX19ub3RfPGlzX3NhbWU8X19yZW1vdmVfY3Y8X1Rw
PiwgX19yZW1vdmVfY3Y8X1VwPj4+ID47CgoKICAgIHB1YmxpYzoKICAgICAgdHlwZWRlZiB0eXBl
bmFtZSBfUG9pbnRlcjo6dHlwZSBwb2ludGVyOwogICAgICB0eXBlZGVmIF9UcCBlbGVtZW50X3R5
cGU7CiAgICAgIHR5cGVkZWYgX0RwIGRlbGV0ZXJfdHlwZTsKCgoKICAgICAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1VwLCB0eXBlbmFtZSBfRXAsCiAgICAgICAgICAgICAgIHR5cGVuYW1lIF9VcF91cCA9
IHVuaXF1ZV9wdHI8X1VwLCBfRXA+LAogICAgICAgIHR5cGVuYW1lIF9VcF9lbGVtZW50X3R5cGUg
PSB0eXBlbmFtZSBfVXBfdXA6OmVsZW1lbnRfdHlwZT4KIHVzaW5nIF9fc2FmZV9jb252ZXJzaW9u
X3VwID0gX19hbmRfPAogICAgICAgICAgaXNfYXJyYXk8X1VwPiwKICAgICAgICAgIGlzX3NhbWU8
cG9pbnRlciwgZWxlbWVudF90eXBlKj4sCiAgICAgICAgICBpc19zYW1lPHR5cGVuYW1lIF9VcF91
cDo6cG9pbnRlciwgX1VwX2VsZW1lbnRfdHlwZSo+LAogICAgICAgICAgaXNfY29udmVydGlibGU8
X1VwX2VsZW1lbnRfdHlwZSgqKVtdLCBlbGVtZW50X3R5cGUoKilbXT4sCiAgICAgICAgICBfX29y
XzxfX2FuZF88aXNfcmVmZXJlbmNlPGRlbGV0ZXJfdHlwZT4sIGlzX3NhbWU8ZGVsZXRlcl90eXBl
LCBfRXA+PiwKICAgICAgICAgICAgICAgIF9fYW5kXzxfX25vdF88aXNfcmVmZXJlbmNlPGRlbGV0
ZXJfdHlwZT4+LAogICAgICAgICAgICAgICAgICAgICAgIGlzX2NvbnZlcnRpYmxlPF9FcCwgZGVs
ZXRlcl90eXBlPj4+CiAgICAgICAgPjsKCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVXA+CiAg
ICAgICAgdXNpbmcgX19zYWZlX2NvbnZlcnNpb25fcmF3ID0gX19hbmRfPAogICAgICAgICAgX19v
cl88X19vcl88aXNfc2FtZTxfVXAsIHBvaW50ZXI+LAogICAgICAgICAgICAgICAgICAgICAgaXNf
c2FtZTxfVXAsIG51bGxwdHJfdD4+LAogICAgICAgICAgICAgICAgX19hbmRfPGlzX3BvaW50ZXI8
X1VwPiwKICAgICAgICAgICAgICAgICAgICAgICBpc19zYW1lPHBvaW50ZXIsIGVsZW1lbnRfdHlw
ZSo+LAogICAgICAgICAgICAgICAgICAgICAgIGlzX2NvbnZlcnRpYmxlPAogICAgICAgICAgICAg
ICAgICAgICAgICAgdHlwZW5hbWUgcmVtb3ZlX3BvaW50ZXI8X1VwPjo6dHlwZSgqKVtdLAogICAg
ICAgICAgICAgICAgICAgICAgICAgZWxlbWVudF90eXBlKCopW10+CiAgICAgICAgICAgICAgICA+
CiAgICAgICAgICA+CiAgICAgICAgPjsKCgoKCiAgICAgIGNvbnN0ZXhwciB1bmlxdWVfcHRyKCkg
bm9leGNlcHQKICAgICAgOiBfTV90KCkKICAgICAgeyBzdGF0aWNfYXNzZXJ0KCFzdGQ6OmlzX3Bv
aW50ZXI8ZGVsZXRlcl90eXBlPjo6dmFsdWUsCiAgICAgICAgImNvbnN0cnVjdGVkIHdpdGggbnVs
bCBmdW5jdGlvbiBwb2ludGVyIGRlbGV0ZXIiKTsgfQojIDQ0NCAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3VuaXF1ZV9wdHIuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVXAsCiAg
ICAgICAgICAgICAgIHR5cGVuYW1lID0gdHlwZW5hbWUgZW5hYmxlX2lmPAogICAgICAgICAgICAg
ICAgIF9fc2FmZV9jb252ZXJzaW9uX3JhdzxfVXA+Ojp2YWx1ZSwgYm9vbD46OnR5cGU+CiAgICAg
IGV4cGxpY2l0CiAgICAgIHVuaXF1ZV9wdHIoX1VwIF9fcCkgbm9leGNlcHQKICAgICAgOiBfTV90
KF9fcCwgZGVsZXRlcl90eXBlKCkpCiAgICAgIHsgc3RhdGljX2Fzc2VydCghaXNfcG9pbnRlcjxk
ZWxldGVyX3R5cGU+Ojp2YWx1ZSwKICAgICAgICAiY29uc3RydWN0ZWQgd2l0aCBudWxsIGZ1bmN0
aW9uIHBvaW50ZXIgZGVsZXRlciIpOyB9CiMgNDYxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvdW5pcXVlX3B0ci5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VcCwKICAgICAgICAg
ICAgICAgdHlwZW5hbWUgPSB0eXBlbmFtZSBlbmFibGVfaWY8CiAgICAgICAgICAgICAgICAgX19z
YWZlX2NvbnZlcnNpb25fcmF3PF9VcD46OnZhbHVlLCBib29sPjo6dHlwZT4KICAgICAgdW5pcXVl
X3B0cihfVXAgX19wLAogICAgICAgICAgICAgICAgIHR5cGVuYW1lIGNvbmRpdGlvbmFsPGlzX3Jl
ZmVyZW5jZTxkZWxldGVyX3R5cGU+Ojp2YWx1ZSwKICAgICAgICAgICAgICAgICBkZWxldGVyX3R5
cGUsIGNvbnN0IGRlbGV0ZXJfdHlwZSY+Ojp0eXBlIF9fZCkgbm9leGNlcHQKICAgICAgOiBfTV90
KF9fcCwgX19kKSB7IH0KIyA0NzcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy91bmlxdWVf
cHRyLmgiIDMKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1VwLAogICAgICAgICAgICAgICB0eXBl
bmFtZSA9IHR5cGVuYW1lIGVuYWJsZV9pZjwKICAgICAgICAgICAgICAgICBfX3NhZmVfY29udmVy
c2lvbl9yYXc8X1VwPjo6dmFsdWUsIGJvb2w+Ojp0eXBlPgogICAgICB1bmlxdWVfcHRyKF9VcCBf
X3AsIHR5cGVuYW1lCiAgIHJlbW92ZV9yZWZlcmVuY2U8ZGVsZXRlcl90eXBlPjo6dHlwZSYmIF9f
ZCkgbm9leGNlcHQKICAgICAgOiBfTV90KHN0ZDo6bW92ZShfX3ApLCBzdGQ6Om1vdmUoX19kKSkK
ICAgICAgeyBzdGF0aWNfYXNzZXJ0KCFpc19yZWZlcmVuY2U8ZGVsZXRlcl90eXBlPjo6dmFsdWUs
CiAgICAgICAgInJ2YWx1ZSBkZWxldGVyIGJvdW5kIHRvIHJlZmVyZW5jZSIpOyB9CgoKICAgICAg
dW5pcXVlX3B0cih1bmlxdWVfcHRyJiYgX191KSBub2V4Y2VwdAogICAgICA6IF9NX3QoX191LnJl
bGVhc2UoKSwgc3RkOjpmb3J3YXJkPGRlbGV0ZXJfdHlwZT4oX191LmdldF9kZWxldGVyKCkpKSB7
IH0KCgogICAgICBjb25zdGV4cHIgdW5pcXVlX3B0cihudWxscHRyX3QpIG5vZXhjZXB0IDogdW5p
cXVlX3B0cigpIHsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1VwLCB0eXBlbmFtZSBfRXAs
CiAgICAgICAgdHlwZW5hbWUgPSBfUmVxdWlyZTxfX3NhZmVfY29udmVyc2lvbl91cDxfVXAsIF9F
cD4+PgogdW5pcXVlX3B0cih1bmlxdWVfcHRyPF9VcCwgX0VwPiYmIF9fdSkgbm9leGNlcHQKIDog
X01fdChfX3UucmVsZWFzZSgpLCBzdGQ6OmZvcndhcmQ8X0VwPihfX3UuZ2V0X2RlbGV0ZXIoKSkp
CiB7IH0KCgogICAgICB+dW5pcXVlX3B0cigpCiAgICAgIHsKIGF1dG8mIF9fcHRyID0gc3RkOjpn
ZXQ8MD4oX01fdCk7CiBpZiAoX19wdHIgIT0gbnVsbHB0cikKICAgZ2V0X2RlbGV0ZXIoKShfX3B0
cik7CiBfX3B0ciA9IHBvaW50ZXIoKTsKICAgICAgfQojIDUxNiAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3VuaXF1ZV9wdHIuaCIgMwogICAgICB1bmlxdWVfcHRyJgogICAgICBvcGVyYXRv
cj0odW5pcXVlX3B0ciYmIF9fdSkgbm9leGNlcHQKICAgICAgewogcmVzZXQoX191LnJlbGVhc2Uo
KSk7CiBnZXRfZGVsZXRlcigpID0gc3RkOjpmb3J3YXJkPGRlbGV0ZXJfdHlwZT4oX191LmdldF9k
ZWxldGVyKCkpOwogcmV0dXJuICp0aGlzOwogICAgICB9CiMgNTMxICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvdW5pcXVlX3B0ci5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9VcCwg
dHlwZW5hbWUgX0VwPgogdHlwZW5hbWUKIGVuYWJsZV9pZjxfX2FuZF88X19zYWZlX2NvbnZlcnNp
b25fdXA8X1VwLCBfRXA+LAogICAgICAgICAgICAgICAgICAgICAgICAgaXNfYXNzaWduYWJsZTxk
ZWxldGVyX3R5cGUmLCBfRXAmJj4KICAgICAgICAgICAgICAgICAgPjo6dmFsdWUsCiAgICAgICAg
ICAgICAgICAgIHVuaXF1ZV9wdHImPjo6dHlwZQogb3BlcmF0b3I9KHVuaXF1ZV9wdHI8X1VwLCBf
RXA+JiYgX191KSBub2V4Y2VwdAogewogICByZXNldChfX3UucmVsZWFzZSgpKTsKICAgZ2V0X2Rl
bGV0ZXIoKSA9IHN0ZDo6Zm9yd2FyZDxfRXA+KF9fdS5nZXRfZGVsZXRlcigpKTsKICAgcmV0dXJu
ICp0aGlzOwogfQoKCiAgICAgIHVuaXF1ZV9wdHImCiAgICAgIG9wZXJhdG9yPShudWxscHRyX3Qp
IG5vZXhjZXB0CiAgICAgIHsKIHJlc2V0KCk7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCgoKCiAg
ICAgIHR5cGVuYW1lIHN0ZDo6YWRkX2x2YWx1ZV9yZWZlcmVuY2U8ZWxlbWVudF90eXBlPjo6dHlw
ZQogICAgICBvcGVyYXRvcltdKHNpemVfdCBfX2kpIGNvbnN0CiAgICAgIHsKIDsKIHJldHVybiBn
ZXQoKVtfX2ldOwogICAgICB9CgoKICAgICAgcG9pbnRlcgogICAgICBnZXQoKSBjb25zdCBub2V4
Y2VwdAogICAgICB7IHJldHVybiBzdGQ6OmdldDwwPihfTV90KTsgfQoKCiAgICAgIGRlbGV0ZXJf
dHlwZSYKICAgICAgZ2V0X2RlbGV0ZXIoKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGQ6Omdl
dDwxPihfTV90KTsgfQoKCiAgICAgIGNvbnN0IGRlbGV0ZXJfdHlwZSYKICAgICAgZ2V0X2RlbGV0
ZXIoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGQ6OmdldDwxPihfTV90KTsgfQoK
CiAgICAgIGV4cGxpY2l0IG9wZXJhdG9yIGJvb2woKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJl
dHVybiBnZXQoKSA9PSBwb2ludGVyKCkgPyBmYWxzZSA6IHRydWU7IH0KCgoKCiAgICAgIHBvaW50
ZXIKICAgICAgcmVsZWFzZSgpIG5vZXhjZXB0CiAgICAgIHsKIHBvaW50ZXIgX19wID0gZ2V0KCk7
CiBzdGQ6OmdldDwwPihfTV90KSA9IHBvaW50ZXIoKTsKIHJldHVybiBfX3A7CiAgICAgIH0KCgoK
CgoKCiAgICAgIHRlbXBsYXRlIDx0eXBlbmFtZSBfVXAsCiAgICAgICAgICAgICAgICB0eXBlbmFt
ZSA9IF9SZXF1aXJlPAogICAgICAgICAgICAgICAgICBfX29yXzxpc19zYW1lPF9VcCwgcG9pbnRl
cj4sCiAgICAgICAgICAgICAgICAgICAgICAgIF9fYW5kXzxpc19zYW1lPHBvaW50ZXIsIGVsZW1l
bnRfdHlwZSo+LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNfcG9pbnRlcjxfVXA+
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNfY29udmVydGlibGU8CiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGVuYW1lIHJlbW92ZV9wb2ludGVyPF9VcD46OnR5
cGUoKilbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudF90eXBlKCop
W10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID4KICAgICAgICAgICAgICAgICAgICAg
ICAgPgogICAgICAgICAgICAgICAgICA+CiAgICAgICAgICAgICAgID4+CiAgICAgIHZvaWQKICAg
ICAgcmVzZXQoX1VwIF9fcCkgbm9leGNlcHQKICAgICAgewogdXNpbmcgc3RkOjpzd2FwOwogc3dh
cChzdGQ6OmdldDwwPihfTV90KSwgX19wKTsKIGlmIChfX3AgIT0gbnVsbHB0cikKICAgZ2V0X2Rl
bGV0ZXIoKShfX3ApOwogICAgICB9CgogICAgICB2b2lkIHJlc2V0KG51bGxwdHJfdCA9IG51bGxw
dHIpIG5vZXhjZXB0CiAgICAgIHsKICAgICAgICByZXNldChwb2ludGVyKCkpOwogICAgICB9CgoK
ICAgICAgdm9pZAogICAgICBzd2FwKHVuaXF1ZV9wdHImIF9fdSkgbm9leGNlcHQKICAgICAgewog
dXNpbmcgc3RkOjpzd2FwOwogc3dhcChfTV90LCBfX3UuX01fdCk7CiAgICAgIH0KCgogICAgICB1
bmlxdWVfcHRyKGNvbnN0IHVuaXF1ZV9wdHImKSA9IGRlbGV0ZTsKICAgICAgdW5pcXVlX3B0ciYg
b3BlcmF0b3I9KGNvbnN0IHVuaXF1ZV9wdHImKSA9IGRlbGV0ZTsKICAgIH07CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0RwPgogICAgaW5saW5lIHZvaWQKICAgIHN3YXAodW5p
cXVlX3B0cjxfVHAsIF9EcD4mIF9feCwKICB1bmlxdWVfcHRyPF9UcCwgX0RwPiYgX195KSBub2V4
Y2VwdAogICAgeyBfX3guc3dhcChfX3kpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlw
ZW5hbWUgX0RwLAogICAgdHlwZW5hbWUgX1VwLCB0eXBlbmFtZSBfRXA+CiAgICBpbmxpbmUgYm9v
bAogICAgb3BlcmF0b3I9PShjb25zdCB1bmlxdWVfcHRyPF9UcCwgX0RwPiYgX194LAogICAgICAg
IGNvbnN0IHVuaXF1ZV9wdHI8X1VwLCBfRXA+JiBfX3kpCiAgICB7IHJldHVybiBfX3guZ2V0KCkg
PT0gX195LmdldCgpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0RwPgog
ICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPT0oY29uc3QgdW5pcXVlX3B0cjxfVHAsIF9EcD4m
IF9feCwgbnVsbHB0cl90KSBub2V4Y2VwdAogICAgeyByZXR1cm4gIV9feDsgfQoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9EcD4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRv
cj09KG51bGxwdHJfdCwgY29uc3QgdW5pcXVlX3B0cjxfVHAsIF9EcD4mIF9feCkgbm9leGNlcHQK
ICAgIHsgcmV0dXJuICFfX3g7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBf
RHAsCiAgICB0eXBlbmFtZSBfVXAsIHR5cGVuYW1lIF9FcD4KICAgIGlubGluZSBib29sCiAgICBv
cGVyYXRvciE9KGNvbnN0IHVuaXF1ZV9wdHI8X1RwLCBfRHA+JiBfX3gsCiAgICAgICAgY29uc3Qg
dW5pcXVlX3B0cjxfVXAsIF9FcD4mIF9feSkKICAgIHsgcmV0dXJuIF9feC5nZXQoKSAhPSBfX3ku
Z2V0KCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfRHA+CiAgICBpbmxp
bmUgYm9vbAogICAgb3BlcmF0b3IhPShjb25zdCB1bmlxdWVfcHRyPF9UcCwgX0RwPiYgX194LCBu
dWxscHRyX3QpIG5vZXhjZXB0CiAgICB7IHJldHVybiAoYm9vbClfX3g7IH0KCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfRHA+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3Ih
PShudWxscHRyX3QsIGNvbnN0IHVuaXF1ZV9wdHI8X1RwLCBfRHA+JiBfX3gpIG5vZXhjZXB0CiAg
ICB7IHJldHVybiAoYm9vbClfX3g7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFt
ZSBfRHAsCiAgICB0eXBlbmFtZSBfVXAsIHR5cGVuYW1lIF9FcD4KICAgIGlubGluZSBib29sCiAg
ICBvcGVyYXRvcjwoY29uc3QgdW5pcXVlX3B0cjxfVHAsIF9EcD4mIF9feCwKICAgICAgIGNvbnN0
IHVuaXF1ZV9wdHI8X1VwLCBfRXA+JiBfX3kpCiAgICB7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUK
IHN0ZDo6Y29tbW9uX3R5cGU8dHlwZW5hbWUgdW5pcXVlX3B0cjxfVHAsIF9EcD46OnBvaW50ZXIs
CiAgICAgICAgICAgICAgICAgIHR5cGVuYW1lIHVuaXF1ZV9wdHI8X1VwLCBfRXA+Ojpwb2ludGVy
Pjo6dHlwZSBfQ1Q7CiAgICAgIHJldHVybiBzdGQ6Omxlc3M8X0NUPigpKF9feC5nZXQoKSwgX195
LmdldCgpKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfRHA+CiAg
ICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I8KGNvbnN0IHVuaXF1ZV9wdHI8X1RwLCBfRHA+JiBf
X3gsIG51bGxwdHJfdCkKICAgIHsgcmV0dXJuIHN0ZDo6bGVzczx0eXBlbmFtZSB1bmlxdWVfcHRy
PF9UcCwgX0RwPjo6cG9pbnRlcj4oKShfX3guZ2V0KCksCiAgICAgICAgIG51bGxwdHIpOyB9Cgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0RwPgogICAgaW5saW5lIGJvb2wKICAg
IG9wZXJhdG9yPChudWxscHRyX3QsIGNvbnN0IHVuaXF1ZV9wdHI8X1RwLCBfRHA+JiBfX3gpCiAg
ICB7IHJldHVybiBzdGQ6Omxlc3M8dHlwZW5hbWUgdW5pcXVlX3B0cjxfVHAsIF9EcD46OnBvaW50
ZXI+KCkobnVsbHB0ciwKICAgICAgICAgX194LmdldCgpKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfVHAsIHR5cGVuYW1lIF9EcCwKICAgIHR5cGVuYW1lIF9VcCwgdHlwZW5hbWUgX0VwPgogICAg
aW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPD0oY29uc3QgdW5pcXVlX3B0cjxfVHAsIF9EcD4mIF9f
eCwKICAgICAgICBjb25zdCB1bmlxdWVfcHRyPF9VcCwgX0VwPiYgX195KQogICAgeyByZXR1cm4g
IShfX3kgPCBfX3gpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0RwPgog
ICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPD0oY29uc3QgdW5pcXVlX3B0cjxfVHAsIF9EcD4m
IF9feCwgbnVsbHB0cl90KQogICAgeyByZXR1cm4gIShudWxscHRyIDwgX194KTsgfQoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9EcD4KICAgIGlubGluZSBib29sCiAgICBvcGVy
YXRvcjw9KG51bGxwdHJfdCwgY29uc3QgdW5pcXVlX3B0cjxfVHAsIF9EcD4mIF9feCkKICAgIHsg
cmV0dXJuICEoX194IDwgbnVsbHB0cik7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBl
bmFtZSBfRHAsCiAgICB0eXBlbmFtZSBfVXAsIHR5cGVuYW1lIF9FcD4KICAgIGlubGluZSBib29s
CiAgICBvcGVyYXRvcj4oY29uc3QgdW5pcXVlX3B0cjxfVHAsIF9EcD4mIF9feCwKICAgICAgIGNv
bnN0IHVuaXF1ZV9wdHI8X1VwLCBfRXA+JiBfX3kpCiAgICB7IHJldHVybiAoX195IDwgX194KTsg
fQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9EcD4KICAgIGlubGluZSBib29s
CiAgICBvcGVyYXRvcj4oY29uc3QgdW5pcXVlX3B0cjxfVHAsIF9EcD4mIF9feCwgbnVsbHB0cl90
KQogICAgeyByZXR1cm4gc3RkOjpsZXNzPHR5cGVuYW1lIHVuaXF1ZV9wdHI8X1RwLCBfRHA+Ojpw
b2ludGVyPigpKG51bGxwdHIsCiAgICAgICAgIF9feC5nZXQoKSk7IH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwLCB0eXBlbmFtZSBfRHA+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I+KG51
bGxwdHJfdCwgY29uc3QgdW5pcXVlX3B0cjxfVHAsIF9EcD4mIF9feCkKICAgIHsgcmV0dXJuIHN0
ZDo6bGVzczx0eXBlbmFtZSB1bmlxdWVfcHRyPF9UcCwgX0RwPjo6cG9pbnRlcj4oKShfX3guZ2V0
KCksCiAgICAgICAgIG51bGxwdHIpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5h
bWUgX0RwLAogICAgdHlwZW5hbWUgX1VwLCB0eXBlbmFtZSBfRXA+CiAgICBpbmxpbmUgYm9vbAog
ICAgb3BlcmF0b3I+PShjb25zdCB1bmlxdWVfcHRyPF9UcCwgX0RwPiYgX194LAogICAgICAgIGNv
bnN0IHVuaXF1ZV9wdHI8X1VwLCBfRXA+JiBfX3kpCiAgICB7IHJldHVybiAhKF9feCA8IF9feSk7
IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfRHA+CiAgICBpbmxpbmUgYm9v
bAogICAgb3BlcmF0b3I+PShjb25zdCB1bmlxdWVfcHRyPF9UcCwgX0RwPiYgX194LCBudWxscHRy
X3QpCiAgICB7IHJldHVybiAhKF9feCA8IG51bGxwdHIpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcCwgdHlwZW5hbWUgX0RwPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPj0obnVsbHB0
cl90LCBjb25zdCB1bmlxdWVfcHRyPF9UcCwgX0RwPiYgX194KQogICAgeyByZXR1cm4gIShudWxs
cHRyIDwgX194KTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfRHA+CiAg
ICBzdHJ1Y3QgaGFzaDx1bmlxdWVfcHRyPF9UcCwgX0RwPj4KICAgIDogcHVibGljIF9faGFzaF9i
YXNlPHNpemVfdCwgdW5pcXVlX3B0cjxfVHAsIF9EcD4+CiAgICB7CiAgICAgIHNpemVfdAogICAg
ICBvcGVyYXRvcigpKGNvbnN0IHVuaXF1ZV9wdHI8X1RwLCBfRHA+JiBfX3UpIGNvbnN0IG5vZXhj
ZXB0CiAgICAgIHsKIHR5cGVkZWYgdW5pcXVlX3B0cjxfVHAsIF9EcD4gX1VQOwogcmV0dXJuIHN0
ZDo6aGFzaDx0eXBlbmFtZSBfVVA6OnBvaW50ZXI+KCkoX191LmdldCgpKTsKICAgICAgfQogICAg
fTsKIyA4MDMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy91bmlxdWVfcHRyLmgiIDMKCn0K
IyA4MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9tZW1vcnkiIDIgMwojIDEgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYml0cy9zaGFyZWRfcHRyLmgiIDEgMwojIDUyICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvc2hhcmVkX3B0ci5oIiAzCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3NoYXJlZF9wdHJfYmFzZS5oIiAxIDMKIyA1NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3NoYXJlZF9wdHJfYmFzZS5oIiAzCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9f
dmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCgogIHRlbXBsYXRlPHR5cGVuYW1lPiBjbGFz
cyBhdXRvX3B0cjsKCgoKCgoKICBjbGFzcyBiYWRfd2Vha19wdHIgOiBwdWJsaWMgc3RkOjpleGNl
cHRpb24KICB7CiAgcHVibGljOgogICAgdmlydHVhbCBjaGFyIGNvbnN0KiB3aGF0KCkgY29uc3Qg
bm9leGNlcHQ7CgogICAgdmlydHVhbCB+YmFkX3dlYWtfcHRyKCkgbm9leGNlcHQ7CiAgfTsKCgog
IGlubGluZSB2b2lkCiAgX190aHJvd19iYWRfd2Vha19wdHIoKQogIHsgKHRocm93IChiYWRfd2Vh
a19wdHIoKSkpOyB9CgogIHVzaW5nIF9fZ251X2N4eDo6X0xvY2tfcG9saWN5OwogIHVzaW5nIF9f
Z251X2N4eDo6X19kZWZhdWx0X2xvY2tfcG9saWN5OwogIHVzaW5nIF9fZ251X2N4eDo6X1Nfc2lu
Z2xlOwogIHVzaW5nIF9fZ251X2N4eDo6X1NfbXV0ZXg7CiAgdXNpbmcgX19nbnVfY3h4OjpfU19h
dG9taWM7CgoKICB0ZW1wbGF0ZTxfTG9ja19wb2xpY3kgX0xwPgogICAgY2xhc3MgX011dGV4X2Jh
c2UKICAgIHsKICAgIHByb3RlY3RlZDoKCiAgICAgIGVudW0geyBfU19uZWVkX2JhcnJpZXJzID0g
MCB9OwogICAgfTsKCiAgdGVtcGxhdGU8PgogICAgY2xhc3MgX011dGV4X2Jhc2U8X1NfbXV0ZXg+
CiAgICA6IHB1YmxpYyBfX2dudV9jeHg6Ol9fbXV0ZXgKICAgIHsKICAgIHByb3RlY3RlZDoKCgoK
ICAgICAgZW51bSB7IF9TX25lZWRfYmFycmllcnMgPSAxIH07CiAgICB9OwoKICB0ZW1wbGF0ZTxf
TG9ja19wb2xpY3kgX0xwID0gX19kZWZhdWx0X2xvY2tfcG9saWN5PgogICAgY2xhc3MgX1NwX2Nv
dW50ZWRfYmFzZQogICAgOiBwdWJsaWMgX011dGV4X2Jhc2U8X0xwPgogICAgewogICAgcHVibGlj
OgogICAgICBfU3BfY291bnRlZF9iYXNlKCkgbm9leGNlcHQKICAgICAgOiBfTV91c2VfY291bnQo
MSksIF9NX3dlYWtfY291bnQoMSkgeyB9CgogICAgICB2aXJ0dWFsCiAgICAgIH5fU3BfY291bnRl
ZF9iYXNlKCkgbm9leGNlcHQKICAgICAgeyB9CgoKCiAgICAgIHZpcnR1YWwgdm9pZAogICAgICBf
TV9kaXNwb3NlKCkgbm9leGNlcHQgPSAwOwoKCiAgICAgIHZpcnR1YWwgdm9pZAogICAgICBfTV9k
ZXN0cm95KCkgbm9leGNlcHQKICAgICAgeyBkZWxldGUgdGhpczsgfQoKICAgICAgdmlydHVhbCB2
b2lkKgogICAgICBfTV9nZXRfZGVsZXRlcihjb25zdCBzdGQ6OnR5cGVfaW5mbyYpIG5vZXhjZXB0
ID0gMDsKCiAgICAgIHZvaWQKICAgICAgX01fYWRkX3JlZl9jb3B5KCkKICAgICAgeyBfX2dudV9j
eHg6Ol9fYXRvbWljX2FkZF9kaXNwYXRjaCgmX01fdXNlX2NvdW50LCAxKTsgfQoKICAgICAgdm9p
ZAogICAgICBfTV9hZGRfcmVmX2xvY2soKTsKCiAgICAgIGJvb2wKICAgICAgX01fYWRkX3JlZl9s
b2NrX25vdGhyb3coKTsKCiAgICAgIHZvaWQKICAgICAgX01fcmVsZWFzZSgpIG5vZXhjZXB0CiAg
ICAgIHsKCiAgICAgICAgOwogaWYgKF9fZ251X2N4eDo6X19leGNoYW5nZV9hbmRfYWRkX2Rpc3Bh
dGNoKCZfTV91c2VfY291bnQsIC0xKSA9PSAxKQogICB7CiAgICAgICAgICAgIDsKICAgICBfTV9k
aXNwb3NlKCk7CgoKCgogICAgIGlmIChfTXV0ZXhfYmFzZTxfTHA+OjpfU19uZWVkX2JhcnJpZXJz
KQogICAgICAgewogIF9fYXRvbWljX3RocmVhZF9mZW5jZSAoNCk7CiAgICAgICB9CgoKICAgICAg
ICAgICAgOwogICAgIGlmIChfX2dudV9jeHg6Ol9fZXhjaGFuZ2VfYW5kX2FkZF9kaXNwYXRjaCgm
X01fd2Vha19jb3VudCwKICAgICAgICAgICAgIC0xKSA9PSAxKQogICAgICAgICAgICAgIHsKICAg
ICAgICAgICAgICAgIDsKICAgICAgICAgX01fZGVzdHJveSgpOwogICAgICAgICAgICAgIH0KICAg
fQogICAgICB9CgogICAgICB2b2lkCiAgICAgIF9NX3dlYWtfYWRkX3JlZigpIG5vZXhjZXB0CiAg
ICAgIHsgX19nbnVfY3h4OjpfX2F0b21pY19hZGRfZGlzcGF0Y2goJl9NX3dlYWtfY291bnQsIDEp
OyB9CgogICAgICB2b2lkCiAgICAgIF9NX3dlYWtfcmVsZWFzZSgpIG5vZXhjZXB0CiAgICAgIHsK
CiAgICAgICAgOwogaWYgKF9fZ251X2N4eDo6X19leGNoYW5nZV9hbmRfYWRkX2Rpc3BhdGNoKCZf
TV93ZWFrX2NvdW50LCAtMSkgPT0gMSkKICAgewogICAgICAgICAgICA7CiAgICAgaWYgKF9NdXRl
eF9iYXNlPF9McD46Ol9TX25lZWRfYmFycmllcnMpCiAgICAgICB7CgoKICBfX2F0b21pY190aHJl
YWRfZmVuY2UgKDQpOwogICAgICAgfQogICAgIF9NX2Rlc3Ryb3koKTsKICAgfQogICAgICB9Cgog
ICAgICBsb25nCiAgICAgIF9NX2dldF91c2VfY291bnQoKSBjb25zdCBub2V4Y2VwdAogICAgICB7
CgoKICAgICAgICByZXR1cm4gX19hdG9taWNfbG9hZF9uKCZfTV91c2VfY291bnQsIDApOwogICAg
ICB9CgogICAgcHJpdmF0ZToKICAgICAgX1NwX2NvdW50ZWRfYmFzZShfU3BfY291bnRlZF9iYXNl
IGNvbnN0JikgPSBkZWxldGU7CiAgICAgIF9TcF9jb3VudGVkX2Jhc2UmIG9wZXJhdG9yPShfU3Bf
Y291bnRlZF9iYXNlIGNvbnN0JikgPSBkZWxldGU7CgogICAgICBfQXRvbWljX3dvcmQgX01fdXNl
X2NvdW50OwogICAgICBfQXRvbWljX3dvcmQgX01fd2Vha19jb3VudDsKICAgIH07CgogIHRlbXBs
YXRlPD4KICAgIGlubGluZSB2b2lkCiAgICBfU3BfY291bnRlZF9iYXNlPF9TX3NpbmdsZT46Ogog
ICAgX01fYWRkX3JlZl9sb2NrKCkKICAgIHsKICAgICAgaWYgKF9NX3VzZV9jb3VudCA9PSAwKQog
X190aHJvd19iYWRfd2Vha19wdHIoKTsKICAgICAgKytfTV91c2VfY291bnQ7CiAgICB9CgogIHRl
bXBsYXRlPD4KICAgIGlubGluZSB2b2lkCiAgICBfU3BfY291bnRlZF9iYXNlPF9TX211dGV4Pjo6
CiAgICBfTV9hZGRfcmVmX2xvY2soKQogICAgewogICAgICBfX2dudV9jeHg6Ol9fc2NvcGVkX2xv
Y2sgc2VudHJ5KCp0aGlzKTsKICAgICAgaWYgKF9fZ251X2N4eDo6X19leGNoYW5nZV9hbmRfYWRk
X2Rpc3BhdGNoKCZfTV91c2VfY291bnQsIDEpID09IDApCiB7CiAgIF9NX3VzZV9jb3VudCA9IDA7
CiAgIF9fdGhyb3dfYmFkX3dlYWtfcHRyKCk7CiB9CiAgICB9CgogIHRlbXBsYXRlPD4KICAgIGlu
bGluZSB2b2lkCiAgICBfU3BfY291bnRlZF9iYXNlPF9TX2F0b21pYz46OgogICAgX01fYWRkX3Jl
Zl9sb2NrKCkKICAgIHsKCiAgICAgIF9BdG9taWNfd29yZCBfX2NvdW50ID0gX01fZ2V0X3VzZV9j
b3VudCgpOwogICAgICBkbwogewogICBpZiAoX19jb3VudCA9PSAwKQogICAgIF9fdGhyb3dfYmFk
X3dlYWtfcHRyKCk7CgoKIH0KICAgICAgd2hpbGUgKCFfX2F0b21pY19jb21wYXJlX2V4Y2hhbmdl
X24oJl9NX3VzZV9jb3VudCwgJl9fY291bnQsIF9fY291bnQgKyAxLAogICAgICAgdHJ1ZSwgNCwK
ICAgICAgIDApKTsKICAgIH0KCiAgdGVtcGxhdGU8PgogICAgaW5saW5lIGJvb2wKICAgIF9TcF9j
b3VudGVkX2Jhc2U8X1Nfc2luZ2xlPjo6CiAgICBfTV9hZGRfcmVmX2xvY2tfbm90aHJvdygpCiAg
ICB7CiAgICAgIGlmIChfTV91c2VfY291bnQgPT0gMCkKIHJldHVybiBmYWxzZTsKICAgICAgKytf
TV91c2VfY291bnQ7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICB0ZW1wbGF0ZTw+CiAgICBp
bmxpbmUgYm9vbAogICAgX1NwX2NvdW50ZWRfYmFzZTxfU19tdXRleD46OgogICAgX01fYWRkX3Jl
Zl9sb2NrX25vdGhyb3coKQogICAgewogICAgICBfX2dudV9jeHg6Ol9fc2NvcGVkX2xvY2sgc2Vu
dHJ5KCp0aGlzKTsKICAgICAgaWYgKF9fZ251X2N4eDo6X19leGNoYW5nZV9hbmRfYWRkX2Rpc3Bh
dGNoKCZfTV91c2VfY291bnQsIDEpID09IDApCiB7CiAgIF9NX3VzZV9jb3VudCA9IDA7CiAgIHJl
dHVybiBmYWxzZTsKIH0KICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogIHRlbXBsYXRlPD4KICAg
IGlubGluZSBib29sCiAgICBfU3BfY291bnRlZF9iYXNlPF9TX2F0b21pYz46OgogICAgX01fYWRk
X3JlZl9sb2NrX25vdGhyb3coKQogICAgewoKICAgICAgX0F0b21pY193b3JkIF9fY291bnQgPSBf
TV9nZXRfdXNlX2NvdW50KCk7CiAgICAgIGRvCiB7CiAgIGlmIChfX2NvdW50ID09IDApCiAgICAg
cmV0dXJuIGZhbHNlOwoKCiB9CiAgICAgIHdoaWxlICghX19hdG9taWNfY29tcGFyZV9leGNoYW5n
ZV9uKCZfTV91c2VfY291bnQsICZfX2NvdW50LCBfX2NvdW50ICsgMSwKICAgICAgIHRydWUsIDQs
CiAgICAgICAwKSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICB0ZW1wbGF0ZTw+CiAgICBp
bmxpbmUgdm9pZAogICAgX1NwX2NvdW50ZWRfYmFzZTxfU19zaW5nbGU+OjpfTV9hZGRfcmVmX2Nv
cHkoKQogICAgeyArK19NX3VzZV9jb3VudDsgfQoKICB0ZW1wbGF0ZTw+CiAgICBpbmxpbmUgdm9p
ZAogICAgX1NwX2NvdW50ZWRfYmFzZTxfU19zaW5nbGU+OjpfTV9yZWxlYXNlKCkgbm9leGNlcHQK
ICAgIHsKICAgICAgaWYgKC0tX01fdXNlX2NvdW50ID09IDApCiAgICAgICAgewogICAgICAgICAg
X01fZGlzcG9zZSgpOwogICAgICAgICAgaWYgKC0tX01fd2Vha19jb3VudCA9PSAwKQogICAgICAg
ICAgICBfTV9kZXN0cm95KCk7CiAgICAgICAgfQogICAgfQoKICB0ZW1wbGF0ZTw+CiAgICBpbmxp
bmUgdm9pZAogICAgX1NwX2NvdW50ZWRfYmFzZTxfU19zaW5nbGU+OjpfTV93ZWFrX2FkZF9yZWYo
KSBub2V4Y2VwdAogICAgeyArK19NX3dlYWtfY291bnQ7IH0KCiAgdGVtcGxhdGU8PgogICAgaW5s
aW5lIHZvaWQKICAgIF9TcF9jb3VudGVkX2Jhc2U8X1Nfc2luZ2xlPjo6X01fd2Vha19yZWxlYXNl
KCkgbm9leGNlcHQKICAgIHsKICAgICAgaWYgKC0tX01fd2Vha19jb3VudCA9PSAwKQogICAgICAg
IF9NX2Rlc3Ryb3koKTsKICAgIH0KCiAgdGVtcGxhdGU8PgogICAgaW5saW5lIGxvbmcKICAgIF9T
cF9jb3VudGVkX2Jhc2U8X1Nfc2luZ2xlPjo6X01fZ2V0X3VzZV9jb3VudCgpIGNvbnN0IG5vZXhj
ZXB0CiAgICB7IHJldHVybiBfTV91c2VfY291bnQ7IH0KCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHAsIF9Mb2NrX3BvbGljeSBfTHAgPSBfX2RlZmF1bHRfbG9ja19wb2xpY3k+CiAgICBjbGFzcyBf
X3NoYXJlZF9wdHI7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9McCA9
IF9fZGVmYXVsdF9sb2NrX3BvbGljeT4KICAgIGNsYXNzIF9fd2Vha19wdHI7CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9McCA9IF9fZGVmYXVsdF9sb2NrX3BvbGljeT4K
ICAgIGNsYXNzIF9fZW5hYmxlX3NoYXJlZF9mcm9tX3RoaXM7CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcD4KICAgIGNsYXNzIHNoYXJlZF9wdHI7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
IGNsYXNzIHdlYWtfcHRyOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3Qgb3du
ZXJfbGVzczsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgY2xhc3MgZW5hYmxlX3NoYXJl
ZF9mcm9tX3RoaXM7CgogIHRlbXBsYXRlPF9Mb2NrX3BvbGljeSBfTHAgPSBfX2RlZmF1bHRfbG9j
a19wb2xpY3k+CiAgICBjbGFzcyBfX3dlYWtfY291bnQ7CgogIHRlbXBsYXRlPF9Mb2NrX3BvbGlj
eSBfTHAgPSBfX2RlZmF1bHRfbG9ja19wb2xpY3k+CiAgICBjbGFzcyBfX3NoYXJlZF9jb3VudDsK
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUHRyLCBfTG9ja19wb2xpY3kgX0xwPgogICAgY2xhc3Mg
X1NwX2NvdW50ZWRfcHRyIGZpbmFsIDogcHVibGljIF9TcF9jb3VudGVkX2Jhc2U8X0xwPgogICAg
ewogICAgcHVibGljOgogICAgICBleHBsaWNpdAogICAgICBfU3BfY291bnRlZF9wdHIoX1B0ciBf
X3ApIG5vZXhjZXB0CiAgICAgIDogX01fcHRyKF9fcCkgeyB9CgogICAgICB2aXJ0dWFsIHZvaWQK
ICAgICAgX01fZGlzcG9zZSgpIG5vZXhjZXB0CiAgICAgIHsgZGVsZXRlIF9NX3B0cjsgfQoKICAg
ICAgdmlydHVhbCB2b2lkCiAgICAgIF9NX2Rlc3Ryb3koKSBub2V4Y2VwdAogICAgICB7IGRlbGV0
ZSB0aGlzOyB9CgogICAgICB2aXJ0dWFsIHZvaWQqCiAgICAgIF9NX2dldF9kZWxldGVyKGNvbnN0
IHN0ZDo6dHlwZV9pbmZvJikgbm9leGNlcHQKICAgICAgeyByZXR1cm4gbnVsbHB0cjsgfQoKICAg
ICAgX1NwX2NvdW50ZWRfcHRyKGNvbnN0IF9TcF9jb3VudGVkX3B0ciYpID0gZGVsZXRlOwogICAg
ICBfU3BfY291bnRlZF9wdHImIG9wZXJhdG9yPShjb25zdCBfU3BfY291bnRlZF9wdHImKSA9IGRl
bGV0ZTsKCiAgICBwcml2YXRlOgogICAgICBfUHRyIF9NX3B0cjsKICAgIH07CgogIHRlbXBsYXRl
PD4KICAgIGlubGluZSB2b2lkCiAgICBfU3BfY291bnRlZF9wdHI8bnVsbHB0cl90LCBfU19zaW5n
bGU+OjpfTV9kaXNwb3NlKCkgbm9leGNlcHQgeyB9CgogIHRlbXBsYXRlPD4KICAgIGlubGluZSB2
b2lkCiAgICBfU3BfY291bnRlZF9wdHI8bnVsbHB0cl90LCBfU19tdXRleD46Ol9NX2Rpc3Bvc2Uo
KSBub2V4Y2VwdCB7IH0KCiAgdGVtcGxhdGU8PgogICAgaW5saW5lIHZvaWQKICAgIF9TcF9jb3Vu
dGVkX3B0cjxudWxscHRyX3QsIF9TX2F0b21pYz46Ol9NX2Rpc3Bvc2UoKSBub2V4Y2VwdCB7IH0K
CiAgdGVtcGxhdGU8aW50IF9ObSwgdHlwZW5hbWUgX1RwLAogICAgYm9vbCBfX3VzZV9lYm8gPSAh
X19pc19maW5hbChfVHApICYmIF9faXNfZW1wdHkoX1RwKT4KICAgIHN0cnVjdCBfU3BfZWJvX2hl
bHBlcjsKCgogIHRlbXBsYXRlPGludCBfTm0sIHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBfU3Bf
ZWJvX2hlbHBlcjxfTm0sIF9UcCwgdHJ1ZT4gOiBwcml2YXRlIF9UcAogICAgewogICAgICBleHBs
aWNpdCBfU3BfZWJvX2hlbHBlcihjb25zdCBfVHAmIF9fdHApIDogX1RwKF9fdHApIHsgfQoKICAg
ICAgc3RhdGljIF9UcCYKICAgICAgX1NfZ2V0KF9TcF9lYm9faGVscGVyJiBfX2Vib2gpIHsgcmV0
dXJuIHN0YXRpY19jYXN0PF9UcCY+KF9fZWJvaCk7IH0KICAgIH07CgoKICB0ZW1wbGF0ZTxpbnQg
X05tLCB0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgX1NwX2Vib19oZWxwZXI8X05tLCBfVHAsIGZh
bHNlPgogICAgewogICAgICBleHBsaWNpdCBfU3BfZWJvX2hlbHBlcihjb25zdCBfVHAmIF9fdHAp
IDogX01fdHAoX190cCkgeyB9CgogICAgICBzdGF0aWMgX1RwJgogICAgICBfU19nZXQoX1NwX2Vi
b19oZWxwZXImIF9fZWJvaCkKICAgICAgeyByZXR1cm4gX19lYm9oLl9NX3RwOyB9CgogICAgcHJp
dmF0ZToKICAgICAgX1RwIF9NX3RwOwogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9QdHIs
IHR5cGVuYW1lIF9EZWxldGVyLCB0eXBlbmFtZSBfQWxsb2MsIF9Mb2NrX3BvbGljeSBfTHA+CiAg
ICBjbGFzcyBfU3BfY291bnRlZF9kZWxldGVyIGZpbmFsIDogcHVibGljIF9TcF9jb3VudGVkX2Jh
c2U8X0xwPgogICAgewogICAgICBjbGFzcyBfSW1wbCA6IF9TcF9lYm9faGVscGVyPDAsIF9EZWxl
dGVyPiwgX1NwX2Vib19oZWxwZXI8MSwgX0FsbG9jPgogICAgICB7CiB0eXBlZGVmIF9TcF9lYm9f
aGVscGVyPDAsIF9EZWxldGVyPiBfRGVsX2Jhc2U7CiB0eXBlZGVmIF9TcF9lYm9faGVscGVyPDEs
IF9BbGxvYz4gX0FsbG9jX2Jhc2U7CgogICAgICBwdWJsaWM6CiBfSW1wbChfUHRyIF9fcCwgX0Rl
bGV0ZXIgX19kLCBjb25zdCBfQWxsb2MmIF9fYSkgbm9leGNlcHQKIDogX01fcHRyKF9fcCksIF9E
ZWxfYmFzZShfX2QpLCBfQWxsb2NfYmFzZShfX2EpCiB7IH0KCiBfRGVsZXRlciYgX01fZGVsKCkg
bm9leGNlcHQgeyByZXR1cm4gX0RlbF9iYXNlOjpfU19nZXQoKnRoaXMpOyB9CiBfQWxsb2MmIF9N
X2FsbG9jKCkgbm9leGNlcHQgeyByZXR1cm4gX0FsbG9jX2Jhc2U6Ol9TX2dldCgqdGhpcyk7IH0K
CiBfUHRyIF9NX3B0cjsKICAgICAgfTsKCiAgICBwdWJsaWM6CiAgICAgIHVzaW5nIF9fYWxsb2Nh
dG9yX3R5cGUgPSBfX2FsbG9jX3JlYmluZDxfQWxsb2MsIF9TcF9jb3VudGVkX2RlbGV0ZXI+OwoK
CiAgICAgIF9TcF9jb3VudGVkX2RlbGV0ZXIoX1B0ciBfX3AsIF9EZWxldGVyIF9fZCkgbm9leGNl
cHQKICAgICAgOiBfTV9pbXBsKF9fcCwgX19kLCBfQWxsb2MoKSkgeyB9CgoKICAgICAgX1NwX2Nv
dW50ZWRfZGVsZXRlcihfUHRyIF9fcCwgX0RlbGV0ZXIgX19kLCBjb25zdCBfQWxsb2MmIF9fYSkg
bm9leGNlcHQKICAgICAgOiBfTV9pbXBsKF9fcCwgX19kLCBfX2EpIHsgfQoKICAgICAgfl9TcF9j
b3VudGVkX2RlbGV0ZXIoKSBub2V4Y2VwdCB7IH0KCiAgICAgIHZpcnR1YWwgdm9pZAogICAgICBf
TV9kaXNwb3NlKCkgbm9leGNlcHQKICAgICAgeyBfTV9pbXBsLl9NX2RlbCgpKF9NX2ltcGwuX01f
cHRyKTsgfQoKICAgICAgdmlydHVhbCB2b2lkCiAgICAgIF9NX2Rlc3Ryb3koKSBub2V4Y2VwdAog
ICAgICB7CiBfX2FsbG9jYXRvcl90eXBlIF9fYShfTV9pbXBsLl9NX2FsbG9jKCkpOwogX19hbGxv
Y2F0ZWRfcHRyPF9fYWxsb2NhdG9yX3R5cGU+IF9fZ3VhcmRfcHRyeyBfX2EsIHRoaXMgfTsKIHRo
aXMtPn5fU3BfY291bnRlZF9kZWxldGVyKCk7CiAgICAgIH0KCiAgICAgIHZpcnR1YWwgdm9pZCoK
ICAgICAgX01fZ2V0X2RlbGV0ZXIoY29uc3Qgc3RkOjp0eXBlX2luZm8mIF9fdGkpIG5vZXhjZXB0
CiAgICAgIHsKCgoKICAgICAgICByZXR1cm4gX190aSA9PSB0eXBlaWQoX0RlbGV0ZXIpCiAgID8g
c3RkOjpfX2FkZHJlc3NvZihfTV9pbXBsLl9NX2RlbCgpKQogICA6IG51bGxwdHI7CgoKCiAgICAg
IH0KCiAgICBwcml2YXRlOgogICAgICBfSW1wbCBfTV9pbXBsOwogICAgfTsKCgoKICBzdHJ1Y3Qg
X1NwX21ha2Vfc2hhcmVkX3RhZyB7IH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5h
bWUgX0FsbG9jLCBfTG9ja19wb2xpY3kgX0xwPgogICAgY2xhc3MgX1NwX2NvdW50ZWRfcHRyX2lu
cGxhY2UgZmluYWwgOiBwdWJsaWMgX1NwX2NvdW50ZWRfYmFzZTxfTHA+CiAgICB7CiAgICAgIGNs
YXNzIF9JbXBsIDogX1NwX2Vib19oZWxwZXI8MCwgX0FsbG9jPgogICAgICB7CiB0eXBlZGVmIF9T
cF9lYm9faGVscGVyPDAsIF9BbGxvYz4gX0FfYmFzZTsKCiAgICAgIHB1YmxpYzoKIGV4cGxpY2l0
IF9JbXBsKF9BbGxvYyBfX2EpIG5vZXhjZXB0IDogX0FfYmFzZShfX2EpIHsgfQoKIF9BbGxvYyYg
X01fYWxsb2MoKSBub2V4Y2VwdCB7IHJldHVybiBfQV9iYXNlOjpfU19nZXQoKnRoaXMpOyB9Cgog
X19nbnVfY3h4OjpfX2FsaWduZWRfYnVmZmVyPF9UcD4gX01fc3RvcmFnZTsKICAgICAgfTsKCiAg
ICBwdWJsaWM6CiAgICAgIHVzaW5nIF9fYWxsb2NhdG9yX3R5cGUgPSBfX2FsbG9jX3JlYmluZDxf
QWxsb2MsIF9TcF9jb3VudGVkX3B0cl9pbnBsYWNlPjsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1l
Li4uIF9BcmdzPgogX1NwX2NvdW50ZWRfcHRyX2lucGxhY2UoX0FsbG9jIF9fYSwgX0FyZ3MmJi4u
LiBfX2FyZ3MpCiA6IF9NX2ltcGwoX19hKQogewoKCiAgIGFsbG9jYXRvcl90cmFpdHM8X0FsbG9j
Pjo6Y29uc3RydWN0KF9fYSwgX01fcHRyKCksCiAgICAgICBzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9f
YXJncykuLi4pOwogfQoKICAgICAgfl9TcF9jb3VudGVkX3B0cl9pbnBsYWNlKCkgbm9leGNlcHQg
eyB9CgogICAgICB2aXJ0dWFsIHZvaWQKICAgICAgX01fZGlzcG9zZSgpIG5vZXhjZXB0CiAgICAg
IHsKIGFsbG9jYXRvcl90cmFpdHM8X0FsbG9jPjo6ZGVzdHJveShfTV9pbXBsLl9NX2FsbG9jKCks
IF9NX3B0cigpKTsKICAgICAgfQoKCiAgICAgIHZpcnR1YWwgdm9pZAogICAgICBfTV9kZXN0cm95
KCkgbm9leGNlcHQKICAgICAgewogX19hbGxvY2F0b3JfdHlwZSBfX2EoX01faW1wbC5fTV9hbGxv
YygpKTsKIF9fYWxsb2NhdGVkX3B0cjxfX2FsbG9jYXRvcl90eXBlPiBfX2d1YXJkX3B0cnsgX19h
LCB0aGlzIH07CiB0aGlzLT5+X1NwX2NvdW50ZWRfcHRyX2lucGxhY2UoKTsKICAgICAgfQoKCiAg
ICAgIHZpcnR1YWwgdm9pZCoKICAgICAgX01fZ2V0X2RlbGV0ZXIoY29uc3Qgc3RkOjp0eXBlX2lu
Zm8mIF9fdGkpIG5vZXhjZXB0CiAgICAgIHsKCiBpZiAoX190aSA9PSB0eXBlaWQoX1NwX21ha2Vf
c2hhcmVkX3RhZykpCiAgIHJldHVybiBjb25zdF9jYXN0PHR5cGVuYW1lIHJlbW92ZV9jdjxfVHA+
Ojp0eXBlKj4oX01fcHRyKCkpOwoKIHJldHVybiBudWxscHRyOwogICAgICB9CgogICAgcHJpdmF0
ZToKICAgICAgX1RwKiBfTV9wdHIoKSBub2V4Y2VwdCB7IHJldHVybiBfTV9pbXBsLl9NX3N0b3Jh
Z2UuX01fcHRyKCk7IH0KCiAgICAgIF9JbXBsIF9NX2ltcGw7CiAgICB9OwoKCiAgdGVtcGxhdGU8
X0xvY2tfcG9saWN5IF9McD4KICAgIGNsYXNzIF9fc2hhcmVkX2NvdW50CiAgICB7CiAgICBwdWJs
aWM6CiAgICAgIGNvbnN0ZXhwciBfX3NoYXJlZF9jb3VudCgpIG5vZXhjZXB0IDogX01fcGkoMCkK
ICAgICAgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUHRyPgogICAgICAgIGV4cGxpY2l0
CiBfX3NoYXJlZF9jb3VudChfUHRyIF9fcCkgOiBfTV9waSgwKQogewogICB0cnkKICAgICB7CiAg
ICAgICBfTV9waSA9IG5ldyBfU3BfY291bnRlZF9wdHI8X1B0ciwgX0xwPihfX3ApOwogICAgIH0K
ICAgY2F0Y2goLi4uKQogICAgIHsKICAgICAgIGRlbGV0ZSBfX3A7CiAgICAgICB0aHJvdzsKICAg
ICB9CiB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUHRyLCB0eXBlbmFtZSBfRGVsZXRlcj4K
IF9fc2hhcmVkX2NvdW50KF9QdHIgX19wLCBfRGVsZXRlciBfX2QpCiA6IF9fc2hhcmVkX2NvdW50
KF9fcCwgc3RkOjptb3ZlKF9fZCksIGFsbG9jYXRvcjx2b2lkPigpKQogeyB9CgogICAgICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfUHRyLCB0eXBlbmFtZSBfRGVsZXRlciwgdHlwZW5hbWUgX0FsbG9jPgog
X19zaGFyZWRfY291bnQoX1B0ciBfX3AsIF9EZWxldGVyIF9fZCwgX0FsbG9jIF9fYSkgOiBfTV9w
aSgwKQogewogICB0eXBlZGVmIF9TcF9jb3VudGVkX2RlbGV0ZXI8X1B0ciwgX0RlbGV0ZXIsIF9B
bGxvYywgX0xwPiBfU3BfY2RfdHlwZTsKICAgdHJ5CiAgICAgewogICAgICAgdHlwZW5hbWUgX1Nw
X2NkX3R5cGU6Ol9fYWxsb2NhdG9yX3R5cGUgX19hMihfX2EpOwogICAgICAgYXV0byBfX2d1YXJk
ID0gc3RkOjpfX2FsbG9jYXRlX2d1YXJkZWQoX19hMik7CiAgICAgICBfU3BfY2RfdHlwZSogX19t
ZW0gPSBfX2d1YXJkLmdldCgpOwogICAgICAgOjpuZXcgKF9fbWVtKSBfU3BfY2RfdHlwZShfX3As
IHN0ZDo6bW92ZShfX2QpLCBzdGQ6Om1vdmUoX19hKSk7CiAgICAgICBfTV9waSA9IF9fbWVtOwog
ICAgICAgX19ndWFyZCA9IG51bGxwdHI7CiAgICAgfQogICBjYXRjaCguLi4pCiAgICAgewogICAg
ICAgX19kKF9fcCk7CiAgICAgICB0aHJvdzsKICAgICB9CiB9CgogICAgICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUuLi4gX0FyZ3M+CiBfX3NoYXJlZF9j
b3VudChfU3BfbWFrZV9zaGFyZWRfdGFnLCBfVHAqLCBjb25zdCBfQWxsb2MmIF9fYSwKICAgICAg
ICAgX0FyZ3MmJi4uLiBfX2FyZ3MpCiA6IF9NX3BpKDApCiB7CiAgIHR5cGVkZWYgX1NwX2NvdW50
ZWRfcHRyX2lucGxhY2U8X1RwLCBfQWxsb2MsIF9McD4gX1NwX2NwX3R5cGU7CiAgIHR5cGVuYW1l
IF9TcF9jcF90eXBlOjpfX2FsbG9jYXRvcl90eXBlIF9fYTIoX19hKTsKICAgYXV0byBfX2d1YXJk
ID0gc3RkOjpfX2FsbG9jYXRlX2d1YXJkZWQoX19hMik7CiAgIF9TcF9jcF90eXBlKiBfX21lbSA9
IF9fZ3VhcmQuZ2V0KCk7CiAgIDo6bmV3IChfX21lbSkgX1NwX2NwX3R5cGUoc3RkOjptb3ZlKF9f
YSksCiAgICAgICAgc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsKICAgX01fcGkgPSBf
X21lbTsKICAgX19ndWFyZCA9IG51bGxwdHI7CiB9CgoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcD4KICAgICAgICBleHBsaWNpdAogX19zaGFyZWRfY291bnQoc3RkOjphdXRvX3B0cjxfVHA+
JiYgX19yKTsKCgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfRGVsPgog
ICAgICAgIGV4cGxpY2l0CiBfX3NoYXJlZF9jb3VudChzdGQ6OnVuaXF1ZV9wdHI8X1RwLCBfRGVs
PiYmIF9fcikgOiBfTV9waSgwKQogewoKCiAgIGlmIChfX3IuZ2V0KCkgPT0gbnVsbHB0cikKICAg
ICByZXR1cm47CgogICB1c2luZyBfUHRyID0gdHlwZW5hbWUgdW5pcXVlX3B0cjxfVHAsIF9EZWw+
Ojpwb2ludGVyOwogICB1c2luZyBfRGVsMiA9IHR5cGVuYW1lIGNvbmRpdGlvbmFsPGlzX3JlZmVy
ZW5jZTxfRGVsPjo6dmFsdWUsCiAgICAgICByZWZlcmVuY2Vfd3JhcHBlcjx0eXBlbmFtZSByZW1v
dmVfcmVmZXJlbmNlPF9EZWw+Ojp0eXBlPiwKICAgICAgIF9EZWw+Ojp0eXBlOwogICB1c2luZyBf
U3BfY2RfdHlwZQogICAgID0gX1NwX2NvdW50ZWRfZGVsZXRlcjxfUHRyLCBfRGVsMiwgYWxsb2Nh
dG9yPHZvaWQ+LCBfTHA+OwogICB1c2luZyBfQWxsb2MgPSBhbGxvY2F0b3I8X1NwX2NkX3R5cGU+
OwogICB1c2luZyBfQWxsb2NfdHJhaXRzID0gYWxsb2NhdG9yX3RyYWl0czxfQWxsb2M+OwogICBf
QWxsb2MgX19hOwogICBfU3BfY2RfdHlwZSogX19tZW0gPSBfQWxsb2NfdHJhaXRzOjphbGxvY2F0
ZShfX2EsIDEpOwogICBfQWxsb2NfdHJhaXRzOjpjb25zdHJ1Y3QoX19hLCBfX21lbSwgX19yLnJl
bGVhc2UoKSwKICAgICAgIF9fci5nZXRfZGVsZXRlcigpKTsKICAgX01fcGkgPSBfX21lbTsKIH0K
CgogICAgICBleHBsaWNpdCBfX3NoYXJlZF9jb3VudChjb25zdCBfX3dlYWtfY291bnQ8X0xwPiYg
X19yKTsKCgogICAgICBleHBsaWNpdCBfX3NoYXJlZF9jb3VudChjb25zdCBfX3dlYWtfY291bnQ8
X0xwPiYgX19yLCBzdGQ6Om5vdGhyb3dfdCk7CgogICAgICB+X19zaGFyZWRfY291bnQoKSBub2V4
Y2VwdAogICAgICB7CiBpZiAoX01fcGkgIT0gbnVsbHB0cikKICAgX01fcGktPl9NX3JlbGVhc2Uo
KTsKICAgICAgfQoKICAgICAgX19zaGFyZWRfY291bnQoY29uc3QgX19zaGFyZWRfY291bnQmIF9f
cikgbm9leGNlcHQKICAgICAgOiBfTV9waShfX3IuX01fcGkpCiAgICAgIHsKIGlmIChfTV9waSAh
PSAwKQogICBfTV9waS0+X01fYWRkX3JlZl9jb3B5KCk7CiAgICAgIH0KCiAgICAgIF9fc2hhcmVk
X2NvdW50JgogICAgICBvcGVyYXRvcj0oY29uc3QgX19zaGFyZWRfY291bnQmIF9fcikgbm9leGNl
cHQKICAgICAgewogX1NwX2NvdW50ZWRfYmFzZTxfTHA+KiBfX3RtcCA9IF9fci5fTV9waTsKIGlm
IChfX3RtcCAhPSBfTV9waSkKICAgewogICAgIGlmIChfX3RtcCAhPSAwKQogICAgICAgX190bXAt
Pl9NX2FkZF9yZWZfY29weSgpOwogICAgIGlmIChfTV9waSAhPSAwKQogICAgICAgX01fcGktPl9N
X3JlbGVhc2UoKTsKICAgICBfTV9waSA9IF9fdG1wOwogICB9CiByZXR1cm4gKnRoaXM7CiAgICAg
IH0KCiAgICAgIHZvaWQKICAgICAgX01fc3dhcChfX3NoYXJlZF9jb3VudCYgX19yKSBub2V4Y2Vw
dAogICAgICB7CiBfU3BfY291bnRlZF9iYXNlPF9McD4qIF9fdG1wID0gX19yLl9NX3BpOwogX19y
Ll9NX3BpID0gX01fcGk7CiBfTV9waSA9IF9fdG1wOwogICAgICB9CgogICAgICBsb25nCiAgICAg
IF9NX2dldF91c2VfY291bnQoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV9waSAh
PSAwID8gX01fcGktPl9NX2dldF91c2VfY291bnQoKSA6IDA7IH0KCiAgICAgIGJvb2wKICAgICAg
X01fdW5pcXVlKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gdGhpcy0+X01fZ2V0X3Vz
ZV9jb3VudCgpID09IDE7IH0KCiAgICAgIHZvaWQqCiAgICAgIF9NX2dldF9kZWxldGVyKGNvbnN0
IHN0ZDo6dHlwZV9pbmZvJiBfX3RpKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV9w
aSA/IF9NX3BpLT5fTV9nZXRfZGVsZXRlcihfX3RpKSA6IG51bGxwdHI7IH0KCiAgICAgIGJvb2wK
ICAgICAgX01fbGVzcyhjb25zdCBfX3NoYXJlZF9jb3VudCYgX19yaHMpIGNvbnN0IG5vZXhjZXB0
CiAgICAgIHsgcmV0dXJuIHN0ZDo6bGVzczxfU3BfY291bnRlZF9iYXNlPF9McD4qPigpKHRoaXMt
Pl9NX3BpLCBfX3Jocy5fTV9waSk7IH0KCiAgICAgIGJvb2wKICAgICAgX01fbGVzcyhjb25zdCBf
X3dlYWtfY291bnQ8X0xwPiYgX19yaHMpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0
ZDo6bGVzczxfU3BfY291bnRlZF9iYXNlPF9McD4qPigpKHRoaXMtPl9NX3BpLCBfX3Jocy5fTV9w
aSk7IH0KCgogICAgICBmcmllbmQgaW5saW5lIGJvb2wKICAgICAgb3BlcmF0b3I9PShjb25zdCBf
X3NoYXJlZF9jb3VudCYgX19hLCBjb25zdCBfX3NoYXJlZF9jb3VudCYgX19iKSBub2V4Y2VwdAog
ICAgICB7IHJldHVybiBfX2EuX01fcGkgPT0gX19iLl9NX3BpOyB9CgogICAgcHJpdmF0ZToKICAg
ICAgZnJpZW5kIGNsYXNzIF9fd2Vha19jb3VudDxfTHA+OwoKICAgICAgX1NwX2NvdW50ZWRfYmFz
ZTxfTHA+KiBfTV9waTsKICAgIH07CgoKICB0ZW1wbGF0ZTxfTG9ja19wb2xpY3kgX0xwPgogICAg
Y2xhc3MgX193ZWFrX2NvdW50CiAgICB7CiAgICBwdWJsaWM6CiAgICAgIGNvbnN0ZXhwciBfX3dl
YWtfY291bnQoKSBub2V4Y2VwdCA6IF9NX3BpKG51bGxwdHIpCiAgICAgIHsgfQoKICAgICAgX193
ZWFrX2NvdW50KGNvbnN0IF9fc2hhcmVkX2NvdW50PF9McD4mIF9fcikgbm9leGNlcHQKICAgICAg
OiBfTV9waShfX3IuX01fcGkpCiAgICAgIHsKIGlmIChfTV9waSAhPSBudWxscHRyKQogICBfTV9w
aS0+X01fd2Vha19hZGRfcmVmKCk7CiAgICAgIH0KCiAgICAgIF9fd2Vha19jb3VudChjb25zdCBf
X3dlYWtfY291bnQmIF9fcikgbm9leGNlcHQKICAgICAgOiBfTV9waShfX3IuX01fcGkpCiAgICAg
IHsKIGlmIChfTV9waSAhPSBudWxscHRyKQogICBfTV9waS0+X01fd2Vha19hZGRfcmVmKCk7CiAg
ICAgIH0KCiAgICAgIF9fd2Vha19jb3VudChfX3dlYWtfY291bnQmJiBfX3IpIG5vZXhjZXB0CiAg
ICAgIDogX01fcGkoX19yLl9NX3BpKQogICAgICB7IF9fci5fTV9waSA9IG51bGxwdHI7IH0KCiAg
ICAgIH5fX3dlYWtfY291bnQoKSBub2V4Y2VwdAogICAgICB7CiBpZiAoX01fcGkgIT0gbnVsbHB0
cikKICAgX01fcGktPl9NX3dlYWtfcmVsZWFzZSgpOwogICAgICB9CgogICAgICBfX3dlYWtfY291
bnQmCiAgICAgIG9wZXJhdG9yPShjb25zdCBfX3NoYXJlZF9jb3VudDxfTHA+JiBfX3IpIG5vZXhj
ZXB0CiAgICAgIHsKIF9TcF9jb3VudGVkX2Jhc2U8X0xwPiogX190bXAgPSBfX3IuX01fcGk7CiBp
ZiAoX190bXAgIT0gbnVsbHB0cikKICAgX190bXAtPl9NX3dlYWtfYWRkX3JlZigpOwogaWYgKF9N
X3BpICE9IG51bGxwdHIpCiAgIF9NX3BpLT5fTV93ZWFrX3JlbGVhc2UoKTsKIF9NX3BpID0gX190
bXA7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCiAgICAgIF9fd2Vha19jb3VudCYKICAgICAgb3Bl
cmF0b3I9KGNvbnN0IF9fd2Vha19jb3VudCYgX19yKSBub2V4Y2VwdAogICAgICB7CiBfU3BfY291
bnRlZF9iYXNlPF9McD4qIF9fdG1wID0gX19yLl9NX3BpOwogaWYgKF9fdG1wICE9IG51bGxwdHIp
CiAgIF9fdG1wLT5fTV93ZWFrX2FkZF9yZWYoKTsKIGlmIChfTV9waSAhPSBudWxscHRyKQogICBf
TV9waS0+X01fd2Vha19yZWxlYXNlKCk7CiBfTV9waSA9IF9fdG1wOwogcmV0dXJuICp0aGlzOwog
ICAgICB9CgogICAgICBfX3dlYWtfY291bnQmCiAgICAgIG9wZXJhdG9yPShfX3dlYWtfY291bnQm
JiBfX3IpIG5vZXhjZXB0CiAgICAgIHsKIGlmIChfTV9waSAhPSBudWxscHRyKQogICBfTV9waS0+
X01fd2Vha19yZWxlYXNlKCk7CiBfTV9waSA9IF9fci5fTV9waTsKICAgICAgICBfX3IuX01fcGkg
PSBudWxscHRyOwogcmV0dXJuICp0aGlzOwogICAgICB9CgogICAgICB2b2lkCiAgICAgIF9NX3N3
YXAoX193ZWFrX2NvdW50JiBfX3IpIG5vZXhjZXB0CiAgICAgIHsKIF9TcF9jb3VudGVkX2Jhc2U8
X0xwPiogX190bXAgPSBfX3IuX01fcGk7CiBfX3IuX01fcGkgPSBfTV9waTsKIF9NX3BpID0gX190
bXA7CiAgICAgIH0KCiAgICAgIGxvbmcKICAgICAgX01fZ2V0X3VzZV9jb3VudCgpIGNvbnN0IG5v
ZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX3BpICE9IG51bGxwdHIgPyBfTV9waS0+X01fZ2V0X3Vz
ZV9jb3VudCgpIDogMDsgfQoKICAgICAgYm9vbAogICAgICBfTV9sZXNzKGNvbnN0IF9fd2Vha19j
b3VudCYgX19yaHMpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0ZDo6bGVzczxfU3Bf
Y291bnRlZF9iYXNlPF9McD4qPigpKHRoaXMtPl9NX3BpLCBfX3Jocy5fTV9waSk7IH0KCiAgICAg
IGJvb2wKICAgICAgX01fbGVzcyhjb25zdCBfX3NoYXJlZF9jb3VudDxfTHA+JiBfX3JocykgY29u
c3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc3RkOjpsZXNzPF9TcF9jb3VudGVkX2Jhc2U8X0xw
Pio+KCkodGhpcy0+X01fcGksIF9fcmhzLl9NX3BpKTsgfQoKCiAgICAgIGZyaWVuZCBpbmxpbmUg
Ym9vbAogICAgICBvcGVyYXRvcj09KGNvbnN0IF9fd2Vha19jb3VudCYgX19hLCBjb25zdCBfX3dl
YWtfY291bnQmIF9fYikgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX19hLl9NX3BpID09IF9fYi5f
TV9waTsgfQoKICAgIHByaXZhdGU6CiAgICAgIGZyaWVuZCBjbGFzcyBfX3NoYXJlZF9jb3VudDxf
THA+OwoKICAgICAgX1NwX2NvdW50ZWRfYmFzZTxfTHA+KiBfTV9waTsKICAgIH07CgoKICB0ZW1w
bGF0ZTxfTG9ja19wb2xpY3kgX0xwPgogICAgaW5saW5lCiAgICBfX3NoYXJlZF9jb3VudDxfTHA+
OjpfX3NoYXJlZF9jb3VudChjb25zdCBfX3dlYWtfY291bnQ8X0xwPiYgX19yKQogICAgOiBfTV9w
aShfX3IuX01fcGkpCiAgICB7CiAgICAgIGlmIChfTV9waSAhPSBudWxscHRyKQogX01fcGktPl9N
X2FkZF9yZWZfbG9jaygpOwogICAgICBlbHNlCiBfX3Rocm93X2JhZF93ZWFrX3B0cigpOwogICAg
fQoKCiAgdGVtcGxhdGU8X0xvY2tfcG9saWN5IF9McD4KICAgIGlubGluZQogICAgX19zaGFyZWRf
Y291bnQ8X0xwPjo6CiAgICBfX3NoYXJlZF9jb3VudChjb25zdCBfX3dlYWtfY291bnQ8X0xwPiYg
X19yLCBzdGQ6Om5vdGhyb3dfdCkKICAgIDogX01fcGkoX19yLl9NX3BpKQogICAgewogICAgICBp
ZiAoX01fcGkgIT0gbnVsbHB0cikKIGlmICghX01fcGktPl9NX2FkZF9yZWZfbG9ja19ub3Rocm93
KCkpCiAgIF9NX3BpID0gbnVsbHB0cjsKICAgIH0KCgoKCiAgdGVtcGxhdGU8X0xvY2tfcG9saWN5
IF9McCwgdHlwZW5hbWUgX1RwMSwgdHlwZW5hbWUgX1RwMj4KICAgIHZvaWQKICAgIF9fZW5hYmxl
X3NoYXJlZF9mcm9tX3RoaXNfaGVscGVyKGNvbnN0IF9fc2hhcmVkX2NvdW50PF9McD4mLAogICAg
ICAgICBjb25zdCBfX2VuYWJsZV9zaGFyZWRfZnJvbV90aGlzPF9UcDEsCiAgICAgICAgIF9McD4q
LCBjb25zdCBfVHAyKikgbm9leGNlcHQ7CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCB0eXBl
bmFtZSBfVHAyPgogICAgdm9pZAogICAgX19lbmFibGVfc2hhcmVkX2Zyb21fdGhpc19oZWxwZXIo
Y29uc3QgX19zaGFyZWRfY291bnQ8PiYsCiAgICAgICAgIGNvbnN0IGVuYWJsZV9zaGFyZWRfZnJv
bV90aGlzPF9UcDE+KiwKICAgICAgICAgY29uc3QgX1RwMiopIG5vZXhjZXB0OwoKICB0ZW1wbGF0
ZTxfTG9ja19wb2xpY3kgX0xwPgogICAgaW5saW5lIHZvaWQKICAgIF9fZW5hYmxlX3NoYXJlZF9m
cm9tX3RoaXNfaGVscGVyKGNvbnN0IF9fc2hhcmVkX2NvdW50PF9McD4mLCAuLi4pIG5vZXhjZXB0
CiAgICB7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9McD4KICAg
IGNsYXNzIF9fc2hhcmVkX3B0cgogICAgewogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUHRyPgog
dXNpbmcgX0NvbnZlcnRpYmxlCiAgID0gdHlwZW5hbWUgZW5hYmxlX2lmPGlzX2NvbnZlcnRpYmxl
PF9QdHIsIF9UcCo+Ojp2YWx1ZT46OnR5cGU7CgogICAgcHVibGljOgogICAgICB0eXBlZGVmIF9U
cCBlbGVtZW50X3R5cGU7CgogICAgICBjb25zdGV4cHIgX19zaGFyZWRfcHRyKCkgbm9leGNlcHQK
ICAgICAgOiBfTV9wdHIoMCksIF9NX3JlZmNvdW50KCkKICAgICAgeyB9CgogICAgICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVHAxPgogZXhwbGljaXQgX19zaGFyZWRfcHRyKF9UcDEqIF9fcCkKICAgICAg
ICA6IF9NX3B0cihfX3ApLCBfTV9yZWZjb3VudChfX3ApCiB7CiAgCiAgIHN0YXRpY19hc3NlcnQo
ICFpc192b2lkPF9UcDE+Ojp2YWx1ZSwgImluY29tcGxldGUgdHlwZSIgKTsKICAgc3RhdGljX2Fz
c2VydCggc2l6ZW9mKF9UcDEpID4gMCwgImluY29tcGxldGUgdHlwZSIgKTsKICAgX19lbmFibGVf
c2hhcmVkX2Zyb21fdGhpc19oZWxwZXIoX01fcmVmY291bnQsIF9fcCwgX19wKTsKIH0KCiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lIF9EZWxldGVyPgogX19zaGFyZWRfcHRy
KF9UcDEqIF9fcCwgX0RlbGV0ZXIgX19kKQogOiBfTV9wdHIoX19wKSwgX01fcmVmY291bnQoX19w
LCBfX2QpCiB7CiAgCgogICBfX2VuYWJsZV9zaGFyZWRfZnJvbV90aGlzX2hlbHBlcihfTV9yZWZj
b3VudCwgX19wLCBfX3ApOwogfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMSwgdHlwZW5h
bWUgX0RlbGV0ZXIsIHR5cGVuYW1lIF9BbGxvYz4KIF9fc2hhcmVkX3B0cihfVHAxKiBfX3AsIF9E
ZWxldGVyIF9fZCwgX0FsbG9jIF9fYSkKIDogX01fcHRyKF9fcCksIF9NX3JlZmNvdW50KF9fcCwg
X19kLCBzdGQ6Om1vdmUoX19hKSkKIHsKICAKCiAgIF9fZW5hYmxlX3NoYXJlZF9mcm9tX3RoaXNf
aGVscGVyKF9NX3JlZmNvdW50LCBfX3AsIF9fcCk7CiB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfRGVsZXRlcj4KIF9fc2hhcmVkX3B0cihudWxscHRyX3QgX19wLCBfRGVsZXRlciBfX2QpCiA6
IF9NX3B0cigwKSwgX01fcmVmY291bnQoX19wLCBfX2QpCiB7IH0KCiAgICAgIHRlbXBsYXRlPHR5
cGVuYW1lIF9EZWxldGVyLCB0eXBlbmFtZSBfQWxsb2M+CiAgICAgICAgX19zaGFyZWRfcHRyKG51
bGxwdHJfdCBfX3AsIF9EZWxldGVyIF9fZCwgX0FsbG9jIF9fYSkKIDogX01fcHRyKDApLCBfTV9y
ZWZjb3VudChfX3AsIF9fZCwgc3RkOjptb3ZlKF9fYSkpCiB7IH0KCiAgICAgIHRlbXBsYXRlPHR5
cGVuYW1lIF9UcDE+CiBfX3NoYXJlZF9wdHIoY29uc3QgX19zaGFyZWRfcHRyPF9UcDEsIF9McD4m
IF9fciwgX1RwKiBfX3ApIG5vZXhjZXB0CiA6IF9NX3B0cihfX3ApLCBfTV9yZWZjb3VudChfX3Iu
X01fcmVmY291bnQpCiB7IH0KCiAgICAgIF9fc2hhcmVkX3B0cihjb25zdCBfX3NoYXJlZF9wdHIm
KSBub2V4Y2VwdCA9IGRlZmF1bHQ7CiAgICAgIF9fc2hhcmVkX3B0ciYgb3BlcmF0b3I9KGNvbnN0
IF9fc2hhcmVkX3B0ciYpIG5vZXhjZXB0ID0gZGVmYXVsdDsKICAgICAgfl9fc2hhcmVkX3B0cigp
ID0gZGVmYXVsdDsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lID0gX0Nv
bnZlcnRpYmxlPF9UcDEqPj4KIF9fc2hhcmVkX3B0cihjb25zdCBfX3NoYXJlZF9wdHI8X1RwMSwg
X0xwPiYgX19yKSBub2V4Y2VwdAogOiBfTV9wdHIoX19yLl9NX3B0ciksIF9NX3JlZmNvdW50KF9f
ci5fTV9yZWZjb3VudCkKIHsgfQoKICAgICAgX19zaGFyZWRfcHRyKF9fc2hhcmVkX3B0ciYmIF9f
cikgbm9leGNlcHQKICAgICAgOiBfTV9wdHIoX19yLl9NX3B0ciksIF9NX3JlZmNvdW50KCkKICAg
ICAgewogX01fcmVmY291bnQuX01fc3dhcChfX3IuX01fcmVmY291bnQpOwogX19yLl9NX3B0ciA9
IDA7CiAgICAgIH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lID0gX0Nv
bnZlcnRpYmxlPF9UcDEqPj4KIF9fc2hhcmVkX3B0cihfX3NoYXJlZF9wdHI8X1RwMSwgX0xwPiYm
IF9fcikgbm9leGNlcHQKIDogX01fcHRyKF9fci5fTV9wdHIpLCBfTV9yZWZjb3VudCgpCiB7CiAg
IF9NX3JlZmNvdW50Ll9NX3N3YXAoX19yLl9NX3JlZmNvdW50KTsKICAgX19yLl9NX3B0ciA9IDA7
CiB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxPgogZXhwbGljaXQgX19zaGFyZWRfcHRy
KGNvbnN0IF9fd2Vha19wdHI8X1RwMSwgX0xwPiYgX19yKQogOiBfTV9yZWZjb3VudChfX3IuX01f
cmVmY291bnQpCiB7CiAgCgoKCiAgIF9NX3B0ciA9IF9fci5fTV9wdHI7CiB9CgoKICAgICAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwMSwgdHlwZW5hbWUgX0RlbCwgdHlwZW5hbWUKICAgICAgICA9IF9D
b252ZXJ0aWJsZTx0eXBlbmFtZSB1bmlxdWVfcHRyPF9UcDEsIF9EZWw+Ojpwb2ludGVyPj4KIF9f
c2hhcmVkX3B0cihzdGQ6OnVuaXF1ZV9wdHI8X1RwMSwgX0RlbD4mJiBfX3IpCiA6IF9NX3B0cihf
X3IuZ2V0KCkpLCBfTV9yZWZjb3VudCgpCiB7CiAgCiAgIGF1dG8gX19yYXcgPSBfU19yYXdfcHRy
KF9fci5nZXQoKSk7CiAgIF9NX3JlZmNvdW50ID0gX19zaGFyZWRfY291bnQ8X0xwPihzdGQ6Om1v
dmUoX19yKSk7CiAgIF9fZW5hYmxlX3NoYXJlZF9mcm9tX3RoaXNfaGVscGVyKF9NX3JlZmNvdW50
LCBfX3JhdywgX19yYXcpOwogfQoKCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxPgogX19z
aGFyZWRfcHRyKHN0ZDo6YXV0b19wdHI8X1RwMT4mJiBfX3IpOwoKCiAgICAgIGNvbnN0ZXhwciBf
X3NoYXJlZF9wdHIobnVsbHB0cl90KSBub2V4Y2VwdCA6IF9fc2hhcmVkX3B0cigpIHsgfQoKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KIF9fc2hhcmVkX3B0ciYKIG9wZXJhdG9yPShjb25z
dCBfX3NoYXJlZF9wdHI8X1RwMSwgX0xwPiYgX19yKSBub2V4Y2VwdAogewogICBfTV9wdHIgPSBf
X3IuX01fcHRyOwogICBfTV9yZWZjb3VudCA9IF9fci5fTV9yZWZjb3VudDsKICAgcmV0dXJuICp0
aGlzOwogfQoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDE+CiBfX3NoYXJlZF9wdHImCiBv
cGVyYXRvcj0oc3RkOjphdXRvX3B0cjxfVHAxPiYmIF9fcikKIHsKICAgX19zaGFyZWRfcHRyKHN0
ZDo6bW92ZShfX3IpKS5zd2FwKCp0aGlzKTsKICAgcmV0dXJuICp0aGlzOwogfQoKCiAgICAgIF9f
c2hhcmVkX3B0ciYKICAgICAgb3BlcmF0b3I9KF9fc2hhcmVkX3B0ciYmIF9fcikgbm9leGNlcHQK
ICAgICAgewogX19zaGFyZWRfcHRyKHN0ZDo6bW92ZShfX3IpKS5zd2FwKCp0aGlzKTsKIHJldHVy
biAqdGhpczsKICAgICAgfQoKICAgICAgdGVtcGxhdGU8Y2xhc3MgX1RwMT4KIF9fc2hhcmVkX3B0
ciYKIG9wZXJhdG9yPShfX3NoYXJlZF9wdHI8X1RwMSwgX0xwPiYmIF9fcikgbm9leGNlcHQKIHsK
ICAgX19zaGFyZWRfcHRyKHN0ZDo6bW92ZShfX3IpKS5zd2FwKCp0aGlzKTsKICAgcmV0dXJuICp0
aGlzOwogfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMSwgdHlwZW5hbWUgX0RlbD4KIF9f
c2hhcmVkX3B0ciYKIG9wZXJhdG9yPShzdGQ6OnVuaXF1ZV9wdHI8X1RwMSwgX0RlbD4mJiBfX3Ip
CiB7CiAgIF9fc2hhcmVkX3B0cihzdGQ6Om1vdmUoX19yKSkuc3dhcCgqdGhpcyk7CiAgIHJldHVy
biAqdGhpczsKIH0KCiAgICAgIHZvaWQKICAgICAgcmVzZXQoKSBub2V4Y2VwdAogICAgICB7IF9f
c2hhcmVkX3B0cigpLnN3YXAoKnRoaXMpOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAx
Pgogdm9pZAogcmVzZXQoX1RwMSogX19wKQogewoKICAgOwogICBfX3NoYXJlZF9wdHIoX19wKS5z
d2FwKCp0aGlzKTsKIH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lIF9E
ZWxldGVyPgogdm9pZAogcmVzZXQoX1RwMSogX19wLCBfRGVsZXRlciBfX2QpCiB7IF9fc2hhcmVk
X3B0cihfX3AsIF9fZCkuc3dhcCgqdGhpcyk7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cDEsIHR5cGVuYW1lIF9EZWxldGVyLCB0eXBlbmFtZSBfQWxsb2M+CiB2b2lkCiAgICAgICAgcmVz
ZXQoX1RwMSogX19wLCBfRGVsZXRlciBfX2QsIF9BbGxvYyBfX2EpCiAgICAgICAgeyBfX3NoYXJl
ZF9wdHIoX19wLCBfX2QsIHN0ZDo6bW92ZShfX2EpKS5zd2FwKCp0aGlzKTsgfQoKCiAgICAgIHR5
cGVuYW1lIHN0ZDo6YWRkX2x2YWx1ZV9yZWZlcmVuY2U8X1RwPjo6dHlwZQogICAgICBvcGVyYXRv
ciooKSBjb25zdCBub2V4Y2VwdAogICAgICB7CiA7CiByZXR1cm4gKl9NX3B0cjsKICAgICAgfQoK
ICAgICAgX1RwKgogICAgICBvcGVyYXRvci0+KCkgY29uc3Qgbm9leGNlcHQKICAgICAgewogOwog
cmV0dXJuIF9NX3B0cjsKICAgICAgfQoKICAgICAgX1RwKgogICAgICBnZXQoKSBjb25zdCBub2V4
Y2VwdAogICAgICB7IHJldHVybiBfTV9wdHI7IH0KCiAgICAgIGV4cGxpY2l0IG9wZXJhdG9yIGJv
b2woKSBjb25zdAogICAgICB7IHJldHVybiBfTV9wdHIgPT0gMCA/IGZhbHNlIDogdHJ1ZTsgfQoK
ICAgICAgYm9vbAogICAgICB1bmlxdWUoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBf
TV9yZWZjb3VudC5fTV91bmlxdWUoKTsgfQoKICAgICAgbG9uZwogICAgICB1c2VfY291bnQoKSBj
b25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV9yZWZjb3VudC5fTV9nZXRfdXNlX2NvdW50
KCk7IH0KCiAgICAgIHZvaWQKICAgICAgc3dhcChfX3NoYXJlZF9wdHI8X1RwLCBfTHA+JiBfX290
aGVyKSBub2V4Y2VwdAogICAgICB7CiBzdGQ6OnN3YXAoX01fcHRyLCBfX290aGVyLl9NX3B0cik7
CiBfTV9yZWZjb3VudC5fTV9zd2FwKF9fb3RoZXIuX01fcmVmY291bnQpOwogICAgICB9CgogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxPgogYm9vbAogb3duZXJfYmVmb3JlKF9fc2hhcmVkX3B0
cjxfVHAxLCBfTHA+IGNvbnN0JiBfX3JocykgY29uc3QKIHsgcmV0dXJuIF9NX3JlZmNvdW50Ll9N
X2xlc3MoX19yaHMuX01fcmVmY291bnQpOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAx
PgogYm9vbAogb3duZXJfYmVmb3JlKF9fd2Vha19wdHI8X1RwMSwgX0xwPiBjb25zdCYgX19yaHMp
IGNvbnN0CiB7IHJldHVybiBfTV9yZWZjb3VudC5fTV9sZXNzKF9fcmhzLl9NX3JlZmNvdW50KTsg
fQoKCiAgICBwcm90ZWN0ZWQ6CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2MsIHR5cGVu
YW1lLi4uIF9BcmdzPgogX19zaGFyZWRfcHRyKF9TcF9tYWtlX3NoYXJlZF90YWcgX190YWcsIGNv
bnN0IF9BbGxvYyYgX19hLAogICAgICAgX0FyZ3MmJi4uLiBfX2FyZ3MpCiA6IF9NX3B0cigpLCBf
TV9yZWZjb3VudChfX3RhZywgKF9UcCopMCwgX19hLAogICAgc3RkOjpmb3J3YXJkPF9BcmdzPihf
X2FyZ3MpLi4uKQogewoKCiAgIHZvaWQqIF9fcCA9IF9NX3JlZmNvdW50Ll9NX2dldF9kZWxldGVy
KHR5cGVpZChfX3RhZykpOwogICBfTV9wdHIgPSBzdGF0aWNfY2FzdDxfVHAqPihfX3ApOwogICBf
X2VuYWJsZV9zaGFyZWRfZnJvbV90aGlzX2hlbHBlcihfTV9yZWZjb3VudCwgX01fcHRyLCBfTV9w
dHIpOwogfQojIDExNDIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zaGFyZWRfcHRyX2Jh
c2UuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCBfTG9ja19wb2xpY3kgX0xwMSwg
dHlwZW5hbWUgX0FsbG9jLAogICAgICAgIHR5cGVuYW1lLi4uIF9BcmdzPgogZnJpZW5kIF9fc2hh
cmVkX3B0cjxfVHAxLCBfTHAxPgogX19hbGxvY2F0ZV9zaGFyZWQoY29uc3QgX0FsbG9jJiBfX2Es
IF9BcmdzJiYuLi4gX19hcmdzKTsKCgoKICAgICAgX19zaGFyZWRfcHRyKGNvbnN0IF9fd2Vha19w
dHI8X1RwLCBfTHA+JiBfX3IsIHN0ZDo6bm90aHJvd190KQogICAgICA6IF9NX3JlZmNvdW50KF9f
ci5fTV9yZWZjb3VudCwgc3RkOjpub3Rocm93KQogICAgICB7CiBfTV9wdHIgPSBfTV9yZWZjb3Vu
dC5fTV9nZXRfdXNlX2NvdW50KCkgPyBfX3IuX01fcHRyIDogbnVsbHB0cjsKICAgICAgfQoKICAg
ICAgZnJpZW5kIGNsYXNzIF9fd2Vha19wdHI8X1RwLCBfTHA+OwoKICAgIHByaXZhdGU6CiAgICAg
IHZvaWQqCiAgICAgIF9NX2dldF9kZWxldGVyKGNvbnN0IHN0ZDo6dHlwZV9pbmZvJiBfX3RpKSBj
b25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV9yZWZjb3VudC5fTV9nZXRfZGVsZXRlcihf
X3RpKTsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KIHN0YXRpYyBfVHAxKgogX1Nf
cmF3X3B0cihfVHAxKiBfX3B0cikKIHsgcmV0dXJuIF9fcHRyOyB9CgogICAgICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHAxPgogc3RhdGljIGF1dG8KIF9TX3Jhd19wdHIoX1RwMSBfX3B0cikgLT4gZGVj
bHR5cGUoc3RkOjpfX2FkZHJlc3NvZigqX19wdHIpKQogeyByZXR1cm4gc3RkOjpfX2FkZHJlc3Nv
ZigqX19wdHIpOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCBfTG9ja19wb2xpY3kg
X0xwMT4gZnJpZW5kIGNsYXNzIF9fc2hhcmVkX3B0cjsKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwMSwgX0xvY2tfcG9saWN5IF9McDE+IGZyaWVuZCBjbGFzcyBfX3dlYWtfcHRyOwoKICAgICAg
dGVtcGxhdGU8dHlwZW5hbWUgX0RlbCwgdHlwZW5hbWUgX1RwMSwgX0xvY2tfcG9saWN5IF9McDE+
CiBmcmllbmQgX0RlbCogZ2V0X2RlbGV0ZXIoY29uc3QgX19zaGFyZWRfcHRyPF9UcDEsIF9McDE+
Jikgbm9leGNlcHQ7CgogICAgICBfVHAqIF9NX3B0cjsKICAgICAgX19zaGFyZWRfY291bnQ8X0xw
PiBfTV9yZWZjb3VudDsKICAgIH07CgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMSwgdHlwZW5h
bWUgX1RwMiwgX0xvY2tfcG9saWN5IF9McD4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj09
KGNvbnN0IF9fc2hhcmVkX3B0cjxfVHAxLCBfTHA+JiBfX2EsCiAgICAgICAgY29uc3QgX19zaGFy
ZWRfcHRyPF9UcDIsIF9McD4mIF9fYikgbm9leGNlcHQKICAgIHsgcmV0dXJuIF9fYS5nZXQoKSA9
PSBfX2IuZ2V0KCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBfTG9ja19wb2xpY3kgX0xw
PgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPT0oY29uc3QgX19zaGFyZWRfcHRyPF9UcCwg
X0xwPiYgX19hLCBudWxscHRyX3QpIG5vZXhjZXB0CiAgICB7IHJldHVybiAhX19hOyB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9McD4KICAgIGlubGluZSBib29sCiAg
ICBvcGVyYXRvcj09KG51bGxwdHJfdCwgY29uc3QgX19zaGFyZWRfcHRyPF9UcCwgX0xwPiYgX19h
KSBub2V4Y2VwdAogICAgeyByZXR1cm4gIV9fYTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAx
LCB0eXBlbmFtZSBfVHAyLCBfTG9ja19wb2xpY3kgX0xwPgogICAgaW5saW5lIGJvb2wKICAgIG9w
ZXJhdG9yIT0oY29uc3QgX19zaGFyZWRfcHRyPF9UcDEsIF9McD4mIF9fYSwKICAgICAgICBjb25z
dCBfX3NoYXJlZF9wdHI8X1RwMiwgX0xwPiYgX19iKSBub2V4Y2VwdAogICAgeyByZXR1cm4gX19h
LmdldCgpICE9IF9fYi5nZXQoKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIF9Mb2NrX3Bv
bGljeSBfTHA+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3IhPShjb25zdCBfX3NoYXJlZF9w
dHI8X1RwLCBfTHA+JiBfX2EsIG51bGxwdHJfdCkgbm9leGNlcHQKICAgIHsgcmV0dXJuIChib29s
KV9fYTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIF9Mb2NrX3BvbGljeSBfTHA+CiAgICBp
bmxpbmUgYm9vbAogICAgb3BlcmF0b3IhPShudWxscHRyX3QsIGNvbnN0IF9fc2hhcmVkX3B0cjxf
VHAsIF9McD4mIF9fYSkgbm9leGNlcHQKICAgIHsgcmV0dXJuIChib29sKV9fYTsgfQoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHAxLCB0eXBlbmFtZSBfVHAyLCBfTG9ja19wb2xpY3kgX0xwPgogICAg
aW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPChjb25zdCBfX3NoYXJlZF9wdHI8X1RwMSwgX0xwPiYg
X19hLAogICAgICAgY29uc3QgX19zaGFyZWRfcHRyPF9UcDIsIF9McD4mIF9fYikgbm9leGNlcHQK
ICAgIHsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBzdGQ6OmNvbW1vbl90eXBlPF9UcDEqLCBfVHAy
Kj46OnR5cGUgX0NUOwogICAgICByZXR1cm4gc3RkOjpsZXNzPF9DVD4oKShfX2EuZ2V0KCksIF9f
Yi5nZXQoKSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9M
cD4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcjwoY29uc3QgX19zaGFyZWRfcHRyPF9UcCwg
X0xwPiYgX19hLCBudWxscHRyX3QpIG5vZXhjZXB0CiAgICB7IHJldHVybiBzdGQ6Omxlc3M8X1Rw
Kj4oKShfX2EuZ2V0KCksIG51bGxwdHIpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgX0xv
Y2tfcG9saWN5IF9McD4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcjwobnVsbHB0cl90LCBj
b25zdCBfX3NoYXJlZF9wdHI8X1RwLCBfTHA+JiBfX2EpIG5vZXhjZXB0CiAgICB7IHJldHVybiBz
dGQ6Omxlc3M8X1RwKj4oKShudWxscHRyLCBfX2EuZ2V0KCkpOyB9CgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcDEsIHR5cGVuYW1lIF9UcDIsIF9Mb2NrX3BvbGljeSBfTHA+CiAgICBpbmxpbmUgYm9v
bAogICAgb3BlcmF0b3I8PShjb25zdCBfX3NoYXJlZF9wdHI8X1RwMSwgX0xwPiYgX19hLAogICAg
ICAgIGNvbnN0IF9fc2hhcmVkX3B0cjxfVHAyLCBfTHA+JiBfX2IpIG5vZXhjZXB0CiAgICB7IHJl
dHVybiAhKF9fYiA8IF9fYSk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBfTG9ja19wb2xp
Y3kgX0xwPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPD0oY29uc3QgX19zaGFyZWRfcHRy
PF9UcCwgX0xwPiYgX19hLCBudWxscHRyX3QpIG5vZXhjZXB0CiAgICB7IHJldHVybiAhKG51bGxw
dHIgPCBfX2EpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9McD4K
ICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcjw9KG51bGxwdHJfdCwgY29uc3QgX19zaGFyZWRf
cHRyPF9UcCwgX0xwPiYgX19hKSBub2V4Y2VwdAogICAgeyByZXR1cm4gIShfX2EgPCBudWxscHRy
KTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCB0eXBlbmFtZSBfVHAyLCBfTG9ja19wb2xp
Y3kgX0xwPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPihjb25zdCBfX3NoYXJlZF9wdHI8
X1RwMSwgX0xwPiYgX19hLAogICAgICAgY29uc3QgX19zaGFyZWRfcHRyPF9UcDIsIF9McD4mIF9f
Yikgbm9leGNlcHQKICAgIHsgcmV0dXJuIChfX2IgPCBfX2EpOyB9CgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcCwgX0xvY2tfcG9saWN5IF9McD4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj4o
Y29uc3QgX19zaGFyZWRfcHRyPF9UcCwgX0xwPiYgX19hLCBudWxscHRyX3QpIG5vZXhjZXB0CiAg
ICB7IHJldHVybiBzdGQ6Omxlc3M8X1RwKj4oKShudWxscHRyLCBfX2EuZ2V0KCkpOyB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9McD4KICAgIGlubGluZSBib29sCiAg
ICBvcGVyYXRvcj4obnVsbHB0cl90LCBjb25zdCBfX3NoYXJlZF9wdHI8X1RwLCBfTHA+JiBfX2Ep
IG5vZXhjZXB0CiAgICB7IHJldHVybiBzdGQ6Omxlc3M8X1RwKj4oKShfX2EuZ2V0KCksIG51bGxw
dHIpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lIF9UcDIsIF9Mb2NrX3Bv
bGljeSBfTHA+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I+PShjb25zdCBfX3NoYXJlZF9w
dHI8X1RwMSwgX0xwPiYgX19hLAogICAgICAgIGNvbnN0IF9fc2hhcmVkX3B0cjxfVHAyLCBfTHA+
JiBfX2IpIG5vZXhjZXB0CiAgICB7IHJldHVybiAhKF9fYSA8IF9fYik7IH0KCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX1RwLCBfTG9ja19wb2xpY3kgX0xwPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJh
dG9yPj0oY29uc3QgX19zaGFyZWRfcHRyPF9UcCwgX0xwPiYgX19hLCBudWxscHRyX3QpIG5vZXhj
ZXB0CiAgICB7IHJldHVybiAhKF9fYSA8IG51bGxwdHIpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcCwgX0xvY2tfcG9saWN5IF9McD4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj49KG51
bGxwdHJfdCwgY29uc3QgX19zaGFyZWRfcHRyPF9UcCwgX0xwPiYgX19hKSBub2V4Y2VwdAogICAg
eyByZXR1cm4gIShudWxscHRyIDwgX19hKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfU3A+CiAg
ICBzdHJ1Y3QgX1NwX2xlc3MgOiBwdWJsaWMgYmluYXJ5X2Z1bmN0aW9uPF9TcCwgX1NwLCBib29s
PgogICAgewogICAgICBib29sCiAgICAgIG9wZXJhdG9yKCkoY29uc3QgX1NwJiBfX2xocywgY29u
c3QgX1NwJiBfX3JocykgY29uc3Qgbm9leGNlcHQKICAgICAgewogdHlwZWRlZiB0eXBlbmFtZSBf
U3A6OmVsZW1lbnRfdHlwZSBlbGVtZW50X3R5cGU7CiByZXR1cm4gc3RkOjpsZXNzPGVsZW1lbnRf
dHlwZSo+KCkoX19saHMuZ2V0KCksIF9fcmhzLmdldCgpKTsKICAgICAgfQogICAgfTsKCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwLCBfTG9ja19wb2xpY3kgX0xwPgogICAgc3RydWN0IGxlc3M8X19z
aGFyZWRfcHRyPF9UcCwgX0xwPj4KICAgIDogcHVibGljIF9TcF9sZXNzPF9fc2hhcmVkX3B0cjxf
VHAsIF9McD4+CiAgICB7IH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIF9Mb2NrX3BvbGlj
eSBfTHA+CiAgICBpbmxpbmUgdm9pZAogICAgc3dhcChfX3NoYXJlZF9wdHI8X1RwLCBfTHA+JiBf
X2EsIF9fc2hhcmVkX3B0cjxfVHAsIF9McD4mIF9fYikgbm9leGNlcHQKICAgIHsgX19hLnN3YXAo
X19iKTsgfQojIDEzMTIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zaGFyZWRfcHRyX2Jh
c2UuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1RwMSwgX0xvY2tfcG9s
aWN5IF9McD4KICAgIGlubGluZSBfX3NoYXJlZF9wdHI8X1RwLCBfTHA+CiAgICBzdGF0aWNfcG9p
bnRlcl9jYXN0KGNvbnN0IF9fc2hhcmVkX3B0cjxfVHAxLCBfTHA+JiBfX3IpIG5vZXhjZXB0CiAg
ICB7IHJldHVybiBfX3NoYXJlZF9wdHI8X1RwLCBfTHA+KF9fciwgc3RhdGljX2Nhc3Q8X1RwKj4o
X19yLmdldCgpKSk7IH0KCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9U
cDEsIF9Mb2NrX3BvbGljeSBfTHA+CiAgICBpbmxpbmUgX19zaGFyZWRfcHRyPF9UcCwgX0xwPgog
ICAgY29uc3RfcG9pbnRlcl9jYXN0KGNvbnN0IF9fc2hhcmVkX3B0cjxfVHAxLCBfTHA+JiBfX3Ip
IG5vZXhjZXB0CiAgICB7IHJldHVybiBfX3NoYXJlZF9wdHI8X1RwLCBfTHA+KF9fciwgY29uc3Rf
Y2FzdDxfVHAqPihfX3IuZ2V0KCkpKTsgfQoKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwg
dHlwZW5hbWUgX1RwMSwgX0xvY2tfcG9saWN5IF9McD4KICAgIGlubGluZSBfX3NoYXJlZF9wdHI8
X1RwLCBfTHA+CiAgICBkeW5hbWljX3BvaW50ZXJfY2FzdChjb25zdCBfX3NoYXJlZF9wdHI8X1Rw
MSwgX0xwPiYgX19yKSBub2V4Y2VwdAogICAgewogICAgICBpZiAoX1RwKiBfX3AgPSBkeW5hbWlj
X2Nhc3Q8X1RwKj4oX19yLmdldCgpKSkKIHJldHVybiBfX3NoYXJlZF9wdHI8X1RwLCBfTHA+KF9f
ciwgX19wKTsKICAgICAgcmV0dXJuIF9fc2hhcmVkX3B0cjxfVHAsIF9McD4oKTsKICAgIH0KCgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9McD4KICAgIGNsYXNzIF9fd2Vh
a19wdHIKICAgIHsKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1B0cj4KIHVzaW5nIF9Db252ZXJ0
aWJsZQogICA9IHR5cGVuYW1lIGVuYWJsZV9pZjxpc19jb252ZXJ0aWJsZTxfUHRyLCBfVHAqPjo6
dmFsdWU+Ojp0eXBlOwoKICAgIHB1YmxpYzoKICAgICAgdHlwZWRlZiBfVHAgZWxlbWVudF90eXBl
OwoKICAgICAgY29uc3RleHByIF9fd2Vha19wdHIoKSBub2V4Y2VwdAogICAgICA6IF9NX3B0cihu
dWxscHRyKSwgX01fcmVmY291bnQoKQogICAgICB7IH0KCiAgICAgIF9fd2Vha19wdHIoY29uc3Qg
X193ZWFrX3B0ciYpIG5vZXhjZXB0ID0gZGVmYXVsdDsKCiAgICAgIH5fX3dlYWtfcHRyKCkgPSBk
ZWZhdWx0OwojIDEzNzQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zaGFyZWRfcHRyX2Jh
c2UuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCB0eXBlbmFtZSA9IF9Db252ZXJ0
aWJsZTxfVHAxKj4+CiBfX3dlYWtfcHRyKGNvbnN0IF9fd2Vha19wdHI8X1RwMSwgX0xwPiYgX19y
KSBub2V4Y2VwdAogOiBfTV9yZWZjb3VudChfX3IuX01fcmVmY291bnQpCiAgICAgICAgeyBfTV9w
dHIgPSBfX3IubG9jaygpLmdldCgpOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCB0
eXBlbmFtZSA9IF9Db252ZXJ0aWJsZTxfVHAxKj4+CiBfX3dlYWtfcHRyKGNvbnN0IF9fc2hhcmVk
X3B0cjxfVHAxLCBfTHA+JiBfX3IpIG5vZXhjZXB0CiA6IF9NX3B0cihfX3IuX01fcHRyKSwgX01f
cmVmY291bnQoX19yLl9NX3JlZmNvdW50KQogeyB9CgogICAgICBfX3dlYWtfcHRyKF9fd2Vha19w
dHImJiBfX3IpIG5vZXhjZXB0CiAgICAgIDogX01fcHRyKF9fci5fTV9wdHIpLCBfTV9yZWZjb3Vu
dChzdGQ6Om1vdmUoX19yLl9NX3JlZmNvdW50KSkKICAgICAgeyBfX3IuX01fcHRyID0gbnVsbHB0
cjsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMSwgdHlwZW5hbWUgPSBfQ29udmVydGli
bGU8X1RwMSo+PgogX193ZWFrX3B0cihfX3dlYWtfcHRyPF9UcDEsIF9McD4mJiBfX3IpIG5vZXhj
ZXB0CiA6IF9NX3B0cihfX3IubG9jaygpLmdldCgpKSwgX01fcmVmY291bnQoc3RkOjptb3ZlKF9f
ci5fTV9yZWZjb3VudCkpCiAgICAgICAgeyBfX3IuX01fcHRyID0gbnVsbHB0cjsgfQoKICAgICAg
X193ZWFrX3B0ciYKICAgICAgb3BlcmF0b3I9KGNvbnN0IF9fd2Vha19wdHImIF9fcikgbm9leGNl
cHQgPSBkZWZhdWx0OwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KIF9fd2Vha19wdHIm
CiBvcGVyYXRvcj0oY29uc3QgX193ZWFrX3B0cjxfVHAxLCBfTHA+JiBfX3IpIG5vZXhjZXB0CiB7
CiAgIF9NX3B0ciA9IF9fci5sb2NrKCkuZ2V0KCk7CiAgIF9NX3JlZmNvdW50ID0gX19yLl9NX3Jl
ZmNvdW50OwogICByZXR1cm4gKnRoaXM7CiB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAx
PgogX193ZWFrX3B0ciYKIG9wZXJhdG9yPShjb25zdCBfX3NoYXJlZF9wdHI8X1RwMSwgX0xwPiYg
X19yKSBub2V4Y2VwdAogewogICBfTV9wdHIgPSBfX3IuX01fcHRyOwogICBfTV9yZWZjb3VudCA9
IF9fci5fTV9yZWZjb3VudDsKICAgcmV0dXJuICp0aGlzOwogfQoKICAgICAgX193ZWFrX3B0ciYK
ICAgICAgb3BlcmF0b3I9KF9fd2Vha19wdHImJiBfX3IpIG5vZXhjZXB0CiAgICAgIHsKIF9NX3B0
ciA9IF9fci5fTV9wdHI7CiBfTV9yZWZjb3VudCA9IHN0ZDo6bW92ZShfX3IuX01fcmVmY291bnQp
OwogX19yLl9NX3B0ciA9IG51bGxwdHI7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCiAgICAgIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcDE+CiBfX3dlYWtfcHRyJgogb3BlcmF0b3I9KF9fd2Vha19wdHI8
X1RwMSwgX0xwPiYmIF9fcikgbm9leGNlcHQKIHsKICAgX01fcHRyID0gX19yLmxvY2soKS5nZXQo
KTsKICAgX01fcmVmY291bnQgPSBzdGQ6Om1vdmUoX19yLl9NX3JlZmNvdW50KTsKICAgX19yLl9N
X3B0ciA9IG51bGxwdHI7CiAgIHJldHVybiAqdGhpczsKIH0KCiAgICAgIF9fc2hhcmVkX3B0cjxf
VHAsIF9McD4KICAgICAgbG9jaygpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fc2hh
cmVkX3B0cjxlbGVtZW50X3R5cGUsIF9McD4oKnRoaXMsIHN0ZDo6bm90aHJvdyk7IH0KCiAgICAg
IGxvbmcKICAgICAgdXNlX2NvdW50KCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX01f
cmVmY291bnQuX01fZ2V0X3VzZV9jb3VudCgpOyB9CgogICAgICBib29sCiAgICAgIGV4cGlyZWQo
KSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV9yZWZjb3VudC5fTV9nZXRfdXNlX2Nv
dW50KCkgPT0gMDsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KIGJvb2wKIG93bmVy
X2JlZm9yZShjb25zdCBfX3NoYXJlZF9wdHI8X1RwMSwgX0xwPiYgX19yaHMpIGNvbnN0CiB7IHJl
dHVybiBfTV9yZWZjb3VudC5fTV9sZXNzKF9fcmhzLl9NX3JlZmNvdW50KTsgfQoKICAgICAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwMT4KIGJvb2wKIG93bmVyX2JlZm9yZShjb25zdCBfX3dlYWtfcHRy
PF9UcDEsIF9McD4mIF9fcmhzKSBjb25zdAogeyByZXR1cm4gX01fcmVmY291bnQuX01fbGVzcyhf
X3Jocy5fTV9yZWZjb3VudCk7IH0KCiAgICAgIHZvaWQKICAgICAgcmVzZXQoKSBub2V4Y2VwdAog
ICAgICB7IF9fd2Vha19wdHIoKS5zd2FwKCp0aGlzKTsgfQoKICAgICAgdm9pZAogICAgICBzd2Fw
KF9fd2Vha19wdHImIF9fcykgbm9leGNlcHQKICAgICAgewogc3RkOjpzd2FwKF9NX3B0ciwgX19z
Ll9NX3B0cik7CiBfTV9yZWZjb3VudC5fTV9zd2FwKF9fcy5fTV9yZWZjb3VudCk7CiAgICAgIH0K
CiAgICBwcml2YXRlOgoKICAgICAgdm9pZAogICAgICBfTV9hc3NpZ24oX1RwKiBfX3B0ciwgY29u
c3QgX19zaGFyZWRfY291bnQ8X0xwPiYgX19yZWZjb3VudCkgbm9leGNlcHQKICAgICAgewogaWYg
KHVzZV9jb3VudCgpID09IDApCiAgIHsKICAgICBfTV9wdHIgPSBfX3B0cjsKICAgICBfTV9yZWZj
b3VudCA9IF9fcmVmY291bnQ7CiAgIH0KICAgICAgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwMSwgX0xvY2tfcG9saWN5IF9McDE+IGZyaWVuZCBjbGFzcyBfX3NoYXJlZF9wdHI7CiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIF9Mb2NrX3BvbGljeSBfTHAxPiBmcmllbmQgY2xhc3Mg
X193ZWFrX3B0cjsKICAgICAgZnJpZW5kIGNsYXNzIF9fZW5hYmxlX3NoYXJlZF9mcm9tX3RoaXM8
X1RwLCBfTHA+OwogICAgICBmcmllbmQgY2xhc3MgZW5hYmxlX3NoYXJlZF9mcm9tX3RoaXM8X1Rw
PjsKCiAgICAgIF9UcCogX01fcHRyOwogICAgICBfX3dlYWtfY291bnQ8X0xwPiBfTV9yZWZjb3Vu
dDsKICAgIH07CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIF9Mb2NrX3BvbGljeSBfTHA+CiAg
ICBpbmxpbmUgdm9pZAogICAgc3dhcChfX3dlYWtfcHRyPF9UcCwgX0xwPiYgX19hLCBfX3dlYWtf
cHRyPF9UcCwgX0xwPiYgX19iKSBub2V4Y2VwdAogICAgeyBfX2Euc3dhcChfX2IpOyB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1RwMT4KICAgIHN0cnVjdCBfU3Bfb3duZXJf
bGVzcyA6IHB1YmxpYyBiaW5hcnlfZnVuY3Rpb248X1RwLCBfVHAsIGJvb2w+CiAgICB7CiAgICAg
IGJvb2wKICAgICAgb3BlcmF0b3IoKShjb25zdCBfVHAmIF9fbGhzLCBjb25zdCBfVHAmIF9fcmhz
KSBjb25zdAogICAgICB7IHJldHVybiBfX2xocy5vd25lcl9iZWZvcmUoX19yaHMpOyB9CgogICAg
ICBib29sCiAgICAgIG9wZXJhdG9yKCkoY29uc3QgX1RwJiBfX2xocywgY29uc3QgX1RwMSYgX19y
aHMpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9fbGhzLm93bmVyX2JlZm9yZShfX3Jocyk7IH0KCiAg
ICAgIGJvb2wKICAgICAgb3BlcmF0b3IoKShjb25zdCBfVHAxJiBfX2xocywgY29uc3QgX1RwJiBf
X3JocykgY29uc3QKICAgICAgeyByZXR1cm4gX19saHMub3duZXJfYmVmb3JlKF9fcmhzKTsgfQog
ICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBfTG9ja19wb2xpY3kgX0xwPgogICAgc3Ry
dWN0IG93bmVyX2xlc3M8X19zaGFyZWRfcHRyPF9UcCwgX0xwPj4KICAgIDogcHVibGljIF9TcF9v
d25lcl9sZXNzPF9fc2hhcmVkX3B0cjxfVHAsIF9McD4sIF9fd2Vha19wdHI8X1RwLCBfTHA+Pgog
ICAgeyB9OwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIF9Mb2NrX3BvbGljeSBfTHA+CiAgICBz
dHJ1Y3Qgb3duZXJfbGVzczxfX3dlYWtfcHRyPF9UcCwgX0xwPj4KICAgIDogcHVibGljIF9TcF9v
d25lcl9sZXNzPF9fd2Vha19wdHI8X1RwLCBfTHA+LCBfX3NoYXJlZF9wdHI8X1RwLCBfTHA+Pgog
ICAgeyB9OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBfTG9ja19wb2xpY3kgX0xwPgogICAg
Y2xhc3MgX19lbmFibGVfc2hhcmVkX2Zyb21fdGhpcwogICAgewogICAgcHJvdGVjdGVkOgogICAg
ICBjb25zdGV4cHIgX19lbmFibGVfc2hhcmVkX2Zyb21fdGhpcygpIG5vZXhjZXB0IHsgfQoKICAg
ICAgX19lbmFibGVfc2hhcmVkX2Zyb21fdGhpcyhjb25zdCBfX2VuYWJsZV9zaGFyZWRfZnJvbV90
aGlzJikgbm9leGNlcHQgeyB9CgogICAgICBfX2VuYWJsZV9zaGFyZWRfZnJvbV90aGlzJgogICAg
ICBvcGVyYXRvcj0oY29uc3QgX19lbmFibGVfc2hhcmVkX2Zyb21fdGhpcyYpIG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuICp0aGlzOyB9CgogICAgICB+X19lbmFibGVfc2hhcmVkX2Zyb21fdGhpcygp
IHsgfQoKICAgIHB1YmxpYzoKICAgICAgX19zaGFyZWRfcHRyPF9UcCwgX0xwPgogICAgICBzaGFy
ZWRfZnJvbV90aGlzKCkKICAgICAgeyByZXR1cm4gX19zaGFyZWRfcHRyPF9UcCwgX0xwPih0aGlz
LT5fTV93ZWFrX3RoaXMpOyB9CgogICAgICBfX3NoYXJlZF9wdHI8Y29uc3QgX1RwLCBfTHA+CiAg
ICAgIHNoYXJlZF9mcm9tX3RoaXMoKSBjb25zdAogICAgICB7IHJldHVybiBfX3NoYXJlZF9wdHI8
Y29uc3QgX1RwLCBfTHA+KHRoaXMtPl9NX3dlYWtfdGhpcyk7IH0KCiAgICBwcml2YXRlOgogICAg
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxPgogdm9pZAogX01fd2Vha19hc3NpZ24oX1RwMSogX19w
LCBjb25zdCBfX3NoYXJlZF9jb3VudDxfTHA+JiBfX24pIGNvbnN0IG5vZXhjZXB0CiB7IF9NX3dl
YWtfdGhpcy5fTV9hc3NpZ24oX19wLCBfX24pOyB9CgogICAgICB0ZW1wbGF0ZTxfTG9ja19wb2xp
Y3kgX0xwMSwgdHlwZW5hbWUgX1RwMSwgdHlwZW5hbWUgX1RwMj4KIGZyaWVuZCB2b2lkCiBfX2Vu
YWJsZV9zaGFyZWRfZnJvbV90aGlzX2hlbHBlcihjb25zdCBfX3NoYXJlZF9jb3VudDxfTHAxPiYs
CiAgICAgIGNvbnN0IF9fZW5hYmxlX3NoYXJlZF9mcm9tX3RoaXM8X1RwMSwKICAgICAgX0xwMT4q
LCBjb25zdCBfVHAyKikgbm9leGNlcHQ7CgogICAgICBtdXRhYmxlIF9fd2Vha19wdHI8X1RwLCBf
THA+IF9NX3dlYWtfdGhpczsKICAgIH07CgogIHRlbXBsYXRlPF9Mb2NrX3BvbGljeSBfTHAxLCB0
eXBlbmFtZSBfVHAxLCB0eXBlbmFtZSBfVHAyPgogICAgaW5saW5lIHZvaWQKICAgIF9fZW5hYmxl
X3NoYXJlZF9mcm9tX3RoaXNfaGVscGVyKGNvbnN0IF9fc2hhcmVkX2NvdW50PF9McDE+JiBfX3Bu
LAogICAgICAgICBjb25zdCBfX2VuYWJsZV9zaGFyZWRfZnJvbV90aGlzPF9UcDEsCiAgICAgICAg
IF9McDE+KiBfX3BlLAogICAgICAgICBjb25zdCBfVHAyKiBfX3B4KSBub2V4Y2VwdAogICAgewog
ICAgICBpZiAoX19wZSAhPSBudWxscHRyKQogX19wZS0+X01fd2Vha19hc3NpZ24oY29uc3RfY2Fz
dDxfVHAyKj4oX19weCksIF9fcG4pOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIF9M
b2NrX3BvbGljeSBfTHAsIHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUuLi4gX0FyZ3M+CiAgICBp
bmxpbmUgX19zaGFyZWRfcHRyPF9UcCwgX0xwPgogICAgX19hbGxvY2F0ZV9zaGFyZWQoY29uc3Qg
X0FsbG9jJiBfX2EsIF9BcmdzJiYuLi4gX19hcmdzKQogICAgewogICAgICByZXR1cm4gX19zaGFy
ZWRfcHRyPF9UcCwgX0xwPihfU3BfbWFrZV9zaGFyZWRfdGFnKCksIF9fYSwKICAgICAgICBzdGQ6
OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHAsIF9Mb2NrX3BvbGljeSBfTHAsIHR5cGVuYW1lLi4uIF9BcmdzPgogICAgaW5saW5lIF9fc2hh
cmVkX3B0cjxfVHAsIF9McD4KICAgIF9fbWFrZV9zaGFyZWQoX0FyZ3MmJi4uLiBfX2FyZ3MpCiAg
ICB7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgc3RkOjpyZW1vdmVfY29uc3Q8X1RwPjo6dHlwZSBf
VHBfbmM7CiAgICAgIHJldHVybiBzdGQ6Ol9fYWxsb2NhdGVfc2hhcmVkPF9UcCwgX0xwPihzdGQ6
OmFsbG9jYXRvcjxfVHBfbmM+KCksCiAgICAgICAgICAgc3RkOjpmb3J3YXJkPF9BcmdzPihfX2Fy
Z3MpLi4uKTsKICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9M
cD4KICAgIHN0cnVjdCBoYXNoPF9fc2hhcmVkX3B0cjxfVHAsIF9McD4+CiAgICA6IHB1YmxpYyBf
X2hhc2hfYmFzZTxzaXplX3QsIF9fc2hhcmVkX3B0cjxfVHAsIF9McD4+CiAgICB7CiAgICAgIHNp
emVfdAogICAgICBvcGVyYXRvcigpKGNvbnN0IF9fc2hhcmVkX3B0cjxfVHAsIF9McD4mIF9fcykg
Y29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc3RkOjpoYXNoPF9UcCo+KCkoX19zLmdldCgp
KTsgfQogICAgfTsKCgp9CiMgNTMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zaGFyZWRf
cHRyLmgiIDIgMwoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18g
KCJkZWZhdWx0IikpKQp7CgoKCgoKCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2gsIHR5cGVuYW1l
IF9UciwgdHlwZW5hbWUgX1RwLCBfTG9ja19wb2xpY3kgX0xwPgogICAgaW5saW5lIHN0ZDo6YmFz
aWNfb3N0cmVhbTxfQ2gsIF9Ucj4mCiAgICBvcGVyYXRvcjw8KHN0ZDo6YmFzaWNfb3N0cmVhbTxf
Q2gsIF9Ucj4mIF9fb3MsCiAgICAgICAgY29uc3QgX19zaGFyZWRfcHRyPF9UcCwgX0xwPiYgX19w
KQogICAgewogICAgICBfX29zIDw8IF9fcC5nZXQoKTsKICAgICAgcmV0dXJuIF9fb3M7CiAgICB9
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRGVsLCB0eXBlbmFtZSBfVHAsIF9Mb2NrX3BvbGljeSBf
THA+CiAgICBpbmxpbmUgX0RlbCoKICAgIGdldF9kZWxldGVyKGNvbnN0IF9fc2hhcmVkX3B0cjxf
VHAsIF9McD4mIF9fcCkgbm9leGNlcHQKICAgIHsKCiAgICAgIHJldHVybiBzdGF0aWNfY2FzdDxf
RGVsKj4oX19wLl9NX2dldF9kZWxldGVyKHR5cGVpZChfRGVsKSkpOwoKCgogICAgfQojIDkyICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc2hhcmVkX3B0ci5oIiAzCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwPgogICAgY2xhc3Mgc2hhcmVkX3B0ciA6IHB1YmxpYyBfX3NoYXJlZF9wdHI8X1Rw
PgogICAgewogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUHRyPgogdXNpbmcgX0NvbnZlcnRpYmxl
CiAgID0gdHlwZW5hbWUgZW5hYmxlX2lmPGlzX2NvbnZlcnRpYmxlPF9QdHIsIF9UcCo+Ojp2YWx1
ZT46OnR5cGU7CgogICAgcHVibGljOgoKCgoKICAgICAgY29uc3RleHByIHNoYXJlZF9wdHIoKSBu
b2V4Y2VwdAogICAgICA6IF9fc2hhcmVkX3B0cjxfVHA+KCkgeyB9CgogICAgICBzaGFyZWRfcHRy
KGNvbnN0IHNoYXJlZF9wdHImKSBub2V4Y2VwdCA9IGRlZmF1bHQ7CgoKCgoKCgogICAgICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHAxPgogZXhwbGljaXQgc2hhcmVkX3B0cihfVHAxKiBfX3ApCiAgICAg
ICAgOiBfX3NoYXJlZF9wdHI8X1RwPihfX3ApIHsgfQojIDEzMiAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3NoYXJlZF9wdHIuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCB0
eXBlbmFtZSBfRGVsZXRlcj4KIHNoYXJlZF9wdHIoX1RwMSogX19wLCBfRGVsZXRlciBfX2QpCiAg
ICAgICAgOiBfX3NoYXJlZF9wdHI8X1RwPihfX3AsIF9fZCkgeyB9CiMgMTQ5ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvc2hhcmVkX3B0ci5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9EZWxldGVyPgogc2hhcmVkX3B0cihudWxscHRyX3QgX19wLCBfRGVsZXRlciBfX2QpCiAgICAg
ICAgOiBfX3NoYXJlZF9wdHI8X1RwPihfX3AsIF9fZCkgeyB9CiMgMTY4ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc2hhcmVkX3B0ci5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cDEsIHR5cGVuYW1lIF9EZWxldGVyLCB0eXBlbmFtZSBfQWxsb2M+CiBzaGFyZWRfcHRyKF9UcDEq
IF9fcCwgX0RlbGV0ZXIgX19kLCBfQWxsb2MgX19hKQogOiBfX3NoYXJlZF9wdHI8X1RwPihfX3As
IF9fZCwgc3RkOjptb3ZlKF9fYSkpIHsgfQojIDE4NyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3NoYXJlZF9wdHIuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRGVsZXRlciwgdHlw
ZW5hbWUgX0FsbG9jPgogc2hhcmVkX3B0cihudWxscHRyX3QgX19wLCBfRGVsZXRlciBfX2QsIF9B
bGxvYyBfX2EpCiA6IF9fc2hhcmVkX3B0cjxfVHA+KF9fcCwgX19kLCBzdGQ6Om1vdmUoX19hKSkg
eyB9CiMgMjA5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc2hhcmVkX3B0ci5oIiAzCiAg
ICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDE+CiBzaGFyZWRfcHRyKGNvbnN0IHNoYXJlZF9wdHI8
X1RwMT4mIF9fciwgX1RwKiBfX3ApIG5vZXhjZXB0CiA6IF9fc2hhcmVkX3B0cjxfVHA+KF9fciwg
X19wKSB7IH0KIyAyMjAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zaGFyZWRfcHRyLmgi
IDMKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMSwgdHlwZW5hbWUgPSBfQ29udmVydGlibGU8
X1RwMSo+Pgogc2hhcmVkX3B0cihjb25zdCBzaGFyZWRfcHRyPF9UcDE+JiBfX3IpIG5vZXhjZXB0
CiAgICAgICAgOiBfX3NoYXJlZF9wdHI8X1RwPihfX3IpIHsgfQoKCgoKCgogICAgICBzaGFyZWRf
cHRyKHNoYXJlZF9wdHImJiBfX3IpIG5vZXhjZXB0CiAgICAgIDogX19zaGFyZWRfcHRyPF9UcD4o
c3RkOjptb3ZlKF9fcikpIHsgfQoKCgoKCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCB0
eXBlbmFtZSA9IF9Db252ZXJ0aWJsZTxfVHAxKj4+CiBzaGFyZWRfcHRyKHNoYXJlZF9wdHI8X1Rw
MT4mJiBfX3IpIG5vZXhjZXB0CiA6IF9fc2hhcmVkX3B0cjxfVHA+KHN0ZDo6bW92ZShfX3IpKSB7
IH0KIyAyNDkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zaGFyZWRfcHRyLmgiIDMKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KIGV4cGxpY2l0IHNoYXJlZF9wdHIoY29uc3Qgd2Vh
a19wdHI8X1RwMT4mIF9fcikKIDogX19zaGFyZWRfcHRyPF9UcD4oX19yKSB7IH0KCgogICAgICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxPgogc2hhcmVkX3B0cihzdGQ6OmF1dG9fcHRyPF9UcDE+JiYg
X19yKTsKCgoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lIF9EZWwsIHR5
cGVuYW1lCiAgICAgICAgPSBfQ29udmVydGlibGU8dHlwZW5hbWUgdW5pcXVlX3B0cjxfVHAxLCBf
RGVsPjo6cG9pbnRlcj4+CiBzaGFyZWRfcHRyKHN0ZDo6dW5pcXVlX3B0cjxfVHAxLCBfRGVsPiYm
IF9fcikKIDogX19zaGFyZWRfcHRyPF9UcD4oc3RkOjptb3ZlKF9fcikpIHsgfQoKCgoKCiAgICAg
IGNvbnN0ZXhwciBzaGFyZWRfcHRyKG51bGxwdHJfdCkgbm9leGNlcHQgOiBzaGFyZWRfcHRyKCkg
eyB9CgogICAgICBzaGFyZWRfcHRyJiBvcGVyYXRvcj0oY29uc3Qgc2hhcmVkX3B0ciYpIG5vZXhj
ZXB0ID0gZGVmYXVsdDsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDE+CiBzaGFyZWRfcHRy
Jgogb3BlcmF0b3I9KGNvbnN0IHNoYXJlZF9wdHI8X1RwMT4mIF9fcikgbm9leGNlcHQKIHsKICAg
dGhpcy0+X19zaGFyZWRfcHRyPF9UcD46Om9wZXJhdG9yPShfX3IpOwogICByZXR1cm4gKnRoaXM7
CiB9CgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KIHNoYXJlZF9wdHImCiBvcGVyYXRv
cj0oc3RkOjphdXRvX3B0cjxfVHAxPiYmIF9fcikKIHsKICAgdGhpcy0+X19zaGFyZWRfcHRyPF9U
cD46Om9wZXJhdG9yPShzdGQ6Om1vdmUoX19yKSk7CiAgIHJldHVybiAqdGhpczsKIH0KCgogICAg
ICBzaGFyZWRfcHRyJgogICAgICBvcGVyYXRvcj0oc2hhcmVkX3B0ciYmIF9fcikgbm9leGNlcHQK
ICAgICAgewogdGhpcy0+X19zaGFyZWRfcHRyPF9UcD46Om9wZXJhdG9yPShzdGQ6Om1vdmUoX19y
KSk7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCiAgICAgIHRlbXBsYXRlPGNsYXNzIF9UcDE+CiBz
aGFyZWRfcHRyJgogb3BlcmF0b3I9KHNoYXJlZF9wdHI8X1RwMT4mJiBfX3IpIG5vZXhjZXB0CiB7
CiAgIHRoaXMtPl9fc2hhcmVkX3B0cjxfVHA+OjpvcGVyYXRvcj0oc3RkOjptb3ZlKF9fcikpOwog
ICByZXR1cm4gKnRoaXM7CiB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCB0eXBlbmFt
ZSBfRGVsPgogc2hhcmVkX3B0ciYKIG9wZXJhdG9yPShzdGQ6OnVuaXF1ZV9wdHI8X1RwMSwgX0Rl
bD4mJiBfX3IpCiB7CiAgIHRoaXMtPl9fc2hhcmVkX3B0cjxfVHA+OjpvcGVyYXRvcj0oc3RkOjpt
b3ZlKF9fcikpOwogICByZXR1cm4gKnRoaXM7CiB9CgogICAgcHJpdmF0ZToKCiAgICAgIHRlbXBs
YXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUuLi4gX0FyZ3M+CiBzaGFyZWRfcHRyKF9TcF9t
YWtlX3NoYXJlZF90YWcgX190YWcsIGNvbnN0IF9BbGxvYyYgX19hLAogICAgIF9BcmdzJiYuLi4g
X19hcmdzKQogOiBfX3NoYXJlZF9wdHI8X1RwPihfX3RhZywgX19hLCBzdGQ6OmZvcndhcmQ8X0Fy
Z3M+KF9fYXJncykuLi4pCiB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVu
YW1lIF9BbGxvYywgdHlwZW5hbWUuLi4gX0FyZ3M+CiBmcmllbmQgc2hhcmVkX3B0cjxfVHAxPgog
YWxsb2NhdGVfc2hhcmVkKGNvbnN0IF9BbGxvYyYgX19hLCBfQXJncyYmLi4uIF9fYXJncyk7CgoK
ICAgICAgc2hhcmVkX3B0cihjb25zdCB3ZWFrX3B0cjxfVHA+JiBfX3IsIHN0ZDo6bm90aHJvd190
KQogICAgICA6IF9fc2hhcmVkX3B0cjxfVHA+KF9fciwgc3RkOjpub3Rocm93KSB7IH0KCiAgICAg
IGZyaWVuZCBjbGFzcyB3ZWFrX3B0cjxfVHA+OwogICAgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcDEsIHR5cGVuYW1lIF9UcDI+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I9PShjb25z
dCBzaGFyZWRfcHRyPF9UcDE+JiBfX2EsCiAgICAgICAgY29uc3Qgc2hhcmVkX3B0cjxfVHAyPiYg
X19iKSBub2V4Y2VwdAogICAgeyByZXR1cm4gX19hLmdldCgpID09IF9fYi5nZXQoKTsgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I9PShjb25z
dCBzaGFyZWRfcHRyPF9UcD4mIF9fYSwgbnVsbHB0cl90KSBub2V4Y2VwdAogICAgeyByZXR1cm4g
IV9fYTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgYm9vbAogICAgb3Bl
cmF0b3I9PShudWxscHRyX3QsIGNvbnN0IHNoYXJlZF9wdHI8X1RwPiYgX19hKSBub2V4Y2VwdAog
ICAgeyByZXR1cm4gIV9fYTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCB0eXBlbmFtZSBf
VHAyPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yIT0oY29uc3Qgc2hhcmVkX3B0cjxfVHAx
PiYgX19hLAogICAgICAgIGNvbnN0IHNoYXJlZF9wdHI8X1RwMj4mIF9fYikgbm9leGNlcHQKICAg
IHsgcmV0dXJuIF9fYS5nZXQoKSAhPSBfX2IuZ2V0KCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yIT0oY29uc3Qgc2hhcmVkX3B0cjxfVHA+
JiBfX2EsIG51bGxwdHJfdCkgbm9leGNlcHQKICAgIHsgcmV0dXJuIChib29sKV9fYTsgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3IhPShudWxs
cHRyX3QsIGNvbnN0IHNoYXJlZF9wdHI8X1RwPiYgX19hKSBub2V4Y2VwdAogICAgeyByZXR1cm4g
KGJvb2wpX19hOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lIF9UcDI+CiAg
ICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I8KGNvbnN0IHNoYXJlZF9wdHI8X1RwMT4mIF9fYSwK
ICAgICAgIGNvbnN0IHNoYXJlZF9wdHI8X1RwMj4mIF9fYikgbm9leGNlcHQKICAgIHsKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBzdGQ6OmNvbW1vbl90eXBlPF9UcDEqLCBfVHAyKj46OnR5cGUgX0NU
OwogICAgICByZXR1cm4gc3RkOjpsZXNzPF9DVD4oKShfX2EuZ2V0KCksIF9fYi5nZXQoKSk7CiAg
ICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRv
cjwoY29uc3Qgc2hhcmVkX3B0cjxfVHA+JiBfX2EsIG51bGxwdHJfdCkgbm9leGNlcHQKICAgIHsg
cmV0dXJuIHN0ZDo6bGVzczxfVHAqPigpKF9fYS5nZXQoKSwgbnVsbHB0cik7IH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPChudWxscHRyX3Qs
IGNvbnN0IHNoYXJlZF9wdHI8X1RwPiYgX19hKSBub2V4Y2VwdAogICAgeyByZXR1cm4gc3RkOjps
ZXNzPF9UcCo+KCkobnVsbHB0ciwgX19hLmdldCgpKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHAxLCB0eXBlbmFtZSBfVHAyPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPD0oY29uc3Qg
c2hhcmVkX3B0cjxfVHAxPiYgX19hLAogICAgICAgIGNvbnN0IHNoYXJlZF9wdHI8X1RwMj4mIF9f
Yikgbm9leGNlcHQKICAgIHsgcmV0dXJuICEoX19iIDwgX19hKTsgfQoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHA+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I8PShjb25zdCBzaGFyZWRfcHRy
PF9UcD4mIF9fYSwgbnVsbHB0cl90KSBub2V4Y2VwdAogICAgeyByZXR1cm4gIShudWxscHRyIDwg
X19hKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgYm9vbAogICAgb3Bl
cmF0b3I8PShudWxscHRyX3QsIGNvbnN0IHNoYXJlZF9wdHI8X1RwPiYgX19hKSBub2V4Y2VwdAog
ICAgeyByZXR1cm4gIShfX2EgPCBudWxscHRyKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAx
LCB0eXBlbmFtZSBfVHAyPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPihjb25zdCBzaGFy
ZWRfcHRyPF9UcDE+JiBfX2EsCiAgICAgICBjb25zdCBzaGFyZWRfcHRyPF9UcDI+JiBfX2IpIG5v
ZXhjZXB0CiAgICB7IHJldHVybiAoX19iIDwgX19hKTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHA+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I+KGNvbnN0IHNoYXJlZF9wdHI8X1RwPiYg
X19hLCBudWxscHRyX3QpIG5vZXhjZXB0CiAgICB7IHJldHVybiBzdGQ6Omxlc3M8X1RwKj4oKShu
dWxscHRyLCBfX2EuZ2V0KCkpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGlu
ZSBib29sCiAgICBvcGVyYXRvcj4obnVsbHB0cl90LCBjb25zdCBzaGFyZWRfcHRyPF9UcD4mIF9f
YSkgbm9leGNlcHQKICAgIHsgcmV0dXJuIHN0ZDo6bGVzczxfVHAqPigpKF9fYS5nZXQoKSwgbnVs
bHB0cik7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMSwgdHlwZW5hbWUgX1RwMj4KICAgIGlu
bGluZSBib29sCiAgICBvcGVyYXRvcj49KGNvbnN0IHNoYXJlZF9wdHI8X1RwMT4mIF9fYSwKICAg
ICAgICBjb25zdCBzaGFyZWRfcHRyPF9UcDI+JiBfX2IpIG5vZXhjZXB0CiAgICB7IHJldHVybiAh
KF9fYSA8IF9fYik7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgaW5saW5lIGJvb2wK
ICAgIG9wZXJhdG9yPj0oY29uc3Qgc2hhcmVkX3B0cjxfVHA+JiBfX2EsIG51bGxwdHJfdCkgbm9l
eGNlcHQKICAgIHsgcmV0dXJuICEoX19hIDwgbnVsbHB0cik7IH0KCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPj0obnVsbHB0cl90LCBjb25zdCBz
aGFyZWRfcHRyPF9UcD4mIF9fYSkgbm9leGNlcHQKICAgIHsgcmV0dXJuICEobnVsbHB0ciA8IF9f
YSk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IGxlc3M8c2hhcmVkX3B0
cjxfVHA+PiA6IHB1YmxpYyBfU3BfbGVzczxzaGFyZWRfcHRyPF9UcD4+CiAgICB7IH07CgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgdm9pZAogICAgc3dhcChzaGFyZWRfcHRy
PF9UcD4mIF9fYSwgc2hhcmVkX3B0cjxfVHA+JiBfX2IpIG5vZXhjZXB0CiAgICB7IF9fYS5zd2Fw
KF9fYik7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1RwMT4KICAgIGlu
bGluZSBzaGFyZWRfcHRyPF9UcD4KICAgIHN0YXRpY19wb2ludGVyX2Nhc3QoY29uc3Qgc2hhcmVk
X3B0cjxfVHAxPiYgX19yKSBub2V4Y2VwdAogICAgeyByZXR1cm4gc2hhcmVkX3B0cjxfVHA+KF9f
ciwgc3RhdGljX2Nhc3Q8X1RwKj4oX19yLmdldCgpKSk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwLCB0eXBlbmFtZSBfVHAxPgogICAgaW5saW5lIHNoYXJlZF9wdHI8X1RwPgogICAgY29uc3Rf
cG9pbnRlcl9jYXN0KGNvbnN0IHNoYXJlZF9wdHI8X1RwMT4mIF9fcikgbm9leGNlcHQKICAgIHsg
cmV0dXJuIHNoYXJlZF9wdHI8X1RwPihfX3IsIGNvbnN0X2Nhc3Q8X1RwKj4oX19yLmdldCgpKSk7
IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfVHAxPgogICAgaW5saW5lIHNo
YXJlZF9wdHI8X1RwPgogICAgZHluYW1pY19wb2ludGVyX2Nhc3QoY29uc3Qgc2hhcmVkX3B0cjxf
VHAxPiYgX19yKSBub2V4Y2VwdAogICAgewogICAgICBpZiAoX1RwKiBfX3AgPSBkeW5hbWljX2Nh
c3Q8X1RwKj4oX19yLmdldCgpKSkKIHJldHVybiBzaGFyZWRfcHRyPF9UcD4oX19yLCBfX3ApOwog
ICAgICByZXR1cm4gc2hhcmVkX3B0cjxfVHA+KCk7CiAgICB9CgoKCgoKCgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9UcD4KICAgIGNsYXNzIHdlYWtfcHRyIDogcHVibGljIF9fd2Vha19wdHI8X1RwPgog
ICAgewogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUHRyPgogdXNpbmcgX0NvbnZlcnRpYmxlCiAg
ID0gdHlwZW5hbWUgZW5hYmxlX2lmPGlzX2NvbnZlcnRpYmxlPF9QdHIsIF9UcCo+Ojp2YWx1ZT46
OnR5cGU7CgogICAgcHVibGljOgogICAgICBjb25zdGV4cHIgd2Vha19wdHIoKSBub2V4Y2VwdCA9
IGRlZmF1bHQ7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCB0eXBlbmFtZSA9IF9Db252
ZXJ0aWJsZTxfVHAxKj4+CiB3ZWFrX3B0cihjb25zdCBzaGFyZWRfcHRyPF9UcDE+JiBfX3IpIG5v
ZXhjZXB0CiA6IF9fd2Vha19wdHI8X1RwPihfX3IpIHsgfQoKICAgICAgd2Vha19wdHIoY29uc3Qg
d2Vha19wdHImKSBub2V4Y2VwdCA9IGRlZmF1bHQ7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHAxLCB0eXBlbmFtZSA9IF9Db252ZXJ0aWJsZTxfVHAxKj4+CiB3ZWFrX3B0cihjb25zdCB3ZWFr
X3B0cjxfVHAxPiYgX19yKSBub2V4Y2VwdAogOiBfX3dlYWtfcHRyPF9UcD4oX19yKSB7IH0KCiAg
ICAgIHdlYWtfcHRyKHdlYWtfcHRyJiYpIG5vZXhjZXB0ID0gZGVmYXVsdDsKCiAgICAgIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcDEsIHR5cGVuYW1lID0gX0NvbnZlcnRpYmxlPF9UcDEqPj4KIHdlYWtf
cHRyKHdlYWtfcHRyPF9UcDE+JiYgX19yKSBub2V4Y2VwdAogOiBfX3dlYWtfcHRyPF9UcD4oc3Rk
Ojptb3ZlKF9fcikpIHsgfQoKICAgICAgd2Vha19wdHImCiAgICAgIG9wZXJhdG9yPShjb25zdCB3
ZWFrX3B0ciYgX19yKSBub2V4Y2VwdCA9IGRlZmF1bHQ7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfVHAxPgogd2Vha19wdHImCiBvcGVyYXRvcj0oY29uc3Qgd2Vha19wdHI8X1RwMT4mIF9fcikg
bm9leGNlcHQKIHsKICAgdGhpcy0+X193ZWFrX3B0cjxfVHA+OjpvcGVyYXRvcj0oX19yKTsKICAg
cmV0dXJuICp0aGlzOwogfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KIHdlYWtfcHRy
Jgogb3BlcmF0b3I9KGNvbnN0IHNoYXJlZF9wdHI8X1RwMT4mIF9fcikgbm9leGNlcHQKIHsKICAg
dGhpcy0+X193ZWFrX3B0cjxfVHA+OjpvcGVyYXRvcj0oX19yKTsKICAgcmV0dXJuICp0aGlzOwog
fQoKICAgICAgd2Vha19wdHImCiAgICAgIG9wZXJhdG9yPSh3ZWFrX3B0ciYmIF9fcikgbm9leGNl
cHQgPSBkZWZhdWx0OwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KIHdlYWtfcHRyJgog
b3BlcmF0b3I9KHdlYWtfcHRyPF9UcDE+JiYgX19yKSBub2V4Y2VwdAogewogICB0aGlzLT5fX3dl
YWtfcHRyPF9UcD46Om9wZXJhdG9yPShzdGQ6Om1vdmUoX19yKSk7CiAgIHJldHVybiAqdGhpczsK
IH0KCiAgICAgIHNoYXJlZF9wdHI8X1RwPgogICAgICBsb2NrKCkgY29uc3Qgbm9leGNlcHQKICAg
ICAgeyByZXR1cm4gc2hhcmVkX3B0cjxfVHA+KCp0aGlzLCBzdGQ6Om5vdGhyb3cpOyB9CiAgICB9
OwoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgaW5saW5lIHZvaWQKICAgIHN3YXAod2Vh
a19wdHI8X1RwPiYgX19hLCB3ZWFrX3B0cjxfVHA+JiBfX2IpIG5vZXhjZXB0CiAgICB7IF9fYS5z
d2FwKF9fYik7IH0KCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3Qgb3duZXJf
bGVzczsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBvd25lcl9sZXNzPHNo
YXJlZF9wdHI8X1RwPj4KICAgIDogcHVibGljIF9TcF9vd25lcl9sZXNzPHNoYXJlZF9wdHI8X1Rw
Piwgd2Vha19wdHI8X1RwPj4KICAgIHsgfTsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
IHN0cnVjdCBvd25lcl9sZXNzPHdlYWtfcHRyPF9UcD4+CiAgICA6IHB1YmxpYyBfU3Bfb3duZXJf
bGVzczx3ZWFrX3B0cjxfVHA+LCBzaGFyZWRfcHRyPF9UcD4+CiAgICB7IH07CgoKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgIGNsYXNzIGVuYWJsZV9zaGFyZWRfZnJvbV90aGlzCiAgICB7
CiAgICBwcm90ZWN0ZWQ6CiAgICAgIGNvbnN0ZXhwciBlbmFibGVfc2hhcmVkX2Zyb21fdGhpcygp
IG5vZXhjZXB0IHsgfQoKICAgICAgZW5hYmxlX3NoYXJlZF9mcm9tX3RoaXMoY29uc3QgZW5hYmxl
X3NoYXJlZF9mcm9tX3RoaXMmKSBub2V4Y2VwdCB7IH0KCiAgICAgIGVuYWJsZV9zaGFyZWRfZnJv
bV90aGlzJgogICAgICBvcGVyYXRvcj0oY29uc3QgZW5hYmxlX3NoYXJlZF9mcm9tX3RoaXMmKSBu
b2V4Y2VwdAogICAgICB7IHJldHVybiAqdGhpczsgfQoKICAgICAgfmVuYWJsZV9zaGFyZWRfZnJv
bV90aGlzKCkgeyB9CgogICAgcHVibGljOgogICAgICBzaGFyZWRfcHRyPF9UcD4KICAgICAgc2hh
cmVkX2Zyb21fdGhpcygpCiAgICAgIHsgcmV0dXJuIHNoYXJlZF9wdHI8X1RwPih0aGlzLT5fTV93
ZWFrX3RoaXMpOyB9CgogICAgICBzaGFyZWRfcHRyPGNvbnN0IF9UcD4KICAgICAgc2hhcmVkX2Zy
b21fdGhpcygpIGNvbnN0CiAgICAgIHsgcmV0dXJuIHNoYXJlZF9wdHI8Y29uc3QgX1RwPih0aGlz
LT5fTV93ZWFrX3RoaXMpOyB9CgogICAgcHJpdmF0ZToKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwMT4KIHZvaWQKIF9NX3dlYWtfYXNzaWduKF9UcDEqIF9fcCwgY29uc3QgX19zaGFyZWRfY291
bnQ8PiYgX19uKSBjb25zdCBub2V4Y2VwdAogeyBfTV93ZWFrX3RoaXMuX01fYXNzaWduKF9fcCwg
X19uKTsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMSwgdHlwZW5hbWUgX1RwMj4KIGZy
aWVuZCB2b2lkCiBfX2VuYWJsZV9zaGFyZWRfZnJvbV90aGlzX2hlbHBlcihjb25zdCBfX3NoYXJl
ZF9jb3VudDw+JiwKICAgICAgY29uc3QgZW5hYmxlX3NoYXJlZF9mcm9tX3RoaXM8X1RwMT4qLAog
ICAgICBjb25zdCBfVHAyKikgbm9leGNlcHQ7CgogICAgICBtdXRhYmxlIHdlYWtfcHRyPF9UcD4g
X01fd2Vha190aGlzOwogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMSwgdHlwZW5hbWUg
X1RwMj4KICAgIGlubGluZSB2b2lkCiAgICBfX2VuYWJsZV9zaGFyZWRfZnJvbV90aGlzX2hlbHBl
cihjb25zdCBfX3NoYXJlZF9jb3VudDw+JiBfX3BuLAogICAgICAgICBjb25zdCBlbmFibGVfc2hh
cmVkX2Zyb21fdGhpczxfVHAxPioKICAgICAgICAgX19wZSwgY29uc3QgX1RwMiogX19weCkgbm9l
eGNlcHQKICAgIHsKICAgICAgaWYgKF9fcGUgIT0gbnVsbHB0cikKIF9fcGUtPl9NX3dlYWtfYXNz
aWduKGNvbnN0X2Nhc3Q8X1RwMio+KF9fcHgpLCBfX3BuKTsKICAgIH0KIyA2MTUgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zaGFyZWRfcHRyLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHAsIHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUuLi4gX0FyZ3M+CiAgICBpbmxpbmUgc2hhcmVk
X3B0cjxfVHA+CiAgICBhbGxvY2F0ZV9zaGFyZWQoY29uc3QgX0FsbG9jJiBfX2EsIF9BcmdzJiYu
Li4gX19hcmdzKQogICAgewogICAgICByZXR1cm4gc2hhcmVkX3B0cjxfVHA+KF9TcF9tYWtlX3No
YXJlZF90YWcoKSwgX19hLAogICAgICAgIHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLik7
CiAgICB9CiMgNjMwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc2hhcmVkX3B0ci5oIiAz
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZS4uLiBfQXJncz4KICAgIGlubGluZSBz
aGFyZWRfcHRyPF9UcD4KICAgIG1ha2Vfc2hhcmVkKF9BcmdzJiYuLi4gX19hcmdzKQogICAgewog
ICAgICB0eXBlZGVmIHR5cGVuYW1lIHN0ZDo6cmVtb3ZlX2NvbnN0PF9UcD46OnR5cGUgX1RwX25j
OwogICAgICByZXR1cm4gc3RkOjphbGxvY2F0ZV9zaGFyZWQ8X1RwPihzdGQ6OmFsbG9jYXRvcjxf
VHBfbmM+KCksCiAgICAgICAgICAgc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsKICAg
IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIHN0cnVjdCBoYXNoPHNoYXJlZF9wdHI8
X1RwPj4KICAgIDogcHVibGljIF9faGFzaF9iYXNlPHNpemVfdCwgc2hhcmVkX3B0cjxfVHA+Pgog
ICAgewogICAgICBzaXplX3QKICAgICAgb3BlcmF0b3IoKShjb25zdCBzaGFyZWRfcHRyPF9UcD4m
IF9fcykgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gc3RkOjpoYXNoPF9UcCo+KCkoX19z
LmdldCgpKTsgfQogICAgfTsKCgoKCn0KIyA4MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9tZW1v
cnkiIDIgMwojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zaGFyZWRfcHRyX2F0b21p
Yy5oIiAxIDMKIyAzMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3NoYXJlZF9wdHJfYXRv
bWljLmgiIDMKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYXRvbWljX2Jhc2UuaCIg
MSAzCiMgMzMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9hdG9taWNfYmFzZS5oIiAzCiAg
ICAgICAKIyAzNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2F0b21pY19iYXNlLmgiIDMK
IyA0MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2F0b21pY19iYXNlLmgiIDMKbmFtZXNw
YWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7Cgoj
IDU1ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvYXRvbWljX2Jhc2UuaCIgMwogIHR5cGVk
ZWYgZW51bSBtZW1vcnlfb3JkZXIKICAgIHsKICAgICAgbWVtb3J5X29yZGVyX3JlbGF4ZWQsCiAg
ICAgIG1lbW9yeV9vcmRlcl9jb25zdW1lLAogICAgICBtZW1vcnlfb3JkZXJfYWNxdWlyZSwKICAg
ICAgbWVtb3J5X29yZGVyX3JlbGVhc2UsCiAgICAgIG1lbW9yeV9vcmRlcl9hY3FfcmVsLAogICAg
ICBtZW1vcnlfb3JkZXJfc2VxX2NzdAogICAgfSBtZW1vcnlfb3JkZXI7CgogIGVudW0gX19tZW1v
cnlfb3JkZXJfbW9kaWZpZXIKICAgIHsKICAgICAgX19tZW1vcnlfb3JkZXJfbWFzayA9IDB4MGZm
ZmYsCiAgICAgIF9fbWVtb3J5X29yZGVyX21vZGlmaWVyX21hc2sgPSAweGZmZmYwMDAwLAogICAg
ICBfX21lbW9yeV9vcmRlcl9obGVfYWNxdWlyZSA9IDB4MTAwMDAsCiAgICAgIF9fbWVtb3J5X29y
ZGVyX2hsZV9yZWxlYXNlID0gMHgyMDAwMAogICAgfTsKCiAgY29uc3RleHByIG1lbW9yeV9vcmRl
cgogIG9wZXJhdG9yfChtZW1vcnlfb3JkZXIgX19tLCBfX21lbW9yeV9vcmRlcl9tb2RpZmllciBf
X21vZCkKICB7CiAgICByZXR1cm4gbWVtb3J5X29yZGVyKF9fbSB8IGludChfX21vZCkpOwogIH0K
CiAgY29uc3RleHByIG1lbW9yeV9vcmRlcgogIG9wZXJhdG9yJihtZW1vcnlfb3JkZXIgX19tLCBf
X21lbW9yeV9vcmRlcl9tb2RpZmllciBfX21vZCkKICB7CiAgICByZXR1cm4gbWVtb3J5X29yZGVy
KF9fbSAmIGludChfX21vZCkpOwogIH0KCgogIGNvbnN0ZXhwciBtZW1vcnlfb3JkZXIKICBfX2Nt
cGV4Y2hfZmFpbHVyZV9vcmRlcjIobWVtb3J5X29yZGVyIF9fbSkgbm9leGNlcHQKICB7CiAgICBy
ZXR1cm4gX19tID09IG1lbW9yeV9vcmRlcl9hY3FfcmVsID8gbWVtb3J5X29yZGVyX2FjcXVpcmUK
ICAgICAgOiBfX20gPT0gbWVtb3J5X29yZGVyX3JlbGVhc2UgPyBtZW1vcnlfb3JkZXJfcmVsYXhl
ZCA6IF9fbTsKICB9CgogIGNvbnN0ZXhwciBtZW1vcnlfb3JkZXIKICBfX2NtcGV4Y2hfZmFpbHVy
ZV9vcmRlcihtZW1vcnlfb3JkZXIgX19tKSBub2V4Y2VwdAogIHsKICAgIHJldHVybiBtZW1vcnlf
b3JkZXIoX19jbXBleGNoX2ZhaWx1cmVfb3JkZXIyKF9fbSAmIF9fbWVtb3J5X29yZGVyX21hc2sp
CiAgICAgIHwgKF9fbSAmIF9fbWVtb3J5X29yZGVyX21vZGlmaWVyX21hc2spKTsKICB9CgogIGlu
bGluZSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQKICBhdG9taWNfdGhy
ZWFkX2ZlbmNlKG1lbW9yeV9vcmRlciBfX20pIG5vZXhjZXB0CiAgeyBfX2F0b21pY190aHJlYWRf
ZmVuY2UoX19tKTsgfQoKICBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18p
KSB2b2lkCiAgYXRvbWljX3NpZ25hbF9mZW5jZShtZW1vcnlfb3JkZXIgX19tKSBub2V4Y2VwdAog
IHsgX19hdG9taWNfc2lnbmFsX2ZlbmNlKF9fbSk7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9U
cD4KICAgIGlubGluZSBfVHAKICAgIGtpbGxfZGVwZW5kZW5jeShfVHAgX195KSBub2V4Y2VwdAog
ICAgewogICAgICBfVHAgX19yZXQoX195KTsKICAgICAgcmV0dXJuIF9fcmV0OwogICAgfQoKCgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9JbnRUcD4KICAgIHN0cnVjdCBfX2F0b21pY19iYXNlOwoKCgoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgYXRvbWljOwoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHA+CiAgICBzdHJ1Y3QgYXRvbWljPF9UcCo+OwoKCgogICAgdHlwZWRlZiBib29s
IF9fYXRvbWljX2ZsYWdfZGF0YV90eXBlOwojIDE0OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL2F0b21pY19iYXNlLmgiIDMKICBleHRlcm4gIkMiIHsKCiAgc3RydWN0IF9fYXRvbWljX2Zs
YWdfYmFzZQogIHsKICAgIF9fYXRvbWljX2ZsYWdfZGF0YV90eXBlIF9NX2k7CiAgfTsKCiAgfQoK
CgoKICBzdHJ1Y3QgYXRvbWljX2ZsYWcgOiBwdWJsaWMgX19hdG9taWNfZmxhZ19iYXNlCiAgewog
ICAgYXRvbWljX2ZsYWcoKSBub2V4Y2VwdCA9IGRlZmF1bHQ7CiAgICB+YXRvbWljX2ZsYWcoKSBu
b2V4Y2VwdCA9IGRlZmF1bHQ7CiAgICBhdG9taWNfZmxhZyhjb25zdCBhdG9taWNfZmxhZyYpID0g
ZGVsZXRlOwogICAgYXRvbWljX2ZsYWcmIG9wZXJhdG9yPShjb25zdCBhdG9taWNfZmxhZyYpID0g
ZGVsZXRlOwogICAgYXRvbWljX2ZsYWcmIG9wZXJhdG9yPShjb25zdCBhdG9taWNfZmxhZyYpIHZv
bGF0aWxlID0gZGVsZXRlOwoKCiAgICBjb25zdGV4cHIgYXRvbWljX2ZsYWcoYm9vbCBfX2kpIG5v
ZXhjZXB0CiAgICAgIDogX19hdG9taWNfZmxhZ19iYXNleyBfU19pbml0KF9faSkgfQogICAgeyB9
CgogICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgYm9vbAogICAg
dGVzdF9hbmRfc2V0KG1lbW9yeV9vcmRlciBfX20gPSBtZW1vcnlfb3JkZXJfc2VxX2NzdCkgbm9l
eGNlcHQKICAgIHsKICAgICAgcmV0dXJuIF9fYXRvbWljX3Rlc3RfYW5kX3NldCAoJl9NX2ksIF9f
bSk7CiAgICB9CgogICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
Ym9vbAogICAgdGVzdF9hbmRfc2V0KG1lbW9yeV9vcmRlciBfX20gPSBtZW1vcnlfb3JkZXJfc2Vx
X2NzdCkgdm9sYXRpbGUgbm9leGNlcHQKICAgIHsKICAgICAgcmV0dXJuIF9fYXRvbWljX3Rlc3Rf
YW5kX3NldCAoJl9NX2ksIF9fbSk7CiAgICB9CgogICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9f
YWx3YXlzX2lubGluZV9fKSkgdm9pZAogICAgY2xlYXIobWVtb3J5X29yZGVyIF9fbSA9IG1lbW9y
eV9vcmRlcl9zZXFfY3N0KSBub2V4Y2VwdAogICAgewogICAgICBtZW1vcnlfb3JkZXIgX19iID0g
X19tICYgX19tZW1vcnlfb3JkZXJfbWFzazsKICAgICAgOwogICAgICA7CiAgICAgIDsKCiAgICAg
IF9fYXRvbWljX2NsZWFyICgmX01faSwgX19tKTsKICAgIH0KCiAgICBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkCiAgICBjbGVhcihtZW1vcnlfb3JkZXIgX19t
ID0gbWVtb3J5X29yZGVyX3NlcV9jc3QpIHZvbGF0aWxlIG5vZXhjZXB0CiAgICB7CiAgICAgIG1l
bW9yeV9vcmRlciBfX2IgPSBfX20gJiBfX21lbW9yeV9vcmRlcl9tYXNrOwogICAgICA7CiAgICAg
IDsKICAgICAgOwoKICAgICAgX19hdG9taWNfY2xlYXIgKCZfTV9pLCBfX20pOwogICAgfQoKICBw
cml2YXRlOgogICAgc3RhdGljIGNvbnN0ZXhwciBfX2F0b21pY19mbGFnX2RhdGFfdHlwZQogICAg
X1NfaW5pdChib29sIF9faSkKICAgIHsgcmV0dXJuIF9faSA/IDEgOiAwOyB9CiAgfTsKIyAyMzcg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9hdG9taWNfYmFzZS5oIiAzCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0lUcD4KICAgIHN0cnVjdCBfX2F0b21pY19iYXNlCiAgICB7CiAgICBwcml2YXRl
OgogICAgICB0eXBlZGVmIF9JVHAgX19pbnRfdHlwZTsKCiAgICAgIHN0YXRpYyBjb25zdGV4cHIg
aW50IF9TX2FsaWdubWVudCA9CiBzaXplb2YoX0lUcCkgPiBhbGlnbm9mKF9JVHApID8gc2l6ZW9m
KF9JVHApIDogYWxpZ25vZihfSVRwKTsKCiAgICAgIGFsaWduYXMoX1NfYWxpZ25tZW50KSBfX2lu
dF90eXBlIF9NX2k7CgogICAgcHVibGljOgogICAgICBfX2F0b21pY19iYXNlKCkgbm9leGNlcHQg
PSBkZWZhdWx0OwogICAgICB+X19hdG9taWNfYmFzZSgpIG5vZXhjZXB0ID0gZGVmYXVsdDsKICAg
ICAgX19hdG9taWNfYmFzZShjb25zdCBfX2F0b21pY19iYXNlJikgPSBkZWxldGU7CiAgICAgIF9f
YXRvbWljX2Jhc2UmIG9wZXJhdG9yPShjb25zdCBfX2F0b21pY19iYXNlJikgPSBkZWxldGU7CiAg
ICAgIF9fYXRvbWljX2Jhc2UmIG9wZXJhdG9yPShjb25zdCBfX2F0b21pY19iYXNlJikgdm9sYXRp
bGUgPSBkZWxldGU7CgoKICAgICAgY29uc3RleHByIF9fYXRvbWljX2Jhc2UoX19pbnRfdHlwZSBf
X2kpIG5vZXhjZXB0IDogX01faSAoX19pKSB7IH0KCiAgICAgIG9wZXJhdG9yIF9faW50X3R5cGUo
KSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBsb2FkKCk7IH0KCiAgICAgIG9wZXJhdG9y
IF9faW50X3R5cGUoKSBjb25zdCB2b2xhdGlsZSBub2V4Y2VwdAogICAgICB7IHJldHVybiBsb2Fk
KCk7IH0KCiAgICAgIF9faW50X3R5cGUKICAgICAgb3BlcmF0b3I9KF9faW50X3R5cGUgX19pKSBu
b2V4Y2VwdAogICAgICB7CiBzdG9yZShfX2kpOwogcmV0dXJuIF9faTsKICAgICAgfQoKICAgICAg
X19pbnRfdHlwZQogICAgICBvcGVyYXRvcj0oX19pbnRfdHlwZSBfX2kpIHZvbGF0aWxlIG5vZXhj
ZXB0CiAgICAgIHsKIHN0b3JlKF9faSk7CiByZXR1cm4gX19pOwogICAgICB9CgogICAgICBfX2lu
dF90eXBlCiAgICAgIG9wZXJhdG9yKysoaW50KSBub2V4Y2VwdAogICAgICB7IHJldHVybiBmZXRj
aF9hZGQoMSk7IH0KCiAgICAgIF9faW50X3R5cGUKICAgICAgb3BlcmF0b3IrKyhpbnQpIHZvbGF0
aWxlIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGZldGNoX2FkZCgxKTsgfQoKICAgICAgX19pbnRf
dHlwZQogICAgICBvcGVyYXRvci0tKGludCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4gZmV0Y2hf
c3ViKDEpOyB9CgogICAgICBfX2ludF90eXBlCiAgICAgIG9wZXJhdG9yLS0oaW50KSB2b2xhdGls
ZSBub2V4Y2VwdAogICAgICB7IHJldHVybiBmZXRjaF9zdWIoMSk7IH0KCiAgICAgIF9faW50X3R5
cGUKICAgICAgb3BlcmF0b3IrKygpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fYXRvbWljX2Fk
ZF9mZXRjaCgmX01faSwgMSwgbWVtb3J5X29yZGVyX3NlcV9jc3QpOyB9CgogICAgICBfX2ludF90
eXBlCiAgICAgIG9wZXJhdG9yKysoKSB2b2xhdGlsZSBub2V4Y2VwdAogICAgICB7IHJldHVybiBf
X2F0b21pY19hZGRfZmV0Y2goJl9NX2ksIDEsIG1lbW9yeV9vcmRlcl9zZXFfY3N0KTsgfQoKICAg
ICAgX19pbnRfdHlwZQogICAgICBvcGVyYXRvci0tKCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4g
X19hdG9taWNfc3ViX2ZldGNoKCZfTV9pLCAxLCBtZW1vcnlfb3JkZXJfc2VxX2NzdCk7IH0KCiAg
ICAgIF9faW50X3R5cGUKICAgICAgb3BlcmF0b3ItLSgpIHZvbGF0aWxlIG5vZXhjZXB0CiAgICAg
IHsgcmV0dXJuIF9fYXRvbWljX3N1Yl9mZXRjaCgmX01faSwgMSwgbWVtb3J5X29yZGVyX3NlcV9j
c3QpOyB9CgogICAgICBfX2ludF90eXBlCiAgICAgIG9wZXJhdG9yKz0oX19pbnRfdHlwZSBfX2kp
IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fYXRvbWljX2FkZF9mZXRjaCgmX01faSwgX19pLCBt
ZW1vcnlfb3JkZXJfc2VxX2NzdCk7IH0KCiAgICAgIF9faW50X3R5cGUKICAgICAgb3BlcmF0b3Ir
PShfX2ludF90eXBlIF9faSkgdm9sYXRpbGUgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX19hdG9t
aWNfYWRkX2ZldGNoKCZfTV9pLCBfX2ksIG1lbW9yeV9vcmRlcl9zZXFfY3N0KTsgfQoKICAgICAg
X19pbnRfdHlwZQogICAgICBvcGVyYXRvci09KF9faW50X3R5cGUgX19pKSBub2V4Y2VwdAogICAg
ICB7IHJldHVybiBfX2F0b21pY19zdWJfZmV0Y2goJl9NX2ksIF9faSwgbWVtb3J5X29yZGVyX3Nl
cV9jc3QpOyB9CgogICAgICBfX2ludF90eXBlCiAgICAgIG9wZXJhdG9yLT0oX19pbnRfdHlwZSBf
X2kpIHZvbGF0aWxlIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fYXRvbWljX3N1Yl9mZXRjaCgm
X01faSwgX19pLCBtZW1vcnlfb3JkZXJfc2VxX2NzdCk7IH0KCiAgICAgIF9faW50X3R5cGUKICAg
ICAgb3BlcmF0b3ImPShfX2ludF90eXBlIF9faSkgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX19h
dG9taWNfYW5kX2ZldGNoKCZfTV9pLCBfX2ksIG1lbW9yeV9vcmRlcl9zZXFfY3N0KTsgfQoKICAg
ICAgX19pbnRfdHlwZQogICAgICBvcGVyYXRvciY9KF9faW50X3R5cGUgX19pKSB2b2xhdGlsZSBu
b2V4Y2VwdAogICAgICB7IHJldHVybiBfX2F0b21pY19hbmRfZmV0Y2goJl9NX2ksIF9faSwgbWVt
b3J5X29yZGVyX3NlcV9jc3QpOyB9CgogICAgICBfX2ludF90eXBlCiAgICAgIG9wZXJhdG9yfD0o
X19pbnRfdHlwZSBfX2kpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fYXRvbWljX29yX2ZldGNo
KCZfTV9pLCBfX2ksIG1lbW9yeV9vcmRlcl9zZXFfY3N0KTsgfQoKICAgICAgX19pbnRfdHlwZQog
ICAgICBvcGVyYXRvcnw9KF9faW50X3R5cGUgX19pKSB2b2xhdGlsZSBub2V4Y2VwdAogICAgICB7
IHJldHVybiBfX2F0b21pY19vcl9mZXRjaCgmX01faSwgX19pLCBtZW1vcnlfb3JkZXJfc2VxX2Nz
dCk7IH0KCiAgICAgIF9faW50X3R5cGUKICAgICAgb3BlcmF0b3JePShfX2ludF90eXBlIF9faSkg
bm9leGNlcHQKICAgICAgeyByZXR1cm4gX19hdG9taWNfeG9yX2ZldGNoKCZfTV9pLCBfX2ksIG1l
bW9yeV9vcmRlcl9zZXFfY3N0KTsgfQoKICAgICAgX19pbnRfdHlwZQogICAgICBvcGVyYXRvcl49
KF9faW50X3R5cGUgX19pKSB2b2xhdGlsZSBub2V4Y2VwdAogICAgICB7IHJldHVybiBfX2F0b21p
Y194b3JfZmV0Y2goJl9NX2ksIF9faSwgbWVtb3J5X29yZGVyX3NlcV9jc3QpOyB9CgogICAgICBi
b29sCiAgICAgIGlzX2xvY2tfZnJlZSgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsKCiByZXR1cm4g
X19hdG9taWNfaXNfbG9ja19mcmVlKHNpemVvZihfTV9pKSwKICAgICByZWludGVycHJldF9jYXN0
PHZvaWQgKj4oLV9fYWxpZ25vZihfTV9pKSkpOwogICAgICB9CgogICAgICBib29sCiAgICAgIGlz
X2xvY2tfZnJlZSgpIGNvbnN0IHZvbGF0aWxlIG5vZXhjZXB0CiAgICAgIHsKCiByZXR1cm4gX19h
dG9taWNfaXNfbG9ja19mcmVlKHNpemVvZihfTV9pKSwKICAgICByZWludGVycHJldF9jYXN0PHZv
aWQgKj4oLV9fYWxpZ25vZihfTV9pKSkpOwogICAgICB9CgogICAgICBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkCiAgICAgIHN0b3JlKF9faW50X3R5cGUgX19p
LCBtZW1vcnlfb3JkZXIgX19tID0gbWVtb3J5X29yZGVyX3NlcV9jc3QpIG5vZXhjZXB0CiAgICAg
IHsKICAgICAgICBtZW1vcnlfb3JkZXIgX19iID0gX19tICYgX19tZW1vcnlfb3JkZXJfbWFzazsK
IDsKIDsKIDsKCiBfX2F0b21pY19zdG9yZV9uKCZfTV9pLCBfX2ksIF9fbSk7CiAgICAgIH0KCiAg
ICAgIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIHZvaWQKICAgICAg
c3RvcmUoX19pbnRfdHlwZSBfX2ksCiAgICAgbWVtb3J5X29yZGVyIF9fbSA9IG1lbW9yeV9vcmRl
cl9zZXFfY3N0KSB2b2xhdGlsZSBub2V4Y2VwdAogICAgICB7CiAgICAgICAgbWVtb3J5X29yZGVy
IF9fYiA9IF9fbSAmIF9fbWVtb3J5X29yZGVyX21hc2s7CiA7CiA7CiA7CgogX19hdG9taWNfc3Rv
cmVfbigmX01faSwgX19pLCBfX20pOwogICAgICB9CgogICAgICBpbmxpbmUgX19hdHRyaWJ1dGVf
XygoX19hbHdheXNfaW5saW5lX18pKSBfX2ludF90eXBlCiAgICAgIGxvYWQobWVtb3J5X29yZGVy
IF9fbSA9IG1lbW9yeV9vcmRlcl9zZXFfY3N0KSBjb25zdCBub2V4Y2VwdAogICAgICB7CiAgICAg
ICBtZW1vcnlfb3JkZXIgX19iID0gX19tICYgX19tZW1vcnlfb3JkZXJfbWFzazsKIDsKIDsKCiBy
ZXR1cm4gX19hdG9taWNfbG9hZF9uKCZfTV9pLCBfX20pOwogICAgICB9CgogICAgICBpbmxpbmUg
X19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX2ludF90eXBlCiAgICAgIGxvYWQo
bWVtb3J5X29yZGVyIF9fbSA9IG1lbW9yeV9vcmRlcl9zZXFfY3N0KSBjb25zdCB2b2xhdGlsZSBu
b2V4Y2VwdAogICAgICB7CiAgICAgICAgbWVtb3J5X29yZGVyIF9fYiA9IF9fbSAmIF9fbWVtb3J5
X29yZGVyX21hc2s7CiA7CiA7CgogcmV0dXJuIF9fYXRvbWljX2xvYWRfbigmX01faSwgX19tKTsK
ICAgICAgfQoKICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
X19pbnRfdHlwZQogICAgICBleGNoYW5nZShfX2ludF90eXBlIF9faSwKICAgICAgICBtZW1vcnlf
b3JkZXIgX19tID0gbWVtb3J5X29yZGVyX3NlcV9jc3QpIG5vZXhjZXB0CiAgICAgIHsKIHJldHVy
biBfX2F0b21pY19leGNoYW5nZV9uKCZfTV9pLCBfX2ksIF9fbSk7CiAgICAgIH0KCgogICAgICBp
bmxpbmUgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX2ludF90eXBlCiAgICAg
IGV4Y2hhbmdlKF9faW50X3R5cGUgX19pLAogICAgICAgIG1lbW9yeV9vcmRlciBfX20gPSBtZW1v
cnlfb3JkZXJfc2VxX2NzdCkgdm9sYXRpbGUgbm9leGNlcHQKICAgICAgewogcmV0dXJuIF9fYXRv
bWljX2V4Y2hhbmdlX24oJl9NX2ksIF9faSwgX19tKTsKICAgICAgfQoKICAgICAgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgYm9vbAogICAgICBjb21wYXJlX2V4Y2hh
bmdlX3dlYWsoX19pbnRfdHlwZSYgX19pMSwgX19pbnRfdHlwZSBfX2kyLAogICAgICAgbWVtb3J5
X29yZGVyIF9fbTEsIG1lbW9yeV9vcmRlciBfX20yKSBub2V4Y2VwdAogICAgICB7CiAgICAgICBt
ZW1vcnlfb3JkZXIgX19iMiA9IF9fbTIgJiBfX21lbW9yeV9vcmRlcl9tYXNrOwogICAgICAgbWVt
b3J5X29yZGVyIF9fYjEgPSBfX20xICYgX19tZW1vcnlfb3JkZXJfbWFzazsKIDsKIDsKIDsKCiBy
ZXR1cm4gX19hdG9taWNfY29tcGFyZV9leGNoYW5nZV9uKCZfTV9pLCAmX19pMSwgX19pMiwgMSwg
X19tMSwgX19tMik7CiAgICAgIH0KCiAgICAgIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpIGJvb2wKICAgICAgY29tcGFyZV9leGNoYW5nZV93ZWFrKF9faW50X3R5cGUm
IF9faTEsIF9faW50X3R5cGUgX19pMiwKICAgICAgIG1lbW9yeV9vcmRlciBfX20xLAogICAgICAg
bWVtb3J5X29yZGVyIF9fbTIpIHZvbGF0aWxlIG5vZXhjZXB0CiAgICAgIHsKICAgICAgIG1lbW9y
eV9vcmRlciBfX2IyID0gX19tMiAmIF9fbWVtb3J5X29yZGVyX21hc2s7CiAgICAgICBtZW1vcnlf
b3JkZXIgX19iMSA9IF9fbTEgJiBfX21lbW9yeV9vcmRlcl9tYXNrOwogOwogOwogOwoKIHJldHVy
biBfX2F0b21pY19jb21wYXJlX2V4Y2hhbmdlX24oJl9NX2ksICZfX2kxLCBfX2kyLCAxLCBfX20x
LCBfX20yKTsKICAgICAgfQoKICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lu
bGluZV9fKSkgYm9vbAogICAgICBjb21wYXJlX2V4Y2hhbmdlX3dlYWsoX19pbnRfdHlwZSYgX19p
MSwgX19pbnRfdHlwZSBfX2kyLAogICAgICAgbWVtb3J5X29yZGVyIF9fbSA9IG1lbW9yeV9vcmRl
cl9zZXFfY3N0KSBub2V4Y2VwdAogICAgICB7CiByZXR1cm4gY29tcGFyZV9leGNoYW5nZV93ZWFr
KF9faTEsIF9faTIsIF9fbSwKICAgICAgICAgX19jbXBleGNoX2ZhaWx1cmVfb3JkZXIoX19tKSk7
CiAgICAgIH0KCiAgICAgIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykp
IGJvb2wKICAgICAgY29tcGFyZV9leGNoYW5nZV93ZWFrKF9faW50X3R5cGUmIF9faTEsIF9faW50
X3R5cGUgX19pMiwKICAgICBtZW1vcnlfb3JkZXIgX19tID0gbWVtb3J5X29yZGVyX3NlcV9jc3Qp
IHZvbGF0aWxlIG5vZXhjZXB0CiAgICAgIHsKIHJldHVybiBjb21wYXJlX2V4Y2hhbmdlX3dlYWso
X19pMSwgX19pMiwgX19tLAogICAgICAgICBfX2NtcGV4Y2hfZmFpbHVyZV9vcmRlcihfX20pKTsK
ICAgICAgfQoKICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
Ym9vbAogICAgICBjb21wYXJlX2V4Y2hhbmdlX3N0cm9uZyhfX2ludF90eXBlJiBfX2kxLCBfX2lu
dF90eXBlIF9faTIsCiAgICAgICAgIG1lbW9yeV9vcmRlciBfX20xLCBtZW1vcnlfb3JkZXIgX19t
Mikgbm9leGNlcHQKICAgICAgewogICAgICAgIG1lbW9yeV9vcmRlciBfX2IyID0gX19tMiAmIF9f
bWVtb3J5X29yZGVyX21hc2s7CiAgICAgICAgbWVtb3J5X29yZGVyIF9fYjEgPSBfX20xICYgX19t
ZW1vcnlfb3JkZXJfbWFzazsKIDsKIDsKIDsKCiByZXR1cm4gX19hdG9taWNfY29tcGFyZV9leGNo
YW5nZV9uKCZfTV9pLCAmX19pMSwgX19pMiwgMCwgX19tMSwgX19tMik7CiAgICAgIH0KCiAgICAg
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIGJvb2wKICAgICAgY29t
cGFyZV9leGNoYW5nZV9zdHJvbmcoX19pbnRfdHlwZSYgX19pMSwgX19pbnRfdHlwZSBfX2kyLAog
ICAgICAgICBtZW1vcnlfb3JkZXIgX19tMSwKICAgICAgICAgbWVtb3J5X29yZGVyIF9fbTIpIHZv
bGF0aWxlIG5vZXhjZXB0CiAgICAgIHsKICAgICAgICBtZW1vcnlfb3JkZXIgX19iMiA9IF9fbTIg
JiBfX21lbW9yeV9vcmRlcl9tYXNrOwogICAgICAgIG1lbW9yeV9vcmRlciBfX2IxID0gX19tMSAm
IF9fbWVtb3J5X29yZGVyX21hc2s7CgogOwogOwogOwoKIHJldHVybiBfX2F0b21pY19jb21wYXJl
X2V4Y2hhbmdlX24oJl9NX2ksICZfX2kxLCBfX2kyLCAwLCBfX20xLCBfX20yKTsKICAgICAgfQoK
ICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgYm9vbAogICAg
ICBjb21wYXJlX2V4Y2hhbmdlX3N0cm9uZyhfX2ludF90eXBlJiBfX2kxLCBfX2ludF90eXBlIF9f
aTIsCiAgICAgICAgIG1lbW9yeV9vcmRlciBfX20gPSBtZW1vcnlfb3JkZXJfc2VxX2NzdCkgbm9l
eGNlcHQKICAgICAgewogcmV0dXJuIGNvbXBhcmVfZXhjaGFuZ2Vfc3Ryb25nKF9faTEsIF9faTIs
IF9fbSwKICAgICAgICAgICBfX2NtcGV4Y2hfZmFpbHVyZV9vcmRlcihfX20pKTsKICAgICAgfQoK
ICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgYm9vbAogICAg
ICBjb21wYXJlX2V4Y2hhbmdlX3N0cm9uZyhfX2ludF90eXBlJiBfX2kxLCBfX2ludF90eXBlIF9f
aTIsCiAgIG1lbW9yeV9vcmRlciBfX20gPSBtZW1vcnlfb3JkZXJfc2VxX2NzdCkgdm9sYXRpbGUg
bm9leGNlcHQKICAgICAgewogcmV0dXJuIGNvbXBhcmVfZXhjaGFuZ2Vfc3Ryb25nKF9faTEsIF9f
aTIsIF9fbSwKICAgICAgICAgICBfX2NtcGV4Y2hfZmFpbHVyZV9vcmRlcihfX20pKTsKICAgICAg
fQoKICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgX19pbnRf
dHlwZQogICAgICBmZXRjaF9hZGQoX19pbnRfdHlwZSBfX2ksCiAgbWVtb3J5X29yZGVyIF9fbSA9
IG1lbW9yeV9vcmRlcl9zZXFfY3N0KSBub2V4Y2VwdAogICAgICB7IHJldHVybiBfX2F0b21pY19m
ZXRjaF9hZGQoJl9NX2ksIF9faSwgX19tKTsgfQoKICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18o
KF9fYWx3YXlzX2lubGluZV9fKSkgX19pbnRfdHlwZQogICAgICBmZXRjaF9hZGQoX19pbnRfdHlw
ZSBfX2ksCiAgbWVtb3J5X29yZGVyIF9fbSA9IG1lbW9yeV9vcmRlcl9zZXFfY3N0KSB2b2xhdGls
ZSBub2V4Y2VwdAogICAgICB7IHJldHVybiBfX2F0b21pY19mZXRjaF9hZGQoJl9NX2ksIF9faSwg
X19tKTsgfQoKICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkg
X19pbnRfdHlwZQogICAgICBmZXRjaF9zdWIoX19pbnRfdHlwZSBfX2ksCiAgbWVtb3J5X29yZGVy
IF9fbSA9IG1lbW9yeV9vcmRlcl9zZXFfY3N0KSBub2V4Y2VwdAogICAgICB7IHJldHVybiBfX2F0
b21pY19mZXRjaF9zdWIoJl9NX2ksIF9faSwgX19tKTsgfQoKICAgICAgaW5saW5lIF9fYXR0cmli
dXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgX19pbnRfdHlwZQogICAgICBmZXRjaF9zdWIoX19p
bnRfdHlwZSBfX2ksCiAgbWVtb3J5X29yZGVyIF9fbSA9IG1lbW9yeV9vcmRlcl9zZXFfY3N0KSB2
b2xhdGlsZSBub2V4Y2VwdAogICAgICB7IHJldHVybiBfX2F0b21pY19mZXRjaF9zdWIoJl9NX2ks
IF9faSwgX19tKTsgfQoKICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGlu
ZV9fKSkgX19pbnRfdHlwZQogICAgICBmZXRjaF9hbmQoX19pbnRfdHlwZSBfX2ksCiAgbWVtb3J5
X29yZGVyIF9fbSA9IG1lbW9yeV9vcmRlcl9zZXFfY3N0KSBub2V4Y2VwdAogICAgICB7IHJldHVy
biBfX2F0b21pY19mZXRjaF9hbmQoJl9NX2ksIF9faSwgX19tKTsgfQoKICAgICAgaW5saW5lIF9f
YXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgX19pbnRfdHlwZQogICAgICBmZXRjaF9h
bmQoX19pbnRfdHlwZSBfX2ksCiAgbWVtb3J5X29yZGVyIF9fbSA9IG1lbW9yeV9vcmRlcl9zZXFf
Y3N0KSB2b2xhdGlsZSBub2V4Y2VwdAogICAgICB7IHJldHVybiBfX2F0b21pY19mZXRjaF9hbmQo
Jl9NX2ksIF9faSwgX19tKTsgfQoKICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlz
X2lubGluZV9fKSkgX19pbnRfdHlwZQogICAgICBmZXRjaF9vcihfX2ludF90eXBlIF9faSwKICAg
ICAgICBtZW1vcnlfb3JkZXIgX19tID0gbWVtb3J5X29yZGVyX3NlcV9jc3QpIG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuIF9fYXRvbWljX2ZldGNoX29yKCZfTV9pLCBfX2ksIF9fbSk7IH0KCiAgICAg
IGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIF9faW50X3R5cGUKICAg
ICAgZmV0Y2hfb3IoX19pbnRfdHlwZSBfX2ksCiAgICAgICAgbWVtb3J5X29yZGVyIF9fbSA9IG1l
bW9yeV9vcmRlcl9zZXFfY3N0KSB2b2xhdGlsZSBub2V4Y2VwdAogICAgICB7IHJldHVybiBfX2F0
b21pY19mZXRjaF9vcigmX01faSwgX19pLCBfX20pOyB9CgogICAgICBpbmxpbmUgX19hdHRyaWJ1
dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX2ludF90eXBlCiAgICAgIGZldGNoX3hvcihfX2lu
dF90eXBlIF9faSwKICBtZW1vcnlfb3JkZXIgX19tID0gbWVtb3J5X29yZGVyX3NlcV9jc3QpIG5v
ZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fYXRvbWljX2ZldGNoX3hvcigmX01faSwgX19pLCBfX20p
OyB9CgogICAgICBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX2lu
dF90eXBlCiAgICAgIGZldGNoX3hvcihfX2ludF90eXBlIF9faSwKICBtZW1vcnlfb3JkZXIgX19t
ID0gbWVtb3J5X29yZGVyX3NlcV9jc3QpIHZvbGF0aWxlIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJu
IF9fYXRvbWljX2ZldGNoX3hvcigmX01faSwgX19pLCBfX20pOyB9CiAgICB9OwoKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9QVHA+CiAgICBzdHJ1Y3QgX19hdG9taWNfYmFzZTxfUFRwKj4KICAgIHsK
ICAgIHByaXZhdGU6CiAgICAgIHR5cGVkZWYgX1BUcCogX19wb2ludGVyX3R5cGU7CgogICAgICBf
X3BvaW50ZXJfdHlwZSBfTV9wOwoKCiAgICAgIGNvbnN0ZXhwciBwdHJkaWZmX3QKICAgICAgX01f
dHlwZV9zaXplKHB0cmRpZmZfdCBfX2QpIGNvbnN0IHsgcmV0dXJuIF9fZCAqIHNpemVvZihfUFRw
KTsgfQoKICAgICAgY29uc3RleHByIHB0cmRpZmZfdAogICAgICBfTV90eXBlX3NpemUocHRyZGlm
Zl90IF9fZCkgY29uc3Qgdm9sYXRpbGUgeyByZXR1cm4gX19kICogc2l6ZW9mKF9QVHApOyB9Cgog
ICAgcHVibGljOgogICAgICBfX2F0b21pY19iYXNlKCkgbm9leGNlcHQgPSBkZWZhdWx0OwogICAg
ICB+X19hdG9taWNfYmFzZSgpIG5vZXhjZXB0ID0gZGVmYXVsdDsKICAgICAgX19hdG9taWNfYmFz
ZShjb25zdCBfX2F0b21pY19iYXNlJikgPSBkZWxldGU7CiAgICAgIF9fYXRvbWljX2Jhc2UmIG9w
ZXJhdG9yPShjb25zdCBfX2F0b21pY19iYXNlJikgPSBkZWxldGU7CiAgICAgIF9fYXRvbWljX2Jh
c2UmIG9wZXJhdG9yPShjb25zdCBfX2F0b21pY19iYXNlJikgdm9sYXRpbGUgPSBkZWxldGU7CgoK
ICAgICAgY29uc3RleHByIF9fYXRvbWljX2Jhc2UoX19wb2ludGVyX3R5cGUgX19wKSBub2V4Y2Vw
dCA6IF9NX3AgKF9fcCkgeyB9CgogICAgICBvcGVyYXRvciBfX3BvaW50ZXJfdHlwZSgpIGNvbnN0
IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGxvYWQoKTsgfQoKICAgICAgb3BlcmF0b3IgX19wb2lu
dGVyX3R5cGUoKSBjb25zdCB2b2xhdGlsZSBub2V4Y2VwdAogICAgICB7IHJldHVybiBsb2FkKCk7
IH0KCiAgICAgIF9fcG9pbnRlcl90eXBlCiAgICAgIG9wZXJhdG9yPShfX3BvaW50ZXJfdHlwZSBf
X3ApIG5vZXhjZXB0CiAgICAgIHsKIHN0b3JlKF9fcCk7CiByZXR1cm4gX19wOwogICAgICB9Cgog
ICAgICBfX3BvaW50ZXJfdHlwZQogICAgICBvcGVyYXRvcj0oX19wb2ludGVyX3R5cGUgX19wKSB2
b2xhdGlsZSBub2V4Y2VwdAogICAgICB7CiBzdG9yZShfX3ApOwogcmV0dXJuIF9fcDsKICAgICAg
fQoKICAgICAgX19wb2ludGVyX3R5cGUKICAgICAgb3BlcmF0b3IrKyhpbnQpIG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuIGZldGNoX2FkZCgxKTsgfQoKICAgICAgX19wb2ludGVyX3R5cGUKICAgICAg
b3BlcmF0b3IrKyhpbnQpIHZvbGF0aWxlIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGZldGNoX2Fk
ZCgxKTsgfQoKICAgICAgX19wb2ludGVyX3R5cGUKICAgICAgb3BlcmF0b3ItLShpbnQpIG5vZXhj
ZXB0CiAgICAgIHsgcmV0dXJuIGZldGNoX3N1YigxKTsgfQoKICAgICAgX19wb2ludGVyX3R5cGUK
ICAgICAgb3BlcmF0b3ItLShpbnQpIHZvbGF0aWxlIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGZl
dGNoX3N1YigxKTsgfQoKICAgICAgX19wb2ludGVyX3R5cGUKICAgICAgb3BlcmF0b3IrKygpIG5v
ZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fYXRvbWljX2FkZF9mZXRjaCgmX01fcCwgX01fdHlwZV9z
aXplKDEpLAogICAgICBtZW1vcnlfb3JkZXJfc2VxX2NzdCk7IH0KCiAgICAgIF9fcG9pbnRlcl90
eXBlCiAgICAgIG9wZXJhdG9yKysoKSB2b2xhdGlsZSBub2V4Y2VwdAogICAgICB7IHJldHVybiBf
X2F0b21pY19hZGRfZmV0Y2goJl9NX3AsIF9NX3R5cGVfc2l6ZSgxKSwKICAgICAgbWVtb3J5X29y
ZGVyX3NlcV9jc3QpOyB9CgogICAgICBfX3BvaW50ZXJfdHlwZQogICAgICBvcGVyYXRvci0tKCkg
bm9leGNlcHQKICAgICAgeyByZXR1cm4gX19hdG9taWNfc3ViX2ZldGNoKCZfTV9wLCBfTV90eXBl
X3NpemUoMSksCiAgICAgIG1lbW9yeV9vcmRlcl9zZXFfY3N0KTsgfQoKICAgICAgX19wb2ludGVy
X3R5cGUKICAgICAgb3BlcmF0b3ItLSgpIHZvbGF0aWxlIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJu
IF9fYXRvbWljX3N1Yl9mZXRjaCgmX01fcCwgX01fdHlwZV9zaXplKDEpLAogICAgICBtZW1vcnlf
b3JkZXJfc2VxX2NzdCk7IH0KCiAgICAgIF9fcG9pbnRlcl90eXBlCiAgICAgIG9wZXJhdG9yKz0o
cHRyZGlmZl90IF9fZCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX19hdG9taWNfYWRkX2ZldGNo
KCZfTV9wLCBfTV90eXBlX3NpemUoX19kKSwKICAgICAgbWVtb3J5X29yZGVyX3NlcV9jc3QpOyB9
CgogICAgICBfX3BvaW50ZXJfdHlwZQogICAgICBvcGVyYXRvcis9KHB0cmRpZmZfdCBfX2QpIHZv
bGF0aWxlIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fYXRvbWljX2FkZF9mZXRjaCgmX01fcCwg
X01fdHlwZV9zaXplKF9fZCksCiAgICAgIG1lbW9yeV9vcmRlcl9zZXFfY3N0KTsgfQoKICAgICAg
X19wb2ludGVyX3R5cGUKICAgICAgb3BlcmF0b3ItPShwdHJkaWZmX3QgX19kKSBub2V4Y2VwdAog
ICAgICB7IHJldHVybiBfX2F0b21pY19zdWJfZmV0Y2goJl9NX3AsIF9NX3R5cGVfc2l6ZShfX2Qp
LAogICAgICBtZW1vcnlfb3JkZXJfc2VxX2NzdCk7IH0KCiAgICAgIF9fcG9pbnRlcl90eXBlCiAg
ICAgIG9wZXJhdG9yLT0ocHRyZGlmZl90IF9fZCkgdm9sYXRpbGUgbm9leGNlcHQKICAgICAgeyBy
ZXR1cm4gX19hdG9taWNfc3ViX2ZldGNoKCZfTV9wLCBfTV90eXBlX3NpemUoX19kKSwKICAgICAg
bWVtb3J5X29yZGVyX3NlcV9jc3QpOyB9CgogICAgICBib29sCiAgICAgIGlzX2xvY2tfZnJlZSgp
IGNvbnN0IG5vZXhjZXB0CiAgICAgIHsKCiByZXR1cm4gX19hdG9taWNfaXNfbG9ja19mcmVlKHNp
emVvZihfTV9wKSwKICAgICByZWludGVycHJldF9jYXN0PHZvaWQgKj4oLV9fYWxpZ25vZihfTV9w
KSkpOwogICAgICB9CgogICAgICBib29sCiAgICAgIGlzX2xvY2tfZnJlZSgpIGNvbnN0IHZvbGF0
aWxlIG5vZXhjZXB0CiAgICAgIHsKCiByZXR1cm4gX19hdG9taWNfaXNfbG9ja19mcmVlKHNpemVv
ZihfTV9wKSwKICAgICByZWludGVycHJldF9jYXN0PHZvaWQgKj4oLV9fYWxpZ25vZihfTV9wKSkp
OwogICAgICB9CgogICAgICBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18p
KSB2b2lkCiAgICAgIHN0b3JlKF9fcG9pbnRlcl90eXBlIF9fcCwKICAgICBtZW1vcnlfb3JkZXIg
X19tID0gbWVtb3J5X29yZGVyX3NlcV9jc3QpIG5vZXhjZXB0CiAgICAgIHsKICAgICAgICBtZW1v
cnlfb3JkZXIgX19iID0gX19tICYgX19tZW1vcnlfb3JkZXJfbWFzazsKCiA7CiA7CiA7CgogX19h
dG9taWNfc3RvcmVfbigmX01fcCwgX19wLCBfX20pOwogICAgICB9CgogICAgICBpbmxpbmUgX19h
dHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSB2b2lkCiAgICAgIHN0b3JlKF9fcG9pbnRl
cl90eXBlIF9fcCwKICAgICBtZW1vcnlfb3JkZXIgX19tID0gbWVtb3J5X29yZGVyX3NlcV9jc3Qp
IHZvbGF0aWxlIG5vZXhjZXB0CiAgICAgIHsKICAgICAgICBtZW1vcnlfb3JkZXIgX19iID0gX19t
ICYgX19tZW1vcnlfb3JkZXJfbWFzazsKIDsKIDsKIDsKCiBfX2F0b21pY19zdG9yZV9uKCZfTV9w
LCBfX3AsIF9fbSk7CiAgICAgIH0KCiAgICAgIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5
c19pbmxpbmVfXykpIF9fcG9pbnRlcl90eXBlCiAgICAgIGxvYWQobWVtb3J5X29yZGVyIF9fbSA9
IG1lbW9yeV9vcmRlcl9zZXFfY3N0KSBjb25zdCBub2V4Y2VwdAogICAgICB7CiAgICAgICAgbWVt
b3J5X29yZGVyIF9fYiA9IF9fbSAmIF9fbWVtb3J5X29yZGVyX21hc2s7CiA7CiA7CgogcmV0dXJu
IF9fYXRvbWljX2xvYWRfbigmX01fcCwgX19tKTsKICAgICAgfQoKICAgICAgaW5saW5lIF9fYXR0
cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgX19wb2ludGVyX3R5cGUKICAgICAgbG9hZCht
ZW1vcnlfb3JkZXIgX19tID0gbWVtb3J5X29yZGVyX3NlcV9jc3QpIGNvbnN0IHZvbGF0aWxlIG5v
ZXhjZXB0CiAgICAgIHsKICAgICAgICBtZW1vcnlfb3JkZXIgX19iID0gX19tICYgX19tZW1vcnlf
b3JkZXJfbWFzazsKIDsKIDsKCiByZXR1cm4gX19hdG9taWNfbG9hZF9uKCZfTV9wLCBfX20pOwog
ICAgICB9CgogICAgICBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBf
X3BvaW50ZXJfdHlwZQogICAgICBleGNoYW5nZShfX3BvaW50ZXJfdHlwZSBfX3AsCiAgICAgICAg
bWVtb3J5X29yZGVyIF9fbSA9IG1lbW9yeV9vcmRlcl9zZXFfY3N0KSBub2V4Y2VwdAogICAgICB7
CiByZXR1cm4gX19hdG9taWNfZXhjaGFuZ2VfbigmX01fcCwgX19wLCBfX20pOwogICAgICB9CgoK
ICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgX19wb2ludGVy
X3R5cGUKICAgICAgZXhjaGFuZ2UoX19wb2ludGVyX3R5cGUgX19wLAogICAgICAgIG1lbW9yeV9v
cmRlciBfX20gPSBtZW1vcnlfb3JkZXJfc2VxX2NzdCkgdm9sYXRpbGUgbm9leGNlcHQKICAgICAg
ewogcmV0dXJuIF9fYXRvbWljX2V4Y2hhbmdlX24oJl9NX3AsIF9fcCwgX19tKTsKICAgICAgfQoK
ICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgYm9vbAogICAg
ICBjb21wYXJlX2V4Y2hhbmdlX3N0cm9uZyhfX3BvaW50ZXJfdHlwZSYgX19wMSwgX19wb2ludGVy
X3R5cGUgX19wMiwKICAgICAgICAgbWVtb3J5X29yZGVyIF9fbTEsCiAgICAgICAgIG1lbW9yeV9v
cmRlciBfX20yKSBub2V4Y2VwdAogICAgICB7CiAgICAgICAgbWVtb3J5X29yZGVyIF9fYjIgPSBf
X20yICYgX19tZW1vcnlfb3JkZXJfbWFzazsKICAgICAgICBtZW1vcnlfb3JkZXIgX19iMSA9IF9f
bTEgJiBfX21lbW9yeV9vcmRlcl9tYXNrOwogOwogOwogOwoKIHJldHVybiBfX2F0b21pY19jb21w
YXJlX2V4Y2hhbmdlX24oJl9NX3AsICZfX3AxLCBfX3AyLCAwLCBfX20xLCBfX20yKTsKICAgICAg
fQoKICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgYm9vbAog
ICAgICBjb21wYXJlX2V4Y2hhbmdlX3N0cm9uZyhfX3BvaW50ZXJfdHlwZSYgX19wMSwgX19wb2lu
dGVyX3R5cGUgX19wMiwKICAgICAgICAgbWVtb3J5X29yZGVyIF9fbTEsCiAgICAgICAgIG1lbW9y
eV9vcmRlciBfX20yKSB2b2xhdGlsZSBub2V4Y2VwdAogICAgICB7CiAgICAgICAgbWVtb3J5X29y
ZGVyIF9fYjIgPSBfX20yICYgX19tZW1vcnlfb3JkZXJfbWFzazsKICAgICAgICBtZW1vcnlfb3Jk
ZXIgX19iMSA9IF9fbTEgJiBfX21lbW9yeV9vcmRlcl9tYXNrOwoKIDsKIDsKIDsKCiByZXR1cm4g
X19hdG9taWNfY29tcGFyZV9leGNoYW5nZV9uKCZfTV9wLCAmX19wMSwgX19wMiwgMCwgX19tMSwg
X19tMik7CiAgICAgIH0KCiAgICAgIGlubGluZSBfX2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxp
bmVfXykpIF9fcG9pbnRlcl90eXBlCiAgICAgIGZldGNoX2FkZChwdHJkaWZmX3QgX19kLAogIG1l
bW9yeV9vcmRlciBfX20gPSBtZW1vcnlfb3JkZXJfc2VxX2NzdCkgbm9leGNlcHQKICAgICAgeyBy
ZXR1cm4gX19hdG9taWNfZmV0Y2hfYWRkKCZfTV9wLCBfTV90eXBlX3NpemUoX19kKSwgX19tKTsg
fQoKICAgICAgaW5saW5lIF9fYXR0cmlidXRlX18oKF9fYWx3YXlzX2lubGluZV9fKSkgX19wb2lu
dGVyX3R5cGUKICAgICAgZmV0Y2hfYWRkKHB0cmRpZmZfdCBfX2QsCiAgbWVtb3J5X29yZGVyIF9f
bSA9IG1lbW9yeV9vcmRlcl9zZXFfY3N0KSB2b2xhdGlsZSBub2V4Y2VwdAogICAgICB7IHJldHVy
biBfX2F0b21pY19mZXRjaF9hZGQoJl9NX3AsIF9NX3R5cGVfc2l6ZShfX2QpLCBfX20pOyB9Cgog
ICAgICBpbmxpbmUgX19hdHRyaWJ1dGVfXygoX19hbHdheXNfaW5saW5lX18pKSBfX3BvaW50ZXJf
dHlwZQogICAgICBmZXRjaF9zdWIocHRyZGlmZl90IF9fZCwKICBtZW1vcnlfb3JkZXIgX19tID0g
bWVtb3J5X29yZGVyX3NlcV9jc3QpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9fYXRvbWljX2Zl
dGNoX3N1YigmX01fcCwgX01fdHlwZV9zaXplKF9fZCksIF9fbSk7IH0KCiAgICAgIGlubGluZSBf
X2F0dHJpYnV0ZV9fKChfX2Fsd2F5c19pbmxpbmVfXykpIF9fcG9pbnRlcl90eXBlCiAgICAgIGZl
dGNoX3N1YihwdHJkaWZmX3QgX19kLAogIG1lbW9yeV9vcmRlciBfX20gPSBtZW1vcnlfb3JkZXJf
c2VxX2NzdCkgdm9sYXRpbGUgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX19hdG9taWNfZmV0Y2hf
c3ViKCZfTV9wLCBfTV90eXBlX3NpemUoX19kKSwgX19tKTsgfQogICAgfTsKCgoKCn0KIyAzNCAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3NoYXJlZF9wdHJfYXRvbWljLmgiIDIgMwoKbmFt
ZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7
CgoKCgoKCgogIHN0cnVjdCBfU3BfbG9ja2VyCiAgewogICAgX1NwX2xvY2tlcihjb25zdCBfU3Bf
bG9ja2VyJikgPSBkZWxldGU7CiAgICBfU3BfbG9ja2VyJiBvcGVyYXRvcj0oY29uc3QgX1NwX2xv
Y2tlciYpID0gZGVsZXRlOwoKCiAgICBleHBsaWNpdAogICAgX1NwX2xvY2tlcihjb25zdCB2b2lk
Kikgbm9leGNlcHQ7CiAgICBfU3BfbG9ja2VyKGNvbnN0IHZvaWQqLCBjb25zdCB2b2lkKikgbm9l
eGNlcHQ7CiAgICB+X1NwX2xvY2tlcigpOwoKICBwcml2YXRlOgogICAgdW5zaWduZWQgY2hhciBf
TV9rZXkxOwogICAgdW5zaWduZWQgY2hhciBfTV9rZXkyOwoKCgogIH07CgoKCgoKCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9McD4KICAgIGlubGluZSBib29sCiAgICBh
dG9taWNfaXNfbG9ja19mcmVlKGNvbnN0IF9fc2hhcmVkX3B0cjxfVHAsIF9McD4qIF9fcCkKICAg
IHsKCiAgICAgIHJldHVybiBfX2d0aHJlYWRfYWN0aXZlX3AoKSA9PSAwOwoKCgogICAgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgYm9vbAogICAgYXRvbWljX2lzX2xvY2tf
ZnJlZShjb25zdCBzaGFyZWRfcHRyPF9UcD4qIF9fcCkKICAgIHsgcmV0dXJuIHN0ZDo6YXRvbWlj
X2lzX2xvY2tfZnJlZTxfVHAsIF9fZGVmYXVsdF9sb2NrX3BvbGljeT4oX19wKTsgfQojIDk2ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc2hhcmVkX3B0cl9hdG9taWMuaCIgMwogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcD4KICAgIGlubGluZSBzaGFyZWRfcHRyPF9UcD4KICAgIGF0b21pY19s
b2FkX2V4cGxpY2l0KGNvbnN0IHNoYXJlZF9wdHI8X1RwPiogX19wLCBtZW1vcnlfb3JkZXIpCiAg
ICB7CiAgICAgIF9TcF9sb2NrZXIgX19sb2Nre19fcH07CiAgICAgIHJldHVybiAqX19wOwogICAg
fQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgc2hhcmVkX3B0cjxfVHA+CiAg
ICBhdG9taWNfbG9hZChjb25zdCBzaGFyZWRfcHRyPF9UcD4qIF9fcCkKICAgIHsgcmV0dXJuIHN0
ZDo6YXRvbWljX2xvYWRfZXhwbGljaXQoX19wLCBtZW1vcnlfb3JkZXJfc2VxX2NzdCk7IH0KCiAg
dGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBfTG9ja19wb2xpY3kgX0xwPgogICAgaW5saW5lIF9fc2hh
cmVkX3B0cjxfVHAsIF9McD4KICAgIGF0b21pY19sb2FkX2V4cGxpY2l0KGNvbnN0IF9fc2hhcmVk
X3B0cjxfVHAsIF9McD4qIF9fcCwgbWVtb3J5X29yZGVyKQogICAgewogICAgICBfU3BfbG9ja2Vy
IF9fbG9ja3tfX3B9OwogICAgICByZXR1cm4gKl9fcDsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwLCBfTG9ja19wb2xpY3kgX0xwPgogICAgaW5saW5lIF9fc2hhcmVkX3B0cjxfVHAsIF9M
cD4KICAgIGF0b21pY19sb2FkKGNvbnN0IF9fc2hhcmVkX3B0cjxfVHAsIF9McD4qIF9fcCkKICAg
IHsgcmV0dXJuIHN0ZDo6YXRvbWljX2xvYWRfZXhwbGljaXQoX19wLCBtZW1vcnlfb3JkZXJfc2Vx
X2NzdCk7IH0KIyAxMzIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zaGFyZWRfcHRyX2F0
b21pYy5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgaW5saW5lIHZvaWQKICAgIGF0
b21pY19zdG9yZV9leHBsaWNpdChzaGFyZWRfcHRyPF9UcD4qIF9fcCwgc2hhcmVkX3B0cjxfVHA+
IF9fciwKICAgICBtZW1vcnlfb3JkZXIpCiAgICB7CiAgICAgIF9TcF9sb2NrZXIgX19sb2Nre19f
cH07CiAgICAgIF9fcC0+c3dhcChfX3IpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+
CiAgICBpbmxpbmUgdm9pZAogICAgYXRvbWljX3N0b3JlKHNoYXJlZF9wdHI8X1RwPiogX19wLCBz
aGFyZWRfcHRyPF9UcD4gX19yKQogICAgeyBzdGQ6OmF0b21pY19zdG9yZV9leHBsaWNpdChfX3As
IHN0ZDo6bW92ZShfX3IpLCBtZW1vcnlfb3JkZXJfc2VxX2NzdCk7IH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwLCBfTG9ja19wb2xpY3kgX0xwPgogICAgaW5saW5lIHZvaWQKICAgIGF0b21pY19z
dG9yZV9leHBsaWNpdChfX3NoYXJlZF9wdHI8X1RwLCBfTHA+KiBfX3AsCiAgICAgX19zaGFyZWRf
cHRyPF9UcCwgX0xwPiBfX3IsCiAgICAgbWVtb3J5X29yZGVyKQogICAgewogICAgICBfU3BfbG9j
a2VyIF9fbG9ja3tfX3B9OwogICAgICBfX3AtPnN3YXAoX19yKTsKICAgIH0KCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX1RwLCBfTG9ja19wb2xpY3kgX0xwPgogICAgaW5saW5lIHZvaWQKICAgIGF0b21p
Y19zdG9yZShfX3NoYXJlZF9wdHI8X1RwLCBfTHA+KiBfX3AsIF9fc2hhcmVkX3B0cjxfVHAsIF9M
cD4gX19yKQogICAgeyBzdGQ6OmF0b21pY19zdG9yZV9leHBsaWNpdChfX3AsIHN0ZDo6bW92ZShf
X3IpLCBtZW1vcnlfb3JkZXJfc2VxX2NzdCk7IH0KIyAxNjkgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9zaGFyZWRfcHRyX2F0b21pYy5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgog
ICAgaW5saW5lIHNoYXJlZF9wdHI8X1RwPgogICAgYXRvbWljX2V4Y2hhbmdlX2V4cGxpY2l0KHNo
YXJlZF9wdHI8X1RwPiogX19wLCBzaGFyZWRfcHRyPF9UcD4gX19yLAogICAgICAgIG1lbW9yeV9v
cmRlcikKICAgIHsKICAgICAgX1NwX2xvY2tlciBfX2xvY2t7X19wfTsKICAgICAgX19wLT5zd2Fw
KF9fcik7CiAgICAgIHJldHVybiBfX3I7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4K
ICAgIGlubGluZSBzaGFyZWRfcHRyPF9UcD4KICAgIGF0b21pY19leGNoYW5nZShzaGFyZWRfcHRy
PF9UcD4qIF9fcCwgc2hhcmVkX3B0cjxfVHA+IF9fcikKICAgIHsKICAgICAgcmV0dXJuIHN0ZDo6
YXRvbWljX2V4Y2hhbmdlX2V4cGxpY2l0KF9fcCwgc3RkOjptb3ZlKF9fciksCiAgICAgICAgbWVt
b3J5X29yZGVyX3NlcV9jc3QpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIF9Mb2Nr
X3BvbGljeSBfTHA+CiAgICBpbmxpbmUgX19zaGFyZWRfcHRyPF9UcCwgX0xwPgogICAgYXRvbWlj
X2V4Y2hhbmdlX2V4cGxpY2l0KF9fc2hhcmVkX3B0cjxfVHAsIF9McD4qIF9fcCwKICAgICAgICBf
X3NoYXJlZF9wdHI8X1RwLCBfTHA+IF9fciwKICAgICAgICBtZW1vcnlfb3JkZXIpCiAgICB7CiAg
ICAgIF9TcF9sb2NrZXIgX19sb2Nre19fcH07CiAgICAgIF9fcC0+c3dhcChfX3IpOwogICAgICBy
ZXR1cm4gX19yOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIF9Mb2NrX3BvbGljeSBf
THA+CiAgICBpbmxpbmUgX19zaGFyZWRfcHRyPF9UcCwgX0xwPgogICAgYXRvbWljX2V4Y2hhbmdl
KF9fc2hhcmVkX3B0cjxfVHAsIF9McD4qIF9fcCwgX19zaGFyZWRfcHRyPF9UcCwgX0xwPiBfX3Ip
CiAgICB7CiAgICAgIHJldHVybiBzdGQ6OmF0b21pY19leGNoYW5nZV9leHBsaWNpdChfX3AsIHN0
ZDo6bW92ZShfX3IpLAogICAgICAgIG1lbW9yeV9vcmRlcl9zZXFfY3N0KTsKICAgIH0KIyAyMTgg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zaGFyZWRfcHRyX2F0b21pYy5oIiAzCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwPgogICAgYm9vbAogICAgYXRvbWljX2NvbXBhcmVfZXhjaGFuZ2Vf
c3Ryb25nX2V4cGxpY2l0KHNoYXJlZF9wdHI8X1RwPiogX19wLAogICAgICAgICBzaGFyZWRfcHRy
PF9UcD4qIF9fdiwKICAgICAgICAgc2hhcmVkX3B0cjxfVHA+IF9fdywKICAgICAgICAgbWVtb3J5
X29yZGVyLAogICAgICAgICBtZW1vcnlfb3JkZXIpCiAgICB7CiAgICAgIHNoYXJlZF9wdHI8X1Rw
PiBfX3g7CiAgICAgIF9TcF9sb2NrZXIgX19sb2Nre19fcCwgX192fTsKICAgICAgb3duZXJfbGVz
czxzaGFyZWRfcHRyPF9UcD4+IF9fbGVzczsKICAgICAgaWYgKCpfX3AgPT0gKl9fdiAmJiAhX19s
ZXNzKCpfX3AsICpfX3YpICYmICFfX2xlc3MoKl9fdiwgKl9fcCkpCiB7CiAgIF9feCA9IHN0ZDo6
bW92ZSgqX19wKTsKICAgKl9fcCA9IHN0ZDo6bW92ZShfX3cpOwogICByZXR1cm4gdHJ1ZTsKIH0K
ICAgICAgX194ID0gc3RkOjptb3ZlKCpfX3YpOwogICAgICAqX192ID0gKl9fcDsKICAgICAgcmV0
dXJuIGZhbHNlOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgYm9v
bAogICAgYXRvbWljX2NvbXBhcmVfZXhjaGFuZ2Vfc3Ryb25nKHNoYXJlZF9wdHI8X1RwPiogX19w
LCBzaGFyZWRfcHRyPF9UcD4qIF9fdiwKICAgICBzaGFyZWRfcHRyPF9UcD4gX193KQogICAgewog
ICAgICByZXR1cm4gc3RkOjphdG9taWNfY29tcGFyZV9leGNoYW5nZV9zdHJvbmdfZXhwbGljaXQo
X19wLCBfX3YsCiAgIHN0ZDo6bW92ZShfX3cpLCBtZW1vcnlfb3JkZXJfc2VxX2NzdCwgbWVtb3J5
X29yZGVyX3NlcV9jc3QpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBpbmxp
bmUgYm9vbAogICAgYXRvbWljX2NvbXBhcmVfZXhjaGFuZ2Vfd2Vha19leHBsaWNpdChzaGFyZWRf
cHRyPF9UcD4qIF9fcCwKICAgICAgIHNoYXJlZF9wdHI8X1RwPiogX192LAogICAgICAgc2hhcmVk
X3B0cjxfVHA+IF9fdywKICAgICAgIG1lbW9yeV9vcmRlciBfX3N1Y2Nlc3MsCiAgICAgICBtZW1v
cnlfb3JkZXIgX19mYWlsdXJlKQogICAgewogICAgICByZXR1cm4gc3RkOjphdG9taWNfY29tcGFy
ZV9leGNoYW5nZV9zdHJvbmdfZXhwbGljaXQoX19wLCBfX3YsCiAgIHN0ZDo6bW92ZShfX3cpLCBf
X3N1Y2Nlc3MsIF9fZmFpbHVyZSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
IGlubGluZSBib29sCiAgICBhdG9taWNfY29tcGFyZV9leGNoYW5nZV93ZWFrKHNoYXJlZF9wdHI8
X1RwPiogX19wLCBzaGFyZWRfcHRyPF9UcD4qIF9fdiwKICAgICBzaGFyZWRfcHRyPF9UcD4gX193
KQogICAgewogICAgICByZXR1cm4gc3RkOjphdG9taWNfY29tcGFyZV9leGNoYW5nZV93ZWFrX2V4
cGxpY2l0KF9fcCwgX192LAogICBzdGQ6Om1vdmUoX193KSwgbWVtb3J5X29yZGVyX3NlcV9jc3Qs
IG1lbW9yeV9vcmRlcl9zZXFfY3N0KTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCBf
TG9ja19wb2xpY3kgX0xwPgogICAgYm9vbAogICAgYXRvbWljX2NvbXBhcmVfZXhjaGFuZ2Vfc3Ry
b25nX2V4cGxpY2l0KF9fc2hhcmVkX3B0cjxfVHAsIF9McD4qIF9fcCwKICAgICAgICAgX19zaGFy
ZWRfcHRyPF9UcCwgX0xwPiogX192LAogICAgICAgICBfX3NoYXJlZF9wdHI8X1RwLCBfTHA+IF9f
dywKICAgICAgICAgbWVtb3J5X29yZGVyLAogICAgICAgICBtZW1vcnlfb3JkZXIpCiAgICB7CiAg
ICAgIF9fc2hhcmVkX3B0cjxfVHAsIF9McD4gX194OwogICAgICBfU3BfbG9ja2VyIF9fbG9ja3tf
X3AsIF9fdn07CiAgICAgIG93bmVyX2xlc3M8X19zaGFyZWRfcHRyPF9UcCwgX0xwPj4gX19sZXNz
OwogICAgICBpZiAoKl9fcCA9PSAqX192ICYmICFfX2xlc3MoKl9fcCwgKl9fdikgJiYgIV9fbGVz
cygqX192LCAqX19wKSkKIHsKICAgX194ID0gc3RkOjptb3ZlKCpfX3ApOwogICAqX19wID0gc3Rk
Ojptb3ZlKF9fdyk7CiAgIHJldHVybiB0cnVlOwogfQogICAgICBfX3ggPSBzdGQ6Om1vdmUoKl9f
dik7CiAgICAgICpfX3YgPSAqX19wOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9McD4KICAgIGlubGluZSBib29sCiAgICBh
dG9taWNfY29tcGFyZV9leGNoYW5nZV9zdHJvbmcoX19zaGFyZWRfcHRyPF9UcCwgX0xwPiogX19w
LAogICAgICAgX19zaGFyZWRfcHRyPF9UcCwgX0xwPiogX192LAogICAgICAgX19zaGFyZWRfcHRy
PF9UcCwgX0xwPiBfX3cpCiAgICB7CiAgICAgIHJldHVybiBzdGQ6OmF0b21pY19jb21wYXJlX2V4
Y2hhbmdlX3N0cm9uZ19leHBsaWNpdChfX3AsIF9fdiwKICAgc3RkOjptb3ZlKF9fdyksIG1lbW9y
eV9vcmRlcl9zZXFfY3N0LCBtZW1vcnlfb3JkZXJfc2VxX2NzdCk7CiAgICB9CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9UcCwgX0xvY2tfcG9saWN5IF9McD4KICAgIGlubGluZSBib29sCiAgICBhdG9t
aWNfY29tcGFyZV9leGNoYW5nZV93ZWFrX2V4cGxpY2l0KF9fc2hhcmVkX3B0cjxfVHAsIF9McD4q
IF9fcCwKICAgICAgIF9fc2hhcmVkX3B0cjxfVHAsIF9McD4qIF9fdiwKICAgICAgIF9fc2hhcmVk
X3B0cjxfVHAsIF9McD4gX193LAogICAgICAgbWVtb3J5X29yZGVyIF9fc3VjY2VzcywKICAgICAg
IG1lbW9yeV9vcmRlciBfX2ZhaWx1cmUpCiAgICB7CiAgICAgIHJldHVybiBzdGQ6OmF0b21pY19j
b21wYXJlX2V4Y2hhbmdlX3N0cm9uZ19leHBsaWNpdChfX3AsIF9fdiwKICAgc3RkOjptb3ZlKF9f
dyksIF9fc3VjY2VzcywgX19mYWlsdXJlKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Rw
LCBfTG9ja19wb2xpY3kgX0xwPgogICAgaW5saW5lIGJvb2wKICAgIGF0b21pY19jb21wYXJlX2V4
Y2hhbmdlX3dlYWsoX19zaGFyZWRfcHRyPF9UcCwgX0xwPiogX19wLAogICAgIF9fc2hhcmVkX3B0
cjxfVHAsIF9McD4qIF9fdiwKICAgICBfX3NoYXJlZF9wdHI8X1RwLCBfTHA+IF9fdykKICAgIHsK
ICAgICAgcmV0dXJuIHN0ZDo6YXRvbWljX2NvbXBhcmVfZXhjaGFuZ2Vfd2Vha19leHBsaWNpdChf
X3AsIF9fdiwKICAgc3RkOjptb3ZlKF9fdyksIG1lbW9yeV9vcmRlcl9zZXFfY3N0LCBtZW1vcnlf
b3JkZXJfc2VxX2NzdCk7CiAgICB9CgoKCgoKfQojIDg0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L21lbW9yeSIgMiAzCgojIDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYmFja3dhcmQvYXV0b19w
dHIuaCIgMSAzCiMgMzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYmFja3dhcmQvYXV0b19wdHIu
aCIgMwpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1
bHQiKSkpCnsKCiMgNDcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYmFja3dhcmQvYXV0b19wdHIu
aCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcDE+CiAgICBzdHJ1Y3QgYXV0b19wdHJfcmVmCiAg
ICB7CiAgICAgIF9UcDEqIF9NX3B0cjsKCiAgICAgIGV4cGxpY2l0CiAgICAgIGF1dG9fcHRyX3Jl
ZihfVHAxKiBfX3ApOiBfTV9wdHIoX19wKSB7IH0KICAgIH0gX19hdHRyaWJ1dGVfXyAoKF9fZGVw
cmVjYXRlZF9fKSk7CiMgODYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYmFja3dhcmQvYXV0b19w
dHIuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIGNsYXNzIGF1dG9fcHRyCiAgICB7
CiAgICBwcml2YXRlOgogICAgICBfVHAqIF9NX3B0cjsKCiAgICBwdWJsaWM6CgogICAgICB0eXBl
ZGVmIF9UcCBlbGVtZW50X3R5cGU7CgoKCgoKCgogICAgICBleHBsaWNpdAogICAgICBhdXRvX3B0
cihlbGVtZW50X3R5cGUqIF9fcCA9IDApIHRocm93KCkgOiBfTV9wdHIoX19wKSB7IH0KIyAxMTIg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYmFja3dhcmQvYXV0b19wdHIuaCIgMwogICAgICBhdXRv
X3B0cihhdXRvX3B0ciYgX19hKSB0aHJvdygpIDogX01fcHRyKF9fYS5yZWxlYXNlKCkpIHsgfQoj
IDEyNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iYWNrd2FyZC9hdXRvX3B0ci5oIiAzCiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcDE+CiAgICAgICAgYXV0b19wdHIoYXV0b19wdHI8X1RwMT4m
IF9fYSkgdGhyb3coKSA6IF9NX3B0cihfX2EucmVsZWFzZSgpKSB7IH0KIyAxMzUgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYmFja3dhcmQvYXV0b19wdHIuaCIgMwogICAgICBhdXRvX3B0ciYKICAg
ICAgb3BlcmF0b3I9KGF1dG9fcHRyJiBfX2EpIHRocm93KCkKICAgICAgewogcmVzZXQoX19hLnJl
bGVhc2UoKSk7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KIyAxNTIgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYmFja3dhcmQvYXV0b19wdHIuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAx
PgogICAgICAgIGF1dG9fcHRyJgogICAgICAgIG9wZXJhdG9yPShhdXRvX3B0cjxfVHAxPiYgX19h
KSB0aHJvdygpCiAgICAgICAgewogICByZXNldChfX2EucmVsZWFzZSgpKTsKICAgcmV0dXJuICp0
aGlzOwogfQojIDE3MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iYWNrd2FyZC9hdXRvX3B0ci5o
IiAzCiAgICAgIH5hdXRvX3B0cigpIHsgZGVsZXRlIF9NX3B0cjsgfQojIDE4MCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iYWNrd2FyZC9hdXRvX3B0ci5oIiAzCiAgICAgIGVsZW1lbnRfdHlwZSYK
ICAgICAgb3BlcmF0b3IqKCkgY29uc3QgdGhyb3coKQogICAgICB7CiA7CiByZXR1cm4gKl9NX3B0
cjsKICAgICAgfQoKCgoKCgoKICAgICAgZWxlbWVudF90eXBlKgogICAgICBvcGVyYXRvci0+KCkg
Y29uc3QgdGhyb3coKQogICAgICB7CiA7CiByZXR1cm4gX01fcHRyOwogICAgICB9CiMgMjEwICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JhY2t3YXJkL2F1dG9fcHRyLmgiIDMKICAgICAgZWxlbWVu
dF90eXBlKgogICAgICBnZXQoKSBjb25zdCB0aHJvdygpIHsgcmV0dXJuIF9NX3B0cjsgfQojIDIy
NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iYWNrd2FyZC9hdXRvX3B0ci5oIiAzCiAgICAgIGVs
ZW1lbnRfdHlwZSoKICAgICAgcmVsZWFzZSgpIHRocm93KCkKICAgICAgewogZWxlbWVudF90eXBl
KiBfX3RtcCA9IF9NX3B0cjsKIF9NX3B0ciA9IDA7CiByZXR1cm4gX190bXA7CiAgICAgIH0KIyAy
MzkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYmFja3dhcmQvYXV0b19wdHIuaCIgMwogICAgICB2
b2lkCiAgICAgIHJlc2V0KGVsZW1lbnRfdHlwZSogX19wID0gMCkgdGhyb3coKQogICAgICB7CiBp
ZiAoX19wICE9IF9NX3B0cikKICAgewogICAgIGRlbGV0ZSBfTV9wdHI7CiAgICAgX01fcHRyID0g
X19wOwogICB9CiAgICAgIH0KIyAyNjAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYmFja3dhcmQv
YXV0b19wdHIuaCIgMwogICAgICBhdXRvX3B0cihhdXRvX3B0cl9yZWY8ZWxlbWVudF90eXBlPiBf
X3JlZikgdGhyb3coKQogICAgICA6IF9NX3B0cihfX3JlZi5fTV9wdHIpIHsgfQoKICAgICAgYXV0
b19wdHImCiAgICAgIG9wZXJhdG9yPShhdXRvX3B0cl9yZWY8ZWxlbWVudF90eXBlPiBfX3JlZikg
dGhyb3coKQogICAgICB7CiBpZiAoX19yZWYuX01fcHRyICE9IHRoaXMtPmdldCgpKQogICB7CiAg
ICAgZGVsZXRlIF9NX3B0cjsKICAgICBfTV9wdHIgPSBfX3JlZi5fTV9wdHI7CiAgIH0KIHJldHVy
biAqdGhpczsKICAgICAgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KICAgICAgICBv
cGVyYXRvciBhdXRvX3B0cl9yZWY8X1RwMT4oKSB0aHJvdygpCiAgICAgICAgeyByZXR1cm4gYXV0
b19wdHJfcmVmPF9UcDE+KHRoaXMtPnJlbGVhc2UoKSk7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcDE+CiAgICAgICAgb3BlcmF0b3IgYXV0b19wdHI8X1RwMT4oKSB0aHJvdygpCiAgICAg
ICAgeyByZXR1cm4gYXV0b19wdHI8X1RwMT4odGhpcy0+cmVsZWFzZSgpKTsgfQogICAgfSBfX2F0
dHJpYnV0ZV9fICgoX19kZXByZWNhdGVkX18pKTsKCgoKICB0ZW1wbGF0ZTw+CiAgICBjbGFzcyBh
dXRvX3B0cjx2b2lkPgogICAgewogICAgcHVibGljOgogICAgICB0eXBlZGVmIHZvaWQgZWxlbWVu
dF90eXBlOwogICAgfSBfX2F0dHJpYnV0ZV9fICgoX19kZXByZWNhdGVkX18pKTsKCgogIHRlbXBs
YXRlPF9Mb2NrX3BvbGljeSBfTHA+CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgaW5saW5l
CiAgICBfX3NoYXJlZF9jb3VudDxfTHA+OjpfX3NoYXJlZF9jb3VudChzdGQ6OmF1dG9fcHRyPF9U
cD4mJiBfX3IpCiAgICA6IF9NX3BpKG5ldyBfU3BfY291bnRlZF9wdHI8X1RwKiwgX0xwPihfX3Iu
Z2V0KCkpKQogICAgeyBfX3IucmVsZWFzZSgpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwg
X0xvY2tfcG9saWN5IF9McD4KICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxPgogICAgaW5saW5lCiAg
ICBfX3NoYXJlZF9wdHI8X1RwLCBfTHA+OjpfX3NoYXJlZF9wdHIoc3RkOjphdXRvX3B0cjxfVHAx
PiYmIF9fcikKICAgIDogX01fcHRyKF9fci5nZXQoKSksIF9NX3JlZmNvdW50KCkKICAgIHsKICAg
ICAKICAgICAgc3RhdGljX2Fzc2VydCggc2l6ZW9mKF9UcDEpID4gMCwgImluY29tcGxldGUgdHlw
ZSIgKTsKICAgICAgX1RwMSogX190bXAgPSBfX3IuZ2V0KCk7CiAgICAgIF9NX3JlZmNvdW50ID0g
X19zaGFyZWRfY291bnQ8X0xwPihzdGQ6Om1vdmUoX19yKSk7CiAgICAgIF9fZW5hYmxlX3NoYXJl
ZF9mcm9tX3RoaXNfaGVscGVyKF9NX3JlZmNvdW50LCBfX3RtcCwgX190bXApOwogICAgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwMT4KICAgIGlubGlu
ZQogICAgc2hhcmVkX3B0cjxfVHA+OjpzaGFyZWRfcHRyKHN0ZDo6YXV0b19wdHI8X1RwMT4mJiBf
X3IpCiAgICA6IF9fc2hhcmVkX3B0cjxfVHA+KHN0ZDo6bW92ZShfX3IpKSB7IH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfRHA+CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1VwLCB0
eXBlbmFtZT4KICAgIGlubGluZQogICAgdW5pcXVlX3B0cjxfVHAsIF9EcD46OnVuaXF1ZV9wdHIo
YXV0b19wdHI8X1VwPiYmIF9fdSkgbm9leGNlcHQKICAgIDogX01fdChfX3UucmVsZWFzZSgpLCBk
ZWxldGVyX3R5cGUoKSkgeyB9CgoKCn0KIyA4NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9tZW1v
cnkiIDIgMwojIDk0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL21lbW9yeSIgMwpuYW1lc3BhY2Ug
c3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCiMgMTE0
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL21lbW9yeSIgMwppbmxpbmUgdm9pZCoKYWxpZ24oc2l6
ZV90IF9fYWxpZ24sIHNpemVfdCBfX3NpemUsIHZvaWQqJiBfX3B0ciwgc2l6ZV90JiBfX3NwYWNl
KSBub2V4Y2VwdAp7CiAgY29uc3QgYXV0byBfX2ludHB0ciA9IHJlaW50ZXJwcmV0X2Nhc3Q8dWlu
dHB0cl90PihfX3B0cik7CiAgY29uc3QgYXV0byBfX2FsaWduZWQgPSAoX19pbnRwdHIgLSAxdSAr
IF9fYWxpZ24pICYgLV9fYWxpZ247CiAgY29uc3QgYXV0byBfX2RpZmYgPSBfX2FsaWduZWQgLSBf
X2ludHB0cjsKICBpZiAoKF9fc2l6ZSArIF9fZGlmZikgPiBfX3NwYWNlKQogICAgcmV0dXJuIG51
bGxwdHI7CiAgZWxzZQogICAgewogICAgICBfX3NwYWNlIC09IF9fZGlmZjsKICAgICAgcmV0dXJu
IF9fcHRyID0gcmVpbnRlcnByZXRfY2FzdDx2b2lkKj4oX19hbGlnbmVkKTsKICAgIH0KfQoKCgpl
bnVtIGNsYXNzIHBvaW50ZXJfc2FmZXR5IHsgcmVsYXhlZCwgcHJlZmVycmVkLCBzdHJpY3QgfTsK
CmlubGluZSB2b2lkCmRlY2xhcmVfcmVhY2hhYmxlKHZvaWQqKSB7IH0KCnRlbXBsYXRlIDxjbGFz
cyBUPgogIGlubGluZSBUKgogIHVuZGVjbGFyZV9yZWFjaGFibGUoVCogX19wKSB7IHJldHVybiBf
X3A7IH0KCmlubGluZSB2b2lkCmRlY2xhcmVfbm9fcG9pbnRlcnMoY2hhciosIHNpemVfdCkgeyB9
CgppbmxpbmUgdm9pZAp1bmRlY2xhcmVfbm9fcG9pbnRlcnMoY2hhciosIHNpemVfdCkgeyB9Cgpp
bmxpbmUgcG9pbnRlcl9zYWZldHkKZ2V0X3BvaW50ZXJfc2FmZXR5KCkgbm9leGNlcHQgeyByZXR1
cm4gcG9pbnRlcl9zYWZldHk6OnJlbGF4ZWQ7IH0KCgp9CiMgMjMgIi91c3IvaW5jbHVkZS9ib29z
dC9zbWFydF9wdHIvc2NvcGVkX3B0ci5ocHAiIDIgMyA0CgoKCiNwcmFnbWEgR0NDIGRpYWdub3N0
aWMgcHVzaAojcHJhZ21hIEdDQyBkaWFnbm9zdGljIGlnbm9yZWQgIi1XZGVwcmVjYXRlZC1kZWNs
YXJhdGlvbnMiCgoKbmFtZXNwYWNlIGJvb3N0CnsKIyA0NyAiL3Vzci9pbmNsdWRlL2Jvb3N0L3Nt
YXJ0X3B0ci9zY29wZWRfcHRyLmhwcCIgMyA0CnRlbXBsYXRlPGNsYXNzIFQ+IGNsYXNzIHNjb3Bl
ZF9wdHIKewpwcml2YXRlOgoKICAgIFQgKiBweDsKCiAgICBzY29wZWRfcHRyKHNjb3BlZF9wdHIg
Y29uc3QgJik7CiAgICBzY29wZWRfcHRyICYgb3BlcmF0b3I9KHNjb3BlZF9wdHIgY29uc3QgJik7
CgogICAgdHlwZWRlZiBzY29wZWRfcHRyPFQ+IHRoaXNfdHlwZTsKCiAgICB2b2lkIG9wZXJhdG9y
PT0oIHNjb3BlZF9wdHIgY29uc3QmICkgY29uc3Q7CiAgICB2b2lkIG9wZXJhdG9yIT0oIHNjb3Bl
ZF9wdHIgY29uc3QmICkgY29uc3Q7CgpwdWJsaWM6CgogICAgdHlwZWRlZiBUIGVsZW1lbnRfdHlw
ZTsKCiAgICBleHBsaWNpdCBzY29wZWRfcHRyKCBUICogcCA9IDAgKTogcHgoIHAgKQogICAgewoK
CgogICAgfQoKCgogICAgZXhwbGljaXQgc2NvcGVkX3B0ciggc3RkOjphdXRvX3B0cjxUPiBwICkg
bm9leGNlcHQgOiBweCggcC5yZWxlYXNlKCkgKQogICAgewoKCgogICAgfQoKCgogICAgfnNjb3Bl
ZF9wdHIoKQogICAgewoKCgogICAgICAgIGJvb3N0OjpjaGVja2VkX2RlbGV0ZSggcHggKTsKICAg
IH0KCiAgICB2b2lkIHJlc2V0KFQgKiBwID0gMCkKICAgIHsKICAgICAgICAoKHAgPT0gMCB8fCBw
ICE9IHB4KSA/IHN0YXRpY19jYXN0PHZvaWQ+ICgwKSA6IF9fYXNzZXJ0X2ZhaWwgKCJwID09IDAg
fHwgcCAhPSBweCIsICIvdXNyL2luY2x1ZGUvYm9vc3Qvc21hcnRfcHRyL3Njb3BlZF9wdHIuaHBw
IiwgOTMsIF9fUFJFVFRZX0ZVTkNUSU9OX18pKTsKICAgICAgICB0aGlzX3R5cGUocCkuc3dhcCgq
dGhpcyk7CiAgICB9CgogICAgVCAmIG9wZXJhdG9yKigpIGNvbnN0CiAgICB7CiAgICAgICAgKChw
eCAhPSAwKSA/IHN0YXRpY19jYXN0PHZvaWQ+ICgwKSA6IF9fYXNzZXJ0X2ZhaWwgKCJweCAhPSAw
IiwgIi91c3IvaW5jbHVkZS9ib29zdC9zbWFydF9wdHIvc2NvcGVkX3B0ci5ocHAiLCA5OSwgX19Q
UkVUVFlfRlVOQ1RJT05fXykpOwogICAgICAgIHJldHVybiAqcHg7CiAgICB9CgogICAgVCAqIG9w
ZXJhdG9yLT4oKSBjb25zdAogICAgewogICAgICAgICgocHggIT0gMCkgPyBzdGF0aWNfY2FzdDx2
b2lkPiAoMCkgOiBfX2Fzc2VydF9mYWlsICgicHggIT0gMCIsICIvdXNyL2luY2x1ZGUvYm9vc3Qv
c21hcnRfcHRyL3Njb3BlZF9wdHIuaHBwIiwgMTA1LCBfX1BSRVRUWV9GVU5DVElPTl9fKSk7CiAg
ICAgICAgcmV0dXJuIHB4OwogICAgfQoKICAgIFQgKiBnZXQoKSBjb25zdCBub2V4Y2VwdAogICAg
ewogICAgICAgIHJldHVybiBweDsKICAgIH0KCgojIDEgIi91c3IvaW5jbHVkZS9ib29zdC9zbWFy
dF9wdHIvZGV0YWlsL29wZXJhdG9yX2Jvb2wuaHBwIiAxIDMgNAojIDEyICIvdXNyL2luY2x1ZGUv
Ym9vc3Qvc21hcnRfcHRyL2RldGFpbC9vcGVyYXRvcl9ib29sLmhwcCIgMyA0CiAgICBleHBsaWNp
dCBvcGVyYXRvciBib29sICgpIGNvbnN0IG5vZXhjZXB0CiAgICB7CiAgICAgICAgcmV0dXJuIHB4
ICE9IDA7CiAgICB9CiMgNjEgIi91c3IvaW5jbHVkZS9ib29zdC9zbWFydF9wdHIvZGV0YWlsL29w
ZXJhdG9yX2Jvb2wuaHBwIiAzIDQKICAgIGJvb2wgb3BlcmF0b3IhICgpIGNvbnN0IG5vZXhjZXB0
CiAgICB7CiAgICAgICAgcmV0dXJuIHB4ID09IDA7CiAgICB9CiMgMTE2ICIvdXNyL2luY2x1ZGUv
Ym9vc3Qvc21hcnRfcHRyL3Njb3BlZF9wdHIuaHBwIiAyIDMgNAoKICAgIHZvaWQgc3dhcChzY29w
ZWRfcHRyICYgYikgbm9leGNlcHQKICAgIHsKICAgICAgICBUICogdG1wID0gYi5weDsKICAgICAg
ICBiLnB4ID0gcHg7CiAgICAgICAgcHggPSB0bXA7CiAgICB9Cn07CgoKCnRlbXBsYXRlPGNsYXNz
IFQ+IGlubGluZSBib29sIG9wZXJhdG9yPT0oIHNjb3BlZF9wdHI8VD4gY29uc3QgJiBwLCBib29z
dDo6ZGV0YWlsOjpzcF9udWxscHRyX3QgKSBub2V4Y2VwdAp7CiAgICByZXR1cm4gcC5nZXQoKSA9
PSAwOwp9Cgp0ZW1wbGF0ZTxjbGFzcyBUPiBpbmxpbmUgYm9vbCBvcGVyYXRvcj09KCBib29zdDo6
ZGV0YWlsOjpzcF9udWxscHRyX3QsIHNjb3BlZF9wdHI8VD4gY29uc3QgJiBwICkgbm9leGNlcHQK
ewogICAgcmV0dXJuIHAuZ2V0KCkgPT0gMDsKfQoKdGVtcGxhdGU8Y2xhc3MgVD4gaW5saW5lIGJv
b2wgb3BlcmF0b3IhPSggc2NvcGVkX3B0cjxUPiBjb25zdCAmIHAsIGJvb3N0OjpkZXRhaWw6OnNw
X251bGxwdHJfdCApIG5vZXhjZXB0CnsKICAgIHJldHVybiBwLmdldCgpICE9IDA7Cn0KCnRlbXBs
YXRlPGNsYXNzIFQ+IGlubGluZSBib29sIG9wZXJhdG9yIT0oIGJvb3N0OjpkZXRhaWw6OnNwX251
bGxwdHJfdCwgc2NvcGVkX3B0cjxUPiBjb25zdCAmIHAgKSBub2V4Y2VwdAp7CiAgICByZXR1cm4g
cC5nZXQoKSAhPSAwOwp9CgoKCnRlbXBsYXRlPGNsYXNzIFQ+IGlubGluZSB2b2lkIHN3YXAoc2Nv
cGVkX3B0cjxUPiAmIGEsIHNjb3BlZF9wdHI8VD4gJiBiKSBub2V4Y2VwdAp7CiAgICBhLnN3YXAo
Yik7Cn0KCgoKdGVtcGxhdGU8Y2xhc3MgVD4gaW5saW5lIFQgKiBnZXRfcG9pbnRlcihzY29wZWRf
cHRyPFQ+IGNvbnN0ICYgcCkgbm9leGNlcHQKewogICAgcmV0dXJuIHAuZ2V0KCk7Cn0KCn0KCgoj
cHJhZ21hIEdDQyBkaWFnbm9zdGljIHBvcAojIDE1ICIvdXNyL2luY2x1ZGUvYm9vc3Qvc2NvcGVk
X3B0ci5ocHAiIDIgMyA0CiMgMzAgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWkt
bWFzdGVyLTMuMi4xL3NyYy9JbXBsUHRyLmgiIDIKIyA0MSAiL2hvbWUvc2hhcmtjei9saWJ5dWkv
bGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL0ltcGxQdHIuaCIKCiMgNDEgIi9ob21lL3No
YXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9JbXBsUHRyLmgiCnRl
bXBsYXRlPGNsYXNzIF9JbXBsPgpjbGFzcyBJbXBsUHRyIDogcHJpdmF0ZSBib29zdDo6bm9uY29w
eWFibGUKewoKCgoKcHVibGljOgogICAgdHlwZWRlZiBfSW1wbCBlbGVtZW50X3R5cGU7CgogICAg
ZXhwbGljaXQKICAgIEltcGxQdHIoIF9JbXBsICogaW1wbF9yID0gMCApIDogX2ltcGwoIGltcGxf
ciApIHt9CgpwdWJsaWM6CiAgICB2b2lkIHJlc2V0KCBfSW1wbCAqIGltcGxfciA9IDAgKSB7IF9p
bXBsLnJlc2V0KCBpbXBsX3IgKTsgfQoKICAgIHZvaWQgc3dhcCggSW1wbFB0ciByaHMgKSB7IF9p
bXBsLnN3YXAoIHJocy5faW1wbCApOyB9CgpwdWJsaWM6CgoKCiAgICBleHBsaWNpdCBvcGVyYXRv
ciBib29sICgpIGNvbnN0IHsgcmV0dXJuIF9pbXBsLmdldCgpICE9IDA7IH0KCgogICAgY29uc3Qg
X0ltcGwgJiBvcGVyYXRvciooKSBjb25zdCB7IHJldHVybiAqX2ltcGw7IH0KICAgIGNvbnN0IF9J
bXBsICogb3BlcmF0b3ItPigpIGNvbnN0IHsgcmV0dXJuIF9pbXBsLmdldCgpOyB9CiAgICBjb25z
dCBfSW1wbCAqIGdldCgpIGNvbnN0IHsgcmV0dXJuIF9pbXBsLmdldCgpOyB9CgogICAgX0ltcGwg
JiBvcGVyYXRvciooKSB7IHJldHVybiAqX2ltcGw7IH0KICAgIF9JbXBsICogb3BlcmF0b3ItPigp
IHsgcmV0dXJuIF9pbXBsLmdldCgpOyB9CiAgICBfSW1wbCAqIGdldCgpIHsgcmV0dXJuIF9pbXBs
LmdldCgpOyB9Cgpwcml2YXRlOgogICAgYm9vc3Q6OnNjb3BlZF9wdHI8X0ltcGw+IF9pbXBsOwp9
OwoKdGVtcGxhdGU8Y2xhc3MgX0ltcGw+CmlubGluZSBib29sIG9wZXJhdG9yPT0oIEltcGxQdHI8
X0ltcGw+ICYgbGhzLCBJbXBsUHRyPF9JbXBsPiAmIHJocyApIHsgcmV0dXJuIGxocy5nZXQoKSA9
PSByaHMuZ2V0KCk7IH0KCnRlbXBsYXRlPGNsYXNzIF9JbXBsPgppbmxpbmUgYm9vbCBvcGVyYXRv
ciE9KCBJbXBsUHRyPF9JbXBsPiAmIGxocywgSW1wbFB0cjxfSW1wbD4gJiByaHMgKSB7IHJldHVy
biBsaHMuZ2V0KCkgIT0gcmhzLmdldCgpOyB9Cgp0ZW1wbGF0ZTxjbGFzcyBfSW1wbD4KaW5saW5l
IGJvb2wgb3BlcmF0b3I8ICggSW1wbFB0cjxfSW1wbD4gJiBsaHMsIEltcGxQdHI8X0ltcGw+ICYg
cmhzICkgeyByZXR1cm4gbGhzLmdldCgpIDwgcmhzLmdldCgpOyB9CiMgMzUgIi9ob21lL3NoYXJr
Y3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZVUlMb2cuaCIgMgojIDY3
ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVVJ
TG9nLmgiCmNsYXNzIFlVSUxvZ1ByaXZhdGU7CgplbnVtIFlVSUxvZ0xldmVsX3QKewogICAgWVVJ
X0xPR19ERUJVRyA9IDAsCiAgICBZVUlfTE9HX01JTEVTVE9ORSwKICAgIFlVSV9MT0dfV0FSTklO
RywKICAgIFlVSV9MT0dfRVJST1IKfTsKCgoKCgoKCnR5cGVkZWYgdm9pZCAoKllVSUxvZ2dlckZ1
bmN0aW9uKSggWVVJTG9nTGV2ZWxfdCwKICAgICAgIGNvbnN0IGNoYXIgKiwKICAgICAgIGNvbnN0
IGNoYXIgKiwKICAgICAgIGludCwKICAgICAgIGNvbnN0IGNoYXIgKiwKICAgICAgIGNvbnN0IGNo
YXIgKiApOwoKdHlwZWRlZiB2b2lkICgqWVVJRW5hYmxlRGVidWdMb2dnaW5nRnVuY3Rpb24pKCBi
b29sICk7CnR5cGVkZWYgYm9vbCAoKllVSURlYnVnTG9nZ2luZ0VuYWJsZWRGdW5jdGlvbikoKTsK
CgoKCgpjbGFzcyBZVUlMb2cKewpwdWJsaWM6CgoKCgoKICAgIHN0YXRpYyBzdGQ6Om9zdHJlYW0g
JiBkZWJ1ZyAoIGNvbnN0IGNoYXIgKiBsb2dDb21wb25lbnQsIGNvbnN0IGNoYXIgKiBzb3VyY2VG
aWxlTmFtZSwgaW50IGxpbmVObywgY29uc3QgY2hhciAqIGZ1bmN0aW9uTmFtZSApOwogICAgc3Rh
dGljIHN0ZDo6b3N0cmVhbSAmIG1pbGVzdG9uZSggY29uc3QgY2hhciAqIGxvZ0NvbXBvbmVudCwg
Y29uc3QgY2hhciAqIHNvdXJjZUZpbGVOYW1lLCBpbnQgbGluZU5vLCBjb25zdCBjaGFyICogZnVu
Y3Rpb25OYW1lICk7CiAgICBzdGF0aWMgc3RkOjpvc3RyZWFtICYgd2FybmluZyAoIGNvbnN0IGNo
YXIgKiBsb2dDb21wb25lbnQsIGNvbnN0IGNoYXIgKiBzb3VyY2VGaWxlTmFtZSwgaW50IGxpbmVO
bywgY29uc3QgY2hhciAqIGZ1bmN0aW9uTmFtZSApOwogICAgc3RhdGljIHN0ZDo6b3N0cmVhbSAm
IGVycm9yICggY29uc3QgY2hhciAqIGxvZ0NvbXBvbmVudCwgY29uc3QgY2hhciAqIHNvdXJjZUZp
bGVOYW1lLCBpbnQgbGluZU5vLCBjb25zdCBjaGFyICogZnVuY3Rpb25OYW1lICk7CgoKCgogICAg
c3RkOjpvc3RyZWFtICYgbG9nKCBZVUlMb2dMZXZlbF90IGxvZ0xldmVsLAogICBjb25zdCBjaGFy
ICogbG9nQ29tcG9uZW50LAogICBjb25zdCBjaGFyICogc291cmNlRmlsZU5hbWUsCiAgIGludCBs
aW5lTm8sCiAgIGNvbnN0IGNoYXIgKiBmdW5jdGlvbk5hbWUgKTsKCgoKCgogICAgc3RhdGljIFlV
SUxvZyAqIGluc3RhbmNlKCk7CgoKCgogICAgc3RhdGljIHZvaWQgZW5hYmxlRGVidWdMb2dnaW5n
KCBib29sIGRlYnVnTG9nZ2luZyA9IHRydWUgKTsKCgoKCiAgICBzdGF0aWMgYm9vbCBkZWJ1Z0xv
Z2dpbmdFbmFibGVkKCk7CiMgMTU3ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVp
LW1hc3Rlci0zLjIuMS9zcmMvWVVJTG9nLmgiCiAgICBzdGF0aWMgYm9vbCBzZXRMb2dGaWxlTmFt
ZSggY29uc3Qgc3RkOjpzdHJpbmcgJiBsb2dGaWxlTmFtZSApOwoKCgoKCgogICAgc3RhdGljIHN0
ZDo6c3RyaW5nIGxvZ0ZpbGVOYW1lKCk7CiMgMTc0ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5
dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVVJTG9nLmgiCiAgICBzdGF0aWMgdm9pZCBzZXRM
b2dnZXJGdW5jdGlvbiggWVVJTG9nZ2VyRnVuY3Rpb24gbG9nZ2VyRnVuY3Rpb24gKTsKIyAxODMg
Ii9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZVUlM
b2cuaCIKICAgIHN0YXRpYyBZVUlMb2dnZXJGdW5jdGlvbiBsb2dnZXJGdW5jdGlvbiggYm9vbCBy
ZXR1cm5TdGRMb2dnZXIgPSBmYWxzZSApOwojIDE5NSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGli
eXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lVSUxvZy5oIgogICAgc3RhdGljIHZvaWQgc2V0
RW5hYmxlRGVidWdMb2dnaW5nSG9va3MoIFlVSUVuYWJsZURlYnVnTG9nZ2luZ0Z1bmN0aW9uIGVu
YWJsZUZ1bmN0aW9uLAogICAgICAgICBZVUlEZWJ1Z0xvZ2dpbmdFbmFibGVkRnVuY3Rpb24gaXNF
bmFibGVkRnVuY3Rpb24gKTsKCgoKCgogICAgc3RhdGljIFlVSUVuYWJsZURlYnVnTG9nZ2luZ0Z1
bmN0aW9uIGVuYWJsZURlYnVnTG9nZ2luZ0hvb2soKTsKCgoKCgogICAgc3RhdGljIFlVSURlYnVn
TG9nZ2luZ0VuYWJsZWRGdW5jdGlvbiBkZWJ1Z0xvZ2dpbmdFbmFibGVkSG9vaygpOwoKCgoKICAg
IHN0YXRpYyBzdGQ6OnN0cmluZyBiYXNlbmFtZSggY29uc3Qgc3RkOjpzdHJpbmcgJiBmaWxlTmFt
ZVdpdGhQYXRoICk7CgoKcHJpdmF0ZToKCgoKCgoKICAgIFlVSUxvZygpOwoKCgoKICAgIH5ZVUlM
b2coKTsKCgoKCgogICAgSW1wbFB0cjxZVUlMb2dQcml2YXRlPiBwcml2Owp9OwojIDMxICIvaG9t
ZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5j
YyIgMgoKIyAxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIu
MS9zcmMvWURpYWxvZy5oIiAxCiMgMjkgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5
dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmgiCiMgMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkv
bGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lTaW5nbGVDaGlsZENvbnRhaW5lcldpZGdl
dC5oIiAxCiMgMjggIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMu
Mi4xL3NyYy9ZU2luZ2xlQ2hpbGRDb250YWluZXJXaWRnZXQuaCIKIyAxICIvaG9tZS9zaGFya2N6
L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVdpZGdldC5oIiAxCiMgMzEg
Ii9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2lk
Z2V0LmgiCiMgMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4y
LjEvc3JjL1lUeXBlcy5oIiAxCiMgMzQgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5
dWktbWFzdGVyLTMuMi4xL3NyYy9ZVHlwZXMuaCIKdHlwZWRlZiBkb3VibGUgWUxheW91dFNpemVf
dDsKdHlwZWRlZiBsb25nIGxvbmcgWUZpbGVTaXplX3Q7CgpjbGFzcyBZV2lkZ2V0OwoKdHlwZWRl
ZiBzdGQ6Omxpc3Q8WVdpZGdldCAqPiBZV2lkZ2V0TGlzdDsKdHlwZWRlZiBzdGQ6Omxpc3Q8WVdp
ZGdldCAqPjo6aXRlcmF0b3IgWVdpZGdldExpc3RJdGVyYXRvcjsKdHlwZWRlZiBzdGQ6Omxpc3Q8
WVdpZGdldCAqPjo6Y29uc3RfaXRlcmF0b3IgWVdpZGdldExpc3RDb25zdEl0ZXJhdG9yOwp0eXBl
ZGVmIHN0ZDo6bGlzdDxZV2lkZ2V0ICo+OjpyZXZlcnNlX2l0ZXJhdG9yIFlXaWRnZXRMaXN0UmV2
ZXJzZUl0ZXJhdG9yOwp0eXBlZGVmIHN0ZDo6bGlzdDxZV2lkZ2V0ICo+Ojpjb25zdF9yZXZlcnNl
X2l0ZXJhdG9yIFlXaWRnZXRMaXN0Q29uc3RSZXZlcnNlSXRlcmF0b3I7CgoKCgplbnVtIFlVSURp
bWVuc2lvbgp7CiAgICBZRF9IT1JJWiA9IDAsCiAgICBZRF9WRVJUID0gMQp9OwoKCmVudW0gWUFs
aWdubWVudFR5cGUKewogICAgWUFsaWduVW5jaGFuZ2VkLAogICAgWUFsaWduQmVnaW4sCiAgICBZ
QWxpZ25FbmQsCiAgICBZQWxpZ25DZW50ZXIKfTsKCgplbnVtIFlEaWFsb2dUeXBlCnsKICAgIFlN
YWluRGlhbG9nLAogICAgWVBvcHVwRGlhbG9nLAogICAgWVdpemFyZERpYWxvZywKfTsKCgplbnVt
IFlEaWFsb2dDb2xvck1vZGUKewogICAgWURpYWxvZ05vcm1hbENvbG9yLAogICAgWURpYWxvZ0lu
Zm9Db2xvciwKICAgIFlEaWFsb2dXYXJuQ29sb3IKfTsKCgplbnVtIFlCdXR0b25Sb2xlCnsKICAg
IFlDdXN0b21CdXR0b24gPSAwLAogICAgWU9LQnV0dG9uLAogICAgWUFwcGx5QnV0dG9uLAogICAg
WUNhbmNlbEJ1dHRvbiwKICAgIFlIZWxwQnV0dG9uLAogICAgWVJlbE5vdGVzQnV0dG9uLAoKICAg
IFlNYXhCdXR0b25Sb2xlCn07CgoKZW51bSBZQnV0dG9uT3JkZXIKewogICAgWUtERUJ1dHRvbk9y
ZGVyLAoKCgogICAgWUdub21lQnV0dG9uT3JkZXIKCgp9OwojIDMyICIvaG9tZS9zaGFya2N6L2xp
Ynl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVdpZGdldC5oIiAyCiMgMSAiL2hv
bWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lQcm9wZXJ0
eS5oIiAxCiMgMjkgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMu
Mi4xL3NyYy9ZUHJvcGVydHkuaCIKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3ZlY3RvciIg
MSAzCiMgNTggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdmVjdG9yIiAzCiAgICAgICAKIyA1OSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC92ZWN0b3IiIDMKCgoKCgojIDEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9zdGxfdmVjdG9yLmgiIDEgMwojIDY2ICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvc3RsX3ZlY3Rvci5oIiAzCgojIDY2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX3ZlY3Rvci5oIiAzCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJp
bGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5h
bWUgX0FsbG9jPgogICAgc3RydWN0IF9WZWN0b3JfYmFzZQogICAgewogICAgICB0eXBlZGVmIHR5
cGVuYW1lIF9fZ251X2N4eDo6X19hbGxvY190cmFpdHM8X0FsbG9jPjo6dGVtcGxhdGUKICAgICAg
ICByZWJpbmQ8X1RwPjo6b3RoZXIgX1RwX2FsbG9jX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5h
bWUgX19nbnVfY3h4OjpfX2FsbG9jX3RyYWl0czxfVHBfYWxsb2NfdHlwZT46OnBvaW50ZXIKICAg
ICAgICBwb2ludGVyOwoKICAgICAgc3RydWN0IF9WZWN0b3JfaW1wbAogICAgICA6IHB1YmxpYyBf
VHBfYWxsb2NfdHlwZQogICAgICB7CiBwb2ludGVyIF9NX3N0YXJ0OwogcG9pbnRlciBfTV9maW5p
c2g7CiBwb2ludGVyIF9NX2VuZF9vZl9zdG9yYWdlOwoKIF9WZWN0b3JfaW1wbCgpCiA6IF9UcF9h
bGxvY190eXBlKCksIF9NX3N0YXJ0KCksIF9NX2ZpbmlzaCgpLCBfTV9lbmRfb2Zfc3RvcmFnZSgp
CiB7IH0KCiBfVmVjdG9yX2ltcGwoX1RwX2FsbG9jX3R5cGUgY29uc3QmIF9fYSkgbm9leGNlcHQK
IDogX1RwX2FsbG9jX3R5cGUoX19hKSwgX01fc3RhcnQoKSwgX01fZmluaXNoKCksIF9NX2VuZF9v
Zl9zdG9yYWdlKCkKIHsgfQoKCiBfVmVjdG9yX2ltcGwoX1RwX2FsbG9jX3R5cGUmJiBfX2EpIG5v
ZXhjZXB0CiA6IF9UcF9hbGxvY190eXBlKHN0ZDo6bW92ZShfX2EpKSwKICAgX01fc3RhcnQoKSwg
X01fZmluaXNoKCksIF9NX2VuZF9vZl9zdG9yYWdlKCkKIHsgfQoKCiB2b2lkIF9NX3N3YXBfZGF0
YShfVmVjdG9yX2ltcGwmIF9feCkgbm9leGNlcHQKIHsKICAgc3RkOjpzd2FwKF9NX3N0YXJ0LCBf
X3guX01fc3RhcnQpOwogICBzdGQ6OnN3YXAoX01fZmluaXNoLCBfX3guX01fZmluaXNoKTsKICAg
c3RkOjpzd2FwKF9NX2VuZF9vZl9zdG9yYWdlLCBfX3guX01fZW5kX29mX3N0b3JhZ2UpOwogfQog
ICAgICB9OwoKICAgIHB1YmxpYzoKICAgICAgdHlwZWRlZiBfQWxsb2MgYWxsb2NhdG9yX3R5cGU7
CgogICAgICBfVHBfYWxsb2NfdHlwZSYKICAgICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpIG5vZXhj
ZXB0CiAgICAgIHsgcmV0dXJuICpzdGF0aWNfY2FzdDxfVHBfYWxsb2NfdHlwZSo+KCZ0aGlzLT5f
TV9pbXBsKTsgfQoKICAgICAgY29uc3QgX1RwX2FsbG9jX3R5cGUmCiAgICAgIF9NX2dldF9UcF9h
bGxvY2F0b3IoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiAqc3RhdGljX2Nhc3Q8Y29u
c3QgX1RwX2FsbG9jX3R5cGUqPigmdGhpcy0+X01faW1wbCk7IH0KCiAgICAgIGFsbG9jYXRvcl90
eXBlCiAgICAgIGdldF9hbGxvY2F0b3IoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBh
bGxvY2F0b3JfdHlwZShfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOyB9CgogICAgICBfVmVjdG9yX2Jh
c2UoKQogICAgICA6IF9NX2ltcGwoKSB7IH0KCiAgICAgIF9WZWN0b3JfYmFzZShjb25zdCBhbGxv
Y2F0b3JfdHlwZSYgX19hKSBub2V4Y2VwdAogICAgICA6IF9NX2ltcGwoX19hKSB7IH0KCiAgICAg
IF9WZWN0b3JfYmFzZShzaXplX3QgX19uKQogICAgICA6IF9NX2ltcGwoKQogICAgICB7IF9NX2Ny
ZWF0ZV9zdG9yYWdlKF9fbik7IH0KCiAgICAgIF9WZWN0b3JfYmFzZShzaXplX3QgX19uLCBjb25z
dCBhbGxvY2F0b3JfdHlwZSYgX19hKQogICAgICA6IF9NX2ltcGwoX19hKQogICAgICB7IF9NX2Ny
ZWF0ZV9zdG9yYWdlKF9fbik7IH0KCgogICAgICBfVmVjdG9yX2Jhc2UoX1RwX2FsbG9jX3R5cGUm
JiBfX2EpIG5vZXhjZXB0CiAgICAgIDogX01faW1wbChzdGQ6Om1vdmUoX19hKSkgeyB9CgogICAg
ICBfVmVjdG9yX2Jhc2UoX1ZlY3Rvcl9iYXNlJiYgX194KSBub2V4Y2VwdAogICAgICA6IF9NX2lt
cGwoc3RkOjptb3ZlKF9feC5fTV9nZXRfVHBfYWxsb2NhdG9yKCkpKQogICAgICB7IHRoaXMtPl9N
X2ltcGwuX01fc3dhcF9kYXRhKF9feC5fTV9pbXBsKTsgfQoKICAgICAgX1ZlY3Rvcl9iYXNlKF9W
ZWN0b3JfYmFzZSYmIF9feCwgY29uc3QgYWxsb2NhdG9yX3R5cGUmIF9fYSkKICAgICAgOiBfTV9p
bXBsKF9fYSkKICAgICAgewogaWYgKF9feC5nZXRfYWxsb2NhdG9yKCkgPT0gX19hKQogICB0aGlz
LT5fTV9pbXBsLl9NX3N3YXBfZGF0YShfX3guX01faW1wbCk7CiBlbHNlCiAgIHsKICAgICBzaXpl
X3QgX19uID0gX194Ll9NX2ltcGwuX01fZmluaXNoIC0gX194Ll9NX2ltcGwuX01fc3RhcnQ7CiAg
ICAgX01fY3JlYXRlX3N0b3JhZ2UoX19uKTsKICAgfQogICAgICB9CgoKICAgICAgfl9WZWN0b3Jf
YmFzZSgpIG5vZXhjZXB0CiAgICAgIHsgX01fZGVhbGxvY2F0ZSh0aGlzLT5fTV9pbXBsLl9NX3N0
YXJ0LCB0aGlzLT5fTV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdlCiAgICAgICAgLSB0aGlzLT5fTV9p
bXBsLl9NX3N0YXJ0KTsgfQoKICAgIHB1YmxpYzoKICAgICAgX1ZlY3Rvcl9pbXBsIF9NX2ltcGw7
CgogICAgICBwb2ludGVyCiAgICAgIF9NX2FsbG9jYXRlKHNpemVfdCBfX24pCiAgICAgIHsKIHR5
cGVkZWYgX19nbnVfY3h4OjpfX2FsbG9jX3RyYWl0czxfVHBfYWxsb2NfdHlwZT4gX1RyOwogcmV0
dXJuIF9fbiAhPSAwID8gX1RyOjphbGxvY2F0ZShfTV9pbXBsLCBfX24pIDogcG9pbnRlcigpOwog
ICAgICB9CgogICAgICB2b2lkCiAgICAgIF9NX2RlYWxsb2NhdGUocG9pbnRlciBfX3AsIHNpemVf
dCBfX24pCiAgICAgIHsKIHR5cGVkZWYgX19nbnVfY3h4OjpfX2FsbG9jX3RyYWl0czxfVHBfYWxs
b2NfdHlwZT4gX1RyOwogaWYgKF9fcCkKICAgX1RyOjpkZWFsbG9jYXRlKF9NX2ltcGwsIF9fcCwg
X19uKTsKICAgICAgfQoKICAgIHByaXZhdGU6CiAgICAgIHZvaWQKICAgICAgX01fY3JlYXRlX3N0
b3JhZ2Uoc2l6ZV90IF9fbikKICAgICAgewogdGhpcy0+X01faW1wbC5fTV9zdGFydCA9IHRoaXMt
Pl9NX2FsbG9jYXRlKF9fbik7CiB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCA9IHRoaXMtPl9NX2lt
cGwuX01fc3RhcnQ7CiB0aGlzLT5fTV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdlID0gdGhpcy0+X01f
aW1wbC5fTV9zdGFydCArIF9fbjsKICAgICAgfQogICAgfTsKIyAyMTMgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9zdGxfdmVjdG9yLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5
cGVuYW1lIF9BbGxvYyA9IHN0ZDo6YWxsb2NhdG9yPF9UcD4gPgogICAgY2xhc3MgdmVjdG9yIDog
cHJvdGVjdGVkIF9WZWN0b3JfYmFzZTxfVHAsIF9BbGxvYz4KICAgIHsKCiAgICAgIHR5cGVkZWYg
dHlwZW5hbWUgX0FsbG9jOjp2YWx1ZV90eXBlIF9BbGxvY192YWx1ZV90eXBlOwoKCgogICAgIAoK
ICAgICAgdHlwZWRlZiBfVmVjdG9yX2Jhc2U8X1RwLCBfQWxsb2M+IF9CYXNlOwogICAgICB0eXBl
ZGVmIHR5cGVuYW1lIF9CYXNlOjpfVHBfYWxsb2NfdHlwZSBfVHBfYWxsb2NfdHlwZTsKICAgICAg
dHlwZWRlZiBfX2dudV9jeHg6Ol9fYWxsb2NfdHJhaXRzPF9UcF9hbGxvY190eXBlPiBfQWxsb2Nf
dHJhaXRzOwoKICAgIHB1YmxpYzoKICAgICAgdHlwZWRlZiBfVHAgdmFsdWVfdHlwZTsKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBfQmFzZTo6cG9pbnRlciBwb2ludGVyOwogICAgICB0eXBlZGVmIHR5
cGVuYW1lIF9BbGxvY190cmFpdHM6OmNvbnN0X3BvaW50ZXIgY29uc3RfcG9pbnRlcjsKICAgICAg
dHlwZWRlZiB0eXBlbmFtZSBfQWxsb2NfdHJhaXRzOjpyZWZlcmVuY2UgcmVmZXJlbmNlOwogICAg
ICB0eXBlZGVmIHR5cGVuYW1lIF9BbGxvY190cmFpdHM6OmNvbnN0X3JlZmVyZW5jZSBjb25zdF9y
ZWZlcmVuY2U7CiAgICAgIHR5cGVkZWYgX19nbnVfY3h4OjpfX25vcm1hbF9pdGVyYXRvcjxwb2lu
dGVyLCB2ZWN0b3I+IGl0ZXJhdG9yOwogICAgICB0eXBlZGVmIF9fZ251X2N4eDo6X19ub3JtYWxf
aXRlcmF0b3I8Y29uc3RfcG9pbnRlciwgdmVjdG9yPgogICAgICBjb25zdF9pdGVyYXRvcjsKICAg
ICAgdHlwZWRlZiBzdGQ6OnJldmVyc2VfaXRlcmF0b3I8Y29uc3RfaXRlcmF0b3I+IGNvbnN0X3Jl
dmVyc2VfaXRlcmF0b3I7CiAgICAgIHR5cGVkZWYgc3RkOjpyZXZlcnNlX2l0ZXJhdG9yPGl0ZXJh
dG9yPiByZXZlcnNlX2l0ZXJhdG9yOwogICAgICB0eXBlZGVmIHNpemVfdCBzaXplX3R5cGU7CiAg
ICAgIHR5cGVkZWYgcHRyZGlmZl90IGRpZmZlcmVuY2VfdHlwZTsKICAgICAgdHlwZWRlZiBfQWxs
b2MgYWxsb2NhdG9yX3R5cGU7CgogICAgcHJvdGVjdGVkOgogICAgICB1c2luZyBfQmFzZTo6X01f
YWxsb2NhdGU7CiAgICAgIHVzaW5nIF9CYXNlOjpfTV9kZWFsbG9jYXRlOwogICAgICB1c2luZyBf
QmFzZTo6X01faW1wbDsKICAgICAgdXNpbmcgX0Jhc2U6Ol9NX2dldF9UcF9hbGxvY2F0b3I7Cgog
ICAgcHVibGljOgoKCgoKCgogICAgICB2ZWN0b3IoKQoKICAgICAgbm9leGNlcHQoaXNfbm90aHJv
d19kZWZhdWx0X2NvbnN0cnVjdGlibGU8X0FsbG9jPjo6dmFsdWUpCgogICAgICA6IF9CYXNlKCkg
eyB9CgoKCgoKICAgICAgZXhwbGljaXQKICAgICAgdmVjdG9yKGNvbnN0IGFsbG9jYXRvcl90eXBl
JiBfX2EpIG5vZXhjZXB0CiAgICAgIDogX0Jhc2UoX19hKSB7IH0KIyAyNzggIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYml0cy9zdGxfdmVjdG9yLmgiIDMKICAgICAgZXhwbGljaXQKICAgICAgdmVj
dG9yKHNpemVfdHlwZSBfX24sIGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EgPSBhbGxvY2F0b3Jf
dHlwZSgpKQogICAgICA6IF9CYXNlKF9fbiwgX19hKQogICAgICB7IF9NX2RlZmF1bHRfaW5pdGlh
bGl6ZShfX24pOyB9CiMgMjkxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3ZlY3Rv
ci5oIiAzCiAgICAgIHZlY3RvcihzaXplX3R5cGUgX19uLCBjb25zdCB2YWx1ZV90eXBlJiBfX3Zh
bHVlLAogICAgICBjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hID0gYWxsb2NhdG9yX3R5cGUoKSkK
ICAgICAgOiBfQmFzZShfX24sIF9fYSkKICAgICAgeyBfTV9maWxsX2luaXRpYWxpemUoX19uLCBf
X3ZhbHVlKTsgfQojIDMyMCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0b3Iu
aCIgMwogICAgICB2ZWN0b3IoY29uc3QgdmVjdG9yJiBfX3gpCiAgICAgIDogX0Jhc2UoX194LnNp
emUoKSwKICAgICAgICBfQWxsb2NfdHJhaXRzOjpfU19zZWxlY3Rfb25fY29weShfX3guX01fZ2V0
X1RwX2FsbG9jYXRvcigpKSkKICAgICAgeyB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCA9CiAgIHN0
ZDo6X191bmluaXRpYWxpemVkX2NvcHlfYShfX3guYmVnaW4oKSwgX194LmVuZCgpLAogICAgICAg
ICAgdGhpcy0+X01faW1wbC5fTV9zdGFydCwKICAgICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3Io
KSk7CiAgICAgIH0KIyAzMzcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfdmVjdG9y
LmgiIDMKICAgICAgdmVjdG9yKHZlY3RvciYmIF9feCkgbm9leGNlcHQKICAgICAgOiBfQmFzZShz
dGQ6Om1vdmUoX194KSkgeyB9CgoKICAgICAgdmVjdG9yKGNvbnN0IHZlY3RvciYgX194LCBjb25z
dCBhbGxvY2F0b3JfdHlwZSYgX19hKQogICAgICA6IF9CYXNlKF9feC5zaXplKCksIF9fYSkKICAg
ICAgeyB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCA9CiAgIHN0ZDo6X191bmluaXRpYWxpemVkX2Nv
cHlfYShfX3guYmVnaW4oKSwgX194LmVuZCgpLAogICAgICAgICAgdGhpcy0+X01faW1wbC5fTV9z
dGFydCwKICAgICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgIH0KCgogICAgICB2
ZWN0b3IodmVjdG9yJiYgX19ydiwgY29uc3QgYWxsb2NhdG9yX3R5cGUmIF9fbSkKICAgICAgbm9l
eGNlcHQoX0FsbG9jX3RyYWl0czo6X1NfYWx3YXlzX2VxdWFsKCkpCiAgICAgIDogX0Jhc2Uoc3Rk
Ojptb3ZlKF9fcnYpLCBfX20pCiAgICAgIHsKIGlmIChfX3J2LmdldF9hbGxvY2F0b3IoKSAhPSBf
X20pCiAgIHsKICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCA9CiAgICAgICBzdGQ6Ol9fdW5p
bml0aWFsaXplZF9tb3ZlX2EoX19ydi5iZWdpbigpLCBfX3J2LmVuZCgpLAogICAgICAgdGhpcy0+
X01faW1wbC5fTV9zdGFydCwKICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgX19y
di5jbGVhcigpOwogICB9CiAgICAgIH0KIyAzNzUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9zdGxfdmVjdG9yLmgiIDMKICAgICAgdmVjdG9yKGluaXRpYWxpemVyX2xpc3Q8dmFsdWVfdHlw
ZT4gX19sLAogICAgICBjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hID0gYWxsb2NhdG9yX3R5cGUo
KSkKICAgICAgOiBfQmFzZShfX2EpCiAgICAgIHsKIF9NX3JhbmdlX2luaXRpYWxpemUoX19sLmJl
Z2luKCksIF9fbC5lbmQoKSwKICAgICAgIHJhbmRvbV9hY2Nlc3NfaXRlcmF0b3JfdGFnKCkpOwog
ICAgICB9CiMgNDAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3ZlY3Rvci5oIiAz
CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLAogICAgICAgIHR5cGVuYW1l
ID0gc3RkOjpfUmVxdWlyZUlucHV0SXRlcjxfSW5wdXRJdGVyYXRvcj4+CiAgICAgICAgdmVjdG9y
KF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgICBj
b25zdCBhbGxvY2F0b3JfdHlwZSYgX19hID0gYWxsb2NhdG9yX3R5cGUoKSkKIDogX0Jhc2UoX19h
KQogICAgICAgIHsgX01faW5pdGlhbGl6ZV9kaXNwYXRjaChfX2ZpcnN0LCBfX2xhc3QsIF9fZmFs
c2VfdHlwZSgpKTsgfQojIDQyNSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0
b3IuaCIgMwogICAgICB+dmVjdG9yKCkgbm9leGNlcHQKICAgICAgeyBzdGQ6Ol9EZXN0cm95KHRo
aXMtPl9NX2ltcGwuX01fc3RhcnQsIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoLAogICAgICAgIF9N
X2dldF9UcF9hbGxvY2F0b3IoKSk7IH0KIyA0MzcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9zdGxfdmVjdG9yLmgiIDMKICAgICAgdmVjdG9yJgogICAgICBvcGVyYXRvcj0oY29uc3QgdmVj
dG9yJiBfX3gpOwojIDQ0OSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0b3Iu
aCIgMwogICAgICB2ZWN0b3ImCiAgICAgIG9wZXJhdG9yPSh2ZWN0b3ImJiBfX3gpIG5vZXhjZXB0
KF9BbGxvY190cmFpdHM6Ol9TX25vdGhyb3dfbW92ZSgpKQogICAgICB7CiAgICAgICAgY29uc3Rl
eHByIGJvb2wgX19tb3ZlX3N0b3JhZ2UgPQogICAgICAgICAgX0FsbG9jX3RyYWl0czo6X1NfcHJv
cGFnYXRlX29uX21vdmVfYXNzaWduKCkKICAgICAgICAgIHx8IF9BbGxvY190cmFpdHM6Ol9TX2Fs
d2F5c19lcXVhbCgpOwogICAgICAgIF9NX21vdmVfYXNzaWduKHN0ZDo6bW92ZShfX3gpLCBfX2Jv
b2xfY29uc3RhbnQ8X19tb3ZlX3N0b3JhZ2U+KCkpOwogcmV0dXJuICp0aGlzOwogICAgICB9CiMg
NDcwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3ZlY3Rvci5oIiAzCiAgICAgIHZl
Y3RvciYKICAgICAgb3BlcmF0b3I9KGluaXRpYWxpemVyX2xpc3Q8dmFsdWVfdHlwZT4gX19sKQog
ICAgICB7CiB0aGlzLT5hc3NpZ24oX19sLmJlZ2luKCksIF9fbC5lbmQoKSk7CiByZXR1cm4gKnRo
aXM7CiAgICAgIH0KIyA0ODggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfdmVjdG9y
LmgiIDMKICAgICAgdm9pZAogICAgICBhc3NpZ24oc2l6ZV90eXBlIF9fbiwgY29uc3QgdmFsdWVf
dHlwZSYgX192YWwpCiAgICAgIHsgX01fZmlsbF9hc3NpZ24oX19uLCBfX3ZhbCk7IH0KIyA1MDUg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfdmVjdG9yLmgiIDMKICAgICAgdGVtcGxh
dGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsCiAgICAgICAgdHlwZW5hbWUgPSBzdGQ6Ol9SZXF1
aXJlSW5wdXRJdGVyPF9JbnB1dEl0ZXJhdG9yPj4KICAgICAgICB2b2lkCiAgICAgICAgYXNzaWdu
KF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCkKICAgICAgICB7
IF9NX2Fzc2lnbl9kaXNwYXRjaChfX2ZpcnN0LCBfX2xhc3QsIF9fZmFsc2VfdHlwZSgpKTsgfQoj
IDUzMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0b3IuaCIgMwogICAgICB2
b2lkCiAgICAgIGFzc2lnbihpbml0aWFsaXplcl9saXN0PHZhbHVlX3R5cGU+IF9fbCkKICAgICAg
eyB0aGlzLT5hc3NpZ24oX19sLmJlZ2luKCksIF9fbC5lbmQoKSk7IH0KCgoKICAgICAgdXNpbmcg
X0Jhc2U6OmdldF9hbGxvY2F0b3I7CgoKCgoKCgogICAgICBpdGVyYXRvcgogICAgICBiZWdpbigp
IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGl0ZXJhdG9yKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQp
OyB9CgoKCgoKCiAgICAgIGNvbnN0X2l0ZXJhdG9yCiAgICAgIGJlZ2luKCkgY29uc3Qgbm9leGNl
cHQKICAgICAgeyByZXR1cm4gY29uc3RfaXRlcmF0b3IodGhpcy0+X01faW1wbC5fTV9zdGFydCk7
IH0KCgoKCgoKICAgICAgaXRlcmF0b3IKICAgICAgZW5kKCkgbm9leGNlcHQKICAgICAgeyByZXR1
cm4gaXRlcmF0b3IodGhpcy0+X01faW1wbC5fTV9maW5pc2gpOyB9CgoKCgoKCiAgICAgIGNvbnN0
X2l0ZXJhdG9yCiAgICAgIGVuZCgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGNvbnN0
X2l0ZXJhdG9yKHRoaXMtPl9NX2ltcGwuX01fZmluaXNoKTsgfQoKCgoKCgogICAgICByZXZlcnNl
X2l0ZXJhdG9yCiAgICAgIHJiZWdpbigpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHJldmVyc2Vf
aXRlcmF0b3IoZW5kKCkpOyB9CgoKCgoKCiAgICAgIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAg
ICAgcmJlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gY29uc3RfcmV2ZXJzZV9p
dGVyYXRvcihlbmQoKSk7IH0KCgoKCgoKICAgICAgcmV2ZXJzZV9pdGVyYXRvcgogICAgICByZW5k
KCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4gcmV2ZXJzZV9pdGVyYXRvcihiZWdpbigpKTsgfQoK
CgoKCgogICAgICBjb25zdF9yZXZlcnNlX2l0ZXJhdG9yCiAgICAgIHJlbmQoKSBjb25zdCBub2V4
Y2VwdAogICAgICB7IHJldHVybiBjb25zdF9yZXZlcnNlX2l0ZXJhdG9yKGJlZ2luKCkpOyB9CgoK
CgoKCgogICAgICBjb25zdF9pdGVyYXRvcgogICAgICBjYmVnaW4oKSBjb25zdCBub2V4Y2VwdAog
ICAgICB7IHJldHVybiBjb25zdF9pdGVyYXRvcih0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0KTsgfQoK
CgoKCgogICAgICBjb25zdF9pdGVyYXRvcgogICAgICBjZW5kKCkgY29uc3Qgbm9leGNlcHQKICAg
ICAgeyByZXR1cm4gY29uc3RfaXRlcmF0b3IodGhpcy0+X01faW1wbC5fTV9maW5pc2gpOyB9CgoK
CgoKCiAgICAgIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAgICAgY3JiZWdpbigpIGNvbnN0IG5v
ZXhjZXB0CiAgICAgIHsgcmV0dXJuIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IoZW5kKCkpOyB9CgoK
CgoKCiAgICAgIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAgICAgY3JlbmQoKSBjb25zdCBub2V4
Y2VwdAogICAgICB7IHJldHVybiBjb25zdF9yZXZlcnNlX2l0ZXJhdG9yKGJlZ2luKCkpOyB9CgoK
CgogICAgICBzaXplX3R5cGUKICAgICAgc2l6ZSgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0
dXJuIHNpemVfdHlwZSh0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCAtIHRoaXMtPl9NX2ltcGwuX01f
c3RhcnQpOyB9CgoKICAgICAgc2l6ZV90eXBlCiAgICAgIG1heF9zaXplKCkgY29uc3Qgbm9leGNl
cHQKICAgICAgeyByZXR1cm4gX0FsbG9jX3RyYWl0czo6bWF4X3NpemUoX01fZ2V0X1RwX2FsbG9j
YXRvcigpKTsgfQojIDY3MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0b3Iu
aCIgMwogICAgICB2b2lkCiAgICAgIHJlc2l6ZShzaXplX3R5cGUgX19uZXdfc2l6ZSkKICAgICAg
ewogaWYgKF9fbmV3X3NpemUgPiBzaXplKCkpCiAgIF9NX2RlZmF1bHRfYXBwZW5kKF9fbmV3X3Np
emUgLSBzaXplKCkpOwogZWxzZSBpZiAoX19uZXdfc2l6ZSA8IHNpemUoKSkKICAgX01fZXJhc2Vf
YXRfZW5kKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQgKyBfX25ld19zaXplKTsKICAgICAgfQojIDY5
MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0b3IuaCIgMwogICAgICB2b2lk
CiAgICAgIHJlc2l6ZShzaXplX3R5cGUgX19uZXdfc2l6ZSwgY29uc3QgdmFsdWVfdHlwZSYgX194
KQogICAgICB7CiBpZiAoX19uZXdfc2l6ZSA+IHNpemUoKSkKICAgaW5zZXJ0KGVuZCgpLCBfX25l
d19zaXplIC0gc2l6ZSgpLCBfX3gpOwogZWxzZSBpZiAoX19uZXdfc2l6ZSA8IHNpemUoKSkKICAg
X01fZXJhc2VfYXRfZW5kKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQgKyBfX25ld19zaXplKTsKICAg
ICAgfQojIDcyNSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0b3IuaCIgMwog
ICAgICB2b2lkCiAgICAgIHNocmlua190b19maXQoKQogICAgICB7IF9NX3Nocmlua190b19maXQo
KTsgfQoKCgoKCgogICAgICBzaXplX3R5cGUKICAgICAgY2FwYWNpdHkoKSBjb25zdCBub2V4Y2Vw
dAogICAgICB7IHJldHVybiBzaXplX3R5cGUodGhpcy0+X01faW1wbC5fTV9lbmRfb2Zfc3RvcmFn
ZQogICAgLSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0KTsgfQoKCgoKCiAgICAgIGJvb2wKICAgICAg
ZW1wdHkoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBiZWdpbigpID09IGVuZCgpOyB9
CiMgNzY0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3ZlY3Rvci5oIiAzCiAgICAg
IHZvaWQKICAgICAgcmVzZXJ2ZShzaXplX3R5cGUgX19uKTsKIyA3NzkgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvYml0cy9zdGxfdmVjdG9yLmgiIDMKICAgICAgcmVmZXJlbmNlCiAgICAgIG9wZXJh
dG9yW10oc2l6ZV90eXBlIF9fbikgbm9leGNlcHQKICAgICAgeyByZXR1cm4gKih0aGlzLT5fTV9p
bXBsLl9NX3N0YXJ0ICsgX19uKTsgfQojIDc5NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRz
L3N0bF92ZWN0b3IuaCIgMwogICAgICBjb25zdF9yZWZlcmVuY2UKICAgICAgb3BlcmF0b3JbXShz
aXplX3R5cGUgX19uKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiAqKHRoaXMtPl9NX2lt
cGwuX01fc3RhcnQgKyBfX24pOyB9CgogICAgcHJvdGVjdGVkOgoKICAgICAgdm9pZAogICAgICBf
TV9yYW5nZV9jaGVjayhzaXplX3R5cGUgX19uKSBjb25zdAogICAgICB7CiBpZiAoX19uID49IHRo
aXMtPnNpemUoKSkKICAgX190aHJvd19vdXRfb2ZfcmFuZ2VfZm10KCgidmVjdG9yOjpfTV9yYW5n
ZV9jaGVjazogX19uICIgIih3aGljaCBpcyAlenUpID49IHRoaXMtPnNpemUoKSAiICIod2hpY2gg
aXMgJXp1KSIpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLAogICAgICAgX19uLCB0aGlz
LT5zaXplKCkpOwogICAgICB9CgogICAgcHVibGljOgojIDgyMiAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3N0bF92ZWN0b3IuaCIgMwogICAgICByZWZlcmVuY2UKICAgICAgYXQoc2l6ZV90
eXBlIF9fbikKICAgICAgewogX01fcmFuZ2VfY2hlY2soX19uKTsKIHJldHVybiAoKnRoaXMpW19f
bl07CiAgICAgIH0KIyA4NDAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfdmVjdG9y
LmgiIDMKICAgICAgY29uc3RfcmVmZXJlbmNlCiAgICAgIGF0KHNpemVfdHlwZSBfX24pIGNvbnN0
CiAgICAgIHsKIF9NX3JhbmdlX2NoZWNrKF9fbik7CiByZXR1cm4gKCp0aGlzKVtfX25dOwogICAg
ICB9CgoKCgoKICAgICAgcmVmZXJlbmNlCiAgICAgIGZyb250KCkgbm9leGNlcHQKICAgICAgeyBy
ZXR1cm4gKmJlZ2luKCk7IH0KCgoKCgogICAgICBjb25zdF9yZWZlcmVuY2UKICAgICAgZnJvbnQo
KSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiAqYmVnaW4oKTsgfQoKCgoKCiAgICAgIHJl
ZmVyZW5jZQogICAgICBiYWNrKCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4gKihlbmQoKSAtIDEp
OyB9CgoKCgoKICAgICAgY29uc3RfcmVmZXJlbmNlCiAgICAgIGJhY2soKSBjb25zdCBub2V4Y2Vw
dAogICAgICB7IHJldHVybiAqKGVuZCgpIC0gMSk7IH0KIyA4ODcgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9zdGxfdmVjdG9yLmgiIDMKICAgICAgX1RwKgoKCgogICAgICBkYXRhKCkgbm9l
eGNlcHQKICAgICAgeyByZXR1cm4gX01fZGF0YV9wdHIodGhpcy0+X01faW1wbC5fTV9zdGFydCk7
IH0KCgogICAgICBjb25zdCBfVHAqCgoKCiAgICAgIGRhdGEoKSBjb25zdCBub2V4Y2VwdAogICAg
ICB7IHJldHVybiBfTV9kYXRhX3B0cih0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0KTsgfQojIDkxMyAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0b3IuaCIgMwogICAgICB2b2lkCiAg
ICAgIHB1c2hfYmFjayhjb25zdCB2YWx1ZV90eXBlJiBfX3gpCiAgICAgIHsKIGlmICh0aGlzLT5f
TV9pbXBsLl9NX2ZpbmlzaCAhPSB0aGlzLT5fTV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdlKQogICB7
CiAgICAgX0FsbG9jX3RyYWl0czo6Y29uc3RydWN0KHRoaXMtPl9NX2ltcGwsIHRoaXMtPl9NX2lt
cGwuX01fZmluaXNoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX3gpOwogICAgICsr
dGhpcy0+X01faW1wbC5fTV9maW5pc2g7CiAgIH0KIGVsc2UKCiAgIF9NX2VtcGxhY2VfYmFja19h
dXgoX194KTsKCgoKICAgICAgfQoKCiAgICAgIHZvaWQKICAgICAgcHVzaF9iYWNrKHZhbHVlX3R5
cGUmJiBfX3gpCiAgICAgIHsgZW1wbGFjZV9iYWNrKHN0ZDo6bW92ZShfX3gpKTsgfQoKICAgICAg
dGVtcGxhdGU8dHlwZW5hbWUuLi4gX0FyZ3M+CiAgICAgICAgdm9pZAogICAgICAgIGVtcGxhY2Vf
YmFjayhfQXJncyYmLi4uIF9fYXJncyk7CiMgOTQ5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX3ZlY3Rvci5oIiAzCiAgICAgIHZvaWQKICAgICAgcG9wX2JhY2soKSBub2V4Y2VwdAog
ICAgICB7CiAtLXRoaXMtPl9NX2ltcGwuX01fZmluaXNoOwogX0FsbG9jX3RyYWl0czo6ZGVzdHJv
eSh0aGlzLT5fTV9pbXBsLCB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCk7CiAgICAgIH0KIyA5Njkg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfdmVjdG9yLmgiIDMKICAgICAgdGVtcGxh
dGU8dHlwZW5hbWUuLi4gX0FyZ3M+CiAgICAgICAgaXRlcmF0b3IKICAgICAgICBlbXBsYWNlKGNv
bnN0X2l0ZXJhdG9yIF9fcG9zaXRpb24sIF9BcmdzJiYuLi4gX19hcmdzKTsKIyA5ODQgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfdmVjdG9yLmgiIDMKICAgICAgaXRlcmF0b3IKICAg
ICAgaW5zZXJ0KGNvbnN0X2l0ZXJhdG9yIF9fcG9zaXRpb24sIGNvbnN0IHZhbHVlX3R5cGUmIF9f
eCk7CiMgMTAxNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0b3IuaCIgMwog
ICAgICBpdGVyYXRvcgogICAgICBpbnNlcnQoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgdmFs
dWVfdHlwZSYmIF9feCkKICAgICAgeyByZXR1cm4gZW1wbGFjZShfX3Bvc2l0aW9uLCBzdGQ6Om1v
dmUoX194KSk7IH0KIyAxMDMxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3ZlY3Rv
ci5oIiAzCiAgICAgIGl0ZXJhdG9yCiAgICAgIGluc2VydChjb25zdF9pdGVyYXRvciBfX3Bvc2l0
aW9uLCBpbml0aWFsaXplcl9saXN0PHZhbHVlX3R5cGU+IF9fbCkKICAgICAgeyByZXR1cm4gdGhp
cy0+aW5zZXJ0KF9fcG9zaXRpb24sIF9fbC5iZWdpbigpLCBfX2wuZW5kKCkpOyB9CiMgMTA1MSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0b3IuaCIgMwogICAgICBpdGVyYXRv
cgogICAgICBpbnNlcnQoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgc2l6ZV90eXBlIF9fbiwg
Y29uc3QgdmFsdWVfdHlwZSYgX194KQogICAgICB7CiBkaWZmZXJlbmNlX3R5cGUgX19vZmZzZXQg
PSBfX3Bvc2l0aW9uIC0gY2JlZ2luKCk7CiBfTV9maWxsX2luc2VydChiZWdpbigpICsgX19vZmZz
ZXQsIF9fbiwgX194KTsKIHJldHVybiBiZWdpbigpICsgX19vZmZzZXQ7CiAgICAgIH0KIyAxMDkz
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3ZlY3Rvci5oIiAzCiAgICAgIHRlbXBs
YXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLAogICAgICAgIHR5cGVuYW1lID0gc3RkOjpfUmVx
dWlyZUlucHV0SXRlcjxfSW5wdXRJdGVyYXRvcj4+CiAgICAgICAgaXRlcmF0b3IKICAgICAgICBp
bnNlcnQoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgX0lucHV0SXRlcmF0b3IgX19maXJzdCwK
ICAgICAgICBfSW5wdXRJdGVyYXRvciBfX2xhc3QpCiAgICAgICAgewogICBkaWZmZXJlbmNlX3R5
cGUgX19vZmZzZXQgPSBfX3Bvc2l0aW9uIC0gY2JlZ2luKCk7CiAgIF9NX2luc2VydF9kaXNwYXRj
aChiZWdpbigpICsgX19vZmZzZXQsCiAgICAgICAgX19maXJzdCwgX19sYXN0LCBfX2ZhbHNlX3R5
cGUoKSk7CiAgIHJldHVybiBiZWdpbigpICsgX19vZmZzZXQ7CiB9CiMgMTE0NSAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0b3IuaCIgMwogICAgICBpdGVyYXRvcgoKICAgICAg
ZXJhc2UoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbikKICAgICAgeyByZXR1cm4gX01fZXJhc2Uo
YmVnaW4oKSArIChfX3Bvc2l0aW9uIC0gY2JlZ2luKCkpKTsgfQojIDExNzIgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYml0cy9zdGxfdmVjdG9yLmgiIDMKICAgICAgaXRlcmF0b3IKCiAgICAgIGVy
YXNlKGNvbnN0X2l0ZXJhdG9yIF9fZmlyc3QsIGNvbnN0X2l0ZXJhdG9yIF9fbGFzdCkKICAgICAg
ewogY29uc3QgYXV0byBfX2JlZyA9IGJlZ2luKCk7CiBjb25zdCBhdXRvIF9fY2JlZyA9IGNiZWdp
bigpOwogcmV0dXJuIF9NX2VyYXNlKF9fYmVnICsgKF9fZmlyc3QgLSBfX2NiZWcpLCBfX2JlZyAr
IChfX2xhc3QgLSBfX2NiZWcpKTsKICAgICAgfQojIDExOTQgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9zdGxfdmVjdG9yLmgiIDMKICAgICAgdm9pZAogICAgICBzd2FwKHZlY3RvciYgX194
KSBub2V4Y2VwdAogICAgICB7CiB0aGlzLT5fTV9pbXBsLl9NX3N3YXBfZGF0YShfX3guX01faW1w
bCk7CiBfQWxsb2NfdHJhaXRzOjpfU19vbl9zd2FwKF9NX2dldF9UcF9hbGxvY2F0b3IoKSwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgX194Ll9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICAg
IH0KCgoKCgoKCiAgICAgIHZvaWQKICAgICAgY2xlYXIoKSBub2V4Y2VwdAogICAgICB7IF9NX2Vy
YXNlX2F0X2VuZCh0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0KTsgfQoKICAgIHByb3RlY3RlZDoKCgoK
CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3I+CiAgICAgICAgcG9pbnRl
cgogICAgICAgIF9NX2FsbG9jYXRlX2FuZF9jb3B5KHNpemVfdHlwZSBfX24sCiAgICAgICAgX0Zv
cndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCkKICAgICAgICB7
CiAgIHBvaW50ZXIgX19yZXN1bHQgPSB0aGlzLT5fTV9hbGxvY2F0ZShfX24pOwogICB0cnkKICAg
ICB7CiAgICAgICBzdGQ6Ol9fdW5pbml0aWFsaXplZF9jb3B5X2EoX19maXJzdCwgX19sYXN0LCBf
X3Jlc3VsdCwKICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgICByZXR1cm4gX19y
ZXN1bHQ7CiAgICAgfQogICBjYXRjaCguLi4pCiAgICAgewogICAgICAgX01fZGVhbGxvY2F0ZShf
X3Jlc3VsdCwgX19uKTsKICAgICAgIHRocm93OwogICAgIH0KIH0KIyAxMjQzICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3ZlY3Rvci5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9JbnRlZ2VyPgogICAgICAgIHZvaWQKICAgICAgICBfTV9pbml0aWFsaXplX2Rpc3BhdGNoKF9J
bnRlZ2VyIF9fbiwgX0ludGVnZXIgX192YWx1ZSwgX190cnVlX3R5cGUpCiAgICAgICAgewogICB0
aGlzLT5fTV9pbXBsLl9NX3N0YXJ0ID0gX01fYWxsb2NhdGUoc3RhdGljX2Nhc3Q8c2l6ZV90eXBl
PihfX24pKTsKICAgdGhpcy0+X01faW1wbC5fTV9lbmRfb2Zfc3RvcmFnZSA9CiAgICAgdGhpcy0+
X01faW1wbC5fTV9zdGFydCArIHN0YXRpY19jYXN0PHNpemVfdHlwZT4oX19uKTsKICAgX01fZmls
bF9pbml0aWFsaXplKHN0YXRpY19jYXN0PHNpemVfdHlwZT4oX19uKSwgX192YWx1ZSk7CiB9CgoK
ICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3I+CiAgICAgICAgdm9pZAogICAg
ICAgIF9NX2luaXRpYWxpemVfZGlzcGF0Y2goX0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0
SXRlcmF0b3IgX19sYXN0LAogICAgICAgICAgX19mYWxzZV90eXBlKQogICAgICAgIHsKICAgdHlw
ZWRlZiB0eXBlbmFtZSBzdGQ6Oml0ZXJhdG9yX3RyYWl0czxfSW5wdXRJdGVyYXRvcj46OgogICAg
IGl0ZXJhdG9yX2NhdGVnb3J5IF9JdGVyQ2F0ZWdvcnk7CiAgIF9NX3JhbmdlX2luaXRpYWxpemUo
X19maXJzdCwgX19sYXN0LCBfSXRlckNhdGVnb3J5KCkpOwogfQoKCiAgICAgIHRlbXBsYXRlPHR5
cGVuYW1lIF9JbnB1dEl0ZXJhdG9yPgogICAgICAgIHZvaWQKICAgICAgICBfTV9yYW5nZV9pbml0
aWFsaXplKF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsCiAgICAgICBfSW5wdXRJdGVyYXRvciBfX2xh
c3QsIHN0ZDo6aW5wdXRfaXRlcmF0b3JfdGFnKQogICAgICAgIHsKICAgZm9yICg7IF9fZmlyc3Qg
IT0gX19sYXN0OyArK19fZmlyc3QpCgogICAgIGVtcGxhY2VfYmFjaygqX19maXJzdCk7CgoKCiB9
CgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvcj4KICAgICAgICB2b2lk
CiAgICAgICAgX01fcmFuZ2VfaW5pdGlhbGl6ZShfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsCiAg
ICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwgc3RkOjpmb3J3YXJkX2l0ZXJhdG9yX3RhZykK
ICAgICAgICB7CiAgIGNvbnN0IHNpemVfdHlwZSBfX24gPSBzdGQ6OmRpc3RhbmNlKF9fZmlyc3Qs
IF9fbGFzdCk7CiAgIHRoaXMtPl9NX2ltcGwuX01fc3RhcnQgPSB0aGlzLT5fTV9hbGxvY2F0ZShf
X24pOwogICB0aGlzLT5fTV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdlID0gdGhpcy0+X01faW1wbC5f
TV9zdGFydCArIF9fbjsKICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2ggPQogICAgIHN0ZDo6X191
bmluaXRpYWxpemVkX2NvcHlfYShfX2ZpcnN0LCBfX2xhc3QsCiAgICAgdGhpcy0+X01faW1wbC5f
TV9zdGFydCwKICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogfQoKCgogICAgICB2b2lkCiAg
ICAgIF9NX2ZpbGxfaW5pdGlhbGl6ZShzaXplX3R5cGUgX19uLCBjb25zdCB2YWx1ZV90eXBlJiBf
X3ZhbHVlKQogICAgICB7CiB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCA9CiAgIHN0ZDo6X191bmlu
aXRpYWxpemVkX2ZpbGxfbl9hKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQsIF9fbiwgX192YWx1ZSwK
ICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgICB9CgoKCiAgICAgIHZvaWQKICAgICAg
X01fZGVmYXVsdF9pbml0aWFsaXplKHNpemVfdHlwZSBfX24pCiAgICAgIHsKIHRoaXMtPl9NX2lt
cGwuX01fZmluaXNoID0KICAgc3RkOjpfX3VuaW5pdGlhbGl6ZWRfZGVmYXVsdF9uX2EodGhpcy0+
X01faW1wbC5fTV9zdGFydCwgX19uLAogICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAg
ICAgIH0KIyAxMzIxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3ZlY3Rvci5oIiAz
CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnRlZ2VyPgogICAgICAgIHZvaWQKICAgICAgICBf
TV9hc3NpZ25fZGlzcGF0Y2goX0ludGVnZXIgX19uLCBfSW50ZWdlciBfX3ZhbCwgX190cnVlX3R5
cGUpCiAgICAgICAgeyBfTV9maWxsX2Fzc2lnbihfX24sIF9fdmFsKTsgfQoKCiAgICAgIHRlbXBs
YXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yPgogICAgICAgIHZvaWQKICAgICAgICBfTV9hc3Np
Z25fZGlzcGF0Y2goX0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0
LAogICAgICBfX2ZhbHNlX3R5cGUpCiAgICAgICAgewogICB0eXBlZGVmIHR5cGVuYW1lIHN0ZDo6
aXRlcmF0b3JfdHJhaXRzPF9JbnB1dEl0ZXJhdG9yPjo6CiAgICAgaXRlcmF0b3JfY2F0ZWdvcnkg
X0l0ZXJDYXRlZ29yeTsKICAgX01fYXNzaWduX2F1eChfX2ZpcnN0LCBfX2xhc3QsIF9JdGVyQ2F0
ZWdvcnkoKSk7CiB9CgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3I+CiAg
ICAgICAgdm9pZAogICAgICAgIF9NX2Fzc2lnbl9hdXgoX0lucHV0SXRlcmF0b3IgX19maXJzdCwg
X0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgICAgIHN0ZDo6aW5wdXRfaXRlcmF0b3JfdGFnKTsK
CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yPgogICAgICAgIHZvaWQK
ICAgICAgICBfTV9hc3NpZ25fYXV4KF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJ
dGVyYXRvciBfX2xhc3QsCiAgICAgICAgc3RkOjpmb3J3YXJkX2l0ZXJhdG9yX3RhZyk7CgoKCiAg
ICAgIHZvaWQKICAgICAgX01fZmlsbF9hc3NpZ24oc2l6ZV90eXBlIF9fbiwgY29uc3QgdmFsdWVf
dHlwZSYgX192YWwpOwojIDEzNjEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfdmVj
dG9yLmgiIDMKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0ludGVnZXI+CiAgICAgICAgdm9pZAog
ICAgICAgIF9NX2luc2VydF9kaXNwYXRjaChpdGVyYXRvciBfX3BvcywgX0ludGVnZXIgX19uLCBf
SW50ZWdlciBfX3ZhbCwKICAgICAgX190cnVlX3R5cGUpCiAgICAgICAgeyBfTV9maWxsX2luc2Vy
dChfX3BvcywgX19uLCBfX3ZhbCk7IH0KCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJ
dGVyYXRvcj4KICAgICAgICB2b2lkCiAgICAgICAgX01faW5zZXJ0X2Rpc3BhdGNoKGl0ZXJhdG9y
IF9fcG9zLCBfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LAogICAgICBfSW5wdXRJdGVyYXRvciBfX2xh
c3QsIF9fZmFsc2VfdHlwZSkKICAgICAgICB7CiAgIHR5cGVkZWYgdHlwZW5hbWUgc3RkOjppdGVy
YXRvcl90cmFpdHM8X0lucHV0SXRlcmF0b3I+OjoKICAgICBpdGVyYXRvcl9jYXRlZ29yeSBfSXRl
ckNhdGVnb3J5OwogICBfTV9yYW5nZV9pbnNlcnQoX19wb3MsIF9fZmlyc3QsIF9fbGFzdCwgX0l0
ZXJDYXRlZ29yeSgpKTsKIH0KCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRv
cj4KICAgICAgICB2b2lkCiAgICAgICAgX01fcmFuZ2VfaW5zZXJ0KGl0ZXJhdG9yIF9fcG9zLCBf
SW5wdXRJdGVyYXRvciBfX2ZpcnN0LAogICBfSW5wdXRJdGVyYXRvciBfX2xhc3QsIHN0ZDo6aW5w
dXRfaXRlcmF0b3JfdGFnKTsKCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJh
dG9yPgogICAgICAgIHZvaWQKICAgICAgICBfTV9yYW5nZV9pbnNlcnQoaXRlcmF0b3IgX19wb3Ms
IF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwKICAgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QsIHN0
ZDo6Zm9yd2FyZF9pdGVyYXRvcl90YWcpOwoKCgogICAgICB2b2lkCiAgICAgIF9NX2ZpbGxfaW5z
ZXJ0KGl0ZXJhdG9yIF9fcG9zLCBzaXplX3R5cGUgX19uLCBjb25zdCB2YWx1ZV90eXBlJiBfX3gp
OwoKCgogICAgICB2b2lkCiAgICAgIF9NX2RlZmF1bHRfYXBwZW5kKHNpemVfdHlwZSBfX24pOwoK
ICAgICAgYm9vbAogICAgICBfTV9zaHJpbmtfdG9fZml0KCk7CgoKCgoKCgogICAgICB0ZW1wbGF0
ZTx0eXBlbmFtZS4uLiBfQXJncz4KICAgICAgICB2b2lkCiAgICAgICAgX01faW5zZXJ0X2F1eChp
dGVyYXRvciBfX3Bvc2l0aW9uLCBfQXJncyYmLi4uIF9fYXJncyk7CgogICAgICB0ZW1wbGF0ZTx0
eXBlbmFtZS4uLiBfQXJncz4KICAgICAgICB2b2lkCiAgICAgICAgX01fZW1wbGFjZV9iYWNrX2F1
eChfQXJncyYmLi4uIF9fYXJncyk7CgoKCiAgICAgIHNpemVfdHlwZQogICAgICBfTV9jaGVja19s
ZW4oc2l6ZV90eXBlIF9fbiwgY29uc3QgY2hhciogX19zKSBjb25zdAogICAgICB7CiBpZiAobWF4
X3NpemUoKSAtIHNpemUoKSA8IF9fbikKICAgX190aHJvd19sZW5ndGhfZXJyb3IoKF9fcykpOwoK
IGNvbnN0IHNpemVfdHlwZSBfX2xlbiA9IHNpemUoKSArIHN0ZDo6bWF4KHNpemUoKSwgX19uKTsK
IHJldHVybiAoX19sZW4gPCBzaXplKCkgfHwgX19sZW4gPiBtYXhfc2l6ZSgpKSA/IG1heF9zaXpl
KCkgOiBfX2xlbjsKICAgICAgfQoKCgoKCiAgICAgIHZvaWQKICAgICAgX01fZXJhc2VfYXRfZW5k
KHBvaW50ZXIgX19wb3MpIG5vZXhjZXB0CiAgICAgIHsKIHN0ZDo6X0Rlc3Ryb3koX19wb3MsIHRo
aXMtPl9NX2ltcGwuX01fZmluaXNoLCBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogdGhpcy0+X01f
aW1wbC5fTV9maW5pc2ggPSBfX3BvczsKICAgICAgfQoKICAgICAgaXRlcmF0b3IKICAgICAgX01f
ZXJhc2UoaXRlcmF0b3IgX19wb3NpdGlvbik7CgogICAgICBpdGVyYXRvcgogICAgICBfTV9lcmFz
ZShpdGVyYXRvciBfX2ZpcnN0LCBpdGVyYXRvciBfX2xhc3QpOwoKCiAgICBwcml2YXRlOgoKCgog
ICAgICB2b2lkCiAgICAgIF9NX21vdmVfYXNzaWduKHZlY3RvciYmIF9feCwgc3RkOjp0cnVlX3R5
cGUpIG5vZXhjZXB0CiAgICAgIHsKIHZlY3RvciBfX3RtcChnZXRfYWxsb2NhdG9yKCkpOwogdGhp
cy0+X01faW1wbC5fTV9zd2FwX2RhdGEoX190bXAuX01faW1wbCk7CiB0aGlzLT5fTV9pbXBsLl9N
X3N3YXBfZGF0YShfX3guX01faW1wbCk7CiBzdGQ6Ol9fYWxsb2Nfb25fbW92ZShfTV9nZXRfVHBf
YWxsb2NhdG9yKCksIF9feC5fTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgICB9CgoKCiAgICAg
IHZvaWQKICAgICAgX01fbW92ZV9hc3NpZ24odmVjdG9yJiYgX194LCBzdGQ6OmZhbHNlX3R5cGUp
CiAgICAgIHsKIGlmIChfX3guX01fZ2V0X1RwX2FsbG9jYXRvcigpID09IHRoaXMtPl9NX2dldF9U
cF9hbGxvY2F0b3IoKSkKICAgX01fbW92ZV9hc3NpZ24oc3RkOjptb3ZlKF9feCksIHN0ZDo6dHJ1
ZV90eXBlKCkpOwogZWxzZQogICB7CgoKICAgICB0aGlzLT5hc3NpZ24oc3RkOjpfX21ha2VfbW92
ZV9pZl9ub2V4Y2VwdF9pdGVyYXRvcihfX3guYmVnaW4oKSksCiAgICBzdGQ6Ol9fbWFrZV9tb3Zl
X2lmX25vZXhjZXB0X2l0ZXJhdG9yKF9feC5lbmQoKSkpOwogICAgIF9feC5jbGVhcigpOwogICB9
CiAgICAgIH0KCgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1VwPgogX1VwKgogX01fZGF0YV9w
dHIoX1VwKiBfX3B0cikgY29uc3QKIHsgcmV0dXJuIF9fcHRyOyB9CgogICAgICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfUHRyPgogdHlwZW5hbWUgc3RkOjpwb2ludGVyX3RyYWl0czxfUHRyPjo6ZWxlbWVu
dF90eXBlKgogX01fZGF0YV9wdHIoX1B0ciBfX3B0cikgY29uc3QKIHsgcmV0dXJuIGVtcHR5KCkg
PyBudWxscHRyIDogc3RkOjpfX2FkZHJlc3NvZigqX19wdHIpOyB9CgoKCgoKCiAgICB9OwojIDE1
MDcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfdmVjdG9yLmgiIDMKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVy
YXRvcj09KGNvbnN0IHZlY3RvcjxfVHAsIF9BbGxvYz4mIF9feCwgY29uc3QgdmVjdG9yPF9UcCwg
X0FsbG9jPiYgX195KQogICAgeyByZXR1cm4gKF9feC5zaXplKCkgPT0gX195LnNpemUoKQogICAg
ICAgJiYgc3RkOjplcXVhbChfX3guYmVnaW4oKSwgX194LmVuZCgpLCBfX3kuYmVnaW4oKSkpOyB9
CiMgMTUyNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF92ZWN0b3IuaCIgMwogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIGJvb2wKICAg
IG9wZXJhdG9yPChjb25zdCB2ZWN0b3I8X1RwLCBfQWxsb2M+JiBfX3gsIGNvbnN0IHZlY3Rvcjxf
VHAsIF9BbGxvYz4mIF9feSkKICAgIHsgcmV0dXJuIHN0ZDo6bGV4aWNvZ3JhcGhpY2FsX2NvbXBh
cmUoX194LmJlZ2luKCksIF9feC5lbmQoKSwKICAgICAgIF9feS5iZWdpbigpLCBfX3kuZW5kKCkp
OyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGlu
ZSBib29sCiAgICBvcGVyYXRvciE9KGNvbnN0IHZlY3RvcjxfVHAsIF9BbGxvYz4mIF9feCwgY29u
c3QgdmVjdG9yPF9UcCwgX0FsbG9jPiYgX195KQogICAgeyByZXR1cm4gIShfX3ggPT0gX195KTsg
fQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUg
Ym9vbAogICAgb3BlcmF0b3I+KGNvbnN0IHZlY3RvcjxfVHAsIF9BbGxvYz4mIF9feCwgY29uc3Qg
dmVjdG9yPF9UcCwgX0FsbG9jPiYgX195KQogICAgeyByZXR1cm4gX195IDwgX194OyB9CgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAg
ICBvcGVyYXRvcjw9KGNvbnN0IHZlY3RvcjxfVHAsIF9BbGxvYz4mIF9feCwgY29uc3QgdmVjdG9y
PF9UcCwgX0FsbG9jPiYgX195KQogICAgeyByZXR1cm4gIShfX3kgPCBfX3gpOyB9CgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBv
cGVyYXRvcj49KGNvbnN0IHZlY3RvcjxfVHAsIF9BbGxvYz4mIF9feCwgY29uc3QgdmVjdG9yPF9U
cCwgX0FsbG9jPiYgX195KQogICAgeyByZXR1cm4gIShfX3ggPCBfX3kpOyB9CgoKICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSB2b2lkCiAgICBzd2Fw
KHZlY3RvcjxfVHAsIF9BbGxvYz4mIF9feCwgdmVjdG9yPF9UcCwgX0FsbG9jPiYgX195KQogICAg
bm9leGNlcHQobm9leGNlcHQoX194LnN3YXAoX195KSkpCiAgICB7IF9feC5zd2FwKF9feSk7IH0K
Cgp9CiMgNjUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdmVjdG9yIiAyIDMKIyAxICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2J2ZWN0b3IuaCIgMSAzCiMgNjMgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYml0cy9zdGxfYnZlY3Rvci5oIiAzCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1
dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCiAgdHlwZWRlZiB1bnNpZ25l
ZCBsb25nIF9CaXRfdHlwZTsKICBlbnVtIHsgX1Nfd29yZF9iaXQgPSBpbnQoOCAqIHNpemVvZihf
Qml0X3R5cGUpKSB9OwoKICBzdHJ1Y3QgX0JpdF9yZWZlcmVuY2UKICB7CiAgICBfQml0X3R5cGUg
KiBfTV9wOwogICAgX0JpdF90eXBlIF9NX21hc2s7CgogICAgX0JpdF9yZWZlcmVuY2UoX0JpdF90
eXBlICogX194LCBfQml0X3R5cGUgX195KQogICAgOiBfTV9wKF9feCksIF9NX21hc2soX195KSB7
IH0KCiAgICBfQml0X3JlZmVyZW5jZSgpIG5vZXhjZXB0IDogX01fcCgwKSwgX01fbWFzaygwKSB7
IH0KCiAgICBvcGVyYXRvciBib29sKCkgY29uc3Qgbm9leGNlcHQKICAgIHsgcmV0dXJuICEhKCpf
TV9wICYgX01fbWFzayk7IH0KCiAgICBfQml0X3JlZmVyZW5jZSYKICAgIG9wZXJhdG9yPShib29s
IF9feCkgbm9leGNlcHQKICAgIHsKICAgICAgaWYgKF9feCkKICpfTV9wIHw9IF9NX21hc2s7CiAg
ICAgIGVsc2UKICpfTV9wICY9IH5fTV9tYXNrOwogICAgICByZXR1cm4gKnRoaXM7CiAgICB9Cgog
ICAgX0JpdF9yZWZlcmVuY2UmCiAgICBvcGVyYXRvcj0oY29uc3QgX0JpdF9yZWZlcmVuY2UmIF9f
eCkgbm9leGNlcHQKICAgIHsgcmV0dXJuICp0aGlzID0gYm9vbChfX3gpOyB9CgogICAgYm9vbAog
ICAgb3BlcmF0b3I9PShjb25zdCBfQml0X3JlZmVyZW5jZSYgX194KSBjb25zdAogICAgeyByZXR1
cm4gYm9vbCgqdGhpcykgPT0gYm9vbChfX3gpOyB9CgogICAgYm9vbAogICAgb3BlcmF0b3I8KGNv
bnN0IF9CaXRfcmVmZXJlbmNlJiBfX3gpIGNvbnN0CiAgICB7IHJldHVybiAhYm9vbCgqdGhpcykg
JiYgYm9vbChfX3gpOyB9CgogICAgdm9pZAogICAgZmxpcCgpIG5vZXhjZXB0CiAgICB7ICpfTV9w
IF49IF9NX21hc2s7IH0KICB9OwoKCiAgaW5saW5lIHZvaWQKICBzd2FwKF9CaXRfcmVmZXJlbmNl
IF9feCwgX0JpdF9yZWZlcmVuY2UgX195KSBub2V4Y2VwdAogIHsKICAgIGJvb2wgX190bXAgPSBf
X3g7CiAgICBfX3ggPSBfX3k7CiAgICBfX3kgPSBfX3RtcDsKICB9CgogIGlubGluZSB2b2lkCiAg
c3dhcChfQml0X3JlZmVyZW5jZSBfX3gsIGJvb2wmIF9feSkgbm9leGNlcHQKICB7CiAgICBib29s
IF9fdG1wID0gX194OwogICAgX194ID0gX195OwogICAgX195ID0gX190bXA7CiAgfQoKICBpbmxp
bmUgdm9pZAogIHN3YXAoYm9vbCYgX194LCBfQml0X3JlZmVyZW5jZSBfX3kpIG5vZXhjZXB0CiAg
ewogICAgYm9vbCBfX3RtcCA9IF9feDsKICAgIF9feCA9IF9feTsKICAgIF9feSA9IF9fdG1wOwog
IH0KCgogIHN0cnVjdCBfQml0X2l0ZXJhdG9yX2Jhc2UKICA6IHB1YmxpYyBzdGQ6Oml0ZXJhdG9y
PHN0ZDo6cmFuZG9tX2FjY2Vzc19pdGVyYXRvcl90YWcsIGJvb2w+CiAgewogICAgX0JpdF90eXBl
ICogX01fcDsKICAgIHVuc2lnbmVkIGludCBfTV9vZmZzZXQ7CgogICAgX0JpdF9pdGVyYXRvcl9i
YXNlKF9CaXRfdHlwZSAqIF9feCwgdW5zaWduZWQgaW50IF9feSkKICAgIDogX01fcChfX3gpLCBf
TV9vZmZzZXQoX195KSB7IH0KCiAgICB2b2lkCiAgICBfTV9idW1wX3VwKCkKICAgIHsKICAgICAg
aWYgKF9NX29mZnNldCsrID09IGludChfU193b3JkX2JpdCkgLSAxKQogewogICBfTV9vZmZzZXQg
PSAwOwogICArK19NX3A7CiB9CiAgICB9CgogICAgdm9pZAogICAgX01fYnVtcF9kb3duKCkKICAg
IHsKICAgICAgaWYgKF9NX29mZnNldC0tID09IDApCiB7CiAgIF9NX29mZnNldCA9IGludChfU193
b3JkX2JpdCkgLSAxOwogICAtLV9NX3A7CiB9CiAgICB9CgogICAgdm9pZAogICAgX01faW5jcihw
dHJkaWZmX3QgX19pKQogICAgewogICAgICBkaWZmZXJlbmNlX3R5cGUgX19uID0gX19pICsgX01f
b2Zmc2V0OwogICAgICBfTV9wICs9IF9fbiAvIGludChfU193b3JkX2JpdCk7CiAgICAgIF9fbiA9
IF9fbiAlIGludChfU193b3JkX2JpdCk7CiAgICAgIGlmIChfX24gPCAwKQogewogICBfX24gKz0g
aW50KF9TX3dvcmRfYml0KTsKICAgLS1fTV9wOwogfQogICAgICBfTV9vZmZzZXQgPSBzdGF0aWNf
Y2FzdDx1bnNpZ25lZCBpbnQ+KF9fbik7CiAgICB9CgogICAgYm9vbAogICAgb3BlcmF0b3I9PShj
b25zdCBfQml0X2l0ZXJhdG9yX2Jhc2UmIF9faSkgY29uc3QKICAgIHsgcmV0dXJuIF9NX3AgPT0g
X19pLl9NX3AgJiYgX01fb2Zmc2V0ID09IF9faS5fTV9vZmZzZXQ7IH0KCiAgICBib29sCiAgICBv
cGVyYXRvcjwoY29uc3QgX0JpdF9pdGVyYXRvcl9iYXNlJiBfX2kpIGNvbnN0CiAgICB7CiAgICAg
IHJldHVybiBfTV9wIDwgX19pLl9NX3AKICAgICAgfHwgKF9NX3AgPT0gX19pLl9NX3AgJiYgX01f
b2Zmc2V0IDwgX19pLl9NX29mZnNldCk7CiAgICB9CgogICAgYm9vbAogICAgb3BlcmF0b3IhPShj
b25zdCBfQml0X2l0ZXJhdG9yX2Jhc2UmIF9faSkgY29uc3QKICAgIHsgcmV0dXJuICEoKnRoaXMg
PT0gX19pKTsgfQoKICAgIGJvb2wKICAgIG9wZXJhdG9yPihjb25zdCBfQml0X2l0ZXJhdG9yX2Jh
c2UmIF9faSkgY29uc3QKICAgIHsgcmV0dXJuIF9faSA8ICp0aGlzOyB9CgogICAgYm9vbAogICAg
b3BlcmF0b3I8PShjb25zdCBfQml0X2l0ZXJhdG9yX2Jhc2UmIF9faSkgY29uc3QKICAgIHsgcmV0
dXJuICEoX19pIDwgKnRoaXMpOyB9CgogICAgYm9vbAogICAgb3BlcmF0b3I+PShjb25zdCBfQml0
X2l0ZXJhdG9yX2Jhc2UmIF9faSkgY29uc3QKICAgIHsgcmV0dXJuICEoKnRoaXMgPCBfX2kpOyB9
CiAgfTsKCiAgaW5saW5lIHB0cmRpZmZfdAogIG9wZXJhdG9yLShjb25zdCBfQml0X2l0ZXJhdG9y
X2Jhc2UmIF9feCwgY29uc3QgX0JpdF9pdGVyYXRvcl9iYXNlJiBfX3kpCiAgewogICAgcmV0dXJu
IChpbnQoX1Nfd29yZF9iaXQpICogKF9feC5fTV9wIC0gX195Ll9NX3ApCiAgICAgKyBfX3guX01f
b2Zmc2V0IC0gX195Ll9NX29mZnNldCk7CiAgfQoKICBzdHJ1Y3QgX0JpdF9pdGVyYXRvciA6IHB1
YmxpYyBfQml0X2l0ZXJhdG9yX2Jhc2UKICB7CiAgICB0eXBlZGVmIF9CaXRfcmVmZXJlbmNlIHJl
ZmVyZW5jZTsKICAgIHR5cGVkZWYgX0JpdF9yZWZlcmVuY2UqIHBvaW50ZXI7CiAgICB0eXBlZGVm
IF9CaXRfaXRlcmF0b3IgaXRlcmF0b3I7CgogICAgX0JpdF9pdGVyYXRvcigpIDogX0JpdF9pdGVy
YXRvcl9iYXNlKDAsIDApIHsgfQoKICAgIF9CaXRfaXRlcmF0b3IoX0JpdF90eXBlICogX194LCB1
bnNpZ25lZCBpbnQgX195KQogICAgOiBfQml0X2l0ZXJhdG9yX2Jhc2UoX194LCBfX3kpIHsgfQoK
ICAgIGl0ZXJhdG9yCiAgICBfTV9jb25zdF9jYXN0KCkgY29uc3QKICAgIHsgcmV0dXJuICp0aGlz
OyB9CgogICAgcmVmZXJlbmNlCiAgICBvcGVyYXRvciooKSBjb25zdAogICAgeyByZXR1cm4gcmVm
ZXJlbmNlKF9NX3AsIDFVTCA8PCBfTV9vZmZzZXQpOyB9CgogICAgaXRlcmF0b3ImCiAgICBvcGVy
YXRvcisrKCkKICAgIHsKICAgICAgX01fYnVtcF91cCgpOwogICAgICByZXR1cm4gKnRoaXM7CiAg
ICB9CgogICAgaXRlcmF0b3IKICAgIG9wZXJhdG9yKysoaW50KQogICAgewogICAgICBpdGVyYXRv
ciBfX3RtcCA9ICp0aGlzOwogICAgICBfTV9idW1wX3VwKCk7CiAgICAgIHJldHVybiBfX3RtcDsK
ICAgIH0KCiAgICBpdGVyYXRvciYKICAgIG9wZXJhdG9yLS0oKQogICAgewogICAgICBfTV9idW1w
X2Rvd24oKTsKICAgICAgcmV0dXJuICp0aGlzOwogICAgfQoKICAgIGl0ZXJhdG9yCiAgICBvcGVy
YXRvci0tKGludCkKICAgIHsKICAgICAgaXRlcmF0b3IgX190bXAgPSAqdGhpczsKICAgICAgX01f
YnVtcF9kb3duKCk7CiAgICAgIHJldHVybiBfX3RtcDsKICAgIH0KCiAgICBpdGVyYXRvciYKICAg
IG9wZXJhdG9yKz0oZGlmZmVyZW5jZV90eXBlIF9faSkKICAgIHsKICAgICAgX01faW5jcihfX2kp
OwogICAgICByZXR1cm4gKnRoaXM7CiAgICB9CgogICAgaXRlcmF0b3ImCiAgICBvcGVyYXRvci09
KGRpZmZlcmVuY2VfdHlwZSBfX2kpCiAgICB7CiAgICAgICp0aGlzICs9IC1fX2k7CiAgICAgIHJl
dHVybiAqdGhpczsKICAgIH0KCiAgICBpdGVyYXRvcgogICAgb3BlcmF0b3IrKGRpZmZlcmVuY2Vf
dHlwZSBfX2kpIGNvbnN0CiAgICB7CiAgICAgIGl0ZXJhdG9yIF9fdG1wID0gKnRoaXM7CiAgICAg
IHJldHVybiBfX3RtcCArPSBfX2k7CiAgICB9CgogICAgaXRlcmF0b3IKICAgIG9wZXJhdG9yLShk
aWZmZXJlbmNlX3R5cGUgX19pKSBjb25zdAogICAgewogICAgICBpdGVyYXRvciBfX3RtcCA9ICp0
aGlzOwogICAgICByZXR1cm4gX190bXAgLT0gX19pOwogICAgfQoKICAgIHJlZmVyZW5jZQogICAg
b3BlcmF0b3JbXShkaWZmZXJlbmNlX3R5cGUgX19pKSBjb25zdAogICAgeyByZXR1cm4gKigqdGhp
cyArIF9faSk7IH0KICB9OwoKICBpbmxpbmUgX0JpdF9pdGVyYXRvcgogIG9wZXJhdG9yKyhwdHJk
aWZmX3QgX19uLCBjb25zdCBfQml0X2l0ZXJhdG9yJiBfX3gpCiAgeyByZXR1cm4gX194ICsgX19u
OyB9CgogIHN0cnVjdCBfQml0X2NvbnN0X2l0ZXJhdG9yIDogcHVibGljIF9CaXRfaXRlcmF0b3Jf
YmFzZQogIHsKICAgIHR5cGVkZWYgYm9vbCByZWZlcmVuY2U7CiAgICB0eXBlZGVmIGJvb2wgY29u
c3RfcmVmZXJlbmNlOwogICAgdHlwZWRlZiBjb25zdCBib29sKiBwb2ludGVyOwogICAgdHlwZWRl
ZiBfQml0X2NvbnN0X2l0ZXJhdG9yIGNvbnN0X2l0ZXJhdG9yOwoKICAgIF9CaXRfY29uc3RfaXRl
cmF0b3IoKSA6IF9CaXRfaXRlcmF0b3JfYmFzZSgwLCAwKSB7IH0KCiAgICBfQml0X2NvbnN0X2l0
ZXJhdG9yKF9CaXRfdHlwZSAqIF9feCwgdW5zaWduZWQgaW50IF9feSkKICAgIDogX0JpdF9pdGVy
YXRvcl9iYXNlKF9feCwgX195KSB7IH0KCiAgICBfQml0X2NvbnN0X2l0ZXJhdG9yKGNvbnN0IF9C
aXRfaXRlcmF0b3ImIF9feCkKICAgIDogX0JpdF9pdGVyYXRvcl9iYXNlKF9feC5fTV9wLCBfX3gu
X01fb2Zmc2V0KSB7IH0KCiAgICBfQml0X2l0ZXJhdG9yCiAgICBfTV9jb25zdF9jYXN0KCkgY29u
c3QKICAgIHsgcmV0dXJuIF9CaXRfaXRlcmF0b3IoX01fcCwgX01fb2Zmc2V0KTsgfQoKICAgIGNv
bnN0X3JlZmVyZW5jZQogICAgb3BlcmF0b3IqKCkgY29uc3QKICAgIHsgcmV0dXJuIF9CaXRfcmVm
ZXJlbmNlKF9NX3AsIDFVTCA8PCBfTV9vZmZzZXQpOyB9CgogICAgY29uc3RfaXRlcmF0b3ImCiAg
ICBvcGVyYXRvcisrKCkKICAgIHsKICAgICAgX01fYnVtcF91cCgpOwogICAgICByZXR1cm4gKnRo
aXM7CiAgICB9CgogICAgY29uc3RfaXRlcmF0b3IKICAgIG9wZXJhdG9yKysoaW50KQogICAgewog
ICAgICBjb25zdF9pdGVyYXRvciBfX3RtcCA9ICp0aGlzOwogICAgICBfTV9idW1wX3VwKCk7CiAg
ICAgIHJldHVybiBfX3RtcDsKICAgIH0KCiAgICBjb25zdF9pdGVyYXRvciYKICAgIG9wZXJhdG9y
LS0oKQogICAgewogICAgICBfTV9idW1wX2Rvd24oKTsKICAgICAgcmV0dXJuICp0aGlzOwogICAg
fQoKICAgIGNvbnN0X2l0ZXJhdG9yCiAgICBvcGVyYXRvci0tKGludCkKICAgIHsKICAgICAgY29u
c3RfaXRlcmF0b3IgX190bXAgPSAqdGhpczsKICAgICAgX01fYnVtcF9kb3duKCk7CiAgICAgIHJl
dHVybiBfX3RtcDsKICAgIH0KCiAgICBjb25zdF9pdGVyYXRvciYKICAgIG9wZXJhdG9yKz0oZGlm
ZmVyZW5jZV90eXBlIF9faSkKICAgIHsKICAgICAgX01faW5jcihfX2kpOwogICAgICByZXR1cm4g
KnRoaXM7CiAgICB9CgogICAgY29uc3RfaXRlcmF0b3ImCiAgICBvcGVyYXRvci09KGRpZmZlcmVu
Y2VfdHlwZSBfX2kpCiAgICB7CiAgICAgICp0aGlzICs9IC1fX2k7CiAgICAgIHJldHVybiAqdGhp
czsKICAgIH0KCiAgICBjb25zdF9pdGVyYXRvcgogICAgb3BlcmF0b3IrKGRpZmZlcmVuY2VfdHlw
ZSBfX2kpIGNvbnN0CiAgICB7CiAgICAgIGNvbnN0X2l0ZXJhdG9yIF9fdG1wID0gKnRoaXM7CiAg
ICAgIHJldHVybiBfX3RtcCArPSBfX2k7CiAgICB9CgogICAgY29uc3RfaXRlcmF0b3IKICAgIG9w
ZXJhdG9yLShkaWZmZXJlbmNlX3R5cGUgX19pKSBjb25zdAogICAgewogICAgICBjb25zdF9pdGVy
YXRvciBfX3RtcCA9ICp0aGlzOwogICAgICByZXR1cm4gX190bXAgLT0gX19pOwogICAgfQoKICAg
IGNvbnN0X3JlZmVyZW5jZQogICAgb3BlcmF0b3JbXShkaWZmZXJlbmNlX3R5cGUgX19pKSBjb25z
dAogICAgeyByZXR1cm4gKigqdGhpcyArIF9faSk7IH0KICB9OwoKICBpbmxpbmUgX0JpdF9jb25z
dF9pdGVyYXRvcgogIG9wZXJhdG9yKyhwdHJkaWZmX3QgX19uLCBjb25zdCBfQml0X2NvbnN0X2l0
ZXJhdG9yJiBfX3gpCiAgeyByZXR1cm4gX194ICsgX19uOyB9CgogIGlubGluZSB2b2lkCiAgX19m
aWxsX2J2ZWN0b3IoX0JpdF9pdGVyYXRvciBfX2ZpcnN0LCBfQml0X2l0ZXJhdG9yIF9fbGFzdCwg
Ym9vbCBfX3gpCiAgewogICAgZm9yICg7IF9fZmlyc3QgIT0gX19sYXN0OyArK19fZmlyc3QpCiAg
ICAgICpfX2ZpcnN0ID0gX194OwogIH0KCiAgaW5saW5lIHZvaWQKICBmaWxsKF9CaXRfaXRlcmF0
b3IgX19maXJzdCwgX0JpdF9pdGVyYXRvciBfX2xhc3QsIGNvbnN0IGJvb2wmIF9feCkKICB7CiAg
ICBpZiAoX19maXJzdC5fTV9wICE9IF9fbGFzdC5fTV9wKQogICAgICB7CiBzdGQ6OmZpbGwoX19m
aXJzdC5fTV9wICsgMSwgX19sYXN0Ll9NX3AsIF9feCA/IH4wIDogMCk7CiBfX2ZpbGxfYnZlY3Rv
cihfX2ZpcnN0LCBfQml0X2l0ZXJhdG9yKF9fZmlyc3QuX01fcCArIDEsIDApLCBfX3gpOwogX19m
aWxsX2J2ZWN0b3IoX0JpdF9pdGVyYXRvcihfX2xhc3QuX01fcCwgMCksIF9fbGFzdCwgX194KTsK
ICAgICAgfQogICAgZWxzZQogICAgICBfX2ZpbGxfYnZlY3RvcihfX2ZpcnN0LCBfX2xhc3QsIF9f
eCk7CiAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2M+CiAgICBzdHJ1Y3QgX0J2ZWN0b3Jf
YmFzZQogICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fZ251X2N4eDo6X19hbGxvY190cmFp
dHM8X0FsbG9jPjo6dGVtcGxhdGUKICAgICAgICByZWJpbmQ8X0JpdF90eXBlPjo6b3RoZXIgX0Jp
dF9hbGxvY190eXBlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fZ251X2N4eDo6X19hbGxvY190
cmFpdHM8X0JpdF9hbGxvY190eXBlPgogX0JpdF9hbGxvY190cmFpdHM7CiAgICAgIHR5cGVkZWYg
dHlwZW5hbWUgX0JpdF9hbGxvY190cmFpdHM6OnBvaW50ZXIgX0JpdF9wb2ludGVyOwoKICAgICAg
c3RydWN0IF9CdmVjdG9yX2ltcGwKICAgICAgOiBwdWJsaWMgX0JpdF9hbGxvY190eXBlCiAgICAg
IHsKIF9CaXRfaXRlcmF0b3IgX01fc3RhcnQ7CiBfQml0X2l0ZXJhdG9yIF9NX2ZpbmlzaDsKIF9C
aXRfcG9pbnRlciBfTV9lbmRfb2Zfc3RvcmFnZTsKCiBfQnZlY3Rvcl9pbXBsKCkKIDogX0JpdF9h
bGxvY190eXBlKCksIF9NX3N0YXJ0KCksIF9NX2ZpbmlzaCgpLCBfTV9lbmRfb2Zfc3RvcmFnZSgp
CiB7IH0KCiBfQnZlY3Rvcl9pbXBsKGNvbnN0IF9CaXRfYWxsb2NfdHlwZSYgX19hKQogOiBfQml0
X2FsbG9jX3R5cGUoX19hKSwgX01fc3RhcnQoKSwgX01fZmluaXNoKCksIF9NX2VuZF9vZl9zdG9y
YWdlKCkKIHsgfQoKCiBfQnZlY3Rvcl9pbXBsKF9CaXRfYWxsb2NfdHlwZSYmIF9fYSkKIDogX0Jp
dF9hbGxvY190eXBlKHN0ZDo6bW92ZShfX2EpKSwgX01fc3RhcnQoKSwgX01fZmluaXNoKCksCiAg
IF9NX2VuZF9vZl9zdG9yYWdlKCkKIHsgfQoKCiBfQml0X3R5cGUqCiBfTV9lbmRfYWRkcigpIGNv
bnN0IG5vZXhjZXB0CiB7CiAgIGlmIChfTV9lbmRfb2Zfc3RvcmFnZSkKICAgICByZXR1cm4gc3Rk
OjpfX2FkZHJlc3NvZihfTV9lbmRfb2Zfc3RvcmFnZVstMV0pICsgMTsKICAgcmV0dXJuIDA7CiB9
CiAgICAgIH07CgogICAgcHVibGljOgogICAgICB0eXBlZGVmIF9BbGxvYyBhbGxvY2F0b3JfdHlw
ZTsKCiAgICAgIF9CaXRfYWxsb2NfdHlwZSYKICAgICAgX01fZ2V0X0JpdF9hbGxvY2F0b3IoKSBu
b2V4Y2VwdAogICAgICB7IHJldHVybiAqc3RhdGljX2Nhc3Q8X0JpdF9hbGxvY190eXBlKj4oJnRo
aXMtPl9NX2ltcGwpOyB9CgogICAgICBjb25zdCBfQml0X2FsbG9jX3R5cGUmCiAgICAgIF9NX2dl
dF9CaXRfYWxsb2NhdG9yKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gKnN0YXRpY19j
YXN0PGNvbnN0IF9CaXRfYWxsb2NfdHlwZSo+KCZ0aGlzLT5fTV9pbXBsKTsgfQoKICAgICAgYWxs
b2NhdG9yX3R5cGUKICAgICAgZ2V0X2FsbG9jYXRvcigpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsg
cmV0dXJuIGFsbG9jYXRvcl90eXBlKF9NX2dldF9CaXRfYWxsb2NhdG9yKCkpOyB9CgogICAgICBf
QnZlY3Rvcl9iYXNlKCkKICAgICAgOiBfTV9pbXBsKCkgeyB9CgogICAgICBfQnZlY3Rvcl9iYXNl
KGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EpCiAgICAgIDogX01faW1wbChfX2EpIHsgfQoKCiAg
ICAgIF9CdmVjdG9yX2Jhc2UoX0J2ZWN0b3JfYmFzZSYmIF9feCkgbm9leGNlcHQKICAgICAgOiBf
TV9pbXBsKHN0ZDo6bW92ZShfX3guX01fZ2V0X0JpdF9hbGxvY2F0b3IoKSkpCiAgICAgIHsKIHRo
aXMtPl9NX2ltcGwuX01fc3RhcnQgPSBfX3guX01faW1wbC5fTV9zdGFydDsKIHRoaXMtPl9NX2lt
cGwuX01fZmluaXNoID0gX194Ll9NX2ltcGwuX01fZmluaXNoOwogdGhpcy0+X01faW1wbC5fTV9l
bmRfb2Zfc3RvcmFnZSA9IF9feC5fTV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdlOwogX194Ll9NX2lt
cGwuX01fc3RhcnQgPSBfQml0X2l0ZXJhdG9yKCk7CiBfX3guX01faW1wbC5fTV9maW5pc2ggPSBf
Qml0X2l0ZXJhdG9yKCk7CiBfX3guX01faW1wbC5fTV9lbmRfb2Zfc3RvcmFnZSA9IG51bGxwdHI7
CiAgICAgIH0KCgogICAgICB+X0J2ZWN0b3JfYmFzZSgpCiAgICAgIHsgdGhpcy0+X01fZGVhbGxv
Y2F0ZSgpOyB9CgogICAgcHJvdGVjdGVkOgogICAgICBfQnZlY3Rvcl9pbXBsIF9NX2ltcGw7Cgog
ICAgICBfQml0X3BvaW50ZXIKICAgICAgX01fYWxsb2NhdGUoc2l6ZV90IF9fbikKICAgICAgeyBy
ZXR1cm4gX0JpdF9hbGxvY190cmFpdHM6OmFsbG9jYXRlKF9NX2ltcGwsIF9TX253b3JkKF9fbikp
OyB9CgogICAgICB2b2lkCiAgICAgIF9NX2RlYWxsb2NhdGUoKQogICAgICB7CiBpZiAoX01faW1w
bC5fTV9zdGFydC5fTV9wKQogICB7CiAgICAgY29uc3Qgc2l6ZV90IF9fbiA9IF9NX2ltcGwuX01f
ZW5kX2FkZHIoKSAtIF9NX2ltcGwuX01fc3RhcnQuX01fcDsKICAgICBfQml0X2FsbG9jX3RyYWl0
czo6ZGVhbGxvY2F0ZShfTV9pbXBsLAogICAgICAgX01faW1wbC5fTV9lbmRfb2Zfc3RvcmFnZSAt
IF9fbiwKICAgICAgIF9fbik7CiAgIH0KICAgICAgfQoKICAgICAgc3RhdGljIHNpemVfdAogICAg
ICBfU19ud29yZChzaXplX3QgX19uKQogICAgICB7IHJldHVybiAoX19uICsgaW50KF9TX3dvcmRf
Yml0KSAtIDEpIC8gaW50KF9TX3dvcmRfYml0KTsgfQogICAgfTsKCgp9CgoKCgpuYW1lc3BhY2Ug
c3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCiMgNTQw
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2J2ZWN0b3IuaCIgMwp0ZW1wbGF0ZTx0
eXBlbmFtZSBfQWxsb2M+CiAgY2xhc3MgdmVjdG9yPGJvb2wsIF9BbGxvYz4gOiBwcm90ZWN0ZWQg
X0J2ZWN0b3JfYmFzZTxfQWxsb2M+CiAgewogICAgdHlwZWRlZiBfQnZlY3Rvcl9iYXNlPF9BbGxv
Yz4gX0Jhc2U7CiAgICB0eXBlZGVmIHR5cGVuYW1lIF9CYXNlOjpfQml0X3BvaW50ZXIgX0JpdF9w
b2ludGVyOwogICAgdHlwZWRlZiB0eXBlbmFtZSBfQmFzZTo6X0JpdF9hbGxvY190cmFpdHMgX0Jp
dF9hbGxvY190cmFpdHM7CgoKICAgIHRlbXBsYXRlPHR5cGVuYW1lPiBmcmllbmQgc3RydWN0IGhh
c2g7CgoKICBwdWJsaWM6CiAgICB0eXBlZGVmIGJvb2wgdmFsdWVfdHlwZTsKICAgIHR5cGVkZWYg
c2l6ZV90IHNpemVfdHlwZTsKICAgIHR5cGVkZWYgcHRyZGlmZl90IGRpZmZlcmVuY2VfdHlwZTsK
ICAgIHR5cGVkZWYgX0JpdF9yZWZlcmVuY2UgcmVmZXJlbmNlOwogICAgdHlwZWRlZiBib29sIGNv
bnN0X3JlZmVyZW5jZTsKICAgIHR5cGVkZWYgX0JpdF9yZWZlcmVuY2UqIHBvaW50ZXI7CiAgICB0
eXBlZGVmIGNvbnN0IGJvb2wqIGNvbnN0X3BvaW50ZXI7CiAgICB0eXBlZGVmIF9CaXRfaXRlcmF0
b3IgaXRlcmF0b3I7CiAgICB0eXBlZGVmIF9CaXRfY29uc3RfaXRlcmF0b3IgY29uc3RfaXRlcmF0
b3I7CiAgICB0eXBlZGVmIHN0ZDo6cmV2ZXJzZV9pdGVyYXRvcjxjb25zdF9pdGVyYXRvcj4gY29u
c3RfcmV2ZXJzZV9pdGVyYXRvcjsKICAgIHR5cGVkZWYgc3RkOjpyZXZlcnNlX2l0ZXJhdG9yPGl0
ZXJhdG9yPiByZXZlcnNlX2l0ZXJhdG9yOwogICAgdHlwZWRlZiBfQWxsb2MgYWxsb2NhdG9yX3R5
cGU7CgogICAgYWxsb2NhdG9yX3R5cGUgZ2V0X2FsbG9jYXRvcigpIGNvbnN0CiAgICB7IHJldHVy
biBfQmFzZTo6Z2V0X2FsbG9jYXRvcigpOyB9CgogIHByb3RlY3RlZDoKICAgIHVzaW5nIF9CYXNl
OjpfTV9hbGxvY2F0ZTsKICAgIHVzaW5nIF9CYXNlOjpfTV9kZWFsbG9jYXRlOwogICAgdXNpbmcg
X0Jhc2U6Ol9TX253b3JkOwogICAgdXNpbmcgX0Jhc2U6Ol9NX2dldF9CaXRfYWxsb2NhdG9yOwoK
ICBwdWJsaWM6CiAgICB2ZWN0b3IoKQoKICAgICAgbm9leGNlcHQoaXNfbm90aHJvd19kZWZhdWx0
X2NvbnN0cnVjdGlibGU8YWxsb2NhdG9yX3R5cGU+Ojp2YWx1ZSkKCiAgICA6IF9CYXNlKCkgeyB9
CgogICAgZXhwbGljaXQKICAgIHZlY3Rvcihjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hKQogICAg
OiBfQmFzZShfX2EpIHsgfQoKCiAgICBleHBsaWNpdAogICAgdmVjdG9yKHNpemVfdHlwZSBfX24s
IGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EgPSBhbGxvY2F0b3JfdHlwZSgpKQogICAgOiB2ZWN0
b3IoX19uLCBmYWxzZSwgX19hKQogICAgeyB9CgogICAgdmVjdG9yKHNpemVfdHlwZSBfX24sIGNv
bnN0IGJvb2wmIF9fdmFsdWUsCiAgICBjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hID0gYWxsb2Nh
dG9yX3R5cGUoKSkKICAgIDogX0Jhc2UoX19hKQogICAgewogICAgICBfTV9pbml0aWFsaXplKF9f
bik7CiAgICAgIHN0ZDo6ZmlsbCh0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9NX3AsIHRoaXMtPl9N
X2ltcGwuX01fZW5kX2FkZHIoKSwKICBfX3ZhbHVlID8gfjAgOiAwKTsKICAgIH0KIyA2MTEgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfYnZlY3Rvci5oIiAzCiAgICB2ZWN0b3IoY29u
c3QgdmVjdG9yJiBfX3gpCiAgICA6IF9CYXNlKF9CaXRfYWxsb2NfdHJhaXRzOjpfU19zZWxlY3Rf
b25fY29weShfX3guX01fZ2V0X0JpdF9hbGxvY2F0b3IoKSkpCiAgICB7CiAgICAgIF9NX2luaXRp
YWxpemUoX194LnNpemUoKSk7CiAgICAgIF9NX2NvcHlfYWxpZ25lZChfX3guYmVnaW4oKSwgX194
LmVuZCgpLCB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0KTsKICAgIH0KCgogICAgdmVjdG9yKHZlY3Rv
ciYmIF9feCkgbm9leGNlcHQKICAgIDogX0Jhc2Uoc3RkOjptb3ZlKF9feCkpIHsgfQoKICAgIHZl
Y3Rvcih2ZWN0b3ImJiBfX3gsIGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EpCiAgICBub2V4Y2Vw
dChfQml0X2FsbG9jX3RyYWl0czo6X1NfYWx3YXlzX2VxdWFsKCkpCiAgICA6IF9CYXNlKF9fYSkK
ICAgIHsKICAgICAgaWYgKF9feC5nZXRfYWxsb2NhdG9yKCkgPT0gX19hKQogewogICB0aGlzLT5f
TV9pbXBsLl9NX3N0YXJ0ID0gX194Ll9NX2ltcGwuX01fc3RhcnQ7CiAgIHRoaXMtPl9NX2ltcGwu
X01fZmluaXNoID0gX194Ll9NX2ltcGwuX01fZmluaXNoOwogICB0aGlzLT5fTV9pbXBsLl9NX2Vu
ZF9vZl9zdG9yYWdlID0gX194Ll9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2U7CiAgIF9feC5fTV9p
bXBsLl9NX3N0YXJ0ID0gX0JpdF9pdGVyYXRvcigpOwogICBfX3guX01faW1wbC5fTV9maW5pc2gg
PSBfQml0X2l0ZXJhdG9yKCk7CiAgIF9feC5fTV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdlID0gbnVs
bHB0cjsKIH0KICAgICAgZWxzZQogewogICBfTV9pbml0aWFsaXplKF9feC5zaXplKCkpOwogICBf
TV9jb3B5X2FsaWduZWQoX194LmJlZ2luKCksIF9feC5lbmQoKSwgYmVnaW4oKSk7CiAgIF9feC5j
bGVhcigpOwogfQogICAgfQoKICAgIHZlY3Rvcihjb25zdCB2ZWN0b3ImIF9feCwgY29uc3QgYWxs
b2NhdG9yX3R5cGUmIF9fYSkKICAgIDogX0Jhc2UoX19hKQogICAgewogICAgICBfTV9pbml0aWFs
aXplKF9feC5zaXplKCkpOwogICAgICBfTV9jb3B5X2FsaWduZWQoX194LmJlZ2luKCksIF9feC5l
bmQoKSwgdGhpcy0+X01faW1wbC5fTV9zdGFydCk7CiAgICB9CgogICAgdmVjdG9yKGluaXRpYWxp
emVyX2xpc3Q8Ym9vbD4gX19sLAogICAgY29uc3QgYWxsb2NhdG9yX3R5cGUmIF9fYSA9IGFsbG9j
YXRvcl90eXBlKCkpCiAgICA6IF9CYXNlKF9fYSkKICAgIHsKICAgICAgX01faW5pdGlhbGl6ZV9y
YW5nZShfX2wuYmVnaW4oKSwgX19sLmVuZCgpLAogICAgIHJhbmRvbV9hY2Nlc3NfaXRlcmF0b3Jf
dGFnKCkpOwogICAgfQoKCgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsCiAg
ICAgIHR5cGVuYW1lID0gc3RkOjpfUmVxdWlyZUlucHV0SXRlcjxfSW5wdXRJdGVyYXRvcj4+CiAg
ICAgIHZlY3RvcihfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3Qs
CiAgICAgIGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EgPSBhbGxvY2F0b3JfdHlwZSgpKQogICAg
ICA6IF9CYXNlKF9fYSkKICAgICAgeyBfTV9pbml0aWFsaXplX2Rpc3BhdGNoKF9fZmlyc3QsIF9f
bGFzdCwgX19mYWxzZV90eXBlKCkpOyB9CiMgNjc3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX2J2ZWN0b3IuaCIgMwogICAgfnZlY3RvcigpIG5vZXhjZXB0IHsgfQoKICAgIHZlY3Rv
ciYKICAgIG9wZXJhdG9yPShjb25zdCB2ZWN0b3ImIF9feCkKICAgIHsKICAgICAgaWYgKCZfX3gg
PT0gdGhpcykKIHJldHVybiAqdGhpczsKCiAgICAgIGlmIChfQml0X2FsbG9jX3RyYWl0czo6X1Nf
cHJvcGFnYXRlX29uX2NvcHlfYXNzaWduKCkpCiB7CiAgIGlmICh0aGlzLT5fTV9nZXRfQml0X2Fs
bG9jYXRvcigpICE9IF9feC5fTV9nZXRfQml0X2FsbG9jYXRvcigpKQogICAgIHsKICAgICAgIHRo
aXMtPl9NX2RlYWxsb2NhdGUoKTsKICAgICAgIHN0ZDo6X19hbGxvY19vbl9jb3B5KF9NX2dldF9C
aXRfYWxsb2NhdG9yKCksCiAgICAgICBfX3guX01fZ2V0X0JpdF9hbGxvY2F0b3IoKSk7CiAgICAg
ICBfTV9pbml0aWFsaXplKF9feC5zaXplKCkpOwogICAgIH0KICAgZWxzZQogICAgIHN0ZDo6X19h
bGxvY19vbl9jb3B5KF9NX2dldF9CaXRfYWxsb2NhdG9yKCksCiAgICAgX194Ll9NX2dldF9CaXRf
YWxsb2NhdG9yKCkpOwogfQoKICAgICAgaWYgKF9feC5zaXplKCkgPiBjYXBhY2l0eSgpKQogewog
ICB0aGlzLT5fTV9kZWFsbG9jYXRlKCk7CiAgIF9NX2luaXRpYWxpemUoX194LnNpemUoKSk7CiB9
CiAgICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoID0gX01fY29weV9hbGlnbmVkKF9feC5iZWdp
bigpLCBfX3guZW5kKCksCiAgICAgIGJlZ2luKCkpOwogICAgICByZXR1cm4gKnRoaXM7CiAgICB9
CgoKICAgIHZlY3RvciYKICAgIG9wZXJhdG9yPSh2ZWN0b3ImJiBfX3gpIG5vZXhjZXB0KF9CaXRf
YWxsb2NfdHJhaXRzOjpfU19ub3Rocm93X21vdmUoKSkKICAgIHsKICAgICAgaWYgKF9CaXRfYWxs
b2NfdHJhaXRzOjpfU19wcm9wYWdhdGVfb25fbW92ZV9hc3NpZ24oKQogICB8fCB0aGlzLT5fTV9n
ZXRfQml0X2FsbG9jYXRvcigpID09IF9feC5fTV9nZXRfQml0X2FsbG9jYXRvcigpKQogewogICB0
aGlzLT5fTV9kZWFsbG9jYXRlKCk7CiAgIHRoaXMtPl9NX2ltcGwuX01fc3RhcnQgPSBfX3guX01f
aW1wbC5fTV9zdGFydDsKICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2ggPSBfX3guX01faW1wbC5f
TV9maW5pc2g7CiAgIHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UgPSBfX3guX01faW1w
bC5fTV9lbmRfb2Zfc3RvcmFnZTsKICAgX194Ll9NX2ltcGwuX01fc3RhcnQgPSBfQml0X2l0ZXJh
dG9yKCk7CiAgIF9feC5fTV9pbXBsLl9NX2ZpbmlzaCA9IF9CaXRfaXRlcmF0b3IoKTsKICAgX194
Ll9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UgPSBudWxscHRyOwogICBzdGQ6Ol9fYWxsb2Nfb25f
bW92ZShfTV9nZXRfQml0X2FsbG9jYXRvcigpLAogICAgICAgICAgX194Ll9NX2dldF9CaXRfYWxs
b2NhdG9yKCkpOwogfQogICAgICBlbHNlCiB7CiAgIGlmIChfX3guc2l6ZSgpID4gY2FwYWNpdHko
KSkKICAgICB7CiAgICAgICB0aGlzLT5fTV9kZWFsbG9jYXRlKCk7CiAgICAgICBfTV9pbml0aWFs
aXplKF9feC5zaXplKCkpOwogICAgIH0KICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2ggPSBfTV9j
b3B5X2FsaWduZWQoX194LmJlZ2luKCksIF9feC5lbmQoKSwKICAgICAgICAgIGJlZ2luKCkpOwog
ICBfX3guY2xlYXIoKTsKIH0KICAgICAgcmV0dXJuICp0aGlzOwogICAgfQoKICAgIHZlY3RvciYK
ICAgIG9wZXJhdG9yPShpbml0aWFsaXplcl9saXN0PGJvb2w+IF9fbCkKICAgIHsKICAgICAgdGhp
cy0+YXNzaWduIChfX2wuYmVnaW4oKSwgX19sLmVuZCgpKTsKICAgICAgcmV0dXJuICp0aGlzOwog
ICAgfQoKCgoKCgogICAgdm9pZAogICAgYXNzaWduKHNpemVfdHlwZSBfX24sIGNvbnN0IGJvb2wm
IF9feCkKICAgIHsgX01fZmlsbF9hc3NpZ24oX19uLCBfX3gpOyB9CgoKICAgIHRlbXBsYXRlPHR5
cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLAogICAgICB0eXBlbmFtZSA9IHN0ZDo6X1JlcXVpcmVJbnB1
dEl0ZXI8X0lucHV0SXRlcmF0b3I+PgogICAgICB2b2lkCiAgICAgIGFzc2lnbihfSW5wdXRJdGVy
YXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QpCiAgICAgIHsgX01fYXNzaWduX2Rp
c3BhdGNoKF9fZmlyc3QsIF9fbGFzdCwgX19mYWxzZV90eXBlKCkpOyB9CiMgNzczICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2J2ZWN0b3IuaCIgMwogICAgdm9pZAogICAgYXNzaWdu
KGluaXRpYWxpemVyX2xpc3Q8Ym9vbD4gX19sKQogICAgeyB0aGlzLT5hc3NpZ24oX19sLmJlZ2lu
KCksIF9fbC5lbmQoKSk7IH0KCgogICAgaXRlcmF0b3IKICAgIGJlZ2luKCkgbm9leGNlcHQKICAg
IHsgcmV0dXJuIHRoaXMtPl9NX2ltcGwuX01fc3RhcnQ7IH0KCiAgICBjb25zdF9pdGVyYXRvcgog
ICAgYmVnaW4oKSBjb25zdCBub2V4Y2VwdAogICAgeyByZXR1cm4gdGhpcy0+X01faW1wbC5fTV9z
dGFydDsgfQoKICAgIGl0ZXJhdG9yCiAgICBlbmQoKSBub2V4Y2VwdAogICAgeyByZXR1cm4gdGhp
cy0+X01faW1wbC5fTV9maW5pc2g7IH0KCiAgICBjb25zdF9pdGVyYXRvcgogICAgZW5kKCkgY29u
c3Qgbm9leGNlcHQKICAgIHsgcmV0dXJuIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoOyB9CgogICAg
cmV2ZXJzZV9pdGVyYXRvcgogICAgcmJlZ2luKCkgbm9leGNlcHQKICAgIHsgcmV0dXJuIHJldmVy
c2VfaXRlcmF0b3IoZW5kKCkpOyB9CgogICAgY29uc3RfcmV2ZXJzZV9pdGVyYXRvcgogICAgcmJl
Z2luKCkgY29uc3Qgbm9leGNlcHQKICAgIHsgcmV0dXJuIGNvbnN0X3JldmVyc2VfaXRlcmF0b3Io
ZW5kKCkpOyB9CgogICAgcmV2ZXJzZV9pdGVyYXRvcgogICAgcmVuZCgpIG5vZXhjZXB0CiAgICB7
IHJldHVybiByZXZlcnNlX2l0ZXJhdG9yKGJlZ2luKCkpOyB9CgogICAgY29uc3RfcmV2ZXJzZV9p
dGVyYXRvcgogICAgcmVuZCgpIGNvbnN0IG5vZXhjZXB0CiAgICB7IHJldHVybiBjb25zdF9yZXZl
cnNlX2l0ZXJhdG9yKGJlZ2luKCkpOyB9CgoKICAgIGNvbnN0X2l0ZXJhdG9yCiAgICBjYmVnaW4o
KSBjb25zdCBub2V4Y2VwdAogICAgeyByZXR1cm4gdGhpcy0+X01faW1wbC5fTV9zdGFydDsgfQoK
ICAgIGNvbnN0X2l0ZXJhdG9yCiAgICBjZW5kKCkgY29uc3Qgbm9leGNlcHQKICAgIHsgcmV0dXJu
IHRoaXMtPl9NX2ltcGwuX01fZmluaXNoOyB9CgogICAgY29uc3RfcmV2ZXJzZV9pdGVyYXRvcgog
ICAgY3JiZWdpbigpIGNvbnN0IG5vZXhjZXB0CiAgICB7IHJldHVybiBjb25zdF9yZXZlcnNlX2l0
ZXJhdG9yKGVuZCgpKTsgfQoKICAgIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAgIGNyZW5kKCkg
Y29uc3Qgbm9leGNlcHQKICAgIHsgcmV0dXJuIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IoYmVnaW4o
KSk7IH0KCgogICAgc2l6ZV90eXBlCiAgICBzaXplKCkgY29uc3Qgbm9leGNlcHQKICAgIHsgcmV0
dXJuIHNpemVfdHlwZShlbmQoKSAtIGJlZ2luKCkpOyB9CgogICAgc2l6ZV90eXBlCiAgICBtYXhf
c2l6ZSgpIGNvbnN0IG5vZXhjZXB0CiAgICB7CiAgICAgIGNvbnN0IHNpemVfdHlwZSBfX2lzaXpl
ID0KIF9fZ251X2N4eDo6X19udW1lcmljX3RyYWl0czxkaWZmZXJlbmNlX3R5cGU+OjpfX21heAog
LSBpbnQoX1Nfd29yZF9iaXQpICsgMTsKICAgICAgY29uc3Qgc2l6ZV90eXBlIF9fYXNpemUKID0g
X0JpdF9hbGxvY190cmFpdHM6Om1heF9zaXplKF9NX2dldF9CaXRfYWxsb2NhdG9yKCkpOwogICAg
ICByZXR1cm4gKF9fYXNpemUgPD0gX19pc2l6ZSAvIGludChfU193b3JkX2JpdCkKICAgICAgID8g
X19hc2l6ZSAqIGludChfU193b3JkX2JpdCkgOiBfX2lzaXplKTsKICAgIH0KCiAgICBzaXplX3R5
cGUKICAgIGNhcGFjaXR5KCkgY29uc3Qgbm9leGNlcHQKICAgIHsgcmV0dXJuIHNpemVfdHlwZShj
b25zdF9pdGVyYXRvcih0aGlzLT5fTV9pbXBsLl9NX2VuZF9hZGRyKCksIDApCiAgICAgICAgIC0g
YmVnaW4oKSk7IH0KCiAgICBib29sCiAgICBlbXB0eSgpIGNvbnN0IG5vZXhjZXB0CiAgICB7IHJl
dHVybiBiZWdpbigpID09IGVuZCgpOyB9CgogICAgcmVmZXJlbmNlCiAgICBvcGVyYXRvcltdKHNp
emVfdHlwZSBfX24pCiAgICB7CiAgICAgIHJldHVybiAqaXRlcmF0b3IodGhpcy0+X01faW1wbC5f
TV9zdGFydC5fTV9wCiAgICAgICAgICsgX19uIC8gaW50KF9TX3dvcmRfYml0KSwgX19uICUgaW50
KF9TX3dvcmRfYml0KSk7CiAgICB9CgogICAgY29uc3RfcmVmZXJlbmNlCiAgICBvcGVyYXRvcltd
KHNpemVfdHlwZSBfX24pIGNvbnN0CiAgICB7CiAgICAgIHJldHVybiAqY29uc3RfaXRlcmF0b3Io
dGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9wCiAgICAgICAgKyBfX24gLyBpbnQoX1Nfd29yZF9i
aXQpLCBfX24gJSBpbnQoX1Nfd29yZF9iaXQpKTsKICAgIH0KCiAgcHJvdGVjdGVkOgogICAgdm9p
ZAogICAgX01fcmFuZ2VfY2hlY2soc2l6ZV90eXBlIF9fbikgY29uc3QKICAgIHsKICAgICAgaWYg
KF9fbiA+PSB0aGlzLT5zaXplKCkpCiBfX3Rocm93X291dF9vZl9yYW5nZV9mbXQoKCJ2ZWN0b3I8
Ym9vbD46Ol9NX3JhbmdlX2NoZWNrOiBfX24gIiAiKHdoaWNoIGlzICV6dSkgPj0gdGhpcy0+c2l6
ZSgpICIgIih3aGljaCBpcyAlenUpIikKCiAgICAgICAgICAgICAgICAgICAgICAgICAgLAogICAg
IF9fbiwgdGhpcy0+c2l6ZSgpKTsKICAgIH0KCiAgcHVibGljOgogICAgcmVmZXJlbmNlCiAgICBh
dChzaXplX3R5cGUgX19uKQogICAgeyBfTV9yYW5nZV9jaGVjayhfX24pOyByZXR1cm4gKCp0aGlz
KVtfX25dOyB9CgogICAgY29uc3RfcmVmZXJlbmNlCiAgICBhdChzaXplX3R5cGUgX19uKSBjb25z
dAogICAgeyBfTV9yYW5nZV9jaGVjayhfX24pOyByZXR1cm4gKCp0aGlzKVtfX25dOyB9CgogICAg
dm9pZAogICAgcmVzZXJ2ZShzaXplX3R5cGUgX19uKQogICAgewogICAgICBpZiAoX19uID4gbWF4
X3NpemUoKSkKIF9fdGhyb3dfbGVuZ3RoX2Vycm9yKCgidmVjdG9yOjpyZXNlcnZlIikpOwogICAg
ICBpZiAoY2FwYWNpdHkoKSA8IF9fbikKIF9NX3JlYWxsb2NhdGUoX19uKTsKICAgIH0KCiAgICBy
ZWZlcmVuY2UKICAgIGZyb250KCkKICAgIHsgcmV0dXJuICpiZWdpbigpOyB9CgogICAgY29uc3Rf
cmVmZXJlbmNlCiAgICBmcm9udCgpIGNvbnN0CiAgICB7IHJldHVybiAqYmVnaW4oKTsgfQoKICAg
IHJlZmVyZW5jZQogICAgYmFjaygpCiAgICB7IHJldHVybiAqKGVuZCgpIC0gMSk7IH0KCiAgICBj
b25zdF9yZWZlcmVuY2UKICAgIGJhY2soKSBjb25zdAogICAgeyByZXR1cm4gKihlbmQoKSAtIDEp
OyB9CgoKCgoKCiAgICB2b2lkCiAgICBkYXRhKCkgbm9leGNlcHQgeyB9CgogICAgdm9pZAogICAg
cHVzaF9iYWNrKGJvb2wgX194KQogICAgewogICAgICBpZiAodGhpcy0+X01faW1wbC5fTV9maW5p
c2guX01fcCAhPSB0aGlzLT5fTV9pbXBsLl9NX2VuZF9hZGRyKCkpCiAgICAgICAgKnRoaXMtPl9N
X2ltcGwuX01fZmluaXNoKysgPSBfX3g7CiAgICAgIGVsc2UKICAgICAgICBfTV9pbnNlcnRfYXV4
KGVuZCgpLCBfX3gpOwogICAgfQoKICAgIHZvaWQKICAgIHN3YXAodmVjdG9yJiBfX3gpIG5vZXhj
ZXB0CiAgICB7CiAgICAgIHN0ZDo6c3dhcCh0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0LCBfX3guX01f
aW1wbC5fTV9zdGFydCk7CiAgICAgIHN0ZDo6c3dhcCh0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwg
X194Ll9NX2ltcGwuX01fZmluaXNoKTsKICAgICAgc3RkOjpzd2FwKHRoaXMtPl9NX2ltcGwuX01f
ZW5kX29mX3N0b3JhZ2UsCiAgX194Ll9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UpOwogICAgICBf
Qml0X2FsbG9jX3RyYWl0czo6X1Nfb25fc3dhcChfTV9nZXRfQml0X2FsbG9jYXRvcigpLAogICAg
ICAgIF9feC5fTV9nZXRfQml0X2FsbG9jYXRvcigpKTsKICAgIH0KCgogICAgc3RhdGljIHZvaWQK
ICAgIHN3YXAocmVmZXJlbmNlIF9feCwgcmVmZXJlbmNlIF9feSkgbm9leGNlcHQKICAgIHsKICAg
ICAgYm9vbCBfX3RtcCA9IF9feDsKICAgICAgX194ID0gX195OwogICAgICBfX3kgPSBfX3RtcDsK
ICAgIH0KCiAgICBpdGVyYXRvcgoKICAgIGluc2VydChjb25zdF9pdGVyYXRvciBfX3Bvc2l0aW9u
LCBjb25zdCBib29sJiBfX3ggPSBib29sKCkpCgoKCiAgICB7CiAgICAgIGNvbnN0IGRpZmZlcmVu
Y2VfdHlwZSBfX24gPSBfX3Bvc2l0aW9uIC0gYmVnaW4oKTsKICAgICAgaWYgKHRoaXMtPl9NX2lt
cGwuX01fZmluaXNoLl9NX3AgIT0gdGhpcy0+X01faW1wbC5fTV9lbmRfYWRkcigpCiAgICYmIF9f
cG9zaXRpb24gPT0gZW5kKCkpCiAgICAgICAgKnRoaXMtPl9NX2ltcGwuX01fZmluaXNoKysgPSBf
X3g7CiAgICAgIGVsc2UKICAgICAgICBfTV9pbnNlcnRfYXV4KF9fcG9zaXRpb24uX01fY29uc3Rf
Y2FzdCgpLCBfX3gpOwogICAgICByZXR1cm4gYmVnaW4oKSArIF9fbjsKICAgIH0KCgogICAgdGVt
cGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsCiAgICAgIHR5cGVuYW1lID0gc3RkOjpfUmVx
dWlyZUlucHV0SXRlcjxfSW5wdXRJdGVyYXRvcj4+CiAgICAgIGl0ZXJhdG9yCiAgICAgIGluc2Vy
dChjb25zdF9pdGVyYXRvciBfX3Bvc2l0aW9uLAogICAgICBfSW5wdXRJdGVyYXRvciBfX2ZpcnN0
LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QpCiAgICAgIHsKIGRpZmZlcmVuY2VfdHlwZSBfX29mZnNl
dCA9IF9fcG9zaXRpb24gLSBjYmVnaW4oKTsKIF9NX2luc2VydF9kaXNwYXRjaChfX3Bvc2l0aW9u
Ll9NX2NvbnN0X2Nhc3QoKSwKICAgICAgX19maXJzdCwgX19sYXN0LCBfX2ZhbHNlX3R5cGUoKSk7
CiByZXR1cm4gYmVnaW4oKSArIF9fb2Zmc2V0OwogICAgICB9CiMgOTg5ICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RsX2J2ZWN0b3IuaCIgMwogICAgaXRlcmF0b3IKICAgIGluc2VydChj
b25zdF9pdGVyYXRvciBfX3Bvc2l0aW9uLCBzaXplX3R5cGUgX19uLCBjb25zdCBib29sJiBfX3gp
CiAgICB7CiAgICAgIGRpZmZlcmVuY2VfdHlwZSBfX29mZnNldCA9IF9fcG9zaXRpb24gLSBjYmVn
aW4oKTsKICAgICAgX01fZmlsbF9pbnNlcnQoX19wb3NpdGlvbi5fTV9jb25zdF9jYXN0KCksIF9f
biwgX194KTsKICAgICAgcmV0dXJuIGJlZ2luKCkgKyBfX29mZnNldDsKICAgIH0KCgoKCgoKCiAg
ICBpdGVyYXRvcgogICAgaW5zZXJ0KGNvbnN0X2l0ZXJhdG9yIF9fcCwgaW5pdGlhbGl6ZXJfbGlz
dDxib29sPiBfX2wpCiAgICB7IHJldHVybiB0aGlzLT5pbnNlcnQoX19wLCBfX2wuYmVnaW4oKSwg
X19sLmVuZCgpKTsgfQoKCiAgICB2b2lkCiAgICBwb3BfYmFjaygpCiAgICB7IC0tdGhpcy0+X01f
aW1wbC5fTV9maW5pc2g7IH0KCiAgICBpdGVyYXRvcgoKICAgIGVyYXNlKGNvbnN0X2l0ZXJhdG9y
IF9fcG9zaXRpb24pCgoKCiAgICB7IHJldHVybiBfTV9lcmFzZShfX3Bvc2l0aW9uLl9NX2NvbnN0
X2Nhc3QoKSk7IH0KCiAgICBpdGVyYXRvcgoKICAgIGVyYXNlKGNvbnN0X2l0ZXJhdG9yIF9fZmly
c3QsIGNvbnN0X2l0ZXJhdG9yIF9fbGFzdCkKCgoKICAgIHsgcmV0dXJuIF9NX2VyYXNlKF9fZmly
c3QuX01fY29uc3RfY2FzdCgpLCBfX2xhc3QuX01fY29uc3RfY2FzdCgpKTsgfQoKICAgIHZvaWQK
ICAgIHJlc2l6ZShzaXplX3R5cGUgX19uZXdfc2l6ZSwgYm9vbCBfX3ggPSBib29sKCkpCiAgICB7
CiAgICAgIGlmIChfX25ld19zaXplIDwgc2l6ZSgpKQogICAgICAgIF9NX2VyYXNlX2F0X2VuZChi
ZWdpbigpICsgZGlmZmVyZW5jZV90eXBlKF9fbmV3X3NpemUpKTsKICAgICAgZWxzZQogICAgICAg
IGluc2VydChlbmQoKSwgX19uZXdfc2l6ZSAtIHNpemUoKSwgX194KTsKICAgIH0KCgogICAgdm9p
ZAogICAgc2hyaW5rX3RvX2ZpdCgpCiAgICB7IF9NX3Nocmlua190b19maXQoKTsgfQoKCiAgICB2
b2lkCiAgICBmbGlwKCkgbm9leGNlcHQKICAgIHsKICAgICAgX0JpdF90eXBlICogY29uc3QgX19l
bmQgPSB0aGlzLT5fTV9pbXBsLl9NX2VuZF9hZGRyKCk7CiAgICAgIGZvciAoX0JpdF90eXBlICog
X19wID0gdGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9wOyBfX3AgIT0gX19lbmQ7ICsrX19wKQog
ICAgICAgICpfX3AgPSB+Kl9fcDsKICAgIH0KCiAgICB2b2lkCiAgICBjbGVhcigpIG5vZXhjZXB0
CiAgICB7IF9NX2VyYXNlX2F0X2VuZChiZWdpbigpKTsgfQoKCiAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZS4uLiBfQXJncz4KICAgICAgdm9pZAogICAgICBlbXBsYWNlX2JhY2soX0FyZ3MmJi4uLiBfX2Fy
Z3MpCiAgICAgIHsgcHVzaF9iYWNrKGJvb2woX19hcmdzLi4uKSk7IH0KCiAgICB0ZW1wbGF0ZTx0
eXBlbmFtZS4uLiBfQXJncz4KICAgICAgaXRlcmF0b3IKICAgICAgZW1wbGFjZShjb25zdF9pdGVy
YXRvciBfX3BvcywgX0FyZ3MmJi4uLiBfX2FyZ3MpCiAgICAgIHsgcmV0dXJuIGluc2VydChfX3Bv
cywgYm9vbChfX2FyZ3MuLi4pKTsgfQoKCiAgcHJvdGVjdGVkOgoKICAgIGl0ZXJhdG9yCiAgICBf
TV9jb3B5X2FsaWduZWQoY29uc3RfaXRlcmF0b3IgX19maXJzdCwgY29uc3RfaXRlcmF0b3IgX19s
YXN0LAogICAgICBpdGVyYXRvciBfX3Jlc3VsdCkKICAgIHsKICAgICAgX0JpdF90eXBlKiBfX3Eg
PSBzdGQ6OmNvcHkoX19maXJzdC5fTV9wLCBfX2xhc3QuX01fcCwgX19yZXN1bHQuX01fcCk7CiAg
ICAgIHJldHVybiBzdGQ6OmNvcHkoY29uc3RfaXRlcmF0b3IoX19sYXN0Ll9NX3AsIDApLCBfX2xh
c3QsCiAgICAgICAgIGl0ZXJhdG9yKF9fcSwgMCkpOwogICAgfQoKICAgIHZvaWQKICAgIF9NX2lu
aXRpYWxpemUoc2l6ZV90eXBlIF9fbikKICAgIHsKICAgICAgX0JpdF9wb2ludGVyIF9fcSA9IHRo
aXMtPl9NX2FsbG9jYXRlKF9fbik7CiAgICAgIHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3Jh
Z2UgPSBfX3EgKyBfU19ud29yZChfX24pOwogICAgICB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0ID0g
aXRlcmF0b3Ioc3RkOjpfX2FkZHJlc3NvZigqX19xKSwgMCk7CiAgICAgIHRoaXMtPl9NX2ltcGwu
X01fZmluaXNoID0gdGhpcy0+X01faW1wbC5fTV9zdGFydCArIGRpZmZlcmVuY2VfdHlwZShfX24p
OwogICAgfQoKICAgIHZvaWQKICAgIF9NX3JlYWxsb2NhdGUoc2l6ZV90eXBlIF9fbik7CgoKICAg
IGJvb2wKICAgIF9NX3Nocmlua190b19maXQoKTsKCgoKCgoKICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9JbnRlZ2VyPgogICAgICB2b2lkCiAgICAgIF9NX2luaXRpYWxpemVfZGlzcGF0Y2goX0ludGVn
ZXIgX19uLCBfSW50ZWdlciBfX3gsIF9fdHJ1ZV90eXBlKQogICAgICB7CiBfTV9pbml0aWFsaXpl
KHN0YXRpY19jYXN0PHNpemVfdHlwZT4oX19uKSk7CiBzdGQ6OmZpbGwodGhpcy0+X01faW1wbC5f
TV9zdGFydC5fTV9wLAogICAgdGhpcy0+X01faW1wbC5fTV9lbmRfYWRkcigpLCBfX3ggPyB+MCA6
IDApOwogICAgICB9CgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3I+CiAgICAg
IHZvaWQKICAgICAgX01faW5pdGlhbGl6ZV9kaXNwYXRjaChfSW5wdXRJdGVyYXRvciBfX2ZpcnN0
LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QsCiAgICAgICAgX19mYWxzZV90eXBlKQogICAgICB7IF9N
X2luaXRpYWxpemVfcmFuZ2UoX19maXJzdCwgX19sYXN0LAogICAgICAgc3RkOjpfX2l0ZXJhdG9y
X2NhdGVnb3J5KF9fZmlyc3QpKTsgfQoKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJh
dG9yPgogICAgICB2b2lkCiAgICAgIF9NX2luaXRpYWxpemVfcmFuZ2UoX0lucHV0SXRlcmF0b3Ig
X19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgIHN0ZDo6aW5wdXRfaXRlcmF0b3Jf
dGFnKQogICAgICB7CiBmb3IgKDsgX19maXJzdCAhPSBfX2xhc3Q7ICsrX19maXJzdCkKICAgcHVz
aF9iYWNrKCpfX2ZpcnN0KTsKICAgICAgfQoKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJk
SXRlcmF0b3I+CiAgICAgIHZvaWQKICAgICAgX01faW5pdGlhbGl6ZV9yYW5nZShfRm9yd2FyZEl0
ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0LAogICAgIHN0ZDo6Zm9yd2Fy
ZF9pdGVyYXRvcl90YWcpCiAgICAgIHsKIGNvbnN0IHNpemVfdHlwZSBfX24gPSBzdGQ6OmRpc3Rh
bmNlKF9fZmlyc3QsIF9fbGFzdCk7CiBfTV9pbml0aWFsaXplKF9fbik7CiBzdGQ6OmNvcHkoX19m
aXJzdCwgX19sYXN0LCB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0KTsKICAgICAgfQoKCgogICAgdGVt
cGxhdGU8dHlwZW5hbWUgX0ludGVnZXI+CiAgICAgIHZvaWQKICAgICAgX01fYXNzaWduX2Rpc3Bh
dGNoKF9JbnRlZ2VyIF9fbiwgX0ludGVnZXIgX192YWwsIF9fdHJ1ZV90eXBlKQogICAgICB7IF9N
X2ZpbGxfYXNzaWduKF9fbiwgX192YWwpOyB9CgogICAgdGVtcGxhdGU8Y2xhc3MgX0lucHV0SXRl
cmF0b3I+CiAgICAgIHZvaWQKICAgICAgX01fYXNzaWduX2Rpc3BhdGNoKF9JbnB1dEl0ZXJhdG9y
IF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgIF9fZmFsc2VfdHlwZSkKICAgICAg
eyBfTV9hc3NpZ25fYXV4KF9fZmlyc3QsIF9fbGFzdCwgc3RkOjpfX2l0ZXJhdG9yX2NhdGVnb3J5
KF9fZmlyc3QpKTsgfQoKICAgIHZvaWQKICAgIF9NX2ZpbGxfYXNzaWduKHNpemVfdCBfX24sIGJv
b2wgX194KQogICAgewogICAgICBpZiAoX19uID4gc2l6ZSgpKQogewogICBzdGQ6OmZpbGwodGhp
cy0+X01faW1wbC5fTV9zdGFydC5fTV9wLAogICAgICB0aGlzLT5fTV9pbXBsLl9NX2VuZF9hZGRy
KCksIF9feCA/IH4wIDogMCk7CiAgIGluc2VydChlbmQoKSwgX19uIC0gc2l6ZSgpLCBfX3gpOwog
fQogICAgICBlbHNlCiB7CiAgIF9NX2VyYXNlX2F0X2VuZChiZWdpbigpICsgX19uKTsKICAgc3Rk
OjpmaWxsKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fcCwKICAgICAgdGhpcy0+X01faW1wbC5f
TV9lbmRfYWRkcigpLCBfX3ggPyB+MCA6IDApOwogfQogICAgfQoKICAgIHRlbXBsYXRlPHR5cGVu
YW1lIF9JbnB1dEl0ZXJhdG9yPgogICAgICB2b2lkCiAgICAgIF9NX2Fzc2lnbl9hdXgoX0lucHV0
SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgICBzdGQ6OmlucHV0
X2l0ZXJhdG9yX3RhZykKICAgICAgewogaXRlcmF0b3IgX19jdXIgPSBiZWdpbigpOwogZm9yICg7
IF9fZmlyc3QgIT0gX19sYXN0ICYmIF9fY3VyICE9IGVuZCgpOyArK19fY3VyLCArK19fZmlyc3Qp
CiAgICpfX2N1ciA9ICpfX2ZpcnN0OwogaWYgKF9fZmlyc3QgPT0gX19sYXN0KQogICBfTV9lcmFz
ZV9hdF9lbmQoX19jdXIpOwogZWxzZQogICBpbnNlcnQoZW5kKCksIF9fZmlyc3QsIF9fbGFzdCk7
CiAgICAgIH0KCiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yPgogICAgICB2
b2lkCiAgICAgIF9NX2Fzc2lnbl9hdXgoX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2Fy
ZEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgc3RkOjpmb3J3YXJkX2l0ZXJhdG9yX3RhZykKICAgICAg
ewogY29uc3Qgc2l6ZV90eXBlIF9fbGVuID0gc3RkOjpkaXN0YW5jZShfX2ZpcnN0LCBfX2xhc3Qp
OwogaWYgKF9fbGVuIDwgc2l6ZSgpKQogICBfTV9lcmFzZV9hdF9lbmQoc3RkOjpjb3B5KF9fZmly
c3QsIF9fbGFzdCwgYmVnaW4oKSkpOwogZWxzZQogICB7CiAgICAgX0ZvcndhcmRJdGVyYXRvciBf
X21pZCA9IF9fZmlyc3Q7CiAgICAgc3RkOjphZHZhbmNlKF9fbWlkLCBzaXplKCkpOwogICAgIHN0
ZDo6Y29weShfX2ZpcnN0LCBfX21pZCwgYmVnaW4oKSk7CiAgICAgaW5zZXJ0KGVuZCgpLCBfX21p
ZCwgX19sYXN0KTsKICAgfQogICAgICB9CgoKCgoKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnRl
Z2VyPgogICAgICB2b2lkCiAgICAgIF9NX2luc2VydF9kaXNwYXRjaChpdGVyYXRvciBfX3Bvcywg
X0ludGVnZXIgX19uLCBfSW50ZWdlciBfX3gsCiAgICBfX3RydWVfdHlwZSkKICAgICAgeyBfTV9m
aWxsX2luc2VydChfX3BvcywgX19uLCBfX3gpOyB9CgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0lu
cHV0SXRlcmF0b3I+CiAgICAgIHZvaWQKICAgICAgX01faW5zZXJ0X2Rpc3BhdGNoKGl0ZXJhdG9y
IF9fcG9zLAogICAgX0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0
LAogICAgX19mYWxzZV90eXBlKQogICAgICB7IF9NX2luc2VydF9yYW5nZShfX3BvcywgX19maXJz
dCwgX19sYXN0LAogICBzdGQ6Ol9faXRlcmF0b3JfY2F0ZWdvcnkoX19maXJzdCkpOyB9CgogICAg
dm9pZAogICAgX01fZmlsbF9pbnNlcnQoaXRlcmF0b3IgX19wb3NpdGlvbiwgc2l6ZV90eXBlIF9f
biwgYm9vbCBfX3gpOwoKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yPgogICAg
ICB2b2lkCiAgICAgIF9NX2luc2VydF9yYW5nZShpdGVyYXRvciBfX3BvcywgX0lucHV0SXRlcmF0
b3IgX19maXJzdCwKICAgICAgICBfSW5wdXRJdGVyYXRvciBfX2xhc3QsIHN0ZDo6aW5wdXRfaXRl
cmF0b3JfdGFnKQogICAgICB7CiBmb3IgKDsgX19maXJzdCAhPSBfX2xhc3Q7ICsrX19maXJzdCkK
ICAgewogICAgIF9fcG9zID0gaW5zZXJ0KF9fcG9zLCAqX19maXJzdCk7CiAgICAgKytfX3BvczsK
ICAgfQogICAgICB9CgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0ZvcndhcmRJdGVyYXRvcj4KICAg
ICAgdm9pZAogICAgICBfTV9pbnNlcnRfcmFuZ2UoaXRlcmF0b3IgX19wb3NpdGlvbiwgX0Zvcndh
cmRJdGVyYXRvciBfX2ZpcnN0LAogICAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0LCBzdGQ6
OmZvcndhcmRfaXRlcmF0b3JfdGFnKTsKCiAgICB2b2lkCiAgICBfTV9pbnNlcnRfYXV4KGl0ZXJh
dG9yIF9fcG9zaXRpb24sIGJvb2wgX194KTsKCiAgICBzaXplX3R5cGUKICAgIF9NX2NoZWNrX2xl
bihzaXplX3R5cGUgX19uLCBjb25zdCBjaGFyKiBfX3MpIGNvbnN0CiAgICB7CiAgICAgIGlmICht
YXhfc2l6ZSgpIC0gc2l6ZSgpIDwgX19uKQogX190aHJvd19sZW5ndGhfZXJyb3IoKF9fcykpOwoK
ICAgICAgY29uc3Qgc2l6ZV90eXBlIF9fbGVuID0gc2l6ZSgpICsgc3RkOjptYXgoc2l6ZSgpLCBf
X24pOwogICAgICByZXR1cm4gKF9fbGVuIDwgc2l6ZSgpIHx8IF9fbGVuID4gbWF4X3NpemUoKSkg
PyBtYXhfc2l6ZSgpIDogX19sZW47CiAgICB9CgogICAgdm9pZAogICAgX01fZXJhc2VfYXRfZW5k
KGl0ZXJhdG9yIF9fcG9zKQogICAgeyB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCA9IF9fcG9zOyB9
CgogICAgaXRlcmF0b3IKICAgIF9NX2VyYXNlKGl0ZXJhdG9yIF9fcG9zKTsKCiAgICBpdGVyYXRv
cgogICAgX01fZXJhc2UoaXRlcmF0b3IgX19maXJzdCwgaXRlcmF0b3IgX19sYXN0KTsKICB9OwoK
Cn0KCgoKCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRl
ZmF1bHQiKSkpCnsKCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jPgogICAgc3RydWN0IGhh
c2g8c3RkOjp2ZWN0b3I8Ym9vbCwgX0FsbG9jPj4KICAgIDogcHVibGljIF9faGFzaF9iYXNlPHNp
emVfdCwgc3RkOjp2ZWN0b3I8Ym9vbCwgX0FsbG9jPj4KICAgIHsKICAgICAgc2l6ZV90CiAgICAg
IG9wZXJhdG9yKCkoY29uc3Qgc3RkOjp2ZWN0b3I8Ym9vbCwgX0FsbG9jPiYpIGNvbnN0IG5vZXhj
ZXB0OwogICAgfTsKCgp9CiMgNjYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdmVjdG9yIiAyIDMK
CgoKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvdmVjdG9yLnRjYyIgMSAzCiMgNTkg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy92ZWN0b3IudGNjIiAzCm5hbWVzcGFjZSBzdGQg
X19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB2b2lkCiAgICB2ZWN0b3I8X1Rw
LCBfQWxsb2M+OjoKICAgIHJlc2VydmUoc2l6ZV90eXBlIF9fbikKICAgIHsKICAgICAgaWYgKF9f
biA+IHRoaXMtPm1heF9zaXplKCkpCiBfX3Rocm93X2xlbmd0aF9lcnJvcigoInZlY3Rvcjo6cmVz
ZXJ2ZSIpKTsKICAgICAgaWYgKHRoaXMtPmNhcGFjaXR5KCkgPCBfX24pCiB7CiAgIGNvbnN0IHNp
emVfdHlwZSBfX29sZF9zaXplID0gc2l6ZSgpOwogICBwb2ludGVyIF9fdG1wID0gX01fYWxsb2Nh
dGVfYW5kX2NvcHkoX19uLAogICAgIHN0ZDo6X19tYWtlX21vdmVfaWZfbm9leGNlcHRfaXRlcmF0
b3IodGhpcy0+X01faW1wbC5fTV9zdGFydCksCiAgICAgc3RkOjpfX21ha2VfbW92ZV9pZl9ub2V4
Y2VwdF9pdGVyYXRvcih0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCkpOwogICBzdGQ6Ol9EZXN0cm95
KHRoaXMtPl9NX2ltcGwuX01fc3RhcnQsIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoLAogICBfTV9n
ZXRfVHBfYWxsb2NhdG9yKCkpOwogICBfTV9kZWFsbG9jYXRlKHRoaXMtPl9NX2ltcGwuX01fc3Rh
cnQsCiAgIHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UKICAgLSB0aGlzLT5fTV9pbXBs
Ll9NX3N0YXJ0KTsKICAgdGhpcy0+X01faW1wbC5fTV9zdGFydCA9IF9fdG1wOwogICB0aGlzLT5f
TV9pbXBsLl9NX2ZpbmlzaCA9IF9fdG1wICsgX19vbGRfc2l6ZTsKICAgdGhpcy0+X01faW1wbC5f
TV9lbmRfb2Zfc3RvcmFnZSA9IHRoaXMtPl9NX2ltcGwuX01fc3RhcnQgKyBfX247CiB9CiAgICB9
CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHRlbXBsYXRl
PHR5cGVuYW1lLi4uIF9BcmdzPgogICAgICB2b2lkCiAgICAgIHZlY3RvcjxfVHAsIF9BbGxvYz46
OgogICAgICBlbXBsYWNlX2JhY2soX0FyZ3MmJi4uLiBfX2FyZ3MpCiAgICAgIHsKIGlmICh0aGlz
LT5fTV9pbXBsLl9NX2ZpbmlzaCAhPSB0aGlzLT5fTV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdlKQog
ICB7CiAgICAgX0FsbG9jX3RyYWl0czo6Y29uc3RydWN0KHRoaXMtPl9NX2ltcGwsIHRoaXMtPl9N
X2ltcGwuX01fZmluaXNoLAogICAgICAgICBzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4p
OwogICAgICsrdGhpcy0+X01faW1wbC5fTV9maW5pc2g7CiAgIH0KIGVsc2UKICAgX01fZW1wbGFj
ZV9iYWNrX2F1eChzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pOwogICAgICB9CgoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHR5cGVuYW1lIHZlY3Rv
cjxfVHAsIF9BbGxvYz46Oml0ZXJhdG9yCiAgICB2ZWN0b3I8X1RwLCBfQWxsb2M+OjoKCiAgICBp
bnNlcnQoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgY29uc3QgdmFsdWVfdHlwZSYgX194KQoK
CgogICAgewogICAgICBjb25zdCBzaXplX3R5cGUgX19uID0gX19wb3NpdGlvbiAtIGJlZ2luKCk7
CiAgICAgIGlmICh0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCAhPSB0aGlzLT5fTV9pbXBsLl9NX2Vu
ZF9vZl9zdG9yYWdlCiAgICYmIF9fcG9zaXRpb24gPT0gZW5kKCkpCiB7CiAgIF9BbGxvY190cmFp
dHM6OmNvbnN0cnVjdCh0aGlzLT5fTV9pbXBsLCB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwgX194
KTsKICAgKyt0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaDsKIH0KICAgICAgZWxzZQogewoKICAgY29u
c3QgYXV0byBfX3BvcyA9IGJlZ2luKCkgKyAoX19wb3NpdGlvbiAtIGNiZWdpbigpKTsKICAgaWYg
KHRoaXMtPl9NX2ltcGwuX01fZmluaXNoICE9IHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3Jh
Z2UpCiAgICAgewogICAgICAgX1RwIF9feF9jb3B5ID0gX194OwogICAgICAgX01faW5zZXJ0X2F1
eChfX3Bvcywgc3RkOjptb3ZlKF9feF9jb3B5KSk7CiAgICAgfQogICBlbHNlCiAgICAgX01faW5z
ZXJ0X2F1eChfX3BvcywgX194KTsKCgoKIH0KICAgICAgcmV0dXJuIGl0ZXJhdG9yKHRoaXMtPl9N
X2ltcGwuX01fc3RhcnQgKyBfX24pOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5
cGVuYW1lIF9BbGxvYz4KICAgIHR5cGVuYW1lIHZlY3RvcjxfVHAsIF9BbGxvYz46Oml0ZXJhdG9y
CiAgICB2ZWN0b3I8X1RwLCBfQWxsb2M+OjoKICAgIF9NX2VyYXNlKGl0ZXJhdG9yIF9fcG9zaXRp
b24pCiAgICB7CiAgICAgIGlmIChfX3Bvc2l0aW9uICsgMSAhPSBlbmQoKSkKIHN0ZDo6bW92ZShf
X3Bvc2l0aW9uICsgMSwgZW5kKCksIF9fcG9zaXRpb24pOwogICAgICAtLXRoaXMtPl9NX2ltcGwu
X01fZmluaXNoOwogICAgICBfQWxsb2NfdHJhaXRzOjpkZXN0cm95KHRoaXMtPl9NX2ltcGwsIHRo
aXMtPl9NX2ltcGwuX01fZmluaXNoKTsKICAgICAgcmV0dXJuIF9fcG9zaXRpb247CiAgICB9Cgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdHlwZW5hbWUgdmVj
dG9yPF9UcCwgX0FsbG9jPjo6aXRlcmF0b3IKICAgIHZlY3RvcjxfVHAsIF9BbGxvYz46OgogICAg
X01fZXJhc2UoaXRlcmF0b3IgX19maXJzdCwgaXRlcmF0b3IgX19sYXN0KQogICAgewogICAgICBp
ZiAoX19maXJzdCAhPSBfX2xhc3QpCiB7CiAgIGlmIChfX2xhc3QgIT0gZW5kKCkpCiAgICAgc3Rk
Ojptb3ZlKF9fbGFzdCwgZW5kKCksIF9fZmlyc3QpOwogICBfTV9lcmFzZV9hdF9lbmQoX19maXJz
dC5iYXNlKCkgKyAoZW5kKCkgLSBfX2xhc3QpKTsKIH0KICAgICAgcmV0dXJuIF9fZmlyc3Q7CiAg
ICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdmVjdG9y
PF9UcCwgX0FsbG9jPiYKICAgIHZlY3RvcjxfVHAsIF9BbGxvYz46OgogICAgb3BlcmF0b3I9KGNv
bnN0IHZlY3RvcjxfVHAsIF9BbGxvYz4mIF9feCkKICAgIHsKICAgICAgaWYgKCZfX3ggIT0gdGhp
cykKIHsKCiAgIGlmIChfQWxsb2NfdHJhaXRzOjpfU19wcm9wYWdhdGVfb25fY29weV9hc3NpZ24o
KSkKICAgICB7CiAgICAgICBpZiAoIV9BbGxvY190cmFpdHM6Ol9TX2Fsd2F5c19lcXVhbCgpCiAg
ICAgICAgICAgJiYgX01fZ2V0X1RwX2FsbG9jYXRvcigpICE9IF9feC5fTV9nZXRfVHBfYWxsb2Nh
dG9yKCkpCiAgICAgICAgIHsKCiAgICB0aGlzLT5jbGVhcigpOwogICAgX01fZGVhbGxvY2F0ZSh0
aGlzLT5fTV9pbXBsLl9NX3N0YXJ0LAogICAgdGhpcy0+X01faW1wbC5fTV9lbmRfb2Zfc3RvcmFn
ZQogICAgLSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0KTsKICAgIHRoaXMtPl9NX2ltcGwuX01fc3Rh
cnQgPSBudWxscHRyOwogICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2ggPSBudWxscHRyOwogICAg
dGhpcy0+X01faW1wbC5fTV9lbmRfb2Zfc3RvcmFnZSA9IG51bGxwdHI7CiAgfQogICAgICAgc3Rk
OjpfX2FsbG9jX29uX2NvcHkoX01fZ2V0X1RwX2FsbG9jYXRvcigpLAogICAgICAgX194Ll9NX2dl
dF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgfQoKICAgY29uc3Qgc2l6ZV90eXBlIF9feGxlbiA9IF9f
eC5zaXplKCk7CiAgIGlmIChfX3hsZW4gPiBjYXBhY2l0eSgpKQogICAgIHsKICAgICAgIHBvaW50
ZXIgX190bXAgPSBfTV9hbGxvY2F0ZV9hbmRfY29weShfX3hsZW4sIF9feC5iZWdpbigpLAogICAg
ICAgICBfX3guZW5kKCkpOwogICAgICAgc3RkOjpfRGVzdHJveSh0aGlzLT5fTV9pbXBsLl9NX3N0
YXJ0LCB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3Io
KSk7CiAgICAgICBfTV9kZWFsbG9jYXRlKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQsCiAgICAgICB0
aGlzLT5fTV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdlCiAgICAgICAtIHRoaXMtPl9NX2ltcGwuX01f
c3RhcnQpOwogICAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydCA9IF9fdG1wOwogICAgICAgdGhp
cy0+X01faW1wbC5fTV9lbmRfb2Zfc3RvcmFnZSA9IHRoaXMtPl9NX2ltcGwuX01fc3RhcnQgKyBf
X3hsZW47CiAgICAgfQogICBlbHNlIGlmIChzaXplKCkgPj0gX194bGVuKQogICAgIHsKICAgICAg
IHN0ZDo6X0Rlc3Ryb3koc3RkOjpjb3B5KF9feC5iZWdpbigpLCBfX3guZW5kKCksIGJlZ2luKCkp
LAogICAgICAgZW5kKCksIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgfQogICBlbHNlCiAg
ICAgewogICAgICAgc3RkOjpjb3B5KF9feC5fTV9pbXBsLl9NX3N0YXJ0LCBfX3guX01faW1wbC5f
TV9zdGFydCArIHNpemUoKSwKICAgdGhpcy0+X01faW1wbC5fTV9zdGFydCk7CiAgICAgICBzdGQ6
Ol9fdW5pbml0aWFsaXplZF9jb3B5X2EoX194Ll9NX2ltcGwuX01fc3RhcnQgKyBzaXplKCksCiAg
ICAgICBfX3guX01faW1wbC5fTV9maW5pc2gsCiAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2Zpbmlz
aCwKICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgfQogICB0aGlzLT5fTV9pbXBs
Ll9NX2ZpbmlzaCA9IHRoaXMtPl9NX2ltcGwuX01fc3RhcnQgKyBfX3hsZW47CiB9CiAgICAgIHJl
dHVybiAqdGhpczsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxs
b2M+CiAgICB2b2lkCiAgICB2ZWN0b3I8X1RwLCBfQWxsb2M+OjoKICAgIF9NX2ZpbGxfYXNzaWdu
KHNpemVfdCBfX24sIGNvbnN0IHZhbHVlX3R5cGUmIF9fdmFsKQogICAgewogICAgICBpZiAoX19u
ID4gY2FwYWNpdHkoKSkKIHsKICAgdmVjdG9yIF9fdG1wKF9fbiwgX192YWwsIF9NX2dldF9UcF9h
bGxvY2F0b3IoKSk7CiAgIF9fdG1wLl9NX2ltcGwuX01fc3dhcF9kYXRhKHRoaXMtPl9NX2ltcGwp
OwogfQogICAgICBlbHNlIGlmIChfX24gPiBzaXplKCkpCiB7CiAgIHN0ZDo6ZmlsbChiZWdpbigp
LCBlbmQoKSwgX192YWwpOwogICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCA9CiAgICAgc3RkOjpf
X3VuaW5pdGlhbGl6ZWRfZmlsbF9uX2EodGhpcy0+X01faW1wbC5fTV9maW5pc2gsCiAgICAgICBf
X24gLSBzaXplKCksIF9fdmFsLAogICAgICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKIH0KICAg
ICAgZWxzZQogICAgICAgIF9NX2VyYXNlX2F0X2VuZChzdGQ6OmZpbGxfbih0aGlzLT5fTV9pbXBs
Ll9NX3N0YXJ0LCBfX24sIF9fdmFsKSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwg
dHlwZW5hbWUgX0FsbG9jPgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3I+CiAg
ICAgIHZvaWQKICAgICAgdmVjdG9yPF9UcCwgX0FsbG9jPjo6CiAgICAgIF9NX2Fzc2lnbl9hdXgo
X0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgICBzdGQ6
OmlucHV0X2l0ZXJhdG9yX3RhZykKICAgICAgewogcG9pbnRlciBfX2N1cih0aGlzLT5fTV9pbXBs
Ll9NX3N0YXJ0KTsKIGZvciAoOyBfX2ZpcnN0ICE9IF9fbGFzdCAmJiBfX2N1ciAhPSB0aGlzLT5f
TV9pbXBsLl9NX2ZpbmlzaDsKICAgICAgKytfX2N1ciwgKytfX2ZpcnN0KQogICAqX19jdXIgPSAq
X19maXJzdDsKIGlmIChfX2ZpcnN0ID09IF9fbGFzdCkKICAgX01fZXJhc2VfYXRfZW5kKF9fY3Vy
KTsKIGVsc2UKICAgaW5zZXJ0KGVuZCgpLCBfX2ZpcnN0LCBfX2xhc3QpOwogICAgICB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdGVtcGxhdGU8dHlwZW5h
bWUgX0ZvcndhcmRJdGVyYXRvcj4KICAgICAgdm9pZAogICAgICB2ZWN0b3I8X1RwLCBfQWxsb2M+
OjoKICAgICAgX01fYXNzaWduX2F1eChfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJk
SXRlcmF0b3IgX19sYXN0LAogICAgICBzdGQ6OmZvcndhcmRfaXRlcmF0b3JfdGFnKQogICAgICB7
CiBjb25zdCBzaXplX3R5cGUgX19sZW4gPSBzdGQ6OmRpc3RhbmNlKF9fZmlyc3QsIF9fbGFzdCk7
CgogaWYgKF9fbGVuID4gY2FwYWNpdHkoKSkKICAgewogICAgIHBvaW50ZXIgX190bXAoX01fYWxs
b2NhdGVfYW5kX2NvcHkoX19sZW4sIF9fZmlyc3QsIF9fbGFzdCkpOwogICAgIHN0ZDo6X0Rlc3Ry
b3kodGhpcy0+X01faW1wbC5fTV9zdGFydCwgdGhpcy0+X01faW1wbC5fTV9maW5pc2gsCiAgICAg
X01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICAgICBfTV9kZWFsbG9jYXRlKHRoaXMtPl9NX2ltcGwu
X01fc3RhcnQsCiAgICAgdGhpcy0+X01faW1wbC5fTV9lbmRfb2Zfc3RvcmFnZQogICAgIC0gdGhp
cy0+X01faW1wbC5fTV9zdGFydCk7CiAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydCA9IF9fdG1w
OwogICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoID0gdGhpcy0+X01faW1wbC5fTV9zdGFydCAr
IF9fbGVuOwogICAgIHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UgPSB0aGlzLT5fTV9p
bXBsLl9NX2ZpbmlzaDsKICAgfQogZWxzZSBpZiAoc2l6ZSgpID49IF9fbGVuKQogICBfTV9lcmFz
ZV9hdF9lbmQoc3RkOjpjb3B5KF9fZmlyc3QsIF9fbGFzdCwgdGhpcy0+X01faW1wbC5fTV9zdGFy
dCkpOwogZWxzZQogICB7CiAgICAgX0ZvcndhcmRJdGVyYXRvciBfX21pZCA9IF9fZmlyc3Q7CiAg
ICAgc3RkOjphZHZhbmNlKF9fbWlkLCBzaXplKCkpOwogICAgIHN0ZDo6Y29weShfX2ZpcnN0LCBf
X21pZCwgdGhpcy0+X01faW1wbC5fTV9zdGFydCk7CiAgICAgdGhpcy0+X01faW1wbC5fTV9maW5p
c2ggPQogICAgICAgc3RkOjpfX3VuaW5pdGlhbGl6ZWRfY29weV9hKF9fbWlkLCBfX2xhc3QsCiAg
ICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3Io
KSk7CiAgIH0KICAgICAgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxs
b2M+CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfQXJncz4KICAgICAgdHlwZW5hbWUgdmVjdG9y
PF9UcCwgX0FsbG9jPjo6aXRlcmF0b3IKICAgICAgdmVjdG9yPF9UcCwgX0FsbG9jPjo6CiAgICAg
IGVtcGxhY2UoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgX0FyZ3MmJi4uLiBfX2FyZ3MpCiAg
ICAgIHsKIGNvbnN0IHNpemVfdHlwZSBfX24gPSBfX3Bvc2l0aW9uIC0gYmVnaW4oKTsKIGlmICh0
aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCAhPSB0aGlzLT5fTV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdl
CiAgICAgJiYgX19wb3NpdGlvbiA9PSBlbmQoKSkKICAgewogICAgIF9BbGxvY190cmFpdHM6OmNv
bnN0cnVjdCh0aGlzLT5fTV9pbXBsLCB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAgICAgICAg
c3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsKICAgICArK3RoaXMtPl9NX2ltcGwuX01f
ZmluaXNoOwogICB9CiBlbHNlCiAgIF9NX2luc2VydF9hdXgoYmVnaW4oKSArIChfX3Bvc2l0aW9u
IC0gY2JlZ2luKCkpLAogICBzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pOwogcmV0dXJu
IGl0ZXJhdG9yKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQgKyBfX24pOwogICAgICB9CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdGVtcGxhdGU8dHlwZW5hbWUu
Li4gX0FyZ3M+CiAgICAgIHZvaWQKICAgICAgdmVjdG9yPF9UcCwgX0FsbG9jPjo6CiAgICAgIF9N
X2luc2VydF9hdXgoaXRlcmF0b3IgX19wb3NpdGlvbiwgX0FyZ3MmJi4uLiBfX2FyZ3MpCgoKCgoK
CiAgICB7CiAgICAgIGlmICh0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCAhPSB0aGlzLT5fTV9pbXBs
Ll9NX2VuZF9vZl9zdG9yYWdlKQogewogICBfQWxsb2NfdHJhaXRzOjpjb25zdHJ1Y3QodGhpcy0+
X01faW1wbCwgdGhpcy0+X01faW1wbC5fTV9maW5pc2gsCiAgICAgICAgICAgICAgc3RkOjptb3Zl
KCoodGhpcy0+X01faW1wbC5fTV9maW5pc2ggLSAxKSkKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICk7CiAgICsrdGhpcy0+X01faW1wbC5fTV9maW5pc2g7CgoKCiAgIHN0ZDo6bW92ZV9iYWNr
d2FyZChfX3Bvc2l0aW9uLmJhc2UoKSwgdGhpcy0+X01faW1wbC5fTV9maW5pc2ggLSAyLCB0aGlz
LT5fTV9pbXBsLl9NX2ZpbmlzaCAtIDEpCgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgOwoKCgogICAqX19wb3NpdGlvbiA9IF9UcChzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncyku
Li4pOwoKIH0KICAgICAgZWxzZQogewogICBjb25zdCBzaXplX3R5cGUgX19sZW4gPQogICAgIF9N
X2NoZWNrX2xlbihzaXplX3R5cGUoMSksICJ2ZWN0b3I6Ol9NX2luc2VydF9hdXgiKTsKICAgY29u
c3Qgc2l6ZV90eXBlIF9fZWxlbXNfYmVmb3JlID0gX19wb3NpdGlvbiAtIGJlZ2luKCk7CiAgIHBv
aW50ZXIgX19uZXdfc3RhcnQodGhpcy0+X01fYWxsb2NhdGUoX19sZW4pKTsKICAgcG9pbnRlciBf
X25ld19maW5pc2goX19uZXdfc3RhcnQpOwogICB0cnkKICAgICB7CgoKCgogICAgICAgX0FsbG9j
X3RyYWl0czo6Y29uc3RydWN0KHRoaXMtPl9NX2ltcGwsCiAgICAgICAgICAgICAgICAgICAgICAg
ICBfX25ld19zdGFydCArIF9fZWxlbXNfYmVmb3JlLAoKICAgICAgICAgICBzdGQ6OmZvcndhcmQ8
X0FyZ3M+KF9fYXJncykuLi4pOwoKCgogICAgICAgX19uZXdfZmluaXNoID0gcG9pbnRlcigpOwoK
ICAgICAgIF9fbmV3X2ZpbmlzaAogID0gc3RkOjpfX3VuaW5pdGlhbGl6ZWRfbW92ZV9pZl9ub2V4
Y2VwdF9hCiAgKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQsIF9fcG9zaXRpb24uYmFzZSgpLAogICBf
X25ld19zdGFydCwgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKCiAgICAgICArK19fbmV3X2Zpbmlz
aDsKCiAgICAgICBfX25ld19maW5pc2gKICA9IHN0ZDo6X191bmluaXRpYWxpemVkX21vdmVfaWZf
bm9leGNlcHRfYQogIChfX3Bvc2l0aW9uLmJhc2UoKSwgdGhpcy0+X01faW1wbC5fTV9maW5pc2gs
CiAgIF9fbmV3X2ZpbmlzaCwgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICAgICB9CiAgICAgICAg
ICBjYXRjaCguLi4pCiAgICAgewogICAgICAgaWYgKCFfX25ld19maW5pc2gpCiAgX0FsbG9jX3Ry
YWl0czo6ZGVzdHJveSh0aGlzLT5fTV9pbXBsLAogICAgICAgICAgICAgICAgICAgICAgICAgX19u
ZXdfc3RhcnQgKyBfX2VsZW1zX2JlZm9yZSk7CiAgICAgICBlbHNlCiAgc3RkOjpfRGVzdHJveShf
X25ld19zdGFydCwgX19uZXdfZmluaXNoLCBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgICAg
X01fZGVhbGxvY2F0ZShfX25ld19zdGFydCwgX19sZW4pOwogICAgICAgdGhyb3c7CiAgICAgfQog
ICBzdGQ6Ol9EZXN0cm95KHRoaXMtPl9NX2ltcGwuX01fc3RhcnQsIHRoaXMtPl9NX2ltcGwuX01f
ZmluaXNoLAogICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICBfTV9kZWFsbG9jYXRlKHRoaXMt
Pl9NX2ltcGwuX01fc3RhcnQsCiAgIHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UKICAg
LSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0KTsKICAgdGhpcy0+X01faW1wbC5fTV9zdGFydCA9IF9f
bmV3X3N0YXJ0OwogICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCA9IF9fbmV3X2ZpbmlzaDsKICAg
dGhpcy0+X01faW1wbC5fTV9lbmRfb2Zfc3RvcmFnZSA9IF9fbmV3X3N0YXJ0ICsgX19sZW47CiB9
CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHRl
bXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogICAgICB2b2lkCiAgICAgIHZlY3RvcjxfVHAsIF9B
bGxvYz46OgogICAgICBfTV9lbXBsYWNlX2JhY2tfYXV4KF9BcmdzJiYuLi4gX19hcmdzKQogICAg
ICB7CiBjb25zdCBzaXplX3R5cGUgX19sZW4gPQogICBfTV9jaGVja19sZW4oc2l6ZV90eXBlKDEp
LCAidmVjdG9yOjpfTV9lbXBsYWNlX2JhY2tfYXV4Iik7CiBwb2ludGVyIF9fbmV3X3N0YXJ0KHRo
aXMtPl9NX2FsbG9jYXRlKF9fbGVuKSk7CiBwb2ludGVyIF9fbmV3X2ZpbmlzaChfX25ld19zdGFy
dCk7CiB0cnkKICAgewogICAgIF9BbGxvY190cmFpdHM6OmNvbnN0cnVjdCh0aGlzLT5fTV9pbXBs
LCBfX25ld19zdGFydCArIHNpemUoKSwKICAgICAgICAgc3RkOjpmb3J3YXJkPF9BcmdzPihfX2Fy
Z3MpLi4uKTsKICAgICBfX25ld19maW5pc2ggPSBwb2ludGVyKCk7CgogICAgIF9fbmV3X2Zpbmlz
aAogICAgICAgPSBzdGQ6Ol9fdW5pbml0aWFsaXplZF9tb3ZlX2lmX25vZXhjZXB0X2EKICAgICAg
ICh0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0LCB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAgICAg
ICBfX25ld19zdGFydCwgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKCiAgICAgKytfX25ld19maW5p
c2g7CiAgIH0KIGNhdGNoKC4uLikKICAgewogICAgIGlmICghX19uZXdfZmluaXNoKQogICAgICAg
X0FsbG9jX3RyYWl0czo6ZGVzdHJveSh0aGlzLT5fTV9pbXBsLCBfX25ld19zdGFydCArIHNpemUo
KSk7CiAgICAgZWxzZQogICAgICAgc3RkOjpfRGVzdHJveShfX25ld19zdGFydCwgX19uZXdfZmlu
aXNoLCBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgIF9NX2RlYWxsb2NhdGUoX19uZXdfc3Rh
cnQsIF9fbGVuKTsKICAgICB0aHJvdzsKICAgfQogc3RkOjpfRGVzdHJveSh0aGlzLT5fTV9pbXBs
Ll9NX3N0YXJ0LCB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAgICAgICBfTV9nZXRfVHBfYWxs
b2NhdG9yKCkpOwogX01fZGVhbGxvY2F0ZSh0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0LAogICAgICAg
IHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UKICAgICAgICAtIHRoaXMtPl9NX2ltcGwu
X01fc3RhcnQpOwogdGhpcy0+X01faW1wbC5fTV9zdGFydCA9IF9fbmV3X3N0YXJ0OwogdGhpcy0+
X01faW1wbC5fTV9maW5pc2ggPSBfX25ld19maW5pc2g7CiB0aGlzLT5fTV9pbXBsLl9NX2VuZF9v
Zl9zdG9yYWdlID0gX19uZXdfc3RhcnQgKyBfX2xlbjsKICAgICAgfQoKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB2b2lkCiAgICB2ZWN0b3I8X1RwLCBfQWxs
b2M+OjoKICAgIF9NX2ZpbGxfaW5zZXJ0KGl0ZXJhdG9yIF9fcG9zaXRpb24sIHNpemVfdHlwZSBf
X24sIGNvbnN0IHZhbHVlX3R5cGUmIF9feCkKICAgIHsKICAgICAgaWYgKF9fbiAhPSAwKQogewog
ICBpZiAoc2l6ZV90eXBlKHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UKICAgLSB0aGlz
LT5fTV9pbXBsLl9NX2ZpbmlzaCkgPj0gX19uKQogICAgIHsKICAgICAgIHZhbHVlX3R5cGUgX194
X2NvcHkgPSBfX3g7CiAgICAgICBjb25zdCBzaXplX3R5cGUgX19lbGVtc19hZnRlciA9IGVuZCgp
IC0gX19wb3NpdGlvbjsKICAgICAgIHBvaW50ZXIgX19vbGRfZmluaXNoKHRoaXMtPl9NX2ltcGwu
X01fZmluaXNoKTsKICAgICAgIGlmIChfX2VsZW1zX2FmdGVyID4gX19uKQogIHsKICAgIHN0ZDo6
X191bmluaXRpYWxpemVkX21vdmVfYSh0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCAtIF9fbiwKICAg
ICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAgICAgICAgICB0aGlzLT5fTV9pbXBs
Ll9NX2ZpbmlzaCwKICAgICAgICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgdGhpcy0+
X01faW1wbC5fTV9maW5pc2ggKz0gX19uOwogICAgc3RkOjptb3ZlX2JhY2t3YXJkKF9fcG9zaXRp
b24uYmFzZSgpLCBfX29sZF9maW5pc2ggLSBfX24sIF9fb2xkX2ZpbmlzaCkKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKICAgIHN0ZDo6ZmlsbChfX3Bvc2l0aW9uLmJh
c2UoKSwgX19wb3NpdGlvbi5iYXNlKCkgKyBfX24sCiAgICAgICBfX3hfY29weSk7CiAgfQogICAg
ICAgZWxzZQogIHsKICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoID0KICAgICAgc3RkOjpfX3Vu
aW5pdGlhbGl6ZWRfZmlsbF9uX2EodGhpcy0+X01faW1wbC5fTV9maW5pc2gsCiAgICAgICAgX19u
IC0gX19lbGVtc19hZnRlciwKICAgICAgICBfX3hfY29weSwKICAgICAgICBfTV9nZXRfVHBfYWxs
b2NhdG9yKCkpOwogICAgc3RkOjpfX3VuaW5pdGlhbGl6ZWRfbW92ZV9hKF9fcG9zaXRpb24uYmFz
ZSgpLCBfX29sZF9maW5pc2gsCiAgICAgICAgICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2gsCiAg
ICAgICAgICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICAgIHRoaXMtPl9NX2ltcGwuX01fZmlu
aXNoICs9IF9fZWxlbXNfYWZ0ZXI7CiAgICBzdGQ6OmZpbGwoX19wb3NpdGlvbi5iYXNlKCksIF9f
b2xkX2ZpbmlzaCwgX194X2NvcHkpOwogIH0KICAgICB9CiAgIGVsc2UKICAgICB7CiAgICAgICBj
b25zdCBzaXplX3R5cGUgX19sZW4gPQogIF9NX2NoZWNrX2xlbihfX24sICJ2ZWN0b3I6Ol9NX2Zp
bGxfaW5zZXJ0Iik7CiAgICAgICBjb25zdCBzaXplX3R5cGUgX19lbGVtc19iZWZvcmUgPSBfX3Bv
c2l0aW9uIC0gYmVnaW4oKTsKICAgICAgIHBvaW50ZXIgX19uZXdfc3RhcnQodGhpcy0+X01fYWxs
b2NhdGUoX19sZW4pKTsKICAgICAgIHBvaW50ZXIgX19uZXdfZmluaXNoKF9fbmV3X3N0YXJ0KTsK
ICAgICAgIHRyeQogIHsKCiAgICBzdGQ6Ol9fdW5pbml0aWFsaXplZF9maWxsX25fYShfX25ld19z
dGFydCArIF9fZWxlbXNfYmVmb3JlLAogICAgICBfX24sIF9feCwKICAgICAgX01fZ2V0X1RwX2Fs
bG9jYXRvcigpKTsKICAgIF9fbmV3X2ZpbmlzaCA9IHBvaW50ZXIoKTsKCiAgICBfX25ld19maW5p
c2gKICAgICAgPSBzdGQ6Ol9fdW5pbml0aWFsaXplZF9tb3ZlX2lmX25vZXhjZXB0X2EKICAgICAg
KHRoaXMtPl9NX2ltcGwuX01fc3RhcnQsIF9fcG9zaXRpb24uYmFzZSgpLAogICAgICAgX19uZXdf
c3RhcnQsIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CgogICAgX19uZXdfZmluaXNoICs9IF9fbjsK
CiAgICBfX25ld19maW5pc2gKICAgICAgPSBzdGQ6Ol9fdW5pbml0aWFsaXplZF9tb3ZlX2lmX25v
ZXhjZXB0X2EKICAgICAgKF9fcG9zaXRpb24uYmFzZSgpLCB0aGlzLT5fTV9pbXBsLl9NX2Zpbmlz
aCwKICAgICAgIF9fbmV3X2ZpbmlzaCwgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICB9CiAgICAg
ICBjYXRjaCguLi4pCiAgewogICAgaWYgKCFfX25ld19maW5pc2gpCiAgICAgIHN0ZDo6X0Rlc3Ry
b3koX19uZXdfc3RhcnQgKyBfX2VsZW1zX2JlZm9yZSwKICAgICAgX19uZXdfc3RhcnQgKyBfX2Vs
ZW1zX2JlZm9yZSArIF9fbiwKICAgICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICAgIGVsc2UK
ICAgICAgc3RkOjpfRGVzdHJveShfX25ld19zdGFydCwgX19uZXdfZmluaXNoLAogICAgICBfTV9n
ZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgX01fZGVhbGxvY2F0ZShfX25ld19zdGFydCwgX19sZW4p
OwogICAgdGhyb3c7CiAgfQogICAgICAgc3RkOjpfRGVzdHJveSh0aGlzLT5fTV9pbXBsLl9NX3N0
YXJ0LCB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3Io
KSk7CiAgICAgICBfTV9kZWFsbG9jYXRlKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQsCiAgICAgICB0
aGlzLT5fTV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdlCiAgICAgICAtIHRoaXMtPl9NX2ltcGwuX01f
c3RhcnQpOwogICAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydCA9IF9fbmV3X3N0YXJ0OwogICAg
ICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2ggPSBfX25ld19maW5pc2g7CiAgICAgICB0aGlzLT5f
TV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdlID0gX19uZXdfc3RhcnQgKyBfX2xlbjsKICAgICB9CiB9
CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHZv
aWQKICAgIHZlY3RvcjxfVHAsIF9BbGxvYz46OgogICAgX01fZGVmYXVsdF9hcHBlbmQoc2l6ZV90
eXBlIF9fbikKICAgIHsKICAgICAgaWYgKF9fbiAhPSAwKQogewogICBpZiAoc2l6ZV90eXBlKHRo
aXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UKICAgLSB0aGlzLT5fTV9pbXBsLl9NX2Zpbmlz
aCkgPj0gX19uKQogICAgIHsKICAgICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoID0KICBzdGQ6
Ol9fdW5pbml0aWFsaXplZF9kZWZhdWx0X25fYSh0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAg
ICAgIF9fbiwgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICAgICB9CiAgIGVsc2UKICAgICB7CiAg
ICAgICBjb25zdCBzaXplX3R5cGUgX19sZW4gPQogIF9NX2NoZWNrX2xlbihfX24sICJ2ZWN0b3I6
Ol9NX2RlZmF1bHRfYXBwZW5kIik7CiAgICAgICBjb25zdCBzaXplX3R5cGUgX19vbGRfc2l6ZSA9
IHRoaXMtPnNpemUoKTsKICAgICAgIHBvaW50ZXIgX19uZXdfc3RhcnQodGhpcy0+X01fYWxsb2Nh
dGUoX19sZW4pKTsKICAgICAgIHBvaW50ZXIgX19uZXdfZmluaXNoKF9fbmV3X3N0YXJ0KTsKICAg
ICAgIHRyeQogIHsKICAgIF9fbmV3X2ZpbmlzaAogICAgICA9IHN0ZDo6X191bmluaXRpYWxpemVk
X21vdmVfaWZfbm9leGNlcHRfYQogICAgICAodGhpcy0+X01faW1wbC5fTV9zdGFydCwgdGhpcy0+
X01faW1wbC5fTV9maW5pc2gsCiAgICAgICBfX25ld19zdGFydCwgX01fZ2V0X1RwX2FsbG9jYXRv
cigpKTsKICAgIF9fbmV3X2ZpbmlzaCA9CiAgICAgIHN0ZDo6X191bmluaXRpYWxpemVkX2RlZmF1
bHRfbl9hKF9fbmV3X2ZpbmlzaCwgX19uLAogICAgICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3Io
KSk7CiAgfQogICAgICAgY2F0Y2goLi4uKQogIHsKICAgIHN0ZDo6X0Rlc3Ryb3koX19uZXdfc3Rh
cnQsIF9fbmV3X2ZpbmlzaCwKICAgIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICBfTV9kZWFs
bG9jYXRlKF9fbmV3X3N0YXJ0LCBfX2xlbik7CiAgICB0aHJvdzsKICB9CiAgICAgICBzdGQ6Ol9E
ZXN0cm95KHRoaXMtPl9NX2ltcGwuX01fc3RhcnQsIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoLAog
ICAgICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICAgICAgIF9NX2RlYWxsb2NhdGUodGhpcy0+
X01faW1wbC5fTV9zdGFydCwKICAgICAgIHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UK
ICAgICAgIC0gdGhpcy0+X01faW1wbC5fTV9zdGFydCk7CiAgICAgICB0aGlzLT5fTV9pbXBsLl9N
X3N0YXJ0ID0gX19uZXdfc3RhcnQ7CiAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCA9IF9f
bmV3X2ZpbmlzaDsKICAgICAgIHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UgPSBfX25l
d19zdGFydCArIF9fbGVuOwogICAgIH0KIH0KICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Rw
LCB0eXBlbmFtZSBfQWxsb2M+CiAgICBib29sCiAgICB2ZWN0b3I8X1RwLCBfQWxsb2M+OjoKICAg
IF9NX3Nocmlua190b19maXQoKQogICAgewogICAgICBpZiAoY2FwYWNpdHkoKSA9PSBzaXplKCkp
CiByZXR1cm4gZmFsc2U7CiAgICAgIHJldHVybiBzdGQ6Ol9fc2hyaW5rX3RvX2ZpdF9hdXg8dmVj
dG9yPjo6X1NfZG9faXQoKnRoaXMpOwogICAgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0
eXBlbmFtZSBfQWxsb2M+CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcj4KICAg
ICAgdm9pZAogICAgICB2ZWN0b3I8X1RwLCBfQWxsb2M+OjoKICAgICAgX01fcmFuZ2VfaW5zZXJ0
KGl0ZXJhdG9yIF9fcG9zLCBfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LAogICAgICAgIF9JbnB1dEl0
ZXJhdG9yIF9fbGFzdCwgc3RkOjppbnB1dF9pdGVyYXRvcl90YWcpCiAgICAgIHsKIGZvciAoOyBf
X2ZpcnN0ICE9IF9fbGFzdDsgKytfX2ZpcnN0KQogICB7CiAgICAgX19wb3MgPSBpbnNlcnQoX19w
b3MsICpfX2ZpcnN0KTsKICAgICArK19fcG9zOwogICB9CiAgICAgIH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2Fy
ZEl0ZXJhdG9yPgogICAgICB2b2lkCiAgICAgIHZlY3RvcjxfVHAsIF9BbGxvYz46OgogICAgICBf
TV9yYW5nZV9pbnNlcnQoaXRlcmF0b3IgX19wb3NpdGlvbiwgX0ZvcndhcmRJdGVyYXRvciBfX2Zp
cnN0LAogICAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19sYXN0LCBzdGQ6OmZvcndhcmRfaXRlcmF0
b3JfdGFnKQogICAgICB7CiBpZiAoX19maXJzdCAhPSBfX2xhc3QpCiAgIHsKICAgICBjb25zdCBz
aXplX3R5cGUgX19uID0gc3RkOjpkaXN0YW5jZShfX2ZpcnN0LCBfX2xhc3QpOwogICAgIGlmIChz
aXplX3R5cGUodGhpcy0+X01faW1wbC5fTV9lbmRfb2Zfc3RvcmFnZQogICAgIC0gdGhpcy0+X01f
aW1wbC5fTV9maW5pc2gpID49IF9fbikKICAgICAgIHsKICBjb25zdCBzaXplX3R5cGUgX19lbGVt
c19hZnRlciA9IGVuZCgpIC0gX19wb3NpdGlvbjsKICBwb2ludGVyIF9fb2xkX2ZpbmlzaCh0aGlz
LT5fTV9pbXBsLl9NX2ZpbmlzaCk7CiAgaWYgKF9fZWxlbXNfYWZ0ZXIgPiBfX24pCiAgICB7CiAg
ICAgIHN0ZDo6X191bmluaXRpYWxpemVkX21vdmVfYSh0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCAt
IF9fbiwKICAgICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2gsCiAgICAgIHRoaXMtPl9NX2ltcGwu
X01fZmluaXNoLAogICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgICB0aGlzLT5fTV9p
bXBsLl9NX2ZpbmlzaCArPSBfX247CiAgICAgIHN0ZDo6bW92ZV9iYWNrd2FyZChfX3Bvc2l0aW9u
LmJhc2UoKSwgX19vbGRfZmluaXNoIC0gX19uLCBfX29sZF9maW5pc2gpCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKICAgICAgc3RkOjpjb3B5KF9fZmlyc3QsIF9f
bGFzdCwgX19wb3NpdGlvbik7CiAgICB9CiAgZWxzZQogICAgewogICAgICBfRm9yd2FyZEl0ZXJh
dG9yIF9fbWlkID0gX19maXJzdDsKICAgICAgc3RkOjphZHZhbmNlKF9fbWlkLCBfX2VsZW1zX2Fm
dGVyKTsKICAgICAgc3RkOjpfX3VuaW5pdGlhbGl6ZWRfY29weV9hKF9fbWlkLCBfX2xhc3QsCiAg
ICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoLAogICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkp
OwogICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCArPSBfX24gLSBfX2VsZW1zX2FmdGVyOwog
ICAgICBzdGQ6Ol9fdW5pbml0aWFsaXplZF9tb3ZlX2EoX19wb3NpdGlvbi5iYXNlKCksCiAgICAg
IF9fb2xkX2ZpbmlzaCwKICAgICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2gsCiAgICAgIF9NX2dl
dF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoICs9IF9fZWxl
bXNfYWZ0ZXI7CiAgICAgIHN0ZDo6Y29weShfX2ZpcnN0LCBfX21pZCwgX19wb3NpdGlvbik7CiAg
ICB9CiAgICAgICB9CiAgICAgZWxzZQogICAgICAgewogIGNvbnN0IHNpemVfdHlwZSBfX2xlbiA9
CiAgICBfTV9jaGVja19sZW4oX19uLCAidmVjdG9yOjpfTV9yYW5nZV9pbnNlcnQiKTsKICBwb2lu
dGVyIF9fbmV3X3N0YXJ0KHRoaXMtPl9NX2FsbG9jYXRlKF9fbGVuKSk7CiAgcG9pbnRlciBfX25l
d19maW5pc2goX19uZXdfc3RhcnQpOwogIHRyeQogICAgewogICAgICBfX25ld19maW5pc2gKICAg
ICAgICA9IHN0ZDo6X191bmluaXRpYWxpemVkX21vdmVfaWZfbm9leGNlcHRfYQogICAgICAgICh0
aGlzLT5fTV9pbXBsLl9NX3N0YXJ0LCBfX3Bvc2l0aW9uLmJhc2UoKSwKICAgICAgICAgX19uZXdf
c3RhcnQsIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgIF9fbmV3X2ZpbmlzaAogICAgICAg
ID0gc3RkOjpfX3VuaW5pdGlhbGl6ZWRfY29weV9hKF9fZmlyc3QsIF9fbGFzdCwKICAgICAgICAg
IF9fbmV3X2ZpbmlzaCwKICAgICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgIF9f
bmV3X2ZpbmlzaAogICAgICAgID0gc3RkOjpfX3VuaW5pdGlhbGl6ZWRfbW92ZV9pZl9ub2V4Y2Vw
dF9hCiAgICAgICAgKF9fcG9zaXRpb24uYmFzZSgpLCB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwK
ICAgICAgICAgX19uZXdfZmluaXNoLCBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgfQogIGNh
dGNoKC4uLikKICAgIHsKICAgICAgc3RkOjpfRGVzdHJveShfX25ld19zdGFydCwgX19uZXdfZmlu
aXNoLAogICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgICBfTV9kZWFsbG9jYXRlKF9f
bmV3X3N0YXJ0LCBfX2xlbik7CiAgICAgIHRocm93OwogICAgfQogIHN0ZDo6X0Rlc3Ryb3kodGhp
cy0+X01faW1wbC5fTV9zdGFydCwgdGhpcy0+X01faW1wbC5fTV9maW5pc2gsCiAgICAgICAgIF9N
X2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgX01fZGVhbGxvY2F0ZSh0aGlzLT5fTV9pbXBsLl9NX3N0
YXJ0LAogICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2VuZF9vZl9zdG9yYWdlCiAgICAgICAgIC0g
dGhpcy0+X01faW1wbC5fTV9zdGFydCk7CiAgdGhpcy0+X01faW1wbC5fTV9zdGFydCA9IF9fbmV3
X3N0YXJ0OwogIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoID0gX19uZXdfZmluaXNoOwogIHRoaXMt
Pl9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UgPSBfX25ld19zdGFydCArIF9fbGVuOwogICAgICAg
fQogICB9CiAgICAgIH0KCgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2M+CiAgICB2b2lkCiAg
ICB2ZWN0b3I8Ym9vbCwgX0FsbG9jPjo6CiAgICBfTV9yZWFsbG9jYXRlKHNpemVfdHlwZSBfX24p
CiAgICB7CiAgICAgIF9CaXRfcG9pbnRlciBfX3EgPSB0aGlzLT5fTV9hbGxvY2F0ZShfX24pOwog
ICAgICBpdGVyYXRvciBfX3N0YXJ0KHN0ZDo6X19hZGRyZXNzb2YoKl9fcSksIDApOwogICAgICB0
aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCA9IF9NX2NvcHlfYWxpZ25lZChiZWdpbigpLCBlbmQoKSwg
X19zdGFydCk7CiAgICAgIHRoaXMtPl9NX2RlYWxsb2NhdGUoKTsKICAgICAgdGhpcy0+X01faW1w
bC5fTV9zdGFydCA9IF9fc3RhcnQ7CiAgICAgIHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3Jh
Z2UgPSBfX3EgKyBfU19ud29yZChfX24pOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxs
b2M+CiAgICB2b2lkCiAgICB2ZWN0b3I8Ym9vbCwgX0FsbG9jPjo6CiAgICBfTV9maWxsX2luc2Vy
dChpdGVyYXRvciBfX3Bvc2l0aW9uLCBzaXplX3R5cGUgX19uLCBib29sIF9feCkKICAgIHsKICAg
ICAgaWYgKF9fbiA9PSAwKQogcmV0dXJuOwogICAgICBpZiAoY2FwYWNpdHkoKSAtIHNpemUoKSA+
PSBfX24pCiB7CiAgIHN0ZDo6Y29weV9iYWNrd2FyZChfX3Bvc2l0aW9uLCBlbmQoKSwKICAgICAg
ICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCArIGRpZmZlcmVuY2VfdHlwZShfX24pKTsKICAgc3Rk
OjpmaWxsKF9fcG9zaXRpb24sIF9fcG9zaXRpb24gKyBkaWZmZXJlbmNlX3R5cGUoX19uKSwgX194
KTsKICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2ggKz0gZGlmZmVyZW5jZV90eXBlKF9fbik7CiB9
CiAgICAgIGVsc2UKIHsKICAgY29uc3Qgc2l6ZV90eXBlIF9fbGVuID0KICAgICBfTV9jaGVja19s
ZW4oX19uLCAidmVjdG9yPGJvb2w+OjpfTV9maWxsX2luc2VydCIpOwogICBfQml0X3BvaW50ZXIg
X19xID0gdGhpcy0+X01fYWxsb2NhdGUoX19sZW4pOwogICBpdGVyYXRvciBfX3N0YXJ0KHN0ZDo6
X19hZGRyZXNzb2YoKl9fcSksIDApOwogICBpdGVyYXRvciBfX2kgPSBfTV9jb3B5X2FsaWduZWQo
YmVnaW4oKSwgX19wb3NpdGlvbiwgX19zdGFydCk7CiAgIHN0ZDo6ZmlsbChfX2ksIF9faSArIGRp
ZmZlcmVuY2VfdHlwZShfX24pLCBfX3gpOwogICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCA9IHN0
ZDo6Y29weShfX3Bvc2l0aW9uLCBlbmQoKSwKICAgICAgICAgICBfX2kgKyBkaWZmZXJlbmNlX3R5
cGUoX19uKSk7CiAgIHRoaXMtPl9NX2RlYWxsb2NhdGUoKTsKICAgdGhpcy0+X01faW1wbC5fTV9l
bmRfb2Zfc3RvcmFnZSA9IF9fcSArIF9TX253b3JkKF9fbGVuKTsKICAgdGhpcy0+X01faW1wbC5f
TV9zdGFydCA9IF9fc3RhcnQ7CiB9CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4K
ICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3YXJkSXRlcmF0b3I+CiAgICAgIHZvaWQKICAgICAg
dmVjdG9yPGJvb2wsIF9BbGxvYz46OgogICAgICBfTV9pbnNlcnRfcmFuZ2UoaXRlcmF0b3IgX19w
b3NpdGlvbiwgX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LAogICAgICAgIF9Gb3J3YXJkSXRlcmF0
b3IgX19sYXN0LCBzdGQ6OmZvcndhcmRfaXRlcmF0b3JfdGFnKQogICAgICB7CiBpZiAoX19maXJz
dCAhPSBfX2xhc3QpCiAgIHsKICAgICBzaXplX3R5cGUgX19uID0gc3RkOjpkaXN0YW5jZShfX2Zp
cnN0LCBfX2xhc3QpOwogICAgIGlmIChjYXBhY2l0eSgpIC0gc2l6ZSgpID49IF9fbikKICAgICAg
IHsKICBzdGQ6OmNvcHlfYmFja3dhcmQoX19wb3NpdGlvbiwgZW5kKCksCiAgICAgICB0aGlzLT5f
TV9pbXBsLl9NX2ZpbmlzaAogICAgICAgKyBkaWZmZXJlbmNlX3R5cGUoX19uKSk7CiAgc3RkOjpj
b3B5KF9fZmlyc3QsIF9fbGFzdCwgX19wb3NpdGlvbik7CiAgdGhpcy0+X01faW1wbC5fTV9maW5p
c2ggKz0gZGlmZmVyZW5jZV90eXBlKF9fbik7CiAgICAgICB9CiAgICAgZWxzZQogICAgICAgewog
IGNvbnN0IHNpemVfdHlwZSBfX2xlbiA9CiAgICBfTV9jaGVja19sZW4oX19uLCAidmVjdG9yPGJv
b2w+OjpfTV9pbnNlcnRfcmFuZ2UiKTsKICBfQml0X3BvaW50ZXIgX19xID0gdGhpcy0+X01fYWxs
b2NhdGUoX19sZW4pOwogIGl0ZXJhdG9yIF9fc3RhcnQoc3RkOjpfX2FkZHJlc3NvZigqX19xKSwg
MCk7CiAgaXRlcmF0b3IgX19pID0gX01fY29weV9hbGlnbmVkKGJlZ2luKCksIF9fcG9zaXRpb24s
IF9fc3RhcnQpOwogIF9faSA9IHN0ZDo6Y29weShfX2ZpcnN0LCBfX2xhc3QsIF9faSk7CiAgdGhp
cy0+X01faW1wbC5fTV9maW5pc2ggPSBzdGQ6OmNvcHkoX19wb3NpdGlvbiwgZW5kKCksIF9faSk7
CiAgdGhpcy0+X01fZGVhbGxvY2F0ZSgpOwogIHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3Jh
Z2UgPSBfX3EgKyBfU19ud29yZChfX2xlbik7CiAgdGhpcy0+X01faW1wbC5fTV9zdGFydCA9IF9f
c3RhcnQ7CiAgICAgICB9CiAgIH0KICAgICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2M+
CiAgICB2b2lkCiAgICB2ZWN0b3I8Ym9vbCwgX0FsbG9jPjo6CiAgICBfTV9pbnNlcnRfYXV4KGl0
ZXJhdG9yIF9fcG9zaXRpb24sIGJvb2wgX194KQogICAgewogICAgICBpZiAodGhpcy0+X01faW1w
bC5fTV9maW5pc2guX01fcCAhPSB0aGlzLT5fTV9pbXBsLl9NX2VuZF9hZGRyKCkpCiB7CiAgIHN0
ZDo6Y29weV9iYWNrd2FyZChfX3Bvc2l0aW9uLCB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAg
ICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCArIDEpOwogICAqX19wb3NpdGlvbiA9IF9feDsK
ICAgKyt0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaDsKIH0KICAgICAgZWxzZQogewogICBjb25zdCBz
aXplX3R5cGUgX19sZW4gPQogICAgIF9NX2NoZWNrX2xlbihzaXplX3R5cGUoMSksICJ2ZWN0b3I8
Ym9vbD46Ol9NX2luc2VydF9hdXgiKTsKICAgX0JpdF9wb2ludGVyIF9fcSA9IHRoaXMtPl9NX2Fs
bG9jYXRlKF9fbGVuKTsKICAgaXRlcmF0b3IgX19zdGFydChzdGQ6Ol9fYWRkcmVzc29mKCpfX3Ep
LCAwKTsKICAgaXRlcmF0b3IgX19pID0gX01fY29weV9hbGlnbmVkKGJlZ2luKCksIF9fcG9zaXRp
b24sIF9fc3RhcnQpOwogICAqX19pKysgPSBfX3g7CiAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNo
ID0gc3RkOjpjb3B5KF9fcG9zaXRpb24sIGVuZCgpLCBfX2kpOwogICB0aGlzLT5fTV9kZWFsbG9j
YXRlKCk7CiAgIHRoaXMtPl9NX2ltcGwuX01fZW5kX29mX3N0b3JhZ2UgPSBfX3EgKyBfU19ud29y
ZChfX2xlbik7CiAgIHRoaXMtPl9NX2ltcGwuX01fc3RhcnQgPSBfX3N0YXJ0OwogfQogICAgfQoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2M+CiAgICB0eXBlbmFtZSB2ZWN0b3I8Ym9vbCwgX0Fs
bG9jPjo6aXRlcmF0b3IKICAgIHZlY3Rvcjxib29sLCBfQWxsb2M+OjoKICAgIF9NX2VyYXNlKGl0
ZXJhdG9yIF9fcG9zaXRpb24pCiAgICB7CiAgICAgIGlmIChfX3Bvc2l0aW9uICsgMSAhPSBlbmQo
KSkKICAgICAgICBzdGQ6OmNvcHkoX19wb3NpdGlvbiArIDEsIGVuZCgpLCBfX3Bvc2l0aW9uKTsK
ICAgICAgLS10aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaDsKICAgICAgcmV0dXJuIF9fcG9zaXRpb247
CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYz4KICAgIHR5cGVuYW1lIHZlY3Rvcjxi
b29sLCBfQWxsb2M+OjppdGVyYXRvcgogICAgdmVjdG9yPGJvb2wsIF9BbGxvYz46OgogICAgX01f
ZXJhc2UoaXRlcmF0b3IgX19maXJzdCwgaXRlcmF0b3IgX19sYXN0KQogICAgewogICAgICBpZiAo
X19maXJzdCAhPSBfX2xhc3QpCiBfTV9lcmFzZV9hdF9lbmQoc3RkOjpjb3B5KF9fbGFzdCwgZW5k
KCksIF9fZmlyc3QpKTsKICAgICAgcmV0dXJuIF9fZmlyc3Q7CiAgICB9CgoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfQWxsb2M+CiAgICBib29sCiAgICB2ZWN0b3I8Ym9vbCwgX0FsbG9jPjo6CiAgICBf
TV9zaHJpbmtfdG9fZml0KCkKICAgIHsKICAgICAgaWYgKGNhcGFjaXR5KCkgLSBzaXplKCkgPCBp
bnQoX1Nfd29yZF9iaXQpKQogcmV0dXJuIGZhbHNlOwogICAgICB0cnkKIHsKICAgX01fcmVhbGxv
Y2F0ZShzaXplKCkpOwogICByZXR1cm4gdHJ1ZTsKIH0KICAgICAgY2F0Y2goLi4uKQogeyByZXR1
cm4gZmFsc2U7IH0KICAgIH0KCgoKfQoKCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChf
X3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxv
Yz4KICAgIHNpemVfdAogICAgaGFzaDxzdGQ6OnZlY3Rvcjxib29sLCBfQWxsb2M+Pjo6CiAgICBv
cGVyYXRvcigpKGNvbnN0IHN0ZDo6dmVjdG9yPGJvb2wsIF9BbGxvYz4mIF9fYikgY29uc3Qgbm9l
eGNlcHQKICAgIHsKICAgICAgc2l6ZV90IF9faGFzaCA9IDA7CiAgICAgIHVzaW5nIHN0ZDo6X1Nf
d29yZF9iaXQ7CiAgICAgIHVzaW5nIHN0ZDo6X0JpdF90eXBlOwoKICAgICAgY29uc3Qgc2l6ZV90
IF9fd29yZHMgPSBfX2Iuc2l6ZSgpIC8gX1Nfd29yZF9iaXQ7CiAgICAgIGlmIChfX3dvcmRzKQog
ewogICBjb25zdCBzaXplX3QgX19jbGVuZ3RoID0gX193b3JkcyAqIHNpemVvZihfQml0X3R5cGUp
OwogICBfX2hhc2ggPSBzdGQ6Ol9IYXNoX2ltcGw6Omhhc2goX19iLl9NX2ltcGwuX01fc3RhcnQu
X01fcCwgX19jbGVuZ3RoKTsKIH0KCiAgICAgIGNvbnN0IHNpemVfdCBfX2V4dHJhYml0cyA9IF9f
Yi5zaXplKCkgJSBfU193b3JkX2JpdDsKICAgICAgaWYgKF9fZXh0cmFiaXRzKQogewogICBfQml0
X3R5cGUgX19oaXdvcmQgPSAqX19iLl9NX2ltcGwuX01fZmluaXNoLl9NX3A7CiAgIF9faGl3b3Jk
ICY9IH4oKH5zdGF0aWNfY2FzdDxfQml0X3R5cGU+KDApKSA8PCBfX2V4dHJhYml0cyk7CgogICBj
b25zdCBzaXplX3QgX19jbGVuZ3RoCiAgICAgPSAoX19leHRyYWJpdHMgKyA4IC0gMSkgLyA4Owog
ICBpZiAoX193b3JkcykKICAgICBfX2hhc2ggPSBzdGQ6Ol9IYXNoX2ltcGw6Omhhc2goJl9faGl3
b3JkLCBfX2NsZW5ndGgsIF9faGFzaCk7CiAgIGVsc2UKICAgICBfX2hhc2ggPSBzdGQ6Ol9IYXNo
X2ltcGw6Omhhc2goJl9faGl3b3JkLCBfX2NsZW5ndGgpOwogfQoKICAgICAgcmV0dXJuIF9faGFz
aDsKICAgIH0KCgp9CiMgNzAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvdmVjdG9yIiAyIDMKIyAz
MCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lQ
cm9wZXJ0eS5oIiAyCgoKCgojIDMzICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVp
LW1hc3Rlci0zLjIuMS9zcmMvWVByb3BlcnR5LmgiCmVudW0gWVByb3BlcnR5VHlwZQp7CiAgICBZ
VW5rbm93blByb3BlcnR5VHlwZSA9IDAsCiAgICBZT3RoZXJQcm9wZXJ0eSwKICAgIFlTdHJpbmdQ
cm9wZXJ0eSwKICAgIFlCb29sUHJvcGVydHksCiAgICBZSW50ZWdlclByb3BlcnR5Cn07CgpjbGFz
cyBZV2lkZ2V0OwpjbGFzcyBZUHJvcGVydHk7Cgp0eXBlZGVmIGxvbmcgbG9uZyBZSW50ZWdlcjsK
CgoKCgpjbGFzcyBZUHJvcGVydHkKewpwdWJsaWM6CgoKCgogICAgWVByb3BlcnR5KCBjb25zdCBz
dGQ6OnN0cmluZyAmIG5hbWUsIFlQcm9wZXJ0eVR5cGUgdHlwZSwgYm9vbCBpc1JlYWRPbmx5ID0g
ZmFsc2UgKQogOiBfbmFtZSggbmFtZSApCiAsIF90eXBlKCB0eXBlICkKICwgX2lzUmVhZE9ubHko
IGlzUmVhZE9ubHkgKQoge30KCgoKCiAgICBzdGQ6OnN0cmluZyBuYW1lKCkgY29uc3QgeyByZXR1
cm4gX25hbWU7IH0KCgoKCiAgICBZUHJvcGVydHlUeXBlIHR5cGUoKSBjb25zdCB7IHJldHVybiBf
dHlwZTsgfQoKCgoKICAgIGJvb2wgaXNSZWFkT25seSgpIGNvbnN0IHsgcmV0dXJuIF9pc1JlYWRP
bmx5OyB9CgoKCgogICAgc3RkOjpzdHJpbmcgdHlwZUFzU3RyKCkgY29uc3QgeyByZXR1cm4gWVBy
b3BlcnR5Ojp0eXBlQXNTdHIoIF90eXBlICk7IH0KCgoKCiAgICBzdGF0aWMgc3RkOjpzdHJpbmcg
dHlwZUFzU3RyKCBZUHJvcGVydHlUeXBlIHR5cGUgKTsKCnByaXZhdGU6CgogICAgc3RkOjpzdHJp
bmcgX25hbWU7CiAgICBZUHJvcGVydHlUeXBlIF90eXBlOwogICAgYm9vbCBfaXNSZWFkT25seTsK
fTsKIyAxMDQgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4x
L3NyYy9ZUHJvcGVydHkuaCIKY2xhc3MgWVByb3BlcnR5VmFsdWUKewpwdWJsaWM6CgoKCgogICAg
WVByb3BlcnR5VmFsdWUoIGNvbnN0IHN0ZDo6c3RyaW5nICYgc3RyICk6CiBfdHlwZSggWVN0cmlu
Z1Byb3BlcnR5ICksIF9zdHJpbmdWYWwoIHN0ciApIHt9CgoKCgogICAgWVByb3BlcnR5VmFsdWUo
IGNvbnN0IGNoYXIgKiBzdHIgKToKIF90eXBlKCBZU3RyaW5nUHJvcGVydHkgKSwgX3N0cmluZ1Zh
bCggc3RyICkge30KCgoKCiAgICBleHBsaWNpdCBZUHJvcGVydHlWYWx1ZSggYm9vbCBiICk6CiBf
dHlwZSggWUJvb2xQcm9wZXJ0eSApLCBfYm9vbFZhbCggYiApIHt9CgoKCgogICAgZXhwbGljaXQg
WVByb3BlcnR5VmFsdWUoIFlJbnRlZ2VyIG51bSApOgogX3R5cGUoIFlJbnRlZ2VyUHJvcGVydHkg
KSwgX2ludGVnZXJWYWwoIG51bSApIHt9CgoKCgogICAgZXhwbGljaXQgWVByb3BlcnR5VmFsdWUo
IGludCBudW0gKToKIF90eXBlKCBZSW50ZWdlclByb3BlcnR5ICksIF9pbnRlZ2VyVmFsKCBudW0g
KSB7fQoKICAgIGV4cGxpY2l0IFlQcm9wZXJ0eVZhbHVlKCBZUHJvcGVydHlUeXBlIHR5cGUgKSA6
CiBfdHlwZSggdHlwZSApIHt9CgoKCgogICAgWVByb3BlcnR5VmFsdWUoKToKIF90eXBlKCBZVW5r
bm93blByb3BlcnR5VHlwZSApIHt9CgoKCgogICAgfllQcm9wZXJ0eVZhbHVlKCk7CgoKCgoKICAg
IFlQcm9wZXJ0eVR5cGUgdHlwZSgpIGNvbnN0IHsgcmV0dXJuIF90eXBlOyB9CgoKCgogICAgc3Rk
OjpzdHJpbmcgdHlwZUFzU3RyKCkgY29uc3QgeyByZXR1cm4gWVByb3BlcnR5Ojp0eXBlQXNTdHIo
IF90eXBlICk7IH0KCgoKCgogICAgc3RkOjpzdHJpbmcgc3RyaW5nVmFsKCkgY29uc3QgeyByZXR1
cm4gX3N0cmluZ1ZhbDsgfQogICAgYm9vbCBib29sVmFsKCkgY29uc3QgeyByZXR1cm4gX2Jvb2xW
YWw7IH0KICAgIFlJbnRlZ2VyIGludGVnZXJWYWwoKSBjb25zdCB7IHJldHVybiBfaW50ZWdlclZh
bDsgfQoKCnByaXZhdGU6CgogICAgWVByb3BlcnR5VHlwZSBfdHlwZTsKICAgIHN0ZDo6c3RyaW5n
IF9zdHJpbmdWYWw7CiAgICBib29sIF9ib29sVmFsOwogICAgWUludGVnZXIgX2ludGVnZXJWYWw7
Cn07CgoKCgoKY2xhc3MgWVByb3BlcnR5U2V0CnsKcHVibGljOgoKCgogICAgWVByb3BlcnR5U2V0
KCk7CgoKCgoKCgogICAgdm9pZCBjaGVjayggY29uc3Qgc3RkOjpzdHJpbmcgJiBwcm9wZXJ0eU5h
bWUgKSBjb25zdDsKIyAyMDkgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFz
dGVyLTMuMi4xL3NyYy9ZUHJvcGVydHkuaCIKICAgIHZvaWQgY2hlY2soIGNvbnN0IHN0ZDo6c3Ry
aW5nICYgcHJvcGVydHlOYW1lLCBZUHJvcGVydHlUeXBlIHR5cGUgKSBjb25zdDsKCgoKCiAgICB2
b2lkIGNoZWNrKCBjb25zdCBZUHJvcGVydHkgJiBwcm9wICkgY29uc3QKIHsgY2hlY2soIHByb3Au
bmFtZSgpLCBwcm9wLnR5cGUoKSApOyB9CiMgMjI0ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5
dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVByb3BlcnR5LmgiCiAgICBib29sIGNvbnRhaW5z
KCBjb25zdCBzdGQ6OnN0cmluZyAmIHByb3BlcnR5TmFtZSApIGNvbnN0IHRocm93KCk7CiMgMjM5
ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVBy
b3BlcnR5LmgiCiAgICBib29sIGNvbnRhaW5zKCBjb25zdCBzdGQ6OnN0cmluZyAmIHByb3BlcnR5
TmFtZSwgWVByb3BlcnR5VHlwZSB0eXBlICkgY29uc3Q7CgoKCgogICAgYm9vbCBjb250YWlucygg
Y29uc3QgWVByb3BlcnR5ICYgcHJvcCApIGNvbnN0CiB7IHJldHVybiBjb250YWlucyggcHJvcC5u
YW1lKCksIHByb3AudHlwZSgpICk7IH0KCgoKCiAgICBib29sIGlzRW1wdHkoKSBjb25zdCB7IHJl
dHVybiBfcHJvcGVydGllcy5lbXB0eSgpOyB9CgoKCgogICAgaW50IHNpemUoKSBjb25zdCB7IHJl
dHVybiAoaW50KSBfcHJvcGVydGllcy5zaXplKCk7IH0KCgoKCiAgICB2b2lkIGFkZCggY29uc3Qg
WVByb3BlcnR5ICYgcHJvcCApOwoKCgoKCgoKICAgIHZvaWQgYWRkKCBjb25zdCBZUHJvcGVydHlT
ZXQgJiBvdGhlclNldCApOwoKICAgIHR5cGVkZWYgc3RkOjp2ZWN0b3I8WVByb3BlcnR5Pjo6Y29u
c3RfaXRlcmF0b3IgY29uc3RfaXRlcmF0b3I7CgoKCgogICAgY29uc3RfaXRlcmF0b3IgcHJvcGVy
dGllc0JlZ2luKCkgY29uc3Q7CgoKCgogICAgY29uc3RfaXRlcmF0b3IgcHJvcGVydGllc0VuZCgp
IGNvbnN0OwoKcHJpdmF0ZToKCgoKCgoKCiAgICBzdGQ6OnZlY3RvcjxZUHJvcGVydHk+IF9wcm9w
ZXJ0aWVzOwp9OwojIDMzICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rl
ci0zLjIuMS9zcmMvWVdpZGdldC5oIiAyCiMgMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVp
LWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lVSVN5bWJvbHMuaCIgMQojIDM0ICIvaG9tZS9zaGFy
a2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVdpZGdldC5oIiAyCiMg
MSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lV
SUV4Y2VwdGlvbi5oIiAxCiMgMzIgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWkt
bWFzdGVyLTMuMi4xL3NyYy9ZVUlFeGNlcHRpb24uaCIKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2NlcnJubyIgMSAzCiMgMzkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY2Vycm5vIiAzCiAg
ICAgICAKIyA0MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jZXJybm8iIDMKCgojIDEgIi91c3Iv
aW5jbHVkZS9lcnJuby5oIiAxIDMgNAojIDQzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2NlcnJu
byIgMiAzCiMgMzMgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMu
Mi4xL3NyYy9ZVUlFeGNlcHRpb24uaCIgMgoKCgoKCgpjbGFzcyBZV2lkZ2V0OwojIDIxMyAiL2hv
bWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lVSUV4Y2Vw
dGlvbi5oIgpjbGFzcyBZQ29kZUxvY2F0aW9uCnsKcHVibGljOgoKCgoKICAgIFlDb2RlTG9jYXRp
b24oIGNvbnN0IHN0ZDo6c3RyaW5nICYgZmlsZV9yLAogICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYg
ZnVuY19yLAogICAgIGludCBsaW5lX3IgKQogOiBfZmlsZSggZmlsZV9yICkKICwgX2Z1bmMoIGZ1
bmNfciApCiAsIF9saW5lKCBsaW5lX3IgKQoge30KCgoKCiAgICBZQ29kZUxvY2F0aW9uKCkKIDog
X2xpbmUoIDAgKQoge30KCgoKCiAgICBzdGQ6OnN0cmluZyBmaWxlKCkgY29uc3QgeyByZXR1cm4g
X2ZpbGU7IH0KCgoKCiAgICBzdGQ6OnN0cmluZyBmdW5jKCkgY29uc3QgeyByZXR1cm4gX2Z1bmM7
IH0KCgoKCiAgICBpbnQgbGluZSgpIGNvbnN0IHsgcmV0dXJuIF9saW5lOyB9CgoKCgogICAgc3Rk
OjpzdHJpbmcgYXNTdHJpbmcoKSBjb25zdDsKCgoKCiAgICBmcmllbmQgc3RkOjpvc3RyZWFtICYg
b3BlcmF0b3I8PCggc3RkOjpvc3RyZWFtICYgc3RyLCBjb25zdCBZQ29kZUxvY2F0aW9uICYgb2Jq
ICk7Cgpwcml2YXRlOgogICAgc3RkOjpzdHJpbmcgX2ZpbGU7CiAgICBzdGQ6OnN0cmluZyBfZnVu
YzsKICAgIGludCBfbGluZTsKCn07CgoKCgoKc3RkOjpvc3RyZWFtICYgb3BlcmF0b3I8PCggc3Rk
Ojpvc3RyZWFtICYgc3RyLCBjb25zdCBZQ29kZUxvY2F0aW9uICYgb2JqICk7CiMgMjgxICIvaG9t
ZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVVJRXhjZXB0
aW9uLmgiCmNsYXNzIFlVSUV4Y2VwdGlvbiA6IHB1YmxpYyBzdGQ6OmV4Y2VwdGlvbgp7CnB1Ymxp
YzoKCgoKCiAgICBZVUlFeGNlcHRpb24oKTsKCgoKCgogICAgWVVJRXhjZXB0aW9uKCBjb25zdCBz
dGQ6OnN0cmluZyAmIG1zZ19yICk7CgoKCgogICAgdmlydHVhbCB+WVVJRXhjZXB0aW9uKCkgdGhy
b3coKTsKCgoKCiAgICBjb25zdCBZQ29kZUxvY2F0aW9uICYgd2hlcmUoKSBjb25zdAogeyByZXR1
cm4gX3doZXJlOyB9CgoKCgogICAgdm9pZCByZWxvY2F0ZSggY29uc3QgWUNvZGVMb2NhdGlvbiAm
IG5ld0xvY2F0aW9uICkgY29uc3QKIHsgX3doZXJlID0gbmV3TG9jYXRpb247IH0KCgoKCgoKICAg
IGNvbnN0IHN0ZDo6c3RyaW5nICYgbXNnKCkgY29uc3QKIHsgcmV0dXJuIF9tc2c7IH0KCgoKCiAg
ICB2b2lkIHNldE1zZyggY29uc3Qgc3RkOjpzdHJpbmcgJiBtc2cgKQogeyBfbXNnID0gbXNnOyB9
CgoKCgogICAgc3RkOjpzdHJpbmcgYXNTdHJpbmcoKSBjb25zdDsKCgoKCiAgICBzdGF0aWMgc3Rk
OjpzdHJpbmcgc3RyRXJybm8oIGludCBlcnJub19yICk7CgoKCgogICAgc3RhdGljIHN0ZDo6c3Ry
aW5nIHN0ckVycm5vKCBpbnQgZXJybm9fciwgY29uc3Qgc3RkOjpzdHJpbmcgJiBtc2cgKTsKCgoK
CgogICAgc3RhdGljIHZvaWQgbG9nKCBjb25zdCBZVUlFeGNlcHRpb24gJiBleGNlcHRpb24sCiAg
ICAgICBjb25zdCBZQ29kZUxvY2F0aW9uICYgbG9jYXRpb24sCiAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IGNoYXIgKiBjb25zdCBwcmVmaXggKTsKCgoKCgogICAgdmlydHVhbCBjb25zdCBjaGFy
ICogd2hhdCgpIGNvbnN0IHRocm93KCkKIHsgcmV0dXJuIF9tc2cuY19zdHIoKTsgfQoKcHJvdGVj
dGVkOgoKCgoKICAgIHZpcnR1YWwgc3RkOjpvc3RyZWFtICYgZHVtcE9uKCBzdGQ6Om9zdHJlYW0g
JiBzdHIgKSBjb25zdDsKCgpwcml2YXRlOgogICAgZnJpZW5kIHN0ZDo6b3N0cmVhbSAmIG9wZXJh
dG9yPDwoIHN0ZDo6b3N0cmVhbSAmIHN0ciwgY29uc3QgWVVJRXhjZXB0aW9uICYgb2JqICk7CgoK
ICAgIG11dGFibGUgWUNvZGVMb2NhdGlvbiBfd2hlcmU7CiAgICBzdGQ6OnN0cmluZyBfbXNnOwoK
CgoKCiAgICBzdGQ6Om9zdHJlYW0gJiBkdW1wRXJyb3IoIHN0ZDo6b3N0cmVhbSAmIHN0ciApIGNv
bnN0OwoKfTsKCgoKCgpzdGQ6Om9zdHJlYW0gJiBvcGVyYXRvcjw8KCBzdGQ6Om9zdHJlYW0gJiBz
dHIsIGNvbnN0IFlVSUV4Y2VwdGlvbiAmIG9iaiApOwoKCgoKCgpjbGFzcyBZVUlOdWxsUG9pbnRl
ckV4Y2VwdGlvbjogcHVibGljIFlVSUV4Y2VwdGlvbgp7CnB1YmxpYzoKICAgIFlVSU51bGxQb2lu
dGVyRXhjZXB0aW9uKCkKIDogWVVJRXhjZXB0aW9uKCAiTnVsbCBwb2ludGVyIiApCiB7fQoKICAg
IHZpcnR1YWwgfllVSU51bGxQb2ludGVyRXhjZXB0aW9uKCkgdGhyb3coKQoge30KfTsKCgoKCgoK
Y2xhc3MgWVVJT3V0T2ZNZW1vcnlFeGNlcHRpb246IHB1YmxpYyBZVUlFeGNlcHRpb24KewpwdWJs
aWM6CiAgICBZVUlPdXRPZk1lbW9yeUV4Y2VwdGlvbigpCiA6IFlVSUV4Y2VwdGlvbiggIk91dCBv
ZiBtZW1vcnkiICkKIHt9CgogICAgdmlydHVhbCB+WVVJT3V0T2ZNZW1vcnlFeGNlcHRpb24oKSB0
aHJvdygpCiB7fQoKfTsKCgoKCgoKY2xhc3MgWVVJSW52YWxpZFdpZGdldEV4Y2VwdGlvbjogcHVi
bGljIFlVSUV4Y2VwdGlvbgp7CnB1YmxpYzoKICAgIFlVSUludmFsaWRXaWRnZXRFeGNlcHRpb24o
KQogOiBZVUlFeGNlcHRpb24oICJJbnZhbGlkIHdpZGdldCIgKQoge30KCiAgICB2aXJ0dWFsIH5Z
VUlJbnZhbGlkV2lkZ2V0RXhjZXB0aW9uKCkgdGhyb3coKQoge30KfTsKCgoKCgpjbGFzcyBZVUlX
aWRnZXROb3RGb3VuZEV4Y2VwdGlvbjogcHVibGljIFlVSUV4Y2VwdGlvbgp7CnB1YmxpYzoKICAg
IFlVSVdpZGdldE5vdEZvdW5kRXhjZXB0aW9uKCBjb25zdCBzdGQ6OnN0cmluZyAmIGlkU3RyaW5n
ICkKIDogWVVJRXhjZXB0aW9uKCBzdGQ6OnN0cmluZyggIk5vIHdpZGdldCB3aXRoIElEICIgKSAr
IGlkU3RyaW5nICkKIHt9CgogICAgdmlydHVhbCB+WVVJV2lkZ2V0Tm90Rm91bmRFeGNlcHRpb24o
KSB0aHJvdygpCiB7fQp9OwoKCmNsYXNzIFlVSU5vRGlhbG9nRXhjZXB0aW9uOiBwdWJsaWMgWVVJ
RXhjZXB0aW9uCnsKcHVibGljOgogICAgWVVJTm9EaWFsb2dFeGNlcHRpb24oKQogOiBZVUlFeGNl
cHRpb24oICJObyBkaWFsb2cgZXhpc3RpbmciICkKIHt9CgogICAgdmlydHVhbCB+WVVJTm9EaWFs
b2dFeGNlcHRpb24oKSB0aHJvdygpCiB7fQp9OwoKCmNsYXNzIFlVSURpYWxvZ1N0YWNraW5nT3Jk
ZXJFeGNlcHRpb246IHB1YmxpYyBZVUlFeGNlcHRpb24KewpwdWJsaWM6CiAgICBZVUlEaWFsb2dT
dGFja2luZ09yZGVyRXhjZXB0aW9uKCkKIDogWVVJRXhjZXB0aW9uKCAiRGlhbG9nIHN0YWNraW5n
IG9yZGVyIHZpb2xhdGVkIiApCiB7fQoKICAgIHZpcnR1YWwgfllVSURpYWxvZ1N0YWNraW5nT3Jk
ZXJFeGNlcHRpb24oKSB0aHJvdygpCiB7fQp9OwoKCmNsYXNzIFlVSVN5bnRheEVycm9yRXhjZXB0
aW9uOiBwdWJsaWMgWVVJRXhjZXB0aW9uCnsKcHVibGljOgogICAgWVVJU3ludGF4RXJyb3JFeGNl
cHRpb24oIGNvbnN0IHN0ZDo6c3RyaW5nICYgbXNnICkKIDogWVVJRXhjZXB0aW9uKCBtc2cgKQog
e30KCiAgICB2aXJ0dWFsIH5ZVUlTeW50YXhFcnJvckV4Y2VwdGlvbigpIHRocm93KCkKIHt9Cn07
CgoKCgoKY2xhc3MgWVVJUHJvcGVydHlFeGNlcHRpb246IHB1YmxpYyBZVUlFeGNlcHRpb24Kewpw
cm90ZWN0ZWQ6CiAgICBZVUlQcm9wZXJ0eUV4Y2VwdGlvbiggY29uc3QgWVByb3BlcnR5ICYgcHJv
cCwKICAgICBZV2lkZ2V0ICogd2lkZ2V0ID0gMCApCiA6IFlVSUV4Y2VwdGlvbigpCiAsIF9wcm9w
ZXJ0eSggcHJvcCApCiAsIF93aWRnZXQoIHdpZGdldCApCiB7fQoKICAgIHZpcnR1YWwgfllVSVBy
b3BlcnR5RXhjZXB0aW9uKCkgdGhyb3coKQoge30KCnB1YmxpYzoKCgoKICAgIFlQcm9wZXJ0eSBw
cm9wZXJ0eSgpIGNvbnN0IHsgcmV0dXJuIF9wcm9wZXJ0eTsgfQoKCgoKICAgIFlXaWRnZXQgKiB3
aWRnZXQoKSBjb25zdCB7IHJldHVybiBfd2lkZ2V0OyB9CgoKCgogICAgdm9pZCBzZXRXaWRnZXQo
IFlXaWRnZXQgKiB3ICkgeyBfd2lkZ2V0ID0gdzsgfQoKcHJvdGVjdGVkOgoKCgoKCiAgICB2aXJ0
dWFsIHN0ZDo6b3N0cmVhbSAmIGR1bXBPbiggc3RkOjpvc3RyZWFtICYgc3RyICkgY29uc3QgPSAw
OwoKcHJpdmF0ZToKICAgIFlQcm9wZXJ0eSBfcHJvcGVydHk7CiAgICBZV2lkZ2V0ICogX3dpZGdl
dDsKfTsKCgoKCgoKY2xhc3MgWVVJVW5rbm93blByb3BlcnR5RXhjZXB0aW9uOiBwdWJsaWMgWVVJ
UHJvcGVydHlFeGNlcHRpb24KewpwdWJsaWM6CiAgICBZVUlVbmtub3duUHJvcGVydHlFeGNlcHRp
b24oIGNvbnN0IHN0ZDo6c3RyaW5nICYgcHJvcGVydHlOYW1lLAogICAgIFlXaWRnZXQgKiB3aWRn
ZXQgPSAwICkKIDogWVVJUHJvcGVydHlFeGNlcHRpb24oIFlQcm9wZXJ0eSggcHJvcGVydHlOYW1l
LCBZVW5rbm93blByb3BlcnR5VHlwZSApLCB3aWRnZXQgKQoge30KCiAgICB2aXJ0dWFsIH5ZVUlV
bmtub3duUHJvcGVydHlFeGNlcHRpb24oKSB0aHJvdygpCiB7fQoKcHJvdGVjdGVkOgoKCgoKCiAg
ICB2aXJ0dWFsIHN0ZDo6b3N0cmVhbSAmIGR1bXBPbiggc3RkOjpvc3RyZWFtICYgc3RyICkgY29u
c3Q7Cn07CgoKCgoKCmNsYXNzIFlVSVByb3BlcnR5VHlwZU1pc21hdGNoRXhjZXB0aW9uOiBwdWJs
aWMgWVVJUHJvcGVydHlFeGNlcHRpb24KewpwdWJsaWM6CgogICAgWVVJUHJvcGVydHlUeXBlTWlz
bWF0Y2hFeGNlcHRpb24oIGNvbnN0IFlQcm9wZXJ0eSAmIHByb3BlcnR5LAogICAgICAgICAgWVBy
b3BlcnR5VHlwZSB0eXBlLAogICAgICAgICAgWVdpZGdldCAqIHdpZGdldCA9IDAgKQogOiBZVUlQ
cm9wZXJ0eUV4Y2VwdGlvbiggcHJvcGVydHksIHdpZGdldCApCiAsIF90eXBlKCB0eXBlICkKIHt9
CgogICAgdmlydHVhbCB+WVVJUHJvcGVydHlUeXBlTWlzbWF0Y2hFeGNlcHRpb24oKSB0aHJvdygp
CiB7fQoKCgoKICAgIFlQcm9wZXJ0eVR5cGUgdHlwZSgpIGNvbnN0IHsgcmV0dXJuIF90eXBlOyB9
Cgpwcm90ZWN0ZWQ6CgoKCgoKICAgIHZpcnR1YWwgc3RkOjpvc3RyZWFtICYgZHVtcE9uKCBzdGQ6
Om9zdHJlYW0gJiBzdHIgKSBjb25zdDsKCnByaXZhdGU6CiAgICBZUHJvcGVydHlUeXBlIF90eXBl
Owp9OwoKCgoKCmNsYXNzIFlVSVNldFJlYWRPbmx5UHJvcGVydHlFeGNlcHRpb246IHB1YmxpYyBZ
VUlQcm9wZXJ0eUV4Y2VwdGlvbgp7CnB1YmxpYzoKCiAgICBZVUlTZXRSZWFkT25seVByb3BlcnR5
RXhjZXB0aW9uKCBjb25zdCBZUHJvcGVydHkgJiBwcm9wZXJ0eSwKICAgICAgICAgWVdpZGdldCAq
IHdpZGdldCA9IDAgKQogOiBZVUlQcm9wZXJ0eUV4Y2VwdGlvbiggcHJvcGVydHksIHdpZGdldCAp
CiB7fQoKICAgIHZpcnR1YWwgfllVSVNldFJlYWRPbmx5UHJvcGVydHlFeGNlcHRpb24oKSB0aHJv
dygpCiB7fQoKcHJvdGVjdGVkOgoKCgoKCiAgICB2aXJ0dWFsIHN0ZDo6b3N0cmVhbSAmIGR1bXBP
biggc3RkOjpvc3RyZWFtICYgc3RyICkgY29uc3Q7Cn07CgoKY2xhc3MgWVVJQmFkUHJvcGVydHlB
cmdFeGNlcHRpb246IHB1YmxpYyBZVUlQcm9wZXJ0eUV4Y2VwdGlvbgp7CnB1YmxpYzoKCiAgICBZ
VUlCYWRQcm9wZXJ0eUFyZ0V4Y2VwdGlvbiggY29uc3QgWVByb3BlcnR5ICYgcHJvcGVydHksCiAg
ICBZV2lkZ2V0ICogd2lkZ2V0LAogICAgY29uc3Qgc3RkOjpzdHJpbmcgJiBtZXNzYWdlID0gIiIg
KQogOiBZVUlQcm9wZXJ0eUV4Y2VwdGlvbiggcHJvcGVydHksIHdpZGdldCApCiB7IHNldE1zZygg
bWVzc2FnZSApOyB9CgogICAgdmlydHVhbCB+WVVJQmFkUHJvcGVydHlBcmdFeGNlcHRpb24oKSB0
aHJvdygpCiB7fQoKcHJvdGVjdGVkOgoKCgoKCiAgICB2aXJ0dWFsIHN0ZDo6b3N0cmVhbSAmIGR1
bXBPbiggc3RkOjpvc3RyZWFtICYgc3RyICkgY29uc3Q7Cn07CgoKCgoKCgp0ZW1wbGF0ZTxjbGFz
cyBZV2lkZ2V0PiBjbGFzcyBZVUlUb29NYW55Q2hpbGRyZW5FeGNlcHRpb246IHB1YmxpYyBZVUlF
eGNlcHRpb24KewpwdWJsaWM6CgogICAgWVVJVG9vTWFueUNoaWxkcmVuRXhjZXB0aW9uKCBZV2lk
Z2V0ICogY29udGFpbmVyICkKIDogWVVJRXhjZXB0aW9uKCAiVG9vIG1hbnkgY2hpbGRyZW4iICkK
ICwgX2NvbnRhaW5lciggY29udGFpbmVyICkKIHt9CgogICAgdmlydHVhbCB+WVVJVG9vTWFueUNo
aWxkcmVuRXhjZXB0aW9uKCkgdGhyb3coKQoge30KCgoKCiAgICBZV2lkZ2V0ICogY29udGFpbmVy
KCkgY29uc3QgeyByZXR1cm4gX2NvbnRhaW5lcjsgfQoKcHJvdGVjdGVkOgoKCgoKCiAgICB2aXJ0
dWFsIHN0ZDo6b3N0cmVhbSAmIGR1bXBPbiggc3RkOjpvc3RyZWFtICYgc3RyICkgY29uc3QKICAg
IHsKIHN0ZDo6c3RyaW5nIHdpZGdldENsYXNzID0KICAgICBjb250YWluZXIoKSA/IGNvbnRhaW5l
cigpLT53aWRnZXRDbGFzcygpIDoKICAgICAid2lkZ2V0IjsKCiByZXR1cm4gc3RyIDw8ICJUb28g
bWFueSBjaGlsZHJlbiBmb3IgIgogICAgIDw8IHdpZGdldENsYXNzCiAgICAgPDwgc3RkOjplbmRs
OwogICAgfQoKcHJpdmF0ZToKCiAgICBZV2lkZ2V0ICogX2NvbnRhaW5lcjsKfTsKIyA2OTYgIi9o
b21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZVUlFeGNl
cHRpb24uaCIKdGVtcGxhdGU8Y2xhc3MgWVdpZGdldD4gY2xhc3MgWVVJSW52YWxpZENoaWxkRXhj
ZXB0aW9uOiBwdWJsaWMgWVVJRXhjZXB0aW9uCnsKcHVibGljOgoKICAgIFlVSUludmFsaWRDaGls
ZEV4Y2VwdGlvbiggWVdpZGdldCAqIGNvbnRhaW5lciwKICAgICAgICAgWVdpZGdldCAqIGNoaWxk
ID0gMCApCiA6IFlVSUV4Y2VwdGlvbiggIkludmFsaWQgY2hpbGQiICkKICwgX2NvbnRhaW5lcigg
Y29udGFpbmVyICkKICwgX2NoaWxkKCBjaGlsZCApCiB7fQoKICAgIHZpcnR1YWwgfllVSUludmFs
aWRDaGlsZEV4Y2VwdGlvbigpIHRocm93KCkKIHt9CgoKCgogICAgWVdpZGdldCAqIGNvbnRhaW5l
cigpIGNvbnN0IHsgcmV0dXJuIF9jb250YWluZXI7IH0KCgoKCiAgICBZV2lkZ2V0ICogY2hpbGQo
KSBjb25zdCB7IHJldHVybiBfY2hpbGQ7IH0KCnByb3RlY3RlZDoKCgoKCgogICAgdmlydHVhbCBz
dGQ6Om9zdHJlYW0gJiBkdW1wT24oIHN0ZDo6b3N0cmVhbSAmIHN0ciApIGNvbnN0CiAgICB7CiBz
dGQ6OnN0cmluZyBjb250YWluZXJXaWRnZXRDbGFzcyA9CiAgICAgY29udGFpbmVyKCkgPyBjb250
YWluZXIoKS0+d2lkZ2V0Q2xhc3MoKSA6CiAgICAgIndpZGdldCI7Cgogc3RkOjpzdHJpbmcgY2hp
bGRXaWRnZXRDbGFzcyA9CiAgICAgY2hpbGQoKSA/IGNoaWxkKCktPndpZGdldENsYXNzKCkgOgog
ICAgICI8TnVsbD4iOwoKIHJldHVybiBzdHIgPDwgY2hpbGRXaWRnZXRDbGFzcwogICAgIDw8ICIg
aXMgbm90IGEgY2hpbGQgb2YgIgogICAgIDw8IGNvbnRhaW5lcldpZGdldENsYXNzCiAgICAgPDwg
c3RkOjplbmRsOwogICAgfQoKcHJpdmF0ZToKCiAgICBZV2lkZ2V0ICogX2NvbnRhaW5lcjsKICAg
IFlXaWRnZXQgKiBfY2hpbGQ7Cn07CiMgNzU5ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWkt
bGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVVJRXhjZXB0aW9uLmgiCmNsYXNzIFlVSVVuc3VwcG9y
dGVkV2lkZ2V0RXhjZXB0aW9uOiBwdWJsaWMgWVVJRXhjZXB0aW9uCnsKcHVibGljOgoKICAgIFlV
SVVuc3VwcG9ydGVkV2lkZ2V0RXhjZXB0aW9uKCBjb25zdCBzdGQ6OnN0cmluZyAmIHdpZGdldFR5
cGUgKQogOiBZVUlFeGNlcHRpb24oIHN0ZDo6c3RyaW5nKCAiVW5zdXBwb3J0ZWQgb3B0aW9uYWwg
d2lkZ2V0IHR5cGU6ICIgKSArIHdpZGdldFR5cGUgKQoge30KCiAgICB2aXJ0dWFsIH5ZVUlVbnN1
cHBvcnRlZFdpZGdldEV4Y2VwdGlvbigpIHRocm93KCkKIHt9Cn07CgoKCgoKCmNsYXNzIFlVSUlu
dmFsaWREaW1lbnNpb25FeGNlcHRpb246IHB1YmxpYyBZVUlFeGNlcHRpb24KewpwdWJsaWM6CiAg
ICBZVUlJbnZhbGlkRGltZW5zaW9uRXhjZXB0aW9uKCkKIDogWVVJRXhjZXB0aW9uKCAiSW52YWxp
ZCBkaW1lbnNpb24gKG5laXRoZXIgWURfSE9SSVogbm9yIFlEX1ZFUlQpIiApCiB7fQoKICAgIHZp
cnR1YWwgfllVSUludmFsaWREaW1lbnNpb25FeGNlcHRpb24oKSB0aHJvdygpCiB7fQp9OwoKCgoK
CmNsYXNzIFlVSUluZGV4T3V0T2ZSYW5nZUV4Y2VwdGlvbjogcHVibGljIFlVSUV4Y2VwdGlvbgp7
CnB1YmxpYzoKIyA4MDIgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVy
LTMuMi4xL3NyYy9ZVUlFeGNlcHRpb24uaCIKICAgIFlVSUluZGV4T3V0T2ZSYW5nZUV4Y2VwdGlv
biggaW50IGludmFsaWRJbmRleCwKICAgICBpbnQgdmFsaWRNaW4sCiAgICAgaW50IHZhbGlkTWF4
LAogICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgbXNnID0gIiIgKQogOiBZVUlFeGNlcHRpb24oIG1z
ZyApCiAsIF9pbnZhbGlkSW5kZXgoIGludmFsaWRJbmRleCApCiAsIF92YWxpZE1pbiggdmFsaWRN
aW4gKQogLCBfdmFsaWRNYXgoIHZhbGlkTWF4ICkKIHt9CgogICAgdmlydHVhbCB+WVVJSW5kZXhP
dXRPZlJhbmdlRXhjZXB0aW9uKCkgdGhyb3coKQoge30KCgoKCiAgICBpbnQgaW52YWxpZEluZGV4
KCkgY29uc3QgeyByZXR1cm4gX2ludmFsaWRJbmRleDsgfQoKCgoKICAgIGludCB2YWxpZE1pbigp
IGNvbnN0IHsgcmV0dXJuIF92YWxpZE1pbjsgfQoKCgoKICAgIGludCB2YWxpZE1heCgpIGNvbnN0
IHsgcmV0dXJuIF92YWxpZE1heDsgfQoKcHJvdGVjdGVkOgoKCgoKCiAgICB2aXJ0dWFsIHN0ZDo6
b3N0cmVhbSAmIGR1bXBPbiggc3RkOjpvc3RyZWFtICYgc3RyICkgY29uc3QKICAgIHsKIHN0ZDo6
c3RyaW5nIHByZWZpeCA9IG1zZygpOwoKIGlmICggcHJlZml4LmVtcHR5KCkgKQogICAgIHByZWZp
eCA9ICJJbmRleCBvdXQgb2YgcmFuZ2UiOwoKIHJldHVybiBzdHIgPDwgcHJlZml4IDw8ICI6ICIg
PDwgX2ludmFsaWRJbmRleAogICAgIDw8ICIgdmFsaWQ6ICIgPDwgX3ZhbGlkTWluIDw8ICIgLi4g
IiA8PCBfdmFsaWRNYXgKICAgICA8PCBzdGQ6OmVuZGw7CiAgICB9Cgpwcml2YXRlOgoKICAgIGlu
dCBfaW52YWxpZEluZGV4OwogICAgaW50IF92YWxpZE1pbjsKICAgIGludCBfdmFsaWRNYXg7Cn07
CgoKCgoKY2xhc3MgWVVJUGx1Z2luRXhjZXB0aW9uOiBwdWJsaWMgWVVJRXhjZXB0aW9uCnsKcHVi
bGljOgogICAgWVVJUGx1Z2luRXhjZXB0aW9uKCBjb25zdCBzdGQ6OnN0cmluZyAmIHBsdWdpbk5h
bWUgKQogOiBZVUlFeGNlcHRpb24oIHN0ZDo6c3RyaW5nKCAiQ291bGRuJ3QgbG9hZCBwbHVnLWlu
ICIgKSArIHBsdWdpbk5hbWUgKQoge30KCiAgICB2aXJ0dWFsIH5ZVUlQbHVnaW5FeGNlcHRpb24o
KSB0aHJvdygpCiB7fQp9OwoKCgoKCmNsYXNzIFlVSUNhbnRMb2FkQW55VUlFeGNlcHRpb246IHB1
YmxpYyBZVUlFeGNlcHRpb24KewpwdWJsaWM6CiAgICBZVUlDYW50TG9hZEFueVVJRXhjZXB0aW9u
KCkKIDogWVVJRXhjZXB0aW9uKCAiTm8gJERJU1BMQVkgYW5kIHN0ZG91dCBpcyBub3QgYSB0dHki
ICkKIHt9CgogICAgdmlydHVhbCB+WVVJQ2FudExvYWRBbnlVSUV4Y2VwdGlvbigpIHRocm93KCkK
IHt9Cn07CgoKCgoKY2xhc3MgWVVJQnV0dG9uUm9sZU1pc21hdGNoRXhjZXB0aW9uOiBwdWJsaWMg
WVVJRXhjZXB0aW9uCnsKcHVibGljOgoKICAgIFlVSUJ1dHRvblJvbGVNaXNtYXRjaEV4Y2VwdGlv
biggY29uc3Qgc3RkOjpzdHJpbmcgJiBtc2cgKQogOiBZVUlFeGNlcHRpb24oIG1zZyApCiB7fQoK
ICAgIHZpcnR1YWwgfllVSUJ1dHRvblJvbGVNaXNtYXRjaEV4Y2VwdGlvbigpIHRocm93KCkKIHt9
Cn07CiMgOTEwICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIu
MS9zcmMvWVVJRXhjZXB0aW9uLmgiCnRlbXBsYXRlPGNsYXNzIF9FeGNlcHRpb24+CnZvaWQgX1lV
SV9USFJPVyggY29uc3QgX0V4Y2VwdGlvbiAmIGV4Y2VwdGlvbl9yLCBjb25zdCBZQ29kZUxvY2F0
aW9uICYgd2hlcmVfciApCnsKICAgIGV4Y2VwdGlvbl9yLnJlbG9jYXRlKCB3aGVyZV9yICk7CiAg
ICBZVUlFeGNlcHRpb246OmxvZyggZXhjZXB0aW9uX3IsIHdoZXJlX3IsICJUSFJPVzogICAiICk7
CiAgICB0aHJvdyggZXhjZXB0aW9uX3IgKTsKfQoKCgoKCnRlbXBsYXRlPGNsYXNzIF9FeGNlcHRp
b24+CnZvaWQgX1lVSV9DQVVHSFQoIGNvbnN0IF9FeGNlcHRpb24gJiBleGNlcHRpb25fciwgY29u
c3QgWUNvZGVMb2NhdGlvbiAmIHdoZXJlX3IgKQp7CiAgICBZVUlFeGNlcHRpb246OmxvZyggZXhj
ZXB0aW9uX3IsIHdoZXJlX3IsICJDQVVHSFQ6ICAiICk7Cn0KCgoKCgp0ZW1wbGF0ZTxjbGFzcyBf
RXhjZXB0aW9uPgp2b2lkIF9ZVUlfUkVUSFJPVyggY29uc3QgX0V4Y2VwdGlvbiAmIGV4Y2VwdGlv
bl9yLCBjb25zdCBZQ29kZUxvY2F0aW9uICYgd2hlcmVfciApCnsKICAgIFlVSUV4Y2VwdGlvbjo6
bG9nKCBleGNlcHRpb25fciwgd2hlcmVfciwgIlJFVEhST1c6ICIgKTsKICAgIGV4Y2VwdGlvbl9y
LnJlbG9jYXRlKCB3aGVyZV9yICk7CiAgICB0aHJvdzsKfQojIDM1ICIvaG9tZS9zaGFya2N6L2xp
Ynl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVdpZGdldC5oIiAyCiMgMSAiL2hv
bWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lDaGlsZHJl
bk1hbmFnZXIuaCIgMQojIDM3ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1h
c3Rlci0zLjIuMS9zcmMvWUNoaWxkcmVuTWFuYWdlci5oIgp0ZW1wbGF0ZTxjbGFzcyBUPiBjbGFz
cyBZQ2hpbGRyZW5NYW5hZ2VyCnsKcHVibGljOgoKCgoKCgogICAgWUNoaWxkcmVuTWFuYWdlcigg
VCAqIGNvbnRhaW5lclBhcmVudCApCiA6IF9jb250YWluZXIoIGNvbnRhaW5lclBhcmVudCApCiB7
fQoKCgoKICAgIHZpcnR1YWwgfllDaGlsZHJlbk1hbmFnZXIoKSB7fQoKCiAgICB0eXBlZGVmIHN0
ZDo6bGlzdDxUICo+IENoaWxkcmVuTGlzdDsKCgoKCiAgICBib29sIGhhc0NoaWxkcmVuKCkgY29u
c3QgeyByZXR1cm4gISBlbXB0eSgpOyB9CgoKCgogICAgYm9vbCBlbXB0eSgpIGNvbnN0IHsgcmV0
dXJuIF9jaGlsZHJlbi5lbXB0eSgpOyB9CgoKCgogICAgaW50IGNvdW50KCkgY29uc3QgeyByZXR1
cm4gX2NoaWxkcmVuLnNpemUoKTsgfQoKCgoKICAgIHR5cGVuYW1lIENoaWxkcmVuTGlzdDo6Y29u
c3RfaXRlcmF0b3IgYmVnaW4oKSBjb25zdAogeyByZXR1cm4gX2NoaWxkcmVuLmJlZ2luKCk7IH0K
CgoKCiAgICB0eXBlbmFtZSBDaGlsZHJlbkxpc3Q6OmNvbnN0X2l0ZXJhdG9yIGVuZCgpIGNvbnN0
CiB7IHJldHVybiBfY2hpbGRyZW4uZW5kKCk7IH0KCgoKCiAgICB0eXBlbmFtZSBDaGlsZHJlbkxp
c3Q6OmNvbnN0X3JldmVyc2VfaXRlcmF0b3IgcmJlZ2luKCkgY29uc3QKIHsgcmV0dXJuIF9jaGls
ZHJlbi5yYmVnaW4oKTsgfQoKCgoKICAgIHR5cGVuYW1lIENoaWxkcmVuTGlzdDo6Y29uc3RfcmV2
ZXJzZV9pdGVyYXRvciByZW5kKCkgY29uc3QKIHsgcmV0dXJuIF9jaGlsZHJlbi5yZW5kKCk7IH0K
CgoKCgogICAgVCAqIGZpcnN0Q2hpbGQoKQogeyByZXR1cm4gX2NoaWxkcmVuLmVtcHR5KCkgPyAo
VCAqKSAwIDogX2NoaWxkcmVuLmZyb250KCk7IH0KCgoKCiAgICBUICogbGFzdENoaWxkKCkKIHsg
cmV0dXJuIF9jaGlsZHJlbi5lbXB0eSgpID8gKFQgKikgMCA6IF9jaGlsZHJlbi5iYWNrKCk7IH0K
CgoKCgoKCiAgICB2aXJ0dWFsIHZvaWQgYWRkKCBUICogY2hpbGQgKQogeyBfY2hpbGRyZW4ucHVz
aF9iYWNrKCBjaGlsZCApOyB9CgoKCgoKICAgIHZpcnR1YWwgdm9pZCByZW1vdmUoIFQgKiBjaGls
ZCApCiB7IF9jaGlsZHJlbi5yZW1vdmUoIGNoaWxkICk7IH0KCgoKCgogICAgdmlydHVhbCB2b2lk
IGNsZWFyKCkKIHsgX2NoaWxkcmVuLmNsZWFyKCk7IH0KCgoKCgoKICAgIGJvb2wgY29udGFpbnMo
IFQgKiBjaGlsZCApIGNvbnN0CiAgICB7CiByZXR1cm4gKCBmaW5kKCBfY2hpbGRyZW4uYmVnaW4o
KSwgX2NoaWxkcmVuLmVuZCgpLCBjaGlsZCApCiAgICE9IF9jaGlsZHJlbi5lbmQoKSApOwogICAg
fQoKCgoKCiAgICBUICogY29udGFpbmVyKCkgY29uc3QgeyByZXR1cm4gX2NvbnRhaW5lcjsgfQoK
cHJvdGVjdGVkOgoKICAgIFQgKiBfY29udGFpbmVyOwogICAgQ2hpbGRyZW5MaXN0IF9jaGlsZHJl
bjsKfTsKCgoKCgoKdGVtcGxhdGU8Y2xhc3MgVD4gY2xhc3MgWVNpbmdsZUNoaWxkTWFuYWdlcjog
cHVibGljIFlDaGlsZHJlbk1hbmFnZXI8VD4KewpwdWJsaWM6CgogICAgWVNpbmdsZUNoaWxkTWFu
YWdlciggVCAqIGNvbnRhaW5lclBhcmVudCApCiA6IFlDaGlsZHJlbk1hbmFnZXI8VD4oIGNvbnRh
aW5lclBhcmVudCApCiB7fQojIDE3NyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1
aS1tYXN0ZXItMy4yLjEvc3JjL1lDaGlsZHJlbk1hbmFnZXIuaCIKICAgIHZpcnR1YWwgdm9pZCBh
ZGQoIFQgKiBjaGlsZCApCiAgICB7CiBpZiAoIHRoaXMtPmVtcHR5KCkgKQogICAgIHRoaXMtPl9j
aGlsZHJlbi5wdXNoX2JhY2soIGNoaWxkICk7CiBlbHNlCiAgICAgX1lVSV9USFJPVyggKCBZVUlU
b29NYW55Q2hpbGRyZW5FeGNlcHRpb248VD4oIHRoaXMtPmNvbnRhaW5lcigpICkgKSwgWUNvZGVM
b2NhdGlvbigiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEv
c3JjL1lDaGlsZHJlbk1hbmFnZXIuaCIsX19GVU5DVElPTl9fLDE4MikgKTsKICAgIH0KCgoKCiAg
ICB2b2lkIHJlcGxhY2UoIFQgKiBuZXdDaGlsZCApCiAgICB7CiB0aGlzLT5fY2hpbGRyZW4uY2xl
YXIoKTsKIHRoaXMtPl9jaGlsZHJlbi5wdXNoX2JhY2soIG5ld0NoaWxkICk7CiAgICB9Cn07CiMg
MjAyICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMv
WUNoaWxkcmVuTWFuYWdlci5oIgp0ZW1wbGF0ZTxjbGFzcyBUPiBjbGFzcyBZQ2hpbGRyZW5SZWpl
Y3RvcjogcHVibGljIFlDaGlsZHJlbk1hbmFnZXI8VD4KewpwdWJsaWM6CgoKCiAgICBZQ2hpbGRy
ZW5SZWplY3RvciggVCAqIGNvbnRhaW5lclBhcmVudCApCiA6IFlDaGlsZHJlbk1hbmFnZXI8VD4o
IGNvbnRhaW5lclBhcmVudCApCiB7fQojIDIyMCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVp
LWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lDaGlsZHJlbk1hbmFnZXIuaCIKICAgIHZpcnR1YWwg
dm9pZCBhZGQoIFQgKiBjaGlsZCApCiB7IF9ZVUlfVEhST1coICggWVVJVG9vTWFueUNoaWxkcmVu
RXhjZXB0aW9uPFQ+KCB0aGlzLT5jb250YWluZXIoKSApICksIFlDb2RlTG9jYXRpb24oIi9ob21l
L3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZQ2hpbGRyZW5N
YW5hZ2VyLmgiLF9fRlVOQ1RJT05fXywyMjEpICk7IH0KfTsKIyAzNiAiL2hvbWUvc2hhcmtjei9s
aWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lXaWRnZXQuaCIgMgoKCgpjbGFz
cyBZRGlhbG9nOwpjbGFzcyBZV2lkZ2V0SUQ7CmNsYXNzIFlNYWNyb1JlY29yZGVyOwoKCnR5cGVk
ZWYgWUNoaWxkcmVuTWFuYWdlcjxZV2lkZ2V0PiBZV2lkZ2V0Q2hpbGRyZW5NYW5hZ2VyOwp0eXBl
ZGVmIFlTaW5nbGVDaGlsZE1hbmFnZXI8WVdpZGdldD4gWVNpbmdsZVdpZGdldENoaWxkTWFuYWdl
cjsKdHlwZWRlZiBZQ2hpbGRyZW5SZWplY3RvcjxZV2lkZ2V0PiBZV2lkZ2V0Q2hpbGRyZW5SZWpl
Y3RvcjsKCmNsYXNzIFlXaWRnZXRQcml2YXRlOwoKCgoKCmNsYXNzIFlXaWRnZXQKewpwcm90ZWN0
ZWQ6CgoKCiAgICBZV2lkZ2V0KCBZV2lkZ2V0ICogcGFyZW50ICk7CgpwdWJsaWM6CgoKCiAgICB2
aXJ0dWFsIH5ZV2lkZ2V0KCk7CgoKCgoKICAgIHZpcnR1YWwgY29uc3QgY2hhciAqIHdpZGdldENs
YXNzKCkgY29uc3QgeyByZXR1cm4gIllXaWRnZXQiOyB9CiMgODUgIi9ob21lL3NoYXJrY3ovbGli
eXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2lkZ2V0LmgiCiAgICB2aXJ0dWFs
IHN0ZDo6c3RyaW5nIGRlYnVnTGFiZWwoKSBjb25zdDsKCgoKCiAgICBzdGQ6OnN0cmluZyBoZWxw
VGV4dCgpIGNvbnN0OwojIDk5ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1h
c3Rlci0zLjIuMS9zcmMvWVdpZGdldC5oIgogICAgdm9pZCBzZXRIZWxwVGV4dCggY29uc3Qgc3Rk
OjpzdHJpbmcgJiBoZWxwVGV4dCApOwojIDEzOCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVp
LWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lXaWRnZXQuaCIKICAgIHZpcnR1YWwgY29uc3QgWVBy
b3BlcnR5U2V0ICYgcHJvcGVydHlTZXQoKTsKIyAxNTIgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xp
Ynl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2lkZ2V0LmgiCiAgICB2aXJ0dWFsIGJvb2wg
c2V0UHJvcGVydHkoIGNvbnN0IHN0ZDo6c3RyaW5nICYgcHJvcGVydHlOYW1lLAogICAgICAgICBj
b25zdCBZUHJvcGVydHlWYWx1ZSAmIHZhbCApOwoKCgoKCgoKICAgIHZpcnR1YWwgWVByb3BlcnR5
VmFsdWUgZ2V0UHJvcGVydHkoIGNvbnN0IHN0ZDo6c3RyaW5nICYgcHJvcGVydHlOYW1lICk7CiMg
MTkyICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMv
WVdpZGdldC5oIgogICAgYm9vbCBoYXNDaGlsZHJlbigpIGNvbnN0CiB7IHJldHVybiBjaGlsZHJl
bk1hbmFnZXIoKS0+aGFzQ2hpbGRyZW4oKTsgfQoKCgoKCiAgICBZV2lkZ2V0ICogZmlyc3RDaGls
ZCgpIGNvbnN0CiB7IHJldHVybiBjaGlsZHJlbk1hbmFnZXIoKS0+Zmlyc3RDaGlsZCgpOyB9CgoK
CgogICAgWVdpZGdldCAqIGxhc3RDaGlsZCgpIGNvbnN0CiB7IHJldHVybiBjaGlsZHJlbk1hbmFn
ZXIoKS0+bGFzdENoaWxkKCk7IH0KCgoKCgogICAgWVdpZGdldExpc3RDb25zdEl0ZXJhdG9yIGNo
aWxkcmVuQmVnaW4oKSBjb25zdAogeyByZXR1cm4gY2hpbGRyZW5NYW5hZ2VyKCktPmJlZ2luKCk7
IH0KCgoKCiAgICBZV2lkZ2V0TGlzdENvbnN0SXRlcmF0b3IgY2hpbGRyZW5FbmQoKSBjb25zdAog
eyByZXR1cm4gY2hpbGRyZW5NYW5hZ2VyKCktPmVuZCgpOyB9CgoKCgogICAgaW50IGNoaWxkcmVu
Q291bnQoKSBjb25zdCB7IHJldHVybiBjaGlsZHJlbk1hbmFnZXIoKS0+Y291bnQoKTsgfQoKCgoK
ICAgIGJvb2wgY29udGFpbnMoIFlXaWRnZXQgKiBjaGlsZCApIGNvbnN0CiB7IHJldHVybiBjaGls
ZHJlbk1hbmFnZXIoKS0+Y29udGFpbnMoIGNoaWxkICk7IH0KCgoKCgoKCiAgICB2aXJ0dWFsIHZv
aWQgYWRkQ2hpbGQoIFlXaWRnZXQgKiBjaGlsZCApOwoKCgoKCiAgICB2aXJ0dWFsIHZvaWQgcmVt
b3ZlQ2hpbGQoIFlXaWRnZXQgKiBjaGlsZCApOwoKCgoKICAgIHZvaWQgZGVsZXRlQ2hpbGRyZW4o
KTsKCgoKCiAgICBZV2lkZ2V0ICogcGFyZW50KCkgY29uc3Q7CgoKCgogICAgYm9vbCBoYXNQYXJl
bnQoKSBjb25zdDsKCgoKCiAgICB2b2lkIHNldFBhcmVudCggWVdpZGdldCAqIG5ld1BhcmVudCAp
OwoKCgoKCiAgICBZRGlhbG9nICogZmluZERpYWxvZygpOwoKCgoKCgoKICAgIFlXaWRnZXQgKiBm
aW5kV2lkZ2V0KCBZV2lkZ2V0SUQgKiBpZCwgYm9vbCBkb1Rocm93ID0gdHJ1ZSApIGNvbnN0Owoj
IDI5MCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3Jj
L1lXaWRnZXQuaCIKICAgIHZpcnR1YWwgaW50IHByZWZlcnJlZFdpZHRoKCkgPSAwOwoKCgoKCgog
ICAgdmlydHVhbCBpbnQgcHJlZmVycmVkSGVpZ2h0KCkgPSAwOwojIDMwOSAiL2hvbWUvc2hhcmtj
ei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lXaWRnZXQuaCIKICAgIHZp
cnR1YWwgaW50IHByZWZlcnJlZFNpemUoIFlVSURpbWVuc2lvbiBkaW0gKTsKIyAzMjYgIi9ob21l
L3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2lkZ2V0Lmgi
CiAgICB2aXJ0dWFsIHZvaWQgc2V0U2l6ZSggaW50IG5ld1dpZHRoLCBpbnQgbmV3SGVpZ2h0ICkg
PSAwOwojIDM0MSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4y
LjEvc3JjL1lXaWRnZXQuaCIKICAgIGJvb2wgaXNWYWxpZCgpIGNvbnN0OwoKCgoKICAgIGJvb2wg
YmVpbmdEZXN0cm95ZWQoKSBjb25zdDsKCgoKCgogICAgdm9pZCAqIHdpZGdldFJlcCgpIGNvbnN0
OwojIDM2MyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEv
c3JjL1lXaWRnZXQuaCIKICAgIHZvaWQgc2V0V2lkZ2V0UmVwKCB2b2lkICogdG9vbGtpdFdpZGdl
dFJlcCApOwoKCgoKICAgIGJvb2wgaGFzSWQoKSBjb25zdDsKCgoKCiAgICBZV2lkZ2V0SUQgKiBp
ZCgpIGNvbnN0OwojIDM4NiAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0
ZXItMy4yLjEvc3JjL1lXaWRnZXQuaCIKICAgIHZvaWQgc2V0SWQoIFlXaWRnZXRJRCAqIG5ld0lk
X2Rpc293biApOwoKCgoKCgoKICAgIHZpcnR1YWwgdm9pZCBzZXRFbmFibGVkKCBib29sIGVuYWJs
ZWQgPSB0cnVlICk7CgoKCgogICAgdm9pZCBzZXREaXNhYmxlZCgpIHsgc2V0RW5hYmxlZCggZmFs
c2UpOyB9CgoKCgogICAgdmlydHVhbCBib29sIGlzRW5hYmxlZCgpIGNvbnN0OwojIDQxNCAiL2hv
bWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lXaWRnZXQu
aCIKICAgIHZpcnR1YWwgYm9vbCBzdHJldGNoYWJsZSggWVVJRGltZW5zaW9uIGRpbSApIGNvbnN0
OwoKCgoKCiAgICB2b2lkIHNldFN0cmV0Y2hhYmxlKCBZVUlEaW1lbnNpb24gZGltLCBib29sIG5l
d1N0cmV0Y2ggKTsKCgoKCgogICAgdm9pZCBzZXREZWZhdWx0U3RyZXRjaGFibGUoIFlVSURpbWVu
c2lvbiBkaW0sIGJvb2wgbmV3U3RyZXRjaCApOwojIDQzOCAiL2hvbWUvc2hhcmtjei9saWJ5dWkv
bGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lXaWRnZXQuaCIKICAgIHZpcnR1YWwgaW50
IHdlaWdodCggWVVJRGltZW5zaW9uIGRpbSApOwoKCgoKCiAgICBib29sIGhhc1dlaWdodCggWVVJ
RGltZW5zaW9uIGRpbSApOwoKCgoKICAgIHZvaWQgc2V0V2VpZ2h0KCBZVUlEaW1lbnNpb24gZGlt
LCBpbnQgd2VpZ2h0ICk7CgoKCgogICAgdm9pZCBzZXROb3RpZnkoIGJvb2wgbm90aWZ5ID0gdHJ1
ZSApOwoKCgoKCiAgICBib29sIG5vdGlmeSgpIGNvbnN0OwoKCgoKICAgIHZvaWQgc2V0Tm90aWZ5
Q29udGV4dE1lbnUoIGJvb2wgbm90aWZ5Q29udGV4dE1lbnUgPSB0cnVlICk7CgoKCgoKICAgIGJv
b2wgbm90aWZ5Q29udGV4dE1lbnUoKSBjb25zdDsKCgoKCgoKICAgIGJvb2wgc2VuZEtleUV2ZW50
cygpIGNvbnN0OwoKCgoKICAgIHZvaWQgc2V0U2VuZEtleUV2ZW50cyggYm9vbCBkb1NlbmQgKTsK
CgoKCgogICAgYm9vbCBhdXRvU2hvcnRjdXQoKSBjb25zdDsKCgoKCiAgICB2b2lkIHNldEF1dG9T
aG9ydGN1dCggYm9vbCBfbmV3QXV0b1Nob3J0Y3V0ICk7CgoKCgoKICAgIGludCBmdW5jdGlvbktl
eSgpIGNvbnN0OwoKCgoKICAgIGJvb2wgaGFzRnVuY3Rpb25LZXkoKSBjb25zdDsKIyA1MTQgIi9o
b21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2lkZ2V0
LmgiCiAgICB2aXJ0dWFsIHZvaWQgc2V0RnVuY3Rpb25LZXkoIGludCBma2V5X25vICk7CiMgNTI1
ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVdp
ZGdldC5oIgogICAgdmlydHVhbCBib29sIHNldEtleWJvYXJkRm9jdXMoKTsKCgoKCgoKCiAgICB2
aXJ0dWFsIHN0ZDo6c3RyaW5nIHNob3J0Y3V0U3RyaW5nKCkgY29uc3QgeyByZXR1cm4gc3RkOjpz
dHJpbmcoICIiICk7IH0KCgoKCgoKCiAgICB2aXJ0dWFsIHZvaWQgc2V0U2hvcnRjdXRTdHJpbmco
IGNvbnN0IHN0ZDo6c3RyaW5nICYgc3RyICk7CgoKCgoKCgogICAgdmlydHVhbCBjb25zdCBjaGFy
ICogdXNlcklucHV0UHJvcGVydHkoKSB7IHJldHVybiAoY29uc3QgY2hhciAqKSAwOyB9CgoKCgoK
ICAgIHZvaWQgZHVtcFdpZGdldFRyZWUoIGludCBpbmRlbnRhdGlvbkxldmVsID0gMCApOwoKCgoK
CgoKICAgIHZvaWQgZHVtcERpYWxvZ1dpZGdldFRyZWUoKTsKCgoKCiAgICB2b2lkIHNldENoaWxk
cmVuRW5hYmxlZCggYm9vbCBlbmFibGVkICk7CiMgNTkyICIvaG9tZS9zaGFya2N6L2xpYnl1aS9s
aWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVdpZGdldC5oIgogICAgdmlydHVhbCB2b2lk
IHNhdmVVc2VySW5wdXQoIFlNYWNyb1JlY29yZGVyICptYWNyb1JlY29yZGVyICk7CiMgNjAxICIv
aG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVdpZGdl
dC5oIgogICAgdm9pZCAqIG9wZXJhdG9yIG5ldyggc2l6ZV90IHNpemUgKTsKIyA2MTMgIi9ob21l
L3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2lkZ2V0Lmgi
CiAgICB2aXJ0dWFsIHZvaWQgc3RhcnRNdWx0aXBsZUNoYW5nZXMoKSB7fQogICAgdmlydHVhbCB2
b2lkIGRvbmVNdWx0aXBsZUNoYW5nZXMoKSB7fQoKCnByb3RlY3RlZDoKCgoKCiAgICBZV2lkZ2V0
Q2hpbGRyZW5NYW5hZ2VyICogY2hpbGRyZW5NYW5hZ2VyKCkgY29uc3Q7CiMgNjM3ICIvaG9tZS9z
aGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVdpZGdldC5oIgog
ICAgdm9pZCBzZXRDaGlsZHJlbk1hbmFnZXIoIFlXaWRnZXRDaGlsZHJlbk1hbmFnZXIgKiBtYW5h
Z2VyICk7CiMgNjQ3ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0z
LjIuMS9zcmMvWVdpZGdldC5oIgogICAgIHZvaWQgc2V0QmVpbmdEZXN0cm95ZWQoKTsKCgoKCgog
ICAgdm9pZCBkdW1wV2lkZ2V0KCBZV2lkZ2V0ICp3LCBpbnQgaW5kZW50YXRpb25MZXZlbCApOwoK
CnByaXZhdGU6CgoKCgogICAgdm9pZCBpbnZhbGlkYXRlKCk7CgoKCgogICAgWVdpZGdldCggY29u
c3QgWVdpZGdldCAmIG90aGVyICk7CgoKCgogICAgY29uc3QgWVdpZGdldCAmIG9wZXJhdG9yPSgg
Y29uc3QgWVdpZGdldCAmIG90aGVyICk7Cgpwcml2YXRlOgoKCgoKCiAgICBpbnQgX21hZ2ljOwog
ICAgSW1wbFB0cjxZV2lkZ2V0UHJpdmF0ZT4gcHJpdjsKICAgIHN0YXRpYyBZUHJvcGVydHlTZXQg
X3Byb3BlcnR5U2V0OwogICAgc3RhdGljIGJvb2wgX3VzZWRPcGVyYXRvck5ldzsKCgojIDEgIi9o
b21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2lkZ2V0
X09wdGltaXplQ2hhbmdlcy5oIiAxCiMgMzggIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1s
aWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2lkZ2V0X09wdGltaXplQ2hhbmdlcy5oIgpwdWJsaWM6
CgoKCgoKICAgIGNsYXNzIE9wdGltaXplQ2hhbmdlcwogICAgewogICAgcHVibGljOgogT3B0aW1p
emVDaGFuZ2VzKCBZV2lkZ2V0ICYgdyApIDogeXcodykgeyB5dy5zdGFydE11bHRpcGxlQ2hhbmdl
cygpOyB9CiB+T3B0aW1pemVDaGFuZ2VzKCkgeyB5dy5kb25lTXVsdGlwbGVDaGFuZ2VzKCk7IH0K
ICAgIHByaXZhdGU6CiBPcHRpbWl6ZUNoYW5nZXMoIGNvbnN0IE9wdGltaXplQ2hhbmdlcyAmICk7
CiB2b2lkIG9wZXJhdG9yPSggY29uc3QgT3B0aW1pemVDaGFuZ2VzICYgKTsKIFlXaWRnZXQgJiB5
dzsKICAgIH07CiMgNjg2ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rl
ci0zLjIuMS9zcmMvWVdpZGdldC5oIiAyCgp9OwoKCnN0ZDo6b3N0cmVhbSAmIG9wZXJhdG9yPDwo
IHN0ZDo6b3N0cmVhbSAmIHN0cmVhbSwgY29uc3QgWVdpZGdldCAqIHdpZGdldCApOwojIDI5ICIv
aG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVNpbmds
ZUNoaWxkQ29udGFpbmVyV2lkZ2V0LmgiIDIKCgoKCgpjbGFzcyBZU2luZ2xlQ2hpbGRDb250YWlu
ZXJXaWRnZXQ6IHB1YmxpYyBZV2lkZ2V0CnsKcHJvdGVjdGVkOgoKCgogICAgWVNpbmdsZUNoaWxk
Q29udGFpbmVyV2lkZ2V0KCBZV2lkZ2V0ICogcGFyZW50ICk7CgpwdWJsaWM6CgoKCiAgICB2aXJ0
dWFsIH5ZU2luZ2xlQ2hpbGRDb250YWluZXJXaWRnZXQoKTsKCgoKCgoKICAgIHZpcnR1YWwgaW50
IHByZWZlcnJlZFdpZHRoKCk7CgoKCgoKCiAgICB2aXJ0dWFsIGludCBwcmVmZXJyZWRIZWlnaHQo
KTsKCgoKCgoKCiAgICB2aXJ0dWFsIHZvaWQgc2V0U2l6ZSggaW50IG5ld1dpZHRoLCBpbnQgbmV3
SGVpZ2h0ICk7CgoKCgoKCgogICAgdmlydHVhbCBib29sIHN0cmV0Y2hhYmxlKCBZVUlEaW1lbnNp
b24gZGltICkgY29uc3Q7Cn07CiMgMzAgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5
dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmgiIDIKIyAxICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL3N0YWNrIiAxIDMKIyA1OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zdGFjayIgMwogICAg
ICAgCiMgNTkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvc3RhY2siIDMKCiMgMSAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9kZXF1ZSIgMSAzCiMgNTggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZGVx
dWUiIDMKICAgICAgIAojIDU5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2RlcXVlIiAzCgoKCgoK
IyAxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDEgMwojIDY2ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMKCiMgNjYgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfZGVxdWUuaCIgMwpuYW1lc3BhY2Ugc3RkIF9fYXR0cmli
dXRlX18gKChfX3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCiMgODggIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYml0cy9zdGxfZGVxdWUuaCIgMwogIGNvbnN0ZXhwciBpbmxpbmUgc2l6ZV90
CiAgX19kZXF1ZV9idWZfc2l6ZShzaXplX3QgX19zaXplKQogIHsgcmV0dXJuIChfX3NpemUgPCA1
MTIKICAgICA/IHNpemVfdCg1MTIgLyBfX3NpemUpIDogc2l6ZV90KDEpKTsgfQojIDEwNSAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwLCB0eXBlbmFtZSBfUmVmLCB0eXBlbmFtZSBfUHRyPgogICAgc3RydWN0IF9EZXF1ZV9p
dGVyYXRvcgogICAgewoKCgoKCgogICAgcHJpdmF0ZToKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUg
X1VwPgogdXNpbmcgX19wdHJfdG8gPSB0eXBlbmFtZSBwb2ludGVyX3RyYWl0czxfUHRyPjo6dGVt
cGxhdGUgcmViaW5kPF9VcD47CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9DdlRwPgogdXNpbmcg
X19pdGVyID0gX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX0N2VHAmLCBfX3B0cl90bzxfQ3ZUcD4+Owog
ICAgcHVibGljOgogICAgICB0eXBlZGVmIF9faXRlcjxfVHA+IGl0ZXJhdG9yOwogICAgICB0eXBl
ZGVmIF9faXRlcjxjb25zdCBfVHA+IGNvbnN0X2l0ZXJhdG9yOwogICAgICB0eXBlZGVmIF9fcHRy
X3RvPF9UcD4gX0VsdF9wb2ludGVyOwogICAgICB0eXBlZGVmIF9fcHRyX3RvPF9FbHRfcG9pbnRl
cj4gX01hcF9wb2ludGVyOwoKCiAgICAgIHN0YXRpYyBzaXplX3QgX1NfYnVmZmVyX3NpemUoKSBu
b2V4Y2VwdAogICAgICB7IHJldHVybiBfX2RlcXVlX2J1Zl9zaXplKHNpemVvZihfVHApKTsgfQoK
ICAgICAgdHlwZWRlZiBzdGQ6OnJhbmRvbV9hY2Nlc3NfaXRlcmF0b3JfdGFnIGl0ZXJhdG9yX2Nh
dGVnb3J5OwogICAgICB0eXBlZGVmIF9UcCB2YWx1ZV90eXBlOwogICAgICB0eXBlZGVmIF9QdHIg
cG9pbnRlcjsKICAgICAgdHlwZWRlZiBfUmVmIHJlZmVyZW5jZTsKICAgICAgdHlwZWRlZiBzaXpl
X3Qgc2l6ZV90eXBlOwogICAgICB0eXBlZGVmIHB0cmRpZmZfdCBkaWZmZXJlbmNlX3R5cGU7CiAg
ICAgIHR5cGVkZWYgX0RlcXVlX2l0ZXJhdG9yIF9TZWxmOwoKICAgICAgX0VsdF9wb2ludGVyIF9N
X2N1cjsKICAgICAgX0VsdF9wb2ludGVyIF9NX2ZpcnN0OwogICAgICBfRWx0X3BvaW50ZXIgX01f
bGFzdDsKICAgICAgX01hcF9wb2ludGVyIF9NX25vZGU7CgogICAgICBfRGVxdWVfaXRlcmF0b3Io
X0VsdF9wb2ludGVyIF9feCwgX01hcF9wb2ludGVyIF9feSkgbm9leGNlcHQKICAgICAgOiBfTV9j
dXIoX194KSwgX01fZmlyc3QoKl9feSksCiAgICAgICAgX01fbGFzdCgqX195ICsgX1NfYnVmZmVy
X3NpemUoKSksIF9NX25vZGUoX195KSB7IH0KCiAgICAgIF9EZXF1ZV9pdGVyYXRvcigpIG5vZXhj
ZXB0CiAgICAgIDogX01fY3VyKCksIF9NX2ZpcnN0KCksIF9NX2xhc3QoKSwgX01fbm9kZSgpIHsg
fQoKICAgICAgX0RlcXVlX2l0ZXJhdG9yKGNvbnN0IGl0ZXJhdG9yJiBfX3gpIG5vZXhjZXB0CiAg
ICAgIDogX01fY3VyKF9feC5fTV9jdXIpLCBfTV9maXJzdChfX3guX01fZmlyc3QpLAogICAgICAg
IF9NX2xhc3QoX194Ll9NX2xhc3QpLCBfTV9ub2RlKF9feC5fTV9ub2RlKSB7IH0KCiAgICAgIGl0
ZXJhdG9yCiAgICAgIF9NX2NvbnN0X2Nhc3QoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVy
biBpdGVyYXRvcihfTV9jdXIsIF9NX25vZGUpOyB9CgogICAgICByZWZlcmVuY2UKICAgICAgb3Bl
cmF0b3IqKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gKl9NX2N1cjsgfQoKICAgICAg
cG9pbnRlcgogICAgICBvcGVyYXRvci0+KCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4g
X01fY3VyOyB9CgogICAgICBfU2VsZiYKICAgICAgb3BlcmF0b3IrKygpIG5vZXhjZXB0CiAgICAg
IHsKICsrX01fY3VyOwogaWYgKF9NX2N1ciA9PSBfTV9sYXN0KQogICB7CiAgICAgX01fc2V0X25v
ZGUoX01fbm9kZSArIDEpOwogICAgIF9NX2N1ciA9IF9NX2ZpcnN0OwogICB9CiByZXR1cm4gKnRo
aXM7CiAgICAgIH0KCiAgICAgIF9TZWxmCiAgICAgIG9wZXJhdG9yKysoaW50KSBub2V4Y2VwdAog
ICAgICB7CiBfU2VsZiBfX3RtcCA9ICp0aGlzOwogKysqdGhpczsKIHJldHVybiBfX3RtcDsKICAg
ICAgfQoKICAgICAgX1NlbGYmCiAgICAgIG9wZXJhdG9yLS0oKSBub2V4Y2VwdAogICAgICB7CiBp
ZiAoX01fY3VyID09IF9NX2ZpcnN0KQogICB7CiAgICAgX01fc2V0X25vZGUoX01fbm9kZSAtIDEp
OwogICAgIF9NX2N1ciA9IF9NX2xhc3Q7CiAgIH0KIC0tX01fY3VyOwogcmV0dXJuICp0aGlzOwog
ICAgICB9CgogICAgICBfU2VsZgogICAgICBvcGVyYXRvci0tKGludCkgbm9leGNlcHQKICAgICAg
ewogX1NlbGYgX190bXAgPSAqdGhpczsKIC0tKnRoaXM7CiByZXR1cm4gX190bXA7CiAgICAgIH0K
CiAgICAgIF9TZWxmJgogICAgICBvcGVyYXRvcis9KGRpZmZlcmVuY2VfdHlwZSBfX24pIG5vZXhj
ZXB0CiAgICAgIHsKIGNvbnN0IGRpZmZlcmVuY2VfdHlwZSBfX29mZnNldCA9IF9fbiArIChfTV9j
dXIgLSBfTV9maXJzdCk7CiBpZiAoX19vZmZzZXQgPj0gMCAmJiBfX29mZnNldCA8IGRpZmZlcmVu
Y2VfdHlwZShfU19idWZmZXJfc2l6ZSgpKSkKICAgX01fY3VyICs9IF9fbjsKIGVsc2UKICAgewog
ICAgIGNvbnN0IGRpZmZlcmVuY2VfdHlwZSBfX25vZGVfb2Zmc2V0ID0KICAgICAgIF9fb2Zmc2V0
ID4gMCA/IF9fb2Zmc2V0IC8gZGlmZmVyZW5jZV90eXBlKF9TX2J1ZmZlcl9zaXplKCkpCiAgICAg
ICAgICAgICAgICAgICAgOiAtZGlmZmVyZW5jZV90eXBlKCgtX19vZmZzZXQgLSAxKQogICAgICAg
ICAgIC8gX1NfYnVmZmVyX3NpemUoKSkgLSAxOwogICAgIF9NX3NldF9ub2RlKF9NX25vZGUgKyBf
X25vZGVfb2Zmc2V0KTsKICAgICBfTV9jdXIgPSBfTV9maXJzdCArIChfX29mZnNldCAtIF9fbm9k
ZV9vZmZzZXQKICAgICAqIGRpZmZlcmVuY2VfdHlwZShfU19idWZmZXJfc2l6ZSgpKSk7CiAgIH0K
IHJldHVybiAqdGhpczsKICAgICAgfQoKICAgICAgX1NlbGYKICAgICAgb3BlcmF0b3IrKGRpZmZl
cmVuY2VfdHlwZSBfX24pIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsKIF9TZWxmIF9fdG1wID0gKnRo
aXM7CiByZXR1cm4gX190bXAgKz0gX19uOwogICAgICB9CgogICAgICBfU2VsZiYKICAgICAgb3Bl
cmF0b3ItPShkaWZmZXJlbmNlX3R5cGUgX19uKSBub2V4Y2VwdAogICAgICB7IHJldHVybiAqdGhp
cyArPSAtX19uOyB9CgogICAgICBfU2VsZgogICAgICBvcGVyYXRvci0oZGlmZmVyZW5jZV90eXBl
IF9fbikgY29uc3Qgbm9leGNlcHQKICAgICAgewogX1NlbGYgX190bXAgPSAqdGhpczsKIHJldHVy
biBfX3RtcCAtPSBfX247CiAgICAgIH0KCiAgICAgIHJlZmVyZW5jZQogICAgICBvcGVyYXRvcltd
KGRpZmZlcmVuY2VfdHlwZSBfX24pIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuICooKnRo
aXMgKyBfX24pOyB9CgoKCgoKCiAgICAgIHZvaWQKICAgICAgX01fc2V0X25vZGUoX01hcF9wb2lu
dGVyIF9fbmV3X25vZGUpIG5vZXhjZXB0CiAgICAgIHsKIF9NX25vZGUgPSBfX25ld19ub2RlOwog
X01fZmlyc3QgPSAqX19uZXdfbm9kZTsKIF9NX2xhc3QgPSBfTV9maXJzdCArIGRpZmZlcmVuY2Vf
dHlwZShfU19idWZmZXJfc2l6ZSgpKTsKICAgICAgfQogICAgfTsKCgoKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwLCB0eXBlbmFtZSBfUmVmLCB0eXBlbmFtZSBfUHRyPgogICAgaW5saW5lIGJvb2wK
ICAgIG9wZXJhdG9yPT0oY29uc3QgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1JlZiwgX1B0cj4mIF9f
eCwKICAgICAgICBjb25zdCBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfUmVmLCBfUHRyPiYgX195KSBu
b2V4Y2VwdAogICAgeyByZXR1cm4gX194Ll9NX2N1ciA9PSBfX3kuX01fY3VyOyB9CgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1JlZkwsIHR5cGVuYW1lIF9QdHJMLAogICAgdHlw
ZW5hbWUgX1JlZlIsIHR5cGVuYW1lIF9QdHJSPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9y
PT0oY29uc3QgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1JlZkwsIF9QdHJMPiYgX194LAogICAgICAg
IGNvbnN0IF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9SZWZSLCBfUHRyUj4mIF9feSkgbm9leGNlcHQK
ICAgIHsgcmV0dXJuIF9feC5fTV9jdXIgPT0gX195Ll9NX2N1cjsgfQoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHAsIHR5cGVuYW1lIF9SZWYsIHR5cGVuYW1lIF9QdHI+CiAgICBpbmxpbmUgYm9vbAog
ICAgb3BlcmF0b3IhPShjb25zdCBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfUmVmLCBfUHRyPiYgX194
LAogICAgICAgIGNvbnN0IF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9SZWYsIF9QdHI+JiBfX3kpIG5v
ZXhjZXB0CiAgICB7IHJldHVybiAhKF9feCA9PSBfX3kpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9UcCwgdHlwZW5hbWUgX1JlZkwsIHR5cGVuYW1lIF9QdHJMLAogICAgdHlwZW5hbWUgX1JlZlIs
IHR5cGVuYW1lIF9QdHJSPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yIT0oY29uc3QgX0Rl
cXVlX2l0ZXJhdG9yPF9UcCwgX1JlZkwsIF9QdHJMPiYgX194LAogICAgICAgIGNvbnN0IF9EZXF1
ZV9pdGVyYXRvcjxfVHAsIF9SZWZSLCBfUHRyUj4mIF9feSkgbm9leGNlcHQKICAgIHsgcmV0dXJu
ICEoX194ID09IF9feSk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfUmVm
LCB0eXBlbmFtZSBfUHRyPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPChjb25zdCBfRGVx
dWVfaXRlcmF0b3I8X1RwLCBfUmVmLCBfUHRyPiYgX194LAogICAgICAgY29uc3QgX0RlcXVlX2l0
ZXJhdG9yPF9UcCwgX1JlZiwgX1B0cj4mIF9feSkgbm9leGNlcHQKICAgIHsgcmV0dXJuIChfX3gu
X01fbm9kZSA9PSBfX3kuX01fbm9kZSkgPyAoX194Ll9NX2N1ciA8IF9feS5fTV9jdXIpCiAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKF9feC5fTV9ub2RlIDwgX195
Ll9NX25vZGUpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1JlZkwsIHR5
cGVuYW1lIF9QdHJMLAogICAgdHlwZW5hbWUgX1JlZlIsIHR5cGVuYW1lIF9QdHJSPgogICAgaW5s
aW5lIGJvb2wKICAgIG9wZXJhdG9yPChjb25zdCBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfUmVmTCwg
X1B0ckw+JiBfX3gsCiAgICAgICBjb25zdCBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfUmVmUiwgX1B0
clI+JiBfX3kpIG5vZXhjZXB0CiAgICB7IHJldHVybiAoX194Ll9NX25vZGUgPT0gX195Ll9NX25v
ZGUpID8gKF9feC5fTV9jdXIgPCBfX3kuX01fY3VyKQogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIDogKF9feC5fTV9ub2RlIDwgX195Ll9NX25vZGUpOyB9CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1JlZiwgdHlwZW5hbWUgX1B0cj4KICAgIGlubGluZSBib29s
CiAgICBvcGVyYXRvcj4oY29uc3QgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1JlZiwgX1B0cj4mIF9f
eCwKICAgICAgIGNvbnN0IF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9SZWYsIF9QdHI+JiBfX3kpIG5v
ZXhjZXB0CiAgICB7IHJldHVybiBfX3kgPCBfX3g7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Rw
LCB0eXBlbmFtZSBfUmVmTCwgdHlwZW5hbWUgX1B0ckwsCiAgICB0eXBlbmFtZSBfUmVmUiwgdHlw
ZW5hbWUgX1B0clI+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I+KGNvbnN0IF9EZXF1ZV9p
dGVyYXRvcjxfVHAsIF9SZWZMLCBfUHRyTD4mIF9feCwKICAgICAgIGNvbnN0IF9EZXF1ZV9pdGVy
YXRvcjxfVHAsIF9SZWZSLCBfUHRyUj4mIF9feSkgbm9leGNlcHQKICAgIHsgcmV0dXJuIF9feSA8
IF9feDsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9SZWYsIHR5cGVuYW1l
IF9QdHI+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I8PShjb25zdCBfRGVxdWVfaXRlcmF0
b3I8X1RwLCBfUmVmLCBfUHRyPiYgX194LAogICAgICAgIGNvbnN0IF9EZXF1ZV9pdGVyYXRvcjxf
VHAsIF9SZWYsIF9QdHI+JiBfX3kpIG5vZXhjZXB0CiAgICB7IHJldHVybiAhKF9feSA8IF9feCk7
IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfUmVmTCwgdHlwZW5hbWUgX1B0
ckwsCiAgICB0eXBlbmFtZSBfUmVmUiwgdHlwZW5hbWUgX1B0clI+CiAgICBpbmxpbmUgYm9vbAog
ICAgb3BlcmF0b3I8PShjb25zdCBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfUmVmTCwgX1B0ckw+JiBf
X3gsCiAgICAgICAgY29uc3QgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1JlZlIsIF9QdHJSPiYgX195
KSBub2V4Y2VwdAogICAgeyByZXR1cm4gIShfX3kgPCBfX3gpOyB9CgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcCwgdHlwZW5hbWUgX1JlZiwgdHlwZW5hbWUgX1B0cj4KICAgIGlubGluZSBib29sCiAg
ICBvcGVyYXRvcj49KGNvbnN0IF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9SZWYsIF9QdHI+JiBfX3gs
CiAgICAgICAgY29uc3QgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1JlZiwgX1B0cj4mIF9feSkgbm9l
eGNlcHQKICAgIHsgcmV0dXJuICEoX194IDwgX195KTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHAsIHR5cGVuYW1lIF9SZWZMLCB0eXBlbmFtZSBfUHRyTCwKICAgIHR5cGVuYW1lIF9SZWZSLCB0
eXBlbmFtZSBfUHRyUj4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj49KGNvbnN0IF9EZXF1
ZV9pdGVyYXRvcjxfVHAsIF9SZWZMLCBfUHRyTD4mIF9feCwKICAgICAgICBjb25zdCBfRGVxdWVf
aXRlcmF0b3I8X1RwLCBfUmVmUiwgX1B0clI+JiBfX3kpIG5vZXhjZXB0CiAgICB7IHJldHVybiAh
KF9feCA8IF9feSk7IH0KCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1Jl
ZiwgdHlwZW5hbWUgX1B0cj4KICAgIGlubGluZSB0eXBlbmFtZSBfRGVxdWVfaXRlcmF0b3I8X1Rw
LCBfUmVmLCBfUHRyPjo6ZGlmZmVyZW5jZV90eXBlCiAgICBvcGVyYXRvci0oY29uc3QgX0RlcXVl
X2l0ZXJhdG9yPF9UcCwgX1JlZiwgX1B0cj4mIF9feCwKICAgICAgIGNvbnN0IF9EZXF1ZV9pdGVy
YXRvcjxfVHAsIF9SZWYsIF9QdHI+JiBfX3kpIG5vZXhjZXB0CiAgICB7CiAgICAgIHJldHVybiB0
eXBlbmFtZSBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfUmVmLCBfUHRyPjo6ZGlmZmVyZW5jZV90eXBl
CiAoX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1JlZiwgX1B0cj46Ol9TX2J1ZmZlcl9zaXplKCkpCiAq
IChfX3guX01fbm9kZSAtIF9feS5fTV9ub2RlIC0gMSkgKyAoX194Ll9NX2N1ciAtIF9feC5fTV9m
aXJzdCkKICsgKF9feS5fTV9sYXN0IC0gX195Ll9NX2N1cik7CiAgICB9CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1JlZkwsIHR5cGVuYW1lIF9QdHJMLAogICAgdHlwZW5hbWUg
X1JlZlIsIHR5cGVuYW1lIF9QdHJSPgogICAgaW5saW5lIHR5cGVuYW1lIF9EZXF1ZV9pdGVyYXRv
cjxfVHAsIF9SZWZMLCBfUHRyTD46OmRpZmZlcmVuY2VfdHlwZQogICAgb3BlcmF0b3ItKGNvbnN0
IF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9SZWZMLCBfUHRyTD4mIF9feCwKICAgICAgIGNvbnN0IF9E
ZXF1ZV9pdGVyYXRvcjxfVHAsIF9SZWZSLCBfUHRyUj4mIF9feSkgbm9leGNlcHQKICAgIHsKICAg
ICAgcmV0dXJuIHR5cGVuYW1lIF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9SZWZMLCBfUHRyTD46OmRp
ZmZlcmVuY2VfdHlwZQogKF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9SZWZMLCBfUHRyTD46Ol9TX2J1
ZmZlcl9zaXplKCkpCiAqIChfX3guX01fbm9kZSAtIF9feS5fTV9ub2RlIC0gMSkgKyAoX194Ll9N
X2N1ciAtIF9feC5fTV9maXJzdCkKICsgKF9feS5fTV9sYXN0IC0gX195Ll9NX2N1cik7CiAgICB9
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1JlZiwgdHlwZW5hbWUgX1B0cj4K
ICAgIGlubGluZSBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfUmVmLCBfUHRyPgogICAgb3BlcmF0b3Ir
KHB0cmRpZmZfdCBfX24sIGNvbnN0IF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9SZWYsIF9QdHI+JiBf
X3gpCiAgICBub2V4Y2VwdAogICAgeyByZXR1cm4gX194ICsgX19uOyB9CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9UcD4KICAgIHZvaWQKICAgIGZpbGwoY29uc3QgX0RlcXVlX2l0ZXJhdG9yPF9UcCwg
X1RwJiwgX1RwKj4mLAogIGNvbnN0IF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9UcCYsIF9UcCo+Jiwg
Y29uc3QgX1RwJik7CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIF9EZXF1ZV9pdGVyYXRv
cjxfVHAsIF9UcCYsIF9UcCo+CiAgICBjb3B5KF9EZXF1ZV9pdGVyYXRvcjxfVHAsIGNvbnN0IF9U
cCYsIGNvbnN0IF9UcCo+LAogIF9EZXF1ZV9pdGVyYXRvcjxfVHAsIGNvbnN0IF9UcCYsIGNvbnN0
IF9UcCo+LAogIF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9UcCYsIF9UcCo+KTsKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX1RwPgogICAgaW5saW5lIF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9UcCYsIF9UcCo+
CiAgICBjb3B5KF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9UcCYsIF9UcCo+IF9fZmlyc3QsCiAgX0Rl
cXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwgX1RwKj4gX19sYXN0LAogIF9EZXF1ZV9pdGVyYXRvcjxf
VHAsIF9UcCYsIF9UcCo+IF9fcmVzdWx0KQogICAgeyByZXR1cm4gc3RkOjpjb3B5KF9EZXF1ZV9p
dGVyYXRvcjxfVHAsIGNvbnN0IF9UcCYsIGNvbnN0IF9UcCo+KF9fZmlyc3QpLAogICAgICAgICBf
RGVxdWVfaXRlcmF0b3I8X1RwLCBjb25zdCBfVHAmLCBjb25zdCBfVHAqPihfX2xhc3QpLAogICAg
ICAgICBfX3Jlc3VsdCk7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgX0RlcXVlX2l0
ZXJhdG9yPF9UcCwgX1RwJiwgX1RwKj4KICAgIGNvcHlfYmFja3dhcmQoX0RlcXVlX2l0ZXJhdG9y
PF9UcCwgY29uc3QgX1RwJiwgY29uc3QgX1RwKj4sCiAgICBfRGVxdWVfaXRlcmF0b3I8X1RwLCBj
b25zdCBfVHAmLCBjb25zdCBfVHAqPiwKICAgIF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9UcCYsIF9U
cCo+KTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgaW5saW5lIF9EZXF1ZV9pdGVyYXRv
cjxfVHAsIF9UcCYsIF9UcCo+CiAgICBjb3B5X2JhY2t3YXJkKF9EZXF1ZV9pdGVyYXRvcjxfVHAs
IF9UcCYsIF9UcCo+IF9fZmlyc3QsCiAgICBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfVHAmLCBfVHAq
PiBfX2xhc3QsCiAgICBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfVHAmLCBfVHAqPiBfX3Jlc3VsdCkK
ICAgIHsgcmV0dXJuIHN0ZDo6Y29weV9iYWNrd2FyZChfRGVxdWVfaXRlcmF0b3I8X1RwLAogICAg
Y29uc3QgX1RwJiwgY29uc3QgX1RwKj4oX19maXJzdCksCiAgICBfRGVxdWVfaXRlcmF0b3I8X1Rw
LAogICAgY29uc3QgX1RwJiwgY29uc3QgX1RwKj4oX19sYXN0KSwKICAgIF9fcmVzdWx0KTsgfQoK
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwg
X1RwKj4KICAgIG1vdmUoX0RlcXVlX2l0ZXJhdG9yPF9UcCwgY29uc3QgX1RwJiwgY29uc3QgX1Rw
Kj4sCiAgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgY29uc3QgX1RwJiwgY29uc3QgX1RwKj4sCiAgX0Rl
cXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwgX1RwKj4pOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+
CiAgICBpbmxpbmUgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwgX1RwKj4KICAgIG1vdmUoX0Rl
cXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwgX1RwKj4gX19maXJzdCwKICBfRGVxdWVfaXRlcmF0b3I8
X1RwLCBfVHAmLCBfVHAqPiBfX2xhc3QsCiAgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwgX1Rw
Kj4gX19yZXN1bHQpCiAgICB7IHJldHVybiBzdGQ6Om1vdmUoX0RlcXVlX2l0ZXJhdG9yPF9UcCwg
Y29uc3QgX1RwJiwgY29uc3QgX1RwKj4oX19maXJzdCksCiAgICAgICAgIF9EZXF1ZV9pdGVyYXRv
cjxfVHAsIGNvbnN0IF9UcCYsIGNvbnN0IF9UcCo+KF9fbGFzdCksCiAgICAgICAgIF9fcmVzdWx0
KTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBfRGVxdWVfaXRlcmF0b3I8X1RwLCBf
VHAmLCBfVHAqPgogICAgbW92ZV9iYWNrd2FyZChfRGVxdWVfaXRlcmF0b3I8X1RwLCBjb25zdCBf
VHAmLCBjb25zdCBfVHAqPiwKICAgIF9EZXF1ZV9pdGVyYXRvcjxfVHAsIGNvbnN0IF9UcCYsIGNv
bnN0IF9UcCo+LAogICAgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwgX1RwKj4pOwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHA+CiAgICBpbmxpbmUgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwg
X1RwKj4KICAgIG1vdmVfYmFja3dhcmQoX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwgX1RwKj4g
X19maXJzdCwKICAgIF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9UcCYsIF9UcCo+IF9fbGFzdCwKICAg
IF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9UcCYsIF9UcCo+IF9fcmVzdWx0KQogICAgeyByZXR1cm4g
c3RkOjptb3ZlX2JhY2t3YXJkKF9EZXF1ZV9pdGVyYXRvcjxfVHAsCiAgICBjb25zdCBfVHAmLCBj
b25zdCBfVHAqPihfX2ZpcnN0KSwKICAgIF9EZXF1ZV9pdGVyYXRvcjxfVHAsCiAgICBjb25zdCBf
VHAmLCBjb25zdCBfVHAqPihfX2xhc3QpLAogICAgX19yZXN1bHQpOyB9CiMgNDU3ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGNsYXNzIF9EZXF1ZV9iYXNlCiAgICB7CiAgICBwcm90
ZWN0ZWQ6CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19nbnVfY3h4OjpfX2FsbG9jX3RyYWl0czxf
QWxsb2M+Ojp0ZW1wbGF0ZQogcmViaW5kPF9UcD46Om90aGVyIF9UcF9hbGxvY190eXBlOwogICAg
ICB0eXBlZGVmIF9fZ251X2N4eDo6X19hbGxvY190cmFpdHM8X1RwX2FsbG9jX3R5cGU+IF9BbGxv
Y190cmFpdHM7CgoKCgoKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQWxsb2NfdHJhaXRzOjpwb2lu
dGVyIF9QdHI7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0FsbG9jX3RyYWl0czo6Y29uc3RfcG9p
bnRlciBfUHRyX2NvbnN0OwoKCiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0FsbG9jX3RyYWl0czo6
dGVtcGxhdGUgcmViaW5kPF9QdHI+OjpvdGhlcgogX01hcF9hbGxvY190eXBlOwogICAgICB0eXBl
ZGVmIF9fZ251X2N4eDo6X19hbGxvY190cmFpdHM8X01hcF9hbGxvY190eXBlPiBfTWFwX2FsbG9j
X3RyYWl0czsKCiAgICBwdWJsaWM6CiAgICAgIHR5cGVkZWYgX0FsbG9jIGFsbG9jYXRvcl90eXBl
OwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9BbGxvY190cmFpdHM6OnNpemVfdHlwZSBzaXplX3R5
cGU7CgogICAgICBhbGxvY2F0b3JfdHlwZQogICAgICBnZXRfYWxsb2NhdG9yKCkgY29uc3Qgbm9l
eGNlcHQKICAgICAgeyByZXR1cm4gYWxsb2NhdG9yX3R5cGUoX01fZ2V0X1RwX2FsbG9jYXRvcigp
KTsgfQoKICAgICAgdHlwZWRlZiBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfVHAmLCBfUHRyPiBpdGVy
YXRvcjsKICAgICAgdHlwZWRlZiBfRGVxdWVfaXRlcmF0b3I8X1RwLCBjb25zdCBfVHAmLCBfUHRy
X2NvbnN0PiBjb25zdF9pdGVyYXRvcjsKCiAgICAgIF9EZXF1ZV9iYXNlKCkKICAgICAgOiBfTV9p
bXBsKCkKICAgICAgeyBfTV9pbml0aWFsaXplX21hcCgwKTsgfQoKICAgICAgX0RlcXVlX2Jhc2Uo
c2l6ZV90IF9fbnVtX2VsZW1lbnRzKQogICAgICA6IF9NX2ltcGwoKQogICAgICB7IF9NX2luaXRp
YWxpemVfbWFwKF9fbnVtX2VsZW1lbnRzKTsgfQoKICAgICAgX0RlcXVlX2Jhc2UoY29uc3QgYWxs
b2NhdG9yX3R5cGUmIF9fYSwgc2l6ZV90IF9fbnVtX2VsZW1lbnRzKQogICAgICA6IF9NX2ltcGwo
X19hKQogICAgICB7IF9NX2luaXRpYWxpemVfbWFwKF9fbnVtX2VsZW1lbnRzKTsgfQoKICAgICAg
X0RlcXVlX2Jhc2UoY29uc3QgYWxsb2NhdG9yX3R5cGUmIF9fYSkKICAgICAgOiBfTV9pbXBsKF9f
YSkKICAgICAgeyB9CgoKICAgICAgX0RlcXVlX2Jhc2UoX0RlcXVlX2Jhc2UmJiBfX3gsIGZhbHNl
X3R5cGUpCiAgICAgIDogX01faW1wbChfX3guX01fbW92ZV9pbXBsKCkpCiAgICAgIHsgfQoKICAg
ICAgX0RlcXVlX2Jhc2UoX0RlcXVlX2Jhc2UmJiBfX3gsIHRydWVfdHlwZSkKICAgICAgOiBfTV9p
bXBsKHN0ZDo6bW92ZShfX3guX01fZ2V0X1RwX2FsbG9jYXRvcigpKSkKICAgICAgewogX01faW5p
dGlhbGl6ZV9tYXAoMCk7CiBpZiAoX194Ll9NX2ltcGwuX01fbWFwKQogICB0aGlzLT5fTV9pbXBs
Ll9NX3N3YXBfZGF0YShfX3guX01faW1wbCk7CiAgICAgIH0KCiAgICAgIF9EZXF1ZV9iYXNlKF9E
ZXF1ZV9iYXNlJiYgX194KQogICAgICA6IF9EZXF1ZV9iYXNlKHN0ZDo6bW92ZShfX3gpLCB0eXBl
bmFtZSBfQWxsb2NfdHJhaXRzOjppc19hbHdheXNfZXF1YWx7fSkKICAgICAgeyB9CgogICAgICBf
RGVxdWVfYmFzZShfRGVxdWVfYmFzZSYmIF9feCwgY29uc3QgYWxsb2NhdG9yX3R5cGUmIF9fYSwg
c2l6ZV90eXBlIF9fbikKICAgICAgOiBfTV9pbXBsKF9fYSkKICAgICAgewogaWYgKF9feC5nZXRf
YWxsb2NhdG9yKCkgPT0gX19hKQogICB7CiAgICAgaWYgKF9feC5fTV9pbXBsLl9NX21hcCkKICAg
ICAgIHsKICBfTV9pbml0aWFsaXplX21hcCgwKTsKICB0aGlzLT5fTV9pbXBsLl9NX3N3YXBfZGF0
YShfX3guX01faW1wbCk7CiAgICAgICB9CiAgIH0KIGVsc2UKICAgewogICAgIF9NX2luaXRpYWxp
emVfbWFwKF9fbik7CiAgIH0KICAgICAgfQoKCiAgICAgIH5fRGVxdWVfYmFzZSgpIG5vZXhjZXB0
OwoKICAgIHByb3RlY3RlZDoKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBpdGVyYXRvcjo6X01hcF9w
b2ludGVyIF9NYXBfcG9pbnRlcjsKCgoKCiAgICAgIHN0cnVjdCBfRGVxdWVfaW1wbAogICAgICA6
IHB1YmxpYyBfVHBfYWxsb2NfdHlwZQogICAgICB7CiBfTWFwX3BvaW50ZXIgX01fbWFwOwogc2l6
ZV90IF9NX21hcF9zaXplOwogaXRlcmF0b3IgX01fc3RhcnQ7CiBpdGVyYXRvciBfTV9maW5pc2g7
CgogX0RlcXVlX2ltcGwoKQogOiBfVHBfYWxsb2NfdHlwZSgpLCBfTV9tYXAoKSwgX01fbWFwX3Np
emUoMCksCiAgIF9NX3N0YXJ0KCksIF9NX2ZpbmlzaCgpCiB7IH0KCiBfRGVxdWVfaW1wbChjb25z
dCBfVHBfYWxsb2NfdHlwZSYgX19hKSBub2V4Y2VwdAogOiBfVHBfYWxsb2NfdHlwZShfX2EpLCBf
TV9tYXAoKSwgX01fbWFwX3NpemUoMCksCiAgIF9NX3N0YXJ0KCksIF9NX2ZpbmlzaCgpCiB7IH0K
CgogX0RlcXVlX2ltcGwoX0RlcXVlX2ltcGwmJikgPSBkZWZhdWx0OwoKIF9EZXF1ZV9pbXBsKF9U
cF9hbGxvY190eXBlJiYgX19hKSBub2V4Y2VwdAogOiBfVHBfYWxsb2NfdHlwZShzdGQ6Om1vdmUo
X19hKSksIF9NX21hcCgpLCBfTV9tYXBfc2l6ZSgwKSwKICAgX01fc3RhcnQoKSwgX01fZmluaXNo
KCkKIHsgfQoKCiB2b2lkIF9NX3N3YXBfZGF0YShfRGVxdWVfaW1wbCYgX194KSBub2V4Y2VwdAog
ewogICB1c2luZyBzdGQ6OnN3YXA7CiAgIHN3YXAodGhpcy0+X01fc3RhcnQsIF9feC5fTV9zdGFy
dCk7CiAgIHN3YXAodGhpcy0+X01fZmluaXNoLCBfX3guX01fZmluaXNoKTsKICAgc3dhcCh0aGlz
LT5fTV9tYXAsIF9feC5fTV9tYXApOwogICBzd2FwKHRoaXMtPl9NX21hcF9zaXplLCBfX3guX01f
bWFwX3NpemUpOwogfQogICAgICB9OwoKICAgICAgX1RwX2FsbG9jX3R5cGUmCiAgICAgIF9NX2dl
dF9UcF9hbGxvY2F0b3IoKSBub2V4Y2VwdAogICAgICB7IHJldHVybiAqc3RhdGljX2Nhc3Q8X1Rw
X2FsbG9jX3R5cGUqPigmdGhpcy0+X01faW1wbCk7IH0KCiAgICAgIGNvbnN0IF9UcF9hbGxvY190
eXBlJgogICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyBy
ZXR1cm4gKnN0YXRpY19jYXN0PGNvbnN0IF9UcF9hbGxvY190eXBlKj4oJnRoaXMtPl9NX2ltcGwp
OyB9CgogICAgICBfTWFwX2FsbG9jX3R5cGUKICAgICAgX01fZ2V0X21hcF9hbGxvY2F0b3IoKSBj
b25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTWFwX2FsbG9jX3R5cGUoX01fZ2V0X1RwX2Fs
bG9jYXRvcigpKTsgfQoKICAgICAgX1B0cgogICAgICBfTV9hbGxvY2F0ZV9ub2RlKCkKICAgICAg
ewogdHlwZWRlZiBfX2dudV9jeHg6Ol9fYWxsb2NfdHJhaXRzPF9UcF9hbGxvY190eXBlPiBfVHJh
aXRzOwogcmV0dXJuIF9UcmFpdHM6OmFsbG9jYXRlKF9NX2ltcGwsIF9fZGVxdWVfYnVmX3NpemUo
c2l6ZW9mKF9UcCkpKTsKICAgICAgfQoKICAgICAgdm9pZAogICAgICBfTV9kZWFsbG9jYXRlX25v
ZGUoX1B0ciBfX3ApIG5vZXhjZXB0CiAgICAgIHsKIHR5cGVkZWYgX19nbnVfY3h4OjpfX2FsbG9j
X3RyYWl0czxfVHBfYWxsb2NfdHlwZT4gX1RyYWl0czsKIF9UcmFpdHM6OmRlYWxsb2NhdGUoX01f
aW1wbCwgX19wLCBfX2RlcXVlX2J1Zl9zaXplKHNpemVvZihfVHApKSk7CiAgICAgIH0KCiAgICAg
IF9NYXBfcG9pbnRlcgogICAgICBfTV9hbGxvY2F0ZV9tYXAoc2l6ZV90IF9fbikKICAgICAgewog
X01hcF9hbGxvY190eXBlIF9fbWFwX2FsbG9jID0gX01fZ2V0X21hcF9hbGxvY2F0b3IoKTsKIHJl
dHVybiBfTWFwX2FsbG9jX3RyYWl0czo6YWxsb2NhdGUoX19tYXBfYWxsb2MsIF9fbik7CiAgICAg
IH0KCiAgICAgIHZvaWQKICAgICAgX01fZGVhbGxvY2F0ZV9tYXAoX01hcF9wb2ludGVyIF9fcCwg
c2l6ZV90IF9fbikgbm9leGNlcHQKICAgICAgewogX01hcF9hbGxvY190eXBlIF9fbWFwX2FsbG9j
ID0gX01fZ2V0X21hcF9hbGxvY2F0b3IoKTsKIF9NYXBfYWxsb2NfdHJhaXRzOjpkZWFsbG9jYXRl
KF9fbWFwX2FsbG9jLCBfX3AsIF9fbik7CiAgICAgIH0KCiAgICBwcm90ZWN0ZWQ6CiAgICAgIHZv
aWQgX01faW5pdGlhbGl6ZV9tYXAoc2l6ZV90KTsKICAgICAgdm9pZCBfTV9jcmVhdGVfbm9kZXMo
X01hcF9wb2ludGVyIF9fbnN0YXJ0LCBfTWFwX3BvaW50ZXIgX19uZmluaXNoKTsKICAgICAgdm9p
ZCBfTV9kZXN0cm95X25vZGVzKF9NYXBfcG9pbnRlciBfX25zdGFydCwKICAgICAgIF9NYXBfcG9p
bnRlciBfX25maW5pc2gpIG5vZXhjZXB0OwogICAgICBlbnVtIHsgX1NfaW5pdGlhbF9tYXBfc2l6
ZSA9IDggfTsKCiAgICAgIF9EZXF1ZV9pbXBsIF9NX2ltcGw7CgoKICAgIHByaXZhdGU6CiAgICAg
IF9EZXF1ZV9pbXBsCiAgICAgIF9NX21vdmVfaW1wbCgpCiAgICAgIHsKIGlmICghX01faW1wbC5f
TV9tYXApCiAgIHJldHVybiBzdGQ6Om1vdmUoX01faW1wbCk7CgoKIF9UcF9hbGxvY190eXBlIF9f
YWxsb2N7X01fZ2V0X1RwX2FsbG9jYXRvcigpfTsKCiBfVHBfYWxsb2NfdHlwZSBfX3NpbmsgX19h
dHRyaWJ1dGUoKF9fdW51c2VkX18pKSB7c3RkOjptb3ZlKF9fYWxsb2MpfTsKCiBfRGVxdWVfYmFz
ZSBfX2VtcHR5e19fYWxsb2N9OwogX19lbXB0eS5fTV9pbml0aWFsaXplX21hcCgwKTsKCiBfRGVx
dWVfaW1wbCBfX3JldHtzdGQ6Om1vdmUoX01fZ2V0X1RwX2FsbG9jYXRvcigpKX07CiBfTV9pbXBs
Ll9NX3N3YXBfZGF0YShfX3JldCk7CiBfTV9pbXBsLl9NX3N3YXBfZGF0YShfX2VtcHR5Ll9NX2lt
cGwpOwogcmV0dXJuIF9fcmV0OwogICAgICB9CgogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBfRGVxdWVfYmFzZTxfVHAsIF9BbGxvYz46OgogICAg
fl9EZXF1ZV9iYXNlKCkgbm9leGNlcHQKICAgIHsKICAgICAgaWYgKHRoaXMtPl9NX2ltcGwuX01f
bWFwKQogewogICBfTV9kZXN0cm95X25vZGVzKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fbm9k
ZSwKICAgICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2guX01fbm9kZSArIDEpOwogICBfTV9kZWFs
bG9jYXRlX21hcCh0aGlzLT5fTV9pbXBsLl9NX21hcCwgdGhpcy0+X01faW1wbC5fTV9tYXBfc2l6
ZSk7CiB9CiAgICB9CiMgNjc3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVl
LmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHZvaWQK
ICAgIF9EZXF1ZV9iYXNlPF9UcCwgX0FsbG9jPjo6CiAgICBfTV9pbml0aWFsaXplX21hcChzaXpl
X3QgX19udW1fZWxlbWVudHMpCiAgICB7CiAgICAgIGNvbnN0IHNpemVfdCBfX251bV9ub2RlcyA9
IChfX251bV9lbGVtZW50cy8gX19kZXF1ZV9idWZfc2l6ZShzaXplb2YoX1RwKSkKICAgICAgKyAx
KTsKCiAgICAgIHRoaXMtPl9NX2ltcGwuX01fbWFwX3NpemUgPSBzdGQ6Om1heCgoc2l6ZV90KSBf
U19pbml0aWFsX21hcF9zaXplLAogICAgICAgIHNpemVfdChfX251bV9ub2RlcyArIDIpKTsKICAg
ICAgdGhpcy0+X01faW1wbC5fTV9tYXAgPSBfTV9hbGxvY2F0ZV9tYXAodGhpcy0+X01faW1wbC5f
TV9tYXBfc2l6ZSk7CgoKCgoKCiAgICAgIF9NYXBfcG9pbnRlciBfX25zdGFydCA9ICh0aGlzLT5f
TV9pbXBsLl9NX21hcAogICAgICAgICAgKyAodGhpcy0+X01faW1wbC5fTV9tYXBfc2l6ZSAtIF9f
bnVtX25vZGVzKSAvIDIpOwogICAgICBfTWFwX3BvaW50ZXIgX19uZmluaXNoID0gX19uc3RhcnQg
KyBfX251bV9ub2RlczsKCiAgICAgIHRyeQogeyBfTV9jcmVhdGVfbm9kZXMoX19uc3RhcnQsIF9f
bmZpbmlzaCk7IH0KICAgICAgY2F0Y2goLi4uKQogewogICBfTV9kZWFsbG9jYXRlX21hcCh0aGlz
LT5fTV9pbXBsLl9NX21hcCwgdGhpcy0+X01faW1wbC5fTV9tYXBfc2l6ZSk7CiAgIHRoaXMtPl9N
X2ltcGwuX01fbWFwID0gX01hcF9wb2ludGVyKCk7CiAgIHRoaXMtPl9NX2ltcGwuX01fbWFwX3Np
emUgPSAwOwogICB0aHJvdzsKIH0KCiAgICAgIHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fc2V0
X25vZGUoX19uc3RhcnQpOwogICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9zZXRfbm9k
ZShfX25maW5pc2ggLSAxKTsKICAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9jdXIgPSBf
TV9pbXBsLl9NX3N0YXJ0Ll9NX2ZpcnN0OwogICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5f
TV9jdXIgPSAodGhpcy0+X01faW1wbC5fTV9maW5pc2guX01fZmlyc3QKICAgICArIF9fbnVtX2Vs
ZW1lbnRzCiAgICAgJSBfX2RlcXVlX2J1Zl9zaXplKHNpemVvZihfVHApKSk7CiAgICB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdm9pZAogICAgX0RlcXVl
X2Jhc2U8X1RwLCBfQWxsb2M+OjoKICAgIF9NX2NyZWF0ZV9ub2RlcyhfTWFwX3BvaW50ZXIgX19u
c3RhcnQsIF9NYXBfcG9pbnRlciBfX25maW5pc2gpCiAgICB7CiAgICAgIF9NYXBfcG9pbnRlciBf
X2N1cjsKICAgICAgdHJ5CiB7CiAgIGZvciAoX19jdXIgPSBfX25zdGFydDsgX19jdXIgPCBfX25m
aW5pc2g7ICsrX19jdXIpCiAgICAgKl9fY3VyID0gdGhpcy0+X01fYWxsb2NhdGVfbm9kZSgpOwog
fQogICAgICBjYXRjaCguLi4pCiB7CiAgIF9NX2Rlc3Ryb3lfbm9kZXMoX19uc3RhcnQsIF9fY3Vy
KTsKICAgdGhyb3c7CiB9CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUg
X0FsbG9jPgogICAgdm9pZAogICAgX0RlcXVlX2Jhc2U8X1RwLCBfQWxsb2M+OjoKICAgIF9NX2Rl
c3Ryb3lfbm9kZXMoX01hcF9wb2ludGVyIF9fbnN0YXJ0LAogICAgICAgX01hcF9wb2ludGVyIF9f
bmZpbmlzaCkgbm9leGNlcHQKICAgIHsKICAgICAgZm9yIChfTWFwX3BvaW50ZXIgX19uID0gX19u
c3RhcnQ7IF9fbiA8IF9fbmZpbmlzaDsgKytfX24pCiBfTV9kZWFsbG9jYXRlX25vZGUoKl9fbik7
CiAgICB9CiMgODI4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYyA9IHN0ZDo6YWxsb2NhdG9y
PF9UcD4gPgogICAgY2xhc3MgZGVxdWUgOiBwcm90ZWN0ZWQgX0RlcXVlX2Jhc2U8X1RwLCBfQWxs
b2M+CiAgICB7CgogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9BbGxvYzo6dmFsdWVfdHlwZSBfQWxs
b2NfdmFsdWVfdHlwZTsKCgoKICAgICAKCiAgICAgIHR5cGVkZWYgX0RlcXVlX2Jhc2U8X1RwLCBf
QWxsb2M+IF9CYXNlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9CYXNlOjpfVHBfYWxsb2NfdHlw
ZSBfVHBfYWxsb2NfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQmFzZTo6X0FsbG9jX3Ry
YWl0cyBfQWxsb2NfdHJhaXRzOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9CYXNlOjpfTWFwX3Bv
aW50ZXIgX01hcF9wb2ludGVyOwoKICAgIHB1YmxpYzoKICAgICAgdHlwZWRlZiBfVHAgdmFsdWVf
dHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQWxsb2NfdHJhaXRzOjpwb2ludGVyIHBvaW50
ZXI7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0FsbG9jX3RyYWl0czo6Y29uc3RfcG9pbnRlciBj
b25zdF9wb2ludGVyOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9BbGxvY190cmFpdHM6OnJlZmVy
ZW5jZSByZWZlcmVuY2U7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0FsbG9jX3RyYWl0czo6Y29u
c3RfcmVmZXJlbmNlIGNvbnN0X3JlZmVyZW5jZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQmFz
ZTo6aXRlcmF0b3IgaXRlcmF0b3I7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0Jhc2U6OmNvbnN0
X2l0ZXJhdG9yIGNvbnN0X2l0ZXJhdG9yOwogICAgICB0eXBlZGVmIHN0ZDo6cmV2ZXJzZV9pdGVy
YXRvcjxjb25zdF9pdGVyYXRvcj4gY29uc3RfcmV2ZXJzZV9pdGVyYXRvcjsKICAgICAgdHlwZWRl
ZiBzdGQ6OnJldmVyc2VfaXRlcmF0b3I8aXRlcmF0b3I+IHJldmVyc2VfaXRlcmF0b3I7CiAgICAg
IHR5cGVkZWYgc2l6ZV90IHNpemVfdHlwZTsKICAgICAgdHlwZWRlZiBwdHJkaWZmX3QgZGlmZmVy
ZW5jZV90eXBlOwogICAgICB0eXBlZGVmIF9BbGxvYyBhbGxvY2F0b3JfdHlwZTsKCiAgICBwcm90
ZWN0ZWQ6CiAgICAgIHN0YXRpYyBzaXplX3QgX1NfYnVmZmVyX3NpemUoKSBub2V4Y2VwdAogICAg
ICB7IHJldHVybiBfX2RlcXVlX2J1Zl9zaXplKHNpemVvZihfVHApKTsgfQoKCiAgICAgIHVzaW5n
IF9CYXNlOjpfTV9pbml0aWFsaXplX21hcDsKICAgICAgdXNpbmcgX0Jhc2U6Ol9NX2NyZWF0ZV9u
b2RlczsKICAgICAgdXNpbmcgX0Jhc2U6Ol9NX2Rlc3Ryb3lfbm9kZXM7CiAgICAgIHVzaW5nIF9C
YXNlOjpfTV9hbGxvY2F0ZV9ub2RlOwogICAgICB1c2luZyBfQmFzZTo6X01fZGVhbGxvY2F0ZV9u
b2RlOwogICAgICB1c2luZyBfQmFzZTo6X01fYWxsb2NhdGVfbWFwOwogICAgICB1c2luZyBfQmFz
ZTo6X01fZGVhbGxvY2F0ZV9tYXA7CiAgICAgIHVzaW5nIF9CYXNlOjpfTV9nZXRfVHBfYWxsb2Nh
dG9yOwoKCgoKCiAgICAgIHVzaW5nIF9CYXNlOjpfTV9pbXBsOwoKICAgIHB1YmxpYzoKCgoKCgoK
ICAgICAgZGVxdWUoKSA6IF9CYXNlKCkgeyB9CgoKCgoKICAgICAgZXhwbGljaXQKICAgICAgZGVx
dWUoY29uc3QgYWxsb2NhdG9yX3R5cGUmIF9fYSkKICAgICAgOiBfQmFzZShfX2EsIDApIHsgfQoj
IDkwMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAgIGV4
cGxpY2l0CiAgICAgIGRlcXVlKHNpemVfdHlwZSBfX24sIGNvbnN0IGFsbG9jYXRvcl90eXBlJiBf
X2EgPSBhbGxvY2F0b3JfdHlwZSgpKQogICAgICA6IF9CYXNlKF9fYSwgX19uKQogICAgICB7IF9N
X2RlZmF1bHRfaW5pdGlhbGl6ZSgpOyB9CiMgOTE2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX2RlcXVlLmgiIDMKICAgICAgZGVxdWUoc2l6ZV90eXBlIF9fbiwgY29uc3QgdmFsdWVf
dHlwZSYgX192YWx1ZSwKICAgICBjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hID0gYWxsb2NhdG9y
X3R5cGUoKSkKICAgICAgOiBfQmFzZShfX2EsIF9fbikKICAgICAgeyBfTV9maWxsX2luaXRpYWxp
emUoX192YWx1ZSk7IH0KIyA5NDMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfZGVx
dWUuaCIgMwogICAgICBkZXF1ZShjb25zdCBkZXF1ZSYgX194KQogICAgICA6IF9CYXNlKF9BbGxv
Y190cmFpdHM6Ol9TX3NlbGVjdF9vbl9jb3B5KF9feC5fTV9nZXRfVHBfYWxsb2NhdG9yKCkpLAog
ICAgICAgX194LnNpemUoKSkKICAgICAgeyBzdGQ6Ol9fdW5pbml0aWFsaXplZF9jb3B5X2EoX194
LmJlZ2luKCksIF9feC5lbmQoKSwKICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0LAogICAg
ICAgIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7IH0KIyA5NTggIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9zdGxfZGVxdWUuaCIgMwogICAgICBkZXF1ZShkZXF1ZSYmIF9feCkKICAgICAgOiBf
QmFzZShzdGQ6Om1vdmUoX194KSkgeyB9CgoKICAgICAgZGVxdWUoY29uc3QgZGVxdWUmIF9feCwg
Y29uc3QgYWxsb2NhdG9yX3R5cGUmIF9fYSkKICAgICAgOiBfQmFzZShfX2EsIF9feC5zaXplKCkp
CiAgICAgIHsgc3RkOjpfX3VuaW5pdGlhbGl6ZWRfY29weV9hKF9feC5iZWdpbigpLCBfX3guZW5k
KCksCiAgICAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydCwKICAgICAgICBfTV9nZXRfVHBfYWxs
b2NhdG9yKCkpOyB9CgoKICAgICAgZGVxdWUoZGVxdWUmJiBfX3gsIGNvbnN0IGFsbG9jYXRvcl90
eXBlJiBfX2EpCiAgICAgIDogX0Jhc2Uoc3RkOjptb3ZlKF9feCksIF9fYSwgX194LnNpemUoKSkK
ICAgICAgewogaWYgKF9feC5nZXRfYWxsb2NhdG9yKCkgIT0gX19hKQogICB7CiAgICAgc3RkOjpf
X3VuaW5pdGlhbGl6ZWRfbW92ZV9hKF9feC5iZWdpbigpLCBfX3guZW5kKCksCiAgICAgdGhpcy0+
X01faW1wbC5fTV9zdGFydCwKICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgIF9feC5j
bGVhcigpOwogICB9CiAgICAgIH0KIyA5OTIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9z
dGxfZGVxdWUuaCIgMwogICAgICBkZXF1ZShpbml0aWFsaXplcl9saXN0PHZhbHVlX3R5cGU+IF9f
bCwKICAgICBjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hID0gYWxsb2NhdG9yX3R5cGUoKSkKICAg
ICAgOiBfQmFzZShfX2EpCiAgICAgIHsKIF9NX3JhbmdlX2luaXRpYWxpemUoX19sLmJlZ2luKCks
IF9fbC5lbmQoKSwKICAgICAgIHJhbmRvbV9hY2Nlc3NfaXRlcmF0b3JfdGFnKCkpOwogICAgICB9
CiMgMTAxNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yLAogICAgICAgIHR5cGVuYW1lID0gc3Rk
OjpfUmVxdWlyZUlucHV0SXRlcjxfSW5wdXRJdGVyYXRvcj4+CiAgICAgICAgZGVxdWUoX0lucHV0
SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgICAgY29uc3QgYWxs
b2NhdG9yX3R5cGUmIF9fYSA9IGFsbG9jYXRvcl90eXBlKCkpCiA6IF9CYXNlKF9fYSkKICAgICAg
ICB7IF9NX2luaXRpYWxpemVfZGlzcGF0Y2goX19maXJzdCwgX19sYXN0LCBfX2ZhbHNlX3R5cGUo
KSk7IH0KIyAxMDQwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMK
ICAgICAgfmRlcXVlKCkKICAgICAgeyBfTV9kZXN0cm95X2RhdGEoYmVnaW4oKSwgZW5kKCksIF9N
X2dldF9UcF9hbGxvY2F0b3IoKSk7IH0KIyAxMDUwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX2RlcXVlLmgiIDMKICAgICAgZGVxdWUmCiAgICAgIG9wZXJhdG9yPShjb25zdCBkZXF1
ZSYgX194KTsKIyAxMDYyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgi
IDMKICAgICAgZGVxdWUmCiAgICAgIG9wZXJhdG9yPShkZXF1ZSYmIF9feCkgbm9leGNlcHQoX0Fs
bG9jX3RyYWl0czo6X1NfYWx3YXlzX2VxdWFsKCkpCiAgICAgIHsKIHVzaW5nIF9fYWx3YXlzX2Vx
dWFsID0gdHlwZW5hbWUgX0FsbG9jX3RyYWl0czo6aXNfYWx3YXlzX2VxdWFsOwogX01fbW92ZV9h
c3NpZ24xKHN0ZDo6bW92ZShfX3gpLCBfX2Fsd2F5c19lcXVhbHt9KTsKIHJldHVybiAqdGhpczsK
ICAgICAgfQojIDEwODEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfZGVxdWUuaCIg
MwogICAgICBkZXF1ZSYKICAgICAgb3BlcmF0b3I9KGluaXRpYWxpemVyX2xpc3Q8dmFsdWVfdHlw
ZT4gX19sKQogICAgICB7CiB0aGlzLT5hc3NpZ24oX19sLmJlZ2luKCksIF9fbC5lbmQoKSk7CiBy
ZXR1cm4gKnRoaXM7CiAgICAgIH0KIyAxMDk5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
c3RsX2RlcXVlLmgiIDMKICAgICAgdm9pZAogICAgICBhc3NpZ24oc2l6ZV90eXBlIF9fbiwgY29u
c3QgdmFsdWVfdHlwZSYgX192YWwpCiAgICAgIHsgX01fZmlsbF9hc3NpZ24oX19uLCBfX3ZhbCk7
IH0KIyAxMTE2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3IsCiAgICAgICAgdHlwZW5hbWUgPSBz
dGQ6Ol9SZXF1aXJlSW5wdXRJdGVyPF9JbnB1dEl0ZXJhdG9yPj4KICAgICAgICB2b2lkCiAgICAg
ICAgYXNzaWduKF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCkK
ICAgICAgICB7IF9NX2Fzc2lnbl9kaXNwYXRjaChfX2ZpcnN0LCBfX2xhc3QsIF9fZmFsc2VfdHlw
ZSgpKTsgfQojIDExNDMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfZGVxdWUuaCIg
MwogICAgICB2b2lkCiAgICAgIGFzc2lnbihpbml0aWFsaXplcl9saXN0PHZhbHVlX3R5cGU+IF9f
bCkKICAgICAgeyB0aGlzLT5hc3NpZ24oX19sLmJlZ2luKCksIF9fbC5lbmQoKSk7IH0KCgoKICAg
ICAgYWxsb2NhdG9yX3R5cGUKICAgICAgZ2V0X2FsbG9jYXRvcigpIGNvbnN0IG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuIF9CYXNlOjpnZXRfYWxsb2NhdG9yKCk7IH0KCgoKCgoKICAgICAgaXRlcmF0
b3IKICAgICAgYmVnaW4oKSBub2V4Y2VwdAogICAgICB7IHJldHVybiB0aGlzLT5fTV9pbXBsLl9N
X3N0YXJ0OyB9CgoKCgoKICAgICAgY29uc3RfaXRlcmF0b3IKICAgICAgYmVnaW4oKSBjb25zdCBu
b2V4Y2VwdAogICAgICB7IHJldHVybiB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0OyB9CgoKCgoKCiAg
ICAgIGl0ZXJhdG9yCiAgICAgIGVuZCgpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHRoaXMtPl9N
X2ltcGwuX01fZmluaXNoOyB9CgoKCgoKCiAgICAgIGNvbnN0X2l0ZXJhdG9yCiAgICAgIGVuZCgp
IGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoOyB9
CgoKCgoKCiAgICAgIHJldmVyc2VfaXRlcmF0b3IKICAgICAgcmJlZ2luKCkgbm9leGNlcHQKICAg
ICAgeyByZXR1cm4gcmV2ZXJzZV9pdGVyYXRvcih0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCk7IH0K
CgoKCgoKICAgICAgY29uc3RfcmV2ZXJzZV9pdGVyYXRvcgogICAgICByYmVnaW4oKSBjb25zdCBu
b2V4Y2VwdAogICAgICB7IHJldHVybiBjb25zdF9yZXZlcnNlX2l0ZXJhdG9yKHRoaXMtPl9NX2lt
cGwuX01fZmluaXNoKTsgfQoKCgoKCgogICAgICByZXZlcnNlX2l0ZXJhdG9yCiAgICAgIHJlbmQo
KSBub2V4Y2VwdAogICAgICB7IHJldHVybiByZXZlcnNlX2l0ZXJhdG9yKHRoaXMtPl9NX2ltcGwu
X01fc3RhcnQpOyB9CgoKCgoKCiAgICAgIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAgICAgcmVu
ZCgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGNvbnN0X3JldmVyc2VfaXRlcmF0b3Io
dGhpcy0+X01faW1wbC5fTV9zdGFydCk7IH0KCgoKCgoKICAgICAgY29uc3RfaXRlcmF0b3IKICAg
ICAgY2JlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gdGhpcy0+X01faW1wbC5f
TV9zdGFydDsgfQoKCgoKCgogICAgICBjb25zdF9pdGVyYXRvcgogICAgICBjZW5kKCkgY29uc3Qg
bm9leGNlcHQKICAgICAgeyByZXR1cm4gdGhpcy0+X01faW1wbC5fTV9maW5pc2g7IH0KCgoKCgoK
ICAgICAgY29uc3RfcmV2ZXJzZV9pdGVyYXRvcgogICAgICBjcmJlZ2luKCkgY29uc3Qgbm9leGNl
cHQKICAgICAgeyByZXR1cm4gY29uc3RfcmV2ZXJzZV9pdGVyYXRvcih0aGlzLT5fTV9pbXBsLl9N
X2ZpbmlzaCk7IH0KCgoKCgoKICAgICAgY29uc3RfcmV2ZXJzZV9pdGVyYXRvcgogICAgICBjcmVu
ZCgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGNvbnN0X3JldmVyc2VfaXRlcmF0b3Io
dGhpcy0+X01faW1wbC5fTV9zdGFydCk7IH0KCgoKCiAgICAgIHNpemVfdHlwZQogICAgICBzaXpl
KCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gdGhpcy0+X01faW1wbC5fTV9maW5pc2gg
LSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0OyB9CgoKICAgICAgc2l6ZV90eXBlCiAgICAgIG1heF9z
aXplKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX0FsbG9jX3RyYWl0czo6bWF4X3Np
emUoX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsgfQojIDEyODIgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9zdGxfZGVxdWUuaCIgMwogICAgICB2b2lkCiAgICAgIHJlc2l6ZShzaXplX3R5cGUg
X19uZXdfc2l6ZSkKICAgICAgewogY29uc3Qgc2l6ZV90eXBlIF9fbGVuID0gc2l6ZSgpOwogaWYg
KF9fbmV3X3NpemUgPiBfX2xlbikKICAgX01fZGVmYXVsdF9hcHBlbmQoX19uZXdfc2l6ZSAtIF9f
bGVuKTsKIGVsc2UgaWYgKF9fbmV3X3NpemUgPCBfX2xlbikKICAgX01fZXJhc2VfYXRfZW5kKHRo
aXMtPl9NX2ltcGwuX01fc3RhcnQKICAgICArIGRpZmZlcmVuY2VfdHlwZShfX25ld19zaXplKSk7
CiAgICAgIH0KIyAxMzA0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgi
IDMKICAgICAgdm9pZAogICAgICByZXNpemUoc2l6ZV90eXBlIF9fbmV3X3NpemUsIGNvbnN0IHZh
bHVlX3R5cGUmIF9feCkKICAgICAgewogY29uc3Qgc2l6ZV90eXBlIF9fbGVuID0gc2l6ZSgpOwog
aWYgKF9fbmV3X3NpemUgPiBfX2xlbikKICAgaW5zZXJ0KHRoaXMtPl9NX2ltcGwuX01fZmluaXNo
LCBfX25ld19zaXplIC0gX19sZW4sIF9feCk7CiBlbHNlIGlmIChfX25ld19zaXplIDwgX19sZW4p
CiAgIF9NX2VyYXNlX2F0X2VuZCh0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0CiAgICAgKyBkaWZmZXJl
bmNlX3R5cGUoX19uZXdfc2l6ZSkpOwogICAgICB9CiMgMTM0MCAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAgIHZvaWQKICAgICAgc2hyaW5rX3RvX2ZpdCgp
IG5vZXhjZXB0CiAgICAgIHsgX01fc2hyaW5rX3RvX2ZpdCgpOyB9CgoKCgoKCiAgICAgIGJvb2wK
ICAgICAgZW1wdHkoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiB0aGlzLT5fTV9pbXBs
Ll9NX2ZpbmlzaCA9PSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0OyB9CiMgMTM2NSAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAgIHJlZmVyZW5jZQogICAgICBv
cGVyYXRvcltdKHNpemVfdHlwZSBfX24pIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHRoaXMtPl9N
X2ltcGwuX01fc3RhcnRbZGlmZmVyZW5jZV90eXBlKF9fbildOyB9CiMgMTM4MCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAgIGNvbnN0X3JlZmVyZW5jZQog
ICAgICBvcGVyYXRvcltdKHNpemVfdHlwZSBfX24pIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0
dXJuIHRoaXMtPl9NX2ltcGwuX01fc3RhcnRbZGlmZmVyZW5jZV90eXBlKF9fbildOyB9CgogICAg
cHJvdGVjdGVkOgoKICAgICAgdm9pZAogICAgICBfTV9yYW5nZV9jaGVjayhzaXplX3R5cGUgX19u
KSBjb25zdAogICAgICB7CiBpZiAoX19uID49IHRoaXMtPnNpemUoKSkKICAgX190aHJvd19vdXRf
b2ZfcmFuZ2VfZm10KCgiZGVxdWU6Ol9NX3JhbmdlX2NoZWNrOiBfX24gIiAiKHdoaWNoIGlzICV6
dSk+PSB0aGlzLT5zaXplKCkgIiAiKHdoaWNoIGlzICV6dSkiKQoKICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICwKICAgICAgIF9fbiwgdGhpcy0+c2l6ZSgpKTsKICAgICAgfQoKICAgIHB1Ymxp
YzoKIyAxNDA4ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMKICAg
ICAgcmVmZXJlbmNlCiAgICAgIGF0KHNpemVfdHlwZSBfX24pCiAgICAgIHsKIF9NX3JhbmdlX2No
ZWNrKF9fbik7CiByZXR1cm4gKCp0aGlzKVtfX25dOwogICAgICB9CiMgMTQyNiAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAgIGNvbnN0X3JlZmVyZW5jZQog
ICAgICBhdChzaXplX3R5cGUgX19uKSBjb25zdAogICAgICB7CiBfTV9yYW5nZV9jaGVjayhfX24p
OwogcmV0dXJuICgqdGhpcylbX19uXTsKICAgICAgfQoKCgoKCiAgICAgIHJlZmVyZW5jZQogICAg
ICBmcm9udCgpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuICpiZWdpbigpOyB9CgoKCgoKICAgICAg
Y29uc3RfcmVmZXJlbmNlCiAgICAgIGZyb250KCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1
cm4gKmJlZ2luKCk7IH0KCgoKCgogICAgICByZWZlcmVuY2UKICAgICAgYmFjaygpIG5vZXhjZXB0
CiAgICAgIHsKIGl0ZXJhdG9yIF9fdG1wID0gZW5kKCk7CiAtLV9fdG1wOwogcmV0dXJuICpfX3Rt
cDsKICAgICAgfQoKCgoKCiAgICAgIGNvbnN0X3JlZmVyZW5jZQogICAgICBiYWNrKCkgY29uc3Qg
bm9leGNlcHQKICAgICAgewogY29uc3RfaXRlcmF0b3IgX190bXAgPSBlbmQoKTsKIC0tX190bXA7
CiByZXR1cm4gKl9fdG1wOwogICAgICB9CiMgMTQ4MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAgIHZvaWQKICAgICAgcHVzaF9mcm9udChjb25zdCB2YWx1
ZV90eXBlJiBfX3gpCiAgICAgIHsKIGlmICh0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9NX2N1ciAh
PSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9NX2ZpcnN0KQogICB7CiAgICAgX0FsbG9jX3RyYWl0
czo6Y29uc3RydWN0KHRoaXMtPl9NX2ltcGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fY3VyIC0gMSwKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgX194KTsKICAgICAtLXRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fY3VyOwogICB9
CiBlbHNlCiAgIF9NX3B1c2hfZnJvbnRfYXV4KF9feCk7CiAgICAgIH0KCgogICAgICB2b2lkCiAg
ICAgIHB1c2hfZnJvbnQodmFsdWVfdHlwZSYmIF9feCkKICAgICAgeyBlbXBsYWNlX2Zyb250KHN0
ZDo6bW92ZShfX3gpKTsgfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX0FyZ3M+CiAgICAg
ICAgdm9pZAogICAgICAgIGVtcGxhY2VfZnJvbnQoX0FyZ3MmJi4uLiBfX2FyZ3MpOwojIDE1MTYg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfZGVxdWUuaCIgMwogICAgICB2b2lkCiAg
ICAgIHB1c2hfYmFjayhjb25zdCB2YWx1ZV90eXBlJiBfX3gpCiAgICAgIHsKIGlmICh0aGlzLT5f
TV9pbXBsLl9NX2ZpbmlzaC5fTV9jdXIKICAgICAhPSB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5f
TV9sYXN0IC0gMSkKICAgewogICAgIF9BbGxvY190cmFpdHM6OmNvbnN0cnVjdCh0aGlzLT5fTV9p
bXBsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2Zpbmlz
aC5fTV9jdXIsIF9feCk7CiAgICAgKyt0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9jdXI7CiAg
IH0KIGVsc2UKICAgX01fcHVzaF9iYWNrX2F1eChfX3gpOwogICAgICB9CgoKICAgICAgdm9pZAog
ICAgICBwdXNoX2JhY2sodmFsdWVfdHlwZSYmIF9feCkKICAgICAgeyBlbXBsYWNlX2JhY2soc3Rk
Ojptb3ZlKF9feCkpOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfQXJncz4KICAgICAg
ICB2b2lkCiAgICAgICAgZW1wbGFjZV9iYWNrKF9BcmdzJiYuLi4gX19hcmdzKTsKIyAxNTQ4ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMKICAgICAgdm9pZAogICAg
ICBwb3BfZnJvbnQoKSBub2V4Y2VwdAogICAgICB7CiBpZiAodGhpcy0+X01faW1wbC5fTV9zdGFy
dC5fTV9jdXIKICAgICAhPSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9NX2xhc3QgLSAxKQogICB7
CiAgICAgX0FsbG9jX3RyYWl0czo6ZGVzdHJveSh0aGlzLT5fTV9pbXBsLAogICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9jdXIpOwogICAgICsrdGhp
cy0+X01faW1wbC5fTV9zdGFydC5fTV9jdXI7CiAgIH0KIGVsc2UKICAgX01fcG9wX2Zyb250X2F1
eCgpOwogICAgICB9CiMgMTU3MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9kZXF1
ZS5oIiAzCiAgICAgIHZvaWQKICAgICAgcG9wX2JhY2soKSBub2V4Y2VwdAogICAgICB7CiBpZiAo
dGhpcy0+X01faW1wbC5fTV9maW5pc2guX01fY3VyCiAgICAgIT0gdGhpcy0+X01faW1wbC5fTV9m
aW5pc2guX01fZmlyc3QpCiAgIHsKICAgICAtLXRoaXMtPl9NX2ltcGwuX01fZmluaXNoLl9NX2N1
cjsKICAgICBfQWxsb2NfdHJhaXRzOjpkZXN0cm95KHRoaXMtPl9NX2ltcGwsCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9jdXIpOwogICB9CiBl
bHNlCiAgIF9NX3BvcF9iYWNrX2F1eCgpOwogICAgICB9CiMgMTU5NCAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9B
cmdzPgogICAgICAgIGl0ZXJhdG9yCiAgICAgICAgZW1wbGFjZShjb25zdF9pdGVyYXRvciBfX3Bv
c2l0aW9uLCBfQXJncyYmLi4uIF9fYXJncyk7CiMgMTYwNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAgIGl0ZXJhdG9yCiAgICAgIGluc2VydChjb25zdF9p
dGVyYXRvciBfX3Bvc2l0aW9uLCBjb25zdCB2YWx1ZV90eXBlJiBfX3gpOwojIDE2MzMgIi91c3Iv
aW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfZGVxdWUuaCIgMwogICAgICBpdGVyYXRvcgogICAg
ICBpbnNlcnQoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgdmFsdWVfdHlwZSYmIF9feCkKICAg
ICAgeyByZXR1cm4gZW1wbGFjZShfX3Bvc2l0aW9uLCBzdGQ6Om1vdmUoX194KSk7IH0KIyAxNjQ2
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMKICAgICAgaXRlcmF0
b3IKICAgICAgaW5zZXJ0KGNvbnN0X2l0ZXJhdG9yIF9fcCwgaW5pdGlhbGl6ZXJfbGlzdDx2YWx1
ZV90eXBlPiBfX2wpCiAgICAgIHsgcmV0dXJuIHRoaXMtPmluc2VydChfX3AsIF9fbC5iZWdpbigp
LCBfX2wuZW5kKCkpOyB9CiMgMTY2MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9k
ZXF1ZS5oIiAzCiAgICAgIGl0ZXJhdG9yCiAgICAgIGluc2VydChjb25zdF9pdGVyYXRvciBfX3Bv
c2l0aW9uLCBzaXplX3R5cGUgX19uLCBjb25zdCB2YWx1ZV90eXBlJiBfX3gpCiAgICAgIHsKIGRp
ZmZlcmVuY2VfdHlwZSBfX29mZnNldCA9IF9fcG9zaXRpb24gLSBjYmVnaW4oKTsKIF9NX2ZpbGxf
aW5zZXJ0KF9fcG9zaXRpb24uX01fY29uc3RfY2FzdCgpLCBfX24sIF9feCk7CiByZXR1cm4gYmVn
aW4oKSArIF9fb2Zmc2V0OwogICAgICB9CiMgMTY5NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9y
LAogICAgICAgIHR5cGVuYW1lID0gc3RkOjpfUmVxdWlyZUlucHV0SXRlcjxfSW5wdXRJdGVyYXRv
cj4+CiAgICAgICAgaXRlcmF0b3IKICAgICAgICBpbnNlcnQoY29uc3RfaXRlcmF0b3IgX19wb3Np
dGlvbiwgX0lucHV0SXRlcmF0b3IgX19maXJzdCwKICAgICAgICBfSW5wdXRJdGVyYXRvciBfX2xh
c3QpCiAgICAgICAgewogICBkaWZmZXJlbmNlX3R5cGUgX19vZmZzZXQgPSBfX3Bvc2l0aW9uIC0g
Y2JlZ2luKCk7CiAgIF9NX2luc2VydF9kaXNwYXRjaChfX3Bvc2l0aW9uLl9NX2NvbnN0X2Nhc3Qo
KSwKICAgICAgICBfX2ZpcnN0LCBfX2xhc3QsIF9fZmFsc2VfdHlwZSgpKTsKICAgcmV0dXJuIGJl
Z2luKCkgKyBfX29mZnNldDsKIH0KIyAxNzQyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
c3RsX2RlcXVlLmgiIDMKICAgICAgaXRlcmF0b3IKCiAgICAgIGVyYXNlKGNvbnN0X2l0ZXJhdG9y
IF9fcG9zaXRpb24pCgoKCiAgICAgIHsgcmV0dXJuIF9NX2VyYXNlKF9fcG9zaXRpb24uX01fY29u
c3RfY2FzdCgpKTsgfQojIDE3NjYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfZGVx
dWUuaCIgMwogICAgICBpdGVyYXRvcgoKICAgICAgZXJhc2UoY29uc3RfaXRlcmF0b3IgX19maXJz
dCwgY29uc3RfaXRlcmF0b3IgX19sYXN0KQoKCgogICAgICB7IHJldHVybiBfTV9lcmFzZShfX2Zp
cnN0Ll9NX2NvbnN0X2Nhc3QoKSwgX19sYXN0Ll9NX2NvbnN0X2Nhc3QoKSk7IH0KIyAxNzgzICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMKICAgICAgdm9pZAogICAg
ICBzd2FwKGRlcXVlJiBfX3gpIG5vZXhjZXB0CiAgICAgIHsKIF9NX2ltcGwuX01fc3dhcF9kYXRh
KF9feC5fTV9pbXBsKTsKIF9BbGxvY190cmFpdHM6Ol9TX29uX3N3YXAoX01fZ2V0X1RwX2FsbG9j
YXRvcigpLAogICAgICBfX3guX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICAgICAgfQoKCgoKCgoK
ICAgICAgdm9pZAogICAgICBjbGVhcigpIG5vZXhjZXB0CiAgICAgIHsgX01fZXJhc2VfYXRfZW5k
KGJlZ2luKCkpOyB9CgogICAgcHJvdGVjdGVkOgoKCgoKCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfSW50ZWdlcj4KICAgICAgICB2b2lkCiAgICAgICAgX01faW5pdGlhbGl6ZV9kaXNwYXRjaChf
SW50ZWdlciBfX24sIF9JbnRlZ2VyIF9feCwgX190cnVlX3R5cGUpCiAgICAgICAgewogICBfTV9p
bml0aWFsaXplX21hcChzdGF0aWNfY2FzdDxzaXplX3R5cGU+KF9fbikpOwogICBfTV9maWxsX2lu
aXRpYWxpemUoX194KTsKIH0KCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRv
cj4KICAgICAgICB2b2lkCiAgICAgICAgX01faW5pdGlhbGl6ZV9kaXNwYXRjaChfSW5wdXRJdGVy
YXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QsCiAgICAgICAgICBfX2ZhbHNlX3R5
cGUpCiAgICAgICAgewogICB0eXBlZGVmIHR5cGVuYW1lIHN0ZDo6aXRlcmF0b3JfdHJhaXRzPF9J
bnB1dEl0ZXJhdG9yPjo6CiAgICAgaXRlcmF0b3JfY2F0ZWdvcnkgX0l0ZXJDYXRlZ29yeTsKICAg
X01fcmFuZ2VfaW5pdGlhbGl6ZShfX2ZpcnN0LCBfX2xhc3QsIF9JdGVyQ2F0ZWdvcnkoKSk7CiB9
CiMgMTgzOSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAg
IHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yPgogICAgICAgIHZvaWQKICAgICAgICBf
TV9yYW5nZV9pbml0aWFsaXplKF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9y
IF9fbGFzdCwKICAgICAgIHN0ZDo6aW5wdXRfaXRlcmF0b3JfdGFnKTsKCgogICAgICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yPgogICAgICAgIHZvaWQKICAgICAgICBfTV9yYW5n
ZV9pbml0aWFsaXplKF9Gb3J3YXJkSXRlcmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBf
X2xhc3QsCiAgICAgICBzdGQ6OmZvcndhcmRfaXRlcmF0b3JfdGFnKTsKIyAxODYxICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMKICAgICAgdm9pZAogICAgICBfTV9m
aWxsX2luaXRpYWxpemUoY29uc3QgdmFsdWVfdHlwZSYgX192YWx1ZSk7CgoKCiAgICAgIHZvaWQK
ICAgICAgX01fZGVmYXVsdF9pbml0aWFsaXplKCk7CiMgMTg3NyAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnRlZ2Vy
PgogICAgICAgIHZvaWQKICAgICAgICBfTV9hc3NpZ25fZGlzcGF0Y2goX0ludGVnZXIgX19uLCBf
SW50ZWdlciBfX3ZhbCwgX190cnVlX3R5cGUpCiAgICAgICAgeyBfTV9maWxsX2Fzc2lnbihfX24s
IF9fdmFsKTsgfQoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yPgogICAg
ICAgIHZvaWQKICAgICAgICBfTV9hc3NpZ25fZGlzcGF0Y2goX0lucHV0SXRlcmF0b3IgX19maXJz
dCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgICBfX2ZhbHNlX3R5cGUpCiAgICAgICAgewog
ICB0eXBlZGVmIHR5cGVuYW1lIHN0ZDo6aXRlcmF0b3JfdHJhaXRzPF9JbnB1dEl0ZXJhdG9yPjo6
CiAgICAgaXRlcmF0b3JfY2F0ZWdvcnkgX0l0ZXJDYXRlZ29yeTsKICAgX01fYXNzaWduX2F1eChf
X2ZpcnN0LCBfX2xhc3QsIF9JdGVyQ2F0ZWdvcnkoKSk7CiB9CgoKICAgICAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0lucHV0SXRlcmF0b3I+CiAgICAgICAgdm9pZAogICAgICAgIF9NX2Fzc2lnbl9hdXgo
X0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICAgICAgIHN0
ZDo6aW5wdXRfaXRlcmF0b3JfdGFnKTsKCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2Fy
ZEl0ZXJhdG9yPgogICAgICAgIHZvaWQKICAgICAgICBfTV9hc3NpZ25fYXV4KF9Gb3J3YXJkSXRl
cmF0b3IgX19maXJzdCwgX0ZvcndhcmRJdGVyYXRvciBfX2xhc3QsCiAgICAgICAgc3RkOjpmb3J3
YXJkX2l0ZXJhdG9yX3RhZykKICAgICAgICB7CiAgIGNvbnN0IHNpemVfdHlwZSBfX2xlbiA9IHN0
ZDo6ZGlzdGFuY2UoX19maXJzdCwgX19sYXN0KTsKICAgaWYgKF9fbGVuID4gc2l6ZSgpKQogICAg
IHsKICAgICAgIF9Gb3J3YXJkSXRlcmF0b3IgX19taWQgPSBfX2ZpcnN0OwogICAgICAgc3RkOjph
ZHZhbmNlKF9fbWlkLCBzaXplKCkpOwogICAgICAgc3RkOjpjb3B5KF9fZmlyc3QsIF9fbWlkLCBi
ZWdpbigpKTsKICAgICAgIGluc2VydChlbmQoKSwgX19taWQsIF9fbGFzdCk7CiAgICAgfQogICBl
bHNlCiAgICAgX01fZXJhc2VfYXRfZW5kKHN0ZDo6Y29weShfX2ZpcnN0LCBfX2xhc3QsIGJlZ2lu
KCkpKTsKIH0KCgoKICAgICAgdm9pZAogICAgICBfTV9maWxsX2Fzc2lnbihzaXplX3R5cGUgX19u
LCBjb25zdCB2YWx1ZV90eXBlJiBfX3ZhbCkKICAgICAgewogaWYgKF9fbiA+IHNpemUoKSkKICAg
ewogICAgIHN0ZDo6ZmlsbChiZWdpbigpLCBlbmQoKSwgX192YWwpOwogICAgIGluc2VydChlbmQo
KSwgX19uIC0gc2l6ZSgpLCBfX3ZhbCk7CiAgIH0KIGVsc2UKICAgewogICAgIF9NX2VyYXNlX2F0
X2VuZChiZWdpbigpICsgZGlmZmVyZW5jZV90eXBlKF9fbikpOwogICAgIHN0ZDo6ZmlsbChiZWdp
bigpLCBlbmQoKSwgX192YWwpOwogICB9CiAgICAgIH0KIyAxOTQxICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX0Fy
Z3M+CiAgICAgICAgdm9pZCBfTV9wdXNoX2JhY2tfYXV4KF9BcmdzJiYuLi4gX19hcmdzKTsKCiAg
ICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogICAgICAgIHZvaWQgX01fcHVzaF9mcm9u
dF9hdXgoX0FyZ3MmJi4uLiBfX2FyZ3MpOwoKCiAgICAgIHZvaWQgX01fcG9wX2JhY2tfYXV4KCk7
CgogICAgICB2b2lkIF9NX3BvcF9mcm9udF9hdXgoKTsKIyAxOTYwICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2JpdHMvc3RsX2RlcXVlLmgiIDMKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0ludGVn
ZXI+CiAgICAgICAgdm9pZAogICAgICAgIF9NX2luc2VydF9kaXNwYXRjaChpdGVyYXRvciBfX3Bv
cywKICAgICAgX0ludGVnZXIgX19uLCBfSW50ZWdlciBfX3gsIF9fdHJ1ZV90eXBlKQogICAgICAg
IHsgX01fZmlsbF9pbnNlcnQoX19wb3MsIF9fbiwgX194KTsgfQoKCiAgICAgIHRlbXBsYXRlPHR5
cGVuYW1lIF9JbnB1dEl0ZXJhdG9yPgogICAgICAgIHZvaWQKICAgICAgICBfTV9pbnNlcnRfZGlz
cGF0Y2goaXRlcmF0b3IgX19wb3MsCiAgICAgIF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1
dEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgX19mYWxzZV90eXBlKQogICAgICAgIHsKICAgdHlwZWRl
ZiB0eXBlbmFtZSBzdGQ6Oml0ZXJhdG9yX3RyYWl0czxfSW5wdXRJdGVyYXRvcj46OgogICAgIGl0
ZXJhdG9yX2NhdGVnb3J5IF9JdGVyQ2F0ZWdvcnk7CiAgICAgICAgICBfTV9yYW5nZV9pbnNlcnRf
YXV4KF9fcG9zLCBfX2ZpcnN0LCBfX2xhc3QsIF9JdGVyQ2F0ZWdvcnkoKSk7CiB9CgoKICAgICAg
dGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3I+CiAgICAgICAgdm9pZAogICAgICAgIF9N
X3JhbmdlX2luc2VydF9hdXgoaXRlcmF0b3IgX19wb3MsIF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3Qs
CiAgICAgICBfSW5wdXRJdGVyYXRvciBfX2xhc3QsIHN0ZDo6aW5wdXRfaXRlcmF0b3JfdGFnKTsK
CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yPgogICAgICAgIHZvaWQK
ICAgICAgICBfTV9yYW5nZV9pbnNlcnRfYXV4KGl0ZXJhdG9yIF9fcG9zLCBfRm9yd2FyZEl0ZXJh
dG9yIF9fZmlyc3QsCiAgICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwgc3RkOjpmb3J3YXJk
X2l0ZXJhdG9yX3RhZyk7CgoKCgogICAgICB2b2lkCiAgICAgIF9NX2ZpbGxfaW5zZXJ0KGl0ZXJh
dG9yIF9fcG9zLCBzaXplX3R5cGUgX19uLCBjb25zdCB2YWx1ZV90eXBlJiBfX3gpOwoKCgoKCgog
ICAgICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfQXJncz4KICAgICAgICBpdGVyYXRvcgogICAgICAg
IF9NX2luc2VydF9hdXgoaXRlcmF0b3IgX19wb3MsIF9BcmdzJiYuLi4gX19hcmdzKTsKCgoKICAg
ICAgdm9pZAogICAgICBfTV9pbnNlcnRfYXV4KGl0ZXJhdG9yIF9fcG9zLCBzaXplX3R5cGUgX19u
LCBjb25zdCB2YWx1ZV90eXBlJiBfX3gpOwoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Gb3J3
YXJkSXRlcmF0b3I+CiAgICAgICAgdm9pZAogICAgICAgIF9NX2luc2VydF9hdXgoaXRlcmF0b3Ig
X19wb3MsCiAgICAgICAgX0ZvcndhcmRJdGVyYXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9y
IF9fbGFzdCwKICAgICAgICBzaXplX3R5cGUgX19uKTsKCgoKCiAgICAgIHZvaWQKICAgICAgX01f
ZGVzdHJveV9kYXRhX2F1eChpdGVyYXRvciBfX2ZpcnN0LCBpdGVyYXRvciBfX2xhc3QpOwoKCgog
ICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2MxPgogICAgICAgIHZvaWQKICAgICAgICBfTV9k
ZXN0cm95X2RhdGEoaXRlcmF0b3IgX19maXJzdCwgaXRlcmF0b3IgX19sYXN0LCBjb25zdCBfQWxs
b2MxJikKICAgICAgICB7IF9NX2Rlc3Ryb3lfZGF0YV9hdXgoX19maXJzdCwgX19sYXN0KTsgfQoK
ICAgICAgdm9pZAogICAgICBfTV9kZXN0cm95X2RhdGEoaXRlcmF0b3IgX19maXJzdCwgaXRlcmF0
b3IgX19sYXN0LAogICAgICAgIGNvbnN0IHN0ZDo6YWxsb2NhdG9yPF9UcD4mKQogICAgICB7CiBp
ZiAoIV9faGFzX3RyaXZpYWxfZGVzdHJ1Y3Rvcih2YWx1ZV90eXBlKSkKICAgX01fZGVzdHJveV9k
YXRhX2F1eChfX2ZpcnN0LCBfX2xhc3QpOwogICAgICB9CgoKICAgICAgdm9pZAogICAgICBfTV9l
cmFzZV9hdF9iZWdpbihpdGVyYXRvciBfX3BvcykKICAgICAgewogX01fZGVzdHJveV9kYXRhKGJl
Z2luKCksIF9fcG9zLCBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogX01fZGVzdHJveV9ub2Rlcyh0
aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9NX25vZGUsIF9fcG9zLl9NX25vZGUpOwogdGhpcy0+X01f
aW1wbC5fTV9zdGFydCA9IF9fcG9zOwogICAgICB9CgoKCiAgICAgIHZvaWQKICAgICAgX01fZXJh
c2VfYXRfZW5kKGl0ZXJhdG9yIF9fcG9zKQogICAgICB7CiBfTV9kZXN0cm95X2RhdGEoX19wb3Ms
IGVuZCgpLCBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogX01fZGVzdHJveV9ub2RlcyhfX3Bvcy5f
TV9ub2RlICsgMSwKICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoLl9NX25vZGUgKyAxKTsKIHRo
aXMtPl9NX2ltcGwuX01fZmluaXNoID0gX19wb3M7CiAgICAgIH0KCiAgICAgIGl0ZXJhdG9yCiAg
ICAgIF9NX2VyYXNlKGl0ZXJhdG9yIF9fcG9zKTsKCiAgICAgIGl0ZXJhdG9yCiAgICAgIF9NX2Vy
YXNlKGl0ZXJhdG9yIF9fZmlyc3QsIGl0ZXJhdG9yIF9fbGFzdCk7CgoKCiAgICAgIHZvaWQKICAg
ICAgX01fZGVmYXVsdF9hcHBlbmQoc2l6ZV90eXBlIF9fbik7CgogICAgICBib29sCiAgICAgIF9N
X3Nocmlua190b19maXQoKTsKCgoKCiAgICAgIGl0ZXJhdG9yCiAgICAgIF9NX3Jlc2VydmVfZWxl
bWVudHNfYXRfZnJvbnQoc2l6ZV90eXBlIF9fbikKICAgICAgewogY29uc3Qgc2l6ZV90eXBlIF9f
dmFjYW5jaWVzID0gdGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9jdXIKICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIC0gdGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9maXJzdDsKIGlmIChf
X24gPiBfX3ZhY2FuY2llcykKICAgX01fbmV3X2VsZW1lbnRzX2F0X2Zyb250KF9fbiAtIF9fdmFj
YW5jaWVzKTsKIHJldHVybiB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0IC0gZGlmZmVyZW5jZV90eXBl
KF9fbik7CiAgICAgIH0KCiAgICAgIGl0ZXJhdG9yCiAgICAgIF9NX3Jlc2VydmVfZWxlbWVudHNf
YXRfYmFjayhzaXplX3R5cGUgX19uKQogICAgICB7CiBjb25zdCBzaXplX3R5cGUgX192YWNhbmNp
ZXMgPSAodGhpcy0+X01faW1wbC5fTV9maW5pc2guX01fbGFzdAogICAgICAgICAgIC0gdGhpcy0+
X01faW1wbC5fTV9maW5pc2guX01fY3VyKSAtIDE7CiBpZiAoX19uID4gX192YWNhbmNpZXMpCiAg
IF9NX25ld19lbGVtZW50c19hdF9iYWNrKF9fbiAtIF9fdmFjYW5jaWVzKTsKIHJldHVybiB0aGlz
LT5fTV9pbXBsLl9NX2ZpbmlzaCArIGRpZmZlcmVuY2VfdHlwZShfX24pOwogICAgICB9CgogICAg
ICB2b2lkCiAgICAgIF9NX25ld19lbGVtZW50c19hdF9mcm9udChzaXplX3R5cGUgX19uZXdfZWxl
bWVudHMpOwoKICAgICAgdm9pZAogICAgICBfTV9uZXdfZWxlbWVudHNfYXRfYmFjayhzaXplX3R5
cGUgX19uZXdfZWxlbWVudHMpOwojIDIxMTEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9z
dGxfZGVxdWUuaCIgMwogICAgICB2b2lkCiAgICAgIF9NX3Jlc2VydmVfbWFwX2F0X2JhY2soc2l6
ZV90eXBlIF9fbm9kZXNfdG9fYWRkID0gMSkKICAgICAgewogaWYgKF9fbm9kZXNfdG9fYWRkICsg
MSA+IHRoaXMtPl9NX2ltcGwuX01fbWFwX3NpemUKICAgICAtICh0aGlzLT5fTV9pbXBsLl9NX2Zp
bmlzaC5fTV9ub2RlIC0gdGhpcy0+X01faW1wbC5fTV9tYXApKQogICBfTV9yZWFsbG9jYXRlX21h
cChfX25vZGVzX3RvX2FkZCwgZmFsc2UpOwogICAgICB9CgogICAgICB2b2lkCiAgICAgIF9NX3Jl
c2VydmVfbWFwX2F0X2Zyb250KHNpemVfdHlwZSBfX25vZGVzX3RvX2FkZCA9IDEpCiAgICAgIHsK
IGlmIChfX25vZGVzX3RvX2FkZCA+IHNpemVfdHlwZSh0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9N
X25vZGUKICAgICAgICAgICAtIHRoaXMtPl9NX2ltcGwuX01fbWFwKSkKICAgX01fcmVhbGxvY2F0
ZV9tYXAoX19ub2Rlc190b19hZGQsIHRydWUpOwogICAgICB9CgogICAgICB2b2lkCiAgICAgIF9N
X3JlYWxsb2NhdGVfbWFwKHNpemVfdHlwZSBfX25vZGVzX3RvX2FkZCwgYm9vbCBfX2FkZF9hdF9m
cm9udCk7CgoKCgoKICAgICAgdm9pZAogICAgICBfTV9tb3ZlX2Fzc2lnbjEoZGVxdWUmJiBfX3gs
IHRydWVfdHlwZSkgbm9leGNlcHQKICAgICAgewogdGhpcy0+X01faW1wbC5fTV9zd2FwX2RhdGEo
X194Ll9NX2ltcGwpOwogX194LmNsZWFyKCk7CiBzdGQ6Ol9fYWxsb2Nfb25fbW92ZShfTV9nZXRf
VHBfYWxsb2NhdG9yKCksIF9feC5fTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgICB9CgoKCgog
ICAgICB2b2lkCiAgICAgIF9NX21vdmVfYXNzaWduMShkZXF1ZSYmIF9feCwgZmFsc2VfdHlwZSkK
ICAgICAgewogY29uc3RleHByIGJvb2wgX19tb3ZlX3N0b3JhZ2UgPQogICBfQWxsb2NfdHJhaXRz
OjpfU19wcm9wYWdhdGVfb25fbW92ZV9hc3NpZ24oKTsKIF9NX21vdmVfYXNzaWduMihzdGQ6Om1v
dmUoX194KSwgX19ib29sX2NvbnN0YW50PF9fbW92ZV9zdG9yYWdlPigpKTsKICAgICAgfQoKCgog
ICAgICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfQXJncz4KICAgICAgdm9pZAogICAgICBfTV9yZXBs
YWNlX21hcChfQXJncyYmLi4uIF9fYXJncykKICAgICAgewoKIGRlcXVlIF9fbmV3b2JqKHN0ZDo6
Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLik7CgogY2xlYXIoKTsKIF9NX2RlYWxsb2NhdGVfbm9k
ZSgqYmVnaW4oKS5fTV9ub2RlKTsKIF9NX2RlYWxsb2NhdGVfbWFwKHRoaXMtPl9NX2ltcGwuX01f
bWFwLCB0aGlzLT5fTV9pbXBsLl9NX21hcF9zaXplKTsKIHRoaXMtPl9NX2ltcGwuX01fbWFwID0g
bnVsbHB0cjsKIHRoaXMtPl9NX2ltcGwuX01fbWFwX3NpemUgPSAwOwoKIHRoaXMtPl9NX2ltcGwu
X01fc3dhcF9kYXRhKF9fbmV3b2JqLl9NX2ltcGwpOwogICAgICB9CgoKICAgICAgdm9pZAogICAg
ICBfTV9tb3ZlX2Fzc2lnbjIoZGVxdWUmJiBfX3gsIHRydWVfdHlwZSkKICAgICAgewoKIGF1dG8g
X19hbGxvYyA9IF9feC5fTV9nZXRfVHBfYWxsb2NhdG9yKCk7CgoKIF9NX3JlcGxhY2VfbWFwKHN0
ZDo6bW92ZShfX3gpKTsKCiBfTV9nZXRfVHBfYWxsb2NhdG9yKCkgPSBzdGQ6Om1vdmUoX19hbGxv
Yyk7CiAgICAgIH0KCgoKICAgICAgdm9pZAogICAgICBfTV9tb3ZlX2Fzc2lnbjIoZGVxdWUmJiBf
X3gsIGZhbHNlX3R5cGUpCiAgICAgIHsKIGlmIChfX3guX01fZ2V0X1RwX2FsbG9jYXRvcigpID09
IHRoaXMtPl9NX2dldF9UcF9hbGxvY2F0b3IoKSkKICAgewoKCiAgICAgX01fcmVwbGFjZV9tYXAo
c3RkOjptb3ZlKF9feCksIF9feC5nZXRfYWxsb2NhdG9yKCkpOwogICB9CiBlbHNlCiAgIHsKCgog
ICAgIHRoaXMtPmFzc2lnbihzdGQ6Ol9fbWFrZV9tb3ZlX2lmX25vZXhjZXB0X2l0ZXJhdG9yKF9f
eC5iZWdpbigpKSwKICAgIHN0ZDo6X19tYWtlX21vdmVfaWZfbm9leGNlcHRfaXRlcmF0b3IoX194
LmVuZCgpKSk7CiAgICAgX194LmNsZWFyKCk7CiAgIH0KICAgICAgfQoKICAgIH07CiMgMjIxOCAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9kZXF1ZS5oIiAzCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I9
PShjb25zdCBkZXF1ZTxfVHAsIF9BbGxvYz4mIF9feCwKICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IGRlcXVlPF9UcCwgX0FsbG9jPiYgX195KQogICAgeyByZXR1cm4gX194LnNpemUoKSA9
PSBfX3kuc2l6ZSgpCiAgICAgICAgICAgICAmJiBzdGQ6OmVxdWFsKF9feC5iZWdpbigpLCBfX3gu
ZW5kKCksIF9feS5iZWdpbigpKTsgfQojIDIyMzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9zdGxfZGVxdWUuaCIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9j
PgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPChjb25zdCBkZXF1ZTxfVHAsIF9BbGxvYz4m
IF9feCwKICAgICAgIGNvbnN0IGRlcXVlPF9UcCwgX0FsbG9jPiYgX195KQogICAgeyByZXR1cm4g
c3RkOjpsZXhpY29ncmFwaGljYWxfY29tcGFyZShfX3guYmVnaW4oKSwgX194LmVuZCgpLAogICAg
ICAgX195LmJlZ2luKCksIF9feS5lbmQoKSk7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwg
dHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yIT0oY29uc3QgZGVx
dWU8X1RwLCBfQWxsb2M+JiBfX3gsCiAgICAgICAgY29uc3QgZGVxdWU8X1RwLCBfQWxsb2M+JiBf
X3kpCiAgICB7IHJldHVybiAhKF9feCA9PSBfX3kpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj4oY29uc3Qg
ZGVxdWU8X1RwLCBfQWxsb2M+JiBfX3gsCiAgICAgICBjb25zdCBkZXF1ZTxfVHAsIF9BbGxvYz4m
IF9feSkKICAgIHsgcmV0dXJuIF9feSA8IF9feDsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1Rw
LCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I8PShjb25zdCBk
ZXF1ZTxfVHAsIF9BbGxvYz4mIF9feCwKICAgICAgICBjb25zdCBkZXF1ZTxfVHAsIF9BbGxvYz4m
IF9feSkKICAgIHsgcmV0dXJuICEoX195IDwgX194KTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I+PShjb25z
dCBkZXF1ZTxfVHAsIF9BbGxvYz4mIF9feCwKICAgICAgICBjb25zdCBkZXF1ZTxfVHAsIF9BbGxv
Yz4mIF9feSkKICAgIHsgcmV0dXJuICEoX194IDwgX195KTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgdm9pZAogICAgc3dhcChkZXF1ZTxf
VHAsX0FsbG9jPiYgX194LCBkZXF1ZTxfVHAsX0FsbG9jPiYgX195KQogICAgbm9leGNlcHQobm9l
eGNlcHQoX194LnN3YXAoX195KSkpCiAgICB7IF9feC5zd2FwKF9feSk7IH0KCgoKCn0KIyA2NSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9kZXF1ZSIgMiAzCgojIDEgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9kZXF1ZS50Y2MiIDEgMwojIDU5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvZGVxdWUudGNjIiAzCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0
eV9fICgiZGVmYXVsdCIpKSkKewoKCgogIHRlbXBsYXRlIDx0eXBlbmFtZSBfVHAsIHR5cGVuYW1l
IF9BbGxvYz4KICAgIHZvaWQKICAgIGRlcXVlPF9UcCwgX0FsbG9jPjo6CiAgICBfTV9kZWZhdWx0
X2luaXRpYWxpemUoKQogICAgewogICAgICBfTWFwX3BvaW50ZXIgX19jdXI7CiAgICAgIHRyeQog
ICAgICAgIHsKICAgICAgICAgIGZvciAoX19jdXIgPSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9N
X25vZGU7CiAgICAgICAgX19jdXIgPCB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9ub2RlOwog
ICAgICAgICsrX19jdXIpCiAgICAgICAgICAgIHN0ZDo6X191bmluaXRpYWxpemVkX2RlZmF1bHRf
YSgqX19jdXIsICpfX2N1ciArIF9TX2J1ZmZlcl9zaXplKCksCiAgICAgICAgX01fZ2V0X1RwX2Fs
bG9jYXRvcigpKTsKICAgICAgICAgIHN0ZDo6X191bmluaXRpYWxpemVkX2RlZmF1bHRfYSh0aGlz
LT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9maXJzdCwKICAgICAgdGhpcy0+X01faW1wbC5fTV9maW5p
c2guX01fY3VyLAogICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgICAgIH0KICAgICAg
Y2F0Y2goLi4uKQogICAgICAgIHsKICAgICAgICAgIHN0ZDo6X0Rlc3Ryb3kodGhpcy0+X01faW1w
bC5fTV9zdGFydCwgaXRlcmF0b3IoKl9fY3VyLCBfX2N1ciksCiAgIF9NX2dldF9UcF9hbGxvY2F0
b3IoKSk7CiAgICAgICAgICB0aHJvdzsKICAgICAgICB9CiAgICB9CgoKICB0ZW1wbGF0ZSA8dHlw
ZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBkZXF1ZTxfVHAsIF9BbGxvYz4mCiAgICBk
ZXF1ZTxfVHAsIF9BbGxvYz46OgogICAgb3BlcmF0b3I9KGNvbnN0IGRlcXVlJiBfX3gpCiAgICB7
CiAgICAgIGlmICgmX194ICE9IHRoaXMpCiB7CgogICBpZiAoX0FsbG9jX3RyYWl0czo6X1NfcHJv
cGFnYXRlX29uX2NvcHlfYXNzaWduKCkpCiAgICAgewogICAgICAgaWYgKCFfQWxsb2NfdHJhaXRz
OjpfU19hbHdheXNfZXF1YWwoKQogICAgICAgICAgICYmIF9NX2dldF9UcF9hbGxvY2F0b3IoKSAh
PSBfX3guX01fZ2V0X1RwX2FsbG9jYXRvcigpKQogICAgICAgICB7CgoKICAgIF9NX3JlcGxhY2Vf
bWFwKF9feCwgX194LmdldF9hbGxvY2F0b3IoKSk7CiAgICBzdGQ6Ol9fYWxsb2Nfb25fY29weShf
TV9nZXRfVHBfYWxsb2NhdG9yKCksCiAgICAgICAgICAgX194Ll9NX2dldF9UcF9hbGxvY2F0b3Io
KSk7CiAgICByZXR1cm4gKnRoaXM7CiAgfQogICAgICAgc3RkOjpfX2FsbG9jX29uX2NvcHkoX01f
Z2V0X1RwX2FsbG9jYXRvcigpLAogICAgICAgX194Ll9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAg
ICAgfQoKICAgY29uc3Qgc2l6ZV90eXBlIF9fbGVuID0gc2l6ZSgpOwogICBpZiAoX19sZW4gPj0g
X194LnNpemUoKSkKICAgICBfTV9lcmFzZV9hdF9lbmQoc3RkOjpjb3B5KF9feC5iZWdpbigpLCBf
X3guZW5kKCksCiAgICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0KSk7CiAgIGVsc2UKICAg
ICB7CiAgICAgICBjb25zdF9pdGVyYXRvciBfX21pZCA9IF9feC5iZWdpbigpICsgZGlmZmVyZW5j
ZV90eXBlKF9fbGVuKTsKICAgICAgIHN0ZDo6Y29weShfX3guYmVnaW4oKSwgX19taWQsIHRoaXMt
Pl9NX2ltcGwuX01fc3RhcnQpOwogICAgICAgaW5zZXJ0KHRoaXMtPl9NX2ltcGwuX01fZmluaXNo
LCBfX21pZCwgX194LmVuZCgpKTsKICAgICB9CiB9CiAgICAgIHJldHVybiAqdGhpczsKICAgIH0K
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdGVtcGxhdGU8
dHlwZW5hbWUuLi4gX0FyZ3M+CiAgICAgIHZvaWQKICAgICAgZGVxdWU8X1RwLCBfQWxsb2M+OjoK
ICAgICAgZW1wbGFjZV9mcm9udChfQXJncyYmLi4uIF9fYXJncykKICAgICAgewogaWYgKHRoaXMt
Pl9NX2ltcGwuX01fc3RhcnQuX01fY3VyICE9IHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fZmly
c3QpCiAgIHsKICAgICBfQWxsb2NfdHJhaXRzOjpjb25zdHJ1Y3QodGhpcy0+X01faW1wbCwKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9jdXIg
LSAxLAogICAgICAgICAgICAgICAgc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsKICAg
ICAtLXRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fY3VyOwogICB9CiBlbHNlCiAgIF9NX3B1c2hf
ZnJvbnRfYXV4KHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLik7CiAgICAgIH0KCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZS4uLiBfQXJncz4KICAgICAgdm9pZAogICAgICBkZXF1ZTxfVHAsIF9BbGxvYz46OgogICAgICBl
bXBsYWNlX2JhY2soX0FyZ3MmJi4uLiBfX2FyZ3MpCiAgICAgIHsKIGlmICh0aGlzLT5fTV9pbXBs
Ll9NX2ZpbmlzaC5fTV9jdXIKICAgICAhPSB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9sYXN0
IC0gMSkKICAgewogICAgIF9BbGxvY190cmFpdHM6OmNvbnN0cnVjdCh0aGlzLT5fTV9pbXBsLAog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9j
dXIsCiAgICAgICAgICAgICAgICBzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pOwogICAg
ICsrdGhpcy0+X01faW1wbC5fTV9maW5pc2guX01fY3VyOwogICB9CiBlbHNlCiAgIF9NX3B1c2hf
YmFja19hdXgoc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsKICAgICAgfQoKCgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdGVtcGxhdGU8dHlwZW5h
bWUuLi4gX0FyZ3M+CiAgICAgIHR5cGVuYW1lIGRlcXVlPF9UcCwgX0FsbG9jPjo6aXRlcmF0b3IK
ICAgICAgZGVxdWU8X1RwLCBfQWxsb2M+OjoKICAgICAgZW1wbGFjZShjb25zdF9pdGVyYXRvciBf
X3Bvc2l0aW9uLCBfQXJncyYmLi4uIF9fYXJncykKICAgICAgewogaWYgKF9fcG9zaXRpb24uX01f
Y3VyID09IHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fY3VyKQogICB7CiAgICAgZW1wbGFjZV9m
cm9udChzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pOwogICAgIHJldHVybiB0aGlzLT5f
TV9pbXBsLl9NX3N0YXJ0OwogICB9CiBlbHNlIGlmIChfX3Bvc2l0aW9uLl9NX2N1ciA9PSB0aGlz
LT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9jdXIpCiAgIHsKICAgICBlbXBsYWNlX2JhY2soc3RkOjpm
b3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsKICAgICBpdGVyYXRvciBfX3RtcCA9IHRoaXMtPl9N
X2ltcGwuX01fZmluaXNoOwogICAgIC0tX190bXA7CiAgICAgcmV0dXJuIF9fdG1wOwogICB9CiBl
bHNlCiAgIHJldHVybiBfTV9pbnNlcnRfYXV4KF9fcG9zaXRpb24uX01fY29uc3RfY2FzdCgpLAog
ICAgICAgICAgc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsKICAgICAgfQoKCiAgdGVt
cGxhdGUgPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdHlwZW5hbWUgZGVxdWU8
X1RwLCBfQWxsb2M+OjppdGVyYXRvcgogICAgZGVxdWU8X1RwLCBfQWxsb2M+OjoKCiAgICBpbnNl
cnQoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgY29uc3QgdmFsdWVfdHlwZSYgX194KQoKCgog
ICAgewogICAgICBpZiAoX19wb3NpdGlvbi5fTV9jdXIgPT0gdGhpcy0+X01faW1wbC5fTV9zdGFy
dC5fTV9jdXIpCiB7CiAgIHB1c2hfZnJvbnQoX194KTsKICAgcmV0dXJuIHRoaXMtPl9NX2ltcGwu
X01fc3RhcnQ7CiB9CiAgICAgIGVsc2UgaWYgKF9fcG9zaXRpb24uX01fY3VyID09IHRoaXMtPl9N
X2ltcGwuX01fZmluaXNoLl9NX2N1cikKIHsKICAgcHVzaF9iYWNrKF9feCk7CiAgIGl0ZXJhdG9y
IF9fdG1wID0gdGhpcy0+X01faW1wbC5fTV9maW5pc2g7CiAgIC0tX190bXA7CiAgIHJldHVybiBf
X3RtcDsKIH0KICAgICAgZWxzZQogcmV0dXJuIF9NX2luc2VydF9hdXgoX19wb3NpdGlvbi5fTV9j
b25zdF9jYXN0KCksIF9feCk7CiAgIH0KCiAgdGVtcGxhdGUgPHR5cGVuYW1lIF9UcCwgdHlwZW5h
bWUgX0FsbG9jPgogICAgdHlwZW5hbWUgZGVxdWU8X1RwLCBfQWxsb2M+OjppdGVyYXRvcgogICAg
ZGVxdWU8X1RwLCBfQWxsb2M+OjoKICAgIF9NX2VyYXNlKGl0ZXJhdG9yIF9fcG9zaXRpb24pCiAg
ICB7CiAgICAgIGl0ZXJhdG9yIF9fbmV4dCA9IF9fcG9zaXRpb247CiAgICAgICsrX19uZXh0Owog
ICAgICBjb25zdCBkaWZmZXJlbmNlX3R5cGUgX19pbmRleCA9IF9fcG9zaXRpb24gLSBiZWdpbigp
OwogICAgICBpZiAoc3RhdGljX2Nhc3Q8c2l6ZV90eXBlPihfX2luZGV4KSA8IChzaXplKCkgPj4g
MSkpCiB7CiAgIGlmIChfX3Bvc2l0aW9uICE9IGJlZ2luKCkpCiAgICAgc3RkOjptb3ZlX2JhY2t3
YXJkKGJlZ2luKCksIF9fcG9zaXRpb24sIF9fbmV4dCk7CiAgIHBvcF9mcm9udCgpOwogfQogICAg
ICBlbHNlCiB7CiAgIGlmIChfX25leHQgIT0gZW5kKCkpCiAgICAgc3RkOjptb3ZlKF9fbmV4dCwg
ZW5kKCksIF9fcG9zaXRpb24pOwogICBwb3BfYmFjaygpOwogfQogICAgICByZXR1cm4gYmVnaW4o
KSArIF9faW5kZXg7CiAgICB9CgogIHRlbXBsYXRlIDx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9B
bGxvYz4KICAgIHR5cGVuYW1lIGRlcXVlPF9UcCwgX0FsbG9jPjo6aXRlcmF0b3IKICAgIGRlcXVl
PF9UcCwgX0FsbG9jPjo6CiAgICBfTV9lcmFzZShpdGVyYXRvciBfX2ZpcnN0LCBpdGVyYXRvciBf
X2xhc3QpCiAgICB7CiAgICAgIGlmIChfX2ZpcnN0ID09IF9fbGFzdCkKIHJldHVybiBfX2ZpcnN0
OwogICAgICBlbHNlIGlmIChfX2ZpcnN0ID09IGJlZ2luKCkgJiYgX19sYXN0ID09IGVuZCgpKQog
ewogICBjbGVhcigpOwogICByZXR1cm4gZW5kKCk7CiB9CiAgICAgIGVsc2UKIHsKICAgY29uc3Qg
ZGlmZmVyZW5jZV90eXBlIF9fbiA9IF9fbGFzdCAtIF9fZmlyc3Q7CiAgIGNvbnN0IGRpZmZlcmVu
Y2VfdHlwZSBfX2VsZW1zX2JlZm9yZSA9IF9fZmlyc3QgLSBiZWdpbigpOwogICBpZiAoc3RhdGlj
X2Nhc3Q8c2l6ZV90eXBlPihfX2VsZW1zX2JlZm9yZSkgPD0gKHNpemUoKSAtIF9fbikgLyAyKQog
ICAgIHsKICAgICAgIGlmIChfX2ZpcnN0ICE9IGJlZ2luKCkpCiAgc3RkOjptb3ZlX2JhY2t3YXJk
KGJlZ2luKCksIF9fZmlyc3QsIF9fbGFzdCk7CiAgICAgICBfTV9lcmFzZV9hdF9iZWdpbihiZWdp
bigpICsgX19uKTsKICAgICB9CiAgIGVsc2UKICAgICB7CiAgICAgICBpZiAoX19sYXN0ICE9IGVu
ZCgpKQogIHN0ZDo6bW92ZShfX2xhc3QsIGVuZCgpLCBfX2ZpcnN0KTsKICAgICAgIF9NX2VyYXNl
X2F0X2VuZChlbmQoKSAtIF9fbik7CiAgICAgfQogICByZXR1cm4gYmVnaW4oKSArIF9fZWxlbXNf
YmVmb3JlOwogfQogICAgfQoKICB0ZW1wbGF0ZSA8dHlwZW5hbWUgX1RwLCBjbGFzcyBfQWxsb2M+
CiAgICB0ZW1wbGF0ZSA8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3I+CiAgICAgIHZvaWQKICAgICAg
ZGVxdWU8X1RwLCBfQWxsb2M+OjoKICAgICAgX01fYXNzaWduX2F1eChfSW5wdXRJdGVyYXRvciBf
X2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QsCiAgICAgIHN0ZDo6aW5wdXRfaXRlcmF0b3Jf
dGFnKQogICAgICB7CiAgICAgICAgaXRlcmF0b3IgX19jdXIgPSBiZWdpbigpOwogICAgICAgIGZv
ciAoOyBfX2ZpcnN0ICE9IF9fbGFzdCAmJiBfX2N1ciAhPSBlbmQoKTsgKytfX2N1ciwgKytfX2Zp
cnN0KQogICAgICAgICAgKl9fY3VyID0gKl9fZmlyc3Q7CiAgICAgICAgaWYgKF9fZmlyc3QgPT0g
X19sYXN0KQogICAgICAgICAgX01fZXJhc2VfYXRfZW5kKF9fY3VyKTsKICAgICAgICBlbHNlCiAg
ICAgICAgICBpbnNlcnQoZW5kKCksIF9fZmlyc3QsIF9fbGFzdCk7CiAgICAgIH0KCiAgdGVtcGxh
dGUgPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdm9pZAogICAgZGVxdWU8X1Rw
LCBfQWxsb2M+OjoKICAgIF9NX2ZpbGxfaW5zZXJ0KGl0ZXJhdG9yIF9fcG9zLCBzaXplX3R5cGUg
X19uLCBjb25zdCB2YWx1ZV90eXBlJiBfX3gpCiAgICB7CiAgICAgIGlmIChfX3Bvcy5fTV9jdXIg
PT0gdGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9jdXIpCiB7CiAgIGl0ZXJhdG9yIF9fbmV3X3N0
YXJ0ID0gX01fcmVzZXJ2ZV9lbGVtZW50c19hdF9mcm9udChfX24pOwogICB0cnkKICAgICB7CiAg
ICAgICBzdGQ6Ol9fdW5pbml0aWFsaXplZF9maWxsX2EoX19uZXdfc3RhcnQsIHRoaXMtPl9NX2lt
cGwuX01fc3RhcnQsCiAgICAgICBfX3gsIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgICB0
aGlzLT5fTV9pbXBsLl9NX3N0YXJ0ID0gX19uZXdfc3RhcnQ7CiAgICAgfQogICBjYXRjaCguLi4p
CiAgICAgewogICAgICAgX01fZGVzdHJveV9ub2RlcyhfX25ld19zdGFydC5fTV9ub2RlLAogICAg
ICAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9ub2RlKTsKICAgICAgIHRocm93OwogICAg
IH0KIH0KICAgICAgZWxzZSBpZiAoX19wb3MuX01fY3VyID09IHRoaXMtPl9NX2ltcGwuX01fZmlu
aXNoLl9NX2N1cikKIHsKICAgaXRlcmF0b3IgX19uZXdfZmluaXNoID0gX01fcmVzZXJ2ZV9lbGVt
ZW50c19hdF9iYWNrKF9fbik7CiAgIHRyeQogICAgIHsKICAgICAgIHN0ZDo6X191bmluaXRpYWxp
emVkX2ZpbGxfYSh0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAgICAgIF9fbmV3X2ZpbmlzaCwg
X194LAogICAgICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICAgICAgIHRoaXMtPl9NX2ltcGwu
X01fZmluaXNoID0gX19uZXdfZmluaXNoOwogICAgIH0KICAgY2F0Y2goLi4uKQogICAgIHsKICAg
ICAgIF9NX2Rlc3Ryb3lfbm9kZXModGhpcy0+X01faW1wbC5fTV9maW5pc2guX01fbm9kZSArIDEs
CiAgICAgICAgICBfX25ld19maW5pc2guX01fbm9kZSArIDEpOwogICAgICAgdGhyb3c7CiAgICAg
fQogfQogICAgICBlbHNlCiAgICAgICAgX01faW5zZXJ0X2F1eChfX3BvcywgX19uLCBfX3gpOwog
ICAgfQoKCiAgdGVtcGxhdGUgPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdm9p
ZAogICAgZGVxdWU8X1RwLCBfQWxsb2M+OjoKICAgIF9NX2RlZmF1bHRfYXBwZW5kKHNpemVfdHlw
ZSBfX24pCiAgICB7CiAgICAgIGlmIChfX24pCiB7CiAgIGl0ZXJhdG9yIF9fbmV3X2ZpbmlzaCA9
IF9NX3Jlc2VydmVfZWxlbWVudHNfYXRfYmFjayhfX24pOwogICB0cnkKICAgICB7CiAgICAgICBz
dGQ6Ol9fdW5pbml0aWFsaXplZF9kZWZhdWx0X2EodGhpcy0+X01faW1wbC5fTV9maW5pc2gsCiAg
ICAgICAgICBfX25ld19maW5pc2gsCiAgICAgICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwog
ICAgICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2ggPSBfX25ld19maW5pc2g7CiAgICAgfQogICBj
YXRjaCguLi4pCiAgICAgewogICAgICAgX01fZGVzdHJveV9ub2Rlcyh0aGlzLT5fTV9pbXBsLl9N
X2ZpbmlzaC5fTV9ub2RlICsgMSwKICAgICAgICAgIF9fbmV3X2ZpbmlzaC5fTV9ub2RlICsgMSk7
CiAgICAgICB0aHJvdzsKICAgICB9CiB9CiAgICB9CgogIHRlbXBsYXRlIDx0eXBlbmFtZSBfVHAs
IHR5cGVuYW1lIF9BbGxvYz4KICAgIGJvb2wKICAgIGRlcXVlPF9UcCwgX0FsbG9jPjo6CiAgICBf
TV9zaHJpbmtfdG9fZml0KCkKICAgIHsKICAgICAgY29uc3QgZGlmZmVyZW5jZV90eXBlIF9fZnJv
bnRfY2FwYWNpdHkKID0gKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fY3VyIC0gdGhpcy0+X01f
aW1wbC5fTV9zdGFydC5fTV9maXJzdCk7CiAgICAgIGlmIChfX2Zyb250X2NhcGFjaXR5ID09IDAp
CiByZXR1cm4gZmFsc2U7CgogICAgICBjb25zdCBkaWZmZXJlbmNlX3R5cGUgX19iYWNrX2NhcGFj
aXR5CiA9ICh0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9sYXN0IC0gdGhpcy0+X01faW1wbC5f
TV9maW5pc2guX01fY3VyKTsKICAgICAgaWYgKF9fZnJvbnRfY2FwYWNpdHkgKyBfX2JhY2tfY2Fw
YWNpdHkgPCBfU19idWZmZXJfc2l6ZSgpKQogcmV0dXJuIGZhbHNlOwoKICAgICAgcmV0dXJuIHN0
ZDo6X19zaHJpbmtfdG9fZml0X2F1eDxkZXF1ZT46Ol9TX2RvX2l0KCp0aGlzKTsKICAgIH0KCgog
IHRlbXBsYXRlIDx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHZvaWQKICAgIGRl
cXVlPF9UcCwgX0FsbG9jPjo6CiAgICBfTV9maWxsX2luaXRpYWxpemUoY29uc3QgdmFsdWVfdHlw
ZSYgX192YWx1ZSkKICAgIHsKICAgICAgX01hcF9wb2ludGVyIF9fY3VyOwogICAgICB0cnkKICAg
ICAgICB7CiAgICAgICAgICBmb3IgKF9fY3VyID0gdGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9u
b2RlOwogICAgICAgIF9fY3VyIDwgdGhpcy0+X01faW1wbC5fTV9maW5pc2guX01fbm9kZTsKICAg
ICAgICArK19fY3VyKQogICAgICAgICAgICBzdGQ6Ol9fdW5pbml0aWFsaXplZF9maWxsX2EoKl9f
Y3VyLCAqX19jdXIgKyBfU19idWZmZXJfc2l6ZSgpLAogICAgIF9fdmFsdWUsIF9NX2dldF9UcF9h
bGxvY2F0b3IoKSk7CiAgICAgICAgICBzdGQ6Ol9fdW5pbml0aWFsaXplZF9maWxsX2EodGhpcy0+
X01faW1wbC5fTV9maW5pc2guX01fZmlyc3QsCiAgICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2Zp
bmlzaC5fTV9jdXIsCiAgICAgICAgICBfX3ZhbHVlLCBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwog
ICAgICAgIH0KICAgICAgY2F0Y2goLi4uKQogICAgICAgIHsKICAgICAgICAgIHN0ZDo6X0Rlc3Ry
b3kodGhpcy0+X01faW1wbC5fTV9zdGFydCwgaXRlcmF0b3IoKl9fY3VyLCBfX2N1ciksCiAgIF9N
X2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgICAgICB0aHJvdzsKICAgICAgICB9CiAgICB9Cgog
IHRlbXBsYXRlIDx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHRlbXBsYXRlIDx0
eXBlbmFtZSBfSW5wdXRJdGVyYXRvcj4KICAgICAgdm9pZAogICAgICBkZXF1ZTxfVHAsIF9BbGxv
Yz46OgogICAgICBfTV9yYW5nZV9pbml0aWFsaXplKF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9J
bnB1dEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OmlucHV0
X2l0ZXJhdG9yX3RhZykKICAgICAgewogICAgICAgIHRoaXMtPl9NX2luaXRpYWxpemVfbWFwKDAp
OwogICAgICAgIHRyeQogICAgICAgICAgewogICAgICAgICAgICBmb3IgKDsgX19maXJzdCAhPSBf
X2xhc3Q7ICsrX19maXJzdCkKCiAgICAgICBlbXBsYWNlX2JhY2soKl9fZmlyc3QpOwoKCgogICAg
ICAgICAgfQogICAgICAgIGNhdGNoKC4uLikKICAgICAgICAgIHsKICAgICAgICAgICAgY2xlYXIo
KTsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICB9CiAgICAgIH0KCiAgdGVtcGxhdGUgPHR5
cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdGVtcGxhdGUgPHR5cGVuYW1lIF9Gb3J3
YXJkSXRlcmF0b3I+CiAgICAgIHZvaWQKICAgICAgZGVxdWU8X1RwLCBfQWxsb2M+OjoKICAgICAg
X01fcmFuZ2VfaW5pdGlhbGl6ZShfRm9yd2FyZEl0ZXJhdG9yIF9fZmlyc3QsIF9Gb3J3YXJkSXRl
cmF0b3IgX19sYXN0LAogICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZDo6Zm9yd2FyZF9pdGVy
YXRvcl90YWcpCiAgICAgIHsKICAgICAgICBjb25zdCBzaXplX3R5cGUgX19uID0gc3RkOjpkaXN0
YW5jZShfX2ZpcnN0LCBfX2xhc3QpOwogICAgICAgIHRoaXMtPl9NX2luaXRpYWxpemVfbWFwKF9f
bik7CgogICAgICAgIF9NYXBfcG9pbnRlciBfX2N1cl9ub2RlOwogICAgICAgIHRyeQogICAgICAg
ICAgewogICAgICAgICAgICBmb3IgKF9fY3VyX25vZGUgPSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0
Ll9NX25vZGU7CiAgICAgICAgICAgICAgICAgX19jdXJfbm9kZSA8IHRoaXMtPl9NX2ltcGwuX01f
ZmluaXNoLl9NX25vZGU7CiAgICAgICAgICAgICAgICAgKytfX2N1cl9ub2RlKQogICAgICAgewog
IF9Gb3J3YXJkSXRlcmF0b3IgX19taWQgPSBfX2ZpcnN0OwogIHN0ZDo6YWR2YW5jZShfX21pZCwg
X1NfYnVmZmVyX3NpemUoKSk7CiAgc3RkOjpfX3VuaW5pdGlhbGl6ZWRfY29weV9hKF9fZmlyc3Qs
IF9fbWlkLCAqX19jdXJfbm9kZSwKICAgICAgICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICBf
X2ZpcnN0ID0gX19taWQ7CiAgICAgICB9CiAgICAgICAgICAgIHN0ZDo6X191bmluaXRpYWxpemVk
X2NvcHlfYShfX2ZpcnN0LCBfX2xhc3QsCiAgICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2guX01f
Zmlyc3QsCiAgICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICAgICAgICAgIH0KICAgICAgICBj
YXRjaCguLi4pCiAgICAgICAgICB7CiAgICAgICAgICAgIHN0ZDo6X0Rlc3Ryb3kodGhpcy0+X01f
aW1wbC5fTV9zdGFydCwKICAgICBpdGVyYXRvcigqX19jdXJfbm9kZSwgX19jdXJfbm9kZSksCiAg
ICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICAgICAgICAgICAgdGhyb3c7CiAgICAgICAgICB9
CiAgICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgoKICAg
IHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogICAgICB2b2lkCiAgICAgIGRlcXVlPF9UcCwg
X0FsbG9jPjo6CiAgICAgIF9NX3B1c2hfYmFja19hdXgoX0FyZ3MmJi4uLiBfX2FyZ3MpCgoKCgoK
ICAgICAgewogX01fcmVzZXJ2ZV9tYXBfYXRfYmFjaygpOwogKih0aGlzLT5fTV9pbXBsLl9NX2Zp
bmlzaC5fTV9ub2RlICsgMSkgPSB0aGlzLT5fTV9hbGxvY2F0ZV9ub2RlKCk7CiB0cnkKICAgewoK
ICAgICBfQWxsb2NfdHJhaXRzOjpjb25zdHJ1Y3QodGhpcy0+X01faW1wbCwKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2guX01fY3VyLAogICAgICAg
ICAgICAgICAgc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsKCgoKICAgICB0aGlzLT5f
TV9pbXBsLl9NX2ZpbmlzaC5fTV9zZXRfbm9kZSh0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9u
b2RlCiAgICAgICsgMSk7CiAgICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2guX01fY3VyID0gdGhp
cy0+X01faW1wbC5fTV9maW5pc2guX01fZmlyc3Q7CiAgIH0KIGNhdGNoKC4uLikKICAgewogICAg
IF9NX2RlYWxsb2NhdGVfbm9kZSgqKHRoaXMtPl9NX2ltcGwuX01fZmluaXNoLl9NX25vZGUgKyAx
KSk7CiAgICAgdGhyb3c7CiAgIH0KICAgICAgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwLCB0
eXBlbmFtZSBfQWxsb2M+CgogICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX0FyZ3M+CiAgICAgIHZv
aWQKICAgICAgZGVxdWU8X1RwLCBfQWxsb2M+OjoKICAgICAgX01fcHVzaF9mcm9udF9hdXgoX0Fy
Z3MmJi4uLiBfX2FyZ3MpCgoKCgoKICAgICAgewogX01fcmVzZXJ2ZV9tYXBfYXRfZnJvbnQoKTsK
ICoodGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9ub2RlIC0gMSkgPSB0aGlzLT5fTV9hbGxvY2F0
ZV9ub2RlKCk7CiB0cnkKICAgewogICAgIHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fc2V0X25v
ZGUodGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9ub2RlCiAgICAgICAgICAgIC0gMSk7CiAgICAg
dGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9jdXIgPSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9N
X2xhc3QgLSAxOwoKICAgICBfQWxsb2NfdHJhaXRzOjpjb25zdHJ1Y3QodGhpcy0+X01faW1wbCwK
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9j
dXIsCiAgICAgICAgICAgICAgICBzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncykuLi4pOwoKCgog
ICB9CiBjYXRjaCguLi4pCiAgIHsKICAgICArK3RoaXMtPl9NX2ltcGwuX01fc3RhcnQ7CiAgICAg
X01fZGVhbGxvY2F0ZV9ub2RlKCoodGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9ub2RlIC0gMSkp
OwogICAgIHRocm93OwogICB9CiAgICAgIH0KCgogIHRlbXBsYXRlIDx0eXBlbmFtZSBfVHAsIHR5
cGVuYW1lIF9BbGxvYz4KICAgIHZvaWQgZGVxdWU8X1RwLCBfQWxsb2M+OjoKICAgIF9NX3BvcF9i
YWNrX2F1eCgpCiAgICB7CiAgICAgIF9NX2RlYWxsb2NhdGVfbm9kZSh0aGlzLT5fTV9pbXBsLl9N
X2ZpbmlzaC5fTV9maXJzdCk7CiAgICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoLl9NX3NldF9u
b2RlKHRoaXMtPl9NX2ltcGwuX01fZmluaXNoLl9NX25vZGUgLSAxKTsKICAgICAgdGhpcy0+X01f
aW1wbC5fTV9maW5pc2guX01fY3VyID0gdGhpcy0+X01faW1wbC5fTV9maW5pc2guX01fbGFzdCAt
IDE7CiAgICAgIF9BbGxvY190cmFpdHM6OmRlc3Ryb3koX01fZ2V0X1RwX2FsbG9jYXRvcigpLAog
ICAgICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoLl9NX2N1cik7CiAgICB9CgoKCgoKCiAgdGVt
cGxhdGUgPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdm9pZCBkZXF1ZTxfVHAs
IF9BbGxvYz46OgogICAgX01fcG9wX2Zyb250X2F1eCgpCiAgICB7CiAgICAgIF9BbGxvY190cmFp
dHM6OmRlc3Ryb3koX01fZ2V0X1RwX2FsbG9jYXRvcigpLAogICAgICAgIHRoaXMtPl9NX2ltcGwu
X01fc3RhcnQuX01fY3VyKTsKICAgICAgX01fZGVhbGxvY2F0ZV9ub2RlKHRoaXMtPl9NX2ltcGwu
X01fc3RhcnQuX01fZmlyc3QpOwogICAgICB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9NX3NldF9u
b2RlKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fbm9kZSArIDEpOwogICAgICB0aGlzLT5fTV9p
bXBsLl9NX3N0YXJ0Ll9NX2N1ciA9IHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fZmlyc3Q7CiAg
ICB9CgogIHRlbXBsYXRlIDx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHRlbXBs
YXRlIDx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcj4KICAgICAgdm9pZAogICAgICBkZXF1ZTxfVHAs
IF9BbGxvYz46OgogICAgICBfTV9yYW5nZV9pbnNlcnRfYXV4KGl0ZXJhdG9yIF9fcG9zLAogICAg
ICAgICAgICAgICAgICAgICAgICAgIF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJh
dG9yIF9fbGFzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICBzdGQ6OmlucHV0X2l0ZXJhdG9y
X3RhZykKICAgICAgeyBzdGQ6OmNvcHkoX19maXJzdCwgX19sYXN0LCBzdGQ6Omluc2VydGVyKCp0
aGlzLCBfX3BvcykpOyB9CgogIHRlbXBsYXRlIDx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxv
Yz4KICAgIHRlbXBsYXRlIDx0eXBlbmFtZSBfRm9yd2FyZEl0ZXJhdG9yPgogICAgICB2b2lkCiAg
ICAgIGRlcXVlPF9UcCwgX0FsbG9jPjo6CiAgICAgIF9NX3JhbmdlX2luc2VydF9hdXgoaXRlcmF0
b3IgX19wb3MsCiAgICAgICAgICAgICAgICAgICAgICAgICAgX0ZvcndhcmRJdGVyYXRvciBfX2Zp
cnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgICAgICAgICAgICAgICAgICAgICBz
dGQ6OmZvcndhcmRfaXRlcmF0b3JfdGFnKQogICAgICB7CiAgICAgICAgY29uc3Qgc2l6ZV90eXBl
IF9fbiA9IHN0ZDo6ZGlzdGFuY2UoX19maXJzdCwgX19sYXN0KTsKICAgICAgICBpZiAoX19wb3Mu
X01fY3VyID09IHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fY3VyKQogICB7CiAgICAgaXRlcmF0
b3IgX19uZXdfc3RhcnQgPSBfTV9yZXNlcnZlX2VsZW1lbnRzX2F0X2Zyb250KF9fbik7CiAgICAg
dHJ5CiAgICAgICB7CiAgc3RkOjpfX3VuaW5pdGlhbGl6ZWRfY29weV9hKF9fZmlyc3QsIF9fbGFz
dCwgX19uZXdfc3RhcnQsCiAgICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgdGhpcy0+
X01faW1wbC5fTV9zdGFydCA9IF9fbmV3X3N0YXJ0OwogICAgICAgfQogICAgIGNhdGNoKC4uLikK
ICAgICAgIHsKICBfTV9kZXN0cm95X25vZGVzKF9fbmV3X3N0YXJ0Ll9NX25vZGUsCiAgICAgdGhp
cy0+X01faW1wbC5fTV9zdGFydC5fTV9ub2RlKTsKICB0aHJvdzsKICAgICAgIH0KICAgfQogICAg
ICAgIGVsc2UgaWYgKF9fcG9zLl9NX2N1ciA9PSB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9j
dXIpCiAgIHsKICAgICBpdGVyYXRvciBfX25ld19maW5pc2ggPSBfTV9yZXNlcnZlX2VsZW1lbnRz
X2F0X2JhY2soX19uKTsKICAgICB0cnkKICAgICAgIHsKICBzdGQ6Ol9fdW5pbml0aWFsaXplZF9j
b3B5X2EoX19maXJzdCwgX19sYXN0LAogICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwK
ICAgICAgICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICB0aGlzLT5fTV9pbXBsLl9NX2Zpbmlz
aCA9IF9fbmV3X2ZpbmlzaDsKICAgICAgIH0KICAgICBjYXRjaCguLi4pCiAgICAgICB7CiAgX01f
ZGVzdHJveV9ub2Rlcyh0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5fTV9ub2RlICsgMSwKICAgICBf
X25ld19maW5pc2guX01fbm9kZSArIDEpOwogIHRocm93OwogICAgICAgfQogICB9CiAgICAgICAg
ZWxzZQogICAgICAgICAgX01faW5zZXJ0X2F1eChfX3BvcywgX19maXJzdCwgX19sYXN0LCBfX24p
OwogICAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgoKICAg
IHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogICAgICB0eXBlbmFtZSBkZXF1ZTxfVHAsIF9B
bGxvYz46Oml0ZXJhdG9yCiAgICAgIGRlcXVlPF9UcCwgX0FsbG9jPjo6CiAgICAgIF9NX2luc2Vy
dF9hdXgoaXRlcmF0b3IgX19wb3MsIF9BcmdzJiYuLi4gX19hcmdzKQogICAgICB7CiB2YWx1ZV90
eXBlIF9feF9jb3B5KHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLik7CgoKCgoKCgogZGlm
ZmVyZW5jZV90eXBlIF9faW5kZXggPSBfX3BvcyAtIHRoaXMtPl9NX2ltcGwuX01fc3RhcnQ7CiBp
ZiAoc3RhdGljX2Nhc3Q8c2l6ZV90eXBlPihfX2luZGV4KSA8IHNpemUoKSAvIDIpCiAgIHsKICAg
ICBwdXNoX2Zyb250KHN0ZDo6bW92ZShmcm9udCgpKSk7CiAgICAgaXRlcmF0b3IgX19mcm9udDEg
PSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0OwogICAgICsrX19mcm9udDE7CiAgICAgaXRlcmF0b3Ig
X19mcm9udDIgPSBfX2Zyb250MTsKICAgICArK19fZnJvbnQyOwogICAgIF9fcG9zID0gdGhpcy0+
X01faW1wbC5fTV9zdGFydCArIF9faW5kZXg7CiAgICAgaXRlcmF0b3IgX19wb3MxID0gX19wb3M7
CiAgICAgKytfX3BvczE7CiAgICAgc3RkOjptb3ZlKF9fZnJvbnQyLCBfX3BvczEsIF9fZnJvbnQx
KTsKICAgfQogZWxzZQogICB7CiAgICAgcHVzaF9iYWNrKHN0ZDo6bW92ZShiYWNrKCkpKTsKICAg
ICBpdGVyYXRvciBfX2JhY2sxID0gdGhpcy0+X01faW1wbC5fTV9maW5pc2g7CiAgICAgLS1fX2Jh
Y2sxOwogICAgIGl0ZXJhdG9yIF9fYmFjazIgPSBfX2JhY2sxOwogICAgIC0tX19iYWNrMjsKICAg
ICBfX3BvcyA9IHRoaXMtPl9NX2ltcGwuX01fc3RhcnQgKyBfX2luZGV4OwogICAgIHN0ZDo6bW92
ZV9iYWNrd2FyZChfX3BvcywgX19iYWNrMiwgX19iYWNrMSk7CiAgIH0KICpfX3BvcyA9IHN0ZDo6
bW92ZShfX3hfY29weSk7CiByZXR1cm4gX19wb3M7CiAgICAgIH0KCiAgdGVtcGxhdGUgPHR5cGVu
YW1lIF9UcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdm9pZAogICAgZGVxdWU8X1RwLCBfQWxsb2M+
OjoKICAgIF9NX2luc2VydF9hdXgoaXRlcmF0b3IgX19wb3MsIHNpemVfdHlwZSBfX24sIGNvbnN0
IHZhbHVlX3R5cGUmIF9feCkKICAgIHsKICAgICAgY29uc3QgZGlmZmVyZW5jZV90eXBlIF9fZWxl
bXNfYmVmb3JlID0gX19wb3MgLSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0OwogICAgICBjb25zdCBz
aXplX3R5cGUgX19sZW5ndGggPSB0aGlzLT5zaXplKCk7CiAgICAgIHZhbHVlX3R5cGUgX194X2Nv
cHkgPSBfX3g7CiAgICAgIGlmIChfX2VsZW1zX2JlZm9yZSA8IGRpZmZlcmVuY2VfdHlwZShfX2xl
bmd0aCAvIDIpKQogewogICBpdGVyYXRvciBfX25ld19zdGFydCA9IF9NX3Jlc2VydmVfZWxlbWVu
dHNfYXRfZnJvbnQoX19uKTsKICAgaXRlcmF0b3IgX19vbGRfc3RhcnQgPSB0aGlzLT5fTV9pbXBs
Ll9NX3N0YXJ0OwogICBfX3BvcyA9IHRoaXMtPl9NX2ltcGwuX01fc3RhcnQgKyBfX2VsZW1zX2Jl
Zm9yZTsKICAgdHJ5CiAgICAgewogICAgICAgaWYgKF9fZWxlbXNfYmVmb3JlID49IGRpZmZlcmVu
Y2VfdHlwZShfX24pKQogIHsKICAgIGl0ZXJhdG9yIF9fc3RhcnRfbiA9ICh0aGlzLT5fTV9pbXBs
Ll9NX3N0YXJ0CiAgICAgKyBkaWZmZXJlbmNlX3R5cGUoX19uKSk7CiAgICBzdGQ6Ol9fdW5pbml0
aWFsaXplZF9tb3ZlX2EodGhpcy0+X01faW1wbC5fTV9zdGFydCwKICAgICAgICAgICBfX3N0YXJ0
X24sIF9fbmV3X3N0YXJ0LAogICAgICAgICAgIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICB0
aGlzLT5fTV9pbXBsLl9NX3N0YXJ0ID0gX19uZXdfc3RhcnQ7CiAgICBzdGQ6Om1vdmUoX19zdGFy
dF9uLCBfX3BvcywgX19vbGRfc3RhcnQpOwogICAgc3RkOjpmaWxsKF9fcG9zIC0gZGlmZmVyZW5j
ZV90eXBlKF9fbiksIF9fcG9zLCBfX3hfY29weSk7CiAgfQogICAgICAgZWxzZQogIHsKICAgIHN0
ZDo6X191bmluaXRpYWxpemVkX21vdmVfZmlsbCh0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0LAogICAg
ICAgX19wb3MsIF9fbmV3X3N0YXJ0LAogICAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydCwKICAg
ICAgIF9feF9jb3B5LAogICAgICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICAgIHRoaXMtPl9N
X2ltcGwuX01fc3RhcnQgPSBfX25ld19zdGFydDsKICAgIHN0ZDo6ZmlsbChfX29sZF9zdGFydCwg
X19wb3MsIF9feF9jb3B5KTsKICB9CiAgICAgfQogICBjYXRjaCguLi4pCiAgICAgewogICAgICAg
X01fZGVzdHJveV9ub2RlcyhfX25ld19zdGFydC5fTV9ub2RlLAogICAgICAgICAgdGhpcy0+X01f
aW1wbC5fTV9zdGFydC5fTV9ub2RlKTsKICAgICAgIHRocm93OwogICAgIH0KIH0KICAgICAgZWxz
ZQogewogICBpdGVyYXRvciBfX25ld19maW5pc2ggPSBfTV9yZXNlcnZlX2VsZW1lbnRzX2F0X2Jh
Y2soX19uKTsKICAgaXRlcmF0b3IgX19vbGRfZmluaXNoID0gdGhpcy0+X01faW1wbC5fTV9maW5p
c2g7CiAgIGNvbnN0IGRpZmZlcmVuY2VfdHlwZSBfX2VsZW1zX2FmdGVyID0KICAgICBkaWZmZXJl
bmNlX3R5cGUoX19sZW5ndGgpIC0gX19lbGVtc19iZWZvcmU7CiAgIF9fcG9zID0gdGhpcy0+X01f
aW1wbC5fTV9maW5pc2ggLSBfX2VsZW1zX2FmdGVyOwogICB0cnkKICAgICB7CiAgICAgICBpZiAo
X19lbGVtc19hZnRlciA+IGRpZmZlcmVuY2VfdHlwZShfX24pKQogIHsKICAgIGl0ZXJhdG9yIF9f
ZmluaXNoX24gPSAodGhpcy0+X01faW1wbC5fTV9maW5pc2gKICAgICAgLSBkaWZmZXJlbmNlX3R5
cGUoX19uKSk7CiAgICBzdGQ6Ol9fdW5pbml0aWFsaXplZF9tb3ZlX2EoX19maW5pc2hfbiwKICAg
ICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAgICAgICAgICB0aGlzLT5fTV9pbXBs
Ll9NX2ZpbmlzaCwKICAgICAgICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwogICAgdGhpcy0+
X01faW1wbC5fTV9maW5pc2ggPSBfX25ld19maW5pc2g7CiAgICBzdGQ6Om1vdmVfYmFja3dhcmQo
X19wb3MsIF9fZmluaXNoX24sIF9fb2xkX2ZpbmlzaCk7CiAgICBzdGQ6OmZpbGwoX19wb3MsIF9f
cG9zICsgZGlmZmVyZW5jZV90eXBlKF9fbiksIF9feF9jb3B5KTsKICB9CiAgICAgICBlbHNlCiAg
ewogICAgc3RkOjpfX3VuaW5pdGlhbGl6ZWRfZmlsbF9tb3ZlKHRoaXMtPl9NX2ltcGwuX01fZmlu
aXNoLAogICAgICAgX19wb3MgKyBkaWZmZXJlbmNlX3R5cGUoX19uKSwKICAgICAgIF9feF9jb3B5
LCBfX3BvcywKICAgICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoLAogICAgICAgX01fZ2V0X1Rw
X2FsbG9jYXRvcigpKTsKICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoID0gX19uZXdfZmluaXNo
OwogICAgc3RkOjpmaWxsKF9fcG9zLCBfX29sZF9maW5pc2gsIF9feF9jb3B5KTsKICB9CiAgICAg
fQogICBjYXRjaCguLi4pCiAgICAgewogICAgICAgX01fZGVzdHJveV9ub2Rlcyh0aGlzLT5fTV9p
bXBsLl9NX2ZpbmlzaC5fTV9ub2RlICsgMSwKICAgICAgICAgIF9fbmV3X2ZpbmlzaC5fTV9ub2Rl
ICsgMSk7CiAgICAgICB0aHJvdzsKICAgICB9CiB9CiAgICB9CgogIHRlbXBsYXRlIDx0eXBlbmFt
ZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHRlbXBsYXRlIDx0eXBlbmFtZSBfRm9yd2FyZEl0
ZXJhdG9yPgogICAgICB2b2lkCiAgICAgIGRlcXVlPF9UcCwgX0FsbG9jPjo6CiAgICAgIF9NX2lu
c2VydF9hdXgoaXRlcmF0b3IgX19wb3MsCiAgICAgICAgICAgICAgICAgICAgX0ZvcndhcmRJdGVy
YXRvciBfX2ZpcnN0LCBfRm9yd2FyZEl0ZXJhdG9yIF9fbGFzdCwKICAgICAgICAgICAgICAgICAg
ICBzaXplX3R5cGUgX19uKQogICAgICB7CiAgICAgICAgY29uc3QgZGlmZmVyZW5jZV90eXBlIF9f
ZWxlbXNiZWZvcmUgPSBfX3BvcyAtIHRoaXMtPl9NX2ltcGwuX01fc3RhcnQ7CiAgICAgICAgY29u
c3Qgc2l6ZV90eXBlIF9fbGVuZ3RoID0gc2l6ZSgpOwogICAgICAgIGlmIChzdGF0aWNfY2FzdDxz
aXplX3R5cGU+KF9fZWxlbXNiZWZvcmUpIDwgX19sZW5ndGggLyAyKQogICB7CiAgICAgaXRlcmF0
b3IgX19uZXdfc3RhcnQgPSBfTV9yZXNlcnZlX2VsZW1lbnRzX2F0X2Zyb250KF9fbik7CiAgICAg
aXRlcmF0b3IgX19vbGRfc3RhcnQgPSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0OwogICAgIF9fcG9z
ID0gdGhpcy0+X01faW1wbC5fTV9zdGFydCArIF9fZWxlbXNiZWZvcmU7CiAgICAgdHJ5CiAgICAg
ICB7CiAgaWYgKF9fZWxlbXNiZWZvcmUgPj0gZGlmZmVyZW5jZV90eXBlKF9fbikpCiAgICB7CiAg
ICAgIGl0ZXJhdG9yIF9fc3RhcnRfbiA9ICh0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0CiAgICAgICAr
IGRpZmZlcmVuY2VfdHlwZShfX24pKTsKICAgICAgc3RkOjpfX3VuaW5pdGlhbGl6ZWRfbW92ZV9h
KHRoaXMtPl9NX2ltcGwuX01fc3RhcnQsCiAgICAgIF9fc3RhcnRfbiwgX19uZXdfc3RhcnQsCiAg
ICAgIF9NX2dldF9UcF9hbGxvY2F0b3IoKSk7CiAgICAgIHRoaXMtPl9NX2ltcGwuX01fc3RhcnQg
PSBfX25ld19zdGFydDsKICAgICAgc3RkOjptb3ZlKF9fc3RhcnRfbiwgX19wb3MsIF9fb2xkX3N0
YXJ0KTsKICAgICAgc3RkOjpjb3B5KF9fZmlyc3QsIF9fbGFzdCwgX19wb3MgLSBkaWZmZXJlbmNl
X3R5cGUoX19uKSk7CiAgICB9CiAgZWxzZQogICAgewogICAgICBfRm9yd2FyZEl0ZXJhdG9yIF9f
bWlkID0gX19maXJzdDsKICAgICAgc3RkOjphZHZhbmNlKF9fbWlkLCBkaWZmZXJlbmNlX3R5cGUo
X19uKSAtIF9fZWxlbXNiZWZvcmUpOwogICAgICBzdGQ6Ol9fdW5pbml0aWFsaXplZF9tb3ZlX2Nv
cHkodGhpcy0+X01faW1wbC5fTV9zdGFydCwKICAgICAgICAgX19wb3MsIF9fZmlyc3QsIF9fbWlk
LAogICAgICAgICBfX25ld19zdGFydCwKICAgICAgICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsK
ICAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydCA9IF9fbmV3X3N0YXJ0OwogICAgICBzdGQ6OmNv
cHkoX19taWQsIF9fbGFzdCwgX19vbGRfc3RhcnQpOwogICAgfQogICAgICAgfQogICAgIGNhdGNo
KC4uLikKICAgICAgIHsKICBfTV9kZXN0cm95X25vZGVzKF9fbmV3X3N0YXJ0Ll9NX25vZGUsCiAg
ICAgdGhpcy0+X01faW1wbC5fTV9zdGFydC5fTV9ub2RlKTsKICB0aHJvdzsKICAgICAgIH0KICAg
fQogICAgICAgIGVsc2UKICAgICAgICB7CiAgICAgICAgICBpdGVyYXRvciBfX25ld19maW5pc2gg
PSBfTV9yZXNlcnZlX2VsZW1lbnRzX2F0X2JhY2soX19uKTsKICAgICAgICAgIGl0ZXJhdG9yIF9f
b2xkX2ZpbmlzaCA9IHRoaXMtPl9NX2ltcGwuX01fZmluaXNoOwogICAgICAgICAgY29uc3QgZGlm
ZmVyZW5jZV90eXBlIF9fZWxlbXNhZnRlciA9CiAgICAgICAgICAgIGRpZmZlcmVuY2VfdHlwZShf
X2xlbmd0aCkgLSBfX2VsZW1zYmVmb3JlOwogICAgICAgICAgX19wb3MgPSB0aGlzLT5fTV9pbXBs
Ll9NX2ZpbmlzaCAtIF9fZWxlbXNhZnRlcjsKICAgICAgICAgIHRyeQogICAgICAgICAgICB7CiAg
ICAgICAgICAgICAgaWYgKF9fZWxlbXNhZnRlciA+IGRpZmZlcmVuY2VfdHlwZShfX24pKQogIHsK
ICAgIGl0ZXJhdG9yIF9fZmluaXNoX24gPSAodGhpcy0+X01faW1wbC5fTV9maW5pc2gKICAgICAg
LSBkaWZmZXJlbmNlX3R5cGUoX19uKSk7CiAgICBzdGQ6Ol9fdW5pbml0aWFsaXplZF9tb3ZlX2Eo
X19maW5pc2hfbiwKICAgICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAgICAgICAg
ICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaCwKICAgICAgICAgICBfTV9nZXRfVHBfYWxsb2NhdG9y
KCkpOwogICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2ggPSBfX25ld19maW5pc2g7CiAgICBzdGQ6
Om1vdmVfYmFja3dhcmQoX19wb3MsIF9fZmluaXNoX24sIF9fb2xkX2ZpbmlzaCk7CiAgICBzdGQ6
OmNvcHkoX19maXJzdCwgX19sYXN0LCBfX3Bvcyk7CiAgfQogICAgICAgICAgICAgIGVsc2UKICB7
CiAgICBfRm9yd2FyZEl0ZXJhdG9yIF9fbWlkID0gX19maXJzdDsKICAgIHN0ZDo6YWR2YW5jZShf
X21pZCwgX19lbGVtc2FmdGVyKTsKICAgIHN0ZDo6X191bmluaXRpYWxpemVkX2NvcHlfbW92ZShf
X21pZCwgX19sYXN0LCBfX3BvcywKICAgICAgIHRoaXMtPl9NX2ltcGwuX01fZmluaXNoLAogICAg
ICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2gsCiAgICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkp
OwogICAgdGhpcy0+X01faW1wbC5fTV9maW5pc2ggPSBfX25ld19maW5pc2g7CiAgICBzdGQ6OmNv
cHkoX19maXJzdCwgX19taWQsIF9fcG9zKTsKICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIGNh
dGNoKC4uLikKICAgICAgICAgICAgewogICAgICAgICAgICAgIF9NX2Rlc3Ryb3lfbm9kZXModGhp
cy0+X01faW1wbC5fTV9maW5pc2guX01fbm9kZSArIDEsCiAgICAgICAgICBfX25ld19maW5pc2gu
X01fbm9kZSArIDEpOwogICAgICAgICAgICAgIHRocm93OwogICAgICAgICAgICB9CiAgICAgICAg
fQogICAgICB9CgogICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9BbGxvYz4KICAg
ICB2b2lkCiAgICAgZGVxdWU8X1RwLCBfQWxsb2M+OjoKICAgICBfTV9kZXN0cm95X2RhdGFfYXV4
KGl0ZXJhdG9yIF9fZmlyc3QsIGl0ZXJhdG9yIF9fbGFzdCkKICAgICB7CiAgICAgICBmb3IgKF9N
YXBfcG9pbnRlciBfX25vZGUgPSBfX2ZpcnN0Ll9NX25vZGUgKyAxOwogICAgIF9fbm9kZSA8IF9f
bGFzdC5fTV9ub2RlOyArK19fbm9kZSkKICBzdGQ6Ol9EZXN0cm95KCpfX25vZGUsICpfX25vZGUg
KyBfU19idWZmZXJfc2l6ZSgpLAogICAgICAgICBfTV9nZXRfVHBfYWxsb2NhdG9yKCkpOwoKICAg
ICAgIGlmIChfX2ZpcnN0Ll9NX25vZGUgIT0gX19sYXN0Ll9NX25vZGUpCiAgewogICAgc3RkOjpf
RGVzdHJveShfX2ZpcnN0Ll9NX2N1ciwgX19maXJzdC5fTV9sYXN0LAogICAgX01fZ2V0X1RwX2Fs
bG9jYXRvcigpKTsKICAgIHN0ZDo6X0Rlc3Ryb3koX19sYXN0Ll9NX2ZpcnN0LCBfX2xhc3QuX01f
Y3VyLAogICAgX01fZ2V0X1RwX2FsbG9jYXRvcigpKTsKICB9CiAgICAgICBlbHNlCiAgc3RkOjpf
RGVzdHJveShfX2ZpcnN0Ll9NX2N1ciwgX19sYXN0Ll9NX2N1ciwKICAgICAgICAgX01fZ2V0X1Rw
X2FsbG9jYXRvcigpKTsKICAgICB9CgogIHRlbXBsYXRlIDx0eXBlbmFtZSBfVHAsIHR5cGVuYW1l
IF9BbGxvYz4KICAgIHZvaWQKICAgIGRlcXVlPF9UcCwgX0FsbG9jPjo6CiAgICBfTV9uZXdfZWxl
bWVudHNfYXRfZnJvbnQoc2l6ZV90eXBlIF9fbmV3X2VsZW1zKQogICAgewogICAgICBpZiAodGhp
cy0+bWF4X3NpemUoKSAtIHRoaXMtPnNpemUoKSA8IF9fbmV3X2VsZW1zKQogX190aHJvd19sZW5n
dGhfZXJyb3IoKCJkZXF1ZTo6X01fbmV3X2VsZW1lbnRzX2F0X2Zyb250IikpOwoKICAgICAgY29u
c3Qgc2l6ZV90eXBlIF9fbmV3X25vZGVzID0gKChfX25ld19lbGVtcyArIF9TX2J1ZmZlcl9zaXpl
KCkgLSAxKQogICAgICAgICAvIF9TX2J1ZmZlcl9zaXplKCkpOwogICAgICBfTV9yZXNlcnZlX21h
cF9hdF9mcm9udChfX25ld19ub2Rlcyk7CiAgICAgIHNpemVfdHlwZSBfX2k7CiAgICAgIHRyeQog
ICAgICAgIHsKICAgICAgICAgIGZvciAoX19pID0gMTsgX19pIDw9IF9fbmV3X25vZGVzOyArK19f
aSkKICAgICAgICAgICAgKih0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9NX25vZGUgLSBfX2kpID0g
dGhpcy0+X01fYWxsb2NhdGVfbm9kZSgpOwogICAgICAgIH0KICAgICAgY2F0Y2goLi4uKQogICAg
ICAgIHsKICAgICAgICAgIGZvciAoc2l6ZV90eXBlIF9faiA9IDE7IF9faiA8IF9faTsgKytfX2op
CiAgICAgICAgICAgIF9NX2RlYWxsb2NhdGVfbm9kZSgqKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQu
X01fbm9kZSAtIF9faikpOwogICAgICAgICAgdGhyb3c7CiAgICAgICAgfQogICAgfQoKICB0ZW1w
bGF0ZSA8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB2b2lkCiAgICBkZXF1ZTxf
VHAsIF9BbGxvYz46OgogICAgX01fbmV3X2VsZW1lbnRzX2F0X2JhY2soc2l6ZV90eXBlIF9fbmV3
X2VsZW1zKQogICAgewogICAgICBpZiAodGhpcy0+bWF4X3NpemUoKSAtIHRoaXMtPnNpemUoKSA8
IF9fbmV3X2VsZW1zKQogX190aHJvd19sZW5ndGhfZXJyb3IoKCJkZXF1ZTo6X01fbmV3X2VsZW1l
bnRzX2F0X2JhY2siKSk7CgogICAgICBjb25zdCBzaXplX3R5cGUgX19uZXdfbm9kZXMgPSAoKF9f
bmV3X2VsZW1zICsgX1NfYnVmZmVyX3NpemUoKSAtIDEpCiAgICAgICAgIC8gX1NfYnVmZmVyX3Np
emUoKSk7CiAgICAgIF9NX3Jlc2VydmVfbWFwX2F0X2JhY2soX19uZXdfbm9kZXMpOwogICAgICBz
aXplX3R5cGUgX19pOwogICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICBmb3IgKF9faSA9IDE7
IF9faSA8PSBfX25ld19ub2RlczsgKytfX2kpCiAgICAgICAgICAgICoodGhpcy0+X01faW1wbC5f
TV9maW5pc2guX01fbm9kZSArIF9faSkgPSB0aGlzLT5fTV9hbGxvY2F0ZV9ub2RlKCk7CiAgICAg
ICAgfQogICAgICBjYXRjaCguLi4pCiAgICAgICAgewogICAgICAgICAgZm9yIChzaXplX3R5cGUg
X19qID0gMTsgX19qIDwgX19pOyArK19faikKICAgICAgICAgICAgX01fZGVhbGxvY2F0ZV9ub2Rl
KCoodGhpcy0+X01faW1wbC5fTV9maW5pc2guX01fbm9kZSArIF9faikpOwogICAgICAgICAgdGhy
b3c7CiAgICAgICAgfQogICAgfQoKICB0ZW1wbGF0ZSA8dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBf
QWxsb2M+CiAgICB2b2lkCiAgICBkZXF1ZTxfVHAsIF9BbGxvYz46OgogICAgX01fcmVhbGxvY2F0
ZV9tYXAoc2l6ZV90eXBlIF9fbm9kZXNfdG9fYWRkLCBib29sIF9fYWRkX2F0X2Zyb250KQogICAg
ewogICAgICBjb25zdCBzaXplX3R5cGUgX19vbGRfbnVtX25vZGVzCiA9IHRoaXMtPl9NX2ltcGwu
X01fZmluaXNoLl9NX25vZGUgLSB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9NX25vZGUgKyAxOwog
ICAgICBjb25zdCBzaXplX3R5cGUgX19uZXdfbnVtX25vZGVzID0gX19vbGRfbnVtX25vZGVzICsg
X19ub2Rlc190b19hZGQ7CgogICAgICBfTWFwX3BvaW50ZXIgX19uZXdfbnN0YXJ0OwogICAgICBp
ZiAodGhpcy0+X01faW1wbC5fTV9tYXBfc2l6ZSA+IDIgKiBfX25ld19udW1fbm9kZXMpCiB7CiAg
IF9fbmV3X25zdGFydCA9IHRoaXMtPl9NX2ltcGwuX01fbWFwICsgKHRoaXMtPl9NX2ltcGwuX01f
bWFwX3NpemUKICAgICAgLSBfX25ld19udW1fbm9kZXMpIC8gMgogICAgICAgICAgICAgICAgICAr
IChfX2FkZF9hdF9mcm9udCA/IF9fbm9kZXNfdG9fYWRkIDogMCk7CiAgIGlmIChfX25ld19uc3Rh
cnQgPCB0aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9NX25vZGUpCiAgICAgc3RkOjpjb3B5KHRoaXMt
Pl9NX2ltcGwuX01fc3RhcnQuX01fbm9kZSwKICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2Zpbmlz
aC5fTV9ub2RlICsgMSwKICAgICAgICBfX25ld19uc3RhcnQpOwogICBlbHNlCiAgICAgc3RkOjpj
b3B5X2JhY2t3YXJkKHRoaXMtPl9NX2ltcGwuX01fc3RhcnQuX01fbm9kZSwKICAgICAgICAgIHRo
aXMtPl9NX2ltcGwuX01fZmluaXNoLl9NX25vZGUgKyAxLAogICAgICAgICAgX19uZXdfbnN0YXJ0
ICsgX19vbGRfbnVtX25vZGVzKTsKIH0KICAgICAgZWxzZQogewogICBzaXplX3R5cGUgX19uZXdf
bWFwX3NpemUgPSB0aGlzLT5fTV9pbXBsLl9NX21hcF9zaXplCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICsgc3RkOjptYXgodGhpcy0+X01faW1wbC5fTV9tYXBfc2l6ZSwKICAgICAgX19u
b2Rlc190b19hZGQpICsgMjsKCiAgIF9NYXBfcG9pbnRlciBfX25ld19tYXAgPSB0aGlzLT5fTV9h
bGxvY2F0ZV9tYXAoX19uZXdfbWFwX3NpemUpOwogICBfX25ld19uc3RhcnQgPSBfX25ld19tYXAg
KyAoX19uZXdfbWFwX3NpemUgLSBfX25ld19udW1fbm9kZXMpIC8gMgogICAgICAgICAgICAgICAg
ICArIChfX2FkZF9hdF9mcm9udCA/IF9fbm9kZXNfdG9fYWRkIDogMCk7CiAgIHN0ZDo6Y29weSh0
aGlzLT5fTV9pbXBsLl9NX3N0YXJ0Ll9NX25vZGUsCiAgICAgIHRoaXMtPl9NX2ltcGwuX01fZmlu
aXNoLl9NX25vZGUgKyAxLAogICAgICBfX25ld19uc3RhcnQpOwogICBfTV9kZWFsbG9jYXRlX21h
cCh0aGlzLT5fTV9pbXBsLl9NX21hcCwgdGhpcy0+X01faW1wbC5fTV9tYXBfc2l6ZSk7CgogICB0
aGlzLT5fTV9pbXBsLl9NX21hcCA9IF9fbmV3X21hcDsKICAgdGhpcy0+X01faW1wbC5fTV9tYXBf
c2l6ZSA9IF9fbmV3X21hcF9zaXplOwogfQoKICAgICAgdGhpcy0+X01faW1wbC5fTV9zdGFydC5f
TV9zZXRfbm9kZShfX25ld19uc3RhcnQpOwogICAgICB0aGlzLT5fTV9pbXBsLl9NX2ZpbmlzaC5f
TV9zZXRfbm9kZShfX25ld19uc3RhcnQgKyBfX29sZF9udW1fbm9kZXMgLSAxKTsKICAgIH0KCgoK
ICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHA+CiAgICB2b2lkCiAgICBmaWxsKGNvbnN0IF9EZXF1ZV9p
dGVyYXRvcjxfVHAsIF9UcCYsIF9UcCo+JiBfX2ZpcnN0LAogIGNvbnN0IF9EZXF1ZV9pdGVyYXRv
cjxfVHAsIF9UcCYsIF9UcCo+JiBfX2xhc3QsIGNvbnN0IF9UcCYgX192YWx1ZSkKICAgIHsKICAg
ICAgdHlwZWRlZiB0eXBlbmFtZSBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfVHAmLCBfVHAqPjo6X1Nl
bGYgX1NlbGY7CgogICAgICBmb3IgKHR5cGVuYW1lIF9TZWxmOjpfTWFwX3BvaW50ZXIgX19ub2Rl
ID0gX19maXJzdC5fTV9ub2RlICsgMTsKICAgICAgICAgICBfX25vZGUgPCBfX2xhc3QuX01fbm9k
ZTsgKytfX25vZGUpCiBzdGQ6OmZpbGwoKl9fbm9kZSwgKl9fbm9kZSArIF9TZWxmOjpfU19idWZm
ZXJfc2l6ZSgpLCBfX3ZhbHVlKTsKCiAgICAgIGlmIChfX2ZpcnN0Ll9NX25vZGUgIT0gX19sYXN0
Ll9NX25vZGUpCiB7CiAgIHN0ZDo6ZmlsbChfX2ZpcnN0Ll9NX2N1ciwgX19maXJzdC5fTV9sYXN0
LCBfX3ZhbHVlKTsKICAgc3RkOjpmaWxsKF9fbGFzdC5fTV9maXJzdCwgX19sYXN0Ll9NX2N1ciwg
X192YWx1ZSk7CiB9CiAgICAgIGVsc2UKIHN0ZDo6ZmlsbChfX2ZpcnN0Ll9NX2N1ciwgX19sYXN0
Ll9NX2N1ciwgX192YWx1ZSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAgIF9E
ZXF1ZV9pdGVyYXRvcjxfVHAsIF9UcCYsIF9UcCo+CiAgICBjb3B5KF9EZXF1ZV9pdGVyYXRvcjxf
VHAsIGNvbnN0IF9UcCYsIGNvbnN0IF9UcCo+IF9fZmlyc3QsCiAgX0RlcXVlX2l0ZXJhdG9yPF9U
cCwgY29uc3QgX1RwJiwgY29uc3QgX1RwKj4gX19sYXN0LAogIF9EZXF1ZV9pdGVyYXRvcjxfVHAs
IF9UcCYsIF9UcCo+IF9fcmVzdWx0KQogICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9EZXF1
ZV9pdGVyYXRvcjxfVHAsIF9UcCYsIF9UcCo+OjpfU2VsZiBfU2VsZjsKICAgICAgdHlwZWRlZiB0
eXBlbmFtZSBfU2VsZjo6ZGlmZmVyZW5jZV90eXBlIGRpZmZlcmVuY2VfdHlwZTsKCiAgICAgIGRp
ZmZlcmVuY2VfdHlwZSBfX2xlbiA9IF9fbGFzdCAtIF9fZmlyc3Q7CiAgICAgIHdoaWxlIChfX2xl
biA+IDApCiB7CiAgIGNvbnN0IGRpZmZlcmVuY2VfdHlwZSBfX2NsZW4KICAgICA9IHN0ZDo6bWlu
KF9fbGVuLCBzdGQ6Om1pbihfX2ZpcnN0Ll9NX2xhc3QgLSBfX2ZpcnN0Ll9NX2N1ciwKICAgICAg
ICAgICBfX3Jlc3VsdC5fTV9sYXN0IC0gX19yZXN1bHQuX01fY3VyKSk7CiAgIHN0ZDo6Y29weShf
X2ZpcnN0Ll9NX2N1ciwgX19maXJzdC5fTV9jdXIgKyBfX2NsZW4sIF9fcmVzdWx0Ll9NX2N1cik7
CiAgIF9fZmlyc3QgKz0gX19jbGVuOwogICBfX3Jlc3VsdCArPSBfX2NsZW47CiAgIF9fbGVuIC09
IF9fY2xlbjsKIH0KICAgICAgcmV0dXJuIF9fcmVzdWx0OwogICAgfQoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHA+CiAgICBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfVHAmLCBfVHAqPgogICAgY29weV9i
YWNrd2FyZChfRGVxdWVfaXRlcmF0b3I8X1RwLCBjb25zdCBfVHAmLCBjb25zdCBfVHAqPiBfX2Zp
cnN0LAogICAgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgY29uc3QgX1RwJiwgY29uc3QgX1RwKj4gX19s
YXN0LAogICAgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwgX1RwKj4gX19yZXN1bHQpCiAgICB7
CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwgX1RwKj46
Ol9TZWxmIF9TZWxmOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9TZWxmOjpkaWZmZXJlbmNlX3R5
cGUgZGlmZmVyZW5jZV90eXBlOwoKICAgICAgZGlmZmVyZW5jZV90eXBlIF9fbGVuID0gX19sYXN0
IC0gX19maXJzdDsKICAgICAgd2hpbGUgKF9fbGVuID4gMCkKIHsKICAgZGlmZmVyZW5jZV90eXBl
IF9fbGxlbiA9IF9fbGFzdC5fTV9jdXIgLSBfX2xhc3QuX01fZmlyc3Q7CiAgIF9UcCogX19sZW5k
ID0gX19sYXN0Ll9NX2N1cjsKCiAgIGRpZmZlcmVuY2VfdHlwZSBfX3JsZW4gPSBfX3Jlc3VsdC5f
TV9jdXIgLSBfX3Jlc3VsdC5fTV9maXJzdDsKICAgX1RwKiBfX3JlbmQgPSBfX3Jlc3VsdC5fTV9j
dXI7CgogICBpZiAoIV9fbGxlbikKICAgICB7CiAgICAgICBfX2xsZW4gPSBfU2VsZjo6X1NfYnVm
ZmVyX3NpemUoKTsKICAgICAgIF9fbGVuZCA9ICooX19sYXN0Ll9NX25vZGUgLSAxKSArIF9fbGxl
bjsKICAgICB9CiAgIGlmICghX19ybGVuKQogICAgIHsKICAgICAgIF9fcmxlbiA9IF9TZWxmOjpf
U19idWZmZXJfc2l6ZSgpOwogICAgICAgX19yZW5kID0gKihfX3Jlc3VsdC5fTV9ub2RlIC0gMSkg
KyBfX3JsZW47CiAgICAgfQoKICAgY29uc3QgZGlmZmVyZW5jZV90eXBlIF9fY2xlbiA9IHN0ZDo6
bWluKF9fbGVuLAogICAgICAgIHN0ZDo6bWluKF9fbGxlbiwgX19ybGVuKSk7CiAgIHN0ZDo6Y29w
eV9iYWNrd2FyZChfX2xlbmQgLSBfX2NsZW4sIF9fbGVuZCwgX19yZW5kKTsKICAgX19sYXN0IC09
IF9fY2xlbjsKICAgX19yZXN1bHQgLT0gX19jbGVuOwogICBfX2xlbiAtPSBfX2NsZW47CiB9CiAg
ICAgIHJldHVybiBfX3Jlc3VsdDsKICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcD4KICAg
IF9EZXF1ZV9pdGVyYXRvcjxfVHAsIF9UcCYsIF9UcCo+CiAgICBtb3ZlKF9EZXF1ZV9pdGVyYXRv
cjxfVHAsIGNvbnN0IF9UcCYsIGNvbnN0IF9UcCo+IF9fZmlyc3QsCiAgX0RlcXVlX2l0ZXJhdG9y
PF9UcCwgY29uc3QgX1RwJiwgY29uc3QgX1RwKj4gX19sYXN0LAogIF9EZXF1ZV9pdGVyYXRvcjxf
VHAsIF9UcCYsIF9UcCo+IF9fcmVzdWx0KQogICAgewogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9E
ZXF1ZV9pdGVyYXRvcjxfVHAsIF9UcCYsIF9UcCo+OjpfU2VsZiBfU2VsZjsKICAgICAgdHlwZWRl
ZiB0eXBlbmFtZSBfU2VsZjo6ZGlmZmVyZW5jZV90eXBlIGRpZmZlcmVuY2VfdHlwZTsKCiAgICAg
IGRpZmZlcmVuY2VfdHlwZSBfX2xlbiA9IF9fbGFzdCAtIF9fZmlyc3Q7CiAgICAgIHdoaWxlIChf
X2xlbiA+IDApCiB7CiAgIGNvbnN0IGRpZmZlcmVuY2VfdHlwZSBfX2NsZW4KICAgICA9IHN0ZDo6
bWluKF9fbGVuLCBzdGQ6Om1pbihfX2ZpcnN0Ll9NX2xhc3QgLSBfX2ZpcnN0Ll9NX2N1ciwKICAg
ICAgICAgICBfX3Jlc3VsdC5fTV9sYXN0IC0gX19yZXN1bHQuX01fY3VyKSk7CiAgIHN0ZDo6bW92
ZShfX2ZpcnN0Ll9NX2N1ciwgX19maXJzdC5fTV9jdXIgKyBfX2NsZW4sIF9fcmVzdWx0Ll9NX2N1
cik7CiAgIF9fZmlyc3QgKz0gX19jbGVuOwogICBfX3Jlc3VsdCArPSBfX2NsZW47CiAgIF9fbGVu
IC09IF9fY2xlbjsKIH0KICAgICAgcmV0dXJuIF9fcmVzdWx0OwogICAgfQoKICB0ZW1wbGF0ZTx0
eXBlbmFtZSBfVHA+CiAgICBfRGVxdWVfaXRlcmF0b3I8X1RwLCBfVHAmLCBfVHAqPgogICAgbW92
ZV9iYWNrd2FyZChfRGVxdWVfaXRlcmF0b3I8X1RwLCBjb25zdCBfVHAmLCBjb25zdCBfVHAqPiBf
X2ZpcnN0LAogICAgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgY29uc3QgX1RwJiwgY29uc3QgX1RwKj4g
X19sYXN0LAogICAgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwgX1RwKj4gX19yZXN1bHQpCiAg
ICB7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0RlcXVlX2l0ZXJhdG9yPF9UcCwgX1RwJiwgX1Rw
Kj46Ol9TZWxmIF9TZWxmOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9TZWxmOjpkaWZmZXJlbmNl
X3R5cGUgZGlmZmVyZW5jZV90eXBlOwoKICAgICAgZGlmZmVyZW5jZV90eXBlIF9fbGVuID0gX19s
YXN0IC0gX19maXJzdDsKICAgICAgd2hpbGUgKF9fbGVuID4gMCkKIHsKICAgZGlmZmVyZW5jZV90
eXBlIF9fbGxlbiA9IF9fbGFzdC5fTV9jdXIgLSBfX2xhc3QuX01fZmlyc3Q7CiAgIF9UcCogX19s
ZW5kID0gX19sYXN0Ll9NX2N1cjsKCiAgIGRpZmZlcmVuY2VfdHlwZSBfX3JsZW4gPSBfX3Jlc3Vs
dC5fTV9jdXIgLSBfX3Jlc3VsdC5fTV9maXJzdDsKICAgX1RwKiBfX3JlbmQgPSBfX3Jlc3VsdC5f
TV9jdXI7CgogICBpZiAoIV9fbGxlbikKICAgICB7CiAgICAgICBfX2xsZW4gPSBfU2VsZjo6X1Nf
YnVmZmVyX3NpemUoKTsKICAgICAgIF9fbGVuZCA9ICooX19sYXN0Ll9NX25vZGUgLSAxKSArIF9f
bGxlbjsKICAgICB9CiAgIGlmICghX19ybGVuKQogICAgIHsKICAgICAgIF9fcmxlbiA9IF9TZWxm
OjpfU19idWZmZXJfc2l6ZSgpOwogICAgICAgX19yZW5kID0gKihfX3Jlc3VsdC5fTV9ub2RlIC0g
MSkgKyBfX3JsZW47CiAgICAgfQoKICAgY29uc3QgZGlmZmVyZW5jZV90eXBlIF9fY2xlbiA9IHN0
ZDo6bWluKF9fbGVuLAogICAgICAgIHN0ZDo6bWluKF9fbGxlbiwgX19ybGVuKSk7CiAgIHN0ZDo6
bW92ZV9iYWNrd2FyZChfX2xlbmQgLSBfX2NsZW4sIF9fbGVuZCwgX19yZW5kKTsKICAgX19sYXN0
IC09IF9fY2xlbjsKICAgX19yZXN1bHQgLT0gX19jbGVuOwogICBfX2xlbiAtPSBfX2NsZW47CiB9
CiAgICAgIHJldHVybiBfX3Jlc3VsdDsKICAgIH0KCgoKfQojIDY3ICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL2RlcXVlIiAyIDMKIyA2MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zdGFjayIgMiAz
CiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9zdGFjay5oIiAxIDMKIyA2NSAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9zdGFjay5oIiAzCm5hbWVzcGFjZSBzdGQg
X19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoKIyA5OCAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9zdGFjay5oIiAzCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwLCB0eXBlbmFtZSBfU2VxdWVuY2UgPSBkZXF1ZTxfVHA+ID4KICAgIGNsYXNzIHN0YWNr
CiAgICB7CgogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9TZXF1ZW5jZTo6dmFsdWVfdHlwZSBfU2Vx
dWVuY2VfdmFsdWVfdHlwZTsKCgoKCiAgICAgCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAx
LCB0eXBlbmFtZSBfU2VxMT4KICAgICAgICBmcmllbmQgYm9vbAogICAgICAgIG9wZXJhdG9yPT0o
Y29uc3Qgc3RhY2s8X1RwMSwgX1NlcTE+JiwgY29uc3Qgc3RhY2s8X1RwMSwgX1NlcTE+Jik7Cgog
ICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAxLCB0eXBlbmFtZSBfU2VxMT4KICAgICAgICBmcmll
bmQgYm9vbAogICAgICAgIG9wZXJhdG9yPChjb25zdCBzdGFjazxfVHAxLCBfU2VxMT4mLCBjb25z
dCBzdGFjazxfVHAxLCBfU2VxMT4mKTsKCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2M+
CiB1c2luZyBfVXNlcyA9IHR5cGVuYW1lCiAgIGVuYWJsZV9pZjx1c2VzX2FsbG9jYXRvcjxfU2Vx
dWVuY2UsIF9BbGxvYz46OnZhbHVlPjo6dHlwZTsKCgogICAgcHVibGljOgogICAgICB0eXBlZGVm
IHR5cGVuYW1lIF9TZXF1ZW5jZTo6dmFsdWVfdHlwZSB2YWx1ZV90eXBlOwogICAgICB0eXBlZGVm
IHR5cGVuYW1lIF9TZXF1ZW5jZTo6cmVmZXJlbmNlIHJlZmVyZW5jZTsKICAgICAgdHlwZWRlZiB0
eXBlbmFtZSBfU2VxdWVuY2U6OmNvbnN0X3JlZmVyZW5jZSBjb25zdF9yZWZlcmVuY2U7CiAgICAg
IHR5cGVkZWYgdHlwZW5hbWUgX1NlcXVlbmNlOjpzaXplX3R5cGUgc2l6ZV90eXBlOwogICAgICB0
eXBlZGVmIF9TZXF1ZW5jZSBjb250YWluZXJfdHlwZTsKCiAgICBwcm90ZWN0ZWQ6CgogICAgICBf
U2VxdWVuY2UgYzsKCiAgICBwdWJsaWM6CiMgMTQ0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX3N0YWNrLmgiIDMKICAgICAgZXhwbGljaXQKICAgICAgc3RhY2soY29uc3QgX1NlcXVl
bmNlJiBfX2MpCiAgICAgIDogYyhfX2MpIHsgfQoKICAgICAgZXhwbGljaXQKICAgICAgc3RhY2so
X1NlcXVlbmNlJiYgX19jID0gX1NlcXVlbmNlKCkpCiAgICAgIDogYyhzdGQ6Om1vdmUoX19jKSkg
eyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2MsIHR5cGVuYW1lIF9SZXF1aXJlcyA9
IF9Vc2VzPF9BbGxvYz4+CiBleHBsaWNpdAogc3RhY2soY29uc3QgX0FsbG9jJiBfX2EpCiA6IGMo
X19hKSB7IH0KCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BbGxvYywgdHlwZW5hbWUgX1JlcXVp
cmVzID0gX1VzZXM8X0FsbG9jPj4KIHN0YWNrKGNvbnN0IF9TZXF1ZW5jZSYgX19jLCBjb25zdCBf
QWxsb2MmIF9fYSkKIDogYyhfX2MsIF9fYSkgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
QWxsb2MsIHR5cGVuYW1lIF9SZXF1aXJlcyA9IF9Vc2VzPF9BbGxvYz4+CiBzdGFjayhfU2VxdWVu
Y2UmJiBfX2MsIGNvbnN0IF9BbGxvYyYgX19hKQogOiBjKHN0ZDo6bW92ZShfX2MpLCBfX2EpIHsg
fQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FsbG9jLCB0eXBlbmFtZSBfUmVxdWlyZXMgPSBf
VXNlczxfQWxsb2M+Pgogc3RhY2soY29uc3Qgc3RhY2smIF9fcSwgY29uc3QgX0FsbG9jJiBfX2Ep
CiA6IGMoX19xLmMsIF9fYSkgeyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQWxsb2MsIHR5
cGVuYW1lIF9SZXF1aXJlcyA9IF9Vc2VzPF9BbGxvYz4+CiBzdGFjayhzdGFjayYmIF9fcSwgY29u
c3QgX0FsbG9jJiBfX2EpCiA6IGMoc3RkOjptb3ZlKF9fcS5jKSwgX19hKSB7IH0KCgoKCgogICAg
ICBib29sCiAgICAgIGVtcHR5KCkgY29uc3QKICAgICAgeyByZXR1cm4gYy5lbXB0eSgpOyB9CgoK
ICAgICAgc2l6ZV90eXBlCiAgICAgIHNpemUoKSBjb25zdAogICAgICB7IHJldHVybiBjLnNpemUo
KTsgfQoKCgoKCiAgICAgIHJlZmVyZW5jZQogICAgICB0b3AoKQogICAgICB7CiA7CiByZXR1cm4g
Yy5iYWNrKCk7CiAgICAgIH0KCgoKCgogICAgICBjb25zdF9yZWZlcmVuY2UKICAgICAgdG9wKCkg
Y29uc3QKICAgICAgewogOwogcmV0dXJuIGMuYmFjaygpOwogICAgICB9CiMgMjE3ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3N0YWNrLmgiIDMKICAgICAgdm9pZAogICAgICBwdXNo
KGNvbnN0IHZhbHVlX3R5cGUmIF9feCkKICAgICAgeyBjLnB1c2hfYmFjayhfX3gpOyB9CgoKICAg
ICAgdm9pZAogICAgICBwdXNoKHZhbHVlX3R5cGUmJiBfX3gpCiAgICAgIHsgYy5wdXNoX2JhY2so
c3RkOjptb3ZlKF9feCkpOyB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfQXJncz4KICAg
ICAgICB2b2lkCiAgICAgICAgZW1wbGFjZShfQXJncyYmLi4uIF9fYXJncykKIHsgYy5lbXBsYWNl
X2JhY2soc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsgfQojIDI0MyAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9zdGFjay5oIiAzCiAgICAgIHZvaWQKICAgICAgcG9wKCkK
ICAgICAgewogOwogYy5wb3BfYmFjaygpOwogICAgICB9CgoKICAgICAgdm9pZAogICAgICBzd2Fw
KHN0YWNrJiBfX3MpCiAgICAgIG5vZXhjZXB0KF9faXNfbm90aHJvd19zd2FwcGFibGU8X1RwPjo6
dmFsdWUpCiAgICAgIHsKIHVzaW5nIHN0ZDo6c3dhcDsKIHN3YXAoYywgX19zLmMpOwogICAgICB9
CgogICAgfTsKIyAyNzMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfc3RhY2suaCIg
MwogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1NlcT4KICAgIGlubGluZSBib29s
CiAgICBvcGVyYXRvcj09KGNvbnN0IHN0YWNrPF9UcCwgX1NlcT4mIF9feCwgY29uc3Qgc3RhY2s8
X1RwLCBfU2VxPiYgX195KQogICAgeyByZXR1cm4gX194LmMgPT0gX195LmM7IH0KIyAyOTEgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfc3RhY2suaCIgMwogIHRlbXBsYXRlPHR5cGVu
YW1lIF9UcCwgdHlwZW5hbWUgX1NlcT4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcjwoY29u
c3Qgc3RhY2s8X1RwLCBfU2VxPiYgX194LCBjb25zdCBzdGFjazxfVHAsIF9TZXE+JiBfX3kpCiAg
ICB7IHJldHVybiBfX3guYyA8IF9feS5jOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfVHAsIHR5
cGVuYW1lIF9TZXE+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3IhPShjb25zdCBzdGFjazxf
VHAsIF9TZXE+JiBfX3gsIGNvbnN0IHN0YWNrPF9UcCwgX1NlcT4mIF9feSkKICAgIHsgcmV0dXJu
ICEoX194ID09IF9feSk7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1Nl
cT4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj4oY29uc3Qgc3RhY2s8X1RwLCBfU2VxPiYg
X194LCBjb25zdCBzdGFjazxfVHAsIF9TZXE+JiBfX3kpCiAgICB7IHJldHVybiBfX3kgPCBfX3g7
IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX1NlcT4KICAgIGlubGluZSBi
b29sCiAgICBvcGVyYXRvcjw9KGNvbnN0IHN0YWNrPF9UcCwgX1NlcT4mIF9feCwgY29uc3Qgc3Rh
Y2s8X1RwLCBfU2VxPiYgX195KQogICAgeyByZXR1cm4gIShfX3kgPCBfX3gpOyB9CgoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9TZXE+CiAgICBpbmxpbmUgYm9vbAogICAgb3Bl
cmF0b3I+PShjb25zdCBzdGFjazxfVHAsIF9TZXE+JiBfX3gsIGNvbnN0IHN0YWNrPF9UcCwgX1Nl
cT4mIF9feSkKICAgIHsgcmV0dXJuICEoX194IDwgX195KTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX1RwLCB0eXBlbmFtZSBfU2VxPgogICAgaW5saW5lIHZvaWQKICAgIHN3YXAoc3RhY2s8X1Rw
LCBfU2VxPiYgX194LCBzdGFjazxfVHAsIF9TZXE+JiBfX3kpCiAgICBub2V4Y2VwdChub2V4Y2Vw
dChfX3guc3dhcChfX3kpKSkKICAgIHsgX194LnN3YXAoX195KTsgfQoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfVHAsIHR5cGVuYW1lIF9TZXEsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHN0cnVjdCB1c2Vz
X2FsbG9jYXRvcjxzdGFjazxfVHAsIF9TZXE+LCBfQWxsb2M+CiAgICA6IHB1YmxpYyB1c2VzX2Fs
bG9jYXRvcjxfU2VxLCBfQWxsb2M+Ojp0eXBlIHsgfTsKCgoKfQojIDYyICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL3N0YWNrIiAyIDMKIyAzMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxp
Ynl1aS1tYXN0ZXItMy4yLjEvc3JjL1lEaWFsb2cuaCIgMgojIDEgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvbWFwIiAxIDMKIyA1OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9tYXAiIDMKICAgICAg
IAojIDU5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL21hcCIgMwoKIyAxICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvc3RsX3RyZWUuaCIgMSAzCiMgNjEgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9zdGxfdHJlZS5oIiAzCiAgICAgICAKIyA2MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL3N0bF90cmVlLmgiIDMKIyA3MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0
bF90cmVlLmgiIDMKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18g
KCJkZWZhdWx0IikpKQp7CgojIDkyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3Ry
ZWUuaCIgMwogIGVudW0gX1JiX3RyZWVfY29sb3IgeyBfU19yZWQgPSBmYWxzZSwgX1NfYmxhY2sg
PSB0cnVlIH07CgogIHN0cnVjdCBfUmJfdHJlZV9ub2RlX2Jhc2UKICB7CiAgICB0eXBlZGVmIF9S
Yl90cmVlX25vZGVfYmFzZSogX0Jhc2VfcHRyOwogICAgdHlwZWRlZiBjb25zdCBfUmJfdHJlZV9u
b2RlX2Jhc2UqIF9Db25zdF9CYXNlX3B0cjsKCiAgICBfUmJfdHJlZV9jb2xvciBfTV9jb2xvcjsK
ICAgIF9CYXNlX3B0ciBfTV9wYXJlbnQ7CiAgICBfQmFzZV9wdHIgX01fbGVmdDsKICAgIF9CYXNl
X3B0ciBfTV9yaWdodDsKCiAgICBzdGF0aWMgX0Jhc2VfcHRyCiAgICBfU19taW5pbXVtKF9CYXNl
X3B0ciBfX3gpIG5vZXhjZXB0CiAgICB7CiAgICAgIHdoaWxlIChfX3gtPl9NX2xlZnQgIT0gMCkg
X194ID0gX194LT5fTV9sZWZ0OwogICAgICByZXR1cm4gX194OwogICAgfQoKICAgIHN0YXRpYyBf
Q29uc3RfQmFzZV9wdHIKICAgIF9TX21pbmltdW0oX0NvbnN0X0Jhc2VfcHRyIF9feCkgbm9leGNl
cHQKICAgIHsKICAgICAgd2hpbGUgKF9feC0+X01fbGVmdCAhPSAwKSBfX3ggPSBfX3gtPl9NX2xl
ZnQ7CiAgICAgIHJldHVybiBfX3g7CiAgICB9CgogICAgc3RhdGljIF9CYXNlX3B0cgogICAgX1Nf
bWF4aW11bShfQmFzZV9wdHIgX194KSBub2V4Y2VwdAogICAgewogICAgICB3aGlsZSAoX194LT5f
TV9yaWdodCAhPSAwKSBfX3ggPSBfX3gtPl9NX3JpZ2h0OwogICAgICByZXR1cm4gX194OwogICAg
fQoKICAgIHN0YXRpYyBfQ29uc3RfQmFzZV9wdHIKICAgIF9TX21heGltdW0oX0NvbnN0X0Jhc2Vf
cHRyIF9feCkgbm9leGNlcHQKICAgIHsKICAgICAgd2hpbGUgKF9feC0+X01fcmlnaHQgIT0gMCkg
X194ID0gX194LT5fTV9yaWdodDsKICAgICAgcmV0dXJuIF9feDsKICAgIH0KICB9OwoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfVmFsPgogICAgc3RydWN0IF9SYl90cmVlX25vZGUgOiBwdWJsaWMgX1Ji
X3RyZWVfbm9kZV9iYXNlCiAgICB7CiAgICAgIHR5cGVkZWYgX1JiX3RyZWVfbm9kZTxfVmFsPiog
X0xpbmtfdHlwZTsKIyAxNDkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfdHJlZS5o
IiAzCiAgICAgIF9fZ251X2N4eDo6X19hbGlnbmVkX21lbWJ1ZjxfVmFsPiBfTV9zdG9yYWdlOwoK
ICAgICAgX1ZhbCoKICAgICAgX01fdmFscHRyKCkKICAgICAgeyByZXR1cm4gX01fc3RvcmFnZS5f
TV9wdHIoKTsgfQoKICAgICAgY29uc3QgX1ZhbCoKICAgICAgX01fdmFscHRyKCkgY29uc3QKICAg
ICAgeyByZXR1cm4gX01fc3RvcmFnZS5fTV9wdHIoKTsgfQoKICAgIH07CgogIF9fYXR0cmlidXRl
X18gKChfX3B1cmVfXykpIF9SYl90cmVlX25vZGVfYmFzZSoKICBfUmJfdHJlZV9pbmNyZW1lbnQo
X1JiX3RyZWVfbm9kZV9iYXNlKiBfX3gpIHRocm93ICgpOwoKICBfX2F0dHJpYnV0ZV9fICgoX19w
dXJlX18pKSBjb25zdCBfUmJfdHJlZV9ub2RlX2Jhc2UqCiAgX1JiX3RyZWVfaW5jcmVtZW50KGNv
bnN0IF9SYl90cmVlX25vZGVfYmFzZSogX194KSB0aHJvdyAoKTsKCiAgX19hdHRyaWJ1dGVfXyAo
KF9fcHVyZV9fKSkgX1JiX3RyZWVfbm9kZV9iYXNlKgogIF9SYl90cmVlX2RlY3JlbWVudChfUmJf
dHJlZV9ub2RlX2Jhc2UqIF9feCkgdGhyb3cgKCk7CgogIF9fYXR0cmlidXRlX18gKChfX3B1cmVf
XykpIGNvbnN0IF9SYl90cmVlX25vZGVfYmFzZSoKICBfUmJfdHJlZV9kZWNyZW1lbnQoY29uc3Qg
X1JiX3RyZWVfbm9kZV9iYXNlKiBfX3gpIHRocm93ICgpOwoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBf
VHA+CiAgICBzdHJ1Y3QgX1JiX3RyZWVfaXRlcmF0b3IKICAgIHsKICAgICAgdHlwZWRlZiBfVHAg
dmFsdWVfdHlwZTsKICAgICAgdHlwZWRlZiBfVHAmIHJlZmVyZW5jZTsKICAgICAgdHlwZWRlZiBf
VHAqIHBvaW50ZXI7CgogICAgICB0eXBlZGVmIGJpZGlyZWN0aW9uYWxfaXRlcmF0b3JfdGFnIGl0
ZXJhdG9yX2NhdGVnb3J5OwogICAgICB0eXBlZGVmIHB0cmRpZmZfdCBkaWZmZXJlbmNlX3R5cGU7
CgogICAgICB0eXBlZGVmIF9SYl90cmVlX2l0ZXJhdG9yPF9UcD4gX1NlbGY7CiAgICAgIHR5cGVk
ZWYgX1JiX3RyZWVfbm9kZV9iYXNlOjpfQmFzZV9wdHIgX0Jhc2VfcHRyOwogICAgICB0eXBlZGVm
IF9SYl90cmVlX25vZGU8X1RwPiogX0xpbmtfdHlwZTsKCiAgICAgIF9SYl90cmVlX2l0ZXJhdG9y
KCkgbm9leGNlcHQKICAgICAgOiBfTV9ub2RlKCkgeyB9CgogICAgICBleHBsaWNpdAogICAgICBf
UmJfdHJlZV9pdGVyYXRvcihfQmFzZV9wdHIgX194KSBub2V4Y2VwdAogICAgICA6IF9NX25vZGUo
X194KSB7IH0KCiAgICAgIHJlZmVyZW5jZQogICAgICBvcGVyYXRvciooKSBjb25zdCBub2V4Y2Vw
dAogICAgICB7IHJldHVybiAqc3RhdGljX2Nhc3Q8X0xpbmtfdHlwZT4oX01fbm9kZSktPl9NX3Zh
bHB0cigpOyB9CgogICAgICBwb2ludGVyCiAgICAgIG9wZXJhdG9yLT4oKSBjb25zdCBub2V4Y2Vw
dAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxfTGlua190eXBlPiAoX01fbm9kZSktPl9NX3Zh
bHB0cigpOyB9CgogICAgICBfU2VsZiYKICAgICAgb3BlcmF0b3IrKygpIG5vZXhjZXB0CiAgICAg
IHsKIF9NX25vZGUgPSBfUmJfdHJlZV9pbmNyZW1lbnQoX01fbm9kZSk7CiByZXR1cm4gKnRoaXM7
CiAgICAgIH0KCiAgICAgIF9TZWxmCiAgICAgIG9wZXJhdG9yKysoaW50KSBub2V4Y2VwdAogICAg
ICB7CiBfU2VsZiBfX3RtcCA9ICp0aGlzOwogX01fbm9kZSA9IF9SYl90cmVlX2luY3JlbWVudChf
TV9ub2RlKTsKIHJldHVybiBfX3RtcDsKICAgICAgfQoKICAgICAgX1NlbGYmCiAgICAgIG9wZXJh
dG9yLS0oKSBub2V4Y2VwdAogICAgICB7CiBfTV9ub2RlID0gX1JiX3RyZWVfZGVjcmVtZW50KF9N
X25vZGUpOwogcmV0dXJuICp0aGlzOwogICAgICB9CgogICAgICBfU2VsZgogICAgICBvcGVyYXRv
ci0tKGludCkgbm9leGNlcHQKICAgICAgewogX1NlbGYgX190bXAgPSAqdGhpczsKIF9NX25vZGUg
PSBfUmJfdHJlZV9kZWNyZW1lbnQoX01fbm9kZSk7CiByZXR1cm4gX190bXA7CiAgICAgIH0KCiAg
ICAgIGJvb2wKICAgICAgb3BlcmF0b3I9PShjb25zdCBfU2VsZiYgX194KSBjb25zdCBub2V4Y2Vw
dAogICAgICB7IHJldHVybiBfTV9ub2RlID09IF9feC5fTV9ub2RlOyB9CgogICAgICBib29sCiAg
ICAgIG9wZXJhdG9yIT0oY29uc3QgX1NlbGYmIF9feCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyBy
ZXR1cm4gX01fbm9kZSAhPSBfX3guX01fbm9kZTsgfQoKICAgICAgX0Jhc2VfcHRyIF9NX25vZGU7
CiAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogICAgc3RydWN0IF9SYl90cmVlX2NvbnN0
X2l0ZXJhdG9yCiAgICB7CiAgICAgIHR5cGVkZWYgX1RwIHZhbHVlX3R5cGU7CiAgICAgIHR5cGVk
ZWYgY29uc3QgX1RwJiByZWZlcmVuY2U7CiAgICAgIHR5cGVkZWYgY29uc3QgX1RwKiBwb2ludGVy
OwoKICAgICAgdHlwZWRlZiBfUmJfdHJlZV9pdGVyYXRvcjxfVHA+IGl0ZXJhdG9yOwoKICAgICAg
dHlwZWRlZiBiaWRpcmVjdGlvbmFsX2l0ZXJhdG9yX3RhZyBpdGVyYXRvcl9jYXRlZ29yeTsKICAg
ICAgdHlwZWRlZiBwdHJkaWZmX3QgZGlmZmVyZW5jZV90eXBlOwoKICAgICAgdHlwZWRlZiBfUmJf
dHJlZV9jb25zdF9pdGVyYXRvcjxfVHA+IF9TZWxmOwogICAgICB0eXBlZGVmIF9SYl90cmVlX25v
ZGVfYmFzZTo6X0NvbnN0X0Jhc2VfcHRyIF9CYXNlX3B0cjsKICAgICAgdHlwZWRlZiBjb25zdCBf
UmJfdHJlZV9ub2RlPF9UcD4qIF9MaW5rX3R5cGU7CgogICAgICBfUmJfdHJlZV9jb25zdF9pdGVy
YXRvcigpIG5vZXhjZXB0CiAgICAgIDogX01fbm9kZSgpIHsgfQoKICAgICAgZXhwbGljaXQKICAg
ICAgX1JiX3RyZWVfY29uc3RfaXRlcmF0b3IoX0Jhc2VfcHRyIF9feCkgbm9leGNlcHQKICAgICAg
OiBfTV9ub2RlKF9feCkgeyB9CgogICAgICBfUmJfdHJlZV9jb25zdF9pdGVyYXRvcihjb25zdCBp
dGVyYXRvciYgX19pdCkgbm9leGNlcHQKICAgICAgOiBfTV9ub2RlKF9faXQuX01fbm9kZSkgeyB9
CgogICAgICBpdGVyYXRvcgogICAgICBfTV9jb25zdF9jYXN0KCkgY29uc3Qgbm9leGNlcHQKICAg
ICAgeyByZXR1cm4gaXRlcmF0b3IoY29uc3RfY2FzdDx0eXBlbmFtZSBpdGVyYXRvcjo6X0Jhc2Vf
cHRyPihfTV9ub2RlKSk7IH0KCiAgICAgIHJlZmVyZW5jZQogICAgICBvcGVyYXRvciooKSBjb25z
dCBub2V4Y2VwdAogICAgICB7IHJldHVybiAqc3RhdGljX2Nhc3Q8X0xpbmtfdHlwZT4oX01fbm9k
ZSktPl9NX3ZhbHB0cigpOyB9CgogICAgICBwb2ludGVyCiAgICAgIG9wZXJhdG9yLT4oKSBjb25z
dCBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxfTGlua190eXBlPihfTV9ub2Rl
KS0+X01fdmFscHRyKCk7IH0KCiAgICAgIF9TZWxmJgogICAgICBvcGVyYXRvcisrKCkgbm9leGNl
cHQKICAgICAgewogX01fbm9kZSA9IF9SYl90cmVlX2luY3JlbWVudChfTV9ub2RlKTsKIHJldHVy
biAqdGhpczsKICAgICAgfQoKICAgICAgX1NlbGYKICAgICAgb3BlcmF0b3IrKyhpbnQpIG5vZXhj
ZXB0CiAgICAgIHsKIF9TZWxmIF9fdG1wID0gKnRoaXM7CiBfTV9ub2RlID0gX1JiX3RyZWVfaW5j
cmVtZW50KF9NX25vZGUpOwogcmV0dXJuIF9fdG1wOwogICAgICB9CgogICAgICBfU2VsZiYKICAg
ICAgb3BlcmF0b3ItLSgpIG5vZXhjZXB0CiAgICAgIHsKIF9NX25vZGUgPSBfUmJfdHJlZV9kZWNy
ZW1lbnQoX01fbm9kZSk7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCiAgICAgIF9TZWxmCiAgICAg
IG9wZXJhdG9yLS0oaW50KSBub2V4Y2VwdAogICAgICB7CiBfU2VsZiBfX3RtcCA9ICp0aGlzOwog
X01fbm9kZSA9IF9SYl90cmVlX2RlY3JlbWVudChfTV9ub2RlKTsKIHJldHVybiBfX3RtcDsKICAg
ICAgfQoKICAgICAgYm9vbAogICAgICBvcGVyYXRvcj09KGNvbnN0IF9TZWxmJiBfX3gpIGNvbnN0
IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX25vZGUgPT0gX194Ll9NX25vZGU7IH0KCiAgICAg
IGJvb2wKICAgICAgb3BlcmF0b3IhPShjb25zdCBfU2VsZiYgX194KSBjb25zdCBub2V4Y2VwdAog
ICAgICB7IHJldHVybiBfTV9ub2RlICE9IF9feC5fTV9ub2RlOyB9CgogICAgICBfQmFzZV9wdHIg
X01fbm9kZTsKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9WYWw+CiAgICBpbmxpbmUgYm9v
bAogICAgb3BlcmF0b3I9PShjb25zdCBfUmJfdHJlZV9pdGVyYXRvcjxfVmFsPiYgX194LAogICAg
ICAgICAgICAgICBjb25zdCBfUmJfdHJlZV9jb25zdF9pdGVyYXRvcjxfVmFsPiYgX195KSBub2V4
Y2VwdAogICAgeyByZXR1cm4gX194Ll9NX25vZGUgPT0gX195Ll9NX25vZGU7IH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX1ZhbD4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvciE9KGNvbnN0IF9S
Yl90cmVlX2l0ZXJhdG9yPF9WYWw+JiBfX3gsCiAgICAgICAgICAgICAgIGNvbnN0IF9SYl90cmVl
X2NvbnN0X2l0ZXJhdG9yPF9WYWw+JiBfX3kpIG5vZXhjZXB0CiAgICB7IHJldHVybiBfX3guX01f
bm9kZSAhPSBfX3kuX01fbm9kZTsgfQoKICB2b2lkCiAgX1JiX3RyZWVfaW5zZXJ0X2FuZF9yZWJh
bGFuY2UoY29uc3QgYm9vbCBfX2luc2VydF9sZWZ0LAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIF9SYl90cmVlX25vZGVfYmFzZSogX194LAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIF9SYl90cmVlX25vZGVfYmFzZSogX19wLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIF9SYl90cmVlX25vZGVfYmFzZSYgX19oZWFkZXIpIHRocm93ICgpOwoKICBfUmJfdHJl
ZV9ub2RlX2Jhc2UqCiAgX1JiX3RyZWVfcmViYWxhbmNlX2Zvcl9lcmFzZShfUmJfdHJlZV9ub2Rl
X2Jhc2UqIGNvbnN0IF9feiwKICAgICAgICAgIF9SYl90cmVlX25vZGVfYmFzZSYgX19oZWFkZXIp
IHRocm93ICgpOwojIDM1NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF90cmVlLmgi
IDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5
T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jID0g
YWxsb2NhdG9yPF9WYWw+ID4KICAgIGNsYXNzIF9SYl90cmVlCiAgICB7CiAgICAgIHR5cGVkZWYg
dHlwZW5hbWUgX19nbnVfY3h4OjpfX2FsbG9jX3RyYWl0czxfQWxsb2M+Ojp0ZW1wbGF0ZQogICAg
ICAgIHJlYmluZDxfUmJfdHJlZV9ub2RlPF9WYWw+ID46Om90aGVyIF9Ob2RlX2FsbG9jYXRvcjsK
CiAgICAgIHR5cGVkZWYgX19nbnVfY3h4OjpfX2FsbG9jX3RyYWl0czxfTm9kZV9hbGxvY2F0b3I+
IF9BbGxvY190cmFpdHM7CgogICAgcHJvdGVjdGVkOgogICAgICB0eXBlZGVmIF9SYl90cmVlX25v
ZGVfYmFzZSogX0Jhc2VfcHRyOwogICAgICB0eXBlZGVmIGNvbnN0IF9SYl90cmVlX25vZGVfYmFz
ZSogX0NvbnN0X0Jhc2VfcHRyOwogICAgICB0eXBlZGVmIF9SYl90cmVlX25vZGU8X1ZhbD4qIF9M
aW5rX3R5cGU7CiAgICAgIHR5cGVkZWYgY29uc3QgX1JiX3RyZWVfbm9kZTxfVmFsPiogX0NvbnN0
X0xpbmtfdHlwZTsKCiAgICBwcml2YXRlOgoKCiAgICAgIHN0cnVjdCBfUmV1c2Vfb3JfYWxsb2Nf
bm9kZQogICAgICB7CiBfUmV1c2Vfb3JfYWxsb2Nfbm9kZShfUmJfdHJlZSYgX190KQogICA6IF9N
X3Jvb3QoX190Ll9NX3Jvb3QoKSksIF9NX25vZGVzKF9fdC5fTV9yaWdodG1vc3QoKSksIF9NX3Qo
X190KQogewogICBpZiAoX01fcm9vdCkKICAgICB7CiAgICAgICBfTV9yb290LT5fTV9wYXJlbnQg
PSAwOwoKICAgICAgIGlmIChfTV9ub2Rlcy0+X01fbGVmdCkKICBfTV9ub2RlcyA9IF9NX25vZGVz
LT5fTV9sZWZ0OwogICAgIH0KICAgZWxzZQogICAgIF9NX25vZGVzID0gMDsKIH0KCgogX1JldXNl
X29yX2FsbG9jX25vZGUoY29uc3QgX1JldXNlX29yX2FsbG9jX25vZGUmKSA9IGRlbGV0ZTsKCgog
fl9SZXVzZV9vcl9hbGxvY19ub2RlKCkKIHsgX01fdC5fTV9lcmFzZShzdGF0aWNfY2FzdDxfTGlu
a190eXBlPihfTV9yb290KSk7IH0KCiB0ZW1wbGF0ZTx0eXBlbmFtZSBfQXJnPgogICBfTGlua190
eXBlCgoKCiAgIG9wZXJhdG9yKCkoX0FyZyYmIF9fYXJnKQoKICAgewogICAgIF9MaW5rX3R5cGUg
X19ub2RlID0gc3RhdGljX2Nhc3Q8X0xpbmtfdHlwZT4oX01fZXh0cmFjdCgpKTsKICAgICBpZiAo
X19ub2RlKQogICAgICAgewogIF9NX3QuX01fZGVzdHJveV9ub2RlKF9fbm9kZSk7CiAgX01fdC5f
TV9jb25zdHJ1Y3Rfbm9kZShfX25vZGUsIHN0ZDo6Zm9yd2FyZDxfQXJnPihfX2FyZykpOwogIHJl
dHVybiBfX25vZGU7CiAgICAgICB9CgogICAgIHJldHVybiBfTV90Ll9NX2NyZWF0ZV9ub2RlKHN0
ZDo6Zm9yd2FyZDxfQXJnPihfX2FyZykpOwogICB9CgogICAgICBwcml2YXRlOgogX0Jhc2VfcHRy
CiBfTV9leHRyYWN0KCkKIHsKICAgaWYgKCFfTV9ub2RlcykKICAgICByZXR1cm4gX01fbm9kZXM7
CgogICBfQmFzZV9wdHIgX19ub2RlID0gX01fbm9kZXM7CiAgIF9NX25vZGVzID0gX01fbm9kZXMt
Pl9NX3BhcmVudDsKICAgaWYgKF9NX25vZGVzKQogICAgIHsKICAgICAgIGlmIChfTV9ub2Rlcy0+
X01fcmlnaHQgPT0gX19ub2RlKQogIHsKICAgIF9NX25vZGVzLT5fTV9yaWdodCA9IDA7CgogICAg
aWYgKF9NX25vZGVzLT5fTV9sZWZ0KQogICAgICB7CiAgICAgICAgX01fbm9kZXMgPSBfTV9ub2Rl
cy0+X01fbGVmdDsKCiAgICAgICAgd2hpbGUgKF9NX25vZGVzLT5fTV9yaWdodCkKICAgX01fbm9k
ZXMgPSBfTV9ub2Rlcy0+X01fcmlnaHQ7CgogICAgICAgIGlmIChfTV9ub2Rlcy0+X01fbGVmdCkK
ICAgX01fbm9kZXMgPSBfTV9ub2Rlcy0+X01fbGVmdDsKICAgICAgfQogIH0KICAgICAgIGVsc2UK
ICBfTV9ub2Rlcy0+X01fbGVmdCA9IDA7CiAgICAgfQogICBlbHNlCiAgICAgX01fcm9vdCA9IDA7
CgogICByZXR1cm4gX19ub2RlOwogfQoKIF9CYXNlX3B0ciBfTV9yb290OwogX0Jhc2VfcHRyIF9N
X25vZGVzOwogX1JiX3RyZWUmIF9NX3Q7CiAgICAgIH07CgoKCiAgICAgIHN0cnVjdCBfQWxsb2Nf
bm9kZQogICAgICB7CiBfQWxsb2Nfbm9kZShfUmJfdHJlZSYgX190KQogICA6IF9NX3QoX190KSB7
IH0KCiB0ZW1wbGF0ZTx0eXBlbmFtZSBfQXJnPgogICBfTGlua190eXBlCgoKCiAgIG9wZXJhdG9y
KCkoX0FyZyYmIF9fYXJnKSBjb25zdAoKICAgeyByZXR1cm4gX01fdC5fTV9jcmVhdGVfbm9kZShz
dGQ6OmZvcndhcmQ8X0FyZz4oX19hcmcpKTsgfQoKICAgICAgcHJpdmF0ZToKIF9SYl90cmVlJiBf
TV90OwogICAgICB9OwoKICAgIHB1YmxpYzoKICAgICAgdHlwZWRlZiBfS2V5IGtleV90eXBlOwog
ICAgICB0eXBlZGVmIF9WYWwgdmFsdWVfdHlwZTsKICAgICAgdHlwZWRlZiB2YWx1ZV90eXBlKiBw
b2ludGVyOwogICAgICB0eXBlZGVmIGNvbnN0IHZhbHVlX3R5cGUqIGNvbnN0X3BvaW50ZXI7CiAg
ICAgIHR5cGVkZWYgdmFsdWVfdHlwZSYgcmVmZXJlbmNlOwogICAgICB0eXBlZGVmIGNvbnN0IHZh
bHVlX3R5cGUmIGNvbnN0X3JlZmVyZW5jZTsKICAgICAgdHlwZWRlZiBzaXplX3Qgc2l6ZV90eXBl
OwogICAgICB0eXBlZGVmIHB0cmRpZmZfdCBkaWZmZXJlbmNlX3R5cGU7CiAgICAgIHR5cGVkZWYg
X0FsbG9jIGFsbG9jYXRvcl90eXBlOwoKICAgICAgX05vZGVfYWxsb2NhdG9yJgogICAgICBfTV9n
ZXRfTm9kZV9hbGxvY2F0b3IoKSBub2V4Y2VwdAogICAgICB7IHJldHVybiAqc3RhdGljX2Nhc3Q8
X05vZGVfYWxsb2NhdG9yKj4oJnRoaXMtPl9NX2ltcGwpOyB9CgogICAgICBjb25zdCBfTm9kZV9h
bGxvY2F0b3ImCiAgICAgIF9NX2dldF9Ob2RlX2FsbG9jYXRvcigpIGNvbnN0IG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuICpzdGF0aWNfY2FzdDxjb25zdCBfTm9kZV9hbGxvY2F0b3IqPigmdGhpcy0+
X01faW1wbCk7IH0KCiAgICAgIGFsbG9jYXRvcl90eXBlCiAgICAgIGdldF9hbGxvY2F0b3IoKSBj
b25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBhbGxvY2F0b3JfdHlwZShfTV9nZXRfTm9kZV9h
bGxvY2F0b3IoKSk7IH0KCiAgICBwcm90ZWN0ZWQ6CiAgICAgIF9MaW5rX3R5cGUKICAgICAgX01f
Z2V0X25vZGUoKQogICAgICB7IHJldHVybiBfQWxsb2NfdHJhaXRzOjphbGxvY2F0ZShfTV9nZXRf
Tm9kZV9hbGxvY2F0b3IoKSwgMSk7IH0KCiAgICAgIHZvaWQKICAgICAgX01fcHV0X25vZGUoX0xp
bmtfdHlwZSBfX3ApIG5vZXhjZXB0CiAgICAgIHsgX0FsbG9jX3RyYWl0czo6ZGVhbGxvY2F0ZShf
TV9nZXRfTm9kZV9hbGxvY2F0b3IoKSwgX19wLCAxKTsgfQojIDUzMiAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL3N0bF90cmVlLmgiIDMKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX0Fy
Z3M+CiB2b2lkCiBfTV9jb25zdHJ1Y3Rfbm9kZShfTGlua190eXBlIF9fbm9kZSwgX0FyZ3MmJi4u
LiBfX2FyZ3MpCiB7CiAgIHRyeQogICAgIHsKICAgICAgIDo6bmV3KF9fbm9kZSkgX1JiX3RyZWVf
bm9kZTxfVmFsPjsKICAgICAgIF9BbGxvY190cmFpdHM6OmNvbnN0cnVjdChfTV9nZXRfTm9kZV9h
bGxvY2F0b3IoKSwKICAgICAgICAgICBfX25vZGUtPl9NX3ZhbHB0cigpLAogICAgICAgICAgIHN0
ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLik7CiAgICAgfQogICBjYXRjaCguLi4pCiAgICAg
ewogICAgICAgX19ub2RlLT5+X1JiX3RyZWVfbm9kZTxfVmFsPigpOwogICAgICAgX01fcHV0X25v
ZGUoX19ub2RlKTsKICAgICAgIHRocm93OwogICAgIH0KIH0KCiAgICAgIHRlbXBsYXRlPHR5cGVu
YW1lLi4uIF9BcmdzPgogICAgICAgIF9MaW5rX3R5cGUKICAgICAgICBfTV9jcmVhdGVfbm9kZShf
QXJncyYmLi4uIF9fYXJncykKIHsKICAgX0xpbmtfdHlwZSBfX3RtcCA9IF9NX2dldF9ub2RlKCk7
CiAgIF9NX2NvbnN0cnVjdF9ub2RlKF9fdG1wLCBzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9fYXJncyku
Li4pOwogICByZXR1cm4gX190bXA7CiB9CgogICAgICB2b2lkCiAgICAgIF9NX2Rlc3Ryb3lfbm9k
ZShfTGlua190eXBlIF9fcCkgbm9leGNlcHQKICAgICAgewogX0FsbG9jX3RyYWl0czo6ZGVzdHJv
eShfTV9nZXRfTm9kZV9hbGxvY2F0b3IoKSwgX19wLT5fTV92YWxwdHIoKSk7CiBfX3AtPn5fUmJf
dHJlZV9ub2RlPF9WYWw+KCk7CiAgICAgIH0KCgogICAgICB2b2lkCiAgICAgIF9NX2Ryb3Bfbm9k
ZShfTGlua190eXBlIF9fcCkgbm9leGNlcHQKICAgICAgewogX01fZGVzdHJveV9ub2RlKF9fcCk7
CiBfTV9wdXRfbm9kZShfX3ApOwogICAgICB9CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfTm9k
ZUdlbj4KIF9MaW5rX3R5cGUKIF9NX2Nsb25lX25vZGUoX0NvbnN0X0xpbmtfdHlwZSBfX3gsIF9O
b2RlR2VuJiBfX25vZGVfZ2VuKQogewogICBfTGlua190eXBlIF9fdG1wID0gX19ub2RlX2dlbigq
X194LT5fTV92YWxwdHIoKSk7CiAgIF9fdG1wLT5fTV9jb2xvciA9IF9feC0+X01fY29sb3I7CiAg
IF9fdG1wLT5fTV9sZWZ0ID0gMDsKICAgX190bXAtPl9NX3JpZ2h0ID0gMDsKICAgcmV0dXJuIF9f
dG1wOwogfQoKICAgIHByb3RlY3RlZDoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXlfY29t
cGFyZSwKICAgICAgICBib29sID0gX19pc19wb2QoX0tleV9jb21wYXJlKT4KICAgICAgICBzdHJ1
Y3QgX1JiX3RyZWVfaW1wbCA6IHB1YmxpYyBfTm9kZV9hbGxvY2F0b3IKICAgICAgICB7CiAgIF9L
ZXlfY29tcGFyZSBfTV9rZXlfY29tcGFyZTsKICAgX1JiX3RyZWVfbm9kZV9iYXNlIF9NX2hlYWRl
cjsKICAgc2l6ZV90eXBlIF9NX25vZGVfY291bnQ7CgogICBfUmJfdHJlZV9pbXBsKCkKICAgOiBf
Tm9kZV9hbGxvY2F0b3IoKSwgX01fa2V5X2NvbXBhcmUoKSwgX01faGVhZGVyKCksCiAgICAgX01f
bm9kZV9jb3VudCgwKQogICB7IF9NX2luaXRpYWxpemUoKTsgfQoKICAgX1JiX3RyZWVfaW1wbChj
b25zdCBfS2V5X2NvbXBhcmUmIF9fY29tcCwgY29uc3QgX05vZGVfYWxsb2NhdG9yJiBfX2EpCiAg
IDogX05vZGVfYWxsb2NhdG9yKF9fYSksIF9NX2tleV9jb21wYXJlKF9fY29tcCksIF9NX2hlYWRl
cigpLAogICAgIF9NX25vZGVfY291bnQoMCkKICAgeyBfTV9pbml0aWFsaXplKCk7IH0KCgogICBf
UmJfdHJlZV9pbXBsKGNvbnN0IF9LZXlfY29tcGFyZSYgX19jb21wLCBfTm9kZV9hbGxvY2F0b3Im
JiBfX2EpCiAgIDogX05vZGVfYWxsb2NhdG9yKHN0ZDo6bW92ZShfX2EpKSwgX01fa2V5X2NvbXBh
cmUoX19jb21wKSwKICAgICBfTV9oZWFkZXIoKSwgX01fbm9kZV9jb3VudCgwKQogICB7IF9NX2lu
aXRpYWxpemUoKTsgfQoKCiAgIHZvaWQKICAgX01fcmVzZXQoKQogICB7CiAgICAgdGhpcy0+X01f
aGVhZGVyLl9NX3BhcmVudCA9IDA7CiAgICAgdGhpcy0+X01faGVhZGVyLl9NX2xlZnQgPSAmdGhp
cy0+X01faGVhZGVyOwogICAgIHRoaXMtPl9NX2hlYWRlci5fTV9yaWdodCA9ICZ0aGlzLT5fTV9o
ZWFkZXI7CiAgICAgdGhpcy0+X01fbm9kZV9jb3VudCA9IDA7CiAgIH0KCiBwcml2YXRlOgogICB2
b2lkCiAgIF9NX2luaXRpYWxpemUoKQogICB7CiAgICAgdGhpcy0+X01faGVhZGVyLl9NX2NvbG9y
ID0gX1NfcmVkOwogICAgIHRoaXMtPl9NX2hlYWRlci5fTV9wYXJlbnQgPSAwOwogICAgIHRoaXMt
Pl9NX2hlYWRlci5fTV9sZWZ0ID0gJnRoaXMtPl9NX2hlYWRlcjsKICAgICB0aGlzLT5fTV9oZWFk
ZXIuX01fcmlnaHQgPSAmdGhpcy0+X01faGVhZGVyOwogICB9CiB9OwoKICAgICAgX1JiX3RyZWVf
aW1wbDxfQ29tcGFyZT4gX01faW1wbDsKCiAgICBwcm90ZWN0ZWQ6CiAgICAgIF9CYXNlX3B0ciYK
ICAgICAgX01fcm9vdCgpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHRoaXMtPl9NX2ltcGwuX01f
aGVhZGVyLl9NX3BhcmVudDsgfQoKICAgICAgX0NvbnN0X0Jhc2VfcHRyCiAgICAgIF9NX3Jvb3Qo
KSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiB0aGlzLT5fTV9pbXBsLl9NX2hlYWRlci5f
TV9wYXJlbnQ7IH0KCiAgICAgIF9CYXNlX3B0ciYKICAgICAgX01fbGVmdG1vc3QoKSBub2V4Y2Vw
dAogICAgICB7IHJldHVybiB0aGlzLT5fTV9pbXBsLl9NX2hlYWRlci5fTV9sZWZ0OyB9CgogICAg
ICBfQ29uc3RfQmFzZV9wdHIKICAgICAgX01fbGVmdG1vc3QoKSBjb25zdCBub2V4Y2VwdAogICAg
ICB7IHJldHVybiB0aGlzLT5fTV9pbXBsLl9NX2hlYWRlci5fTV9sZWZ0OyB9CgogICAgICBfQmFz
ZV9wdHImCiAgICAgIF9NX3JpZ2h0bW9zdCgpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHRoaXMt
Pl9NX2ltcGwuX01faGVhZGVyLl9NX3JpZ2h0OyB9CgogICAgICBfQ29uc3RfQmFzZV9wdHIKICAg
ICAgX01fcmlnaHRtb3N0KCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gdGhpcy0+X01f
aW1wbC5fTV9oZWFkZXIuX01fcmlnaHQ7IH0KCiAgICAgIF9MaW5rX3R5cGUKICAgICAgX01fYmVn
aW4oKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxfTGlua190eXBlPih0aGlz
LT5fTV9pbXBsLl9NX2hlYWRlci5fTV9wYXJlbnQpOyB9CgogICAgICBfQ29uc3RfTGlua190eXBl
CiAgICAgIF9NX2JlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAgICAgewogcmV0dXJuIHN0YXRpY19j
YXN0PF9Db25zdF9MaW5rX3R5cGU+CiAgICh0aGlzLT5fTV9pbXBsLl9NX2hlYWRlci5fTV9wYXJl
bnQpOwogICAgICB9CgogICAgICBfQmFzZV9wdHIKICAgICAgX01fZW5kKCkgbm9leGNlcHQKICAg
ICAgeyByZXR1cm4gJnRoaXMtPl9NX2ltcGwuX01faGVhZGVyOyB9CgogICAgICBfQ29uc3RfQmFz
ZV9wdHIKICAgICAgX01fZW5kKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gJnRoaXMt
Pl9NX2ltcGwuX01faGVhZGVyOyB9CgogICAgICBzdGF0aWMgY29uc3RfcmVmZXJlbmNlCiAgICAg
IF9TX3ZhbHVlKF9Db25zdF9MaW5rX3R5cGUgX194KQogICAgICB7IHJldHVybiAqX194LT5fTV92
YWxwdHIoKTsgfQoKICAgICAgc3RhdGljIGNvbnN0IF9LZXkmCiAgICAgIF9TX2tleShfQ29uc3Rf
TGlua190eXBlIF9feCkKICAgICAgeyByZXR1cm4gX0tleU9mVmFsdWUoKShfU192YWx1ZShfX3gp
KTsgfQoKICAgICAgc3RhdGljIF9MaW5rX3R5cGUKICAgICAgX1NfbGVmdChfQmFzZV9wdHIgX194
KSBub2V4Y2VwdAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxfTGlua190eXBlPihfX3gtPl9N
X2xlZnQpOyB9CgogICAgICBzdGF0aWMgX0NvbnN0X0xpbmtfdHlwZQogICAgICBfU19sZWZ0KF9D
b25zdF9CYXNlX3B0ciBfX3gpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0YXRpY19jYXN0PF9D
b25zdF9MaW5rX3R5cGU+KF9feC0+X01fbGVmdCk7IH0KCiAgICAgIHN0YXRpYyBfTGlua190eXBl
CiAgICAgIF9TX3JpZ2h0KF9CYXNlX3B0ciBfX3gpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHN0
YXRpY19jYXN0PF9MaW5rX3R5cGU+KF9feC0+X01fcmlnaHQpOyB9CgogICAgICBzdGF0aWMgX0Nv
bnN0X0xpbmtfdHlwZQogICAgICBfU19yaWdodChfQ29uc3RfQmFzZV9wdHIgX194KSBub2V4Y2Vw
dAogICAgICB7IHJldHVybiBzdGF0aWNfY2FzdDxfQ29uc3RfTGlua190eXBlPihfX3gtPl9NX3Jp
Z2h0KTsgfQoKICAgICAgc3RhdGljIGNvbnN0X3JlZmVyZW5jZQogICAgICBfU192YWx1ZShfQ29u
c3RfQmFzZV9wdHIgX194KQogICAgICB7IHJldHVybiAqc3RhdGljX2Nhc3Q8X0NvbnN0X0xpbmtf
dHlwZT4oX194KS0+X01fdmFscHRyKCk7IH0KCiAgICAgIHN0YXRpYyBjb25zdCBfS2V5JgogICAg
ICBfU19rZXkoX0NvbnN0X0Jhc2VfcHRyIF9feCkKICAgICAgeyByZXR1cm4gX0tleU9mVmFsdWUo
KShfU192YWx1ZShfX3gpKTsgfQoKICAgICAgc3RhdGljIF9CYXNlX3B0cgogICAgICBfU19taW5p
bXVtKF9CYXNlX3B0ciBfX3gpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9SYl90cmVlX25vZGVf
YmFzZTo6X1NfbWluaW11bShfX3gpOyB9CgogICAgICBzdGF0aWMgX0NvbnN0X0Jhc2VfcHRyCiAg
ICAgIF9TX21pbmltdW0oX0NvbnN0X0Jhc2VfcHRyIF9feCkgbm9leGNlcHQKICAgICAgeyByZXR1
cm4gX1JiX3RyZWVfbm9kZV9iYXNlOjpfU19taW5pbXVtKF9feCk7IH0KCiAgICAgIHN0YXRpYyBf
QmFzZV9wdHIKICAgICAgX1NfbWF4aW11bShfQmFzZV9wdHIgX194KSBub2V4Y2VwdAogICAgICB7
IHJldHVybiBfUmJfdHJlZV9ub2RlX2Jhc2U6Ol9TX21heGltdW0oX194KTsgfQoKICAgICAgc3Rh
dGljIF9Db25zdF9CYXNlX3B0cgogICAgICBfU19tYXhpbXVtKF9Db25zdF9CYXNlX3B0ciBfX3gp
IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9SYl90cmVlX25vZGVfYmFzZTo6X1NfbWF4aW11bShf
X3gpOyB9CgogICAgcHVibGljOgogICAgICB0eXBlZGVmIF9SYl90cmVlX2l0ZXJhdG9yPHZhbHVl
X3R5cGU+IGl0ZXJhdG9yOwogICAgICB0eXBlZGVmIF9SYl90cmVlX2NvbnN0X2l0ZXJhdG9yPHZh
bHVlX3R5cGU+IGNvbnN0X2l0ZXJhdG9yOwoKICAgICAgdHlwZWRlZiBzdGQ6OnJldmVyc2VfaXRl
cmF0b3I8aXRlcmF0b3I+IHJldmVyc2VfaXRlcmF0b3I7CiAgICAgIHR5cGVkZWYgc3RkOjpyZXZl
cnNlX2l0ZXJhdG9yPGNvbnN0X2l0ZXJhdG9yPiBjb25zdF9yZXZlcnNlX2l0ZXJhdG9yOwoKICAg
ICAgcGFpcjxfQmFzZV9wdHIsIF9CYXNlX3B0cj4KICAgICAgX01fZ2V0X2luc2VydF91bmlxdWVf
cG9zKGNvbnN0IGtleV90eXBlJiBfX2spOwoKICAgICAgcGFpcjxfQmFzZV9wdHIsIF9CYXNlX3B0
cj4KICAgICAgX01fZ2V0X2luc2VydF9lcXVhbF9wb3MoY29uc3Qga2V5X3R5cGUmIF9fayk7Cgog
ICAgICBwYWlyPF9CYXNlX3B0ciwgX0Jhc2VfcHRyPgogICAgICBfTV9nZXRfaW5zZXJ0X2hpbnRf
dW5pcXVlX3Bvcyhjb25zdF9pdGVyYXRvciBfX3BvcywKICAgICAgICBjb25zdCBrZXlfdHlwZSYg
X19rKTsKCiAgICAgIHBhaXI8X0Jhc2VfcHRyLCBfQmFzZV9wdHI+CiAgICAgIF9NX2dldF9pbnNl
cnRfaGludF9lcXVhbF9wb3MoY29uc3RfaXRlcmF0b3IgX19wb3MsCiAgICAgICBjb25zdCBrZXlf
dHlwZSYgX19rKTsKCiAgICBwcml2YXRlOgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0FyZywg
dHlwZW5hbWUgX05vZGVHZW4+CiAgICAgICAgaXRlcmF0b3IKIF9NX2luc2VydF8oX0Jhc2VfcHRy
IF9feCwgX0Jhc2VfcHRyIF9feSwgX0FyZyYmIF9fdiwgX05vZGVHZW4mKTsKCiAgICAgIGl0ZXJh
dG9yCiAgICAgIF9NX2luc2VydF9ub2RlKF9CYXNlX3B0ciBfX3gsIF9CYXNlX3B0ciBfX3ksIF9M
aW5rX3R5cGUgX196KTsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Bcmc+CiAgICAgICAgaXRl
cmF0b3IKICAgICAgICBfTV9pbnNlcnRfbG93ZXIoX0Jhc2VfcHRyIF9feSwgX0FyZyYmIF9fdik7
CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQXJnPgogICAgICAgIGl0ZXJhdG9yCiAgICAgICAg
X01faW5zZXJ0X2VxdWFsX2xvd2VyKF9BcmcmJiBfX3gpOwoKICAgICAgaXRlcmF0b3IKICAgICAg
X01faW5zZXJ0X2xvd2VyX25vZGUoX0Jhc2VfcHRyIF9fcCwgX0xpbmtfdHlwZSBfX3opOwoKICAg
ICAgaXRlcmF0b3IKICAgICAgX01faW5zZXJ0X2VxdWFsX2xvd2VyX25vZGUoX0xpbmtfdHlwZSBf
X3opOwojIDc4NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF90cmVlLmgiIDMKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX05vZGVHZW4+CiBfTGlua190eXBlCiBfTV9jb3B5KF9Db25z
dF9MaW5rX3R5cGUgX194LCBfQmFzZV9wdHIgX19wLCBfTm9kZUdlbiYpOwoKICAgICAgX0xpbmtf
dHlwZQogICAgICBfTV9jb3B5KF9Db25zdF9MaW5rX3R5cGUgX194LCBfQmFzZV9wdHIgX19wKQog
ICAgICB7CiBfQWxsb2Nfbm9kZSBfX2FuKCp0aGlzKTsKIHJldHVybiBfTV9jb3B5KF9feCwgX19w
LCBfX2FuKTsKICAgICAgfQoKICAgICAgdm9pZAogICAgICBfTV9lcmFzZShfTGlua190eXBlIF9f
eCk7CgogICAgICBpdGVyYXRvcgogICAgICBfTV9sb3dlcl9ib3VuZChfTGlua190eXBlIF9feCwg
X0Jhc2VfcHRyIF9feSwKICAgICAgIGNvbnN0IF9LZXkmIF9fayk7CgogICAgICBjb25zdF9pdGVy
YXRvcgogICAgICBfTV9sb3dlcl9ib3VuZChfQ29uc3RfTGlua190eXBlIF9feCwgX0NvbnN0X0Jh
c2VfcHRyIF9feSwKICAgICAgIGNvbnN0IF9LZXkmIF9faykgY29uc3Q7CgogICAgICBpdGVyYXRv
cgogICAgICBfTV91cHBlcl9ib3VuZChfTGlua190eXBlIF9feCwgX0Jhc2VfcHRyIF9feSwKICAg
ICAgIGNvbnN0IF9LZXkmIF9fayk7CgogICAgICBjb25zdF9pdGVyYXRvcgogICAgICBfTV91cHBl
cl9ib3VuZChfQ29uc3RfTGlua190eXBlIF9feCwgX0NvbnN0X0Jhc2VfcHRyIF9feSwKICAgICAg
IGNvbnN0IF9LZXkmIF9faykgY29uc3Q7CgogICAgcHVibGljOgoKICAgICAgX1JiX3RyZWUoKSB7
IH0KCiAgICAgIF9SYl90cmVlKGNvbnN0IF9Db21wYXJlJiBfX2NvbXAsCiAgICAgICAgY29uc3Qg
YWxsb2NhdG9yX3R5cGUmIF9fYSA9IGFsbG9jYXRvcl90eXBlKCkpCiAgICAgIDogX01faW1wbChf
X2NvbXAsIF9Ob2RlX2FsbG9jYXRvcihfX2EpKSB7IH0KCiAgICAgIF9SYl90cmVlKGNvbnN0IF9S
Yl90cmVlJiBfX3gpCiAgICAgIDogX01faW1wbChfX3guX01faW1wbC5fTV9rZXlfY29tcGFyZSwK
ICAgICAgICAgX0FsbG9jX3RyYWl0czo6X1Nfc2VsZWN0X29uX2NvcHkoX194Ll9NX2dldF9Ob2Rl
X2FsbG9jYXRvcigpKSkKICAgICAgewogaWYgKF9feC5fTV9yb290KCkgIT0gMCkKICAgewogICAg
IF9NX3Jvb3QoKSA9IF9NX2NvcHkoX194Ll9NX2JlZ2luKCksIF9NX2VuZCgpKTsKICAgICBfTV9s
ZWZ0bW9zdCgpID0gX1NfbWluaW11bShfTV9yb290KCkpOwogICAgIF9NX3JpZ2h0bW9zdCgpID0g
X1NfbWF4aW11bShfTV9yb290KCkpOwogICAgIF9NX2ltcGwuX01fbm9kZV9jb3VudCA9IF9feC5f
TV9pbXBsLl9NX25vZGVfY291bnQ7CiAgIH0KICAgICAgfQoKCiAgICAgIF9SYl90cmVlKGNvbnN0
IGFsbG9jYXRvcl90eXBlJiBfX2EpCiAgICAgIDogX01faW1wbChfQ29tcGFyZSgpLCBfTm9kZV9h
bGxvY2F0b3IoX19hKSkKICAgICAgeyB9CgogICAgICBfUmJfdHJlZShjb25zdCBfUmJfdHJlZSYg
X194LCBjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hKQogICAgICA6IF9NX2ltcGwoX194Ll9NX2lt
cGwuX01fa2V5X2NvbXBhcmUsIF9Ob2RlX2FsbG9jYXRvcihfX2EpKQogICAgICB7CiBpZiAoX194
Ll9NX3Jvb3QoKSAhPSBudWxscHRyKQogICB7CiAgICAgX01fcm9vdCgpID0gX01fY29weShfX3gu
X01fYmVnaW4oKSwgX01fZW5kKCkpOwogICAgIF9NX2xlZnRtb3N0KCkgPSBfU19taW5pbXVtKF9N
X3Jvb3QoKSk7CiAgICAgX01fcmlnaHRtb3N0KCkgPSBfU19tYXhpbXVtKF9NX3Jvb3QoKSk7CiAg
ICAgX01faW1wbC5fTV9ub2RlX2NvdW50ID0gX194Ll9NX2ltcGwuX01fbm9kZV9jb3VudDsKICAg
fQogICAgICB9CgogICAgICBfUmJfdHJlZShfUmJfdHJlZSYmIF9feCkKICAgICAgOiBfTV9pbXBs
KF9feC5fTV9pbXBsLl9NX2tleV9jb21wYXJlLCBfX3guX01fZ2V0X05vZGVfYWxsb2NhdG9yKCkp
CiAgICAgIHsKIGlmIChfX3guX01fcm9vdCgpICE9IDApCiAgIF9NX21vdmVfZGF0YShfX3gsIHN0
ZDo6dHJ1ZV90eXBlKCkpOwogICAgICB9CgogICAgICBfUmJfdHJlZShfUmJfdHJlZSYmIF9feCwg
Y29uc3QgYWxsb2NhdG9yX3R5cGUmIF9fYSkKICAgICAgOiBfUmJfdHJlZShzdGQ6Om1vdmUoX194
KSwgX05vZGVfYWxsb2NhdG9yKF9fYSkpCiAgICAgIHsgfQoKICAgICAgX1JiX3RyZWUoX1JiX3Ry
ZWUmJiBfX3gsIF9Ob2RlX2FsbG9jYXRvciYmIF9fYSk7CgoKICAgICAgfl9SYl90cmVlKCkgbm9l
eGNlcHQKICAgICAgeyBfTV9lcmFzZShfTV9iZWdpbigpKTsgfQoKICAgICAgX1JiX3RyZWUmCiAg
ICAgIG9wZXJhdG9yPShjb25zdCBfUmJfdHJlZSYgX194KTsKCgogICAgICBfQ29tcGFyZQogICAg
ICBrZXlfY29tcCgpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX2ltcGwuX01fa2V5X2NvbXBhcmU7
IH0KCiAgICAgIGl0ZXJhdG9yCiAgICAgIGJlZ2luKCkgbm9leGNlcHQKICAgICAgeyByZXR1cm4g
aXRlcmF0b3IodGhpcy0+X01faW1wbC5fTV9oZWFkZXIuX01fbGVmdCk7IH0KCiAgICAgIGNvbnN0
X2l0ZXJhdG9yCiAgICAgIGJlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gY29u
c3RfaXRlcmF0b3IodGhpcy0+X01faW1wbC5fTV9oZWFkZXIuX01fbGVmdCk7IH0KCiAgICAgIGl0
ZXJhdG9yCiAgICAgIGVuZCgpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGl0ZXJhdG9yKCZ0aGlz
LT5fTV9pbXBsLl9NX2hlYWRlcik7IH0KCiAgICAgIGNvbnN0X2l0ZXJhdG9yCiAgICAgIGVuZCgp
IGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGNvbnN0X2l0ZXJhdG9yKCZ0aGlzLT5fTV9p
bXBsLl9NX2hlYWRlcik7IH0KCiAgICAgIHJldmVyc2VfaXRlcmF0b3IKICAgICAgcmJlZ2luKCkg
bm9leGNlcHQKICAgICAgeyByZXR1cm4gcmV2ZXJzZV9pdGVyYXRvcihlbmQoKSk7IH0KCiAgICAg
IGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAgICAgcmJlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAg
ICAgeyByZXR1cm4gY29uc3RfcmV2ZXJzZV9pdGVyYXRvcihlbmQoKSk7IH0KCiAgICAgIHJldmVy
c2VfaXRlcmF0b3IKICAgICAgcmVuZCgpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIHJldmVyc2Vf
aXRlcmF0b3IoYmVnaW4oKSk7IH0KCiAgICAgIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAgICAg
cmVuZCgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIGNvbnN0X3JldmVyc2VfaXRlcmF0
b3IoYmVnaW4oKSk7IH0KCiAgICAgIGJvb2wKICAgICAgZW1wdHkoKSBjb25zdCBub2V4Y2VwdAog
ICAgICB7IHJldHVybiBfTV9pbXBsLl9NX25vZGVfY291bnQgPT0gMDsgfQoKICAgICAgc2l6ZV90
eXBlCiAgICAgIHNpemUoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV9pbXBsLl9N
X25vZGVfY291bnQ7IH0KCiAgICAgIHNpemVfdHlwZQogICAgICBtYXhfc2l6ZSgpIGNvbnN0IG5v
ZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9BbGxvY190cmFpdHM6Om1heF9zaXplKF9NX2dldF9Ob2Rl
X2FsbG9jYXRvcigpKTsgfQoKICAgICAgdm9pZAogICAgICBzd2FwKF9SYl90cmVlJiBfX3QpCiAg
ICAgIG5vZXhjZXB0KF9faXNfbm90aHJvd19zd2FwcGFibGU8X0NvbXBhcmU+Ojp2YWx1ZSk7CgoK
CiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9Bcmc+CiAgICAgICAgcGFpcjxpdGVyYXRvciwgYm9v
bD4KICAgICAgICBfTV9pbnNlcnRfdW5pcXVlKF9BcmcmJiBfX3gpOwoKICAgICAgdGVtcGxhdGU8
dHlwZW5hbWUgX0FyZz4KICAgICAgICBpdGVyYXRvcgogICAgICAgIF9NX2luc2VydF9lcXVhbChf
QXJnJiYgX194KTsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BcmcsIHR5cGVuYW1lIF9Ob2Rl
R2VuPgogICAgICAgIGl0ZXJhdG9yCiBfTV9pbnNlcnRfdW5pcXVlXyhjb25zdF9pdGVyYXRvciBf
X3BvcywgX0FyZyYmIF9feCwgX05vZGVHZW4mKTsKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9B
cmc+CiBpdGVyYXRvcgogX01faW5zZXJ0X3VuaXF1ZV8oY29uc3RfaXRlcmF0b3IgX19wb3MsIF9B
cmcmJiBfX3gpCiB7CiAgIF9BbGxvY19ub2RlIF9fYW4oKnRoaXMpOwogICByZXR1cm4gX01faW5z
ZXJ0X3VuaXF1ZV8oX19wb3MsIHN0ZDo6Zm9yd2FyZDxfQXJnPihfX3gpLCBfX2FuKTsKIH0KCiAg
ICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BcmcsIHR5cGVuYW1lIF9Ob2RlR2VuPgogaXRlcmF0b3IK
IF9NX2luc2VydF9lcXVhbF8oY29uc3RfaXRlcmF0b3IgX19wb3MsIF9BcmcmJiBfX3gsIF9Ob2Rl
R2VuJik7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQXJnPgogaXRlcmF0b3IKIF9NX2luc2Vy
dF9lcXVhbF8oY29uc3RfaXRlcmF0b3IgX19wb3MsIF9BcmcmJiBfX3gpCiB7CiAgIF9BbGxvY19u
b2RlIF9fYW4oKnRoaXMpOwogICByZXR1cm4gX01faW5zZXJ0X2VxdWFsXyhfX3Bvcywgc3RkOjpm
b3J3YXJkPF9Bcmc+KF9feCksIF9fYW4pOwogfQoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4g
X0FyZ3M+CiBwYWlyPGl0ZXJhdG9yLCBib29sPgogX01fZW1wbGFjZV91bmlxdWUoX0FyZ3MmJi4u
LiBfX2FyZ3MpOwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX0FyZ3M+CiBpdGVyYXRvcgog
X01fZW1wbGFjZV9lcXVhbChfQXJncyYmLi4uIF9fYXJncyk7CgogICAgICB0ZW1wbGF0ZTx0eXBl
bmFtZS4uLiBfQXJncz4KIGl0ZXJhdG9yCiBfTV9lbXBsYWNlX2hpbnRfdW5pcXVlKGNvbnN0X2l0
ZXJhdG9yIF9fcG9zLCBfQXJncyYmLi4uIF9fYXJncyk7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZS4uLiBfQXJncz4KIGl0ZXJhdG9yCiBfTV9lbXBsYWNlX2hpbnRfZXF1YWwoY29uc3RfaXRlcmF0
b3IgX19wb3MsIF9BcmdzJiYuLi4gX19hcmdzKTsKIyAxMDA2ICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvc3RsX3RyZWUuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVy
YXRvcj4KICAgICAgICB2b2lkCiAgICAgICAgX01faW5zZXJ0X3VuaXF1ZShfSW5wdXRJdGVyYXRv
ciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QpOwoKICAgICAgdGVtcGxhdGU8dHlwZW5h
bWUgX0lucHV0SXRlcmF0b3I+CiAgICAgICAgdm9pZAogICAgICAgIF9NX2luc2VydF9lcXVhbChf
SW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QpOwoKICAgIHByaXZh
dGU6CiAgICAgIHZvaWQKICAgICAgX01fZXJhc2VfYXV4KGNvbnN0X2l0ZXJhdG9yIF9fcG9zaXRp
b24pOwoKICAgICAgdm9pZAogICAgICBfTV9lcmFzZV9hdXgoY29uc3RfaXRlcmF0b3IgX19maXJz
dCwgY29uc3RfaXRlcmF0b3IgX19sYXN0KTsKCiAgICBwdWJsaWM6CgoKCiAgICAgIF9fYXR0cmli
dXRlICgoX19hYmlfdGFnX18gKCJjeHgxMSIpKSkKICAgICAgaXRlcmF0b3IKICAgICAgZXJhc2Uo
Y29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbikKICAgICAgewogY29uc3RfaXRlcmF0b3IgX19yZXN1
bHQgPSBfX3Bvc2l0aW9uOwogKytfX3Jlc3VsdDsKIF9NX2VyYXNlX2F1eChfX3Bvc2l0aW9uKTsK
IHJldHVybiBfX3Jlc3VsdC5fTV9jb25zdF9jYXN0KCk7CiAgICAgIH0KCgogICAgICBfX2F0dHJp
YnV0ZSAoKF9fYWJpX3RhZ19fICgiY3h4MTEiKSkpCiAgICAgIGl0ZXJhdG9yCiAgICAgIGVyYXNl
KGl0ZXJhdG9yIF9fcG9zaXRpb24pCiAgICAgIHsKIGl0ZXJhdG9yIF9fcmVzdWx0ID0gX19wb3Np
dGlvbjsKICsrX19yZXN1bHQ7CiBfTV9lcmFzZV9hdXgoX19wb3NpdGlvbik7CiByZXR1cm4gX19y
ZXN1bHQ7CiAgICAgIH0KIyAxMDU0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3Ry
ZWUuaCIgMwogICAgICBzaXplX3R5cGUKICAgICAgZXJhc2UoY29uc3Qga2V5X3R5cGUmIF9feCk7
CgoKCgogICAgICBfX2F0dHJpYnV0ZSAoKF9fYWJpX3RhZ19fICgiY3h4MTEiKSkpCiAgICAgIGl0
ZXJhdG9yCiAgICAgIGVyYXNlKGNvbnN0X2l0ZXJhdG9yIF9fZmlyc3QsIGNvbnN0X2l0ZXJhdG9y
IF9fbGFzdCkKICAgICAgewogX01fZXJhc2VfYXV4KF9fZmlyc3QsIF9fbGFzdCk7CiByZXR1cm4g
X19sYXN0Ll9NX2NvbnN0X2Nhc3QoKTsKICAgICAgfQojIDEwNzYgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9zdGxfdHJlZS5oIiAzCiAgICAgIHZvaWQKICAgICAgZXJhc2UoY29uc3Qga2V5
X3R5cGUqIF9fZmlyc3QsIGNvbnN0IGtleV90eXBlKiBfX2xhc3QpOwoKICAgICAgdm9pZAogICAg
ICBjbGVhcigpIG5vZXhjZXB0CiAgICAgIHsKICAgICAgICBfTV9lcmFzZShfTV9iZWdpbigpKTsK
IF9NX2ltcGwuX01fcmVzZXQoKTsKICAgICAgfQoKCiAgICAgIGl0ZXJhdG9yCiAgICAgIGZpbmQo
Y29uc3Qga2V5X3R5cGUmIF9fayk7CgogICAgICBjb25zdF9pdGVyYXRvcgogICAgICBmaW5kKGNv
bnN0IGtleV90eXBlJiBfX2spIGNvbnN0OwoKICAgICAgc2l6ZV90eXBlCiAgICAgIGNvdW50KGNv
bnN0IGtleV90eXBlJiBfX2spIGNvbnN0OwoKICAgICAgaXRlcmF0b3IKICAgICAgbG93ZXJfYm91
bmQoY29uc3Qga2V5X3R5cGUmIF9faykKICAgICAgeyByZXR1cm4gX01fbG93ZXJfYm91bmQoX01f
YmVnaW4oKSwgX01fZW5kKCksIF9fayk7IH0KCiAgICAgIGNvbnN0X2l0ZXJhdG9yCiAgICAgIGxv
d2VyX2JvdW5kKGNvbnN0IGtleV90eXBlJiBfX2spIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX2xv
d2VyX2JvdW5kKF9NX2JlZ2luKCksIF9NX2VuZCgpLCBfX2spOyB9CgogICAgICBpdGVyYXRvcgog
ICAgICB1cHBlcl9ib3VuZChjb25zdCBrZXlfdHlwZSYgX19rKQogICAgICB7IHJldHVybiBfTV91
cHBlcl9ib3VuZChfTV9iZWdpbigpLCBfTV9lbmQoKSwgX19rKTsgfQoKICAgICAgY29uc3RfaXRl
cmF0b3IKICAgICAgdXBwZXJfYm91bmQoY29uc3Qga2V5X3R5cGUmIF9faykgY29uc3QKICAgICAg
eyByZXR1cm4gX01fdXBwZXJfYm91bmQoX01fYmVnaW4oKSwgX01fZW5kKCksIF9fayk7IH0KCiAg
ICAgIHBhaXI8aXRlcmF0b3IsIGl0ZXJhdG9yPgogICAgICBlcXVhbF9yYW5nZShjb25zdCBrZXlf
dHlwZSYgX19rKTsKCiAgICAgIHBhaXI8Y29uc3RfaXRlcmF0b3IsIGNvbnN0X2l0ZXJhdG9yPgog
ICAgICBlcXVhbF9yYW5nZShjb25zdCBrZXlfdHlwZSYgX19rKSBjb25zdDsKIyAxMjM2ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX3RyZWUuaCIgMwogICAgICBib29sCiAgICAgIF9f
cmJfdmVyaWZ5KCkgY29uc3Q7CgoKICAgICAgX1JiX3RyZWUmCiAgICAgIG9wZXJhdG9yPShfUmJf
dHJlZSYmKQogICAgICBub2V4Y2VwdChfQWxsb2NfdHJhaXRzOjpfU19ub3Rocm93X21vdmUoKQog
ICAgICAgICYmIGlzX25vdGhyb3dfbW92ZV9hc3NpZ25hYmxlPF9Db21wYXJlPjo6dmFsdWUpOwoK
ICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9yPgogdm9pZAogX01fYXNzaWduX3VuaXF1
ZShfSXRlcmF0b3IsIF9JdGVyYXRvcik7CgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0
b3I+CiB2b2lkCiBfTV9hc3NpZ25fZXF1YWwoX0l0ZXJhdG9yLCBfSXRlcmF0b3IpOwoKICAgIHBy
aXZhdGU6CgogICAgICB2b2lkCiAgICAgIF9NX21vdmVfZGF0YShfUmJfdHJlZSYsIHN0ZDo6dHJ1
ZV90eXBlKTsKCgoKICAgICAgdm9pZAogICAgICBfTV9tb3ZlX2RhdGEoX1JiX3RyZWUmLCBzdGQ6
OmZhbHNlX3R5cGUpOwoKICAgIH07CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1l
IF9WYWwsIHR5cGVuYW1lIF9LZXlPZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJl
LCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I9PShjb25zdCBf
UmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBhcmUsIF9BbGxvYz4mIF9feCwK
ICAgICAgICBjb25zdCBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBhcmUs
IF9BbGxvYz4mIF9feSkKICAgIHsKICAgICAgcmV0dXJuIF9feC5zaXplKCkgPT0gX195LnNpemUo
KQogICAgICAmJiBzdGQ6OmVxdWFsKF9feC5iZWdpbigpLCBfX3guZW5kKCksIF9feS5iZWdpbigp
KTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5h
bWUgX0tleU9mVmFsdWUsCiAgICAgICAgICAgdHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9B
bGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcjwoY29uc3QgX1JiX3RyZWU8X0tleSwg
X1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+JiBfX3gsCiAgICAgICBjb25zdCBf
UmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBhcmUsIF9BbGxvYz4mIF9feSkK
ICAgIHsKICAgICAgcmV0dXJuIHN0ZDo6bGV4aWNvZ3JhcGhpY2FsX2NvbXBhcmUoX194LmJlZ2lu
KCksIF9feC5lbmQoKSwKICAgICAgIF9feS5iZWdpbigpLCBfX3kuZW5kKCkpOwogICAgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1
ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5s
aW5lIGJvb2wKICAgIG9wZXJhdG9yIT0oY29uc3QgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9m
VmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+JiBfX3gsCiAgICAgICAgY29uc3QgX1JiX3RyZWU8X0tl
eSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+JiBfX3kpCiAgICB7IHJldHVy
biAhKF9feCA9PSBfX3kpOyB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9W
YWwsIHR5cGVuYW1lIF9LZXlPZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0
eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I+KGNvbnN0IF9SYl90
cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLCBfQ29tcGFyZSwgX0FsbG9jPiYgX194LAogICAg
ICAgY29uc3QgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxs
b2M+JiBfX3kpCiAgICB7IHJldHVybiBfX3kgPCBfX3g7IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5hbWUgX0tleU9mVmFsdWUsCiAgICAgICAgICAgdHlw
ZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVy
YXRvcjw9KGNvbnN0IF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLCBfQ29tcGFyZSwg
X0FsbG9jPiYgX194LAogICAgICAgIGNvbnN0IF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZh
bHVlLCBfQ29tcGFyZSwgX0FsbG9jPiYgX195KQogICAgeyByZXR1cm4gIShfX3kgPCBfX3gpOyB9
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWwsIHR5cGVuYW1lIF9LZXlP
ZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxsb2M+CiAg
ICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I+PShjb25zdCBfUmJfdHJlZTxfS2V5LCBfVmFsLCBf
S2V5T2ZWYWx1ZSwgX0NvbXBhcmUsIF9BbGxvYz4mIF9feCwKICAgICAgICBjb25zdCBfUmJfdHJl
ZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBhcmUsIF9BbGxvYz4mIF9feSkKICAgIHsg
cmV0dXJuICEoX194IDwgX195KTsgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFt
ZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFy
ZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIHZvaWQKICAgIHN3YXAoX1JiX3RyZWU8X0tl
eSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+JiBfX3gsCiAgX1JiX3RyZWU8
X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+JiBfX3kpCiAgICB7IF9f
eC5zd2FwKF9feSk7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWws
IHR5cGVuYW1lIF9LZXlPZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBl
bmFtZSBfQWxsb2M+CiAgICBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBh
cmUsIF9BbGxvYz46OgogICAgX1JiX3RyZWUoX1JiX3RyZWUmJiBfX3gsIF9Ob2RlX2FsbG9jYXRv
ciYmIF9fYSkKICAgIDogX01faW1wbChfX3guX01faW1wbC5fTV9rZXlfY29tcGFyZSwgc3RkOjpt
b3ZlKF9fYSkpCiAgICB7CiAgICAgIHVzaW5nIF9fZXEgPSB0eXBlbmFtZSBfQWxsb2NfdHJhaXRz
Ojppc19hbHdheXNfZXF1YWw7CiAgICAgIGlmIChfX3guX01fcm9vdCgpICE9IG51bGxwdHIpCiBf
TV9tb3ZlX2RhdGEoX194LCBfX2VxKCkpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5
LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFt
ZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgdm9pZAogICAgX1JiX3RyZWU8X0tleSwg
X1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjoKICAgIF9NX21vdmVfZGF0YShf
UmJfdHJlZSYgX194LCBzdGQ6OnRydWVfdHlwZSkKICAgIHsKICAgICAgX01fcm9vdCgpID0gX194
Ll9NX3Jvb3QoKTsKICAgICAgX01fbGVmdG1vc3QoKSA9IF9feC5fTV9sZWZ0bW9zdCgpOwogICAg
ICBfTV9yaWdodG1vc3QoKSA9IF9feC5fTV9yaWdodG1vc3QoKTsKICAgICAgX01fcm9vdCgpLT5f
TV9wYXJlbnQgPSBfTV9lbmQoKTsKCiAgICAgIF9feC5fTV9yb290KCkgPSAwOwogICAgICBfX3gu
X01fbGVmdG1vc3QoKSA9IF9feC5fTV9lbmQoKTsKICAgICAgX194Ll9NX3JpZ2h0bW9zdCgpID0g
X194Ll9NX2VuZCgpOwoKICAgICAgdGhpcy0+X01faW1wbC5fTV9ub2RlX2NvdW50ID0gX194Ll9N
X2ltcGwuX01fbm9kZV9jb3VudDsKICAgICAgX194Ll9NX2ltcGwuX01fbm9kZV9jb3VudCA9IDA7
CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWwsIHR5cGVuYW1l
IF9LZXlPZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxs
b2M+CiAgICB2b2lkCiAgICBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBh
cmUsIF9BbGxvYz46OgogICAgX01fbW92ZV9kYXRhKF9SYl90cmVlJiBfX3gsIHN0ZDo6ZmFsc2Vf
dHlwZSkKICAgIHsKICAgICAgaWYgKF9NX2dldF9Ob2RlX2FsbG9jYXRvcigpID09IF9feC5fTV9n
ZXRfTm9kZV9hbGxvY2F0b3IoKSkKICAgX01fbW92ZV9kYXRhKF9feCwgc3RkOjp0cnVlX3R5cGUo
KSk7CiAgICAgIGVsc2UKIHsKICAgX0FsbG9jX25vZGUgX19hbigqdGhpcyk7CiAgIGF1dG8gX19s
YmQgPQogICAgIFsmX19hbl0oY29uc3QgdmFsdWVfdHlwZSYgX19jdmFsKQogICAgIHsKICAgICAg
IGF1dG8mIF9fdmFsID0gY29uc3RfY2FzdDx2YWx1ZV90eXBlJj4oX19jdmFsKTsKICAgICAgIHJl
dHVybiBfX2FuKHN0ZDo6bW92ZV9pZl9ub2V4Y2VwdChfX3ZhbCkpOwogICAgIH07CiAgIF9NX3Jv
b3QoKSA9IF9NX2NvcHkoX194Ll9NX2JlZ2luKCksIF9NX2VuZCgpLCBfX2xiZCk7CiAgIF9NX2xl
ZnRtb3N0KCkgPSBfU19taW5pbXVtKF9NX3Jvb3QoKSk7CiAgIF9NX3JpZ2h0bW9zdCgpID0gX1Nf
bWF4aW11bShfTV9yb290KCkpOwogICBfTV9pbXBsLl9NX25vZGVfY291bnQgPSBfX3guX01faW1w
bC5fTV9ub2RlX2NvdW50OwogfQogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBl
bmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29t
cGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFs
dWUsIF9Db21wYXJlLCBfQWxsb2M+JgogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFs
dWUsIF9Db21wYXJlLCBfQWxsb2M+OjoKICAgIG9wZXJhdG9yPShfUmJfdHJlZSYmIF9feCkKICAg
IG5vZXhjZXB0KF9BbGxvY190cmFpdHM6Ol9TX25vdGhyb3dfbW92ZSgpCiAgICAgICYmIGlzX25v
dGhyb3dfbW92ZV9hc3NpZ25hYmxlPF9Db21wYXJlPjo6dmFsdWUpCiAgICB7CiAgICAgIF9NX2lt
cGwuX01fa2V5X2NvbXBhcmUgPSBfX3guX01faW1wbC5fTV9rZXlfY29tcGFyZTsKICAgICAgaWYg
KF9BbGxvY190cmFpdHM6Ol9TX3Byb3BhZ2F0ZV9vbl9tb3ZlX2Fzc2lnbigpCiAgIHx8IF9BbGxv
Y190cmFpdHM6Ol9TX2Fsd2F5c19lcXVhbCgpCiAgIHx8IF9NX2dldF9Ob2RlX2FsbG9jYXRvcigp
ID09IF9feC5fTV9nZXRfTm9kZV9hbGxvY2F0b3IoKSkKIHsKICAgY2xlYXIoKTsKICAgaWYgKF9f
eC5fTV9yb290KCkgIT0gbnVsbHB0cikKICAgICBfTV9tb3ZlX2RhdGEoX194LCBzdGQ6OnRydWVf
dHlwZSgpKTsKICAgc3RkOjpfX2FsbG9jX29uX21vdmUoX01fZ2V0X05vZGVfYWxsb2NhdG9yKCks
CiAgICAgICAgICBfX3guX01fZ2V0X05vZGVfYWxsb2NhdG9yKCkpOwogICByZXR1cm4gKnRoaXM7
CiB9CgoKCiAgICAgIF9SZXVzZV9vcl9hbGxvY19ub2RlIF9fcm9hbigqdGhpcyk7CiAgICAgIF9N
X2ltcGwuX01fcmVzZXQoKTsKICAgICAgaWYgKF9feC5fTV9yb290KCkgIT0gbnVsbHB0cikKIHsK
ICAgYXV0byBfX2xiZCA9CiAgICAgWyZfX3JvYW5dKGNvbnN0IHZhbHVlX3R5cGUmIF9fY3ZhbCkK
ICAgICB7CiAgICAgICBhdXRvJiBfX3ZhbCA9IGNvbnN0X2Nhc3Q8dmFsdWVfdHlwZSY+KF9fY3Zh
bCk7CiAgICAgICByZXR1cm4gX19yb2FuKHN0ZDo6bW92ZV9pZl9ub2V4Y2VwdChfX3ZhbCkpOwog
ICAgIH07CiAgIF9NX3Jvb3QoKSA9IF9NX2NvcHkoX194Ll9NX2JlZ2luKCksIF9NX2VuZCgpLCBf
X2xiZCk7CiAgIF9NX2xlZnRtb3N0KCkgPSBfU19taW5pbXVtKF9NX3Jvb3QoKSk7CiAgIF9NX3Jp
Z2h0bW9zdCgpID0gX1NfbWF4aW11bShfTV9yb290KCkpOwogICBfTV9pbXBsLl9NX25vZGVfY291
bnQgPSBfX3guX01faW1wbC5fTV9ub2RlX2NvdW50OwogICBfX3guY2xlYXIoKTsKIH0KICAgICAg
cmV0dXJuICp0aGlzOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBf
VmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwg
dHlwZW5hbWUgX0FsbG9jPgogICAgdGVtcGxhdGU8dHlwZW5hbWUgX0l0ZXJhdG9yPgogICAgICB2
b2lkCiAgICAgIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLCBfQ29tcGFyZSwgX0Fs
bG9jPjo6CiAgICAgIF9NX2Fzc2lnbl91bmlxdWUoX0l0ZXJhdG9yIF9fZmlyc3QsIF9JdGVyYXRv
ciBfX2xhc3QpCiAgICAgIHsKIF9SZXVzZV9vcl9hbGxvY19ub2RlIF9fcm9hbigqdGhpcyk7CiBf
TV9pbXBsLl9NX3Jlc2V0KCk7CiBmb3IgKDsgX19maXJzdCAhPSBfX2xhc3Q7ICsrX19maXJzdCkK
ICAgX01faW5zZXJ0X3VuaXF1ZV8oZW5kKCksICpfX2ZpcnN0LCBfX3JvYW4pOwogICAgICB9Cgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWwsIHR5cGVuYW1lIF9LZXlPZlZh
bHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfSXRlcmF0b3I+CiAgICAgIHZvaWQKICAgICAgX1JiX3RyZWU8X0tl
eSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjoKICAgICAgX01fYXNzaWdu
X2VxdWFsKF9JdGVyYXRvciBfX2ZpcnN0LCBfSXRlcmF0b3IgX19sYXN0KQogICAgICB7CiBfUmV1
c2Vfb3JfYWxsb2Nfbm9kZSBfX3JvYW4oKnRoaXMpOwogX01faW1wbC5fTV9yZXNldCgpOwogZm9y
ICg7IF9fZmlyc3QgIT0gX19sYXN0OyArK19fZmlyc3QpCiAgIF9NX2luc2VydF9lcXVhbF8oZW5k
KCksICpfX2ZpcnN0LCBfX3JvYW4pOwogICAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5
LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFt
ZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tl
eU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+JgogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tl
eU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjoKICAgIG9wZXJhdG9yPShjb25zdCBfUmJfdHJl
ZSYgX194KQogICAgewogICAgICBpZiAodGhpcyAhPSAmX194KQogewoKCiAgIGlmIChfQWxsb2Nf
dHJhaXRzOjpfU19wcm9wYWdhdGVfb25fY29weV9hc3NpZ24oKSkKICAgICB7CiAgICAgICBhdXRv
JiBfX3RoaXNfYWxsb2MgPSB0aGlzLT5fTV9nZXRfTm9kZV9hbGxvY2F0b3IoKTsKICAgICAgIGF1
dG8mIF9fdGhhdF9hbGxvYyA9IF9feC5fTV9nZXRfTm9kZV9hbGxvY2F0b3IoKTsKICAgICAgIGlm
ICghX0FsbG9jX3RyYWl0czo6X1NfYWx3YXlzX2VxdWFsKCkKICAgICYmIF9fdGhpc19hbGxvYyAh
PSBfX3RoYXRfYWxsb2MpCiAgewoKCiAgICBjbGVhcigpOwogICAgc3RkOjpfX2FsbG9jX29uX2Nv
cHkoX190aGlzX2FsbG9jLCBfX3RoYXRfYWxsb2MpOwogIH0KICAgICB9CgoKICAgX1JldXNlX29y
X2FsbG9jX25vZGUgX19yb2FuKCp0aGlzKTsKICAgX01faW1wbC5fTV9yZXNldCgpOwogICBfTV9p
bXBsLl9NX2tleV9jb21wYXJlID0gX194Ll9NX2ltcGwuX01fa2V5X2NvbXBhcmU7CiAgIGlmIChf
X3guX01fcm9vdCgpICE9IDApCiAgICAgewogICAgICAgX01fcm9vdCgpID0gX01fY29weShfX3gu
X01fYmVnaW4oKSwgX01fZW5kKCksIF9fcm9hbik7CiAgICAgICBfTV9sZWZ0bW9zdCgpID0gX1Nf
bWluaW11bShfTV9yb290KCkpOwogICAgICAgX01fcmlnaHRtb3N0KCkgPSBfU19tYXhpbXVtKF9N
X3Jvb3QoKSk7CiAgICAgICBfTV9pbXBsLl9NX25vZGVfY291bnQgPSBfX3guX01faW1wbC5fTV9u
b2RlX2NvdW50OwogICAgIH0KIH0KCiAgICAgIHJldHVybiAqdGhpczsKICAgIH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5hbWUgX0tleU9mVmFsdWUsCiAg
ICAgICAgICAgdHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9BbGxvYz4KCiAgICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfQXJnLCB0eXBlbmFtZSBfTm9kZUdlbj4KCgoKICAgICAgdHlwZW5hbWUgX1Ji
X3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjppdGVyYXRv
cgogICAgICBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBhcmUsIF9BbGxv
Yz46OgogICAgICBfTV9pbnNlcnRfKF9CYXNlX3B0ciBfX3gsIF9CYXNlX3B0ciBfX3AsCgogICBf
QXJnJiYgX192LAoKCgogICBfTm9kZUdlbiYgX19ub2RlX2dlbikKICAgICAgewogYm9vbCBfX2lu
c2VydF9sZWZ0ID0gKF9feCAhPSAwIHx8IF9fcCA9PSBfTV9lbmQoKQogICAgICAgICB8fCBfTV9p
bXBsLl9NX2tleV9jb21wYXJlKF9LZXlPZlZhbHVlKCkoX192KSwKICAgICAgIF9TX2tleShfX3Ap
KSk7CgogX0xpbmtfdHlwZSBfX3ogPSBfX25vZGVfZ2VuKHN0ZDo6Zm9yd2FyZDxfQXJnPihfX3Yp
KTsKCiBfUmJfdHJlZV9pbnNlcnRfYW5kX3JlYmFsYW5jZShfX2luc2VydF9sZWZ0LCBfX3osIF9f
cCwKICAgICAgICAgIHRoaXMtPl9NX2ltcGwuX01faGVhZGVyKTsKICsrX01faW1wbC5fTV9ub2Rl
X2NvdW50OwogcmV0dXJuIGl0ZXJhdG9yKF9feik7CiAgICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5h
bWUgX0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5hbWUgX0tleU9mVmFsdWUsCiAgICAgICAgICAg
dHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9BbGxvYz4KCiAgICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfQXJnPgoKICAgIHR5cGVuYW1lIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLCBf
Q29tcGFyZSwgX0FsbG9jPjo6aXRlcmF0b3IKICAgIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlP
ZlZhbHVlLCBfQ29tcGFyZSwgX0FsbG9jPjo6CgogICAgX01faW5zZXJ0X2xvd2VyKF9CYXNlX3B0
ciBfX3AsIF9BcmcmJiBfX3YpCgoKCiAgICB7CiAgICAgIGJvb2wgX19pbnNlcnRfbGVmdCA9IChf
X3AgPT0gX01fZW5kKCkKICAgICAgIHx8ICFfTV9pbXBsLl9NX2tleV9jb21wYXJlKF9TX2tleShf
X3ApLAogICAgICAgICAgICAgX0tleU9mVmFsdWUoKShfX3YpKSk7CgogICAgICBfTGlua190eXBl
IF9feiA9IF9NX2NyZWF0ZV9ub2RlKHN0ZDo6Zm9yd2FyZDxfQXJnPihfX3YpKTsKCiAgICAgIF9S
Yl90cmVlX2luc2VydF9hbmRfcmViYWxhbmNlKF9faW5zZXJ0X2xlZnQsIF9feiwgX19wLAogICAg
ICAgIHRoaXMtPl9NX2ltcGwuX01faGVhZGVyKTsKICAgICAgKytfTV9pbXBsLl9NX25vZGVfY291
bnQ7CiAgICAgIHJldHVybiBpdGVyYXRvcihfX3opOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0
eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgoKICAgIHRlbXBsYXRlPHR5cGVuYW1l
IF9Bcmc+CgogICAgdHlwZW5hbWUgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9D
b21wYXJlLCBfQWxsb2M+OjppdGVyYXRvcgogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9m
VmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjoKCiAgICBfTV9pbnNlcnRfZXF1YWxfbG93ZXIoX0Fy
ZyYmIF9fdikKCgoKICAgIHsKICAgICAgX0xpbmtfdHlwZSBfX3ggPSBfTV9iZWdpbigpOwogICAg
ICBfQmFzZV9wdHIgX195ID0gX01fZW5kKCk7CiAgICAgIHdoaWxlIChfX3ggIT0gMCkKIHsKICAg
X195ID0gX194OwogICBfX3ggPSAhX01faW1wbC5fTV9rZXlfY29tcGFyZShfU19rZXkoX194KSwg
X0tleU9mVmFsdWUoKShfX3YpKSA/CiAgICAgICAgIF9TX2xlZnQoX194KSA6IF9TX3JpZ2h0KF9f
eCk7CiB9CiAgICAgIHJldHVybiBfTV9pbnNlcnRfbG93ZXIoX195LCBzdGQ6OmZvcndhcmQ8X0Fy
Zz4oX192KSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWws
IHR5cGVuYW1lIF9Lb1YsCiAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgog
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX05vZGVHZW4+CiAgICAgIHR5cGVuYW1lIF9SYl90cmVlPF9L
ZXksIF9WYWwsIF9Lb1YsIF9Db21wYXJlLCBfQWxsb2M+OjpfTGlua190eXBlCiAgICAgIF9SYl90
cmVlPF9LZXksIF9WYWwsIF9Lb1YsIF9Db21wYXJlLCBfQWxsb2M+OjoKICAgICAgX01fY29weShf
Q29uc3RfTGlua190eXBlIF9feCwgX0Jhc2VfcHRyIF9fcCwgX05vZGVHZW4mIF9fbm9kZV9nZW4p
CiAgICAgIHsKCiBfTGlua190eXBlIF9fdG9wID0gX01fY2xvbmVfbm9kZShfX3gsIF9fbm9kZV9n
ZW4pOwogX190b3AtPl9NX3BhcmVudCA9IF9fcDsKCiB0cnkKICAgewogICAgIGlmIChfX3gtPl9N
X3JpZ2h0KQogICAgICAgX190b3AtPl9NX3JpZ2h0ID0gX01fY29weShfU19yaWdodChfX3gpLCBf
X3RvcCwgX19ub2RlX2dlbik7CiAgICAgX19wID0gX190b3A7CiAgICAgX194ID0gX1NfbGVmdChf
X3gpOwoKICAgICB3aGlsZSAoX194ICE9IDApCiAgICAgICB7CiAgX0xpbmtfdHlwZSBfX3kgPSBf
TV9jbG9uZV9ub2RlKF9feCwgX19ub2RlX2dlbik7CiAgX19wLT5fTV9sZWZ0ID0gX195OwogIF9f
eS0+X01fcGFyZW50ID0gX19wOwogIGlmIChfX3gtPl9NX3JpZ2h0KQogICAgX195LT5fTV9yaWdo
dCA9IF9NX2NvcHkoX1NfcmlnaHQoX194KSwgX195LCBfX25vZGVfZ2VuKTsKICBfX3AgPSBfX3k7
CiAgX194ID0gX1NfbGVmdChfX3gpOwogICAgICAgfQogICB9CiBjYXRjaCguLi4pCiAgIHsKICAg
ICBfTV9lcmFzZShfX3RvcCk7CiAgICAgdGhyb3c7CiAgIH0KIHJldHVybiBfX3RvcDsKICAgICAg
fQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5
T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgog
ICAgdm9pZAogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBf
QWxsb2M+OjoKICAgIF9NX2VyYXNlKF9MaW5rX3R5cGUgX194KQogICAgewoKICAgICAgd2hpbGUg
KF9feCAhPSAwKQogewogICBfTV9lcmFzZShfU19yaWdodChfX3gpKTsKICAgX0xpbmtfdHlwZSBf
X3kgPSBfU19sZWZ0KF9feCk7CiAgIF9NX2Ryb3Bfbm9kZShfX3gpOwogICBfX3ggPSBfX3k7CiB9
CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWwsIHR5cGVuYW1l
IF9LZXlPZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxs
b2M+CiAgICB0eXBlbmFtZSBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwKICAgICAg
ICBfQ29tcGFyZSwgX0FsbG9jPjo6aXRlcmF0b3IKICAgIF9SYl90cmVlPF9LZXksIF9WYWwsIF9L
ZXlPZlZhbHVlLCBfQ29tcGFyZSwgX0FsbG9jPjo6CiAgICBfTV9sb3dlcl9ib3VuZChfTGlua190
eXBlIF9feCwgX0Jhc2VfcHRyIF9feSwKICAgICBjb25zdCBfS2V5JiBfX2spCiAgICB7CiAgICAg
IHdoaWxlIChfX3ggIT0gMCkKIGlmICghX01faW1wbC5fTV9rZXlfY29tcGFyZShfU19rZXkoX194
KSwgX19rKSkKICAgX195ID0gX194LCBfX3ggPSBfU19sZWZ0KF9feCk7CiBlbHNlCiAgIF9feCA9
IF9TX3JpZ2h0KF9feCk7CiAgICAgIHJldHVybiBpdGVyYXRvcihfX3kpOwogICAgfQoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwK
ICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgdHlwZW5h
bWUgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsCiAgICAgICAgX0NvbXBhcmUsIF9B
bGxvYz46OmNvbnN0X2l0ZXJhdG9yCiAgICBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1
ZSwgX0NvbXBhcmUsIF9BbGxvYz46OgogICAgX01fbG93ZXJfYm91bmQoX0NvbnN0X0xpbmtfdHlw
ZSBfX3gsIF9Db25zdF9CYXNlX3B0ciBfX3ksCiAgICAgY29uc3QgX0tleSYgX19rKSBjb25zdAog
ICAgewogICAgICB3aGlsZSAoX194ICE9IDApCiBpZiAoIV9NX2ltcGwuX01fa2V5X2NvbXBhcmUo
X1Nfa2V5KF9feCksIF9faykpCiAgIF9feSA9IF9feCwgX194ID0gX1NfbGVmdChfX3gpOwogZWxz
ZQogICBfX3ggPSBfU19yaWdodChfX3gpOwogICAgICByZXR1cm4gY29uc3RfaXRlcmF0b3IoX195
KTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5h
bWUgX0tleU9mVmFsdWUsCiAgICAgICAgICAgdHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9B
bGxvYz4KICAgIHR5cGVuYW1lIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLAogICAg
ICAgIF9Db21wYXJlLCBfQWxsb2M+OjppdGVyYXRvcgogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwg
X0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjoKICAgIF9NX3VwcGVyX2JvdW5kKF9MaW5r
X3R5cGUgX194LCBfQmFzZV9wdHIgX195LAogICAgIGNvbnN0IF9LZXkmIF9faykKICAgIHsKICAg
ICAgd2hpbGUgKF9feCAhPSAwKQogaWYgKF9NX2ltcGwuX01fa2V5X2NvbXBhcmUoX19rLCBfU19r
ZXkoX194KSkpCiAgIF9feSA9IF9feCwgX194ID0gX1NfbGVmdChfX3gpOwogZWxzZQogICBfX3gg
PSBfU19yaWdodChfX3gpOwogICAgICByZXR1cm4gaXRlcmF0b3IoX195KTsKICAgIH0KCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5hbWUgX0tleU9mVmFsdWUs
CiAgICAgICAgICAgdHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHR5cGVu
YW1lIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLAogICAgICAgIF9Db21wYXJlLCBf
QWxsb2M+Ojpjb25zdF9pdGVyYXRvcgogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFs
dWUsIF9Db21wYXJlLCBfQWxsb2M+OjoKICAgIF9NX3VwcGVyX2JvdW5kKF9Db25zdF9MaW5rX3R5
cGUgX194LCBfQ29uc3RfQmFzZV9wdHIgX195LAogICAgIGNvbnN0IF9LZXkmIF9faykgY29uc3QK
ICAgIHsKICAgICAgd2hpbGUgKF9feCAhPSAwKQogaWYgKF9NX2ltcGwuX01fa2V5X2NvbXBhcmUo
X19rLCBfU19rZXkoX194KSkpCiAgIF9feSA9IF9feCwgX194ID0gX1NfbGVmdChfX3gpOwogZWxz
ZQogICBfX3ggPSBfU19yaWdodChfX3gpOwogICAgICByZXR1cm4gY29uc3RfaXRlcmF0b3IoX195
KTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5h
bWUgX0tleU9mVmFsdWUsCiAgICAgICAgICAgdHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9B
bGxvYz4KICAgIHBhaXI8dHlwZW5hbWUgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUs
CiAgICAgIF9Db21wYXJlLCBfQWxsb2M+OjppdGVyYXRvciwKICB0eXBlbmFtZSBfUmJfdHJlZTxf
S2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwKICAgICAgX0NvbXBhcmUsIF9BbGxvYz46Oml0ZXJhdG9y
PgogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+
OjoKICAgIGVxdWFsX3JhbmdlKGNvbnN0IF9LZXkmIF9faykKICAgIHsKICAgICAgX0xpbmtfdHlw
ZSBfX3ggPSBfTV9iZWdpbigpOwogICAgICBfQmFzZV9wdHIgX195ID0gX01fZW5kKCk7CiAgICAg
IHdoaWxlIChfX3ggIT0gMCkKIHsKICAgaWYgKF9NX2ltcGwuX01fa2V5X2NvbXBhcmUoX1Nfa2V5
KF9feCksIF9faykpCiAgICAgX194ID0gX1NfcmlnaHQoX194KTsKICAgZWxzZSBpZiAoX01faW1w
bC5fTV9rZXlfY29tcGFyZShfX2ssIF9TX2tleShfX3gpKSkKICAgICBfX3kgPSBfX3gsIF9feCA9
IF9TX2xlZnQoX194KTsKICAgZWxzZQogICAgIHsKICAgICAgIF9MaW5rX3R5cGUgX194dShfX3gp
OwogICAgICAgX0Jhc2VfcHRyIF9feXUoX195KTsKICAgICAgIF9feSA9IF9feCwgX194ID0gX1Nf
bGVmdChfX3gpOwogICAgICAgX194dSA9IF9TX3JpZ2h0KF9feHUpOwogICAgICAgcmV0dXJuIHBh
aXI8aXRlcmF0b3IsCiAgICAgICAgICAgIGl0ZXJhdG9yPihfTV9sb3dlcl9ib3VuZChfX3gsIF9f
eSwgX19rKSwKICAgICAgICBfTV91cHBlcl9ib3VuZChfX3h1LCBfX3l1LCBfX2spKTsKICAgICB9
CiB9CiAgICAgIHJldHVybiBwYWlyPGl0ZXJhdG9yLCBpdGVyYXRvcj4oaXRlcmF0b3IoX195KSwK
ICAgICAgICAgIGl0ZXJhdG9yKF9feSkpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5
LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFt
ZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgcGFpcjx0eXBlbmFtZSBfUmJfdHJlZTxf
S2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwKICAgICAgX0NvbXBhcmUsIF9BbGxvYz46OmNvbnN0X2l0
ZXJhdG9yLAogIHR5cGVuYW1lIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLAogICAg
ICBfQ29tcGFyZSwgX0FsbG9jPjo6Y29uc3RfaXRlcmF0b3I+CiAgICBfUmJfdHJlZTxfS2V5LCBf
VmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBhcmUsIF9BbGxvYz46OgogICAgZXF1YWxfcmFuZ2UoY29u
c3QgX0tleSYgX19rKSBjb25zdAogICAgewogICAgICBfQ29uc3RfTGlua190eXBlIF9feCA9IF9N
X2JlZ2luKCk7CiAgICAgIF9Db25zdF9CYXNlX3B0ciBfX3kgPSBfTV9lbmQoKTsKICAgICAgd2hp
bGUgKF9feCAhPSAwKQogewogICBpZiAoX01faW1wbC5fTV9rZXlfY29tcGFyZShfU19rZXkoX194
KSwgX19rKSkKICAgICBfX3ggPSBfU19yaWdodChfX3gpOwogICBlbHNlIGlmIChfTV9pbXBsLl9N
X2tleV9jb21wYXJlKF9faywgX1Nfa2V5KF9feCkpKQogICAgIF9feSA9IF9feCwgX194ID0gX1Nf
bGVmdChfX3gpOwogICBlbHNlCiAgICAgewogICAgICAgX0NvbnN0X0xpbmtfdHlwZSBfX3h1KF9f
eCk7CiAgICAgICBfQ29uc3RfQmFzZV9wdHIgX195dShfX3kpOwogICAgICAgX195ID0gX194LCBf
X3ggPSBfU19sZWZ0KF9feCk7CiAgICAgICBfX3h1ID0gX1NfcmlnaHQoX194dSk7CiAgICAgICBy
ZXR1cm4gcGFpcjxjb25zdF9pdGVyYXRvciwKICAgICAgICAgICAgY29uc3RfaXRlcmF0b3I+KF9N
X2xvd2VyX2JvdW5kKF9feCwgX195LCBfX2spLAogICAgICAgX01fdXBwZXJfYm91bmQoX194dSwg
X195dSwgX19rKSk7CiAgICAgfQogfQogICAgICByZXR1cm4gcGFpcjxjb25zdF9pdGVyYXRvciwg
Y29uc3RfaXRlcmF0b3I+KGNvbnN0X2l0ZXJhdG9yKF9feSksCiAgICAgICAgY29uc3RfaXRlcmF0
b3IoX195KSk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWws
IHR5cGVuYW1lIF9LZXlPZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBl
bmFtZSBfQWxsb2M+CiAgICB2b2lkCiAgICBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1
ZSwgX0NvbXBhcmUsIF9BbGxvYz46OgogICAgc3dhcChfUmJfdHJlZSYgX190KQogICAgbm9leGNl
cHQoX19pc19ub3Rocm93X3N3YXBwYWJsZTxfQ29tcGFyZT46OnZhbHVlKQogICAgewogICAgICBp
ZiAoX01fcm9vdCgpID09IDApCiB7CiAgIGlmIChfX3QuX01fcm9vdCgpICE9IDApCiAgICAgewog
ICAgICAgX01fcm9vdCgpID0gX190Ll9NX3Jvb3QoKTsKICAgICAgIF9NX2xlZnRtb3N0KCkgPSBf
X3QuX01fbGVmdG1vc3QoKTsKICAgICAgIF9NX3JpZ2h0bW9zdCgpID0gX190Ll9NX3JpZ2h0bW9z
dCgpOwogICAgICAgX01fcm9vdCgpLT5fTV9wYXJlbnQgPSBfTV9lbmQoKTsKICAgICAgIF9NX2lt
cGwuX01fbm9kZV9jb3VudCA9IF9fdC5fTV9pbXBsLl9NX25vZGVfY291bnQ7CgogICAgICAgX190
Ll9NX2ltcGwuX01fcmVzZXQoKTsKICAgICB9CiB9CiAgICAgIGVsc2UgaWYgKF9fdC5fTV9yb290
KCkgPT0gMCkKIHsKICAgX190Ll9NX3Jvb3QoKSA9IF9NX3Jvb3QoKTsKICAgX190Ll9NX2xlZnRt
b3N0KCkgPSBfTV9sZWZ0bW9zdCgpOwogICBfX3QuX01fcmlnaHRtb3N0KCkgPSBfTV9yaWdodG1v
c3QoKTsKICAgX190Ll9NX3Jvb3QoKS0+X01fcGFyZW50ID0gX190Ll9NX2VuZCgpOwogICBfX3Qu
X01faW1wbC5fTV9ub2RlX2NvdW50ID0gX01faW1wbC5fTV9ub2RlX2NvdW50OwoKICAgX01faW1w
bC5fTV9yZXNldCgpOwogfQogICAgICBlbHNlCiB7CiAgIHN0ZDo6c3dhcChfTV9yb290KCksX190
Ll9NX3Jvb3QoKSk7CiAgIHN0ZDo6c3dhcChfTV9sZWZ0bW9zdCgpLF9fdC5fTV9sZWZ0bW9zdCgp
KTsKICAgc3RkOjpzd2FwKF9NX3JpZ2h0bW9zdCgpLF9fdC5fTV9yaWdodG1vc3QoKSk7CgogICBf
TV9yb290KCktPl9NX3BhcmVudCA9IF9NX2VuZCgpOwogICBfX3QuX01fcm9vdCgpLT5fTV9wYXJl
bnQgPSBfX3QuX01fZW5kKCk7CiAgIHN0ZDo6c3dhcCh0aGlzLT5fTV9pbXBsLl9NX25vZGVfY291
bnQsIF9fdC5fTV9pbXBsLl9NX25vZGVfY291bnQpOwogfQoKICAgICAgc3RkOjpzd2FwKHRoaXMt
Pl9NX2ltcGwuX01fa2V5X2NvbXBhcmUsIF9fdC5fTV9pbXBsLl9NX2tleV9jb21wYXJlKTsKCiAg
ICAgIF9BbGxvY190cmFpdHM6Ol9TX29uX3N3YXAoX01fZ2V0X05vZGVfYWxsb2NhdG9yKCksCiAg
ICBfX3QuX01fZ2V0X05vZGVfYWxsb2NhdG9yKCkpOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0
eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgcGFpcjx0eXBlbmFtZSBfUmJf
dHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwKICAgICAgX0NvbXBhcmUsIF9BbGxvYz46Ol9C
YXNlX3B0ciwKICB0eXBlbmFtZSBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwKICAg
ICAgX0NvbXBhcmUsIF9BbGxvYz46Ol9CYXNlX3B0cj4KICAgIF9SYl90cmVlPF9LZXksIF9WYWws
IF9LZXlPZlZhbHVlLCBfQ29tcGFyZSwgX0FsbG9jPjo6CiAgICBfTV9nZXRfaW5zZXJ0X3VuaXF1
ZV9wb3MoY29uc3Qga2V5X3R5cGUmIF9faykKICAgIHsKICAgICAgdHlwZWRlZiBwYWlyPF9CYXNl
X3B0ciwgX0Jhc2VfcHRyPiBfUmVzOwogICAgICBfTGlua190eXBlIF9feCA9IF9NX2JlZ2luKCk7
CiAgICAgIF9CYXNlX3B0ciBfX3kgPSBfTV9lbmQoKTsKICAgICAgYm9vbCBfX2NvbXAgPSB0cnVl
OwogICAgICB3aGlsZSAoX194ICE9IDApCiB7CiAgIF9feSA9IF9feDsKICAgX19jb21wID0gX01f
aW1wbC5fTV9rZXlfY29tcGFyZShfX2ssIF9TX2tleShfX3gpKTsKICAgX194ID0gX19jb21wID8g
X1NfbGVmdChfX3gpIDogX1NfcmlnaHQoX194KTsKIH0KICAgICAgaXRlcmF0b3IgX19qID0gaXRl
cmF0b3IoX195KTsKICAgICAgaWYgKF9fY29tcCkKIHsKICAgaWYgKF9faiA9PSBiZWdpbigpKQog
ICAgIHJldHVybiBfUmVzKF9feCwgX195KTsKICAgZWxzZQogICAgIC0tX19qOwogfQogICAgICBp
ZiAoX01faW1wbC5fTV9rZXlfY29tcGFyZShfU19rZXkoX19qLl9NX25vZGUpLCBfX2spKQogcmV0
dXJuIF9SZXMoX194LCBfX3kpOwogICAgICByZXR1cm4gX1JlcyhfX2ouX01fbm9kZSwgMCk7CiAg
ICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWwsIHR5cGVuYW1lIF9L
ZXlPZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxsb2M+
CiAgICBwYWlyPHR5cGVuYW1lIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLAogICAg
ICBfQ29tcGFyZSwgX0FsbG9jPjo6X0Jhc2VfcHRyLAogIHR5cGVuYW1lIF9SYl90cmVlPF9LZXks
IF9WYWwsIF9LZXlPZlZhbHVlLAogICAgICBfQ29tcGFyZSwgX0FsbG9jPjo6X0Jhc2VfcHRyPgog
ICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjoK
ICAgIF9NX2dldF9pbnNlcnRfZXF1YWxfcG9zKGNvbnN0IGtleV90eXBlJiBfX2spCiAgICB7CiAg
ICAgIHR5cGVkZWYgcGFpcjxfQmFzZV9wdHIsIF9CYXNlX3B0cj4gX1JlczsKICAgICAgX0xpbmtf
dHlwZSBfX3ggPSBfTV9iZWdpbigpOwogICAgICBfQmFzZV9wdHIgX195ID0gX01fZW5kKCk7CiAg
ICAgIHdoaWxlIChfX3ggIT0gMCkKIHsKICAgX195ID0gX194OwogICBfX3ggPSBfTV9pbXBsLl9N
X2tleV9jb21wYXJlKF9faywgX1Nfa2V5KF9feCkpID8KICAgICAgICAgX1NfbGVmdChfX3gpIDog
X1NfcmlnaHQoX194KTsKIH0KICAgICAgcmV0dXJuIF9SZXMoX194LCBfX3kpOwogICAgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1
ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgoKICAgIHRl
bXBsYXRlPHR5cGVuYW1lIF9Bcmc+CgogICAgcGFpcjx0eXBlbmFtZSBfUmJfdHJlZTxfS2V5LCBf
VmFsLCBfS2V5T2ZWYWx1ZSwKICAgICAgX0NvbXBhcmUsIF9BbGxvYz46Oml0ZXJhdG9yLCBib29s
PgogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+
OjoKCiAgICBfTV9pbnNlcnRfdW5pcXVlKF9BcmcmJiBfX3YpCgoKCiAgICB7CiAgICAgIHR5cGVk
ZWYgcGFpcjxpdGVyYXRvciwgYm9vbD4gX1JlczsKICAgICAgcGFpcjxfQmFzZV9wdHIsIF9CYXNl
X3B0cj4gX19yZXMKID0gX01fZ2V0X2luc2VydF91bmlxdWVfcG9zKF9LZXlPZlZhbHVlKCkoX192
KSk7CgogICAgICBpZiAoX19yZXMuc2Vjb25kKQogewogICBfQWxsb2Nfbm9kZSBfX2FuKCp0aGlz
KTsKICAgcmV0dXJuIF9SZXMoX01faW5zZXJ0XyhfX3Jlcy5maXJzdCwgX19yZXMuc2Vjb25kLAog
ICAgIHN0ZDo6Zm9yd2FyZDxfQXJnPihfX3YpLCBfX2FuKSwKICAgICAgICB0cnVlKTsKIH0KCiAg
ICAgIHJldHVybiBfUmVzKGl0ZXJhdG9yKF9fcmVzLmZpcnN0KSwgZmFsc2UpOwogICAgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1
ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgoKICAgIHRl
bXBsYXRlPHR5cGVuYW1lIF9Bcmc+CgogICAgdHlwZW5hbWUgX1JiX3RyZWU8X0tleSwgX1ZhbCwg
X0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjppdGVyYXRvcgogICAgX1JiX3RyZWU8X0tl
eSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjoKCiAgICBfTV9pbnNlcnRf
ZXF1YWwoX0FyZyYmIF9fdikKCgoKICAgIHsKICAgICAgcGFpcjxfQmFzZV9wdHIsIF9CYXNlX3B0
cj4gX19yZXMKID0gX01fZ2V0X2luc2VydF9lcXVhbF9wb3MoX0tleU9mVmFsdWUoKShfX3YpKTsK
ICAgICAgX0FsbG9jX25vZGUgX19hbigqdGhpcyk7CiAgICAgIHJldHVybiBfTV9pbnNlcnRfKF9f
cmVzLmZpcnN0LCBfX3Jlcy5zZWNvbmQsCiAgIHN0ZDo6Zm9yd2FyZDxfQXJnPihfX3YpLCBfX2Fu
KTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5h
bWUgX0tleU9mVmFsdWUsCiAgICAgICAgICAgdHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9B
bGxvYz4KICAgIHBhaXI8dHlwZW5hbWUgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUs
CiAgICAgIF9Db21wYXJlLCBfQWxsb2M+OjpfQmFzZV9wdHIsCiAgICAgICAgIHR5cGVuYW1lIF9S
Yl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLAogICAgICBfQ29tcGFyZSwgX0FsbG9jPjo6
X0Jhc2VfcHRyPgogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJl
LCBfQWxsb2M+OjoKICAgIF9NX2dldF9pbnNlcnRfaGludF91bmlxdWVfcG9zKGNvbnN0X2l0ZXJh
dG9yIF9fcG9zaXRpb24sCiAgICAgIGNvbnN0IGtleV90eXBlJiBfX2spCiAgICB7CiAgICAgIGl0
ZXJhdG9yIF9fcG9zID0gX19wb3NpdGlvbi5fTV9jb25zdF9jYXN0KCk7CiAgICAgIHR5cGVkZWYg
cGFpcjxfQmFzZV9wdHIsIF9CYXNlX3B0cj4gX1JlczsKCgogICAgICBpZiAoX19wb3MuX01fbm9k
ZSA9PSBfTV9lbmQoKSkKIHsKICAgaWYgKHNpemUoKSA+IDAKICAgICAgICYmIF9NX2ltcGwuX01f
a2V5X2NvbXBhcmUoX1Nfa2V5KF9NX3JpZ2h0bW9zdCgpKSwgX19rKSkKICAgICByZXR1cm4gX1Jl
cygwLCBfTV9yaWdodG1vc3QoKSk7CiAgIGVsc2UKICAgICByZXR1cm4gX01fZ2V0X2luc2VydF91
bmlxdWVfcG9zKF9fayk7CiB9CiAgICAgIGVsc2UgaWYgKF9NX2ltcGwuX01fa2V5X2NvbXBhcmUo
X19rLCBfU19rZXkoX19wb3MuX01fbm9kZSkpKQogewoKICAgaXRlcmF0b3IgX19iZWZvcmUgPSBf
X3BvczsKICAgaWYgKF9fcG9zLl9NX25vZGUgPT0gX01fbGVmdG1vc3QoKSkKICAgICByZXR1cm4g
X1JlcyhfTV9sZWZ0bW9zdCgpLCBfTV9sZWZ0bW9zdCgpKTsKICAgZWxzZSBpZiAoX01faW1wbC5f
TV9rZXlfY29tcGFyZShfU19rZXkoKC0tX19iZWZvcmUpLl9NX25vZGUpLCBfX2spKQogICAgIHsK
ICAgICAgIGlmIChfU19yaWdodChfX2JlZm9yZS5fTV9ub2RlKSA9PSAwKQogIHJldHVybiBfUmVz
KDAsIF9fYmVmb3JlLl9NX25vZGUpOwogICAgICAgZWxzZQogIHJldHVybiBfUmVzKF9fcG9zLl9N
X25vZGUsIF9fcG9zLl9NX25vZGUpOwogICAgIH0KICAgZWxzZQogICAgIHJldHVybiBfTV9nZXRf
aW5zZXJ0X3VuaXF1ZV9wb3MoX19rKTsKIH0KICAgICAgZWxzZSBpZiAoX01faW1wbC5fTV9rZXlf
Y29tcGFyZShfU19rZXkoX19wb3MuX01fbm9kZSksIF9faykpCiB7CgogICBpdGVyYXRvciBfX2Fm
dGVyID0gX19wb3M7CiAgIGlmIChfX3Bvcy5fTV9ub2RlID09IF9NX3JpZ2h0bW9zdCgpKQogICAg
IHJldHVybiBfUmVzKDAsIF9NX3JpZ2h0bW9zdCgpKTsKICAgZWxzZSBpZiAoX01faW1wbC5fTV9r
ZXlfY29tcGFyZShfX2ssIF9TX2tleSgoKytfX2FmdGVyKS5fTV9ub2RlKSkpCiAgICAgewogICAg
ICAgaWYgKF9TX3JpZ2h0KF9fcG9zLl9NX25vZGUpID09IDApCiAgcmV0dXJuIF9SZXMoMCwgX19w
b3MuX01fbm9kZSk7CiAgICAgICBlbHNlCiAgcmV0dXJuIF9SZXMoX19hZnRlci5fTV9ub2RlLCBf
X2FmdGVyLl9NX25vZGUpOwogICAgIH0KICAgZWxzZQogICAgIHJldHVybiBfTV9nZXRfaW5zZXJ0
X3VuaXF1ZV9wb3MoX19rKTsKIH0KICAgICAgZWxzZQoKIHJldHVybiBfUmVzKF9fcG9zLl9NX25v
ZGUsIDApOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0
eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5h
bWUgX0FsbG9jPgoKICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9BcmcsIHR5cGVuYW1lIF9Ob2RlR2Vu
PgoKCgogICAgICB0eXBlbmFtZSBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0Nv
bXBhcmUsIF9BbGxvYz46Oml0ZXJhdG9yCiAgICAgIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlP
ZlZhbHVlLCBfQ29tcGFyZSwgX0FsbG9jPjo6CiAgICAgIF9NX2luc2VydF91bmlxdWVfKGNvbnN0
X2l0ZXJhdG9yIF9fcG9zaXRpb24sCgogICBfQXJnJiYgX192LAoKCgogICBfTm9kZUdlbiYgX19u
b2RlX2dlbikKICAgIHsKICAgICAgcGFpcjxfQmFzZV9wdHIsIF9CYXNlX3B0cj4gX19yZXMKID0g
X01fZ2V0X2luc2VydF9oaW50X3VuaXF1ZV9wb3MoX19wb3NpdGlvbiwgX0tleU9mVmFsdWUoKShf
X3YpKTsKCiAgICAgIGlmIChfX3Jlcy5zZWNvbmQpCiByZXR1cm4gX01faW5zZXJ0XyhfX3Jlcy5m
aXJzdCwgX19yZXMuc2Vjb25kLAogICAgIHN0ZDo6Zm9yd2FyZDxfQXJnPihfX3YpLAogICAgIF9f
bm9kZV9nZW4pOwogICAgICByZXR1cm4gaXRlcmF0b3IoX19yZXMuZmlyc3QpOwogICAgfQoKICB0
ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1
ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgcGFp
cjx0eXBlbmFtZSBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwKICAgICAgX0NvbXBh
cmUsIF9BbGxvYz46Ol9CYXNlX3B0ciwKICAgICAgICAgdHlwZW5hbWUgX1JiX3RyZWU8X0tleSwg
X1ZhbCwgX0tleU9mVmFsdWUsCiAgICAgIF9Db21wYXJlLCBfQWxsb2M+OjpfQmFzZV9wdHI+CiAg
ICBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBhcmUsIF9BbGxvYz46Ogog
ICAgX01fZ2V0X2luc2VydF9oaW50X2VxdWFsX3Bvcyhjb25zdF9pdGVyYXRvciBfX3Bvc2l0aW9u
LCBjb25zdCBrZXlfdHlwZSYgX19rKQogICAgewogICAgICBpdGVyYXRvciBfX3BvcyA9IF9fcG9z
aXRpb24uX01fY29uc3RfY2FzdCgpOwogICAgICB0eXBlZGVmIHBhaXI8X0Jhc2VfcHRyLCBfQmFz
ZV9wdHI+IF9SZXM7CgoKICAgICAgaWYgKF9fcG9zLl9NX25vZGUgPT0gX01fZW5kKCkpCiB7CiAg
IGlmIChzaXplKCkgPiAwCiAgICAgICAmJiAhX01faW1wbC5fTV9rZXlfY29tcGFyZShfX2ssIF9T
X2tleShfTV9yaWdodG1vc3QoKSkpKQogICAgIHJldHVybiBfUmVzKDAsIF9NX3JpZ2h0bW9zdCgp
KTsKICAgZWxzZQogICAgIHJldHVybiBfTV9nZXRfaW5zZXJ0X2VxdWFsX3BvcyhfX2spOwogfQog
ICAgICBlbHNlIGlmICghX01faW1wbC5fTV9rZXlfY29tcGFyZShfU19rZXkoX19wb3MuX01fbm9k
ZSksIF9faykpCiB7CgogICBpdGVyYXRvciBfX2JlZm9yZSA9IF9fcG9zOwogICBpZiAoX19wb3Mu
X01fbm9kZSA9PSBfTV9sZWZ0bW9zdCgpKQogICAgIHJldHVybiBfUmVzKF9NX2xlZnRtb3N0KCks
IF9NX2xlZnRtb3N0KCkpOwogICBlbHNlIGlmICghX01faW1wbC5fTV9rZXlfY29tcGFyZShfX2ss
IF9TX2tleSgoLS1fX2JlZm9yZSkuX01fbm9kZSkpKQogICAgIHsKICAgICAgIGlmIChfU19yaWdo
dChfX2JlZm9yZS5fTV9ub2RlKSA9PSAwKQogIHJldHVybiBfUmVzKDAsIF9fYmVmb3JlLl9NX25v
ZGUpOwogICAgICAgZWxzZQogIHJldHVybiBfUmVzKF9fcG9zLl9NX25vZGUsIF9fcG9zLl9NX25v
ZGUpOwogICAgIH0KICAgZWxzZQogICAgIHJldHVybiBfTV9nZXRfaW5zZXJ0X2VxdWFsX3Bvcyhf
X2spOwogfQogICAgICBlbHNlCiB7CgogICBpdGVyYXRvciBfX2FmdGVyID0gX19wb3M7CiAgIGlm
IChfX3Bvcy5fTV9ub2RlID09IF9NX3JpZ2h0bW9zdCgpKQogICAgIHJldHVybiBfUmVzKDAsIF9N
X3JpZ2h0bW9zdCgpKTsKICAgZWxzZSBpZiAoIV9NX2ltcGwuX01fa2V5X2NvbXBhcmUoX1Nfa2V5
KCgrK19fYWZ0ZXIpLl9NX25vZGUpLCBfX2spKQogICAgIHsKICAgICAgIGlmIChfU19yaWdodChf
X3Bvcy5fTV9ub2RlKSA9PSAwKQogIHJldHVybiBfUmVzKDAsIF9fcG9zLl9NX25vZGUpOwogICAg
ICAgZWxzZQogIHJldHVybiBfUmVzKF9fYWZ0ZXIuX01fbm9kZSwgX19hZnRlci5fTV9ub2RlKTsK
ICAgICB9CiAgIGVsc2UKICAgICByZXR1cm4gX1JlcygwLCAwKTsKIH0KICAgIH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5hbWUgX0tleU9mVmFsdWUsCiAg
ICAgICAgICAgdHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9BbGxvYz4KCiAgICB0ZW1wbGF0
ZTx0eXBlbmFtZSBfQXJnLCB0eXBlbmFtZSBfTm9kZUdlbj4KCgoKICAgICAgdHlwZW5hbWUgX1Ji
X3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjppdGVyYXRv
cgogICAgICBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBhcmUsIF9BbGxv
Yz46OgogICAgICBfTV9pbnNlcnRfZXF1YWxfKGNvbnN0X2l0ZXJhdG9yIF9fcG9zaXRpb24sCgog
ICAgICAgICBfQXJnJiYgX192LAoKCgogICAgICAgICBfTm9kZUdlbiYgX19ub2RlX2dlbikKICAg
ICAgewogcGFpcjxfQmFzZV9wdHIsIF9CYXNlX3B0cj4gX19yZXMKICAgPSBfTV9nZXRfaW5zZXJ0
X2hpbnRfZXF1YWxfcG9zKF9fcG9zaXRpb24sIF9LZXlPZlZhbHVlKCkoX192KSk7CgogaWYgKF9f
cmVzLnNlY29uZCkKICAgcmV0dXJuIF9NX2luc2VydF8oX19yZXMuZmlyc3QsIF9fcmVzLnNlY29u
ZCwKICAgICAgIHN0ZDo6Zm9yd2FyZDxfQXJnPihfX3YpLAogICAgICAgX19ub2RlX2dlbik7Cgog
cmV0dXJuIF9NX2luc2VydF9lcXVhbF9sb3dlcihzdGQ6OmZvcndhcmQ8X0FyZz4oX192KSk7CiAg
ICAgIH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWwsIHR5cGVuYW1l
IF9LZXlPZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxs
b2M+CiAgICB0eXBlbmFtZSBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBh
cmUsIF9BbGxvYz46Oml0ZXJhdG9yCiAgICBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1
ZSwgX0NvbXBhcmUsIF9BbGxvYz46OgogICAgX01faW5zZXJ0X25vZGUoX0Jhc2VfcHRyIF9feCwg
X0Jhc2VfcHRyIF9fcCwgX0xpbmtfdHlwZSBfX3opCiAgICB7CiAgICAgIGJvb2wgX19pbnNlcnRf
bGVmdCA9IChfX3ggIT0gMCB8fCBfX3AgPT0gX01fZW5kKCkKICAgICAgIHx8IF9NX2ltcGwuX01f
a2V5X2NvbXBhcmUoX1Nfa2V5KF9feiksCiAgICAgICAgICAgIF9TX2tleShfX3ApKSk7CgogICAg
ICBfUmJfdHJlZV9pbnNlcnRfYW5kX3JlYmFsYW5jZShfX2luc2VydF9sZWZ0LCBfX3osIF9fcCwK
ICAgICAgICB0aGlzLT5fTV9pbXBsLl9NX2hlYWRlcik7CiAgICAgICsrX01faW1wbC5fTV9ub2Rl
X2NvdW50OwogICAgICByZXR1cm4gaXRlcmF0b3IoX196KTsKICAgIH0KCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5hbWUgX0tleU9mVmFsdWUsCiAgICAgICAg
ICAgdHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHR5cGVuYW1lIF9SYl90
cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLCBfQ29tcGFyZSwgX0FsbG9jPjo6aXRlcmF0b3IK
ICAgIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLCBfQ29tcGFyZSwgX0FsbG9jPjo6
CiAgICBfTV9pbnNlcnRfbG93ZXJfbm9kZShfQmFzZV9wdHIgX19wLCBfTGlua190eXBlIF9feikK
ICAgIHsKICAgICAgYm9vbCBfX2luc2VydF9sZWZ0ID0gKF9fcCA9PSBfTV9lbmQoKQogICAgICAg
fHwgIV9NX2ltcGwuX01fa2V5X2NvbXBhcmUoX1Nfa2V5KF9fcCksCiAgICAgICAgICAgICBfU19r
ZXkoX196KSkpOwoKICAgICAgX1JiX3RyZWVfaW5zZXJ0X2FuZF9yZWJhbGFuY2UoX19pbnNlcnRf
bGVmdCwgX196LCBfX3AsCiAgICAgICAgdGhpcy0+X01faW1wbC5fTV9oZWFkZXIpOwogICAgICAr
K19NX2ltcGwuX01fbm9kZV9jb3VudDsKICAgICAgcmV0dXJuIGl0ZXJhdG9yKF9feik7CiAgICB9
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWwsIHR5cGVuYW1lIF9LZXlP
ZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxsb2M+CiAg
ICB0eXBlbmFtZSBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBhcmUsIF9B
bGxvYz46Oml0ZXJhdG9yCiAgICBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0Nv
bXBhcmUsIF9BbGxvYz46OgogICAgX01faW5zZXJ0X2VxdWFsX2xvd2VyX25vZGUoX0xpbmtfdHlw
ZSBfX3opCiAgICB7CiAgICAgIF9MaW5rX3R5cGUgX194ID0gX01fYmVnaW4oKTsKICAgICAgX0Jh
c2VfcHRyIF9feSA9IF9NX2VuZCgpOwogICAgICB3aGlsZSAoX194ICE9IDApCiB7CiAgIF9feSA9
IF9feDsKICAgX194ID0gIV9NX2ltcGwuX01fa2V5X2NvbXBhcmUoX1Nfa2V5KF9feCksIF9TX2tl
eShfX3opKSA/CiAgICAgICAgIF9TX2xlZnQoX194KSA6IF9TX3JpZ2h0KF9feCk7CiB9CiAgICAg
IHJldHVybiBfTV9pbnNlcnRfbG93ZXJfbm9kZShfX3ksIF9feik7CiAgICB9CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWwsIHR5cGVuYW1lIF9LZXlPZlZhbHVlLAogICAg
ICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB0ZW1wbGF0ZTx0
eXBlbmFtZS4uLiBfQXJncz4KICAgICAgcGFpcjx0eXBlbmFtZSBfUmJfdHJlZTxfS2V5LCBfVmFs
LCBfS2V5T2ZWYWx1ZSwKICAgICAgICBfQ29tcGFyZSwgX0FsbG9jPjo6aXRlcmF0b3IsIGJvb2w+
CiAgICAgIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLCBfQ29tcGFyZSwgX0FsbG9j
Pjo6CiAgICAgIF9NX2VtcGxhY2VfdW5pcXVlKF9BcmdzJiYuLi4gX19hcmdzKQogICAgICB7CiBf
TGlua190eXBlIF9feiA9IF9NX2NyZWF0ZV9ub2RlKHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdz
KS4uLik7CgogdHJ5CiAgIHsKICAgICB0eXBlZGVmIHBhaXI8aXRlcmF0b3IsIGJvb2w+IF9SZXM7
CiAgICAgYXV0byBfX3JlcyA9IF9NX2dldF9pbnNlcnRfdW5pcXVlX3BvcyhfU19rZXkoX196KSk7
CiAgICAgaWYgKF9fcmVzLnNlY29uZCkKICAgICAgIHJldHVybiBfUmVzKF9NX2luc2VydF9ub2Rl
KF9fcmVzLmZpcnN0LCBfX3Jlcy5zZWNvbmQsIF9feiksIHRydWUpOwoKICAgICBfTV9kcm9wX25v
ZGUoX196KTsKICAgICByZXR1cm4gX1JlcyhpdGVyYXRvcihfX3Jlcy5maXJzdCksIGZhbHNlKTsK
ICAgfQogY2F0Y2goLi4uKQogICB7CiAgICAgX01fZHJvcF9ub2RlKF9feik7CiAgICAgdGhyb3c7
CiAgIH0KICAgICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0
eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5h
bWUgX0FsbG9jPgogICAgdGVtcGxhdGU8dHlwZW5hbWUuLi4gX0FyZ3M+CiAgICAgIHR5cGVuYW1l
IF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLCBfQ29tcGFyZSwgX0FsbG9jPjo6aXRl
cmF0b3IKICAgICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBf
QWxsb2M+OjoKICAgICAgX01fZW1wbGFjZV9lcXVhbChfQXJncyYmLi4uIF9fYXJncykKICAgICAg
ewogX0xpbmtfdHlwZSBfX3ogPSBfTV9jcmVhdGVfbm9kZShzdGQ6OmZvcndhcmQ8X0FyZ3M+KF9f
YXJncykuLi4pOwoKIHRyeQogICB7CiAgICAgYXV0byBfX3JlcyA9IF9NX2dldF9pbnNlcnRfZXF1
YWxfcG9zKF9TX2tleShfX3opKTsKICAgICByZXR1cm4gX01faW5zZXJ0X25vZGUoX19yZXMuZmly
c3QsIF9fcmVzLnNlY29uZCwgX196KTsKICAgfQogY2F0Y2goLi4uKQogICB7CiAgICAgX01fZHJv
cF9ub2RlKF9feik7CiAgICAgdGhyb3c7CiAgIH0KICAgICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0
eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgdGVtcGxhdGU8dHlwZW5hbWUu
Li4gX0FyZ3M+CiAgICAgIHR5cGVuYW1lIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVl
LCBfQ29tcGFyZSwgX0FsbG9jPjo6aXRlcmF0b3IKICAgICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwg
X0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjoKICAgICAgX01fZW1wbGFjZV9oaW50X3Vu
aXF1ZShjb25zdF9pdGVyYXRvciBfX3BvcywgX0FyZ3MmJi4uLiBfX2FyZ3MpCiAgICAgIHsKIF9M
aW5rX3R5cGUgX196ID0gX01fY3JlYXRlX25vZGUoc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3Mp
Li4uKTsKCiB0cnkKICAgewogICAgIGF1dG8gX19yZXMgPSBfTV9nZXRfaW5zZXJ0X2hpbnRfdW5p
cXVlX3BvcyhfX3BvcywgX1Nfa2V5KF9feikpOwoKICAgICBpZiAoX19yZXMuc2Vjb25kKQogICAg
ICAgcmV0dXJuIF9NX2luc2VydF9ub2RlKF9fcmVzLmZpcnN0LCBfX3Jlcy5zZWNvbmQsIF9feik7
CgogICAgIF9NX2Ryb3Bfbm9kZShfX3opOwogICAgIHJldHVybiBpdGVyYXRvcihfX3Jlcy5maXJz
dCk7CiAgIH0KIGNhdGNoKC4uLikKICAgewogICAgIF9NX2Ryb3Bfbm9kZShfX3opOwogICAgIHRo
cm93OwogICB9CiAgICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1Zh
bCwgdHlwZW5hbWUgX0tleU9mVmFsdWUsCiAgICAgICAgICAgdHlwZW5hbWUgX0NvbXBhcmUsIHR5
cGVuYW1lIF9BbGxvYz4KICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogICAgICB0eXBl
bmFtZSBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBhcmUsIF9BbGxvYz46
Oml0ZXJhdG9yCiAgICAgIF9SYl90cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLCBfQ29tcGFy
ZSwgX0FsbG9jPjo6CiAgICAgIF9NX2VtcGxhY2VfaGludF9lcXVhbChjb25zdF9pdGVyYXRvciBf
X3BvcywgX0FyZ3MmJi4uLiBfX2FyZ3MpCiAgICAgIHsKIF9MaW5rX3R5cGUgX196ID0gX01fY3Jl
YXRlX25vZGUoc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsKCiB0cnkKICAgewogICAg
IGF1dG8gX19yZXMgPSBfTV9nZXRfaW5zZXJ0X2hpbnRfZXF1YWxfcG9zKF9fcG9zLCBfU19rZXko
X196KSk7CgogICAgIGlmIChfX3Jlcy5zZWNvbmQpCiAgICAgICByZXR1cm4gX01faW5zZXJ0X25v
ZGUoX19yZXMuZmlyc3QsIF9fcmVzLnNlY29uZCwgX196KTsKCiAgICAgcmV0dXJuIF9NX2luc2Vy
dF9lcXVhbF9sb3dlcl9ub2RlKF9feik7CiAgIH0KIGNhdGNoKC4uLikKICAgewogICAgIF9NX2Ry
b3Bfbm9kZShfX3opOwogICAgIHRocm93OwogICB9CiAgICAgIH0KCgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9LZXksIHR5cGVuYW1lIF9WYWwsIHR5cGVuYW1lIF9Lb1YsCiAgICAgICAgICAgdHlwZW5h
bWUgX0NtcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdGVtcGxhdGU8Y2xhc3MgX0lJPgogICAgICB2
b2lkCiAgICAgIF9SYl90cmVlPF9LZXksIF9WYWwsIF9Lb1YsIF9DbXAsIF9BbGxvYz46OgogICAg
ICBfTV9pbnNlcnRfdW5pcXVlKF9JSSBfX2ZpcnN0LCBfSUkgX19sYXN0KQogICAgICB7CiBfQWxs
b2Nfbm9kZSBfX2FuKCp0aGlzKTsKIGZvciAoOyBfX2ZpcnN0ICE9IF9fbGFzdDsgKytfX2ZpcnN0
KQogICBfTV9pbnNlcnRfdW5pcXVlXyhlbmQoKSwgKl9fZmlyc3QsIF9fYW4pOwogICAgICB9Cgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWwsIHR5cGVuYW1lIF9Lb1YsCiAg
ICAgICAgICAgdHlwZW5hbWUgX0NtcCwgdHlwZW5hbWUgX0FsbG9jPgogICAgdGVtcGxhdGU8Y2xh
c3MgX0lJPgogICAgICB2b2lkCiAgICAgIF9SYl90cmVlPF9LZXksIF9WYWwsIF9Lb1YsIF9DbXAs
IF9BbGxvYz46OgogICAgICBfTV9pbnNlcnRfZXF1YWwoX0lJIF9fZmlyc3QsIF9JSSBfX2xhc3Qp
CiAgICAgIHsKIF9BbGxvY19ub2RlIF9fYW4oKnRoaXMpOwogZm9yICg7IF9fZmlyc3QgIT0gX19s
YXN0OyArK19fZmlyc3QpCiAgIF9NX2luc2VydF9lcXVhbF8oZW5kKCksICpfX2ZpcnN0LCBfX2Fu
KTsKICAgICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBl
bmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUg
X0FsbG9jPgogICAgdm9pZAogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9D
b21wYXJlLCBfQWxsb2M+OjoKICAgIF9NX2VyYXNlX2F1eChjb25zdF9pdGVyYXRvciBfX3Bvc2l0
aW9uKQogICAgewogICAgICBfTGlua190eXBlIF9feSA9CiBzdGF0aWNfY2FzdDxfTGlua190eXBl
PihfUmJfdHJlZV9yZWJhbGFuY2VfZm9yX2VyYXNlCiAgICAoY29uc3RfY2FzdDxfQmFzZV9wdHI+
KF9fcG9zaXRpb24uX01fbm9kZSksCiAgICAgdGhpcy0+X01faW1wbC5fTV9oZWFkZXIpKTsKICAg
ICAgX01fZHJvcF9ub2RlKF9feSk7CiAgICAgIC0tX01faW1wbC5fTV9ub2RlX2NvdW50OwogICAg
fQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5
T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgog
ICAgdm9pZAogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBf
QWxsb2M+OjoKICAgIF9NX2VyYXNlX2F1eChjb25zdF9pdGVyYXRvciBfX2ZpcnN0LCBjb25zdF9p
dGVyYXRvciBfX2xhc3QpCiAgICB7CiAgICAgIGlmIChfX2ZpcnN0ID09IGJlZ2luKCkgJiYgX19s
YXN0ID09IGVuZCgpKQogY2xlYXIoKTsKICAgICAgZWxzZQogd2hpbGUgKF9fZmlyc3QgIT0gX19s
YXN0KQogICBlcmFzZShfX2ZpcnN0KyspOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5
LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAgICB0eXBlbmFt
ZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgdHlwZW5hbWUgX1JiX3RyZWU8X0tleSwg
X1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+OjpzaXplX3R5cGUKICAgIF9SYl90
cmVlPF9LZXksIF9WYWwsIF9LZXlPZlZhbHVlLCBfQ29tcGFyZSwgX0FsbG9jPjo6CiAgICBlcmFz
ZShjb25zdCBfS2V5JiBfX3gpCiAgICB7CiAgICAgIHBhaXI8aXRlcmF0b3IsIGl0ZXJhdG9yPiBf
X3AgPSBlcXVhbF9yYW5nZShfX3gpOwogICAgICBjb25zdCBzaXplX3R5cGUgX19vbGRfc2l6ZSA9
IHNpemUoKTsKICAgICAgZXJhc2UoX19wLmZpcnN0LCBfX3Auc2Vjb25kKTsKICAgICAgcmV0dXJu
IF9fb2xkX3NpemUgLSBzaXplKCk7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5
cGVuYW1lIF9WYWwsIHR5cGVuYW1lIF9LZXlPZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9D
b21wYXJlLCB0eXBlbmFtZSBfQWxsb2M+CiAgICB2b2lkCiAgICBfUmJfdHJlZTxfS2V5LCBfVmFs
LCBfS2V5T2ZWYWx1ZSwgX0NvbXBhcmUsIF9BbGxvYz46OgogICAgZXJhc2UoY29uc3QgX0tleSog
X19maXJzdCwgY29uc3QgX0tleSogX19sYXN0KQogICAgewogICAgICB3aGlsZSAoX19maXJzdCAh
PSBfX2xhc3QpCiBlcmFzZSgqX19maXJzdCsrKTsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUg
X0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5hbWUgX0tleU9mVmFsdWUsCiAgICAgICAgICAgdHlw
ZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9BbGxvYz4KICAgIHR5cGVuYW1lIF9SYl90cmVlPF9L
ZXksIF9WYWwsIF9LZXlPZlZhbHVlLAogICAgICAgIF9Db21wYXJlLCBfQWxsb2M+OjppdGVyYXRv
cgogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsIF9Db21wYXJlLCBfQWxsb2M+
OjoKICAgIGZpbmQoY29uc3QgX0tleSYgX19rKQogICAgewogICAgICBpdGVyYXRvciBfX2ogPSBf
TV9sb3dlcl9ib3VuZChfTV9iZWdpbigpLCBfTV9lbmQoKSwgX19rKTsKICAgICAgcmV0dXJuIChf
X2ogPT0gZW5kKCkKICAgICAgIHx8IF9NX2ltcGwuX01fa2V5X2NvbXBhcmUoX19rLAogICAgIF9T
X2tleShfX2ouX01fbm9kZSkpKSA/IGVuZCgpIDogX19qOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfS2V5LCB0eXBlbmFtZSBfVmFsLCB0eXBlbmFtZSBfS2V5T2ZWYWx1ZSwKICAgICAgICAg
ICB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgdHlwZW5hbWUgX1JiX3Ry
ZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFsdWUsCiAgICAgICAgX0NvbXBhcmUsIF9BbGxvYz46OmNv
bnN0X2l0ZXJhdG9yCiAgICBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBh
cmUsIF9BbGxvYz46OgogICAgZmluZChjb25zdCBfS2V5JiBfX2spIGNvbnN0CiAgICB7CiAgICAg
IGNvbnN0X2l0ZXJhdG9yIF9faiA9IF9NX2xvd2VyX2JvdW5kKF9NX2JlZ2luKCksIF9NX2VuZCgp
LCBfX2spOwogICAgICByZXR1cm4gKF9faiA9PSBlbmQoKQogICAgICAgfHwgX01faW1wbC5fTV9r
ZXlfY29tcGFyZShfX2ssCiAgICAgX1Nfa2V5KF9fai5fTV9ub2RlKSkpID8gZW5kKCkgOiBfX2o7
CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9WYWwsIHR5cGVuYW1l
IF9LZXlPZlZhbHVlLAogICAgICAgICAgIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxs
b2M+CiAgICB0eXBlbmFtZSBfUmJfdHJlZTxfS2V5LCBfVmFsLCBfS2V5T2ZWYWx1ZSwgX0NvbXBh
cmUsIF9BbGxvYz46OnNpemVfdHlwZQogICAgX1JiX3RyZWU8X0tleSwgX1ZhbCwgX0tleU9mVmFs
dWUsIF9Db21wYXJlLCBfQWxsb2M+OjoKICAgIGNvdW50KGNvbnN0IF9LZXkmIF9faykgY29uc3QK
ICAgIHsKICAgICAgcGFpcjxjb25zdF9pdGVyYXRvciwgY29uc3RfaXRlcmF0b3I+IF9fcCA9IGVx
dWFsX3JhbmdlKF9fayk7CiAgICAgIGNvbnN0IHNpemVfdHlwZSBfX24gPSBzdGQ6OmRpc3RhbmNl
KF9fcC5maXJzdCwgX19wLnNlY29uZCk7CiAgICAgIHJldHVybiBfX247CiAgICB9CgogIF9fYXR0
cmlidXRlX18gKChfX3B1cmVfXykpIHVuc2lnbmVkIGludAogIF9SYl90cmVlX2JsYWNrX2NvdW50
KGNvbnN0IF9SYl90cmVlX25vZGVfYmFzZSogX19ub2RlLAogICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IF9SYl90cmVlX25vZGVfYmFzZSogX19yb290KSB0aHJvdyAoKTsKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1ZhbCwgdHlwZW5hbWUgX0tleU9mVmFsdWUsCiAgICAg
ICAgICAgdHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGJvb2wKICAgIF9S
Yl90cmVlPF9LZXksX1ZhbCxfS2V5T2ZWYWx1ZSxfQ29tcGFyZSxfQWxsb2M+OjpfX3JiX3Zlcmlm
eSgpIGNvbnN0CiAgICB7CiAgICAgIGlmIChfTV9pbXBsLl9NX25vZGVfY291bnQgPT0gMCB8fCBi
ZWdpbigpID09IGVuZCgpKQogcmV0dXJuIF9NX2ltcGwuX01fbm9kZV9jb3VudCA9PSAwICYmIGJl
Z2luKCkgPT0gZW5kKCkKICAgICAgICAmJiB0aGlzLT5fTV9pbXBsLl9NX2hlYWRlci5fTV9sZWZ0
ID09IF9NX2VuZCgpCiAgICAgICAgJiYgdGhpcy0+X01faW1wbC5fTV9oZWFkZXIuX01fcmlnaHQg
PT0gX01fZW5kKCk7CgogICAgICB1bnNpZ25lZCBpbnQgX19sZW4gPSBfUmJfdHJlZV9ibGFja19j
b3VudChfTV9sZWZ0bW9zdCgpLCBfTV9yb290KCkpOwogICAgICBmb3IgKGNvbnN0X2l0ZXJhdG9y
IF9faXQgPSBiZWdpbigpOyBfX2l0ICE9IGVuZCgpOyArK19faXQpCiB7CiAgIF9Db25zdF9MaW5r
X3R5cGUgX194ID0gc3RhdGljX2Nhc3Q8X0NvbnN0X0xpbmtfdHlwZT4oX19pdC5fTV9ub2RlKTsK
ICAgX0NvbnN0X0xpbmtfdHlwZSBfX0wgPSBfU19sZWZ0KF9feCk7CiAgIF9Db25zdF9MaW5rX3R5
cGUgX19SID0gX1NfcmlnaHQoX194KTsKCiAgIGlmIChfX3gtPl9NX2NvbG9yID09IF9TX3JlZCkK
ICAgICBpZiAoKF9fTCAmJiBfX0wtPl9NX2NvbG9yID09IF9TX3JlZCkKICB8fCAoX19SICYmIF9f
Ui0+X01fY29sb3IgPT0gX1NfcmVkKSkKICAgICAgIHJldHVybiBmYWxzZTsKCiAgIGlmIChfX0wg
JiYgX01faW1wbC5fTV9rZXlfY29tcGFyZShfU19rZXkoX194KSwgX1Nfa2V5KF9fTCkpKQogICAg
IHJldHVybiBmYWxzZTsKICAgaWYgKF9fUiAmJiBfTV9pbXBsLl9NX2tleV9jb21wYXJlKF9TX2tl
eShfX1IpLCBfU19rZXkoX194KSkpCiAgICAgcmV0dXJuIGZhbHNlOwoKICAgaWYgKCFfX0wgJiYg
IV9fUiAmJiBfUmJfdHJlZV9ibGFja19jb3VudChfX3gsIF9NX3Jvb3QoKSkgIT0gX19sZW4pCiAg
ICAgcmV0dXJuIGZhbHNlOwogfQoKICAgICAgaWYgKF9NX2xlZnRtb3N0KCkgIT0gX1JiX3RyZWVf
bm9kZV9iYXNlOjpfU19taW5pbXVtKF9NX3Jvb3QoKSkpCiByZXR1cm4gZmFsc2U7CiAgICAgIGlm
IChfTV9yaWdodG1vc3QoKSAhPSBfUmJfdHJlZV9ub2RlX2Jhc2U6Ol9TX21heGltdW0oX01fcm9v
dCgpKSkKIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgoKfQojIDYxICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL21hcCIgMiAzCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL3N0bF9tYXAuaCIgMSAzCiMgNjYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9z
dGxfbWFwLmgiIDMKbmFtZXNwYWNlIHN0ZCBfX2F0dHJpYnV0ZV9fICgoX192aXNpYmlsaXR5X18g
KCJkZWZhdWx0IikpKQp7CgojIDk0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX21h
cC5oIiAzCiAgdGVtcGxhdGUgPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUg
X0NvbXBhcmUgPSBzdGQ6Omxlc3M8X0tleT4sCiAgICAgICAgICAgIHR5cGVuYW1lIF9BbGxvYyA9
IHN0ZDo6YWxsb2NhdG9yPHN0ZDo6cGFpcjxjb25zdCBfS2V5LCBfVHA+ID4gPgogICAgY2xhc3Mg
bWFwCiAgICB7CiAgICBwdWJsaWM6CiAgICAgIHR5cGVkZWYgX0tleSBrZXlfdHlwZTsKICAgICAg
dHlwZWRlZiBfVHAgbWFwcGVkX3R5cGU7CiAgICAgIHR5cGVkZWYgc3RkOjpwYWlyPGNvbnN0IF9L
ZXksIF9UcD4gdmFsdWVfdHlwZTsKICAgICAgdHlwZWRlZiBfQ29tcGFyZSBrZXlfY29tcGFyZTsK
ICAgICAgdHlwZWRlZiBfQWxsb2MgYWxsb2NhdG9yX3R5cGU7CgogICAgcHJpdmF0ZToKCiAgICAg
IHR5cGVkZWYgdHlwZW5hbWUgX0FsbG9jOjp2YWx1ZV90eXBlIF9BbGxvY192YWx1ZV90eXBlOwog
ICAgIAogICAgIAoKICAgICAKCiAgICBwdWJsaWM6CiAgICAgIGNsYXNzIHZhbHVlX2NvbXBhcmUK
ICAgICAgOiBwdWJsaWMgc3RkOjpiaW5hcnlfZnVuY3Rpb248dmFsdWVfdHlwZSwgdmFsdWVfdHlw
ZSwgYm9vbD4KICAgICAgewogZnJpZW5kIGNsYXNzIG1hcDxfS2V5LCBfVHAsIF9Db21wYXJlLCBf
QWxsb2M+OwogICAgICBwcm90ZWN0ZWQ6CiBfQ29tcGFyZSBjb21wOwoKIHZhbHVlX2NvbXBhcmUo
X0NvbXBhcmUgX19jKQogOiBjb21wKF9fYykgeyB9CgogICAgICBwdWJsaWM6CiBib29sIG9wZXJh
dG9yKCkoY29uc3QgdmFsdWVfdHlwZSYgX194LCBjb25zdCB2YWx1ZV90eXBlJiBfX3kpIGNvbnN0
CiB7IHJldHVybiBjb21wKF9feC5maXJzdCwgX195LmZpcnN0KTsgfQogICAgICB9OwoKICAgIHBy
aXZhdGU6CgogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9fZ251X2N4eDo6X19hbGxvY190cmFpdHM8
X0FsbG9jPjo6dGVtcGxhdGUKIHJlYmluZDx2YWx1ZV90eXBlPjo6b3RoZXIgX1BhaXJfYWxsb2Nf
dHlwZTsKCiAgICAgIHR5cGVkZWYgX1JiX3RyZWU8a2V5X3R5cGUsIHZhbHVlX3R5cGUsIF9TZWxl
Y3Qxc3Q8dmFsdWVfdHlwZT4sCiAgICAgICAgIGtleV9jb21wYXJlLCBfUGFpcl9hbGxvY190eXBl
PiBfUmVwX3R5cGU7CgoKICAgICAgX1JlcF90eXBlIF9NX3Q7CgogICAgICB0eXBlZGVmIF9fZ251
X2N4eDo6X19hbGxvY190cmFpdHM8X1BhaXJfYWxsb2NfdHlwZT4gX0FsbG9jX3RyYWl0czsKCiAg
ICBwdWJsaWM6CgoKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQWxsb2NfdHJhaXRzOjpwb2ludGVy
IHBvaW50ZXI7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0FsbG9jX3RyYWl0czo6Y29uc3RfcG9p
bnRlciBjb25zdF9wb2ludGVyOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9BbGxvY190cmFpdHM6
OnJlZmVyZW5jZSByZWZlcmVuY2U7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0FsbG9jX3RyYWl0
czo6Y29uc3RfcmVmZXJlbmNlIGNvbnN0X3JlZmVyZW5jZTsKICAgICAgdHlwZWRlZiB0eXBlbmFt
ZSBfUmVwX3R5cGU6Oml0ZXJhdG9yIGl0ZXJhdG9yOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9S
ZXBfdHlwZTo6Y29uc3RfaXRlcmF0b3IgY29uc3RfaXRlcmF0b3I7CiAgICAgIHR5cGVkZWYgdHlw
ZW5hbWUgX1JlcF90eXBlOjpzaXplX3R5cGUgc2l6ZV90eXBlOwogICAgICB0eXBlZGVmIHR5cGVu
YW1lIF9SZXBfdHlwZTo6ZGlmZmVyZW5jZV90eXBlIGRpZmZlcmVuY2VfdHlwZTsKICAgICAgdHlw
ZWRlZiB0eXBlbmFtZSBfUmVwX3R5cGU6OnJldmVyc2VfaXRlcmF0b3IgcmV2ZXJzZV9pdGVyYXRv
cjsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfUmVwX3R5cGU6OmNvbnN0X3JldmVyc2VfaXRlcmF0
b3IgY29uc3RfcmV2ZXJzZV9pdGVyYXRvcjsKCgoKCgoKCiAgICAgIG1hcCgpCgogICAgICBub2V4
Y2VwdChpc19ub3Rocm93X2RlZmF1bHRfY29uc3RydWN0aWJsZTxhbGxvY2F0b3JfdHlwZT46OnZh
bHVlKQoKICAgICAgOiBfTV90KCkgeyB9CgoKCgoKCiAgICAgIGV4cGxpY2l0CiAgICAgIG1hcChj
b25zdCBfQ29tcGFyZSYgX19jb21wLAogICBjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hID0gYWxs
b2NhdG9yX3R5cGUoKSkKICAgICAgOiBfTV90KF9fY29tcCwgX1BhaXJfYWxsb2NfdHlwZShfX2Ep
KSB7IH0KIyAxODUgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbWFwLmgiIDMKICAg
ICAgbWFwKGNvbnN0IG1hcCYgX194KQogICAgICA6IF9NX3QoX194Ll9NX3QpIHsgfQojIDE5NiAi
L3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tYXAuaCIgMwogICAgICBtYXAobWFwJiYg
X194KQogICAgICBub2V4Y2VwdChpc19ub3Rocm93X2NvcHlfY29uc3RydWN0aWJsZTxfQ29tcGFy
ZT46OnZhbHVlKQogICAgICA6IF9NX3Qoc3RkOjptb3ZlKF9feC5fTV90KSkgeyB9CiMgMjExICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX21hcC5oIiAzCiAgICAgIG1hcChpbml0aWFs
aXplcl9saXN0PHZhbHVlX3R5cGU+IF9fbCwKICAgY29uc3QgX0NvbXBhcmUmIF9fY29tcCA9IF9D
b21wYXJlKCksCiAgIGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EgPSBhbGxvY2F0b3JfdHlwZSgp
KQogICAgICA6IF9NX3QoX19jb21wLCBfUGFpcl9hbGxvY190eXBlKF9fYSkpCiAgICAgIHsgX01f
dC5fTV9pbnNlcnRfdW5pcXVlKF9fbC5iZWdpbigpLCBfX2wuZW5kKCkpOyB9CgoKICAgICAgZXhw
bGljaXQKICAgICAgbWFwKGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EpCiAgICAgIDogX01fdChf
Q29tcGFyZSgpLCBfUGFpcl9hbGxvY190eXBlKF9fYSkpIHsgfQoKCiAgICAgIG1hcChjb25zdCBt
YXAmIF9fbSwgY29uc3QgYWxsb2NhdG9yX3R5cGUmIF9fYSkKICAgICAgOiBfTV90KF9fbS5fTV90
LCBfUGFpcl9hbGxvY190eXBlKF9fYSkpIHsgfQoKCiAgICAgIG1hcChtYXAmJiBfX20sIGNvbnN0
IGFsbG9jYXRvcl90eXBlJiBfX2EpCiAgICAgIG5vZXhjZXB0KGlzX25vdGhyb3dfY29weV9jb25z
dHJ1Y3RpYmxlPF9Db21wYXJlPjo6dmFsdWUKICAgICAgICAmJiBfQWxsb2NfdHJhaXRzOjpfU19h
bHdheXNfZXF1YWwoKSkKICAgICAgOiBfTV90KHN0ZDo6bW92ZShfX20uX01fdCksIF9QYWlyX2Fs
bG9jX3R5cGUoX19hKSkgeyB9CgoKICAgICAgbWFwKGluaXRpYWxpemVyX2xpc3Q8dmFsdWVfdHlw
ZT4gX19sLCBjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hKQogICAgICA6IF9NX3QoX0NvbXBhcmUo
KSwgX1BhaXJfYWxsb2NfdHlwZShfX2EpKQogICAgICB7IF9NX3QuX01faW5zZXJ0X3VuaXF1ZShf
X2wuYmVnaW4oKSwgX19sLmVuZCgpKTsgfQoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1
dEl0ZXJhdG9yPgogICAgICAgIG1hcChfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVy
YXRvciBfX2xhc3QsCiAgICAgY29uc3QgYWxsb2NhdG9yX3R5cGUmIF9fYSkKIDogX01fdChfQ29t
cGFyZSgpLCBfUGFpcl9hbGxvY190eXBlKF9fYSkpCiAgICAgICAgeyBfTV90Ll9NX2luc2VydF91
bmlxdWUoX19maXJzdCwgX19sYXN0KTsgfQojIDI1NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3N0bF9tYXAuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcj4K
ICAgICAgICBtYXAoX0lucHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0
KQogOiBfTV90KCkKICAgICAgICB7IF9NX3QuX01faW5zZXJ0X3VuaXF1ZShfX2ZpcnN0LCBfX2xh
c3QpOyB9CiMgMjcyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX21hcC5oIiAzCiAg
ICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yPgogICAgICAgIG1hcChfSW5wdXRJ
dGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3QsCiAgICAgY29uc3QgX0NvbXBh
cmUmIF9fY29tcCwKICAgICBjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hID0gYWxsb2NhdG9yX3R5
cGUoKSkKIDogX01fdChfX2NvbXAsIF9QYWlyX2FsbG9jX3R5cGUoX19hKSkKICAgICAgICB7IF9N
X3QuX01faW5zZXJ0X3VuaXF1ZShfX2ZpcnN0LCBfX2xhc3QpOyB9CiMgMjk1ICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvc3RsX21hcC5oIiAzCiAgICAgIG1hcCYKICAgICAgb3BlcmF0b3I9
KGNvbnN0IG1hcCYgX194KQogICAgICB7CiBfTV90ID0gX194Ll9NX3Q7CiByZXR1cm4gKnRoaXM7
CiAgICAgIH0KCgoKICAgICAgbWFwJgogICAgICBvcGVyYXRvcj0obWFwJiYpID0gZGVmYXVsdDsK
IyAzMTggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbWFwLmgiIDMKICAgICAgbWFw
JgogICAgICBvcGVyYXRvcj0oaW5pdGlhbGl6ZXJfbGlzdDx2YWx1ZV90eXBlPiBfX2wpCiAgICAg
IHsKIF9NX3QuX01fYXNzaWduX3VuaXF1ZShfX2wuYmVnaW4oKSwgX19sLmVuZCgpKTsKIHJldHVy
biAqdGhpczsKICAgICAgfQoKCgogICAgICBhbGxvY2F0b3JfdHlwZQogICAgICBnZXRfYWxsb2Nh
dG9yKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gYWxsb2NhdG9yX3R5cGUoX01fdC5n
ZXRfYWxsb2NhdG9yKCkpOyB9CgoKCgoKCgogICAgICBpdGVyYXRvcgogICAgICBiZWdpbigpIG5v
ZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX3QuYmVnaW4oKTsgfQoKCgoKCgogICAgICBjb25zdF9p
dGVyYXRvcgogICAgICBiZWdpbigpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX3Qu
YmVnaW4oKTsgfQoKCgoKCgogICAgICBpdGVyYXRvcgogICAgICBlbmQoKSBub2V4Y2VwdAogICAg
ICB7IHJldHVybiBfTV90LmVuZCgpOyB9CgoKCgoKCiAgICAgIGNvbnN0X2l0ZXJhdG9yCiAgICAg
IGVuZCgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX3QuZW5kKCk7IH0KCgoKCgoK
ICAgICAgcmV2ZXJzZV9pdGVyYXRvcgogICAgICByYmVnaW4oKSBub2V4Y2VwdAogICAgICB7IHJl
dHVybiBfTV90LnJiZWdpbigpOyB9CgoKCgoKCiAgICAgIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IK
ICAgICAgcmJlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4gX01fdC5yYmVnaW4o
KTsgfQoKCgoKCgogICAgICByZXZlcnNlX2l0ZXJhdG9yCiAgICAgIHJlbmQoKSBub2V4Y2VwdAog
ICAgICB7IHJldHVybiBfTV90LnJlbmQoKTsgfQoKCgoKCgogICAgICBjb25zdF9yZXZlcnNlX2l0
ZXJhdG9yCiAgICAgIHJlbmQoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV90LnJl
bmQoKTsgfQoKCgoKCgoKICAgICAgY29uc3RfaXRlcmF0b3IKICAgICAgY2JlZ2luKCkgY29uc3Qg
bm9leGNlcHQKICAgICAgeyByZXR1cm4gX01fdC5iZWdpbigpOyB9CgoKCgoKCiAgICAgIGNvbnN0
X2l0ZXJhdG9yCiAgICAgIGNlbmQoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV90
LmVuZCgpOyB9CgoKCgoKCiAgICAgIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAgICAgY3JiZWdp
bigpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX3QucmJlZ2luKCk7IH0KCgoKCgoK
ICAgICAgY29uc3RfcmV2ZXJzZV9pdGVyYXRvcgogICAgICBjcmVuZCgpIGNvbnN0IG5vZXhjZXB0
CiAgICAgIHsgcmV0dXJuIF9NX3QucmVuZCgpOyB9CgoKCgoKCiAgICAgIGJvb2wKICAgICAgZW1w
dHkoKSBjb25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV90LmVtcHR5KCk7IH0KCgogICAg
ICBzaXplX3R5cGUKICAgICAgc2l6ZSgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9N
X3Quc2l6ZSgpOyB9CgoKICAgICAgc2l6ZV90eXBlCiAgICAgIG1heF9zaXplKCkgY29uc3Qgbm9l
eGNlcHQKICAgICAgeyByZXR1cm4gX01fdC5tYXhfc2l6ZSgpOyB9CiMgNDczICIvdXNyL2luY2x1
ZGUvYysrLzYuMC4wL2JpdHMvc3RsX21hcC5oIiAzCiAgICAgIG1hcHBlZF90eXBlJgogICAgICBv
cGVyYXRvcltdKGNvbnN0IGtleV90eXBlJiBfX2spCiAgICAgIHsKCgoKIGl0ZXJhdG9yIF9faSA9
IGxvd2VyX2JvdW5kKF9fayk7CgogaWYgKF9faSA9PSBlbmQoKSB8fCBrZXlfY29tcCgpKF9faywg
KCpfX2kpLmZpcnN0KSkKCiAgIF9faSA9IF9NX3QuX01fZW1wbGFjZV9oaW50X3VuaXF1ZShfX2ks
IHN0ZDo6cGllY2V3aXNlX2NvbnN0cnVjdCwKICAgICAgICAgc3RkOjp0dXBsZTxjb25zdCBrZXlf
dHlwZSY+KF9fayksCiAgICAgICAgIHN0ZDo6dHVwbGU8PigpKTsKCgoKIHJldHVybiAoKl9faSku
c2Vjb25kOwogICAgICB9CgoKICAgICAgbWFwcGVkX3R5cGUmCiAgICAgIG9wZXJhdG9yW10oa2V5
X3R5cGUmJiBfX2spCiAgICAgIHsKCgoKIGl0ZXJhdG9yIF9faSA9IGxvd2VyX2JvdW5kKF9fayk7
CgogaWYgKF9faSA9PSBlbmQoKSB8fCBrZXlfY29tcCgpKF9faywgKCpfX2kpLmZpcnN0KSkKICAg
X19pID0gX01fdC5fTV9lbXBsYWNlX2hpbnRfdW5pcXVlKF9faSwgc3RkOjpwaWVjZXdpc2VfY29u
c3RydWN0LAogICAgIHN0ZDo6Zm9yd2FyZF9hc190dXBsZShzdGQ6Om1vdmUoX19rKSksCiAgICAg
c3RkOjp0dXBsZTw+KCkpOwogcmV0dXJuICgqX19pKS5zZWNvbmQ7CiAgICAgIH0KIyA1MTggIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbWFwLmgiIDMKICAgICAgbWFwcGVkX3R5cGUm
CiAgICAgIGF0KGNvbnN0IGtleV90eXBlJiBfX2spCiAgICAgIHsKIGl0ZXJhdG9yIF9faSA9IGxv
d2VyX2JvdW5kKF9fayk7CiBpZiAoX19pID09IGVuZCgpIHx8IGtleV9jb21wKCkoX19rLCAoKl9f
aSkuZmlyc3QpKQogICBfX3Rocm93X291dF9vZl9yYW5nZSgoIm1hcDo6YXQiKSk7CiByZXR1cm4g
KCpfX2kpLnNlY29uZDsKICAgICAgfQoKICAgICAgY29uc3QgbWFwcGVkX3R5cGUmCiAgICAgIGF0
KGNvbnN0IGtleV90eXBlJiBfX2spIGNvbnN0CiAgICAgIHsKIGNvbnN0X2l0ZXJhdG9yIF9faSA9
IGxvd2VyX2JvdW5kKF9fayk7CiBpZiAoX19pID09IGVuZCgpIHx8IGtleV9jb21wKCkoX19rLCAo
Kl9faSkuZmlyc3QpKQogICBfX3Rocm93X291dF9vZl9yYW5nZSgoIm1hcDo6YXQiKSk7CiByZXR1
cm4gKCpfX2kpLnNlY29uZDsKICAgICAgfQojIDU1NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9i
aXRzL3N0bF9tYXAuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZS4uLiBfQXJncz4KIHN0ZDo6
cGFpcjxpdGVyYXRvciwgYm9vbD4KIGVtcGxhY2UoX0FyZ3MmJi4uLiBfX2FyZ3MpCiB7IHJldHVy
biBfTV90Ll9NX2VtcGxhY2VfdW5pcXVlKHN0ZDo6Zm9yd2FyZDxfQXJncz4oX19hcmdzKS4uLik7
IH0KIyA1ODYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbWFwLmgiIDMKICAgICAg
dGVtcGxhdGU8dHlwZW5hbWUuLi4gX0FyZ3M+CiBpdGVyYXRvcgogZW1wbGFjZV9oaW50KGNvbnN0
X2l0ZXJhdG9yIF9fcG9zLCBfQXJncyYmLi4uIF9fYXJncykKIHsKICAgcmV0dXJuIF9NX3QuX01f
ZW1wbGFjZV9oaW50X3VuaXF1ZShfX3BvcywKICAgICAgICAgIHN0ZDo6Zm9yd2FyZDxfQXJncz4o
X19hcmdzKS4uLik7CiB9CiMgNzMwICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX21h
cC5oIiAzCiAgICAgIHN0ZDo6cGFpcjxpdGVyYXRvciwgYm9vbD4KICAgICAgaW5zZXJ0KGNvbnN0
IHZhbHVlX3R5cGUmIF9feCkKICAgICAgeyByZXR1cm4gX01fdC5fTV9pbnNlcnRfdW5pcXVlKF9f
eCk7IH0KCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUGFpciwgdHlwZW5hbWUgPSB0eXBlbmFt
ZQogICAgICAgIHN0ZDo6ZW5hYmxlX2lmPHN0ZDo6aXNfY29uc3RydWN0aWJsZTx2YWx1ZV90eXBl
LAogICAgICAgICAgX1BhaXImJj46OnZhbHVlPjo6dHlwZT4KICAgICAgICBzdGQ6OnBhaXI8aXRl
cmF0b3IsIGJvb2w+CiAgICAgICAgaW5zZXJ0KF9QYWlyJiYgX194KQogICAgICAgIHsgcmV0dXJu
IF9NX3QuX01faW5zZXJ0X3VuaXF1ZShzdGQ6OmZvcndhcmQ8X1BhaXI+KF9feCkpOyB9CiMgNzUx
ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX21hcC5oIiAzCiAgICAgIHZvaWQKICAg
ICAgaW5zZXJ0KHN0ZDo6aW5pdGlhbGl6ZXJfbGlzdDx2YWx1ZV90eXBlPiBfX2xpc3QpCiAgICAg
IHsgaW5zZXJ0KF9fbGlzdC5iZWdpbigpLCBfX2xpc3QuZW5kKCkpOyB9CiMgNzc5ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX21hcC5oIiAzCiAgICAgIGl0ZXJhdG9yCgogICAgICBp
bnNlcnQoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgY29uc3QgdmFsdWVfdHlwZSYgX194KQoK
CgogICAgICB7IHJldHVybiBfTV90Ll9NX2luc2VydF91bmlxdWVfKF9fcG9zaXRpb24sIF9feCk7
IH0KCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfUGFpciwgdHlwZW5hbWUgPSB0eXBlbmFtZQog
ICAgICAgIHN0ZDo6ZW5hYmxlX2lmPHN0ZDo6aXNfY29uc3RydWN0aWJsZTx2YWx1ZV90eXBlLAog
ICAgICAgICAgX1BhaXImJj46OnZhbHVlPjo6dHlwZT4KICAgICAgICBpdGVyYXRvcgogICAgICAg
IGluc2VydChjb25zdF9pdGVyYXRvciBfX3Bvc2l0aW9uLCBfUGFpciYmIF9feCkKICAgICAgICB7
IHJldHVybiBfTV90Ll9NX2luc2VydF91bmlxdWVfKF9fcG9zaXRpb24sCiAgICAgc3RkOjpmb3J3
YXJkPF9QYWlyPihfX3gpKTsgfQojIDgwNSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0
bF9tYXAuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcj4KICAgICAg
ICB2b2lkCiAgICAgICAgaW5zZXJ0KF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJh
dG9yIF9fbGFzdCkKICAgICAgICB7IF9NX3QuX01faW5zZXJ0X3VuaXF1ZShfX2ZpcnN0LCBfX2xh
c3QpOyB9CiMgOTQzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX21hcC5oIiAzCiAg
ICAgIGl0ZXJhdG9yCiAgICAgIGVyYXNlKGNvbnN0X2l0ZXJhdG9yIF9fcG9zaXRpb24pCiAgICAg
IHsgcmV0dXJuIF9NX3QuZXJhc2UoX19wb3NpdGlvbik7IH0KCgogICAgICBfX2F0dHJpYnV0ZSAo
KF9fYWJpX3RhZ19fICgiY3h4MTEiKSkpCiAgICAgIGl0ZXJhdG9yCiAgICAgIGVyYXNlKGl0ZXJh
dG9yIF9fcG9zaXRpb24pCiAgICAgIHsgcmV0dXJuIF9NX3QuZXJhc2UoX19wb3NpdGlvbik7IH0K
IyA5NzkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbWFwLmgiIDMKICAgICAgc2l6
ZV90eXBlCiAgICAgIGVyYXNlKGNvbnN0IGtleV90eXBlJiBfX3gpCiAgICAgIHsgcmV0dXJuIF9N
X3QuZXJhc2UoX194KTsgfQojIDk5OSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9t
YXAuaCIgMwogICAgICBpdGVyYXRvcgogICAgICBlcmFzZShjb25zdF9pdGVyYXRvciBfX2ZpcnN0
LCBjb25zdF9pdGVyYXRvciBfX2xhc3QpCiAgICAgIHsgcmV0dXJuIF9NX3QuZXJhc2UoX19maXJz
dCwgX19sYXN0KTsgfQojIDEwMzEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbWFw
LmgiIDMKICAgICAgdm9pZAogICAgICBzd2FwKG1hcCYgX194KQogICAgICBub2V4Y2VwdChfX2lz
X25vdGhyb3dfc3dhcHBhYmxlPF9Db21wYXJlPjo6dmFsdWUpCiAgICAgIHsgX01fdC5zd2FwKF9f
eC5fTV90KTsgfQoKCgoKCgoKICAgICAgdm9pZAogICAgICBjbGVhcigpIG5vZXhjZXB0CiAgICAg
IHsgX01fdC5jbGVhcigpOyB9CgoKCgoKCiAgICAgIGtleV9jb21wYXJlCiAgICAgIGtleV9jb21w
KCkgY29uc3QKICAgICAgeyByZXR1cm4gX01fdC5rZXlfY29tcCgpOyB9CgoKCgoKICAgICAgdmFs
dWVfY29tcGFyZQogICAgICB2YWx1ZV9jb21wKCkgY29uc3QKICAgICAgeyByZXR1cm4gdmFsdWVf
Y29tcGFyZShfTV90LmtleV9jb21wKCkpOyB9CiMgMTA3OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL3N0bF9tYXAuaCIgMwogICAgICBpdGVyYXRvcgogICAgICBmaW5kKGNvbnN0IGtleV90
eXBlJiBfX3gpCiAgICAgIHsgcmV0dXJuIF9NX3QuZmluZChfX3gpOyB9CiMgMTEwMyAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tYXAuaCIgMwogICAgICBjb25zdF9pdGVyYXRvcgog
ICAgICBmaW5kKGNvbnN0IGtleV90eXBlJiBfX3gpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX3Qu
ZmluZChfX3gpOyB9CiMgMTEyNCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tYXAu
aCIgMwogICAgICBzaXplX3R5cGUKICAgICAgY291bnQoY29uc3Qga2V5X3R5cGUmIF9feCkgY29u
c3QKICAgICAgeyByZXR1cm4gX01fdC5maW5kKF9feCkgPT0gX01fdC5lbmQoKSA/IDAgOiAxOyB9
CiMgMTE0OCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tYXAuaCIgMwogICAgICBp
dGVyYXRvcgogICAgICBsb3dlcl9ib3VuZChjb25zdCBrZXlfdHlwZSYgX194KQogICAgICB7IHJl
dHVybiBfTV90Lmxvd2VyX2JvdW5kKF9feCk7IH0KIyAxMTczICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2JpdHMvc3RsX21hcC5oIiAzCiAgICAgIGNvbnN0X2l0ZXJhdG9yCiAgICAgIGxvd2VyX2Jv
dW5kKGNvbnN0IGtleV90eXBlJiBfX3gpIGNvbnN0CiAgICAgIHsgcmV0dXJuIF9NX3QubG93ZXJf
Ym91bmQoX194KTsgfQojIDExOTMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbWFw
LmgiIDMKICAgICAgaXRlcmF0b3IKICAgICAgdXBwZXJfYm91bmQoY29uc3Qga2V5X3R5cGUmIF9f
eCkKICAgICAgeyByZXR1cm4gX01fdC51cHBlcl9ib3VuZChfX3gpOyB9CiMgMTIxMyAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tYXAuaCIgMwogICAgICBjb25zdF9pdGVyYXRvcgog
ICAgICB1cHBlcl9ib3VuZChjb25zdCBrZXlfdHlwZSYgX194KSBjb25zdAogICAgICB7IHJldHVy
biBfTV90LnVwcGVyX2JvdW5kKF9feCk7IH0KIyAxMjQyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvc3RsX21hcC5oIiAzCiAgICAgIHN0ZDo6cGFpcjxpdGVyYXRvciwgaXRlcmF0b3I+CiAg
ICAgIGVxdWFsX3JhbmdlKGNvbnN0IGtleV90eXBlJiBfX3gpCiAgICAgIHsgcmV0dXJuIF9NX3Qu
ZXF1YWxfcmFuZ2UoX194KTsgfQojIDEyNzEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9z
dGxfbWFwLmgiIDMKICAgICAgc3RkOjpwYWlyPGNvbnN0X2l0ZXJhdG9yLCBjb25zdF9pdGVyYXRv
cj4KICAgICAgZXF1YWxfcmFuZ2UoY29uc3Qga2V5X3R5cGUmIF9feCkgY29uc3QKICAgICAgeyBy
ZXR1cm4gX01fdC5lcXVhbF9yYW5nZShfX3gpOyB9CiMgMTI4NCAiL3Vzci9pbmNsdWRlL2MrKy82
LjAuMC9iaXRzL3N0bF9tYXAuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSzEsIHR5cGVu
YW1lIF9UMSwgdHlwZW5hbWUgX0MxLCB0eXBlbmFtZSBfQTE+CiAgICAgICAgZnJpZW5kIGJvb2wK
ICAgICAgICBvcGVyYXRvcj09KGNvbnN0IG1hcDxfSzEsIF9UMSwgX0MxLCBfQTE+JiwKICAgICBj
b25zdCBtYXA8X0sxLCBfVDEsIF9DMSwgX0ExPiYpOwoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUg
X0sxLCB0eXBlbmFtZSBfVDEsIHR5cGVuYW1lIF9DMSwgdHlwZW5hbWUgX0ExPgogICAgICAgIGZy
aWVuZCBib29sCiAgICAgICAgb3BlcmF0b3I8KGNvbnN0IG1hcDxfSzEsIF9UMSwgX0MxLCBfQTE+
JiwKICAgIGNvbnN0IG1hcDxfSzEsIF9UMSwgX0MxLCBfQTE+Jik7CiAgICB9OwojIDEzMDUgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbWFwLmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfS2V5LCB0eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxsb2M+
CiAgICBpbmxpbmUgYm9vbAogICAgb3BlcmF0b3I9PShjb25zdCBtYXA8X0tleSwgX1RwLCBfQ29t
cGFyZSwgX0FsbG9jPiYgX194LAogICAgICAgICAgICAgICBjb25zdCBtYXA8X0tleSwgX1RwLCBf
Q29tcGFyZSwgX0FsbG9jPiYgX195KQogICAgeyByZXR1cm4gX194Ll9NX3QgPT0gX195Ll9NX3Q7
IH0KIyAxMzIyICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX21hcC5oIiAzCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQ29tcGFyZSwgdHlw
ZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPChjb25zdCBtYXA8X0tl
eSwgX1RwLCBfQ29tcGFyZSwgX0FsbG9jPiYgX194LAogICAgICAgICAgICAgIGNvbnN0IG1hcDxf
S2V5LCBfVHAsIF9Db21wYXJlLCBfQWxsb2M+JiBfX3kpCiAgICB7IHJldHVybiBfX3guX01fdCA8
IF9feS5fTV90OyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVHAsIHR5
cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYm9vbAogICAgb3Bl
cmF0b3IhPShjb25zdCBtYXA8X0tleSwgX1RwLCBfQ29tcGFyZSwgX0FsbG9jPiYgX194LAogICAg
ICAgICAgICAgICBjb25zdCBtYXA8X0tleSwgX1RwLCBfQ29tcGFyZSwgX0FsbG9jPiYgX195KQog
ICAgeyByZXR1cm4gIShfX3ggPT0gX195KTsgfQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0tleSwg
dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5s
aW5lIGJvb2wKICAgIG9wZXJhdG9yPihjb25zdCBtYXA8X0tleSwgX1RwLCBfQ29tcGFyZSwgX0Fs
bG9jPiYgX194LAogICAgICAgICAgICAgIGNvbnN0IG1hcDxfS2V5LCBfVHAsIF9Db21wYXJlLCBf
QWxsb2M+JiBfX3kpCiAgICB7IHJldHVybiBfX3kgPCBfX3g7IH0KCgogIHRlbXBsYXRlPHR5cGVu
YW1lIF9LZXksIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9BbGxv
Yz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcjw9KGNvbnN0IG1hcDxfS2V5LCBfVHAsIF9D
b21wYXJlLCBfQWxsb2M+JiBfX3gsCiAgICAgICAgICAgICAgIGNvbnN0IG1hcDxfS2V5LCBfVHAs
IF9Db21wYXJlLCBfQWxsb2M+JiBfX3kpCiAgICB7IHJldHVybiAhKF9feSA8IF9feCk7IH0KCgog
IHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0NvbXBhcmUs
IHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcj49KGNvbnN0IG1h
cDxfS2V5LCBfVHAsIF9Db21wYXJlLCBfQWxsb2M+JiBfX3gsCiAgICAgICAgICAgICAgIGNvbnN0
IG1hcDxfS2V5LCBfVHAsIF9Db21wYXJlLCBfQWxsb2M+JiBfX3kpCiAgICB7IHJldHVybiAhKF9f
eCA8IF9feSk7IH0KCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9UcCwgdHlw
ZW5hbWUgX0NvbXBhcmUsIHR5cGVuYW1lIF9BbGxvYz4KICAgIGlubGluZSB2b2lkCiAgICBzd2Fw
KG1hcDxfS2V5LCBfVHAsIF9Db21wYXJlLCBfQWxsb2M+JiBfX3gsCiAgbWFwPF9LZXksIF9UcCwg
X0NvbXBhcmUsIF9BbGxvYz4mIF9feSkKICAgIG5vZXhjZXB0KG5vZXhjZXB0KF9feC5zd2FwKF9f
eSkpKQogICAgeyBfX3guc3dhcChfX3kpOyB9CgoKfQojIDYyICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL21hcCIgMiAzCiMgMSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tdWx0aW1h
cC5oIiAxIDMKIyA2NCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tdWx0aW1hcC5o
IiAzCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVs
dCIpKSkKewoKIyA5MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tdWx0aW1hcC5o
IiAzCiAgdGVtcGxhdGUgPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9UcCwKICAgICB0eXBlbmFt
ZSBfQ29tcGFyZSA9IHN0ZDo6bGVzczxfS2V5PiwKICAgICB0eXBlbmFtZSBfQWxsb2MgPSBzdGQ6
OmFsbG9jYXRvcjxzdGQ6OnBhaXI8Y29uc3QgX0tleSwgX1RwPiA+ID4KICAgIGNsYXNzIG11bHRp
bWFwCiAgICB7CiAgICBwdWJsaWM6CiAgICAgIHR5cGVkZWYgX0tleSBrZXlfdHlwZTsKICAgICAg
dHlwZWRlZiBfVHAgbWFwcGVkX3R5cGU7CiAgICAgIHR5cGVkZWYgc3RkOjpwYWlyPGNvbnN0IF9L
ZXksIF9UcD4gdmFsdWVfdHlwZTsKICAgICAgdHlwZWRlZiBfQ29tcGFyZSBrZXlfY29tcGFyZTsK
ICAgICAgdHlwZWRlZiBfQWxsb2MgYWxsb2NhdG9yX3R5cGU7CgogICAgcHJpdmF0ZToKCiAgICAg
IHR5cGVkZWYgdHlwZW5hbWUgX0FsbG9jOjp2YWx1ZV90eXBlIF9BbGxvY192YWx1ZV90eXBlOwog
ICAgIAogICAgIAoKICAgICAKCiAgICBwdWJsaWM6CiAgICAgIGNsYXNzIHZhbHVlX2NvbXBhcmUK
ICAgICAgOiBwdWJsaWMgc3RkOjpiaW5hcnlfZnVuY3Rpb248dmFsdWVfdHlwZSwgdmFsdWVfdHlw
ZSwgYm9vbD4KICAgICAgewogZnJpZW5kIGNsYXNzIG11bHRpbWFwPF9LZXksIF9UcCwgX0NvbXBh
cmUsIF9BbGxvYz47CiAgICAgIHByb3RlY3RlZDoKIF9Db21wYXJlIGNvbXA7CgogdmFsdWVfY29t
cGFyZShfQ29tcGFyZSBfX2MpCiA6IGNvbXAoX19jKSB7IH0KCiAgICAgIHB1YmxpYzoKIGJvb2wg
b3BlcmF0b3IoKShjb25zdCB2YWx1ZV90eXBlJiBfX3gsIGNvbnN0IHZhbHVlX3R5cGUmIF9feSkg
Y29uc3QKIHsgcmV0dXJuIGNvbXAoX194LmZpcnN0LCBfX3kuZmlyc3QpOyB9CiAgICAgIH07Cgog
ICAgcHJpdmF0ZToKCiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX19nbnVfY3h4OjpfX2FsbG9jX3Ry
YWl0czxfQWxsb2M+Ojp0ZW1wbGF0ZQogcmViaW5kPHZhbHVlX3R5cGU+OjpvdGhlciBfUGFpcl9h
bGxvY190eXBlOwoKICAgICAgdHlwZWRlZiBfUmJfdHJlZTxrZXlfdHlwZSwgdmFsdWVfdHlwZSwg
X1NlbGVjdDFzdDx2YWx1ZV90eXBlPiwKICAgICAgICAga2V5X2NvbXBhcmUsIF9QYWlyX2FsbG9j
X3R5cGU+IF9SZXBfdHlwZTsKCiAgICAgIF9SZXBfdHlwZSBfTV90OwoKICAgICAgdHlwZWRlZiBf
X2dudV9jeHg6Ol9fYWxsb2NfdHJhaXRzPF9QYWlyX2FsbG9jX3R5cGU+IF9BbGxvY190cmFpdHM7
CgogICAgcHVibGljOgoKCiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX0FsbG9jX3RyYWl0czo6cG9p
bnRlciBwb2ludGVyOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9BbGxvY190cmFpdHM6OmNvbnN0
X3BvaW50ZXIgY29uc3RfcG9pbnRlcjsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSBfQWxsb2NfdHJh
aXRzOjpyZWZlcmVuY2UgcmVmZXJlbmNlOwogICAgICB0eXBlZGVmIHR5cGVuYW1lIF9BbGxvY190
cmFpdHM6OmNvbnN0X3JlZmVyZW5jZSBjb25zdF9yZWZlcmVuY2U7CiAgICAgIHR5cGVkZWYgdHlw
ZW5hbWUgX1JlcF90eXBlOjppdGVyYXRvciBpdGVyYXRvcjsKICAgICAgdHlwZWRlZiB0eXBlbmFt
ZSBfUmVwX3R5cGU6OmNvbnN0X2l0ZXJhdG9yIGNvbnN0X2l0ZXJhdG9yOwogICAgICB0eXBlZGVm
IHR5cGVuYW1lIF9SZXBfdHlwZTo6c2l6ZV90eXBlIHNpemVfdHlwZTsKICAgICAgdHlwZWRlZiB0
eXBlbmFtZSBfUmVwX3R5cGU6OmRpZmZlcmVuY2VfdHlwZSBkaWZmZXJlbmNlX3R5cGU7CiAgICAg
IHR5cGVkZWYgdHlwZW5hbWUgX1JlcF90eXBlOjpyZXZlcnNlX2l0ZXJhdG9yIHJldmVyc2VfaXRl
cmF0b3I7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUgX1JlcF90eXBlOjpjb25zdF9yZXZlcnNlX2l0
ZXJhdG9yIGNvbnN0X3JldmVyc2VfaXRlcmF0b3I7CgoKCgoKCgogICAgICBtdWx0aW1hcCgpCgog
ICAgICBub2V4Y2VwdChpc19ub3Rocm93X2RlZmF1bHRfY29uc3RydWN0aWJsZTxhbGxvY2F0b3Jf
dHlwZT46OnZhbHVlKQoKICAgICAgOiBfTV90KCkgeyB9CgoKCgoKCiAgICAgIGV4cGxpY2l0CiAg
ICAgIG11bHRpbWFwKGNvbnN0IF9Db21wYXJlJiBfX2NvbXAsCiAgICAgICAgY29uc3QgYWxsb2Nh
dG9yX3R5cGUmIF9fYSA9IGFsbG9jYXRvcl90eXBlKCkpCiAgICAgIDogX01fdChfX2NvbXAsIF9Q
YWlyX2FsbG9jX3R5cGUoX19hKSkgeyB9CiMgMTgzICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2Jp
dHMvc3RsX211bHRpbWFwLmgiIDMKICAgICAgbXVsdGltYXAoY29uc3QgbXVsdGltYXAmIF9feCkK
ICAgICAgOiBfTV90KF9feC5fTV90KSB7IH0KIyAxOTQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfbXVsdGltYXAuaCIgMwogICAgICBtdWx0aW1hcChtdWx0aW1hcCYmIF9feCkKICAg
ICAgbm9leGNlcHQoaXNfbm90aHJvd19jb3B5X2NvbnN0cnVjdGlibGU8X0NvbXBhcmU+Ojp2YWx1
ZSkKICAgICAgOiBfTV90KHN0ZDo6bW92ZShfX3guX01fdCkpIHsgfQojIDIwOCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tdWx0aW1hcC5oIiAzCiAgICAgIG11bHRpbWFwKGluaXRp
YWxpemVyX2xpc3Q8dmFsdWVfdHlwZT4gX19sLAogICAgICAgIGNvbnN0IF9Db21wYXJlJiBfX2Nv
bXAgPSBfQ29tcGFyZSgpLAogICAgICAgIGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EgPSBhbGxv
Y2F0b3JfdHlwZSgpKQogICAgICA6IF9NX3QoX19jb21wLCBfUGFpcl9hbGxvY190eXBlKF9fYSkp
CiAgICAgIHsgX01fdC5fTV9pbnNlcnRfZXF1YWwoX19sLmJlZ2luKCksIF9fbC5lbmQoKSk7IH0K
CgogICAgICBleHBsaWNpdAogICAgICBtdWx0aW1hcChjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19h
KQogICAgICA6IF9NX3QoX0NvbXBhcmUoKSwgX1BhaXJfYWxsb2NfdHlwZShfX2EpKSB7IH0KCgog
ICAgICBtdWx0aW1hcChjb25zdCBtdWx0aW1hcCYgX19tLCBjb25zdCBhbGxvY2F0b3JfdHlwZSYg
X19hKQogICAgICA6IF9NX3QoX19tLl9NX3QsIF9QYWlyX2FsbG9jX3R5cGUoX19hKSkgeyB9CgoK
ICAgICAgbXVsdGltYXAobXVsdGltYXAmJiBfX20sIGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2Ep
CiAgICAgIG5vZXhjZXB0KGlzX25vdGhyb3dfY29weV9jb25zdHJ1Y3RpYmxlPF9Db21wYXJlPjo6
dmFsdWUKICAgICAgICAmJiBfQWxsb2NfdHJhaXRzOjpfU19hbHdheXNfZXF1YWwoKSkKICAgICAg
OiBfTV90KHN0ZDo6bW92ZShfX20uX01fdCksIF9QYWlyX2FsbG9jX3R5cGUoX19hKSkgeyB9CgoK
ICAgICAgbXVsdGltYXAoaW5pdGlhbGl6ZXJfbGlzdDx2YWx1ZV90eXBlPiBfX2wsIGNvbnN0IGFs
bG9jYXRvcl90eXBlJiBfX2EpCiAgICAgIDogX01fdChfQ29tcGFyZSgpLCBfUGFpcl9hbGxvY190
eXBlKF9fYSkpCiAgICAgIHsgX01fdC5fTV9pbnNlcnRfZXF1YWwoX19sLmJlZ2luKCksIF9fbC5l
bmQoKSk7IH0KCgogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSW5wdXRJdGVyYXRvcj4KICAgICAg
ICBtdWx0aW1hcChfSW5wdXRJdGVyYXRvciBfX2ZpcnN0LCBfSW5wdXRJdGVyYXRvciBfX2xhc3Qs
CiAgIGNvbnN0IGFsbG9jYXRvcl90eXBlJiBfX2EpCiA6IF9NX3QoX0NvbXBhcmUoKSwgX1BhaXJf
YWxsb2NfdHlwZShfX2EpKQogICAgICAgIHsgX01fdC5fTV9pbnNlcnRfZXF1YWwoX19maXJzdCwg
X19sYXN0KTsgfQojIDI1MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tdWx0aW1h
cC5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnB1dEl0ZXJhdG9yPgogICAgICAgIG11
bHRpbWFwKF9JbnB1dEl0ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCkKIDog
X01fdCgpCiAgICAgICAgeyBfTV90Ll9NX2luc2VydF9lcXVhbChfX2ZpcnN0LCBfX2xhc3QpOyB9
CiMgMjY3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX211bHRpbWFwLmgiIDMKICAg
ICAgdGVtcGxhdGU8dHlwZW5hbWUgX0lucHV0SXRlcmF0b3I+CiAgICAgICAgbXVsdGltYXAoX0lu
cHV0SXRlcmF0b3IgX19maXJzdCwgX0lucHV0SXRlcmF0b3IgX19sYXN0LAogICBjb25zdCBfQ29t
cGFyZSYgX19jb21wLAogICBjb25zdCBhbGxvY2F0b3JfdHlwZSYgX19hID0gYWxsb2NhdG9yX3R5
cGUoKSkKIDogX01fdChfX2NvbXAsIF9QYWlyX2FsbG9jX3R5cGUoX19hKSkKICAgICAgICB7IF9N
X3QuX01faW5zZXJ0X2VxdWFsKF9fZmlyc3QsIF9fbGFzdCk7IH0KIyAyOTAgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvYml0cy9zdGxfbXVsdGltYXAuaCIgMwogICAgICBtdWx0aW1hcCYKICAgICAg
b3BlcmF0b3I9KGNvbnN0IG11bHRpbWFwJiBfX3gpCiAgICAgIHsKIF9NX3QgPSBfX3guX01fdDsK
IHJldHVybiAqdGhpczsKICAgICAgfQoKCgogICAgICBtdWx0aW1hcCYKICAgICAgb3BlcmF0b3I9
KG11bHRpbWFwJiYpID0gZGVmYXVsdDsKIyAzMTMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0
cy9zdGxfbXVsdGltYXAuaCIgMwogICAgICBtdWx0aW1hcCYKICAgICAgb3BlcmF0b3I9KGluaXRp
YWxpemVyX2xpc3Q8dmFsdWVfdHlwZT4gX19sKQogICAgICB7CiBfTV90Ll9NX2Fzc2lnbl9lcXVh
bChfX2wuYmVnaW4oKSwgX19sLmVuZCgpKTsKIHJldHVybiAqdGhpczsKICAgICAgfQoKCgogICAg
ICBhbGxvY2F0b3JfdHlwZQogICAgICBnZXRfYWxsb2NhdG9yKCkgY29uc3Qgbm9leGNlcHQKICAg
ICAgeyByZXR1cm4gYWxsb2NhdG9yX3R5cGUoX01fdC5nZXRfYWxsb2NhdG9yKCkpOyB9CgoKCgoK
CgogICAgICBpdGVyYXRvcgogICAgICBiZWdpbigpIG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9N
X3QuYmVnaW4oKTsgfQoKCgoKCgogICAgICBjb25zdF9pdGVyYXRvcgogICAgICBiZWdpbigpIGNv
bnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX3QuYmVnaW4oKTsgfQoKCgoKCgogICAgICBp
dGVyYXRvcgogICAgICBlbmQoKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV90LmVuZCgpOyB9
CgoKCgoKCiAgICAgIGNvbnN0X2l0ZXJhdG9yCiAgICAgIGVuZCgpIGNvbnN0IG5vZXhjZXB0CiAg
ICAgIHsgcmV0dXJuIF9NX3QuZW5kKCk7IH0KCgoKCgoKICAgICAgcmV2ZXJzZV9pdGVyYXRvcgog
ICAgICByYmVnaW4oKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV90LnJiZWdpbigpOyB9CgoK
CgoKCiAgICAgIGNvbnN0X3JldmVyc2VfaXRlcmF0b3IKICAgICAgcmJlZ2luKCkgY29uc3Qgbm9l
eGNlcHQKICAgICAgeyByZXR1cm4gX01fdC5yYmVnaW4oKTsgfQoKCgoKCgogICAgICByZXZlcnNl
X2l0ZXJhdG9yCiAgICAgIHJlbmQoKSBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV90LnJlbmQo
KTsgfQoKCgoKCgogICAgICBjb25zdF9yZXZlcnNlX2l0ZXJhdG9yCiAgICAgIHJlbmQoKSBjb25z
dCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV90LnJlbmQoKTsgfQoKCgoKCgoKICAgICAgY29u
c3RfaXRlcmF0b3IKICAgICAgY2JlZ2luKCkgY29uc3Qgbm9leGNlcHQKICAgICAgeyByZXR1cm4g
X01fdC5iZWdpbigpOyB9CgoKCgoKCiAgICAgIGNvbnN0X2l0ZXJhdG9yCiAgICAgIGNlbmQoKSBj
b25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV90LmVuZCgpOyB9CgoKCgoKCiAgICAgIGNv
bnN0X3JldmVyc2VfaXRlcmF0b3IKICAgICAgY3JiZWdpbigpIGNvbnN0IG5vZXhjZXB0CiAgICAg
IHsgcmV0dXJuIF9NX3QucmJlZ2luKCk7IH0KCgoKCgoKICAgICAgY29uc3RfcmV2ZXJzZV9pdGVy
YXRvcgogICAgICBjcmVuZCgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX3QucmVu
ZCgpOyB9CgoKCgogICAgICBib29sCiAgICAgIGVtcHR5KCkgY29uc3Qgbm9leGNlcHQKICAgICAg
eyByZXR1cm4gX01fdC5lbXB0eSgpOyB9CgoKICAgICAgc2l6ZV90eXBlCiAgICAgIHNpemUoKSBj
b25zdCBub2V4Y2VwdAogICAgICB7IHJldHVybiBfTV90LnNpemUoKTsgfQoKCiAgICAgIHNpemVf
dHlwZQogICAgICBtYXhfc2l6ZSgpIGNvbnN0IG5vZXhjZXB0CiAgICAgIHsgcmV0dXJuIF9NX3Qu
bWF4X3NpemUoKTsgfQojIDQ3MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tdWx0
aW1hcC5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4uIF9BcmdzPgogaXRlcmF0b3IKIGVt
cGxhY2UoX0FyZ3MmJi4uLiBfX2FyZ3MpCiB7IHJldHVybiBfTV90Ll9NX2VtcGxhY2VfZXF1YWwo
c3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsgfQojIDQ5OCAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL3N0bF9tdWx0aW1hcC5oIiAzCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lLi4u
IF9BcmdzPgogaXRlcmF0b3IKIGVtcGxhY2VfaGludChjb25zdF9pdGVyYXRvciBfX3BvcywgX0Fy
Z3MmJi4uLiBfX2FyZ3MpCiB7CiAgIHJldHVybiBfTV90Ll9NX2VtcGxhY2VfaGludF9lcXVhbChf
X3BvcywKICAgICAgICAgc3RkOjpmb3J3YXJkPF9BcmdzPihfX2FyZ3MpLi4uKTsKIH0KIyA1MTkg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbXVsdGltYXAuaCIgMwogICAgICBpdGVy
YXRvcgogICAgICBpbnNlcnQoY29uc3QgdmFsdWVfdHlwZSYgX194KQogICAgICB7IHJldHVybiBf
TV90Ll9NX2luc2VydF9lcXVhbChfX3gpOyB9CgoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1Bh
aXIsIHR5cGVuYW1lID0gdHlwZW5hbWUKICAgICAgICBzdGQ6OmVuYWJsZV9pZjxzdGQ6OmlzX2Nv
bnN0cnVjdGlibGU8dmFsdWVfdHlwZSwKICAgICAgICAgIF9QYWlyJiY+Ojp2YWx1ZT46OnR5cGU+
CiAgICAgICAgaXRlcmF0b3IKICAgICAgICBpbnNlcnQoX1BhaXImJiBfX3gpCiAgICAgICAgeyBy
ZXR1cm4gX01fdC5fTV9pbnNlcnRfZXF1YWwoc3RkOjpmb3J3YXJkPF9QYWlyPihfX3gpKTsgfQoj
IDU1MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tdWx0aW1hcC5oIiAzCiAgICAg
IGl0ZXJhdG9yCgogICAgICBpbnNlcnQoY29uc3RfaXRlcmF0b3IgX19wb3NpdGlvbiwgY29uc3Qg
dmFsdWVfdHlwZSYgX194KQoKCgogICAgICB7IHJldHVybiBfTV90Ll9NX2luc2VydF9lcXVhbF8o
X19wb3NpdGlvbiwgX194KTsgfQoKCiAgICAgIHRlbXBsYXRlPHR5cGVuYW1lIF9QYWlyLCB0eXBl
bmFtZSA9IHR5cGVuYW1lCiAgICAgICAgc3RkOjplbmFibGVfaWY8c3RkOjppc19jb25zdHJ1Y3Rp
YmxlPHZhbHVlX3R5cGUsCiAgICAgICAgICBfUGFpciYmPjo6dmFsdWU+Ojp0eXBlPgogICAgICAg
IGl0ZXJhdG9yCiAgICAgICAgaW5zZXJ0KGNvbnN0X2l0ZXJhdG9yIF9fcG9zaXRpb24sIF9QYWly
JiYgX194KQogICAgICAgIHsgcmV0dXJuIF9NX3QuX01faW5zZXJ0X2VxdWFsXyhfX3Bvc2l0aW9u
LAogICAgICAgICAgIHN0ZDo6Zm9yd2FyZDxfUGFpcj4oX194KSk7IH0KIyA1NzkgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbXVsdGltYXAuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBl
bmFtZSBfSW5wdXRJdGVyYXRvcj4KICAgICAgICB2b2lkCiAgICAgICAgaW5zZXJ0KF9JbnB1dEl0
ZXJhdG9yIF9fZmlyc3QsIF9JbnB1dEl0ZXJhdG9yIF9fbGFzdCkKICAgICAgICB7IF9NX3QuX01f
aW5zZXJ0X2VxdWFsKF9fZmlyc3QsIF9fbGFzdCk7IH0KIyA1OTIgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvYml0cy9zdGxfbXVsdGltYXAuaCIgMwogICAgICB2b2lkCiAgICAgIGluc2VydChpbml0
aWFsaXplcl9saXN0PHZhbHVlX3R5cGU+IF9fbCkKICAgICAgeyB0aGlzLT5pbnNlcnQoX19sLmJl
Z2luKCksIF9fbC5lbmQoKSk7IH0KIyA2MTMgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9z
dGxfbXVsdGltYXAuaCIgMwogICAgICBpdGVyYXRvcgogICAgICBlcmFzZShjb25zdF9pdGVyYXRv
ciBfX3Bvc2l0aW9uKQogICAgICB7IHJldHVybiBfTV90LmVyYXNlKF9fcG9zaXRpb24pOyB9CgoK
ICAgICAgX19hdHRyaWJ1dGUgKChfX2FiaV90YWdfXyAoImN4eDExIikpKQogICAgICBpdGVyYXRv
cgogICAgICBlcmFzZShpdGVyYXRvciBfX3Bvc2l0aW9uKQogICAgICB7IHJldHVybiBfTV90LmVy
YXNlKF9fcG9zaXRpb24pOyB9CiMgNjQ5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvc3Rs
X211bHRpbWFwLmgiIDMKICAgICAgc2l6ZV90eXBlCiAgICAgIGVyYXNlKGNvbnN0IGtleV90eXBl
JiBfX3gpCiAgICAgIHsgcmV0dXJuIF9NX3QuZXJhc2UoX194KTsgfQojIDY3MCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tdWx0aW1hcC5oIiAzCiAgICAgIGl0ZXJhdG9yCiAgICAg
IGVyYXNlKGNvbnN0X2l0ZXJhdG9yIF9fZmlyc3QsIGNvbnN0X2l0ZXJhdG9yIF9fbGFzdCkKICAg
ICAgeyByZXR1cm4gX01fdC5lcmFzZShfX2ZpcnN0LCBfX2xhc3QpOyB9CiMgNzA1ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2JpdHMvc3RsX211bHRpbWFwLmgiIDMKICAgICAgdm9pZAogICAgICBz
d2FwKG11bHRpbWFwJiBfX3gpCiAgICAgIG5vZXhjZXB0KF9faXNfbm90aHJvd19zd2FwcGFibGU8
X0NvbXBhcmU+Ojp2YWx1ZSkKICAgICAgeyBfTV90LnN3YXAoX194Ll9NX3QpOyB9CgoKCgoKCgog
ICAgICB2b2lkCiAgICAgIGNsZWFyKCkgbm9leGNlcHQKICAgICAgeyBfTV90LmNsZWFyKCk7IH0K
CgoKCgoKICAgICAga2V5X2NvbXBhcmUKICAgICAga2V5X2NvbXAoKSBjb25zdAogICAgICB7IHJl
dHVybiBfTV90LmtleV9jb21wKCk7IH0KCgoKCgogICAgICB2YWx1ZV9jb21wYXJlCiAgICAgIHZh
bHVlX2NvbXAoKSBjb25zdAogICAgICB7IHJldHVybiB2YWx1ZV9jb21wYXJlKF9NX3Qua2V5X2Nv
bXAoKSk7IH0KIyA3NTEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbXVsdGltYXAu
aCIgMwogICAgICBpdGVyYXRvcgogICAgICBmaW5kKGNvbnN0IGtleV90eXBlJiBfX3gpCiAgICAg
IHsgcmV0dXJuIF9NX3QuZmluZChfX3gpOyB9CiMgNzc1ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2JpdHMvc3RsX211bHRpbWFwLmgiIDMKICAgICAgY29uc3RfaXRlcmF0b3IKICAgICAgZmluZChj
b25zdCBrZXlfdHlwZSYgX194KSBjb25zdAogICAgICB7IHJldHVybiBfTV90LmZpbmQoX194KTsg
fQojIDc5MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tdWx0aW1hcC5oIiAzCiAg
ICAgIHNpemVfdHlwZQogICAgICBjb3VudChjb25zdCBrZXlfdHlwZSYgX194KSBjb25zdAogICAg
ICB7IHJldHVybiBfTV90LmNvdW50KF9feCk7IH0KIyA4MTcgIi91c3IvaW5jbHVkZS9jKysvNi4w
LjAvYml0cy9zdGxfbXVsdGltYXAuaCIgMwogICAgICBpdGVyYXRvcgogICAgICBsb3dlcl9ib3Vu
ZChjb25zdCBrZXlfdHlwZSYgX194KQogICAgICB7IHJldHVybiBfTV90Lmxvd2VyX2JvdW5kKF9f
eCk7IH0KIyA4NDIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbXVsdGltYXAuaCIg
MwogICAgICBjb25zdF9pdGVyYXRvcgogICAgICBsb3dlcl9ib3VuZChjb25zdCBrZXlfdHlwZSYg
X194KSBjb25zdAogICAgICB7IHJldHVybiBfTV90Lmxvd2VyX2JvdW5kKF9feCk7IH0KIyA4NjIg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbXVsdGltYXAuaCIgMwogICAgICBpdGVy
YXRvcgogICAgICB1cHBlcl9ib3VuZChjb25zdCBrZXlfdHlwZSYgX194KQogICAgICB7IHJldHVy
biBfTV90LnVwcGVyX2JvdW5kKF9feCk7IH0KIyA4ODIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfbXVsdGltYXAuaCIgMwogICAgICBjb25zdF9pdGVyYXRvcgogICAgICB1cHBlcl9i
b3VuZChjb25zdCBrZXlfdHlwZSYgX194KSBjb25zdAogICAgICB7IHJldHVybiBfTV90LnVwcGVy
X2JvdW5kKF9feCk7IH0KIyA5MDkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbXVs
dGltYXAuaCIgMwogICAgICBzdGQ6OnBhaXI8aXRlcmF0b3IsIGl0ZXJhdG9yPgogICAgICBlcXVh
bF9yYW5nZShjb25zdCBrZXlfdHlwZSYgX194KQogICAgICB7IHJldHVybiBfTV90LmVxdWFsX3Jh
bmdlKF9feCk7IH0KIyA5MzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9zdGxfbXVsdGlt
YXAuaCIgMwogICAgICBzdGQ6OnBhaXI8Y29uc3RfaXRlcmF0b3IsIGNvbnN0X2l0ZXJhdG9yPgog
ICAgICBlcXVhbF9yYW5nZShjb25zdCBrZXlfdHlwZSYgX194KSBjb25zdAogICAgICB7IHJldHVy
biBfTV90LmVxdWFsX3JhbmdlKF9feCk7IH0KIyA5NDkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAv
Yml0cy9zdGxfbXVsdGltYXAuaCIgMwogICAgICB0ZW1wbGF0ZTx0eXBlbmFtZSBfSzEsIHR5cGVu
YW1lIF9UMSwgdHlwZW5hbWUgX0MxLCB0eXBlbmFtZSBfQTE+CiAgICAgICAgZnJpZW5kIGJvb2wK
ICAgICAgICBvcGVyYXRvcj09KGNvbnN0IG11bHRpbWFwPF9LMSwgX1QxLCBfQzEsIF9BMT4mLAog
ICAgIGNvbnN0IG11bHRpbWFwPF9LMSwgX1QxLCBfQzEsIF9BMT4mKTsKCiAgICAgIHRlbXBsYXRl
PHR5cGVuYW1lIF9LMSwgdHlwZW5hbWUgX1QxLCB0eXBlbmFtZSBfQzEsIHR5cGVuYW1lIF9BMT4K
ICAgICAgICBmcmllbmQgYm9vbAogICAgICAgIG9wZXJhdG9yPChjb25zdCBtdWx0aW1hcDxfSzEs
IF9UMSwgX0MxLCBfQTE+JiwKICAgIGNvbnN0IG11bHRpbWFwPF9LMSwgX1QxLCBfQzEsIF9BMT4m
KTsKICB9OwojIDk3MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL3N0bF9tdWx0aW1hcC5o
IiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQ29t
cGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yPT0oY29u
c3QgbXVsdGltYXA8X0tleSwgX1RwLCBfQ29tcGFyZSwgX0FsbG9jPiYgX194LAogICAgICAgICAg
ICAgICBjb25zdCBtdWx0aW1hcDxfS2V5LCBfVHAsIF9Db21wYXJlLCBfQWxsb2M+JiBfX3kpCiAg
ICB7IHJldHVybiBfX3guX01fdCA9PSBfX3kuX01fdDsgfQojIDk4NyAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL3N0bF9tdWx0aW1hcC5oIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0tleSwg
dHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5s
aW5lIGJvb2wKICAgIG9wZXJhdG9yPChjb25zdCBtdWx0aW1hcDxfS2V5LCBfVHAsIF9Db21wYXJl
LCBfQWxsb2M+JiBfX3gsCiAgICAgICAgICAgICAgY29uc3QgbXVsdGltYXA8X0tleSwgX1RwLCBf
Q29tcGFyZSwgX0FsbG9jPiYgX195KQogICAgeyByZXR1cm4gX194Ll9NX3QgPCBfX3kuX01fdDsg
fQoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0tleSwgdHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQ29t
cGFyZSwgdHlwZW5hbWUgX0FsbG9jPgogICAgaW5saW5lIGJvb2wKICAgIG9wZXJhdG9yIT0oY29u
c3QgbXVsdGltYXA8X0tleSwgX1RwLCBfQ29tcGFyZSwgX0FsbG9jPiYgX194LAogICAgICAgICAg
ICAgICBjb25zdCBtdWx0aW1hcDxfS2V5LCBfVHAsIF9Db21wYXJlLCBfQWxsb2M+JiBfX3kpCiAg
ICB7IHJldHVybiAhKF9feCA9PSBfX3kpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0
eXBlbmFtZSBfVHAsIHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxp
bmUgYm9vbAogICAgb3BlcmF0b3I+KGNvbnN0IG11bHRpbWFwPF9LZXksIF9UcCwgX0NvbXBhcmUs
IF9BbGxvYz4mIF9feCwKICAgICAgICAgICAgICBjb25zdCBtdWx0aW1hcDxfS2V5LCBfVHAsIF9D
b21wYXJlLCBfQWxsb2M+JiBfX3kpCiAgICB7IHJldHVybiBfX3kgPCBfX3g7IH0KCgogIHRlbXBs
YXRlPHR5cGVuYW1lIF9LZXksIHR5cGVuYW1lIF9UcCwgdHlwZW5hbWUgX0NvbXBhcmUsIHR5cGVu
YW1lIF9BbGxvYz4KICAgIGlubGluZSBib29sCiAgICBvcGVyYXRvcjw9KGNvbnN0IG11bHRpbWFw
PF9LZXksIF9UcCwgX0NvbXBhcmUsIF9BbGxvYz4mIF9feCwKICAgICAgICAgICAgICAgY29uc3Qg
bXVsdGltYXA8X0tleSwgX1RwLCBfQ29tcGFyZSwgX0FsbG9jPiYgX195KQogICAgeyByZXR1cm4g
IShfX3kgPCBfX3gpOyB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfS2V5LCB0eXBlbmFtZSBfVHAs
IHR5cGVuYW1lIF9Db21wYXJlLCB0eXBlbmFtZSBfQWxsb2M+CiAgICBpbmxpbmUgYm9vbAogICAg
b3BlcmF0b3I+PShjb25zdCBtdWx0aW1hcDxfS2V5LCBfVHAsIF9Db21wYXJlLCBfQWxsb2M+JiBf
X3gsCiAgICAgICAgICAgICAgIGNvbnN0IG11bHRpbWFwPF9LZXksIF9UcCwgX0NvbXBhcmUsIF9B
bGxvYz4mIF9feSkKICAgIHsgcmV0dXJuICEoX194IDwgX195KTsgfQoKCiAgdGVtcGxhdGU8dHlw
ZW5hbWUgX0tleSwgdHlwZW5hbWUgX1RwLCB0eXBlbmFtZSBfQ29tcGFyZSwgdHlwZW5hbWUgX0Fs
bG9jPgogICAgaW5saW5lIHZvaWQKICAgIHN3YXAobXVsdGltYXA8X0tleSwgX1RwLCBfQ29tcGFy
ZSwgX0FsbG9jPiYgX194LAogICAgICAgICBtdWx0aW1hcDxfS2V5LCBfVHAsIF9Db21wYXJlLCBf
QWxsb2M+JiBfX3kpCiAgICBub2V4Y2VwdChub2V4Y2VwdChfX3guc3dhcChfX3kpKSkKICAgIHsg
X194LnN3YXAoX195KTsgfQoKCn0KIyA2MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9tYXAiIDIg
MwojIDMyICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9z
cmMvWURpYWxvZy5oIiAyCgoKIyAzMyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1
aS1tYXN0ZXItMy4yLjEvc3JjL1lEaWFsb2cuaCIKY2xhc3MgWVNob3J0Y3V0TWFuYWdlcjsKY2xh
c3MgWVB1c2hCdXR0b247CmNsYXNzIFlEaWFsb2dQcml2YXRlOwpjbGFzcyBZRXZlbnQ7CmNsYXNz
IFlFdmVudEZpbHRlcjsKCgoKCmNsYXNzIFlEaWFsb2cgOiBwdWJsaWMgWVNpbmdsZUNoaWxkQ29u
dGFpbmVyV2lkZ2V0CnsKcHJvdGVjdGVkOgojIDU0ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5
dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5oIgogICAgWURpYWxvZyggWURpYWxv
Z1R5cGUgZGlhbG9nVHlwZSwKICAgICAgWURpYWxvZ0NvbG9yTW9kZSBjb2xvck1vZGUgPSBZRGlh
bG9nTm9ybWFsQ29sb3IgKTsKCgoKCgoKICAgIHZpcnR1YWwgfllEaWFsb2coKTsKCnB1YmxpYzoK
CgoKCiAgICB2aXJ0dWFsIGNvbnN0IGNoYXIgKiB3aWRnZXRDbGFzcygpIGNvbnN0IHsgcmV0dXJu
ICJZRGlhbG9nIjsgfQojIDg0ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1h
c3Rlci0zLjIuMS9zcmMvWURpYWxvZy5oIgogICAgdm9pZCBvcGVuKCk7CgoKCgogICAgYm9vbCBp
c09wZW4oKSBjb25zdDsKIyAxMTcgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWkt
bWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmgiCiAgICBZRXZlbnQgKiB3YWl0Rm9yRXZlbnQoIGlu
dCB0aW1lb3V0X21pbGxpc2VjID0gMCApOwojIDEzMyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGli
eXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lEaWFsb2cuaCIKICAgIFlFdmVudCAqIHBvbGxF
dmVudCgpOwoKCgoKICAgIGJvb2wgaXNUb3Btb3N0RGlhbG9nKCkgY29uc3Q7CiMgMTUzICIvaG9t
ZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5o
IgogICAgYm9vbCBkZXN0cm95KCBib29sIGRvVGhyb3cgPSB0cnVlICk7CiMgMTY2ICIvaG9tZS9z
aGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5oIgog
ICAgc3RhdGljIGJvb2wgZGVsZXRlVG9wbW9zdERpYWxvZyggYm9vbCBkb1Rocm93ID0gdHJ1ZSAp
OwoKCgoKICAgIHN0YXRpYyB2b2lkIGRlbGV0ZUFsbERpYWxvZ3MoKTsKCgoKCiAgICBzdGF0aWMg
dm9pZCBkZWxldGVUbyggWURpYWxvZyAqIGRpYWxvZyApOwoKCgoKCiAgICBzdGF0aWMgaW50IG9w
ZW5EaWFsb2dzQ291bnQoKTsKCgoKCgoKCiAgICBzdGF0aWMgWURpYWxvZyAqIGN1cnJlbnREaWFs
b2coIGJvb2wgZG9UaHJvdyA9IHRydWUgKTsKCgoKCiAgICBzdGF0aWMgWURpYWxvZyAqIHRvcG1v
c3REaWFsb2coIGJvb2wgZG9UaHJvdyA9IHRydWUgKQogeyByZXR1cm4gY3VycmVudERpYWxvZygg
ZG9UaHJvdyApOyB9CgoKCgoKCiAgICB2b2lkIHNldEluaXRpYWxTaXplKCk7CiMgMjE3ICIvaG9t
ZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5o
IgogICAgdm9pZCByZWNhbGNMYXlvdXQoKTsKCgoKCiAgICBZRGlhbG9nVHlwZSBkaWFsb2dUeXBl
KCkgY29uc3Q7CgoKCgoKICAgIGJvb2wgaXNNYWluRGlhbG9nKCk7CgoKCgogICAgWURpYWxvZ0Nv
bG9yTW9kZSBjb2xvck1vZGUoKSBjb25zdDsKCgoKCgoKCiAgICB2b2lkIGNoZWNrU2hvcnRjdXRz
KCBib29sIGZvcmNlID0gZmFsc2UgKTsKCgoKCgoKICAgIHZvaWQgcG9zdHBvbmVTaG9ydGN1dENo
ZWNrKCk7CgoKCgogICAgYm9vbCBzaG9ydGN1dENoZWNrUG9zdHBvbmVkKCkgY29uc3Q7CiMgMjYy
ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURp
YWxvZy5oIgogICAgWVB1c2hCdXR0b24gKiBkZWZhdWx0QnV0dG9uKCkgY29uc3Q7CgoKCgogICAg
dm9pZCBkZWxldGVFdmVudCggWUV2ZW50ICogZXZlbnQgKTsKIyAyODYgIi9ob21lL3NoYXJrY3ov
bGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmgiCiAgICB2b2lk
IGFkZEV2ZW50RmlsdGVyKCBZRXZlbnRGaWx0ZXIgKiBldmVudEZpbHRlciApOwoKCgoKCgoKICAg
IHZvaWQgcmVtb3ZlRXZlbnRGaWx0ZXIoIFlFdmVudEZpbHRlciAqIGV2ZW50RmlsdGVyICk7CiMg
MzA3ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMv
WURpYWxvZy5oIgogICAgdmlydHVhbCB2b2lkIGhpZ2hsaWdodCggWVdpZGdldCAqIGNoaWxkICkg
e30KIyAzMTkgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4x
L3NyYy9ZRGlhbG9nLmgiCiAgICB2aXJ0dWFsIHZvaWQgc2V0RGVmYXVsdEJ1dHRvbiggWVB1c2hC
dXR0b24gKiBkZWZhdWx0QnV0dG9uICk7CgoKCgoKCgogICAgdmlydHVhbCB2b2lkIGFjdGl2YXRl
KCkgPSAwOwoKCgoKCgogICAgc3RhdGljIHZvaWQgc2hvd1RleHQoIGNvbnN0IHN0ZDo6c3RyaW5n
ICYgdGV4dCwgYm9vbCByaWNoVGV4dCA9IGZhbHNlICk7CiMgMzQ2ICIvaG9tZS9zaGFya2N6L2xp
Ynl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5oIgogICAgc3RhdGlj
IGJvb2wgc2hvd0hlbHBUZXh0KCBZV2lkZ2V0ICogd2lkZ2V0ICk7CiMgMzU3ICIvaG9tZS9zaGFy
a2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5oIgogICAg
c3RhdGljIGJvb2wgc2hvd1JlbE5vdGVzVGV4dCgpOwoKCnByb3RlY3RlZDoKIyAzNjkgIi9ob21l
L3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmgi
CiAgICB2aXJ0dWFsIHZvaWQgb3BlbkludGVybmFsKCkgPSAwOwoKCgoKCgogICAgdmlydHVhbCBZ
RXZlbnQgKiB3YWl0Rm9yRXZlbnRJbnRlcm5hbCggaW50IHRpbWVvdXRfbWlsbGlzZWMgKSA9IDA7
CgoKCgoKCgogICAgdmlydHVhbCBZRXZlbnQgKiBwb2xsRXZlbnRJbnRlcm5hbCgpID0gMDsKCgoK
CgogICAgWUV2ZW50ICogZmlsdGVySW52YWxpZEV2ZW50cyggWUV2ZW50ICogZXZlbnQgKTsKCgoK
CiAgICBZRXZlbnQgKiBjYWxsRXZlbnRGaWx0ZXJzKCBZRXZlbnQgKiBldmVudCApOwoKCgoKICAg
IHZvaWQgZGVsZXRlRXZlbnRGaWx0ZXJzKCk7CgoKCgogICAgc3RhdGljIHN0ZDo6c3RhY2s8WURp
YWxvZyAqPiBfZGlhbG9nU3RhY2s7Cgpwcml2YXRlOgoKICAgIEltcGxQdHI8WURpYWxvZ1ByaXZh
dGU+IHByaXY7Cn07CiMgMzMgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFz
dGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIiAyCiMgMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGli
eXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lFdmVudC5oIiAxCiMgMzIgIi9ob21lL3NoYXJr
Y3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRXZlbnQuaCIKIyAxICIv
aG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVNpbXBs
ZUV2ZW50SGFuZGxlci5oIiAxCiMgMjkgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5
dWktbWFzdGVyLTMuMi4xL3NyYy9ZU2ltcGxlRXZlbnRIYW5kbGVyLmgiCmNsYXNzIFlFdmVudDsK
Y2xhc3MgWVdpZGdldDsKIyAzOSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1t
YXN0ZXItMy4yLjEvc3JjL1lTaW1wbGVFdmVudEhhbmRsZXIuaCIKY2xhc3MgWVNpbXBsZUV2ZW50
SGFuZGxlcgp7CnB1YmxpYzoKCgoKCiAgICBZU2ltcGxlRXZlbnRIYW5kbGVyKCk7CgoKCgoKCiAg
ICB2aXJ0dWFsIH5ZU2ltcGxlRXZlbnRIYW5kbGVyKCk7CiMgNjggIi9ob21lL3NoYXJrY3ovbGli
eXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZU2ltcGxlRXZlbnRIYW5kbGVyLmgi
CiAgICB2b2lkIHNlbmRFdmVudCggWUV2ZW50ICogZXZlbnRfZGlzb3duICk7CgoKCgogICAgYm9v
bCBldmVudFBlbmRpbmdGb3IoIFlXaWRnZXQgKiB3aWRnZXQgKSBjb25zdDsKCgoKCgoKICAgIFlF
dmVudCAqIHBlbmRpbmdFdmVudCgpIGNvbnN0IHsgcmV0dXJuIF9wZW5kaW5nRXZlbnQ7IH0KIyA5
MiAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lT
aW1wbGVFdmVudEhhbmRsZXIuaCIKICAgIFlFdmVudCAqIGNvbnN1bWVQZW5kaW5nRXZlbnQoKTsK
CgoKCgogICAgdm9pZCBkZWxldGVQZW5kaW5nRXZlbnRzRm9yKCBZV2lkZ2V0ICogd2lkZ2V0ICk7
CgoKCgogICAgdm9pZCBjbGVhcigpOwoKCgoKCgogICAgdm9pZCBibG9ja0V2ZW50cyggYm9vbCBi
bG9jayA9IHRydWUgKTsKCgoKCgogICAgdm9pZCB1bmJsb2NrRXZlbnRzKCkgeyBibG9ja0V2ZW50
cyggZmFsc2UgKTsgfQoKCgoKICAgIGJvb2wgZXZlbnRzQmxvY2tlZCgpIGNvbnN0IHsgcmV0dXJu
IF9ldmVudHNCbG9ja2VkOyB9CgoKCgoKICAgIHZvaWQgZGVsZXRlRXZlbnQoIFlFdmVudCAqIGV2
ZW50ICk7CgoKcHJvdGVjdGVkOgoKCgogICAgWUV2ZW50ICogX3BlbmRpbmdFdmVudDsKICAgIGJv
b2wgX2V2ZW50c0Jsb2NrZWQ7Cn07CiMgMzMgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1s
aWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRXZlbnQuaCIgMgoKY2xhc3MgWVdpZGdldDsKY2xhc3Mg
WUl0ZW07CmNsYXNzIFlEaWFsb2c7CgoKCgoKCmNsYXNzIFlFdmVudAp7CnB1YmxpYzoKCiAgICBl
bnVtIEV2ZW50VHlwZQogICAgewogTm9FdmVudCA9IDAsCiBVbmtub3duRXZlbnQsCiBXaWRnZXRF
dmVudCwKIE1lbnVFdmVudCwKIEtleUV2ZW50LAogQ2FuY2VsRXZlbnQsCiBUaW1lb3V0RXZlbnQs
CiBEZWJ1Z0V2ZW50LAogSW52YWxpZEV2ZW50ID0gMHg0MjQyCiAgICB9OwoKCiAgICBlbnVtIEV2
ZW50UmVhc29uCiAgICB7CiBVbmtub3duUmVhc29uID0gMCwKIEFjdGl2YXRlZCwKIFNlbGVjdGlv
bkNoYW5nZWQsCiBWYWx1ZUNoYW5nZWQsCiBDb250ZXh0TWVudUFjdGl2YXRlZAogICAgfTsKCgoK
CgogICAgWUV2ZW50KCBFdmVudFR5cGUgZXZlbnRUeXBlID0gVW5rbm93bkV2ZW50ICk7CgoKCgog
ICAgRXZlbnRUeXBlIGV2ZW50VHlwZSgpIGNvbnN0IHsgcmV0dXJuIF9ldmVudFR5cGU7IH0KCgoK
CgogICAgdW5zaWduZWQgbG9uZyBzZXJpYWwoKSBjb25zdCB7IHJldHVybiBfc2VyaWFsOyB9CgoK
CgoKCgogICAgdmlydHVhbCBZV2lkZ2V0ICogd2lkZ2V0KCkgY29uc3QgeyByZXR1cm4gMDsgfQoK
CgoKCgoKICAgIHZpcnR1YWwgWUl0ZW0gKiBpdGVtKCkgY29uc3QgeyByZXR1cm4gMDsgfQoKCgoK
ICAgIFlEaWFsb2cgKiBkaWFsb2coKSBjb25zdCB7IHJldHVybiBfZGlhbG9nOyB9CgoKCgogICAg
Ym9vbCBpc1ZhbGlkKCkgY29uc3Q7CgoKCgogICAgc3RhdGljIGNvbnN0IGNoYXIgKiB0b1N0cmlu
ZyggRXZlbnRUeXBlIGV2ZW50VHlwZSApOwoKCgoKICAgIHN0YXRpYyBjb25zdCBjaGFyICogdG9T
dHJpbmcoIEV2ZW50UmVhc29uIHJlYXNvbiApOwoKCnByb3RlY3RlZDoKCgoKCiAgICB2b2lkIHNl
dERpYWxvZyggWURpYWxvZyAqIGRpYSApIHsgX2RpYWxvZyA9IGRpYTsgfQojIDEzOSAiL2hvbWUv
c2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lFdmVudC5oIgog
ICAgdmlydHVhbCB+WUV2ZW50KCk7CgoKCgogICAgdm9pZCBpbnZhbGlkYXRlKCk7Cgpwcml2YXRl
OgoKICAgIGZyaWVuZCB2b2lkIFlEaWFsb2c6OmRlbGV0ZUV2ZW50KCBZRXZlbnQgKiBldmVudCAp
OwogICAgZnJpZW5kIHZvaWQgWVNpbXBsZUV2ZW50SGFuZGxlcjo6ZGVsZXRlRXZlbnQoIFlFdmVu
dCAqIGV2ZW50ICk7CgoKCgoKCiAgICBFdmVudFR5cGUgX2V2ZW50VHlwZTsKICAgIHVuc2lnbmVk
IGxvbmcgX3NlcmlhbDsKICAgIFlEaWFsb2cgKiBfZGlhbG9nOwoKICAgIHN0YXRpYyB1bnNpZ25l
ZCBsb25nIF9uZXh0U2VyaWFsOwp9OwoKCgpjbGFzcyBZV2lkZ2V0RXZlbnQ6IHB1YmxpYyBZRXZl
bnQKewpwdWJsaWM6CgoKCgogICAgWVdpZGdldEV2ZW50KCBZV2lkZ2V0ICogd2lkZ2V0ID0gMCwK
ICAgIEV2ZW50UmVhc29uIHJlYXNvbiA9IEFjdGl2YXRlZCwKICAgIEV2ZW50VHlwZSBldmVudFR5
cGUgPSBXaWRnZXRFdmVudCApOwoKCgoKCiAgICB2aXJ0dWFsIFlXaWRnZXQgKiB3aWRnZXQoKSBj
b25zdCB7IHJldHVybiBfd2lkZ2V0OyB9CgoKCgogICAgRXZlbnRSZWFzb24gcmVhc29uKCkgY29u
c3QgeyByZXR1cm4gX3JlYXNvbjsgfQoKcHJvdGVjdGVkOgoKCgoKCgogICAgdmlydHVhbCB+WVdp
ZGdldEV2ZW50KCkge30KCgoKCgoKICAgIFlXaWRnZXQgKiBfd2lkZ2V0OwogICAgRXZlbnRSZWFz
b24gX3JlYXNvbjsKfTsKCgpjbGFzcyBZS2V5RXZlbnQ6IHB1YmxpYyBZRXZlbnQKewpwdWJsaWM6
CiMgMjE3ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9z
cmMvWUV2ZW50LmgiCiAgICBZS2V5RXZlbnQoIGNvbnN0IHN0ZDo6c3RyaW5nICYga2V5U3ltYm9s
LAogICAgICAgIFlXaWRnZXQgKiBmb2N1c1dpZGdldCA9IDAgKTsKCgoKCgogICAgc3RkOjpzdHJp
bmcga2V5U3ltYm9sKCkgY29uc3QgeyByZXR1cm4gX2tleVN5bWJvbDsgfQoKCgoKCgoKICAgIFlX
aWRnZXQgKiBmb2N1c1dpZGdldCgpIGNvbnN0IHsgcmV0dXJuIF9mb2N1c1dpZGdldDsgfQoKcHJv
dGVjdGVkOgoKCgoKCgogICAgdmlydHVhbCB+WUtleUV2ZW50KCkge30KCgoKCgoKICAgIHN0ZDo6
c3RyaW5nIF9rZXlTeW1ib2w7CiAgICBZV2lkZ2V0ICogX2ZvY3VzV2lkZ2V0Owp9OwoKCgoKCmNs
YXNzIFlNZW51RXZlbnQ6IHB1YmxpYyBZRXZlbnQKewpwdWJsaWM6CgogICAgWU1lbnVFdmVudCgg
WUl0ZW0gKiBpdGVtICkKIDogWUV2ZW50KCBNZW51RXZlbnQgKQogLCBfaXRlbSggaXRlbSApCiB7
fQoKICAgIFlNZW51RXZlbnQoIGNvbnN0IGNoYXIgKiBpZCApIDogWUV2ZW50KCBNZW51RXZlbnQg
KSwgX2l0ZW0oMCksIF9pZCggaWQgKSB7fQogICAgWU1lbnVFdmVudCggY29uc3Qgc3RkOjpzdHJp
bmcgJiBpZCApIDogWUV2ZW50KCBNZW51RXZlbnQgKSwgX2l0ZW0oMCksIF9pZCggaWQgKSB7fQoK
CgoKCgoKICAgIHZpcnR1YWwgWUl0ZW0gKiBpdGVtKCkgY29uc3QgeyByZXR1cm4gX2l0ZW07IH0K
CgoKCgogICAgc3RkOjpzdHJpbmcgaWQoKSBjb25zdCB7IHJldHVybiBfaWQ7IH0KCnByb3RlY3Rl
ZDoKCgoKCgoKICAgIHZpcnR1YWwgfllNZW51RXZlbnQoKSB7fQoKCgoKCgogICAgWUl0ZW0gKiBf
aXRlbTsKICAgIHN0ZDo6c3RyaW5nIF9pZDsKfTsKCgoKCgoKY2xhc3MgWUNhbmNlbEV2ZW50OiBw
dWJsaWMgWUV2ZW50CnsKcHVibGljOgoKICAgIFlDYW5jZWxFdmVudCgpIDogWUV2ZW50KCBDYW5j
ZWxFdmVudCApIHt9CgoKcHJvdGVjdGVkOgoKCgoKCiAgICB2aXJ0dWFsIH5ZQ2FuY2VsRXZlbnQo
KSB7fQp9OwoKCgoKCgpjbGFzcyBZRGVidWdFdmVudDogcHVibGljIFlFdmVudAp7CnB1YmxpYzoK
CiAgICBZRGVidWdFdmVudCgpIDogWUV2ZW50KCBEZWJ1Z0V2ZW50ICkge30KCnByb3RlY3RlZDoK
CgoKCgogICAgdmlydHVhbCB+WURlYnVnRXZlbnQoKSB7fQp9OwoKCgoKCgpjbGFzcyBZVGltZW91
dEV2ZW50OiBwdWJsaWMgWUV2ZW50CnsKcHVibGljOgoKICAgIFlUaW1lb3V0RXZlbnQoKSA6IFlF
dmVudCggVGltZW91dEV2ZW50ICkge30KCnByb3RlY3RlZDoKCgoKCgogICAgdmlydHVhbCB+WVRp
bWVvdXRFdmVudCgpIHt9Cn07CgoKc3RkOjpvc3RyZWFtICYgb3BlcmF0b3I8PCggc3RkOjpvc3Ry
ZWFtICYgc3RyZWFtLCBjb25zdCBZRXZlbnQgKiBldmVudCApOwojIDM0ICIvaG9tZS9zaGFya2N6
L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5jYyIgMgojIDEg
Ii9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZU2hv
cnRjdXRNYW5hZ2VyLmgiIDEKIyAzMCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1
aS1tYXN0ZXItMy4yLjEvc3JjL1lTaG9ydGN1dE1hbmFnZXIuaCIKIyAxICIvaG9tZS9zaGFya2N6
L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVNob3J0Y3V0LmgiIDEKIyAz
MyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lT
aG9ydGN1dC5oIgpjbGFzcyBZSXRlbTsKCgoKCgoKY2xhc3MgWVNob3J0Y3V0CnsKcHVibGljOgoK
CgogICAgWVNob3J0Y3V0KCBZV2lkZ2V0ICpzaG9ydGN1dF93aWRnZXQgKTsKCgoKCiAgICB2aXJ0
dWFsIH5ZU2hvcnRjdXQoKTsKCgoKCiAgICBlbnVtIHsgTm9uZSA9IDAgfTsKCgoKCiAgICBZV2lk
Z2V0ICogd2lkZ2V0KCkgY29uc3QgeyByZXR1cm4gX3dpZGdldDsgfQoKCgoKCiAgICBjb25zdCBj
aGFyICogd2lkZ2V0Q2xhc3MoKSBjb25zdCB7IHJldHVybiB3aWRnZXQoKS0+d2lkZ2V0Q2xhc3Mo
KTsgfQoKCgoKCiAgICBib29sIGlzQnV0dG9uKCkgY29uc3QgeyByZXR1cm4gX2lzQnV0dG9uOyB9
CgoKCgoKICAgIGJvb2wgaXNXaXphcmRCdXR0b24oKSBjb25zdCB7IHJldHVybiBfaXNXaXphcmRC
dXR0b247IH0KIyA4OSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXIt
My4yLjEvc3JjL1lTaG9ydGN1dC5oIgogICAgc3RkOjpzdHJpbmcgc2hvcnRjdXRTdHJpbmcoKTsK
CgoKCgogICAgc3RkOjpzdHJpbmcgY2xlYW5TaG9ydGN1dFN0cmluZygpOwoKCgoKCiAgICBzdGF0
aWMgc3RkOjpzdHJpbmcgY2xlYW5TaG9ydGN1dFN0cmluZyggc3RkOjpzdHJpbmcgc2hvcnRjdXRT
dHJpbmcgKTsKCgoKCgogICAgY2hhciBwcmVmZXJyZWQoKTsKCgoKCgoKICAgIGNoYXIgc2hvcnRj
dXQoKTsKCgoKCiAgICB2aXJ0dWFsIHZvaWQgc2V0U2hvcnRjdXQoIGNoYXIgbmV3U2hvcnRjdXQg
KTsKCgoKCgogICAgdm9pZCBjbGVhclNob3J0Y3V0KCk7CgoKCgoKICAgIGJvb2wgY29uZmxpY3Qo
KSB7IHJldHVybiBfY29uZmxpY3Q7IH0KCgoKCiAgICB2b2lkIHNldENvbmZsaWN0KCBib29sIG5l
d0NvbmZsaWN0U3RhdGUgPSB0cnVlICkgeyBfY29uZmxpY3QgPSBuZXdDb25mbGljdFN0YXRlOyB9
CgoKCgoKICAgIGludCBkaXN0aW5jdFNob3J0Y3V0Q2hhcnMoKTsKCgoKCgogICAgYm9vbCBoYXNW
YWxpZFNob3J0Y3V0Q2hhcigpOwoKCgoKCiAgICBzdGF0aWMgY2hhciBzaG9ydGN1dE1hcmtlcigp
IHsgcmV0dXJuICcmJzsgfQojIDE2MyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1
aS1tYXN0ZXItMy4yLjEvc3JjL1lTaG9ydGN1dC5oIgogICAgc3RhdGljIHN0ZDo6c3RyaW5nOjpz
aXplX3R5cGUgZmluZFNob3J0Y3V0UG9zKCBjb25zdCBzdGQ6OnN0cmluZyAmIHN0ciwgc3RkOjpz
dHJpbmc6OnNpemVfdHlwZSBzdGFydF9wb3MgPSAwICk7CgoKCgoKCgogICAgc3RhdGljIGNoYXIg
ZmluZFNob3J0Y3V0KCBjb25zdCBzdGQ6OnN0cmluZyAmIHN0ciwgc3RkOjpzdHJpbmc6OnNpemVf
dHlwZSBzdGFydF9wb3MgPSAwICk7CgoKCgoKICAgIHN0YXRpYyBib29sIGlzVmFsaWQoIGNoYXIg
YyApOwoKCgoKCiAgICBzdGF0aWMgY2hhciBub3JtYWxpemVkKCBjaGFyIGMgKTsKCgoKCgogICAg
c3RhdGljIHN0ZDo6c3RyaW5nIGdldFNob3J0Y3V0U3RyaW5nKCBjb25zdCBZV2lkZ2V0ICogd2lk
Z2V0ICk7CgoKcHJvdGVjdGVkOgoKCgoKCiAgICB2aXJ0dWFsIHN0ZDo6c3RyaW5nIGdldFNob3J0
Y3V0U3RyaW5nKCk7CgoKCgogICAgWVdpZGdldCAqIF93aWRnZXQ7CiAgICBzdGQ6OnN0cmluZyBf
c2hvcnRjdXRTdHJpbmc7CiAgICBib29sIF9zaG9ydGN1dFN0cmluZ0NhY2hlZDsKCiAgICBzdGQ6
OnN0cmluZyBfY2xlYW5TaG9ydGN1dFN0cmluZzsKICAgIGJvb2wgX2NsZWFuU2hvcnRjdXRTdHJp
bmdDYWNoZWQ7CgogICAgaW50IF9wcmVmZXJyZWQ7CiAgICBpbnQgX3Nob3J0Y3V0OwoKICAgIGJv
b2wgX2NvbmZsaWN0OwogICAgYm9vbCBfaXNCdXR0b247CiAgICBib29sIF9pc1dpemFyZEJ1dHRv
bjsKICAgIGludCBfZGlzdGluY3RTaG9ydGN1dENoYXJzOwp9OwoKCgoKCgoKY2xhc3MgWUl0ZW1T
aG9ydGN1dDogcHVibGljIFlTaG9ydGN1dAp7CnB1YmxpYzoKCgoKICAgIFlJdGVtU2hvcnRjdXQo
IFlXaWRnZXQgKiB3aWRnZXQsIFlJdGVtICogaXRlbSApCiA6IFlTaG9ydGN1dCggd2lkZ2V0ICkK
ICwgX2l0ZW0oIGl0ZW0gKQoge30KCgoKCiAgICB2aXJ0dWFsIH5ZSXRlbVNob3J0Y3V0KCkge30K
CgoKCiAgICBZSXRlbSAqIGl0ZW0oKSBjb25zdCB7IHJldHVybiBfaXRlbTsgfQoKCgoKCiAgICB2
aXJ0dWFsIHZvaWQgc2V0U2hvcnRjdXQoIGNoYXIgbmV3U2hvcnRjdXQgKTsKCnByb3RlY3RlZDoK
CgoKCgogICAgdmlydHVhbCBzdGQ6OnN0cmluZyBnZXRTaG9ydGN1dFN0cmluZygpOwoKCnByaXZh
dGU6CgogICAgWUl0ZW0gKiBfaXRlbTsKfTsKCgp0eXBlZGVmIHN0ZDo6dmVjdG9yPFlTaG9ydGN1
dCAqPiBZU2hvcnRjdXRMaXN0Owp0eXBlZGVmIFlTaG9ydGN1dExpc3Q6Oml0ZXJhdG9yIFlTaG9y
dGN1dExpc3RJdGVyYXRvcjsKIyAzMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1
aS1tYXN0ZXItMy4yLjEvc3JjL1lTaG9ydGN1dE1hbmFnZXIuaCIgMgoKY2xhc3MgWURpYWxvZzsK
CgoKCgpjbGFzcyBZU2hvcnRjdXRNYW5hZ2VyCnsKcHVibGljOgoKCgogICAgWVNob3J0Y3V0TWFu
YWdlciggWURpYWxvZyAqZGlhbG9nICk7CgoKCgogICAgdmlydHVhbCB+WVNob3J0Y3V0TWFuYWdl
cigpOwoKCgoKCgoKICAgIHZvaWQgY2hlY2tTaG9ydGN1dHMoIGJvb2wgYXV0b1Jlc29sdmUgPSB0
cnVlICk7CgoKCgoKICAgIGludCBjb25mbGljdENvdW50KCkgeyByZXR1cm4gX2NvbmZsaWN0Q291
bnQ7IH0KIyA5OSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4y
LjEvc3JjL1lTaG9ydGN1dE1hbmFnZXIuaCIKICAgIHZvaWQgcmVzb2x2ZUFsbENvbmZsaWN0cygp
OwoKCgoKICAgIFlEaWFsb2cgKmRpYWxvZygpIHsgcmV0dXJuIF9kaWFsb2c7IH0KCnByb3RlY3Rl
ZDoKCgoKCiAgICB2b2lkIGNsZWFyU2hvcnRjdXRMaXN0KCk7CgoKCgoKCiAgICB2b2lkIGZpbmRT
aG9ydGN1dFdpZGdldHMoIFlXaWRnZXRMaXN0Q29uc3RJdGVyYXRvciBiZWdpbiwKICAgICAgICAg
WVdpZGdldExpc3RDb25zdEl0ZXJhdG9yIGVuZCApOwoKCgoKCiAgICB2b2lkIHJlc29sdmVDb25m
bGljdCggWVNob3J0Y3V0ICogc2hvcnRjdXQgKTsKCgoKCgogICAgaW50IGZpbmRTaG9ydGVzdFdp
emFyZEJ1dHRvbiggY29uc3QgWVNob3J0Y3V0TGlzdCAmIGNvbmZsaWN0TGlzdCApOwoKCgoKCgoK
ICAgIHVuc2lnbmVkIGZpbmRTaG9ydGVzdFdpZGdldCggY29uc3QgWVNob3J0Y3V0TGlzdCAmIGNv
bmZsaWN0TGlzdCApOwoKCgoKICAgIFlEaWFsb2cgKl9kaWFsb2c7CgoKCgogICAgWVNob3J0Y3V0
TGlzdCBfc2hvcnRjdXRMaXN0OwoKCgoKICAgIGludCBfd2FudGVkWyBzaXplb2YoIGNoYXIgKSA8
PCA4IF07CgoKCgoKICAgIGJvb2wgX3VzZWRbIHNpemVvZiggY2hhciApIDw8IDggXTsKCgoKCgog
ICAgaW50IF9jb25mbGljdENvdW50OwoKCnByaXZhdGU6CgogICAgYm9vbCBfZGlkQ2hlY2s7Cn07
CiMgMzUgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3Ny
Yy9ZRGlhbG9nLmNjIiAyCiMgMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1t
YXN0ZXItMy4yLjEvc3JjL1lQdXNoQnV0dG9uLmgiIDEKIyAzMCAiL2hvbWUvc2hhcmtjei9saWJ5
dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lQdXNoQnV0dG9uLmgiCmNsYXNzIFlQ
dXNoQnV0dG9uUHJpdmF0ZTsKCgoKY2xhc3MgWVB1c2hCdXR0b24gOiBwdWJsaWMgWVdpZGdldAp7
CnByb3RlY3RlZDoKCgoKICAgIFlQdXNoQnV0dG9uKCBZV2lkZ2V0ICogcGFyZW50LCBjb25zdCBz
dGQ6OnN0cmluZyAmIGxhYmVsICk7CgpwdWJsaWM6CgoKCiAgICB2aXJ0dWFsIH5ZUHVzaEJ1dHRv
bigpOwoKCgoKCiAgICB2aXJ0dWFsIGNvbnN0IGNoYXIgKiB3aWRnZXRDbGFzcygpIGNvbnN0IHsg
cmV0dXJuICJZUHVzaEJ1dHRvbiI7IH0KCgoKCiAgICBzdGQ6OnN0cmluZyBsYWJlbCgpIGNvbnN0
OwoKCgoKCgoKICAgIHZpcnR1YWwgdm9pZCBzZXRMYWJlbCggY29uc3Qgc3RkOjpzdHJpbmcgJiBs
YWJlbCApOwojIDc0ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0z
LjIuMS9zcmMvWVB1c2hCdXR0b24uaCIKICAgIHZpcnR1YWwgdm9pZCBzZXRJY29uKCBjb25zdCBz
dGQ6OnN0cmluZyAmIGljb25OYW1lICkge30KCgoKCgoKICAgIGJvb2wgaXNEZWZhdWx0QnV0dG9u
KCkgY29uc3Q7CgoKCgoKCgogICAgdmlydHVhbCB2b2lkIHNldERlZmF1bHRCdXR0b24oIGJvb2wg
ZGVmID0gdHJ1ZSApOwojIDExMCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1t
YXN0ZXItMy4yLjEvc3JjL1lQdXNoQnV0dG9uLmgiCiAgICB2aXJ0dWFsIHZvaWQgc2V0Um9sZSgg
WUJ1dHRvblJvbGUgcm9sZSApOwoKCgoKICAgIFlCdXR0b25Sb2xlIHJvbGUoKSBjb25zdDsKIyAx
MjYgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9Z
UHVzaEJ1dHRvbi5oIgogICAgdmlydHVhbCB2b2lkIHNldEZ1bmN0aW9uS2V5KCBpbnQgZmtleV9u
byApOwojIDE0MiAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4y
LjEvc3JjL1lQdXNoQnV0dG9uLmgiCiAgICBib29sIGlzSGVscEJ1dHRvbigpIGNvbnN0OwoKCgoK
CgoKICAgIHZpcnR1YWwgdm9pZCBzZXRIZWxwQnV0dG9uKCBib29sIGhlbHBCdXR0b24gPSB0cnVl
ICk7CiMgMTYxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIu
MS9zcmMvWVB1c2hCdXR0b24uaCIKICAgIGJvb2wgaXNSZWxOb3Rlc0J1dHRvbigpIGNvbnN0OwoK
CgoKCgoKICAgIHZpcnR1YWwgdm9pZCBzZXRSZWxOb3Rlc0J1dHRvbiggYm9vbCByZWxOb3Rlc0J1
dHRvbiA9IHRydWUgKTsKIyAxODEgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWkt
bWFzdGVyLTMuMi4xL3NyYy9ZUHVzaEJ1dHRvbi5oIgogICAgdmlydHVhbCBib29sIHNldFByb3Bl
cnR5KCBjb25zdCBzdGQ6OnN0cmluZyAmIHByb3BlcnR5TmFtZSwKICAgICAgICAgY29uc3QgWVBy
b3BlcnR5VmFsdWUgJiB2YWwgKTsKCgoKCgoKCiAgICB2aXJ0dWFsIFlQcm9wZXJ0eVZhbHVlIGdl
dFByb3BlcnR5KCBjb25zdCBzdGQ6OnN0cmluZyAmIHByb3BlcnR5TmFtZSApOwoKCgoKCgoKICAg
IHZpcnR1YWwgY29uc3QgWVByb3BlcnR5U2V0ICYgcHJvcGVydHlTZXQoKTsKCgoKCgoKICAgIHZp
cnR1YWwgc3RkOjpzdHJpbmcgc2hvcnRjdXRTdHJpbmcoKSBjb25zdCB7IHJldHVybiBsYWJlbCgp
OyB9CgoKCgoKCiAgICB2aXJ0dWFsIHZvaWQgc2V0U2hvcnRjdXRTdHJpbmcoIGNvbnN0IHN0ZDo6
c3RyaW5nICYgc3RyICkKIHsgc2V0TGFiZWwoIHN0ciApOyB9CgoKcHJpdmF0ZToKCiAgICBJbXBs
UHRyPFlQdXNoQnV0dG9uUHJpdmF0ZT4gcHJpdjsKfTsKCgpzdGQ6Om9zdHJlYW0gJiBvcGVyYXRv
cjw8KCBzdGQ6Om9zdHJlYW0gJiBzdHJlYW0sIFlCdXR0b25Sb2xlIHJvbGUgKTsKCgp0eXBlZGVm
IFlQdXNoQnV0dG9uIFlJY29uQnV0dG9uOwojIDM2ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5
dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5jYyIgMgojIDEgIi9ob21lL3NoYXJr
Y3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZQnV0dG9uQm94LmgiIDEK
IyAzMyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3Jj
L1lCdXR0b25Cb3guaCIKY2xhc3MgWUJ1dHRvbkJveFByaXZhdGU7CmNsYXNzIFlQdXNoQnV0dG9u
OwoKCgoKCgpzdHJ1Y3QgWUJ1dHRvbkJveExheW91dFBvbGljeQp7CiAgICBZQnV0dG9uQm94TGF5
b3V0UG9saWN5KCkKIDogYnV0dG9uT3JkZXIoIFlLREVCdXR0b25PcmRlciApCiAsIGVxdWFsU2l6
ZUJ1dHRvbnMoIGZhbHNlICkKICwgYWRkRXhjZXNzU3BhY2VUb0hlbHBCdXR0b25FeHRyYU1hcmdp
biggZmFsc2UgKQogICAgewogYWxpZ25tZW50WyBZRF9IT1JJWiBdID0gWUFsaWduQ2VudGVyOwog
YWxpZ25tZW50WyBZRF9WRVJUIF0gPSBZQWxpZ25CZWdpbjsKICAgIH0KCiAgICBZQnV0dG9uT3Jk
ZXIgYnV0dG9uT3JkZXI7CiAgICBib29sIGVxdWFsU2l6ZUJ1dHRvbnM7CiAgICBib29sIGFkZEV4
Y2Vzc1NwYWNlVG9IZWxwQnV0dG9uRXh0cmFNYXJnaW47CgoKICAgIFlBbGlnbm1lbnRUeXBlIGFs
aWdubWVudFsgMiBdOwp9OwoKCgoKCgpzdHJ1Y3QgWUJ1dHRvbkJveE1hcmdpbnMKewogICAgWUJ1
dHRvbkJveE1hcmdpbnMoKQogOiBsZWZ0KCAwICkKICwgcmlnaHQoIDAgKQogLCB0b3AoIDAgKQog
LCBib3R0b20oIDAgKQogLCBzcGFjaW5nKCAwICkKICwgaGVscEJ1dHRvbkV4dHJhU3BhY2luZygg
MCApCiB7fQoKICAgIGludCBsZWZ0OwogICAgaW50IHJpZ2h0OwogICAgaW50IHRvcDsKICAgIGlu
dCBib3R0b207CgogICAgaW50IHNwYWNpbmc7CiAgICBpbnQgaGVscEJ1dHRvbkV4dHJhU3BhY2lu
ZzsKfTsKIyAxNDggIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMu
Mi4xL3NyYy9ZQnV0dG9uQm94LmgiCmNsYXNzIFlCdXR0b25Cb3ggOiBwdWJsaWMgWVdpZGdldAp7
CiAgICBmcmllbmQgY2xhc3MgWUJ1dHRvbkJveFByaXZhdGU7Cgpwcm90ZWN0ZWQ6CgoKCiAgICBZ
QnV0dG9uQm94KCBZV2lkZ2V0ICogcGFyZW50ICk7CgpwdWJsaWM6CgoKCgogICAgdmlydHVhbCB+
WUJ1dHRvbkJveCgpOwoKCgoKCiAgICB2aXJ0dWFsIGNvbnN0IGNoYXIgKiB3aWRnZXRDbGFzcygp
IGNvbnN0IHsgcmV0dXJuICJZQnV0dG9uQm94IjsgfQojIDE4NiAiL2hvbWUvc2hhcmtjei9saWJ5
dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lCdXR0b25Cb3guaCIKICAgIHN0YXRp
YyB2b2lkIHNldExheW91dFBvbGljeSggY29uc3QgWUJ1dHRvbkJveExheW91dFBvbGljeSAmIGxh
eW91dFBvbGljeSApOwoKCgoKICAgIHN0YXRpYyBZQnV0dG9uQm94TGF5b3V0UG9saWN5IGxheW91
dFBvbGljeSgpOwoKCgoKICAgIHN0YXRpYyBZQnV0dG9uQm94TGF5b3V0UG9saWN5IGtkZUxheW91
dFBvbGljeSgpOwoKCgoKICAgIHN0YXRpYyBZQnV0dG9uQm94TGF5b3V0UG9saWN5IGdub21lTGF5
b3V0UG9saWN5KCk7CgoKCgogICAgc3RhdGljIHZvaWQgc2V0RGVmYXVsdE1hcmdpbnMoIGNvbnN0
IFlCdXR0b25Cb3hNYXJnaW5zICYgbWFyZ2lucyApOwoKCgoKICAgIHN0YXRpYyBZQnV0dG9uQm94
TWFyZ2lucyBkZWZhdWx0TWFyZ2lucygpOwoKCgoKCgoKICAgIHZpcnR1YWwgdm9pZCBzZXRNYXJn
aW5zKCBjb25zdCBZQnV0dG9uQm94TWFyZ2lucyAmIG1hcmdpbnMgKTsKCgoKCgoKCiAgICBZQnV0
dG9uQm94TWFyZ2lucyBtYXJnaW5zKCkgY29uc3Q7CiMgMjQ1ICIvaG9tZS9zaGFya2N6L2xpYnl1
aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUJ1dHRvbkJveC5oIgogICAgdmlydHVh
bCB2b2lkIGRvTGF5b3V0KCBpbnQgd2lkdGgsIGludCBoZWlnaHQgKTsKCgoKCgogICAgWVB1c2hC
dXR0b24gKiBmaW5kQnV0dG9uKCBZQnV0dG9uUm9sZSByb2xlICk7CiMgMjc0ICIvaG9tZS9zaGFy
a2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUJ1dHRvbkJveC5oIgog
ICAgdm9pZCBzYW5pdHlDaGVjaygpOwojIDI5NiAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVp
LWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lCdXR0b25Cb3guaCIKICAgIHZvaWQgc2V0U2FuaXR5
Q2hlY2tSZWxheGVkKCBib29sIHJlbGF4ID0gdHJ1ZSApOwoKCgoKICAgIGJvb2wgc2FuaXR5Q2hl
Y2tSZWxheGVkKCkgY29uc3Q7CiMgMzEzICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGli
eXVpLW1hc3Rlci0zLjIuMS9zcmMvWUJ1dHRvbkJveC5oIgogICAgdmlydHVhbCBpbnQgcHJlZmVy
cmVkV2lkdGgoKTsKIyAzMjQgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFz
dGVyLTMuMi4xL3NyYy9ZQnV0dG9uQm94LmgiCiAgICB2aXJ0dWFsIGludCBwcmVmZXJyZWRIZWln
aHQoKTsKIyAzMzQgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMu
Mi4xL3NyYy9ZQnV0dG9uQm94LmgiCiAgICB2aXJ0dWFsIHZvaWQgc2V0U2l6ZSggaW50IG5ld1dp
ZHRoLCBpbnQgbmV3SGVpZ2h0ICk7CiMgMzQzICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWkt
bGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUJ1dHRvbkJveC5oIgogICAgdmlydHVhbCBib29sIHN0
cmV0Y2hhYmxlKCBZVUlEaW1lbnNpb24gZGltZW5zaW9uICkgY29uc3Q7CgoKcHJvdGVjdGVkOgoj
IDM1OSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3Jj
L1lCdXR0b25Cb3guaCIKICAgIHZpcnR1YWwgc3RkOjp2ZWN0b3I8WVB1c2hCdXR0b24gKj4gYnV0
dG9uc0J5QnV0dG9uT3JkZXIoKTsKCgoKCgogICAgaW50IG1heENoaWxkU2l6ZSggWVVJRGltZW5z
aW9uIGRpbSApIGNvbnN0OwoKCgoKICAgIGludCB0b3RhbENoaWxkcmVuV2lkdGgoKSBjb25zdDsK
CgoKCgoKICAgIHZpcnR1YWwgdm9pZCBtb3ZlQ2hpbGQoIFlXaWRnZXQgKiBjaGlsZCwgaW50IG5l
d1gsIGludCBuZXdZICkgPSAwOwoKCgoKCiAgICBpbnQgcHJlZmVycmVkV2lkdGgoIGJvb2wgZXF1
YWxTaXplQnV0dG9ucyApOwoKCnByaXZhdGU6CgogICAgSW1wbFB0cjxZQnV0dG9uQm94UHJpdmF0
ZT4gcHJpdjsKCiAgICBzdGF0aWMgWUJ1dHRvbkJveExheW91dFBvbGljeSBfbGF5b3V0UG9saWN5
OwogICAgc3RhdGljIFlCdXR0b25Cb3hNYXJnaW5zIF9kZWZhdWx0TWFyZ2luczsKfTsKIyAzNyAi
L2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lEaWFs
b2cuY2MiIDIKCiMgMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXIt
My4yLjEvc3JjL1lVSS5oIiAxCiMgMzIgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5
dWktbWFzdGVyLTMuMi4xL3NyYy9ZVUkuaCIKIyAxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5
dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVNldHRpbmdzLmgiIDEKIyA0MyAiL2hvbWUvc2hh
cmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lTZXR0aW5ncy5oIgpj
bGFzcyBZU2V0dGluZ3MKewpwdWJsaWM6CgoKCgoKCgogICAgc3RhdGljIHZvaWQgc2V0UHJvZ0Rp
ciAoIHN0ZDo6c3RyaW5nIGRpcmVjdG9yeSApOwoKCgogICAgc3RhdGljIHN0ZDo6c3RyaW5nIHBy
b2dEaXIgKCk7CiMgNjYgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVy
LTMuMi4xL3NyYy9ZU2V0dGluZ3MuaCIKICAgIHN0YXRpYyB2b2lkIHNldEljb25EaXIgKCBzdGQ6
OnN0cmluZyBkaXJlY3RvcnkgKTsKCgoKICAgIHN0YXRpYyBzdGQ6OnN0cmluZyBpY29uRGlyICgp
OwojIDc5ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9z
cmMvWVNldHRpbmdzLmgiCiAgICBzdGF0aWMgdm9pZCBzZXRUaGVtZURpciAoIHN0ZDo6c3RyaW5n
IGRpcmVjdG9yeSApOwoKCgogICAgc3RhdGljIHN0ZDo6c3RyaW5nIHRoZW1lRGlyICgpOwojIDky
ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVNl
dHRpbmdzLmgiCiAgICBzdGF0aWMgdm9pZCBzZXRMb2NhbGVEaXIgKCBzdGQ6OnN0cmluZyBkaXJl
Y3RvcnkgKTsKCgoKICAgIHN0YXRpYyBzdGQ6OnN0cmluZyBsb2NhbGVEaXIgKCk7Cgpwcml2YXRl
OgogICAgc3RhdGljIHN0ZDo6c3RyaW5nIF9wcm9nRGlyOwogICAgc3RhdGljIHN0ZDo6c3RyaW5n
IF9pY29uRGlyOwogICAgc3RhdGljIHN0ZDo6c3RyaW5nIF90aGVtZURpcjsKICAgIHN0YXRpYyBz
dGQ6OnN0cmluZyBfbG9jYWxlRGlyOwoKICAgIFlTZXR0aW5ncyAoKTsKICAgIFlTZXR0aW5ncyAo
IGNvbnN0IFlTZXR0aW5ncyYgKTsKICAgIH5ZU2V0dGluZ3MgKCk7Cn07CiMgMzMgIi9ob21lL3No
YXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZVUkuaCIgMgoKY2xh
c3MgWUFwcGxpY2F0aW9uOwpjbGFzcyBZV2lkZ2V0OwpjbGFzcyBZV2lkZ2V0RmFjdG9yeTsKY2xh
c3MgWU9wdGlvbmFsV2lkZ2V0RmFjdG9yeTsKY2xhc3MgWUV2ZW50OwpjbGFzcyBZQnVpbHRpbkNh
bGxlcjsKY2xhc3MgWURpYWxvZzsKY2xhc3MgWU1hY3JvUGxheWVyOwpjbGFzcyBZTWFjcm9SZWNv
cmRlcjsKCgoKCgpjbGFzcyBZVUkKewogICAgZnJpZW5kIGNsYXNzIFlVSUZ1bmN0aW9uOwogICAg
ZnJpZW5kIGNsYXNzIFlVSUxvYWRlcjsKCnByb3RlY3RlZDoKCgoKICAgIFlVSSggYm9vbCB3aXRo
VGhyZWFkcyApOwoKcHVibGljOgoKCgoKICAgIHZpcnR1YWwgfllVSSgpOwoKCgoKCgogICAgdm9p
ZCBzaHV0ZG93blRocmVhZHMoKTsKCgoKCiAgICBzdGF0aWMgWVVJICogdWkoKTsKIyA4NiAiL2hv
bWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lVSS5oIgog
ICAgc3RhdGljIFlXaWRnZXRGYWN0b3J5ICogd2lkZ2V0RmFjdG9yeSgpOwojIDk3ICIvaG9tZS9z
aGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVVJLmgiCiAgICBz
dGF0aWMgWU9wdGlvbmFsV2lkZ2V0RmFjdG9yeSAqIG9wdGlvbmFsV2lkZ2V0RmFjdG9yeSgpOwoj
IDEwNyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3Jj
L1lVSS5oIgogICAgc3RhdGljIFlBcHBsaWNhdGlvbiAqIGFwcCgpOwoKCgoKICAgIHN0YXRpYyBZ
QXBwbGljYXRpb24gKiBhcHBsaWNhdGlvbigpIHsgcmV0dXJuIGFwcCgpOyB9CiAgICBzdGF0aWMg
WUFwcGxpY2F0aW9uICogeUFwcCgpIHsgcmV0dXJuIGFwcCgpOyB9CgoKCgoKCgogICAgc3RhdGlj
IHZvaWQgZW5zdXJlVUlDcmVhdGVkKCk7CgoKcHJvdGVjdGVkOgoKCgoKCgoKICAgIHZpcnR1YWwg
WVdpZGdldEZhY3RvcnkgKiBjcmVhdGVXaWRnZXRGYWN0b3J5KCkgPSAwOwojIDE0MSAiL2hvbWUv
c2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lVSS5oIgogICAg
dmlydHVhbCBZT3B0aW9uYWxXaWRnZXRGYWN0b3J5ICogY3JlYXRlT3B0aW9uYWxXaWRnZXRGYWN0
b3J5KCkgPSAwOwoKCgoKCgogICAgdmlydHVhbCBZQXBwbGljYXRpb24gKiBjcmVhdGVBcHBsaWNh
dGlvbigpID0gMDsKCgpwdWJsaWM6CiMgMTYxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWkt
bGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVVJLmgiCiAgICB2aXJ0dWFsIHZvaWQgYmxvY2tFdmVu
dHMoIGJvb2wgYmxvY2sgPSB0cnVlICkgeyBfZXZlbnRzQmxvY2tlZCA9IGJsb2NrOyB9CgoKCgoK
CgogICAgdm9pZCB1bmJsb2NrRXZlbnRzKCkgeyBibG9ja0V2ZW50cyggZmFsc2UgKTsgfQoKCgoK
CgogICAgdmlydHVhbCBib29sIGV2ZW50c0Jsb2NrZWQoKSBjb25zdCB7IHJldHVybiBfZXZlbnRz
QmxvY2tlZDsgfQojIDE4NSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0
ZXItMy4yLjEvc3JjL1lVSS5oIgogICAgdmlydHVhbCB2b2lkIGRlbGV0ZU5vdGlmeSggWVdpZGdl
dCAqIHdpZGdldCApIHt9CgoKCgoKICAgIHZvaWQgdG9wbW9zdENvbnN0cnVjdG9ySGFzRmluaXNo
ZWQoKTsKCgoKCiAgICBib29sIHJ1bm5pbmdXaXRoVGhyZWFkcygpIGNvbnN0IHsgcmV0dXJuIF93
aXRoVGhyZWFkczsgfQojIDIwNiAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1t
YXN0ZXItMy4yLjEvc3JjL1lVSS5oIgogICAgdm9pZCB1aVRocmVhZE1haW5Mb29wKCk7CgoKCgoK
ICAgIFlCdWlsdGluQ2FsbGVyICogYnVpbHRpbkNhbGxlcigpIGNvbnN0IHsgcmV0dXJuIF9idWls
dGluQ2FsbGVyOyB9CgoKCgoKICAgIHZvaWQgc2V0QnVpbHRpbkNhbGxlciggWUJ1aWx0aW5DYWxs
ZXIgKiBjYWxsZXIgKQogeyBfYnVpbHRpbkNhbGxlciA9IGNhbGxlcjsgfQojIDIzMSAiL2hvbWUv
c2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lVSS5oIgogICAg
dmlydHVhbCBZRXZlbnQgKiBydW5Qa2dTZWxlY3Rpb24oIFlXaWRnZXQgKiBwYWNrYWdlU2VsZWN0
b3IgKSA9IDA7CgoKcHJvdGVjdGVkOgojIDI1MCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVp
LWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lVSS5oIgogICAgdmlydHVhbCB2b2lkIGlkbGVMb29w
KCBpbnQgZmRfeWNwICkgPSAwOwoKCgoKCiAgICB2b2lkIHRlcm1pbmF0ZVVJVGhyZWFkKCk7CgoK
CgogICAgdm9pZCBjcmVhdGVVSVRocmVhZCgpOwogICAgZnJpZW5kIHZvaWQgKnN0YXJ0X3VpX3Ro
cmVhZCggdm9pZCAqdWlfaW50ICk7CiMgMjcxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWkt
bGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVVJLmgiCiAgICB2aXJ0dWFsIHZvaWQgdWlUaHJlYWRE
ZXN0cnVjdG9yKCk7CgoKCgoKICAgIHZvaWQgc2lnbmFsVUlUaHJlYWQoKTsKCgoKCgogICAgYm9v
bCB3YWl0Rm9yVUlUaHJlYWQoKTsKCgoKCgogICAgdm9pZCBzaWduYWxZQ1BUaHJlYWQoKTsKCgoK
CgogICAgYm9vbCB3YWl0Rm9yWUNQVGhyZWFkKCk7CiMgMzA2ICIvaG9tZS9zaGFya2N6L2xpYnl1
aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVVJLmgiCiAgICB2b2lkIHNldEJ1dHRv
bk9yZGVyRnJvbUVudmlyb25tZW50KCk7CiMgMzE2ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5
dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVVJLmgiCiAgICBib29sIF93aXRoVGhyZWFkczsK
CgoKCiAgICBwdGhyZWFkX3QgX3VpVGhyZWFkOwojIDMzMCAiL2hvbWUvc2hhcmtjei9saWJ5dWkv
bGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lVSS5oIgogICAgWUJ1aWx0aW5DYWxsZXIg
KiBfYnVpbHRpbkNhbGxlcjsKCgoKCgoKICAgIGludCBwaXBlX3RvX3VpWzJdOwoKCgoKCgogICAg
aW50IHBpcGVfZnJvbV91aVsyXTsKCgoKCgoKCiAgICBib29sIF90ZXJtaW5hdGVfdWlfdGhyZWFk
OwoKCgoKCiAgICBib29sIF9ldmVudHNCbG9ja2VkOwoKcHJpdmF0ZToKCiAgICBzdGF0aWMgWVVJ
ICogX3VpOwp9OwojIDM5ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rl
ci0zLjIuMS9zcmMvWURpYWxvZy5jYyIgMgojIDEgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1
aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZQXBwbGljYXRpb24uaCIgMQojIDMxICIvaG9tZS9z
aGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUFwcGxpY2F0aW9u
LmgiCiMgMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEv
c3JjL1lNZW51SXRlbS5oIiAxCiMgMjggIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5
dWktbWFzdGVyLTMuMi4xL3NyYy9ZTWVudUl0ZW0uaCIKIyAxICIvaG9tZS9zaGFya2N6L2xpYnl1
aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVRyZWVJdGVtLmgiIDEKIyAyOCAiL2hv
bWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lUcmVlSXRl
bS5oIgojIDEgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4x
L3NyYy9ZSXRlbS5oIiAxCiMgMzIgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWkt
bWFzdGVyLTMuMi4xL3NyYy9ZSXRlbS5oIgpjbGFzcyBZSXRlbTsKCgoKCgp0eXBlZGVmIHN0ZDo6
dmVjdG9yPFlJdGVtICo+IFlJdGVtQ29sbGVjdGlvbjsKCnR5cGVkZWYgWUl0ZW1Db2xsZWN0aW9u
OjppdGVyYXRvciBZSXRlbUl0ZXJhdG9yOwoKdHlwZWRlZiBZSXRlbUNvbGxlY3Rpb246OmNvbnN0
X2l0ZXJhdG9yIFlJdGVtQ29uc3RJdGVyYXRvcjsKCgoKCgoKY2xhc3MgWUl0ZW0KewpwdWJsaWM6
CgoKCiAgICBZSXRlbSggY29uc3Qgc3RkOjpzdHJpbmcgJiBsYWJlbCwgYm9vbCBzZWxlY3RlZCA9
IGZhbHNlICkKIDogX2xhYmVsKCBsYWJlbCApCiAsIF9zZWxlY3RlZCggc2VsZWN0ZWQgKQogLCBf
aW5kZXgoIC0xICkKICwgX2RhdGEoIDAgKQoge30KCgoKCiAgICBZSXRlbSggY29uc3Qgc3RkOjpz
dHJpbmcgJiBsYWJlbCwgY29uc3Qgc3RkOjpzdHJpbmcgJiBpY29uTmFtZSwgYm9vbCBzZWxlY3Rl
ZCA9IGZhbHNlICkKIDogX2xhYmVsKCBsYWJlbCApCiAsIF9pY29uTmFtZSggaWNvbk5hbWUgKQog
LCBfc2VsZWN0ZWQoIHNlbGVjdGVkICkKICwgX2luZGV4KCAtMSApCiAsIF9kYXRhKCAwICkKIHt9
CgoKCgogICAgdmlydHVhbCB+WUl0ZW0oKSB7fQoKCgoKCiAgICBzdGQ6OnN0cmluZyBsYWJlbCgp
IGNvbnN0IHsgcmV0dXJuIF9sYWJlbDsgfQoKCgoKICAgIHZvaWQgc2V0TGFiZWwoIGNvbnN0IHN0
ZDo6c3RyaW5nICYgbmV3TGFiZWwgKSB7IF9sYWJlbCA9IG5ld0xhYmVsOyB9CgoKCgogICAgc3Rk
OjpzdHJpbmcgaWNvbk5hbWUoKSBjb25zdCB7IHJldHVybiBfaWNvbk5hbWU7IH0KCgoKCiAgICBi
b29sIGhhc0ljb25OYW1lKCkgY29uc3QgeyByZXR1cm4gISBfaWNvbk5hbWUuZW1wdHkoKTsgfQoK
CgoKICAgIHZvaWQgc2V0SWNvbk5hbWUoIGNvbnN0IHN0ZDo6c3RyaW5nICYgbmV3SWNvbk5hbWUg
KSB7IF9pY29uTmFtZSA9IG5ld0ljb25OYW1lOyB9CgoKCgogICAgYm9vbCBzZWxlY3RlZCgpIGNv
bnN0IHsgcmV0dXJuIF9zZWxlY3RlZDsgfQoKCgoKCgogICAgdm9pZCBzZXRTZWxlY3RlZCggYm9v
bCBzZWwgPSB0cnVlICkgeyBfc2VsZWN0ZWQgPSBzZWw7IH0KCgoKCiAgICB2b2lkIHNldEluZGV4
KCBpbnQgaW5kZXggKSB7IF9pbmRleCA9IGluZGV4OyB9CgoKCgogICAgaW50IGluZGV4KCkgY29u
c3QgeyByZXR1cm4gX2luZGV4OyB9CiMgMTM0ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWkt
bGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUl0ZW0uaCIKICAgIHZvaWQgc2V0RGF0YSggdm9pZCAq
IG5ld0RhdGEgKSB7IF9kYXRhID0gbmV3RGF0YTsgfQoKCgoKICAgIHZvaWQgKiBkYXRhKCkgY29u
c3QgeyByZXR1cm4gX2RhdGE7IH0KIyAxNTMgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1s
aWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZSXRlbS5oIgogICAgdmlydHVhbCBib29sIGhhc0NoaWxk
cmVuKCkgY29uc3QgeyByZXR1cm4gZmFsc2U7IH0KIyAxNzIgIi9ob21lL3NoYXJrY3ovbGlieXVp
L2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZSXRlbS5oIgogICAgdmlydHVhbCBZSXRl
bUl0ZXJhdG9yIGNoaWxkcmVuQmVnaW4oKSB7IHJldHVybiBfbm9DaGlsZHJlbi5lbmQoKTsgfQog
ICAgdmlydHVhbCBZSXRlbUNvbnN0SXRlcmF0b3IgY2hpbGRyZW5CZWdpbigpIGNvbnN0IHsgcmV0
dXJuIF9ub0NoaWxkcmVuLmVuZCgpOyB9CgoKCgoKCgogICAgdmlydHVhbCBZSXRlbUl0ZXJhdG9y
IGNoaWxkcmVuRW5kKCkgeyByZXR1cm4gX25vQ2hpbGRyZW4uZW5kKCk7IH0KICAgIHZpcnR1YWwg
WUl0ZW1Db25zdEl0ZXJhdG9yIGNoaWxkcmVuRW5kKCkgY29uc3QgeyByZXR1cm4gX25vQ2hpbGRy
ZW4uZW5kKCk7IH0KCgoKCgoKICAgIHZpcnR1YWwgWUl0ZW0gKiBwYXJlbnQoKSBjb25zdCB7IHJl
dHVybiAwOyB9CgoKcHJpdmF0ZToKCiAgICBzdGQ6OnN0cmluZyBfbGFiZWw7CiAgICBzdGQ6OnN0
cmluZyBfaWNvbk5hbWU7CiAgICBib29sIF9zZWxlY3RlZDsKICAgIGludCBfaW5kZXg7CiAgICB2
b2lkICogX2RhdGE7CgoKCgoKICAgIHN0YXRpYyBZSXRlbUNvbGxlY3Rpb24gX25vQ2hpbGRyZW47
Cn07CiMgMjkgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4x
L3NyYy9ZVHJlZUl0ZW0uaCIgMgojIDM3ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGli
eXVpLW1hc3Rlci0zLjIuMS9zcmMvWVRyZWVJdGVtLmgiCmNsYXNzIFlUcmVlSXRlbTogcHVibGlj
IFlJdGVtCnsKcHVibGljOgoKCgogICAgWVRyZWVJdGVtKCBjb25zdCBzdGQ6OnN0cmluZyAmIGxh
YmVsLAogICAgICAgIGJvb2wgaXNPcGVuID0gZmFsc2UgKTsKCiAgICBZVHJlZUl0ZW0oIGNvbnN0
IHN0ZDo6c3RyaW5nICYgbGFiZWwsCiAgICAgICAgY29uc3Qgc3RkOjpzdHJpbmcgJiBpY29uTmFt
ZSwKICAgICAgICBib29sIGlzT3BlbiA9IGZhbHNlICk7CiMgNTcgIi9ob21lL3NoYXJrY3ovbGli
eXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZVHJlZUl0ZW0uaCIKICAgIFlUcmVl
SXRlbSggWVRyZWVJdGVtICogcGFyZW50LAogICAgICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgbGFi
ZWwsCiAgICAgICAgYm9vbCBpc09wZW4gPSBmYWxzZSApOwoKICAgIFlUcmVlSXRlbSggWVRyZWVJ
dGVtICogcGFyZW50LAogICAgICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgbGFiZWwsCiAgICAgICAg
Y29uc3Qgc3RkOjpzdHJpbmcgJiBpY29uTmFtZSwKICAgICAgICBib29sIGlzT3BlbiA9IGZhbHNl
ICk7CgoKCgoKCiAgICB2aXJ0dWFsIH5ZVHJlZUl0ZW0oKTsKCgoKCgoKICAgIHZpcnR1YWwgYm9v
bCBoYXNDaGlsZHJlbigpIGNvbnN0IHsgcmV0dXJuICEgX2NoaWxkcmVuLmVtcHR5KCk7IH0KCgoK
CgoKICAgIHZpcnR1YWwgWUl0ZW1JdGVyYXRvciBjaGlsZHJlbkJlZ2luKCkgeyByZXR1cm4gX2No
aWxkcmVuLmJlZ2luKCk7IH0KICAgIHZpcnR1YWwgWUl0ZW1Db25zdEl0ZXJhdG9yIGNoaWxkcmVu
QmVnaW4oKSBjb25zdCB7IHJldHVybiBfY2hpbGRyZW4uYmVnaW4oKTsgfQoKCgoKCgogICAgdmly
dHVhbCBZSXRlbUl0ZXJhdG9yIGNoaWxkcmVuRW5kKCkgeyByZXR1cm4gX2NoaWxkcmVuLmVuZCgp
OyB9CiAgICB2aXJ0dWFsIFlJdGVtQ29uc3RJdGVyYXRvciBjaGlsZHJlbkVuZCgpIGNvbnN0IHsg
cmV0dXJuIF9jaGlsZHJlbi5lbmQoKTsgfQojIDEwMyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGli
eXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lUcmVlSXRlbS5oIgogICAgdmlydHVhbCB2b2lk
IGFkZENoaWxkKCBZSXRlbSAqIGl0ZW1fZGlzb3duICk7CgoKCgogICAgdmlydHVhbCB2b2lkIGRl
bGV0ZUNoaWxkcmVuKCk7CiMgMTE3ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVp
LW1hc3Rlci0zLjIuMS9zcmMvWVRyZWVJdGVtLmgiCiAgICBib29sIGlzT3BlbigpIGNvbnN0OwoK
CgoKICAgIHZvaWQgc2V0T3BlbiggYm9vbCBvcGVuICk7CgoKCgoKCiAgICB2aXJ0dWFsIFlUcmVl
SXRlbSAqIHBhcmVudCgpIGNvbnN0IHsgcmV0dXJuIF9wYXJlbnQ7IH0KCnByaXZhdGU6CgogICAg
WVRyZWVJdGVtICogX3BhcmVudDsKICAgIFlJdGVtQ29sbGVjdGlvbiBfY2hpbGRyZW47CiAgICBi
b29sIF9pc09wZW47Cn07CiMgMjkgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWkt
bWFzdGVyLTMuMi4xL3NyYy9ZTWVudUl0ZW0uaCIgMgoKCgoKCgpjbGFzcyBZTWVudUl0ZW06IHB1
YmxpYyBZVHJlZUl0ZW0KewpwdWJsaWM6CgoKCiAgICBZTWVudUl0ZW0oIGNvbnN0IHN0ZDo6c3Ry
aW5nICYgbGFiZWwgKQogOiBZVHJlZUl0ZW0oIGxhYmVsICkKIHt9CgogICAgWU1lbnVJdGVtKCBj
b25zdCBzdGQ6OnN0cmluZyAmIGxhYmVsLAogICAgICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgaWNv
bk5hbWUgKQogOiBZVHJlZUl0ZW0oIGxhYmVsLCBpY29uTmFtZSApCiB7fQojIDU3ICIvaG9tZS9z
aGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWU1lbnVJdGVtLmgi
CiAgICBZTWVudUl0ZW0oIFlNZW51SXRlbSAqIHBhcmVudCwKICAgICAgICBjb25zdCBzdGQ6OnN0
cmluZyAmIGxhYmVsICkKIDogWVRyZWVJdGVtKCBwYXJlbnQsIGxhYmVsICkKIHt9CgogICAgWU1l
bnVJdGVtKCBZTWVudUl0ZW0gKiBwYXJlbnQsCiAgICAgICAgY29uc3Qgc3RkOjpzdHJpbmcgJiBs
YWJlbCwKICAgICAgICBjb25zdCBzdGQ6OnN0cmluZyAmIGljb25OYW1lICkKIDogWVRyZWVJdGVt
KCBwYXJlbnQsIGxhYmVsLCBpY29uTmFtZSApCiB7fQoKCgoKCgogICAgdmlydHVhbCB+WU1lbnVJ
dGVtKCkge30KCgoKCgogICAgWU1lbnVJdGVtICogcGFyZW50KCkgY29uc3QKIHsgcmV0dXJuIGR5
bmFtaWNfY2FzdDxZTWVudUl0ZW0gKj4gKCBZVHJlZUl0ZW06OnBhcmVudCgpICk7IH0KCgpwcml2
YXRlOgoKCgogICAgYm9vbCBpc09wZW4oKSBjb25zdCB7IHJldHVybiBmYWxzZTsgfQogICAgdm9p
ZCBzZXRPcGVuKCBib29sICkge30KfTsKIyAzMiAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVp
LWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lBcHBsaWNhdGlvbi5oIiAyCiMgMSAiL2hvbWUvc2hh
cmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lJY29uTG9hZGVyLmgi
IDEKIyAzMiAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEv
c3JjL1lJY29uTG9hZGVyLmgiCmNsYXNzIFlJY29uTG9hZGVyCnsKcHVibGljOgoKICAgIFlJY29u
TG9hZGVyKCk7CiAgICB+WUljb25Mb2FkZXIoKTsKCiAgICBzdGQ6OnN0cmluZyBmaW5kSWNvbigg
c3RkOjpzdHJpbmcgbmFtZSApOwoKCgoKICAgIHZvaWQgc2V0SWNvbkJhc2VQYXRoKCBzdGQ6OnN0
cmluZyBwYXRoICk7CiAgICBzdGQ6OnN0cmluZyBpY29uQmFzZVBhdGgoKSBjb25zdDsKCiAgICB2
b2lkIGFkZEljb25TZWFyY2hQYXRoKCBzdGQ6OnN0cmluZyBwYXRoICk7Cgpwcml2YXRlOgoKICAg
IHN0ZDo6c3RyaW5nIF9pY29uQmFzZVBhdGg7CiAgICBzdGQ6Omxpc3QgPHN0ZDo6c3RyaW5nPiBp
Y29uX2RpcnM7CgogICAgYm9vbCBmaWxlRXhpc3RzKCBzdGQ6OnN0cmluZyBmbmFtZSApOwp9Owoj
IDMzICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMv
WUFwcGxpY2F0aW9uLmgiIDIKCgoKY2xhc3MgWVdpZGdldDsKY2xhc3MgWVdpZGdldElEOwpjbGFz
cyBZQXBwbGljYXRpb25Qcml2YXRlOwoKCgoKCgpjbGFzcyBZQXBwbGljYXRpb24Kewpwcm90ZWN0
ZWQ6CgogICAgZnJpZW5kIGNsYXNzIFlVSTsKCgoKCgogICAgWUFwcGxpY2F0aW9uKCk7CgoKCgog
ICAgdmlydHVhbCB+WUFwcGxpY2F0aW9uKCk7CgpwdWJsaWM6CiMgNzEgIi9ob21lL3NoYXJrY3ov
bGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZQXBwbGljYXRpb24uaCIKICAg
IFlXaWRnZXQgKiBmaW5kV2lkZ2V0KCBZV2lkZ2V0SUQgKiBpZCwgYm9vbCBkb1Rocm93ID0gdHJ1
ZSApIGNvbnN0OwoKCgoKCgogICAgdmlydHVhbCBzdGQ6OnN0cmluZyBpY29uQmFzZVBhdGgoKSBj
b25zdDsKCgoKCiAgICB2aXJ0dWFsIHZvaWQgc2V0SWNvbkJhc2VQYXRoKCBjb25zdCBzdGQ6OnN0
cmluZyAmIG5ld0ljb25CYXNlUGF0aCApOwoKICAgIFlJY29uTG9hZGVyICppY29uTG9hZGVyKCk7
CiMgMTA3ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9z
cmMvWUFwcGxpY2F0aW9uLmgiCiAgICBpbnQgZGVmYXVsdEZ1bmN0aW9uS2V5KCBjb25zdCBzdGQ6
OnN0cmluZyAmIGxhYmVsICkgY29uc3Q7CgoKCgoKCgogICAgdm9pZCBzZXREZWZhdWx0RnVuY3Rp
b25LZXkoIGNvbnN0IHN0ZDo6c3RyaW5nICYgbGFiZWwsIGludCBma2V5ICk7CgoKCgogICAgdm9p
ZCBjbGVhckRlZmF1bHRGdW5jdGlvbktleXMoKTsKIyAxMzYgIi9ob21lL3NoYXJrY3ovbGlieXVp
L2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZQXBwbGljYXRpb24uaCIKICAgIHZpcnR1
YWwgdm9pZCBzZXRMYW5ndWFnZSggY29uc3Qgc3RkOjpzdHJpbmcgJiBsYW5ndWFnZSwKICAgICAg
ICAgY29uc3Qgc3RkOjpzdHJpbmcgJiBlbmNvZGluZyA9IHN0ZDo6c3RyaW5nKCkgKTsKCgoKCgog
ICAgc3RkOjpzdHJpbmcgbGFuZ3VhZ2UoIGJvb2wgc3RyaXBFbmNvZGluZyA9IGZhbHNlICkgY29u
c3Q7CiMgMTY2ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIu
MS9zcmMvWUFwcGxpY2F0aW9uLmgiCiAgICB2aXJ0dWFsIHN0ZDo6c3RyaW5nIGdseXBoKCBjb25z
dCBzdGQ6OnN0cmluZyAmIGdseXBoU3ltYm9sTmFtZSApOwojIDE4MiAiL2hvbWUvc2hhcmtjei9s
aWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lBcHBsaWNhdGlvbi5oIgogICAg
dmlydHVhbCBzdGQ6OnN0cmluZyBhc2tGb3JFeGlzdGluZ0RpcmVjdG9yeSggY29uc3Qgc3RkOjpz
dHJpbmcgJiBzdGFydERpciwKICAgICAgICAgY29uc3Qgc3RkOjpzdHJpbmcgJiBoZWFkbGluZSAp
ID0gMDsKIyAyMDEgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMu
Mi4xL3NyYy9ZQXBwbGljYXRpb24uaCIKICAgIHZpcnR1YWwgc3RkOjpzdHJpbmcgYXNrRm9yRXhp
c3RpbmdGaWxlKCBjb25zdCBzdGQ6OnN0cmluZyAmIHN0YXJ0V2l0aCwKICAgICAgICAgICBjb25z
dCBzdGQ6OnN0cmluZyAmIGZpbHRlciwKICAgICAgICAgICBjb25zdCBzdGQ6OnN0cmluZyAmIGhl
YWRsaW5lICkgPSAwOwojIDIyMyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1t
YXN0ZXItMy4yLjEvc3JjL1lBcHBsaWNhdGlvbi5oIgogICAgdmlydHVhbCBzdGQ6OnN0cmluZyBh
c2tGb3JTYXZlRmlsZU5hbWUoIGNvbnN0IHN0ZDo6c3RyaW5nICYgc3RhcnRXaXRoLAogICAgICAg
ICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgZmlsdGVyLAogICAgICAgICAgIGNvbnN0IHN0ZDo6c3Ry
aW5nICYgaGVhZGxpbmUgKSA9IDA7CiMgMjM2ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWkt
bGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUFwcGxpY2F0aW9uLmgiCiAgICB2aXJ0dWFsIGJvb2wg
b3BlbkNvbnRleHRNZW51KCBjb25zdCBZSXRlbUNvbGxlY3Rpb24gJiBpdGVtQ29sbGVjdGlvbiAp
OwojIDI0NyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEv
c3JjL1lBcHBsaWNhdGlvbi5oIgogICAgdmlydHVhbCB2b2lkIHNldFByb2R1Y3ROYW1lKCBjb25z
dCBzdGQ6OnN0cmluZyAmIHByb2R1Y3ROYW1lICk7CgoKCgogICAgc3RkOjpzdHJpbmcgcHJvZHVj
dE5hbWUoKSBjb25zdDsKCgoKCgogICAgdm9pZCBzZXRSZWxlYXNlTm90ZXMoIGNvbnN0IHN0ZDo6
bWFwPHN0ZDo6c3RyaW5nLHN0ZDo6c3RyaW5nPiAmIHJlbE5vdGVzICk7CgoKCgogICAgc3RkOjpt
YXA8c3RkOjpzdHJpbmcsc3RkOjpzdHJpbmc+IHJlbGVhc2VOb3RlcygpIGNvbnN0OwoKCgoKICAg
IHZvaWQgc2V0U2hvd1Byb2R1Y3RMb2dvKCBib29sIHNob3cgKTsKCgoKCiAgICBib29sIHNob3dQ
cm9kdWN0TG9nbygpIGNvbnN0OwoKCgoKCgoKICAgIHZpcnR1YWwgaW50IGRldmljZVVuaXRzKCBZ
VUlEaW1lbnNpb24gZGltLCBmbG9hdCBsYXlvdXRVbml0cyApOwoKCgoKCgoKICAgIHZpcnR1YWwg
ZmxvYXQgbGF5b3V0VW5pdHMoIFlVSURpbWVuc2lvbiBkaW0sIGludCBkZXZpY2VVbml0cyApOwoK
CgoKCgoKICAgIHZpcnR1YWwgdm9pZCBzZXRSZXZlcnNlTGF5b3V0KCBib29sIHJldmVyc2UgKTsK
CgoKCgogICAgYm9vbCByZXZlcnNlTGF5b3V0KCkgY29uc3Q7CgoKCgoKICAgIHZpcnR1YWwgdm9p
ZCBidXN5Q3Vyc29yKCkge30KCgoKCgogICAgdmlydHVhbCB2b2lkIG5vcm1hbEN1cnNvcigpIHt9
CgoKCgoKICAgIHZpcnR1YWwgdm9pZCBtYWtlU2NyZWVuU2hvdCggY29uc3Qgc3RkOjpzdHJpbmcg
JiBmaWxlTmFtZSApIHt9CgoKCgoKICAgIHZpcnR1YWwgdm9pZCBiZWVwKCkge30KIyAzMzggIi9o
b21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZQXBwbGlj
YXRpb24uaCIKICAgIHZpcnR1YWwgdm9pZCByZWRyYXdTY3JlZW4oKSB7fQoKCgoKCiAgICB2aXJ0
dWFsIHZvaWQgaW5pdENvbnNvbGVLZXlib2FyZCgpIHt9CgoKCgoKCgogICAgdmlydHVhbCB2b2lk
IHNldENvbnNvbGVGb250KCBjb25zdCBzdGQ6OnN0cmluZyAmIGNvbnNvbGVfbWFnaWMsCiAgICAg
Y29uc3Qgc3RkOjpzdHJpbmcgJiBmb250LAogICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgc2NyZWVu
X21hcCwKICAgICBjb25zdCBzdGQ6OnN0cmluZyAmIHVuaWNvZGVfbWFwLAogICAgIGNvbnN0IHN0
ZDo6c3RyaW5nICYgbGFuZ3VhZ2UgKQoge30KIyAzNjkgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xp
Ynl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZQXBwbGljYXRpb24uaCIKICAgIHZpcnR1YWwg
aW50IHJ1bkluVGVybWluYWwoIGNvbnN0IHN0ZDo6c3RyaW5nICYgY29tbWFuZCApOwojIDM3OSAi
L2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lBcHBs
aWNhdGlvbi5oIgogICAgdmlydHVhbCB2b2lkIG9wZW5VSSgpIHt9CiAgICB2aXJ0dWFsIHZvaWQg
Y2xvc2VVSSgpIHt9CiMgMzkzICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1h
c3Rlci0zLjIuMS9zcmMvWUFwcGxpY2F0aW9uLmgiCiAgICB2aXJ0dWFsIGludCBkaXNwbGF5V2lk
dGgoKSA9IDA7CiAgICB2aXJ0dWFsIGludCBkaXNwbGF5SGVpZ2h0KCkgPSAwOwogICAgdmlydHVh
bCBpbnQgZGlzcGxheURlcHRoKCkgPSAwOwogICAgdmlydHVhbCBsb25nIGRpc3BsYXlDb2xvcnMo
KSA9IDA7CgoKICAgIHZpcnR1YWwgaW50IGRlZmF1bHRXaWR0aCgpID0gMDsKICAgIHZpcnR1YWwg
aW50IGRlZmF1bHRIZWlnaHQoKSA9IDA7CgoKCgoKICAgIHZpcnR1YWwgYm9vbCBpc1RleHRNb2Rl
KCkgPSAwOwogICAgdmlydHVhbCBib29sIGhhc0ltYWdlU3VwcG9ydCgpID0gMDsKICAgIHZpcnR1
YWwgYm9vbCBoYXNJY29uU3VwcG9ydCgpID0gMDsKICAgIHZpcnR1YWwgYm9vbCBoYXNBbmltYXRp
b25TdXBwb3J0KCkgPSAwOwogICAgdmlydHVhbCBib29sIGhhc0Z1bGxVdGY4U3VwcG9ydCgpID0g
MDsKICAgIHZpcnR1YWwgYm9vbCByaWNoVGV4dFN1cHBvcnRzVGFibGUoKSA9IDA7CiAgICB2aXJ0
dWFsIGJvb2wgbGVmdEhhbmRlZE1vdXNlKCkgPSAwOwogICAgdmlydHVhbCBib29sIGhhc1dpemFy
ZERpYWxvZ1N1cHBvcnQoKSB7IHJldHVybiBmYWxzZTsgfQoKCgoKCiAgICB2aXJ0dWFsIHZvaWQg
c2V0QXBwbGljYXRpb25UaXRsZSAoIGNvbnN0IHN0ZDo6c3RyaW5nJiB0aXRsZSApOwoKCgoKCgog
ICAgdmlydHVhbCBjb25zdCBzdGQ6OnN0cmluZyYgYXBwbGljYXRpb25UaXRsZSgpIGNvbnN0OwoK
CgoKICAgIHZpcnR1YWwgdm9pZCBzZXRBcHBsaWNhdGlvbkljb24gKCBjb25zdCBzdGQ6OnN0cmlu
ZyYgaWNvbiApOwoKCgoKCgogICAgIHZpcnR1YWwgY29uc3Qgc3RkOjpzdHJpbmcmIGFwcGxpY2F0
aW9uSWNvbigpIGNvbnN0OwoKcHJpdmF0ZToKCiAgICBJbXBsUHRyPFlBcHBsaWNhdGlvblByaXZh
dGU+IHByaXY7Cgp9OwojIDQwICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1h
c3Rlci0zLjIuMS9zcmMvWURpYWxvZy5jYyIgMgojIDEgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xp
Ynl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2lkZ2V0RmFjdG9yeS5oIiAxCiMgMzMgIi9o
b21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2lkZ2V0
RmFjdG9yeS5oIgpjbGFzcyBZV2lkZ2V0OwpjbGFzcyBZQWxpZ25tZW50OwpjbGFzcyBZQnV0dG9u
Qm94OwpjbGFzcyBZQ2hlY2tCb3g7CmNsYXNzIFlDaGVja0JveEZyYW1lOwpjbGFzcyBZQ29tYm9C
b3g7CmNsYXNzIFlEaWFsb2c7CmNsYXNzIFlFbXB0eTsKY2xhc3MgWUZyYW1lOwpjbGFzcyBZSW1h
Z2U7CmNsYXNzIFlJbnB1dEZpZWxkOwpjbGFzcyBZSW50RmllbGQ7CmNsYXNzIFlMYWJlbDsKY2xh
c3MgWUxheW91dEJveDsKY2xhc3MgWUxvZ1ZpZXc7CmNsYXNzIFlNZW51QnV0dG9uOwpjbGFzcyBZ
TXVsdGlMaW5lRWRpdDsKY2xhc3MgWU11bHRpU2VsZWN0aW9uQm94OwpjbGFzcyBZUGFja2FnZVNl
bGVjdG9yOwpjbGFzcyBZUHJvZ3Jlc3NCYXI7CmNsYXNzIFlQdXNoQnV0dG9uOwpjbGFzcyBZUmFk
aW9CdXR0b247CmNsYXNzIFlSYWRpb0J1dHRvbkdyb3VwOwpjbGFzcyBZUmVwbGFjZVBvaW50Owpj
bGFzcyBZUmljaFRleHQ7CmNsYXNzIFlTZWxlY3Rpb25Cb3g7CmNsYXNzIFlTcGFjaW5nOwpjbGFz
cyBZU3F1YXNoOwpjbGFzcyBZVGFibGU7CmNsYXNzIFlUYWJsZUhlYWRlcjsKY2xhc3MgWVRpbWVG
aWVsZDsKY2xhc3MgWVRyZWU7CmNsYXNzIFlCdXN5SW5kaWNhdG9yOwojIDc2ICIvaG9tZS9zaGFy
a2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVdpZGdldEZhY3Rvcnku
aCIKY2xhc3MgWVdpZGdldEZhY3RvcnkKewpwdWJsaWM6CgoKCgoKICAgIFlEaWFsb2cgKiBjcmVh
dGVNYWluRGlhbG9nICggWURpYWxvZ0NvbG9yTW9kZSBjb2xvck1vZGUgPSBZRGlhbG9nTm9ybWFs
Q29sb3IgKTsKICAgIFlEaWFsb2cgKiBjcmVhdGVQb3B1cERpYWxvZyAoIFlEaWFsb2dDb2xvck1v
ZGUgY29sb3JNb2RlID0gWURpYWxvZ05vcm1hbENvbG9yICk7CiAgICB2aXJ0dWFsIFlEaWFsb2cg
KiBjcmVhdGVEaWFsb2cgKCBZRGlhbG9nVHlwZSBkaWFsb2dUeXBlLCBZRGlhbG9nQ29sb3JNb2Rl
IGNvbG9yTW9kZSA9IFlEaWFsb2dOb3JtYWxDb2xvciApID0gMDsKCgoKCgogICAgWUxheW91dEJv
eCAqIGNyZWF0ZVZCb3ggKCBZV2lkZ2V0ICogcGFyZW50ICk7CiAgICBZTGF5b3V0Qm94ICogY3Jl
YXRlSEJveCAoIFlXaWRnZXQgKiBwYXJlbnQgKTsKICAgIHZpcnR1YWwgWUxheW91dEJveCAqIGNy
ZWF0ZUxheW91dEJveCAoIFlXaWRnZXQgKiBwYXJlbnQsIFlVSURpbWVuc2lvbiBkaW1lbnNpb24g
KSA9IDA7CiAgICB2aXJ0dWFsIFlCdXR0b25Cb3ggKiBjcmVhdGVCdXR0b25Cb3ggKCBZV2lkZ2V0
ICogcGFyZW50ICkgPSAwOwoKCgoKCiAgICB2aXJ0dWFsIFlQdXNoQnV0dG9uICogY3JlYXRlUHVz
aEJ1dHRvbiAoIFlXaWRnZXQgKiBwYXJlbnQsIGNvbnN0IHN0ZDo6c3RyaW5nICYgbGFiZWwgKSA9
IDA7CiAgICB2aXJ0dWFsIFlMYWJlbCAqIGNyZWF0ZUxhYmVsICggWVdpZGdldCAqIHBhcmVudCwg
Y29uc3Qgc3RkOjpzdHJpbmcgJiB0ZXh0LCBib29sIGlzSGVhZGluZyA9IGZhbHNlLCBib29sIGlz
T3V0cHV0RmllbGQgPSBmYWxzZSApID0gMDsKICAgIFlMYWJlbCAqIGNyZWF0ZUhlYWRpbmcgKCBZ
V2lkZ2V0ICogcGFyZW50LCBjb25zdCBzdGQ6OnN0cmluZyAmIGxhYmVsICk7CiAgICB2aXJ0dWFs
IFlJbnB1dEZpZWxkICogY3JlYXRlSW5wdXRGaWVsZCAoIFlXaWRnZXQgKiBwYXJlbnQsIGNvbnN0
IHN0ZDo6c3RyaW5nICYgbGFiZWwsIGJvb2wgcGFzc3dvcmRNb2RlID0gZmFsc2UgKSA9IDA7CiAg
ICB2aXJ0dWFsIFlDaGVja0JveCAqIGNyZWF0ZUNoZWNrQm94ICggWVdpZGdldCAqIHBhcmVudCwg
Y29uc3Qgc3RkOjpzdHJpbmcgJiBsYWJlbCwgYm9vbCBpc0NoZWNrZWQgPSBmYWxzZSApID0gMDsK
ICAgIHZpcnR1YWwgWVJhZGlvQnV0dG9uICogY3JlYXRlUmFkaW9CdXR0b24gKCBZV2lkZ2V0ICog
cGFyZW50LCBjb25zdCBzdGQ6OnN0cmluZyAmIGxhYmVsLCBib29sIGlzQ2hlY2tlZCA9IGZhbHNl
ICkgPSAwOwogICAgdmlydHVhbCBZQ29tYm9Cb3ggKiBjcmVhdGVDb21ib0JveCAoIFlXaWRnZXQg
KiBwYXJlbnQsIGNvbnN0IHN0ZDo6c3RyaW5nICYgbGFiZWwsIGJvb2wgZWRpdGFibGUgPSBmYWxz
ZSApID0gMDsKICAgIHZpcnR1YWwgWVNlbGVjdGlvbkJveCAqIGNyZWF0ZVNlbGVjdGlvbkJveCAo
IFlXaWRnZXQgKiBwYXJlbnQsIGNvbnN0IHN0ZDo6c3RyaW5nICYgbGFiZWwgKSA9IDA7CiAgICB2
aXJ0dWFsIFlUcmVlICogY3JlYXRlVHJlZSAoIFlXaWRnZXQgKiBwYXJlbnQsIGNvbnN0IHN0ZDo6
c3RyaW5nICYgbGFiZWwsIGJvb2wgbXVsdGlzZWxlY3Rpb24gPSBmYWxzZSwgYm9vbCByZWN1cnNp
dmVzZWxlY3Rpb24gPSBmYWxzZSApID0gMDsKICAgIHZpcnR1YWwgWVRhYmxlICogY3JlYXRlVGFi
bGUgKCBZV2lkZ2V0ICogcGFyZW50LCBZVGFibGVIZWFkZXIgKiBoZWFkZXJfZGlzb3duLCBib29s
IG11bHRpU2VsZWN0aW9uID0gZmFsc2UgKSA9IDA7CiAgICB2aXJ0dWFsIFlQcm9ncmVzc0JhciAq
IGNyZWF0ZVByb2dyZXNzQmFyICggWVdpZGdldCAqIHBhcmVudCwgY29uc3Qgc3RkOjpzdHJpbmcg
JiBsYWJlbCwgaW50IG1heFZhbHVlID0gMTAwICkgPSAwOwogICAgdmlydHVhbCBZUmljaFRleHQg
KiBjcmVhdGVSaWNoVGV4dCAoIFlXaWRnZXQgKiBwYXJlbnQsIGNvbnN0IHN0ZDo6c3RyaW5nICYg
dGV4dCA9IHN0ZDo6c3RyaW5nKCksIGJvb2wgcGxhaW5UZXh0TW9kZSA9IGZhbHNlICkgPSAwOwog
ICAgdmlydHVhbCBZQnVzeUluZGljYXRvciAqIGNyZWF0ZUJ1c3lJbmRpY2F0b3IgKCBZV2lkZ2V0
ICogcGFyZW50LCBjb25zdCBzdGQ6OnN0cmluZyAmIGxhYmVsLCBpbnQgdGltZW91dCA9IDEwMDAg
KSA9IDA7CgoKCgoKICAgIFlQdXNoQnV0dG9uICogY3JlYXRlSWNvbkJ1dHRvbiAoIFlXaWRnZXQg
KiBwYXJlbnQsIGNvbnN0IHN0ZDo6c3RyaW5nICYgaWNvbk5hbWUsIGNvbnN0IHN0ZDo6c3RyaW5n
ICYgZmFsbGJhY2tUZXh0TGFiZWwgKTsKICAgIFlMYWJlbCAqIGNyZWF0ZU91dHB1dEZpZWxkICgg
WVdpZGdldCAqIHBhcmVudCwgY29uc3Qgc3RkOjpzdHJpbmcgJiBsYWJlbCApOwogICAgdmlydHVh
bCBZSW50RmllbGQgKiBjcmVhdGVJbnRGaWVsZCAoIFlXaWRnZXQgKiBwYXJlbnQsIGNvbnN0IHN0
ZDo6c3RyaW5nICYgbGFiZWwsIGludCBtaW5WYWwsIGludCBtYXhWYWwsIGludCBpbml0aWFsVmFs
ICkgPSAwOwogICAgWUlucHV0RmllbGQgKiBjcmVhdGVQYXNzd29yZEZpZWxkICggWVdpZGdldCAq
IHBhcmVudCwgY29uc3Qgc3RkOjpzdHJpbmcgJiBsYWJlbCApOwoKICAgIHZpcnR1YWwgWU1lbnVC
dXR0b24gKiBjcmVhdGVNZW51QnV0dG9uICggWVdpZGdldCAqIHBhcmVudCwgY29uc3Qgc3RkOjpz
dHJpbmcgJiBsYWJlbCApID0gMDsKICAgIHZpcnR1YWwgWU11bHRpTGluZUVkaXQgKiBjcmVhdGVN
dWx0aUxpbmVFZGl0ICggWVdpZGdldCAqIHBhcmVudCwgY29uc3Qgc3RkOjpzdHJpbmcgJiBsYWJl
bCApID0gMDsKICAgIHZpcnR1YWwgWUltYWdlICogY3JlYXRlSW1hZ2UgKCBZV2lkZ2V0ICogcGFy
ZW50LCBjb25zdCBzdGQ6OnN0cmluZyAmIGltYWdlRmlsZU5hbWUsIGJvb2wgYW5pbWF0ZWQgPSBm
YWxzZSApID0gMDsKICAgIHZpcnR1YWwgWUxvZ1ZpZXcgKiBjcmVhdGVMb2dWaWV3ICggWVdpZGdl
dCAqIHBhcmVudCwgY29uc3Qgc3RkOjpzdHJpbmcgJiBsYWJlbCwgaW50IHZpc2libGVMaW5lcywg
aW50IHN0b3JlZExpbmVzID0gMCApID0gMDsKICAgIHZpcnR1YWwgWU11bHRpU2VsZWN0aW9uQm94
ICpjcmVhdGVNdWx0aVNlbGVjdGlvbkJveCAoIFlXaWRnZXQgKiBwYXJlbnQsIGNvbnN0IHN0ZDo6
c3RyaW5nICYgbGFiZWwgKSA9IDA7CgogICAgdmlydHVhbCBZUGFja2FnZVNlbGVjdG9yICogY3Jl
YXRlUGFja2FnZVNlbGVjdG9yICggWVdpZGdldCAqIHBhcmVudCwgbG9uZyBNb2RlRmxhZ3MgPSAw
ICkgPSAwOwogICAgdmlydHVhbCBZV2lkZ2V0ICogY3JlYXRlUGtnU3BlY2lhbCAoIFlXaWRnZXQg
KiBwYXJlbnQsIGNvbnN0IHN0ZDo6c3RyaW5nICYgc3Vid2lkZ2V0TmFtZSApID0gMDsKCgoKCgog
ICAgWVNwYWNpbmcgKiBjcmVhdGVIU3RyZXRjaCAoIFlXaWRnZXQgKiBwYXJlbnQgKTsKICAgIFlT
cGFjaW5nICogY3JlYXRlVlN0cmV0Y2ggKCBZV2lkZ2V0ICogcGFyZW50ICk7CiAgICBZU3BhY2lu
ZyAqIGNyZWF0ZUhTcGFjaW5nICggWVdpZGdldCAqIHBhcmVudCwgWUxheW91dFNpemVfdCBzaXpl
ID0gMS4wICk7CiAgICBZU3BhY2luZyAqIGNyZWF0ZVZTcGFjaW5nICggWVdpZGdldCAqIHBhcmVu
dCwgWUxheW91dFNpemVfdCBzaXplID0gMS4wICk7CiAgICB2aXJ0dWFsIFlTcGFjaW5nICogY3Jl
YXRlU3BhY2luZyAoIFlXaWRnZXQgKiBwYXJlbnQsIFlVSURpbWVuc2lvbiBkaW0sIGJvb2wgc3Ry
ZXRjaGFibGUgPSBmYWxzZSwgWUxheW91dFNpemVfdCBzaXplID0gMC4wICkgPSAwOwogICAgdmly
dHVhbCBZRW1wdHkgKiBjcmVhdGVFbXB0eSAoIFlXaWRnZXQgKiBwYXJlbnQgKSA9IDA7CgogICAg
WUFsaWdubWVudCAqIGNyZWF0ZUxlZnQgKCBZV2lkZ2V0ICogcGFyZW50ICk7CiAgICBZQWxpZ25t
ZW50ICogY3JlYXRlUmlnaHQgKCBZV2lkZ2V0ICogcGFyZW50ICk7CiAgICBZQWxpZ25tZW50ICog
Y3JlYXRlVG9wICggWVdpZGdldCAqIHBhcmVudCApOwogICAgWUFsaWdubWVudCAqIGNyZWF0ZUJv
dHRvbSAoIFlXaWRnZXQgKiBwYXJlbnQgKTsKICAgIFlBbGlnbm1lbnQgKiBjcmVhdGVIQ2VudGVy
ICggWVdpZGdldCAqIHBhcmVudCApOwogICAgWUFsaWdubWVudCAqIGNyZWF0ZVZDZW50ZXIgKCBZ
V2lkZ2V0ICogcGFyZW50ICk7CiAgICBZQWxpZ25tZW50ICogY3JlYXRlSFZDZW50ZXIgKCBZV2lk
Z2V0ICogcGFyZW50ICk7CgogICAgWUFsaWdubWVudCAqIGNyZWF0ZU1hcmdpbkJveCAoIFlXaWRn
ZXQgKiBwYXJlbnQsIFlMYXlvdXRTaXplX3QgaG9yTWFyZ2luLCBZTGF5b3V0U2l6ZV90IHZlcnRN
YXJnaW4gKTsKICAgIFlBbGlnbm1lbnQgKiBjcmVhdGVNYXJnaW5Cb3ggKCBZV2lkZ2V0ICogcGFy
ZW50LAogICAgICAgICBZTGF5b3V0U2l6ZV90IGxlZnRNYXJnaW4sIFlMYXlvdXRTaXplX3Qgcmln
aHRNYXJnaW4sCiAgICAgICAgIFlMYXlvdXRTaXplX3QgdG9wTWFyZ2luLCBZTGF5b3V0U2l6ZV90
IGJvdHRvbU1hcmdpbiApOwoKICAgIFlBbGlnbm1lbnQgKiBjcmVhdGVNaW5XaWR0aCAoIFlXaWRn
ZXQgKiBwYXJlbnQsIFlMYXlvdXRTaXplX3QgbWluV2lkdGggKTsKICAgIFlBbGlnbm1lbnQgKiBj
cmVhdGVNaW5IZWlnaHQgKCBZV2lkZ2V0ICogcGFyZW50LCBZTGF5b3V0U2l6ZV90IG1pbkhlaWdo
dCApOwogICAgWUFsaWdubWVudCAqIGNyZWF0ZU1pblNpemUgKCBZV2lkZ2V0ICogcGFyZW50LCBZ
TGF5b3V0U2l6ZV90IG1pbldpZHRoLCBZTGF5b3V0U2l6ZV90IG1pbkhlaWdodCApOwoKICAgIHZp
cnR1YWwgWUFsaWdubWVudCAqIGNyZWF0ZUFsaWdubWVudCAoIFlXaWRnZXQgKiBwYXJlbnQsIFlB
bGlnbm1lbnRUeXBlIGhvckFsaWdubWVudCwgWUFsaWdubWVudFR5cGUgdmVydEFsaWdubWVudCAp
ID0gMDsKCiAgICBZU3F1YXNoICogY3JlYXRlSFNxdWFzaCAoIFlXaWRnZXQgKiBwYXJlbnQgKTsK
ICAgIFlTcXVhc2ggKiBjcmVhdGVWU3F1YXNoICggWVdpZGdldCAqIHBhcmVudCApOwogICAgWVNx
dWFzaCAqIGNyZWF0ZUhWU3F1YXNoICggWVdpZGdldCAqIHBhcmVudCApOwogICAgdmlydHVhbCBZ
U3F1YXNoICogY3JlYXRlU3F1YXNoICggWVdpZGdldCAqIHBhcmVudCwgYm9vbCBob3JTcXVhc2gs
IGJvb2wgdmVydFNxdWFzaCApID0gMDsKCgoKCgogICAgdmlydHVhbCBZRnJhbWUgKiBjcmVhdGVG
cmFtZSAoIFlXaWRnZXQgKiBwYXJlbnQsIGNvbnN0IHN0ZDo6c3RyaW5nICYgbGFiZWwgKSA9IDA7
CiAgICB2aXJ0dWFsIFlDaGVja0JveEZyYW1lICogY3JlYXRlQ2hlY2tCb3hGcmFtZSAoIFlXaWRn
ZXQgKiBwYXJlbnQsIGNvbnN0IHN0ZDo6c3RyaW5nICYgbGFiZWwsIGJvb2wgY2hlY2tlZCApID0g
MDsKCgoKCgogICAgdmlydHVhbCBZUmFkaW9CdXR0b25Hcm91cCAqIGNyZWF0ZVJhZGlvQnV0dG9u
R3JvdXAgKCBZV2lkZ2V0ICogcGFyZW50ICkgPSAwOwogICAgdmlydHVhbCBZUmVwbGFjZVBvaW50
ICogY3JlYXRlUmVwbGFjZVBvaW50ICggWVdpZGdldCAqIHBhcmVudCApID0gMDsKCgpwcm90ZWN0
ZWQ6CgogICAgZnJpZW5kIGNsYXNzIFlVSTsKCgoKCgoKICAgIFlXaWRnZXRGYWN0b3J5KCk7CgoK
CgogICAgdmlydHVhbCB+WVdpZGdldEZhY3RvcnkoKTsKCn07CiMgNDEgIi9ob21lL3NoYXJrY3ov
bGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIiAyCiMgMSAi
L2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lPcHRp
b25hbFdpZGdldEZhY3RvcnkuaCIgMQojIDMzICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWkt
bGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWU9wdGlvbmFsV2lkZ2V0RmFjdG9yeS5oIgojIDEgIi9o
b21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2l6YXJk
LmgiIDEKIyAzMCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4y
LjEvc3JjL1lXaXphcmQuaCIKY2xhc3MgWU1hY3JvUmVjb3JkZXI7CmNsYXNzIFlXaXphcmRQcml2
YXRlOwpjbGFzcyBZUHVzaEJ1dHRvbjsKY2xhc3MgWVJlcGxhY2VQb2ludDsKCgoKCgplbnVtIFlX
aXphcmRNb2RlCnsKICAgIFlXaXphcmRNb2RlX1N0YW5kYXJkLAogICAgWVdpemFyZE1vZGVfU3Rl
cHMsCiAgICBZV2l6YXJkTW9kZV9UcmVlLAogICAgWVdpemFyZE1vZGVfVGl0bGVPbkxlZnQKfTsK
IyA5MyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3Jj
L1lXaXphcmQuaCIKY2xhc3MgWVdpemFyZDogcHVibGljIFlXaWRnZXQKewpwcm90ZWN0ZWQ6CgoK
CgoKICAgIFlXaXphcmQoIFlXaWRnZXQgKiBwYXJlbnQsCiAgICAgIGNvbnN0IHN0ZDo6c3RyaW5n
ICYgYmFja0J1dHRvbkxhYmVsLAogICAgICBjb25zdCBzdGQ6OnN0cmluZyAmIGFib3J0QnV0dG9u
TGFiZWwsCiAgICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgbmV4dEJ1dHRvbkxhYmVsLAogICAgICBZ
V2l6YXJkTW9kZSB3aXphcmRNb2RlID0gWVdpemFyZE1vZGVfU3RhbmRhcmQgKTsKCnB1YmxpYzoK
CgoKCiAgICB2aXJ0dWFsIH5ZV2l6YXJkKCk7CgoKCgoKICAgIHZpcnR1YWwgY29uc3QgY2hhciAq
IHdpZGdldENsYXNzKCkgY29uc3QgeyByZXR1cm4gIllXaXphcmQiOyB9CiMgMTI5ICIvaG9tZS9z
aGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVdpemFyZC5oIgog
ICAgWVdpemFyZE1vZGUgd2l6YXJkTW9kZSgpIGNvbnN0OwoKCgoKCgogICAgdmlydHVhbCBZUHVz
aEJ1dHRvbiAqIGJhY2tCdXR0b24oKSBjb25zdCA9IDA7CiAgICB2aXJ0dWFsIFlQdXNoQnV0dG9u
ICogYWJvcnRCdXR0b24oKSBjb25zdCA9IDA7CiAgICB2aXJ0dWFsIFlQdXNoQnV0dG9uICogbmV4
dEJ1dHRvbigpIGNvbnN0ID0gMDsKCgoKCgoKICAgIHZpcnR1YWwgWVJlcGxhY2VQb2ludCAqIGNv
bnRlbnRzUmVwbGFjZVBvaW50KCkgY29uc3QgPSAwOwoKCgoKICAgIHZvaWQgcHJvdGVjdE5leHRC
dXR0b24oIGJvb2wgcHJvdGVjdCApOwoKCgoKCiAgICBib29sIG5leHRCdXR0b25Jc1Byb3RlY3Rl
ZCgpIGNvbnN0OwoKCgoKCgoKICAgIHZpcnR1YWwgdm9pZCBzZXRCdXR0b25MYWJlbCggWVB1c2hC
dXR0b24gKiBidXR0b24sIGNvbnN0IHN0ZDo6c3RyaW5nICYgbmV3TGFiZWwgKTsKCgoKCiAgICB2
aXJ0dWFsIHZvaWQgc2V0SGVscFRleHQoIGNvbnN0IHN0ZDo6c3RyaW5nICYgaGVscFRleHQgKSA9
IDA7CgoKCgogICAgdmlydHVhbCB2b2lkIHNldERpYWxvZ0ljb24oIGNvbnN0IHN0ZDo6c3RyaW5n
ICYgaWNvbk5hbWUgKSA9IDA7CgoKCgoKICAgIHZpcnR1YWwgdm9pZCBzZXREaWFsb2dUaXRsZSgg
Y29uc3Qgc3RkOjpzdHJpbmcgJiB0aXRsZVRleHQgKSA9IDA7CgoKCgogICAgdmlydHVhbCB2b2lk
IHNldERpYWxvZ0hlYWRpbmcoIGNvbnN0IHN0ZDo6c3RyaW5nICYgaGVhZGluZ1RleHQgKSA9IDA7
CiMgMTk3ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9z
cmMvWVdpemFyZC5oIgogICAgdmlydHVhbCB2b2lkIGFkZFN0ZXAoIGNvbnN0IHN0ZDo6c3RyaW5n
ICYgdGV4dCwgY29uc3Qgc3RkOjpzdHJpbmcgJiBpZCApID0gMDsKCgoKCgoKICAgIHZpcnR1YWwg
dm9pZCBhZGRTdGVwSGVhZGluZyggY29uc3Qgc3RkOjpzdHJpbmcgJiB0ZXh0ICkgPSAwOwoKCgoK
CiAgICB2aXJ0dWFsIHZvaWQgZGVsZXRlU3RlcHMoKSA9IDA7CgoKCgogICAgdmlydHVhbCB2b2lk
IHNldEN1cnJlbnRTdGVwKCBjb25zdCBzdGQ6OnN0cmluZyAmIGlkICkgPSAwOwoKCgoKCiAgICB2
aXJ0dWFsIHZvaWQgdXBkYXRlU3RlcHMoKSA9IDA7CiMgMjM0ICIvaG9tZS9zaGFya2N6L2xpYnl1
aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVdpemFyZC5oIgogICAgdmlydHVhbCB2
b2lkIGFkZFRyZWVJdGVtKCBjb25zdCBzdGQ6OnN0cmluZyAmIHBhcmVudElELAogICAgICAgICBj
b25zdCBzdGQ6OnN0cmluZyAmIHRleHQsCiAgICAgICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgaWQg
KSA9IDA7CgoKCgogICAgdmlydHVhbCB2b2lkIHNlbGVjdFRyZWVJdGVtKCBjb25zdCBzdGQ6OnN0
cmluZyAmIGlkICkgPSAwOwoKCgoKCiAgICB2aXJ0dWFsIHN0ZDo6c3RyaW5nIGN1cnJlbnRUcmVl
U2VsZWN0aW9uKCkgPSAwOwoKCgoKICAgIHZpcnR1YWwgdm9pZCBkZWxldGVUcmVlSXRlbXMoKSA9
IDA7CiMgMjY1ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIu
MS9zcmMvWVdpemFyZC5oIgogICAgdmlydHVhbCB2b2lkIGFkZE1lbnUoIGNvbnN0IHN0ZDo6c3Ry
aW5nICYgdGV4dCwKICAgICBjb25zdCBzdGQ6OnN0cmluZyAmIGlkICkgPSAwOwoKCgoKICAgIHZp
cnR1YWwgdm9pZCBhZGRTdWJNZW51KCBjb25zdCBzdGQ6OnN0cmluZyAmIHBhcmVudE1lbnVJRCwK
ICAgICAgICBjb25zdCBzdGQ6OnN0cmluZyAmIHRleHQsCiAgICAgICAgY29uc3Qgc3RkOjpzdHJp
bmcgJiBpZCApID0gMDsKCgoKCgogICAgdmlydHVhbCB2b2lkIGFkZE1lbnVFbnRyeSggY29uc3Qg
c3RkOjpzdHJpbmcgJiBwYXJlbnRNZW51SUQsCiAgICAgICAgICBjb25zdCBzdGQ6OnN0cmluZyAm
IHRleHQsCiAgICAgICAgICBjb25zdCBzdGQ6OnN0cmluZyAmIGlkICkgPSAwOwoKCgoKICAgIHZp
cnR1YWwgdm9pZCBhZGRNZW51U2VwYXJhdG9yKCBjb25zdCBzdGQ6OnN0cmluZyAmIHBhcmVudE1l
bnVJRCApID0gMDsKCgoKCiAgICB2aXJ0dWFsIHZvaWQgZGVsZXRlTWVudXMoKSA9IDA7CgoKCgoK
CiAgICB2aXJ0dWFsIHZvaWQgc2hvd1JlbGVhc2VOb3Rlc0J1dHRvbiggY29uc3Qgc3RkOjpzdHJp
bmcgJiBsYWJlbCwKICAgICAgY29uc3Qgc3RkOjpzdHJpbmcgJiBpZCApID0gMDsKIyAzMDggIi9o
b21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZV2l6YXJk
LmgiCiAgICB2aXJ0dWFsIHZvaWQgaGlkZVJlbGVhc2VOb3Rlc0J1dHRvbigpID0gMDsKCgoKCgoK
CiAgICB2aXJ0dWFsIHZvaWQgcmV0cmFuc2xhdGVJbnRlcm5hbEJ1dHRvbnMoKSA9IDA7CgoKCgog
ICAgdm9pZCBwaW5nKCk7CiMgMzM0ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVp
LW1hc3Rlci0zLjIuMS9zcmMvWVdpemFyZC5oIgogICAgdmlydHVhbCBZUHJvcGVydHlWYWx1ZSBn
ZXRQcm9wZXJ0eSggY29uc3Qgc3RkOjpzdHJpbmcgJiBwcm9wZXJ0eU5hbWUgKTsKCgoKCgoKCiAg
ICB2aXJ0dWFsIGNvbnN0IFlQcm9wZXJ0eVNldCAmIHByb3BlcnR5U2V0KCk7CgoKcHJpdmF0ZToK
CiAgICBJbXBsUHRyPFlXaXphcmRQcml2YXRlPiBwcml2Owp9OwojIDM0ICIvaG9tZS9zaGFya2N6
L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWU9wdGlvbmFsV2lkZ2V0RmFj
dG9yeS5oIiAyCiMgMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXIt
My4yLjEvc3JjL1lHcmFwaC5oIiAxCiMgNDAgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1s
aWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZR3JhcGguaCIKY2xhc3MgWUdyYXBoUHJpdmF0ZTsKCgpj
bGFzcyBZR3JhcGggOiBwdWJsaWMgWVdpZGdldAp7CnByb3RlY3RlZDoKIyA1NSAiL2hvbWUvc2hh
cmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lHcmFwaC5oIgogICAg
WUdyYXBoKCBZV2lkZ2V0ICogcGFyZW50LCBjb25zdCBzdGQ6OnN0cmluZyAmIGZpbGVuYW1lLCBj
b25zdCBzdGQ6OnN0cmluZyAmIGxheW91dEFsZ29yaXRobSApOwoKCgoKCgogICAgWUdyYXBoKCBZ
V2lkZ2V0ICogcGFyZW50LCB2b2lkICogZ3JhcGggKTsKCnB1YmxpYzoKCgoKCiAgICB2aXJ0dWFs
IH5ZR3JhcGgoKTsKCgoKCgogICAgdmlydHVhbCBjb25zdCBjaGFyICogd2lkZ2V0Q2xhc3MoKSBj
b25zdCB7IHJldHVybiAiWUdyYXBoIjsgfQojIDg3ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5
dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUdyYXBoLmgiCiAgICB2aXJ0dWFsIGJvb2wgc2V0
UHJvcGVydHkoIGNvbnN0IHN0ZDo6c3RyaW5nICYgcHJvcGVydHlOYW1lLAogICAgICAgICBjb25z
dCBZUHJvcGVydHlWYWx1ZSAmIHZhbCApOwoKCgoKCgoKICAgIHZpcnR1YWwgWVByb3BlcnR5VmFs
dWUgZ2V0UHJvcGVydHkoIGNvbnN0IHN0ZDo6c3RyaW5nICYgcHJvcGVydHlOYW1lICk7CgoKCgoK
CgogICAgdmlydHVhbCBjb25zdCBZUHJvcGVydHlTZXQgJiBwcm9wZXJ0eVNldCgpOwoKCgoKICAg
IHN0ZDo6c3RyaW5nIGZpbGVuYW1lKCkgY29uc3Q7CgoKCgoKCgogICAgdmlydHVhbCB2b2lkIHNl
dEZpbGVuYW1lKCBjb25zdCBzdGQ6OnN0cmluZyAmIGZpbGVuYW1lICk7CgoKCgogICAgc3RkOjpz
dHJpbmcgbGF5b3V0QWxnb3JpdGhtKCkgY29uc3Q7CgoKCgoKCiAgICB2aXJ0dWFsIHZvaWQgc2V0
TGF5b3V0QWxnb3JpdGhtKCBjb25zdCBzdGQ6OnN0cmluZyAmIGZpbGVuYW1lICk7CgoKCgoKCiAg
ICB2aXJ0dWFsIHZvaWQgc2V0R3JhcGgoIHZvaWQgKiBncmFwaCApOwoKCgoKCiAgICB2aXJ0dWFs
IHN0ZDo6c3RyaW5nIGFjdGl2YXRlZE5vZGUoKSBjb25zdDsKCnByb3RlY3RlZDoKCgoKCgogICAg
dmlydHVhbCB2b2lkIHJlbmRlckdyYXBoKCBjb25zdCBzdGQ6OnN0cmluZyAmIGZpbGVuYW1lLCBj
b25zdCBzdGQ6OnN0cmluZyAmIGxheW91dEFsZ29yaXRobSApID0gMDsKCgoKCiAgICB2aXJ0dWFs
IHZvaWQgcmVuZGVyR3JhcGgoIHZvaWQgKiBncmFwaCApID0gMDsKCnByaXZhdGU6CgogICAgSW1w
bFB0cjxZR3JhcGhQcml2YXRlPiBwcml2OwoKfTsKIyAzNSAiL2hvbWUvc2hhcmtjei9saWJ5dWkv
bGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lPcHRpb25hbFdpZGdldEZhY3RvcnkuaCIg
MgoKCmNsYXNzIFlCYXJHcmFwaDsKY2xhc3MgWURhdGVGaWVsZDsKY2xhc3MgWURvd25sb2FkUHJv
Z3Jlc3M7CmNsYXNzIFlEdW1iVGFiOwpjbGFzcyBZRHVtbXlTcGVjaWFsV2lkZ2V0OwpjbGFzcyBZ
TXVsdGlQcm9ncmVzc01ldGVyOwpjbGFzcyBZUGFydGl0aW9uU3BsaXR0ZXI7CmNsYXNzIFlTbGlk
ZXI7CmNsYXNzIFlUaW1lRmllbGQ7CmNsYXNzIFlXaWRnZXQ7CmNsYXNzIFlUaW1lem9uZVNlbGVj
dG9yOwojIDU2ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIu
MS9zcmMvWU9wdGlvbmFsV2lkZ2V0RmFjdG9yeS5oIgpjbGFzcyBZT3B0aW9uYWxXaWRnZXRGYWN0
b3J5CnsKcHVibGljOgoKCgoKCiAgICB2aXJ0dWFsIGJvb2wgaGFzV2l6YXJkKCk7CiAgICB2aXJ0
dWFsIFlXaXphcmQgKiBjcmVhdGVXaXphcmQgKCBZV2lkZ2V0ICogcGFyZW50LAogICAgICAgICAg
Y29uc3Qgc3RkOjpzdHJpbmcgJiBiYWNrQnV0dG9uTGFiZWwsCiAgICAgICAgICBjb25zdCBzdGQ6
OnN0cmluZyAmIGFib3J0QnV0dG9uTGFiZWwsCiAgICAgICAgICBjb25zdCBzdGQ6OnN0cmluZyAm
IG5leHRCdXR0b25MYWJlbCwKICAgICAgICAgIFlXaXphcmRNb2RlIHdpemFyZE1vZGUgPSBZV2l6
YXJkTW9kZV9TdGFuZGFyZCApOwoKICAgIHZpcnR1YWwgYm9vbCBoYXNEdW1iVGFiKCk7CiAgICB2
aXJ0dWFsIFlEdW1iVGFiICogY3JlYXRlRHVtYlRhYiAoIFlXaWRnZXQgKiBwYXJlbnQgKTsKCiAg
ICB2aXJ0dWFsIGJvb2wgaGFzU2xpZGVyKCk7CiAgICB2aXJ0dWFsIFlTbGlkZXIgKiBjcmVhdGVT
bGlkZXIgKCBZV2lkZ2V0ICogcGFyZW50LAogICAgICAgICAgY29uc3Qgc3RkOjpzdHJpbmcgJiBs
YWJlbCwKICAgICAgICAgIGludCBtaW5WYWwsCiAgICAgICAgICBpbnQgbWF4VmFsLAogICAgICAg
ICAgaW50IGluaXRpYWxWYWwgKTsKCiAgICB2aXJ0dWFsIGJvb2wgaGFzRGF0ZUZpZWxkKCk7CiAg
ICB2aXJ0dWFsIFlEYXRlRmllbGQgKiBjcmVhdGVEYXRlRmllbGQgKCBZV2lkZ2V0ICogcGFyZW50
LCBjb25zdCBzdGQ6OnN0cmluZyAmIGxhYmVsICk7CgogICAgdmlydHVhbCBib29sIGhhc1RpbWVG
aWVsZCgpOwogICAgdmlydHVhbCBZVGltZUZpZWxkICogY3JlYXRlVGltZUZpZWxkICggWVdpZGdl
dCAqIHBhcmVudCwgY29uc3Qgc3RkOjpzdHJpbmcgJiBsYWJlbCApOwoKICAgIHZpcnR1YWwgYm9v
bCBoYXNCYXJHcmFwaCgpOwogICAgdmlydHVhbCBZQmFyR3JhcGggKiBjcmVhdGVCYXJHcmFwaCAo
IFlXaWRnZXQgKiBwYXJlbnQgKTsKCiAgICB2aXJ0dWFsIGJvb2wgaGFzUGF0dGVyblNlbGVjdG9y
KCk7CiAgICB2aXJ0dWFsIFlXaWRnZXQgKiBjcmVhdGVQYXR0ZXJuU2VsZWN0b3IgKCBZV2lkZ2V0
ICogcGFyZW50LCBsb25nIG1vZGVGbGFncyA9IDAgKTsKCiAgICB2aXJ0dWFsIGJvb2wgaGFzU2lt
cGxlUGF0Y2hTZWxlY3RvcigpOwogICAgdmlydHVhbCBZV2lkZ2V0ICogY3JlYXRlU2ltcGxlUGF0
Y2hTZWxlY3RvciggWVdpZGdldCAqIHBhcmVudCwgbG9uZyBtb2RlRmxhZ3MgPSAwICk7CgogICAg
dmlydHVhbCBib29sIGhhc011bHRpUHJvZ3Jlc3NNZXRlcigpOwogICAgWU11bHRpUHJvZ3Jlc3NN
ZXRlciAqIGNyZWF0ZUhNdWx0aVByb2dyZXNzTWV0ZXIoIFlXaWRnZXQgKiBwYXJlbnQsIGNvbnN0
IHN0ZDo6dmVjdG9yPGZsb2F0PiAmIG1heFZhbHVlcyApOwogICAgWU11bHRpUHJvZ3Jlc3NNZXRl
ciAqIGNyZWF0ZVZNdWx0aVByb2dyZXNzTWV0ZXIoIFlXaWRnZXQgKiBwYXJlbnQsIGNvbnN0IHN0
ZDo6dmVjdG9yPGZsb2F0PiAmIG1heFZhbHVlcyApOwogICAgdmlydHVhbCBZTXVsdGlQcm9ncmVz
c01ldGVyICogY3JlYXRlTXVsdGlQcm9ncmVzc01ldGVyICggWVdpZGdldCAqIHBhcmVudCwgWVVJ
RGltZW5zaW9uIGRpbSwgY29uc3Qgc3RkOjp2ZWN0b3I8ZmxvYXQ+ICYgbWF4VmFsdWVzICk7Cgog
ICAgdmlydHVhbCBib29sIGhhc1BhcnRpdGlvblNwbGl0dGVyKCk7CiAgICB2aXJ0dWFsIFlQYXJ0
aXRpb25TcGxpdHRlciAqIGNyZWF0ZVBhcnRpdGlvblNwbGl0dGVyICggWVdpZGdldCAqIHBhcmVu
dCwKICAgICAgICAgIGludCB1c2VkU2l6ZSwKICAgICAgICAgIGludCB0b3RhbEZyZWVTaXplLAog
ICAgICAgICAgaW50IG5ld1BhcnRTaXplLAogICAgICAgICAgaW50IG1pbk5ld1BhcnRTaXplLAog
ICAgICAgICAgaW50IG1pbkZyZWVTaXplLAogICAgICAgICAgY29uc3Qgc3RkOjpzdHJpbmcgJiB1
c2VkTGFiZWwsCiAgICAgICAgICBjb25zdCBzdGQ6OnN0cmluZyAmIGZyZWVMYWJlbCwKICAgICAg
ICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgbmV3UGFydExhYmVsLAogICAgICAgICAgY29uc3Qgc3Rk
OjpzdHJpbmcgJiBmcmVlRmllbGRMYWJlbCwKICAgICAgICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYg
bmV3UGFydEZpZWxkTGFiZWwgKTsKCgogICAgdmlydHVhbCBib29sIGhhc0Rvd25sb2FkUHJvZ3Jl
c3MoKTsKICAgIHZpcnR1YWwgWURvd25sb2FkUHJvZ3Jlc3MgKiBjcmVhdGVEb3dubG9hZFByb2dy
ZXNzICggWVdpZGdldCAqIHBhcmVudCwKICAgICAgICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgbGFi
ZWwsCiAgICAgICAgICBjb25zdCBzdGQ6OnN0cmluZyAmIGZpbGVuYW1lLAogICAgICAgICAgWUZp
bGVTaXplX3QgZXhwZWN0ZWRGaWxlU2l6ZSApOwoKICAgIGJvb2wgaGFzRHVtbXlTcGVjaWFsV2lk
Z2V0KCk7CiAgICBZV2lkZ2V0ICogY3JlYXRlRHVtbXlTcGVjaWFsV2lkZ2V0KCBZV2lkZ2V0ICog
cGFyZW50ICk7CgogICAgdmlydHVhbCBib29sIGhhc1RpbWV6b25lU2VsZWN0b3IoKTsKICAgIHZp
cnR1YWwgWVRpbWV6b25lU2VsZWN0b3IgKiBjcmVhdGVUaW1lem9uZVNlbGVjdG9yKCBZV2lkZ2V0
ICogcGFyZW50LAogICAgICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgcGl4bWFwLAogICAgICAgIGNv
bnN0IHN0ZDo6bWFwPHN0ZDo6c3RyaW5nLHN0ZDo6c3RyaW5nPiAmIHRpbWV6b25lcyApOwoKICAg
IHZpcnR1YWwgYm9vbCBoYXNHcmFwaCgpOwogICAgdmlydHVhbCBZR3JhcGggKiBjcmVhdGVHcmFw
aCggWVdpZGdldCAqIHBhcmVudCwgY29uc3Qgc3RkOjpzdHJpbmcgJiBmaWxlbmFtZSwKICAgICAg
ICAgICBjb25zdCBzdGQ6OnN0cmluZyAmIGxheW91dEFsZ29yaXRobSApOwogICAgdmlydHVhbCBZ
R3JhcGggKiBjcmVhdGVHcmFwaCggWVdpZGdldCAqIHBhcmVudCwgdm9pZCAqIGdyYXBoICk7Cgog
ICAgdmlydHVhbCBib29sIGhhc0NvbnRleHRNZW51KCk7Cgpwcm90ZWN0ZWQ6CgogICAgZnJpZW5k
IGNsYXNzIFlVSTsKCgoKCgoKICAgIFlPcHRpb25hbFdpZGdldEZhY3RvcnkoKTsKCgoKCiAgICB2
aXJ0dWFsIH5ZT3B0aW9uYWxXaWRnZXRGYWN0b3J5KCk7Cgp9OwojIDQyICIvaG9tZS9zaGFya2N6
L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5jYyIgMgojIDEg
Ii9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZTGF5
b3V0Qm94LmgiIDEKIyAzMiAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0
ZXItMy4yLjEvc3JjL1lMYXlvdXRCb3guaCIKY2xhc3MgWUxheW91dEJveFByaXZhdGU7CgoKY2xh
c3MgWUxheW91dEJveCA6IHB1YmxpYyBZV2lkZ2V0CnsKcHVibGljOgogICAgdHlwZWRlZiBzdGQ6
OnZlY3RvcjxpbnQ+IHNpemVWZWN0b3I7CiAgICB0eXBlZGVmIHN0ZDo6dmVjdG9yPGludD4gcG9z
VmVjdG9yOwoKcHJvdGVjdGVkOgoKCgoKCiAgICBZTGF5b3V0Qm94KCBZV2lkZ2V0ICogcGFyZW50
LCBZVUlEaW1lbnNpb24gZGltICk7CgpwdWJsaWM6CgoKCiAgICB2aXJ0dWFsIH5ZTGF5b3V0Qm94
KCk7CgoKCgoKICAgIHZpcnR1YWwgY29uc3QgY2hhciAqIHdpZGdldENsYXNzKCkgY29uc3Q7CgoK
CgoKICAgIFlVSURpbWVuc2lvbiBwcmltYXJ5KCkgY29uc3Q7CgoKCgogICAgWVVJRGltZW5zaW9u
IHNlY29uZGFyeSgpIGNvbnN0OwoKCgoKICAgIGJvb2wgZGVidWdMYXlvdXQoKSBjb25zdDsKCgoK
CiAgICB2b2lkIHNldERlYnVnTGF5b3V0KCBib29sIGRlYiA9IHRydWUgKTsKCgoKCgoKICAgIHZp
cnR1YWwgaW50IHByZWZlcnJlZFNpemUoIFlVSURpbWVuc2lvbiBkaW0gKTsKCgoKCgoKICAgIHZp
cnR1YWwgaW50IHByZWZlcnJlZFdpZHRoKCk7CgoKCgoKCiAgICB2aXJ0dWFsIGludCBwcmVmZXJy
ZWRIZWlnaHQoKTsKIyAxMTIgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFz
dGVyLTMuMi4xL3NyYy9ZTGF5b3V0Qm94LmgiCiAgICB2aXJ0dWFsIHZvaWQgc2V0U2l6ZSggaW50
IG5ld1dpZHRoLCBpbnQgbmV3SGVpZ2h0ICk7CiMgMTIyICIvaG9tZS9zaGFya2N6L2xpYnl1aS9s
aWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUxheW91dEJveC5oIgogICAgdmlydHVhbCBi
b29sIHN0cmV0Y2hhYmxlKCBZVUlEaW1lbnNpb24gZGltZW5zaW9uICkgY29uc3Q7CgoKCgoKCiAg
ICB2aXJ0dWFsIHZvaWQgbW92ZUNoaWxkKCBZV2lkZ2V0ICogY2hpbGQsIGludCBuZXdYLCBpbnQg
bmV3WSApID0gMDsKCgoKCgogICAgc3RhdGljIGJvb2wgaXNMYXlvdXRTdHJldGNoKCBZV2lkZ2V0
ICogY2hpbGQsIFlVSURpbWVuc2lvbiBkaW1lbnNpb24gKTsKCgpwcm90ZWN0ZWQ6CgoKCgogICAg
aW50IGNoaWxkcmVuVG90YWxXZWlnaHQoIFlVSURpbWVuc2lvbiBkaW1lbnNpb24gKTsKCgoKCgog
ICAgaW50IGNoaWxkcmVuTWF4UHJlZmVycmVkU2l6ZSggWVVJRGltZW5zaW9uIGRpbWVuc2lvbiAp
OwoKCgoKCiAgICBpbnQgdG90YWxOb25XZWlnaHRlZENoaWxkcmVuUHJlZmVycmVkU2l6ZSggWVVJ
RGltZW5zaW9uIGRpbWVuc2lvbiApOwoKCgoKICAgIGludCBjb3VudE5vbldlaWdodGVkQ2hpbGRy
ZW4oIFlVSURpbWVuc2lvbiBkaW1lbnNpb24gKTsKCgoKCgogICAgaW50IGNvdW50U3RyZXRjaGFi
bGVDaGlsZHJlbiggWVVJRGltZW5zaW9uIGRpbWVuc2lvbiApOwoKCgoKCgogICAgaW50IGNvdW50
TGF5b3V0U3RyZXRjaENoaWxkcmVuKCBZVUlEaW1lbnNpb24gZGltZW5zaW9uICk7CiMgMTgyICIv
aG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUxheW91
dEJveC5oIgogICAgWVdpZGdldCAqIGZpbmREb21pbmF0aW5nQ2hpbGQoKTsKCgoKCgogICAgdm9p
ZCBjYWxjUHJpbWFyeUdlb21ldHJ5ICggaW50IG5ld1NpemUsCiAgICAgIHNpemVWZWN0b3IgJiBj
aGlsZFNpemUsCiAgICAgIHBvc1ZlY3RvciAmIGNoaWxkUG9zICk7CgoKCgoKICAgIHZvaWQgY2Fs
Y1NlY29uZGFyeUdlb21ldHJ5ICggaW50IG5ld1NpemUsCiAgICAgIHNpemVWZWN0b3IgJiBjaGls
ZFNpemUsCiAgICAgIHBvc1ZlY3RvciAmIGNoaWxkUG9zICk7CiMgMjA3ICIvaG9tZS9zaGFya2N6
L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUxheW91dEJveC5oIgogICAg
dm9pZCBkb1Jlc2l6ZSggc2l6ZVZlY3RvciAmIHdpZHRoLAogICAgIHNpemVWZWN0b3IgJiBoZWln
aHQsCiAgICAgcG9zVmVjdG9yICYgeF9wb3MsCiAgICAgcG9zVmVjdG9yICYgeV9wb3MgKTsKCgpw
cml2YXRlOgoKICAgIEltcGxQdHI8WUxheW91dEJveFByaXZhdGU+IHByaXY7Cn07CgoKdHlwZWRl
ZiBZTGF5b3V0Qm94IFlWQm94Owp0eXBlZGVmIFlMYXlvdXRCb3ggWUhCb3g7CiMgNDMgIi9ob21l
L3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNj
IiAyCiMgMSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEv
c3JjL1lSaWNoVGV4dC5oIiAxCiMgMzMgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5
dWktbWFzdGVyLTMuMi4xL3NyYy9ZUmljaFRleHQuaCIKY2xhc3MgWVJpY2hUZXh0UHJpdmF0ZTsK
CgpjbGFzcyBZUmljaFRleHQgOiBwdWJsaWMgWVdpZGdldAp7CnB1YmxpYzoKIyA0NyAiL2hvbWUv
c2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lSaWNoVGV4dC5o
IgogICAgWVJpY2hUZXh0KCBZV2lkZ2V0ICogcGFyZW50LAogICAgICAgIGNvbnN0IHN0ZDo6c3Ry
aW5nICYgdGV4dCwKICAgICAgICBib29sIHBsYWluVGV4dE1vZGUgPSBmYWxzZSApOwoKCgoKICAg
IHZpcnR1YWwgfllSaWNoVGV4dCgpOwoKCgoKCiAgICB2aXJ0dWFsIGNvbnN0IGNoYXIgKiB3aWRn
ZXRDbGFzcygpIGNvbnN0IHsgcmV0dXJuICJZUmljaFRleHQiOyB9CgoKCgoKCgogICAgdmlydHVh
bCB2b2lkIHNldFZhbHVlKCBjb25zdCBzdGQ6OnN0cmluZyAmIG5ld1ZhbHVlICk7CgoKCgogICAg
c3RkOjpzdHJpbmcgdmFsdWUoKSBjb25zdDsKCgoKCiAgICB2b2lkIHNldFRleHQoIGNvbnN0IHN0
ZDo6c3RyaW5nICYgbmV3VGV4dCApIHsgc2V0VmFsdWUoIG5ld1RleHQgKTsgfQoKCgoKICAgIHN0
ZDo6c3RyaW5nIHRleHQoKSBjb25zdCB7IHJldHVybiB2YWx1ZSgpOyB9CgoKCgoKICAgIGJvb2wg
cGxhaW5UZXh0TW9kZSgpIGNvbnN0OwoKCgoKCgoKICAgIHZpcnR1YWwgdm9pZCBzZXRQbGFpblRl
eHRNb2RlKCBib29sIG9uID0gdHJ1ZSApOwoKCgoKCgogICAgYm9vbCBhdXRvU2Nyb2xsRG93bigp
IGNvbnN0OwoKCgoKCgoKICAgIHZpcnR1YWwgdm9pZCBzZXRBdXRvU2Nyb2xsRG93biggYm9vbCBv
biA9IHRydWUgKTsKCgoKCgogICAgYm9vbCBzaHJpbmthYmxlKCkgY29uc3Q7CiMgMTI3ICIvaG9t
ZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVJpY2hUZXh0
LmgiCiAgICB2b2lkIHNldFNocmlua2FibGUoIGJvb2wgc2hyaW5rYWJsZSA9IHRydWUgKTsKIyAx
MzkgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9Z
UmljaFRleHQuaCIKICAgIHZpcnR1YWwgYm9vbCBzZXRQcm9wZXJ0eSggY29uc3Qgc3RkOjpzdHJp
bmcgJiBwcm9wZXJ0eU5hbWUsCiAgICAgICAgIGNvbnN0IFlQcm9wZXJ0eVZhbHVlICYgdmFsICk7
CgoKCgoKCgogICAgdmlydHVhbCBZUHJvcGVydHlWYWx1ZSBnZXRQcm9wZXJ0eSggY29uc3Qgc3Rk
OjpzdHJpbmcgJiBwcm9wZXJ0eU5hbWUgKTsKCgoKCgoKCiAgICB2aXJ0dWFsIGNvbnN0IFlQcm9w
ZXJ0eVNldCAmIHByb3BlcnR5U2V0KCk7CgoKcHJvdGVjdGVkOgoKICAgIEltcGxQdHI8WVJpY2hU
ZXh0UHJpdmF0ZT4gcHJpdjsKfTsKIyA0NCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxp
Ynl1aS1tYXN0ZXItMy4yLjEvc3JjL1lEaWFsb2cuY2MiIDIKIyAxICIvaG9tZS9zaGFya2N6L2xp
Ynl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUFsaWdubWVudC5oIiAxCiMgMzEg
Ii9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZQWxp
Z25tZW50LmgiCmNsYXNzIFlBbGlnbm1lbnRQcml2YXRlOwojIDQxICIvaG9tZS9zaGFya2N6L2xp
Ynl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUFsaWdubWVudC5oIgpjbGFzcyBZ
QWxpZ25tZW50IDogcHVibGljIFlTaW5nbGVDaGlsZENvbnRhaW5lcldpZGdldAp7CnByb3RlY3Rl
ZDoKCgoKICAgIFlBbGlnbm1lbnQoIFlXaWRnZXQgKiBwYXJlbnQsCiAgWUFsaWdubWVudFR5cGUg
aG9yQWxpZ24sCiAgWUFsaWdubWVudFR5cGUgdmVydEFsaWduICk7CgpwdWJsaWM6CgoKCiAgICB2
aXJ0dWFsIH5ZQWxpZ25tZW50KCk7CgoKCgoKICAgIHZpcnR1YWwgY29uc3QgY2hhciAqIHdpZGdl
dENsYXNzKCkgY29uc3Q7CgoKCgogICAgWUFsaWdubWVudFR5cGUgYWxpZ25tZW50KCBZVUlEaW1l
bnNpb24gZGltICkgY29uc3Q7CgoKCgoKICAgIGludCBsZWZ0TWFyZ2luKCkgY29uc3Q7CgoKCgoK
ICAgIGludCByaWdodE1hcmdpbigpIGNvbnN0OwoKCgoKCiAgICBpbnQgdG9wTWFyZ2luKCkgY29u
c3Q7CgoKCgoKICAgIGludCBib3R0b21NYXJnaW4oKSBjb25zdDsKCgoKCiAgICBpbnQgdG90YWxN
YXJnaW5zKCBZVUlEaW1lbnNpb24gZGltICkgY29uc3Q7CgoKCgogICAgdm9pZCBzZXRMZWZ0TWFy
Z2luKCBpbnQgbWFyZ2luICk7CgoKCgogICAgdm9pZCBzZXRSaWdodE1hcmdpbiggaW50IG1hcmdp
biApOwoKCgoKICAgIHZvaWQgc2V0VG9wTWFyZ2luKCBpbnQgbWFyZ2luICk7CgoKCgogICAgdm9p
ZCBzZXRCb3R0b21NYXJnaW4oIGludCBtYXJnaW4gKTsKCgoKCgogICAgaW50IG1pbldpZHRoKCkg
Y29uc3Q7CgoKCgoKICAgIGludCBtaW5IZWlnaHQoKSBjb25zdDsKCgoKCiAgICB2b2lkIHNldE1p
bldpZHRoKCBpbnQgd2lkdGggKTsKCgoKCiAgICB2b2lkIHNldE1pbkhlaWdodCggaW50IGhlaWdo
dCApOwojIDE0OSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4y
LjEvc3JjL1lBbGlnbm1lbnQuaCIKICAgIHZpcnR1YWwgdm9pZCBzZXRCYWNrZ3JvdW5kUGl4bWFw
KCBjb25zdCBzdGQ6OnN0cmluZyAmIHBpeG1hcEZpbGVOYW1lICk7CgoKCgoKICAgIHN0ZDo6c3Ry
aW5nIGJhY2tncm91bmRQaXhtYXAoKSBjb25zdDsKCgoKCgoKCiAgICB2aXJ0dWFsIHZvaWQgYWRk
Q2hpbGQoIFlXaWRnZXQgKiBjaGlsZCApOwoKCgoKICAgIHZpcnR1YWwgdm9pZCBtb3ZlQ2hpbGQo
IFlXaWRnZXQgKmNoaWxkLCBpbnQgbmV3eCwgaW50IG5ld3kgKSA9IDA7CiMgMTc4ICIvaG9tZS9z
aGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUFsaWdubWVudC5o
IgogICAgdmlydHVhbCBib29sIHN0cmV0Y2hhYmxlKCBZVUlEaW1lbnNpb24gZGltICkgY29uc3Q7
CgoKCgoKCiAgICB2aXJ0dWFsIGludCBwcmVmZXJyZWRXaWR0aCgpOwoKCgoKCgogICAgdmlydHVh
bCBpbnQgcHJlZmVycmVkSGVpZ2h0KCk7CiMgMjAxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5
dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUFsaWdubWVudC5oIgogICAgdmlydHVhbCB2b2lk
IHNldFNpemUoIGludCBuZXdXaWR0aCwgaW50IG5ld0hlaWdodCApOwoKCnByb3RlY3RlZDoKCiAg
ICBJbXBsUHRyPFlBbGlnbm1lbnRQcml2YXRlPiBwcml2Owp9OwojIDQ1ICIvaG9tZS9zaGFya2N6
L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5jYyIgMgoKIyAx
ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUV2
ZW50RmlsdGVyLmgiIDEKIyAzMiAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1t
YXN0ZXItMy4yLjEvc3JjL1lFdmVudEZpbHRlci5oIgpjbGFzcyBZRXZlbnQ7CmNsYXNzIFlEaWFs
b2c7CgpjbGFzcyBZRXZlbnRGaWx0ZXJQcml2YXRlOwojIDYyICIvaG9tZS9zaGFya2N6L2xpYnl1
aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUV2ZW50RmlsdGVyLmgiCmNsYXNzIFlF
dmVudEZpbHRlcgp7CnByb3RlY3RlZDoKIyA3NSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVp
LWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lFdmVudEZpbHRlci5oIgogICAgWUV2ZW50RmlsdGVy
KCBZRGlhbG9nICogZGlhbG9nID0gMCApOwoKcHVibGljOgoKCgoKCiAgICB2aXJ0dWFsIH5ZRXZl
bnRGaWx0ZXIoKTsKIyAxMDcgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFz
dGVyLTMuMi4xL3NyYy9ZRXZlbnRGaWx0ZXIuaCIKICAgIHZpcnR1YWwgWUV2ZW50ICogZmlsdGVy
KCBZRXZlbnQgKiBldmVudCApID0gMDsKCgoKCiAgICBZRGlhbG9nICogZGlhbG9nKCkgY29uc3Q7
Cgpwcml2YXRlOgoKICAgIEltcGxQdHI8WUV2ZW50RmlsdGVyUHJpdmF0ZT4gcHJpdjsKfTsKIyA0
NyAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lE
aWFsb2cuY2MiIDIKIyAxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rl
ci0zLjIuMS9zcmMvWVdpZGdldElELmgiIDEKIyAzNiAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGli
eXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lXaWRnZXRJRC5oIgpjbGFzcyBZV2lkZ2V0SUQK
ewpwcm90ZWN0ZWQ6CgoKCiAgICBZV2lkZ2V0SUQoKSB7fQoKcHVibGljOgoKCgogICAgdmlydHVh
bCB+WVdpZGdldElEKCkge30KCgoKCiAgICB2aXJ0dWFsIGJvb2wgaXNFcXVhbCggWVdpZGdldElE
ICogb3RoZXJJRCApIGNvbnN0ID0gMDsKCgoKCgogICAgdmlydHVhbCBzdGQ6OnN0cmluZyB0b1N0
cmluZygpIGNvbnN0ID0gMDsKCnByaXZhdGU6CgoKCiAgICBZV2lkZ2V0SUQoIGNvbnN0IFlXaWRn
ZXRJRCAmIG9yaWcgKTsKfTsKCgoKCgpjbGFzcyBZU3RyaW5nV2lkZ2V0SUQ6IHB1YmxpYyBZV2lk
Z2V0SUQKewpwdWJsaWM6CgoKCgogICAgWVN0cmluZ1dpZGdldElEKCBjb25zdCBzdGQ6OnN0cmlu
ZyAmIHZhbHVlICk7CgoKCgogICAgdmlydHVhbCB+WVN0cmluZ1dpZGdldElEKCk7CgoKCgoKCiAg
ICB2aXJ0dWFsIGJvb2wgaXNFcXVhbCggWVdpZGdldElEICogb3RoZXJJRCApIGNvbnN0OwoKCgoK
CgoKICAgIHZpcnR1YWwgc3RkOjpzdHJpbmcgdG9TdHJpbmcoKSBjb25zdDsKCgoKCiAgICBzdGQ6
OnN0cmluZyB2YWx1ZSgpIGNvbnN0OwoKCgoKICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgdmFsdWVD
b25zdFJlZigpIGNvbnN0OwoKcHJpdmF0ZToKICAgIHN0ZDo6c3RyaW5nIF92YWx1ZTsKfTsKCnN0
ZDo6b3N0cmVhbSAmIG9wZXJhdG9yPDwoIHN0ZDo6b3N0cmVhbSAmIHN0cmVhbSwgY29uc3QgWVdp
ZGdldElEICogaWQgKTsKIyA0OCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1t
YXN0ZXItMy4yLjEvc3JjL1lEaWFsb2cuY2MiIDIKIyAxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9s
aWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUR1bWJUYWIuaCIgMQojIDI4ICIvaG9tZS9z
aGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWUR1bWJUYWIuaCIK
IyAxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMv
WVNlbGVjdGlvbldpZGdldC5oIiAxCiMgMzIgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1s
aWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZU2VsZWN0aW9uV2lkZ2V0LmgiCmNsYXNzIFlTZWxlY3Rp
b25XaWRnZXRQcml2YXRlOwojIDQyICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVp
LW1hc3Rlci0zLjIuMS9zcmMvWVNlbGVjdGlvbldpZGdldC5oIgpjbGFzcyBZU2VsZWN0aW9uV2lk
Z2V0IDogcHVibGljIFlXaWRnZXQKewpwcm90ZWN0ZWQ6CiMgNTQgIi9ob21lL3NoYXJrY3ovbGli
eXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZU2VsZWN0aW9uV2lkZ2V0LmgiCiAg
ICBZU2VsZWN0aW9uV2lkZ2V0KCBZV2lkZ2V0ICogcGFyZW50LAogICAgICAgIGNvbnN0IHN0ZDo6
c3RyaW5nICYgbGFiZWwsCiAgICAgICAgYm9vbCBlbmZvcmNlU2luZ2xlU2VsZWN0aW9uLAogICAg
ICAgIGJvb2wgcmVjdXJpc3ZlU2VsZWN0aW9uID0gZmFsc2UgKTsKCnB1YmxpYzoKCgoKICAgIHZp
cnR1YWwgfllTZWxlY3Rpb25XaWRnZXQoKTsKCgoKCgogICAgdmlydHVhbCBjb25zdCBjaGFyICog
d2lkZ2V0Q2xhc3MoKSBjb25zdCB7IHJldHVybiAiWVNlbGVjdGlvbldpZGdldCI7IH0KCgoKCiAg
ICBzdGQ6OnN0cmluZyBsYWJlbCgpIGNvbnN0OwoKCgoKCgoKICAgIHZpcnR1YWwgdm9pZCBzZXRM
YWJlbCggY29uc3Qgc3RkOjpzdHJpbmcgJiBuZXdMYWJlbCApOwojIDk1ICIvaG9tZS9zaGFya2N6
L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVNlbGVjdGlvbldpZGdldC5o
IgogICAgdmlydHVhbCB2b2lkIGFkZEl0ZW0oIFlJdGVtICogaXRlbV9kaXNvd24gKTsKCgoKCiAg
ICB2b2lkIGFkZEl0ZW0oIGNvbnN0IHN0ZDo6c3RyaW5nICYgaXRlbUxhYmVsLCBib29sIHNlbGVj
dGVkID0gZmFsc2UgKTsKCgoKCgogICAgdm9pZCBhZGRJdGVtKCBjb25zdCBzdGQ6OnN0cmluZyAm
IGl0ZW1MYWJlbCwKICAgIGNvbnN0IHN0ZDo6c3RyaW5nICYgaWNvbk5hbWUsCiAgICBib29sIHNl
bGVjdGVkID0gZmFsc2UgKTsKCgoKCgogICAgdmlydHVhbCB2b2lkIGFkZEl0ZW1zKCBjb25zdCBZ
SXRlbUNvbGxlY3Rpb24gJiBpdGVtQ29sbGVjdGlvbiApOwoKCgoKCgoKICAgIHZpcnR1YWwgdm9p
ZCBkZWxldGVBbGxJdGVtcygpOwoKCgoKICAgIHZvaWQgc2V0SXRlbXMoIGNvbnN0IFlJdGVtQ29s
bGVjdGlvbiAmIGl0ZW1Db2xsZWN0aW9uICkKIHsgZGVsZXRlQWxsSXRlbXMoKTsgYWRkSXRlbXMo
IGl0ZW1Db2xsZWN0aW9uICk7IH0KIyAxNDAgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1s
aWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZU2VsZWN0aW9uV2lkZ2V0LmgiCiAgICBZSXRlbUl0ZXJh
dG9yIGl0ZW1zQmVnaW4oKTsKICAgIFlJdGVtQ29uc3RJdGVyYXRvciBpdGVtc0JlZ2luKCkgY29u
c3Q7CgoKCgogICAgWUl0ZW1JdGVyYXRvciBpdGVtc0VuZCgpOwogICAgWUl0ZW1Db25zdEl0ZXJh
dG9yIGl0ZW1zRW5kKCkgY29uc3Q7CgoKCgogICAgYm9vbCBoYXNJdGVtcygpIGNvbnN0OwoKCgoK
CgoKICAgIGludCBpdGVtc0NvdW50KCkgY29uc3Q7CgoKCgogICAgWUl0ZW0gKiBmaXJzdEl0ZW0o
KSBjb25zdDsKCgoKCiAgICB2aXJ0dWFsIFlJdGVtICogc2VsZWN0ZWRJdGVtKCk7CiMgMTc5ICIv
aG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVNlbGVj
dGlvbldpZGdldC5oIgogICAgdmlydHVhbCBZSXRlbUNvbGxlY3Rpb24gc2VsZWN0ZWRJdGVtcygp
OwoKCgoKICAgIGJvb2wgaGFzU2VsZWN0ZWRJdGVtKCk7CiMgMjAyICIvaG9tZS9zaGFya2N6L2xp
Ynl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVNlbGVjdGlvbldpZGdldC5oIgog
ICAgdmlydHVhbCB2b2lkIHNlbGVjdEl0ZW0oIFlJdGVtICogaXRlbSwgYm9vbCBzZWxlY3RlZCA9
IHRydWUgKTsKCgoKCgoKCiAgICB2aXJ0dWFsIHZvaWQgZGVzZWxlY3RBbGxJdGVtcygpOwoKCgoK
CiAgICB2b2lkIHNldEljb25CYXNlUGF0aCggY29uc3Qgc3RkOjpzdHJpbmcgJiBiYXNlUGF0aCAp
OwoKCgoKCiAgICBzdGQ6OnN0cmluZyBpY29uQmFzZVBhdGgoKSBjb25zdDsKIyAyMzIgIi9ob21l
L3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZU2VsZWN0aW9u
V2lkZ2V0LmgiCiAgICBzdGQ6OnN0cmluZyBpY29uRnVsbFBhdGgoIGNvbnN0IHN0ZDo6c3RyaW5n
ICYgaWNvbk5hbWUgKSBjb25zdDsKIyAyNDMgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1s
aWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZU2VsZWN0aW9uV2lkZ2V0LmgiCiAgICBzdGQ6OnN0cmlu
ZyBpY29uRnVsbFBhdGgoIFlJdGVtICogaXRlbSApIGNvbnN0OwoKCgoKICAgIGJvb2wgaXRlbXND
b250YWluKCBZSXRlbSAqIGl0ZW0gKSBjb25zdDsKCgoKCgogICAgWUl0ZW0gKiBmaW5kSXRlbSgg
Y29uc3Qgc3RkOjpzdHJpbmcgJiBpdGVtTGFiZWwgKSBjb25zdDsKCgoKCgoKICAgIHZpcnR1YWwg
c3RkOjpzdHJpbmcgc2hvcnRjdXRTdHJpbmcoKSBjb25zdCB7IHJldHVybiBsYWJlbCgpOyB9CgoK
CgoKCiAgICB2aXJ0dWFsIHZvaWQgc2V0U2hvcnRjdXRTdHJpbmcoIGNvbnN0IHN0ZDo6c3RyaW5n
ICYgc3RyICkKIHsgc2V0TGFiZWwoIHN0ciApOyB9Cgpwcm90ZWN0ZWQ6CiMgMjgxICIvaG9tZS9z
aGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWVNlbGVjdGlvbldp
ZGdldC5oIgogICAgdm9pZCBzZXRFbmZvcmNlU2luZ2xlU2VsZWN0aW9uKCBib29sIG9uICk7CgoK
CgogICAgYm9vbCBlbmZvcmNlU2luZ2xlU2VsZWN0aW9uKCkgY29uc3Q7CgoKCgogICAgYm9vbCBy
ZWN1cnNpdmVTZWxlY3Rpb24oKSBjb25zdDsKCgoKCgogICAgWUl0ZW0gKiBmaW5kU2VsZWN0ZWRJ
dGVtKCBZSXRlbUNvbnN0SXRlcmF0b3IgYmVnaW4sCiAgICAgICAgIFlJdGVtQ29uc3RJdGVyYXRv
ciBlbmQgKTsKCgoKCgogICAgdm9pZCBmaW5kU2VsZWN0ZWRJdGVtcyggWUl0ZW1Db2xsZWN0aW9u
ICYgc2VsZWN0ZWRJdGVtcywKICAgICAgIFlJdGVtQ29uc3RJdGVyYXRvciBiZWdpbiwKICAgICAg
IFlJdGVtQ29uc3RJdGVyYXRvciBlbmQgKTsKCgoKCiAgICB2b2lkIGRlc2VsZWN0QWxsSXRlbXMo
IFlJdGVtSXRlcmF0b3IgYmVnaW4sCiAgICAgIFlJdGVtSXRlcmF0b3IgZW5kICk7CgoKCgogICAg
WUl0ZW0gKiBmaW5kSXRlbSAoIGNvbnN0IHN0ZDo6c3RyaW5nICYgd2FudGVkSXRlbUxhYmVsLAog
ICAgIFlJdGVtQ29uc3RJdGVyYXRvciBiZWdpbiwKICAgICBZSXRlbUNvbnN0SXRlcmF0b3IgZW5k
ICkgY29uc3Q7CgoKCgoKICAgIGJvb2wgaXRlbXNDb250YWluICggWUl0ZW0gKiB3YW50ZWRJdGVt
LAogICAgIFlJdGVtQ29uc3RJdGVyYXRvciBiZWdpbiwKICAgICBZSXRlbUNvbnN0SXRlcmF0b3Ig
ZW5kICkgY29uc3Q7CgoKCgogICAgWUl0ZW0gKiBpdGVtQXQoIGludCBpbmRleCApIGNvbnN0OwoK
CnByaXZhdGU6CgogICAgSW1wbFB0cjxZU2VsZWN0aW9uV2lkZ2V0UHJpdmF0ZT4gcHJpdjsKfTsK
IyAyOSAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3Jj
L1lEdW1iVGFiLmgiIDIKCmNsYXNzIFlEdW1iVGFiUHJpdmF0ZTsKIyA0MCAiL2hvbWUvc2hhcmtj
ei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lEdW1iVGFiLmgiCmNsYXNz
IFlEdW1iVGFiIDogcHVibGljIFlTZWxlY3Rpb25XaWRnZXQKewpwcm90ZWN0ZWQ6CgoKCiAgICBZ
RHVtYlRhYiggWVdpZGdldCAqIHBhcmVudCApOwoKcHVibGljOgoKCgogICAgdmlydHVhbCB+WUR1
bWJUYWIoKTsKCgoKCgogICAgdmlydHVhbCBjb25zdCBjaGFyICogd2lkZ2V0Q2xhc3MoKSBjb25z
dCB7IHJldHVybiAiWUR1bWJUYWIiOyB9CiMgNjggIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1
aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRHVtYlRhYi5oIgogICAgdmlydHVhbCB2b2lkIGFk
ZEl0ZW0oIFlJdGVtICogaXRlbSApOwoKCgoKCgoKICAgIHZpcnR1YWwgdm9pZCBzaG9ydGN1dENo
YW5nZWQoKSB7fQojIDkxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rl
ci0zLjIuMS9zcmMvWUR1bWJUYWIuaCIKICAgIHZpcnR1YWwgYm9vbCBzZXRQcm9wZXJ0eSggY29u
c3Qgc3RkOjpzdHJpbmcgJiBwcm9wZXJ0eU5hbWUsCiAgICAgICAgIGNvbnN0IFlQcm9wZXJ0eVZh
bHVlICYgdmFsICk7CiMgMTAxICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1h
c3Rlci0zLjIuMS9zcmMvWUR1bWJUYWIuaCIKICAgIHZpcnR1YWwgWVByb3BlcnR5VmFsdWUgZ2V0
UHJvcGVydHkoIGNvbnN0IHN0ZDo6c3RyaW5nICYgcHJvcGVydHlOYW1lICk7CgoKCgoKCgogICAg
dmlydHVhbCBjb25zdCBZUHJvcGVydHlTZXQgJiBwcm9wZXJ0eVNldCgpOwojIDEyMCAiL2hvbWUv
c2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lEdW1iVGFiLmgi
CiAgICB2aXJ0dWFsIHN0ZDo6c3RyaW5nIHNob3J0Y3V0U3RyaW5nKCkgY29uc3QgeyByZXR1cm4g
IiI7IH0KIyAxMzAgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMu
Mi4xL3NyYy9ZRHVtYlRhYi5oIgogICAgdmlydHVhbCB2b2lkIHNldFNob3J0Y3V0U3RyaW5nKCBj
b25zdCBzdGQ6OnN0cmluZyAmIHN0ciApIHsgc2hvcnRjdXRDaGFuZ2VkKCk7IH0KCgoKCgoKCiAg
ICB2aXJ0dWFsIGJvb2wgc3RyZXRjaGFibGUoIFlVSURpbWVuc2lvbiBkaW0gKSBjb25zdDsKCgoK
CgogICAgdmlydHVhbCBzdGQ6OnN0cmluZyBkZWJ1Z0xhYmVsKCkgY29uc3Q7Cgpwcml2YXRlOgoK
CiAgICBzdGQ6OnN0cmluZyBsYWJlbCgpIGNvbnN0OwogICAgdmlydHVhbCB2b2lkIHNldExhYmVs
KCBjb25zdCBzdGQ6OnN0cmluZyAmIG5ld0xhYmVsICkge307CgoKICAgIEltcGxQdHI8WUR1bWJU
YWJQcml2YXRlPiBwcml2Owp9OwojIDQ5ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGli
eXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5jYyIgMgoKCgojIDEgIi91c3IvaW5jbHVkZS9k
aXJlbnQuaCIgMSAzIDQKIyAyNyAiL3Vzci9pbmNsdWRlL2RpcmVudC5oIiAzIDQKCiMgMjcgIi91
c3IvaW5jbHVkZS9kaXJlbnQuaCIgMyA0CmV4dGVybiAiQyIgewojIDYxICIvdXNyL2luY2x1ZGUv
ZGlyZW50LmgiIDMgNAojIDEgIi91c3IvaW5jbHVkZS9iaXRzL2RpcmVudC5oIiAxIDMgNAojIDIy
ICIvdXNyL2luY2x1ZGUvYml0cy9kaXJlbnQuaCIgMyA0CnN0cnVjdCBkaXJlbnQKICB7CgogICAg
X19pbm9fdCBkX2lubzsKICAgIF9fb2ZmX3QgZF9vZmY7CgoKCgogICAgdW5zaWduZWQgc2hvcnQg
aW50IGRfcmVjbGVuOwogICAgdW5zaWduZWQgY2hhciBkX3R5cGU7CiAgICBjaGFyIGRfbmFtZVsy
NTZdOwogIH07CgoKc3RydWN0IGRpcmVudDY0CiAgewogICAgX19pbm82NF90IGRfaW5vOwogICAg
X19vZmY2NF90IGRfb2ZmOwogICAgdW5zaWduZWQgc2hvcnQgaW50IGRfcmVjbGVuOwogICAgdW5z
aWduZWQgY2hhciBkX3R5cGU7CiAgICBjaGFyIGRfbmFtZVsyNTZdOwogIH07CiMgNjIgIi91c3Iv
aW5jbHVkZS9kaXJlbnQuaCIgMiAzIDQKIyA5NyAiL3Vzci9pbmNsdWRlL2RpcmVudC5oIiAzIDQK
ZW51bQogIHsKICAgIERUX1VOS05PV04gPSAwLAoKICAgIERUX0ZJRk8gPSAxLAoKICAgIERUX0NI
UiA9IDIsCgogICAgRFRfRElSID0gNCwKCiAgICBEVF9CTEsgPSA2LAoKICAgIERUX1JFRyA9IDgs
CgogICAgRFRfTE5LID0gMTAsCgogICAgRFRfU09DSyA9IDEyLAoKICAgIERUX1dIVCA9IDE0Cgog
IH07CiMgMTI3ICIvdXNyL2luY2x1ZGUvZGlyZW50LmgiIDMgNAp0eXBlZGVmIHN0cnVjdCBfX2Rp
cnN0cmVhbSBESVI7CgoKCgoKCmV4dGVybiBESVIgKm9wZW5kaXIgKGNvbnN0IGNoYXIgKl9fbmFt
ZSkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgxKSkpOwoKCgoKCgpleHRlcm4gRElSICpm
ZG9wZW5kaXIgKGludCBfX2ZkKTsKCgoKCgoKCmV4dGVybiBpbnQgY2xvc2VkaXIgKERJUiAqX19k
aXJwKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CiMgMTYyICIvdXNyL2luY2x1
ZGUvZGlyZW50LmgiIDMgNApleHRlcm4gc3RydWN0IGRpcmVudCAqcmVhZGRpciAoRElSICpfX2Rp
cnApIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKIyAxNzMgIi91c3IvaW5jbHVk
ZS9kaXJlbnQuaCIgMyA0CmV4dGVybiBzdHJ1Y3QgZGlyZW50NjQgKnJlYWRkaXI2NCAoRElSICpf
X2RpcnApIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSkpKTsKIyAxODMgIi91c3IvaW5j
bHVkZS9kaXJlbnQuaCIgMyA0CmV4dGVybiBpbnQgcmVhZGRpcl9yIChESVIgKl9fcmVzdHJpY3Qg
X19kaXJwLAogICAgICAgIHN0cnVjdCBkaXJlbnQgKl9fcmVzdHJpY3QgX19lbnRyeSwKICAgICAg
ICBzdHJ1Y3QgZGlyZW50ICoqX19yZXN0cmljdCBfX3Jlc3VsdCkKICAgICBfX2F0dHJpYnV0ZV9f
ICgoX19ub25udWxsX18gKDEsIDIsIDMpKSk7CiMgMjAwICIvdXNyL2luY2x1ZGUvZGlyZW50Lmgi
IDMgNApleHRlcm4gaW50IHJlYWRkaXI2NF9yIChESVIgKl9fcmVzdHJpY3QgX19kaXJwLAogICBz
dHJ1Y3QgZGlyZW50NjQgKl9fcmVzdHJpY3QgX19lbnRyeSwKICAgc3RydWN0IGRpcmVudDY0ICoq
X19yZXN0cmljdCBfX3Jlc3VsdCkKICAgICBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEs
IDIsIDMpKSk7CgoKCgpleHRlcm4gdm9pZCByZXdpbmRkaXIgKERJUiAqX19kaXJwKSB0aHJvdyAo
KSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoKZXh0ZXJuIHZvaWQgc2Vl
a2RpciAoRElSICpfX2RpcnAsIGxvbmcgaW50IF9fcG9zKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9f
ICgoX19ub25udWxsX18gKDEpKSk7CgoKZXh0ZXJuIGxvbmcgaW50IHRlbGxkaXIgKERJUiAqX19k
aXJwKSB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEpKSk7CgoKCgoKZXh0
ZXJuIGludCBkaXJmZCAoRElSICpfX2RpcnApIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMSkpKTsKIyAyMzIgIi91c3IvaW5jbHVkZS9kaXJlbnQuaCIgMyA0CiMgMSAiL3Vz
ci9pbmNsdWRlL2JpdHMvcG9zaXgxX2xpbS5oIiAxIDMgNAojIDE2MCAiL3Vzci9pbmNsdWRlL2Jp
dHMvcG9zaXgxX2xpbS5oIiAzIDQKIyAxICIvdXNyL2luY2x1ZGUvYml0cy9sb2NhbF9saW0uaCIg
MSAzIDQKIyAzOCAiL3Vzci9pbmNsdWRlL2JpdHMvbG9jYWxfbGltLmgiIDMgNAojIDEgIi91c3Iv
aW5jbHVkZS9saW51eC9saW1pdHMuaCIgMSAzIDQKIyAzOSAiL3Vzci9pbmNsdWRlL2JpdHMvbG9j
YWxfbGltLmgiIDIgMyA0CiMgMTYxICIvdXNyL2luY2x1ZGUvYml0cy9wb3NpeDFfbGltLmgiIDIg
MyA0CiMgMjMzICIvdXNyL2luY2x1ZGUvZGlyZW50LmgiIDIgMyA0CiMgMjQ0ICIvdXNyL2luY2x1
ZGUvZGlyZW50LmgiIDMgNAojIDEgIi91c3IvbGliL2djYy9zMzkweC1yZWRoYXQtbGludXgvNi4w
LjAvaW5jbHVkZS9zdGRkZWYuaCIgMSAzIDQKIyAyNDUgIi91c3IvaW5jbHVkZS9kaXJlbnQuaCIg
MiAzIDQKIyAyNTQgIi91c3IvaW5jbHVkZS9kaXJlbnQuaCIgMyA0CmV4dGVybiBpbnQgc2NhbmRp
ciAoY29uc3QgY2hhciAqX19yZXN0cmljdCBfX2RpciwKICAgICAgc3RydWN0IGRpcmVudCAqKipf
X3Jlc3RyaWN0IF9fbmFtZWxpc3QsCiAgICAgIGludCAoKl9fc2VsZWN0b3IpIChjb25zdCBzdHJ1
Y3QgZGlyZW50ICopLAogICAgICBpbnQgKCpfX2NtcCkgKGNvbnN0IHN0cnVjdCBkaXJlbnQgKios
CiAgICAgIGNvbnN0IHN0cnVjdCBkaXJlbnQgKiopKQogICAgIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMSwgMikpKTsKIyAyNzcgIi91c3IvaW5jbHVkZS9kaXJlbnQuaCIgMyA0CmV4dGVy
biBpbnQgc2NhbmRpcjY0IChjb25zdCBjaGFyICpfX3Jlc3RyaWN0IF9fZGlyLAogICAgICAgIHN0
cnVjdCBkaXJlbnQ2NCAqKipfX3Jlc3RyaWN0IF9fbmFtZWxpc3QsCiAgICAgICAgaW50ICgqX19z
ZWxlY3RvcikgKGNvbnN0IHN0cnVjdCBkaXJlbnQ2NCAqKSwKICAgICAgICBpbnQgKCpfX2NtcCkg
KGNvbnN0IHN0cnVjdCBkaXJlbnQ2NCAqKiwKICAgICAgICBjb25zdCBzdHJ1Y3QgZGlyZW50NjQg
KiopKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKIyAyOTIgIi91
c3IvaW5jbHVkZS9kaXJlbnQuaCIgMyA0CmV4dGVybiBpbnQgc2NhbmRpcmF0IChpbnQgX19kZmQs
IGNvbnN0IGNoYXIgKl9fcmVzdHJpY3QgX19kaXIsCiAgICAgICAgc3RydWN0IGRpcmVudCAqKipf
X3Jlc3RyaWN0IF9fbmFtZWxpc3QsCiAgICAgICAgaW50ICgqX19zZWxlY3RvcikgKGNvbnN0IHN0
cnVjdCBkaXJlbnQgKiksCiAgICAgICAgaW50ICgqX19jbXApIChjb25zdCBzdHJ1Y3QgZGlyZW50
ICoqLAogICAgICAgIGNvbnN0IHN0cnVjdCBkaXJlbnQgKiopKQogICAgIF9fYXR0cmlidXRlX18g
KChfX25vbm51bGxfXyAoMiwgMykpKTsKIyAzMTQgIi91c3IvaW5jbHVkZS9kaXJlbnQuaCIgMyA0
CmV4dGVybiBpbnQgc2NhbmRpcmF0NjQgKGludCBfX2RmZCwgY29uc3QgY2hhciAqX19yZXN0cmlj
dCBfX2RpciwKICAgc3RydWN0IGRpcmVudDY0ICoqKl9fcmVzdHJpY3QgX19uYW1lbGlzdCwKICAg
aW50ICgqX19zZWxlY3RvcikgKGNvbnN0IHN0cnVjdCBkaXJlbnQ2NCAqKSwKICAgaW50ICgqX19j
bXApIChjb25zdCBzdHJ1Y3QgZGlyZW50NjQgKiosCiAgICAgICAgICBjb25zdCBzdHJ1Y3QgZGly
ZW50NjQgKiopKQogICAgIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMiwgMykpKTsKCgoK
CmV4dGVybiBpbnQgYWxwaGFzb3J0IChjb25zdCBzdHJ1Y3QgZGlyZW50ICoqX19lMSwKICAgICAg
ICBjb25zdCBzdHJ1Y3QgZGlyZW50ICoqX19lMikKICAgICB0aHJvdyAoKSBfX2F0dHJpYnV0ZV9f
ICgoX19wdXJlX18pKSBfX2F0dHJpYnV0ZV9fICgoX19ub25udWxsX18gKDEsIDIpKSk7CiMgMzM5
ICIvdXNyL2luY2x1ZGUvZGlyZW50LmgiIDMgNApleHRlcm4gaW50IGFscGhhc29ydDY0IChjb25z
dCBzdHJ1Y3QgZGlyZW50NjQgKipfX2UxLAogICBjb25zdCBzdHJ1Y3QgZGlyZW50NjQgKipfX2Uy
KQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18g
KChfX25vbm51bGxfXyAoMSwgMikpKTsKIyAzNTIgIi91c3IvaW5jbHVkZS9kaXJlbnQuaCIgMyA0
CmV4dGVybiBfX3NzaXplX3QgZ2V0ZGlyZW50cmllcyAoaW50IF9fZmQsIGNoYXIgKl9fcmVzdHJp
Y3QgX19idWYsCiAgICBzaXplX3QgX19uYnl0ZXMsCiAgICBfX29mZl90ICpfX3Jlc3RyaWN0IF9f
YmFzZXApCiAgICAgdGhyb3cgKCkgX19hdHRyaWJ1dGVfXyAoKF9fbm9ubnVsbF9fICgyLCA0KSkp
OwojIDM2OSAiL3Vzci9pbmNsdWRlL2RpcmVudC5oIiAzIDQKZXh0ZXJuIF9fc3NpemVfdCBnZXRk
aXJlbnRyaWVzNjQgKGludCBfX2ZkLCBjaGFyICpfX3Jlc3RyaWN0IF9fYnVmLAogICAgICBzaXpl
X3QgX19uYnl0ZXMsCiAgICAgIF9fb2ZmNjRfdCAqX19yZXN0cmljdCBfX2Jhc2VwKQogICAgIHRo
cm93ICgpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMiwgNCkpKTsKCgoKCgoKZXh0ZXJu
IGludCB2ZXJzaW9uc29ydCAoY29uc3Qgc3RydWN0IGRpcmVudCAqKl9fZTEsCiAgIGNvbnN0IHN0
cnVjdCBkaXJlbnQgKipfX2UyKQogICAgIHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3B1cmVf
XykpIF9fYXR0cmlidXRlX18gKChfX25vbm51bGxfXyAoMSwgMikpKTsKIyAzOTUgIi91c3IvaW5j
bHVkZS9kaXJlbnQuaCIgMyA0CmV4dGVybiBpbnQgdmVyc2lvbnNvcnQ2NCAoY29uc3Qgc3RydWN0
IGRpcmVudDY0ICoqX19lMSwKICAgICBjb25zdCBzdHJ1Y3QgZGlyZW50NjQgKipfX2UyKQogICAg
IHRocm93ICgpIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fYXR0cmlidXRlX18gKChfX25v
bm51bGxfXyAoMSwgMikpKTsKCgoKfQojIDUzICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWkt
bGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5jYyIgMgojIDEgIi91c3IvaW5jbHVkZS9j
KysvNi4wLjAvZnN0cmVhbSIgMSAzCiMgMzYgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVh
bSIgMwogICAgICAgCiMgMzcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMwoKCgoj
IDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9jb2RlY3Z0LmgiIDEgMwojIDM5ICIvdXNy
L2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvY29kZWN2dC5oIiAzCiAgICAgICAKIyA0MCAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9iaXRzL2NvZGVjdnQuaCIgMwoKbmFtZXNwYWNlIHN0ZCBfX2F0dHJp
YnV0ZV9fICgoX192aXNpYmlsaXR5X18gKCJkZWZhdWx0IikpKQp7CgoKCiAgY2xhc3MgY29kZWN2
dF9iYXNlCiAgewogIHB1YmxpYzoKICAgIGVudW0gcmVzdWx0CiAgICB7CiAgICAgIG9rLAogICAg
ICBwYXJ0aWFsLAogICAgICBlcnJvciwKICAgICAgbm9jb252CiAgICB9OwogIH07CiMgNjcgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9jb2RlY3Z0LmgiIDMKICB0ZW1wbGF0ZTx0eXBlbmFt
ZSBfSW50ZXJuVCwgdHlwZW5hbWUgX0V4dGVyblQsIHR5cGVuYW1lIF9TdGF0ZVQ+CiAgICBjbGFz
cyBfX2NvZGVjdnRfYWJzdHJhY3RfYmFzZQogICAgOiBwdWJsaWMgbG9jYWxlOjpmYWNldCwgcHVi
bGljIGNvZGVjdnRfYmFzZQogICAgewogICAgcHVibGljOgoKICAgICAgdHlwZWRlZiBjb2RlY3Z0
X2Jhc2U6OnJlc3VsdCByZXN1bHQ7CiAgICAgIHR5cGVkZWYgX0ludGVyblQgaW50ZXJuX3R5cGU7
CiAgICAgIHR5cGVkZWYgX0V4dGVyblQgZXh0ZXJuX3R5cGU7CiAgICAgIHR5cGVkZWYgX1N0YXRl
VCBzdGF0ZV90eXBlOwojIDExNSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2NvZGVjdnQu
aCIgMwogICAgICByZXN1bHQKICAgICAgb3V0KHN0YXRlX3R5cGUmIF9fc3RhdGUsIGNvbnN0IGlu
dGVybl90eXBlKiBfX2Zyb20sCiAgIGNvbnN0IGludGVybl90eXBlKiBfX2Zyb21fZW5kLCBjb25z
dCBpbnRlcm5fdHlwZSomIF9fZnJvbV9uZXh0LAogICBleHRlcm5fdHlwZSogX190bywgZXh0ZXJu
X3R5cGUqIF9fdG9fZW5kLAogICBleHRlcm5fdHlwZSomIF9fdG9fbmV4dCkgY29uc3QKICAgICAg
ewogcmV0dXJuIHRoaXMtPmRvX291dChfX3N0YXRlLCBfX2Zyb20sIF9fZnJvbV9lbmQsIF9fZnJv
bV9uZXh0LAogICAgICAgX190bywgX190b19lbmQsIF9fdG9fbmV4dCk7CiAgICAgIH0KIyAxNTQg
Ii91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9jb2RlY3Z0LmgiIDMKICAgICAgcmVzdWx0CiAg
ICAgIHVuc2hpZnQoc3RhdGVfdHlwZSYgX19zdGF0ZSwgZXh0ZXJuX3R5cGUqIF9fdG8sIGV4dGVy
bl90eXBlKiBfX3RvX2VuZCwKICAgICAgIGV4dGVybl90eXBlKiYgX190b19uZXh0KSBjb25zdAog
ICAgICB7IHJldHVybiB0aGlzLT5kb191bnNoaWZ0KF9fc3RhdGUsIF9fdG8sX190b19lbmQsX190
b19uZXh0KTsgfQojIDE5NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9iaXRzL2NvZGVjdnQuaCIg
MwogICAgICByZXN1bHQKICAgICAgaW4oc3RhdGVfdHlwZSYgX19zdGF0ZSwgY29uc3QgZXh0ZXJu
X3R5cGUqIF9fZnJvbSwKICBjb25zdCBleHRlcm5fdHlwZSogX19mcm9tX2VuZCwgY29uc3QgZXh0
ZXJuX3R5cGUqJiBfX2Zyb21fbmV4dCwKICBpbnRlcm5fdHlwZSogX190bywgaW50ZXJuX3R5cGUq
IF9fdG9fZW5kLAogIGludGVybl90eXBlKiYgX190b19uZXh0KSBjb25zdAogICAgICB7CiByZXR1
cm4gdGhpcy0+ZG9faW4oX19zdGF0ZSwgX19mcm9tLCBfX2Zyb21fZW5kLCBfX2Zyb21fbmV4dCwK
ICAgICAgX190bywgX190b19lbmQsIF9fdG9fbmV4dCk7CiAgICAgIH0KCiAgICAgIGludAogICAg
ICBlbmNvZGluZygpIGNvbnN0IHRocm93KCkKICAgICAgeyByZXR1cm4gdGhpcy0+ZG9fZW5jb2Rp
bmcoKTsgfQoKICAgICAgYm9vbAogICAgICBhbHdheXNfbm9jb252KCkgY29uc3QgdGhyb3coKQog
ICAgICB7IHJldHVybiB0aGlzLT5kb19hbHdheXNfbm9jb252KCk7IH0KCiAgICAgIGludAogICAg
ICBsZW5ndGgoc3RhdGVfdHlwZSYgX19zdGF0ZSwgY29uc3QgZXh0ZXJuX3R5cGUqIF9fZnJvbSwK
ICAgICAgY29uc3QgZXh0ZXJuX3R5cGUqIF9fZW5kLCBzaXplX3QgX19tYXgpIGNvbnN0CiAgICAg
IHsgcmV0dXJuIHRoaXMtPmRvX2xlbmd0aChfX3N0YXRlLCBfX2Zyb20sIF9fZW5kLCBfX21heCk7
IH0KCiAgICAgIGludAogICAgICBtYXhfbGVuZ3RoKCkgY29uc3QgdGhyb3coKQogICAgICB7IHJl
dHVybiB0aGlzLT5kb19tYXhfbGVuZ3RoKCk7IH0KCiAgICBwcm90ZWN0ZWQ6CiAgICAgIGV4cGxp
Y2l0CiAgICAgIF9fY29kZWN2dF9hYnN0cmFjdF9iYXNlKHNpemVfdCBfX3JlZnMgPSAwKSA6IGxv
Y2FsZTo6ZmFjZXQoX19yZWZzKSB7IH0KCiAgICAgIHZpcnR1YWwKICAgICAgfl9fY29kZWN2dF9h
YnN0cmFjdF9iYXNlKCkgeyB9CiMgMjM2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMvY29k
ZWN2dC5oIiAzCiAgICAgIHZpcnR1YWwgcmVzdWx0CiAgICAgIGRvX291dChzdGF0ZV90eXBlJiBf
X3N0YXRlLCBjb25zdCBpbnRlcm5fdHlwZSogX19mcm9tLAogICAgICBjb25zdCBpbnRlcm5fdHlw
ZSogX19mcm9tX2VuZCwgY29uc3QgaW50ZXJuX3R5cGUqJiBfX2Zyb21fbmV4dCwKICAgICAgZXh0
ZXJuX3R5cGUqIF9fdG8sIGV4dGVybl90eXBlKiBfX3RvX2VuZCwKICAgICAgZXh0ZXJuX3R5cGUq
JiBfX3RvX25leHQpIGNvbnN0ID0gMDsKCiAgICAgIHZpcnR1YWwgcmVzdWx0CiAgICAgIGRvX3Vu
c2hpZnQoc3RhdGVfdHlwZSYgX19zdGF0ZSwgZXh0ZXJuX3R5cGUqIF9fdG8sCiAgIGV4dGVybl90
eXBlKiBfX3RvX2VuZCwgZXh0ZXJuX3R5cGUqJiBfX3RvX25leHQpIGNvbnN0ID0gMDsKCiAgICAg
IHZpcnR1YWwgcmVzdWx0CiAgICAgIGRvX2luKHN0YXRlX3R5cGUmIF9fc3RhdGUsIGNvbnN0IGV4
dGVybl90eXBlKiBfX2Zyb20sCiAgICAgY29uc3QgZXh0ZXJuX3R5cGUqIF9fZnJvbV9lbmQsIGNv
bnN0IGV4dGVybl90eXBlKiYgX19mcm9tX25leHQsCiAgICAgaW50ZXJuX3R5cGUqIF9fdG8sIGlu
dGVybl90eXBlKiBfX3RvX2VuZCwKICAgICBpbnRlcm5fdHlwZSomIF9fdG9fbmV4dCkgY29uc3Qg
PSAwOwoKICAgICAgdmlydHVhbCBpbnQKICAgICAgZG9fZW5jb2RpbmcoKSBjb25zdCB0aHJvdygp
ID0gMDsKCiAgICAgIHZpcnR1YWwgYm9vbAogICAgICBkb19hbHdheXNfbm9jb252KCkgY29uc3Qg
dGhyb3coKSA9IDA7CgogICAgICB2aXJ0dWFsIGludAogICAgICBkb19sZW5ndGgoc3RhdGVfdHlw
ZSYsIGNvbnN0IGV4dGVybl90eXBlKiBfX2Zyb20sCiAgY29uc3QgZXh0ZXJuX3R5cGUqIF9fZW5k
LCBzaXplX3QgX19tYXgpIGNvbnN0ID0gMDsKCiAgICAgIHZpcnR1YWwgaW50CiAgICAgIGRvX21h
eF9sZW5ndGgoKSBjb25zdCB0aHJvdygpID0gMDsKICAgIH07CiMgMjczICIvdXNyL2luY2x1ZGUv
YysrLzYuMC4wL2JpdHMvY29kZWN2dC5oIiAzCiAgIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnRlcm5U
LCB0eXBlbmFtZSBfRXh0ZXJuVCwgdHlwZW5hbWUgX1N0YXRlVD4KICAgIGNsYXNzIGNvZGVjdnQK
ICAgIDogcHVibGljIF9fY29kZWN2dF9hYnN0cmFjdF9iYXNlPF9JbnRlcm5ULCBfRXh0ZXJuVCwg
X1N0YXRlVD4KICAgIHsKICAgIHB1YmxpYzoKCiAgICAgIHR5cGVkZWYgY29kZWN2dF9iYXNlOjpy
ZXN1bHQgcmVzdWx0OwogICAgICB0eXBlZGVmIF9JbnRlcm5UIGludGVybl90eXBlOwogICAgICB0
eXBlZGVmIF9FeHRlcm5UIGV4dGVybl90eXBlOwogICAgICB0eXBlZGVmIF9TdGF0ZVQgc3RhdGVf
dHlwZTsKCiAgICBwcm90ZWN0ZWQ6CiAgICAgIF9fY19sb2NhbGUgX01fY19sb2NhbGVfY29kZWN2
dDsKCiAgICBwdWJsaWM6CiAgICAgIHN0YXRpYyBsb2NhbGU6OmlkIGlkOwoKICAgICAgZXhwbGlj
aXQKICAgICAgY29kZWN2dChzaXplX3QgX19yZWZzID0gMCkKICAgICAgOiBfX2NvZGVjdnRfYWJz
dHJhY3RfYmFzZTxfSW50ZXJuVCwgX0V4dGVyblQsIF9TdGF0ZVQ+IChfX3JlZnMpLAogX01fY19s
b2NhbGVfY29kZWN2dCgwKQogICAgICB7IH0KCiAgICAgIGV4cGxpY2l0CiAgICAgIGNvZGVjdnQo
X19jX2xvY2FsZSBfX2Nsb2MsIHNpemVfdCBfX3JlZnMgPSAwKTsKCiAgICBwcm90ZWN0ZWQ6CiAg
ICAgIHZpcnR1YWwKICAgICAgfmNvZGVjdnQoKSB7IH0KCiAgICAgIHZpcnR1YWwgcmVzdWx0CiAg
ICAgIGRvX291dChzdGF0ZV90eXBlJiBfX3N0YXRlLCBjb25zdCBpbnRlcm5fdHlwZSogX19mcm9t
LAogICAgICBjb25zdCBpbnRlcm5fdHlwZSogX19mcm9tX2VuZCwgY29uc3QgaW50ZXJuX3R5cGUq
JiBfX2Zyb21fbmV4dCwKICAgICAgZXh0ZXJuX3R5cGUqIF9fdG8sIGV4dGVybl90eXBlKiBfX3Rv
X2VuZCwKICAgICAgZXh0ZXJuX3R5cGUqJiBfX3RvX25leHQpIGNvbnN0OwoKICAgICAgdmlydHVh
bCByZXN1bHQKICAgICAgZG9fdW5zaGlmdChzdGF0ZV90eXBlJiBfX3N0YXRlLCBleHRlcm5fdHlw
ZSogX190bywKICAgZXh0ZXJuX3R5cGUqIF9fdG9fZW5kLCBleHRlcm5fdHlwZSomIF9fdG9fbmV4
dCkgY29uc3Q7CgogICAgICB2aXJ0dWFsIHJlc3VsdAogICAgICBkb19pbihzdGF0ZV90eXBlJiBf
X3N0YXRlLCBjb25zdCBleHRlcm5fdHlwZSogX19mcm9tLAogICAgIGNvbnN0IGV4dGVybl90eXBl
KiBfX2Zyb21fZW5kLCBjb25zdCBleHRlcm5fdHlwZSomIF9fZnJvbV9uZXh0LAogICAgIGludGVy
bl90eXBlKiBfX3RvLCBpbnRlcm5fdHlwZSogX190b19lbmQsCiAgICAgaW50ZXJuX3R5cGUqJiBf
X3RvX25leHQpIGNvbnN0OwoKICAgICAgdmlydHVhbCBpbnQKICAgICAgZG9fZW5jb2RpbmcoKSBj
b25zdCB0aHJvdygpOwoKICAgICAgdmlydHVhbCBib29sCiAgICAgIGRvX2Fsd2F5c19ub2NvbnYo
KSBjb25zdCB0aHJvdygpOwoKICAgICAgdmlydHVhbCBpbnQKICAgICAgZG9fbGVuZ3RoKHN0YXRl
X3R5cGUmLCBjb25zdCBleHRlcm5fdHlwZSogX19mcm9tLAogIGNvbnN0IGV4dGVybl90eXBlKiBf
X2VuZCwgc2l6ZV90IF9fbWF4KSBjb25zdDsKCiAgICAgIHZpcnR1YWwgaW50CiAgICAgIGRvX21h
eF9sZW5ndGgoKSBjb25zdCB0aHJvdygpOwogICAgfTsKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0lu
dGVyblQsIHR5cGVuYW1lIF9FeHRlcm5ULCB0eXBlbmFtZSBfU3RhdGVUPgogICAgbG9jYWxlOjpp
ZCBjb2RlY3Z0PF9JbnRlcm5ULCBfRXh0ZXJuVCwgX1N0YXRlVD46OmlkOwoKCiAgdGVtcGxhdGU8
PgogICAgY2xhc3MgY29kZWN2dDxjaGFyLCBjaGFyLCBtYnN0YXRlX3Q+CiAgICA6IHB1YmxpYyBf
X2NvZGVjdnRfYWJzdHJhY3RfYmFzZTxjaGFyLCBjaGFyLCBtYnN0YXRlX3Q+CiAgICB7CiAgICAg
IGZyaWVuZCBjbGFzcyBtZXNzYWdlczxjaGFyPjsKCiAgICBwdWJsaWM6CgogICAgICB0eXBlZGVm
IGNoYXIgaW50ZXJuX3R5cGU7CiAgICAgIHR5cGVkZWYgY2hhciBleHRlcm5fdHlwZTsKICAgICAg
dHlwZWRlZiBtYnN0YXRlX3Qgc3RhdGVfdHlwZTsKCiAgICBwcm90ZWN0ZWQ6CiAgICAgIF9fY19s
b2NhbGUgX01fY19sb2NhbGVfY29kZWN2dDsKCiAgICBwdWJsaWM6CiAgICAgIHN0YXRpYyBsb2Nh
bGU6OmlkIGlkOwoKICAgICAgZXhwbGljaXQKICAgICAgY29kZWN2dChzaXplX3QgX19yZWZzID0g
MCk7CgogICAgICBleHBsaWNpdAogICAgICBjb2RlY3Z0KF9fY19sb2NhbGUgX19jbG9jLCBzaXpl
X3QgX19yZWZzID0gMCk7CgogICAgcHJvdGVjdGVkOgogICAgICB2aXJ0dWFsCiAgICAgIH5jb2Rl
Y3Z0KCk7CgogICAgICB2aXJ0dWFsIHJlc3VsdAogICAgICBkb19vdXQoc3RhdGVfdHlwZSYgX19z
dGF0ZSwgY29uc3QgaW50ZXJuX3R5cGUqIF9fZnJvbSwKICAgICAgY29uc3QgaW50ZXJuX3R5cGUq
IF9fZnJvbV9lbmQsIGNvbnN0IGludGVybl90eXBlKiYgX19mcm9tX25leHQsCiAgICAgIGV4dGVy
bl90eXBlKiBfX3RvLCBleHRlcm5fdHlwZSogX190b19lbmQsCiAgICAgIGV4dGVybl90eXBlKiYg
X190b19uZXh0KSBjb25zdDsKCiAgICAgIHZpcnR1YWwgcmVzdWx0CiAgICAgIGRvX3Vuc2hpZnQo
c3RhdGVfdHlwZSYgX19zdGF0ZSwgZXh0ZXJuX3R5cGUqIF9fdG8sCiAgIGV4dGVybl90eXBlKiBf
X3RvX2VuZCwgZXh0ZXJuX3R5cGUqJiBfX3RvX25leHQpIGNvbnN0OwoKICAgICAgdmlydHVhbCBy
ZXN1bHQKICAgICAgZG9faW4oc3RhdGVfdHlwZSYgX19zdGF0ZSwgY29uc3QgZXh0ZXJuX3R5cGUq
IF9fZnJvbSwKICAgICBjb25zdCBleHRlcm5fdHlwZSogX19mcm9tX2VuZCwgY29uc3QgZXh0ZXJu
X3R5cGUqJiBfX2Zyb21fbmV4dCwKICAgICBpbnRlcm5fdHlwZSogX190bywgaW50ZXJuX3R5cGUq
IF9fdG9fZW5kLAogICAgIGludGVybl90eXBlKiYgX190b19uZXh0KSBjb25zdDsKCiAgICAgIHZp
cnR1YWwgaW50CiAgICAgIGRvX2VuY29kaW5nKCkgY29uc3QgdGhyb3coKTsKCiAgICAgIHZpcnR1
YWwgYm9vbAogICAgICBkb19hbHdheXNfbm9jb252KCkgY29uc3QgdGhyb3coKTsKCiAgICAgIHZp
cnR1YWwgaW50CiAgICAgIGRvX2xlbmd0aChzdGF0ZV90eXBlJiwgY29uc3QgZXh0ZXJuX3R5cGUq
IF9fZnJvbSwKICBjb25zdCBleHRlcm5fdHlwZSogX19lbmQsIHNpemVfdCBfX21heCkgY29uc3Q7
CgogICAgICB2aXJ0dWFsIGludAogICAgICBkb19tYXhfbGVuZ3RoKCkgY29uc3QgdGhyb3coKTsK
ICB9OwoKCgoKCgogIHRlbXBsYXRlPD4KICAgIGNsYXNzIGNvZGVjdnQ8d2NoYXJfdCwgY2hhciwg
bWJzdGF0ZV90PgogICAgOiBwdWJsaWMgX19jb2RlY3Z0X2Fic3RyYWN0X2Jhc2U8d2NoYXJfdCwg
Y2hhciwgbWJzdGF0ZV90PgogICAgewogICAgICBmcmllbmQgY2xhc3MgbWVzc2FnZXM8d2NoYXJf
dD47CgogICAgcHVibGljOgoKICAgICAgdHlwZWRlZiB3Y2hhcl90IGludGVybl90eXBlOwogICAg
ICB0eXBlZGVmIGNoYXIgZXh0ZXJuX3R5cGU7CiAgICAgIHR5cGVkZWYgbWJzdGF0ZV90IHN0YXRl
X3R5cGU7CgogICAgcHJvdGVjdGVkOgogICAgICBfX2NfbG9jYWxlIF9NX2NfbG9jYWxlX2NvZGVj
dnQ7CgogICAgcHVibGljOgogICAgICBzdGF0aWMgbG9jYWxlOjppZCBpZDsKCiAgICAgIGV4cGxp
Y2l0CiAgICAgIGNvZGVjdnQoc2l6ZV90IF9fcmVmcyA9IDApOwoKICAgICAgZXhwbGljaXQKICAg
ICAgY29kZWN2dChfX2NfbG9jYWxlIF9fY2xvYywgc2l6ZV90IF9fcmVmcyA9IDApOwoKICAgIHBy
b3RlY3RlZDoKICAgICAgdmlydHVhbAogICAgICB+Y29kZWN2dCgpOwoKICAgICAgdmlydHVhbCBy
ZXN1bHQKICAgICAgZG9fb3V0KHN0YXRlX3R5cGUmIF9fc3RhdGUsIGNvbnN0IGludGVybl90eXBl
KiBfX2Zyb20sCiAgICAgIGNvbnN0IGludGVybl90eXBlKiBfX2Zyb21fZW5kLCBjb25zdCBpbnRl
cm5fdHlwZSomIF9fZnJvbV9uZXh0LAogICAgICBleHRlcm5fdHlwZSogX190bywgZXh0ZXJuX3R5
cGUqIF9fdG9fZW5kLAogICAgICBleHRlcm5fdHlwZSomIF9fdG9fbmV4dCkgY29uc3Q7CgogICAg
ICB2aXJ0dWFsIHJlc3VsdAogICAgICBkb191bnNoaWZ0KHN0YXRlX3R5cGUmIF9fc3RhdGUsCiAg
IGV4dGVybl90eXBlKiBfX3RvLCBleHRlcm5fdHlwZSogX190b19lbmQsCiAgIGV4dGVybl90eXBl
KiYgX190b19uZXh0KSBjb25zdDsKCiAgICAgIHZpcnR1YWwgcmVzdWx0CiAgICAgIGRvX2luKHN0
YXRlX3R5cGUmIF9fc3RhdGUsCiAgICAgIGNvbnN0IGV4dGVybl90eXBlKiBfX2Zyb20sIGNvbnN0
IGV4dGVybl90eXBlKiBfX2Zyb21fZW5kLAogICAgICBjb25zdCBleHRlcm5fdHlwZSomIF9fZnJv
bV9uZXh0LAogICAgICBpbnRlcm5fdHlwZSogX190bywgaW50ZXJuX3R5cGUqIF9fdG9fZW5kLAog
ICAgICBpbnRlcm5fdHlwZSomIF9fdG9fbmV4dCkgY29uc3Q7CgogICAgICB2aXJ0dWFsCiAgICAg
IGludCBkb19lbmNvZGluZygpIGNvbnN0IHRocm93KCk7CgogICAgICB2aXJ0dWFsCiAgICAgIGJv
b2wgZG9fYWx3YXlzX25vY29udigpIGNvbnN0IHRocm93KCk7CgogICAgICB2aXJ0dWFsCiAgICAg
IGludCBkb19sZW5ndGgoc3RhdGVfdHlwZSYsIGNvbnN0IGV4dGVybl90eXBlKiBfX2Zyb20sCiAg
ICAgIGNvbnN0IGV4dGVybl90eXBlKiBfX2VuZCwgc2l6ZV90IF9fbWF4KSBjb25zdDsKCiAgICAg
IHZpcnR1YWwgaW50CiAgICAgIGRvX21heF9sZW5ndGgoKSBjb25zdCB0aHJvdygpOwogICAgfTsK
IyA0NjcgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvYml0cy9jb2RlY3Z0LmgiIDMKICB0ZW1wbGF0
ZTw+CiAgICBjbGFzcyBjb2RlY3Z0PGNoYXIxNl90LCBjaGFyLCBtYnN0YXRlX3Q+CiAgICA6IHB1
YmxpYyBfX2NvZGVjdnRfYWJzdHJhY3RfYmFzZTxjaGFyMTZfdCwgY2hhciwgbWJzdGF0ZV90Pgog
ICAgewogICAgcHVibGljOgoKICAgICAgdHlwZWRlZiBjaGFyMTZfdCBpbnRlcm5fdHlwZTsKICAg
ICAgdHlwZWRlZiBjaGFyIGV4dGVybl90eXBlOwogICAgICB0eXBlZGVmIG1ic3RhdGVfdCBzdGF0
ZV90eXBlOwoKICAgIHB1YmxpYzoKICAgICAgc3RhdGljIGxvY2FsZTo6aWQgaWQ7CgogICAgICBl
eHBsaWNpdAogICAgICBjb2RlY3Z0KHNpemVfdCBfX3JlZnMgPSAwKQogICAgICA6IF9fY29kZWN2
dF9hYnN0cmFjdF9iYXNlPGNoYXIxNl90LCBjaGFyLCBtYnN0YXRlX3Q+KF9fcmVmcykgeyB9Cgog
ICAgcHJvdGVjdGVkOgogICAgICB2aXJ0dWFsCiAgICAgIH5jb2RlY3Z0KCk7CgogICAgICB2aXJ0
dWFsIHJlc3VsdAogICAgICBkb19vdXQoc3RhdGVfdHlwZSYgX19zdGF0ZSwgY29uc3QgaW50ZXJu
X3R5cGUqIF9fZnJvbSwKICAgICAgY29uc3QgaW50ZXJuX3R5cGUqIF9fZnJvbV9lbmQsIGNvbnN0
IGludGVybl90eXBlKiYgX19mcm9tX25leHQsCiAgICAgIGV4dGVybl90eXBlKiBfX3RvLCBleHRl
cm5fdHlwZSogX190b19lbmQsCiAgICAgIGV4dGVybl90eXBlKiYgX190b19uZXh0KSBjb25zdDsK
CiAgICAgIHZpcnR1YWwgcmVzdWx0CiAgICAgIGRvX3Vuc2hpZnQoc3RhdGVfdHlwZSYgX19zdGF0
ZSwKICAgZXh0ZXJuX3R5cGUqIF9fdG8sIGV4dGVybl90eXBlKiBfX3RvX2VuZCwKICAgZXh0ZXJu
X3R5cGUqJiBfX3RvX25leHQpIGNvbnN0OwoKICAgICAgdmlydHVhbCByZXN1bHQKICAgICAgZG9f
aW4oc3RhdGVfdHlwZSYgX19zdGF0ZSwKICAgICAgY29uc3QgZXh0ZXJuX3R5cGUqIF9fZnJvbSwg
Y29uc3QgZXh0ZXJuX3R5cGUqIF9fZnJvbV9lbmQsCiAgICAgIGNvbnN0IGV4dGVybl90eXBlKiYg
X19mcm9tX25leHQsCiAgICAgIGludGVybl90eXBlKiBfX3RvLCBpbnRlcm5fdHlwZSogX190b19l
bmQsCiAgICAgIGludGVybl90eXBlKiYgX190b19uZXh0KSBjb25zdDsKCiAgICAgIHZpcnR1YWwK
ICAgICAgaW50IGRvX2VuY29kaW5nKCkgY29uc3QgdGhyb3coKTsKCiAgICAgIHZpcnR1YWwKICAg
ICAgYm9vbCBkb19hbHdheXNfbm9jb252KCkgY29uc3QgdGhyb3coKTsKCiAgICAgIHZpcnR1YWwK
ICAgICAgaW50IGRvX2xlbmd0aChzdGF0ZV90eXBlJiwgY29uc3QgZXh0ZXJuX3R5cGUqIF9fZnJv
bSwKICAgICAgY29uc3QgZXh0ZXJuX3R5cGUqIF9fZW5kLCBzaXplX3QgX19tYXgpIGNvbnN0OwoK
ICAgICAgdmlydHVhbCBpbnQKICAgICAgZG9fbWF4X2xlbmd0aCgpIGNvbnN0IHRocm93KCk7CiAg
ICB9OwoKCgoKCiAgdGVtcGxhdGU8PgogICAgY2xhc3MgY29kZWN2dDxjaGFyMzJfdCwgY2hhciwg
bWJzdGF0ZV90PgogICAgOiBwdWJsaWMgX19jb2RlY3Z0X2Fic3RyYWN0X2Jhc2U8Y2hhcjMyX3Qs
IGNoYXIsIG1ic3RhdGVfdD4KICAgIHsKICAgIHB1YmxpYzoKCiAgICAgIHR5cGVkZWYgY2hhcjMy
X3QgaW50ZXJuX3R5cGU7CiAgICAgIHR5cGVkZWYgY2hhciBleHRlcm5fdHlwZTsKICAgICAgdHlw
ZWRlZiBtYnN0YXRlX3Qgc3RhdGVfdHlwZTsKCiAgICBwdWJsaWM6CiAgICAgIHN0YXRpYyBsb2Nh
bGU6OmlkIGlkOwoKICAgICAgZXhwbGljaXQKICAgICAgY29kZWN2dChzaXplX3QgX19yZWZzID0g
MCkKICAgICAgOiBfX2NvZGVjdnRfYWJzdHJhY3RfYmFzZTxjaGFyMzJfdCwgY2hhciwgbWJzdGF0
ZV90PihfX3JlZnMpIHsgfQoKICAgIHByb3RlY3RlZDoKICAgICAgdmlydHVhbAogICAgICB+Y29k
ZWN2dCgpOwoKICAgICAgdmlydHVhbCByZXN1bHQKICAgICAgZG9fb3V0KHN0YXRlX3R5cGUmIF9f
c3RhdGUsIGNvbnN0IGludGVybl90eXBlKiBfX2Zyb20sCiAgICAgIGNvbnN0IGludGVybl90eXBl
KiBfX2Zyb21fZW5kLCBjb25zdCBpbnRlcm5fdHlwZSomIF9fZnJvbV9uZXh0LAogICAgICBleHRl
cm5fdHlwZSogX190bywgZXh0ZXJuX3R5cGUqIF9fdG9fZW5kLAogICAgICBleHRlcm5fdHlwZSom
IF9fdG9fbmV4dCkgY29uc3Q7CgogICAgICB2aXJ0dWFsIHJlc3VsdAogICAgICBkb191bnNoaWZ0
KHN0YXRlX3R5cGUmIF9fc3RhdGUsCiAgIGV4dGVybl90eXBlKiBfX3RvLCBleHRlcm5fdHlwZSog
X190b19lbmQsCiAgIGV4dGVybl90eXBlKiYgX190b19uZXh0KSBjb25zdDsKCiAgICAgIHZpcnR1
YWwgcmVzdWx0CiAgICAgIGRvX2luKHN0YXRlX3R5cGUmIF9fc3RhdGUsCiAgICAgIGNvbnN0IGV4
dGVybl90eXBlKiBfX2Zyb20sIGNvbnN0IGV4dGVybl90eXBlKiBfX2Zyb21fZW5kLAogICAgICBj
b25zdCBleHRlcm5fdHlwZSomIF9fZnJvbV9uZXh0LAogICAgICBpbnRlcm5fdHlwZSogX190bywg
aW50ZXJuX3R5cGUqIF9fdG9fZW5kLAogICAgICBpbnRlcm5fdHlwZSomIF9fdG9fbmV4dCkgY29u
c3Q7CgogICAgICB2aXJ0dWFsCiAgICAgIGludCBkb19lbmNvZGluZygpIGNvbnN0IHRocm93KCk7
CgogICAgICB2aXJ0dWFsCiAgICAgIGJvb2wgZG9fYWx3YXlzX25vY29udigpIGNvbnN0IHRocm93
KCk7CgogICAgICB2aXJ0dWFsCiAgICAgIGludCBkb19sZW5ndGgoc3RhdGVfdHlwZSYsIGNvbnN0
IGV4dGVybl90eXBlKiBfX2Zyb20sCiAgICAgIGNvbnN0IGV4dGVybl90eXBlKiBfX2VuZCwgc2l6
ZV90IF9fbWF4KSBjb25zdDsKCiAgICAgIHZpcnR1YWwgaW50CiAgICAgIGRvX21heF9sZW5ndGgo
KSBjb25zdCB0aHJvdygpOwogICAgfTsKCgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9JbnRlcm5U
LCB0eXBlbmFtZSBfRXh0ZXJuVCwgdHlwZW5hbWUgX1N0YXRlVD4KICAgIGNsYXNzIGNvZGVjdnRf
YnluYW1lIDogcHVibGljIGNvZGVjdnQ8X0ludGVyblQsIF9FeHRlcm5ULCBfU3RhdGVUPgogICAg
ewogICAgcHVibGljOgogICAgICBleHBsaWNpdAogICAgICBjb2RlY3Z0X2J5bmFtZShjb25zdCBj
aGFyKiBfX3MsIHNpemVfdCBfX3JlZnMgPSAwKQogICAgICA6IGNvZGVjdnQ8X0ludGVyblQsIF9F
eHRlcm5ULCBfU3RhdGVUPihfX3JlZnMpCiAgICAgIHsKIGlmIChfX2J1aWx0aW5fc3RyY21wKF9f
cywgIkMiKSAhPSAwCiAgICAgJiYgX19idWlsdGluX3N0cmNtcChfX3MsICJQT1NJWCIpICE9IDAp
CiAgIHsKICAgICB0aGlzLT5fU19kZXN0cm95X2NfbG9jYWxlKHRoaXMtPl9NX2NfbG9jYWxlX2Nv
ZGVjdnQpOwogICAgIHRoaXMtPl9TX2NyZWF0ZV9jX2xvY2FsZSh0aGlzLT5fTV9jX2xvY2FsZV9j
b2RlY3Z0LCBfX3MpOwogICB9CiAgICAgIH0KCgogICAgICBleHBsaWNpdAogICAgICBjb2RlY3Z0
X2J5bmFtZShjb25zdCBzdHJpbmcmIF9fcywgc2l6ZV90IF9fcmVmcyA9IDApCiAgICAgIDogY29k
ZWN2dF9ieW5hbWUoX19zLmNfc3RyKCksIF9fcmVmcykgeyB9CgoKICAgIHByb3RlY3RlZDoKICAg
ICAgdmlydHVhbAogICAgICB+Y29kZWN2dF9ieW5hbWUoKSB7IH0KICAgIH07CgoKICB0ZW1wbGF0
ZTw+CiAgICBjbGFzcyBjb2RlY3Z0X2J5bmFtZTxjaGFyMTZfdCwgY2hhciwgbWJzdGF0ZV90Pgog
ICAgOiBwdWJsaWMgY29kZWN2dDxjaGFyMTZfdCwgY2hhciwgbWJzdGF0ZV90PgogICAgewogICAg
cHVibGljOgogICAgICBleHBsaWNpdAogICAgICBjb2RlY3Z0X2J5bmFtZShjb25zdCBjaGFyKiBf
X3MsIHNpemVfdCBfX3JlZnMgPSAwKQogICAgICA6IGNvZGVjdnQ8Y2hhcjE2X3QsIGNoYXIsIG1i
c3RhdGVfdD4oX19yZWZzKSB7IH0KCiAgICAgIGV4cGxpY2l0CiAgICAgIGNvZGVjdnRfYnluYW1l
KGNvbnN0IHN0cmluZyYgX19zLCBzaXplX3QgX19yZWZzID0gMCkKICAgICAgOiBjb2RlY3Z0X2J5
bmFtZShfX3MuY19zdHIoKSwgX19yZWZzKSB7IH0KCiAgICBwcm90ZWN0ZWQ6CiAgICAgIHZpcnR1
YWwKICAgICAgfmNvZGVjdnRfYnluYW1lKCkgeyB9CiAgICB9OwoKICB0ZW1wbGF0ZTw+CiAgICBj
bGFzcyBjb2RlY3Z0X2J5bmFtZTxjaGFyMzJfdCwgY2hhciwgbWJzdGF0ZV90PgogICAgOiBwdWJs
aWMgY29kZWN2dDxjaGFyMzJfdCwgY2hhciwgbWJzdGF0ZV90PgogICAgewogICAgcHVibGljOgog
ICAgICBleHBsaWNpdAogICAgICBjb2RlY3Z0X2J5bmFtZShjb25zdCBjaGFyKiBfX3MsIHNpemVf
dCBfX3JlZnMgPSAwKQogICAgICA6IGNvZGVjdnQ8Y2hhcjMyX3QsIGNoYXIsIG1ic3RhdGVfdD4o
X19yZWZzKSB7IH0KCiAgICAgIGV4cGxpY2l0CiAgICAgIGNvZGVjdnRfYnluYW1lKGNvbnN0IHN0
cmluZyYgX19zLCBzaXplX3QgX19yZWZzID0gMCkKICAgICAgOiBjb2RlY3Z0X2J5bmFtZShfX3Mu
Y19zdHIoKSwgX19yZWZzKSB7IH0KCiAgICBwcm90ZWN0ZWQ6CiAgICAgIHZpcnR1YWwKICAgICAg
fmNvZGVjdnRfYnluYW1lKCkgeyB9CiAgICB9OwoKCgoKCiAgZXh0ZXJuIHRlbXBsYXRlIGNsYXNz
IGNvZGVjdnRfYnluYW1lPGNoYXIsIGNoYXIsIG1ic3RhdGVfdD47CgogIGV4dGVybiB0ZW1wbGF0
ZQogICAgY29uc3QgY29kZWN2dDxjaGFyLCBjaGFyLCBtYnN0YXRlX3Q+JgogICAgdXNlX2ZhY2V0
PGNvZGVjdnQ8Y2hhciwgY2hhciwgbWJzdGF0ZV90PiA+KGNvbnN0IGxvY2FsZSYpOwoKICBleHRl
cm4gdGVtcGxhdGUKICAgIGJvb2wKICAgIGhhc19mYWNldDxjb2RlY3Z0PGNoYXIsIGNoYXIsIG1i
c3RhdGVfdD4gPihjb25zdCBsb2NhbGUmKTsKCgogIGV4dGVybiB0ZW1wbGF0ZSBjbGFzcyBjb2Rl
Y3Z0X2J5bmFtZTx3Y2hhcl90LCBjaGFyLCBtYnN0YXRlX3Q+OwoKICBleHRlcm4gdGVtcGxhdGUK
ICAgIGNvbnN0IGNvZGVjdnQ8d2NoYXJfdCwgY2hhciwgbWJzdGF0ZV90PiYKICAgIHVzZV9mYWNl
dDxjb2RlY3Z0PHdjaGFyX3QsIGNoYXIsIG1ic3RhdGVfdD4gPihjb25zdCBsb2NhbGUmKTsKCiAg
ZXh0ZXJuIHRlbXBsYXRlCiAgICBib29sCiAgICBoYXNfZmFjZXQ8Y29kZWN2dDx3Y2hhcl90LCBj
aGFyLCBtYnN0YXRlX3Q+ID4oY29uc3QgbG9jYWxlJik7CgoKCiAgZXh0ZXJuIHRlbXBsYXRlIGNs
YXNzIGNvZGVjdnRfYnluYW1lPGNoYXIxNl90LCBjaGFyLCBtYnN0YXRlX3Q+OwogIGV4dGVybiB0
ZW1wbGF0ZSBjbGFzcyBjb2RlY3Z0X2J5bmFtZTxjaGFyMzJfdCwgY2hhciwgbWJzdGF0ZV90PjsK
CgoKCgp9CiMgNDEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMiAzCiMgMSAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9jc3RkaW8iIDEgMwojIDM5ICIvdXNyL2luY2x1ZGUvYysrLzYu
MC4wL2NzdGRpbyIgMwogICAgICAgCiMgNDAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvY3N0ZGlv
IiAzCiMgNDIgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMiAzCiMgMSAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0cy9iYXNpY19maWxlLmgiIDEg
MwojIDM3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2Jh
c2ljX2ZpbGUuaCIgMwogICAgICAgCiMgMzggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvczM5MHgt
cmVkaGF0LWxpbnV4L2JpdHMvYmFzaWNfZmlsZS5oIiAzCgoKIyAxICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2MrK2lvLmgiIDEgMwojIDM1ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2MrK2lvLmgiIDMKIyAxICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2NzdGRpbyIgMSAzCiMgMzkgIi91c3IvaW5jbHVkZS9jKysv
Ni4wLjAvY3N0ZGlvIiAzCiAgICAgICAKIyA0MCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9jc3Rk
aW8iIDMKIyAzNiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9zMzkweC1yZWRoYXQtbGludXgvYml0
cy9jKytpby5oIiAyIDMKCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChfX3Zpc2liaWxp
dHlfXyAoImRlZmF1bHQiKSkpCnsKCgogIHR5cGVkZWYgX19ndGhyZWFkX211dGV4X3QgX19jX2xv
Y2s7CgoKICB0eXBlZGVmIEZJTEUgX19jX2ZpbGU7CgoKfQojIDQxICIvdXNyL2luY2x1ZGUvYysr
LzYuMC4wL3MzOTB4LXJlZGhhdC1saW51eC9iaXRzL2Jhc2ljX2ZpbGUuaCIgMiAzCgoKCm5hbWVz
cGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJpbGl0eV9fICgiZGVmYXVsdCIpKSkKewoK
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVD4KICAgIGNsYXNzIF9fYmFzaWNfZmlsZTsKCgog
IHRlbXBsYXRlPD4KICAgIGNsYXNzIF9fYmFzaWNfZmlsZTxjaGFyPgogICAgewoKICAgICAgX19j
X2ZpbGUqIF9NX2NmaWxlOwoKCiAgICAgIGJvb2wgX01fY2ZpbGVfY3JlYXRlZDsKCiAgICBwdWJs
aWM6CiAgICAgIF9fYmFzaWNfZmlsZShfX2NfbG9jayogX19sb2NrID0gMCkgdGhyb3cgKCk7CgoK
ICAgICAgX19iYXNpY19maWxlKF9fYmFzaWNfZmlsZSYmIF9fcnYsIF9fY19sb2NrKiBfX2xvY2sg
PSAwKSBub2V4Y2VwdAogICAgICA6IF9NX2NmaWxlKF9fcnYuX01fY2ZpbGUpLCBfTV9jZmlsZV9j
cmVhdGVkKF9fcnYuX01fY2ZpbGVfY3JlYXRlZCkKICAgICAgewogX19ydi5fTV9jZmlsZSA9IG51
bGxwdHI7CiBfX3J2Ll9NX2NmaWxlX2NyZWF0ZWQgPSBmYWxzZTsKICAgICAgfQoKICAgICAgX19i
YXNpY19maWxlJiBvcGVyYXRvcj0oY29uc3QgX19iYXNpY19maWxlJikgPSBkZWxldGU7CiAgICAg
IF9fYmFzaWNfZmlsZSYgb3BlcmF0b3I9KF9fYmFzaWNfZmlsZSYmKSA9IGRlbGV0ZTsKCiAgICAg
IHZvaWQKICAgICAgc3dhcChfX2Jhc2ljX2ZpbGUmIF9fZikgbm9leGNlcHQKICAgICAgewogc3Rk
Ojpzd2FwKF9NX2NmaWxlLCBfX2YuX01fY2ZpbGUpOwogc3RkOjpzd2FwKF9NX2NmaWxlX2NyZWF0
ZWQsIF9fZi5fTV9jZmlsZV9jcmVhdGVkKTsKICAgICAgfQoKCiAgICAgIF9fYmFzaWNfZmlsZSoK
ICAgICAgb3Blbihjb25zdCBjaGFyKiBfX25hbWUsIGlvc19iYXNlOjpvcGVubW9kZSBfX21vZGUs
IGludCBfX3Byb3QgPSAwNjY0KTsKCiAgICAgIF9fYmFzaWNfZmlsZSoKICAgICAgc3lzX29wZW4o
X19jX2ZpbGUqIF9fZmlsZSwgaW9zX2Jhc2U6Om9wZW5tb2RlKTsKCiAgICAgIF9fYmFzaWNfZmls
ZSoKICAgICAgc3lzX29wZW4oaW50IF9fZmQsIGlvc19iYXNlOjpvcGVubW9kZSBfX21vZGUpIHRo
cm93ICgpOwoKICAgICAgX19iYXNpY19maWxlKgogICAgICBjbG9zZSgpOwoKICAgICAgX19hdHRy
aWJ1dGVfXyAoKF9fcHVyZV9fKSkgYm9vbAogICAgICBpc19vcGVuKCkgY29uc3QgdGhyb3cgKCk7
CgogICAgICBfX2F0dHJpYnV0ZV9fICgoX19wdXJlX18pKSBpbnQKICAgICAgZmQoKSB0aHJvdyAo
KTsKCiAgICAgIF9fYXR0cmlidXRlX18gKChfX3B1cmVfXykpIF9fY19maWxlKgogICAgICBmaWxl
KCkgdGhyb3cgKCk7CgogICAgICB+X19iYXNpY19maWxlKCk7CgogICAgICBzdHJlYW1zaXplCiAg
ICAgIHhzcHV0bihjb25zdCBjaGFyKiBfX3MsIHN0cmVhbXNpemUgX19uKTsKCiAgICAgIHN0cmVh
bXNpemUKICAgICAgeHNwdXRuXzIoY29uc3QgY2hhciogX19zMSwgc3RyZWFtc2l6ZSBfX24xLAog
ICAgICAgIGNvbnN0IGNoYXIqIF9fczIsIHN0cmVhbXNpemUgX19uMik7CgogICAgICBzdHJlYW1z
aXplCiAgICAgIHhzZ2V0bihjaGFyKiBfX3MsIHN0cmVhbXNpemUgX19uKTsKCiAgICAgIHN0cmVh
bW9mZgogICAgICBzZWVrb2ZmKHN0cmVhbW9mZiBfX29mZiwgaW9zX2Jhc2U6OnNlZWtkaXIgX193
YXkpIHRocm93ICgpOwoKICAgICAgaW50CiAgICAgIHN5bmMoKTsKCiAgICAgIHN0cmVhbXNpemUK
ICAgICAgc2hvd21hbnljKCk7CiAgICB9OwoKCn0KIyA0MyAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9mc3RyZWFtIiAyIDMKCgoKCm5hbWVzcGFjZSBzdGQgX19hdHRyaWJ1dGVfXyAoKF9fdmlzaWJp
bGl0eV9fICgiZGVmYXVsdCIpKSkKewoKIyA3MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9mc3Ry
ZWFtIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAg
Y2xhc3MgYmFzaWNfZmlsZWJ1ZiA6IHB1YmxpYyBiYXNpY19zdHJlYW1idWY8X0NoYXJULCBfVHJh
aXRzPgogICAgewoKICAgICAgdGVtcGxhdGU8dHlwZW5hbWUgX1RwPgogdXNpbmcgX19jaGtfc3Rh
dGUgPSBfX2FuZF88aXNfY29weV9hc3NpZ25hYmxlPF9UcD4sCiAgICAgICBpc19jb3B5X2NvbnN0
cnVjdGlibGU8X1RwPiwKICAgICAgIGlzX2RlZmF1bHRfY29uc3RydWN0aWJsZTxfVHA+PjsKCiAg
ICAgIHN0YXRpY19hc3NlcnQoX19jaGtfc3RhdGU8dHlwZW5hbWUgX1RyYWl0czo6c3RhdGVfdHlw
ZT46OnZhbHVlLAogICAgICAic3RhdGVfdHlwZSBtdXN0IGJlIENvcHlBc3NpZ25hYmxlLCBDb3B5
Q29uc3RydWN0aWJsZSIKICAgICAgIiBhbmQgRGVmYXVsdENvbnN0cnVjdGlibGUiKTsKCiAgICAg
IHN0YXRpY19hc3NlcnQoaXNfc2FtZTx0eXBlbmFtZSBfVHJhaXRzOjpwb3NfdHlwZSwKICAgICAg
IGZwb3M8dHlwZW5hbWUgX1RyYWl0czo6c3RhdGVfdHlwZT4+Ojp2YWx1ZSwKICAgICAgInBvc190
eXBlIG11c3QgYmUgZnBvczxzdGF0ZV90eXBlPiIpOwoKICAgIHB1YmxpYzoKCiAgICAgIHR5cGVk
ZWYgX0NoYXJUIGNoYXJfdHlwZTsKICAgICAgdHlwZWRlZiBfVHJhaXRzIHRyYWl0c190eXBlOwog
ICAgICB0eXBlZGVmIHR5cGVuYW1lIHRyYWl0c190eXBlOjppbnRfdHlwZSBpbnRfdHlwZTsKICAg
ICAgdHlwZWRlZiB0eXBlbmFtZSB0cmFpdHNfdHlwZTo6cG9zX3R5cGUgcG9zX3R5cGU7CiAgICAg
IHR5cGVkZWYgdHlwZW5hbWUgdHJhaXRzX3R5cGU6Om9mZl90eXBlIG9mZl90eXBlOwoKICAgICAg
dHlwZWRlZiBiYXNpY19zdHJlYW1idWY8Y2hhcl90eXBlLCB0cmFpdHNfdHlwZT4gX19zdHJlYW1i
dWZfdHlwZTsKICAgICAgdHlwZWRlZiBiYXNpY19maWxlYnVmPGNoYXJfdHlwZSwgdHJhaXRzX3R5
cGU+IF9fZmlsZWJ1Zl90eXBlOwogICAgICB0eXBlZGVmIF9fYmFzaWNfZmlsZTxjaGFyPiBfX2Zp
bGVfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFtZSB0cmFpdHNfdHlwZTo6c3RhdGVfdHlwZSBf
X3N0YXRlX3R5cGU7CiAgICAgIHR5cGVkZWYgY29kZWN2dDxjaGFyX3R5cGUsIGNoYXIsIF9fc3Rh
dGVfdHlwZT4gX19jb2RlY3Z0X3R5cGU7CgogICAgICBmcmllbmQgY2xhc3MgaW9zX2Jhc2U7Cgog
ICAgcHJvdGVjdGVkOgoKCiAgICAgIF9fY19sb2NrIF9NX2xvY2s7CgoKICAgICAgX19maWxlX3R5
cGUgX01fZmlsZTsKCgogICAgICBpb3NfYmFzZTo6b3Blbm1vZGUgX01fbW9kZTsKCgogICAgICBf
X3N0YXRlX3R5cGUgX01fc3RhdGVfYmVnOwoKCgoKICAgICAgX19zdGF0ZV90eXBlIF9NX3N0YXRl
X2N1cjsKCgoKICAgICAgX19zdGF0ZV90eXBlIF9NX3N0YXRlX2xhc3Q7CgoKICAgICAgY2hhcl90
eXBlKiBfTV9idWY7CgoKCgoKCiAgICAgIHNpemVfdCBfTV9idWZfc2l6ZTsKCgogICAgICBib29s
IF9NX2J1Zl9hbGxvY2F0ZWQ7CiMgMTQ3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2ZzdHJlYW0i
IDMKICAgICAgYm9vbCBfTV9yZWFkaW5nOwogICAgICBib29sIF9NX3dyaXRpbmc7CgoKCgoKCgog
ICAgICBjaGFyX3R5cGUgX01fcGJhY2s7CiAgICAgIGNoYXJfdHlwZSogX01fcGJhY2tfY3VyX3Nh
dmU7CiAgICAgIGNoYXJfdHlwZSogX01fcGJhY2tfZW5kX3NhdmU7CiAgICAgIGJvb2wgX01fcGJh
Y2tfaW5pdDsKCgoKICAgICAgY29uc3QgX19jb2RlY3Z0X3R5cGUqIF9NX2NvZGVjdnQ7CgoKCgoK
CiAgICAgIGNoYXIqIF9NX2V4dF9idWY7CgoKCgogICAgICBzdHJlYW1zaXplIF9NX2V4dF9idWZf
c2l6ZTsKCgoKCgoKICAgICAgY29uc3QgY2hhciogX01fZXh0X25leHQ7CiAgICAgIGNoYXIqIF9N
X2V4dF9lbmQ7CgoKCgoKCiAgICAgIHZvaWQKICAgICAgX01fY3JlYXRlX3BiYWNrKCkKICAgICAg
ewogaWYgKCFfTV9wYmFja19pbml0KQogICB7CiAgICAgX01fcGJhY2tfY3VyX3NhdmUgPSB0aGlz
LT5ncHRyKCk7CiAgICAgX01fcGJhY2tfZW5kX3NhdmUgPSB0aGlzLT5lZ3B0cigpOwogICAgIHRo
aXMtPnNldGcoJl9NX3BiYWNrLCAmX01fcGJhY2ssICZfTV9wYmFjayArIDEpOwogICAgIF9NX3Bi
YWNrX2luaXQgPSB0cnVlOwogICB9CiAgICAgIH0KCgoKCgoKICAgICAgdm9pZAogICAgICBfTV9k
ZXN0cm95X3BiYWNrKCkgdGhyb3coKQogICAgICB7CiBpZiAoX01fcGJhY2tfaW5pdCkKICAgewoK
ICAgICBfTV9wYmFja19jdXJfc2F2ZSArPSB0aGlzLT5ncHRyKCkgIT0gdGhpcy0+ZWJhY2soKTsK
ICAgICB0aGlzLT5zZXRnKF9NX2J1ZiwgX01fcGJhY2tfY3VyX3NhdmUsIF9NX3BiYWNrX2VuZF9z
YXZlKTsKICAgICBfTV9wYmFja19pbml0ID0gZmFsc2U7CiAgIH0KICAgICAgfQoKICAgIHB1Ymxp
YzoKCgoKCgoKCiAgICAgIGJhc2ljX2ZpbGVidWYoKTsKCgogICAgICBiYXNpY19maWxlYnVmKGNv
bnN0IGJhc2ljX2ZpbGVidWYmKSA9IGRlbGV0ZTsKICAgICAgYmFzaWNfZmlsZWJ1ZihiYXNpY19m
aWxlYnVmJiYpOwoKCgoKCiAgICAgIHZpcnR1YWwKICAgICAgfmJhc2ljX2ZpbGVidWYoKQogICAg
ICB7IHRoaXMtPmNsb3NlKCk7IH0KCgogICAgICBiYXNpY19maWxlYnVmJiBvcGVyYXRvcj0oY29u
c3QgYmFzaWNfZmlsZWJ1ZiYpID0gZGVsZXRlOwogICAgICBiYXNpY19maWxlYnVmJiBvcGVyYXRv
cj0oYmFzaWNfZmlsZWJ1ZiYmKTsKICAgICAgdm9pZCBzd2FwKGJhc2ljX2ZpbGVidWYmKTsKCgoK
CgoKICAgICAgYm9vbAogICAgICBpc19vcGVuKCkgY29uc3QgdGhyb3coKQogICAgICB7IHJldHVy
biBfTV9maWxlLmlzX29wZW4oKTsgfQojIDI5NiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9mc3Ry
ZWFtIiAzCiAgICAgIF9fZmlsZWJ1Zl90eXBlKgogICAgICBvcGVuKGNvbnN0IGNoYXIqIF9fcywg
aW9zX2Jhc2U6Om9wZW5tb2RlIF9fbW9kZSk7CiMgMzA2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4w
L2ZzdHJlYW0iIDMKICAgICAgX19maWxlYnVmX3R5cGUqCiAgICAgIG9wZW4oY29uc3Qgc3RkOjpz
dHJpbmcmIF9fcywgaW9zX2Jhc2U6Om9wZW5tb2RlIF9fbW9kZSkKICAgICAgeyByZXR1cm4gb3Bl
bihfX3MuY19zdHIoKSwgX19tb2RlKTsgfQojIDMyMyAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9m
c3RyZWFtIiAzCiAgICAgIF9fZmlsZWJ1Zl90eXBlKgogICAgICBjbG9zZSgpOwoKICAgIHByb3Rl
Y3RlZDoKICAgICAgdm9pZAogICAgICBfTV9hbGxvY2F0ZV9pbnRlcm5hbF9idWZmZXIoKTsKCiAg
ICAgIHZvaWQKICAgICAgX01fZGVzdHJveV9pbnRlcm5hbF9idWZmZXIoKSB0aHJvdygpOwoKCiAg
ICAgIHZpcnR1YWwgc3RyZWFtc2l6ZQogICAgICBzaG93bWFueWMoKTsKCgoKCgoKICAgICAgdmly
dHVhbCBpbnRfdHlwZQogICAgICB1bmRlcmZsb3coKTsKCiAgICAgIHZpcnR1YWwgaW50X3R5cGUK
ICAgICAgcGJhY2tmYWlsKGludF90eXBlIF9fYyA9IF9UcmFpdHM6OmVvZigpKTsKIyAzNTUgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMwogICAgICB2aXJ0dWFsIGludF90eXBlCiAg
ICAgIG92ZXJmbG93KGludF90eXBlIF9fYyA9IF9UcmFpdHM6OmVvZigpKTsKCgoKICAgICAgYm9v
bAogICAgICBfTV9jb252ZXJ0X3RvX2V4dGVybmFsKGNoYXJfdHlwZSosIHN0cmVhbXNpemUpOwoj
IDM3NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9mc3RyZWFtIiAzCiAgICAgIHZpcnR1YWwgX19z
dHJlYW1idWZfdHlwZSoKICAgICAgc2V0YnVmKGNoYXJfdHlwZSogX19zLCBzdHJlYW1zaXplIF9f
bik7CgogICAgICB2aXJ0dWFsIHBvc190eXBlCiAgICAgIHNlZWtvZmYob2ZmX3R5cGUgX19vZmYs
IGlvc19iYXNlOjpzZWVrZGlyIF9fd2F5LAogICAgICAgaW9zX2Jhc2U6Om9wZW5tb2RlIF9fbW9k
ZSA9IGlvc19iYXNlOjppbiB8IGlvc19iYXNlOjpvdXQpOwoKICAgICAgdmlydHVhbCBwb3NfdHlw
ZQogICAgICBzZWVrcG9zKHBvc190eXBlIF9fcG9zLAogICAgICAgaW9zX2Jhc2U6Om9wZW5tb2Rl
IF9fbW9kZSA9IGlvc19iYXNlOjppbiB8IGlvc19iYXNlOjpvdXQpOwoKCiAgICAgIHBvc190eXBl
CiAgICAgIF9NX3NlZWsob2ZmX3R5cGUgX19vZmYsIGlvc19iYXNlOjpzZWVrZGlyIF9fd2F5LCBf
X3N0YXRlX3R5cGUgX19zdGF0ZSk7CgogICAgICBpbnQKICAgICAgX01fZ2V0X2V4dF9wb3MoX19z
dGF0ZV90eXBlICZfX3N0YXRlKTsKCiAgICAgIHZpcnR1YWwgaW50CiAgICAgIHN5bmMoKTsKCiAg
ICAgIHZpcnR1YWwgdm9pZAogICAgICBpbWJ1ZShjb25zdCBsb2NhbGUmIF9fbG9jKTsKCiAgICAg
IHZpcnR1YWwgc3RyZWFtc2l6ZQogICAgICB4c2dldG4oY2hhcl90eXBlKiBfX3MsIHN0cmVhbXNp
emUgX19uKTsKCiAgICAgIHZpcnR1YWwgc3RyZWFtc2l6ZQogICAgICB4c3B1dG4oY29uc3QgY2hh
cl90eXBlKiBfX3MsIHN0cmVhbXNpemUgX19uKTsKCgogICAgICBib29sCiAgICAgIF9NX3Rlcm1p
bmF0ZV9vdXRwdXQoKTsKIyA0MjEgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMwog
ICAgICB2b2lkCiAgICAgIF9NX3NldF9idWZmZXIoc3RyZWFtc2l6ZSBfX29mZikKICAgICAgewog
Y29uc3QgYm9vbCBfX3Rlc3RpbiA9IF9NX21vZGUgJiBpb3NfYmFzZTo6aW47CiBjb25zdCBib29s
IF9fdGVzdG91dCA9IChfTV9tb2RlICYgaW9zX2Jhc2U6Om91dAogICAgfHwgX01fbW9kZSAmIGlv
c19iYXNlOjphcHApOwoKIGlmIChfX3Rlc3RpbiAmJiBfX29mZiA+IDApCiAgIHRoaXMtPnNldGco
X01fYnVmLCBfTV9idWYsIF9NX2J1ZiArIF9fb2ZmKTsKIGVsc2UKICAgdGhpcy0+c2V0ZyhfTV9i
dWYsIF9NX2J1ZiwgX01fYnVmKTsKCiBpZiAoX190ZXN0b3V0ICYmIF9fb2ZmID09IDAgJiYgX01f
YnVmX3NpemUgPiAxICkKICAgdGhpcy0+c2V0cChfTV9idWYsIF9NX2J1ZiArIF9NX2J1Zl9zaXpl
IC0gMSk7CiBlbHNlCiAgIHRoaXMtPnNldHAoMCwgMCk7CiAgICAgIH0KICAgIH07CiMgNDU0ICIv
dXNyL2luY2x1ZGUvYysrLzYuMC4wL2ZzdHJlYW0iIDMKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hh
clQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICBjbGFzcyBiYXNpY19pZnN0cmVhbSA6IHB1YmxpYyBi
YXNpY19pc3RyZWFtPF9DaGFyVCwgX1RyYWl0cz4KICAgIHsKICAgIHB1YmxpYzoKCiAgICAgIHR5
cGVkZWYgX0NoYXJUIGNoYXJfdHlwZTsKICAgICAgdHlwZWRlZiBfVHJhaXRzIHRyYWl0c190eXBl
OwogICAgICB0eXBlZGVmIHR5cGVuYW1lIHRyYWl0c190eXBlOjppbnRfdHlwZSBpbnRfdHlwZTsK
ICAgICAgdHlwZWRlZiB0eXBlbmFtZSB0cmFpdHNfdHlwZTo6cG9zX3R5cGUgcG9zX3R5cGU7CiAg
ICAgIHR5cGVkZWYgdHlwZW5hbWUgdHJhaXRzX3R5cGU6Om9mZl90eXBlIG9mZl90eXBlOwoKCiAg
ICAgIHR5cGVkZWYgYmFzaWNfZmlsZWJ1ZjxjaGFyX3R5cGUsIHRyYWl0c190eXBlPiBfX2ZpbGVi
dWZfdHlwZTsKICAgICAgdHlwZWRlZiBiYXNpY19pc3RyZWFtPGNoYXJfdHlwZSwgdHJhaXRzX3R5
cGU+IF9faXN0cmVhbV90eXBlOwoKICAgIHByaXZhdGU6CiAgICAgIF9fZmlsZWJ1Zl90eXBlIF9N
X2ZpbGVidWY7CgogICAgcHVibGljOgojIDQ4MSAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9mc3Ry
ZWFtIiAzCiAgICAgIGJhc2ljX2lmc3RyZWFtKCkgOiBfX2lzdHJlYW1fdHlwZSgpLCBfTV9maWxl
YnVmKCkKICAgICAgeyB0aGlzLT5pbml0KCZfTV9maWxlYnVmKTsgfQojIDQ5NCAiL3Vzci9pbmNs
dWRlL2MrKy82LjAuMC9mc3RyZWFtIiAzCiAgICAgIGV4cGxpY2l0CiAgICAgIGJhc2ljX2lmc3Ry
ZWFtKGNvbnN0IGNoYXIqIF9fcywgaW9zX2Jhc2U6Om9wZW5tb2RlIF9fbW9kZSA9IGlvc19iYXNl
OjppbikKICAgICAgOiBfX2lzdHJlYW1fdHlwZSgpLCBfTV9maWxlYnVmKCkKICAgICAgewogdGhp
cy0+aW5pdCgmX01fZmlsZWJ1Zik7CiB0aGlzLT5vcGVuKF9fcywgX19tb2RlKTsKICAgICAgfQoj
IDUxMCAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9mc3RyZWFtIiAzCiAgICAgIGV4cGxpY2l0CiAg
ICAgIGJhc2ljX2lmc3RyZWFtKGNvbnN0IHN0ZDo6c3RyaW5nJiBfX3MsCiAgICAgICBpb3NfYmFz
ZTo6b3Blbm1vZGUgX19tb2RlID0gaW9zX2Jhc2U6OmluKQogICAgICA6IF9faXN0cmVhbV90eXBl
KCksIF9NX2ZpbGVidWYoKQogICAgICB7CiB0aGlzLT5pbml0KCZfTV9maWxlYnVmKTsKIHRoaXMt
Pm9wZW4oX19zLCBfX21vZGUpOwogICAgICB9CgogICAgICBiYXNpY19pZnN0cmVhbShjb25zdCBi
YXNpY19pZnN0cmVhbSYpID0gZGVsZXRlOwoKICAgICAgYmFzaWNfaWZzdHJlYW0oYmFzaWNfaWZz
dHJlYW0mJiBfX3JocykKICAgICAgOiBfX2lzdHJlYW1fdHlwZShzdGQ6Om1vdmUoX19yaHMpKSwK
ICAgICAgX01fZmlsZWJ1ZihzdGQ6Om1vdmUoX19yaHMuX01fZmlsZWJ1ZikpCiAgICAgIHsgX19p
c3RyZWFtX3R5cGU6OnNldF9yZGJ1ZigmX01fZmlsZWJ1Zik7IH0KIyA1MzMgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvZnN0cmVhbSIgMwogICAgICB+YmFzaWNfaWZzdHJlYW0oKQogICAgICB7IH0K
CgoKCiAgICAgIGJhc2ljX2lmc3RyZWFtJgogICAgICBvcGVyYXRvcj0oY29uc3QgYmFzaWNfaWZz
dHJlYW0mKSA9IGRlbGV0ZTsKCiAgICAgIGJhc2ljX2lmc3RyZWFtJgogICAgICBvcGVyYXRvcj0o
YmFzaWNfaWZzdHJlYW0mJiBfX3JocykKICAgICAgewogX19pc3RyZWFtX3R5cGU6Om9wZXJhdG9y
PShzdGQ6Om1vdmUoX19yaHMpKTsKIF9NX2ZpbGVidWYgPSBzdGQ6Om1vdmUoX19yaHMuX01fZmls
ZWJ1Zik7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCiAgICAgIHZvaWQKICAgICAgc3dhcChiYXNp
Y19pZnN0cmVhbSYgX19yaHMpCiAgICAgIHsKIF9faXN0cmVhbV90eXBlOjpzd2FwKF9fcmhzKTsK
IF9NX2ZpbGVidWYuc3dhcChfX3Jocy5fTV9maWxlYnVmKTsKICAgICAgfQojIDU2NSAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9mc3RyZWFtIiAzCiAgICAgIF9fZmlsZWJ1Zl90eXBlKgogICAgICBy
ZGJ1ZigpIGNvbnN0CiAgICAgIHsgcmV0dXJuIGNvbnN0X2Nhc3Q8X19maWxlYnVmX3R5cGUqPigm
X01fZmlsZWJ1Zik7IH0KCgoKCgogICAgICBib29sCiAgICAgIGlzX29wZW4oKQogICAgICB7IHJl
dHVybiBfTV9maWxlYnVmLmlzX29wZW4oKTsgfQoKCgogICAgICBib29sCiAgICAgIGlzX29wZW4o
KSBjb25zdAogICAgICB7IHJldHVybiBfTV9maWxlYnVmLmlzX29wZW4oKTsgfQojIDU5NCAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9mc3RyZWFtIiAzCiAgICAgIHZvaWQKICAgICAgb3Blbihjb25z
dCBjaGFyKiBfX3MsIGlvc19iYXNlOjpvcGVubW9kZSBfX21vZGUgPSBpb3NfYmFzZTo6aW4pCiAg
ICAgIHsKIGlmICghX01fZmlsZWJ1Zi5vcGVuKF9fcywgX19tb2RlIHwgaW9zX2Jhc2U6OmluKSkK
ICAgdGhpcy0+c2V0c3RhdGUoaW9zX2Jhc2U6OmZhaWxiaXQpOwogZWxzZQoKCiAgIHRoaXMtPmNs
ZWFyKCk7CiAgICAgIH0KIyA2MTQgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMwog
ICAgICB2b2lkCiAgICAgIG9wZW4oY29uc3Qgc3RkOjpzdHJpbmcmIF9fcywgaW9zX2Jhc2U6Om9w
ZW5tb2RlIF9fbW9kZSA9IGlvc19iYXNlOjppbikKICAgICAgewogaWYgKCFfTV9maWxlYnVmLm9w
ZW4oX19zLCBfX21vZGUgfCBpb3NfYmFzZTo6aW4pKQogICB0aGlzLT5zZXRzdGF0ZShpb3NfYmFz
ZTo6ZmFpbGJpdCk7CiBlbHNlCgoKICAgdGhpcy0+Y2xlYXIoKTsKICAgICAgfQojIDYzMiAiL3Vz
ci9pbmNsdWRlL2MrKy82LjAuMC9mc3RyZWFtIiAzCiAgICAgIHZvaWQKICAgICAgY2xvc2UoKQog
ICAgICB7CiBpZiAoIV9NX2ZpbGVidWYuY2xvc2UoKSkKICAgdGhpcy0+c2V0c3RhdGUoaW9zX2Jh
c2U6OmZhaWxiaXQpOwogICAgICB9CiAgICB9OwojIDY1NSAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9mc3RyZWFtIiAzCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRz
PgogICAgY2xhc3MgYmFzaWNfb2ZzdHJlYW0gOiBwdWJsaWMgYmFzaWNfb3N0cmVhbTxfQ2hhclQs
X1RyYWl0cz4KICAgIHsKICAgIHB1YmxpYzoKCiAgICAgIHR5cGVkZWYgX0NoYXJUIGNoYXJfdHlw
ZTsKICAgICAgdHlwZWRlZiBfVHJhaXRzIHRyYWl0c190eXBlOwogICAgICB0eXBlZGVmIHR5cGVu
YW1lIHRyYWl0c190eXBlOjppbnRfdHlwZSBpbnRfdHlwZTsKICAgICAgdHlwZWRlZiB0eXBlbmFt
ZSB0cmFpdHNfdHlwZTo6cG9zX3R5cGUgcG9zX3R5cGU7CiAgICAgIHR5cGVkZWYgdHlwZW5hbWUg
dHJhaXRzX3R5cGU6Om9mZl90eXBlIG9mZl90eXBlOwoKCiAgICAgIHR5cGVkZWYgYmFzaWNfZmls
ZWJ1ZjxjaGFyX3R5cGUsIHRyYWl0c190eXBlPiBfX2ZpbGVidWZfdHlwZTsKICAgICAgdHlwZWRl
ZiBiYXNpY19vc3RyZWFtPGNoYXJfdHlwZSwgdHJhaXRzX3R5cGU+IF9fb3N0cmVhbV90eXBlOwoK
ICAgIHByaXZhdGU6CiAgICAgIF9fZmlsZWJ1Zl90eXBlIF9NX2ZpbGVidWY7CgogICAgcHVibGlj
OgojIDY4MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9mc3RyZWFtIiAzCiAgICAgIGJhc2ljX29m
c3RyZWFtKCk6IF9fb3N0cmVhbV90eXBlKCksIF9NX2ZpbGVidWYoKQogICAgICB7IHRoaXMtPmlu
aXQoJl9NX2ZpbGVidWYpOyB9CiMgNjk2ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2ZzdHJlYW0i
IDMKICAgICAgZXhwbGljaXQKICAgICAgYmFzaWNfb2ZzdHJlYW0oY29uc3QgY2hhciogX19zLAog
ICAgICAgaW9zX2Jhc2U6Om9wZW5tb2RlIF9fbW9kZSA9IGlvc19iYXNlOjpvdXR8aW9zX2Jhc2U6
OnRydW5jKQogICAgICA6IF9fb3N0cmVhbV90eXBlKCksIF9NX2ZpbGVidWYoKQogICAgICB7CiB0
aGlzLT5pbml0KCZfTV9maWxlYnVmKTsKIHRoaXMtPm9wZW4oX19zLCBfX21vZGUpOwogICAgICB9
CiMgNzE0ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2ZzdHJlYW0iIDMKICAgICAgZXhwbGljaXQK
ICAgICAgYmFzaWNfb2ZzdHJlYW0oY29uc3Qgc3RkOjpzdHJpbmcmIF9fcywKICAgICAgIGlvc19i
YXNlOjpvcGVubW9kZSBfX21vZGUgPSBpb3NfYmFzZTo6b3V0fGlvc19iYXNlOjp0cnVuYykKICAg
ICAgOiBfX29zdHJlYW1fdHlwZSgpLCBfTV9maWxlYnVmKCkKICAgICAgewogdGhpcy0+aW5pdCgm
X01fZmlsZWJ1Zik7CiB0aGlzLT5vcGVuKF9fcywgX19tb2RlKTsKICAgICAgfQoKICAgICAgYmFz
aWNfb2ZzdHJlYW0oY29uc3QgYmFzaWNfb2ZzdHJlYW0mKSA9IGRlbGV0ZTsKCiAgICAgIGJhc2lj
X29mc3RyZWFtKGJhc2ljX29mc3RyZWFtJiYgX19yaHMpCiAgICAgIDogX19vc3RyZWFtX3R5cGUo
c3RkOjptb3ZlKF9fcmhzKSksCiAgICAgIF9NX2ZpbGVidWYoc3RkOjptb3ZlKF9fcmhzLl9NX2Zp
bGVidWYpKQogICAgICB7IF9fb3N0cmVhbV90eXBlOjpzZXRfcmRidWYoJl9NX2ZpbGVidWYpOyB9
CiMgNzM3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2ZzdHJlYW0iIDMKICAgICAgfmJhc2ljX29m
c3RyZWFtKCkKICAgICAgeyB9CgoKCgogICAgICBiYXNpY19vZnN0cmVhbSYKICAgICAgb3BlcmF0
b3I9KGNvbnN0IGJhc2ljX29mc3RyZWFtJikgPSBkZWxldGU7CgogICAgICBiYXNpY19vZnN0cmVh
bSYKICAgICAgb3BlcmF0b3I9KGJhc2ljX29mc3RyZWFtJiYgX19yaHMpCiAgICAgIHsKIF9fb3N0
cmVhbV90eXBlOjpvcGVyYXRvcj0oc3RkOjptb3ZlKF9fcmhzKSk7CiBfTV9maWxlYnVmID0gc3Rk
Ojptb3ZlKF9fcmhzLl9NX2ZpbGVidWYpOwogcmV0dXJuICp0aGlzOwogICAgICB9CgogICAgICB2
b2lkCiAgICAgIHN3YXAoYmFzaWNfb2ZzdHJlYW0mIF9fcmhzKQogICAgICB7CiBfX29zdHJlYW1f
dHlwZTo6c3dhcChfX3Jocyk7CiBfTV9maWxlYnVmLnN3YXAoX19yaHMuX01fZmlsZWJ1Zik7CiAg
ICAgIH0KIyA3NjkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMwogICAgICBfX2Zp
bGVidWZfdHlwZSoKICAgICAgcmRidWYoKSBjb25zdAogICAgICB7IHJldHVybiBjb25zdF9jYXN0
PF9fZmlsZWJ1Zl90eXBlKj4oJl9NX2ZpbGVidWYpOyB9CgoKCgoKICAgICAgYm9vbAogICAgICBp
c19vcGVuKCkKICAgICAgeyByZXR1cm4gX01fZmlsZWJ1Zi5pc19vcGVuKCk7IH0KCgoKICAgICAg
Ym9vbAogICAgICBpc19vcGVuKCkgY29uc3QKICAgICAgeyByZXR1cm4gX01fZmlsZWJ1Zi5pc19v
cGVuKCk7IH0KIyA3OTggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMwogICAgICB2
b2lkCiAgICAgIG9wZW4oY29uc3QgY2hhciogX19zLAogICAgaW9zX2Jhc2U6Om9wZW5tb2RlIF9f
bW9kZSA9IGlvc19iYXNlOjpvdXQgfCBpb3NfYmFzZTo6dHJ1bmMpCiAgICAgIHsKIGlmICghX01f
ZmlsZWJ1Zi5vcGVuKF9fcywgX19tb2RlIHwgaW9zX2Jhc2U6Om91dCkpCiAgIHRoaXMtPnNldHN0
YXRlKGlvc19iYXNlOjpmYWlsYml0KTsKIGVsc2UKCgogICB0aGlzLT5jbGVhcigpOwogICAgICB9
CiMgODE5ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2ZzdHJlYW0iIDMKICAgICAgdm9pZAogICAg
ICBvcGVuKGNvbnN0IHN0ZDo6c3RyaW5nJiBfX3MsCiAgICBpb3NfYmFzZTo6b3Blbm1vZGUgX19t
b2RlID0gaW9zX2Jhc2U6Om91dCB8IGlvc19iYXNlOjp0cnVuYykKICAgICAgewogaWYgKCFfTV9m
aWxlYnVmLm9wZW4oX19zLCBfX21vZGUgfCBpb3NfYmFzZTo6b3V0KSkKICAgdGhpcy0+c2V0c3Rh
dGUoaW9zX2Jhc2U6OmZhaWxiaXQpOwogZWxzZQoKCiAgIHRoaXMtPmNsZWFyKCk7CiAgICAgIH0K
IyA4MzggIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMwogICAgICB2b2lkCiAgICAg
IGNsb3NlKCkKICAgICAgewogaWYgKCFfTV9maWxlYnVmLmNsb3NlKCkpCiAgIHRoaXMtPnNldHN0
YXRlKGlvc19iYXNlOjpmYWlsYml0KTsKICAgICAgfQogICAgfTsKIyA4NjEgIi91c3IvaW5jbHVk
ZS9jKysvNi4wLjAvZnN0cmVhbSIgMwogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5h
bWUgX1RyYWl0cz4KICAgIGNsYXNzIGJhc2ljX2ZzdHJlYW0gOiBwdWJsaWMgYmFzaWNfaW9zdHJl
YW08X0NoYXJULCBfVHJhaXRzPgogICAgewogICAgcHVibGljOgoKICAgICAgdHlwZWRlZiBfQ2hh
clQgY2hhcl90eXBlOwogICAgICB0eXBlZGVmIF9UcmFpdHMgdHJhaXRzX3R5cGU7CiAgICAgIHR5
cGVkZWYgdHlwZW5hbWUgdHJhaXRzX3R5cGU6OmludF90eXBlIGludF90eXBlOwogICAgICB0eXBl
ZGVmIHR5cGVuYW1lIHRyYWl0c190eXBlOjpwb3NfdHlwZSBwb3NfdHlwZTsKICAgICAgdHlwZWRl
ZiB0eXBlbmFtZSB0cmFpdHNfdHlwZTo6b2ZmX3R5cGUgb2ZmX3R5cGU7CgoKICAgICAgdHlwZWRl
ZiBiYXNpY19maWxlYnVmPGNoYXJfdHlwZSwgdHJhaXRzX3R5cGU+IF9fZmlsZWJ1Zl90eXBlOwog
ICAgICB0eXBlZGVmIGJhc2ljX2lvczxjaGFyX3R5cGUsIHRyYWl0c190eXBlPiBfX2lvc190eXBl
OwogICAgICB0eXBlZGVmIGJhc2ljX2lvc3RyZWFtPGNoYXJfdHlwZSwgdHJhaXRzX3R5cGU+IF9f
aW9zdHJlYW1fdHlwZTsKCiAgICBwcml2YXRlOgogICAgICBfX2ZpbGVidWZfdHlwZSBfTV9maWxl
YnVmOwoKICAgIHB1YmxpYzoKIyA4ODkgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIg
MwogICAgICBiYXNpY19mc3RyZWFtKCkKICAgICAgOiBfX2lvc3RyZWFtX3R5cGUoKSwgX01fZmls
ZWJ1ZigpCiAgICAgIHsgdGhpcy0+aW5pdCgmX01fZmlsZWJ1Zik7IH0KIyA5MDEgIi91c3IvaW5j
bHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMwogICAgICBleHBsaWNpdAogICAgICBiYXNpY19mc3Ry
ZWFtKGNvbnN0IGNoYXIqIF9fcywKICAgICAgaW9zX2Jhc2U6Om9wZW5tb2RlIF9fbW9kZSA9IGlv
c19iYXNlOjppbiB8IGlvc19iYXNlOjpvdXQpCiAgICAgIDogX19pb3N0cmVhbV90eXBlKDApLCBf
TV9maWxlYnVmKCkKICAgICAgewogdGhpcy0+aW5pdCgmX01fZmlsZWJ1Zik7CiB0aGlzLT5vcGVu
KF9fcywgX19tb2RlKTsKICAgICAgfQoKCgoKCgoKICAgICAgZXhwbGljaXQKICAgICAgYmFzaWNf
ZnN0cmVhbShjb25zdCBzdGQ6OnN0cmluZyYgX19zLAogICAgICBpb3NfYmFzZTo6b3Blbm1vZGUg
X19tb2RlID0gaW9zX2Jhc2U6OmluIHwgaW9zX2Jhc2U6Om91dCkKICAgICAgOiBfX2lvc3RyZWFt
X3R5cGUoMCksIF9NX2ZpbGVidWYoKQogICAgICB7CiB0aGlzLT5pbml0KCZfTV9maWxlYnVmKTsK
IHRoaXMtPm9wZW4oX19zLCBfX21vZGUpOwogICAgICB9CgogICAgICBiYXNpY19mc3RyZWFtKGNv
bnN0IGJhc2ljX2ZzdHJlYW0mKSA9IGRlbGV0ZTsKCiAgICAgIGJhc2ljX2ZzdHJlYW0oYmFzaWNf
ZnN0cmVhbSYmIF9fcmhzKQogICAgICA6IF9faW9zdHJlYW1fdHlwZShzdGQ6Om1vdmUoX19yaHMp
KSwKICAgICAgX01fZmlsZWJ1ZihzdGQ6Om1vdmUoX19yaHMuX01fZmlsZWJ1ZikpCiAgICAgIHsg
X19pb3N0cmVhbV90eXBlOjpzZXRfcmRidWYoJl9NX2ZpbGVidWYpOyB9CiMgOTM5ICIvdXNyL2lu
Y2x1ZGUvYysrLzYuMC4wL2ZzdHJlYW0iIDMKICAgICAgfmJhc2ljX2ZzdHJlYW0oKQogICAgICB7
IH0KCgoKCiAgICAgIGJhc2ljX2ZzdHJlYW0mCiAgICAgIG9wZXJhdG9yPShjb25zdCBiYXNpY19m
c3RyZWFtJikgPSBkZWxldGU7CgogICAgICBiYXNpY19mc3RyZWFtJgogICAgICBvcGVyYXRvcj0o
YmFzaWNfZnN0cmVhbSYmIF9fcmhzKQogICAgICB7CiBfX2lvc3RyZWFtX3R5cGU6Om9wZXJhdG9y
PShzdGQ6Om1vdmUoX19yaHMpKTsKIF9NX2ZpbGVidWYgPSBzdGQ6Om1vdmUoX19yaHMuX01fZmls
ZWJ1Zik7CiByZXR1cm4gKnRoaXM7CiAgICAgIH0KCiAgICAgIHZvaWQKICAgICAgc3dhcChiYXNp
Y19mc3RyZWFtJiBfX3JocykKICAgICAgewogX19pb3N0cmVhbV90eXBlOjpzd2FwKF9fcmhzKTsK
IF9NX2ZpbGVidWYuc3dhcChfX3Jocy5fTV9maWxlYnVmKTsKICAgICAgfQojIDk3MSAiL3Vzci9p
bmNsdWRlL2MrKy82LjAuMC9mc3RyZWFtIiAzCiAgICAgIF9fZmlsZWJ1Zl90eXBlKgogICAgICBy
ZGJ1ZigpIGNvbnN0CiAgICAgIHsgcmV0dXJuIGNvbnN0X2Nhc3Q8X19maWxlYnVmX3R5cGUqPigm
X01fZmlsZWJ1Zik7IH0KCgoKCgogICAgICBib29sCiAgICAgIGlzX29wZW4oKQogICAgICB7IHJl
dHVybiBfTV9maWxlYnVmLmlzX29wZW4oKTsgfQoKCgogICAgICBib29sCiAgICAgIGlzX29wZW4o
KSBjb25zdAogICAgICB7IHJldHVybiBfTV9maWxlYnVmLmlzX29wZW4oKTsgfQojIDEwMDAgIi91
c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMwogICAgICB2b2lkCiAgICAgIG9wZW4oY29u
c3QgY2hhciogX19zLAogICAgaW9zX2Jhc2U6Om9wZW5tb2RlIF9fbW9kZSA9IGlvc19iYXNlOjpp
biB8IGlvc19iYXNlOjpvdXQpCiAgICAgIHsKIGlmICghX01fZmlsZWJ1Zi5vcGVuKF9fcywgX19t
b2RlKSkKICAgdGhpcy0+c2V0c3RhdGUoaW9zX2Jhc2U6OmZhaWxiaXQpOwogZWxzZQoKCiAgIHRo
aXMtPmNsZWFyKCk7CiAgICAgIH0KIyAxMDIxICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2ZzdHJl
YW0iIDMKICAgICAgdm9pZAogICAgICBvcGVuKGNvbnN0IHN0ZDo6c3RyaW5nJiBfX3MsCiAgICBp
b3NfYmFzZTo6b3Blbm1vZGUgX19tb2RlID0gaW9zX2Jhc2U6OmluIHwgaW9zX2Jhc2U6Om91dCkK
ICAgICAgewogaWYgKCFfTV9maWxlYnVmLm9wZW4oX19zLCBfX21vZGUpKQogICB0aGlzLT5zZXRz
dGF0ZShpb3NfYmFzZTo6ZmFpbGJpdCk7CiBlbHNlCgoKICAgdGhpcy0+Y2xlYXIoKTsKICAgICAg
fQojIDEwNDAgIi91c3IvaW5jbHVkZS9jKysvNi4wLjAvZnN0cmVhbSIgMwogICAgICB2b2lkCiAg
ICAgIGNsb3NlKCkKICAgICAgewogaWYgKCFfTV9maWxlYnVmLmNsb3NlKCkpCiAgIHRoaXMtPnNl
dHN0YXRlKGlvc19iYXNlOjpmYWlsYml0KTsKICAgICAgfQogICAgfTsKCgoKICB0ZW1wbGF0ZSA8
Y2xhc3MgX0NoYXJULCBjbGFzcyBfVHJhaXRzPgogICAgaW5saW5lIHZvaWQKICAgIHN3YXAoYmFz
aWNfZmlsZWJ1ZjxfQ2hhclQsIF9UcmFpdHM+JiBfX3gsCiAgYmFzaWNfZmlsZWJ1ZjxfQ2hhclQs
IF9UcmFpdHM+JiBfX3kpCiAgICB7IF9feC5zd2FwKF9feSk7IH0KCgogIHRlbXBsYXRlIDxjbGFz
cyBfQ2hhclQsIGNsYXNzIF9UcmFpdHM+CiAgICBpbmxpbmUgdm9pZAogICAgc3dhcChiYXNpY19p
ZnN0cmVhbTxfQ2hhclQsIF9UcmFpdHM+JiBfX3gsCiAgYmFzaWNfaWZzdHJlYW08X0NoYXJULCBf
VHJhaXRzPiYgX195KQogICAgeyBfX3guc3dhcChfX3kpOyB9CgoKICB0ZW1wbGF0ZSA8Y2xhc3Mg
X0NoYXJULCBjbGFzcyBfVHJhaXRzPgogICAgaW5saW5lIHZvaWQKICAgIHN3YXAoYmFzaWNfb2Zz
dHJlYW08X0NoYXJULCBfVHJhaXRzPiYgX194LAogIGJhc2ljX29mc3RyZWFtPF9DaGFyVCwgX1Ry
YWl0cz4mIF9feSkKICAgIHsgX194LnN3YXAoX195KTsgfQoKCiAgdGVtcGxhdGUgPGNsYXNzIF9D
aGFyVCwgY2xhc3MgX1RyYWl0cz4KICAgIGlubGluZSB2b2lkCiAgICBzd2FwKGJhc2ljX2ZzdHJl
YW08X0NoYXJULCBfVHJhaXRzPiYgX194LAogIGJhc2ljX2ZzdHJlYW08X0NoYXJULCBfVHJhaXRz
PiYgX195KQogICAgeyBfX3guc3dhcChfX3kpOyB9CgoKCn0KCiMgMSAiL3Vzci9pbmNsdWRlL2Mr
Ky82LjAuMC9iaXRzL2ZzdHJlYW0udGNjIiAxIDMKIyAzNyAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL2ZzdHJlYW0udGNjIiAzCiAgICAgICAKIyAzOCAiL3Vzci9pbmNsdWRlL2MrKy82LjAu
MC9iaXRzL2ZzdHJlYW0udGNjIiAzCgoKCgpuYW1lc3BhY2Ugc3RkIF9fYXR0cmlidXRlX18gKChf
X3Zpc2liaWxpdHlfXyAoImRlZmF1bHQiKSkpCnsKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFy
VCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIHZvaWQKICAgIGJhc2ljX2ZpbGVidWY8X0NoYXJULCBf
VHJhaXRzPjo6CiAgICBfTV9hbGxvY2F0ZV9pbnRlcm5hbF9idWZmZXIoKQogICAgewoKCiAgICAg
IGlmICghX01fYnVmX2FsbG9jYXRlZCAmJiAhX01fYnVmKQogewogICBfTV9idWYgPSBuZXcgY2hh
cl90eXBlW19NX2J1Zl9zaXplXTsKICAgX01fYnVmX2FsbG9jYXRlZCA9IHRydWU7CiB9CiAgICB9
CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIHZvaWQK
ICAgIGJhc2ljX2ZpbGVidWY8X0NoYXJULCBfVHJhaXRzPjo6CiAgICBfTV9kZXN0cm95X2ludGVy
bmFsX2J1ZmZlcigpIHRocm93KCkKICAgIHsKICAgICAgaWYgKF9NX2J1Zl9hbGxvY2F0ZWQpCiB7
CiAgIGRlbGV0ZSBbXSBfTV9idWY7CiAgIF9NX2J1ZiA9IDA7CiAgIF9NX2J1Zl9hbGxvY2F0ZWQg
PSBmYWxzZTsKIH0KICAgICAgZGVsZXRlIFtdIF9NX2V4dF9idWY7CiAgICAgIF9NX2V4dF9idWYg
PSAwOwogICAgICBfTV9leHRfYnVmX3NpemUgPSAwOwogICAgICBfTV9leHRfbmV4dCA9IDA7CiAg
ICAgIF9NX2V4dF9lbmQgPSAwOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5
cGVuYW1lIF9UcmFpdHM+CiAgICBiYXNpY19maWxlYnVmPF9DaGFyVCwgX1RyYWl0cz46OgogICAg
YmFzaWNfZmlsZWJ1ZigpIDogX19zdHJlYW1idWZfdHlwZSgpLCBfTV9sb2NrKCksIF9NX2ZpbGUo
Jl9NX2xvY2spLAogICAgX01fbW9kZShpb3NfYmFzZTo6b3Blbm1vZGUoMCkpLCBfTV9zdGF0ZV9i
ZWcoKSwgX01fc3RhdGVfY3VyKCksCiAgICBfTV9zdGF0ZV9sYXN0KCksIF9NX2J1ZigwKSwgX01f
YnVmX3NpemUoODE5MiksCiAgICBfTV9idWZfYWxsb2NhdGVkKGZhbHNlKSwgX01fcmVhZGluZyhm
YWxzZSksIF9NX3dyaXRpbmcoZmFsc2UpLCBfTV9wYmFjaygpLAogICAgX01fcGJhY2tfY3VyX3Nh
dmUoMCksIF9NX3BiYWNrX2VuZF9zYXZlKDApLCBfTV9wYmFja19pbml0KGZhbHNlKSwKICAgIF9N
X2NvZGVjdnQoMCksIF9NX2V4dF9idWYoMCksIF9NX2V4dF9idWZfc2l6ZSgwKSwgX01fZXh0X25l
eHQoMCksCiAgICBfTV9leHRfZW5kKDApCiAgICB7CiAgICAgIGlmIChoYXNfZmFjZXQ8X19jb2Rl
Y3Z0X3R5cGU+KHRoaXMtPl9NX2J1Zl9sb2NhbGUpKQogX01fY29kZWN2dCA9ICZ1c2VfZmFjZXQ8
X19jb2RlY3Z0X3R5cGU+KHRoaXMtPl9NX2J1Zl9sb2NhbGUpOwogICAgfQoKCiAgdGVtcGxhdGU8
dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgYmFzaWNfZmlsZWJ1ZjxfQ2hh
clQsIF9UcmFpdHM+OjoKICAgIGJhc2ljX2ZpbGVidWYoYmFzaWNfZmlsZWJ1ZiYmIF9fcmhzKQog
ICAgOiBfX3N0cmVhbWJ1Zl90eXBlKF9fcmhzKSwKICAgIF9NX2xvY2soKSwgX01fZmlsZShzdGQ6
Om1vdmUoX19yaHMuX01fZmlsZSksICZfTV9sb2NrKSwKICAgIF9NX21vZGUoc3RkOjpfX2V4Y2hh
bmdlKF9fcmhzLl9NX21vZGUsIGlvc19iYXNlOjpvcGVubW9kZSgwKSkpLAogICAgX01fc3RhdGVf
YmVnKHN0ZDo6bW92ZShfX3Jocy5fTV9zdGF0ZV9iZWcpKSwKICAgIF9NX3N0YXRlX2N1cihzdGQ6
Om1vdmUoX19yaHMuX01fc3RhdGVfY3VyKSksCiAgICBfTV9zdGF0ZV9sYXN0KHN0ZDo6bW92ZShf
X3Jocy5fTV9zdGF0ZV9sYXN0KSksCiAgICBfTV9idWYoc3RkOjpfX2V4Y2hhbmdlKF9fcmhzLl9N
X2J1ZiwgbnVsbHB0cikpLAogICAgX01fYnVmX3NpemUoc3RkOjpfX2V4Y2hhbmdlKF9fcmhzLl9N
X2J1Zl9zaXplLCAxKSksCiAgICBfTV9idWZfYWxsb2NhdGVkKHN0ZDo6X19leGNoYW5nZShfX3Jo
cy5fTV9idWZfYWxsb2NhdGVkLCBmYWxzZSkpLAogICAgX01fcmVhZGluZyhzdGQ6Ol9fZXhjaGFu
Z2UoX19yaHMuX01fcmVhZGluZywgZmFsc2UpKSwKICAgIF9NX3dyaXRpbmcoc3RkOjpfX2V4Y2hh
bmdlKF9fcmhzLl9NX3dyaXRpbmcsIGZhbHNlKSksCiAgICBfTV9wYmFjayhfX3Jocy5fTV9wYmFj
ayksCiAgICBfTV9wYmFja19jdXJfc2F2ZShzdGQ6Ol9fZXhjaGFuZ2UoX19yaHMuX01fcGJhY2tf
Y3VyX3NhdmUsIG51bGxwdHIpKSwKICAgIF9NX3BiYWNrX2VuZF9zYXZlKHN0ZDo6X19leGNoYW5n
ZShfX3Jocy5fTV9wYmFja19lbmRfc2F2ZSwgbnVsbHB0cikpLAogICAgX01fcGJhY2tfaW5pdChz
dGQ6Ol9fZXhjaGFuZ2UoX19yaHMuX01fcGJhY2tfaW5pdCwgZmFsc2UpKSwKICAgIF9NX2NvZGVj
dnQoX19yaHMuX01fY29kZWN2dCksCiAgICBfTV9leHRfYnVmKHN0ZDo6X19leGNoYW5nZShfX3Jo
cy5fTV9leHRfYnVmLCBudWxscHRyKSksCiAgICBfTV9leHRfYnVmX3NpemUoc3RkOjpfX2V4Y2hh
bmdlKF9fcmhzLl9NX2V4dF9idWZfc2l6ZSwgMCkpLAogICAgX01fZXh0X25leHQoc3RkOjpfX2V4
Y2hhbmdlKF9fcmhzLl9NX2V4dF9uZXh0LCBudWxscHRyKSksCiAgICBfTV9leHRfZW5kKHN0ZDo6
X19leGNoYW5nZShfX3Jocy5fTV9leHRfZW5kLCBudWxscHRyKSkKICAgIHsKICAgICAgX19yaHMu
X01fc2V0X2J1ZmZlcigtMSk7CiAgICAgIF9fcmhzLl9NX3N0YXRlX2xhc3QgPSBfX3Jocy5fTV9z
dGF0ZV9jdXIgPSBfX3Jocy5fTV9zdGF0ZV9iZWc7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1l
IF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIGJhc2ljX2ZpbGVidWY8X0NoYXJULCBfVHJh
aXRzPiYKICAgIGJhc2ljX2ZpbGVidWY8X0NoYXJULCBfVHJhaXRzPjo6CiAgICBvcGVyYXRvcj0o
YmFzaWNfZmlsZWJ1ZiYmIF9fcmhzKQogICAgewogICAgICB0aGlzLT5jbG9zZSgpOwogICAgICBf
X3N0cmVhbWJ1Zl90eXBlOjpvcGVyYXRvcj0oX19yaHMpOwogICAgICBfTV9maWxlLnN3YXAoX19y
aHMuX01fZmlsZSk7CiAgICAgIF9NX21vZGUgPSBzdGQ6Ol9fZXhjaGFuZ2UoX19yaHMuX01fbW9k
ZSwgaW9zX2Jhc2U6Om9wZW5tb2RlKDApKTsKICAgICAgX01fc3RhdGVfYmVnID0gc3RkOjptb3Zl
KF9fcmhzLl9NX3N0YXRlX2JlZyk7CiAgICAgIF9NX3N0YXRlX2N1ciA9IHN0ZDo6bW92ZShfX3Jo
cy5fTV9zdGF0ZV9jdXIpOwogICAgICBfTV9zdGF0ZV9sYXN0ID0gc3RkOjptb3ZlKF9fcmhzLl9N
X3N0YXRlX2xhc3QpOwogICAgICBfTV9idWYgPSBzdGQ6Ol9fZXhjaGFuZ2UoX19yaHMuX01fYnVm
LCBudWxscHRyKTsKICAgICAgX01fYnVmX3NpemUgPSBzdGQ6Ol9fZXhjaGFuZ2UoX19yaHMuX01f
YnVmX3NpemUsIDEpOwogICAgICBfTV9idWZfYWxsb2NhdGVkID0gc3RkOjpfX2V4Y2hhbmdlKF9f
cmhzLl9NX2J1Zl9hbGxvY2F0ZWQsIGZhbHNlKTsKICAgICAgX01fZXh0X2J1ZiA9IHN0ZDo6X19l
eGNoYW5nZShfX3Jocy5fTV9leHRfYnVmLCBudWxscHRyKTsKICAgICAgX01fZXh0X2J1Zl9zaXpl
ID0gc3RkOjpfX2V4Y2hhbmdlKF9fcmhzLl9NX2V4dF9idWZfc2l6ZSwgMCk7CiAgICAgIF9NX2V4
dF9uZXh0ID0gc3RkOjpfX2V4Y2hhbmdlKF9fcmhzLl9NX2V4dF9uZXh0LCBudWxscHRyKTsKICAg
ICAgX01fZXh0X2VuZCA9IHN0ZDo6X19leGNoYW5nZShfX3Jocy5fTV9leHRfZW5kLCBudWxscHRy
KTsKICAgICAgX01fcmVhZGluZyA9IHN0ZDo6X19leGNoYW5nZShfX3Jocy5fTV9yZWFkaW5nLCBm
YWxzZSk7CiAgICAgIF9NX3dyaXRpbmcgPSBzdGQ6Ol9fZXhjaGFuZ2UoX19yaHMuX01fd3JpdGlu
ZywgZmFsc2UpOwogICAgICBfTV9wYmFja19jdXJfc2F2ZSA9IHN0ZDo6X19leGNoYW5nZShfX3Jo
cy5fTV9wYmFja19jdXJfc2F2ZSwgbnVsbHB0cik7CiAgICAgIF9NX3BiYWNrX2VuZF9zYXZlID0g
c3RkOjpfX2V4Y2hhbmdlKF9fcmhzLl9NX3BiYWNrX2VuZF9zYXZlLCBudWxscHRyKTsKICAgICAg
X01fcGJhY2tfaW5pdCA9IHN0ZDo6X19leGNoYW5nZShfX3Jocy5fTV9wYmFja19pbml0LCBmYWxz
ZSk7CiAgICAgIF9fcmhzLl9NX3NldF9idWZmZXIoLTEpOwogICAgICBfX3Jocy5fTV9zdGF0ZV9s
YXN0ID0gX19yaHMuX01fc3RhdGVfY3VyID0gX19yaHMuX01fc3RhdGVfYmVnOwogICAgICByZXR1
cm4gKnRoaXM7CiAgICB9CgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1Ry
YWl0cz4KICAgIHZvaWQKICAgIGJhc2ljX2ZpbGVidWY8X0NoYXJULCBfVHJhaXRzPjo6CiAgICBz
d2FwKGJhc2ljX2ZpbGVidWYmIF9fcmhzKQogICAgewogICAgICBfX3N0cmVhbWJ1Zl90eXBlOjpz
d2FwKF9fcmhzKTsKICAgICAgX01fZmlsZS5zd2FwKF9fcmhzLl9NX2ZpbGUpOwogICAgICBzdGQ6
OnN3YXAoX01fbW9kZSwgX19yaHMuX01fbW9kZSk7CiAgICAgIHN0ZDo6c3dhcChfTV9zdGF0ZV9i
ZWcsIF9fcmhzLl9NX3N0YXRlX2JlZyk7CiAgICAgIHN0ZDo6c3dhcChfTV9zdGF0ZV9jdXIsIF9f
cmhzLl9NX3N0YXRlX2N1cik7CiAgICAgIHN0ZDo6c3dhcChfTV9zdGF0ZV9sYXN0LCBfX3Jocy5f
TV9zdGF0ZV9sYXN0KTsKICAgICAgc3RkOjpzd2FwKF9NX2J1ZiwgX19yaHMuX01fYnVmKTsKICAg
ICAgc3RkOjpzd2FwKF9NX2J1Zl9zaXplLCBfX3Jocy5fTV9idWZfc2l6ZSk7CiAgICAgIHN0ZDo6
c3dhcChfTV9idWZfYWxsb2NhdGVkLCBfX3Jocy5fTV9idWZfYWxsb2NhdGVkKTsKICAgICAgc3Rk
Ojpzd2FwKF9NX2V4dF9idWYsIF9fcmhzLl9NX2V4dF9idWYpOwogICAgICBzdGQ6OnN3YXAoX01f
ZXh0X2J1Zl9zaXplLCBfX3Jocy5fTV9leHRfYnVmX3NpemUpOwogICAgICBzdGQ6OnN3YXAoX01f
ZXh0X25leHQsIF9fcmhzLl9NX2V4dF9uZXh0KTsKICAgICAgc3RkOjpzd2FwKF9NX2V4dF9lbmQs
IF9fcmhzLl9NX2V4dF9lbmQpOwogICAgICBzdGQ6OnN3YXAoX01fcmVhZGluZywgX19yaHMuX01f
cmVhZGluZyk7CiAgICAgIHN0ZDo6c3dhcChfTV93cml0aW5nLCBfX3Jocy5fTV93cml0aW5nKTsK
ICAgICAgc3RkOjpzd2FwKF9NX3BiYWNrX2N1cl9zYXZlLCBfX3Jocy5fTV9wYmFja19jdXJfc2F2
ZSk7CiAgICAgIHN0ZDo6c3dhcChfTV9wYmFja19lbmRfc2F2ZSwgX19yaHMuX01fcGJhY2tfZW5k
X3NhdmUpOwogICAgICBzdGQ6OnN3YXAoX01fcGJhY2tfaW5pdCwgX19yaHMuX01fcGJhY2tfaW5p
dCk7CiAgICB9CgoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+
CiAgICB0eXBlbmFtZSBiYXNpY19maWxlYnVmPF9DaGFyVCwgX1RyYWl0cz46Ol9fZmlsZWJ1Zl90
eXBlKgogICAgYmFzaWNfZmlsZWJ1ZjxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIG9wZW4oY29uc3Qg
Y2hhciogX19zLCBpb3NfYmFzZTo6b3Blbm1vZGUgX19tb2RlKQogICAgewogICAgICBfX2ZpbGVi
dWZfdHlwZSAqX19yZXQgPSAwOwogICAgICBpZiAoIXRoaXMtPmlzX29wZW4oKSkKIHsKICAgX01f
ZmlsZS5vcGVuKF9fcywgX19tb2RlKTsKICAgaWYgKHRoaXMtPmlzX29wZW4oKSkKICAgICB7CiAg
ICAgICBfTV9hbGxvY2F0ZV9pbnRlcm5hbF9idWZmZXIoKTsKICAgICAgIF9NX21vZGUgPSBfX21v
ZGU7CgoKICAgICAgIF9NX3JlYWRpbmcgPSBmYWxzZTsKICAgICAgIF9NX3dyaXRpbmcgPSBmYWxz
ZTsKICAgICAgIF9NX3NldF9idWZmZXIoLTEpOwoKCiAgICAgICBfTV9zdGF0ZV9sYXN0ID0gX01f
c3RhdGVfY3VyID0gX01fc3RhdGVfYmVnOwoKCiAgICAgICBpZiAoKF9fbW9kZSAmIGlvc19iYXNl
OjphdGUpCiAgICAmJiB0aGlzLT5zZWVrb2ZmKDAsIGlvc19iYXNlOjplbmQsIF9fbW9kZSkKICAg
ID09IHBvc190eXBlKG9mZl90eXBlKC0xKSkpCiAgdGhpcy0+Y2xvc2UoKTsKICAgICAgIGVsc2UK
ICBfX3JldCA9IHRoaXM7CiAgICAgfQogfQogICAgICByZXR1cm4gX19yZXQ7CiAgICB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIHR5cGVuYW1lIGJh
c2ljX2ZpbGVidWY8X0NoYXJULCBfVHJhaXRzPjo6X19maWxlYnVmX3R5cGUqCiAgICBiYXNpY19m
aWxlYnVmPF9DaGFyVCwgX1RyYWl0cz46OgogICAgY2xvc2UoKQogICAgewogICAgICBpZiAoIXRo
aXMtPmlzX29wZW4oKSkKIHJldHVybiAwOwoKICAgICAgYm9vbCBfX3Rlc3RmYWlsID0gZmFsc2U7
CiAgICAgIHsKCiBzdHJ1Y3QgX19jbG9zZV9zZW50cnkKIHsKICAgYmFzaWNfZmlsZWJ1ZiAqX19m
YjsKICAgX19jbG9zZV9zZW50cnkgKGJhc2ljX2ZpbGVidWYgKl9fZmJpKTogX19mYihfX2ZiaSkg
eyB9CiAgIH5fX2Nsb3NlX3NlbnRyeSAoKQogICB7CiAgICAgX19mYi0+X01fbW9kZSA9IGlvc19i
YXNlOjpvcGVubW9kZSgwKTsKICAgICBfX2ZiLT5fTV9wYmFja19pbml0ID0gZmFsc2U7CiAgICAg
X19mYi0+X01fZGVzdHJveV9pbnRlcm5hbF9idWZmZXIoKTsKICAgICBfX2ZiLT5fTV9yZWFkaW5n
ID0gZmFsc2U7CiAgICAgX19mYi0+X01fd3JpdGluZyA9IGZhbHNlOwogICAgIF9fZmItPl9NX3Nl
dF9idWZmZXIoLTEpOwogICAgIF9fZmItPl9NX3N0YXRlX2xhc3QgPSBfX2ZiLT5fTV9zdGF0ZV9j
dXIgPSBfX2ZiLT5fTV9zdGF0ZV9iZWc7CiAgIH0KIH0gX19jcyAodGhpcyk7CgogdHJ5CiAgIHsK
ICAgICBpZiAoIV9NX3Rlcm1pbmF0ZV9vdXRwdXQoKSkKICAgICAgIF9fdGVzdGZhaWwgPSB0cnVl
OwogICB9CiBjYXRjaChfX2N4eGFiaXYxOjpfX2ZvcmNlZF91bndpbmQmKQogICB7CiAgICAgX01f
ZmlsZS5jbG9zZSgpOwogICAgIHRocm93OwogICB9CiBjYXRjaCguLi4pCiAgIHsgX190ZXN0ZmFp
bCA9IHRydWU7IH0KICAgICAgfQoKICAgICAgaWYgKCFfTV9maWxlLmNsb3NlKCkpCiBfX3Rlc3Rm
YWlsID0gdHJ1ZTsKCiAgICAgIGlmIChfX3Rlc3RmYWlsKQogcmV0dXJuIDA7CiAgICAgIGVsc2UK
IHJldHVybiB0aGlzOwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1l
IF9UcmFpdHM+CiAgICBzdHJlYW1zaXplCiAgICBiYXNpY19maWxlYnVmPF9DaGFyVCwgX1RyYWl0
cz46OgogICAgc2hvd21hbnljKCkKICAgIHsKICAgICAgc3RyZWFtc2l6ZSBfX3JldCA9IC0xOwog
ICAgICBjb25zdCBib29sIF9fdGVzdGluID0gX01fbW9kZSAmIGlvc19iYXNlOjppbjsKICAgICAg
aWYgKF9fdGVzdGluICYmIHRoaXMtPmlzX29wZW4oKSkKIHsKCgogICBfX3JldCA9IHRoaXMtPmVn
cHRyKCkgLSB0aGlzLT5ncHRyKCk7CgoKCgoKCgogICBpZiAoX19jaGVja19mYWNldChfTV9jb2Rl
Y3Z0KS5lbmNvZGluZygpID49IDApCgogICAgIF9fcmV0ICs9IF9NX2ZpbGUuc2hvd21hbnljKCkg
LyBfTV9jb2RlY3Z0LT5tYXhfbGVuZ3RoKCk7CiB9CiAgICAgIHJldHVybiBfX3JldDsKICAgIH0K
CiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgdHlwZW5h
bWUgYmFzaWNfZmlsZWJ1ZjxfQ2hhclQsIF9UcmFpdHM+OjppbnRfdHlwZQogICAgYmFzaWNfZmls
ZWJ1ZjxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIHVuZGVyZmxvdygpCiAgICB7CiAgICAgIGludF90
eXBlIF9fcmV0ID0gdHJhaXRzX3R5cGU6OmVvZigpOwogICAgICBjb25zdCBib29sIF9fdGVzdGlu
ID0gX01fbW9kZSAmIGlvc19iYXNlOjppbjsKICAgICAgaWYgKF9fdGVzdGluKQogewogICBpZiAo
X01fd3JpdGluZykKICAgICB7CiAgICAgICBpZiAob3ZlcmZsb3coKSA9PSB0cmFpdHNfdHlwZTo6
ZW9mKCkpCiAgcmV0dXJuIF9fcmV0OwogICAgICAgX01fc2V0X2J1ZmZlcigtMSk7CiAgICAgICBf
TV93cml0aW5nID0gZmFsc2U7CiAgICAgfQoKCgogICBfTV9kZXN0cm95X3BiYWNrKCk7CgogICBp
ZiAodGhpcy0+Z3B0cigpIDwgdGhpcy0+ZWdwdHIoKSkKICAgICByZXR1cm4gdHJhaXRzX3R5cGU6
OnRvX2ludF90eXBlKCp0aGlzLT5ncHRyKCkpOwoKCiAgIGNvbnN0IHNpemVfdCBfX2J1ZmxlbiA9
IF9NX2J1Zl9zaXplID4gMSA/IF9NX2J1Zl9zaXplIC0gMSA6IDE7CgoKICAgYm9vbCBfX2dvdF9l
b2YgPSBmYWxzZTsKCiAgIHN0cmVhbXNpemUgX19pbGVuID0gMDsKICAgY29kZWN2dF9iYXNlOjpy
ZXN1bHQgX19yID0gY29kZWN2dF9iYXNlOjpvazsKICAgaWYgKF9fY2hlY2tfZmFjZXQoX01fY29k
ZWN2dCkuYWx3YXlzX25vY29udigpKQogICAgIHsKICAgICAgIF9faWxlbiA9IF9NX2ZpbGUueHNn
ZXRuKHJlaW50ZXJwcmV0X2Nhc3Q8Y2hhcio+KHRoaXMtPmViYWNrKCkpLAogICAgICAgICAgX19i
dWZsZW4pOwogICAgICAgaWYgKF9faWxlbiA9PSAwKQogIF9fZ290X2VvZiA9IHRydWU7CiAgICAg
fQogICBlbHNlCiAgICAgewoKCiAgICAgICBjb25zdCBpbnQgX19lbmMgPSBfTV9jb2RlY3Z0LT5l
bmNvZGluZygpOwogICAgICAgc3RyZWFtc2l6ZSBfX2JsZW47CiAgICAgICBzdHJlYW1zaXplIF9f
cmxlbjsKICAgICAgIGlmIChfX2VuYyA+IDApCiAgX19ibGVuID0gX19ybGVuID0gX19idWZsZW4g
KiBfX2VuYzsKICAgICAgIGVsc2UKICB7CiAgICBfX2JsZW4gPSBfX2J1ZmxlbiArIF9NX2NvZGVj
dnQtPm1heF9sZW5ndGgoKSAtIDE7CiAgICBfX3JsZW4gPSBfX2J1ZmxlbjsKICB9CiAgICAgICBj
b25zdCBzdHJlYW1zaXplIF9fcmVtYWluZGVyID0gX01fZXh0X2VuZCAtIF9NX2V4dF9uZXh0Owog
ICAgICAgX19ybGVuID0gX19ybGVuID4gX19yZW1haW5kZXIgPyBfX3JsZW4gLSBfX3JlbWFpbmRl
ciA6IDA7CgoKCiAgICAgICBpZiAoX01fcmVhZGluZyAmJiB0aGlzLT5lZ3B0cigpID09IHRoaXMt
PmViYWNrKCkgJiYgX19yZW1haW5kZXIpCiAgX19ybGVuID0gMDsKCgoKICAgICAgIGlmIChfTV9l
eHRfYnVmX3NpemUgPCBfX2JsZW4pCiAgewogICAgY2hhciogX19idWYgPSBuZXcgY2hhcltfX2Js
ZW5dOwogICAgaWYgKF9fcmVtYWluZGVyKQogICAgICBfX2J1aWx0aW5fbWVtY3B5KF9fYnVmLCBf
TV9leHRfbmV4dCwgX19yZW1haW5kZXIpOwoKICAgIGRlbGV0ZSBbXSBfTV9leHRfYnVmOwogICAg
X01fZXh0X2J1ZiA9IF9fYnVmOwogICAgX01fZXh0X2J1Zl9zaXplID0gX19ibGVuOwogIH0KICAg
ICAgIGVsc2UgaWYgKF9fcmVtYWluZGVyKQogIF9fYnVpbHRpbl9tZW1tb3ZlKF9NX2V4dF9idWYs
IF9NX2V4dF9uZXh0LCBfX3JlbWFpbmRlcik7CgogICAgICAgX01fZXh0X25leHQgPSBfTV9leHRf
YnVmOwogICAgICAgX01fZXh0X2VuZCA9IF9NX2V4dF9idWYgKyBfX3JlbWFpbmRlcjsKICAgICAg
IF9NX3N0YXRlX2xhc3QgPSBfTV9zdGF0ZV9jdXI7CgogICAgICAgZG8KICB7CiAgICBpZiAoX19y
bGVuID4gMCkKICAgICAgewoKCgogICAgICAgIGlmIChfTV9leHRfZW5kIC0gX01fZXh0X2J1ZiAr
IF9fcmxlbiA+IF9NX2V4dF9idWZfc2l6ZSkKICAgewogICAgIF9fdGhyb3dfaW9zX2ZhaWx1cmUo
KCJiYXNpY19maWxlYnVmOjp1bmRlcmZsb3cgIiAiY29kZWN2dDo6bWF4X2xlbmd0aCgpICIgImlz
IG5vdCB2YWxpZCIpCgogICAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgIH0KICAgICAgICBz
dHJlYW1zaXplIF9fZWxlbiA9IF9NX2ZpbGUueHNnZXRuKF9NX2V4dF9lbmQsIF9fcmxlbik7CiAg
ICAgICAgaWYgKF9fZWxlbiA9PSAwKQogICBfX2dvdF9lb2YgPSB0cnVlOwogICAgICAgIGVsc2Ug
aWYgKF9fZWxlbiA9PSAtMSkKICAgYnJlYWs7CiAgICAgICAgX01fZXh0X2VuZCArPSBfX2VsZW47
CiAgICAgIH0KCiAgICBjaGFyX3R5cGUqIF9faWVuZCA9IHRoaXMtPmViYWNrKCk7CiAgICBpZiAo
X01fZXh0X25leHQgPCBfTV9leHRfZW5kKQogICAgICBfX3IgPSBfTV9jb2RlY3Z0LT5pbihfTV9z
dGF0ZV9jdXIsIF9NX2V4dF9uZXh0LAogICAgICBfTV9leHRfZW5kLCBfTV9leHRfbmV4dCwKICAg
ICAgdGhpcy0+ZWJhY2soKSwKICAgICAgdGhpcy0+ZWJhY2soKSArIF9fYnVmbGVuLCBfX2llbmQp
OwogICAgaWYgKF9fciA9PSBjb2RlY3Z0X2Jhc2U6Om5vY29udikKICAgICAgewogICAgICAgIHNp
emVfdCBfX2F2YWlsID0gX01fZXh0X2VuZCAtIF9NX2V4dF9idWY7CiAgICAgICAgX19pbGVuID0g
c3RkOjptaW4oX19hdmFpbCwgX19idWZsZW4pOwogICAgICAgIHRyYWl0c190eXBlOjpjb3B5KHRo
aXMtPmViYWNrKCksCiAgICAgcmVpbnRlcnByZXRfY2FzdDxjaGFyX3R5cGUqPgogICAgIChfTV9l
eHRfYnVmKSwgX19pbGVuKTsKICAgICAgICBfTV9leHRfbmV4dCA9IF9NX2V4dF9idWYgKyBfX2ls
ZW47CiAgICAgIH0KICAgIGVsc2UKICAgICAgX19pbGVuID0gX19pZW5kIC0gdGhpcy0+ZWJhY2so
KTsKCgoKCiAgICBpZiAoX19yID09IGNvZGVjdnRfYmFzZTo6ZXJyb3IpCiAgICAgIGJyZWFrOwoK
ICAgIF9fcmxlbiA9IDE7CiAgfQogICAgICAgd2hpbGUgKF9faWxlbiA9PSAwICYmICFfX2dvdF9l
b2YpOwogICAgIH0KCiAgIGlmIChfX2lsZW4gPiAwKQogICAgIHsKICAgICAgIF9NX3NldF9idWZm
ZXIoX19pbGVuKTsKICAgICAgIF9NX3JlYWRpbmcgPSB0cnVlOwogICAgICAgX19yZXQgPSB0cmFp
dHNfdHlwZTo6dG9faW50X3R5cGUoKnRoaXMtPmdwdHIoKSk7CiAgICAgfQogICBlbHNlIGlmIChf
X2dvdF9lb2YpCiAgICAgewoKCgogICAgICAgX01fc2V0X2J1ZmZlcigtMSk7CiAgICAgICBfTV9y
ZWFkaW5nID0gZmFsc2U7CgoKICAgICAgIGlmIChfX3IgPT0gY29kZWN2dF9iYXNlOjpwYXJ0aWFs
KQogIF9fdGhyb3dfaW9zX2ZhaWx1cmUoKCJiYXNpY19maWxlYnVmOjp1bmRlcmZsb3cgIiAiaW5j
b21wbGV0ZSBjaGFyYWN0ZXIgaW4gZmlsZSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICk7CiAgICAgfQogICBlbHNlIGlmIChfX3IgPT0gY29kZWN2dF9iYXNlOjplcnJv
cikKICAgICBfX3Rocm93X2lvc19mYWlsdXJlKCgiYmFzaWNfZmlsZWJ1Zjo6dW5kZXJmbG93ICIg
ImludmFsaWQgYnl0ZSBzZXF1ZW5jZSBpbiBmaWxlIikKICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKTsKICAgZWxzZQogICAgIF9fdGhyb3dfaW9zX2ZhaWx1cmUoKCJiYXNpY19m
aWxlYnVmOjp1bmRlcmZsb3cgIiAiZXJyb3IgcmVhZGluZyB0aGUgZmlsZSIpCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgKTsKIH0KICAgICAgcmV0dXJuIF9fcmV0OwogICAgfQoKICB0ZW1w
bGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAgICB0eXBlbmFtZSBiYXNp
Y19maWxlYnVmPF9DaGFyVCwgX1RyYWl0cz46OmludF90eXBlCiAgICBiYXNpY19maWxlYnVmPF9D
aGFyVCwgX1RyYWl0cz46OgogICAgcGJhY2tmYWlsKGludF90eXBlIF9faSkKICAgIHsKICAgICAg
aW50X3R5cGUgX19yZXQgPSB0cmFpdHNfdHlwZTo6ZW9mKCk7CiAgICAgIGNvbnN0IGJvb2wgX190
ZXN0aW4gPSBfTV9tb2RlICYgaW9zX2Jhc2U6OmluOwogICAgICBpZiAoX190ZXN0aW4pCiB7CiAg
IGlmIChfTV93cml0aW5nKQogICAgIHsKICAgICAgIGlmIChvdmVyZmxvdygpID09IHRyYWl0c190
eXBlOjplb2YoKSkKICByZXR1cm4gX19yZXQ7CiAgICAgICBfTV9zZXRfYnVmZmVyKC0xKTsKICAg
ICAgIF9NX3dyaXRpbmcgPSBmYWxzZTsKICAgICB9CgoKICAgY29uc3QgYm9vbCBfX3Rlc3RwYiA9
IF9NX3BiYWNrX2luaXQ7CiAgIGNvbnN0IGJvb2wgX190ZXN0ZW9mID0gdHJhaXRzX3R5cGU6OmVx
X2ludF90eXBlKF9faSwgX19yZXQpOwogICBpbnRfdHlwZSBfX3RtcDsKICAgaWYgKHRoaXMtPmVi
YWNrKCkgPCB0aGlzLT5ncHRyKCkpCiAgICAgewogICAgICAgdGhpcy0+Z2J1bXAoLTEpOwogICAg
ICAgX190bXAgPSB0cmFpdHNfdHlwZTo6dG9faW50X3R5cGUoKnRoaXMtPmdwdHIoKSk7CiAgICAg
fQogICBlbHNlIGlmICh0aGlzLT5zZWVrb2ZmKC0xLCBpb3NfYmFzZTo6Y3VyKSAhPSBwb3NfdHlw
ZShvZmZfdHlwZSgtMSkpKQogICAgIHsKICAgICAgIF9fdG1wID0gdGhpcy0+dW5kZXJmbG93KCk7
CiAgICAgICBpZiAodHJhaXRzX3R5cGU6OmVxX2ludF90eXBlKF9fdG1wLCBfX3JldCkpCiAgcmV0
dXJuIF9fcmV0OwogICAgIH0KICAgZWxzZQogICAgIHsKCgoKCgogICAgICAgcmV0dXJuIF9fcmV0
OwogICAgIH0KCgoKICAgaWYgKCFfX3Rlc3Rlb2YgJiYgdHJhaXRzX3R5cGU6OmVxX2ludF90eXBl
KF9faSwgX190bXApKQogICAgIF9fcmV0ID0gX19pOwogICBlbHNlIGlmIChfX3Rlc3Rlb2YpCiAg
ICAgX19yZXQgPSB0cmFpdHNfdHlwZTo6bm90X2VvZihfX2kpOwogICBlbHNlIGlmICghX190ZXN0
cGIpCiAgICAgewogICAgICAgX01fY3JlYXRlX3BiYWNrKCk7CiAgICAgICBfTV9yZWFkaW5nID0g
dHJ1ZTsKICAgICAgICp0aGlzLT5ncHRyKCkgPSB0cmFpdHNfdHlwZTo6dG9fY2hhcl90eXBlKF9f
aSk7CiAgICAgICBfX3JldCA9IF9faTsKICAgICB9CiB9CiAgICAgIHJldHVybiBfX3JldDsKICAg
IH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgdHlw
ZW5hbWUgYmFzaWNfZmlsZWJ1ZjxfQ2hhclQsIF9UcmFpdHM+OjppbnRfdHlwZQogICAgYmFzaWNf
ZmlsZWJ1ZjxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIG92ZXJmbG93KGludF90eXBlIF9fYykKICAg
IHsKICAgICAgaW50X3R5cGUgX19yZXQgPSB0cmFpdHNfdHlwZTo6ZW9mKCk7CiAgICAgIGNvbnN0
IGJvb2wgX190ZXN0ZW9mID0gdHJhaXRzX3R5cGU6OmVxX2ludF90eXBlKF9fYywgX19yZXQpOwog
ICAgICBjb25zdCBib29sIF9fdGVzdG91dCA9IChfTV9tb2RlICYgaW9zX2Jhc2U6Om91dAogICAg
ICAgICB8fCBfTV9tb2RlICYgaW9zX2Jhc2U6OmFwcCk7CiAgICAgIGlmIChfX3Rlc3RvdXQpCiB7
CiAgICAgICAgICBpZiAoX01fcmVhZGluZykKICAgICAgICAgICAgewogICAgICAgICAgICAgIF9N
X2Rlc3Ryb3lfcGJhY2soKTsKICAgICAgICAgICAgICBjb25zdCBpbnQgX19ncHRyX29mZiA9IF9N
X2dldF9leHRfcG9zKF9NX3N0YXRlX2xhc3QpOwogICAgICAgICAgICAgIGlmIChfTV9zZWVrKF9f
Z3B0cl9vZmYsIGlvc19iYXNlOjpjdXIsIF9NX3N0YXRlX2xhc3QpCiAgICAgICAgICAgICAgICAg
ID09IHBvc190eXBlKG9mZl90eXBlKC0xKSkpCiAgICAgICAgICAgICAgICByZXR1cm4gX19yZXQ7
CiAgICAgICAgICAgIH0KICAgaWYgKHRoaXMtPnBiYXNlKCkgPCB0aGlzLT5wcHRyKCkpCiAgICAg
ewoKICAgICAgIGlmICghX190ZXN0ZW9mKQogIHsKICAgICp0aGlzLT5wcHRyKCkgPSB0cmFpdHNf
dHlwZTo6dG9fY2hhcl90eXBlKF9fYyk7CiAgICB0aGlzLT5wYnVtcCgxKTsKICB9CgoKCiAgICAg
ICBpZiAoX01fY29udmVydF90b19leHRlcm5hbCh0aGlzLT5wYmFzZSgpLAogICAgICB0aGlzLT5w
cHRyKCkgLSB0aGlzLT5wYmFzZSgpKSkKICB7CiAgICBfTV9zZXRfYnVmZmVyKDApOwogICAgX19y
ZXQgPSB0cmFpdHNfdHlwZTo6bm90X2VvZihfX2MpOwogIH0KICAgICB9CiAgIGVsc2UgaWYgKF9N
X2J1Zl9zaXplID4gMSkKICAgICB7CgoKCiAgICAgICBfTV9zZXRfYnVmZmVyKDApOwogICAgICAg
X01fd3JpdGluZyA9IHRydWU7CiAgICAgICBpZiAoIV9fdGVzdGVvZikKICB7CiAgICAqdGhpcy0+
cHB0cigpID0gdHJhaXRzX3R5cGU6OnRvX2NoYXJfdHlwZShfX2MpOwogICAgdGhpcy0+cGJ1bXAo
MSk7CiAgfQogICAgICAgX19yZXQgPSB0cmFpdHNfdHlwZTo6bm90X2VvZihfX2MpOwogICAgIH0K
ICAgZWxzZQogICAgIHsKCiAgICAgICBjaGFyX3R5cGUgX19jb252ID0gdHJhaXRzX3R5cGU6OnRv
X2NoYXJfdHlwZShfX2MpOwogICAgICAgaWYgKF9fdGVzdGVvZiB8fCBfTV9jb252ZXJ0X3RvX2V4
dGVybmFsKCZfX2NvbnYsIDEpKQogIHsKICAgIF9NX3dyaXRpbmcgPSB0cnVlOwogICAgX19yZXQg
PSB0cmFpdHNfdHlwZTo6bm90X2VvZihfX2MpOwogIH0KICAgICB9CiB9CiAgICAgIHJldHVybiBf
X3JldDsKICAgIH0KCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRz
PgogICAgYm9vbAogICAgYmFzaWNfZmlsZWJ1ZjxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIF9NX2Nv
bnZlcnRfdG9fZXh0ZXJuYWwoX0NoYXJUKiBfX2lidWYsIHN0cmVhbXNpemUgX19pbGVuKQogICAg
ewoKICAgICAgc3RyZWFtc2l6ZSBfX2VsZW47CiAgICAgIHN0cmVhbXNpemUgX19wbGVuOwogICAg
ICBpZiAoX19jaGVja19mYWNldChfTV9jb2RlY3Z0KS5hbHdheXNfbm9jb252KCkpCiB7CiAgIF9f
ZWxlbiA9IF9NX2ZpbGUueHNwdXRuKHJlaW50ZXJwcmV0X2Nhc3Q8Y2hhcio+KF9faWJ1ZiksIF9f
aWxlbik7CiAgIF9fcGxlbiA9IF9faWxlbjsKIH0KICAgICAgZWxzZQogewoKCiAgIHN0cmVhbXNp
emUgX19ibGVuID0gX19pbGVuICogX01fY29kZWN2dC0+bWF4X2xlbmd0aCgpOwogICBjaGFyKiBf
X2J1ZiA9IHN0YXRpY19jYXN0PGNoYXIqPihfX2J1aWx0aW5fYWxsb2NhKF9fYmxlbikpOwoKICAg
Y2hhciogX19iZW5kOwogICBjb25zdCBjaGFyX3R5cGUqIF9faWVuZDsKICAgY29kZWN2dF9iYXNl
OjpyZXN1bHQgX19yOwogICBfX3IgPSBfTV9jb2RlY3Z0LT5vdXQoX01fc3RhdGVfY3VyLCBfX2li
dWYsIF9faWJ1ZiArIF9faWxlbiwKICAgIF9faWVuZCwgX19idWYsIF9fYnVmICsgX19ibGVuLCBf
X2JlbmQpOwoKICAgaWYgKF9fciA9PSBjb2RlY3Z0X2Jhc2U6Om9rIHx8IF9fciA9PSBjb2RlY3Z0
X2Jhc2U6OnBhcnRpYWwpCiAgICAgX19ibGVuID0gX19iZW5kIC0gX19idWY7CiAgIGVsc2UgaWYg
KF9fciA9PSBjb2RlY3Z0X2Jhc2U6Om5vY29udikKICAgICB7CgogICAgICAgX19idWYgPSByZWlu
dGVycHJldF9jYXN0PGNoYXIqPihfX2lidWYpOwogICAgICAgX19ibGVuID0gX19pbGVuOwogICAg
IH0KICAgZWxzZQogICAgIF9fdGhyb3dfaW9zX2ZhaWx1cmUoKCJiYXNpY19maWxlYnVmOjpfTV9j
b252ZXJ0X3RvX2V4dGVybmFsICIgImNvbnZlcnNpb24gZXJyb3IiKQogICAgICAgICAgICAgICAg
ICAgICAgICAgICApOwoKICAgX19lbGVuID0gX01fZmlsZS54c3B1dG4oX19idWYsIF9fYmxlbik7
CiAgIF9fcGxlbiA9IF9fYmxlbjsKCgogICBpZiAoX19yID09IGNvZGVjdnRfYmFzZTo6cGFydGlh
bCAmJiBfX2VsZW4gPT0gX19wbGVuKQogICAgIHsKICAgICAgIGNvbnN0IGNoYXJfdHlwZSogX19p
cmVzdW1lID0gX19pZW5kOwogICAgICAgc3RyZWFtc2l6ZSBfX3JsZW4gPSB0aGlzLT5wcHRyKCkg
LSBfX2llbmQ7CiAgICAgICBfX3IgPSBfTV9jb2RlY3Z0LT5vdXQoX01fc3RhdGVfY3VyLCBfX2ly
ZXN1bWUsCiAgICAgICAgX19pcmVzdW1lICsgX19ybGVuLCBfX2llbmQsIF9fYnVmLAogICAgICAg
IF9fYnVmICsgX19ibGVuLCBfX2JlbmQpOwogICAgICAgaWYgKF9fciAhPSBjb2RlY3Z0X2Jhc2U6
OmVycm9yKQogIHsKICAgIF9fcmxlbiA9IF9fYmVuZCAtIF9fYnVmOwogICAgX19lbGVuID0gX01f
ZmlsZS54c3B1dG4oX19idWYsIF9fcmxlbik7CiAgICBfX3BsZW4gPSBfX3JsZW47CiAgfQogICAg
ICAgZWxzZQogIF9fdGhyb3dfaW9zX2ZhaWx1cmUoKCJiYXNpY19maWxlYnVmOjpfTV9jb252ZXJ0
X3RvX2V4dGVybmFsICIgImNvbnZlcnNpb24gZXJyb3IiKQogICAgICAgICAgICAgICAgICAgICAg
ICApOwogICAgIH0KIH0KICAgICAgcmV0dXJuIF9fZWxlbiA9PSBfX3BsZW47CiAgICB9CgogIHRl
bXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIHN0cmVhbXNpemUK
ICAgIGJhc2ljX2ZpbGVidWY8X0NoYXJULCBfVHJhaXRzPjo6CiAgICB4c2dldG4oX0NoYXJUKiBf
X3MsIHN0cmVhbXNpemUgX19uKQogICAgewoKICAgICAgc3RyZWFtc2l6ZSBfX3JldCA9IDA7CiAg
ICAgIGlmIChfTV9wYmFja19pbml0KQogewogICBpZiAoX19uID4gMCAmJiB0aGlzLT5ncHRyKCkg
PT0gdGhpcy0+ZWJhY2soKSkKICAgICB7CiAgICAgICAqX19zKysgPSAqdGhpcy0+Z3B0cigpOwog
ICAgICAgdGhpcy0+Z2J1bXAoMSk7CiAgICAgICBfX3JldCA9IDE7CiAgICAgICAtLV9fbjsKICAg
ICB9CiAgIF9NX2Rlc3Ryb3lfcGJhY2soKTsKIH0KICAgICAgZWxzZSBpZiAoX01fd3JpdGluZykK
IHsKICAgIGlmIChvdmVyZmxvdygpID09IHRyYWl0c190eXBlOjplb2YoKSkKICAgICAgcmV0dXJu
IF9fcmV0OwogICAgX01fc2V0X2J1ZmZlcigtMSk7CiAgICBfTV93cml0aW5nID0gZmFsc2U7CiAg
fQoKCgoKICAgICAgY29uc3QgYm9vbCBfX3Rlc3RpbiA9IF9NX21vZGUgJiBpb3NfYmFzZTo6aW47
CiAgICAgIGNvbnN0IHN0cmVhbXNpemUgX19idWZsZW4gPSBfTV9idWZfc2l6ZSA+IDEgPyBfTV9i
dWZfc2l6ZSAtIDEgOiAxOwoKICAgICAgaWYgKF9fbiA+IF9fYnVmbGVuICYmIF9fY2hlY2tfZmFj
ZXQoX01fY29kZWN2dCkuYWx3YXlzX25vY29udigpCiAgICAgJiYgX190ZXN0aW4pCiAgIHsKCiAg
ICAgY29uc3Qgc3RyZWFtc2l6ZSBfX2F2YWlsID0gdGhpcy0+ZWdwdHIoKSAtIHRoaXMtPmdwdHIo
KTsKICAgICBpZiAoX19hdmFpbCAhPSAwKQogICAgICAgewogICAgICAgIHRyYWl0c190eXBlOjpj
b3B5KF9fcywgdGhpcy0+Z3B0cigpLCBfX2F2YWlsKTsKICAgICAgICAgX19zICs9IF9fYXZhaWw7
CiAgICAgICAgdGhpcy0+c2V0Zyh0aGlzLT5lYmFjaygpLCB0aGlzLT5ncHRyKCkgKyBfX2F2YWls
LAogICAgIHRoaXMtPmVncHRyKCkpOwogICAgICAgIF9fcmV0ICs9IF9fYXZhaWw7CiAgICAgICAg
X19uIC09IF9fYXZhaWw7CiAgICAgICB9CgoKCiAgICAgc3RyZWFtc2l6ZSBfX2xlbjsKICAgICBm
b3IgKDs7KQogICAgICAgewogICAgICAgICBfX2xlbiA9IF9NX2ZpbGUueHNnZXRuKHJlaW50ZXJw
cmV0X2Nhc3Q8Y2hhcio+KF9fcyksCiAgICAgICAgICAgX19uKTsKICAgICAgICAgaWYgKF9fbGVu
ID09IC0xKQogICAgX190aHJvd19pb3NfZmFpbHVyZSgoImJhc2ljX2ZpbGVidWY6OnhzZ2V0biAi
ICJlcnJvciByZWFkaW5nIHRoZSBmaWxlIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICApOwogICAgICAgICBpZiAoX19sZW4gPT0gMCkKICAgIGJyZWFrOwoKICAgICAgICAgX19uIC09
IF9fbGVuOwogICAgICAgICBfX3JldCArPSBfX2xlbjsKICAgICAgICAgaWYgKF9fbiA9PSAwKQog
ICAgYnJlYWs7CgogICAgICAgICBfX3MgKz0gX19sZW47CiAgICAgICB9CgogICAgIGlmIChfX24g
PT0gMCkKICAgICAgIHsKICAgICAgICAgX01fc2V0X2J1ZmZlcigwKTsKICAgICAgICAgX01fcmVh
ZGluZyA9IHRydWU7CiAgICAgICB9CiAgICAgZWxzZSBpZiAoX19sZW4gPT0gMCkKICAgICAgIHsK
CgoKICAgICAgICAgX01fc2V0X2J1ZmZlcigtMSk7CiAgICAgICAgIF9NX3JlYWRpbmcgPSBmYWxz
ZTsKICAgICAgIH0KICAgfQogICAgICBlbHNlCiAgIF9fcmV0ICs9IF9fc3RyZWFtYnVmX3R5cGU6
OnhzZ2V0bihfX3MsIF9fbik7CgogICAgICByZXR1cm4gX19yZXQ7CiAgICB9CgogIHRlbXBsYXRl
PHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIHN0cmVhbXNpemUKICAgIGJh
c2ljX2ZpbGVidWY8X0NoYXJULCBfVHJhaXRzPjo6CiAgICB4c3B1dG4oY29uc3QgX0NoYXJUKiBf
X3MsIHN0cmVhbXNpemUgX19uKQogICAgewogICAgICBzdHJlYW1zaXplIF9fcmV0ID0gMDsKCgoK
ICAgICAgY29uc3QgYm9vbCBfX3Rlc3RvdXQgPSAoX01fbW9kZSAmIGlvc19iYXNlOjpvdXQKICAg
ICAgICAgfHwgX01fbW9kZSAmIGlvc19iYXNlOjphcHApOwogICAgICBpZiAoX19jaGVja19mYWNl
dChfTV9jb2RlY3Z0KS5hbHdheXNfbm9jb252KCkKICAgICAmJiBfX3Rlc3RvdXQgJiYgIV9NX3Jl
YWRpbmcpCiB7CgogICBjb25zdCBzdHJlYW1zaXplIF9fY2h1bmsgPSAxdWwgPDwgMTA7CiAgIHN0
cmVhbXNpemUgX19idWZhdmFpbCA9IHRoaXMtPmVwcHRyKCkgLSB0aGlzLT5wcHRyKCk7CgoKICAg
aWYgKCFfTV93cml0aW5nICYmIF9NX2J1Zl9zaXplID4gMSkKICAgICBfX2J1ZmF2YWlsID0gX01f
YnVmX3NpemUgLSAxOwoKICAgY29uc3Qgc3RyZWFtc2l6ZSBfX2xpbWl0ID0gc3RkOjptaW4oX19j
aHVuaywgX19idWZhdmFpbCk7CiAgIGlmIChfX24gPj0gX19saW1pdCkKICAgICB7CiAgICAgICBj
b25zdCBzdHJlYW1zaXplIF9fYnVmZmlsbCA9IHRoaXMtPnBwdHIoKSAtIHRoaXMtPnBiYXNlKCk7
CiAgICAgICBjb25zdCBjaGFyKiBfX2J1ZiA9IHJlaW50ZXJwcmV0X2Nhc3Q8Y29uc3QgY2hhcio+
KHRoaXMtPnBiYXNlKCkpOwogICAgICAgX19yZXQgPSBfTV9maWxlLnhzcHV0bl8yKF9fYnVmLCBf
X2J1ZmZpbGwsCiAgICAgICAgICAgcmVpbnRlcnByZXRfY2FzdDxjb25zdCBjaGFyKj4oX19zKSwK
ICAgICAgICAgICBfX24pOwogICAgICAgaWYgKF9fcmV0ID09IF9fYnVmZmlsbCArIF9fbikKICB7
CiAgICBfTV9zZXRfYnVmZmVyKDApOwogICAgX01fd3JpdGluZyA9IHRydWU7CiAgfQogICAgICAg
aWYgKF9fcmV0ID4gX19idWZmaWxsKQogIF9fcmV0IC09IF9fYnVmZmlsbDsKICAgICAgIGVsc2UK
ICBfX3JldCA9IDA7CiAgICAgfQogICBlbHNlCiAgICAgX19yZXQgPSBfX3N0cmVhbWJ1Zl90eXBl
Ojp4c3B1dG4oX19zLCBfX24pOwogfQogICAgICAgZWxzZQogIF9fcmV0ID0gX19zdHJlYW1idWZf
dHlwZTo6eHNwdXRuKF9fcywgX19uKTsKICAgICAgIHJldHVybiBfX3JldDsKICAgIH0KCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgdHlwZW5hbWUgYmFz
aWNfZmlsZWJ1ZjxfQ2hhclQsIF9UcmFpdHM+OjpfX3N0cmVhbWJ1Zl90eXBlKgogICAgYmFzaWNf
ZmlsZWJ1ZjxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIHNldGJ1ZihjaGFyX3R5cGUqIF9fcywgc3Ry
ZWFtc2l6ZSBfX24pCiAgICB7CiAgICAgIGlmICghdGhpcy0+aXNfb3BlbigpKQogewogICBpZiAo
X19zID09IDAgJiYgX19uID09IDApCiAgICAgX01fYnVmX3NpemUgPSAxOwogICBlbHNlIGlmIChf
X3MgJiYgX19uID4gMCkKICAgICB7CiMgNzg3ICIvdXNyL2luY2x1ZGUvYysrLzYuMC4wL2JpdHMv
ZnN0cmVhbS50Y2MiIDMKICAgICAgIF9NX2J1ZiA9IF9fczsKICAgICAgIF9NX2J1Zl9zaXplID0g
X19uOwogICAgIH0KIH0KICAgICAgcmV0dXJuIHRoaXM7CiAgICB9CgoKCgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIHR5cGVuYW1lIGJhc2ljX2ZpbGVi
dWY8X0NoYXJULCBfVHJhaXRzPjo6cG9zX3R5cGUKICAgIGJhc2ljX2ZpbGVidWY8X0NoYXJULCBf
VHJhaXRzPjo6CiAgICBzZWVrb2ZmKG9mZl90eXBlIF9fb2ZmLCBpb3NfYmFzZTo6c2Vla2RpciBf
X3dheSwgaW9zX2Jhc2U6Om9wZW5tb2RlKQogICAgewogICAgICBpbnQgX193aWR0aCA9IDA7CiAg
ICAgIGlmIChfTV9jb2RlY3Z0KQogX193aWR0aCA9IF9NX2NvZGVjdnQtPmVuY29kaW5nKCk7CiAg
ICAgIGlmIChfX3dpZHRoIDwgMCkKIF9fd2lkdGggPSAwOwoKICAgICAgcG9zX3R5cGUgX19yZXQg
PSBwb3NfdHlwZShvZmZfdHlwZSgtMSkpOwogICAgICBjb25zdCBib29sIF9fdGVzdGZhaWwgPSBf
X29mZiAhPSAwICYmIF9fd2lkdGggPD0gMDsKICAgICAgaWYgKHRoaXMtPmlzX29wZW4oKSAmJiAh
X190ZXN0ZmFpbCkKIHsKCgoKCiAgIGJvb2wgX19ub19tb3ZlbWVudCA9IF9fd2F5ID09IGlvc19i
YXNlOjpjdXIgJiYgX19vZmYgPT0gMAogICAgICYmICghX01fd3JpdGluZyB8fCBfTV9jb2RlY3Z0
LT5hbHdheXNfbm9jb252KCkpOwoKCiAgIGlmICghX19ub19tb3ZlbWVudCkKICAgICBfTV9kZXN0
cm95X3BiYWNrKCk7CgoKCgoKCiAgIF9fc3RhdGVfdHlwZSBfX3N0YXRlID0gX01fc3RhdGVfYmVn
OwogICBvZmZfdHlwZSBfX2NvbXB1dGVkX29mZiA9IF9fb2ZmICogX193aWR0aDsKICAgaWYgKF9N
X3JlYWRpbmcgJiYgX193YXkgPT0gaW9zX2Jhc2U6OmN1cikKICAgICB7CiAgICAgICBfX3N0YXRl
ID0gX01fc3RhdGVfbGFzdDsKICAgICAgIF9fY29tcHV0ZWRfb2ZmICs9IF9NX2dldF9leHRfcG9z
KF9fc3RhdGUpOwogICAgIH0KICAgaWYgKCFfX25vX21vdmVtZW50KQogICAgIF9fcmV0ID0gX01f
c2VlayhfX2NvbXB1dGVkX29mZiwgX193YXksIF9fc3RhdGUpOwogICBlbHNlCiAgICAgewogICAg
ICAgaWYgKF9NX3dyaXRpbmcpCiAgX19jb21wdXRlZF9vZmYgPSB0aGlzLT5wcHRyKCkgLSB0aGlz
LT5wYmFzZSgpOwoKICAgICAgICBvZmZfdHlwZSBfX2ZpbGVfb2ZmID0gX01fZmlsZS5zZWVrb2Zm
KDAsIGlvc19iYXNlOjpjdXIpOwogICAgICAgIGlmIChfX2ZpbGVfb2ZmICE9IG9mZl90eXBlKC0x
KSkKICB7CiAgICBfX3JldCA9IF9fZmlsZV9vZmYgKyBfX2NvbXB1dGVkX29mZjsKICAgIF9fcmV0
LnN0YXRlKF9fc3RhdGUpOwogIH0KICAgICB9CiB9CiAgICAgIHJldHVybiBfX3JldDsKICAgIH0K
CgoKCgogIHRlbXBsYXRlPHR5cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIHR5
cGVuYW1lIGJhc2ljX2ZpbGVidWY8X0NoYXJULCBfVHJhaXRzPjo6cG9zX3R5cGUKICAgIGJhc2lj
X2ZpbGVidWY8X0NoYXJULCBfVHJhaXRzPjo6CiAgICBzZWVrcG9zKHBvc190eXBlIF9fcG9zLCBp
b3NfYmFzZTo6b3Blbm1vZGUpCiAgICB7CiAgICAgIHBvc190eXBlIF9fcmV0ID0gcG9zX3R5cGUo
b2ZmX3R5cGUoLTEpKTsKICAgICAgaWYgKHRoaXMtPmlzX29wZW4oKSkKIHsKCiAgIF9NX2Rlc3Ry
b3lfcGJhY2soKTsKICAgX19yZXQgPSBfTV9zZWVrKG9mZl90eXBlKF9fcG9zKSwgaW9zX2Jhc2U6
OmJlZywgX19wb3Muc3RhdGUoKSk7CiB9CiAgICAgIHJldHVybiBfX3JldDsKICAgIH0KCiAgdGVt
cGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgdHlwZW5hbWUgYmFz
aWNfZmlsZWJ1ZjxfQ2hhclQsIF9UcmFpdHM+Ojpwb3NfdHlwZQogICAgYmFzaWNfZmlsZWJ1Zjxf
Q2hhclQsIF9UcmFpdHM+OjoKICAgIF9NX3NlZWsob2ZmX3R5cGUgX19vZmYsIGlvc19iYXNlOjpz
ZWVrZGlyIF9fd2F5LCBfX3N0YXRlX3R5cGUgX19zdGF0ZSkKICAgIHsKICAgICAgcG9zX3R5cGUg
X19yZXQgPSBwb3NfdHlwZShvZmZfdHlwZSgtMSkpOwogICAgICBpZiAoX01fdGVybWluYXRlX291
dHB1dCgpKQogewogICBvZmZfdHlwZSBfX2ZpbGVfb2ZmID0gX01fZmlsZS5zZWVrb2ZmKF9fb2Zm
LCBfX3dheSk7CiAgIGlmIChfX2ZpbGVfb2ZmICE9IG9mZl90eXBlKC0xKSkKICAgICB7CiAgICAg
ICBfTV9yZWFkaW5nID0gZmFsc2U7CiAgICAgICBfTV93cml0aW5nID0gZmFsc2U7CiAgICAgICBf
TV9leHRfbmV4dCA9IF9NX2V4dF9lbmQgPSBfTV9leHRfYnVmOwogICAgICAgX01fc2V0X2J1ZmZl
cigtMSk7CiAgICAgICBfTV9zdGF0ZV9jdXIgPSBfX3N0YXRlOwogICAgICAgX19yZXQgPSBfX2Zp
bGVfb2ZmOwogICAgICAgX19yZXQuc3RhdGUoX01fc3RhdGVfY3VyKTsKICAgICB9CiB9CiAgICAg
IHJldHVybiBfX3JldDsKICAgIH0KCgoKCiAgdGVtcGxhdGU8dHlwZW5hbWUgX0NoYXJULCB0eXBl
bmFtZSBfVHJhaXRzPgogICAgaW50IGJhc2ljX2ZpbGVidWY8X0NoYXJULCBfVHJhaXRzPjo6CiAg
ICBfTV9nZXRfZXh0X3BvcyhfX3N0YXRlX3R5cGUmIF9fc3RhdGUpCiAgICB7CiAgICAgIGlmIChf
TV9jb2RlY3Z0LT5hbHdheXNfbm9jb252KCkpCiAgICAgICAgcmV0dXJuIHRoaXMtPmdwdHIoKSAt
IHRoaXMtPmVncHRyKCk7CiAgICAgIGVsc2UKICAgICAgICB7CgoKCiAgICAgICAgICBjb25zdCBp
bnQgX19ncHRyX29mZiA9CiAgICAgICAgICAgIF9NX2NvZGVjdnQtPmxlbmd0aChfX3N0YXRlLCBf
TV9leHRfYnVmLCBfTV9leHRfbmV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRo
aXMtPmdwdHIoKSAtIHRoaXMtPmViYWNrKCkpOwogICAgICAgICAgcmV0dXJuIF9NX2V4dF9idWYg
KyBfX2dwdHJfb2ZmIC0gX01fZXh0X2VuZDsKICAgICAgICB9CiAgICB9CgogIHRlbXBsYXRlPHR5
cGVuYW1lIF9DaGFyVCwgdHlwZW5hbWUgX1RyYWl0cz4KICAgIGJvb2wKICAgIGJhc2ljX2ZpbGVi
dWY8X0NoYXJULCBfVHJhaXRzPjo6CiAgICBfTV90ZXJtaW5hdGVfb3V0cHV0KCkKICAgIHsKCiAg
ICAgIGJvb2wgX190ZXN0dmFsaWQgPSB0cnVlOwogICAgICBpZiAodGhpcy0+cGJhc2UoKSA8IHRo
aXMtPnBwdHIoKSkKIHsKICAgY29uc3QgaW50X3R5cGUgX190bXAgPSB0aGlzLT5vdmVyZmxvdygp
OwogICBpZiAodHJhaXRzX3R5cGU6OmVxX2ludF90eXBlKF9fdG1wLCB0cmFpdHNfdHlwZTo6ZW9m
KCkpKQogICAgIF9fdGVzdHZhbGlkID0gZmFsc2U7CiB9CgoKICAgICAgaWYgKF9NX3dyaXRpbmcg
JiYgIV9fY2hlY2tfZmFjZXQoX01fY29kZWN2dCkuYWx3YXlzX25vY29udigpCiAgICYmIF9fdGVz
dHZhbGlkKQogewoKCgogICBjb25zdCBzaXplX3QgX19ibGVuID0gMTI4OwogICBjaGFyIF9fYnVm
W19fYmxlbl07CiAgIGNvZGVjdnRfYmFzZTo6cmVzdWx0IF9fcjsKICAgc3RyZWFtc2l6ZSBfX2ls
ZW4gPSAwOwoKICAgZG8KICAgICB7CiAgICAgICBjaGFyKiBfX25leHQ7CiAgICAgICBfX3IgPSBf
TV9jb2RlY3Z0LT51bnNoaWZ0KF9NX3N0YXRlX2N1ciwgX19idWYsCiAgICAgX19idWYgKyBfX2Js
ZW4sIF9fbmV4dCk7CiAgICAgICBpZiAoX19yID09IGNvZGVjdnRfYmFzZTo6ZXJyb3IpCiAgX190
ZXN0dmFsaWQgPSBmYWxzZTsKICAgICAgIGVsc2UgaWYgKF9fciA9PSBjb2RlY3Z0X2Jhc2U6Om9r
IHx8CiAgICAgICAgIF9fciA9PSBjb2RlY3Z0X2Jhc2U6OnBhcnRpYWwpCiAgewogICAgX19pbGVu
ID0gX19uZXh0IC0gX19idWY7CiAgICBpZiAoX19pbGVuID4gMCkKICAgICAgewogICAgICAgIGNv
bnN0IHN0cmVhbXNpemUgX19lbGVuID0gX01fZmlsZS54c3B1dG4oX19idWYsIF9faWxlbik7CiAg
ICAgICAgaWYgKF9fZWxlbiAhPSBfX2lsZW4pCiAgIF9fdGVzdHZhbGlkID0gZmFsc2U7CiAgICAg
IH0KICB9CiAgICAgfQogICB3aGlsZSAoX19yID09IGNvZGVjdnRfYmFzZTo6cGFydGlhbCAmJiBf
X2lsZW4gPiAwICYmIF9fdGVzdHZhbGlkKTsKCiAgIGlmIChfX3Rlc3R2YWxpZCkKICAgICB7CgoK
CgogICAgICAgY29uc3QgaW50X3R5cGUgX190bXAgPSB0aGlzLT5vdmVyZmxvdygpOwogICAgICAg
aWYgKHRyYWl0c190eXBlOjplcV9pbnRfdHlwZShfX3RtcCwgdHJhaXRzX3R5cGU6OmVvZigpKSkK
ICBfX3Rlc3R2YWxpZCA9IGZhbHNlOwogICAgIH0KIH0KICAgICAgcmV0dXJuIF9fdGVzdHZhbGlk
OwogICAgfQoKICB0ZW1wbGF0ZTx0eXBlbmFtZSBfQ2hhclQsIHR5cGVuYW1lIF9UcmFpdHM+CiAg
ICBpbnQKICAgIGJhc2ljX2ZpbGVidWY8X0NoYXJULCBfVHJhaXRzPjo6CiAgICBzeW5jKCkKICAg
IHsKCgogICAgICBpbnQgX19yZXQgPSAwOwogICAgICBpZiAodGhpcy0+cGJhc2UoKSA8IHRoaXMt
PnBwdHIoKSkKIHsKICAgY29uc3QgaW50X3R5cGUgX190bXAgPSB0aGlzLT5vdmVyZmxvdygpOwog
ICBpZiAodHJhaXRzX3R5cGU6OmVxX2ludF90eXBlKF9fdG1wLCB0cmFpdHNfdHlwZTo6ZW9mKCkp
KQogICAgIF9fcmV0ID0gLTE7CiB9CiAgICAgIHJldHVybiBfX3JldDsKICAgIH0KCiAgdGVtcGxh
dGU8dHlwZW5hbWUgX0NoYXJULCB0eXBlbmFtZSBfVHJhaXRzPgogICAgdm9pZAogICAgYmFzaWNf
ZmlsZWJ1ZjxfQ2hhclQsIF9UcmFpdHM+OjoKICAgIGltYnVlKGNvbnN0IGxvY2FsZSYgX19sb2Mp
CiAgICB7CiAgICAgIGJvb2wgX190ZXN0dmFsaWQgPSB0cnVlOwoKICAgICAgY29uc3QgX19jb2Rl
Y3Z0X3R5cGUqIF9NX2NvZGVjdnRfdG1wID0gMDsKICAgICAgaWYgKF9fYnVpbHRpbl9leHBlY3Qo
aGFzX2ZhY2V0PF9fY29kZWN2dF90eXBlPihfX2xvYyksIHRydWUpKQogX01fY29kZWN2dF90bXAg
PSAmdXNlX2ZhY2V0PF9fY29kZWN2dF90eXBlPihfX2xvYyk7CgogICAgICBpZiAodGhpcy0+aXNf
b3BlbigpKQogewoKICAgaWYgKChfTV9yZWFkaW5nIHx8IF9NX3dyaXRpbmcpCiAgICAgICAmJiBf
X2NoZWNrX2ZhY2V0KF9NX2NvZGVjdnQpLmVuY29kaW5nKCkgPT0gLTEpCiAgICAgX190ZXN0dmFs
aWQgPSBmYWxzZTsKICAgZWxzZQogICAgIHsKICAgICAgIGlmIChfTV9yZWFkaW5nKQogIHsKICAg
IGlmIChfX2NoZWNrX2ZhY2V0KF9NX2NvZGVjdnQpLmFsd2F5c19ub2NvbnYoKSkKICAgICAgewog
ICAgICAgIGlmIChfTV9jb2RlY3Z0X3RtcAogICAgICYmICFfX2NoZWNrX2ZhY2V0KF9NX2NvZGVj
dnRfdG1wKS5hbHdheXNfbm9jb252KCkpCiAgIF9fdGVzdHZhbGlkID0gdGhpcy0+c2Vla29mZigw
LCBpb3NfYmFzZTo6Y3VyLCBfTV9tb2RlKQogICAgICAgICAgICAgICAgICE9IHBvc190eXBlKG9m
Zl90eXBlKC0xKSk7CiAgICAgIH0KICAgIGVsc2UKICAgICAgewoKICAgICAgICBfTV9leHRfbmV4
dCA9IF9NX2V4dF9idWYKICAgKyBfTV9jb2RlY3Z0LT5sZW5ndGgoX01fc3RhdGVfbGFzdCwgX01f
ZXh0X2J1ZiwKICAgICAgICAgIF9NX2V4dF9uZXh0LAogICAgICAgICAgdGhpcy0+Z3B0cigpIC0g
dGhpcy0+ZWJhY2soKSk7CiAgICAgICAgY29uc3Qgc3RyZWFtc2l6ZSBfX3JlbWFpbmRlciA9IF9N
X2V4dF9lbmQgLSBfTV9leHRfbmV4dDsKICAgICAgICBpZiAoX19yZW1haW5kZXIpCiAgIF9fYnVp
bHRpbl9tZW1tb3ZlKF9NX2V4dF9idWYsIF9NX2V4dF9uZXh0LCBfX3JlbWFpbmRlcik7CgogICAg
ICAgIF9NX2V4dF9uZXh0ID0gX01fZXh0X2J1ZjsKICAgICAgICBfTV9leHRfZW5kID0gX01fZXh0
X2J1ZiArIF9fcmVtYWluZGVyOwogICAgICAgIF9NX3NldF9idWZmZXIoLTEpOwogICAgICAgIF9N
X3N0YXRlX2xhc3QgPSBfTV9zdGF0ZV9jdXIgPSBfTV9zdGF0ZV9iZWc7CiAgICAgIH0KICB9CiAg
ICAgICBlbHNlIGlmIChfTV93cml0aW5nICYmIChfX3Rlc3R2YWxpZCA9IF9NX3Rlcm1pbmF0ZV9v
dXRwdXQoKSkpCiAgX01fc2V0X2J1ZmZlcigtMSk7CiAgICAgfQogfQoKICAgICAgaWYgKF9fdGVz
dHZhbGlkKQogX01fY29kZWN2dCA9IF9NX2NvZGVjdnRfdG1wOwogICAgICBlbHNlCiBfTV9jb2Rl
Y3Z0ID0gMDsKICAgIH0KCgoKCiAgZXh0ZXJuIHRlbXBsYXRlIGNsYXNzIGJhc2ljX2ZpbGVidWY8
Y2hhcj47CiAgZXh0ZXJuIHRlbXBsYXRlIGNsYXNzIGJhc2ljX2lmc3RyZWFtPGNoYXI+OwogIGV4
dGVybiB0ZW1wbGF0ZSBjbGFzcyBiYXNpY19vZnN0cmVhbTxjaGFyPjsKICBleHRlcm4gdGVtcGxh
dGUgY2xhc3MgYmFzaWNfZnN0cmVhbTxjaGFyPjsKCgogIGV4dGVybiB0ZW1wbGF0ZSBjbGFzcyBi
YXNpY19maWxlYnVmPHdjaGFyX3Q+OwogIGV4dGVybiB0ZW1wbGF0ZSBjbGFzcyBiYXNpY19pZnN0
cmVhbTx3Y2hhcl90PjsKICBleHRlcm4gdGVtcGxhdGUgY2xhc3MgYmFzaWNfb2ZzdHJlYW08d2No
YXJfdD47CiAgZXh0ZXJuIHRlbXBsYXRlIGNsYXNzIGJhc2ljX2ZzdHJlYW08d2NoYXJfdD47CgoK
Cgp9CiMgMTA4MiAiL3Vzci9pbmNsdWRlL2MrKy82LjAuMC9mc3RyZWFtIiAyIDMKIyA1NCAiL2hv
bWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lEaWFsb2cu
Y2MiIDIKCgoKCgoKCiMgNjAgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFz
dGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIgp0eXBlZGVmIHN0ZDo6bGlzdDxZRXZlbnRGaWx0ZXIg
Kj4gWUV2ZW50RmlsdGVyTGlzdDsKCgpzdHJ1Y3QgWURpYWxvZ1ByaXZhdGUKewogICAgWURpYWxv
Z1ByaXZhdGUoIFlEaWFsb2dUeXBlIGRpYWxvZ1R5cGUsIFlEaWFsb2dDb2xvck1vZGUgY29sb3JN
b2RlICkKIDogZGlhbG9nVHlwZSggZGlhbG9nVHlwZSApCiAsIGNvbG9yTW9kZSggY29sb3JNb2Rl
ICkKICwgc2hvcnRjdXRDaGVja1Bvc3Rwb25lZCggZmFsc2UgKQogLCBkZWZhdWx0QnV0dG9uKCAw
ICkKICwgaXNPcGVuKCBmYWxzZSApCiAsIGxhc3RFdmVudCggMCApCiB7fQoKICAgIFlEaWFsb2dU
eXBlIGRpYWxvZ1R5cGU7CiAgICBZRGlhbG9nQ29sb3JNb2RlIGNvbG9yTW9kZTsKICAgIGJvb2wg
c2hvcnRjdXRDaGVja1Bvc3Rwb25lZDsKICAgIFlQdXNoQnV0dG9uICogZGVmYXVsdEJ1dHRvbjsK
ICAgIGJvb2wgaXNPcGVuOwogICAgWUV2ZW50ICogbGFzdEV2ZW50OwogICAgWUV2ZW50RmlsdGVy
TGlzdCBldmVudEZpbHRlckxpc3Q7Cn07CgoKCgoKCmNsYXNzIFlIZWxwQnV0dG9uSGFuZGxlcjog
cHVibGljIFlFdmVudEZpbHRlcgp7CnB1YmxpYzoKICAgIFlIZWxwQnV0dG9uSGFuZGxlciggWURp
YWxvZyAqIGRpYWxvZyApCiA6IFlFdmVudEZpbHRlciggZGlhbG9nICkKIHt9CgogICAgdmlydHVh
bCB+WUhlbHBCdXR0b25IYW5kbGVyKCkge30KCiAgICBZRXZlbnQgKiBmaWx0ZXIoIFlFdmVudCAq
IGV2ZW50ICkKICAgIHsKIGlmICggZXZlbnQgJiYgZXZlbnQtPndpZGdldCgpICkKIHsKICAgICBZ
UHVzaEJ1dHRvbiAqIGJ1dHRvbiA9IGR5bmFtaWNfY2FzdDxZUHVzaEJ1dHRvbiAqPiAoIGV2ZW50
LT53aWRnZXQoKSApOwoKICAgICBpZiAoIGJ1dHRvbiAmJiBidXR0b24tPmlzSGVscEJ1dHRvbigp
ICkKICAgICB7CiAgaWYgKCBZRGlhbG9nOjpzaG93SGVscFRleHQoIGJ1dHRvbiApICkKICB7CiAg
ICAgIGV2ZW50ID0gMDsKICB9CiAgICAgfQogfQoKIHJldHVybiBldmVudDsKICAgIH0KfTsKCgoK
CmNsYXNzIFlSZWxOb3Rlc0J1dHRvbkhhbmRsZXI6IHB1YmxpYyBZRXZlbnRGaWx0ZXIKewpwdWJs
aWM6CiAgICBZUmVsTm90ZXNCdXR0b25IYW5kbGVyKCBZRGlhbG9nICogZGlhbG9nICkKIDogWUV2
ZW50RmlsdGVyKCBkaWFsb2cgKQoge30KCiAgICB2aXJ0dWFsIH5ZUmVsTm90ZXNCdXR0b25IYW5k
bGVyKCkge30KCiAgICBZRXZlbnQgKiBmaWx0ZXIoIFlFdmVudCAqIGV2ZW50ICkKICAgIHsKIGlm
ICggZXZlbnQgJiYgZXZlbnQtPndpZGdldCgpICkKIHsKICAgICBZUHVzaEJ1dHRvbiAqIGJ1dHRv
biA9IGR5bmFtaWNfY2FzdDxZUHVzaEJ1dHRvbiAqPiAoIGV2ZW50LT53aWRnZXQoKSApOwoKICAg
ICBpZiAoIGJ1dHRvbiAmJiBidXR0b24tPmlzUmVsTm90ZXNCdXR0b24oKSApCiAgICAgewogIGlm
ICggWURpYWxvZzo6c2hvd1JlbE5vdGVzVGV4dCgpICkKICB7CiAgICAgIGV2ZW50ID0gMDsKICB9
CiAgICAgfQogfQoKIHJldHVybiBldmVudDsKICAgIH0KfTsKCgoKCllEaWFsb2c6OllEaWFsb2co
IFlEaWFsb2dUeXBlIGRpYWxvZ1R5cGUsIFlEaWFsb2dDb2xvck1vZGUgY29sb3JNb2RlICkKICAg
IDogWVNpbmdsZUNoaWxkQ29udGFpbmVyV2lkZ2V0KCAwICkKICAgICwgcHJpdiggbmV3IFlEaWFs
b2dQcml2YXRlKCBkaWFsb2dUeXBlLCBjb2xvck1vZGUgKSApCnsKICAgIGRvIHsgaWYgKCAhIChw
cml2KSApIHsgX1lVSV9USFJPVyggKCBZVUlPdXRPZk1lbW9yeUV4Y2VwdGlvbigpICksIFlDb2Rl
TG9jYXRpb24oIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4x
L3NyYy9ZRGlhbG9nLmNjIixfX0ZVTkNUSU9OX18sMTU0KSApOyB9IH0gd2hpbGUoIDAgKTsKCiAg
ICBfZGlhbG9nU3RhY2sucHVzaCggdGhpcyApOwoKCgoKCiAgICBuZXcgWUhlbHBCdXR0b25IYW5k
bGVyKCB0aGlzICk7CiAgICBuZXcgWVJlbE5vdGVzQnV0dG9uSGFuZGxlciggdGhpcyApOwp9CgoK
WURpYWxvZzo6fllEaWFsb2coKQp7CgoKCgoKCgogICAgc2V0QmVpbmdEZXN0cm95ZWQoKTsKCiAg
ICBpZiAoIHByaXYtPmxhc3RFdmVudCApCiBkZWxldGVFdmVudCggcHJpdi0+bGFzdEV2ZW50ICk7
CgoKCgogICAgZGVsZXRlQ2hpbGRyZW4oKTsKCgoKICAgIGRlbGV0ZUV2ZW50RmlsdGVycygpOwoK
ICAgIGlmICggISBfZGlhbG9nU3RhY2suZW1wdHkoKSAmJiBfZGlhbG9nU3RhY2sudG9wKCkgPT0g
dGhpcyApCiAgICB7CiBfZGlhbG9nU3RhY2sucG9wKCk7CgogaWYgKCAhIF9kaWFsb2dTdGFjay5l
bXB0eSgpICkKICAgICBfZGlhbG9nU3RhY2sudG9wKCktPmFjdGl2YXRlKCk7CiAgICB9CiAgICBl
bHNlCiBZVUlMb2c6OmVycm9yICggInVpIiwgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1s
aWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIiwgMTk4LCBfX0ZVTkNUSU9OX18gKSA8
PCAiTm90IHRvcCBvZiBkaWFsb2cgc3RhY2s6ICIgPDwgdGhpcyA8PCBzdGQ6OmVuZGw7Cn0KCgp2
b2lkCllEaWFsb2c6Om9wZW4oKQp7CiAgICBpZiAoIHByaXYtPmlzT3BlbiApCiByZXR1cm47Cgog
ICAgY2hlY2tTaG9ydGN1dHMoKTsKICAgIHNldEluaXRpYWxTaXplKCk7CiAgICBvcGVuSW50ZXJu
YWwoKTsKCiAgICBwcml2LT5pc09wZW4gPSB0cnVlOwp9CgoKYm9vbApZRGlhbG9nOjppc09wZW4o
KSBjb25zdAp7CiAgICByZXR1cm4gcHJpdi0+aXNPcGVuOwp9CgoKYm9vbApZRGlhbG9nOjppc1Rv
cG1vc3REaWFsb2coKSBjb25zdAp7CiAgICBpZiAoIF9kaWFsb2dTdGFjay5lbXB0eSgpICkKICAg
IHsKIFlVSUxvZzo6ZXJyb3IgKCAidWkiLCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxp
Ynl1aS1tYXN0ZXItMy4yLjEvc3JjL1lEaWFsb2cuY2MiLCAyMjgsIF9fRlVOQ1RJT05fXyApIDw8
ICJEaWFsb2cgc3RhY2sgZW1wdHksIGJ1dCBkaWFsb2cgZXhpc3Rpbmc6ICIgPDwgdGhpcyA8PCBz
dGQ6OmVuZGw7CiByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcmV0dXJuIF9kaWFsb2dTdGFjay50
b3AoKSA9PSB0aGlzOwp9CgoKdm9pZApZRGlhbG9nOjpkZWxldGVFdmVudEZpbHRlcnMoKQp7CiAg
ICB3aGlsZSAoICEgcHJpdi0+ZXZlbnRGaWx0ZXJMaXN0LmVtcHR5KCkgKQogICAgewogWUV2ZW50
RmlsdGVyICogZmlsdGVyID0gcHJpdi0+ZXZlbnRGaWx0ZXJMaXN0LmJhY2soKTsKCgoKCiBkZWxl
dGUgZmlsdGVyOwogICAgfQp9CgoKYm9vbApZRGlhbG9nOjpkZXN0cm95KCBib29sIGRvVGhyb3cg
KQp7CiAgICBkbyB7IGlmICggISAodGhpcykgfHwgISAodGhpcyktPmlzVmFsaWQoKSApIHsgX1lV
SV9USFJPVyggKCBZVUlJbnZhbGlkV2lkZ2V0RXhjZXB0aW9uKCkgKSwgWUNvZGVMb2NhdGlvbigi
L2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lEaWFs
b2cuY2MiLF9fRlVOQ1RJT05fXywyNTQpICk7IH0gfSB3aGlsZSggMCApOwoKICAgIGlmICggaXNU
b3Btb3N0RGlhbG9nKCkgKQogICAgewogZGVsZXRlIHRoaXM7CgogcmV0dXJuIHRydWU7CiAgICB9
CiAgICBlbHNlCiAgICB7CiBpZiAoIGRvVGhyb3cgKQogICAgIF9ZVUlfVEhST1coICggWVVJRGlh
bG9nU3RhY2tpbmdPcmRlckV4Y2VwdGlvbigpICksIFlDb2RlTG9jYXRpb24oIi9ob21lL3NoYXJr
Y3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIixfX0ZV
TkNUSU9OX18sMjY1KSApOwoKIHJldHVybiBmYWxzZTsKICAgIH0KfQoKCllEaWFsb2dUeXBlCllE
aWFsb2c6OmRpYWxvZ1R5cGUoKSBjb25zdAp7CiAgICByZXR1cm4gcHJpdi0+ZGlhbG9nVHlwZTsK
fQoKCmJvb2wKWURpYWxvZzo6aXNNYWluRGlhbG9nKCkKewogICAgc3dpdGNoICggcHJpdi0+ZGlh
bG9nVHlwZSApCiAgICB7CiBjYXNlIFlNYWluRGlhbG9nOiByZXR1cm4gdHJ1ZTsKIGNhc2UgWVdp
emFyZERpYWxvZzogcmV0dXJuIHRydWU7CiBjYXNlIFlQb3B1cERpYWxvZzogcmV0dXJuIGZhbHNl
OwoKCgogICAgfQoKCiAgICByZXR1cm4gZmFsc2U7Cn0KCgpZRGlhbG9nQ29sb3JNb2RlCllEaWFs
b2c6OmNvbG9yTW9kZSgpIGNvbnN0CnsKICAgIHJldHVybiBwcml2LT5jb2xvck1vZGU7Cn0KCgp2
b2lkCllEaWFsb2c6OnBvc3Rwb25lU2hvcnRjdXRDaGVjaygpCnsKICAgIHByaXYtPnNob3J0Y3V0
Q2hlY2tQb3N0cG9uZWQgPSB0cnVlOwp9CgoKYm9vbApZRGlhbG9nOjpzaG9ydGN1dENoZWNrUG9z
dHBvbmVkKCkgY29uc3QKewogICAgcmV0dXJuIHByaXYtPnNob3J0Y3V0Q2hlY2tQb3N0cG9uZWQ7
Cn0KCgp2b2lkCllEaWFsb2c6OmNoZWNrU2hvcnRjdXRzKCBib29sIGZvcmNlICkKewogICAgaWYg
KCBwcml2LT5zaG9ydGN1dENoZWNrUG9zdHBvbmVkICYmICEgZm9yY2UgKQogICAgewogWVVJTG9n
OjpkZWJ1ZyAoICJ1aSIsICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rl
ci0zLjIuMS9zcmMvWURpYWxvZy5jYyIsIDMyMywgX19GVU5DVElPTl9fICkgPDwgIlNob3J0Y3V0
IGNoZWNrIHBvc3Rwb25lZCIgPDwgc3RkOjplbmRsOwogICAgfQogICAgZWxzZQogICAgewoKIFlT
aG9ydGN1dE1hbmFnZXIgc2hvcnRjdXRNYW5hZ2VyKCB0aGlzICk7CiBzaG9ydGN1dE1hbmFnZXIu
Y2hlY2tTaG9ydGN1dHMoKTsKCiBwcml2LT5zaG9ydGN1dENoZWNrUG9zdHBvbmVkID0gZmFsc2U7
CiAgICB9Cn0KCgpZUHVzaEJ1dHRvbiAqCllEaWFsb2c6OmRlZmF1bHRCdXR0b24oKSBjb25zdAp7
CiAgICByZXR1cm4gcHJpdi0+ZGVmYXVsdEJ1dHRvbjsKfQoKCnZvaWQKWURpYWxvZzo6c2V0RGVm
YXVsdEJ1dHRvbiggWVB1c2hCdXR0b24gKiBuZXdEZWZhdWx0QnV0dG9uICkKewogICAgaWYgKCBu
ZXdEZWZhdWx0QnV0dG9uICYmIHByaXYtPmRlZmF1bHRCdXR0b24gKQogICAgewogWVVJTG9nOjpl
cnJvciAoICJ1aSIsICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0z
LjIuMS9zcmMvWURpYWxvZy5jYyIsIDM0OCwgX19GVU5DVElPTl9fICkgPDwgIlRvbyBtYW55IGBv
cHQoYGRlZmF1bHQpIFB1c2hCdXR0b25zOiBbIgogICAgIDw8IG5ld0RlZmF1bHRCdXR0b24tPmxh
YmVsKCkKICAgICA8PCAiXSIgPDwgc3RkOjplbmRsOwogICAgfQoKICAgIHByaXYtPmRlZmF1bHRC
dXR0b24gPSBuZXdEZWZhdWx0QnV0dG9uOwp9CgoKdm9pZApZRGlhbG9nOjpzZXRJbml0aWFsU2l6
ZSgpCnsKCgoKCgogICAgc2V0U2l6ZSggcHJlZmVycmVkV2lkdGgoKSwgcHJlZmVycmVkSGVpZ2h0
KCkgKTsKfQoKCnZvaWQKWURpYWxvZzo6cmVjYWxjTGF5b3V0KCkKewogICAgWVVJTG9nOjpkZWJ1
ZyAoICJ1aSIsICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIu
MS9zcmMvWURpYWxvZy5jYyIsIDM3MiwgX19GVU5DVElPTl9fICkgPDwgIlJlY2FsY3VsYXRpbmcg
bGF5b3V0IGZvciAiIDw8IHRoaXMgPDwgc3RkOjplbmRsOwoKICAgIHNldFNpemUoIHByZWZlcnJl
ZFdpZHRoKCksIHByZWZlcnJlZEhlaWdodCgpICk7Cn0KCgpZRXZlbnQgKgpZRGlhbG9nOjp3YWl0
Rm9yRXZlbnQoIGludCB0aW1lb3V0X21pbGxpc2VjICkKewogICAgaWYgKCAhIGlzVG9wbW9zdERp
YWxvZygpICkKIF9ZVUlfVEhST1coICggWVVJRGlhbG9nU3RhY2tpbmdPcmRlckV4Y2VwdGlvbigp
ICksIFlDb2RlTG9jYXRpb24oIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFz
dGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIixfX0ZVTkNUSU9OX18sMzgyKSApOwoKICAgIGlmICgg
dGltZW91dF9taWxsaXNlYyA8IDAgKQogdGltZW91dF9taWxsaXNlYyA9IDA7CgogICAgaWYgKCAh
IGlzT3BlbigpICkKIG9wZW4oKTsKCiAgICBpZiAoIHNob3J0Y3V0Q2hlY2tQb3N0cG9uZWQoKSAp
CiAgICB7CiBZVUlMb2c6OmVycm9yICggInVpIiwgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1
aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIiwgMzkyLCBfX0ZVTkNUSU9OX18g
KSA8PCAiUGVyZm9ybWluZyBtaXNzaW5nIGtleWJvYXJkIHNob3J0Y3V0IGNoZWNrIG5vdyBpbiAi
CiAgICAgPDwgdGhpcyA8PCBzdGQ6OmVuZGw7CgogY2hlY2tTaG9ydGN1dHMoIHRydWUgKTsKICAg
IH0KCiAgICBkZWxldGVFdmVudCggcHJpdi0+bGFzdEV2ZW50ICk7CiAgICBZRXZlbnQgKiBldmVu
dCA9IDA7CgogICAgZG8KICAgIHsKIGV2ZW50ID0gZmlsdGVySW52YWxpZEV2ZW50cyggd2FpdEZv
ckV2ZW50SW50ZXJuYWwoIHRpbWVvdXRfbWlsbGlzZWMgKSApOwogZXZlbnQgPSBjYWxsRXZlbnRG
aWx0ZXJzKCBldmVudCApOwoKCgoKCiAgICB9IHdoaWxlICggISBldmVudCApOwoKICAgIHByaXYt
Pmxhc3RFdmVudCA9IGV2ZW50OwoKICAgIHJldHVybiBldmVudDsKfQoKCllFdmVudCAqCllEaWFs
b2c6OnBvbGxFdmVudCgpCnsKICAgIGlmICggISBpc1RvcG1vc3REaWFsb2coKSApCiBfWVVJX1RI
Uk9XKCAoIFlVSURpYWxvZ1N0YWNraW5nT3JkZXJFeGNlcHRpb24oKSApLCBZQ29kZUxvY2F0aW9u
KCIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURp
YWxvZy5jYyIsX19GVU5DVElPTl9fLDQyMikgKTsKCiAgICBpZiAoICEgaXNPcGVuKCkgKQogb3Bl
bigpOwoKICAgIFlFdmVudCAqIGV2ZW50ID0gZmlsdGVySW52YWxpZEV2ZW50cyggcG9sbEV2ZW50
SW50ZXJuYWwoKSApOwoKICAgIGlmICggZXZlbnQgKQogZXZlbnQgPSBjYWxsRXZlbnRGaWx0ZXJz
KCBldmVudCApOwoKICAgIHByaXYtPmxhc3RFdmVudCA9IGV2ZW50OwoKCgoKCgogICAgcmV0dXJu
IGV2ZW50Owp9CgoKWUV2ZW50ICoKWURpYWxvZzo6ZmlsdGVySW52YWxpZEV2ZW50cyggWUV2ZW50
ICogZXZlbnQgKQp7CiAgICBpZiAoICEgZXZlbnQgKQogcmV0dXJuIDA7CgogICAgWVdpZGdldEV2
ZW50ICogd2lkZ2V0RXZlbnQgPSBkeW5hbWljX2Nhc3Q8WVdpZGdldEV2ZW50ICo+IChldmVudCk7
CgogICAgaWYgKCB3aWRnZXRFdmVudCAmJiB3aWRnZXRFdmVudC0+d2lkZ2V0KCkgKQogICAgewog
aWYgKCAhIHdpZGdldEV2ZW50LT53aWRnZXQoKS0+aXNWYWxpZCgpICkKIHsKIyA0NjUgIi9ob21l
L3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNj
IgogICAgIGRlbGV0ZUV2ZW50KCB3aWRnZXRFdmVudCApOwogICAgIHJldHVybiAwOwogfQoKIGlm
ICggd2lkZ2V0RXZlbnQtPndpZGdldCgpLT5maW5kRGlhbG9nKCkgIT0gdGhpcyApCiB7CiMgNDgx
ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURp
YWxvZy5jYyIKICAgICBZVUlMb2c6OmRlYnVnICggInVpIiwgIi9ob21lL3NoYXJrY3ovbGlieXVp
L2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIiwgNDgxLCBfX0ZVTkNU
SU9OX18gKSA8PCAiRGlzY2FyZGluZyBldmVudCBmcm9tIHdpZGdldCBmcm9tIGZvcmVpZ24gZGlh
bG9nIiA8PCBzdGQ6OmVuZGw7CiMgNDk1ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGli
eXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5jYyIKICAgICBhY3RpdmF0ZSgpOwoKICAgICBk
ZWxldGVFdmVudCggd2lkZ2V0RXZlbnQgKTsKICAgICByZXR1cm4gMDsKIH0KCiAgICB9CgogICAg
cmV0dXJuIGV2ZW50Owp9CgoKdm9pZApZRGlhbG9nOjpkZWxldGVFdmVudCggWUV2ZW50ICogZXZl
bnQgKQp7CiAgICBpZiAoIGV2ZW50ID09IHByaXYtPmxhc3RFdmVudCApCiBwcml2LT5sYXN0RXZl
bnQgPSAwOwoKICAgIGlmICggZXZlbnQgKQogICAgewogaWYgKCBldmVudC0+aXNWYWxpZCgpICkK
IHsKCgoKICAgICBkZWxldGUgZXZlbnQ7CiB9CiBlbHNlCiB7CiAgICAgWVVJTG9nOjplcnJvciAo
ICJ1aSIsICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9z
cmMvWURpYWxvZy5jYyIsIDUyNCwgX19GVU5DVElPTl9fICkgPDwgIkF0dGVtcHQgdG8gZGVsZXRl
IGludmFsaWQgZXZlbnQgIiA8PCBldmVudCA8PCBzdGQ6OmVuZGw7CiB9CiAgICB9Cn0KCgpZRGlh
bG9nICoKWURpYWxvZzo6Y3VycmVudERpYWxvZyggYm9vbCBkb1Rocm93ICkKewogICAgaWYgKCBf
ZGlhbG9nU3RhY2suZW1wdHkoKSApCiAgICB7CiBpZiAoIGRvVGhyb3cgKQogICAgIF9ZVUlfVEhS
T1coICggWVVJTm9EaWFsb2dFeGNlcHRpb24oKSApLCBZQ29kZUxvY2F0aW9uKCIvaG9tZS9zaGFy
a2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5jYyIsX19G
VU5DVElPTl9fLDUzNikgKTsKIHJldHVybiAwOwogICAgfQogICAgZWxzZQogcmV0dXJuIF9kaWFs
b2dTdGFjay50b3AoKTsKfQoKCmJvb2wKWURpYWxvZzo6ZGVsZXRlVG9wbW9zdERpYWxvZyggYm9v
bCBkb1Rocm93ICkKewogICAgaWYgKCBfZGlhbG9nU3RhY2suZW1wdHkoKSApCiAgICB7CiBpZiAo
IGRvVGhyb3cgKQogICAgIF9ZVUlfVEhST1coICggWVVJTm9EaWFsb2dFeGNlcHRpb24oKSApLCBZ
Q29kZUxvY2F0aW9uKCIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0z
LjIuMS9zcmMvWURpYWxvZy5jYyIsX19GVU5DVElPTl9fLDU1MCkgKTsKICAgIH0KICAgIGVsc2UK
ICAgIHsKIGRlbGV0ZSBfZGlhbG9nU3RhY2sudG9wKCk7CiAgICB9CgogICAgcmV0dXJuICEgX2Rp
YWxvZ1N0YWNrLmVtcHR5KCk7Cn0KCgp2b2lkCllEaWFsb2c6OmRlbGV0ZUFsbERpYWxvZ3MoKQp7
CiAgICB3aGlsZSAoICEgX2RpYWxvZ1N0YWNrLmVtcHR5KCkgKQogICAgewogZGVsZXRlIF9kaWFs
b2dTdGFjay50b3AoKTsKICAgIH0KfQoKCnZvaWQKWURpYWxvZzo6ZGVsZXRlVG8oIFlEaWFsb2cg
KiB0YXJnZXREaWFsb2cgKQp7CiAgICBkbyB7IGlmICggISAodGFyZ2V0RGlhbG9nKSB8fCAhICh0
YXJnZXREaWFsb2cpLT5pc1ZhbGlkKCkgKSB7IF9ZVUlfVEhST1coICggWVVJSW52YWxpZFdpZGdl
dEV4Y2VwdGlvbigpICksIFlDb2RlTG9jYXRpb24oIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1
aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIixfX0ZVTkNUSU9OX18sNTc0KSAp
OyB9IH0gd2hpbGUoIDAgKTsKCiAgICB3aGlsZSAoICEgX2RpYWxvZ1N0YWNrLmVtcHR5KCkgKQog
ICAgewogWURpYWxvZyAqIGRpYWxvZyA9IF9kaWFsb2dTdGFjay50b3AoKTsKCiBkZWxldGUgZGlh
bG9nOwoKIGlmICggZGlhbG9nID09IHRhcmdldERpYWxvZyApCiAgICAgcmV0dXJuOwogICAgfQoK
CgogICAgX1lVSV9USFJPVyggKCBZVUlEaWFsb2dTdGFja2luZ09yZGVyRXhjZXB0aW9uKCkgKSwg
WUNvZGVMb2NhdGlvbigiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXIt
My4yLjEvc3JjL1lEaWFsb2cuY2MiLF9fRlVOQ1RJT05fXyw1ODgpICk7Cn0KCgppbnQKWURpYWxv
Zzo6b3BlbkRpYWxvZ3NDb3VudCgpCnsKICAgIHJldHVybiBfZGlhbG9nU3RhY2suc2l6ZSgpOwp9
CgoKdm9pZApZRGlhbG9nOjphZGRFdmVudEZpbHRlciggWUV2ZW50RmlsdGVyICogZXZlbnRGaWx0
ZXIgKQp7CiAgICBkbyB7IGlmICggISAoZXZlbnRGaWx0ZXIpICkgeyBfWVVJX1RIUk9XKCAoIFlV
SU51bGxQb2ludGVyRXhjZXB0aW9uKCkgKSwgWUNvZGVMb2NhdGlvbigiL2hvbWUvc2hhcmtjei9s
aWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lEaWFsb2cuY2MiLF9fRlVOQ1RJ
T05fXyw2MDIpICk7IH0gfSB3aGlsZSggMCApOwoKICAgIGlmICggZmluZCggcHJpdi0+ZXZlbnRG
aWx0ZXJMaXN0LmJlZ2luKCksIHByaXYtPmV2ZW50RmlsdGVyTGlzdC5lbmQoKSwKICAgICAgICBl
dmVudEZpbHRlciApICE9IHByaXYtPmV2ZW50RmlsdGVyTGlzdC5lbmQoKSApCiAgICB7CiBZVUlM
b2c6OmVycm9yICggInVpIiwgIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFz
dGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIiwgNjA3LCBfX0ZVTkNUSU9OX18gKSA8PCAiZXZlbnQg
ZmlsdGVyICIgPDwgc3RkOjpoZXggPDwgZXZlbnRGaWx0ZXIgPDwgc3RkOjpkZWMKICAgICA8PCAi
IGFscmVhZHkgYWRkZWQgdG8gIiA8PCB0aGlzCiAgICAgPDwgc3RkOjplbmRsOwogICAgfQogICAg
ZWxzZQogICAgewoKCgogcHJpdi0+ZXZlbnRGaWx0ZXJMaXN0LnB1c2hfYmFjayggZXZlbnRGaWx0
ZXIgKTsKICAgIH0KfQoKCnZvaWQKWURpYWxvZzo6cmVtb3ZlRXZlbnRGaWx0ZXIoIFlFdmVudEZp
bHRlciAqIGV2ZW50RmlsdGVyICkKewogICAgZG8geyBpZiAoICEgKGV2ZW50RmlsdGVyKSApIHsg
X1lVSV9USFJPVyggKCBZVUlOdWxsUG9pbnRlckV4Y2VwdGlvbigpICksIFlDb2RlTG9jYXRpb24o
Ii9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlh
bG9nLmNjIixfX0ZVTkNUSU9OX18sNjI0KSApOyB9IH0gd2hpbGUoIDAgKTsKCgoKCiAgICBwcml2
LT5ldmVudEZpbHRlckxpc3QucmVtb3ZlKCBldmVudEZpbHRlciApOwp9CgoKWUV2ZW50ICoKWURp
YWxvZzo6Y2FsbEV2ZW50RmlsdGVycyggWUV2ZW50ICogZXZlbnQgKQp7CiAgICBZRXZlbnRGaWx0
ZXJMaXN0Ojpjb25zdF9pdGVyYXRvciBpdCA9IHByaXYtPmV2ZW50RmlsdGVyTGlzdC5iZWdpbigp
OwoKICAgIHdoaWxlICggaXQgIT0gcHJpdi0+ZXZlbnRGaWx0ZXJMaXN0LmVuZCgpICYmIGV2ZW50
ICkKICAgIHsKIFlFdmVudCAqIG9sZEV2ZW50ID0gZXZlbnQ7CiBldmVudCA9ICgqaXQpLT5maWx0
ZXIoIGV2ZW50ICk7CgogaWYgKCBvbGRFdmVudCAhPSBldmVudCApCiAgICAgZGVsZXRlRXZlbnQo
IG9sZEV2ZW50ICk7CgogKytpdDsKICAgIH0KCiAgICByZXR1cm4gZXZlbnQ7Cn0KCgp2b2lkCllE
aWFsb2c6OnNob3dUZXh0KCBjb25zdCBzdGQ6OnN0cmluZyAmIHRleHQsIGJvb2wgdXNlUmljaFRl
eHQgKQp7CgoKCiAgICB1bnNpZ25lZCBpbnQgZGlhbG9nV2lkdGggPSA0NTsKICAgIHVuc2lnbmVk
IGludCBkaWFsb2dIZWlnaHQgPSAxNTsKCiAgICBpZiAoICEgX2RpYWxvZ1N0YWNrLmVtcHR5KCkg
KQogICAgewogWURpYWxvZyAqIGRpYWxvZyA9IF9kaWFsb2dTdGFjay50b3AoKTsKICAgICAgICBk
aWFsb2dXaWR0aCA9ICh1bnNpZ25lZCBpbnQpICggKGZsb2F0KSBkaWFsb2ctPnByZWZlcnJlZFdp
ZHRoKCkgKiAwLjggKTsKICAgICAgICBkaWFsb2dIZWlnaHQgPSAodW5zaWduZWQgaW50KSAoIChm
bG9hdCkgZGlhbG9nLT5wcmVmZXJyZWRIZWlnaHQoKSAqIDAuOCApOwogICAgfQoKCiAgICBpZiAo
IGRpYWxvZ1dpZHRoID4gODAgfHwgZGlhbG9nSGVpZ2h0ID4gMjUgKQogICAgewogZGlhbG9nV2lk
dGggPSA4MDsKIGRpYWxvZ0hlaWdodCA9IDI1OwogICAgfQoKICAgIHRyeQogICAgewogWURpYWxv
ZyAqIGRpYWxvZyA9IFlVSTo6d2lkZ2V0RmFjdG9yeSgpLT5jcmVhdGVQb3B1cERpYWxvZygpOwog
WUFsaWdubWVudCAqIG1pblNpemUgPSBZVUk6OndpZGdldEZhY3RvcnkoKS0+Y3JlYXRlTWluU2l6
ZSggZGlhbG9nLCBkaWFsb2dXaWR0aCwgZGlhbG9nSGVpZ2h0ICk7CiBZTGF5b3V0Qm94ICogdmJv
eCA9IFlVSTo6d2lkZ2V0RmFjdG9yeSgpLT5jcmVhdGVWQm94KCBtaW5TaXplICk7CiBZVUk6Ondp
ZGdldEZhY3RvcnkoKS0+Y3JlYXRlUmljaFRleHQoIHZib3gsIHRleHQsICEgdXNlUmljaFRleHQg
KTsKIFlCdXR0b25Cb3ggKiBidXR0b25Cb3ggPSBZVUk6OndpZGdldEZhY3RvcnkoKS0+Y3JlYXRl
QnV0dG9uQm94KCB2Ym94ICk7CiBZUHVzaEJ1dHRvbiAqIG9rQnV0dG9uID0gWVVJOjp3aWRnZXRG
YWN0b3J5KCktPmNyZWF0ZVB1c2hCdXR0b24oIGJ1dHRvbkJveCwgIiZPSyIgKTsKIG9rQnV0dG9u
LT5zZXRSb2xlKCBZT0tCdXR0b24gKTsKIG9rQnV0dG9uLT5zZXREZWZhdWx0QnV0dG9uKCk7Cgog
ZGlhbG9nLT53YWl0Rm9yRXZlbnQoKTsKIGRpYWxvZy0+ZGVzdHJveSgpOwogICAgfQogICAgY2F0
Y2ggKCBZVUlFeGNlcHRpb24gZXhjZXB0aW9uICkKICAgIHsKCgogX1lVSV9DQVVHSFQoICggZXhj
ZXB0aW9uICksIFlDb2RlTG9jYXRpb24oIi9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5
dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlhbG9nLmNjIixfX0ZVTkNUSU9OX18sNjk0KSApOwogICAg
fQp9CgoKYm9vbApZRGlhbG9nOjpzaG93SGVscFRleHQoIFlXaWRnZXQgKiB3aWRnZXQgKQp7CiAg
ICBzdGQ6OnN0cmluZyBoZWxwVGV4dDsKCiAgICB3aGlsZSAoIHdpZGdldCApCiAgICB7CiBpZiAo
ICEgd2lkZ2V0LT5oZWxwVGV4dCgpLmVtcHR5KCkgKQogewogICAgIFlVSUxvZzo6ZGVidWcgKCAi
dWkiLCAiL2hvbWUvc2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3Jj
L1lEaWFsb2cuY2MiLCA3MDgsIF9fRlVOQ1RJT05fXyApIDw8ICJGb3VuZCBoZWxwIHRleHQgZm9y
ICIgPDwgd2lkZ2V0IDw8IHN0ZDo6ZW5kbDsKICAgICBoZWxwVGV4dCA9IHdpZGdldC0+aGVscFRl
eHQoKTsKIH0KCiB3aWRnZXQgPSB3aWRnZXQtPnBhcmVudCgpOwogICAgfQoKICAgIGlmICggISBo
ZWxwVGV4dC5lbXB0eSgpICkKICAgIHsKIFlVSUxvZzo6bWlsZXN0b25lKCAidWkiLCAiL2hvbWUv
c2hhcmtjei9saWJ5dWkvbGlieXVpLWxpYnl1aS1tYXN0ZXItMy4yLjEvc3JjL1lEaWFsb2cuY2Mi
LCA3MTcsIF9fRlVOQ1RJT05fXyApIDw8ICJTaG93aW5nIGhlbHAgdGV4dCIgPDwgc3RkOjplbmRs
Owogc2hvd1RleHQoIGhlbHBUZXh0LCB0cnVlICk7CgogWVVJTG9nOjptaWxlc3RvbmUoICJ1aSIs
ICIvaG9tZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURp
YWxvZy5jYyIsIDcyMCwgX19GVU5DVElPTl9fICkgPDwgIkhlbHAgZGlhbG9nIGNsb3NlZCIgPDwg
c3RkOjplbmRsOwogICAgfQogICAgZWxzZQogICAgewogWVVJTG9nOjp3YXJuaW5nICggInVpIiwg
Ii9ob21lL3NoYXJrY3ovbGlieXVpL2xpYnl1aS1saWJ5dWktbWFzdGVyLTMuMi4xL3NyYy9ZRGlh
bG9nLmNjIiwgNzI0LCBfX0ZVTkNUSU9OX18gKSA8PCAiTm8gaGVscCB0ZXh0IiA8PCBzdGQ6OmVu
ZGw7CiAgICB9CgogICAgcmV0dXJuICEgaGVscFRleHQuZW1wdHkoKTsKfQoKYm9vbApZRGlhbG9n
OjpzaG93UmVsTm90ZXNUZXh0KCkKewogICAgWVVJTG9nOjptaWxlc3RvbmUoICJ1aSIsICIvaG9t
ZS9zaGFya2N6L2xpYnl1aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5j
YyIsIDczMywgX19GVU5DVElPTl9fICkgPDwiU2hvd2luZyBSZWxlYXNlIE5vdGVzIiA8PCBzdGQ6
OmVuZGw7CgoKCiAgICB1bnNpZ25lZCBpbnQgZGlhbG9nV2lkdGggPSA0NTsKICAgIHVuc2lnbmVk
IGludCBkaWFsb2dIZWlnaHQgPSAxNTsKCiAgICBpZiAoICEgX2RpYWxvZ1N0YWNrLmVtcHR5KCkg
KQogICAgewogICAgICAgIFlEaWFsb2cgKiBkaWFsb2cgPSBfZGlhbG9nU3RhY2sudG9wKCk7CiAg
ICAgICAgZGlhbG9nV2lkdGggPSAodW5zaWduZWQgaW50KSAoIChmbG9hdCkgZGlhbG9nLT5wcmVm
ZXJyZWRXaWR0aCgpICogMC44ICk7CiAgICAgICAgZGlhbG9nSGVpZ2h0ID0gKHVuc2lnbmVkIGlu
dCkgKCAoZmxvYXQpIGRpYWxvZy0+cHJlZmVycmVkSGVpZ2h0KCkgKiAwLjggKTsKICAgIH0KCgog
ICAgaWYgKCBkaWFsb2dXaWR0aCA+IDgwIHx8IGRpYWxvZ0hlaWdodCA+IDI1ICkKICAgIHsKICAg
ICAgICBkaWFsb2dXaWR0aCA9IDgwOwogICAgICAgIGRpYWxvZ0hlaWdodCA9IDI1OwogICAgfQoK
ICAgIHRyeQogICAgewogc3RkOjptYXA8c3RkOjpzdHJpbmcsc3RkOjpzdHJpbmc+IHJlbG5vdGVz
ID0gWVVJOjphcHBsaWNhdGlvbigpLT5yZWxlYXNlTm90ZXMoKTsKIGlmICggcmVsbm90ZXMuc2l6
ZSgpID09IDApCiB7CiAgICAgcmV0dXJuIGZhbHNlOwogfQogc3RkOjp2ZWN0b3I8c3RkOjpzdHJp
bmc+IGtleXM7CiBmb3Ioc3RkOjptYXA8c3RkOjpzdHJpbmcsc3RkOjpzdHJpbmc+OjppdGVyYXRv
ciBpdCA9IHJlbG5vdGVzLmJlZ2luKCk7IGl0ICE9IHJlbG5vdGVzLmVuZCgpOyArK2l0KSB7CiAg
ICAga2V5cy5wdXNoX2JhY2soaXQtPmZpcnN0KTsKIH0KICAgICAgICBZRGlhbG9nICogZGlhbG9n
ID0gWVVJOjp3aWRnZXRGYWN0b3J5KCktPmNyZWF0ZVBvcHVwRGlhbG9nKCk7CiAgICAgICAgWUFs
aWdubWVudCAqIG1pblNpemUgPSBZVUk6OndpZGdldEZhY3RvcnkoKS0+Y3JlYXRlTWluU2l6ZSgg
ZGlhbG9nLCBkaWFsb2dXaWR0aCwgZGlhbG9nSGVpZ2h0ICk7CiAgICAgICAgWUxheW91dEJveCAq
IHZib3ggPSBZVUk6OndpZGdldEZhY3RvcnkoKS0+Y3JlYXRlVkJveCggbWluU2l6ZSApOwogICAg
ICAgIFlEdW1iVGFiICogcm5UYWIgPSAwOwogICAgICAgIFlSaWNoVGV4dCAqIHJpY2h0ZXh0ID0g
MDsKCgogICAgICAgIGlmIChyZWxub3Rlcy5zaXplKCkgPiAxICYmIFlVSTo6b3B0aW9uYWxXaWRn
ZXRGYWN0b3J5KCktPmhhc0R1bWJUYWIoKSkKIHsKICAgICByblRhYiA9IFlVSTo6b3B0aW9uYWxX
aWRnZXRGYWN0b3J5KCktPmNyZWF0ZUR1bWJUYWIoIHZib3ggKTsKICAgICBpbnQgaW5kZXggPSAw
OwogICAgIGZvcihzdGQ6Om1hcDxzdGQ6OnN0cmluZyxzdGQ6OnN0cmluZz46OmNvbnN0X2l0ZXJh
dG9yIGl0ID0gcmVsbm90ZXMuYmVnaW4oKTsgaXQgIT0gcmVsbm90ZXMuZW5kKCk7IGl0KyspCiAg
ICAgewogIFlJdGVtICogaXRlbSA9IG5ldyBZSXRlbSgoKml0KS5maXJzdCApOwogIGl0ZW0tPnNl
dEluZGV4KCBpbmRleCsrICk7CiAgcm5UYWItPmFkZEl0ZW0oIGl0ZW0gKTsKICAgICB9CiAgICAg
cmljaHRleHQgPSBZVUk6OndpZGdldEZhY3RvcnkoKS0+Y3JlYXRlUmljaFRleHQoIHJuVGFiLCAo
KihyZWxub3Rlcy5iZWdpbigpKSkuc2Vjb25kLCBZVUk6OmFwcCgpLT5pc1RleHRNb2RlKCkgKTsK
IH0KIGVsc2UKIHsKICAgICByaWNodGV4dCA9IFlVSTo6d2lkZ2V0RmFjdG9yeSgpLT5jcmVhdGVS
aWNoVGV4dCggdmJveCwgKCoocmVsbm90ZXMuYmVnaW4oKSkpLnNlY29uZCwgWVVJOjphcHAoKS0+
aXNUZXh0TW9kZSgpICk7CiB9CiAgICAgICAgWUJ1dHRvbkJveCAqIGJ1dHRvbkJveCA9IFlVSTo6
d2lkZ2V0RmFjdG9yeSgpLT5jcmVhdGVCdXR0b25Cb3goIHZib3ggKTsKICAgICAgICBZUHVzaEJ1
dHRvbiAqIG9rQnV0dG9uID0gWVVJOjp3aWRnZXRGYWN0b3J5KCktPmNyZWF0ZVB1c2hCdXR0b24o
IGJ1dHRvbkJveCwgIiZPSyIgKTsKICAgICAgICBva0J1dHRvbi0+c2V0Um9sZSggWU9LQnV0dG9u
ICk7CiAgICAgICAgb2tCdXR0b24tPnNldERlZmF1bHRCdXR0b24oKTsKCiB3aGlsZSh0cnVlKSB7
CiAgICAgWUV2ZW50KiBldmVudCA9IGRpYWxvZy0+d2FpdEZvckV2ZW50KCk7CiAgICAgaWYgKCBl
dmVudCAmJiBldmVudC0+ZXZlbnRUeXBlKCkgPT0gWUV2ZW50OjpNZW51RXZlbnQgJiYgZXZlbnQt
Pml0ZW0oKSkKICAgICB7CiAgWUl0ZW0gKiBpdGVtID0gZHluYW1pY19jYXN0PFlJdGVtICo+ICgg
ZXZlbnQtPml0ZW0oKSk7CiAgcmljaHRleHQtPnNldFZhbHVlKCByZWxub3Rlc1trZXlzW2l0ZW0t
PmluZGV4KCldXSApOwogICAgIH0KICAgICBlbHNlIGlmICggZXZlbnQgJiYgZXZlbnQtPndpZGdl
dCgpICkKICAgICB7CiAgWVB1c2hCdXR0b24gKiBidXR0b24gPSBkeW5hbWljX2Nhc3Q8WVB1c2hC
dXR0b24gKj4gKCBldmVudC0+d2lkZ2V0KCkgKTsKICBpZiAoIGJ1dHRvbiApCiAgewogICAgICBp
ZiAoIGJ1dHRvbi0+cm9sZSgpID09IFlPS0J1dHRvbikKICAgICAgewogICBicmVhazsKICAgICAg
fQogIH0KICAgICAgICAgICAgfQogfQogICAgICAgIGRpYWxvZy0+ZGVzdHJveSgpOwogICAgfQog
ICAgY2F0Y2ggKCBZVUlFeGNlcHRpb24gZXhjZXB0aW9uICkKICAgIHsKCgogICAgICAgIF9ZVUlf
Q0FVR0hUKCAoIGV4Y2VwdGlvbiApLCBZQ29kZUxvY2F0aW9uKCIvaG9tZS9zaGFya2N6L2xpYnl1
aS9saWJ5dWktbGlieXVpLW1hc3Rlci0zLjIuMS9zcmMvWURpYWxvZy5jYyIsX19GVU5DVElPTl9f
LDgxOCkgKTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKCn0K
</data>

          </attachment>
      

    </bug>

</bugzilla>