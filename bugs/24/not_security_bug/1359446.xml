<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1" urlbase="https://bugzilla.redhat.com/" maintainer="bugzilla-error-list@redhat.com">

  <bug>
    <bug_id>1359446</bug_id>

    <creation_ts>2016-07-23 20:44:00 -0400</creation_ts>
    <short_desc>SELinux is preventing (coredump) from mounton access on the directory /etc</short_desc>
    <delta_ts>2016-08-12 18:24:13 -0400</delta_ts>
    <reporter_accessible>1</reporter_accessible>
    <cclist_accessible>1</cclist_accessible>
    <classification_id>2</classification_id>
    <classification>Fedora</classification>
    <product>Fedora</product>
    <component>selinux-policy</component>
    <version>24</version>
    <rep_platform>Unspecified</rep_platform>
    <op_sys>Unspecified</op_sys>
    <bug_status>CLOSED</bug_status>
    <resolution>ERRATA</resolution>

    <bug_file_loc></bug_file_loc>
    <status_whiteboard></status_whiteboard>
    <keywords></keywords>
    <priority>unspecified</priority>
    <bug_severity>unspecified</bug_severity>
    <target_milestone>---</target_milestone>

    <everconfirmed>1</everconfirmed>
    <reporter name="Chris Murphy">bugzilla</reporter>
    <assigned_to name="Lukas Vrabec">lvrabec</assigned_to>
    <cc>dominick.grift</cc>

    <cc>dwalsh</cc>

    <cc>lvrabec</cc>

    <cc>mgrepl</cc>

    <cc>notadrop</cc>

    <cc>plautrba</cc>

    <cc>schlaffi</cc>
    <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>

    <cf_fixed_in>selinux-policy-3.13.1-191.9.fc24 selinux-policy-3.13.1-191.10.fc24</cf_fixed_in>
  <cf_doc_type>If docs needed, set a value</cf_doc_type>
<cf_release_notes></cf_release_notes>
<cf_story_points>---</cf_story_points>

<cf_environment></cf_environment>
<cf_last_closed>2016-08-12 15:29:24</cf_last_closed>
<cf_type>Bug</cf_type>
<cf_regression_status>---</cf_regression_status>
<cf_mount_type>---</cf_mount_type>
<cf_documentation_action>---</cf_documentation_action>
<cf_crm></cf_crm>
<cf_verified_branch></cf_verified_branch>
<cf_category>---</cf_category>
<cf_ovirt_team>---</cf_ovirt_team>

<cf_cloudforms_team>---</cf_cloudforms_team>

<target_release>---</target_release>

<votes>0</votes>

<comment_sort_order>oldest_to_newest</comment_sort_order>
<long_desc isprivate="0">
<commentid>9543548</commentid>
<comment_count>0</comment_count>
<who name="Chris Murphy">bugzilla</who>
<bug_when>2016-07-23 20:44:11 -0400</bug_when>
<thetext>Description of problem: I see this message in the journal, and once today I saw a notification for it in GNOME which lastest only very briefly even though I didn&apos;t dismiss the message. Version-Release number of selected component (if
applicable): selinux-policy-3.13.1-191.5.fc24.noarch How reproducible: Frequently, I have several of these from the past couple days, but I&apos;m not exactly sure what&apos;s triggering it. Steps to Reproduce: 1. Unknown Actual results: type=AVC
msg=audit(1469306689.434:87): avc: denied { mounton } for pid=785 comm=&quot;(uetoothd)&quot; path=&quot;/etc&quot; dev=&quot;sda5&quot; ino=267 scontext=system_u:system_r:init_t:s0 tcontext=system_u:object_r:etc_t:s0 tclass=dir permissive=0 Expected
results: Either no denial, or Additional info: Could be related to bug 1341753. comm=uetoothd in the AVC but sealert as well as the journal information on this event says the source is coredump.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9543553</commentid>
<comment_count>1</comment_count>
<attachid>1183239</attachid>
<who name="Chris Murphy">bugzilla</who>
<bug_when>2016-07-23 20:44:45 -0400</bug_when>
<thetext>Created attachment 1183239 sealert output</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9543585</commentid>
<comment_count>2</comment_count>
<who name="Chris Murphy">bugzilla</who>
<bug_when>2016-07-23 20:54:03 -0400</bug_when>
<thetext>OK so it looks like there&apos;s a bluetooth issue: Jul 23 14:44:49 f24m bluetoothd[785]: Failed to obtain handles for &quot;Service Changed&quot; characteristic And abrt wants to capture some info about it, and wants to create some
directory, which then results in the AVC. Jul 23 14:44:52 f24m abrt-dump-journal-oops[882]: abrt-dump-journal-oops: Found oopses: 1 Jul 23 14:44:52 f24m abrt-dump-journal-oops[882]: abrt-dump-journal-oops: Creating problem directories Jul 23 14:44:52
f24m setroubleshoot[908]: SELinux is preventing (coredump) from mounton access on the directory /etc. For complete SELinux messages. run sealert -l 3fe792d7-2dc0-4379-9386-00ff207e4291</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9543850</commentid>
<comment_count>3</comment_count>
<who name="">notadrop</who>
<bug_when>2016-07-24 02:55:15 -0400</bug_when>
<thetext>Ever since I installed the package &quot;powetop&quot; I have begun to see this notification from the SELinux Troubleshooter on every boot. Perhaps this is related? See below: SELinux is preventing (uetoothd) from mounton access on the
directory /etc. ***** Plugin catchall_labels (83.8 confidence) suggests ******************* If you want to allow (uetoothd) to have mounton access on the etc directory Then you need to change the label on /etc Do # semanage fcontext -a -t FILE_TYPE
&apos;/etc&apos; where FILE_TYPE is one of the following: admin_home_t, anon_inodefs_t, audit_spool_t, auditd_log_t, autofs_t, automount_tmp_t, bacula_store_t, binfmt_misc_fs_t, boot_t, capifs_t, cephfs_t, cgroup_t, cifs_t, container_image_t,
debugfs_t, default_t, device_t, devpts_t, dnssec_t, dosfs_t, ecryptfs_t, efivarfs_t, fusefs_t, home_root_t, hugetlbfs_t, ifconfig_var_run_t, init_var_run_t, initrc_tmp_t, iso9660_t, kdbusfs_t, mail_spool_t, mnt_t, mqueue_spool_t, named_conf_t,
news_spool_t, nfs_t, nfsd_fs_t, onload_fs_t, openshift_tmp_t, openshift_var_lib_t, oracleasmfs_t, proc_t, proc_xen_t, pstore_t, public_content_rw_t, public_content_t, ramfs_t, random_seed_t, removable_t, root_t, rpc_pipefs_t, security_t, spufs_t,
src_t, svirt_sandbox_file_t, sysctl_fs_t, sysctl_t, sysfs_t, sysv_t, tmp_t, tmpfs_t, usbfs_t, user_home_dir_t, user_home_t, user_tmp_t, usr_t, var_lib_nfs_t, var_lib_t, var_lock_t, var_log_t, var_run_t, var_t, virt_image_t, virt_var_lib_t, vmblock_t,
vxfs_t, xend_var_lib_t, xend_var_run_t, xenfs_t, xenstored_var_lib_t. Then execute: restorecon -v &apos;/etc&apos; ***** Plugin catchall (17.1 confidence) suggests ************************** If you believe that (uetoothd) should be allowed mounton
access on the etc directory by default. Then you should report this as a bug. You can generate a local policy module to allow this access. Do allow this access for now by executing: # ausearch -c &apos;(uetoothd)&apos; --raw | audit2allow -M
my-uetoothd # semodule -X 300 -i my-uetoothd.pp Additional Information: Source Context system_u:system_r:init_t:s0 Target Context system_u:object_r:etc_t:s0 Target Objects /etc [ dir ] Source (uetoothd) Source Path (uetoothd) Port &lt;Unknown&gt;
Host vishnu Source RPM Packages Target RPM Packages filesystem-3.2-37.fc24.x86_64 Policy RPM selinux-policy-3.13.1-191.5.fc24.noarch Selinux Enabled True Policy Type targeted Enforcing Mode Enforcing Host Name vishnu Platform Linux vishnu
4.6.4-301.fc24.x86_64 #1 SMP Tue Jul 12 11:50:00 UTC 2016 x86_64 x86_64 Alert Count 15 First Seen 2016-07-20 00:19:27 MDT Last Seen 2016-07-24 00:47:44 MDT Local ID b8381d75-0b93-4365-a11f-912f364c00cd Raw Audit Messages type=AVC
msg=audit(1469342864.699:208): avc: denied { mounton } for pid=1604 comm=&quot;(uetoothd)&quot; path=&quot;/etc&quot; dev=&quot;dm-0&quot; ino=1703937 scontext=system_u:system_r:init_t:s0 tcontext=system_u:object_r:etc_t:s0 tclass=dir permissive=0
Hash: (uetoothd),init_t,etc_t,dir,mounton</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9543851</commentid>
<comment_count>4</comment_count>
<who name="">notadrop</who>
<bug_when>2016-07-24 02:56:00 -0400</bug_when>
<thetext>Apologies for the typo. The above comment should specify a package named &quot;powertop&quot;</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9600450</commentid>
<comment_count>5</comment_count>
<who name="">schlaffi</who>
<bug_when>2016-08-09 16:12:34 -0400</bug_when>
<thetext>I see this too. Since I am (an unskilled) developer, this pops up everytime I manage to coredump. This is although I have set Storage=none in /etc/systemd/coredump.conf . (Btw, the idea that in the default configuration all my precious
passwords are floating around in /var/*/coredump gives me nightmares...)</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9602497</commentid>
<comment_count>6</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2016-08-10 08:24:43 -0400</bug_when>
<thetext>selinux-policy-3.13.1-191.10.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report. See https://fedoraproject.org/wiki/QA:Updates_Testing for instructions on how to
install test updates. You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-2c8a3e08c6</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9612247</commentid>
<comment_count>7</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2016-08-12 15:28:35 -0400</bug_when>
<thetext>selinux-policy-3.13.1-191.10.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9612559</commentid>
<comment_count>8</comment_count>
<who name="">notadrop</who>
<bug_when>2016-08-12 18:24:13 -0400</bug_when>
<thetext>I have updated my system and also installed the testing update of the &quot;selinux-policy.noarch&quot; package. The problem appears to be solved. I will, of course, report back if anything changes in that regard.</thetext>
</long_desc>

<attachment isobsolete="0" ispatch="0" isprivate="0">
<attachid>1183239</attachid>
<date>2016-07-23 20:44:00 -0400</date>
<delta_ts>2016-07-23 20:44:45 -0400</delta_ts>
<desc>sealert output</desc>
<filename>bug1359446_sealertlookup.txt</filename>
<type>text/plain</type>
<size>3171</size>
<attacher name="Chris Murphy">bugzilla</attacher>

<data encoding="base64">W3Jvb3RAZjI0bSBpbWFnZXNdIyBzZWFsZXJ0IC1sIDNmZTc5MmQ3LTJkYzAtNDM3OS05Mzg2LTAw ZmYyMDdlNDI5MQpTRUxpbnV4IGlzIHByZXZlbnRpbmcgKGNvcmVkdW1wKSBmcm9tIG1vdW50b24g
YWNjZXNzIG9uIHRoZSBkaXJlY3RvcnkgL2V0Yy4KCioqKioqICBQbHVnaW4gY2F0Y2hhbGxfbGFi ZWxzICg4My44IGNvbmZpZGVuY2UpIHN1Z2dlc3RzICAgKioqKioqKioqKioqKioqKioqKgoKSWYg eW91IHdhbnQgdG8gYWxsb3cgKGNvcmVkdW1wKSB0byBoYXZlIG1vdW50b24gYWNjZXNzIG9uIHRo
ZSBldGMgZGlyZWN0b3J5ClRoZW4geW91IG5lZWQgdG8gY2hhbmdlIHRoZSBsYWJlbCBvbiAvZXRj CkRvCiMgc2VtYW5hZ2UgZmNvbnRleHQgLWEgLXQgRklMRV9UWVBFICcvZXRjJwp3aGVyZSBGSUxF X1RZUEUgaXMgb25lIG9mIHRoZSBmb2xsb3dpbmc6IGFkbWluX2hvbWVfdCwgYW5vbl9pbm9kZWZz
X3QsIGF1ZGl0X3Nwb29sX3QsIGF1ZGl0ZF9sb2dfdCwgYXV0b2ZzX3QsIGF1dG9tb3VudF90bXBf dCwgYmFjdWxhX3N0b3JlX3QsIGJpbmZtdF9taXNjX2ZzX3QsIGJvb3RfdCwgY2FwaWZzX3QsIGNl cGhmc190LCBjZ3JvdXBfdCwgY2lmc190LCBjb250YWluZXJfaW1hZ2VfdCwgZGVidWdmc190LCBk
ZWZhdWx0X3QsIGRldmljZV90LCBkZXZwdHNfdCwgZG5zc2VjX3QsIGRvc2ZzX3QsIGVjcnlwdGZz X3QsIGVmaXZhcmZzX3QsIGZ1c2Vmc190LCBob21lX3Jvb3RfdCwgaHVnZXRsYmZzX3QsIGlmY29u ZmlnX3Zhcl9ydW5fdCwgaW5pdF92YXJfcnVuX3QsIGluaXRyY190bXBfdCwgaXNvOTY2MF90LCBr
ZGJ1c2ZzX3QsIG1haWxfc3Bvb2xfdCwgbW50X3QsIG1xdWV1ZV9zcG9vbF90LCBuYW1lZF9jb25m X3QsIG5ld3Nfc3Bvb2xfdCwgbmZzX3QsIG5mc2RfZnNfdCwgb25sb2FkX2ZzX3QsIG9wZW5zaGlm dF90bXBfdCwgb3BlbnNoaWZ0X3Zhcl9saWJfdCwgb3JhY2xlYXNtZnNfdCwgcHJvY190LCBwcm9j
X3hlbl90LCBwc3RvcmVfdCwgcHVibGljX2NvbnRlbnRfcndfdCwgcHVibGljX2NvbnRlbnRfdCwg cmFtZnNfdCwgcmFuZG9tX3NlZWRfdCwgcmVtb3ZhYmxlX3QsIHJvb3RfdCwgcnBjX3BpcGVmc190 LCBzZWN1cml0eV90LCBzcHVmc190LCBzcmNfdCwgc3ZpcnRfc2FuZGJveF9maWxlX3QsIHN5c2N0
bF9mc190LCBzeXNjdGxfdCwgc3lzZnNfdCwgc3lzdl90LCB0bXBfdCwgdG1wZnNfdCwgdXNiZnNf dCwgdXNlcl9ob21lX2Rpcl90LCB1c2VyX2hvbWVfdCwgdXNlcl90bXBfdCwgdXNyX3QsIHZhcl9s aWJfbmZzX3QsIHZhcl9saWJfdCwgdmFyX2xvY2tfdCwgdmFyX2xvZ190LCB2YXJfcnVuX3QsIHZh
cl90LCB2aXJ0X2ltYWdlX3QsIHZpcnRfdmFyX2xpYl90LCB2bWJsb2NrX3QsIHZ4ZnNfdCwgeGVu ZF92YXJfbGliX3QsIHhlbmRfdmFyX3J1bl90LCB4ZW5mc190LCB4ZW5zdG9yZWRfdmFyX2xpYl90 LgpUaGVuIGV4ZWN1dGU6CnJlc3RvcmVjb24gLXYgJy9ldGMnCgoKKioqKiogIFBsdWdpbiBjYXRj
aGFsbCAoMTcuMSBjb25maWRlbmNlKSBzdWdnZXN0cyAgICoqKioqKioqKioqKioqKioqKioqKioq KioqCgpJZiB5b3UgYmVsaWV2ZSB0aGF0IChjb3JlZHVtcCkgc2hvdWxkIGJlIGFsbG93ZWQgbW91 bnRvbiBhY2Nlc3Mgb24gdGhlIGV0YyBkaXJlY3RvcnkgYnkgZGVmYXVsdC4KVGhlbiB5b3Ugc2hv
dWxkIHJlcG9ydCB0aGlzIGFzIGEgYnVnLgpZb3UgY2FuIGdlbmVyYXRlIGEgbG9jYWwgcG9saWN5 IG1vZHVsZSB0byBhbGxvdyB0aGlzIGFjY2Vzcy4KRG8KYWxsb3cgdGhpcyBhY2Nlc3MgZm9yIG5v dyBieSBleGVjdXRpbmc6CiMgYXVzZWFyY2ggLWMgJyhjb3JlZHVtcCknIC0tcmF3IHwgYXVkaXQy
YWxsb3cgLU0gbXktY29yZWR1bXAKIyBzZW1vZHVsZSAtWCAzMDAgLWkgbXktY29yZWR1bXAucHAK CgpBZGRpdGlvbmFsIEluZm9ybWF0aW9uOgpTb3VyY2UgQ29udGV4dCAgICAgICAgICAgICAgICBz eXN0ZW1fdTpzeXN0ZW1fcjppbml0X3Q6czAKVGFyZ2V0IENvbnRleHQgICAgICAgICAgICAgICAg
c3lzdGVtX3U6b2JqZWN0X3I6ZXRjX3Q6czAKVGFyZ2V0IE9iamVjdHMgICAgICAgICAgICAgICAg L2V0YyBbIGRpciBdClNvdXJjZSAgICAgICAgICAgICAgICAgICAgICAgIChjb3JlZHVtcCkKU291 cmNlIFBhdGggICAgICAgICAgICAgICAgICAgKGNvcmVkdW1wKQpQb3J0ICAgICAgICAgICAgICAg
ICAgICAgICAgICA8VW5rbm93bj4KSG9zdCAgICAgICAgICAgICAgICAgICAgICAgICAgZjI0bQpT b3VyY2UgUlBNIFBhY2thZ2VzICAgICAgICAgICAKVGFyZ2V0IFJQTSBQYWNrYWdlcyAgICAgICAg ICAgZmlsZXN5c3RlbS0zLjItMzcuZmMyNC54ODZfNjQKUG9saWN5IFJQTSAgICAgICAgICAgICAg
ICAgICAgc2VsaW51eC1wb2xpY3ktMy4xMy4xLTE5MS41LmZjMjQubm9hcmNoClNlbGludXggRW5h YmxlZCAgICAgICAgICAgICAgIFRydWUKUG9saWN5IFR5cGUgICAgICAgICAgICAgICAgICAgdGFy Z2V0ZWQKRW5mb3JjaW5nIE1vZGUgICAgICAgICAgICAgICAgRW5mb3JjaW5nCkhvc3QgTmFtZSAg
ICAgICAgICAgICAgICAgICAgIGYyNG0KUGxhdGZvcm0gICAgICAgICAgICAgICAgICAgICAgTGlu dXggZjI0bSA0LjYuNC0zMDEuZmMyNC54ODZfNjQgIzEgU01QIFR1ZSBKdWwgMTIKICAgICAgICAg ICAgICAgICAgICAgICAgICAgICAgMTE6NTA6MDAgVVRDIDIwMTYgeDg2XzY0IHg4Nl82NApBbGVy
dCBDb3VudCAgICAgICAgICAgICAgICAgICAzCkZpcnN0IFNlZW4gICAgICAgICAgICAgICAgICAg IDIwMTYtMDctMjMgMTA6MjU6MTAgTURUCkxhc3QgU2VlbiAgICAgICAgICAgICAgICAgICAgIDIw MTYtMDctMjMgMTQ6NDQ6NDkgTURUCkxvY2FsIElEICAgICAgICAgICAgICAgICAgICAgIDNmZTc5
MmQ3LTJkYzAtNDM3OS05Mzg2LTAwZmYyMDdlNDI5MQoKUmF3IEF1ZGl0IE1lc3NhZ2VzCnR5cGU9 QVZDIG1zZz1hdWRpdCgxNDY5MzA2Njg5LjQzNDo4Nyk6IGF2YzogIGRlbmllZCAgeyBtb3VudG9u IH0gZm9yICBwaWQ9Nzg1IGNvbW09Iih1ZXRvb3RoZCkiIHBhdGg9Ii9ldGMiIGRldj0ic2RhNSIg
aW5vPTI2NyBzY29udGV4dD1zeXN0ZW1fdTpzeXN0ZW1fcjppbml0X3Q6czAgdGNvbnRleHQ9c3lz dGVtX3U6b2JqZWN0X3I6ZXRjX3Q6czAgdGNsYXNzPWRpciBwZXJtaXNzaXZlPTAKCgpIYXNoOiAo Y29yZWR1bXApLGluaXRfdCxldGNfdCxkaXIsbW91bnRvbgoK
</data>

</attachment>

</bug>

</bugzilla>
