<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1242980</bug_id>
          
          <creation_ts>2015-07-14 09:51:00 -0400</creation_ts>
          <short_desc>-Wcast-qual compiler warnings in hv_func.h</short_desc>
          <delta_ts>2017-01-03 16:24:31 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>perl</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc>https://rt.perl.org/Ticket/Display.html?id=130169</bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Patch</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jan Safranek">jsafrane</reporter>
          <assigned_to name="Petr Pisar">ppisar</assigned_to>
          <cc>cweyl</cc>
    
    
    <cc>iarnell</cc>
    
    
    <cc>jplesnik</cc>
    
    
    <cc>kasal</cc>
    
    
    <cc>perl-devel</cc>
    
    
    <cc>ppisar</cc>
    
    
    <cc>psabata</cc>
    
    
    <cc>rc040203</cc>
    
    
    <cc>tcallawa</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>perl-5.24.0-381.fc26 perl-5.24.0-380.fc25 perl-5.22.2-365.fc24</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-12-22 00:24:26</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>8437870</commentid>
    <comment_count>0</comment_count>
    <who name="Jan Safranek">jsafrane</who>
    <bug_when>2015-07-14 09:51:03 -0400</bug_when>
    <thetext>I get following warnings when compiling net-snmp with -Wall:

gcc -c   -I../../include -DNETSNMP_ENABLE_IPV6 -fno-strict-aliasing -g -O2 -Ulinux -Dlinux=linux -D_REENTRANT -D_GNU_SOURCE -fwrapv -fno-strict-aliasing -pipe -fstack-protector -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -I/usr/lib64/perl5/CORE -Wall -Wstrict-prototypes -Wwrite-strings -Wcast-qual -I. -I/usr/local/include -D_REENTRANT -D_GNU_SOURCE -fwrapv -fno-strict-aliasing -pipe -fstack-protector -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic   -DVERSION=\&quot;5.08\&quot; -DXS_VERSION=\&quot;5.08\&quot; -fPIC &quot;-I/usr/lib64/perl5/CORE&quot;   default_store.c
In file included from /usr/lib64/perl5/CORE/hv.h:629:0,
                 from /usr/lib64/perl5/CORE/perl.h:3344,
                 from default_store.xs:6:
/usr/lib64/perl5/CORE/hv_func.h: In function ‘S_perl_hash_siphash_2_4’:
/usr/lib64/perl5/CORE/hv_func.h:201:23: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
   U64TYPE k0 = ((U64TYPE*)seed)[0];
                       ^
/usr/lib64/perl5/CORE/hv_func.h:202:23: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
   U64TYPE k1 = ((U64TYPE*)seed)[1];
                       ^
In file included from /usr/lib64/perl5/CORE/hv.h:629:0,
                 from /usr/lib64/perl5/CORE/perl.h:3344,
                 from default_store.xs:6:
/usr/lib64/perl5/CORE/hv_func.h: In function ‘S_perl_hash_superfast’:
/usr/lib64/perl5/CORE/hv_func.h:260:18: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
     U32 hash = *((U32*)seed) + len;
                  ^
In file included from /usr/lib64/perl5/CORE/hv.h:629:0,
                 from /usr/lib64/perl5/CORE/perl.h:3344,
                 from default_store.xs:6:
/usr/lib64/perl5/CORE/hv_func.h: In function ‘S_perl_hash_murmur3’:
/usr/lib64/perl5/CORE/hv_func.h:364:16: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
     U32 h1 = *((U32*)seed);
                ^
In file included from /usr/lib64/perl5/CORE/hv.h:629:0,
                 from /usr/lib64/perl5/CORE/perl.h:3344,
                 from default_store.xs:6:
/usr/lib64/perl5/CORE/hv_func.h:401:21: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
             k1 = U8TO32_LE(ptr);
                     ^
/usr/lib64/perl5/CORE/hv_func.h:408:24: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
             carry = U8TO32_LE(ptr);
                        ^
/usr/lib64/perl5/CORE/hv_func.h:416:24: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
             carry = U8TO32_LE(ptr);
                        ^
/usr/lib64/perl5/CORE/hv_func.h:424:24: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
             carry = U8TO32_LE(ptr);
                        ^
/usr/lib64/perl5/CORE/hv_func.h: In function ‘S_perl_hash_djb2’:
/usr/lib64/perl5/CORE/hv_func.h:458:18: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
     U32 hash = *((U32*)seed + len);
                  ^
/usr/lib64/perl5/CORE/hv_func.h: In function ‘S_perl_hash_sdbm’:
/usr/lib64/perl5/CORE/hv_func.h:468:18: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
     U32 hash = *((U32*)seed + len);
                  ^
In file included from /usr/lib64/perl5/CORE/hv.h:629:0,
                 from /usr/lib64/perl5/CORE/perl.h:3344,
                 from default_store.xs:6:
/usr/lib64/perl5/CORE/hv_func.h: In function ‘S_perl_hash_one_at_a_time’:
/usr/lib64/perl5/CORE/hv_func.h:494:18: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
     U32 hash = *((U32*)seed) + len;
                  ^
/usr/lib64/perl5/CORE/hv_func.h: In function ‘S_perl_hash_one_at_a_time_hard’:
/usr/lib64/perl5/CORE/hv_func.h:509:18: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
     U32 hash = *((U32*)seed) + len;
                  ^
/usr/lib64/perl5/CORE/hv_func.h: In function ‘S_perl_hash_old_one_at_a_time’:
/usr/lib64/perl5/CORE/hv_func.h:544:18: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
     U32 hash = *((U32*)seed);
                  ^

This pollutes build logs and we may miss some useful warning. What about this?

-     U32 hash = *((U32*)seed) + len;
+     U32 hash = (U32) *seed + len;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8442439</commentid>
    <comment_count>1</comment_count>
    <who name="Jan Kurik">jkurik</who>
    <bug_when>2015-07-15 09:16:48 -0400</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 23 development cycle.
Changing version to &apos;23&apos;.

(As we did not run this process for some time, it could affect also pre-Fedora 23 development
cycle bugs. We are very sorry. It will help us with cleanup during Fedora 23 End Of Life. Thank you.)

More information and reason for this action is here:
https://fedoraproject.org/wiki/BugZappers/HouseKeeping/Fedora23</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9921359</commentid>
    <comment_count>2</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2016-11-24 07:12:11 -0500</bug_when>
    <thetext>This message is a reminder that Fedora 23 is nearing its end of life.
Approximately 4 (four) weeks from now Fedora will stop maintaining
and issuing updates for Fedora 23. It is Fedora&apos;s policy to close all
bug reports from releases that are no longer maintained. At that time
this bug will be closed as EOL if it remains open with a Fedora  &apos;version&apos;
of &apos;23&apos;.

Package Maintainer: If you wish for this bug to remain open because you
plan to fix it in a currently maintained version, simply change the &apos;version&apos; 
to a later Fedora version.

Thank you for reporting this issue and we are sorry that we were not 
able to fix it before Fedora 23 is end of life. If you would still like 
to see this bug fixed and are able to reproduce it against a later version 
of Fedora, you are encouraged  change the &apos;version&apos; to a later Fedora 
version prior this bug is closed as described in the policy above.

Although we aim to fix as many bugs as possible during every release&apos;s 
lifetime, sometimes those efforts are overtaken by events. Often a 
more recent Fedora release includes newer upstream software that fixes 
bugs or makes them obsolete.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9923266</commentid>
    <comment_count>3</comment_count>
    <who name="Petr Pisar">ppisar</who>
    <bug_when>2016-11-24 08:56:29 -0500</bug_when>
    <thetext>The proposed change is wrong. Original code copies 4 bytes from a memory specified by a pointer. Proposed code would take 1 byte from a memory specified by a pointer and coerced the value to a 4-byte integer.

But your point about the cast constness is valid.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9924091</commentid>
    <comment_count>4</comment_count>
    <who name="Petr Pisar">ppisar</who>
    <bug_when>2016-11-24 09:42:17 -0500</bug_when>
    <thetext>Reproducer:

$ printf &apos;#include &quot;EXTERN.h&quot;\n#include &quot;perl.h&quot;\n&apos; | gcc -Wcast-qual -I/usr/lib64/perl5/CORE -c -x c -
In file included from /usr/lib64/perl5/CORE/hv.h:629:0,
                 from /usr/lib64/perl5/CORE/perl.h:3740,
                 from &lt;stdin&gt;:2:
/usr/lib64/perl5/CORE/hv_func.h: In function ‘S_perl_hash_siphash_2_4’:
/usr/lib64/perl5/CORE/hv_func.h:213:17: warning: cast discards ‘const’ qualifier from pointer target type [-Wcast-qual]
   U64TYPE k0 = ((U64TYPE*)seed)[0];
                 ^
et cetera.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9929962</commentid>
    <comment_count>5</comment_count>
    <who name="Petr Pisar">ppisar</who>
    <bug_when>2016-11-25 08:30:46 -0500</bug_when>
    <thetext>I developed fixes that are under review now. However upstream developmental code added new violating in-line functions that he does not to fix. So probably you will have to live with some warnings in the future.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9946049</commentid>
    <comment_count>6</comment_count>
    <who name="Petr Pisar">ppisar</who>
    <bug_when>2016-12-01 01:39:49 -0500</bug_when>
    <thetext>Upstream accepted the fixes. The new violations were fixed by suppressing the warnings.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9998695</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-19 10:28:11 -0500</bug_when>
    <thetext>perl-5.24.0-380.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2016-213ba43154</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10000995</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-20 01:54:27 -0500</bug_when>
    <thetext>perl-5.22.2-365.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-85dffa754f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10001404</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-20 04:23:51 -0500</bug_when>
    <thetext>perl-5.24.0-380.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-213ba43154</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10007182</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-20 14:21:52 -0500</bug_when>
    <thetext>perl-5.22.2-365.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-85dffa754f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10013149</commentid>
    <comment_count>11</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-22 00:24:26 -0500</bug_when>
    <thetext>perl-5.24.0-380.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10031729</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-01-03 16:24:31 -0500</bug_when>
    <thetext>perl-5.22.2-365.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>