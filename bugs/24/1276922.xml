<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1276922</bug_id>
          
          <creation_ts>2015-11-01 05:41:00 -0500</creation_ts>
          <short_desc>SELinux is preventing find from &apos;read&apos; accesses on the directory repodata.</short_desc>
          <delta_ts>2016-10-06 18:53:08 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>selinux-policy</component>
          <version>24</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard>abrt_hash:9fb8200dcf856be7e19d40f68ba85b4430bf5b459c75ef68ef1130252bb12014;VARIANT_ID=workstation;</status_whiteboard>
          <keywords></keywords>
          <priority>medium</priority>
          <bug_severity>medium</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1277654</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Christian Stadelmann">rhbz2</reporter>
          <assigned_to name="Lukas Vrabec">lvrabec</assigned_to>
          <cc>abrt-devel-list</cc>
    
    
    <cc>akees</cc>
    
    
    <cc>brian</cc>
    
    
    <cc>brian.murrell</cc>
    
    
    <cc>cla.azzarello</cc>
    
    
    <cc>dominick.grift</cc>
    
    
    <cc>dvlasenk</cc>
    
    
    <cc>dwalsh</cc>
    
    
    <cc>enugazio</cc>
    
    
    <cc>estes.chris72</cc>
    
    
    <cc>iprikryl</cc>
    
    
    <cc>jayabharat</cc>
    
    
    <cc>jfilak</cc>
    
    
    <cc>lvrabec</cc>
    
    
    <cc>maxim.galamay</cc>
    
    
    <cc>mgrepl</cc>
    
    
    <cc>mhabrnal</cc>
    
    
    <cc>michal.toman</cc>
    
    
    <cc>mmilata</cc>
    
    
    <cc>niki.guldbrand</cc>
    
    
    <cc>obliterator666</cc>
    
    
    <cc>plautrba</cc>
    
    
    <cc>rhbz2</cc>
    
    
    <cc>sheepdestroyer</cc>
    
    
    <cc>szmitek</cc>
    
    
    <cc>thithithori37</cc>
    
    
    <cc>xzj8b3</cc>
    
    
    <cc>zyxsamys</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>selinux-policy-3.13.1-191.16.fc24</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-09-21 20:24:08</cf_last_closed>
          <cf_type>---</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>8771331</commentid>
    <comment_count>0</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2015-11-01 05:41:35 -0500</bug_when>
    <thetext>Description of problem:
This happened while dnf was running as root on cli and yumex-dnf was running as admin user looking at the dnf history database. At the same time https://bugzilla.redhat.com/show_bug.cgi?id=1276921 happened.
SELinux is preventing find from &apos;read&apos; accesses on the directory repodata.

*****  Plugin catchall (100. confidence) suggests   **************************

If sie denken, dass es find standardmässig erlaubt sein sollte, read Zugriff auf repodata directory zu erhalten.
Then sie sollten dies als Fehler melden.
Um diesen Zugriff zu erlauben, können Sie ein lokales Richtlinien-Modul erstellen.
Do
zugriff jetzt erlauben, indem Sie die nachfolgenden Befehle ausführen:
# grep find /var/log/audit/audit.log | audit2allow -M mypol
# semodule -i mypol.pp

Additional Information:
Source Context                system_u:system_r:abrt_t:s0-s0:c0.c1023
Target Context                system_u:object_r:rpm_tmp_t:s0
Target Objects                repodata [ dir ]
Source                        find
Source Path                   find
Port                          &lt;Unknown&gt;
Host                          (removed)
Source RPM Packages           
Target RPM Packages           
Policy RPM                    selinux-policy-3.13.1-152.fc23.noarch
Selinux Enabled               True
Policy Type                   targeted
Enforcing Mode                Enforcing
Host Name                     (removed)
Platform                      Linux (removed) 4.2.3-300.fc23.x86_64 #1 SMP Mon
                              Oct 5 15:42:54 UTC 2015 x86_64 x86_64
Alert Count                   7
First Seen                    2015-11-01 11:38:20 CET
Last Seen                     2015-11-01 11:38:20 CET
Local ID                      7e5cfa36-9dca-4dba-a821-dca0e84692c3

Raw Audit Messages
type=AVC msg=audit(1446374300.719:693): avc:  denied  { read } for  pid=15519 comm=&quot;find&quot; name=&quot;repodata&quot; dev=&quot;dm-0&quot; ino=17791 scontext=system_u:system_r:abrt_t:s0-s0:c0.c1023 tcontext=system_u:object_r:rpm_tmp_t:s0 tclass=dir permissive=0


Hash: find,abrt_t,rpm_tmp_t,dir,read

Version-Release number of selected component:
selinux-policy-3.13.1-152.fc23.noarch

Additional info:
reporter:       libreport-2.6.3
hashmarkername: setroubleshoot
kernel:         4.2.3-300.fc23.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8794396</commentid>
    <comment_count>1</comment_count>
    <who name="Michal Nowak">mnowak</who>
    <bug_when>2015-11-05 05:35:21 -0500</bug_when>
    <thetext>Description of problem:
I used DNF at that time.

Version-Release number of selected component:
selinux-policy-3.13.1-152.fc23.noarch

Additional info:
reporter:       libreport-2.6.3
hashmarkername: setroubleshoot
kernel:         4.2.5-300.fc23.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8802695</commentid>
    <comment_count>2</comment_count>
    <who name="">sheepdestroyer</who>
    <bug_when>2015-11-09 04:30:17 -0500</bug_when>
    <thetext>Description of problem:
put &quot;n&quot; as answer to update or not question from dnf :

...
...
Upgrade  56 Packages

Total download size: 122 M
Is this ok [y/N]:  n
Traceback (most recent call last):
  File &quot;/bin/dnf&quot;, line 35, in &lt;module&gt;
    main.user_main(sys.argv[1:], exit_code=True)
  File &quot;/usr/lib/python3.4/site-packages/dnf/cli/main.py&quot;, line 198, in user_main
    errcode = main(args)
  File &quot;/usr/lib/python3.4/site-packages/dnf/cli/main.py&quot;, line 84, in main
    return _main(base, args)
  File &quot;/usr/lib/python3.4/site-packages/dnf/cli/main.py&quot;, line 144, in _main
    ret = resolving(cli, base)
  File &quot;/usr/lib/python3.4/site-packages/dnf/cli/main.py&quot;, line 173, in resolving
    base.do_transaction(display=displays)
  File &quot;/usr/lib/python3.4/site-packages/dnf/cli/cli.py&quot;, line 200, in do_transaction
    if self.conf.assumeno or not self.output.userconfirm():
  File &quot;/usr/lib/python3.4/site-packages/dnf/cli/output.py&quot;, line 631, in userconfirm
    choice = dnf.i18n.ucd_input(msg)
  File &quot;/usr/lib/python3.4/site-packages/dnf/i18n.py&quot;, line 109, in ucd_input
    return dnf.pycomp.raw_input()
UnicodeDecodeError: &apos;utf-8&apos; codec can&apos;t decode bytes in position 0-1: invalid continuation byte
[sheepdestroyer@sheepora ~] $ 

Version-Release number of selected component:
selinux-policy-3.13.1-153.fc23.noarch

Additional info:
reporter:       libreport-2.6.3
hashmarkername: setroubleshoot
kernel:         4.2.5-300.fc23.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8845806</commentid>
    <comment_count>3</comment_count>
    <who name="Jakub Filak">jfilak</who>
    <bug_when>2015-11-20 06:17:31 -0500</bug_when>
    <thetext>This AVC is probably caused by dnf&apos;s EVENT=notify script which is run by abrtd:
https://github.com/rpm-software-management/dnf/blob/master/etc/collect_dnf.conf

Mirek, can you please take a look at the script?

The script makes copies of files from /var/cache/dnf, /var/tmp/dnf-${username}-* and /var/log/dnf.log and /var/log/dnf.transaction.log</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8846855</commentid>
    <comment_count>4</comment_count>
    <who name="Lukas Vrabec">lvrabec</who>
    <bug_when>2015-11-20 10:49:48 -0500</bug_when>
    <thetext>In this case we should allow it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9080437</commentid>
    <comment_count>5</comment_count>
    <who name="Kamil Szmit">szmitek</who>
    <bug_when>2016-02-20 05:18:05 -0500</bug_when>
    <thetext>Description of problem:
Error was probably caused by DNF automatic updates.

Version-Release number of selected component:
selinux-policy-3.13.1-158.6.fc23.noarch

Additional info:
reporter:       libreport-2.6.4
hashmarkername: setroubleshoot
kernel:         4.3.5-300.fc23.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9085689</commentid>
    <comment_count>6</comment_count>
    <who name="Maxim Galamay">maxim.galamay</who>
    <bug_when>2016-02-22 14:48:38 -0500</bug_when>
    <thetext>Description of problem:
just run sudo dnf clean all

Version-Release number of selected component:
selinux-policy-3.13.1-158.6.fc23.noarch

Additional info:
reporter:       libreport-2.6.4
hashmarkername: setroubleshoot
kernel:         4.3.5-300.fc23.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9213888</commentid>
    <comment_count>7</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2016-04-06 18:22:23 -0400</bug_when>
    <thetext>Still present with selinux-policy-targeted-3.13.1-180.fc24.noarch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9228590</commentid>
    <comment_count>8</comment_count>
    <who name="Lukas Vrabec">lvrabec</who>
    <bug_when>2016-04-12 06:15:49 -0400</bug_when>
    <thetext>Hi, 
Do you know where is repodata dir stored? I believe this dir should have rpm_var_cache_t label. Then, we have rules for this action.

$ sesearch -A -s abrt_t -t rpm_var_cache_t -p read -c dir 
Found 1 semantic av rules:
   allow abrt_t rpm_var_cache_t : dir { ioctl read write create getattr setattr lock unlink link rename add_name remove_name reparent search rmdir open } ;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9228956</commentid>
    <comment_count>9</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2016-04-12 07:37:56 -0400</bug_when>
    <thetext>@Lukas vrabec: I don&apos;t have any clue, no. Is there any file name or extension I can search for? I would expect it to be somewhere below /var/cache/dnf or /var/lib/dnf, since both dnf and yumex-dnf are using dnf api.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9258015</commentid>
    <comment_count>10</comment_count>
    <who name="Lukas Vrabec">lvrabec</who>
    <bug_when>2016-04-21 10:18:02 -0400</bug_when>
    <thetext>*** Bug 1327241 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9285350</commentid>
    <comment_count>11</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2016-05-02 10:55:31 -0400</bug_when>
    <thetext>There is no `sesearch` command on my computer and `dnf provides sesearch` doesn&apos;t find one either.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9285797</commentid>
    <comment_count>12</comment_count>
    <who name="Daniel Walsh">dwalsh</who>
    <bug_when>2016-05-02 14:16:11 -0400</bug_when>
    <thetext>dnf install setools-console</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9285918</commentid>
    <comment_count>13</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2016-05-02 15:04:05 -0400</bug_when>
    <thetext>Looks the same here:

$ sesearch -A -s abrt_t -t rpm_var_cache_t -p read -c dir
Found 1 semantic av rules:
   allow abrt_t rpm_var_cache_t : dir { ioctl read write create getattr setattr lock unlink link rename add_name remove_name reparent search rmdir open } ;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9432543</commentid>
    <comment_count>14</comment_count>
    <who name="Lukas Vrabec">lvrabec</who>
    <bug_when>2016-06-20 06:58:36 -0400</bug_when>
    <thetext>*** Bug 1344375 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9493902</commentid>
    <comment_count>15</comment_count>
    <who name="">estes.chris72</who>
    <bug_when>2016-07-09 21:48:26 -0400</bug_when>
    <thetext>Description of problem:
I was installing OSSEC client on Fedora 24. The commands that I ran were as follows:

# wget -q -O – https://www.atomicorp.com/installers/atomic | sh 
# dnf install ossec-hids ossec-hids-client

The following error came up after entering the second command:

Running transaction
  Installing  : inotify-tools-3.14-10.fc24.x86_64                           1/3 
  Installing  : ossec-hids-2.8.3-51.fc24.art.x86_64                         2/3 
  Installing  : ossec-hids-client-2.8.3-51.fc24.art.x86_64                  3/3 
Restarting ossec-hids (via systemctl):  Job for ossec-hids.service failed because the control process exited with error code. See &quot;systemctl status ossec-hids.service&quot; and &quot;journalctl -xe&quot; for details.
[FAILED]
^Cwarning: %triggerin(man-db-2.7.5-3.fc24.x86_64) scriptlet failed, signal 2
Traceback (most recent call last):
  File &quot;/usr/lib/python3.5/site-packages/dnf/yum/rpmtrans.py&quot;, line 427, in callback
    self._scriptError(bytes, total, h)
  File &quot;/usr/lib/python3.5/site-packages/dnf/yum/rpmtrans.py&quot;, line 557, in _scriptError
    pkg, _, _ = self._extract_cbkey(h)
  File &quot;/usr/lib/python3.5/site-packages/dnf/yum/rpmtrans.py&quot;, line 229, in _extract_cbkey
    return self._extract_str_cbkey(cbkey)
  File &quot;/usr/lib/python3.5/site-packages/dnf/yum/rpmtrans.py&quot;, line 237, in _extract_str_cbkey
    assert(isinstance(name, basestring))
AssertionError
FATAL ERROR: python callback ??? failed, aborting!

I am not sure how to reproduce.

Version-Release number of selected component:
selinux-policy-3.13.1-190.fc24.noarch

Additional info:
reporter:       libreport-2.7.1
hashmarkername: setroubleshoot
kernel:         4.5.7-300.fc24.x86_64
reproducible:   Not sure how to reproduce the problem
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9705243</commentid>
    <comment_count>16</comment_count>
    <who name="Brian J. Murrell">brian</who>
    <bug_when>2016-09-13 21:51:34 -0400</bug_when>
    <thetext>Description of problem:
Not sure what caused this.

Version-Release number of selected component:
selinux-policy-3.13.1-158.fc23.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.6.4-301.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9710649</commentid>
    <comment_count>17</comment_count>
    <who name="Claudio Azzarello">cla.azzarello</who>
    <bug_when>2016-09-15 07:51:42 -0400</bug_when>
    <thetext>Description of problem:
I was running &quot;sudo dnf update&quot;. At the end of the process the window was freeze.

Version-Release number of selected component:
selinux-policy-3.13.1-191.14.fc24.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.7.2-201.fc24.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9712871</commentid>
    <comment_count>18</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-09-15 20:53:15 -0400</bug_when>
    <thetext>selinux-policy-3.13.1-191.16.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-fe39b806b6</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9732070</commentid>
    <comment_count>19</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-09-21 20:24:08 -0400</bug_when>
    <thetext>selinux-policy-3.13.1-191.16.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9772258</commentid>
    <comment_count>20</comment_count>
    <who name="enrico ugazio">enugazio</who>
    <bug_when>2016-10-06 18:53:08 -0400</bug_when>
    <thetext>Description of problem:
i dnf update esecute the command but the system interrupt

Version-Release number of selected component:
selinux-policy-3.13.1-190.fc24.noarch

Additional info:
reporter:       libreport-2.7.1
hashmarkername: setroubleshoot
kernel:         4.7.5-200.fc24.x86_64
reproducible:   Not sure how to reproduce the problem
type:           libreport</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>