<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1337424</bug_id>
          
          <creation_ts>2016-05-19 03:54:00 -0400</creation_ts>
          <short_desc>Very short timeout for establishment of VPN connection</short_desc>
          <delta_ts>2016-08-19 15:50:02 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>NetworkManager</component>
          <version>24</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Alexander Mayorov">alexus_m</reporter>
          <assigned_to name="Lubomir Rintel">lkundrak</assigned_to>
          <cc>adamc55</cc>
    
    
    <cc>bugzilla</cc>
    
    
    <cc>dcbw</cc>
    
    
    <cc>fgiudici</cc>
    
    
    <cc>lkundrak</cc>
    
    
    <cc>psimerda</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>NetworkManager-1.2.4-2.fc24</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-08-19 15:50:02</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9339760</commentid>
    <comment_count>0</comment_count>
    <who name="Alexander Mayorov">alexus_m</who>
    <bug_when>2016-05-19 03:54:04 -0400</bug_when>
    <thetext>Description of problem:
  There is very short timeout for VPN connection establishment via NM = 25 seconds.
Usually there is enough time if credential data are prepared before a connection attempt. But for OTP (one-time password) receiving via SMS it is really hard to get connected at least the very first time while you are reading, selecting parameter and typing credentials
and second times, e.g. connection profile modified with xml configuration downloaded from VPN GW and it is need to start profile configuration from beginning next time.
Even in case of good luck it is not easy to get connected via NM and afterwards if SMS with new OTP delayed few seconds.
There is no such kind of problem to connect via openconnect command.
  I&apos;ve checked the issue with OpenConnect, PPTP and vpnc plugins.

Version-Release number of selected component (if applicable):
NetworkManager-1.2.2-1.fc24.x86_64
NetworkManager-openconnect-1.2.2-1.fc24.x86_64
NetworkManager-pptp-1.2.2-1.fc24.x86_64
NetworkManager-pptp-gnome-1.2.2-1.fc24.x86_64
NetworkManager-vpnc-1.2.2-1.fc24.x86_64
NetworkManager-vpnc-gnome-1.2.2-1.fc24.x86_64


How reproducible:
Always in case of delay in establishment of VPN connection is more than 25 seconds.

Steps to Reproduce:
1. Start VPN connection via NM applet and don&apos;t send requested authentication data for a half of minute.
2. Then you can proceed further with authentication (it will always fail silently) or cancel the connection.
3. Check NM logs, e.g. with
journalctl --unit NetworkManager
You&apos;ll find following error
NetworkManager[8145]: &lt;error&gt; [1463641447.3416] vpn-connection[0x5617c05107a0,f273dcb1-6ec3-4bd2-9b7b-1a7c0d28ed9d,&quot;vpnc&quot;,0]: Failed to request VPN secrets #3: No agents were available for this request.

Actual results:
Establishment of VPN connection fail in case of delay is more than 25 seconds, e.g. because of awaited OTP via SMS.

Expected results:
There should be enough time to enter all required data especially in case of two-factor authentication.

Additional info:
  OpenConnect:
May 19 12:45:23 zb15.alexus NetworkManager[8145]: &lt;info&gt;  [1463640323.8144] audit: op=&quot;connection-activate&quot; uuid=&quot;370302f3-bb4e-473a-930d-815966088408&quot; name=&quot;OpenConnect&quot; pid=1726 uid=1000 result=&quot;success&quot;
May 19 12:45:23 zb15.alexus NetworkManager[8145]: &lt;info&gt;  [1463640323.8196] vpn-connection[0x5617c05107a0,370302f3-bb4e-473a-930d-815966088408,&quot;OpenConnect&quot;,0]: Started the VPN service, PID 10177
May 19 12:45:23 zb15.alexus NetworkManager[8145]: &lt;info&gt;  [1463640323.8300] vpn-connection[0x5617c05107a0,370302f3-bb4e-473a-930d-815966088408,&quot;OpenConnect&quot;,0]: Saw the service appear; activating connection
May 19 12:45:48 zb15.alexus NetworkManager[8145]: &lt;error&gt; [1463640348.9026] vpn-connection[0x5617c05107a0,370302f3-bb4e-473a-930d-815966088408,&quot;OpenConnect&quot;,0]: Failed to request VPN secrets #3: No agents were available for this request.
  PPTP:
May 19 13:15:25 zb15.alexus NetworkManager[8145]: &lt;info&gt;  [1463642125.0676] audit: op=&quot;connection-activate&quot; uuid=&quot;80de8e52-9bf2-4079-8b0e-5476a866155b&quot; name=&quot;PPTP&quot; pid=1726 uid=1000 result=&quot;success&quot;
May 19 13:15:25 zb15.alexus NetworkManager[8145]: &lt;info&gt;  [1463642125.0941] vpn-connection[0x5617c05105b0,80de8e52-9bf2-4079-8b0e-5476a866155b,&quot;PPTP&quot;,0]: Started the VPN service, PID 12494
May 19 13:15:25 zb15.alexus NetworkManager[8145]: &lt;info&gt;  [1463642125.0998] vpn-connection[0x5617c05105b0,80de8e52-9bf2-4079-8b0e-5476a866155b,&quot;PPTP&quot;,0]: Saw the service appear; activating connection
May 19 13:15:50 zb15.alexus NetworkManager[8145]: &lt;error&gt; [1463642150.2336] vpn-connection[0x5617c05105b0,80de8e52-9bf2-4079-8b0e-5476a866155b,&quot;PPTP&quot;,0]: Failed to request VPN secrets #3: No agents were available for this request.
  VPNC:
May 19 13:03:41 zb15.alexus NetworkManager[8145]: &lt;info&gt;  [1463641421.9434] audit: op=&quot;connection-activate&quot; uuid=&quot;f273dcb1-6ec3-4bd2-9b7b-1a7c0d28ed9d&quot; name=&quot;vpnc&quot; pid=1726 uid=1000 result=&quot;success&quot;
May 19 13:03:42 zb15.alexus NetworkManager[8145]: &lt;info&gt;  [1463641422.0643] vpn-connection[0x5617c05107a0,f273dcb1-6ec3-4bd2-9b7b-1a7c0d28ed9d,&quot;vpnc&quot;,0]: Started the VPN service, PID 11724
May 19 13:03:42 zb15.alexus NetworkManager[8145]: &lt;info&gt;  [1463641422.1107] vpn-connection[0x5617c05107a0,f273dcb1-6ec3-4bd2-9b7b-1a7c0d28ed9d,&quot;vpnc&quot;,0]: Saw the service appear; activating connection
May 19 13:04:07 zb15.alexus NetworkManager[8145]: &lt;error&gt; [1463641447.3416] vpn-connection[0x5617c05107a0,f273dcb1-6ec3-4bd2-9b7b-1a7c0d28ed9d,&quot;vpnc&quot;,0]: Failed to request VPN secrets #3: No agents were available for this request.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9479231</commentid>
    <comment_count>1</comment_count>
    <who name="Andy Campbell">bugzilla</who>
    <bug_when>2016-07-04 15:12:52 -0400</bug_when>
    <thetext>Confirmed - I noticed this after upgrading to F24.  Was ok in F23</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9502722</commentid>
    <comment_count>2</comment_count>
    <who name="Adam Connor">adamc55</who>
    <bug_when>2016-07-12 15:55:37 -0400</bug_when>
    <thetext>I had the same experience in Fedora 24. Seems like is it something hardcoded into NetworkManager: https://bugs.launchpad.net/ubuntu/+source/network-manager/+bug/420411</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9504744</commentid>
    <comment_count>3</comment_count>
    <who name="Francesco Giudici">fgiudici</who>
    <bug_when>2016-07-13 07:55:20 -0400</bug_when>
    <thetext>Hi, thanks for reporting.

This seems a duplicate of bugs:
https://bugzilla.gnome.org/show_bug.cgi?id=767321
https://bugzilla.redhat.com/show_bug.cgi?id=1349740

It has been tackled upstream recently:
https://cgit.freedesktop.org/NetworkManager/NetworkManager/commit/?id=10c53528552d1f0df8c28326a8f0bd2a31b9fa46

and has already been backported on nm-1-2 tree.
Should be fixed in the next release.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9587852</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-08-05 03:53:01 -0400</bug_when>
    <thetext>NetworkManager-1.2.4-1.fc24 network-manager-applet-1.2.4-1.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-f739ece3cf</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9590111</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-08-05 17:21:41 -0400</bug_when>
    <thetext>NetworkManager-1.2.4-1.fc24, network-manager-applet-1.2.4-1.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-f739ece3cf</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9627251</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-08-18 12:39:07 -0400</bug_when>
    <thetext>NetworkManager-1.2.4-2.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-fade485364</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9628654</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-08-18 20:56:53 -0400</bug_when>
    <thetext>NetworkManager-1.2.4-2.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-fade485364</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9630113</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-08-19 06:29:15 -0400</bug_when>
    <thetext>network-manager-applet-1.2.4-1.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-f739ece3cf</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9631568</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-08-19 15:49:39 -0400</bug_when>
    <thetext>NetworkManager-1.2.4-2.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>