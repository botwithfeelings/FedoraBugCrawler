<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1335401</bug_id>
          
          <creation_ts>2016-05-12 03:48:00 -0400</creation_ts>
          <short_desc>Weird sudo issue that seems to be selinux related</short_desc>
          <delta_ts>2016-05-16 12:18:43 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>sudo</component>
          <version>24</version>
          <rep_platform>All</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Patch</keywords>
          <priority>unspecified</priority>
          <bug_severity>high</bug_severity>
          <target_milestone>---</target_milestone>
          <dependson>1328735</dependson>
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Daniel Kopeček">dkopecek</reporter>
          <assigned_to name="Daniel Kopeček">dkopecek</assigned_to>
          <cc>dkopecek</cc>
    
    
    <cc>dominick.grift</cc>
    
    
    <cc>dwalsh</cc>
    
    
    <cc>extras-qa</cc>
    
    
    <cc>kzak</cc>
    
    
    <cc>lvrabec</cc>
    
    
    <cc>mgrepl</cc>
    
    
    <cc>plautrba</cc>
    
    
    <cc>rlpowell</cc>
    
    
    <cc>rsroka</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>sudo-1.8.16-3.fc24</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          <cf_clone_of>1328735</cf_clone_of>
          <cf_environment></cf_environment>
          <cf_last_closed>2016-05-16 12:18:43</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9319752</commentid>
    <comment_count>0</comment_count>
    <who name="Daniel Kopeček">dkopecek</who>
    <bug_when>2016-05-12 03:48:48 -0400</bug_when>
    <thetext>+++ This bug was initially created as a clone of Bug #1328735 +++

I just upgraded to rawhide on a machine with unconfined disabled:

rlpowell@vrici&gt; sudo ls
foo
rlpowell@vrici&gt; sudo ls .
sudo: unable to execute /bin/ls: Bad address
rlpowell@vrici&gt; sudo ls /bin/
sudo: unable to execute /bin/ls: Bad address
rlpowell@vrici&gt;

Now, here&apos;s the thing.  When it&apos;s doing this, we have:

root@vrici# cat /etc/sudoers.d/rlpowell
rlpowell    ALL=(ALL)    TYPE=unconfined_t ROLE=unconfined_r   ALL
rlpowell    ALL=(ALL)    TYPE=unconfined_t ROLE=unconfined_r   NOPASSWD: /usr/sbin/service
rlpowell    ALL=(ALL)    TYPE=unconfined_t ROLE=unconfined_r   NOPASSWD: /usr/bin/docker

If I change it to:

root@vrici# cat /etc/sudoers.d/rlpowell
rlpowell    ALL=(ALL)    TYPE=unconfined_t    ALL
rlpowell    ALL=(ALL)    TYPE=unconfined_t    NOPASSWD: /usr/sbin/service
rlpowell    ALL=(ALL)    TYPE=unconfined_t    NOPASSWD: /usr/bin/docker

, then sudo works fine:

rlpowell@vrici&gt; sudo ls /tmp/crap
foo

except that it doesn&apos;t appear to, you know, actually elevate my permissions in any way:

rlpowell@vrici&gt; sudo ls -l /var/log/httpd/
ls: cannot access &apos;/var/log/httpd/&apos;: Permission denied

Presumably because:

rlpowell@vrici&gt; sudo id -a
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel) context=staff_u:staff_r:staff_t:s0-s0:c0.c1023

It is, however, not a *simple* selinux problem, if it&apos;s an selinux problem at all (I just figured here was a good place to start) because:

rlpowell@vrici&gt; getenforce
Permissive
rlpowell@vrici&gt; sudo id -a
sudo: unable to execute /bin/id: Bad address

The bad call in strace:

[pid  8540] execve(&quot;/usr/libexec/sudo/sesh&quot;, [&quot;sesh&quot;, &quot;/bin/ls&quot;, &quot;/bin/&quot;, 0x6574616572637965, 0x6d65747379733a00, 0x31, &quot;\260\310\4\23,V&quot;, &quot;\260\310\4\23,V&quot;], [/* 20 vars */]) = -1 EFAULT (Bad address)

--- Additional comment from Robin Powell on 2016-04-20 04:08:05 EDT ---

The error occurs even with:

root@vrici# cat /etc/sudoers.d/rlpowell
rlpowell    ALL=(ALL)    TYPE=staff_t ROLE=staff_r   ALL

even though:

rlpowell@vrici&gt; id -a
uid=1000(rlpowell) gid=1000(rlpowell) groups=1000(rlpowell),10000(users) context=staff_u:staff_r:staff_t:s0-s0:c0.c1023

So apparently the error is &quot;sudo with ROLE= explodes&quot;, which is seeming less and less like an SELinux issue as such.

--- Additional comment from Robin Powell on 2016-04-20 04:17:34 EDT ---

Erm, sorry, apparently the error is &quot;sudo with ROLE= explodes, but only if there are arguments given to the command&quot;.  0.o

&quot;sudo ls&quot; works; &quot;sudo -i&quot; works.  Bizarre stuff.

--- Additional comment from Daniel Walsh on 2016-04-20 09:15:47 EDT ---

Any AVC&apos;s?

Any AVC&apos;s if you disable dontaudit rules?

--- Additional comment from Robin Powell on 2016-04-20 13:50:15 EDT ---

Here&apos;s everything from my (somewhat noisy) audit log during a failed sudo run, with &quot;dontaudit off&quot; and &quot;setenforce 0&quot;:




type=AVC msg=audit(1461174570.403:6245): avc:  denied  { rlimitinh } for  pid=3450 comm=&quot;sudo&quot; scontext=staff_u:staff_r:staff_t:s0-s0:c0.c1023 tcontext=staff_u:staff_r:staff_sudo_t:s0-s0:c0.c1023 tclass=process permissive=1
type=AVC msg=audit(1461174570.403:6246): avc:  denied  { siginh } for  pid=3450 comm=&quot;sudo&quot; scontext=staff_u:staff_r:staff_t:s0-s0:c0.c1023 tcontext=staff_u:staff_r:staff_sudo_t:s0-s0:c0.c1023 tclass=process permissive=1
type=USER_CMD msg=audit(1461174570.417:6247): pid=3450 uid=1000 auid=1000 ses=19 subj=staff_u:staff_r:staff_sudo_t:s0-s0:c0.c1023 msg=&apos;cwd=&quot;/tmp/crap&quot; cmd=6C73202F746D702F63726170 terminal=pts/9 res=success&apos;
type=CRED_REFR msg=audit(1461174570.417:6248): pid=3450 uid=0 auid=1000 ses=19 subj=staff_u:staff_r:staff_sudo_t:s0-s0:c0.c1023 msg=&apos;op=PAM:setcred grantors=pam_env,pam_fprintd acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/9 res=success&apos;
type=USER_START msg=audit(1461174570.424:6249): pid=3450 uid=0 auid=1000 ses=19 subj=staff_u:staff_r:staff_sudo_t:s0-s0:c0.c1023 msg=&apos;op=PAM:session_open grantors=pam_keyinit,pam_limits,pam_keyinit,pam_limits,pam_systemd,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/9 res=success&apos;
type=USER_ROLE_CHANGE msg=audit(1461174570.425:6250): pid=3451 uid=0 auid=1000 ses=19 subj=staff_u:staff_r:staff_sudo_t:s0-s0:c0.c1023 msg=&apos;newrole: old-context=staff_u:staff_r:staff_t:s0-s0:c0.c1023 new-context=staff_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/9 res=success&apos;
type=USER_END msg=audit(1461174572.426:6251): pid=3450 uid=0 auid=1000 ses=19 subj=staff_u:staff_r:staff_sudo_t:s0-s0:c0.c1023 msg=&apos;op=PAM:session_close grantors=pam_keyinit,pam_limits,pam_keyinit,pam_limits,pam_systemd,pam_unix acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/9 res=success&apos;
type=CRED_DISP msg=audit(1461174572.426:6252): pid=3450 uid=0 auid=1000 ses=19 subj=staff_u:staff_r:staff_sudo_t:s0-s0:c0.c1023 msg=&apos;op=PAM:setcred grantors=pam_env,pam_fprintd acct=&quot;root&quot; exe=&quot;/usr/bin/sudo&quot; hostname=? addr=? terminal=/dev/pts/9 res=success&apos;

--- Additional comment from Robin Powell on 2016-04-22 03:10:07 EDT ---

Is there any further debugging I can provide of any kind?  Having a basically unusable sudo is ... distressing.

--- Additional comment from Daniel Kopeček on 2016-04-22 08:11:13 EDT ---

(In reply to Robin Powell from comment #5)
&gt; Is there any further debugging I can provide of any kind?  Having a
&gt; basically unusable sudo is ... distressing.

Hello, I would say this is a bug in sudo, not in the policy. However, I don&apos;t have a solid proof that yet.

I&apos;ll try to replicate the issue and debug it from there.

Have you used this setup with previous versions of sudo? Could this be a regression? Is so, that would help with hunting down the root cause of this.

--- Additional comment from Robin Powell on 2016-04-22 13:55:46 EDT ---

At this point I would also say that it also feels like a bug in sudo, because Permissive doesn&apos;t fix it, and it only happens when the command has an argument.

My sudo config did not change at all; the only thing that changed was going from F23 to Rawhide (rawhide as of a few days ago).

Here&apos;s a minimal test:

Defaults    env_reset
root    ALL=(ALL)    NOPASSWD: ALL
rlpowell    ALL=(ALL)    NOPASSWD: ALL

^^ that&apos;s my entire sudoers.

rlpowell@vrici&gt; sudo ls /tmp/ | wc -l
152
rlpowell@vrici&gt; sudo -r sysadm_r ls | wc -l
152
rlpowell@vrici&gt; sudo -r sysadm_r ls /tmp/
sudo: unable to execute /bin/ls: Bad address

--- Additional comment from Daniel Walsh on 2016-04-29 15:15:01 EDT ---

I am seeing the same issue on my Rawhide system. Was working fine on fedora 24.

--- Additional comment from Robin Powell on 2016-05-05 20:48:43 EDT ---

Anything I can do to help debug this?  It&apos;s really pretty unpleasant.

--- Additional comment from Robin Powell on 2016-05-11 11:40:11 EDT ---

*poke*

--- Additional comment from Daniel Kopeček on 2016-05-11 15:08:25 EDT ---

Hello,

(In reply to Robin Powell from comment #10)
&gt; *poke*

I&apos;ve found the bug that is causing this issue and reported upstream. If you&apos;d like, you can test this package with the proposed patch:

https://fedorapeople.org/~dkopecek/sudo/sudo-1.8.16-2.fc22.src.rpm

Anyway, once some variation of the fix is pushed upstream, I&apos;ll make an update in Fedora.

--- Additional comment from Daniel Kopeček on 2016-05-11 15:09 EDT ---



--- Additional comment from Daniel Kopeček on 2016-05-11 17:22:53 EDT ---

Fixed upstream:
https://www.sudo.ws/repos/sudo/rev/1246583c7c1f

--- Additional comment from Daniel Kopeček on 2016-05-12 03:36 EDT ---</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9319754</commentid>
    <comment_count>1</comment_count>
      <attachid>1156492</attachid>
    <who name="Daniel Kopeček">dkopecek</who>
    <bug_when>2016-05-12 03:49:27 -0400</bug_when>
    <thetext>Created attachment 1156492
upstream patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9319798</commentid>
    <comment_count>2</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-05-12 04:10:54 -0400</bug_when>
    <thetext>sudo-1.8.16-2.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-a04f1b9b97</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9322873</commentid>
    <comment_count>3</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-05-12 18:27:11 -0400</bug_when>
    <thetext>sudo-1.8.16-2.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-a04f1b9b97</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9323937</commentid>
    <comment_count>4</comment_count>
      <attachid>1157055</attachid>
    <who name="Daniel Kopeček">dkopecek</who>
    <bug_when>2016-05-13 05:31:52 -0400</bug_when>
    <thetext>Created attachment 1157055
proposed patch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9324167</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-05-13 07:34:31 -0400</bug_when>
    <thetext>sudo-1.8.16-3.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-5680e43366</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9326997</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-05-15 02:57:00 -0400</bug_when>
    <thetext>sudo-1.8.16-3.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-5680e43366</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9330448</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-05-16 12:18:39 -0400</bug_when>
    <thetext>sudo-1.8.16-3.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1156492</attachid>
            <date>2016-05-12 03:49:00 -0400</date>
            <delta_ts>2016-05-13 05:31:52 -0400</delta_ts>
            <desc>upstream patch</desc>
            <filename>sudo-1.8.16-seshargsfix.patch</filename>
            <type>text/plain</type>
            <size>1643</size>
            <attacher name="Daniel Kopeček">dkopecek</attacher>
            
              <data encoding="base64">ZGlmZiAtdXAgc3Vkby0xLjguMTYvc3JjL3NlbGludXguYy5zZXNoYXJnc2ZpeCBzdWRvLTEuOC4x
Ni9zcmMvc2VsaW51eC5jCi0tLSBzdWRvLTEuOC4xNi9zcmMvc2VsaW51eC5jLnNlc2hhcmdzZml4
CTIwMTYtMDMtMTcgMTc6MTM6MTAuMDAwMDAwMDAwICswMTAwCisrKyBzdWRvLTEuOC4xNi9zcmMv
c2VsaW51eC5jCTIwMTYtMDUtMTIgMDk6Mjk6MTQuNjg3MDE0NDYwICswMjAwCkBAIC0zNzgsNyAr
Mzc4LDcgQEAgc2VsaW51eF9leGVjdmUoaW50IGZkLCBjb25zdCBjaGFyICpwYXRoLAogewogICAg
IGNoYXIgKipuYXJndjsKICAgICBjb25zdCBjaGFyICpzZXNoOwotICAgIGludCBhcmdjLCBzZXJy
bm87CisgICAgaW50IGFyZ2MsIG5hcmdjLCBzZXJybm87CiAgICAgZGVidWdfZGVjbChzZWxpbnV4
X2V4ZWN2ZSwgU1VET19ERUJVR19TRUxJTlVYKQogCiAgICAgc2VzaCA9IHN1ZG9fY29uZl9zZXNo
X3BhdGgoKTsKQEAgLTQwOSw5ICs0MDksNyBAQCBzZWxpbnV4X2V4ZWN2ZShpbnQgZmQsIGNvbnN0
IGNoYXIgKnBhdGgsCiAgICAgICovCiAgICAgZm9yIChhcmdjID0gMDsgYXJndlthcmdjXSAhPSBO
VUxMOyBhcmdjKyspCiAJY29udGludWU7Ci0gICAgaWYgKGZkICE9IC0xKQotCWFyZ2MrKzsKLSAg
ICBuYXJndiA9IHJlYWxsb2NhcnJheShOVUxMLCBhcmdjICsgMiwgc2l6ZW9mKGNoYXIgKikpOwor
ICAgIG5hcmd2ID0gcmVhbGxvY2FycmF5KE5VTEwsIGFyZ2MgKyAzLCBzaXplb2YoY2hhciAqKSk7
CiAgICAgaWYgKG5hcmd2ID09IE5VTEwpIHsKIAlzdWRvX3dhcm54KFVfKCIlczogJXMiKSwgX19m
dW5jX18sIFVfKCJ1bmFibGUgdG8gYWxsb2NhdGUgbWVtb3J5IikpOwogCWRlYnVnX3JldHVybjsK
QEAgLTQyMCwxMyArNDE4LDEzIEBAIHNlbGludXhfZXhlY3ZlKGludCBmZCwgY29uc3QgY2hhciAq
cGF0aCwKIAluYXJndlswXSA9ICphcmd2WzBdID09ICctJyA/ICItc2VzaC1ub2V4ZWMiIDogInNl
c2gtbm9leGVjIjsKICAgICBlbHNlCiAJbmFyZ3ZbMF0gPSAqYXJndlswXSA9PSAnLScgPyAiLXNl
c2giIDogInNlc2giOwotICAgIGFyZ2MgPSAxOwotICAgIGlmIChmZCAhPSAtMSAmJiBhc3ByaW50
ZigmbmFyZ3ZbYXJnYysrXSwgIi0tZXhlY2ZkPSVkIiwgZmQpID09IC0xKSB7CisgICAgbmFyZ2Mg
PSAxOworICAgIGlmIChmZCAhPSAtMSAmJiBhc3ByaW50ZigmbmFyZ3ZbbmFyZ2MrK10sICItLWV4
ZWNmZD0lZCIsIGZkKSA9PSAtMSkgewogCXN1ZG9fd2FybngoVV8oIiVzOiAlcyIpLCBfX2Z1bmNf
XywgVV8oInVuYWJsZSB0byBhbGxvY2F0ZSBtZW1vcnkiKSk7CiAJZGVidWdfcmV0dXJuOwogICAg
IH0KLSAgICBuYXJndlthcmdjXSA9IChjaGFyICopcGF0aDsKLSAgICBtZW1jcHkoJm5hcmd2W2Fy
Z2MgKyAxXSwgJmFyZ3ZbYXJnY10sIGFyZ2MgKiBzaXplb2YoY2hhciAqKSk7IC8qIGNvcGllcyBO
VUxMICovCisgICAgbmFyZ3ZbbmFyZ2MrK10gPSAoY2hhciAqKXBhdGg7CisgICAgbWVtY3B5KCZu
YXJndltuYXJnY10sICZhcmd2W2FyZ2NdLCBhcmdjICogc2l6ZW9mKGNoYXIgKikpOyAvKiBjb3Bp
ZXMgTlVMTCAqLwogCiAgICAgLyogc2VzaCB3aWxsIGhhbmRsZSBub2V4ZWMgZm9yIHVzLiAqLwog
ICAgIHN1ZG9fZXhlY3ZlKC0xLCBzZXNoLCBuYXJndiwgZW52cCwgZmFsc2UpOwo=
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1157055</attachid>
            <date>2016-05-13 05:31:00 -0400</date>
            <delta_ts>2016-05-13 05:31:52 -0400</delta_ts>
            <desc>proposed patch</desc>
            <filename>sudo-1.8.16-seshargsfix.patch</filename>
            <type>text/plain</type>
            <size>1640</size>
            <attacher name="Daniel Kopeček">dkopecek</attacher>
            
              <data encoding="base64">ZGlmZiAtdXAgc3Vkby0xLjguMTYvc3JjL3NlbGludXguYy5zZXNoYXJnc2ZpeCBzdWRvLTEuOC4x
Ni9zcmMvc2VsaW51eC5jCi0tLSBzdWRvLTEuOC4xNi9zcmMvc2VsaW51eC5jLnNlc2hhcmdzZml4
CTIwMTYtMDMtMTcgMTc6MTM6MTAuMDAwMDAwMDAwICswMTAwCisrKyBzdWRvLTEuOC4xNi9zcmMv
c2VsaW51eC5jCTIwMTYtMDUtMTMgMTE6MTQ6MDQuNjI4Mjk2OTk2ICswMjAwCkBAIC0zNzgsNyAr
Mzc4LDcgQEAgc2VsaW51eF9leGVjdmUoaW50IGZkLCBjb25zdCBjaGFyICpwYXRoLAogewogICAg
IGNoYXIgKipuYXJndjsKICAgICBjb25zdCBjaGFyICpzZXNoOwotICAgIGludCBhcmdjLCBzZXJy
bm87CisgICAgaW50IGFyZ2MsIG5hcmdjLCBzZXJybm87CiAgICAgZGVidWdfZGVjbChzZWxpbnV4
X2V4ZWN2ZSwgU1VET19ERUJVR19TRUxJTlVYKQogCiAgICAgc2VzaCA9IHN1ZG9fY29uZl9zZXNo
X3BhdGgoKTsKQEAgLTQwOSw5ICs0MDksNyBAQCBzZWxpbnV4X2V4ZWN2ZShpbnQgZmQsIGNvbnN0
IGNoYXIgKnBhdGgsCiAgICAgICovCiAgICAgZm9yIChhcmdjID0gMDsgYXJndlthcmdjXSAhPSBO
VUxMOyBhcmdjKyspCiAJY29udGludWU7Ci0gICAgaWYgKGZkICE9IC0xKQotCWFyZ2MrKzsKLSAg
ICBuYXJndiA9IHJlYWxsb2NhcnJheShOVUxMLCBhcmdjICsgMiwgc2l6ZW9mKGNoYXIgKikpOwor
ICAgIG5hcmd2ID0gcmVhbGxvY2FycmF5KE5VTEwsIGFyZ2MgKyAzLCBzaXplb2YoY2hhciAqKSk7
CiAgICAgaWYgKG5hcmd2ID09IE5VTEwpIHsKIAlzdWRvX3dhcm54KFVfKCIlczogJXMiKSwgX19m
dW5jX18sIFVfKCJ1bmFibGUgdG8gYWxsb2NhdGUgbWVtb3J5IikpOwogCWRlYnVnX3JldHVybjsK
QEAgLTQyMCwxMyArNDE4LDEzIEBAIHNlbGludXhfZXhlY3ZlKGludCBmZCwgY29uc3QgY2hhciAq
cGF0aCwKIAluYXJndlswXSA9ICphcmd2WzBdID09ICctJyA/ICItc2VzaC1ub2V4ZWMiIDogInNl
c2gtbm9leGVjIjsKICAgICBlbHNlCiAJbmFyZ3ZbMF0gPSAqYXJndlswXSA9PSAnLScgPyAiLXNl
c2giIDogInNlc2giOwotICAgIGFyZ2MgPSAxOwotICAgIGlmIChmZCAhPSAtMSAmJiBhc3ByaW50
ZigmbmFyZ3ZbYXJnYysrXSwgIi0tZXhlY2ZkPSVkIiwgZmQpID09IC0xKSB7CisgICAgbmFyZ2Mg
PSAxOworICAgIGlmIChmZCAhPSAtMSAmJiBhc3ByaW50ZigmbmFyZ3ZbbmFyZ2MrK10sICItLWV4
ZWNmZD0lZCIsIGZkKSA9PSAtMSkgewogCXN1ZG9fd2FybngoVV8oIiVzOiAlcyIpLCBfX2Z1bmNf
XywgVV8oInVuYWJsZSB0byBhbGxvY2F0ZSBtZW1vcnkiKSk7CiAJZGVidWdfcmV0dXJuOwogICAg
IH0KLSAgICBuYXJndlthcmdjXSA9IChjaGFyICopcGF0aDsKLSAgICBtZW1jcHkoJm5hcmd2W2Fy
Z2MgKyAxXSwgJmFyZ3ZbYXJnY10sIGFyZ2MgKiBzaXplb2YoY2hhciAqKSk7IC8qIGNvcGllcyBO
VUxMICovCisgICAgbmFyZ3ZbbmFyZ2MrK10gPSAoY2hhciAqKXBhdGg7CisgICAgbWVtY3B5KCZu
YXJndltuYXJnY10sICZhcmd2WzFdLCBhcmdjICogc2l6ZW9mKGNoYXIgKikpOyAvKiBjb3BpZXMg
TlVMTCAqLwogCiAgICAgLyogc2VzaCB3aWxsIGhhbmRsZSBub2V4ZWMgZm9yIHVzLiAqLwogICAg
IHN1ZG9fZXhlY3ZlKC0xLCBzZXNoLCBuYXJndiwgZW52cCwgZmFsc2UpOwo=
</data>

          </attachment>
      

    </bug>

</bugzilla>