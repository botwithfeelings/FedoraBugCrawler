<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1319433</bug_id>
          
          <creation_ts>2016-03-19 22:06:00 -0400</creation_ts>
          <short_desc>fedpkg-1.22-2.fc24 : submitted buildSRPMFromSCM koji tasks fail</short_desc>
          <delta_ts>2016-03-31 16:31:06 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>fedpkg</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>high</priority>
          <bug_severity>high</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Rex Dieter">rdieter</reporter>
          <assigned_to name="Lubomír Sedlář">lsedlar</assigned_to>
          <cc>bochecha</cc>
    
    
    <cc>dennis</cc>
    
    
    <cc>honli</cc>
    
    
    <cc>ignatenko</cc>
    
    
    <cc>jfilak</cc>
    
    
    <cc>jgrulich</cc>
    
    
    <cc>kevin</cc>
    
    
    <cc>limburgher</cc>
    
    
    <cc>lsedlar</cc>
    
    
    <cc>mcepl</cc>
    
    
    <cc>mtasaka</cc>
    
    
    <cc>pbabinca</cc>
    
    
    <cc>s</cc>
    
    
    <cc>vondruch</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>fedpkg-1.22-3.fc24</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-03-31 16:31:06</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9162204</commentid>
    <comment_count>0</comment_count>
    <who name="Rex Dieter">rdieter</who>
    <bug_when>2016-03-19 22:06:11 -0400</bug_when>
    <thetext>Using 
fedpkg-1.22-2.fc24
rpkg-1.42-1.fc24

all builds submitted to koji fail at buildSRPMFromSCM step.

Example,
https://koji.fedoraproject.org/koji/taskinfo?taskID=13389643 

Seems it is due to an extra &apos;/&apos; inserted between host and module name:

git clone -n git://pkgs.fedoraproject.org//qt5-qtenginio ... =&gt; fatal: remote error: access denied or repository not exported: //qt5-qtenginio

Previous fedpkg (and rpkg) didn&apos;t have this extra /, and the koji task succeeds.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9162359</commentid>
    <comment_count>1</comment_count>
    <who name="Igor Gnatenko">ignatenko</who>
    <bug_when>2016-03-20 04:04:37 -0400</bug_when>
    <thetext>In my case it adds &quot;/rpms/&quot; for normal packages which fails.

Something totally wrong with that namespaces.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9162505</commentid>
    <comment_count>2</comment_count>
    <who name="Lubomír Sedlář">lsedlar</who>
    <bug_when>2016-03-20 08:06:39 -0400</bug_when>
    <thetext>This is partly a problem with rpkg in that it doubles the slash. This only happens if your git checkout predates dist-git namespaces. With new checkouts, the git config has the url with namespace, in which case rpkg (and in turn fedpkg) will use it, ultimately leading to the behaviour Igor observed.

There is a separate problem with dist-git: it should be publishing the repos under the namespace, but for some reason it does not. I have opened another issue about that:
https://fedorahosted.org/fedora-infrastructure/ticket/5178</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9165315</commentid>
    <comment_count>3</comment_count>
    <who name="Honggang LI">honli</who>
    <bug_when>2016-03-21 11:25:29 -0400</bug_when>
    <thetext>http://koji.fedoraproject.org/koji/taskinfo?taskID=13411833
https://kojipkgs.fedoraproject.org//work/tasks/1833/13411833/checkout.log

$ git clone -n git://pkgs.fedoraproject.org/librdmacm /var/lib/mock/f23-build-5233093-592286/root/tmp/scmroot/librdmacm
Cloning into &apos;/var/lib/mock/f23-build-5233093-592286/root/tmp/scmroot/librdmacm&apos;...
fatal: remote error: access denied or repository not exported: /librdmacm

--------------------------------------------
This is a blocker issue. Please fix it ASAP. Thanks</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9165376</commentid>
    <comment_count>4</comment_count>
    <who name="Kevin Fenzi">kevin</who>
    <bug_when>2016-03-21 11:41:47 -0400</bug_when>
    <thetext>Please resubmit your build. It looks like it was added when we were trying to get both new and old urls working, but that didn&apos;t work, so we reverted it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9165568</commentid>
    <comment_count>5</comment_count>
    <who name="Honggang LI">honli</who>
    <bug_when>2016-03-21 12:24:05 -0400</bug_when>
    <thetext>http://koji.fedoraproject.org/koji/buildinfo?buildID=747280
http://koji.fedoraproject.org/koji/buildinfo?buildID=747273

It works again. Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9166583</commentid>
    <comment_count>6</comment_count>
    <who name="Kevin Fenzi">kevin</who>
    <bug_when>2016-03-21 16:50:41 -0400</bug_when>
    <thetext>So, we fixed the /rpms/ thing on the server side now. 

However there&apos;s still the // thing. I guess the workaround is to do a fresh clone, but it would be nice if fedpkg fixes this case.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9172830</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-03-23 09:30:30 -0400</bug_when>
    <thetext>fedpkg-1.22-3.fc24 rpkg-1.43-1.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-0b0aabf419</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9174181</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-03-23 15:55:34 -0400</bug_when>
    <thetext>fedpkg-1.22-3.fc24, rpkg-1.43-1.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-0b0aabf419</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9197669</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-03-31 16:30:59 -0400</bug_when>
    <thetext>fedpkg-1.22-3.fc24, rpkg-1.43-1.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>