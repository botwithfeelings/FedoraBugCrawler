<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1288712</bug_id>
          
          <creation_ts>2015-12-05 08:23:00 -0500</creation_ts>
          <short_desc>Fix for HP8200 scanners: ADF infinite loop [patch]</short_desc>
          <delta_ts>2017-05-19 18:54:09 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>sane-backends</component>
          <version>24</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Thibault North">thibault.north</reporter>
          <assigned_to name="Nils Philippsen">nphilipp</assigned_to>
          <cc>nphilipp</cc>
    
    
    <cc>organicchemistry_01</cc>
    
    
    <cc>thibault.north</cc>
    
    
    <cc>zdohnal</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>sane-backends-1.0.25-6.fc25 sane-backends-1.0.25-6.fc26 sane-backends-1.0.25-7.fc24</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-04-01 13:06:24</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>8892904</commentid>
    <comment_count>0</comment_count>
      <attachid>1102523</attachid>
    <who name="Thibault North">thibault.north</who>
    <bug_when>2015-12-05 08:23:36 -0500</bug_when>
    <thetext>Created attachment 1102523
Patch against sane-backends

Description of problem:

Without the attached patch, sane is stuck in a loop and can&apos;t scan. The output of scanimage is:
$ scanimage --device avision:libusb:004:003 --format=tiff &gt; test.tiff
scanimage: open of device avision:libusb:004:003 failed: Operation not supported

Version-Release number of selected component (if applicable):
sane-backends-1.0.25-1

Steps to Reproduce:
1. Find a ScanJet 8200 from HP...
2. run scanimage --device &lt;the device from scanimage -L&gt; --format=tiff &gt; test.tiff

Actual results:
Operation not supported (timeout?)

Expected results:
test.tiff.

Additional info:
This patch was adapted from https://bugzilla.novell.com/show_bug.cgi?id=840443 and rebased against sane-backends-1.0.25

Attached patch works for me.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9603424</commentid>
    <comment_count>1</comment_count>
    <who name="Thibault North">thibault.north</who>
    <bug_when>2016-08-10 11:41:43 -0400</bug_when>
    <thetext>The problem still exists with Fedora 24.

Unless there is a reason/opposition to this patch, I&apos;m ready to request ACLs to apply it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9792836</commentid>
    <comment_count>2</comment_count>
    <who name="Nils Philippsen">nphilipp</who>
    <bug_when>2016-10-14 11:34:51 -0400</bug_when>
    <thetext>Hey Thibault, sorry for the lack of response from my side so far!

I&apos;d gladly accept help maintaining the sane-backends component. If that&apos;s what you mean, please check the relevant boxes here:

https://admin.fedoraproject.org/pkgdb/package/rpms/sane-backends/

Regarding the patch you attached, I have reservations about enabling the option as a default, I suspect that only certain devices show the error you experience. Can you take this upstream -- http://sane-project.org -- and we apply the patch without making the option enabled by default in the interim?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9876708</commentid>
    <comment_count>3</comment_count>
    <who name="Zdenek Dohnal">zdohnal</who>
    <bug_when>2016-11-09 11:47:02 -0500</bug_when>
    <thetext>*** Bug 1392712 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9876919</commentid>
    <comment_count>4</comment_count>
    <who name="Thibault North">thibault.north</who>
    <bug_when>2016-11-09 12:34:09 -0500</bug_when>
    <thetext>Hi Nils,

Ok, I&apos;ll check upstream.
I&apos;ll apply for ACLs and push the fix - disabling it by default sound like a reasonable option.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10003113</commentid>
    <comment_count>5</comment_count>
    <who name="Nils Philippsen">nphilipp</who>
    <bug_when>2016-12-20 08:54:16 -0500</bug_when>
    <thetext>Hi Thibault! Any news from upstream about this?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10003473</commentid>
    <comment_count>6</comment_count>
    <who name="Thibault North">thibault.north</who>
    <bug_when>2016-12-20 09:23:34 -0500</bug_when>
    <thetext>Hi Nils,

Looks like a fix was commited upstream:

&quot;&quot;&quot;
commit 6585b6f60d07a196e42c99b935e2754bbc80b3c8
Author: Dave Platt &lt;dplatt@radagast.org&gt;
Date:   Thu Dec 15 22:29:16 2016 -0800

    avision.c: Add &quot;skip-adf&quot; option
    
    The code which tries aggressively to reset/initialize HP 82xx/83xx
    Automatic Document Feeders doesn&apos;t work well if there&apos;s no ADF attached,
    because the scanner reports a non-zero ADF model type in this case.
    The retry code makes several attempts to initialize the ADF, and then
    bails out with an &quot;Operation not supported&quot; error.
    
    Add a new &quot;option skip-adf&quot; which will cause the backend to believe
    the &quot;ADF not present&quot; status if that&apos;s what the scanner reports.
    
    Fixes #313751
&quot;&quot;&quot;

See https://alioth.debian.org/tracker/?group_id=30186&amp;atid=410366&amp;func=detail&amp;aid=313751

The patch can most likely be backported as a patch before this fix makes it into a new release of sane-backends. What do you think?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10018778</commentid>
    <comment_count>7</comment_count>
    <who name="Nils Philippsen">nphilipp</who>
    <bug_when>2016-12-23 13:29:11 -0500</bug_when>
    <thetext>Hi Thibault,

that sounds fine to me! I&apos;m on vacation until after New Year, so if you want to give it a go...? You seem to be set as far as co-maintainer permissions are concerned. Otherwise I can do it when I return.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10238603</commentid>
    <comment_count>8</comment_count>
    <who name="Nils Philippsen">nphilipp</who>
    <bug_when>2017-03-14 12:41:49 -0400</bug_when>
    <thetext>This has been laying around too long already, I&apos;ll build it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10238661</commentid>
    <comment_count>9</comment_count>
    <who name="Thibault North">thibault.north</who>
    <bug_when>2017-03-14 13:04:27 -0400</bug_when>
    <thetext>Thanks. I couldn&apos;t find time for this unfortunately.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10240954</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-15 05:25:44 -0400</bug_when>
    <thetext>sane-backends-1.0.25-6.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-8d1ecdf7e2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10240955</commentid>
    <comment_count>11</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-15 05:25:53 -0400</bug_when>
    <thetext>sane-backends-1.0.25-6.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-d969db6151</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10240956</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-15 05:25:59 -0400</bug_when>
    <thetext>sane-backends-1.0.25-6.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-8964acb82a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10240961</commentid>
    <comment_count>13</comment_count>
    <who name="Nils Philippsen">nphilipp</who>
    <bug_when>2017-03-15 05:28:12 -0400</bug_when>
    <thetext>(In reply to Thibault North from comment #9)
&gt; Thanks. I couldn&apos;t find time for this unfortunately.

Me neither until now, no worries. But you can test it ;).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10241084</commentid>
    <comment_count>14</comment_count>
    <who name="Thibault North">thibault.north</who>
    <bug_when>2017-03-15 05:48:06 -0400</bug_when>
    <thetext>I&apos;d love to, but this scanner is now 700 km south from me.
Once I am able to reach it (with or without proxy :)) i&apos;ll give it a try!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10243358</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-15 15:56:28 -0400</bug_when>
    <thetext>sane-backends-1.0.25-6.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-d969db6151</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10243389</commentid>
    <comment_count>16</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-15 15:58:41 -0400</bug_when>
    <thetext>sane-backends-1.0.25-6.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-8d1ecdf7e2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10244095</commentid>
    <comment_count>17</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-15 20:49:27 -0400</bug_when>
    <thetext>sane-backends-1.0.25-6.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-8964acb82a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10257713</commentid>
    <comment_count>18</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-20 23:20:44 -0400</bug_when>
    <thetext>sane-backends-1.0.25-6.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10269424</commentid>
    <comment_count>19</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-23 08:07:12 -0400</bug_when>
    <thetext>sane-backends-1.0.25-7.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-0f5fe1913f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10276127</commentid>
    <comment_count>20</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-24 15:52:21 -0400</bug_when>
    <thetext>sane-backends-1.0.25-7.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-0f5fe1913f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10296700</commentid>
    <comment_count>21</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-01 13:06:24 -0400</bug_when>
    <thetext>sane-backends-1.0.25-6.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10430396</commentid>
    <comment_count>22</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-19 18:54:09 -0400</bug_when>
    <thetext>sane-backends-1.0.25-7.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1102523</attachid>
            <date>2015-12-05 08:23:00 -0500</date>
            <delta_ts>2015-12-05 08:23:36 -0500</delta_ts>
            <desc>Patch against sane-backends</desc>
            <filename>sane-backends-1.0.24-adf-loop.patch</filename>
            <type>text/plain</type>
            <size>1917</size>
            <attacher name="Thibault North">thibault.north</attacher>
            
              <data encoding="base64">UGF0Y2ggYnkgUGkgTnksIHNlZSBodHRwczovL2J1Z3ppbGxhLm5vdmVsbC5jb20vc2hvd19idWcu
Y2dpP2lkPTg0MDQ0MwoKLS0tIGEvYmFja2VuZC9hdmlzaW9uLmMub2xkCTIwMTMtMDgtMjUgMTc6
MjI6NTguMDAwMDAwMDAwIC0wNDAwCisrKyBiL2JhY2tlbmQvYXZpc2lvbi5jCTIwMTQtMDUtMTYg
MTI6NTc6NTIuODE4NjA5MTUzIC0wNDAwCkBAIC0xMjczLDYgKzEyNzMsMTMgQEAKIHN0YXRpYyBT
QU5FX0Jvb2wgZm9yY2VfYTQgPSBTQU5FX0ZBTFNFOwogc3RhdGljIFNBTkVfQm9vbCBmb3JjZV9h
MyA9IFNBTkVfRkFMU0U7CiAKKworLyogPDIwMTMtMDktMTVfUE51PgorKiBIUCBTY2FuamV0IDgy
MDAgdy9vIEFERiBmYWlscyBkdXJpbmcgdGhlIEFERiByZXNldCBsb29wIGluIGdldF9hY2Nlc3Nv
cmllc19pbmZvKCkKKyogQnJ1dGUgZm9yY2Ugb3B0aW9uIGVuZm9yY2Utbm8tYWRmCisqLworc3Rh
dGljIFNBTkVfQm9vbCBlbmZvcmNlX25vX2FkZiA9IFNBTkVfRkFMU0U7CisKIC8qIGhhcmR3YXJl
IHJlc29sdXRpb25zIHRvIGludGVycG9sYXRlIGZyb20gKi8KIHN0YXRpYyBjb25zdCBpbnQgIGh3
X3Jlc19saXN0X2M1W10gPQogICB7CkBAIC0zMjA3LDYgKzMyMTQsMTcgQEAKICAgICAgICBhZGZf
bW9kZWxbIChyZXN1bHRbMl0gPCBhZGZfbW9kZWxzKSA/IHJlc3VsdFsyXSA6IGFkZl9tb2RlbHMg
XSk7CiAKICAgZGV2LT5pbnF1aXJ5X2FkZiB8PSByZXN1bHQgWzBdOworICAKKyAgIC8qIDwyMDEz
LTA5LTE1X1BOdT4KKyAgICAqIEhQIFNjYW5qZXQgODIwMCB3L28gQURGIGZhaWxzIGR1cmluZyB0
aGUgZm9sbG93aW5nIEFERiByZXNldCBsb29wCisgICAgKi8KKyAgIGlmIChlbmZvcmNlX25vX2Fk
ZikgeworICAgICBpZiAocmVzdWx0WzBdID09IDApIHsKKyAgICAgICByZXN1bHRbMl0gPSAwOyAv
KiB0byBwcmV2ZW50IGZhaWwgb2YgZm9sbG93aW5nIGxvb3AgKi8KKyAgICAgICBEQkcgKDMsICJn
ZXRfYWNjZXNzb3JpZXNfaW5mbzogbm8gYWRmIGVuZm9yY2VkIVxuIik7CisgICAgIH0KKyAgIH0K
KyAgIC8qIDwvMjAxMy0wOS0xNV9QTnU+ICovCiAKICAgaWYgKGRldi0+aHctPmZlYXR1cmVfdHlw
ZSAmIEFWX0FERl9GTElQUElOR19EVVBMRVgpCiAgIHsKQEAgLTc2MzcsNiArNzY1NSwxNCBAQAog
CQkgICAgbGluZW51bWJlcik7CiAJCXN0YXRpY19jYWxpYl9saXN0IFsyXSA9IFNBTkVfVFJVRTsg
CiAJICAgICAgfQorCSAgICAgIGVsc2UgaWYgKHN0cmNtcCAod29yZCwgImVuZm9yY2Utbm8tYWRm
IikgPT0gMCkgeworICAgICAgICAgIC8qIDwyMDEzLTA5LTE1X1BOdT4KKyAgICAgICAgICAqIEJy
dXRlIGZvcmNlIG9wdGlvbiBlbmZvcmNlLW5vLWFkZgorICAgICAgICAgICovCisgICAgICAgICAg
REJHICgzLCAic2FuZV9yZWxvYWRfZGV2aWNlczogY29uZmlnIGZpbGUgbGluZSAlZDogZW5mb3Jj
ZS1uby1hZGZcbiIsCisgICAgICAgICAgIGxpbmVudW1iZXIpOworICAgICAgICAgIGVuZm9yY2Vf
bm9fYWRmID0gU0FORV9UUlVFOyAKKyAgICAgICAgICB9CiAJICAgICAgZWxzZQogCQlEQkcgKDEs
ICJzYW5lX3JlbG9hZF9kZXZpY2VzOiBjb25maWcgZmlsZSBsaW5lICVkOiBvcHRpb25zIHVua25v
d24hXG4iLAogCQkgICAgbGluZW51bWJlcik7CgotLS0gYS9iYWNrZW5kL2F2aXNpb24uY29uZi5p
bi5vcmlnICAgICAgICAyMDE0LTA1LTE3IDA0OjM3OjA0LjUxNjE4MzI1MyAtMDQwMAorKysgYi9i
YWNrZW5kL2F2aXNpb24uY29uZi5pbiAgICAgMjAxNC0wNS0xNyAwNDozNzoyOS41MTUyMjk1NTMg
LTA0MDAKQEAgLTgsNiArOCw3IEBACiAjb3B0aW9uIGRpc2FibGUtZ2FtbWEtdGFibGUKICNvcHRp
b24gZGlzYWJsZS1jYWxpYnJhdGlvbgogI29wdGlvbiBmb3JjZS1hNAorb3B0aW9uIGVuZm9yY2Ut
bm8tYWRmCiAKICNzY3NpIEFWSVNJT04KICNzY3NpIEZDUEEK
</data>

          </attachment>
      

    </bug>

</bugzilla>