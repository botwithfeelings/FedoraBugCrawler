<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1339383</bug_id>
          
          <creation_ts>2016-05-24 16:49:00 -0400</creation_ts>
          <short_desc>ThinkPad X1 Carbon 4th generation freezes hard; SysRq crash combo does nothing</short_desc>
          <delta_ts>2016-09-26 17:08:08 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>kernel</component>
          <version>24</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>CURRENTRELEASE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>urgent</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jeff Gehlbach">jeffg</reporter>
          <assigned_to name="Kernel Maintainer List">kernel-maint</assigned_to>
          <cc>gansalmon</cc>
    
    
    <cc>itamar</cc>
    
    
    <cc>jeffg</cc>
    
    
    <cc>jonathan</cc>
    
    
    <cc>kernel-maint</cc>
    
    
    <cc>madhu.chinakonda</cc>
    
    
    <cc>mchehab</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-09-26 17:08:08</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9355677</commentid>
    <comment_count>0</comment_count>
    <who name="Jeff Gehlbach">jeffg</who>
    <bug_when>2016-05-24 16:49:57 -0400</bug_when>
    <thetext>Description of problem:

Running F24-beta on a new ThinkPad X1 Carbon 4th generation. Sometimes the system freezes very hard and must be powered off with a 10-second power button press. It&apos;s so deeply frozen that even SysRq-c will not trigger a crash dump. The freeze usually time-correlates with plugging in an external monitor to the built-in Mini DisplayPort or HDMI interfaces, but it has also happened independent of any peripheral connect / disconnect.

Version-Release number of selected component (if applicable):

Observed on kernels 4.5.4-300.fc24.x86_64 and 4.5.5-300.fc24.x86_64

How reproducible:

Usually

Steps to Reproduce:
1. Power on the system and log in to GNOME 3
2. Enable Magic SysRq (# echo 1 &gt; /proc/sys/kernel/sysrq)
3. Connect an external monitor to the Mini DisplayPort or HDMI connector

Actual results:

Super hard freeze such that Ctrl+Alt+PrtSc+c does nothing (I verified that this is the correct key combo and produces a crash record in /var/crash when the system is not frozen)

Expected results:

System does not freeze

Additional info:

I&apos;m not attached to the installation and am happy to trash it, install rawhide, and do anything else that will not physically damage the hardware if it will help. My comfort level with kernel stuff might be summed up as &quot;I know what mrproper means, but haven&apos;t built a kernel since that was a thing, and I don&apos;t mind doing it again if it will help.&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9355816</commentid>
    <comment_count>1</comment_count>
    <who name="Jeff Gehlbach">jeffg</who>
    <bug_when>2016-05-24 17:58:02 -0400</bug_when>
    <thetext>I&apos;ve found that if I take the system to the multi-user target (rather than graphical) I can plug and unplug external monitors at will with no freezing. I found the following interesting-looking traces in the output of journalctl -k after doing a few plug / unplugs to the Mini DisplayPort and HDMI connectors. I don&apos;t know whether they&apos;re at all helpful, but here they are.


May 24 17:47:29 monkeyfaced.opennms.com kernel: ------------[ cut here ]------------
May 24 17:47:29 monkeyfaced.opennms.com kernel: WARNING: CPU: 0 PID: 195 at drivers/gpu/drm/i915/intel_pm.c:3554 skl_update_other_pipe_wm+0x16c/0x180 [i915]()
May 24 17:47:29 monkeyfaced.opennms.com kernel: WARN_ON(!wm_changed)
May 24 17:47:29 monkeyfaced.opennms.com kernel: Modules linked in:
May 24 17:47:29 monkeyfaced.opennms.com kernel:  ccm xt_CHECKSUM ipt_MASQUERADE nf_nat_masquerade_ipv4 tun nf_conntrack_netbios_ns nf_conntrack_broadcast ip6t_rpfilter ip6t_REJECT nf_reject_ipv6 xt_conntrack ip_set nfnetlink ebtable_broute bridge ebtable_nat ip6table_mangle ip6table_raw ip6table_nat nf_conntrack_ipv6 nf_defrag_ipv6 nf_nat_ipv6 ip6table_security iptable_mangle iptable_raw iptable_nat nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat nf_conntrack iptable_security ebtable_filter ebtables ip6table_filter ip6_tables bnep vfat fat arc4 snd_soc_skl snd_soc_skl_ipc snd_soc_sst_ipc snd_soc_sst_dsp snd_hda_ext_core intel_rapl snd_soc_sst_match snd_soc_core x86_pkg_temp_thermal snd_hda_codec_hdmi snd_hda_codec_conexant coretemp kvm_intel snd_hda_codec_generic snd_compress iTCO_wdt iwlmvm iTCO_vendor_support snd_pcm_dmaengine
May 24 17:47:29 monkeyfaced.opennms.com kernel:  ac97_bus snd_hda_intel acer_wmi kvm snd_hda_codec uvcvideo sparse_keymap mac80211 snd_hda_core snd_hwdep videobuf2_vmalloc videobuf2_memops snd_seq videobuf2_v4l2 videobuf2_core snd_seq_device videodev snd_pcm btusb irqbypass iwlwifi btrtl btbcm rtsx_pci_ms btintel media cfg80211 bluetooth joydev thinkpad_acpi snd_timer memstick mei_me i2c_i801 mei tpm_crb snd shpchp soundcore rfkill tpm_tis tpm nfsd nfs_acl lockd auth_rpcgss grace dm_crypt 8021q garp stp llc mrp i915 rtsx_pci_sdmmc mmc_core crct10dif_pclmul crc32_pclmul i2c_algo_bit drm_kms_helper crc32c_intel drm e1000e ghash_clmulni_intel serio_raw ptp nvme pps_core rtsx_pci wmi video fjes sunrpc scsi_transport_iscsi
May 24 17:47:29 monkeyfaced.opennms.com kernel: CPU: 0 PID: 195 Comm: kworker/0:2 Not tainted 4.5.5-300.fc24.x86_64 #1
May 24 17:47:29 monkeyfaced.opennms.com kernel: Hardware name: LENOVO 20FBCTO1WW/20FBCTO1WW, BIOS N1FET38W (1.12 ) 03/30/2016
May 24 17:47:29 monkeyfaced.opennms.com kernel: Workqueue: events i915_hotplug_work_func [i915]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  0000000000000286 00000000086d6449 ffff880408453930 ffffffff813d35af
May 24 17:47:29 monkeyfaced.opennms.com kernel:  ffff880408453978 ffffffffa02d97f8 ffff880408453968 ffffffff810a5f12
May 24 17:47:29 monkeyfaced.opennms.com kernel:  ffff88003f97f000 ffff88003fb39bd4 ffff88003f97d000 ffff880407caeba8
May 24 17:47:29 monkeyfaced.opennms.com kernel: Call Trace:
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffff813d35af&gt;] dump_stack+0x63/0x84
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810a5f12&gt;] warn_slowpath_common+0x82/0xc0
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810a5fac&gt;] warn_slowpath_fmt+0x5c/0x80
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa02106ac&gt;] skl_update_other_pipe_wm+0x16c/0x180 [i915]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa021083c&gt;] skl_update_wm+0x17c/0x610 [i915]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa029d2bf&gt;] ? intel_ddi_enable_transcoder_func+0x17f/0x260 [i915]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa021422e&gt;] intel_update_watermarks+0x1e/0x30 [i915]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0280592&gt;] haswell_crtc_enable+0x322/0x8d0 [i915]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa027bed6&gt;] intel_atomic_commit+0x776/0x1860 [i915]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0141362&gt;] ? drm_atomic_check_only+0x182/0x600 [drm]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0140bb7&gt;] ? drm_atomic_set_crtc_for_connector+0x57/0xe0 [drm]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0141817&gt;] drm_atomic_commit+0x37/0x60 [drm]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b17c8&gt;] restore_fbdev_mode+0x238/0x260 [drm_kms_helper]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b3984&gt;] drm_fb_helper_restore_fbdev_mode_unlocked+0x34/0x80 [drm_kms_helper]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b39fd&gt;] drm_fb_helper_set_par+0x2d/0x50 [drm_kms_helper]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b3902&gt;] drm_fb_helper_hotplug_event+0xd2/0x120 [drm_kms_helper]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa029432e&gt;] intel_fbdev_output_poll_changed+0x1e/0x30 [i915]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01a6717&gt;] drm_kms_helper_hotplug_event+0x27/0x30 [drm_kms_helper]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa028a091&gt;] i915_hotplug_work_func+0x201/0x2c0 [i915]
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810be7e4&gt;] process_one_work+0x184/0x440
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaee&gt;] worker_thread+0x4e/0x480
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaa0&gt;] ? process_one_work+0x440/0x440
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaa0&gt;] ? process_one_work+0x440/0x440
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c49c8&gt;] kthread+0xd8/0xf0
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c48f0&gt;] ? kthread_worker_fn+0x180/0x180
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffff817cf03f&gt;] ret_from_fork+0x3f/0x70
May 24 17:47:29 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c48f0&gt;] ? kthread_worker_fn+0x180/0x180
May 24 17:47:29 monkeyfaced.opennms.com kernel: ---[ end trace 4f8e03c451afde80 ]---




May 24 17:47:57 monkeyfaced.opennms.com kernel: ------------[ cut here ]------------
May 24 17:47:57 monkeyfaced.opennms.com kernel: WARNING: CPU: 2 PID: 3004 at drivers/gpu/drm/i915/intel_pm.c:3554 skl_update_other_pipe_wm+0x16c/0x180 [i915]()
May 24 17:47:57 monkeyfaced.opennms.com kernel: WARN_ON(!wm_changed)
May 24 17:47:57 monkeyfaced.opennms.com kernel: Modules linked in:
May 24 17:47:57 monkeyfaced.opennms.com kernel:  asix usbnet mii hid_lenovo ccm xt_CHECKSUM ipt_MASQUERADE nf_nat_masquerade_ipv4 tun nf_conntrack_netbios_ns nf_conntrack_broadcast ip6t_rpfilter ip6t_REJECT nf_reject_ipv6 xt_conntrack ip_set nfnetlink ebtable_broute bridge ebtable_nat ip6table_mangle ip6table_raw ip6table_nat nf_conntrack_ipv6 nf_defrag_ipv6 nf_nat_ipv6 ip6table_security iptable_mangle iptable_raw iptable_nat nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat nf_conntrack iptable_security ebtable_filter ebtables ip6table_filter ip6_tables bnep vfat fat arc4 snd_soc_skl snd_soc_skl_ipc snd_soc_sst_ipc snd_soc_sst_dsp snd_hda_ext_core intel_rapl snd_soc_sst_match snd_soc_core x86_pkg_temp_thermal snd_hda_codec_hdmi snd_hda_codec_conexant coretemp kvm_intel snd_hda_codec_generic snd_compress iTCO_wdt iwlmvm iTCO_vendor_support
May 24 17:47:57 monkeyfaced.opennms.com kernel:  snd_pcm_dmaengine ac97_bus snd_hda_intel acer_wmi kvm snd_hda_codec uvcvideo sparse_keymap mac80211 snd_hda_core snd_hwdep videobuf2_vmalloc videobuf2_memops snd_seq videobuf2_v4l2 videobuf2_core snd_seq_device videodev snd_pcm btusb irqbypass iwlwifi btrtl btbcm rtsx_pci_ms btintel media cfg80211 bluetooth joydev thinkpad_acpi snd_timer memstick mei_me i2c_i801 mei tpm_crb snd shpchp soundcore rfkill tpm_tis tpm nfsd nfs_acl lockd auth_rpcgss grace dm_crypt 8021q garp stp llc mrp i915 rtsx_pci_sdmmc mmc_core crct10dif_pclmul crc32_pclmul i2c_algo_bit drm_kms_helper crc32c_intel drm e1000e ghash_clmulni_intel serio_raw ptp nvme pps_core rtsx_pci wmi video fjes sunrpc scsi_transport_iscsi
May 24 17:47:57 monkeyfaced.opennms.com kernel: CPU: 2 PID: 3004 Comm: kworker/2:5 Tainted: G        W       4.5.5-300.fc24.x86_64 #1
May 24 17:47:57 monkeyfaced.opennms.com kernel: Hardware name: LENOVO 20FBCTO1WW/20FBCTO1WW, BIOS N1FET38W (1.12 ) 03/30/2016
May 24 17:47:57 monkeyfaced.opennms.com kernel: Workqueue: events i915_hotplug_work_func [i915]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  0000000000000286 00000000a967d999 ffff880404f739a0 ffffffff813d35af
May 24 17:47:57 monkeyfaced.opennms.com kernel:  ffff880404f739e8 ffffffffa02d97f8 ffff880404f739d8 ffffffff810a5f12
May 24 17:47:57 monkeyfaced.opennms.com kernel:  ffff88003f97f000 ffff88003fb39bd4 ffff88003f97d000 ffff880407caeba8
May 24 17:47:57 monkeyfaced.opennms.com kernel: Call Trace:
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff813d35af&gt;] dump_stack+0x63/0x84
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810a5f12&gt;] warn_slowpath_common+0x82/0xc0
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810a5fac&gt;] warn_slowpath_fmt+0x5c/0x80
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa02106ac&gt;] skl_update_other_pipe_wm+0x16c/0x180 [i915]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa021083c&gt;] skl_update_wm+0x17c/0x610 [i915]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff817cc942&gt;] ? mutex_lock+0x12/0x30
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0288ea5&gt;] ? intel_fbc_disable_crtc+0x45/0xb0 [i915]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa021422e&gt;] intel_update_watermarks+0x1e/0x30 [i915]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa027bf37&gt;] intel_atomic_commit+0x7d7/0x1860 [i915]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0141362&gt;] ? drm_atomic_check_only+0x182/0x600 [drm]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0140b8f&gt;] ? drm_atomic_set_crtc_for_connector+0x2f/0xe0 [drm]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0141817&gt;] drm_atomic_commit+0x37/0x60 [drm]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b17c8&gt;] restore_fbdev_mode+0x238/0x260 [drm_kms_helper]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b3984&gt;] drm_fb_helper_restore_fbdev_mode_unlocked+0x34/0x80 [drm_kms_helper]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b39fd&gt;] drm_fb_helper_set_par+0x2d/0x50 [drm_kms_helper]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b3902&gt;] drm_fb_helper_hotplug_event+0xd2/0x120 [drm_kms_helper]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa029432e&gt;] intel_fbdev_output_poll_changed+0x1e/0x30 [i915]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01a6717&gt;] drm_kms_helper_hotplug_event+0x27/0x30 [drm_kms_helper]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa028a091&gt;] i915_hotplug_work_func+0x201/0x2c0 [i915]
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810be7e4&gt;] process_one_work+0x184/0x440
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaee&gt;] worker_thread+0x4e/0x480
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaa0&gt;] ? process_one_work+0x440/0x440
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaa0&gt;] ? process_one_work+0x440/0x440
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c49c8&gt;] kthread+0xd8/0xf0
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c48f0&gt;] ? kthread_worker_fn+0x180/0x180
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff817cf03f&gt;] ret_from_fork+0x3f/0x70
May 24 17:47:57 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c48f0&gt;] ? kthread_worker_fn+0x180/0x180
May 24 17:47:57 monkeyfaced.opennms.com kernel: ---[ end trace 4f8e03c451afde82 ]---




May 24 17:48:08 monkeyfaced.opennms.com kernel: ------------[ cut here ]------------
May 24 17:48:08 monkeyfaced.opennms.com kernel: WARNING: CPU: 2 PID: 3004 at drivers/gpu/drm/i915/intel_pm.c:3554 skl_update_other_pipe_wm+0x16c/0x180 [i915]()
May 24 17:48:08 monkeyfaced.opennms.com kernel: WARN_ON(!wm_changed)
May 24 17:48:08 monkeyfaced.opennms.com kernel: Modules linked in:
May 24 17:48:08 monkeyfaced.opennms.com kernel:  asix usbnet mii hid_lenovo ccm xt_CHECKSUM ipt_MASQUERADE nf_nat_masquerade_ipv4 tun nf_conntrack_netbios_ns nf_conntrack_broadcast ip6t_rpfilter ip6t_REJECT nf_reject_ipv6 xt_conntrack ip_set nfnetlink ebtable_broute bridge ebtable_nat ip6table_mangle ip6table_raw ip6table_nat nf_conntrack_ipv6 nf_defrag_ipv6 nf_nat_ipv6 ip6table_security iptable_mangle iptable_raw iptable_nat nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat nf_conntrack iptable_security ebtable_filter ebtables ip6table_filter ip6_tables bnep vfat fat arc4 snd_soc_skl snd_soc_skl_ipc snd_soc_sst_ipc snd_soc_sst_dsp snd_hda_ext_core intel_rapl snd_soc_sst_match snd_soc_core x86_pkg_temp_thermal snd_hda_codec_hdmi snd_hda_codec_conexant coretemp kvm_intel snd_hda_codec_generic snd_compress iTCO_wdt iwlmvm iTCO_vendor_support
May 24 17:48:08 monkeyfaced.opennms.com kernel:  snd_pcm_dmaengine ac97_bus snd_hda_intel acer_wmi kvm snd_hda_codec uvcvideo sparse_keymap mac80211 snd_hda_core snd_hwdep videobuf2_vmalloc videobuf2_memops snd_seq videobuf2_v4l2 videobuf2_core snd_seq_device videodev snd_pcm btusb irqbypass iwlwifi btrtl btbcm rtsx_pci_ms btintel media cfg80211 bluetooth joydev thinkpad_acpi snd_timer memstick mei_me i2c_i801 mei tpm_crb snd shpchp soundcore rfkill tpm_tis tpm nfsd nfs_acl lockd auth_rpcgss grace dm_crypt 8021q garp stp llc mrp i915 rtsx_pci_sdmmc mmc_core crct10dif_pclmul crc32_pclmul i2c_algo_bit drm_kms_helper crc32c_intel drm e1000e ghash_clmulni_intel serio_raw ptp nvme pps_core rtsx_pci wmi video fjes sunrpc scsi_transport_iscsi
May 24 17:48:08 monkeyfaced.opennms.com kernel: CPU: 2 PID: 3004 Comm: kworker/2:5 Tainted: G        W       4.5.5-300.fc24.x86_64 #1
May 24 17:48:08 monkeyfaced.opennms.com kernel: Hardware name: LENOVO 20FBCTO1WW/20FBCTO1WW, BIOS N1FET38W (1.12 ) 03/30/2016
May 24 17:48:08 monkeyfaced.opennms.com kernel: Workqueue: events i915_hotplug_work_func [i915]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  0000000000000286 00000000a967d999 ffff880404f739a0 ffffffff813d35af
May 24 17:48:08 monkeyfaced.opennms.com kernel:  ffff880404f739e8 ffffffffa02d97f8 ffff880404f739d8 ffffffff810a5f12
May 24 17:48:08 monkeyfaced.opennms.com kernel:  ffff88003f97f000 ffff88003fb39bd4 ffff88003f97c000 ffff880407caeba8
May 24 17:48:08 monkeyfaced.opennms.com kernel: Call Trace:
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffff813d35af&gt;] dump_stack+0x63/0x84
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810a5f12&gt;] warn_slowpath_common+0x82/0xc0
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810a5fac&gt;] warn_slowpath_fmt+0x5c/0x80
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa02106ac&gt;] skl_update_other_pipe_wm+0x16c/0x180 [i915]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa021083c&gt;] skl_update_wm+0x17c/0x610 [i915]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa021c111&gt;] ? intel_display_power_put+0xd1/0x130 [i915]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa021422e&gt;] intel_update_watermarks+0x1e/0x30 [i915]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa027bf37&gt;] intel_atomic_commit+0x7d7/0x1860 [i915]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0141362&gt;] ? drm_atomic_check_only+0x182/0x600 [drm]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0141817&gt;] drm_atomic_commit+0x37/0x60 [drm]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b17c8&gt;] restore_fbdev_mode+0x238/0x260 [drm_kms_helper]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b3984&gt;] drm_fb_helper_restore_fbdev_mode_unlocked+0x34/0x80 [drm_kms_helper]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b39fd&gt;] drm_fb_helper_set_par+0x2d/0x50 [drm_kms_helper]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b3902&gt;] drm_fb_helper_hotplug_event+0xd2/0x120 [drm_kms_helper]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa029432e&gt;] intel_fbdev_output_poll_changed+0x1e/0x30 [i915]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01a6717&gt;] drm_kms_helper_hotplug_event+0x27/0x30 [drm_kms_helper]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa028a091&gt;] i915_hotplug_work_func+0x201/0x2c0 [i915]
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810be7e4&gt;] process_one_work+0x184/0x440
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaee&gt;] worker_thread+0x4e/0x480
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaa0&gt;] ? process_one_work+0x440/0x440
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaa0&gt;] ? process_one_work+0x440/0x440
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c49c8&gt;] kthread+0xd8/0xf0
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c48f0&gt;] ? kthread_worker_fn+0x180/0x180
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffff817cf03f&gt;] ret_from_fork+0x3f/0x70
May 24 17:48:08 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c48f0&gt;] ? kthread_worker_fn+0x180/0x180
May 24 17:48:08 monkeyfaced.opennms.com kernel: ---[ end trace 4f8e03c451afde84 ]---




May 24 17:48:25 monkeyfaced.opennms.com kernel: ------------[ cut here ]------------
May 24 17:48:25 monkeyfaced.opennms.com kernel: WARNING: CPU: 2 PID: 3004 at drivers/gpu/drm/i915/intel_pm.c:3554 skl_update_other_pipe_wm+0x16c/0x180 [i915]()
May 24 17:48:25 monkeyfaced.opennms.com kernel: WARN_ON(!wm_changed)
May 24 17:48:25 monkeyfaced.opennms.com kernel: Modules linked in:
May 24 17:48:25 monkeyfaced.opennms.com kernel:  asix usbnet mii hid_lenovo ccm xt_CHECKSUM ipt_MASQUERADE nf_nat_masquerade_ipv4 tun nf_conntrack_netbios_ns nf_conntrack_broadcast ip6t_rpfilter ip6t_REJECT nf_reject_ipv6 xt_conntrack ip_set nfnetlink ebtable_broute bridge ebtable_nat ip6table_mangle ip6table_raw ip6table_nat nf_conntrack_ipv6 nf_defrag_ipv6 nf_nat_ipv6 ip6table_security iptable_mangle iptable_raw iptable_nat nf_conntrack_ipv4 nf_defrag_ipv4 nf_nat_ipv4 nf_nat nf_conntrack iptable_security ebtable_filter ebtables ip6table_filter ip6_tables bnep vfat fat arc4 snd_soc_skl snd_soc_skl_ipc snd_soc_sst_ipc snd_soc_sst_dsp snd_hda_ext_core intel_rapl snd_soc_sst_match snd_soc_core x86_pkg_temp_thermal snd_hda_codec_hdmi snd_hda_codec_conexant coretemp kvm_intel snd_hda_codec_generic snd_compress iTCO_wdt iwlmvm iTCO_vendor_support
May 24 17:48:25 monkeyfaced.opennms.com kernel:  snd_pcm_dmaengine ac97_bus snd_hda_intel acer_wmi kvm snd_hda_codec uvcvideo sparse_keymap mac80211 snd_hda_core snd_hwdep videobuf2_vmalloc videobuf2_memops snd_seq videobuf2_v4l2 videobuf2_core snd_seq_device videodev snd_pcm btusb irqbypass iwlwifi btrtl btbcm rtsx_pci_ms btintel media cfg80211 bluetooth joydev thinkpad_acpi snd_timer memstick mei_me i2c_i801 mei tpm_crb snd shpchp soundcore rfkill tpm_tis tpm nfsd nfs_acl lockd auth_rpcgss grace dm_crypt 8021q garp stp llc mrp i915 rtsx_pci_sdmmc mmc_core crct10dif_pclmul crc32_pclmul i2c_algo_bit drm_kms_helper crc32c_intel drm e1000e ghash_clmulni_intel serio_raw ptp nvme pps_core rtsx_pci wmi video fjes sunrpc scsi_transport_iscsi
May 24 17:48:25 monkeyfaced.opennms.com kernel: CPU: 2 PID: 3004 Comm: kworker/2:5 Tainted: G        W       4.5.5-300.fc24.x86_64 #1
May 24 17:48:25 monkeyfaced.opennms.com kernel: Hardware name: LENOVO 20FBCTO1WW/20FBCTO1WW, BIOS N1FET38W (1.12 ) 03/30/2016
May 24 17:48:25 monkeyfaced.opennms.com kernel: Workqueue: events i915_hotplug_work_func [i915]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  0000000000000286 00000000a967d999 ffff880404f739a0 ffffffff813d35af
May 24 17:48:25 monkeyfaced.opennms.com kernel:  ffff880404f739e8 ffffffffa02d97f8 ffff880404f739d8 ffffffff810a5f12
May 24 17:48:25 monkeyfaced.opennms.com kernel:  ffff88003f97f000 ffff88003fb39bd4 ffff88003f97c000 ffff880407caeba8
May 24 17:48:25 monkeyfaced.opennms.com kernel: Call Trace:
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffff813d35af&gt;] dump_stack+0x63/0x84
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810a5f12&gt;] warn_slowpath_common+0x82/0xc0
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810a5fac&gt;] warn_slowpath_fmt+0x5c/0x80
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa02106ac&gt;] skl_update_other_pipe_wm+0x16c/0x180 [i915]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa021083c&gt;] skl_update_wm+0x17c/0x610 [i915]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa021c111&gt;] ? intel_display_power_put+0xd1/0x130 [i915]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa021422e&gt;] intel_update_watermarks+0x1e/0x30 [i915]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa027bf37&gt;] intel_atomic_commit+0x7d7/0x1860 [i915]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0141362&gt;] ? drm_atomic_check_only+0x182/0x600 [drm]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa0141817&gt;] drm_atomic_commit+0x37/0x60 [drm]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b17c8&gt;] restore_fbdev_mode+0x238/0x260 [drm_kms_helper]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b3984&gt;] drm_fb_helper_restore_fbdev_mode_unlocked+0x34/0x80 [drm_kms_helper]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b39fd&gt;] drm_fb_helper_set_par+0x2d/0x50 [drm_kms_helper]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01b3902&gt;] drm_fb_helper_hotplug_event+0xd2/0x120 [drm_kms_helper]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa029432e&gt;] intel_fbdev_output_poll_changed+0x1e/0x30 [i915]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa01a6717&gt;] drm_kms_helper_hotplug_event+0x27/0x30 [drm_kms_helper]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffffa028a091&gt;] i915_hotplug_work_func+0x201/0x2c0 [i915]
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810be7e4&gt;] process_one_work+0x184/0x440
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaee&gt;] worker_thread+0x4e/0x480
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaa0&gt;] ? process_one_work+0x440/0x440
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810beaa0&gt;] ? process_one_work+0x440/0x440
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c49c8&gt;] kthread+0xd8/0xf0
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c48f0&gt;] ? kthread_worker_fn+0x180/0x180
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffff817cf03f&gt;] ret_from_fork+0x3f/0x70
May 24 17:48:25 monkeyfaced.opennms.com kernel:  [&lt;ffffffff810c48f0&gt;] ? kthread_worker_fn+0x180/0x180
May 24 17:48:25 monkeyfaced.opennms.com kernel: ---[ end trace 4f8e03c451afde86 ]---</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9359096</commentid>
    <comment_count>2</comment_count>
    <who name="Jeff Gehlbach">jeffg</who>
    <bug_when>2016-05-25 16:18:21 -0400</bug_when>
    <thetext>masterzorag in #fedora suggested trying the following patch; I&apos;m building now and will report here whether it makes any difference.

https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/drivers/gpu/drm/i915/intel_pm.c?id=9aec6a08f1163fb24c23f9036891e1d5bab3f1be</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9365779</commentid>
    <comment_count>3</comment_count>
    <who name="Jeff Gehlbach">jeffg</who>
    <bug_when>2016-05-27 10:49:02 -0400</bug_when>
    <thetext>I can&apos;t get that patch to apply (too many intervening changes and too little free time to work it all out). So I tried a kernel from rawhide:

kernel-4.7.0-0.rc0.git5.1.fc25.x86_64

So far I&apos;ve been unable to trigger the freeze while running this kernel. Going to put the system through its paces a bit and see how it holds up.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9373179</commentid>
    <comment_count>4</comment_count>
    <who name="Jeff Gehlbach">jeffg</who>
    <bug_when>2016-05-31 11:54:24 -0400</bug_when>
    <thetext>Still holding steady. No time at the moment to isolate and test particular patches, though.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9738947</commentid>
    <comment_count>5</comment_count>
    <who name="Laura Abbott">labbott</who>
    <bug_when>2016-09-23 15:21:40 -0400</bug_when>
    <thetext>*********** MASS BUG UPDATE **************
 
We apologize for the inconvenience.  There is a large number of bugs to go through and several of them have gone stale.  Due to this, we are doing a mass bug update across all of the Fedora 24 kernel bugs.
 
Fedora 24 has now been rebased to 4.7.4-200.fc24.  Please test this kernel update (or newer) and let us know if you issue has been resolved or if it is still present with the newer kernel.
 
If you have moved on to Fedora 25, and are still experiencing this issue, please change the version to Fedora 25.
 
If you experience different issues, please open a new bug report for those.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9743930</commentid>
    <comment_count>6</comment_count>
    <who name="Jeff Gehlbach">jeffg</who>
    <bug_when>2016-09-26 17:08:08 -0400</bug_when>
    <thetext>As far as I can tell, the crash is gone with newer kernels. 4.7.4-200.fc24 is fine, as were a few of its predecessors. Truth be told I&apos;ve been on the road quite a bit and unable to test every one, so I&apos;m not sure when it disappeared. Looking much better in any case, good work!</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>