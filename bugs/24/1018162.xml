<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1018162</bug_id>
          
          <creation_ts>2013-10-11 07:04:00 -0400</creation_ts>
          <short_desc>only testing LIVE CD, changes system time in BIOS</short_desc>
          <delta_ts>2016-06-19 15:28:33 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>spin-kickstarts</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>joerg.lechner</reporter>
          <assigned_to name="Bruno Wolff III">bruno</assigned_to>
          <cc>admiller</cc>
    
    
    <cc>awilliam</cc>
    
    
    <cc>bruno</cc>
    
    
    <cc>dustymabe</cc>
    
    
    <cc>fedorabugmail</cc>
    
    
    <cc>joerg.lechner</cc>
    
    
    <cc>kevin</cc>
    
    
    <cc>massi.ergosum</cc>
    
    
    <cc>mlichvar</cc>
    
    
    <cc>vanmeeuwen+fedora</cc>
    
    
    <cc>vpavlin</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-06-19 15:28:33</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>6407758</commentid>
    <comment_count>0</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2013-10-11 07:04:32 -0400</bug_when>
    <thetext>Description of problem:
tried to test Live CD from https://dl.fedoraproject.org/pub/alt/stage/20-Beta-TC2/Spins/i386/Fedora-Live-LXDE-i686-20-Beta-TC2.iso. After test I started the  old Windows XP again. The system time was turned back by 2 hours. I had to adjust the system time again in Windows or BIOS. 

Version-Release number of selected component (if applicable):
https://dl.fedoraproject.org/pub/alt/stage/20-Beta-TC2/Spins/i386/Fedora-Live-LXDE-i686-20-Beta-TC2.iso

How reproducible:
always, start LXDE Live CD. Logout. Have a look at Your system time in BIOS.

Steps to Reproduce:
1. Download LXDE iso, produce CD
2. Start LXDE CD, then Logout
3. Start Your PC again, and have a look into Your Bios

Actual results:
System time permanently changed only by a test &quot;how is Fedora 20&quot;

Expected results:
No change of system time in BIOS, when only testing a LIVE CD

Additional info:</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>6411631</commentid>
    <comment_count>1</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2013-10-13 01:36:42 -0400</bug_when>
    <thetext>To say it clearly, I didn&apos;t install F20, the system runs only via Live CD, and then the system time of the PC is permanently changed from local time to UTC.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>6460094</commentid>
    <comment_count>2</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2013-10-27 02:05:38 -0400</bug_when>
    <thetext>This problem still exists in F20 Beta TC6 LXDE Live CD.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>6481091</commentid>
    <comment_count>3</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2013-11-02 10:35:25 -0400</bug_when>
    <thetext>Problems with F20 Beta RC2:
 Fedora-Live-LXDE-i686-20-Beta-2.iso uploaded on the 1st of November.
When I reboot from Windows XP to F20 LXDE Live CD, NO installation, only running the Live CD. I have access to the web (internet connection ok), the F20 Firewall says &quot;disabled Lockdown, disabled Panic Mode&quot;. Then for leaving the Live CD I use the branch &quot;shutdown&quot;, then sytem shuts down, but the system clock remains SET to UTC.
When I shut down Windows XP, wait for some minutes and then boot the LXDE Live CD, NO installation, only running the live CD, then starting Firefox. The result is &quot;NO Access to web&quot;, looking at the F20 Firewall, the Firewall is waiting and says &quot; - Lockdown, - Panic Mode&quot;. When I want to leave the &quot;Live CD run&quot; I find only the branch &quot;Logout - Quit - Shutdown&quot;, after systemstart with Windows XP, I found the system clock unchanged - NOT set to UTC.

This seems to be repeatable.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>6481792</commentid>
    <comment_count>4</comment_count>
    <who name="Christoph Wickert">cwickert</who>
    <bug_when>2013-11-03 08:04:21 -0500</bug_when>
    <thetext>Is this specific to the LXDE livecd?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>6482476</commentid>
    <comment_count>5</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2013-11-03 23:12:29 -0500</bug_when>
    <thetext>So far I have tested the LXDE livecd on 2 computers with different BIOS. UTC setting after the branch &quot;Logout-Quit-Shutdown&quot; appears in both computers, I will download another livecd from the i386 possibilities and report after test.

This thing with &quot;panic mode&quot; didn&apos;t appears with the other PC so far, but the changing of system time to UTC I could see also there.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>6483165</commentid>
    <comment_count>6</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2013-11-04 04:17:06 -0500</bug_when>
    <thetext>Test with https://dl.fedoraproject.org/pub/alt/stage/20-Beta-RC2/Live/i386/Fedora-Live-Desktop-i686-20-Beta-2.iso, with the F20 Dektop livecd.

Test: Run livecd in live modus, start Firefox, close Firefox, shutdown Fedora 20, start Windows XP.
Test Result: System time is set to UTC, in my case 1 hour less then CET.

Test is performed on a fast (2.5 GHz) 10 years old Laptop.
Same result as LXDE Livecd.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>6657183</commentid>
    <comment_count>7</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2013-12-25 08:17:53 -0500</bug_when>
    <thetext>Test with F20 LiveCD: http://download.fedoraproject.org/pub/fedora/linux/releases/20/Live/i386/Fedora-Live-LXDE-i686-20-1.iso

This error is still valid</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8278668</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2015-05-29 05:33:23 -0400</bug_when>
    <thetext>This message is a reminder that Fedora 20 is nearing its end of life.
Approximately 4 (four) weeks from now Fedora will stop maintaining
and issuing updates for Fedora 20. It is Fedora&apos;s policy to close all
bug reports from releases that are no longer maintained. At that time
this bug will be closed as EOL if it remains open with a Fedora  &apos;version&apos;
of &apos;20&apos;.

Package Maintainer: If you wish for this bug to remain open because you
plan to fix it in a currently maintained version, simply change the &apos;version&apos; 
to a later Fedora version.

Thank you for reporting this issue and we are sorry that we were not 
able to fix it before Fedora 20 is end of life. If you would still like 
to see this bug fixed and are able to reproduce it against a later version 
of Fedora, you are encouraged  change the &apos;version&apos; to a later Fedora 
version prior this bug is closed as described in the policy above.

Although we aim to fix as many bugs as possible during every release&apos;s 
lifetime, sometimes those efforts are overtaken by events. Often a 
more recent Fedora release includes newer upstream software that fixes 
bugs or makes them obsolete.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8289019</commentid>
    <comment_count>9</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2015-05-30 04:08:44 -0400</bug_when>
    <thetext>wrote a Bug 1226427 for F22, the new bug ts a duplicate to this one.
Changed F20 in this bug to F22.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8289021</commentid>
    <comment_count>10</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2015-05-30 04:12:12 -0400</bug_when>
    <thetext>Description of problem:
When I load the F22 Final Live Medium (Workstation x86_64) via USB stick to the laptop the system time is permanently changed to UTC.
The Live medium is produced via the F22 liveUSB Creator. There was a similar problem in F20 or F21, I don&apos;t remember exactly.

Version-Release number of selected component (if applicable):
Name        : liveusb-creator
Arch        : noarch
Epoch       : 0
Version     : 3.14.1
Release     : 1.fc22

How reproducible:
Create iso on usb flash media with liveusb-creator i.e Fedora-Live-Workstation-x86_64-22-3.iso, on F22.
Load (not install) the created iso on usb stick onto a laptop (in my case Acer Aspire E 15).
After shutdown and i.e. start of Windows 8.1 the sytem time is changed (from German time) to UTC. 

Steps to Reproduce:
1. Create iso onto usb stick
2. Load iso onto laptop/PC
3. Shutdown and i.e. start Windows

Actual results:
System time permanently set UTC

Expected results:
System time remains unchanged</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8289024</commentid>
    <comment_count>11</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2015-05-30 04:15:45 -0400</bug_when>
    <thetext>Description of problem:
When I load the F22 Final Live Medium (Workstation x86_64) via USB stick to the laptop the system time is permanently changed to UTC.
The Live medium is produced via the F22 liveUSB Creator. There was a similar problem in F20 or F21, I don&apos;t remember exactly.

Version-Release number of selected component (if applicable):
Name        : liveusb-creator
Arch        : noarch
Epoch       : 0
Version     : 3.14.1
Release     : 1.fc22

How reproducible:
Create iso on usb flash media with liveusb-creator i.e Fedora-Live-Workstation-x86_64-22-3.iso, on F22.
Load (not install) the created iso on usb stick onto a laptop (in my case Acer Aspire E 15).
After shutdown and i.e. start of Windows 8.1 the sytem time is changed (from German time) to UTC. 

Steps to Reproduce:
1. Create iso onto usb stick
2. Load iso onto laptop/PC
3. Shutdown and i.e. start Windows

Actual results:
System time permanently set UTC

Expected results:
System time remains unchanged</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8289026</commentid>
    <comment_count>12</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2015-05-30 04:19:56 -0400</bug_when>
    <thetext>*** Bug 1226427 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8289260</commentid>
    <comment_count>13</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2015-05-30 11:12:54 -0400</bug_when>
    <thetext>just tested F21 Workstation x86_64,
this error does not occur with F21 Workstation x86_64,

This means:
An error in F20 was corrected in F21 and is again present in F22.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8347250</commentid>
    <comment_count>14</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2015-06-17 17:25:22 -0400</bug_when>
    <thetext>I suspect this may be caused by chrony - chronyd.service looks like it starts up and perhaps adjusts the system clock on live image boot. We could consider disabling it for live sessions.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8348292</commentid>
    <comment_count>15</comment_count>
    <who name="Miroslav Lichvar">mlichvar</who>
    <bug_when>2015-06-18 02:40:21 -0400</bug_when>
    <thetext>Yes, chronyd in the default Fedora configuration tells the kernel that the system clock is synchronized and the kernel updates the RTC to the system time every 11 minutes. Older kernels (before 3.10) used to sync the RTC only within +/- 15 minutes, so an offset between UTC and the timezone in which Windows keeps the RTC was preserved. With newer kernels the UTC/local setting of RTC would need to agree with Windows, which would be difficult to do.

Instead of disabling the chronyd service in the live image, I&apos;d suggest to remove the rtcsync option from /etc/chrony.conf. The users will still have accurate system clock, but nothing will touch the RTC.

What component would be best to make live image specific changes in the configuration?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8350777</commentid>
    <comment_count>16</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2015-06-18 12:00:53 -0400</bug_when>
    <thetext>To disable a service on lives you can use a systemd conditional in the unit file, but for something like editing a config file it pretty much has to go in spin-kickstarts. There&apos;s a big chunk of fedora-live-base.ks that creates a livesys.service within the live environment (but that doesn&apos;t wind up getting installed to disk), and things like this go in there.

We&apos;d probably want something like this:

[adamw@adam spin-kickstarts (master %)]$ git diff
diff --git a/fedora-live-base.ks b/fedora-live-base.ks
index 9aeeeb8..7e8e4fa 100644
--- a/fedora-live-base.ks
+++ b/fedora-live-base.ks
@@ -193,6 +193,9 @@ systemctl --no-reload disable atd.service 2&gt; /dev/null || :
 systemctl stop crond.service 2&gt; /dev/null || :
 systemctl stop atd.service 2&gt; /dev/null || :
 
+# Don&apos;t sync the system clock when running live (RHBZ #1018162)
+sed -i &apos;s/rtcsync//&apos; /etc/chrony.conf
+
 # Mark things as configured
 touch /.liveimg-configured
 
If that looks right, I can commit it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8350841</commentid>
    <comment_count>17</comment_count>
    <who name="Miroslav Lichvar">mlichvar</who>
    <bug_when>2015-06-18 12:15:29 -0400</bug_when>
    <thetext>Looks good to me. Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8468535</commentid>
    <comment_count>18</comment_count>
    <who name="Miroslav Lichvar">mlichvar</who>
    <bug_when>2015-07-22 04:53:34 -0400</bug_when>
    <thetext>Adam, can we close this bug?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8470314</commentid>
    <comment_count>19</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2015-07-22 11:24:33 -0400</bug_when>
    <thetext>Oops, yeah. I did commit the change to the kickstart, F23 lives should not have this problem.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8532141</commentid>
    <comment_count>20</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2015-08-11 14:36:13 -0400</bug_when>
    <thetext>Tested with F23 Alpha Release:
Error still present, problem so far not solved.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8533679</commentid>
    <comment_count>21</comment_count>
    <who name="Miroslav Lichvar">mlichvar</who>
    <bug_when>2015-08-12 02:08:38 -0400</bug_when>
    <thetext>Hm, if the rtcsync option was removed from /etc/chrony.conf, there is probably something else touching the RTC. A forgotten hwclock --systohc call or something setting the clock or timezone via timedated?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8534565</commentid>
    <comment_count>22</comment_count>
    <who name="Miroslav Lichvar">mlichvar</who>
    <bug_when>2015-08-12 06:28:12 -0400</bug_when>
    <thetext>Actually, it seems the problem is that the livesys init script, which modifies /etc/chrony.conf, is started after the chronyd service.

Is there any way to describe the dependency in the init script, or would it have to be converted to a systemd service?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8535140</commentid>
    <comment_count>23</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2015-08-12 09:18:23 -0400</bug_when>
    <thetext>I used to know the answer to that, but I&apos;ve forgotten. I&apos;ll look it up again. Believe me, you don&apos;t want to go down the road of converting livesys to systemd, I spent a week doing that four years ago and it never got merged...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8557155</commentid>
    <comment_count>24</comment_count>
    <who name="">joerg.lechner</who>
    <bug_when>2015-08-19 14:38:29 -0400</bug_when>
    <thetext>Started by case the F23 Alpha Desktop x86_64 without Internet connection (forgot to plug), did all what I normally did to test this bug, in this case there was NO time change to UTC, when I started Win 8.1 again. I think this info could be helpful in the analysis of this problem.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8960259</commentid>
    <comment_count>25</comment_count>
    <who name="James">fedorabugmail</who>
    <bug_when>2016-01-06 21:33:12 -0500</bug_when>
    <thetext>I see this behavior with the F23/Mate Live image downloaded sometime in November.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9266794</commentid>
    <comment_count>26</comment_count>
    <who name="Bruno Wolff III">bruno</who>
    <bug_when>2016-04-25 16:38:42 -0400</bug_when>
    <thetext>I suspect this may be do to systemd changes. It looks like there are now systemd services that are involved with syncing time. This bug should probably supercede bug 297421 which was the same problem back before chrony.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9266805</commentid>
    <comment_count>27</comment_count>
    <who name="Bruno Wolff III">bruno</who>
    <bug_when>2016-04-25 16:42:40 -0400</bug_when>
    <thetext>I am not sure whether or not we should keep this under chrony.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9429354</commentid>
    <comment_count>28</comment_count>
    <who name="Bruno Wolff III">bruno</who>
    <bug_when>2016-06-17 17:37:06 -0400</bug_when>
    <thetext>chronyd is still running on live images (in particular) and it is happening with Fedora 24.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9429861</commentid>
    <comment_count>29</comment_count>
    <who name="Bruno Wolff III">bruno</who>
    <bug_when>2016-06-18 08:28:26 -0400</bug_when>
    <thetext>I believe this can be fixed by having livesys start before chronyd. This can be done with a special comment in the livesys init script. Preliminary testing looks good.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9429879</commentid>
    <comment_count>30</comment_count>
    <who name="Bruno Wolff III">bruno</who>
    <bug_when>2016-06-18 09:29:15 -0400</bug_when>
    <thetext>Fixed in commit:
https://pagure.io/fedora-kickstarts/c/b39ac7702471da634ebdee5eb0e131dffe2cc7ca
This should be used for the next rawhide compose (f25) started after this was committed. If that tests out, I&apos;ll close this bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9430924</commentid>
    <comment_count>31</comment_count>
    <who name="Bruno Wolff III">bruno</who>
    <bug_when>2016-06-19 15:28:33 -0400</bug_when>
    <thetext>I tested Fedora-Games-Live-i386-Rawhide-20160619.n.0.iso and it does appear rawhide comoses no longer exhibit this problem. The fix isn&apos;t actually in a spin-kickstarts package yet, but I don&apos;t think we need to force a new build with so few changes, nor do we need to keep is open until there is one. Most testing at this point is going to be with the fixed compose images.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>