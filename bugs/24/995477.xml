<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>995477</bug_id>
          
          <creation_ts>2013-08-09 09:41:00 -0400</creation_ts>
          <short_desc>kdump does not work with live images</short_desc>
          <delta_ts>2016-12-12 00:54:41 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>kexec-tools</component>
          <version>24</version>
          <rep_platform>All</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>medium</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Vivek Goyal">vgoyal</reporter>
          <assigned_to name="Tong Li">tonli</assigned_to>
          <cc>awilliam</cc>
    
    
    <cc>bhe</cc>
    
    
    <cc>kdump-team-bugs</cc>
    
    
    <cc>ruyang</cc>
    
    
    <cc>tonli</cc>
    
    
    <cc>xlpang</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-12-12 00:54:41</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>6198540</commentid>
    <comment_count>0</comment_count>
    <who name="Vivek Goyal">vgoyal</who>
    <bug_when>2013-08-09 09:41:23 -0400</bug_when>
    <thetext>Description of problem:

Kdump does not work with live images. Some users want it to work there too.

Version-Release number of selected component (if applicable):


How reproducible:


Steps to Reproduce:
1.
2.
3.

Actual results:


Expected results:


Additional info:</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>6204061</commentid>
    <comment_count>1</comment_count>
    <who name="Dave Young">ruyang</who>
    <bug_when>2013-08-12 10:24:18 -0400</bug_when>
    <thetext>Hi, Vivek

For the Live media support, there&apos;s several limitations I think:

a. The live media initrd is created by anaconda, not sure the difference between normal initrd. So 2nd kernel live rootfs mounting probably will fail.

b. It need user manually modify grub cmdline while booting for the crashkernel. Also manually yum install kexec-tools after booting into desktop.

It should be ok for user to specify a standalone disk for dump target. It make no much sense to dump to ramfs.

What do you think?

Thanks
Dave</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>6204154</commentid>
    <comment_count>2</comment_count>
    <who name="Vivek Goyal">vgoyal</who>
    <bug_when>2013-08-12 10:36:08 -0400</bug_when>
    <thetext>(In reply to Dave Young from comment #1)
&gt; Hi, Vivek
&gt; 
&gt; For the Live media support, there&apos;s several limitations I think:
&gt; 
&gt; a. The live media initrd is created by anaconda, not sure the difference
&gt; between normal initrd. So 2nd kernel live rootfs mounting probably will fail.

But that is boot initrd. I was under the impression that certain parts of
root will be somehow on RAM and be writable. So we will be able to start
kdump service and generate an initramfs. Is that not the case?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>6204170</commentid>
    <comment_count>3</comment_count>
    <who name="Vivek Goyal">vgoyal</who>
    <bug_when>2013-08-12 10:37:38 -0400</bug_when>
    <thetext>(In reply to Dave Young from comment #1)

&gt; b. It need user manually modify grub cmdline while booting for the
&gt; crashkernel. Also manually yum install kexec-tools after booting into
&gt; desktop.

For kexec-tools, I think it should make sense to make it part of default
install. Otherwise installing it manually should act as a workaround though.


&gt; 
&gt; It should be ok for user to specify a standalone disk for dump target. It
&gt; make no much sense to dump to ramfs.

Yes, either to a disk or send it over network.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>6312105</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2013-09-16 12:28:32 -0400</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 20 development cycle.
Changing version to &apos;20&apos;.

More information and reason for this action is here:
https://fedoraproject.org/wiki/BugZappers/HouseKeeping/Fedora20</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8278280</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2015-05-29 05:18:23 -0400</bug_when>
    <thetext>This message is a reminder that Fedora 20 is nearing its end of life.
Approximately 4 (four) weeks from now Fedora will stop maintaining
and issuing updates for Fedora 20. It is Fedora&apos;s policy to close all
bug reports from releases that are no longer maintained. At that time
this bug will be closed as EOL if it remains open with a Fedora  &apos;version&apos;
of &apos;20&apos;.

Package Maintainer: If you wish for this bug to remain open because you
plan to fix it in a currently maintained version, simply change the &apos;version&apos; 
to a later Fedora version.

Thank you for reporting this issue and we are sorry that we were not 
able to fix it before Fedora 20 is end of life. If you would still like 
to see this bug fixed and are able to reproduce it against a later version 
of Fedora, you are encouraged  change the &apos;version&apos; to a later Fedora 
version prior this bug is closed as described in the policy above.

Although we aim to fix as many bugs as possible during every release&apos;s 
lifetime, sometimes those efforts are overtaken by events. Often a 
more recent Fedora release includes newer upstream software that fixes 
bugs or makes them obsolete.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8380640</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2015-06-29 08:15:36 -0400</bug_when>
    <thetext>Fedora 20 changed to end-of-life (EOL) status on 2015-06-23. Fedora 20 is
no longer maintained, which means that it will not receive any further
security or bug fix updates. As a result we are closing this bug.

If you can reproduce this bug against a currently maintained version of
Fedora please feel free to reopen this bug against that version. If you
are unable to reopen this bug, please file a new report against the
current release. If you experience problems, please add a comment to this
bug.

Thank you for reporting this bug and we are sorry it could not be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9094331</commentid>
    <comment_count>9</comment_count>
    <who name="Jan Kurik">jkurik</who>
    <bug_when>2016-02-24 10:34:55 -0500</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 24 development cycle.
Changing version to &apos;24&apos;.

More information and reason for this action is here:
https://fedoraproject.org/wiki/Fedora_Program_Management/HouseKeeping/Fedora24#Rawhide_Rebase</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9741275</commentid>
    <comment_count>10</comment_count>
    <who name="Dave Young">ruyang</who>
    <bug_when>2016-09-25 22:50:28 -0400</bug_when>
    <thetext>Litong, Can you do a test with latest Fedora?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9745315</commentid>
    <comment_count>11</comment_count>
    <who name="Tong Li">tonli</who>
    <bug_when>2016-09-27 03:48:24 -0400</bug_when>
    <thetext>(In reply to Dave Young from comment #10)
&gt; Litong, Can you do a test with latest Fedora?

I tested with a live USB created from &apos;Fedora-Workstation-Live-x86_64-25_Alpha-2.iso&apos;. I tried two dump target. Both of them print such a error on serial and then the system was halted.

[    3.637243] dracut: FATAL: Don&apos;t know how to handle &apos;root=live:CDLABEL=Fedora-WS-Live-25_A-2&apos;
[    3.646358] dracut: Refusing to continue

1. ext4 /dev/sdb4

/dev/sdb4 is a partition on my USB stick whose file system is ext4.

2. ssh root@10.*.*.*

This is my laptop which is in the same LAN with the testing machine.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9745777</commentid>
    <comment_count>12</comment_count>
    <who name="Xunlei Pang">xlpang</who>
    <bug_when>2016-09-27 05:37:48 -0400</bug_when>
    <thetext>(In reply to Tong Li from comment #11)
&gt; (In reply to Dave Young from comment #10)
&gt; &gt; Litong, Can you do a test with latest Fedora?
&gt; 
&gt; I tested with a live USB created from
&gt; &apos;Fedora-Workstation-Live-x86_64-25_Alpha-2.iso&apos;. I tried two dump target.
&gt; Both of them print such a error on serial and then the system was halted.
&gt; 
&gt; [    3.637243] dracut: FATAL: Don&apos;t know how to handle
&gt; &apos;root=live:CDLABEL=Fedora-WS-Live-25_A-2&apos;
&gt; [    3.646358] dracut: Refusing to continue
&gt; 
&gt; 1. ext4 /dev/sdb4
&gt; 
&gt; /dev/sdb4 is a partition on my USB stick whose file system is ext4.
&gt; 
&gt; 2. ssh root@10.*.*.*
&gt; 
&gt; This is my laptop which is in the same LAN with the testing machine.

Hi Tong,

Could you please try to remove &quot;root=live:CDLABEL=Fedora-WS-Live-25_A-2&quot; using &quot;KDUMP_COMMANDLINE&quot; in /etc/sysconfig/kdump?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9749105</commentid>
    <comment_count>13</comment_count>
    <who name="Tong Li">tonli</who>
    <bug_when>2016-09-28 01:28:10 -0400</bug_when>
    <thetext>(In reply to Xunlei Pang from comment #12)
&gt; (In reply to Tong Li from comment #11)
&gt; &gt; (In reply to Dave Young from comment #10)
&gt; &gt; &gt; Litong, Can you do a test with latest Fedora?
&gt; &gt; 
&gt; &gt; I tested with a live USB created from
&gt; &gt; &apos;Fedora-Workstation-Live-x86_64-25_Alpha-2.iso&apos;. I tried two dump target.
&gt; &gt; Both of them print such a error on serial and then the system was halted.
&gt; &gt; 
&gt; &gt; [    3.637243] dracut: FATAL: Don&apos;t know how to handle
&gt; &gt; &apos;root=live:CDLABEL=Fedora-WS-Live-25_A-2&apos;
&gt; &gt; [    3.646358] dracut: Refusing to continue
&gt; &gt; 
&gt; &gt; 1. ext4 /dev/sdb4
&gt; &gt; 
&gt; &gt; /dev/sdb4 is a partition on my USB stick whose file system is ext4.
&gt; &gt; 
&gt; &gt; 2. ssh root@10.*.*.*
&gt; &gt; 
&gt; &gt; This is my laptop which is in the same LAN with the testing machine.
&gt; 
&gt; Hi Tong,
&gt; 
&gt; Could you please try to remove &quot;root=live:CDLABEL=Fedora-WS-Live-25_A-2&quot;
&gt; using &quot;KDUMP_COMMANDLINE&quot; in /etc/sysconfig/kdump?

Hi Xunlei,

After appending &quot;root&quot; in KDUMP_COMMANDLINE_REMOVE of /etc/sysconfig/kdump, kdump worked well. But the captured vmcore was too large because of bug 1377567</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9756186</commentid>
    <comment_count>14</comment_count>
    <who name="Dave Young">ruyang</who>
    <bug_when>2016-09-30 02:34:39 -0400</bug_when>
    <thetext>Hi, Li Tong

So looks like livecd dump works with some manual steps. If so can you write a document about how to test with livecd, we can maintain it in fedora kexec-tools.

Thanks
Dave</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9756487</commentid>
    <comment_count>15</comment_count>
      <attachid>1206183</attachid>
    <who name="Tong Li">tonli</who>
    <bug_when>2016-09-30 05:02:39 -0400</bug_when>
    <thetext>Created attachment 1206183
how to setup kdump in Live CD</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9756498</commentid>
    <comment_count>16</comment_count>
      <attachid>1206184</attachid>
    <who name="Tong Li">tonli</who>
    <bug_when>2016-09-30 05:04:26 -0400</bug_when>
    <thetext>Created attachment 1206184
Try to filter &quot;root&quot; argument when running in Live CD</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1206183</attachid>
            <date>2016-09-30 05:02:00 -0400</date>
            <delta_ts>2016-09-30 05:02:39 -0400</delta_ts>
            <desc>how to setup kdump in Live CD</desc>
            <filename>kdump-livecd.txt</filename>
            <type>text/plain</type>
            <size>1085</size>
            <attacher name="Tong Li">tonli</attacher>
            
              <data encoding="base64">S2R1bXAgbm93IGNhbiB3b3JrIG9uIExpdmUgaW1hZ2VzLCBidXQgc29tZSBtYW51YWwgY29uZmln
dXJhdGlvbnMgYXJlIG5lZWRlZC4gCkhlcmUgaXMgdGhlIHN0ZXAgYnkgc3RlcCBndWlkZS4gUGxl
YXNlIHJ1biB0aGVzZSBjb21tYW5kcyB3aXRoIHJvb3QgdXNlci4KCjEuIEFwcGVuZCAicm9vdCIg
dG8gS0RVTVBfQ09NTUFORExJTkVfUkVNT1ZFIGluIC9ldGMvc3lzY29uZmlnL2tkdW1wLiAKClRo
aXMgaXMgYmVjYXVzZSBMaXZlIGltYWdlcyBhcmUgYm9vdGVkIHdpdGggYW4ga2VybmVsIHBhcmFt
ZXRlciBsaWtlIAoicm9vdD1saXZlOkNETEFCRUw9RmVkb3JhLVdTLUxpdmUtMjVfQS0yIiB3aGlj
aCBjYW4ndCBiZSByZWNvZ25pemVkIGJ5IGRyYWN1dCAKZHVyaW5nIGtkdW1wIHByb2Nlc3MgYW5k
IHdpbGwgY2F1c2Uga2R1bXAgZmFpbHVyZS4gQXBwZW5kaW5nICJyb290IiB0byAKS0RVTVBfQ09N
TUFORExJTkVfUkVNT1ZFIGNhbid0IGlnbm9yZSB0aGlzIGFyZ3VtZW50LgoKMi4gQ2hhbmdlIGR1
bXAgdGFyZ2V0IGluIC9ldGMva2R1bXAuY29uZgoKV2hlbiBrZHVtcCBpcyB0cmlnZ2VyZWQgaW4g
YSBMaXZlIGVudmlyb25tZW50LCB0aGUgZGVmYXVsdCB0YXJnZXQgL3Zhci9jcmFzaAp3aWxsIG5v
dCBiZSBtb3VudGVkIGFuZCB1bmFibGUgdG8gYmUgdXNlZCB0byBzYXZlIHZtY29yZS4gWW91IGNh
biBtb2RpZnkgaXQgdG8gCm1ha2Uga2R1bXAgc2F2ZSB0aGUgY2FwdHVyZWQgZHVtcCBmaWxlIG9u
IGFuIGV4dGVybmFsIGRpc2sgb3Igc2VuZCBpdCB3aXRoIHNzaAp0aHJvdWdodCBuZXR3b3JrLgoK
My4gUnVuICdrZHVtcGN0bCBzdGFydCcgdG8gYnVpbGQga2R1bXAgaW5pdHJhbWZzIGFuZCBzdGFy
dCBrZHVtcC4KCkhlcmUgaXMgYWxsIGNvbmZpZ3VyYXRpb25zIHlvdSBuZWVkIHRvIHR3ZWFrIG1h
bnVhbGx5LiBJZiB5b3Ugd2FudCB0byBjb25maXJtCndoZXRoZXIga2R1bXAgaXMgd29ya2luZyBv
ciBub3QsIHlvdSBjYW4gdXNlIHN5cy10cmlnZ2VyIGludGVyZmFjZSBieSBydW5uaW5nOgoJZWNo
byAxID4gL3Byb2Mvc3lzL2tlcm5lbC9zeXNycQoJZWNobyBjID4gL3Byb2Mvc3lzcnEtdHJpZ2dl
cgo=
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1206184</attachid>
            <date>2016-09-30 05:04:00 -0400</date>
            <delta_ts>2016-09-30 05:04:26 -0400</delta_ts>
            <desc>Try to filter &quot;root&quot; argument when running in Live CD</desc>
            <filename>kdumpctl.patch</filename>
            <type>text/plain</type>
            <size>335</size>
            <attacher name="Tong Li">tonli</attacher>
            
              <data encoding="base64">LS0tIC91c3IvYmluL2tkdW1wY3RsCTIwMTYtMDktMTYgMTY6MTE6MTkuMDAwMDAwMDAwICswODAw
CisrKyBrZHVtcGN0bAkyMDE2LTA5LTMwIDE2OjM0OjA5LjQ5OTMyNjExNyArMDgwMApAQCAtMjcs
NiArMjcsMTAgQEAKIAkuIC9ldGMvc3lzY29uZmlnL2tkdW1wCiBmaQogCitpZiBbWyAkKGNhdCAv
cHJvYy9jbWRsaW5lKSA9PSAqInJvb3Q9bGl2ZTpDRExBQkVMIiogXV07IHRoZW4KKwlLRFVNUF9D
T01NQU5ETElORV9SRU1PVkU9IiR7S0RVTVBfQ09NTUFORExJTkVfUkVNT1ZFfSByb290IgorZmkK
Kwogc2luZ2xlX2luc3RhbmNlX2xvY2soKQogewogCWxvY2FsIHJjIHRpbWVvdXQ9NQo=
</data>

          </attachment>
      

    </bug>

</bugzilla>