<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1385280</bug_id>
          
          <creation_ts>2016-10-15 16:58:00 -0400</creation_ts>
          <short_desc>perl-App-Cmd contains a lot of test files which should not be installed.</short_desc>
          <delta_ts>2016-10-25 00:28:33 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>perl-App-Cmd</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Van de Bugger">van.de.bugger</reporter>
          <assigned_to name="Emmanuel Seyman">emmanuel</assigned_to>
          <cc>emmanuel</cc>
    
    
    <cc>perl-devel</cc>
    
    
    <cc>ppisar</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>perl-App-Cmd-0.330-3.fc24 perl-App-Cmd-0.331-2.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-10-24 16:23:29</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9794592</commentid>
    <comment_count>0</comment_count>
    <who name="Van de Bugger">van.de.bugger</who>
    <bug_when>2016-10-15 16:58:22 -0400</bug_when>
    <thetext>Description of problem:

perl-App-Cmd rpm package contains a lot of test files which should NOT be installed.

Version-Release number of selected component (if applicable):

perl-App-Cmd-0.330-2.fc24.noarch

How reproducible:

Always.

Steps to Reproduce:
1. dnf download perl-App-Cmd
2. rpm -ql -p ./perl-App-Cmd-0.330-2.fc24.noarch.rpm | grep /t/

Actual results:

/usr/share/doc/perl-App-Cmd/t/00-load.t
/usr/share/doc/perl-App-Cmd/t/00-report-prereqs.dd
/usr/share/doc/perl-App-Cmd/t/00-report-prereqs.t
...(lot more test files)...

Expected results:

(empty output)

Additional info:

Many Perl distributions (they call it &quot;distribution&quot; because term &quot;package&quot; is used for a Perl language construct) contain tests. Perl distribution installer unpacks distribution, run tests, and installs Perl modules to the user system. Tests are NOT installed.

perl-App-Cmd rpm package contains a lot of tests, which are installed to the /usr/share/doc/perl-App-Cmd/ directory. This is a bug. Tests are NOT documentation, and so, should NOT be installed into /usr/share/doc/. Moreover, tests should NOT be included into rpm at all, since rpm does not run them before installing the modules.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9794603</commentid>
    <comment_count>1</comment_count>
    <who name="Van de Bugger">van.de.bugger</who>
    <bug_when>2016-10-15 17:02:57 -0400</bug_when>
    <thetext>BTW, on my system there are 386 directories /usr/share/doc/perl-*, and only 26 /usr/share/doc/perl-*/t/ directories:

$ ls -1 -d perl-*/t 
perl-App-Cmd/t
perl-B-Hooks-EndOfScope/t
perl-B-Hooks-OP-Check/t
perl-Business-ISBN-Data/t
perl-Class-Method-Modifiers/t
perl-common-sense/t
perl-CPAN-Meta/t
perl-Data-OptList/t
perl-Devel-GlobalDestruction/t
perl-Devel-LexAlias/t
perl-Devel-Size/t
perl-HTML-Tidy/t
perl-Moose/t
perl-MooseX-ConfigFromFile/t
perl-MooseX-Getopt/t
perl-MooseX-Role-Parameterized/t
perl-MooseX-StrictConstructor/t
perl-MooseX-Types-Path-Class/t
perl-MooseX-Types/t
perl-MRO-Compat/t
perl-namespace-clean/t
perl-Scope-Guard/t
perl-Sub-Exporter/t
perl-Sub-Identify/t
perl-Test-Simple/t
perl-Try-Tiny/t</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9795420</commentid>
    <comment_count>2</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-16 19:52:52 -0400</bug_when>
    <thetext>perl-App-Cmd-0.330-3.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-49887ecd61</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9795468</commentid>
    <comment_count>3</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-16 20:52:18 -0400</bug_when>
    <thetext>perl-App-Cmd-0.331-2.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-c5a776d731</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9798459</commentid>
    <comment_count>4</comment_count>
    <who name="Van de Bugger">van.de.bugger</who>
    <bug_when>2016-10-17 15:21:16 -0400</bug_when>
    <thetext>perl-App-Cmd-0.330-3.fc24 works for me. What about other 25 packages?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9798799</commentid>
    <comment_count>5</comment_count>
    <who name="Emmanuel Seyman">emmanuel</who>
    <bug_when>2016-10-17 17:48:29 -0400</bug_when>
    <thetext>(In reply to Van de Bugger from comment #4)
&gt;
&gt; What about other 25 packages?

You&apos;ll have to file bugs.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9803446</commentid>
    <comment_count>6</comment_count>
    <who name="Van de Bugger">van.de.bugger</who>
    <bug_when>2016-10-19 03:25:05 -0400</bug_when>
    <thetext>&gt; You&apos;ll have to file bugs.

25 bugs? It&apos;s ridiculous.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9803494</commentid>
    <comment_count>7</comment_count>
    <who name="Petr Pisar">ppisar</who>
    <bug_when>2016-10-19 03:43:56 -0400</bug_when>
    <thetext>It&apos;s ridiculous generalizing all the tests are not worth of documentation. Have studied each of the packages? Sometimes the tests are the only available useful documentation. Each package must be considered specially, therefore a bug report for each of them.

Moreover from logistic point of view, not all of them are maintained by Emanuel. Their maintainers are not aware of your concerns. The right way in Fedora is to file a bug report for each of them.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9804403</commentid>
    <comment_count>8</comment_count>
    <who name="Emmanuel Seyman">emmanuel</who>
    <bug_when>2016-10-19 08:19:35 -0400</bug_when>
    <thetext>(In reply to Van de Bugger from comment #6)
&gt; 
&gt; 25 bugs? It&apos;s ridiculous.

Note that that&apos;s what on your system. I&apos;m sure there are more packages affected.

I plan to evaluate the need to remove tests on a case by case basis. While perl-App-Cmd&apos;s documentation is good enough that it is not necessary to include  the tests as examples of use of the module, I can&apos;t guarantee that all modules 
are like this.

It would help if you explained why you feel this is a bug. Is there an inconvenience to having the t/ directory ship in the documentation? Do they take up too much disk space? Do they drag in otherwise-unneeded deps?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9813262</commentid>
    <comment_count>9</comment_count>
    <who name="Van de Bugger">van.de.bugger</who>
    <bug_when>2016-10-22 16:54:27 -0400</bug_when>
    <thetext>&gt; It&apos;s ridiculous generalizing all the tests are not worth of documentation. 

They are tests, not examples.

&gt; It would help if you explained why you feel this is a bug.

It is my feeling.

I already said that tests are part of Perl distribution. Perl distribution installer (either cpan, cpanp, or cpanm), unpacks distribution archive, builds the module (if there are parts written in C), run tests (optionally send reports), and installs the module to the system. Tests are *not* installed. They remain in the temporary directory, which is usually removed soon. (I have large local Perl library installed directly from CPAN, it contains ~1500 *.pm files and *no* *single* *.t file.)

RPM package contains prebuilt and &quot;pretested&quot; software. Packed software was built and tested when RPM itself was building. When RPM package is installing to the user system, it just copies files (no source compiling, no testing at all (akmods are exception)). If original Perl distribution does not install tests, why RPM does it?

&gt; Sometimes the tests are the only available useful documentation. 

Anyway, it is not a reason for installing tests. End-users are not interested in tests at all. Developers may be interested, but… Did RPM packager take care about *test dependencies*? Tests may have specific requirements. For a Perl developer having local Perl library (of modules installed directly from CPAN) have many advantages over using RPMs.

&gt; Each package must be considered specially…

Indeed, it would be much better to have a policy. 

Again: If original Perl distribution does not install tests, why RPM does it?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9813275</commentid>
    <comment_count>10</comment_count>
    <who name="Emmanuel Seyman">emmanuel</who>
    <bug_when>2016-10-22 18:03:48 -0400</bug_when>
    <thetext>(In reply to Van de Bugger from comment #9)
&gt; 
&gt; They are tests, not examples.

In practice, they are sometimes the only examples of use of the module.

&gt; If original Perl distribution does not install tests, why RPM does it?

For the same reason we convert files to UTF-8 or apply patches to better integrate the modules in the system: the benefits for our users outweigh
the costs.

&gt; Anyway, it is not a reason for installing tests. End-users are not
&gt; interested in tests at all. Developers may be interested, but… Did RPM
&gt; packager take care about *test dependencies*?

We usually use the macro %{?perl_default_filter} in our spec files which
tells RPM not to use provides and requires from the documentation.

&gt; Indeed, it would be much better to have a policy.

That sounds like a job for FESCo.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9817053</commentid>
    <comment_count>11</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-24 16:23:29 -0400</bug_when>
    <thetext>perl-App-Cmd-0.330-3.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9817761</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-25 00:28:33 -0400</bug_when>
    <thetext>perl-App-Cmd-0.331-2.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>