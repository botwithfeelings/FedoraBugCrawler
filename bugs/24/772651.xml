<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>772651</bug_id>
          
          <creation_ts>2012-01-09 09:28:00 -0500</creation_ts>
          <short_desc>/usr/lib64/perl5/vendor_perl/Encode/Makefile_PL.e2x detected as C source wrongly</short_desc>
          <delta_ts>2017-02-23 10:25:40 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>file</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          <see_also>https://bugzilla.redhat.com/show_bug.cgi?id=1424989</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Patch, Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Petr Pisar">ppisar</reporter>
          <assigned_to name="Kamil Dudka">kdudka</assigned_to>
          <cc>jkaluza</cc>
    
    
    <cc>kdudka</cc>
    
    
    <cc>ppisar</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>file-5.30-4.fc26</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-02-23 10:25:40</cf_last_closed>
          <cf_type>---</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>4294959</commentid>
    <comment_count>0</comment_count>
    <who name="Petr Pisar">ppisar</who>
    <bug_when>2012-01-09 09:28:07 -0500</bug_when>
    <thetext>$ rpm -q file
file-5.10-3.fc17.x86_64

$ file /usr/share/perl5/Encode/Makefile_PL.e2x
/usr/share/perl5/Encode/Makefile_PL.e2x: C source, ASCII text

But /usr/share/perl5/Encode/Makefile_PL.e2x is Perl code:

$ head  /usr/share/perl5/Encode/Makefile_PL.e2x
#
# This file is auto-generated by:
# enc2xs version $_Version_
# $_Now_
#
use 5.7.2;
use strict;
use ExtUtils::MakeMaker;
use Config;

This is regression against file-5.09-1.fc17.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>4297182</commentid>
    <comment_count>1</comment_count>
    <who name="Jan KaluÅ¾a">jkaluza</who>
    <bug_when>2012-01-10 02:56:10 -0500</bug_when>
    <thetext>Thanks for the report. It should be fixed in file-5.10-4.fc17.

Upstream bug report: http://bugs.gw.com/view.php?id=166</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>4297407</commentid>
    <comment_count>2</comment_count>
    <who name="Petr Pisar">ppisar</who>
    <bug_when>2012-01-10 04:24:44 -0500</bug_when>
    <thetext>Fix verified. Thank you.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10167041</commentid>
    <comment_count>3</comment_count>
    <who name="Kamil Dudka">kdudka</who>
    <bug_when>2017-02-20 08:44:29 -0500</bug_when>
    <thetext>The Fedora patch for this bug has never been applied upstream and it is known to cause problems (see bug #1424989).  Based on the info from the above ticket on the upstream bug tracker, this bug is already fixed upstream in a different way.

I am about to drop the downstream patch from Fedora now.  Petr, do you have any data I can use to verify if this bug is fixed upstream?

/usr/share/perl5/Encode/Makefile_PL.e2x does not exist on my Fedora 24 box...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10167132</commentid>
    <comment_count>4</comment_count>
    <who name="Petr Pisar">ppisar</who>
    <bug_when>2017-02-20 09:06:00 -0500</bug_when>
    <thetext>The bug report mentions Fedora 17. /usr/share/perl5/Encode/Makefile_PL.e2x is delivered by perl-devel-5.14.4-224.fc17.x86_64.rpm there and I can assure you that file-5.25-6.fc24.x86_64 still misinterprets the file:

$ wget -q -O - https://kojipkgs.fedoraproject.org//packages/perl/5.14.4/224.fc17/x86_64/perl-devel-5.14.4-224.fc17.x86_64.rpm | rpm2cpio | cpio -i --to-stdout ./usr/share/perl5/Encode/Makefile_PL.e2x | file -
3823 blocks
/dev/stdin: C source, ASCII text

$ rpm -qf /usr/bin/file
file-5.25-6.fc24.x86_64

F24 provides the file in perl-Encode-devel under /usr/lib64/perl5/vendor_perl/Encode/Makefile_PL.e2x path and it also exhibits the same problem:

$ file /usr/lib64/perl5/vendor_perl/Encode/Makefile_PL.e2x
/usr/lib64/perl5/vendor_perl/Encode/Makefile_PL.e2x: C source, ASCII text</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10167138</commentid>
    <comment_count>5</comment_count>
    <who name="Petr Pisar">ppisar</who>
    <bug_when>2017-02-20 09:07:05 -0500</bug_when>
    <thetext>So it looks like a regression in Fedora because Fedora 24 is broken again. Reopening this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10167215</commentid>
    <comment_count>6</comment_count>
    <who name="Kamil Dudka">kdudka</who>
    <bug_when>2017-02-20 09:23:52 -0500</bug_when>
    <thetext>Thanks!  So it does not work anyway...

The patch we have in Fedora is not the patch that was originally applied for this bug.  The contents of file-5.10-strength.patch was (by mistake?) rewritten two years later:

http://pkgs.fedoraproject.org/cgit/rpms/file.git/diff/file-5.10-strength.patch?id=3ddc6949

The patch for this bug patched Magdir/c-lang whereas the current patch (with the same file name) patches Magdir/python.  The commit message only says &quot;update to version 5.19&quot;:

http://pkgs.fedoraproject.org/cgit/rpms/file.git/commit/?id=3ddc6949</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10167301</commentid>
    <comment_count>7</comment_count>
      <attachid>1255707</attachid>
    <who name="Kamil Dudka">kdudka</who>
    <bug_when>2017-02-20 09:37:37 -0500</bug_when>
    <thetext>Created attachment 1255707
reproducer</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10173544</commentid>
    <comment_count>8</comment_count>
    <who name="Kamil Dudka">kdudka</who>
    <bug_when>2017-02-22 02:49:22 -0500</bug_when>
    <thetext>upstream commit:
https://github.com/file/file/commit/3c60e59a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10178729</commentid>
    <comment_count>9</comment_count>
    <who name="Kamil Dudka">kdudka</who>
    <bug_when>2017-02-23 10:25:40 -0500</bug_when>
    <thetext>downstream commit:
http://pkgs.fedoraproject.org/cgit/rpms/file.git/commit/?id=909293dc</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1255707</attachid>
            <date>2017-02-20 09:37:00 -0500</date>
            <delta_ts>2017-02-20 13:57:22 -0500</delta_ts>
            <desc>reproducer</desc>
            <filename>Makefile_PL.e2x</filename>
            <type>text/plain</type>
            <size>4733</size>
            <attacher name="Kamil Dudka">kdudka</attacher>
            
              <data encoding="base64">IwojIFRoaXMgZmlsZSBpcyBhdXRvLWdlbmVyYXRlZCBieToKIyBlbmMyeHMgdmVyc2lvbiAkX1Zl
cnNpb25fCiMgJF9Ob3dfCiMKdXNlIDUuNy4yOwp1c2Ugc3RyaWN0Owp1c2UgRXh0VXRpbHM6Ok1h
a2VNYWtlcjsKdXNlIENvbmZpZzsKCiMgUGxlYXNlIGVkaXQgdGhlIGZvbGxvd2luZyB0byB0aGUg
dGFzdGUhCm15ICRuYW1lID0gJyRfTmFtZV8nOwpteSAldGFibGVzID0gKAogICAgICAgICAkX05h
bWVfX3QgICA9PiBbICRfVGFibGVGaWxlc18gXSwKICAgICAgICAgKTsKCiMjIyMgRE8gTk9UIEVE
SVQgQkVZT05EIFRISVMgUE9JTlQhCnJlcXVpcmUgRmlsZTo6U3BlYzsKbXkgKCRlbmMyeHMsICRl
bmNvZGVfaCkgPSAoKTsKUEFUSExPT1A6CmZvciBteSAkZCAoQENvbmZpZ3txdy9iaW4gc2l0ZWJp
biB2ZW5kb3JiaW4vfSwgCiAgICAgICAoc3BsaXQgLyRDb25maWd7cGF0aF9zZXB9L28sICRFTlZ7
UEFUSH0pKXsKICAgIGZvciBteSAkZiAocXcvZW5jMnhzIGVuYzJ4czUuNy4zLyl7CiAgICAgICAg
bXkgJHBhdGggPSBGaWxlOjpTcGVjLT5jYXRmaWxlKCRkLCAkZik7CiAgICAgICAgLXIgJHBhdGgg
YW5kICRlbmMyeHMgPSAkcGF0aCBhbmQgbGFzdCBQQVRITE9PUDsKICAgIH0KfQokZW5jMnhzIG9y
IGRpZSAiZW5jMnhzIG5vdCBmb3VuZCEiOwpwcmludCAiZW5jMnhzIGlzICRlbmMyeHNcbiI7Cm15
ICVlbmNvZGVfaCA9ICgpOwpmb3IgbXkgJGQgKEBJTkMpewogICAgbXkgJGRpciA9IEZpbGU6OlNw
ZWMtPmNhdGZpbGUoJGQsICJFbmNvZGUiKTsKICAgIG15ICRmaWxlID0gIEZpbGU6OlNwZWMtPmNh
dGZpbGUoJGRpciwgImVuY29kZS5oIik7CiAgICAtZiAkZmlsZSBhbmQgJGVuY29kZV9oeyRkaXJ9
ID0gLU0gJGZpbGU7Cn0KJWVuY29kZV9oIG9yIGRpZSAiZW5jb2RlLmggbm90IGZvdW5kISI7CiMg
ZmluZCB0aGUgbGF0ZXN0IG9uZQooJGVuY29kZV9oKSA9IHNvcnQgeyRlbmNvZGVfaHskYn0gPD0+
ICRlbmNvZGVfaHskYX19IGtleXMgJWVuY29kZV9oOwpwcmludCAiZW5jb2RlLmggaXMgYXQgJGVu
Y29kZV9oXG4iOwoKV3JpdGVNYWtlZmlsZSgKICAgICAgICAgICAgICBJTkMJCT0+ICItSSRlbmNv
ZGVfaCIsCiMjIyMgRU5EX09GX0hFQURFUiAtLSBETyBOT1QgRURJVCBUSElTIExJTkUgQlkgSEFO
RCEgIyMjIwogICAgICAgICAgTkFNRQkJPT4gJ0VuY29kZTo6Jy4kbmFtZSwKICAgICAgICAgIFZF
UlNJT05fRlJPTQk9PiAiJG5hbWUucG0iLAogICAgICAgICAgT0JKRUNUCQk9PiAnJChPX0ZJTEVT
KScsCiAgICAgICAgICAnZGlzdCcJCT0+IHsKICAgICAgICAgIENPTVBSRVNTCT0+ICdnemlwIC05
ZicsCiAgICAgICAgICBTVUZGSVgJPT4gJ2d6JywKICAgICAgICAgIERJU1RfREVGQVVMVCA9PiAn
YWxsIHRhcmRpc3QnLAogICAgICAgICAgfSwKICAgICAgICAgIE1BTjNQT0RTCT0+IHt9LAogICAg
ICAgICAgUFJFUkVRX1BNID0+IHsKICAgICAgICAgICAgICAgICdFbmNvZGUnICAgICA9PiAiMS40
MSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAjIE9TIDM5MCB3aW5n
ZXMgYWJvdXQgbGluZSBudW1iZXJzID4gNjRLID8/PwogICAgICAgICAgWFNPUFQgPT4gJy1ub2xp
bmVudW1iZXJzJywKICAgICAgICAgICk7CgpwYWNrYWdlIE1ZOwoKc3ViIHBvc3RfaW5pdGlhbGl6
ZQp7CiAgICBteSAoJHNlbGYpID0gQF87CiAgICBteSAlbzsKICAgIG15ICR4ID0gJHNlbGYtPnsn
T0JKX0VYVCd9OwogICAgIyBBZGQgdGhlIHRhYmxlIE9fRklMRVMKICAgIGZvcmVhY2ggbXkgJGUg
KGtleXMgJXRhYmxlcykKICAgIHsKICAgICRveyRlLiR4fSA9IDE7CiAgICB9CiAgICAkb3siJG5h
bWUkeCJ9ID0gMTsKICAgICRzZWxmLT57J09fRklMRVMnfSA9IFtzb3J0IGtleXMgJW9dOwogICAg
bXkgQGZpbGVzID0gKCIkbmFtZS54cyIpOwogICAgJHNlbGYtPnsnQyd9ID0gWyIkbmFtZS5jIl07
CiAgICAjIFRoZSBuZXh0IHR3byBsaW5lcyB0byBtYWtlIE1hY1BlcmwgSGFwcHkgLS0gZGFua29n
YWkgdmlhIHB1ZGdlCiAgICAkc2VsZi0+e1NPVVJDRX0gLj0gIiAkbmFtZS5jIgogICAgICAgIGlm
ICReTyBlcSAnTWFjT1MnICYmICRzZWxmLT57U09VUkNFfSAhfiAvXGIkbmFtZVwuY1xiLzsKICAg
ICMgJHNlbGYtPnsnSCd9ID0gWyRzZWxmLT5jYXRmaWxlKCRzZWxmLT51cGRpciwnZW5jb2RlLmgn
KV07CiAgICBteSAleHM7CiAgICBmb3JlYWNoIG15ICR0YWJsZSAoa2V5cyAldGFibGVzKSB7CiAg
ICBwdXNoIChAeyRzZWxmLT57J0MnfX0sIiR0YWJsZS5jIik7CiAgICAjIERvIE5PVCBhZGQgJHRh
YmxlLmggZXRjLiB0byBIX0ZJTEVTIHVubGVzcyB3ZSBvd24gdXAgYXMgdG8gaG93IHRoZXkKICAg
ICMgZ2V0IGJ1aWx0LgogICAgZm9yZWFjaCBteSAkZXh0IChxdygkKE9CSl9FWFQpIC5jIC5oIC5l
eGggLmZubSkpIHsKICAgICAgICBwdXNoIChAZmlsZXMsJHRhYmxlLiRleHQpOwogICAgfQogICAg
fQogICAgJHNlbGYtPnsnWFMnfSA9IHsgIiRuYW1lLnhzIiA9PiAiJG5hbWUuYyIgfTsKICAgICRz
ZWxmLT57J2NsZWFuJ317J0ZJTEVTJ30gLj0gam9pbignICcsQGZpbGVzKTsKICAgIG9wZW4oWFMs
Ij4kbmFtZS54cyIpIHx8IGRpZSAiQ2Fubm90IG9wZW4gJG5hbWUueHM6JCEiOwogICAgcHJpbnQg
WFMgPDwnRU5EJzsKI2luY2x1ZGUgPEVYVEVSTi5oPgojaW5jbHVkZSA8cGVybC5oPgojaW5jbHVk
ZSA8WFNVQi5oPgojZGVmaW5lIFU4IFU4CiNpbmNsdWRlICJlbmNvZGUuaCIKRU5ECiAgICBmb3Jl
YWNoIG15ICR0YWJsZSAoa2V5cyAldGFibGVzKSB7CiAgICBwcmludCBYUyBxcVsjaW5jbHVkZSAi
JHt0YWJsZX0uaCJcbl07CiAgICB9CiAgICBwcmludCBYUyA8PCJFTkQiOwoKc3RhdGljIHZvaWQK
RW5jb2RlX1hTRW5jb2RpbmcocFRIWF8gZW5jb2RlX3QgKmVuYykKewogZFNQOwogSFYgKnN0YXNo
ID0gZ3Zfc3Rhc2hwdigiRW5jb2RlOjpYUyIsIFRSVUUpOwogU1YgKnN2ICAgID0gc3ZfYmxlc3Mo
bmV3UlZfbm9pbmMobmV3U1ZpdihQVFIySVYoZW5jKSkpLHN0YXNoKTsKIGludCBpID0gMDsKIFBV
U0hNQVJLKHNwKTsKIFhQVVNIcyhzdik7CiB3aGlsZSAoZW5jLT5uYW1lW2ldKQogIHsKICAgY29u
c3QgY2hhciAqbmFtZSA9IGVuYy0+bmFtZVtpKytdOwogICBYUFVTSHMoc3ZfMm1vcnRhbChuZXdT
VnB2bihuYW1lLHN0cmxlbihuYW1lKSkpKTsKICB9CiBQVVRCQUNLOwogY2FsbF9wdigiRW5jb2Rl
OjpkZWZpbmVfZW5jb2RpbmciLEdfRElTQ0FSRCk7CiBTdlJFRkNOVF9kZWMoc3YpOwp9CgpNT0RV
TEUgPSBFbmNvZGU6OiRuYW1lCVBBQ0tBR0UgPSBFbmNvZGU6OiRuYW1lClBST1RPVFlQRVM6IERJ
U0FCTEUKQk9PVDoKewpFTkQKICAgIGZvcmVhY2ggbXkgJHRhYmxlIChrZXlzICV0YWJsZXMpIHsK
ICAgIHByaW50IFhTIHFxWyNpbmNsdWRlICIke3RhYmxlfS5leGgiXG5dOwogICAgfQogICAgcHJp
bnQgWFMgIn1cbiI7CiAgICBjbG9zZShYUyk7CiAgICByZXR1cm4gIiMgQnVpbHQgJG5hbWUueHNc
blxuIjsKfQoKc3ViIHBvc3RhbWJsZQp7CiAgICBteSAkc2VsZiA9IHNoaWZ0OwogICAgbXkgJGRp
ciAgPSAiLiI7ICMgJHNlbGYtPmNhdGRpcignRW5jb2RlJyk7CiAgICBteSAkc3RyICA9ICIjICRu
YW1lXCQoT0JKX0VYVCkgZGVwZW5kcyBvbiAuaCBhbmQgLmV4aCBmaWxlcyBub3QgLmMgZmlsZXMg
LSBidXQgYWxsIHdyaXR0ZW4gYnkgZW5jMnhzXG4iOwogICAgJHN0ciAgICAuPSAiJG5hbWUuYyA6
ICRuYW1lLnhzICI7CiAgICBmb3JlYWNoIG15ICR0YWJsZSAoa2V5cyAldGFibGVzKQogICAgewog
ICAgJHN0ciAuPSAiICR0YWJsZS5jIjsKICAgIH0KICAgICRzdHIgLj0gIlxuXG4iOwogICAgJHN0
ciAuPSAiJG5hbWVcJChPQkpfRVhUKSA6ICRuYW1lLmNcblxuIjsKCiAgICBmb3JlYWNoIG15ICR0
YWJsZSAoa2V5cyAldGFibGVzKQogICAgewogICAgbXkgJG51bWxpbmVzID0gMTsKICAgIG15ICRs
ZW5ndGhzb2ZhciA9IGxlbmd0aCgkc3RyKTsKICAgIG15ICRjb250aW51YXRvciA9ICcnOwogICAg
JHN0ciAuPSAiJHRhYmxlLmMgOiBNYWtlZmlsZS5QTCI7CiAgICBmb3JlYWNoIG15ICRmaWxlIChA
eyR0YWJsZXN7JHRhYmxlfX0pCiAgICB7CiAgICAgICAgJHN0ciAuPSAkY29udGludWF0b3IuJyAn
LiRzZWxmLT5jYXRmaWxlKCRkaXIsJGZpbGUpOwogICAgICAgIGlmICggbGVuZ3RoKCRzdHIpLSRs
ZW5ndGhzb2ZhciA+IDEyOCokbnVtbGluZXMgKQogICAgICAgIHsKICAgICAgICAkY29udGludWF0
b3IgLj0gIiBcXFxuXHQiOwogICAgICAgICRudW1saW5lcysrOwogICAgICAgIH0gZWxzZSB7CiAg
ICAgICAgJGNvbnRpbnVhdG9yID0gJyc7CiAgICAgICAgfQogICAgfQogICAgbXkgJHBsaWIgICA9
ICRzZWxmLT57UEVSTF9DT1JFfSA/ICciLUkkKFBFUkxfTElCKSInIDogJyc7CiAgICBteSAkdWNv
cHRzID0gJy0iUSInOwogICAgJHN0ciAuPSAgCiAgICAgICAgcXF7XG5cdFwkKFBFUkwpICRwbGli
ICRlbmMyeHMgJHVjb3B0cyAtbyBcJFxAIC1mICR0YWJsZS5mbm1cblxufTsKICAgIG9wZW4gKEZJ
TEVMSVNULCAiPiR0YWJsZS5mbm0iKQogICAgICAgIHx8IGRpZSAiQ291bGQgbm90IG9wZW4gJHRh
YmxlLmZubTogJCEiOwogICAgZm9yZWFjaCBteSAkZmlsZSAoQHskdGFibGVzeyR0YWJsZX19KQog
ICAgewogICAgICAgIHByaW50IEZJTEVMSVNUICRzZWxmLT5jYXRmaWxlKCRkaXIsJGZpbGUpIC4g
IlxuIjsKICAgIH0KICAgIGNsb3NlKEZJTEVMSVNUKTsKICAgIH0KICAgIHJldHVybiAkc3RyOwp9
Cgo=
</data>

          </attachment>
      

    </bug>

</bugzilla>