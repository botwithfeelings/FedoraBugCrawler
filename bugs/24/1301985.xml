<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1301985</bug_id>
          
          <creation_ts>2016-01-26 08:35:00 -0500</creation_ts>
          <short_desc>mockbuild unable to read source rpm</short_desc>
          <delta_ts>2016-06-27 23:19:31 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>mock</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Matthew Gyurgyik">matthew</reporter>
          <assigned_to name="Miroslav Suchý">msuchy</assigned_to>
          <cc>jdisnard</cc>
    
    
    <cc>mebrown</cc>
    
    
    <cc>msimacek</cc>
    
    
    <cc>msuchy</cc>
    
    
    <cc>praiskup</cc>
    
    
    <cc>williams</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>mock-1.2.18-1.fc23 mock-1.2.18-1.fc24 mock-1.2.18-1.el7 mock-1.2.18-1.el6</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-06-13 00:56:03</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9010671</commentid>
    <comment_count>0</comment_count>
    <who name="Matthew Gyurgyik">matthew</who>
    <bug_when>2016-01-26 08:35:55 -0500</bug_when>
    <thetext>Description of problem:

mock fails because the mockbuild user can&apos;t read the .src.rpm.


Version-Release number of selected component (if applicable):
mock-1.2.14

How reproducible: Always


Steps to Reproduce:
1. chmod 640 /tmp/pl-gcc-4.9.3-1.el7.src.rpm
2. mock -r epel-7-x86_64 --rebuild /tmp/pl-gcc-4.9.3-1.el7.src.rpm 
3.

Actual results:

ERROR: Command failed. See logs for output.
 # /usr/bin/systemd-nspawn -q -M 80cfcb408a6a414ba6c893293f11c766 -D /var/lib/mock/epel-7-x86_64/root /bin/su -l mockbuild -c /bin/rpm -Uvh --nodeps /builddir/build/originals/pl-gcc-4.9.3-1.el7.src.rpm


[build2 SPECS]$ sudo /usr/bin/systemd-nspawn -q -M 80cfcb408a6a414ba6c893293f11c766 -D /var/lib/mock/epel-7-x86_64/root
-bash-4.2# ls -l /builddir/build/originals/pl-gcc-4.9.3-1.el7.src.rpm
-rw-r-----. 1 root root 124343301 Jan 26 08:27 /builddir/build/originals/pl-gcc-4.9.3-1.el7.src.rpm


Expected results:

SRPM should be copied to the /buildroot with 644.

Additional info:
Build is successful when permissions on /tmp/pl-gcc-4.9.3-1.el7.src.rpm are 644</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9010773</commentid>
    <comment_count>1</comment_count>
    <who name="Matthew Gyurgyik">matthew</who>
    <bug_when>2016-01-26 09:00:32 -0500</bug_when>
    <thetext>I&apos;m have no familiarity with the code base, but if I was to take a stab at this...

I think the shutil.copy2() call on line 370 (copy_srpm_into_chroot function) in backend.py could be replaced with shutil.copyfile(). According the the python documentation, copyfile() will copy the file contents, ignoring file metadata and permission bits. I don&apos;t think it&apos;s important to preserve metadata or permission bits (but since copy2() is being used, perhaps someone felt it was).

If the file metadata is important, you could always just issue os.chmod() after shutil.copy2().

I would be willing to provide a patch with either approach if that would be helpful.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9092954</commentid>
    <comment_count>2</comment_count>
    <who name="Jan Kurik">jkurik</who>
    <bug_when>2016-02-24 09:20:59 -0500</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 24 development cycle.
Changing version to &apos;24&apos;.

More information and reason for this action is here:
https://fedoraproject.org/wiki/Fedora_Program_Management/HouseKeeping/Fedora24#Rawhide_Rebase</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9401221</commentid>
    <comment_count>3</comment_count>
    <who name="Miroslav Suchý">msuchy</who>
    <bug_when>2016-06-09 09:53:27 -0400</bug_when>
    <thetext>Fixed by commit
* 6829caa copy just content of SRPM not the attributes [RHBZ#1301985]</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404035</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 09:13:33 -0400</bug_when>
    <thetext>mock-1.2.16-1.fc22 has been submitted as an update to Fedora 22. https://bodhi.fedoraproject.org/updates/FEDORA-2016-89209fd48b</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404040</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 09:13:54 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-70cdc0c410</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404045</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 09:14:12 -0400</bug_when>
    <thetext>mock-1.2.18-1.el7 has been submitted as an update to Fedora EPEL 7. https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2016-3d9f899f6a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404049</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 09:14:33 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc23 has been submitted as an update to Fedora 23. https://bodhi.fedoraproject.org/updates/FEDORA-2016-de15171a43</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404053</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 09:14:54 -0400</bug_when>
    <thetext>mock-1.2.18-1.el6 has been submitted as an update to Fedora EPEL 6. https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2016-9e2f372208</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9404730</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 13:59:41 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-70cdc0c410</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9405194</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 23:18:21 -0400</bug_when>
    <thetext>mock-1.2.18-1.el6 has been pushed to the Fedora EPEL 6 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2016-9e2f372208</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9405199</commentid>
    <comment_count>11</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 23:19:04 -0400</bug_when>
    <thetext>mock-1.2.18-1.el7 has been pushed to the Fedora EPEL 7 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2016-3d9f899f6a</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9405206</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 23:53:28 -0400</bug_when>
    <thetext>mock-1.2.16-1.fc22 has been pushed to the Fedora 22 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-89209fd48b</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9405214</commentid>
    <comment_count>13</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-10 23:54:02 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc23 has been pushed to the Fedora 23 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-de15171a43</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9407840</commentid>
    <comment_count>14</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-13 00:55:48 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc23 has been pushed to the Fedora 23 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9430063</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-18 14:34:08 -0400</bug_when>
    <thetext>mock-1.2.18-1.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9456788</commentid>
    <comment_count>16</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-27 15:48:29 -0400</bug_when>
    <thetext>mock-1.2.18-1.el7 has been pushed to the Fedora EPEL 7 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9457448</commentid>
    <comment_count>17</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-06-27 23:19:16 -0400</bug_when>
    <thetext>mock-1.2.18-1.el6 has been pushed to the Fedora EPEL 6 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>