<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1310753</bug_id>
          
          <creation_ts>2016-02-22 10:37:00 -0500</creation_ts>
          <short_desc>qt5-qtwebengine FTBFS on aarch64</short_desc>
          <delta_ts>2016-03-21 04:29:28 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>qt5-qtwebengine</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          <dependson>1311125</dependson>
          <blocked>922257</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Marcin Juszkiewicz">mjuszkie</reporter>
          <assigned_to name="Kevin Kofler">kevin</assigned_to>
          <cc>kde-sig</cc>
    
    
    <cc>kevin</cc>
    
    
    <cc>pbrobinson</cc>
    
    
    <cc>rdieter</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>qt5-qtwebengine-5.6.0-0.17.beta.fc24</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-03-21 04:29:28</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9084920</commentid>
    <comment_count>0</comment_count>
    <who name="Marcin Juszkiewicz">mjuszkie</who>
    <bug_when>2016-02-22 10:37:39 -0500</bug_when>
    <thetext>Description of problem:

qt5-qtwebengine source is 0.2% of whole source. Rest is Chromium source code. 65.2% of which is set of 3rdparty code which involves:

- icu
- mesa
- skia
- ffmpeg (cleaned by qt5-qtwebengine maintainer)
- sqlite
- webrtc
- yasm

And many other software directories which are (or can) be part of Fedora as separate packages.

The problem is that those bundled components are often old and do not contain changes needed for qt5-qtwebengine to build on secondary architectures.

Version-Release number of selected component (if applicable):

5.6.0-0.16.beta

How reproducible:

always

Steps to Reproduce:
1. run on aarch64 (arm-koji scratch is enough)

Actual results:

In file included from /builddir/build/BUILD/qtwebengine-opensource-src-5.6.0-beta/src/3rdparty/chromium/third_party/ffmpeg/libavutil/intreadwrite.h:25:0,
                 from /builddir/build/BUILD/qtwebengine-opensource-src-5.6.0-beta/src/3rdparty/chromium/third_party/ffmpeg/libavcodec/get_bits.h:32,
                 from /builddir/build/BUILD/qtwebengine-opensource-src-5.6.0-beta/src/3rdparty/chromium/third_party/ffmpeg/libavcodec/vp3.c:39:
/builddir/build/BUILD/qtwebengine-opensource-src-5.6.0-beta/src/3rdparty/chromium/third_party/ffmpeg/libavutil/bswap.h:38:30: fatal error: aarch64/bswap.h: No such file or directory
 #   include &quot;aarch64/bswap.h&quot;
                              ^
compilation terminated.


Expected results:

package builds

Additional info:

IMHO missing components (like ffmpeg) should be packaged for Fedora and used as build dependencies.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9086270</commentid>
    <comment_count>1</comment_count>
    <who name="Kevin Kofler">kevin</who>
    <bug_when>2016-02-22 18:51:02 -0500</bug_when>
    <thetext>&quot;Package is 99.8% bundled Chromium code which contains another set of 3rd party code&quot; is not a bug according to the current packaging guidelines. And I tried hard to unbundle things. Various components cannot be unbundled for various reasons. The main reason FFmpeg cannot be unbundled is that a fully featured FFmpeg cannot be provided in Fedora. The bundled version is cleaned by a script to only contain known unencumbered parts, which is also where the build failure is coming from. (We would have the same build failure if it were packaged standalone.)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9086397</commentid>
    <comment_count>2</comment_count>
    <who name="Kevin Kofler">kevin</who>
    <bug_when>2016-02-22 19:49:21 -0500</bug_when>
    <thetext>Should be fixed in Rawhide (fixed package now building on the primary architectures, but there will be no difference on those), thanks for the 2-line patch to clean_ffmpeg.sh you linked to on IRC.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9086843</commentid>
    <comment_count>3</comment_count>
    <who name="Marcin Juszkiewicz">mjuszkie</who>
    <bug_when>2016-02-23 01:31:50 -0500</bug_when>
    <thetext>&quot;should be&quot; is wish thinking. I am in a middle of getting it into buildable state.

Adding those two files to ffmpeg was beginning.

/builddir/build/BUILD/qtwebengine-opensource-src-5.6.0-beta/aarch64-redhat-linux-gnu/src/core/Release/obj/src/3rdparty/chromium/third_party/webrtc/modules/video_coding/codecs/vp8/libwebrtc_vp8.a(/builddir/build/BUILD/qtwebengine-opensource-src-5.6.0-beta/aarch64-redhat-linux-gnu/src/core/Release/obj/src/3rdparty/chromium/third_party/webrtc/modules/video_coding/codecs/vp8/webrtc_vp8.vp8_impl.o):vp8_impl.cc:function webrtc::VP8EncoderImpl::InitAndSetControlSettings(): error: undefined reference to &apos;vpx_codec_enc_init_multi_ver&apos;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9088122</commentid>
    <comment_count>4</comment_count>
    <who name="Kevin Kofler">kevin</who>
    <bug_when>2016-02-23 08:48:46 -0500</bug_when>
    <thetext>OK. I hope at least the tarball is good now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9094220</commentid>
    <comment_count>5</comment_count>
    <who name="Jan Kurik">jkurik</who>
    <bug_when>2016-02-24 10:28:43 -0500</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 24 development cycle.
Changing version to &apos;24&apos;.

More information and reason for this action is here:
https://fedoraproject.org/wiki/Fedora_Program_Management/HouseKeeping/Fedora24#Rawhide_Rebase</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9153224</commentid>
    <comment_count>6</comment_count>
    <who name="Peter Robinson">pbrobinson</who>
    <bug_when>2016-03-16 10:10:31 -0400</bug_when>
    <thetext>So still seeing some issues here on both aarch64 and ppc

PPC: http://ppc.koji.fedoraproject.org/koji/taskinfo?taskID=3220219

gyp: Undefined variable platform_heap_asm_files in /builddir/build/BUILD/qtwebengine-opensource-src-5.6.0-rc/src/3rdparty/chromium/third_party/WebKit/Source/platform/blink_platform.gyp
Project ERROR: -- running gyp_qtwebengine failed --
Makefile:116: recipe for target &apos;sub-gyp_run-pro-make_first&apos; failed

aarch64: http://arm.koji.fedoraproject.org/koji/taskinfo?taskID=3457421

/third_party/libjingle/libjingle_p2p_constants.a /builddir/build/BUILD/qtwebengine-opensource-src-5.6.0-rc/aarch64-redhat-linux-gnu/src/core/Release/obj/src/3rdparty/chromium/third_party/webrtc/modules/libvideo_render.a -Wl,--end-group -lrt -ldl -lgmodule-2.0 -lgobject-2.0 -lgthread-2.0 -lglib-2.0 -levent -lsmime3 -lnss3 -lnssutil3 -lplds4 -lplc4 -lnspr4 -lpthread -licui18n -licuuc -licudata -lprotobuf -lz -lresolv -lfontconfig -lfreetype -lharfbuzz-icu -lharfbuzz -lpng16 -ljpeg -lX11 -lXi -lXcursor -lXext -lXfixes -lXrender -lXss -lpci -lre2 -lXcomposite -lasound -lopus -lm -lvpx -lXdamage -lXtst -lXrandr -lwebp -lwebpdemux -lxml2 -lxslt -lsnappy -lexpat -ldbus-1 -lminizip -lsrtp -L/builddir/build/BUILD/qtwebengine-opensource-src-5.6.0-rc/aarch64-redhat-linux-gnu/src/core/api/Release -Wl,-whole-archive -lqtwebenginecoreapi -Wl,-no-whole-archive -lEGL -lQt5Quick -lQt5Gui -lQt5Qml -lQt5Network -lQt5Core -lGL 
/builddir/build/BUILD/qtwebengine-opensource-src-5.6.0-rc/aarch64-redhat-linux-gnu/src/core/Release/obj/src/3rdparty/chromium/third_party/webrtc/modules/video_coding/codecs/vp8/libwebrtc_vp8.a(/builddir/build/BUILD/qtwebengine-opensource-src-5.6.0-rc/aarch64-redhat-linux-gnu/src/core/Release/obj/src/3rdparty/chromium/third_party/webrtc/modules/video_coding/codecs/vp8/webrtc_vp8.vp8_impl.o):vp8_impl.cc:function webrtc::VP8EncoderImpl::InitAndSetControlSettings(): error: undefined reference to &apos;vpx_codec_enc_init_multi_ver&apos;
Makefile.core_module:154: recipe for target &apos;../../lib/libQt5WebEngineCore.so.5.6.0&apos; failed
collect2: error: ld returned 1 exit status</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9153248</commentid>
    <comment_count>7</comment_count>
    <who name="Marcin Juszkiewicz">mjuszkie</who>
    <bug_when>2016-03-16 10:16:03 -0400</bug_when>
    <thetext>bug 1311125 is change to libvpx package which is needed to fix this package</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9163706</commentid>
    <comment_count>8</comment_count>
    <who name="Marcin Juszkiewicz">mjuszkie</who>
    <bug_when>2016-03-21 04:29:28 -0400</bug_when>
    <thetext>http://arm.koji.fedoraproject.org/koji/buildinfo?buildID=362634 got built</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>