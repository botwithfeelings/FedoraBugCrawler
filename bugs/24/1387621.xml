<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1387621</bug_id>
          
          <creation_ts>2016-10-21 07:52:00 -0400</creation_ts>
          <short_desc>dnf module doesn&apos;t work with a rawhide host</short_desc>
          <delta_ts>2016-11-19 16:12:21 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>ansible</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>high</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Vratislav Podzimek">vpodzime</reporter>
          <assigned_to name="Kevin Fenzi">kevin</assigned_to>
          <cc>a.badger</cc>
    
    
    <cc>athmanem</cc>
    
    
    <cc>jkonecny</cc>
    
    
    <cc>jsilhan</cc>
    
    
    <cc>kevin</cc>
    
    
    <cc>kupo</cc>
    
    
    <cc>mark</cc>
    
    
    <cc>maxim</cc>
    
    
    <cc>orion</cc>
    
    
    <cc>toromoti</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>ansible-2.2.0.0-3.fc24 ansible-2.2.0.0-3.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-11-07 18:27:48</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9811069</commentid>
    <comment_count>0</comment_count>
    <who name="Vratislav Podzimek">vpodzime</who>
    <bug_when>2016-10-21 07:52:21 -0400</bug_when>
    <thetext>Description of problem:
When trying to use the &apos;dnf&apos; module in one of my tasks, I&apos;m getting errors like this:

fatal: [IP_ADDRESS_REMOVED]: FAILED! =&gt; {&quot;changed&quot;: false, &quot;failed&quot;: true, &quot;module_stderr&quot;: &quot;&quot;, &quot;module_stdout&quot;: &quot;No handlers could be found for logger \&quot;dnf\&quot;\r\nTraceback (most recent call last):\r\n  File \&quot;/tmp/ansible_LDnNIF/ansible_module_dnf.py\&quot;, line 355, in &lt;module&gt;\r\n    main()\r\n  File \&quot;/tmp/ansible_LDnNIF/ansible_module_dnf.py\&quot;, line 349, in main\r\n    ensure(module, base, params[&apos;state&apos;], params[&apos;name&apos;])\r\n  File \&quot;/tmp/ansible_LDnNIF/ansible_module_dnf.py\&quot;, line 240, in ensure\r\n    pkg_specs, group_specs, filenames = cli.commands.parse_spec_group_file(\r\nAttributeError: &apos;module&apos; object has no attribute &apos;parse_spec_group_file&apos;\r\n&quot;, &quot;msg&quot;: &quot;MODULE FAILURE&quot;}


Version-Release number of selected component (if applicable):
ansible-2.1.2.0-1.fc24.noarch
python2-dnf-2.0.0-0.rc1.4.fc26.noarch (on the managed host)

How reproducible:
100%

Steps to Reproduce:
1. try to use the &apos;dnf&apos; module (e.g to install a package) on a rawhide host

Actual results:
an error

Expected results:
packages installed/checked as installed

Additional info:
This is probably related to the change that introduced DNF 2.0 (API) in Rawhide. DNF developers (CC&apos;d) say that the ansible module is using something that has never been part of the API (in the above traceback).

Also please note that this makes a lot of ansible playbooks unusable with Rawhide hosts and may result in people going back to &apos;cmd: dnf install SOMETHING&apos; instead of using the &apos;dnf&apos; module.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9811586</commentid>
    <comment_count>1</comment_count>
    <who name="Toshio Ernie Kuratomi">a.badger</who>
    <bug_when>2016-10-21 10:28:59 -0400</bug_when>
    <thetext>Do you have a github login?  Would you be willing to file a bug upstream? https://github.com/ansible/ansible-modules-extras/issues/new

We, upstream, are in the late stages of the 2.2.0 release candidate process... not sure if a fix for this will get into 2.2.0 or will have to wait for 2.2.1.  Pinging others about whether this is a blocker for 2.2.0 or not.  On the one hand package managers are always important modules.  On the other hand, dnf is an extras module so it depends on getting the community maintainers involved (I don&apos;t see ignatenkobrain CC&apos;d above; he&apos;s the one that got the ball rolling on rewriting dnf to use the API so he&apos;ll probably be the community maintainer we rely upon to write a fix that works with both dnf-1.x and dnf-2.x), there&apos;s workarounds (command module or yum module), and since rawhide is still early stages as well we&apos;ll probably have 2.2.1 out before rawhide becomes Fedora 26.

I&apos;ll add more about the status of fixing this in 2.2.0 vs 2.2.1 once more of the team has replied.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9811618</commentid>
    <comment_count>2</comment_count>
    <who name="Kevin Fenzi">kevin</who>
    <bug_when>2016-10-21 10:47:18 -0400</bug_when>
    <thetext>I don&apos;t think this needs to block the 2.2.0 release. We can add a patch when we have one to fix this in rawhide either way.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9811958</commentid>
    <comment_count>3</comment_count>
    <who name="Toshio Ernie Kuratomi">a.badger</who>
    <bug_when>2016-10-21 12:17:50 -0400</bug_when>
    <thetext>Cool.  ignatenkobrain also said (on irc) that he thinks he can work on a patch in a few days.  So we&apos;ll probably get it into our upstream devel branch sometime next week.  Then it can be applied as a backport to the Fedora package and queued up for the upstream 2.2.1 release.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9827826</commentid>
    <comment_count>4</comment_count>
    <who name="Toshio Ernie Kuratomi">a.badger</who>
    <bug_when>2016-10-27 16:03:06 -0400</bug_when>
    <thetext>Opened a bug upstream: https://github.com/ansible/ansible-modules-extras/issues/3310</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9848181</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-02 13:30:45 -0400</bug_when>
    <thetext>ansible-2.2.0.0-2.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-e348c4e0e3</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9848198</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-02 13:31:35 -0400</bug_when>
    <thetext>ansible-2.2.0.0-2.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2016-a5f9956e38</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9863747</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-04 23:33:07 -0400</bug_when>
    <thetext>ansible-2.2.0.0-2.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-e348c4e0e3</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9864069</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-05 12:01:23 -0400</bug_when>
    <thetext>ansible-2.2.0.0-3.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2016-3113e71193</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9864076</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-05 12:02:05 -0400</bug_when>
    <thetext>ansible-2.2.0.0-3.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2016-3ccb098630</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9864233</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-05 15:01:20 -0400</bug_when>
    <thetext>ansible-2.2.0.0-3.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-3ccb098630</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9864468</commentid>
    <comment_count>11</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-05 21:53:27 -0400</bug_when>
    <thetext>ansible-2.2.0.0-3.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-3113e71193</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9869310</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-07 18:27:48 -0500</bug_when>
    <thetext>ansible-2.2.0.0-3.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9905839</commentid>
    <comment_count>13</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-19 16:12:21 -0500</bug_when>
    <thetext>ansible-2.2.0.0-3.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>