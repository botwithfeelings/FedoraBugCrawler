<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1196480</bug_id>
          
          <creation_ts>2015-02-25 22:35:00 -0500</creation_ts>
          <short_desc>read does not set variable on timeout</short_desc>
          <delta_ts>2017-02-13 02:22:26 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>bash</component>
          <version>24</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="M. Kristall">mkpdev</reporter>
          <assigned_to name="Siteshwar Vashisht">svashisht</assigned_to>
          <cc>admiller</cc>
    
    
    <cc>jpesco</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-02-11 02:59:53</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>7977633</commentid>
    <comment_count>0</comment_count>
    <who name="M. Kristall">mkpdev</who>
    <bug_when>2015-02-25 22:35:20 -0500</bug_when>
    <thetext>Description of problem:
read with &quot;-t&quot; does not behave according to the documentation. Specifically, the documentation says:
              -t timeoutâ€¦
                     If read times out, read saves any partial input read into
                     the  specified  variable  name.
but that is not happening

Version-Release number of selected component (if applicable):
$ echo $BASH_VERSION
4.3.33(1)-release

How reproducible:
always

Actual results:
$ read part &lt; &lt;( echo -n ye; sleep 2; echo s ); echo &quot;part=$part&quot;
part=yes
$ read -t 1 part &lt; &lt;( echo -n ye; sleep 2; echo s ); echo &quot;part=$part&quot;
part=

Expected results:
1. part=yes
2. part=ye</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8422812</commentid>
    <comment_count>1</comment_count>
    <who name="Ondrej Oprala">ooprala</who>
    <bug_when>2015-07-09 02:58:38 -0400</bug_when>
    <thetext>Hey again!

This is an interesting part of working with fds.
What happens is something like this:
1. echo writes &quot;ye&quot; to stdout, stdout however is buffered, meaning &quot;ye&quot; is &quot;stuck&quot; in a buffer somewhere, and not yet written to the FD.
2. sleep 2; is ran inside the subshell
3. read waits for 1 second, trying to read from the descriptor given, but no complete line, or indeed no data at all is found and it times out. Omit the code after the subshell and you can check with echo ${PIPESTATUS[0]} that read really did time out (it should return 142)
4. subshell wakes up and writes &quot;s\n&quot; to its stdout, making the buffer flush and really writing this time. However, there&apos;s noone to read the output anymore.

I&apos;ll be closing this bugzilla for now, but thank you for the report!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8423053</commentid>
    <comment_count>2</comment_count>
    <who name="M. Kristall">mkpdev</who>
    <bug_when>2015-07-09 04:00:20 -0400</bug_when>
    <thetext>(In reply to Ondrej Oprala from comment #1)
&gt; Hey again!
&gt; 
&gt; This is an interesting part of working with fds.
&gt; What happens is something like this:
&gt; 1. echo writes &quot;ye&quot; to stdout, stdout however is buffered, meaning &quot;ye&quot; is
&gt; &quot;stuck&quot; in a buffer somewhere, and not yet written to the FD.

Then let&apos;s make both sides of the pipe unbuffered:

$ stdbuf -i0 bash -c &apos;read -t 1 part; echo &quot;part=$part&quot;&apos; &lt; &lt;( stdbuf -o0 echo -n ye; sleep 2; echo s )
part=

Still not &quot;[saving] any partial input read&quot; on a timeout</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8450506</commentid>
    <comment_count>3</comment_count>
    <who name="M. Kristall">mkpdev</who>
    <bug_when>2015-07-16 19:13:46 -0400</bug_when>
    <thetext>It has been one week with no reply since I provided what I think is evidence that your explanation does not rule this out as a bug, so I&apos;m reopening this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9523167</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2016-07-19 08:52:06 -0400</bug_when>
    <thetext>Fedora 22 changed to end-of-life (EOL) status on 2016-07-19. Fedora 22 is
no longer maintained, which means that it will not receive any further
security or bug fix updates. As a result we are closing this bug.

If you can reproduce this bug against a currently maintained version of
Fedora please feel free to reopen this bug against that version. If you
are unable to reopen this bug, please file a new report against the
current release. If you experience problems, please add a comment to this
bug.

Thank you for reporting this bug and we are sorry it could not be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9528567</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2016-07-19 15:44:17 -0400</bug_when>
    <thetext>Fedora 22 changed to end-of-life (EOL) status on 2016-07-19. Fedora 22 is
no longer maintained, which means that it will not receive any further
security or bug fix updates. As a result we are closing this bug.

If you can reproduce this bug against a currently maintained version of
Fedora please feel free to reopen this bug against that version. If you
are unable to reopen this bug, please file a new report against the
current release. If you experience problems, please add a comment to this
bug.

Thank you for reporting this bug and we are sorry it could not be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9920551</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2016-11-24 06:29:26 -0500</bug_when>
    <thetext>This message is a reminder that Fedora 23 is nearing its end of life.
Approximately 4 (four) weeks from now Fedora will stop maintaining
and issuing updates for Fedora 23. It is Fedora&apos;s policy to close all
bug reports from releases that are no longer maintained. At that time
this bug will be closed as EOL if it remains open with a Fedora  &apos;version&apos;
of &apos;23&apos;.

Package Maintainer: If you wish for this bug to remain open because you
plan to fix it in a currently maintained version, simply change the &apos;version&apos; 
to a later Fedora version.

Thank you for reporting this issue and we are sorry that we were not 
able to fix it before Fedora 23 is end of life. If you would still like 
to see this bug fixed and are able to reproduce it against a later version 
of Fedora, you are encouraged  change the &apos;version&apos; to a later Fedora 
version prior this bug is closed as described in the policy above.

Although we aim to fix as many bugs as possible during every release&apos;s 
lifetime, sometimes those efforts are overtaken by events. Often a 
more recent Fedora release includes newer upstream software that fixes 
bugs or makes them obsolete.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10141966</commentid>
    <comment_count>8</comment_count>
    <who name="Siteshwar Vashisht">svashisht</who>
    <bug_when>2017-02-13 02:22:26 -0500</bug_when>
    <thetext>This was fixed by rebasing bash to version 4.4 in rawhide.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>