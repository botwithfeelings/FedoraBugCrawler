<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1" urlbase="https://bugzilla.redhat.com/" maintainer="bugzilla-error-list@redhat.com">

  <bug>
    <bug_id>1411130</bug_id>

    <creation_ts>2017-01-08 10:48:00 -0500</creation_ts>
    <short_desc>suspicious warnings on fresh installed system</short_desc>
    <delta_ts>2017-02-11 08:19:14 -0500</delta_ts>
    <reporter_accessible>1</reporter_accessible>
    <cclist_accessible>1</cclist_accessible>
    <classification_id>2</classification_id>
    <classification>Fedora</classification>
    <product>Fedora</product>
    <component>rkhunter</component>
    <version>25</version>
    <rep_platform>x86_64</rep_platform>
    <op_sys>Linux</op_sys>
    <bug_status>CLOSED</bug_status>
    <resolution>ERRATA</resolution>

    <bug_file_loc></bug_file_loc>
    <status_whiteboard></status_whiteboard>
    <keywords></keywords>
    <priority>unspecified</priority>
    <bug_severity>medium</bug_severity>
    <target_milestone>---</target_milestone>

    <everconfirmed>1</everconfirmed>
    <reporter>redhat</reporter>
    <assigned_to name="Kevin Fenzi">kevin</assigned_to>
    <cc>kevin</cc>

    <cc>nonamedotc</cc>
    <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>

    <cf_fixed_in>rkhunter-1.4.2-12.fc25 rkhunter-1.4.2-8.el7</cf_fixed_in>
  <cf_doc_type>If docs needed, set a value</cf_doc_type>
<cf_release_notes></cf_release_notes>
<cf_story_points>---</cf_story_points>

<cf_environment></cf_environment>
<cf_last_closed>2017-02-05 15:20:55</cf_last_closed>
<cf_type>Bug</cf_type>
<cf_regression_status>---</cf_regression_status>
<cf_mount_type>---</cf_mount_type>
<cf_documentation_action>---</cf_documentation_action>
<cf_crm></cf_crm>
<cf_verified_branch></cf_verified_branch>
<cf_category>---</cf_category>
<cf_ovirt_team>---</cf_ovirt_team>

<cf_cloudforms_team>---</cf_cloudforms_team>

<target_release>---</target_release>

<votes>0</votes>

<comment_sort_order>oldest_to_newest</comment_sort_order>
<long_desc isprivate="0">
<commentid>10043252</commentid>
<comment_count>0</comment_count>
<who name="">redhat</who>
<bug_when>2017-01-08 10:48:37 -0500</bug_when>
<thetext>Description of problem: When running rkhunter on a fresh installed system it produces suspicious warnings. Version-Release number of selected component (if applicable): rkhunter-1.4.2-11.fc25.noarch How reproducible: Always after fresh
installed FC25 Server. Steps to Reproduce: 1. rkhunter 2. 3. Actual results: --------------------- Start Rootkit Hunter Update --------------------- [ Rootkit Hunter version 1.4.2 ] Checking rkhunter data files... Checking file mirrors.dat [ No
update ] Checking file programs_bad.dat [ No update ] Checking file backdoorports.dat [ No update ] Checking file suspscan.dat [ No update ] Checking file i18n/cn [ No update ] Checking file i18n/de [ No update ] Checking file i18n/en [ No update ]
Checking file i18n/tr [ No update ] Checking file i18n/tr.utf8 [ No update ] Checking file i18n/zh [ No update ] Checking file i18n/zh.utf8 [ No update ] .... Warning: The command &apos;/usr/sbin/ifdown&apos; has been replaced by a script:
/usr/sbin/ifdown: +Bourne-Again shell script, ASCII text executable Warning: The command &apos;/usr/sbin/ifup&apos; has been replaced by a script: /usr/sbin/ifup: Bourne-Again +shell script, ASCII text executable Warning: The command
&apos;/usr/bin/egrep&apos; has been replaced by a script: /usr/bin/egrep: POSIX shell +script, ASCII text executable Warning: The command &apos;/usr/bin/fgrep&apos; has been replaced by a script: /usr/bin/fgrep: POSIX shell +script, ASCII text
executable ... Warning: Hidden file found: /usr/bin/.tv7: ASCII text, with no line terminators Expected results: No warnings Additional info: # rpm -qf /usr/bin/egrep grep-2.27-1.fc25.x86_64 # rpm -Vv grep-2.27-1.fc25.x86_64 ......... /bin/egrep
......... /bin/fgrep ......... /bin/grep ......... c /etc/GREP_COLORS ......... c /etc/profile.d/colorgrep.csh ......... c /etc/profile.d/colorgrep.sh ......... /usr/libexec/grepconf.sh ......... /usr/share/doc/grep ......... d
/usr/share/doc/grep/AUTHORS ......... d /usr/share/doc/grep/NEWS ......... d /usr/share/doc/grep/README ......... d /usr/share/doc/grep/THANKS ......... d /usr/share/doc/grep/TODO ......... d /usr/share/info/grep.info.gz .........
/usr/share/licenses/grep ......... l /usr/share/licenses/grep/COPYING ......... /usr/share/locale/af/LC_MESSAGES/grep.mo ......... /usr/share/locale/be/LC_MESSAGES/grep.mo ......... /usr/share/locale/bg/LC_MESSAGES/grep.mo .........
/usr/share/locale/ca/LC_MESSAGES/grep.mo ......... /usr/share/locale/cs/LC_MESSAGES/grep.mo ......... /usr/share/locale/da/LC_MESSAGES/grep.mo ......... /usr/share/locale/de/LC_MESSAGES/grep.mo ......... /usr/share/locale/el/LC_MESSAGES/grep.mo
......... /usr/share/locale/eo/LC_MESSAGES/grep.mo ......... /usr/share/locale/es/LC_MESSAGES/grep.mo ......... /usr/share/locale/et/LC_MESSAGES/grep.mo ......... /usr/share/locale/eu/LC_MESSAGES/grep.mo .........
/usr/share/locale/fi/LC_MESSAGES/grep.mo ......... /usr/share/locale/fr/LC_MESSAGES/grep.mo ......... /usr/share/locale/ga/LC_MESSAGES/grep.mo ......... /usr/share/locale/gl/LC_MESSAGES/grep.mo ......... /usr/share/locale/he/LC_MESSAGES/grep.mo
......... /usr/share/locale/hr/LC_MESSAGES/grep.mo ......... /usr/share/locale/hu/LC_MESSAGES/grep.mo ......... /usr/share/locale/id/LC_MESSAGES/grep.mo ......... /usr/share/locale/it/LC_MESSAGES/grep.mo .........
/usr/share/locale/ja/LC_MESSAGES/grep.mo ......... /usr/share/locale/ko/LC_MESSAGES/grep.mo ......... /usr/share/locale/ky/LC_MESSAGES/grep.mo ......... /usr/share/locale/lt/LC_MESSAGES/grep.mo ......... /usr/share/locale/nb/LC_MESSAGES/grep.mo
......... /usr/share/locale/nl/LC_MESSAGES/grep.mo ......... /usr/share/locale/pa/LC_MESSAGES/grep.mo ......... /usr/share/locale/pl/LC_MESSAGES/grep.mo ......... /usr/share/locale/pt/LC_MESSAGES/grep.mo .........
/usr/share/locale/pt_BR/LC_MESSAGES/grep.mo ......... /usr/share/locale/ro/LC_MESSAGES/grep.mo ......... /usr/share/locale/ru/LC_MESSAGES/grep.mo ......... /usr/share/locale/sk/LC_MESSAGES/grep.mo ......... /usr/share/locale/sl/LC_MESSAGES/grep.mo
......... /usr/share/locale/sr/LC_MESSAGES/grep.mo ......... /usr/share/locale/sv/LC_MESSAGES/grep.mo ......... /usr/share/locale/th/LC_MESSAGES/grep.mo ......... /usr/share/locale/tr/LC_MESSAGES/grep.mo .........
/usr/share/locale/uk/LC_MESSAGES/grep.mo ......... /usr/share/locale/vi/LC_MESSAGES/grep.mo ......... /usr/share/locale/zh_CN/LC_MESSAGES/grep.mo ......... /usr/share/locale/zh_TW/LC_MESSAGES/grep.mo ......... d /usr/share/man/man1/egrep.1.gz
......... d /usr/share/man/man1/fgrep.1.gz ......... d /usr/share/man/man1/grep.1.gz # rpm -qf /usr/bin/.tv7 Die Datei /usr/bin/.tv7 geh√∂rt zu keinem Paket Where does this file come from?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10043285</commentid>
<comment_count>1</comment_count>
<who name="Kevin Fenzi">kevin</who>
<bug_when>2017-01-08 12:09:49 -0500</bug_when>
<thetext>Did you run &apos;rkhunter --propupd&apos; ? You need to do that everytime you make changes and are telling rkhunter that those changes are ok. I have no idea what that /usr/bin/.tv7 file is from. No Fedora packages seem to provide it.
Perhaps check the contents and timestamp?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10043297</commentid>
<comment_count>2</comment_count>
<who name="">redhat</who>
<bug_when>2017-01-08 13:04:37 -0500</bug_when>
<thetext>&gt; Did you run &apos;rkhunter --propupd&apos; ? You need to do that everytime you make &gt; changes and are telling rkhunter that those changes are ok. The package rkhunter has been installed after the package grep. So I did not change the
system, therefor did not run &apos;rkhunter --propupd&apos;. And why doesn&apos;t it complain about all the other packages that have been installed before? Excuse me, but I do not understand why I should run &apos;rkhunter --propupd&apos;.
Doesn&apos;t it has the FC packages in its database? &gt; I have no idea what that /usr/bin/.tv7 file is from. No Fedora packages seem &gt; to provide it. Perhaps check the contents and timestamp? A quick search with google showed
https://www.synology.com/en-global/knowledgebase/DSM/tutorial/General/Why_does_Security_Advisor_inform_me_of_modified_system_files which mentions this file. Looks like the TwonkyMediaServer created this file, whis is really odd, because it is not
executable. I&apos;ve just removed id.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10046942</commentid>
<comment_count>3</comment_count>
<who name="Kevin Fenzi">kevin</who>
<bug_when>2017-01-09 16:20:22 -0500</bug_when>
<thetext>(In reply to redhat from comment #2) &gt; &gt; Did you run &apos;rkhunter --propupd&apos; ? You need to do that everytime you make &gt; &gt; changes and are telling rkhunter that those changes are ok. &gt; &gt; The package rkhunter has been
installed after the package grep. So I did not &gt; change the system, therefor did not run &apos;rkhunter --propupd&apos;. And why &gt; doesn&apos;t it complain about all the other packages that have been installed &gt; before? Excuse me, but I do
not understand why I should run &apos;rkhunter &gt; --propupd&apos;. Doesn&apos;t it has the FC packages in its database? You did change the system. You installed. This is simply the way the tool works. See:
http://rkhunter.cvs.sourceforge.net/viewvc/rkhunter/rkhunter/files/FAQ &quot;3.7) I have just installed Rootkit Hunter, and I am already getting warning messages. Why is that? A. The first run of rkhunter after an installation will usually give some
warning messages. One of the checks is whether the file of file properties (called &apos;rkhunter.dat&apos;) exists. This file won&apos;t exist until rkhunter is run with the &apos;--propupd&apos; option.&quot; If you run &apos;rkhunter
--propupd&apos; and then &apos;rkhunter -c -sk&apos; does it show any problems?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10049208</commentid>
<comment_count>4</comment_count>
<who name="">redhat</who>
<bug_when>2017-01-10 08:24:06 -0500</bug_when>
<thetext>Well, I did as suggested and the warnings disapeared. Fine. But a new one popped up: [14:19:51] Info: Starting test name &apos;filesystem&apos; [14:19:51] Performing filesystem checks [14:19:51] Info: SCAN_MODE_DEV set to
&apos;THOROUGH&apos; [14:19:53] Info: Found file &apos;/dev/shm/squid-cf__readers.shm&apos;: it is whitelisted. [14:19:53] Info: Found file &apos;/dev/shm/squid-cf__queues.shm&apos;: it is whitelisted. [14:19:53] Info: Found file
&apos;/dev/shm/squid-cf__metadata.shm&apos;: it is whitelisted. [14:19:57] Checking /dev for suspicious file types [ Warning ] [14:19:57] Warning: Suspicious file types found in /dev: [14:19:57] /dev/shm/squid-ssl_session_cache.shm: data
&apos;--propupd&apos; did not whitelist &apos;/dev/shm/squid-ssl_session_cache.shm&apos;. Is this an error of rkhunter or the squid?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10051255</commentid>
<comment_count>5</comment_count>
<who name="Mukundan Ragavan">nonamedotc</who>
<bug_when>2017-01-10 21:55:23 -0500</bug_when>
<thetext>(In reply to redhat from comment #4) &gt; [14:19:57] Checking /dev for suspicious file types [ Warning ] &gt; [14:19:57] Warning: Suspicious file types found in /dev: &gt; [14:19:57] /dev/shm/squid-ssl_session_cache.shm: data &gt; &gt;
&apos;--propupd&apos; did not whitelist &apos;/dev/shm/squid-ssl_session_cache.shm&apos;. Is &gt; this an error of rkhunter or the squid? yeah ... that&apos;s because, this file is not present in rkhunter.conf file. You will have to add this file to
the configuration file and run --propupd again I think. Of course, you would want to run --propupd on a &quot;known safe&quot; system. Alternatively, we would have to add this to rkhunter.conf file .. what package does this file belong to? Thanks.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10053964</commentid>
<comment_count>6</comment_count>
<who name="">redhat</who>
<bug_when>2017-01-11 13:23:03 -0500</bug_when>
<thetext>The file is not directly part of a package, but is created when Squid is operated with the option SSL Bump. Therefore I find it important to add this file to the white list of rkhunter. # rpm -qal|grep squid-ssl_session_cache.shm
&lt;empty&gt; # rpm -q squid squid-4.0.17-1.fc25.x86_64</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10055132</commentid>
<comment_count>7</comment_count>
<who name="Mukundan Ragavan">nonamedotc</who>
<bug_when>2017-01-11 19:04:21 -0500</bug_when>
<thetext>(In reply to redhat from comment #6) &gt; The file is not directly part of a package, but is created when Squid is &gt; operated with the option SSL Bump. Therefore I find it important to add this &gt; file to the white list of rkhunter.
&gt; &gt; # rpm -qal|grep squid-ssl_session_cache.shm &gt; &lt;empty&gt; &gt; # rpm -q squid &gt; squid-4.0.17-1.fc25.x86_64 that explains why I was unable to find the file. I am testing another update for rkhunter (in another bug). I will add this
as well and do a scratch build and post here.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10097555</commentid>
<comment_count>8</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-01-25 21:37:54 -0500</bug_when>
<thetext>rkhunter-1.4.2-8.el7 rkhunter-1.4.2-8.el7 has been submitted as an update to Fedora EPEL 7. https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2017-a9679aec00</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10097563</commentid>
<comment_count>9</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-01-25 21:42:31 -0500</bug_when>
<thetext>rkhunter-1.4.2-12.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-600553ca54</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10100692</commentid>
<comment_count>10</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-01-26 21:48:11 -0500</bug_when>
<thetext>rkhunter-1.4.2-8.el7 has been pushed to the Fedora EPEL 7 testing repository. If problems still persist, please make note of it in this bug report. See https://fedoraproject.org/wiki/QA:Updates_Testing for instructions on how to install test
updates. You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2017-a9679aec00</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10103195</commentid>
<comment_count>11</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-01-27 23:54:25 -0500</bug_when>
<thetext>rkhunter-1.4.2-12.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report. See https://fedoraproject.org/wiki/QA:Updates_Testing for instructions on how to install test
updates. You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-600553ca54</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10122005</commentid>
<comment_count>12</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-02-05 15:20:55 -0500</bug_when>
<thetext>rkhunter-1.4.2-12.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10140044</commentid>
<comment_count>13</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-02-11 08:19:14 -0500</bug_when>
<thetext>rkhunter-1.4.2-8.el7 has been pushed to the Fedora EPEL 7 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
</long_desc>

</bug>

</bugzilla>
