<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1417601</bug_id>
          
          <creation_ts>2017-01-30 07:04:00 -0500</creation_ts>
          <short_desc>dnf  - missing error message</short_desc>
          <delta_ts>2017-01-30 15:04:22 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>dnf</component>
          <version>25</version>
          <rep_platform>i686</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>high</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Eduard Vopicka">eduard.vopicka</reporter>
          <assigned_to>rpm-software-management</assigned_to>
          <cc>packaging-team-maint</cc>
    
    
    <cc>rpm-software-management</cc>
    
    
    <cc>vmukhame</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-01-30 15:04:22</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10105605</commentid>
    <comment_count>0</comment_count>
    <who name="Eduard Vopicka">eduard.vopicka</who>
    <bug_when>2017-01-30 07:04:55 -0500</bug_when>
    <thetext>Description of problem: Error or warning message about unsatified dependencies missing when trying to update set of packages specified on command line. Possible functional or security consequences.


Version-Release number of selected component (if applicable):
[vopicka@czlx-vopicka tmp]$ rpm -q dnf
dnf-1.1.10-5.fc25.noarch
[vopicka@czlx-vopicka tmp]$ 


How reproducible:
Always with repo in such a state that dependencies cannot be resolved.


Steps to Reproduce:
1. I am trying to update my almost up-to-date fedora 25. Skipped packages with broken dependencies are correctly reported:
[root@czlx-vopicka ~]# dnf update
Last metadata expiration check: 1:07:59 ago on Mon Jan 30 11:31:12 2017.
Dependencies resolved.
================================================================================
 Package                 Arch         Version               Repository     Size
================================================================================
Skipping packages with broken dependencies:
 mesa-libEGL             x86_64       13.0.3-4.fc25         updates       103 k
 mesa-libEGL-devel       x86_64       13.0.3-4.fc25         updates        38 k
 mesa-libGL              x86_64       13.0.3-4.fc25         updates       164 k
 mesa-libGL-devel        x86_64       13.0.3-4.fc25         updates       161 k
 mesa-libGLES            x86_64       13.0.3-4.fc25         updates        21 k
 mesa-libglapi           x86_64       13.0.3-4.fc25         updates        49 k

Transaction Summary
================================================================================
Skip  6 Packages

Nothing to do.
Complete!
[root@czlx-vopicka ~]# 

2. Now I am trying to update packages reported in step 1. No packages with broken dependencies are reported this time, only &quot;Nothing to do&quot;:

[root@czlx-vopicka ~]# dnf update mesa-libEGL mesa-libEGL-devel mesa-libGL mesa-libGL-devel mesa-libGLES mesa-libglapi
Last metadata expiration check: 1:11:45 ago on Mon Jan 30 11:31:12 2017.
Dependencies resolved.
Nothing to do.
Complete!
[root@czlx-vopicka ~]#

3. (Here you can try again &quot;dnf update&quot; as in step 1 to verify that their broken dependencies still exist.)

[root@czlx-vopicka ~]# dnf update
Last metadata expiration check: 1:13:30 ago on Mon Jan 30 11:31:12 2017.
Dependencies resolved.
================================================================================
 Package                 Arch         Version               Repository     Size
================================================================================
Skipping packages with broken dependencies:
 mesa-libEGL             x86_64       13.0.3-4.fc25         updates       103 k
 mesa-libEGL-devel       x86_64       13.0.3-4.fc25         updates        38 k
 mesa-libGL              x86_64       13.0.3-4.fc25         updates       164 k
 mesa-libGL-devel        x86_64       13.0.3-4.fc25         updates       161 k
 mesa-libGLES            x86_64       13.0.3-4.fc25         updates        21 k
 mesa-libglapi           x86_64       13.0.3-4.fc25         updates        49 k

Transaction Summary
================================================================================
Skip  6 Packages

Nothing to do.
Complete!
[root@czlx-vopicka ~]# 



Actual results:
No packeges with broken dependencies reported in step 2.


Expected results:
Packages with broken dependencies should be reported in step 2.

Additional info:
[root@czlx-vopicka ~]# uname -a
Linux czlx-vopicka.ad.ifortuna.cz 4.9.5-200.fc25.x86_64 #1 SMP Fri Jan 20 12:24:16 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux
[root@czlx-vopicka ~]# 

I am considering this to be serious problem because of it may lead to packages with broken dependencies being SILENTLY NOT UPDATED, even when they are in repo. and should be reported as packages with broken dependencies.i This may have functional or security consequences - you are not warned that there is a problem with these packages and packages are just silently ignored.

Plase note that my idea in step 2 was to add --enablerepo=fedora-testing in the next run to get packages missing in the fedora repo from fedora-updates. This is also the reason for having packages specified on command line, e.g. to get only minimum set of required packages from fedora-testing.

[root@czlx-vopicka ~]# dnf update --enablerepo=updates-testing mesa-libEGL mesa-libEGL-devel mesa-libGL mesa-libGL-devel mesa-libGLES mesa-libglapi
Fedora 25 - x86_64 - Test Updates                10 MB/s | 6.1 MB     00:00    
Last metadata expiration check: 0:00:02 ago on Mon Jan 30 12:50:45 2017.
Dependencies resolved.
================================================================================
 Package             Arch   Version                       Repository       Size
================================================================================
Installing:
 libglvnd            x86_64 1:0.2.999-7.gitdc16f8c.fc25   updates-testing  88 k
 libglvnd-core-devel x86_64 1:0.2.999-7.gitdc16f8c.fc25   updates-testing  19 k
 libglvnd-devel      x86_64 1:0.2.999-7.gitdc16f8c.fc25   updates-testing  11 k
 libglvnd-egl        x86_64 1:0.2.999-7.gitdc16f8c.fc25   updates-testing  42 k
 libglvnd-gles       x86_64 1:0.2.999-7.gitdc16f8c.fc25   updates-testing  30 k
 libglvnd-glx        x86_64 1:0.2.999-7.gitdc16f8c.fc25   updates-testing 124 k
 libglvnd-opengl     x86_64 1:0.2.999-7.gitdc16f8c.fc25   updates-testing  43 k
Upgrading:
 mesa-libEGL         x86_64 13.0.3-4.fc25                 updates         103 k
 mesa-libEGL-devel   x86_64 13.0.3-4.fc25                 updates          38 k
 mesa-libGL          x86_64 13.0.3-4.fc25                 updates         164 k
 mesa-libGL-devel    x86_64 13.0.3-4.fc25                 updates         161 k
 mesa-libGLES        x86_64 13.0.3-4.fc25                 updates          21 k
 mesa-libglapi       x86_64 13.0.3-4.fc25                 updates          49 k

Transaction Summary
================================================================================
Install  7 Packages
Upgrade  6 Packages

Total download size: 894 k
Is this ok [y/N]:</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10105716</commentid>
    <comment_count>1</comment_count>
    <who name="Igor Gnatenko">ignatenko</who>
    <bug_when>2017-01-30 07:25:44 -0500</bug_when>
    <thetext>Usual users should not notice problems with dependencies, only developers or advanced users. Use --best if you want to see error.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10106943</commentid>
    <comment_count>2</comment_count>
    <who name="Eduard Vopicka">eduard.vopicka</who>
    <bug_when>2017-01-30 14:51:49 -0500</bug_when>
    <thetext>Hello.

I would like to point out the following:

1) The missing message is certainly ERROR message and in no way anything like notice or something similar.

2) Ending with packages not updated w/o any error message in some cases can certainly have functional or evwn worse security impact on the system.

3) In my opinion, the current dnf behavior is exact opposite of what you are writing. &quot;Usual user&quot;, if using dnf from comamnd line at all, will certainly use just &quot;dnf update&quot;, while the &quot;advanced user&quot; od &quot;developer&quot;  will possibly use &quot;dnf update package_name ...&quot; But &quot;usual user&apos;s&quot; command gives proper error message and the &quot;advanced user&apos;s&quot; does not display error message&quot;. So the error message is not hiden for usual users, but instead for advanced users and developers.

4) Oldschool yum behaves correctly in this case.

[root@localhost ~]# yum-deprecated update --skip-broken  mesa-libEGL mesa-libEGL-devel mesa-libGL mesa-libGL-devel mesa-libGLES         mesa-libOSMesa mesa-libglapi  
### Lots of messages from yum dependency solving removed here. But finally:
Packages skipped because of dependency problems:
    libglvnd-0.2.999-6.git28867bb.fc25.i686 from fedora
    libglvnd-devel-0.2.999-6.git28867bb.fc25.i686 from fedora
    mesa-libEGL-13.0.3-4.fc25.i686 from updates
    mesa-libEGL-devel-13.0.3-4.fc25.i686 from updates
    mesa-libGL-13.0.3-4.fc25.i686 from updates
    mesa-libGL-devel-13.0.3-4.fc25.i686 from updates
    mesa-libGLES-13.0.3-4.fc25.i686 from updates
    mesa-libOSMesa-13.0.3-4.fc25.i686 from updates
    mesa-libglapi-13.0.3-4.fc25.i686 from updates
[root@localhost ~]# 

5) The mesaages we are talking about are significant ERROR messages, so they should not be hidden in any case.

Best regards,

Ed</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10106968</commentid>
    <comment_count>3</comment_count>
    <who name="Igor Gnatenko">ignatenko</who>
    <bug_when>2017-01-30 15:04:22 -0500</bug_when>
    <thetext>Users do not need to report such bugs (that&apos;s why `best` is set to false by default). It&apos;s job of developers to prevent this. and even it happened it should not break other system updates.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>