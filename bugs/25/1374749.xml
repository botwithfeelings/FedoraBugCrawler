<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1374749</bug_id>
          
          <creation_ts>2016-09-09 10:01:00 -0400</creation_ts>
          <short_desc>qemu-system-ppc-2.7.0-0.2.rc3.fc25 failed with &quot;qemu: fatal: Unknown MMU model&quot;</short_desc>
          <delta_ts>2016-10-22 00:00:03 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>qemu</component>
          <version>25</version>
          <rep_platform>ppc64le</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1071880</blocked>
    
    
    <blocked>1374380</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Menanteau Guy">menantea</reporter>
          <assigned_to name="Fedora Virtualization Maintainers">virt-maint</assigned_to>
          <cc>amit.shah</cc>
    
    
    <cc>berrange</cc>
    
    
    <cc>cfergeau</cc>
    
    
    <cc>crobinso</cc>
    
    
    <cc>dgibson</cc>
    
    
    <cc>dwmw2</cc>
    
    
    <cc>itamar</cc>
    
    
    <cc>mdroth</cc>
    
    
    <cc>pbonzini</cc>
    
    
    <cc>pbrobinson</cc>
    
    
    <cc>rjones</cc>
    
    
    <cc>skumari</cc>
    
    
    <cc>virt-maint</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>qemu-2.7.0-6.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-10-22 00:00:03</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9694277</commentid>
    <comment_count>0</comment_count>
    <who name="Menanteau Guy">menantea</who>
    <bug_when>2016-09-09 10:01:58 -0400</bug_when>
    <thetext>I am trying to run last f25 ppc64le qemu (qemu-system-ppc-2.7.0-0.2.rc3.fc25) and it failed with:

qemu: fatal: Unknown MMU model

NIP 0000000000000100   LR 0000000000000000 CTR 0000000000000000 XER 0000000000000000 CPU#0
MSR 8000000000000000 HID0 0000000000000000  HF 8000000000000000 iidx 3 didx 3
TB 00000000 00000000 DECR 00000000
GPR00 0000000000000000 0000000000000000 0000000000000000 0000000000000000
GPR04 0000000000000000 0000000000000000 0000000000000000 0000000000000000
GPR08 0000000000000000 0000000000000000 0000000000000000 0000000000000000
GPR12 0000000000000000 0000000000000000 0000000000000000 0000000000000000
GPR16 0000000000000000 0000000000000000 0000000000000000 0000000000000000
GPR20 0000000000000000 0000000000000000 0000000000000000 0000000000000000
GPR24 0000000000000000 0000000000000000 0000000000000000 0000000000000000
GPR28 0000000000000000 0000000000000000 0000000000000000 0000000000000000
CR 00000000  [ -  -  -  -  -  -  -  -  ]             RES 0000000000000000
FPR00 0000000000000000 0000000000000000 0000000000000000 0000000000000000
FPR04 0000000000000000 0000000000000000 0000000000000000 0000000000000000
FPR08 0000000000000000 0000000000000000 0000000000000000 0000000000000000
FPR12 0000000000000000 0000000000000000 0000000000000000 0000000000000000
FPR16 0000000000000000 0000000000000000 0000000000000000 0000000000000000
FPR20 0000000000000000 0000000000000000 0000000000000000 0000000000000000
FPR24 0000000000000000 0000000000000000 0000000000000000 0000000000000000
FPR28 0000000000000000 0000000000000000 0000000000000000 0000000000000000
FPSCR 0000000000000000
 SRR0 0000000000000000  SRR1 0000000000000000    PVR 00000000004b0201 VRSAVE 0000000000000000
SPRG0 0000000000000000 SPRG1 0000000000000000  SPRG2 0000000000000000  SPRG3 0000000000000000
SPRG4 0000000000000000 SPRG5 0000000000000000  SPRG6 0000000000000000  SPRG7 0000000000000000
HSRR0 0000000000000000 HSRR1 0000000000000000
 CFAR 0000000000000000
[ 5392.261033] br0: port 2(tap0) entered disabled state
[ 5392.265196] device tap0 left promiscuous mode
[ 5392.265269] br0: port 2(tap0) entered disabled state
Aborted (core dumped)


It seems corresponding to the following missing patch:
https://patchwork.kernel.org/patch/9240965/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9706474</commentid>
    <comment_count>1</comment_count>
    <who name="Menanteau Guy">menantea</who>
    <bug_when>2016-09-14 05:25:18 -0400</bug_when>
    <thetext>Currently, I am able to reproduce this problem only when I try to run a virtual machine in a virtual machine. This problem appears also with libvirt.
Here after are used commands:
/usr/bin/qemu-system-ppc64 -name /root -enable-kvm -M pseries -smp 4 -m 4G -nographic -nodefaults -monitor stdio -serial pty -device virtio-net-pci,netdev=net10051,mac=c0:ff:ee:00:00:51 -netdev bridge,br=br0,id=net10051 -hda /root/hd.qcow2 --cdrom /root/Fedora-Server-dvd-ppc64le-25-Alpha-1.2.iso -S

virt-install --machine pseries --name f25_ppc64le_alpha1.2 --hvm --virt-type kvm --arch ppc64le --boot cdrom,hd --network bridge=virbr0,model=virtio-net-pci,mac=c0:ff:ee:00:00:51 --disk path=/var/lib/libvirt/images/hd.qcow2,size=10,format=qcow2,bus=virtio,cache=none --memory 4096 --vcpus sockets=1,cores=1,threads=1 --cdrom /var/lib/libvirt/images/Fedora-Server-dvd-ppc64le-25-Alpha-1.2.iso

Note: when I try these commands in a host machine (f25 ppc64le) on a baremetal, I hit the following problem:
qemu-system-ppc64: -device virtio-net-pci,netdev=net10051,mac=c0:ff:ee:00:00:51: failed to find romfile &quot;efi-virtio.rom&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9753553</commentid>
    <comment_count>2</comment_count>
    <who name="Sinny Kumari">skumari</who>
    <bug_when>2016-09-29 08:47:31 -0400</bug_when>
    <thetext>(In reply to Menanteau Guy from comment #0)
&gt; I am trying to run last f25 ppc64le qemu
&gt; (qemu-system-ppc-2.7.0-0.2.rc3.fc25) and it failed with:
&gt; 
&gt; qemu: fatal: Unknown MMU model
&gt; 

I too saw similar issue in different scenario and found a patch at https://lists.gnu.org/archive/html/qemu-devel/2016-07/msg04879.html. I did a scratch build with mentioned patch which is available at http://ppc.koji.fedoraproject.org/koji/taskinfo?taskID=3753334 .
Can you please try updating qemu with sub-packages available in this scratch build and see if it fixes the problem? Worked for me.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9754399</commentid>
    <comment_count>3</comment_count>
    <who name="Menanteau Guy">menantea</who>
    <bug_when>2016-09-29 11:04:03 -0400</bug_when>
    <thetext>Hi, I tested your qemu (got form your koji link) in same environment as I got the problem and it works fine with your fix. Thanks</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9781252</commentid>
    <comment_count>4</comment_count>
    <who name="Menanteau Guy">menantea</who>
    <bug_when>2016-10-11 09:03:45 -0400</bug_when>
    <thetext>This problem is still present on fedora 25 Beta 1.2 release with qemu-2.7.0-1

f25 Beta-1.2 ppc64le:
http://ppc.koji.fedoraproject.org/compose/25/Fedora-25-20161010.0/compose/Server/ppc64le/iso/Fedora-Server-dvd-ppc64le-25_Beta-1.2.iso</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9792905</commentid>
    <comment_count>5</comment_count>
    <who name="Cole Robinson">crobinso</who>
    <bug_when>2016-10-14 11:53:30 -0400</bug_when>
    <thetext>dwg, did that patch fall of your radar? I don&apos;t see it in qemu.git yet

https://lists.gnu.org/archive/html/qemu-devel/2016-07/msg04879.html</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9798780</commentid>
    <comment_count>6</comment_count>
    <who name="Michael Roth">mdroth</who>
    <bug_when>2016-10-17 17:32:39 -0400</bug_when>
    <thetext>It looks like an alternative patch got pulled in in it&apos;s place for 2.8:

[PATCH] ppc/kvm: Mark 64kB page size support as disabled if not available
QEMU currently refuses to start with KVM-PR and only prints out

        qemu: fatal: Unknown MMU model 851972

when being started there. This is because commit 4322e8ced5aaac719
(&quot;ppc: Fix 64K pages support in full emulation&quot;) introduced a new
POWERPC_MMU_64K bit to indicate support for this page size, but
it never gets cleared on KVM-PR if the host kernel does not support
this. Thus we&apos;ve got to turn off this bit in the mmu_model for KVM-PR.

Signed-off-by: Thomas Huth &lt;thuth@redhat.com&gt;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9798792</commentid>
    <comment_count>7</comment_count>
    <who name="Cole Robinson">crobinso</who>
    <bug_when>2016-10-17 17:42:30 -0400</bug_when>
    <thetext>Thanks Michael! That&apos;s commit 0d594f5565837fe2886a8aa307ef8abb65eab8f7 , I&apos;ll pull it in on the next build</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9809693</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-20 18:56:20 -0400</bug_when>
    <thetext>qemu-2.7.0-6.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-190e517826</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9812763</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-10-22 00:00:03 -0400</bug_when>
    <thetext>qemu-2.7.0-6.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>