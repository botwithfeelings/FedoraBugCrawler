<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1402627</bug_id>
          
          <creation_ts>2016-12-07 20:21:00 -0500</creation_ts>
          <short_desc>atlas-3.10.2-12.fc24 FTBFS</short_desc>
          <delta_ts>2016-12-20 12:21:55 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>atlas</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1400162</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Merlin Mathesius">mmathesi</reporter>
          <assigned_to name="Frantisek Kluknavsky">fkluknav</assigned_to>
          <cc>c.david86</cc>
    
    
    <cc>dakingun</cc>
    
    
    <cc>fkluknav</cc>
    
    
    <cc>orion</cc>
    
    
    <cc>psabata</cc>
    
    
    <cc>sgallagh</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>atlas-3.10.2-14.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-12-20 12:21:55</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9966429</commentid>
    <comment_count>0</comment_count>
    <who name="Merlin Mathesius">mmathesi</who>
    <bug_when>2016-12-07 20:21:21 -0500</bug_when>
    <thetext>atlas-3.10.2-12.fc24 fails to build from source.
This affects Base Runtime, Rawhide, F25, and earlier releases.

The problem is that erroneous flags get passed to the compiler during the build. For example:

/usr/bin/gcc -DL2SIZE=4194304 -I/builddir/build/BUILD/ATLAS/x86_64_base/include -I/builddir/build/BUILD/ATLAS/x86_64_base/..//include -I/builddir/build/BUILD/ATLAS/x86_64_base/..//include/contrib -DAdd_ -DF77_INTEGER=int -DStringSunStyle -DATL_OS_Linux -DATL_ARCH_UNKNOWNx86 -DATL_CPUMHZ=2808 MAC -DATL_AVX -DATL_SSE3 -DATL_SSE2 -DATL_SSE1 -DATL_USE64BITS -DATL_GAS_x8664 -m64 -DWALL -DATL_NCPU=4 -O -fomit-frame-pointer  -g -Wa,--noexecstack -fPIC -m64 -c /builddir/build/BUILD/ATLAS/x86_64_base/..//bin/atlas_tee.c
gcc: error: MAC: No such file or directory

and

/usr/bin/gcc -c -DL2SIZE=4194304 -I/builddir/build/BUILD/ATLAS/x86_64_base/include -I/builddir/build/BUILD/ATLAS/x86_64_base/..//include -I/builddir/build/BUILD/ATLAS/x86_64_base/..//include/contrib -DAdd_ -DF77_INTEGER=int -DStringSunStyle -DATL_OS_Linux -DATL_ARCH_UNKNOWNx86 -DATL_CPUMHZ=2808 -DATL_AVXMAC -DATL_AVX -DATL_SSE3 -DATL_SSE2 -DATL_SSE1 -DATL_USE64BITS -DATL_GAS_x8664 -m64 -DWALL -DATL_NCPU=4 -O -fomit-frame-pointer -msse32 -mfma  -g -Wa,--noexecstack -fPIC -m64 ATL_walltime.c
gcc: error: unrecognized command line option &apos;-msse32&apos;; did you mean &apos;-msse2&apos;?

The reason for the invalid flags appearing is due to some &quot;sed&quot; substitutions in the spec file that are making unexpected modifications to values in the Make.inc file. For example, the &quot;sed -i &apos;s#-DATL_AVX##&apos; Make.inc&quot; and &quot;sed -i &apos;s#-mavx#-msse3#&apos; Make.inc&quot; commands are changing lines such as the following:

    ARCHDEFS = -DATL_OS_Linux -DATL_ARCH_UNKNOWNx86 -DATL_CPUMHZ=2808 -DATL_AVXMAC -DATL_AVX -DATL_SSE3 -DATL_SSE2 -DATL_SSE1 -DATL_USE64BITS -DATL_GAS_x8664
    GCCFLAGS = -O -fomit-frame-pointer -mavx2 -mfma  -g -Wa,--noexecstack -fPIC -m64

to

    ARCHDEFS = -DATL_OS_Linux -DATL_ARCH_UNKNOWNx86 -DATL_CPUMHZ=2808 MAC -DATL_AVX -DATL_SSE3 -DATL_SSE2 -DATL_SSE1 -DATL_USE64BITS -DATL_GAS_x8664
    GCCFLAGS = -O -fomit-frame-pointer -msse32 -mfma  -g -Wa,--noexecstack -fPIC -m64

The fix may be as simple as anchoring the sed substitutions to end on word boundaries such as:

-     sed -i &apos;s#-DATL_AVX##&apos; Make.inc
+     sed -i &apos;s#-DATL_AVX\b##&apos; Make.inc

-     sed -i &apos;s#-mavx#-msse3#&apos; Make.inc
+     sed -i &apos;s#-mavx\b#-msse3#&apos; Make.inc

I have confirmed that making the above two changes allows the package to compile again for x86_64.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9966431</commentid>
    <comment_count>1</comment_count>
    <who name="Merlin Mathesius">mmathesi</who>
    <bug_when>2016-12-07 20:23:02 -0500</bug_when>
    <thetext>Please apply the patch or respond with a reason it should not be applied within two weeks. After that time, a provenpackager will go ahead and apply it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9987858</commentid>
    <comment_count>2</comment_count>
      <attachid>1231926</attachid>
    <who name="Merlin Mathesius">mmathesi</who>
    <bug_when>2016-12-14 17:51:33 -0500</bug_when>
    <thetext>Created attachment 1231926
proposed patch to correct FTBFS issue</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9987957</commentid>
    <comment_count>3</comment_count>
    <who name="Orion Poplawski">orion</who>
    <bug_when>2016-12-14 19:09:20 -0500</bug_when>
    <thetext>Thanks for the patch.  Checked in and building.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9990621</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-15 11:34:41 -0500</bug_when>
    <thetext>atlas-3.10.2-13.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2016-6f9c9156c7</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9992301</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-16 00:33:43 -0500</bug_when>
    <thetext>atlas-3.10.2-13.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-6f9c9156c7</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9995719</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-17 11:42:08 -0500</bug_when>
    <thetext>atlas-3.10.2-14.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2016-1d3b1fc610</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9996997</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-18 21:31:51 -0500</bug_when>
    <thetext>atlas-3.10.2-14.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-1d3b1fc610</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10005705</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-20 12:21:55 -0500</bug_when>
    <thetext>atlas-3.10.2-14.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1231926</attachid>
            <date>2016-12-14 17:51:00 -0500</date>
            <delta_ts>2016-12-14 17:51:33 -0500</delta_ts>
            <desc>proposed patch to correct FTBFS issue</desc>
            <filename>0001-Correct-Make.inc-adjustments-that-were-going-awry-to.patch</filename>
            <type>text/plain</type>
            <size>1577</size>
            <attacher name="Merlin Mathesius">mmathesi</attacher>
            
              <data encoding="base64">RnJvbSBmOTQxYzVhNGFjOWFhMWUzZGU3YTRlMTQ5MzdjZDQyOWM4YjRiMmYyIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBNZXJsaW4gTWF0aGVzaXVzIDxtbWF0aGVzaUByZWRoYXQuY29t
PgpEYXRlOiBXZWQsIDE0IERlYyAyMDE2IDE2OjM2OjA0IC0wNjAwClN1YmplY3Q6IFtQQVRDSF0g
Q29ycmVjdCBNYWtlLmluYyBhZGp1c3RtZW50cyB0aGF0IHdlcmUgZ29pbmcgYXdyeSB0byBmaXgK
IEZUQkZTIChCWiMxNDAyNjI3KS4KCi0tLQogYXRsYXMuc3BlYyB8IDkgKysrKysrLS0tCiAxIGZp
bGUgY2hhbmdlZCwgNiBpbnNlcnRpb25zKCspLCAzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L2F0bGFzLnNwZWMgYi9hdGxhcy5zcGVjCmluZGV4IDdjNTFiOTUuLjMzZmRjMzUgMTAwNjQ0Ci0t
LSBhL2F0bGFzLnNwZWMKKysrIGIvYXRsYXMuc3BlYwpAQCAtNSw3ICs1LDcgQEAgVmVyc2lvbjog
ICAgICAgIDMuMTAuMgogJWlmICIlez9lbmFibGVfbmF0aXZlX2F0bGFzfSIgIT0gIjAiCiAlZGVm
aW5lIGRpc3QgLm5hdGl2ZQogJWVuZGlmCi1SZWxlYXNlOiAgICAgICAgMTIlez9kaXN0fQorUmVs
ZWFzZTogICAgICAgIDEzJXs/ZGlzdH0KIFN1bW1hcnk6ICAgICAgICBBdXRvbWF0aWNhbGx5IFR1
bmVkIExpbmVhciBBbGdlYnJhIFNvZnR3YXJlCiAKIEdyb3VwOiAgICAgICAgICBTeXN0ZW0gRW52
aXJvbm1lbnQvTGlicmFyaWVzCkBAIC00MDEsOSArNDAxLDkgQEAgZm9yIHR5cGUgaW4gJXt0eXBl
c307IGRvCiAjCQlzZWQgLWkgJ3MjQVJDSCA9LiojQVJDSCA9IEhBTU1FUjY0U1NFMiMnIE1ha2Uu
aW5jCiAJCXNlZCAtaSAncyNBUkNIID0uKiNBUkNIID0gSEFNTUVSNjRTU0UzIycgTWFrZS5pbmMK
ICMJCXNlZCAtaSAncyMtREFUTF9TU0UzIyMnIE1ha2UuaW5jCi0JCXNlZCAtaSAncyMtREFUTF9B
VlgjIycgTWFrZS5pbmMgCisJCXNlZCAtaSAncyMtREFUTF9BVlhcYiMjJyBNYWtlLmluYwogIwkJ
c2VkIC1pICdzIy1tc3NlMyMtbXNzZTIjJyBNYWtlLmluYyAKLQkJc2VkIC1pICdzIy1tYXZ4Iy1t
c3NlMyMnIE1ha2UuaW5jCisJCXNlZCAtaSAncyMtbWF2eFxiIy1tc3NlMyMnIE1ha2UuaW5jCiAJ
CWVjaG8gJ2Jhc2UgbWFrZWZpbGUgZWRpdGVkJyAKICMJCXNlZCAtaSAncyNQTUFLRSA9ICQoTUFL
RSkgLiojUE1BS0UgPSAkKE1BS0UpIC1qIDEjJyBNYWtlLmluYyAKIAllbGlmIFsgIiR0eXBlIiA9
ICJzc2UzIiBdOyB0aGVuCkBAIC04MTksNiArODE5LDkgQEAgZmkKICVlbmRpZgogCiAlY2hhbmdl
bG9nCisqIFdlZCBEZWMgMTQgMjAxNiBNZXJsaW4gTWF0aGVzaXVzIDxtbWF0aGVzaUByZWRoYXQu
Y29tPiAtIDMuMTAuMi0xMworLSBDb3JyZWN0IE1ha2UuaW5jIGFkanVzdG1lbnRzIHRoYXQgd2Vy
ZSBnb2luZyBhd3J5IHRvIGZpeCBGVEJGUyAoQlojMTQwMjYyNykuCisKICogV2VkIEZlYiAwMyAy
MDE2IEZlZG9yYSBSZWxlYXNlIEVuZ2luZWVyaW5nIDxyZWxlbmdAZmVkb3JhcHJvamVjdC5vcmc+
IC0gMy4xMC4yLTEyCiAtIFJlYnVpbHQgZm9yIGh0dHBzOi8vZmVkb3JhcHJvamVjdC5vcmcvd2lr
aS9GZWRvcmFfMjRfTWFzc19SZWJ1aWxkCiAKLS0gCjIuOS4zCgo=
</data>

          </attachment>
      

    </bug>

</bugzilla>