<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1401463</bug_id>
          
          <creation_ts>2016-12-05 06:02:00 -0500</creation_ts>
          <short_desc>wireshark-devel  lost all pkg-config dependencies</short_desc>
          <delta_ts>2017-05-29 02:01:16 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>wireshark</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>high</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Daniel Berrange">berrange</reporter>
          <assigned_to name="Martin Sehnoutka">msehnout</assigned_to>
          <cc>crobinso</cc>
    
    
    <cc>huzaifas</cc>
    
    
    <cc>lemenkov</cc>
    
    
    <cc>msehnout</cc>
    
    
    <cc>nenolod</cc>
    
    
    <cc>ngompa13</cc>
    
    
    <cc>nmavrogi</cc>
    
    
    <cc>phatina</cc>
    
    
    <cc>rvokal</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>wireshark-2.2.6-2.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-05-29 02:01:16</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      <flag name="needinfo"
          id="2921293"
          type_id="16"
          status="-"
          setter="msehnout"
    />

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9955561</commentid>
    <comment_count>0</comment_count>
    <who name="Daniel Berrange">berrange</who>
    <bug_when>2016-12-05 06:02:54 -0500</bug_when>
    <thetext>Description of problem:
In Fedora 24 wireshark-devel shows the following deps:

$ rpm -q wireshark-devel
wireshark-devel-2.1.1-1.fc24.x86_64

$ rpm -q wireshark-devel --requires
/usr/bin/pkg-config
glib2-devel
glibc-devel
libwireshark.so.0()(64bit)
libwiretap.so.0()(64bit)
libwscodecs.so.0()(64bit)
libwsutil.so.0()(64bit)
pkgconfig(Qt)
pkgconfig(glib-2.0)
pkgconfig(gmodule-2.0)
pkgconfig(gthread-2.0)
rpmlib(CompressedFileNames) &lt;= 3.0.4-1
rpmlib(FileDigests) &lt;= 4.6.0-1
rpmlib(PayloadFilesHavePrefix) &lt;= 4.0-1
rpmlib(PayloadIsXz) &lt;= 5.2-1
wireshark = 2.1.1-1.fc24


In Fedora 25/rawhide it shows

# rpm -q wireshark-devel
wireshark-devel-2.2.2-2.fc25.x86_64

# rpm -q wireshark-devel --requires
/usr/bin/pkg-config
glib2-devel
glibc-devel
libwireshark.so.8()(64bit)
libwiretap.so.6()(64bit)
libwscodecs.so.1()(64bit)
libwsutil.so.7()(64bit)
rpmlib(CompressedFileNames) &lt;= 3.0.4-1
rpmlib(FileDigests) &lt;= 4.6.0-1
rpmlib(PayloadFilesHavePrefix) &lt;= 4.0-1
rpmlib(PayloadIsXz) &lt;= 5.2-1
wireshark = 2.2.2-2.fc25


Notice that all the pkg-config dependancies have gone. In particular this causes problems because qt4-devel never gets installed  and as a result pkg-config fails to find Qt


# pkg-config --cflags wireshark
Package Qt was not found in the pkg-config search path.
Perhaps you should add the directory containing `Qt.pc&apos;
to the PKG_CONFIG_PATH environment variable
Package &apos;Qt&apos;, required by &apos;wireshark&apos;, not found


Version-Release number of selected component (if applicable):
wireshark-devel-2.2.2-2.fc25.x86_64

How reproducible:
Always

Steps to Reproduce:
1. Install wireshark in a minimal build-root
2. Run pkg-config --cflags wireshark
3.

Actual results:
Fails to find Qt library due to missing RPM deps

Expected results:
Reports cflags

Additional info:</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10060341</commentid>
    <comment_count>1</comment_count>
    <who name="Daniel Berrange">berrange</who>
    <bug_when>2017-01-13 05:15:55 -0500</bug_when>
    <thetext>Any update on fixing this problem</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10223873</commentid>
    <comment_count>2</comment_count>
    <who name="Martin Sehnoutka">msehnout</who>
    <bug_when>2017-03-09 03:02:05 -0500</bug_when>
    <thetext>Hi, I&apos;m taking this bug and will update you soon.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10314553</commentid>
    <comment_count>3</comment_count>
    <who name="Martin Sehnoutka">msehnout</who>
    <bug_when>2017-04-07 10:13:37 -0400</bug_when>
    <thetext>This bug seems to be introduced by one of our patches:
http://pkgs.fedoraproject.org/cgit/rpms/wireshark.git/tree/wireshark-0006-Add-pkgconfig-entry.patch?h=f25

We should start using the upstream wireshark.pc file.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10316111</commentid>
    <comment_count>4</comment_count>
    <who name="William Pitcock">nenolod</who>
    <bug_when>2017-04-07 22:53:53 -0400</bug_when>
    <thetext>hello,

it is a little more involved than that.  while it is true that there is a deviation in the .pc file (which makes very little sense honestly), it is really showing a defect in the rpm dependency generator, which is caused by a design flaw in how pkg-config processes packages.  this bug can also be triggered by two split packages from the same source that have a dependency on each other (but pkg-config&apos;s dependency resolver will not see the other split package&apos;s .pc files, so it will silently fail and not output dependency data).

to provide correct behaviour for dependency generators, pkgconf 1.3.2 and later added an environment variable that can be used to limit the depth that the dependency resolver uses, allowing for the dependency resolver to only resolve top-level dependencies (the packages on the command line themselves) for consumers like the rpm dependency generator, which only wants to dump data from the .pc files.

with pkgconf 1.3.2 and the pull request at https://github.com/rpm-software-management/rpm/pull/192 the bug is fully resolved.

either way, the wireshark .pc file should probably be fixed as well, as there is no reason for wireshark to depend on Qt if it&apos;s not in build depends (if it were, the dependency generator would not fail in this way).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10355800</commentid>
    <comment_count>5</comment_count>
    <who name="Martin Sehnoutka">msehnout</who>
    <bug_when>2017-04-24 05:51:45 -0400</bug_when>
    <thetext>This bug has been resolved:
http://pkgs.fedoraproject.org/cgit/rpms/wireshark.git/commit/?id=3a632b364d874cce40d0b0fd4955e6611ebe1444</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10402062</commentid>
    <comment_count>6</comment_count>
    <who name="Cole Robinson">crobinso</who>
    <bug_when>2017-05-10 17:47:48 -0400</bug_when>
    <thetext>Please also backport this to f24/f25</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10429502</commentid>
    <comment_count>7</comment_count>
    <who name="Neal Gompa">ngompa13</who>
    <bug_when>2017-05-19 11:26:32 -0400</bug_when>
    <thetext>This issue shouldn&apos;t affect Fedora 24, but it is definitely an issue in Fedora 25.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10451301</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-26 09:14:23 -0400</bug_when>
    <thetext>wireshark-2.2.6-2.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-f994c12a2d</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10453063</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-27 00:39:52 -0400</bug_when>
    <thetext>wireshark-2.2.6-2.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-f994c12a2d</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10454655</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-29 02:01:16 -0400</bug_when>
    <thetext>wireshark-2.2.6-2.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>