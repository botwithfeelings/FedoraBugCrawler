<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1420091</bug_id>
          
          <creation_ts>2017-02-07 13:44:00 -0500</creation_ts>
          <short_desc>caja terminal not shown</short_desc>
          <delta_ts>2017-03-10 10:20:11 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>caja-terminal</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>medium</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Monem">mmonem</reporter>
          <assigned_to name="Wolfgang Ulbrich">fedora</assigned_to>
          <cc>fedora</cc>
    
    
    <cc>yselkowi</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>caja-terminal-0.9.1-3.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-03-10 10:20:11</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10128763</commentid>
    <comment_count>0</comment_count>
    <who name="Monem">mmonem</who>
    <bug_when>2017-02-07 13:44:26 -0500</bug_when>
    <thetext>Description of problem:

caja-terminal-0.9.1-1.fc25.x86_64 is installed but it it is not working in any caja file manager window.

How reproducible:
Always Reproducible in all F25 machines I have

Steps to Reproduce:
1. dnf install caja-terminal
2. restart caja or reboot
3. Open any Caja file manager window
4. Caja terminal does not show

Actual results:
- Caja terminal does not show

Expected results:
- Caja terminal should appear</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10129088</commentid>
    <comment_count>1</comment_count>
    <who name="Wolfgang Ulbrich">fedora</who>
    <bug_when>2017-02-07 16:22:11 -0500</bug_when>
    <thetext>caja-terminal needs porting to gtk3 by upstream.
https://github.com/yselkowitz/caja-terminal</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10135691</commentid>
    <comment_count>2</comment_count>
    <who name="Monem">mmonem</who>
    <bug_when>2017-02-09 13:43:14 -0500</bug_when>
    <thetext>I am not python programmer but I made some change from the upstream and the terminal is barely working with some (not important???) warnings. How should I share these changes so that it can be used in public?

Should I fork the upstream github repo or make changes as a patch to be applied while building the rpm from the spec file?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10135855</commentid>
    <comment_count>3</comment_count>
    <who name="Wolfgang Ulbrich">fedora</who>
    <bug_when>2017-02-09 15:02:25 -0500</bug_when>
    <thetext>Great, can you please fork the githup repo and do a pull request by upstream?
This should go in upstream first.
You can also attach a patch here, than i can test it too.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10135947</commentid>
    <comment_count>4</comment_count>
    <who name="Monem">mmonem</who>
    <bug_when>2017-02-09 15:47:51 -0500</bug_when>
    <thetext>---
 code/caja-terminal.py | 45 ++++++++++++++++++++++++---------------------
 1 file changed, 24 insertions(+), 21 deletions(-)

diff --git a/code/caja-terminal.py b/code/caja-terminal.py
index a0140e2..eb70bca 100755
--- a/code/caja-terminal.py
+++ b/code/caja-terminal.py
@@ -1,4 +1,4 @@
-#!/usr/bin/python
+#!/usr/bin/python2
 # -*- coding: UTF-8 -*-
 
   #########################################################################
@@ -33,7 +33,7 @@
 ##                                                                        ##
 ############################################################################
 ##                                                                        ##
-## WEB SITE : https://github.com/yselkowitz/caja-terminal                 ##
+## WEB SITE : https://github.com/NiceandGently/caja-terminal              ##
 ##                                                                       ##
  #########################################################################
 
@@ -705,10 +705,10 @@ class CajaTerminal(GObject.GObject, Caja.LocationWidgetProvider):
         terminal.show()
         sclwinTerm.add(terminal)
         #scrollbar
-        terminal.set_scroll_adjustments(
-                gui.get_object(&quot;adjH&quot;),
-                gui.get_object(&quot;adjV&quot;),
-                )
+#        terminal.set_scroll_adjustments(
+#                gui.get_object(&quot;adjH&quot;),
+#                gui.get_object(&quot;adjV&quot;),
+#                )
         if CONF[&apos;general_showscrollbar&apos;]:
             vpolicy = Gtk.PolicyType.ALWAYS
         else:
@@ -758,9 +758,9 @@ class CajaTerminal(GObject.GObject, Caja.LocationWidgetProvider):
         terminal.connect(&quot;focus&quot;, self.on_terminal_need_child,
                 window, terminal, sclwinTerm, path,
                 )
-        terminal.connect(&quot;expose-event&quot;, self.on_terminal_need_child,
-                window, terminal, sclwinTerm, path,
-                )
+#        terminal.connect(&quot;expose-event&quot;, self.on_terminal_need_child,
+#                window, terminal, sclwinTerm, path,
+#                )
         terminal.connect(&quot;button-press-event&quot;, self.on_terminal_need_child,
                 window, terminal, sclwinTerm, path,
                 )
@@ -771,13 +771,13 @@ class CajaTerminal(GObject.GObject, Caja.LocationWidgetProvider):
         #DnD
         if Gtk._version != &apos;2.0&apos;:
             # Missing from Gtk-2.0 introspection
-            terminal.drag_dest_set(
-                    Gtk.DestDefaults.MOTION |
-                    Gtk.DestDefaults.HIGHLIGHT |
-                    Gtk.DestDefaults.DROP,
-                    [(&apos;text/uri-list&apos;, 0, 80)],
-                    Gdk.DragAction.COPY,
-                    )
+#            terminal.drag_dest_set(
+#                    Gtk.DestDefaults.MOTION |
+#                    Gtk.DestDefaults.HIGHLIGHT |
+#                    Gtk.DestDefaults.DROP,
+#                    [(&apos;text/uri-list&apos;, 0, 80)],
+#                    Gdk.DragAction.COPY,
+#                    )
             terminal.connect(&quot;drag_motion&quot;, self.on_terminal_drag_motion)
             terminal.connect(&quot;drag_drop&quot;, self.on_terminal_drag_drop)
             terminal.connect(&quot;drag_data_received&quot;, self.on_terminal_drag_data_received)
@@ -822,7 +822,7 @@ class CajaTerminal(GObject.GObject, Caja.LocationWidgetProvider):
         #Size
         rwidget.set_size_request(-1, window.nt_termheight)
         #fork
-        window.nt_lastpid = terminal.fork_command_full(Vte.PtyFlags.DEFAULT,
+        window.nt_lastpid = terminal.spawn_sync(Vte.PtyFlags.DEFAULT,
                 None, [CONF[&apos;general_command&apos;]], None,
                 GLib.SpawnFlags.SEARCH_PATH, None, None)[1]
         terminal.feed(&quot;\033[2K\033[1G&quot;)
@@ -956,11 +956,15 @@ class CajaTerminal(GObject.GObject, Caja.LocationWidgetProvider):
             colors = CONF[&apos;color_palette&apos;]
         else:
             colors = PREDEF_PALETTE[&apos;Tango&apos;]
-        fg = Gdk.color_parse(CONF[&apos;color_text&apos;])
-        bg = Gdk.color_parse(CONF[&apos;color_background&apos;])
+        fg = Gdk.RGBA()
+        bg = Gdk.RGBA()
+        fg.parse(CONF[&apos;color_text&apos;])
+        bg.parse(CONF[&apos;color_background&apos;])
         palette = []
         for color in colors:
-            palette.append(Gdk.color_parse(color))
+            c = Gdk.RGBA()
+            c.parse(color)
+            palette.append(c)
         terminal.set_colors(fg, bg, palette)
         #Font
         font = Pango.FontDescription(CONF[&apos;font_name&apos;])
@@ -991,4 +995,3 @@ def match_path(path, path_list):
 
 CONF = Conf(CONF_FILE)
 
-
--</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10137215</commentid>
    <comment_count>5</comment_count>
    <who name="Wolfgang Ulbrich">fedora</who>
    <bug_when>2017-02-10 03:06:32 -0500</bug_when>
    <thetext>That works but preferences gui is broken and i see a lot of warnining in xsession-errors

Traceback (most recent call last):
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 929, in on_evResize_enter_notify_event
    widget.window.set_cursor(cursor)
AttributeError: &apos;EventBox&apos; object has no attribute &apos;window&apos;
Traceback (most recent call last):
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 933, in on_evResize_leave_notify_event
    widget.window.set_cursor(cursor)
AttributeError: &apos;EventBox&apos; object has no attribute &apos;window&apos;
Traceback (most recent call last):
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 842, in preferences
    CajaTerminalPref(self._set_terminal, terminal)
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 347, in __init__
    self.gui.add_from_file(PREF_GUI_FILE)
GLib.Error: gtk-builder-error-quark: /usr/share/caja-terminal/caja-terminal-preferences.glade:983:37 Invalid property: GtkAboutDialog.has_separator (11)

Btw. actual upstream is https://github.com/yselkowitz/caja-terminal
I think it is really helpful to work there on the issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10137253</commentid>
    <comment_count>6</comment_count>
    <who name="Wolfgang Ulbrich">fedora</who>
    <bug_when>2017-02-10 03:27:26 -0500</bug_when>
    <thetext>Ok removing those lines with &lt;property name=&quot;has_separator&quot;&gt;False&lt;/property&gt;
from glade file let&apos;s start the preferences dialog, but than there are more warnings.

Traceback (most recent call last):
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 929, in on_evResize_enter_notify_event
    widget.window.set_cursor(cursor)
AttributeError: &apos;EventBox&apos; object has no attribute &apos;window&apos;
Traceback (most recent call last):
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 933, in on_evResize_leave_notify_event
    widget.window.set_cursor(cursor)
AttributeError: &apos;EventBox&apos; object has no attribute &apos;window&apos;
Traceback (most recent call last):
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 489, in on_comboboxPalette_changed
    self._set_palette(self._conf[&apos;color_palettename&apos;])
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 610, in _set_palette
    self.demoTerm.set_colors(fg, bg, palette)
TypeError: argument foreground: Expected Gdk.RGBA, but got gi.overrides.Gdk.Color
Traceback (most recent call last):
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 842, in preferences
    CajaTerminalPref(self._set_terminal, terminal)
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 435, in __init__
    self._put_opt()
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 577, in _put_opt
    self._set_palette(self._conf[&apos;color_palettename&apos;])
  File &quot;/usr/share/caja-python/extensions/caja-terminal.py&quot;, line 610, in _set_palette
    self.demoTerm.set_colors(fg, bg, palette)
TypeError: argument foreground: Expected Gdk.RGBA, but got gi.overrides.Gdk.Color</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10137809</commentid>
    <comment_count>7</comment_count>
    <who name="Monem">mmonem</who>
    <bug_when>2017-02-10 07:18:53 -0500</bug_when>
    <thetext>I fixed all the warnings I saw and done what you said about the glade file (thank you)

I have created a pull request but I done&apos;t know if there will be any response from the author.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10171862</commentid>
    <comment_count>8</comment_count>
    <who name="Wolfgang Ulbrich">fedora</who>
    <bug_when>2017-02-21 12:13:48 -0500</bug_when>
    <thetext>I did a scratch build for testing
https://koji.fedoraproject.org/koji/taskinfo?taskID=17977486
With gtk3 patch from other PR and one of your commits and a patch for ui files from me.
If it works for you i will push that quickly to repos.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10177140</commentid>
    <comment_count>9</comment_count>
    <who name="Monem">mmonem</who>
    <bug_when>2017-02-23 01:15:48 -0500</bug_when>
    <thetext>Thanks for the effort but I don&apos;t know where to find the rpm of your build. All what I found on koji is your old builds only.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10177218</commentid>
    <comment_count>10</comment_count>
    <who name="Wolfgang Ulbrich">fedora</who>
    <bug_when>2017-02-23 01:45:13 -0500</bug_when>
    <thetext>No, this is the new build at koji
Here is the srpm of it, compare which patches are used in spec file.
https://dl.dropboxusercontent.com/u/49862637/Mate-desktop/SOURCE/caja-terminal-0.9.1-2.fc25.src.rpm</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10177300</commentid>
    <comment_count>11</comment_count>
    <who name="Monem">mmonem</who>
    <bug_when>2017-02-23 02:40:22 -0500</bug_when>
    <thetext>I just built the rpm and installed/tested it and it works correctly without warnings even after playing with the preferences, colors, etc.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10177413</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-02-23 03:25:32 -0500</bug_when>
    <thetext>caja-terminal-0.9.1-2.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-4d2d528355</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10177431</commentid>
    <comment_count>13</comment_count>
    <who name="Wolfgang Ulbrich">fedora</who>
    <bug_when>2017-02-23 03:33:08 -0500</bug_when>
    <thetext>PS: thanks a lot for your help to fixes the issue :-)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10177447</commentid>
    <comment_count>14</comment_count>
    <who name="Monem">mmonem</who>
    <bug_when>2017-02-23 03:39:17 -0500</bug_when>
    <thetext>Thanks to all.

by the way I added my own karma at bohdi ;-)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10180279</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-02-23 18:21:30 -0500</bug_when>
    <thetext>caja-terminal-0.9.1-2.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-4d2d528355</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10183560</commentid>
    <comment_count>16</comment_count>
    <who name="Monem">mmonem</who>
    <bug_when>2017-02-25 04:21:51 -0500</bug_when>
    <thetext>Installed it from the updates-testing repo and it is fine</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10201109</commentid>
    <comment_count>17</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-02 04:47:30 -0500</bug_when>
    <thetext>caja-terminal-0.9.1-3.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-4d2d528355</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10204678</commentid>
    <comment_count>18</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-02 23:52:20 -0500</bug_when>
    <thetext>caja-terminal-0.9.1-3.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-4d2d528355</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10228694</commentid>
    <comment_count>19</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-10 10:20:11 -0500</bug_when>
    <thetext>caja-terminal-0.9.1-3.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>