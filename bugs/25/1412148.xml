<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1412148</bug_id>
          
          <creation_ts>2017-01-11 06:53:00 -0500</creation_ts>
          <short_desc>containerd: container did not start before the specified timeout</short_desc>
          <delta_ts>2017-01-17 03:23:44 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>docker</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1412164</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Lukas Slebodnik">lslebodn</reporter>
          <assigned_to name="Antonio Murdaca">amurdaca</assigned_to>
          <cc>adimania</cc>
    
    
    <cc>admiller</cc>
    
    
    <cc>amurdaca</cc>
    
    
    <cc>dwalsh</cc>
    
    
    <cc>ichavero</cc>
    
    
    <cc>jcajka</cc>
    
    
    <cc>jchaloup</cc>
    
    
    <cc>lsm5</cc>
    
    
    <cc>marianne</cc>
    
    
    <cc>miminar</cc>
    
    
    <cc>nalin</cc>
    
    
    <cc>riek</cc>
    
    
    <cc>vbatts</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>docker-1.12.6-3.git51ef5a8.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-01-12 21:23:54</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10052391</commentid>
    <comment_count>0</comment_count>
    <who name="Lukas Slebodnik">lslebodn</who>
    <bug_when>2017-01-11 06:53:23 -0500</bug_when>
    <thetext>Description of problem:
I run CI test in docker containers with various distributions
and int sometimes happen to me that &quot;container did not start before the specified timeout&quot;


Version-Release number of selected component (if applicable):
sh# rpm -q docker
docker-1.12.5-4.git03508cc.fc25.x86_64

How reproducible:
non-deterministic

Steps to Reproduce:
Unfortunately, I do not have a reliable reproducer.

Actual results:
//there is just a created container; but it is not running.
sh# docker ps -a
3e9c420dc892        temp/debian_testing_ci   &quot;sh -e -c &apos;sudo su -c&quot;   10 hours ago        Created                                                      pensive_ardinghelli

Expected results:
No such intermittent issue

Additional info:
related part of journal log

Jan 11 02:15:32 vm-153.example.com docker-containerd-current[11813]: time=&quot;2017-01-11T02:15:32.323752307+01:00&quot; level=error msg=&quot;containerd: start container&quot; error=&quot;containerd: container did not start before the specified timeout&quot; id=3e9c420dc892144aeb404a4f3acc7f3b3b96ccf3e5f1f2161434a27a05f8b56f
Jan 11 02:15:32 vm-153.example.com systemd[1]: libcontainer-23026-systemd-test-default-dependencies.scope: Scope has no PIDs. Refusing.
Jan 11 02:15:32 vm-153.example.com systemd[1]: libcontainer-23026-systemd-test-default-dependencies.scope: Scope has no PIDs. Refusing.
Jan 11 02:15:33 vm-153.example.com dockerd-current[11882]: time=&quot;2017-01-11T02:15:33.099431736+01:00&quot; level=error msg=&quot;Create container failed with error: containerd: container did not start before the specified timeout&quot;
Jan 11 02:15:34 vm-153.example.com kernel: docker0: port 2(veth132dd3f) entered disabled state
Jan 11 02:15:34 vm-153.example.com kernel: device veth132dd3f left promiscuous mode
Jan 11 02:15:34 vm-153.example.com kernel: docker0: port 2(veth132dd3f) entered disabled state
Jan 11 02:15:34 vm-153.example.com audit: ANOM_PROMISCUOUS dev=veth132dd3f prom=0 old_prom=256 auid=4294967295 uid=0 gid=0 ses=4294967295
Jan 11 02:15:34 vm-153.example.com NetworkManager[1128]: &lt;info&gt;  [1484097334.5298] device (vetha4686a3): driver &apos;veth&apos; does not support carrier detection.
Jan 11 02:15:34 vm-153.example.com NetworkManager[1128]: &lt;info&gt;  [1484097334.5309] device (veth132dd3f): driver &apos;veth&apos; does not support carrier detection.
Jan 11 02:15:35 vm-153.example.com kernel: XFS (dm-6): Unmounting Filesystem
Jan 11 02:15:35 vm-153.example.com dockerd-current[11882]: time=&quot;2017-01-11T02:15:35.307872220+01:00&quot; level=error msg=&quot;Handler for POST /v1.24/containers/3e9c420dc892144aeb404a4f3acc7f3b3b96ccf3e5f1f2161434a27a05f8b56f/start returned error: containerd: container did not start before the specified timeout&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10052396</commentid>
    <comment_count>1</comment_count>
    <who name="Lukas Slebodnik">lslebodn</who>
    <bug_when>2017-01-11 06:56:53 -0500</bug_when>
    <thetext>docker inspect says:

[
    {
        &quot;Id&quot;: &quot;3e9c420dc892144aeb404a4f3acc7f3b3b96ccf3e5f1f2161434a27a05f8b56f&quot;,
        &quot;Created&quot;: &quot;2017-01-11T01:15:06.130476175Z&quot;,
        &quot;Path&quot;: &quot;sh&quot;,
        &quot;Args&quot;: [
            &quot;-e&quot;,
            &quot;-c&quot;,
            &quot;sudo su -c \&quot;apt-get update || apt-get update\&quot; \u0026\u0026 sudo su -c \&quot;DEBIAN_FRONTEND=noninteractive apt-get upgrade -y\&quot; \u0026\u0026 sudo su -c \&quot;DEBIAN_FRONTEND=noninteractive apt-get dist-upgrade -y\&quot; \u0026\u0026 git pull -v \u0026\u0026 git am -3 /home/build/*.patch \u0026\u0026 contrib/ci/run -f -p $HOSTNAME:/home/build/&quot;
        ],
        &quot;State&quot;: {
            &quot;Status&quot;: &quot;created&quot;,
            &quot;Running&quot;: false,
            &quot;Paused&quot;: false,
            &quot;Restarting&quot;: false,
            &quot;OOMKilled&quot;: false,
            &quot;Dead&quot;: false,
            &quot;Pid&quot;: 0,
            &quot;ExitCode&quot;: 128,
            &quot;Error&quot;: &quot;containerd: container did not start before the specified timeout&quot;,
            &quot;StartedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;,
            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;
        },
        &quot;Image&quot;: &quot;sha256:3a50a5f12f83b1b9e37d0413c54938894fdb21507788f140541b565217451b28&quot;,
        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/3e9c420dc892144aeb404a4f3acc7f3b3b96ccf3e5f1f2161434a27a05f8b56f/resolv.conf&quot;,
        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/3e9c420dc892144aeb404a4f3acc7f3b3b96ccf3e5f1f2161434a27a05f8b56f/hostname&quot;,
        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/3e9c420dc892144aeb404a4f3acc7f3b3b96ccf3e5f1f2161434a27a05f8b56f/hosts&quot;,
        &quot;LogPath&quot;: &quot;&quot;,
        &quot;Name&quot;: &quot;/pensive_ardinghelli&quot;,
        &quot;RestartCount&quot;: 0,
        &quot;Driver&quot;: &quot;devicemapper&quot;,
        &quot;MountLabel&quot;: &quot;system_u:object_r:container_file_t:s0:c276,c582&quot;,
        &quot;ProcessLabel&quot;: &quot;system_u:system_r:container_t:s0:c276,c582&quot;,
        &quot;AppArmorProfile&quot;: &quot;&quot;,
        &quot;ExecIDs&quot;: null,
        &quot;HostConfig&quot;: {
            &quot;Binds&quot;: null,
            &quot;ContainerIDFile&quot;: &quot;debian_testing_ci_container_id.1484097304&quot;,
            &quot;LogConfig&quot;: {
                &quot;Type&quot;: &quot;journald&quot;,
                &quot;Config&quot;: {}
            },
            &quot;NetworkMode&quot;: &quot;default&quot;,
            &quot;PortBindings&quot;: {},
            &quot;RestartPolicy&quot;: {
                &quot;Name&quot;: &quot;no&quot;,
                &quot;MaximumRetryCount&quot;: 0
            },
            &quot;AutoRemove&quot;: false,
            &quot;VolumeDriver&quot;: &quot;&quot;,
            &quot;VolumesFrom&quot;: null,
            &quot;CapAdd&quot;: null,
            &quot;CapDrop&quot;: null,
            &quot;Dns&quot;: [],
            &quot;DnsOptions&quot;: [],
            &quot;DnsSearch&quot;: [],
            &quot;ExtraHosts&quot;: null,
            &quot;GroupAdd&quot;: null,
            &quot;IpcMode&quot;: &quot;&quot;,
            &quot;Cgroup&quot;: &quot;&quot;,
            &quot;Links&quot;: null,
            &quot;OomScoreAdj&quot;: 0,
            &quot;PidMode&quot;: &quot;&quot;,
            &quot;Privileged&quot;: false,
            &quot;PublishAllPorts&quot;: false,
            &quot;ReadonlyRootfs&quot;: false,
            &quot;SecurityOpt&quot;: null,
            &quot;UTSMode&quot;: &quot;&quot;,
            &quot;UsernsMode&quot;: &quot;&quot;,
            &quot;ShmSize&quot;: 67108864,
            &quot;Runtime&quot;: &quot;oci&quot;,
            &quot;ConsoleSize&quot;: [
                0,
                0
            ],
            &quot;Isolation&quot;: &quot;&quot;,
            &quot;CpuShares&quot;: 0,
            &quot;Memory&quot;: 0,
            &quot;CgroupParent&quot;: &quot;&quot;,
            &quot;BlkioWeight&quot;: 0,
            &quot;BlkioWeightDevice&quot;: null,
            &quot;BlkioDeviceReadBps&quot;: null,
            &quot;BlkioDeviceWriteBps&quot;: null,
            &quot;BlkioDeviceReadIOps&quot;: null,
            &quot;BlkioDeviceWriteIOps&quot;: null,
            &quot;CpuPeriod&quot;: 0,
            &quot;CpuQuota&quot;: 0,
            &quot;CpusetCpus&quot;: &quot;&quot;,
            &quot;CpusetMems&quot;: &quot;&quot;,
            &quot;Devices&quot;: [],
            &quot;DiskQuota&quot;: 0,
            &quot;KernelMemory&quot;: 0,
            &quot;MemoryReservation&quot;: 0,
            &quot;MemorySwap&quot;: 0,
            &quot;MemorySwappiness&quot;: -1,
            &quot;OomKillDisable&quot;: false,
            &quot;PidsLimit&quot;: 1024,
            &quot;Ulimits&quot;: null,
            &quot;CpuCount&quot;: 0,
            &quot;CpuPercent&quot;: 0,
            &quot;IOMaximumIOps&quot;: 0,
            &quot;IOMaximumBandwidth&quot;: 0
        },
        &quot;GraphDriver&quot;: {
            &quot;Name&quot;: &quot;devicemapper&quot;,
            &quot;Data&quot;: {
                &quot;DeviceId&quot;: &quot;56435&quot;,
                &quot;DeviceName&quot;: &quot;docker-253:1-261561-a1043dd326699e7af5affeac3486fb48529124a26f3bcc3688b2c127521dc120&quot;,
                &quot;DeviceSize&quot;: &quot;107374182400&quot;
            }
        },
        &quot;Mounts&quot;: [],
        &quot;Config&quot;: {
            &quot;Hostname&quot;: &quot;3e9c420dc892&quot;,
            &quot;Domainname&quot;: &quot;&quot;,
            &quot;User&quot;: &quot;build&quot;,
            &quot;AttachStdin&quot;: false,
            &quot;AttachStdout&quot;: true,
            &quot;AttachStderr&quot;: true,
            &quot;Tty&quot;: false,
            &quot;OpenStdin&quot;: false,
            &quot;StdinOnce&quot;: false,
            &quot;Env&quot;: [
                &quot;PATH=/usr/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;,
                &quot;TALLOC_FREE_FILL=222&quot;,
                &quot;MALLOC_PERTURB_=190&quot;,
                &quot;USER=build&quot;
            ],
            &quot;Cmd&quot;: [
                &quot;sh&quot;,
                &quot;-e&quot;,
                &quot;-c&quot;,
                &quot;sudo su -c \&quot;apt-get update || apt-get update\&quot; \u0026\u0026 sudo su -c \&quot;DEBIAN_FRONTEND=noninteractive apt-get upgrade -y\&quot; \u0026\u0026 sudo su -c \&quot;DEBIAN_FRONTEND=noninteractive apt-get dist-upgrade -y\&quot; \u0026\u0026 git pull -v \u0026\u0026 git am -3 /home/build/*.patch \u0026\u0026 contrib/ci/run -f -p $HOSTNAME:/home/build/&quot;
            ],
            &quot;Image&quot;: &quot;temp/debian_testing_ci&quot;,
            &quot;Volumes&quot;: null,
            &quot;WorkingDir&quot;: &quot;/home/build&quot;,
            &quot;Entrypoint&quot;: null,
            &quot;OnBuild&quot;: null,
            &quot;Labels&quot;: {}
        },
        &quot;NetworkSettings&quot;: {
            &quot;Bridge&quot;: &quot;&quot;,
            &quot;SandboxID&quot;: &quot;600cd344921d7b3e75f49438c61e7a60e532404d385480e1887e94019ee5c26d&quot;,
            &quot;HairpinMode&quot;: false,
            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,
            &quot;LinkLocalIPv6PrefixLen&quot;: 0,
            &quot;Ports&quot;: null,
            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/600cd344921d&quot;,
            &quot;SecondaryIPAddresses&quot;: null,
            &quot;SecondaryIPv6Addresses&quot;: null,
            &quot;EndpointID&quot;: &quot;&quot;,
            &quot;Gateway&quot;: &quot;&quot;,
            &quot;GlobalIPv6Address&quot;: &quot;&quot;,
            &quot;GlobalIPv6PrefixLen&quot;: 0,
            &quot;IPAddress&quot;: &quot;&quot;,
            &quot;IPPrefixLen&quot;: 0,
            &quot;IPv6Gateway&quot;: &quot;&quot;,
            &quot;MacAddress&quot;: &quot;&quot;,
            &quot;Networks&quot;: {
                &quot;bridge&quot;: {
                    &quot;IPAMConfig&quot;: null,
                    &quot;Links&quot;: null,
                    &quot;Aliases&quot;: null,
                    &quot;NetworkID&quot;: &quot;add43d5a6a68390c2573ab139b1411accf2fd8292f87c8b1c717d5db405e0d92&quot;,
                    &quot;EndpointID&quot;: &quot;&quot;,
                    &quot;Gateway&quot;: &quot;&quot;,
                    &quot;IPAddress&quot;: &quot;&quot;,
                    &quot;IPPrefixLen&quot;: 0,
                    &quot;IPv6Gateway&quot;: &quot;&quot;,
                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,
                    &quot;GlobalIPv6PrefixLen&quot;: 0,
                    &quot;MacAddress&quot;: &quot;&quot;
                }
            }
        }
    }
]</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10052401</commentid>
    <comment_count>2</comment_count>
    <who name="Lukas Slebodnik">lslebodn</who>
    <bug_when>2017-01-11 06:58:19 -0500</bug_when>
    <thetext>And I could not see such problems on fedora24 with older docker 1.10.3-55.gite03ddb8.fc24</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10052413</commentid>
    <comment_count>3</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2017-01-11 07:03:06 -0500</bug_when>
    <thetext>Alright, we need to add --start-timeout=2m to the docker-containerd unit file. This is happening in Fedora because we use a different containerd process while docker upstream embeds containerd spawning. I&apos;ll update the unit file and release an update. Meanwhile, could you add &quot;--start-timeout=2m&quot; to the docker-containerd.service ExecStart and re-test? 

Source: https://github.com/docker/docker/issues/22226</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10052576</commentid>
    <comment_count>4</comment_count>
    <who name="Lukas Slebodnik">lslebodn</who>
    <bug_when>2017-01-11 07:33:15 -0500</bug_when>
    <thetext>OK; I tried workaround. I home that 2 mins will be enough

sh# mkdir /etc/systemd/system/docker-containerd.service.d/

sh# cat /etc/systemd/system/docker-containerd.service.d/timeout.conf 
[Service]
ExecStart=
ExecStart=/usr/libexec/docker/docker-containerd-current --listen unix:///run/containerd.sock --shim /usr/libexec/docker/docker-containerd-shim-current --start-timeout=2m

sh# systemctl daemon-reload
sh# systemctl restart docker.service docker-containerd.service</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10052772</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-01-11 08:29:29 -0500</bug_when>
    <thetext>docker-1.12.6-3.git51ef5a8.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-dbc2b618eb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10056043</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-01-12 02:52:33 -0500</bug_when>
    <thetext>docker-1.12.6-3.git51ef5a8.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-dbc2b618eb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10059381</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-01-12 21:23:54 -0500</bug_when>
    <thetext>docker-1.12.6-3.git51ef5a8.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10069460</commentid>
    <comment_count>8</comment_count>
    <who name="Lukas Slebodnik">lslebodn</who>
    <bug_when>2017-01-17 03:16:48 -0500</bug_when>
    <thetext>FYI, I have been testing docker-containerd.service with shorter timeout. Just 1 minute. And I could not see any problem yet.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10069492</commentid>
    <comment_count>9</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2017-01-17 03:23:44 -0500</bug_when>
    <thetext>(In reply to Lukas Slebodnik from comment #8)
&gt; FYI, I have been testing docker-containerd.service with shorter timeout.
&gt; Just 1 minute. And I could not see any problem yet.

Cool, 2min has no harm afaict though, just following what upstrea does. Thanks for testing Lukas.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>