<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1373317</bug_id>
          
          <creation_ts>2016-09-05 21:32:00 -0400</creation_ts>
          <short_desc>RFE: Add &quot;type=rpm-md&quot; and &quot;repo_gpgcheck=0&quot; to Fedora repo files</short_desc>
          <delta_ts>2017-03-18 10:36:53 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>fedora-repos</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>NEXTRELEASE</resolution>
          
          <see_also>https://bugzilla.redhat.com/show_bug.cgi?id=1433592</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1427185</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Neal Gompa">ngompa13</reporter>
          <assigned_to name="Dennis Gilmore">dennis</assigned_to>
          <cc>dennis</cc>
    
    
    <cc>kevin</cc>
    
    
    <cc>klember</cc>
    
    
    <cc>mboddu</cc>
    
    
    <cc>mkolman</cc>
    
    
    <cc>pbrobinson</cc>
    
    
    <cc>stefan</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-03-10 08:41:04</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9680655</commentid>
    <comment_count>0</comment_count>
    <who name="Neal Gompa">ngompa13</who>
    <bug_when>2016-09-05 21:32:11 -0400</bug_when>
    <thetext>Description of problem:
I&apos;m working on packaging Zypper for Fedora. For now, it sits in a COPR repository[1] and requires manual effort to configure properly. However, I&apos;d like to set up Zypper to use the repo files in /etc/yum.repos.d when I&apos;m ready to submit it for review.

For that to work, two values are missing from each repository specified in the .repo files in /etc/yum.repos.d: the repo type and whether to verify the signature of the repository metadata.

The repository type is set by adding &quot;type=rpm-md&quot; under each section in the .repo files. This is necessary because Zypper supports three types: rpm-md, yast2, and plaindir. This is noted in zypper(8).

As for verifying the signature of repository metadata, Fedora currently does not sign repository metadata (with the exception of the Cisco OpenH264 repository). For the repositories where it does not sign the repository metadata, &quot;repo_gpgcheck=0&quot; needs to be added so that Zypper will not refuse to load repository metadata that isn&apos;t signed. By default, it expects them to be signed.

The addition of these values has no effect on DNF, as it simply ignores &quot;type=&quot; and it already defaults to &quot;repo_gpgcheck=0&quot; if not specified in the .repo file.

[1]: https://copr.fedorainfracloud.org/coprs/ngompa/zypper/

Version-Release number of selected component (if applicable):
All current versions are affected for Fedora 24, 25, and Rawhide (F26)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9680799</commentid>
    <comment_count>1</comment_count>
    <who name="Neal Gompa">ngompa13</who>
    <bug_when>2016-09-05 22:53:35 -0400</bug_when>
    <thetext>Also, changes to COPR have already been merged in to generate .repo files that include this new data: https://github.com/fedora-copr/copr/pull/12</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9684370</commentid>
    <comment_count>2</comment_count>
    <who name="Kevin Fenzi">kevin</who>
    <bug_when>2016-09-06 18:45:30 -0400</bug_when>
    <thetext>Do we know how this interacts with gnome-software/PackageKit? We will want to make sure it doesn&apos;t run into any problems with it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9685457</commentid>
    <comment_count>3</comment_count>
    <who name="Kalev Lember">klember</who>
    <bug_when>2016-09-07 03:57:33 -0400</bug_when>
    <thetext>I think these should both be fine for PackageKit. It has support for parsing the &quot;repo_gpgcheck&quot; key and just ignores the &quot;type&quot; key.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9687654</commentid>
    <comment_count>4</comment_count>
    <who name="Dennis Gilmore">dennis</who>
    <bug_when>2016-09-07 13:32:16 -0400</bug_when>
    <thetext>I have no problems adding repo_gpgcheck however the type is kinda messy and strange</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9692103</commentid>
    <comment_count>5</comment_count>
    <who name="Neal Gompa">ngompa13</who>
    <bug_when>2016-09-08 16:26:01 -0400</bug_when>
    <thetext>How is it strange? It just declares what type of repodata it is.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9695627</commentid>
    <comment_count>6</comment_count>
    <who name="Dennis Gilmore">dennis</who>
    <bug_when>2016-09-09 18:04:07 -0400</bug_when>
    <thetext>what is rpm-md?  and why do we need a type anyway?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9695679</commentid>
    <comment_count>7</comment_count>
    <who name="Dennis Gilmore">dennis</who>
    <bug_when>2016-09-09 19:50:47 -0400</bug_when>
    <thetext>loking further I found https://en.opensuse.org/openSUSE:Standards_Rpm_Metadata which makes me sad, it does not use the sqlitedbs we produce to make things work faster. suse has also added its own non standard data.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9695755</commentid>
    <comment_count>8</comment_count>
    <who name="Dennis Gilmore">dennis</who>
    <bug_when>2016-09-09 20:59:21 -0400</bug_when>
    <thetext>I have filed https://github.com/openSUSE/zypper/issues/100 upstream as rpm-md really makes no sense</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9696304</commentid>
    <comment_count>9</comment_count>
    <who name="Neal Gompa">ngompa13</who>
    <bug_when>2016-09-10 16:04:37 -0400</bug_when>
    <thetext>The nonstandard parts are the &quot;susetags&quot;/&quot;yast2&quot; format, which is rpm-md with extra suse stuff.

The SQLite database information isn&apos;t used by DNF either. libsolv constructs a solver cache from the rpm-md XML data and uses that for quickly identifying things in repositories. The SQLite metadata form is essentially deprecated, and as far as I&apos;m aware, the only tool that actually handled that data was Yum.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9708641</commentid>
    <comment_count>10</comment_count>
    <who name="Neal Gompa">ngompa13</who>
    <bug_when>2016-09-14 15:51:33 -0400</bug_when>
    <thetext>So now libzypp supports &quot;rpm&quot; as an alias for &quot;rpm-md&quot;. Would you now be willing to add it to the repo files in fedora-repos?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9709013</commentid>
    <comment_count>11</comment_count>
    <who name="Dennis Gilmore">dennis</who>
    <bug_when>2016-09-14 18:56:17 -0400</bug_when>
    <thetext>added in https://pagure.io/fedora-repos/pull-request/14</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9713084</commentid>
    <comment_count>12</comment_count>
    <who name="Neal Gompa">ngompa13</who>
    <bug_when>2016-09-16 00:00:03 -0400</bug_when>
    <thetext>Could you also add it to F25 (and maaaybe even F24)?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10228271</commentid>
    <comment_count>13</comment_count>
    <who name="Neal Gompa">ngompa13</who>
    <bug_when>2017-03-10 08:41:04 -0500</bug_when>
    <thetext>This is coming with F26...</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>