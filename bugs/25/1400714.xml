<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1400714</bug_id>
          
          <creation_ts>2016-12-01 17:34:00 -0500</creation_ts>
          <short_desc>implement alwaysprompt=no option</short_desc>
          <delta_ts>2017-06-16 09:19:01 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>dnf</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Triaged</keywords>
          <priority>low</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Georg Sauthoff">fedora</reporter>
          <assigned_to name="Jaroslav Rohel">jrohel</assigned_to>
          <cc>jrohel</cc>
    
    
    <cc>mluscon</cc>
    
    
    <cc>packaging-team-maint</cc>
    
    
    <cc>rpm-software-management</cc>
    
    
    <cc>vmukhame</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>dnf-2.5.1-1.fc26</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-06-16 09:19:01</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9949178</commentid>
    <comment_count>0</comment_count>
    <who name="Georg Sauthoff">fedora</who>
    <bug_when>2016-12-01 17:34:36 -0500</bug_when>
    <thetext>Description of problem:
Yum has this option `--setopt=alwaysprompt=no` to suppress some prompting. As expected, dnf understands this option as well but when using it, dnf fails with a Python exception.

Version-Release number of selected component (if applicable):


How reproducible:
always

Steps to Reproduce:
1. make sure that xonsh isn&apos;t installed
2. dnf install --setopt=alwaysprompt=no xonsh
3.

Actual results:
Last metadata expiration check: 2:52:44 ago on Thu Dec  1 20:28:10 2016.
Dependencies resolved.
================================================================================
 Package                     Arch        Version              Repository   Size
================================================================================
Installing:
 python3-ply                 noarch      3.8-2.fc25           fedora      108 k
 python3-prompt_toolkit      noarch      1.0.0-2.fc25         fedora      402 k
 python3-setproctitle        x86_64      1.1.9-4.fc25         fedora       20 k
 python3-wcwidth             noarch      0.1.6-4.fc25         fedora       30 k
 xonsh                       noarch      0.4.6-1.fc25         fedora      994 k

Transaction Summary
================================================================================
Install  5 Packages

Total download size: 1.5 M
Installed size: 11 M
Traceback (most recent call last):
  File &quot;/usr/bin/dnf&quot;, line 58, in &lt;module&gt;
    main.user_main(sys.argv[1:], exit_code=True)
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 174, in user_main
    errcode = main(args)
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 60, in main
    return _main(base, args)
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 120, in _main
    ret = resolving(cli, base)
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 149, in resolving
    base.do_transaction(display=displays)
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/cli.py&quot;, line 199, in do_transaction
    if self._promptWanted():
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/cli.py&quot;, line 552, in _promptWanted
    for txmbr in self.tsInfo.getMembers():
  File &quot;/usr/lib/python3.5/site-packages/dnf/util.py&quot;, line 79, in __getattr__
    % (C.__name__, name))
AttributeError: &apos;Base&apos; object has no attribute &apos;tsInfo&apos;

Expected results:
Just the installation of xonsh with its dependencies and without any prompting. 

In case something &apos;bad&apos; happens that normally would require a prompt - e.g. a non-imported gpg key, a failed package verification - the command shouldn&apos;t continue with the install and abort.

Additional info:
It seems that the dnf manual doesn&apos;t document the `alwaysprompt` option, yet. At least I couldn&apos;t find it in http://dnf.readthedocs.io/en/latest/conf_ref.html</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10458130</commentid>
    <comment_count>1</comment_count>
    <who name="Jaroslav Rohel">jrohel</who>
    <bug_when>2017-05-30 07:29:17 -0400</bug_when>
    <thetext>status DNF:
- &apos;alwaysprompt=no&apos; option is not implemented (there is only a piece of unusable crashing code)

status of YUM:
Implemented and documented. But the option and documentation is confusing. 

Documentation:
Either &apos;1&apos; or &apos;0&apos;. When set to &apos;0&apos;, yum will not prompt for confirmation when the list of packages to be installed exactly matches those given on the command line. Unless &apos;assumeyes&apos; is enabled, it will prompt when additional packages need to be installed to fulfill dependencies regardless of this setting. Note that older versions of yum would also always prompt for package removal, and that is no longer true. Default is &apos;1&apos;.

Result:

1. You expect this results:
Just the installation of xonsh with its dependencies and without any prompting. 

But according to the yum documentation it must prompt (and it prompts in my test). Because the dependcy packages was not given on command line. So &apos;allwayspromt=no&apos; is useless for that case.

2. How about removal of packages. Documentation says it depends on yum version. And what about upgraded and downgraded packages given on command line? And theirs dependencies? What about obsoleted packages during upgrade?

There are many possibilities. And as I wrote at point 1. the option &apos;alwaysprompt=no&apos; is useless for your case.

So we decided to fix this bug by removing the option &apos;alwaysprompt&apos; completely.

PR: https://github.com/rpm-software-management/dnf/pull/830</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10498393</commentid>
    <comment_count>2</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-12 11:30:34 -0400</bug_when>
    <thetext>dnf-plugins-core-2.1.1-1.fc26 libdnf-0.9.1-1.fc26 dnf-2.5.1-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-c87c47dccb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10503190</commentid>
    <comment_count>3</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-13 21:36:05 -0400</bug_when>
    <thetext>dnf-2.5.1-1.fc26, dnf-plugins-core-2.1.1-1.fc26, libdnf-0.9.1-1.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-c87c47dccb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10503670</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-14 01:34:30 -0400</bug_when>
    <thetext>dnf-2.5.1-1.fc26 dnf-plugins-core-2.1.1-1.fc26 dnfdaemon-0.3.18-3.fc26 libdnf-0.9.1-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-c87c47dccb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10509747</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-15 09:56:13 -0400</bug_when>
    <thetext>dnf-2.5.1-1.fc26, dnf-plugins-core-2.1.1-1.fc26, dnfdaemon-0.3.18-3.fc26, libdnf-0.9.1-1.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-c87c47dccb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10513083</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-16 09:19:01 -0400</bug_when>
    <thetext>dnf-2.5.1-1.fc26, dnf-plugins-core-2.1.1-1.fc26, dnfdaemon-0.3.18-3.fc26, libdnf-0.9.1-1.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>