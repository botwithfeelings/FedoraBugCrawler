<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1342491</bug_id>
          
          <creation_ts>2016-06-03 07:40:00 -0400</creation_ts>
          <short_desc>dnf-plugin-spacewalk: dnf-plugin-spacewalk requires both Python 2 and Python 3</short_desc>
          <delta_ts>2017-02-15 15:51:17 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>dnf-plugin-spacewalk</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1285816</blocked>
    
    
    <blocked>1340802</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Tomas Orsava">torsava</reporter>
          <assigned_to name="Michael Mráka">mmraka</assigned_to>
          <cc>dkrejci</cc>
    
    
    <cc>lau18</cc>
    
    
    <cc>mmraka</cc>
    
    
    <cc>msuchy</cc>
    
    
    <cc>pgozart</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>dnf-plugin-spacewalk-2.6.1-1 dnf-plugin-spacewalk-2.6.3-1.fc25 dnf-plugin-spacewalk-2.6.3-1.fc24</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-02-14 16:24:36</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9384513</commentid>
    <comment_count>0</comment_count>
    <who name="Tomas Orsava">torsava</who>
    <bug_when>2016-06-03 07:40:55 -0400</bug_when>
    <thetext>The dnf-plugin-spacewalk RPM requires both Python 2 and Python 3.

Except in very special circumstances, there is no need for one package
to drag in both Python stacks. Usually, this is a packaging error: for
example, a stray &quot;/usr/bin/python&quot; shebang in a Python 3 package can
introduce a Python 2 dependency.

Please split your package, or remove the stray dependencies.
There is a section on shebangs in the Python RPM Porting Guide [0]
which covers this issue.

It&apos;s ok to do this in Rawhide only, however, it would be greatly
appreciated if you could push it to Fedora 24 as well.


If anything is unclear, or if you need any kind of assistance, you can
ask on IRC (#fedora-python on Freenode), or reply here. We&apos;ll be happy
to help investigating or fixing this issue!


[0] http://python-rpm-porting.readthedocs.io/en/latest/application-modules.html#are-shebangs-dragging-you-down-to-python-2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9398107</commentid>
    <comment_count>1</comment_count>
    <who name="Miroslav Suchý">msuchy</who>
    <bug_when>2016-06-08 09:32:10 -0400</bug_when>
    <thetext>Note that rhnlib with python3 support just landed in rawhide.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9549608</commentid>
    <comment_count>2</comment_count>
    <who name="Jan Kurik">jkurik</who>
    <bug_when>2016-07-26 00:47:35 -0400</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 25 development cycle.
Changing version to &apos;25&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9679757</commentid>
    <comment_count>3</comment_count>
    <who name="Dominika Krejčí">dkrejci</who>
    <bug_when>2016-09-05 09:59:52 -0400</bug_when>
    <thetext>Hi Michael,
how is it going? Do you need some help?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9737563</commentid>
    <comment_count>4</comment_count>
    <who name="Michael Mráka">mmraka</who>
    <bug_when>2016-09-23 08:17:13 -0400</bug_when>
    <thetext>Fixed in
commit df2755ff5d0540103814a4f10e8ce648165b922a
    fixed rpmlint warnings
commit 3f4022b51ae602dacc5be09be4624ffc4277c233
    1342491 - remove dependency on python2 on F23+</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10107462</commentid>
    <comment_count>5</comment_count>
    <who name="">lau18</who>
    <bug_when>2017-01-30 19:52:05 -0500</bug_when>
    <thetext>Hi Michael,

Does dnf-plugin-spacewalk-2.6.1-1 support Fedora 25?  I am getting below stack trace when executing dnf with dnf-plugin-spacewalk-2.4.15-4 on a fedora 25 system (Linux daemon2 4.8.6-300.fc25.x86_64 #1 SMP Tue Nov 1 12:36:38 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux):

Traceback (most recent call last):
  File &quot;/usr/bin/dnf&quot;, line 58, in &lt;module&gt;
    main.user_main(sys.argv[1:], exit_code=True)
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 174, in user_main
    errcode = main(args)
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 60, in main
    return _main(base, args)
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 93, in _main
    cli.configure(list(map(ucd, args)))
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/cli.py&quot;, line 1048, in configure
    self.base._plugins.run_config()
  File &quot;/usr/lib/python3.5/site-packages/dnf/plugin.py&quot;, line 82, in fn
    dnf.util.mapall(operator.methodcaller(method), self.plugins)
  File &quot;/usr/lib/python3.5/site-packages/dnf/util.py&quot;, line 183, in mapall
    return list(map(fn, *seq))
  File &quot;/usr/lib/python3.5/site-packages/dnf-plugins/spacewalk.py&quot;, line 82, in config
    self.activate_channels(self.cli.demands.sack_activation)
  File &quot;/usr/lib/python3.5/site-packages/dnf-plugins/spacewalk.py&quot;, line 137, in activate_channels
    for (channel_id, channel_dict) in enabled_channels.iteritems():</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10108260</commentid>
    <comment_count>6</comment_count>
    <who name="Michael Mráka">mmraka</who>
    <bug_when>2017-01-31 05:12:36 -0500</bug_when>
    <thetext>What command do you exactly run? What&apos;s the error message (the very last lines from traceback which are missing from you previous comment)?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10110082</commentid>
    <comment_count>7</comment_count>
    <who name="">lau18</who>
    <bug_when>2017-01-31 12:45:56 -0500</bug_when>
    <thetext>(In reply to Michael Mráka from comment #6)
&gt; What command do you exactly run? What&apos;s the error message (the very last
&gt; lines from traceback which are missing from you previous comment)?

After installing the dnf-plugin-spacewalk and others, any subsequent dnf commands failed.  The last successful dnf execution was this in the kickstart file during a build:
  # dnf -y install dnf-plugin-spacewalk rhnlib rhn-check rhn-setup rhn-client-tools python3-rhnlib

Then the subsequent dnf resulted the stack trace that followed:
  # dnf -y install yum-plugin-changelog yum-plugin-versionlock


This system is receiving updates from Spacewalk server.
Traceback (most recent call last):
  File &quot;/usr/bin/dnf&quot;, line 58, in &lt;module&gt;
    main.user_main(sys.argv[1:], exit_code=True)
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 174, in user_main
    errcode = main(args)
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 60, in main
    return _main(base, args)
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 93, in _main
    cli.configure(list(map(ucd, args)))
  File &quot;/usr/lib/python3.5/site-packages/dnf/cli/cli.py&quot;, line 1048, in configure
    self.base._plugins.run_config()
  File &quot;/usr/lib/python3.5/site-packages/dnf/plugin.py&quot;, line 82, in fn
    dnf.util.mapall(operator.methodcaller(method), self.plugins)
  File &quot;/usr/lib/python3.5/site-packages/dnf/util.py&quot;, line 183, in mapall
    return list(map(fn, *seq))
  File &quot;/usr/lib/python3.5/site-packages/dnf-plugins/spacewalk.py&quot;, line 82, in config
    self.activate_channels(self.cli.demands.sack_activation)
  File &quot;/usr/lib/python3.5/site-packages/dnf-plugins/spacewalk.py&quot;, line 137, in activate_channels
    for (channel_id, channel_dict) in enabled_channels.iteritems():
AttributeError: &apos;dict&apos; object has no attribute &apos;iteritems&apos;

yum plugin changelog installed


Here we have the last dnf installation information and the plugin config file used to communicate with RedHat Satellite 5.6:

root@daemon2 tmp]# rpm -qa |grep dnf-plugin
python3-dnf-plugins-core-0.1.21-4.fc25.noarch
dnf-plugins-core-0.1.21-4.fc25.noarch
dnf-plugin-spacewalk-2.4.15-4.fc25.noarch
[root@daemon2 tmp]# rpm -qa |grep rhn-
rhn-client-tools-2.5.16-1.fc25.noarch
rhn-setup-2.5.16-1.fc25.noarch
rhn-check-2.5.16-1.fc25.noarch
[root@daemon2 tmp]# rpm -qa |grep python3-rhnlib
python3-rhnlib-2.5.87-2.fc25.noarch

[root@daemon2 tmp]# cat /etc/dnf/plugins/spacewalk.conf
[main]
enabled = 1
gpgcheck = 1
timeout = 120

# You can specify options per channel, e.g.:
#
#[rhel-i386-server-5]
#enabled = 1
#
#[some-unsigned-custom-channel]
#gpgcheck = 0
[root@daemon2 tmp]#

Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10110086</commentid>
    <comment_count>8</comment_count>
    <who name="">lau18</who>
    <bug_when>2017-01-31 12:49:01 -0500</bug_when>
    <thetext>(In reply to lau18 from comment #7)
&gt; (In reply to Michael Mráka from comment #6)
&gt; &gt; What command do you exactly run? What&apos;s the error message (the very last
&gt; &gt; lines from traceback which are missing from you previous comment)?
&gt; 
&gt; After installing the dnf-plugin-spacewalk and others, any subsequent dnf
&gt; commands failed.  The last successful dnf execution was this in the
&gt; kickstart file during a build:
&gt;   # dnf -y install dnf-plugin-spacewalk rhnlib rhn-check rhn-setup
&gt; rhn-client-tools python3-rhnlib
&gt; 
&gt; Then the subsequent dnf resulted the stack trace that followed:
&gt;   # dnf -y install yum-plugin-changelog yum-plugin-versionlock
&gt; 
&gt; 
&gt; This system is receiving updates from Spacewalk server.
&gt; Traceback (most recent call last):
&gt;   File &quot;/usr/bin/dnf&quot;, line 58, in &lt;module&gt;
&gt;     main.user_main(sys.argv[1:], exit_code=True)
&gt;   File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 174, in
&gt; user_main
&gt;     errcode = main(args)
&gt;   File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 60, in main
&gt;     return _main(base, args)
&gt;   File &quot;/usr/lib/python3.5/site-packages/dnf/cli/main.py&quot;, line 93, in _main
&gt;     cli.configure(list(map(ucd, args)))
&gt;   File &quot;/usr/lib/python3.5/site-packages/dnf/cli/cli.py&quot;, line 1048, in
&gt; configure
&gt;     self.base._plugins.run_config()
&gt;   File &quot;/usr/lib/python3.5/site-packages/dnf/plugin.py&quot;, line 82, in fn
&gt;     dnf.util.mapall(operator.methodcaller(method), self.plugins)
&gt;   File &quot;/usr/lib/python3.5/site-packages/dnf/util.py&quot;, line 183, in mapall
&gt;     return list(map(fn, *seq))
&gt;   File &quot;/usr/lib/python3.5/site-packages/dnf-plugins/spacewalk.py&quot;, line 82,
&gt; in config
&gt;     self.activate_channels(self.cli.demands.sack_activation)
&gt;   File &quot;/usr/lib/python3.5/site-packages/dnf-plugins/spacewalk.py&quot;, line
&gt; 137, in activate_channels
&gt;     for (channel_id, channel_dict) in enabled_channels.iteritems():
&gt; AttributeError: &apos;dict&apos; object has no attribute &apos;iteritems&apos;
&gt; 
&gt; yum plugin changelog installed
&gt; 
&gt; 
&gt; Here we have the last dnf installation information and the plugin config
&gt; file used to communicate with RedHat Satellite 5.6:
&gt; 
&gt; root@daemon2 tmp]# rpm -qa |grep dnf-plugin
&gt; python3-dnf-plugins-core-0.1.21-4.fc25.noarch
&gt; dnf-plugins-core-0.1.21-4.fc25.noarch
&gt; dnf-plugin-spacewalk-2.4.15-4.fc25.noarch
&gt; [root@daemon2 tmp]# rpm -qa |grep rhn-
&gt; rhn-client-tools-2.5.16-1.fc25.noarch
&gt; rhn-setup-2.5.16-1.fc25.noarch
&gt; rhn-check-2.5.16-1.fc25.noarch
&gt; [root@daemon2 tmp]# rpm -qa |grep python3-rhnlib
&gt; python3-rhnlib-2.5.87-2.fc25.noarch
&gt; 
&gt; [root@daemon2 tmp]# cat /etc/dnf/plugins/spacewalk.conf
&gt; [main]
&gt; enabled = 1
&gt; gpgcheck = 1
&gt; timeout = 120
&gt; 
&gt; # You can specify options per channel, e.g.:
&gt; #
&gt; #[rhel-i386-server-5]
&gt; #enabled = 1
&gt; #
&gt; #[some-unsigned-custom-channel]
&gt; #gpgcheck = 0
&gt; [root@daemon2 tmp]#
&gt; 
&gt; Thanks.

Please disregard the output as it&apos;s just a debug string using echo command:
   yum plugin changelog installed</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10122956</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-02-06 04:26:50 -0500</bug_when>
    <thetext>dnf-plugin-spacewalk-2.6.3-1.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-cfc209b1df</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10122957</commentid>
    <comment_count>11</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-02-06 04:26:57 -0500</bug_when>
    <thetext>dnf-plugin-spacewalk-2.6.3-1.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-14fa17d107</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10124870</commentid>
    <comment_count>12</comment_count>
    <who name="">lau18</who>
    <bug_when>2017-02-06 13:36:52 -0500</bug_when>
    <thetext>Hello Michael,

Does dnf-plugin-spacewalk-2.6.3-1.fc25 include the fix for errors in Comment 7?

  File &quot;/usr/lib/python3.5/site-packages/dnf-plugins/spacewalk.py&quot;, line 137, in activate_channels
    for (channel_id, channel_dict) in enabled_channels.iteritems():
AttributeError: &apos;dict&apos; object has no attribute &apos;iteritems

Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10125870</commentid>
    <comment_count>13</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-02-06 21:49:16 -0500</bug_when>
    <thetext>dnf-plugin-spacewalk-2.6.3-1.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-14fa17d107</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10126448</commentid>
    <comment_count>14</comment_count>
    <who name="Michael Mráka">mmraka</who>
    <bug_when>2017-02-07 03:39:46 -0500</bug_when>
    <thetext>&gt; Hello Michael,
&gt; 
&gt; Does dnf-plugin-spacewalk-2.6.3-1.fc25 include the fix for errors in Comment 7?
&gt; 
&gt;   File &quot;/usr/lib/python3.5/site-packages/dnf-plugins/spacewalk.py&quot;, line
&gt; 137, in activate_channels
&gt;     for (channel_id, channel_dict) in enabled_channels.iteritems():
&gt; AttributeError: &apos;dict&apos; object has no attribute &apos;iteritems
&gt; 
&gt; Thanks.

Yes, it does. For Fedora 25 update has been already pushed to updates-testing.
You can update by

 dnf update dnf-plugin-spacewalk --enablerepo=updates-testing --disableplugin=spacewalk</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10126920</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-02-07 05:50:11 -0500</bug_when>
    <thetext>dnf-plugin-spacewalk-2.6.3-1.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-cfc209b1df</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10129100</commentid>
    <comment_count>16</comment_count>
    <who name="">lau18</who>
    <bug_when>2017-02-07 16:31:26 -0500</bug_when>
    <thetext>(In reply to Michael Mráka from comment #14)
&gt; &gt; Hello Michael,
&gt; &gt; 
&gt; &gt; Does dnf-plugin-spacewalk-2.6.3-1.fc25 include the fix for errors in Comment 7?
&gt; &gt; 
&gt; &gt;   File &quot;/usr/lib/python3.5/site-packages/dnf-plugins/spacewalk.py&quot;, line
&gt; &gt; 137, in activate_channels
&gt; &gt;     for (channel_id, channel_dict) in enabled_channels.iteritems():
&gt; &gt; AttributeError: &apos;dict&apos; object has no attribute &apos;iteritems
&gt; &gt; 
&gt; &gt; Thanks.
&gt; 
&gt; Yes, it does. For Fedora 25 update has been already pushed to
&gt; updates-testing.
&gt; You can update by
&gt; 
&gt;  dnf update dnf-plugin-spacewalk --enablerepo=updates-testing
&gt; --disableplugin=spacewalk

Thanks! The AttributeError has been fixed.  When will the fix be propagated into the fc25 Update?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10130066</commentid>
    <comment_count>17</comment_count>
    <who name="Michael Mráka">mmraka</who>
    <bug_when>2017-02-08 03:16:46 -0500</bug_when>
    <thetext>&gt; When will the fix be propagated into the fc25 Update?

See https://fedoraproject.org/wiki/Updates_Policy#All_other_updates for detailed description. Basically when 3 people will mark it as worksforme (+3 karma) or after a week.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10147981</commentid>
    <comment_count>18</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-02-14 16:24:36 -0500</bug_when>
    <thetext>dnf-plugin-spacewalk-2.6.3-1.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10151438</commentid>
    <comment_count>19</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-02-15 15:51:17 -0500</bug_when>
    <thetext>dnf-plugin-spacewalk-2.6.3-1.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>