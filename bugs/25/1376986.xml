<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1376986</bug_id>
          
          <creation_ts>2016-09-17 04:23:00 -0400</creation_ts>
          <short_desc>Depend on nss_nis if NIS support is needed.</short_desc>
          <delta_ts>2016-11-23 10:45:51 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>ypbind</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          <see_also>https://bugzilla.redhat.com/show_bug.cgi?id=1358429</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dr. Tilmann Bubeck">tilmann</reporter>
          <assigned_to name="Petr Kubat">pkubat</assigned_to>
          <cc>arjun.is</cc>
    
    
    <cc>codonell</cc>
    
    
    <cc>dj</cc>
    
    
    <cc>francesco.simula</cc>
    
    
    <cc>fweimer</cc>
    
    
    <cc>hhorak</cc>
    
    
    <cc>jakub</cc>
    
    
    <cc>jussi.eloranta</cc>
    
    
    <cc>law</cc>
    
    
    <cc>mfabian</cc>
    
    
    <cc>mmuzila</cc>
    
    
    <cc>pfrankli</cc>
    
    
    <cc>pkubat</cc>
    
    
    <cc>rc040203</cc>
    
    
    <cc>r.kruglicky</cc>
    
    
    <cc>sid</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>ypbind-1.38-6.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-11-19 16:14:18</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9716050</commentid>
    <comment_count>0</comment_count>
    <who name="Dr. Tilmann Bubeck">tilmann</who>
    <bug_when>2016-09-17 04:23:02 -0400</bug_when>
    <thetext>Description of problem:
NIS is not working, as nss_nis is not installed. Before fc25 /lib64/libnss_nis.so.2 was part of glibc and is now in a seperate RPM called &quot;nss_nis&quot;. This is not installed by default or as a dependency of ypbind (or some other package) or by using &quot;setup&quot;. This results in a proper NIS configuration without the NIS users being available.

e.g. ypwhich shows the bound NIS server correctly and also &quot;ypcat passwd&quot; works, but &quot;id some-username-from-NIS&quot; shows &quot;no such user&quot;.

Version-Release number of selected component (if applicable):
2.24-3.fc25

How reproducible:
always

Steps to Reproduce:
1. dnf install ypbind
2. setup (and configure NIS)
3. id some-username-from-NIS

Actual results:
&quot;no such user&quot;

Expected results:
the correct output of &quot;id&quot;

Additional info:
This fixed the problem &quot;dnf install nss_nis&quot;. I would propose to add nss_nis as a dependency of ypbind.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9716074</commentid>
    <comment_count>1</comment_count>
    <who name="Florian Weimer">fweimer</who>
    <bug_when>2016-09-17 04:55:41 -0400</bug_when>
    <thetext>This is basically a documentation issue, see bug 1358430.

A straight dependency for ypbind is difficult because you would still have to install nss_nis.i686 manually if on a mixed 32/64 bit system.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9728394</commentid>
    <comment_count>2</comment_count>
    <who name="Carlos O&apos;Donell">codonell</who>
    <bug_when>2016-09-20 23:59:04 -0400</bug_when>
    <thetext>(In reply to Florian Weimer from comment #1)
&gt; This is basically a documentation issue, see bug 1358430.
&gt; 
&gt; A straight dependency for ypbind is difficult because you would still have
&gt; to install nss_nis.i686 manually if on a mixed 32/64 bit system.

It would fix the non-mixed cases though, and those are becoming much more common.

I agree that there is an issue of documentation though.

I&apos;m retitling and passing to ypbind for consideration to see what they would like to do.

In summary:

- Bug 1358429 documents that &apos;nss_nis&apos; package needs installing now.

- This bug, bug 1376986, is open to discuss ways this might be made more automatic e.g. ypbind depends on nss_nis.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9733081</commentid>
    <comment_count>3</comment_count>
    <who name="Petr Kubat">pkubat</who>
    <bug_when>2016-09-22 04:10:56 -0400</bug_when>
    <thetext>I feel like ypbind should not depend on nss_nis as (if I am not mistaken) it does not need NSS to work. It definitely should be documented somewhere that you need to install nss_nis if you want to use NSS though.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9754975</commentid>
    <comment_count>4</comment_count>
    <who name="Carlos O&apos;Donell">codonell</who>
    <bug_when>2016-09-29 14:39:14 -0400</bug_when>
    <thetext>(In reply to Petr Kubat from comment #3)
&gt; I feel like ypbind should not depend on nss_nis as (if I am not mistaken) it
&gt; does not need NSS to work. It definitely should be documented somewhere that
&gt; you need to install nss_nis if you want to use NSS though.

Despite the fact that you could conceivably operate without nss_nis, the point is that it would do all NIS users a benefit if ypbind depended on nss_nis to make all the other APIs NIS-enabled.

Again, requiring nss_nis would simply make user configuration easier. They wouldn&apos;t have to go read the documentation to find what they need, it would just work.

We want to go from having glibc _always_ install nss_nis (the old glibc packaging with everything in place) to having ypbind install nss_nis. This streamlines cloud and container installs, and yet keeps things similar to how it used to be for NIS users.

Does that make sense?

Is there a strong technical argument for not having ypbind require nss_nis?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9760151</commentid>
    <comment_count>5</comment_count>
    <who name="Petr Kubat">pkubat</who>
    <bug_when>2016-10-03 02:02:29 -0400</bug_when>
    <thetext>(In reply to Carlos O&apos;Donell from comment #4)
&gt; We want to go from having glibc _always_ install nss_nis (the old glibc
&gt; packaging with everything in place) to having ypbind install nss_nis. This
&gt; streamlines cloud and container installs, and yet keeps things similar to
&gt; how it used to be for NIS users.

Right, having the users not go through more documentation to fix things might be a better approach. There would be some issues with mixed systems (as Florian already pointed out) so the documentation would still need to be updated.

&gt; Is there a strong technical argument for not having ypbind require nss_nis?

I don&apos;t see any reason not to add the requirement from the technical side of things.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9862668</commentid>
    <comment_count>6</comment_count>
    <who name="Jussi Eloranta">jussi.eloranta</who>
    <bug_when>2016-11-04 12:51:10 -0400</bug_when>
    <thetext>This really needs to be fixed! I just wasted couple of hours on trying to figure why NIS authentication does not work. Finally running finger &lt;user&gt; gave a clue about the missing libraries. Whatever the technical details might be, installing ypbind must result in installation of nss_nis.

And note that this was not needed before F25. So I have already started to expect that everything will more or less break with every major upgrade.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9863694</commentid>
    <comment_count>7</comment_count>
    <who name="Jussi Eloranta">jussi.eloranta</who>
    <bug_when>2016-11-04 22:53:24 -0400</bug_when>
    <thetext>That should have read strace finger &lt;user&gt;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9872086</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-08 09:34:34 -0500</bug_when>
    <thetext>ypbind-1.38-6.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2016-c99e46d2c2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9874255</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-08 21:27:18 -0500</bug_when>
    <thetext>ypbind-1.38-6.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-c99e46d2c2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9900866</commentid>
    <comment_count>10</comment_count>
    <who name="Jussi Eloranta">jussi.eloranta</who>
    <bug_when>2016-11-17 12:57:12 -0500</bug_when>
    <thetext>What I am seeing now is that systemctl fails to start ypbind completely! For example, it tries to start it during boot - waits for a long time and then gives up. Then I login as root and do systemctl start ypbind  and that hangs for some time and then ypbind does not start. However, during the time systemctl hangs ypbind is actually running correctly and things like ypcat passwd work fine. As soon as systemctl command ends, ypbind disappears. Also, if I start ypbind by hand (# ypbind &amp;), it works just fine. This is with up to date F25 (with ypbind-1.38-6.fc25.x86_64). This could be something else but it just started recently.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9900872</commentid>
    <comment_count>11</comment_count>
    <who name="Jussi Eloranta">jussi.eloranta</who>
    <bug_when>2016-11-17 12:58:17 -0500</bug_when>
    <thetext>sorry, replace the first systemctl with systemd</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9905872</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-11-19 16:14:18 -0500</bug_when>
    <thetext>ypbind-1.38-6.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9906465</commentid>
    <comment_count>13</comment_count>
    <who name="Ralf Corsepius">rc040203</who>
    <bug_when>2016-11-20 11:07:24 -0500</bug_when>
    <thetext>(In reply to Jussi Eloranta from comment #10)
&gt; What I am seeing now is that systemctl fails to start ypbind completely!

I am now seeing this with ypbind-1.38-6.fc25 as well. Downgrading to ypbind-1.38-5.fc24.x86_64 immediately remedied it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9916756</commentid>
    <comment_count>14</comment_count>
    <who name="Francesco Simula">francesco.simula</who>
    <bug_when>2016-11-23 10:11:07 -0500</bug_when>
    <thetext>(In reply to Ralf Corsepius from comment #13)
&gt; (In reply to Jussi Eloranta from comment #10)
&gt; &gt; What I am seeing now is that systemctl fails to start ypbind completely!
&gt; 
&gt; I am now seeing this with ypbind-1.38-6.fc25 as well. Downgrading to
&gt; ypbind-1.38-5.fc24.x86_64 immediately remedied it.

Same thing here: a freshly installed box with Fedora 25 upgraded from Fedora 24 (where ypbind was working) stopped authenticating the users, with the very same symptoms described in comment #10.

I confirm that the downgrade to ypbind-1.38-5.fc24.x86_64 from ypbind-1.38-6.fc25 restored NIS functions.

Maybe this need be pushed to a different bug?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9916878</commentid>
    <comment_count>15</comment_count>
    <who name="Ralf Corsepius">rc040203</who>
    <bug_when>2016-11-23 10:45:51 -0500</bug_when>
    <thetext>(In reply to Francesco Simula from comment #14)
&gt; Maybe this need be pushed to a different bug?
See: https://bugzilla.redhat.com/show_bug.cgi?id=1396893</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>