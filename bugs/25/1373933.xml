<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1373933</bug_id>
          
          <creation_ts>2016-09-07 09:05:00 -0400</creation_ts>
          <short_desc>object selection and edit freezes libreoffice for several seconds</short_desc>
          <delta_ts>2016-12-29 18:00:20 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>libreoffice</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          <see_also>https://bugzilla.redhat.com/show_bug.cgi?id=1373809</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard>AcceptedBlocker</status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1277927</blocked>
    
    
    <blocked>1277289</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Kamil Páral">kparal</reporter>
          <assigned_to name="Caolan McNamara">caolanm</assigned_to>
          <cc>awilliam</cc>
    
    
    <cc>caolanm</cc>
    
    
    <cc>dtardon</cc>
    
    
    <cc>erack</cc>
    
    
    <cc>finomeno</cc>
    
    
    <cc>gmarr</cc>
    
    
    <cc>jeischma</cc>
    
    
    <cc>mclasen</cc>
    
    
    <cc>mstahl</cc>
    
    
    <cc>pavel.raur.pr</cc>
    
    
    <cc>rhbz2</cc>
    
    
    <cc>robatino</cc>
    
    
    <cc>sbergman</cc>
    
    
    <cc>trevor</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>libreoffice-5.2.2.1-2.fc25 libreoffice-5.2.2.1-5.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-09-26 20:33:20</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          <external_bugs name="Debian BTS">837356</external_bugs>
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9686657</commentid>
    <comment_count>0</comment_count>
    <who name="Kamil Páral">kparal</who>
    <bug_when>2016-09-07 09:05:29 -0400</bug_when>
    <thetext>Description of problem:
This problem seems to affect all libreoffice apps, but is mostly visible in Impress and Draw. Any time you select an object (a shape, a block of text, etc), the app freezes for several seconds, using 100% CPU. If you want to edit the object (a block of text), again the app freezes for a few seconds, and then the selection is changed to an edit cursor and you can finally type text.

With this slow speed, Impress and Draw are completely unusable for any serious work (try it).

Tested on several computers, both bare metal and VMs. (Please note that in VMs libreoffice frequently crashes with bug 1373372, which is unrelated.)

Version-Release number of selected component (if applicable):
clutter-1.26.0-1.fc25.x86_64
clutter-gst2-2.0.18-1.fc25.x86_64
clutter-gst3-3.0.18-1.fc25.x86_64
clutter-gtk-1.8.0-2.fc25.x86_64
cogl-1.22.2-1.fc25.x86_64
gtk3-3.21.4-2.fc25.x86_64
libreoffice-calc-5.2.1.2-1.fc25.x86_64
libreoffice-core-5.2.1.2-1.fc25.x86_64
libreoffice-data-5.2.1.2-1.fc25.noarch
libreoffice-draw-5.2.1.2-1.fc25.x86_64
libreoffice-emailmerge-5.2.1.2-1.fc25.x86_64
libreoffice-filters-5.2.1.2-1.fc25.x86_64
libreoffice-graphicfilter-5.2.1.2-1.fc25.x86_64
libreoffice-gtk2-5.2.1.2-1.fc25.x86_64
libreoffice-gtk3-5.2.1.2-1.fc25.x86_64
libreoffice-impress-5.2.1.2-1.fc25.x86_64
libreoffice-langpack-cs-5.2.1.2-1.fc25.x86_64
libreoffice-langpack-en-5.2.1.2-1.fc25.x86_64
libreoffice-math-5.2.1.2-1.fc25.x86_64
libreoffice-ogltrans-5.2.1.2-1.fc25.x86_64
libreoffice-opensymbol-fonts-5.2.1.2-1.fc25.noarch
libreoffice-pdfimport-5.2.1.2-1.fc25.x86_64
libreoffice-pyuno-5.2.1.2-1.fc25.x86_64
libreoffice-ure-5.2.1.2-1.fc25.x86_64
libreoffice-writer-5.2.1.2-1.fc25.x86_64
libreoffice-x11-5.2.1.2-1.fc25.x86_64
libreoffice-xsltfilter-5.2.1.2-1.fc25.x86_64
mesa-dri-drivers-12.0.2-1.fc25.x86_64
mutter-3.21.90-3.fc25.x86_64

How reproducible:
always

Steps to Reproduce:
1. run Impress (or Draw)
2. click on text areas to enter text (title, body)
3. draw a shape (a circle, a star)
4. switch selection between different objects (text areas, shapes)

Actual results:
object selection is extremely slow

Expected results:
should be fast

Additional info:
This doesn&apos;t seem to be wayland related. It&apos;s slow as well on X11.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9686667</commentid>
    <comment_count>1</comment_count>
    <who name="Kamil Páral">kparal</who>
    <bug_when>2016-09-07 09:07:29 -0400</bug_when>
    <thetext>Proposing as a blocker:
&quot;All applications that can be launched using the standard graphical mechanism of a release-blocking desktop after a default installation of that desktop must start successfully and withstand a basic functionality test. &quot;
https://fedoraproject.org/wiki/Fedora_25_Final_Release_Criteria#Default_application_functionality

Currently it&apos;s not really possible to work normally in Impress or Draw. It&apos;s unbearably slow.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9700200</commentid>
    <comment_count>2</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2016-09-12 14:04:55 -0400</bug_when>
    <thetext>confirming, I see this on my regular F25 desktop (with X11). sometimes I can&apos;t even get the selection to trigger at all, but it clearly renders Impress effectively unusable.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9700959</commentid>
    <comment_count>3</comment_count>
    <who name="Geoffrey Marr">gmarr</who>
    <bug_when>2016-09-12 22:18:19 -0400</bug_when>
    <thetext>Discussed during the 2016-09-12 blocker review meeting: [1]

The decision to classify this as an AcceptedBlocker was made as this constitutes a violation of &quot;All applications that can be launched using the standard graphical mechanism of a release-blocking desktop after a default installation of that desktop must start successfully and withstand a basic functionality test&quot;, as it&apos;s impossible to do basic work in Impress or Draw applications.

[1] https://meetbot.fedoraproject.org/fedora-blocker-review/2016-09-12/f25-blocker-review.2016-09-12-16.01.txt</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9711792</commentid>
    <comment_count>4</comment_count>
    <who name="Caolan McNamara">caolanm</who>
    <bug_when>2016-09-15 12:09:29 -0400</bug_when>
    <thetext>If you have both libreoffice-gtk2 and libreoffice-gtk3 installed, does it make a difference to use

export SAL_USE_VCLPLUGIN=gtk
before launching e.g. 
libreoffice --writer</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9713346</commentid>
    <comment_count>5</comment_count>
    <who name="Kamil Páral">kparal</who>
    <bug_when>2016-09-16 03:06:22 -0400</bug_when>
    <thetext>(In reply to Caolan McNamara from comment #4)
&gt; export SAL_USE_VCLPLUGIN=gtk
&gt; before launching e.g. 
&gt; libreoffice --writer

Yes, the problems are gone and object selection is now immediate.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9713546</commentid>
    <comment_count>6</comment_count>
    <who name="Caolan McNamara">caolanm</who>
    <bug_when>2016-09-16 04:02:50 -0400</bug_when>
    <thetext>If I selectively upgrade gtk3 on a F24 box I appear to see this too so looks like a change in gtk3 has triggered it.

I see an icon flying around on the clicks, so that would indicate drag and drop is active.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9713864</commentid>
    <comment_count>7</comment_count>
    <who name="Caolan McNamara">caolanm</who>
    <bug_when>2016-09-16 06:09:24 -0400</bug_when>
    <thetext>Things went wrong for us with gtk3 change of

commit 0f116135f4a5033ce4e9dfa19f10624701fa615c
Author: Matthias Clasen &lt;mclasen@redhat.com&gt;
Date:   Fri May 6 10:12:14 2016 -0400

    Avoid emitting ::style-set by name
    
    GtkStyle is deprecated, but we still emit ::style-set quite
    a bit, so lets at least not be slow while doing it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9714080</commentid>
    <comment_count>8</comment_count>
    <who name="Kamil Páral">kparal</who>
    <bug_when>2016-09-16 07:39:21 -0400</bug_when>
    <thetext>In the mean time, I found that if I use gtk3-3.21.1-1.fc25 on F24, everything works OK, but if I use gtk3-3.21.4-1.fc25, Impress becomes slow and lagging. Probably too late, though, you&apos;ve already found the exact commit.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9719371</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-09-18 15:58:39 -0400</bug_when>
    <thetext>libreoffice-5.2.2.1-2.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2016-6d6718e947</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9720337</commentid>
    <comment_count>10</comment_count>
    <who name="Caolan McNamara">caolanm</who>
    <bug_when>2016-09-19 04:46:22 -0400</bug_when>
    <thetext>Yeah, the issue can be reproduced on F24 by using the F25 gtk3. There&apos;s a load of these style-set signals. I changed over to style-updated and there is less of them, but still a surprising amount of those too so I&apos;ve a follow up commit to do less work on style-updated</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9721031</commentid>
    <comment_count>11</comment_count>
    <who name="Kamil Páral">kparal</who>
    <bug_when>2016-09-19 08:09:26 -0400</bug_when>
    <thetext>(In reply to Fedora Update System from comment #9)
&gt; libreoffice-5.2.2.1-2.fc25 has been submitted as an update to Fedora 25.
&gt; https://bodhi.fedoraproject.org/updates/FEDORA-2016-6d6718e947

This build fixes the slowness issue for me.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9721157</commentid>
    <comment_count>12</comment_count>
    <who name="Kamil Páral">kparal</who>
    <bug_when>2016-09-19 08:38:13 -0400</bug_when>
    <thetext>*** Bug 1373809 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9727643</commentid>
    <comment_count>13</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-09-20 16:00:01 -0400</bug_when>
    <thetext>libreoffice-5.2.2.1-2.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-6d6718e947</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9733379</commentid>
    <comment_count>14</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-09-22 05:56:08 -0400</bug_when>
    <thetext>libreoffice-5.2.2.1-4.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-d959f4b5ec</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9736341</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-09-23 01:24:50 -0400</bug_when>
    <thetext>libreoffice-5.2.2.1-5.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-aa4fa71f75</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9744387</commentid>
    <comment_count>16</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-09-26 20:33:20 -0400</bug_when>
    <thetext>libreoffice-5.2.2.1-5.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9788215</commentid>
    <comment_count>17</comment_count>
    <who name="Paulo">finomeno</who>
    <bug_when>2016-10-13 07:30:30 -0400</bug_when>
    <thetext>Not sure if this is the right place for this comment.

On 64 bit Arch Linux, updating Gnome to 3.22 (which is on Wayland by default) brought this LibreOffice bug back.
Plus the running app&apos;s icon does not show.
The current version is stated as 5.2.2.1, last updated on 2016-10-01 08:32 UTC.

Starting Gnome on X instead of Wayland doesn&apos;t help.
But the fix from comment #4 works and brings the icon back.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9788585</commentid>
    <comment_count>18</comment_count>
    <who name="Kamil Páral">kparal</who>
    <bug_when>2016-10-13 09:13:55 -0400</bug_when>
    <thetext>Paulo, I guess this got fixed just locally in Fedora package for the moment, judging by maintainers just bumping the release part of the package NVR. You&apos;ll probably need to wait until an upstream fix is available or ask for a local patch in Arch as well. You can see the git for the Fedora package here:
http://pkgs.fedoraproject.org/cgit/rpms/libreoffice.git/log/?h=f25</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9788750</commentid>
    <comment_count>19</comment_count>
    <who name="Paulo">finomeno</who>
    <bug_when>2016-10-13 09:55:31 -0400</bug_when>
    <thetext>Thanks Kamil,
I duplicated this bug in Arch and LibreOffice bug trackers.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>