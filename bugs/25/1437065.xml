<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1437065</bug_id>
          
          <creation_ts>2017-03-29 09:00:00 -0400</creation_ts>
          <short_desc>CUPS does not recognize changes to /etc/resolv.conf until CUPS restart</short_desc>
          <delta_ts>2017-04-12 15:50:20 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>cups</component>
          <version>25</version>
          <rep_platform>All</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Patch, Reopened</keywords>
          <priority>high</priority>
          <bug_severity>medium</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Zdenek Dohnal">zdohnal</reporter>
          <assigned_to name="Zdenek Dohnal">zdohnal</assigned_to>
          <cc>ashankar</cc>
    
    
    <cc>codonell</cc>
    
    
    <cc>fweimer</cc>
    
    
    <cc>jean-luc.richier</cc>
    
    
    <cc>jeischma</cc>
    
    
    <cc>jpopelka</cc>
    
    
    <cc>mdshaikh</cc>
    
    
    <cc>mnewsome</cc>
    
    
    <cc>pfrankli</cc>
    
    
    <cc>psklenar</cc>
    
    
    <cc>qe-baseos-daemons</cc>
    
    
    <cc>redhat-bugzilla</cc>
    
    
    <cc>thozza</cc>
    
    
    <cc>twaugh</cc>
    
    
    <cc>zdohnal</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>cups-2.2.0-6.fc25 cups-2.2.2-3.fc26 cups-2.2.0-8.fc25 cups-2.2.2-5.fc26 cups-2.1.4-6.fc24</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          <cf_clone_of>1325692</cf_clone_of>
          <cf_environment></cf_environment>
          <cf_last_closed>2017-04-08 22:54:32</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10290221</commentid>
    <comment_count>1</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-30 07:51:57 -0400</bug_when>
    <thetext>cups-2.1.4-4.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-af9f3f0102</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10290229</commentid>
    <comment_count>2</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-30 07:53:42 -0400</bug_when>
    <thetext>cups-2.2.0-6.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-aaa2f5c814</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10290276</commentid>
    <comment_count>3</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-30 08:01:44 -0400</bug_when>
    <thetext>cups-2.2.2-3.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-cb1c7c3146</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10292016</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-30 14:53:41 -0400</bug_when>
    <thetext>cups-2.2.2-3.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-cb1c7c3146</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10292864</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-30 23:19:53 -0400</bug_when>
    <thetext>cups-2.1.4-4.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-af9f3f0102</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10292891</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-30 23:22:08 -0400</bug_when>
    <thetext>cups-2.2.0-6.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-aaa2f5c814</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10297059</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-01 18:21:23 -0400</bug_when>
    <thetext>cups-2.2.0-6.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10297633</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-02 17:00:36 -0400</bug_when>
    <thetext>cups-2.2.2-3.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10298667</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-03 06:45:22 -0400</bug_when>
    <thetext>cups-2.1.4-4.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-af9f3f0102</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10300961</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-03 20:23:35 -0400</bug_when>
    <thetext>cups-2.1.4-4.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-af9f3f0102</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10301209</commentid>
    <comment_count>11</comment_count>
    <who name="Doug Hutcheson">owlbrudder</who>
    <bug_when>2017-04-03 23:45:18 -0400</bug_when>
    <thetext>(In reply to Fedora Update System from comment #7)
&gt; cups-2.2.0-6.fc25 has been pushed to the Fedora 25 stable repository. If
&gt; problems still persist, please make note of it in this bug report.

On my Fedora 25 x86_64 system, I have cups-2.2.0-6.fc25.x86_64 and can confirm the bug is still there. In fact, I only encountered this bug report because I was Googling the problem, which only came to my attention on this machine yesterday.

It is strange, because I had no problem previously and I have not run a system update since Saturday afternoon Australian time.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10301211</commentid>
    <comment_count>12</comment_count>
    <who name="Doug Hutcheson">owlbrudder</who>
    <bug_when>2017-04-03 23:47:14 -0400</bug_when>
    <thetext>(In reply to Doug Hutcheson from comment #11)
&gt; (In reply to Fedora Update System from comment #7)
&gt; &gt; cups-2.2.0-6.fc25 has been pushed to the Fedora 25 stable repository. If
&gt; &gt; problems still persist, please make note of it in this bug report.
&gt; 
&gt; On my Fedora 25 x86_64 system, I have cups-2.2.0-6.fc25.x86_64 and can
&gt; confirm the bug is still there. In fact, I only encountered this bug report
&gt; because I was Googling the problem, which only came to my attention on this
&gt; machine yesterday.
&gt; 
&gt; It is strange, because I had no problem previously and I have not run a
&gt; system update since Saturday afternoon Australian time.

Ignore me - I replied to the wrong bug report. Humble apologies.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10301754</commentid>
    <comment_count>13</comment_count>
    <who name="Jiri Eischmann">jeischma</who>
    <bug_when>2017-04-04 05:46:25 -0400</bug_when>
    <thetext>I can also confirm there is still a problem. CUPS fails to start at boot, but it&apos;s somehow started and running when I check it afterwards. Nevertheless cups-browsed fails to start at boot because cups as its dependency failed to start and it stays that way until you manually restart it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10302468</commentid>
    <comment_count>14</comment_count>
    <who name="Zdenek Dohnal">zdohnal</who>
    <bug_when>2017-04-04 09:16:02 -0400</bug_when>
    <thetext>Thanks Jirka and Doug, I will look into it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10302665</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-04 09:59:45 -0400</bug_when>
    <thetext>cups-2.1.4-5.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-19ab04c1b9</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10303055</commentid>
    <comment_count>16</comment_count>
    <who name="Jean-Luc Richier">jean-luc.richier</who>
    <bug_when>2017-04-04 11:32:02 -0400</bug_when>
    <thetext>
(In reply to Jiri Eischmann from comment #13)
&gt; I can also confirm there is still a problem. CUPS fails to start at boot,
&gt; but it&apos;s somehow started and running when I check it afterwards.
&gt; Nevertheless cups-browsed fails to start at boot because cups as its
&gt; dependency failed to start and it stays that way until you manually restart
&gt; it.

I have the same problem using cups-2.2.0-6.fc25.x86_64 : cups fails at boot time, 
withe message
cupsd[991]: cupsd: Cannot get a status of /etc/resolv.conf

and therefore the dependency cups-browsed fails to start at boot
To solve the problem, I modified /lib/systemd/system/cups.service to wait for
the activation of NetworkManager

diff /lib/systemd/system/cups.service.DIST /lib/systemd/system/cups.service
4c4
&lt; After=network.target
---
&gt; After=network-online.target NetworkManager-wait-online.service</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10303197</commentid>
    <comment_count>17</comment_count>
    <who name="Jean-Luc Richier">jean-luc.richier</who>
    <bug_when>2017-04-04 12:05:35 -0400</bug_when>
    <thetext>(In reply to Need Real Name from comment #16)

&gt; I have the same problem using cups-2.2.0-6.fc25.x86_64 : cups fails at boot
&gt; time, 
&gt; with message
&gt; cupsd[991]: cupsd: Cannot get a status of /etc/resolv.conf

I installed cups-2.2.0-7.fc25.x86_64 and it solves the problem</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10303204</commentid>
    <comment_count>18</comment_count>
    <who name="Zdenek Dohnal">zdohnal</who>
    <bug_when>2017-04-04 12:07:53 -0400</bug_when>
    <thetext>Yes, it solves problem, but I removed that patch only temporarily until I fix this issue.
Your solution will delay boot process for 90s if network-online.target fails. IMHO it is not the way it should be solved. 
Issue is with cups.service, which tries to start when network.target is completed, but network.target completion doesn&apos;t guarantee that /etc/resolv.conf exists. I&apos;ll try to do stat call later in daemon, when /etc/resolv.conf could exist.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10303245</commentid>
    <comment_count>19</comment_count>
    <who name="Zdenek Dohnal">zdohnal</who>
    <bug_when>2017-04-04 12:24:29 -0400</bug_when>
    <thetext>Ad comment #18:

After some time CUPS restarts, but cups-browsed, which depends on CUPS, will not restart and stays dead from boot time.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10304102</commentid>
    <comment_count>20</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-04 18:21:38 -0400</bug_when>
    <thetext>cups-2.1.4-5.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-19ab04c1b9</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10306190</commentid>
    <comment_count>21</comment_count>
    <who name="Zdenek Dohnal">zdohnal</who>
    <bug_when>2017-04-05 06:13:57 -0400</bug_when>
    <thetext>*** Bug 1439124 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10308094</commentid>
    <comment_count>22</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-05 15:45:32 -0400</bug_when>
    <thetext>cups-2.1.4-6.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-61498b10c5</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10308097</commentid>
    <comment_count>23</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-05 15:46:26 -0400</bug_when>
    <thetext>cups-2.2.0-8.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-37931b24eb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10308183</commentid>
    <comment_count>24</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-05 16:03:56 -0400</bug_when>
    <thetext>cups-2.2.2-5.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-81ec2a7046</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10308205</commentid>
    <comment_count>25</comment_count>
    <who name="Zdenek Dohnal">zdohnal</who>
    <bug_when>2017-04-05 16:18:16 -0400</bug_when>
    <thetext>Issue should be fixed with 2.1.4-6.fc24, 2.2.0-8.fc25, 2.2.2-5.fc26 and 2.2.3-4.fc27 releases. It contains again cups-resolv_reload.patch, which now does following:

- when /etc/resolv.conf doesn&apos;t exist, it tries to reload resolver with local nameserver (more info in &apos;man resolv.conf&apos;). 
- when even reloading resolver with local nameserver fails, function httpCheckResolv returns error, which is checked in cupsd main function - it only prints message to stderr about &quot;Cannot reload resolver - using old configuration&quot; - and no hard exit

I tested it in my F25, no error mesages for CUPS and cups-browsed service is still running.
Purpose of cups-resolv_reload.patch is to make CUPS recognize changes of nameserver IP&apos;s configuration without CUPS restart. This patch is only temporary workaround until glibc doesn&apos;t fix issue with dynamically changing nameservers IP configuration. Please check if this feature works too (it should be, I tested it too).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10312155</commentid>
    <comment_count>26</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-06 15:53:11 -0400</bug_when>
    <thetext>cups-2.1.4-6.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-61498b10c5</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10312243</commentid>
    <comment_count>27</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-06 16:24:10 -0400</bug_when>
    <thetext>cups-2.2.0-8.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-37931b24eb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10312456</commentid>
    <comment_count>28</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-06 18:22:26 -0400</bug_when>
    <thetext>cups-2.2.2-5.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-81ec2a7046</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10316828</commentid>
    <comment_count>29</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-08 22:54:32 -0400</bug_when>
    <thetext>cups-2.2.0-8.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10321139</commentid>
    <comment_count>30</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-10 12:01:49 -0400</bug_when>
    <thetext>cups-2.2.2-5.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10330815</commentid>
    <comment_count>31</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-12 15:50:20 -0400</bug_when>
    <thetext>cups-2.1.4-6.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>