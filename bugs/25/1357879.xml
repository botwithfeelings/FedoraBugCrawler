<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1357879</bug_id>
          
          <creation_ts>2016-07-19 08:58:00 -0400</creation_ts>
          <short_desc>rubygem-uglifier: FTBFS</short_desc>
          <delta_ts>2016-08-01 06:06:14 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>rubygem-uglifier</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          <see_also>https://bugzilla.redhat.com/show_bug.cgi?id=1077626</see_also>
    
    
    
    <see_also>https://bugzilla.redhat.com/show_bug.cgi?id=1358915</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          <dependson>1361179</dependson>
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Jun Aruga">jaruga</reporter>
          <assigned_to name="Jun Aruga">jaruga</assigned_to>
          <cc>strzibny</cc>
    
    
    <cc>vondruch</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>rubygem-uglifier-3.0.0-1.fc25, rubygem-uglifier-3.0.0-1.fc26</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-08-01 06:06:14</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9523262</commentid>
    <comment_count>0</comment_count>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-07-19 08:58:44 -0400</bug_when>
    <thetext>Description of problem:
FTBFS(Fails to build from source) because of retired rubygem-therubyracer.

Version-Release number of selected component (if applicable):
rubygem-uglifier-2.4.0-4.fc25

How reproducible:


Steps to Reproduce:
1. $ mock -r fedora-rawhide-x86_64 rubygem-uglifier-2.4.0-4.fc25.src.rpm

Actual results:
The test is failed with
No matching package to install: &apos;rubygem(therubyracer)&apos;
Not all dependencies satisfied
Error: Some packages could not be found.


Expected results:
The test is succeeded.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9525376</commentid>
    <comment_count>1</comment_count>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-07-19 11:11:13 -0400</bug_when>
    <thetext>I will fix it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9532800</commentid>
    <comment_count>2</comment_count>
      <attachid>1182133</attachid>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-07-20 10:39:48 -0400</bug_when>
    <thetext>Created attachment 1182133
Fix FTBFS, update to 3.0.0

Hi,
I fixed the FTBFS. and updated to 3.0.0.

# Highlight

- The dependency is no problem.

- This time, when I updated from v2.4.0 to v3.0.0.
  I removed json dependency from the RPM spec file.
  because then below json dependency is removed from the gem spec file.

```
spec.add_runtime_dependency &quot;json&quot;, &quot;&gt;= 1.8.0&quot;
```

- I did not touch bundled Javascript files this time.

Could you check my patch?
Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9532887</commentid>
    <comment_count>3</comment_count>
      <attachid>1182138</attachid>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-07-20 10:58:24 -0400</bug_when>
    <thetext>Created attachment 1182138
Fix FTBFS, update to 3.0.0

Sorry, I will upload the patch file again.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9533064</commentid>
    <comment_count>4</comment_count>
    <who name="Vít Ondruch">vondruch</who>
    <bug_when>2016-07-20 11:33:37 -0400</bug_when>
    <thetext>(In reply to Jun Aruga from comment #2)
&gt; - This time, when I updated from v2.4.0 to v3.0.0.
&gt;   I removed json dependency from the RPM spec file.
&gt;   because then below json dependency is removed from the gem spec file.

You should also remove the &quot;Requires: rubygem(execjs)&quot;, since this should be autogenerated (and I think RPM or rpmlint compalins about duplicated Requires).

&gt; - I did not touch bundled Javascript files this time.

Would you mind to explore, if there is a chance to undbundle the bundled JS in favor of uglify-js package?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9533283</commentid>
    <comment_count>5</comment_count>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-07-20 12:18:28 -0400</bug_when>
    <thetext>(In reply to Vít Ondruch from comment #4)
&gt; (In reply to Jun Aruga from comment #2)
&gt; &gt; - This time, when I updated from v2.4.0 to v3.0.0.
&gt; &gt;   I removed json dependency from the RPM spec file.
&gt; &gt;   because then below json dependency is removed from the gem spec file.
&gt; 
&gt; You should also remove the &quot;Requires: rubygem(execjs)&quot;, since this should be
&gt; autogenerated (and I think RPM or rpmlint compalins about duplicated
&gt; Requires).

If you want to remove the line &quot;Requires: rubygem(execjs)&quot;,
I want to remove not only &quot;Requires: rubygem(execjs)&quot; but also below 3 lines.

Requires: ruby(release)
Requires: ruby(rubygems)-
Requires: rubygem(execjs) &gt;= 0.3.0

The 3 lines are not needed when comparing the result of gem2rpm for the uglifier-3.0.0.gem.

Though my rpmlint did not complain about the duplicated Requires, I will take cafe of it.

$ rpmlint --version
rpmlint version 1.8 Copyright (C) 1999-2007 Frederic Lepied, Mandriva

$ rpmlint -i ./*.spec /var/lib/mock/fedora-rawhide-x86_64/result/*.rpm
rubygem-uglifier.noarch: W: spelling-error %description -l en_US minifies -&gt; miniseries
The value of this tag appears to be misspelled. Please double-check.

rubygem-uglifier.noarch: W: no-documentation
The package contains no documentation (README, doc, etc). You have to include
documentation files.

rubygem-uglifier.src: W: spelling-error %description -l en_US minifies -&gt; miniseries
The value of this tag appears to be misspelled. Please double-check.

3 packages and 1 specfiles checked; 0 errors, 3 warnings.


&gt; &gt; - I did not touch bundled Javascript files this time.
&gt; 
&gt; Would you mind to explore, if there is a chance to undbundle the bundled JS
&gt; in favor of uglify-js package?

Okay I will explore to unbundle it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9538056</commentid>
    <comment_count>6</comment_count>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-07-21 14:37:00 -0400</bug_when>
    <thetext>
&gt; Okay I will explore to unbundle it.

It is difficult for us to unbundle uglity-js right now.

Because
The rubygem-uglifier one of the file lib/uglify.js is generated from source-map and uglify-js.

We have nodejs-source-map package for the source-map and the uglify-js package.

However we do not have nodejs-source-map&apos;s dist file (dist/source-map.js) in the nodejs-source-map package

https://github.com/lautis/uglifier/blob/v3.0.0/Rakefile#L22

So, I will ask the owner of nodejs-source-map to put and include dist/source-map.js in the package.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9550070</commentid>
    <comment_count>7</comment_count>
    <who name="Jan Kurik">jkurik</who>
    <bug_when>2016-07-26 01:11:01 -0400</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 25 development cycle.
Changing version to &apos;25&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9559013</commentid>
    <comment_count>8</comment_count>
      <attachid>1184661</attachid>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-07-27 09:48:26 -0400</bug_when>
    <thetext>Created attachment 1184661
Fix FTBFS, update to 3.0.0

Hi,

I created again to unbundle uglify-js in the package, and use system uglify-js.
However this package needs uglify-js pacakge version 2.7.0.

- Fix for FTBFS. (rhbz#1357879)
- Update to uglifier 3.0.0
- Use system uglify-js instead of bundled one.

I used
BuildRequires: uglify-js &gt;= 2.7.0
instead of
BuildRequires: %{_bindir}/uglifyjs
Because I wanted to specify the version of it.

The SRPM is here.
https://copr.fedorainfracloud.org/coprs/vondruch/ror5/package/rubygem-uglifier/

Could you check the patch again?
Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9559073</commentid>
    <comment_count>9</comment_count>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-07-27 10:05:01 -0400</bug_when>
    <thetext>Sorry below 2 lines in the spec file, is not needed. I will remove these 2 lines after your review.
&gt; BuildRequires: nodejs-packaging
&gt; BuildRequires: npm(source-map)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9562695</commentid>
    <comment_count>10</comment_count>
    <who name="Vít Ondruch">vondruch</who>
    <bug_when>2016-07-28 06:24:34 -0400</bug_when>
    <thetext>Several notes:

* First of all, minor nit. If you are linking the GH PR above the Patch line, please avoid the &quot;.patch&quot; suffix. That way, one can easily get the whole picture.

* You don&apos;t have to be that wordy in comments above license. I&apos;d go with: &quot;# lib/source-map.js - BSD&quot; and that is it. The rest of the comments should go to &quot;Provides: bundled(nodejs-source-map)&quot;, which you are missing.

* You are removing the es5.js and split.js, but I don&apos;t think the explanation is sufficient. I would suggest something like: &quot;Unbundling es5.js and split.js files, since they are needed only by JScript engine, which is not supported on Fedora&quot;. Does it explain what you are trying to achieve?

*** Unbundling

Unfortunately, this:

```
# Use sysmtem uglify.js
uglifyjs --self --comments /Copyright/ &gt; lib/uglify.js
```

is not what I consider unbundling, since:

1) There is no runtime dependency on js-uglify (uglify-js).
2) Update of uglify-js does not result in update of the lib/uglify.js</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9562993</commentid>
    <comment_count>11</comment_count>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-07-28 07:34:00 -0400</bug_when>
    <thetext>Thank you for your review.

&gt; Several notes:

Okay, I will update the spec file for that.

&gt; *** Unbundling

uglify-js.js was bundled on the uglify-js package at past time. But now not.
https://bugzilla.redhat.com/show_bug.cgi?id=894725

So, I am asking the upstream to include it again.
https://github.com/mishoo/UglifyJS2/issues/1239</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9562998</commentid>
    <comment_count>12</comment_count>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-07-28 07:35:05 -0400</bug_when>
    <thetext>I will also update below page too for &quot;Provides: bundled(nodejs-source-map)&quot;.
https://fedoraproject.org/wiki/Bundled_Libraries_Virtual_Provides</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9563413</commentid>
    <comment_count>13</comment_count>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-07-28 09:05:52 -0400</bug_when>
    <thetext>I pushed to master(rawhide).
Koji: http://koji.fedoraproject.org/koji/taskinfo?taskID=15048704

But I could not push to f25 branch because uglify-js is still not updated to 2.7.0.
So, I asm asking to the upsatream to update to 2.7.0 on f25 branch too.
https://bugzilla.redhat.com/show_bug.cgi?id=1361179

After that, I will push it to f25 branch too.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9572347</commentid>
    <comment_count>14</comment_count>
    <who name="Jun Aruga">jaruga</who>
    <bug_when>2016-08-01 06:04:08 -0400</bug_when>
    <thetext>Finally I pushed it to f25 branch too.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1182133</attachid>
            <date>2016-07-20 10:39:00 -0400</date>
            <delta_ts>2016-07-20 10:57:48 -0400</delta_ts>
            <desc>Fix FTBFS, update to 3.0.0</desc>
            <filename>0001-Fix-for-FTBFS.-rhbz-1357879.patch</filename>
            <type>text/plain</type>
            <size>2928</size>
            <attacher name="Jun Aruga">jaruga</attacher>
            
              <data encoding="base64">RnJvbSAzYzI4M2U4YzQxYjlmMmVmMmI0NjE0ZmJjYzFiNjE0OTg0OGMyMmIzIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBKdW4gQXJ1Z2EgPGphcnVnYUByZWRoYXQuY29tPgpEYXRlOiBX
ZWQsIDIwIEp1bCAyMDE2IDE2OjMzOjM1ICswMjAwClN1YmplY3Q6IFtQQVRDSF0gLSBGaXggZm9y
IEZUQkZTLiAocmhieiMxMzU3ODc5KSAtIFVwZGF0ZSB0byB1Z2xpZmllciAzLjAuMAoKLS0tCiBy
dWJ5Z2VtLXVnbGlmaWVyLnNwZWMgfCAzMSArKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0t
CiAxIGZpbGUgY2hhbmdlZCwgMTcgaW5zZXJ0aW9ucygrKSwgMTQgZGVsZXRpb25zKC0pCgpkaWZm
IC0tZ2l0IGEvcnVieWdlbS11Z2xpZmllci5zcGVjIGIvcnVieWdlbS11Z2xpZmllci5zcGVjCmlu
ZGV4IDNlNzZkZjUuLjNjNjA0OTYgMTAwNjQ0Ci0tLSBhL3J1YnlnZW0tdWdsaWZpZXIuc3BlYwor
KysgYi9ydWJ5Z2VtLXVnbGlmaWVyLnNwZWMKQEAgLTMsMzIgKzMsMjggQEAKIAogU3VtbWFyeTog
UnVieSB3cmFwcGVyIGZvciBVZ2xpZnlKUyBKYXZhU2NyaXB0IGNvbXByZXNzb3IKIE5hbWU6IHJ1
YnlnZW0tJXtnZW1fbmFtZX0KLVZlcnNpb246IDIuNC4wCi1SZWxlYXNlOiA0JXs/ZGlzdH0KK1Zl
cnNpb246IDMuMC4wCitSZWxlYXNlOiAxJXs/ZGlzdH0KIEdyb3VwOiBEZXZlbG9wbWVudC9MYW5n
dWFnZXMKICMgVWdsaWZpZXIgaXRzZWxmIGlzIE1JVAogIyB0aGUgYnVuZGxlZCBKYXZhU2NyaXB0
IGZyb20gVWdsaWZ5SlMgaXMgQlNECiBMaWNlbnNlOiBNSVQgYW5kIEJTRAogVVJMOiBodHRwOi8v
Z2l0aHViLmNvbS9sYXV0aXMvdWdsaWZpZXIKLVNvdXJjZTA6IGh0dHA6Ly9ydWJ5Z2Vtcy5vcmcv
Z2Vtcy8le2dlbV9uYW1lfS0le3ZlcnNpb259LmdlbQorU291cmNlMDogaHR0cHM6Ly9ydWJ5Z2Vt
cy5vcmcvZ2Vtcy8le2dlbV9uYW1lfS0le3ZlcnNpb259LmdlbQogUmVxdWlyZXM6IHJ1YnkocmVs
ZWFzZSkKIFJlcXVpcmVzOiBydWJ5KHJ1YnlnZW1zKSAKIFJlcXVpcmVzOiBydWJ5Z2VtKGV4ZWNq
cykgPj0gMC4zLjAKLVJlcXVpcmVzOiBydWJ5Z2VtKG11bHRpX2pzb24pID0+IDEuMwotUmVxdWly
ZXM6IHJ1YnlnZW0obXVsdGlfanNvbikgPCAyCiBCdWlsZFJlcXVpcmVzOiBydWJ5KHJlbGVhc2Up
CiBCdWlsZFJlcXVpcmVzOiBydWJ5Z2Vtcy1kZXZlbAogQnVpbGRSZXF1aXJlczogcnVieQogQnVp
bGRSZXF1aXJlczogcnVieWdlbShleGVjanMpID49IDAuMy4wCi1CdWlsZFJlcXVpcmVzOiBydWJ5
Z2VtKG11bHRpX2pzb24pID0+IDEuMwotQnVpbGRSZXF1aXJlczogcnVieWdlbShtdWx0aV9qc29u
KSA8IDIKIEJ1aWxkUmVxdWlyZXM6IHJ1YnlnZW0ocnNwZWMpCi1CdWlsZFJlcXVpcmVzOiBydWJ5
Z2VtKHRoZXJ1YnlyYWNlcikKK0J1aWxkUmVxdWlyZXM6ICV7X2JpbmRpcn0vbm9kZQogQnVpbGRB
cmNoOiBub2FyY2gKLVByb3ZpZGVzOiBydWJ5Z2VtKCV7Z2VtX25hbWV9KSA9ICV7dmVyc2lvbn0K
IAogJWRlc2NyaXB0aW9uCi1SdWJ5IHdyYXBwZXIgZm9yIFVnbGlmeUpTIEphdmFTY3JpcHQgY29t
cHJlc3Nvci4KK1VnbGlmaWVyIG1pbmlmaWVzIEphdmFTY3JpcHQgZmlsZXMgYnkgd3JhcHBpbmcg
VWdsaWZ5SlMgdG8gYmUgYWNjZXNzaWJsZSBpbgorUnVieS4KIAogCiAlcGFja2FnZSBkb2MKQEAg
LTU0LDggKzUwLDggQEAgY3AgLWEgLiV7Z2VtX2Rpcn0vKiBcCiAlY2hlY2sKIHB1c2hkIC4le2dl
bV9pbnN0ZGlyfQogCi0jIHNvdXJjZV9tYXAgaXMgbm90IHBhcnQgb2YgZmVkb3JhIHlldCwgZ2Vk
IHJpZCBvZiBzb3VyY2VfbWFwIGluIHNwZWNzCi1zZWQgLWkgInMvcmVxdWlyZSAnc291cmNlX21h
cCcvLyIgIHNwZWMvc3BlY19oZWxwZXIucmIKKyMgc291cmNlbWFwIGlzIG5vdCBwYXJ0IG9mIGZl
ZG9yYSB5ZXQsIGdlZCByaWQgb2Ygc291cmNlX21hcCBpbiBzcGVjcworc2VkIC1pICJzL3JlcXVp
cmUgJ3NvdXJjZW1hcCcvLyIgIHNwZWMvc3BlY19oZWxwZXIucmIKIHJtIHNwZWMvc291cmNlX21h
cF9zcGVjLnJiCiAKIHJzcGVjIHNwZWMKQEAgLTY0LDI0ICs2MCwzMSBAQCBwb3BkCiAKICVmaWxl
cwogJWRpciAle2dlbV9pbnN0ZGlyfQotJWRvYyAle2dlbV9pbnN0ZGlyfS9MSUNFTlNFLnR4dAor
JWxpY2Vuc2UgJXtnZW1faW5zdGRpcn0vTElDRU5TRS50eHQKICV7Z2VtX2xpYmRpcn0KICVleGNs
dWRlICV7Z2VtX2luc3RkaXJ9Ly4qCiAlZXhjbHVkZSAle2dlbV9jYWNoZX0KLSVleGNsdWRlICV7
Z2VtX2luc3RkaXJ9L2dlbWZpbGVzCiAle2dlbV9zcGVjfQogCiAlZmlsZXMgZG9jCiAlZG9jICV7
Z2VtX2RvY2Rpcn0KKyVkb2MgJXtnZW1faW5zdGRpcn0vLmRvY3VtZW50CislZG9jICV7Z2VtX2lu
c3RkaXJ9L0NIQU5HRUxPRy5tZAorJWRvYyAle2dlbV9pbnN0ZGlyfS9DT05UUklCVVRJTkcubWQK
ICV7Z2VtX2luc3RkaXJ9L0dlbWZpbGUKICV7Z2VtX2luc3RkaXJ9L1Jha2VmaWxlCiAlZG9jICV7
Z2VtX2luc3RkaXJ9L1JFQURNRS5tZAorJXtnZW1faW5zdGRpcn0vZ2VtZmlsZXMKICV7Z2VtX2lu
c3RkaXJ9L3NwZWMKICV7Z2VtX2luc3RkaXJ9LyV7Z2VtX25hbWV9LmdlbXNwZWMKICVkb2MgJXtn
ZW1faW5zdGRpcn0vQ0hBTkdFTE9HLm1kCiAlZG9jICV7Z2VtX2luc3RkaXJ9L0NPTlRSSUJVVElO
Ry5tZAogCiAlY2hhbmdlbG9nCisqIFR1ZSBKdWwgMTkgMjAxNiBKdW4gQXJ1Z2EgPGphcnVnYUBy
ZWRoYXQuY29tPiAtIDMuMC4wLTEKKy0gRml4IGZvciBGVEJGUy4gKHJoYnojMTM1Nzg3OSkKKy0g
VXBkYXRlIHRvIHVnbGlmaWVyIDMuMC4wCisKICogVGh1IEZlYiAwNCAyMDE2IEZlZG9yYSBSZWxl
YXNlIEVuZ2luZWVyaW5nIDxyZWxlbmdAZmVkb3JhcHJvamVjdC5vcmc+IC0gMi40LjAtNAogLSBS
ZWJ1aWx0IGZvciBodHRwczovL2ZlZG9yYXByb2plY3Qub3JnL3dpa2kvRmVkb3JhXzI0X01hc3Nf
UmVidWlsZAogCi0tIAoyLjUuNQoK
</data>

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1182138</attachid>
            <date>2016-07-20 10:58:00 -0400</date>
            <delta_ts>2016-07-27 09:43:34 -0400</delta_ts>
            <desc>Fix FTBFS, update to 3.0.0</desc>
            <filename>0001-Fix-for-FTBFS.-rhbz-1357879.patch</filename>
            <type>text/plain</type>
            <size>2896</size>
            <attacher name="Jun Aruga">jaruga</attacher>
            
              <data encoding="base64">RnJvbSBmMTM0Y2MxZDAzMWE3ZjZlZjdlZDk2MDM3NmFjODhjYTM1MmM3NDQ1IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBKdW4gQXJ1Z2EgPGphcnVnYUByZWRoYXQuY29tPgpEYXRlOiBX
ZWQsIDIwIEp1bCAyMDE2IDE2OjMzOjM1ICswMjAwClN1YmplY3Q6IFtQQVRDSF0gLSBGaXggZm9y
IEZUQkZTLiAocmhieiMxMzU3ODc5KSAtIFVwZGF0ZSB0byB1Z2xpZmllciAzLjAuMAoKLS0tCiBy
dWJ5Z2VtLXVnbGlmaWVyLnNwZWMgfCAzMCArKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0K
IDEgZmlsZSBjaGFuZ2VkLCAxNiBpbnNlcnRpb25zKCspLCAxNCBkZWxldGlvbnMoLSkKCmRpZmYg
LS1naXQgYS9ydWJ5Z2VtLXVnbGlmaWVyLnNwZWMgYi9ydWJ5Z2VtLXVnbGlmaWVyLnNwZWMKaW5k
ZXggM2U3NmRmNS4uNzE3NTJlNyAxMDA2NDQKLS0tIGEvcnVieWdlbS11Z2xpZmllci5zcGVjCisr
KyBiL3J1YnlnZW0tdWdsaWZpZXIuc3BlYwpAQCAtMywzMiArMywyOCBAQAogCiBTdW1tYXJ5OiBS
dWJ5IHdyYXBwZXIgZm9yIFVnbGlmeUpTIEphdmFTY3JpcHQgY29tcHJlc3NvcgogTmFtZTogcnVi
eWdlbS0le2dlbV9uYW1lfQotVmVyc2lvbjogMi40LjAKLVJlbGVhc2U6IDQlez9kaXN0fQorVmVy
c2lvbjogMy4wLjAKK1JlbGVhc2U6IDElez9kaXN0fQogR3JvdXA6IERldmVsb3BtZW50L0xhbmd1
YWdlcwogIyBVZ2xpZmllciBpdHNlbGYgaXMgTUlUCiAjIHRoZSBidW5kbGVkIEphdmFTY3JpcHQg
ZnJvbSBVZ2xpZnlKUyBpcyBCU0QKIExpY2Vuc2U6IE1JVCBhbmQgQlNECiBVUkw6IGh0dHA6Ly9n
aXRodWIuY29tL2xhdXRpcy91Z2xpZmllcgotU291cmNlMDogaHR0cDovL3J1YnlnZW1zLm9yZy9n
ZW1zLyV7Z2VtX25hbWV9LSV7dmVyc2lvbn0uZ2VtCitTb3VyY2UwOiBodHRwczovL3J1YnlnZW1z
Lm9yZy9nZW1zLyV7Z2VtX25hbWV9LSV7dmVyc2lvbn0uZ2VtCiBSZXF1aXJlczogcnVieShyZWxl
YXNlKQogUmVxdWlyZXM6IHJ1YnkocnVieWdlbXMpIAogUmVxdWlyZXM6IHJ1YnlnZW0oZXhlY2pz
KSA+PSAwLjMuMAotUmVxdWlyZXM6IHJ1YnlnZW0obXVsdGlfanNvbikgPT4gMS4zCi1SZXF1aXJl
czogcnVieWdlbShtdWx0aV9qc29uKSA8IDIKIEJ1aWxkUmVxdWlyZXM6IHJ1YnkocmVsZWFzZSkK
IEJ1aWxkUmVxdWlyZXM6IHJ1YnlnZW1zLWRldmVsCiBCdWlsZFJlcXVpcmVzOiBydWJ5CiBCdWls
ZFJlcXVpcmVzOiBydWJ5Z2VtKGV4ZWNqcykgPj0gMC4zLjAKLUJ1aWxkUmVxdWlyZXM6IHJ1Ynln
ZW0obXVsdGlfanNvbikgPT4gMS4zCi1CdWlsZFJlcXVpcmVzOiBydWJ5Z2VtKG11bHRpX2pzb24p
IDwgMgogQnVpbGRSZXF1aXJlczogcnVieWdlbShyc3BlYykKLUJ1aWxkUmVxdWlyZXM6IHJ1Ynln
ZW0odGhlcnVieXJhY2VyKQorQnVpbGRSZXF1aXJlczogJXtfYmluZGlyfS9ub2RlCiBCdWlsZEFy
Y2g6IG5vYXJjaAotUHJvdmlkZXM6IHJ1YnlnZW0oJXtnZW1fbmFtZX0pID0gJXt2ZXJzaW9ufQog
CiAlZGVzY3JpcHRpb24KLVJ1Ynkgd3JhcHBlciBmb3IgVWdsaWZ5SlMgSmF2YVNjcmlwdCBjb21w
cmVzc29yLgorVWdsaWZpZXIgbWluaWZpZXMgSmF2YVNjcmlwdCBmaWxlcyBieSB3cmFwcGluZyBV
Z2xpZnlKUyB0byBiZSBhY2Nlc3NpYmxlIGluCitSdWJ5LgogCiAKICVwYWNrYWdlIGRvYwpAQCAt
NTQsOCArNTAsOCBAQCBjcCAtYSAuJXtnZW1fZGlyfS8qIFwKICVjaGVjawogcHVzaGQgLiV7Z2Vt
X2luc3RkaXJ9CiAKLSMgc291cmNlX21hcCBpcyBub3QgcGFydCBvZiBmZWRvcmEgeWV0LCBnZWQg
cmlkIG9mIHNvdXJjZV9tYXAgaW4gc3BlY3MKLXNlZCAtaSAicy9yZXF1aXJlICdzb3VyY2VfbWFw
Jy8vIiAgc3BlYy9zcGVjX2hlbHBlci5yYgorIyBzb3VyY2VtYXAgaXMgbm90IHBhcnQgb2YgZmVk
b3JhIHlldCwgZ2VkIHJpZCBvZiBzb3VyY2VfbWFwIGluIHNwZWNzCitzZWQgLWkgInMvcmVxdWly
ZSAnc291cmNlbWFwJy8vIiAgc3BlYy9zcGVjX2hlbHBlci5yYgogcm0gc3BlYy9zb3VyY2VfbWFw
X3NwZWMucmIKIAogcnNwZWMgc3BlYwpAQCAtNjQsMjQgKzYwLDMwIEBAIHBvcGQKIAogJWZpbGVz
CiAlZGlyICV7Z2VtX2luc3RkaXJ9Ci0lZG9jICV7Z2VtX2luc3RkaXJ9L0xJQ0VOU0UudHh0Cisl
bGljZW5zZSAle2dlbV9pbnN0ZGlyfS9MSUNFTlNFLnR4dAogJXtnZW1fbGliZGlyfQogJWV4Y2x1
ZGUgJXtnZW1faW5zdGRpcn0vLioKICVleGNsdWRlICV7Z2VtX2NhY2hlfQotJWV4Y2x1ZGUgJXtn
ZW1faW5zdGRpcn0vZ2VtZmlsZXMKICV7Z2VtX3NwZWN9CiAKICVmaWxlcyBkb2MKICVkb2MgJXtn
ZW1fZG9jZGlyfQorJWRvYyAle2dlbV9pbnN0ZGlyfS9DSEFOR0VMT0cubWQKKyVkb2MgJXtnZW1f
aW5zdGRpcn0vQ09OVFJJQlVUSU5HLm1kCiAle2dlbV9pbnN0ZGlyfS9HZW1maWxlCiAle2dlbV9p
bnN0ZGlyfS9SYWtlZmlsZQogJWRvYyAle2dlbV9pbnN0ZGlyfS9SRUFETUUubWQKKyV7Z2VtX2lu
c3RkaXJ9L2dlbWZpbGVzCiAle2dlbV9pbnN0ZGlyfS9zcGVjCiAle2dlbV9pbnN0ZGlyfS8le2dl
bV9uYW1lfS5nZW1zcGVjCiAlZG9jICV7Z2VtX2luc3RkaXJ9L0NIQU5HRUxPRy5tZAogJWRvYyAl
e2dlbV9pbnN0ZGlyfS9DT05UUklCVVRJTkcubWQKIAogJWNoYW5nZWxvZworKiBUdWUgSnVsIDE5
IDIwMTYgSnVuIEFydWdhIDxqYXJ1Z2FAcmVkaGF0LmNvbT4gLSAzLjAuMC0xCistIEZpeCBmb3Ig
RlRCRlMuIChyaGJ6IzEzNTc4NzkpCistIFVwZGF0ZSB0byB1Z2xpZmllciAzLjAuMAorCiAqIFRo
dSBGZWIgMDQgMjAxNiBGZWRvcmEgUmVsZWFzZSBFbmdpbmVlcmluZyA8cmVsZW5nQGZlZG9yYXBy
b2plY3Qub3JnPiAtIDIuNC4wLTQKIC0gUmVidWlsdCBmb3IgaHR0cHM6Ly9mZWRvcmFwcm9qZWN0
Lm9yZy93aWtpL0ZlZG9yYV8yNF9NYXNzX1JlYnVpbGQKIAotLSAKMi41LjUKCg==
</data>

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1184661</attachid>
            <date>2016-07-27 09:48:00 -0400</date>
            <delta_ts>2016-07-27 09:48:26 -0400</delta_ts>
            <desc>Fix FTBFS, update to 3.0.0</desc>
            <filename>0001-Fix-for-FTBFS.-rhbz-1357879.patch</filename>
            <type>text/plain</type>
            <size>246591</size>
            <attacher name="Jun Aruga">jaruga</attacher>
            
              <data encoding="base64">RnJvbSAzYmIyYTM0ZjhlZWE2OWU3Y2VhZTIzNzkyZGIxYTQ3MTY1ZmU5ZTY1IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBKdW4gQXJ1Z2EgPGphcnVnYUByZWRoYXQuY29tPgpEYXRlOiBX
ZWQsIDIwIEp1bCAyMDE2IDE2OjMzOjM1ICswMjAwClN1YmplY3Q6IFtQQVRDSF0gLSBGaXggZm9y
IEZUQkZTLiAocmhieiMxMzU3ODc5KSAtIFVwZGF0ZSB0byB1Z2xpZmllciAzLjAuMCAtCiBVc2Ug
c3lzdGVtIHVnbGlmeS1qcyBpbnN0ZWFkIG9mIGJ1bmRsZWQgb25lLgoKLS0tCiAuLi5nbGlmaWVy
LTMuMC4wLWZpeC10ZXN0LWZvci11Z2xpZnlqcy0yLjcuMC5wYXRjaCB8ICAgMjUgKwogcnVieWdl
bS11Z2xpZmllci0zLjAuMC1zZXBhcmF0ZS1zb3VyY2UtbWFwLnBhdGNoICAgfCA2MTAzICsrKysr
KysrKysrKysrKysrKysrCiAuLi5pZmllci0zLjAuMC11bmJ1bmRsZS1qcy1maWxlcy1mb3ItanNj
cmlwdC5wYXRjaCB8ICA0OTAgKysKIHJ1YnlnZW0tdWdsaWZpZXIuc3BlYyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHwgICA3OCArLQogNCBmaWxlcyBjaGFuZ2VkLCA2NjczIGluc2VydGlv
bnMoKyksIDIzIGRlbGV0aW9ucygtKQogY3JlYXRlIG1vZGUgMTAwNjQ0IHJ1YnlnZW0tdWdsaWZp
ZXItMy4wLjAtZml4LXRlc3QtZm9yLXVnbGlmeWpzLTIuNy4wLnBhdGNoCiBjcmVhdGUgbW9kZSAx
MDA2NDQgcnVieWdlbS11Z2xpZmllci0zLjAuMC1zZXBhcmF0ZS1zb3VyY2UtbWFwLnBhdGNoCiBj
cmVhdGUgbW9kZSAxMDA2NDQgcnVieWdlbS11Z2xpZmllci0zLjAuMC11bmJ1bmRsZS1qcy1maWxl
cy1mb3ItanNjcmlwdC5wYXRjaAoKZGlmZiAtLWdpdCBhL3J1YnlnZW0tdWdsaWZpZXItMy4wLjAt
Zml4LXRlc3QtZm9yLXVnbGlmeWpzLTIuNy4wLnBhdGNoIGIvcnVieWdlbS11Z2xpZmllci0zLjAu
MC1maXgtdGVzdC1mb3ItdWdsaWZ5anMtMi43LjAucGF0Y2gKbmV3IGZpbGUgbW9kZSAxMDA2NDQK
aW5kZXggMDAwMDAwMC4uNzEwYWY5MgotLS0gL2Rldi9udWxsCisrKyBiL3J1YnlnZW0tdWdsaWZp
ZXItMy4wLjAtZml4LXRlc3QtZm9yLXVnbGlmeWpzLTIuNy4wLnBhdGNoCkBAIC0wLDAgKzEsMjUg
QEAKK0Zyb20gZjY3NmI2NmYxZDM1NjUzZjgxYjk2NDU1MDhjMzAwNTNiNjgwYTY0YiBNb24gU2Vw
IDE3IDAwOjAwOjAwIDIwMDEKK0Zyb206IFZpbGxlIExhdXRhbmFsYSA8bGF1dGlzQGdtYWlsLmNv
bT4KK0RhdGU6IFN1biwgMjQgSnVsIDIwMTYgMjA6Mjk6NDMgKzAzMDAKK1N1YmplY3Q6IFtQQVRD
SF0gVXBkYXRlIFVnbGlmeUpTIHRvIDIuNy4wCisKKy0tLQorIENIQU5HRUxPRy5tZCAgICAgICAg
ICB8ICA0ICsrKysKKyBsaWIvdWdsaWZ5LmpzICAgICAgICAgfCAyMSArKysrKysrKysrKy0tLS0t
LS0tLS0KKyBzcGVjL3VnbGlmaWVyX3NwZWMucmIgfCAgMiArLQorIHZlbmRvci91Z2xpZnlqcyAg
ICAgICB8ICAyICstCisgNCBmaWxlcyBjaGFuZ2VkLCAxNyBpbnNlcnRpb25zKCspLCAxMiBkZWxl
dGlvbnMoLSkKKworZGlmZiAtLWdpdCBhL3NwZWMvdWdsaWZpZXJfc3BlYy5yYiBiL3NwZWMvdWds
aWZpZXJfc3BlYy5yYgoraW5kZXggN2YwZmRjMS4uOGYyNDIwZSAxMDA2NDQKKy0tLSBhL3NwZWMv
dWdsaWZpZXJfc3BlYy5yYgorKysrIGIvc3BlYy91Z2xpZmllcl9zcGVjLnJiCitAQCAtMTksNyAr
MTksNyBAQAorICAgZW5kCisgCisgICBpdCAiZG9lc24ndCBvbWl0IG51bGwgY2hhcmFjdGVyIGlu
IHN0cmluZ3MiIGRvCistICAgIGV4cGVjdChVZ2xpZmllci5uZXcuY29tcGlsZSgndmFyIGZvbz0i
XDBiYXIiJykpLnRvIGluY2x1ZGUoIlxceDAwYmFyIikKKysgICAgZXhwZWN0KFVnbGlmaWVyLm5l
dy5jb21waWxlKCd2YXIgZm9vPSJcMGJhciInKSkudG8gaW5jbHVkZSgiXFwwYmFyIikKKyAgIGVu
ZAorIAorICAgaXQgImFkZHMgdHJhaWxpbmcgc2VtaWNvbG9uIHRvIG1pbmlmaWVkIHNvdXJjZSIg
ZG8KZGlmZiAtLWdpdCBhL3J1YnlnZW0tdWdsaWZpZXItMy4wLjAtc2VwYXJhdGUtc291cmNlLW1h
cC5wYXRjaCBiL3J1YnlnZW0tdWdsaWZpZXItMy4wLjAtc2VwYXJhdGUtc291cmNlLW1hcC5wYXRj
aApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi41Mjk2YjljCi0tLSAvZGV2L251
bGwKKysrIGIvcnVieWdlbS11Z2xpZmllci0zLjAuMC1zZXBhcmF0ZS1zb3VyY2UtbWFwLnBhdGNo
CkBAIC0wLDAgKzEsNjEwMyBAQAorRnJvbSA4ODY2MzkyY2VmMDkyZWU0YWQzYTVhNTI3NmUwM2Jj
NjdlYjdhNTFkIE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQorRnJvbTogSnVuIEFydWdhIDxqYXJ1
Z2FAcmVkaGF0LmNvbT4KK0RhdGU6IEZyaSwgMjIgSnVsIDIwMTYgMTk6MTk6NTEgKzAyMDAKK1N1
YmplY3Q6IFtQQVRDSF0gU2VwYXJhdGUgU291cmNlIE1hcCBhbmQgVWdsaWZ5SlMgbGlicmFyeSBm
aWxlLgorCistLS0KKyBSYWtlZmlsZSAgICAgICAgICB8ICAgIDggKy0KKyBsaWIvc291cmNlLW1h
cC5qcyB8IDMwMDUgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysrKworIGxpYi91Z2xpZmllci5qcyAgIHwgICAgMyArCisgbGliL3VnbGlmaWVyLnJiICAg
fCAgICA1ICstCisgbGliL3VnbGlmeS5qcyAgICAgfCAzMDA2ICstLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCisgNSBmaWxlcyBjaGFuZ2VkLCAzMDE2
IGluc2VydGlvbnMoKyksIDMwMTEgZGVsZXRpb25zKC0pCisgY3JlYXRlIG1vZGUgMTAwNjQ0IGxp
Yi9zb3VyY2UtbWFwLmpzCisKK2RpZmYgLS1naXQgYS9SYWtlZmlsZSBiL1Jha2VmaWxlCitpbmRl
eCBhNzAzNjNlLi5mNDJkNjNmIDEwMDY0NAorLS0tIGEvUmFrZWZpbGUKKysrKyBiL1Jha2VmaWxl
CitAQCAtMSw1ICsxLDYgQEAKKyAjIGVuY29kaW5nOiB1dGYtOAorIAorK3JlcXVpcmUgJ2ZpbGV1
dGlscycKKyByZXF1aXJlICdidW5kbGVyL2dlbV90YXNrcycKKyByZXF1aXJlICdyc3BlYy9jb3Jl
L3Jha2VfdGFzaycKKyBSU3BlYzo6Q29yZTo6UmFrZVRhc2submV3KDpzcGVjKSBkbyB8c3BlY3wK
K0BAIC0xNywxMiArMTgsOSBAQCB0YXNrIDpqcyBkbworICAgICBgbnBtIGluc3RhbGxgCisgICBl
bmQKKyAKKy0gIHNvdXJjZSA9ICIiCistICBzb3VyY2UgPDwgIndpbmRvdyA9IHRoaXM7IgorLSAg
c291cmNlIDw8IEZpbGUucmVhZCgidmVuZG9yL3NvdXJjZS1tYXAvZGlzdC9zb3VyY2UtbWFwLmpz
IikKKy0gIHNvdXJjZSA8PCAiTU9aX1NvdXJjZU1hcCA9IHNvdXJjZU1hcDsiCistICBzb3VyY2Ug
PDwgYC4vdmVuZG9yL3VnbGlmeWpzL2Jpbi91Z2xpZnlqcyAtLXNlbGYgLS1jb21tZW50cyAvQ29w
eXJpZ2h0L2AKKysgIEZpbGVVdGlscy5jcCgidmVuZG9yL3NvdXJjZS1tYXAvZGlzdC9zb3VyY2Ut
bWFwLmpzIiwgImxpYi9zb3VyY2UtbWFwLmpzIikKKyAKKysgIHNvdXJjZSA9IGAuL3ZlbmRvci91
Z2xpZnlqcy9iaW4vdWdsaWZ5anMgLS1zZWxmIC0tY29tbWVudHMgL0NvcHlyaWdodC9gCisgICBG
aWxlLndyaXRlKCJsaWIvdWdsaWZ5LmpzIiwgc291cmNlKQorIGVuZAorIAorZGlmZiAtLWdpdCBh
L2xpYi9zb3VyY2UtbWFwLmpzIGIvbGliL3NvdXJjZS1tYXAuanMKK25ldyBmaWxlIG1vZGUgMTAw
NjQ0CitpbmRleCAwMDAwMDAwLi4yNTE5OWE2CistLS0gL2Rldi9udWxsCisrKysgYi9saWIvc291
cmNlLW1hcC5qcworQEAgLTAsMCArMSwzMDA1IEBACisrKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJz
YWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHsKKysJaWYodHlwZW9mIGV4cG9ydHMg
PT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKQorKwkJbW9kdWxlLmV4
cG9ydHMgPSBmYWN0b3J5KCk7CisrCWVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9u
JyAmJiBkZWZpbmUuYW1kKQorKwkJZGVmaW5lKFtdLCBmYWN0b3J5KTsKKysJZWxzZSBpZih0eXBl
b2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpCisrCQlleHBvcnRzWyJzb3VyY2VNYXAiXSA9IGZhY3Rv
cnkoKTsKKysJZWxzZQorKwkJcm9vdFsic291cmNlTWFwIl0gPSBmYWN0b3J5KCk7CisrfSkodGhp
cywgZnVuY3Rpb24oKSB7CisrcmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8v
IHdlYnBhY2tCb290c3RyYXAKKysvKioqKioqLyAJLy8gVGhlIG1vZHVsZSBjYWNoZQorKy8qKioq
KiovIAl2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9OworKworKy8qKioqKiovIAkvLyBUaGUgcmVx
dWlyZSBmdW5jdGlvbgorKy8qKioqKiovIAlmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1v
ZHVsZUlkKSB7CisrCisrLyoqKioqKi8gCQkvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGUK
KysvKioqKioqLyAJCWlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKQorKy8qKioqKiovIAkJ
CXJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzOworKworKy8qKioqKiov
IAkJLy8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSkKKysv
KioqKioqLyAJCXZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHsKKysv
KioqKioqLyAJCQlleHBvcnRzOiB7fSwKKysvKioqKioqLyAJCQlpZDogbW9kdWxlSWQsCisrLyoq
KioqKi8gCQkJbG9hZGVkOiBmYWxzZQorKy8qKioqKiovIAkJfTsKKysKKysvKioqKioqLyAJCS8v
IEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvbgorKy8qKioqKiovIAkJbW9kdWxlc1ttb2R1bGVJ
ZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNr
X3JlcXVpcmVfXyk7CisrCisrLyoqKioqKi8gCQkvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVk
CisrLyoqKioqKi8gCQltb2R1bGUubG9hZGVkID0gdHJ1ZTsKKysKKysvKioqKioqLyAJCS8vIFJl
dHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlCisrLyoqKioqKi8gCQlyZXR1cm4gbW9kdWxl
LmV4cG9ydHM7CisrLyoqKioqKi8gCX0KKysKKysKKysvKioqKioqLyAJLy8gZXhwb3NlIHRoZSBt
b2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXykKKysvKioqKioqLyAJX193ZWJwYWNr
X3JlcXVpcmVfXy5tID0gbW9kdWxlczsKKysKKysvKioqKioqLyAJLy8gZXhwb3NlIHRoZSBtb2R1
bGUgY2FjaGUKKysvKioqKioqLyAJX193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9k
dWxlczsKKysKKysvKioqKioqLyAJLy8gX193ZWJwYWNrX3B1YmxpY19wYXRoX18KKysvKioqKioq
LyAJX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gIiI7CisrCisrLyoqKioqKi8gCS8vIExvYWQgZW50
cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0cworKy8qKioqKiovIAlyZXR1cm4gX193ZWJwYWNr
X3JlcXVpcmVfXygwKTsKKysvKioqKioqLyB9KQorKy8qKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCisrLyoqKioq
Ki8gKFsKKysvKiAwICovCisrLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBh
Y2tfcmVxdWlyZV9fKSB7CisrCisrCS8qCisrCSAqIENvcHlyaWdodCAyMDA5LTIwMTEgTW96aWxs
YSBGb3VuZGF0aW9uIGFuZCBjb250cmlidXRvcnMKKysJICogTGljZW5zZWQgdW5kZXIgdGhlIE5l
dyBCU0QgbGljZW5zZS4gU2VlIExJQ0VOU0UudHh0IG9yOgorKwkgKiBodHRwOi8vb3BlbnNvdXJj
ZS5vcmcvbGljZW5zZXMvQlNELTMtQ2xhdXNlCisrCSAqLworKwlleHBvcnRzLlNvdXJjZU1hcEdl
bmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJlX18oMSkuU291cmNlTWFwR2VuZXJhdG9yOworKwll
eHBvcnRzLlNvdXJjZU1hcENvbnN1bWVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3KS5Tb3VyY2VN
YXBDb25zdW1lcjsKKysJZXhwb3J0cy5Tb3VyY2VOb2RlID0gX193ZWJwYWNrX3JlcXVpcmVfXygx
MCkuU291cmNlTm9kZTsKKysKKysKKysvKioqLyB9LAorKy8qIDEgKi8KKysvKioqLyBmdW5jdGlv
bihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKKysKKysJLyogLSotIE1v
ZGU6IGpzOyBqcy1pbmRlbnQtbGV2ZWw6IDI7IC0qLSAqLworKwkvKgorKwkgKiBDb3B5cmlnaHQg
MjAxMSBNb3ppbGxhIEZvdW5kYXRpb24gYW5kIGNvbnRyaWJ1dG9ycworKwkgKiBMaWNlbnNlZCB1
bmRlciB0aGUgTmV3IEJTRCBsaWNlbnNlLiBTZWUgTElDRU5TRSBvcjoKKysJICogaHR0cDovL29w
ZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL0JTRC0zLUNsYXVzZQorKwkgKi8KKysJeworKwkgIHZhciBi
YXNlNjRWTFEgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpOworKwkgIHZhciB1dGlsID0gX193ZWJw
YWNrX3JlcXVpcmVfXyg0KTsKKysJICB2YXIgQXJyYXlTZXQgPSBfX3dlYnBhY2tfcmVxdWlyZV9f
KDUpLkFycmF5U2V0OworKwkgIHZhciBNYXBwaW5nTGlzdCA9IF9fd2VicGFja19yZXF1aXJlX18o
NikuTWFwcGluZ0xpc3Q7CisrCisrCSAgLyoqCisrCSAgICogQW4gaW5zdGFuY2Ugb2YgdGhlIFNv
dXJjZU1hcEdlbmVyYXRvciByZXByZXNlbnRzIGEgc291cmNlIG1hcCB3aGljaCBpcworKwkgICAq
IGJlaW5nIGJ1aWx0IGluY3JlbWVudGFsbHkuIFlvdSBtYXkgcGFzcyBhbiBvYmplY3Qgd2l0aCB0
aGUgZm9sbG93aW5nCisrCSAgICogcHJvcGVydGllczoKKysJICAgKgorKwkgICAqICAgLSBmaWxl
OiBUaGUgZmlsZW5hbWUgb2YgdGhlIGdlbmVyYXRlZCBzb3VyY2UuCisrCSAgICogICAtIHNvdXJj
ZVJvb3Q6IEEgcm9vdCBmb3IgYWxsIHJlbGF0aXZlIFVSTHMgaW4gdGhpcyBzb3VyY2UgbWFwLgor
KwkgICAqLworKwkgIGZ1bmN0aW9uIFNvdXJjZU1hcEdlbmVyYXRvcihhQXJncykgeworKwkgICAg
aWYgKCFhQXJncykgeworKwkgICAgICBhQXJncyA9IHt9OworKwkgICAgfQorKwkgICAgdGhpcy5f
ZmlsZSA9IHV0aWwuZ2V0QXJnKGFBcmdzLCAnZmlsZScsIG51bGwpOworKwkgICAgdGhpcy5fc291
cmNlUm9vdCA9IHV0aWwuZ2V0QXJnKGFBcmdzLCAnc291cmNlUm9vdCcsIG51bGwpOworKwkgICAg
dGhpcy5fc2tpcFZhbGlkYXRpb24gPSB1dGlsLmdldEFyZyhhQXJncywgJ3NraXBWYWxpZGF0aW9u
JywgZmFsc2UpOworKwkgICAgdGhpcy5fc291cmNlcyA9IG5ldyBBcnJheVNldCgpOworKwkgICAg
dGhpcy5fbmFtZXMgPSBuZXcgQXJyYXlTZXQoKTsKKysJICAgIHRoaXMuX21hcHBpbmdzID0gbmV3
IE1hcHBpbmdMaXN0KCk7CisrCSAgICB0aGlzLl9zb3VyY2VzQ29udGVudHMgPSBudWxsOworKwkg
IH0KKysKKysJICBTb3VyY2VNYXBHZW5lcmF0b3IucHJvdG90eXBlLl92ZXJzaW9uID0gMzsKKysK
KysJICAvKioKKysJICAgKiBDcmVhdGVzIGEgbmV3IFNvdXJjZU1hcEdlbmVyYXRvciBiYXNlZCBv
biBhIFNvdXJjZU1hcENvbnN1bWVyCisrCSAgICoKKysJICAgKiBAcGFyYW0gYVNvdXJjZU1hcENv
bnN1bWVyIFRoZSBTb3VyY2VNYXAuCisrCSAgICovCisrCSAgU291cmNlTWFwR2VuZXJhdG9yLmZy
b21Tb3VyY2VNYXAgPQorKwkgICAgZnVuY3Rpb24gU291cmNlTWFwR2VuZXJhdG9yX2Zyb21Tb3Vy
Y2VNYXAoYVNvdXJjZU1hcENvbnN1bWVyKSB7CisrCSAgICAgIHZhciBzb3VyY2VSb290ID0gYVNv
dXJjZU1hcENvbnN1bWVyLnNvdXJjZVJvb3Q7CisrCSAgICAgIHZhciBnZW5lcmF0b3IgPSBuZXcg
U291cmNlTWFwR2VuZXJhdG9yKHsKKysJICAgICAgICBmaWxlOiBhU291cmNlTWFwQ29uc3VtZXIu
ZmlsZSwKKysJICAgICAgICBzb3VyY2VSb290OiBzb3VyY2VSb290CisrCSAgICAgIH0pOworKwkg
ICAgICBhU291cmNlTWFwQ29uc3VtZXIuZWFjaE1hcHBpbmcoZnVuY3Rpb24gKG1hcHBpbmcpIHsK
KysJICAgICAgICB2YXIgbmV3TWFwcGluZyA9IHsKKysJICAgICAgICAgIGdlbmVyYXRlZDogewor
KwkgICAgICAgICAgICBsaW5lOiBtYXBwaW5nLmdlbmVyYXRlZExpbmUsCisrCSAgICAgICAgICAg
IGNvbHVtbjogbWFwcGluZy5nZW5lcmF0ZWRDb2x1bW4KKysJICAgICAgICAgIH0KKysJICAgICAg
ICB9OworKworKwkgICAgICAgIGlmIChtYXBwaW5nLnNvdXJjZSAhPSBudWxsKSB7CisrCSAgICAg
ICAgICBuZXdNYXBwaW5nLnNvdXJjZSA9IG1hcHBpbmcuc291cmNlOworKwkgICAgICAgICAgaWYg
KHNvdXJjZVJvb3QgIT0gbnVsbCkgeworKwkgICAgICAgICAgICBuZXdNYXBwaW5nLnNvdXJjZSA9
IHV0aWwucmVsYXRpdmUoc291cmNlUm9vdCwgbmV3TWFwcGluZy5zb3VyY2UpOworKwkgICAgICAg
ICAgfQorKworKwkgICAgICAgICAgbmV3TWFwcGluZy5vcmlnaW5hbCA9IHsKKysJICAgICAgICAg
ICAgbGluZTogbWFwcGluZy5vcmlnaW5hbExpbmUsCisrCSAgICAgICAgICAgIGNvbHVtbjogbWFw
cGluZy5vcmlnaW5hbENvbHVtbgorKwkgICAgICAgICAgfTsKKysKKysJICAgICAgICAgIGlmICht
YXBwaW5nLm5hbWUgIT0gbnVsbCkgeworKwkgICAgICAgICAgICBuZXdNYXBwaW5nLm5hbWUgPSBt
YXBwaW5nLm5hbWU7CisrCSAgICAgICAgICB9CisrCSAgICAgICAgfQorKworKwkgICAgICAgIGdl
bmVyYXRvci5hZGRNYXBwaW5nKG5ld01hcHBpbmcpOworKwkgICAgICB9KTsKKysJICAgICAgYVNv
dXJjZU1hcENvbnN1bWVyLnNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbiAoc291cmNlRmlsZSkgewor
KwkgICAgICAgIHZhciBjb250ZW50ID0gYVNvdXJjZU1hcENvbnN1bWVyLnNvdXJjZUNvbnRlbnRG
b3Ioc291cmNlRmlsZSk7CisrCSAgICAgICAgaWYgKGNvbnRlbnQgIT0gbnVsbCkgeworKwkgICAg
ICAgICAgZ2VuZXJhdG9yLnNldFNvdXJjZUNvbnRlbnQoc291cmNlRmlsZSwgY29udGVudCk7Cisr
CSAgICAgICAgfQorKwkgICAgICB9KTsKKysJICAgICAgcmV0dXJuIGdlbmVyYXRvcjsKKysJICAg
IH07CisrCisrCSAgLyoqCisrCSAgICogQWRkIGEgc2luZ2xlIG1hcHBpbmcgZnJvbSBvcmlnaW5h
bCBzb3VyY2UgbGluZSBhbmQgY29sdW1uIHRvIHRoZSBnZW5lcmF0ZWQKKysJICAgKiBzb3VyY2Un
cyBsaW5lIGFuZCBjb2x1bW4gZm9yIHRoaXMgc291cmNlIG1hcCBiZWluZyBjcmVhdGVkLiBUaGUg
bWFwcGluZworKwkgICAqIG9iamVjdCBzaG91bGQgaGF2ZSB0aGUgZm9sbG93aW5nIHByb3BlcnRp
ZXM6CisrCSAgICoKKysJICAgKiAgIC0gZ2VuZXJhdGVkOiBBbiBvYmplY3Qgd2l0aCB0aGUgZ2Vu
ZXJhdGVkIGxpbmUgYW5kIGNvbHVtbiBwb3NpdGlvbnMuCisrCSAgICogICAtIG9yaWdpbmFsOiBB
biBvYmplY3Qgd2l0aCB0aGUgb3JpZ2luYWwgbGluZSBhbmQgY29sdW1uIHBvc2l0aW9ucy4KKysJ
ICAgKiAgIC0gc291cmNlOiBUaGUgb3JpZ2luYWwgc291cmNlIGZpbGUgKHJlbGF0aXZlIHRvIHRo
ZSBzb3VyY2VSb290KS4KKysJICAgKiAgIC0gbmFtZTogQW4gb3B0aW9uYWwgb3JpZ2luYWwgdG9r
ZW4gbmFtZSBmb3IgdGhpcyBtYXBwaW5nLgorKwkgICAqLworKwkgIFNvdXJjZU1hcEdlbmVyYXRv
ci5wcm90b3R5cGUuYWRkTWFwcGluZyA9CisrCSAgICBmdW5jdGlvbiBTb3VyY2VNYXBHZW5lcmF0
b3JfYWRkTWFwcGluZyhhQXJncykgeworKwkgICAgICB2YXIgZ2VuZXJhdGVkID0gdXRpbC5nZXRB
cmcoYUFyZ3MsICdnZW5lcmF0ZWQnKTsKKysJICAgICAgdmFyIG9yaWdpbmFsID0gdXRpbC5nZXRB
cmcoYUFyZ3MsICdvcmlnaW5hbCcsIG51bGwpOworKwkgICAgICB2YXIgc291cmNlID0gdXRpbC5n
ZXRBcmcoYUFyZ3MsICdzb3VyY2UnLCBudWxsKTsKKysJICAgICAgdmFyIG5hbWUgPSB1dGlsLmdl
dEFyZyhhQXJncywgJ25hbWUnLCBudWxsKTsKKysKKysJICAgICAgaWYgKCF0aGlzLl9za2lwVmFs
aWRhdGlvbikgeworKwkgICAgICAgIHRoaXMuX3ZhbGlkYXRlTWFwcGluZyhnZW5lcmF0ZWQsIG9y
aWdpbmFsLCBzb3VyY2UsIG5hbWUpOworKwkgICAgICB9CisrCisrCSAgICAgIGlmIChzb3VyY2Ug
IT0gbnVsbCAmJiAhdGhpcy5fc291cmNlcy5oYXMoc291cmNlKSkgeworKwkgICAgICAgIHRoaXMu
X3NvdXJjZXMuYWRkKHNvdXJjZSk7CisrCSAgICAgIH0KKysKKysJICAgICAgaWYgKG5hbWUgIT0g
bnVsbCAmJiAhdGhpcy5fbmFtZXMuaGFzKG5hbWUpKSB7CisrCSAgICAgICAgdGhpcy5fbmFtZXMu
YWRkKG5hbWUpOworKwkgICAgICB9CisrCisrCSAgICAgIHRoaXMuX21hcHBpbmdzLmFkZCh7Cisr
CSAgICAgICAgZ2VuZXJhdGVkTGluZTogZ2VuZXJhdGVkLmxpbmUsCisrCSAgICAgICAgZ2VuZXJh
dGVkQ29sdW1uOiBnZW5lcmF0ZWQuY29sdW1uLAorKwkgICAgICAgIG9yaWdpbmFsTGluZTogb3Jp
Z2luYWwgIT0gbnVsbCAmJiBvcmlnaW5hbC5saW5lLAorKwkgICAgICAgIG9yaWdpbmFsQ29sdW1u
OiBvcmlnaW5hbCAhPSBudWxsICYmIG9yaWdpbmFsLmNvbHVtbiwKKysJICAgICAgICBzb3VyY2U6
IHNvdXJjZSwKKysJICAgICAgICBuYW1lOiBuYW1lCisrCSAgICAgIH0pOworKwkgICAgfTsKKysK
KysJICAvKioKKysJICAgKiBTZXQgdGhlIHNvdXJjZSBjb250ZW50IGZvciBhIHNvdXJjZSBmaWxl
LgorKwkgICAqLworKwkgIFNvdXJjZU1hcEdlbmVyYXRvci5wcm90b3R5cGUuc2V0U291cmNlQ29u
dGVudCA9CisrCSAgICBmdW5jdGlvbiBTb3VyY2VNYXBHZW5lcmF0b3Jfc2V0U291cmNlQ29udGVu
dChhU291cmNlRmlsZSwgYVNvdXJjZUNvbnRlbnQpIHsKKysJICAgICAgdmFyIHNvdXJjZSA9IGFT
b3VyY2VGaWxlOworKwkgICAgICBpZiAodGhpcy5fc291cmNlUm9vdCAhPSBudWxsKSB7CisrCSAg
ICAgICAgc291cmNlID0gdXRpbC5yZWxhdGl2ZSh0aGlzLl9zb3VyY2VSb290LCBzb3VyY2UpOwor
KwkgICAgICB9CisrCisrCSAgICAgIGlmIChhU291cmNlQ29udGVudCAhPSBudWxsKSB7CisrCSAg
ICAgICAgLy8gQWRkIHRoZSBzb3VyY2UgY29udGVudCB0byB0aGUgX3NvdXJjZXNDb250ZW50cyBt
YXAuCisrCSAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IF9zb3VyY2VzQ29udGVudHMgbWFwIGlmIHRo
ZSBwcm9wZXJ0eSBpcyBudWxsLgorKwkgICAgICAgIGlmICghdGhpcy5fc291cmNlc0NvbnRlbnRz
KSB7CisrCSAgICAgICAgICB0aGlzLl9zb3VyY2VzQ29udGVudHMgPSB7fTsKKysJICAgICAgICB9
CisrCSAgICAgICAgdGhpcy5fc291cmNlc0NvbnRlbnRzW3V0aWwudG9TZXRTdHJpbmcoc291cmNl
KV0gPSBhU291cmNlQ29udGVudDsKKysJICAgICAgfSBlbHNlIGlmICh0aGlzLl9zb3VyY2VzQ29u
dGVudHMpIHsKKysJICAgICAgICAvLyBSZW1vdmUgdGhlIHNvdXJjZSBmaWxlIGZyb20gdGhlIF9z
b3VyY2VzQ29udGVudHMgbWFwLgorKwkgICAgICAgIC8vIElmIHRoZSBfc291cmNlc0NvbnRlbnRz
IG1hcCBpcyBlbXB0eSwgc2V0IHRoZSBwcm9wZXJ0eSB0byBudWxsLgorKwkgICAgICAgIGRlbGV0
ZSB0aGlzLl9zb3VyY2VzQ29udGVudHNbdXRpbC50b1NldFN0cmluZyhzb3VyY2UpXTsKKysJICAg
ICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5fc291cmNlc0NvbnRlbnRzKS5sZW5ndGggPT09IDAp
IHsKKysJICAgICAgICAgIHRoaXMuX3NvdXJjZXNDb250ZW50cyA9IG51bGw7CisrCSAgICAgICAg
fQorKwkgICAgICB9CisrCSAgICB9OworKworKwkgIC8qKgorKwkgICAqIEFwcGxpZXMgdGhlIG1h
cHBpbmdzIG9mIGEgc3ViLXNvdXJjZS1tYXAgZm9yIGEgc3BlY2lmaWMgc291cmNlIGZpbGUgdG8g
dGhlCisrCSAgICogc291cmNlIG1hcCBiZWluZyBnZW5lcmF0ZWQuIEVhY2ggbWFwcGluZyB0byB0
aGUgc3VwcGxpZWQgc291cmNlIGZpbGUgaXMKKysJICAgKiByZXdyaXR0ZW4gdXNpbmcgdGhlIHN1
cHBsaWVkIHNvdXJjZSBtYXAuIE5vdGU6IFRoZSByZXNvbHV0aW9uIGZvciB0aGUKKysJICAgKiBy
ZXN1bHRpbmcgbWFwcGluZ3MgaXMgdGhlIG1pbmltaXVtIG9mIHRoaXMgbWFwIGFuZCB0aGUgc3Vw
cGxpZWQgbWFwLgorKwkgICAqCisrCSAgICogQHBhcmFtIGFTb3VyY2VNYXBDb25zdW1lciBUaGUg
c291cmNlIG1hcCB0byBiZSBhcHBsaWVkLgorKwkgICAqIEBwYXJhbSBhU291cmNlRmlsZSBPcHRp
b25hbC4gVGhlIGZpbGVuYW1lIG9mIHRoZSBzb3VyY2UgZmlsZS4KKysJICAgKiAgICAgICAgSWYg
b21pdHRlZCwgU291cmNlTWFwQ29uc3VtZXIncyBmaWxlIHByb3BlcnR5IHdpbGwgYmUgdXNlZC4K
KysJICAgKiBAcGFyYW0gYVNvdXJjZU1hcFBhdGggT3B0aW9uYWwuIFRoZSBkaXJuYW1lIG9mIHRo
ZSBwYXRoIHRvIHRoZSBzb3VyY2UgbWFwCisrCSAgICogICAgICAgIHRvIGJlIGFwcGxpZWQuIElm
IHJlbGF0aXZlLCBpdCBpcyByZWxhdGl2ZSB0byB0aGUgU291cmNlTWFwQ29uc3VtZXIuCisrCSAg
ICogICAgICAgIFRoaXMgcGFyYW1ldGVyIGlzIG5lZWRlZCB3aGVuIHRoZSB0d28gc291cmNlIG1h
cHMgYXJlbid0IGluIHRoZSBzYW1lCisrCSAgICogICAgICAgIGRpcmVjdG9yeSwgYW5kIHRoZSBz
b3VyY2UgbWFwIHRvIGJlIGFwcGxpZWQgY29udGFpbnMgcmVsYXRpdmUgc291cmNlCisrCSAgICog
ICAgICAgIHBhdGhzLiBJZiBzbywgdGhvc2UgcmVsYXRpdmUgc291cmNlIHBhdGhzIG5lZWQgdG8g
YmUgcmV3cml0dGVuCisrCSAgICogICAgICAgIHJlbGF0aXZlIHRvIHRoZSBTb3VyY2VNYXBHZW5l
cmF0b3IuCisrCSAgICovCisrCSAgU291cmNlTWFwR2VuZXJhdG9yLnByb3RvdHlwZS5hcHBseVNv
dXJjZU1hcCA9CisrCSAgICBmdW5jdGlvbiBTb3VyY2VNYXBHZW5lcmF0b3JfYXBwbHlTb3VyY2VN
YXAoYVNvdXJjZU1hcENvbnN1bWVyLCBhU291cmNlRmlsZSwgYVNvdXJjZU1hcFBhdGgpIHsKKysJ
ICAgICAgdmFyIHNvdXJjZUZpbGUgPSBhU291cmNlRmlsZTsKKysJICAgICAgLy8gSWYgYVNvdXJj
ZUZpbGUgaXMgb21pdHRlZCwgd2Ugd2lsbCB1c2UgdGhlIGZpbGUgcHJvcGVydHkgb2YgdGhlIFNv
dXJjZU1hcAorKwkgICAgICBpZiAoYVNvdXJjZUZpbGUgPT0gbnVsbCkgeworKwkgICAgICAgIGlm
IChhU291cmNlTWFwQ29uc3VtZXIuZmlsZSA9PSBudWxsKSB7CisrCSAgICAgICAgICB0aHJvdyBu
ZXcgRXJyb3IoCisrCSAgICAgICAgICAgICdTb3VyY2VNYXBHZW5lcmF0b3IucHJvdG90eXBlLmFw
cGx5U291cmNlTWFwIHJlcXVpcmVzIGVpdGhlciBhbiBleHBsaWNpdCBzb3VyY2UgZmlsZSwgJyAr
CisrCSAgICAgICAgICAgICdvciB0aGUgc291cmNlIG1hcFwncyAiZmlsZSIgcHJvcGVydHkuIEJv
dGggd2VyZSBvbWl0dGVkLicKKysJICAgICAgICAgICk7CisrCSAgICAgICAgfQorKwkgICAgICAg
IHNvdXJjZUZpbGUgPSBhU291cmNlTWFwQ29uc3VtZXIuZmlsZTsKKysJICAgICAgfQorKwkgICAg
ICB2YXIgc291cmNlUm9vdCA9IHRoaXMuX3NvdXJjZVJvb3Q7CisrCSAgICAgIC8vIE1ha2UgInNv
dXJjZUZpbGUiIHJlbGF0aXZlIGlmIGFuIGFic29sdXRlIFVybCBpcyBwYXNzZWQuCisrCSAgICAg
IGlmIChzb3VyY2VSb290ICE9IG51bGwpIHsKKysJICAgICAgICBzb3VyY2VGaWxlID0gdXRpbC5y
ZWxhdGl2ZShzb3VyY2VSb290LCBzb3VyY2VGaWxlKTsKKysJICAgICAgfQorKwkgICAgICAvLyBB
cHBseWluZyB0aGUgU291cmNlTWFwIGNhbiBhZGQgYW5kIHJlbW92ZSBpdGVtcyBmcm9tIHRoZSBz
b3VyY2VzIGFuZAorKwkgICAgICAvLyB0aGUgbmFtZXMgYXJyYXkuCisrCSAgICAgIHZhciBuZXdT
b3VyY2VzID0gbmV3IEFycmF5U2V0KCk7CisrCSAgICAgIHZhciBuZXdOYW1lcyA9IG5ldyBBcnJh
eVNldCgpOworKworKwkgICAgICAvLyBGaW5kIG1hcHBpbmdzIGZvciB0aGUgInNvdXJjZUZpbGUi
CisrCSAgICAgIHRoaXMuX21hcHBpbmdzLnVuc29ydGVkRm9yRWFjaChmdW5jdGlvbiAobWFwcGlu
ZykgeworKwkgICAgICAgIGlmIChtYXBwaW5nLnNvdXJjZSA9PT0gc291cmNlRmlsZSAmJiBtYXBw
aW5nLm9yaWdpbmFsTGluZSAhPSBudWxsKSB7CisrCSAgICAgICAgICAvLyBDaGVjayBpZiBpdCBj
YW4gYmUgbWFwcGVkIGJ5IHRoZSBzb3VyY2UgbWFwLCB0aGVuIHVwZGF0ZSB0aGUgbWFwcGluZy4K
KysJICAgICAgICAgIHZhciBvcmlnaW5hbCA9IGFTb3VyY2VNYXBDb25zdW1lci5vcmlnaW5hbFBv
c2l0aW9uRm9yKHsKKysJICAgICAgICAgICAgbGluZTogbWFwcGluZy5vcmlnaW5hbExpbmUsCisr
CSAgICAgICAgICAgIGNvbHVtbjogbWFwcGluZy5vcmlnaW5hbENvbHVtbgorKwkgICAgICAgICAg
fSk7CisrCSAgICAgICAgICBpZiAob3JpZ2luYWwuc291cmNlICE9IG51bGwpIHsKKysJICAgICAg
ICAgICAgLy8gQ29weSBtYXBwaW5nCisrCSAgICAgICAgICAgIG1hcHBpbmcuc291cmNlID0gb3Jp
Z2luYWwuc291cmNlOworKwkgICAgICAgICAgICBpZiAoYVNvdXJjZU1hcFBhdGggIT0gbnVsbCkg
eworKwkgICAgICAgICAgICAgIG1hcHBpbmcuc291cmNlID0gdXRpbC5qb2luKGFTb3VyY2VNYXBQ
YXRoLCBtYXBwaW5nLnNvdXJjZSkKKysJICAgICAgICAgICAgfQorKwkgICAgICAgICAgICBpZiAo
c291cmNlUm9vdCAhPSBudWxsKSB7CisrCSAgICAgICAgICAgICAgbWFwcGluZy5zb3VyY2UgPSB1
dGlsLnJlbGF0aXZlKHNvdXJjZVJvb3QsIG1hcHBpbmcuc291cmNlKTsKKysJICAgICAgICAgICAg
fQorKwkgICAgICAgICAgICBtYXBwaW5nLm9yaWdpbmFsTGluZSA9IG9yaWdpbmFsLmxpbmU7Cisr
CSAgICAgICAgICAgIG1hcHBpbmcub3JpZ2luYWxDb2x1bW4gPSBvcmlnaW5hbC5jb2x1bW47Cisr
CSAgICAgICAgICAgIGlmIChvcmlnaW5hbC5uYW1lICE9IG51bGwpIHsKKysJICAgICAgICAgICAg
ICBtYXBwaW5nLm5hbWUgPSBvcmlnaW5hbC5uYW1lOworKwkgICAgICAgICAgICB9CisrCSAgICAg
ICAgICB9CisrCSAgICAgICAgfQorKworKwkgICAgICAgIHZhciBzb3VyY2UgPSBtYXBwaW5nLnNv
dXJjZTsKKysJICAgICAgICBpZiAoc291cmNlICE9IG51bGwgJiYgIW5ld1NvdXJjZXMuaGFzKHNv
dXJjZSkpIHsKKysJICAgICAgICAgIG5ld1NvdXJjZXMuYWRkKHNvdXJjZSk7CisrCSAgICAgICAg
fQorKworKwkgICAgICAgIHZhciBuYW1lID0gbWFwcGluZy5uYW1lOworKwkgICAgICAgIGlmIChu
YW1lICE9IG51bGwgJiYgIW5ld05hbWVzLmhhcyhuYW1lKSkgeworKwkgICAgICAgICAgbmV3TmFt
ZXMuYWRkKG5hbWUpOworKwkgICAgICAgIH0KKysKKysJICAgICAgfSwgdGhpcyk7CisrCSAgICAg
IHRoaXMuX3NvdXJjZXMgPSBuZXdTb3VyY2VzOworKwkgICAgICB0aGlzLl9uYW1lcyA9IG5ld05h
bWVzOworKworKwkgICAgICAvLyBDb3B5IHNvdXJjZXNDb250ZW50cyBvZiBhcHBsaWVkIG1hcC4K
KysJICAgICAgYVNvdXJjZU1hcENvbnN1bWVyLnNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbiAoc291
cmNlRmlsZSkgeworKwkgICAgICAgIHZhciBjb250ZW50ID0gYVNvdXJjZU1hcENvbnN1bWVyLnNv
dXJjZUNvbnRlbnRGb3Ioc291cmNlRmlsZSk7CisrCSAgICAgICAgaWYgKGNvbnRlbnQgIT0gbnVs
bCkgeworKwkgICAgICAgICAgaWYgKGFTb3VyY2VNYXBQYXRoICE9IG51bGwpIHsKKysJICAgICAg
ICAgICAgc291cmNlRmlsZSA9IHV0aWwuam9pbihhU291cmNlTWFwUGF0aCwgc291cmNlRmlsZSk7
CisrCSAgICAgICAgICB9CisrCSAgICAgICAgICBpZiAoc291cmNlUm9vdCAhPSBudWxsKSB7Cisr
CSAgICAgICAgICAgIHNvdXJjZUZpbGUgPSB1dGlsLnJlbGF0aXZlKHNvdXJjZVJvb3QsIHNvdXJj
ZUZpbGUpOworKwkgICAgICAgICAgfQorKwkgICAgICAgICAgdGhpcy5zZXRTb3VyY2VDb250ZW50
KHNvdXJjZUZpbGUsIGNvbnRlbnQpOworKwkgICAgICAgIH0KKysJICAgICAgfSwgdGhpcyk7Cisr
CSAgICB9OworKworKwkgIC8qKgorKwkgICAqIEEgbWFwcGluZyBjYW4gaGF2ZSBvbmUgb2YgdGhl
IHRocmVlIGxldmVscyBvZiBkYXRhOgorKwkgICAqCisrCSAgICogICAxLiBKdXN0IHRoZSBnZW5l
cmF0ZWQgcG9zaXRpb24uCisrCSAgICogICAyLiBUaGUgR2VuZXJhdGVkIHBvc2l0aW9uLCBvcmln
aW5hbCBwb3NpdGlvbiwgYW5kIG9yaWdpbmFsIHNvdXJjZS4KKysJICAgKiAgIDMuIEdlbmVyYXRl
ZCBhbmQgb3JpZ2luYWwgcG9zaXRpb24sIG9yaWdpbmFsIHNvdXJjZSwgYXMgd2VsbCBhcyBhIG5h
bWUKKysJICAgKiAgICAgIHRva2VuLgorKwkgICAqCisrCSAgICogVG8gbWFpbnRhaW4gY29uc2lz
dGVuY3ksIHdlIHZhbGlkYXRlIHRoYXQgYW55IG5ldyBtYXBwaW5nIGJlaW5nIGFkZGVkIGZhbGxz
CisrCSAgICogaW4gdG8gb25lIG9mIHRoZXNlIGNhdGVnb3JpZXMuCisrCSAgICovCisrCSAgU291
cmNlTWFwR2VuZXJhdG9yLnByb3RvdHlwZS5fdmFsaWRhdGVNYXBwaW5nID0KKysJICAgIGZ1bmN0
aW9uIFNvdXJjZU1hcEdlbmVyYXRvcl92YWxpZGF0ZU1hcHBpbmcoYUdlbmVyYXRlZCwgYU9yaWdp
bmFsLCBhU291cmNlLAorKwkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBhTmFtZSkgeworKwkgICAgICBpZiAoYUdlbmVyYXRlZCAmJiAnbGluZScgaW4gYUdl
bmVyYXRlZCAmJiAnY29sdW1uJyBpbiBhR2VuZXJhdGVkCisrCSAgICAgICAgICAmJiBhR2VuZXJh
dGVkLmxpbmUgPiAwICYmIGFHZW5lcmF0ZWQuY29sdW1uID49IDAKKysJICAgICAgICAgICYmICFh
T3JpZ2luYWwgJiYgIWFTb3VyY2UgJiYgIWFOYW1lKSB7CisrCSAgICAgICAgLy8gQ2FzZSAxLgor
KwkgICAgICAgIHJldHVybjsKKysJICAgICAgfQorKwkgICAgICBlbHNlIGlmIChhR2VuZXJhdGVk
ICYmICdsaW5lJyBpbiBhR2VuZXJhdGVkICYmICdjb2x1bW4nIGluIGFHZW5lcmF0ZWQKKysJICAg
ICAgICAgICAgICAgJiYgYU9yaWdpbmFsICYmICdsaW5lJyBpbiBhT3JpZ2luYWwgJiYgJ2NvbHVt
bicgaW4gYU9yaWdpbmFsCisrCSAgICAgICAgICAgICAgICYmIGFHZW5lcmF0ZWQubGluZSA+IDAg
JiYgYUdlbmVyYXRlZC5jb2x1bW4gPj0gMAorKwkgICAgICAgICAgICAgICAmJiBhT3JpZ2luYWwu
bGluZSA+IDAgJiYgYU9yaWdpbmFsLmNvbHVtbiA+PSAwCisrCSAgICAgICAgICAgICAgICYmIGFT
b3VyY2UpIHsKKysJICAgICAgICAvLyBDYXNlcyAyIGFuZCAzLgorKwkgICAgICAgIHJldHVybjsK
KysJICAgICAgfQorKwkgICAgICBlbHNlIHsKKysJICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0lu
dmFsaWQgbWFwcGluZzogJyArIEpTT04uc3RyaW5naWZ5KHsKKysJICAgICAgICAgIGdlbmVyYXRl
ZDogYUdlbmVyYXRlZCwKKysJICAgICAgICAgIHNvdXJjZTogYVNvdXJjZSwKKysJICAgICAgICAg
IG9yaWdpbmFsOiBhT3JpZ2luYWwsCisrCSAgICAgICAgICBuYW1lOiBhTmFtZQorKwkgICAgICAg
IH0pKTsKKysJICAgICAgfQorKwkgICAgfTsKKysKKysJICAvKioKKysJICAgKiBTZXJpYWxpemUg
dGhlIGFjY3VtdWxhdGVkIG1hcHBpbmdzIGluIHRvIHRoZSBzdHJlYW0gb2YgYmFzZSA2NCBWTFFz
CisrCSAgICogc3BlY2lmaWVkIGJ5IHRoZSBzb3VyY2UgbWFwIGZvcm1hdC4KKysJICAgKi8KKysJ
ICBTb3VyY2VNYXBHZW5lcmF0b3IucHJvdG90eXBlLl9zZXJpYWxpemVNYXBwaW5ncyA9CisrCSAg
ICBmdW5jdGlvbiBTb3VyY2VNYXBHZW5lcmF0b3Jfc2VyaWFsaXplTWFwcGluZ3MoKSB7CisrCSAg
ICAgIHZhciBwcmV2aW91c0dlbmVyYXRlZENvbHVtbiA9IDA7CisrCSAgICAgIHZhciBwcmV2aW91
c0dlbmVyYXRlZExpbmUgPSAxOworKwkgICAgICB2YXIgcHJldmlvdXNPcmlnaW5hbENvbHVtbiA9
IDA7CisrCSAgICAgIHZhciBwcmV2aW91c09yaWdpbmFsTGluZSA9IDA7CisrCSAgICAgIHZhciBw
cmV2aW91c05hbWUgPSAwOworKwkgICAgICB2YXIgcHJldmlvdXNTb3VyY2UgPSAwOworKwkgICAg
ICB2YXIgcmVzdWx0ID0gJyc7CisrCSAgICAgIHZhciBtYXBwaW5nOworKwkgICAgICB2YXIgbmFt
ZUlkeDsKKysJICAgICAgdmFyIHNvdXJjZUlkeDsKKysKKysJICAgICAgdmFyIG1hcHBpbmdzID0g
dGhpcy5fbWFwcGluZ3MudG9BcnJheSgpOworKwkgICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0g
bWFwcGluZ3MubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKKysJICAgICAgICBtYXBwaW5nID0gbWFw
cGluZ3NbaV07CisrCisrCSAgICAgICAgaWYgKG1hcHBpbmcuZ2VuZXJhdGVkTGluZSAhPT0gcHJl
dmlvdXNHZW5lcmF0ZWRMaW5lKSB7CisrCSAgICAgICAgICBwcmV2aW91c0dlbmVyYXRlZENvbHVt
biA9IDA7CisrCSAgICAgICAgICB3aGlsZSAobWFwcGluZy5nZW5lcmF0ZWRMaW5lICE9PSBwcmV2
aW91c0dlbmVyYXRlZExpbmUpIHsKKysJICAgICAgICAgICAgcmVzdWx0ICs9ICc7JzsKKysJICAg
ICAgICAgICAgcHJldmlvdXNHZW5lcmF0ZWRMaW5lKys7CisrCSAgICAgICAgICB9CisrCSAgICAg
ICAgfQorKwkgICAgICAgIGVsc2UgeworKwkgICAgICAgICAgaWYgKGkgPiAwKSB7CisrCSAgICAg
ICAgICAgIGlmICghdXRpbC5jb21wYXJlQnlHZW5lcmF0ZWRQb3NpdGlvbnNJbmZsYXRlZChtYXBw
aW5nLCBtYXBwaW5nc1tpIC0gMV0pKSB7CisrCSAgICAgICAgICAgICAgY29udGludWU7CisrCSAg
ICAgICAgICAgIH0KKysJICAgICAgICAgICAgcmVzdWx0ICs9ICcsJzsKKysJICAgICAgICAgIH0K
KysJICAgICAgICB9CisrCisrCSAgICAgICAgcmVzdWx0ICs9IGJhc2U2NFZMUS5lbmNvZGUobWFw
cGluZy5nZW5lcmF0ZWRDb2x1bW4KKysJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAtIHByZXZpb3VzR2VuZXJhdGVkQ29sdW1uKTsKKysJICAgICAgICBwcmV2aW91c0dlbmVyYXRl
ZENvbHVtbiA9IG1hcHBpbmcuZ2VuZXJhdGVkQ29sdW1uOworKworKwkgICAgICAgIGlmIChtYXBw
aW5nLnNvdXJjZSAhPSBudWxsKSB7CisrCSAgICAgICAgICBzb3VyY2VJZHggPSB0aGlzLl9zb3Vy
Y2VzLmluZGV4T2YobWFwcGluZy5zb3VyY2UpOworKwkgICAgICAgICAgcmVzdWx0ICs9IGJhc2U2
NFZMUS5lbmNvZGUoc291cmNlSWR4IC0gcHJldmlvdXNTb3VyY2UpOworKwkgICAgICAgICAgcHJl
dmlvdXNTb3VyY2UgPSBzb3VyY2VJZHg7CisrCisrCSAgICAgICAgICAvLyBsaW5lcyBhcmUgc3Rv
cmVkIDAtYmFzZWQgaW4gU291cmNlTWFwIHNwZWMgdmVyc2lvbiAzCisrCSAgICAgICAgICByZXN1
bHQgKz0gYmFzZTY0VkxRLmVuY29kZShtYXBwaW5nLm9yaWdpbmFsTGluZSAtIDEKKysJICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gcHJldmlvdXNPcmlnaW5hbExpbmUpOwor
KwkgICAgICAgICAgcHJldmlvdXNPcmlnaW5hbExpbmUgPSBtYXBwaW5nLm9yaWdpbmFsTGluZSAt
IDE7CisrCisrCSAgICAgICAgICByZXN1bHQgKz0gYmFzZTY0VkxRLmVuY29kZShtYXBwaW5nLm9y
aWdpbmFsQ29sdW1uCisrCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtIHBy
ZXZpb3VzT3JpZ2luYWxDb2x1bW4pOworKwkgICAgICAgICAgcHJldmlvdXNPcmlnaW5hbENvbHVt
biA9IG1hcHBpbmcub3JpZ2luYWxDb2x1bW47CisrCisrCSAgICAgICAgICBpZiAobWFwcGluZy5u
YW1lICE9IG51bGwpIHsKKysJICAgICAgICAgICAgbmFtZUlkeCA9IHRoaXMuX25hbWVzLmluZGV4
T2YobWFwcGluZy5uYW1lKTsKKysJICAgICAgICAgICAgcmVzdWx0ICs9IGJhc2U2NFZMUS5lbmNv
ZGUobmFtZUlkeCAtIHByZXZpb3VzTmFtZSk7CisrCSAgICAgICAgICAgIHByZXZpb3VzTmFtZSA9
IG5hbWVJZHg7CisrCSAgICAgICAgICB9CisrCSAgICAgICAgfQorKwkgICAgICB9CisrCisrCSAg
ICAgIHJldHVybiByZXN1bHQ7CisrCSAgICB9OworKworKwkgIFNvdXJjZU1hcEdlbmVyYXRvci5w
cm90b3R5cGUuX2dlbmVyYXRlU291cmNlc0NvbnRlbnQgPQorKwkgICAgZnVuY3Rpb24gU291cmNl
TWFwR2VuZXJhdG9yX2dlbmVyYXRlU291cmNlc0NvbnRlbnQoYVNvdXJjZXMsIGFTb3VyY2VSb290
KSB7CisrCSAgICAgIHJldHVybiBhU291cmNlcy5tYXAoZnVuY3Rpb24gKHNvdXJjZSkgeworKwkg
ICAgICAgIGlmICghdGhpcy5fc291cmNlc0NvbnRlbnRzKSB7CisrCSAgICAgICAgICByZXR1cm4g
bnVsbDsKKysJICAgICAgICB9CisrCSAgICAgICAgaWYgKGFTb3VyY2VSb290ICE9IG51bGwpIHsK
KysJICAgICAgICAgIHNvdXJjZSA9IHV0aWwucmVsYXRpdmUoYVNvdXJjZVJvb3QsIHNvdXJjZSk7
CisrCSAgICAgICAgfQorKwkgICAgICAgIHZhciBrZXkgPSB1dGlsLnRvU2V0U3RyaW5nKHNvdXJj
ZSk7CisrCSAgICAgICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2Fs
bCh0aGlzLl9zb3VyY2VzQ29udGVudHMsCisrCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBrZXkpCisrCSAgICAgICAgICA/IHRoaXMuX3NvdXJjZXND
b250ZW50c1trZXldCisrCSAgICAgICAgICA6IG51bGw7CisrCSAgICAgIH0sIHRoaXMpOworKwkg
ICAgfTsKKysKKysJICAvKioKKysJICAgKiBFeHRlcm5hbGl6ZSB0aGUgc291cmNlIG1hcC4KKysJ
ICAgKi8KKysJICBTb3VyY2VNYXBHZW5lcmF0b3IucHJvdG90eXBlLnRvSlNPTiA9CisrCSAgICBm
dW5jdGlvbiBTb3VyY2VNYXBHZW5lcmF0b3JfdG9KU09OKCkgeworKwkgICAgICB2YXIgbWFwID0g
eworKwkgICAgICAgIHZlcnNpb246IHRoaXMuX3ZlcnNpb24sCisrCSAgICAgICAgc291cmNlczog
dGhpcy5fc291cmNlcy50b0FycmF5KCksCisrCSAgICAgICAgbmFtZXM6IHRoaXMuX25hbWVzLnRv
QXJyYXkoKSwKKysJICAgICAgICBtYXBwaW5nczogdGhpcy5fc2VyaWFsaXplTWFwcGluZ3MoKQor
KwkgICAgICB9OworKwkgICAgICBpZiAodGhpcy5fZmlsZSAhPSBudWxsKSB7CisrCSAgICAgICAg
bWFwLmZpbGUgPSB0aGlzLl9maWxlOworKwkgICAgICB9CisrCSAgICAgIGlmICh0aGlzLl9zb3Vy
Y2VSb290ICE9IG51bGwpIHsKKysJICAgICAgICBtYXAuc291cmNlUm9vdCA9IHRoaXMuX3NvdXJj
ZVJvb3Q7CisrCSAgICAgIH0KKysJICAgICAgaWYgKHRoaXMuX3NvdXJjZXNDb250ZW50cykgewor
KwkgICAgICAgIG1hcC5zb3VyY2VzQ29udGVudCA9IHRoaXMuX2dlbmVyYXRlU291cmNlc0NvbnRl
bnQobWFwLnNvdXJjZXMsIG1hcC5zb3VyY2VSb290KTsKKysJICAgICAgfQorKworKwkgICAgICBy
ZXR1cm4gbWFwOworKwkgICAgfTsKKysKKysJICAvKioKKysJICAgKiBSZW5kZXIgdGhlIHNvdXJj
ZSBtYXAgYmVpbmcgZ2VuZXJhdGVkIHRvIGEgc3RyaW5nLgorKwkgICAqLworKwkgIFNvdXJjZU1h
cEdlbmVyYXRvci5wcm90b3R5cGUudG9TdHJpbmcgPQorKwkgICAgZnVuY3Rpb24gU291cmNlTWFw
R2VuZXJhdG9yX3RvU3RyaW5nKCkgeworKwkgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodGhp
cy50b0pTT04oKSk7CisrCSAgICB9OworKworKwkgIGV4cG9ydHMuU291cmNlTWFwR2VuZXJhdG9y
ID0gU291cmNlTWFwR2VuZXJhdG9yOworKwl9CisrCisrCisrLyoqKi8gfSwKKysvKiAyICovCisr
LyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7Cisr
CisrCS8qIC0qLSBNb2RlOiBqczsganMtaW5kZW50LWxldmVsOiAyOyAtKi0gKi8KKysJLyoKKysJ
ICogQ29weXJpZ2h0IDIwMTEgTW96aWxsYSBGb3VuZGF0aW9uIGFuZCBjb250cmlidXRvcnMKKysJ
ICogTGljZW5zZWQgdW5kZXIgdGhlIE5ldyBCU0QgbGljZW5zZS4gU2VlIExJQ0VOU0Ugb3I6Cisr
CSAqIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9CU0QtMy1DbGF1c2UKKysJICoKKysJ
ICogQmFzZWQgb24gdGhlIEJhc2UgNjQgVkxRIGltcGxlbWVudGF0aW9uIGluIENsb3N1cmUgQ29t
cGlsZXI6CisrCSAqIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2xvc3VyZS1jb21waWxlci9z
b3VyY2UvYnJvd3NlL3RydW5rL3NyYy9jb20vZ29vZ2xlL2RlYnVnZ2luZy9zb3VyY2VtYXAvQmFz
ZTY0VkxRLmphdmEKKysJICoKKysJICogQ29weXJpZ2h0IDIwMTEgVGhlIENsb3N1cmUgQ29tcGls
ZXIgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KKysJICogUmVkaXN0cmlidXRpb24gYW5k
IHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0CisrCSAqIG1v
ZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29u
ZGl0aW9ucyBhcmUKKysJICogbWV0OgorKwkgKgorKwkgKiAgKiBSZWRpc3RyaWJ1dGlvbnMgb2Yg
c291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodAorKwkgKiAgICBub3Rp
Y2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIu
CisrCSAqICAqIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0
aGUgYWJvdmUKKysJICogICAgY29weXJpZ2h0IG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlv
bnMgYW5kIHRoZSBmb2xsb3dpbmcKKysJICogICAgZGlzY2xhaW1lciBpbiB0aGUgZG9jdW1lbnRh
dGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkCisrCSAqICAgIHdpdGggdGhlIGRp
c3RyaWJ1dGlvbi4KKysJICogICogTmVpdGhlciB0aGUgbmFtZSBvZiBHb29nbGUgSW5jLiBub3Ig
dGhlIG5hbWVzIG9mIGl0cworKwkgKiAgICBjb250cmlidXRvcnMgbWF5IGJlIHVzZWQgdG8gZW5k
b3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzIGRlcml2ZWQKKysJICogICAgZnJvbSB0aGlzIHNvZnR3
YXJlIHdpdGhvdXQgc3BlY2lmaWMgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLgorKwkgKgorKwkg
KiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQg
Q09OVFJJQlVUT1JTCisrCSAqICJBUyBJUyIgQU5EIEFOWSBFWFBSRVNTIE9SIElNUExJRUQgV0FS
UkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UCisrCSAqIExJTUlURUQgVE8sIFRIRSBJTVBMSUVE
IFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUgorKwkgKiBBIFBB
UlRJQ1VMQVIgUFVSUE9TRSBBUkUgRElTQ0xBSU1FRC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIENP
UFlSSUdIVAorKwkgKiBPV05FUiBPUiBDT05UUklCVVRPUlMgQkUgTElBQkxFIEZPUiBBTlkgRElS
RUNULCBJTkRJUkVDVCwgSU5DSURFTlRBTCwKKysJICogU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBD
T05TRVFVRU5USUFMIERBTUFHRVMgKElOQ0xVRElORywgQlVUIE5PVAorKwkgKiBMSU1JVEVEIFRP
LCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVT
RSwKKysJICogREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dF
VkVSIENBVVNFRCBBTkQgT04gQU5ZCisrCSAqIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIg
SU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SIFRPUlQKKysJICogKElOQ0xVRElORyBO
RUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNF
CisrCSAqIE9GIFRISVMgU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJ
VFkgT0YgU1VDSCBEQU1BR0UuCisrCSAqLworKwl7CisrCSAgdmFyIGJhc2U2NCA9IF9fd2VicGFj
a19yZXF1aXJlX18oMyk7CisrCisrCSAgLy8gQSBzaW5nbGUgYmFzZSA2NCBkaWdpdCBjYW4gY29u
dGFpbiA2IGJpdHMgb2YgZGF0YS4gRm9yIHRoZSBiYXNlIDY0IHZhcmlhYmxlCisrCSAgLy8gbGVu
Z3RoIHF1YW50aXRpZXMgd2UgdXNlIGluIHRoZSBzb3VyY2UgbWFwIHNwZWMsIHRoZSBmaXJzdCBi
aXQgaXMgdGhlIHNpZ24sCisrCSAgLy8gdGhlIG5leHQgZm91ciBiaXRzIGFyZSB0aGUgYWN0dWFs
IHZhbHVlLCBhbmQgdGhlIDZ0aCBiaXQgaXMgdGhlCisrCSAgLy8gY29udGludWF0aW9uIGJpdC4g
VGhlIGNvbnRpbnVhdGlvbiBiaXQgdGVsbHMgdXMgd2hldGhlciB0aGVyZSBhcmUgbW9yZQorKwkg
IC8vIGRpZ2l0cyBpbiB0aGlzIHZhbHVlIGZvbGxvd2luZyB0aGlzIGRpZ2l0LgorKwkgIC8vCisr
CSAgLy8gICBDb250aW51YXRpb24KKysJICAvLyAgIHwgICAgU2lnbgorKwkgIC8vICAgfCAgICB8
CisrCSAgLy8gICBWICAgIFYKKysJICAvLyAgIDEwMTAxMQorKworKwkgIHZhciBWTFFfQkFTRV9T
SElGVCA9IDU7CisrCisrCSAgLy8gYmluYXJ5OiAxMDAwMDAKKysJICB2YXIgVkxRX0JBU0UgPSAx
IDw8IFZMUV9CQVNFX1NISUZUOworKworKwkgIC8vIGJpbmFyeTogMDExMTExCisrCSAgdmFyIFZM
UV9CQVNFX01BU0sgPSBWTFFfQkFTRSAtIDE7CisrCisrCSAgLy8gYmluYXJ5OiAxMDAwMDAKKysJ
ICB2YXIgVkxRX0NPTlRJTlVBVElPTl9CSVQgPSBWTFFfQkFTRTsKKysKKysJICAvKioKKysJICAg
KiBDb252ZXJ0cyBmcm9tIGEgdHdvLWNvbXBsZW1lbnQgdmFsdWUgdG8gYSB2YWx1ZSB3aGVyZSB0
aGUgc2lnbiBiaXQgaXMKKysJICAgKiBwbGFjZWQgaW4gdGhlIGxlYXN0IHNpZ25pZmljYW50IGJp
dC4gIEZvciBleGFtcGxlLCBhcyBkZWNpbWFsczoKKysJICAgKiAgIDEgYmVjb21lcyAyICgxMCBi
aW5hcnkpLCAtMSBiZWNvbWVzIDMgKDExIGJpbmFyeSkKKysJICAgKiAgIDIgYmVjb21lcyA0ICgx
MDAgYmluYXJ5KSwgLTIgYmVjb21lcyA1ICgxMDEgYmluYXJ5KQorKwkgICAqLworKwkgIGZ1bmN0
aW9uIHRvVkxRU2lnbmVkKGFWYWx1ZSkgeworKwkgICAgcmV0dXJuIGFWYWx1ZSA8IDAKKysJICAg
ICAgPyAoKC1hVmFsdWUpIDw8IDEpICsgMQorKwkgICAgICA6IChhVmFsdWUgPDwgMSkgKyAwOwor
KwkgIH0KKysKKysJICAvKioKKysJICAgKiBDb252ZXJ0cyB0byBhIHR3by1jb21wbGVtZW50IHZh
bHVlIGZyb20gYSB2YWx1ZSB3aGVyZSB0aGUgc2lnbiBiaXQgaXMKKysJICAgKiBwbGFjZWQgaW4g
dGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdC4gIEZvciBleGFtcGxlLCBhcyBkZWNpbWFsczoKKysJ
ICAgKiAgIDIgKDEwIGJpbmFyeSkgYmVjb21lcyAxLCAzICgxMSBiaW5hcnkpIGJlY29tZXMgLTEK
KysJICAgKiAgIDQgKDEwMCBiaW5hcnkpIGJlY29tZXMgMiwgNSAoMTAxIGJpbmFyeSkgYmVjb21l
cyAtMgorKwkgICAqLworKwkgIGZ1bmN0aW9uIGZyb21WTFFTaWduZWQoYVZhbHVlKSB7CisrCSAg
ICB2YXIgaXNOZWdhdGl2ZSA9IChhVmFsdWUgJiAxKSA9PT0gMTsKKysJICAgIHZhciBzaGlmdGVk
ID0gYVZhbHVlID4+IDE7CisrCSAgICByZXR1cm4gaXNOZWdhdGl2ZQorKwkgICAgICA/IC1zaGlm
dGVkCisrCSAgICAgIDogc2hpZnRlZDsKKysJICB9CisrCisrCSAgLyoqCisrCSAgICogUmV0dXJu
cyB0aGUgYmFzZSA2NCBWTFEgZW5jb2RlZCB2YWx1ZS4KKysJICAgKi8KKysJICBleHBvcnRzLmVu
Y29kZSA9IGZ1bmN0aW9uIGJhc2U2NFZMUV9lbmNvZGUoYVZhbHVlKSB7CisrCSAgICB2YXIgZW5j
b2RlZCA9ICIiOworKwkgICAgdmFyIGRpZ2l0OworKworKwkgICAgdmFyIHZscSA9IHRvVkxRU2ln
bmVkKGFWYWx1ZSk7CisrCisrCSAgICBkbyB7CisrCSAgICAgIGRpZ2l0ID0gdmxxICYgVkxRX0JB
U0VfTUFTSzsKKysJICAgICAgdmxxID4+Pj0gVkxRX0JBU0VfU0hJRlQ7CisrCSAgICAgIGlmICh2
bHEgPiAwKSB7CisrCSAgICAgICAgLy8gVGhlcmUgYXJlIHN0aWxsIG1vcmUgZGlnaXRzIGluIHRo
aXMgdmFsdWUsIHNvIHdlIG11c3QgbWFrZSBzdXJlIHRoZQorKwkgICAgICAgIC8vIGNvbnRpbnVh
dGlvbiBiaXQgaXMgbWFya2VkLgorKwkgICAgICAgIGRpZ2l0IHw9IFZMUV9DT05USU5VQVRJT05f
QklUOworKwkgICAgICB9CisrCSAgICAgIGVuY29kZWQgKz0gYmFzZTY0LmVuY29kZShkaWdpdCk7
CisrCSAgICB9IHdoaWxlICh2bHEgPiAwKTsKKysKKysJICAgIHJldHVybiBlbmNvZGVkOworKwkg
IH07CisrCisrCSAgLyoqCisrCSAgICogRGVjb2RlcyB0aGUgbmV4dCBiYXNlIDY0IFZMUSB2YWx1
ZSBmcm9tIHRoZSBnaXZlbiBzdHJpbmcgYW5kIHJldHVybnMgdGhlCisrCSAgICogdmFsdWUgYW5k
IHRoZSByZXN0IG9mIHRoZSBzdHJpbmcgdmlhIHRoZSBvdXQgcGFyYW1ldGVyLgorKwkgICAqLwor
KwkgIGV4cG9ydHMuZGVjb2RlID0gZnVuY3Rpb24gYmFzZTY0VkxRX2RlY29kZShhU3RyLCBhSW5k
ZXgsIGFPdXRQYXJhbSkgeworKwkgICAgdmFyIHN0ckxlbiA9IGFTdHIubGVuZ3RoOworKwkgICAg
dmFyIHJlc3VsdCA9IDA7CisrCSAgICB2YXIgc2hpZnQgPSAwOworKwkgICAgdmFyIGNvbnRpbnVh
dGlvbiwgZGlnaXQ7CisrCisrCSAgICBkbyB7CisrCSAgICAgIGlmIChhSW5kZXggPj0gc3RyTGVu
KSB7CisrCSAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJFeHBlY3RlZCBtb3JlIGRpZ2l0cyBpbiBi
YXNlIDY0IFZMUSB2YWx1ZS4iKTsKKysJICAgICAgfQorKworKwkgICAgICBkaWdpdCA9IGJhc2U2
NC5kZWNvZGUoYVN0ci5jaGFyQ29kZUF0KGFJbmRleCsrKSk7CisrCSAgICAgIGlmIChkaWdpdCA9
PT0gLTEpIHsKKysJICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkludmFsaWQgYmFzZTY0IGRpZ2l0
OiAiICsgYVN0ci5jaGFyQXQoYUluZGV4IC0gMSkpOworKwkgICAgICB9CisrCisrCSAgICAgIGNv
bnRpbnVhdGlvbiA9ICEhKGRpZ2l0ICYgVkxRX0NPTlRJTlVBVElPTl9CSVQpOworKwkgICAgICBk
aWdpdCAmPSBWTFFfQkFTRV9NQVNLOworKwkgICAgICByZXN1bHQgPSByZXN1bHQgKyAoZGlnaXQg
PDwgc2hpZnQpOworKwkgICAgICBzaGlmdCArPSBWTFFfQkFTRV9TSElGVDsKKysJICAgIH0gd2hp
bGUgKGNvbnRpbnVhdGlvbik7CisrCisrCSAgICBhT3V0UGFyYW0udmFsdWUgPSBmcm9tVkxRU2ln
bmVkKHJlc3VsdCk7CisrCSAgICBhT3V0UGFyYW0ucmVzdCA9IGFJbmRleDsKKysJICB9OworKwl9
CisrCisrCisrLyoqKi8gfSwKKysvKiAzICovCisrLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBv
cnRzKSB7CisrCisrCS8qIC0qLSBNb2RlOiBqczsganMtaW5kZW50LWxldmVsOiAyOyAtKi0gKi8K
KysJLyoKKysJICogQ29weXJpZ2h0IDIwMTEgTW96aWxsYSBGb3VuZGF0aW9uIGFuZCBjb250cmli
dXRvcnMKKysJICogTGljZW5zZWQgdW5kZXIgdGhlIE5ldyBCU0QgbGljZW5zZS4gU2VlIExJQ0VO
U0Ugb3I6CisrCSAqIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9CU0QtMy1DbGF1c2UK
KysJICovCisrCXsKKysJICB2YXIgaW50VG9DaGFyTWFwID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNU
VVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky8nLnNwbGl0KCcnKTsK
KysKKysJICAvKioKKysJICAgKiBFbmNvZGUgYW4gaW50ZWdlciBpbiB0aGUgcmFuZ2Ugb2YgMCB0
byA2MyB0byBhIHNpbmdsZSBiYXNlIDY0IGRpZ2l0LgorKwkgICAqLworKwkgIGV4cG9ydHMuZW5j
b2RlID0gZnVuY3Rpb24gKG51bWJlcikgeworKwkgICAgaWYgKDAgPD0gbnVtYmVyICYmIG51bWJl
ciA8IGludFRvQ2hhck1hcC5sZW5ndGgpIHsKKysJICAgICAgcmV0dXJuIGludFRvQ2hhck1hcFtu
dW1iZXJdOworKwkgICAgfQorKwkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiTXVzdCBiZSBiZXR3
ZWVuIDAgYW5kIDYzOiAiICsgbnVtYmVyKTsKKysJICB9OworKworKwkgIC8qKgorKwkgICAqIERl
Y29kZSBhIHNpbmdsZSBiYXNlIDY0IGNoYXJhY3RlciBjb2RlIGRpZ2l0IHRvIGFuIGludGVnZXIu
IFJldHVybnMgLTEgb24KKysJICAgKiBmYWlsdXJlLgorKwkgICAqLworKwkgIGV4cG9ydHMuZGVj
b2RlID0gZnVuY3Rpb24gKGNoYXJDb2RlKSB7CisrCSAgICB2YXIgYmlnQSA9IDY1OyAgICAgLy8g
J0EnCisrCSAgICB2YXIgYmlnWiA9IDkwOyAgICAgLy8gJ1onCisrCisrCSAgICB2YXIgbGl0dGxl
QSA9IDk3OyAgLy8gJ2EnCisrCSAgICB2YXIgbGl0dGxlWiA9IDEyMjsgLy8gJ3onCisrCisrCSAg
ICB2YXIgemVybyA9IDQ4OyAgICAgLy8gJzAnCisrCSAgICB2YXIgbmluZSA9IDU3OyAgICAgLy8g
JzknCisrCisrCSAgICB2YXIgcGx1cyA9IDQzOyAgICAgLy8gJysnCisrCSAgICB2YXIgc2xhc2gg
PSA0NzsgICAgLy8gJy8nCisrCisrCSAgICB2YXIgbGl0dGxlT2Zmc2V0ID0gMjY7CisrCSAgICB2
YXIgbnVtYmVyT2Zmc2V0ID0gNTI7CisrCisrCSAgICAvLyAwIC0gMjU6IEFCQ0RFRkdISUpLTE1O
T1BRUlNUVVZXWFlaCisrCSAgICBpZiAoYmlnQSA8PSBjaGFyQ29kZSAmJiBjaGFyQ29kZSA8PSBi
aWdaKSB7CisrCSAgICAgIHJldHVybiAoY2hhckNvZGUgLSBiaWdBKTsKKysJICAgIH0KKysKKysJ
ICAgIC8vIDI2IC0gNTE6IGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6CisrCSAgICBpZiAobGl0
dGxlQSA8PSBjaGFyQ29kZSAmJiBjaGFyQ29kZSA8PSBsaXR0bGVaKSB7CisrCSAgICAgIHJldHVy
biAoY2hhckNvZGUgLSBsaXR0bGVBICsgbGl0dGxlT2Zmc2V0KTsKKysJICAgIH0KKysKKysJICAg
IC8vIDUyIC0gNjE6IDAxMjM0NTY3ODkKKysJICAgIGlmICh6ZXJvIDw9IGNoYXJDb2RlICYmIGNo
YXJDb2RlIDw9IG5pbmUpIHsKKysJICAgICAgcmV0dXJuIChjaGFyQ29kZSAtIHplcm8gKyBudW1i
ZXJPZmZzZXQpOworKwkgICAgfQorKworKwkgICAgLy8gNjI6ICsKKysJICAgIGlmIChjaGFyQ29k
ZSA9PSBwbHVzKSB7CisrCSAgICAgIHJldHVybiA2MjsKKysJICAgIH0KKysKKysJICAgIC8vIDYz
OiAvCisrCSAgICBpZiAoY2hhckNvZGUgPT0gc2xhc2gpIHsKKysJICAgICAgcmV0dXJuIDYzOwor
KwkgICAgfQorKworKwkgICAgLy8gSW52YWxpZCBiYXNlNjQgZGlnaXQuCisrCSAgICByZXR1cm4g
LTE7CisrCSAgfTsKKysJfQorKworKworKy8qKiovIH0sCisrLyogNCAqLworKy8qKiovIGZ1bmN0
aW9uKG1vZHVsZSwgZXhwb3J0cykgeworKworKwkvKiAtKi0gTW9kZToganM7IGpzLWluZGVudC1s
ZXZlbDogMjsgLSotICovCisrCS8qCisrCSAqIENvcHlyaWdodCAyMDExIE1vemlsbGEgRm91bmRh
dGlvbiBhbmQgY29udHJpYnV0b3JzCisrCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBOZXcgQlNEIGxp
Y2Vuc2UuIFNlZSBMSUNFTlNFIG9yOgorKwkgKiBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5z
ZXMvQlNELTMtQ2xhdXNlCisrCSAqLworKwl7CisrCSAgLyoqCisrCSAgICogVGhpcyBpcyBhIGhl
bHBlciBmdW5jdGlvbiBmb3IgZ2V0dGluZyB2YWx1ZXMgZnJvbSBwYXJhbWV0ZXIvb3B0aW9ucwor
KwkgICAqIG9iamVjdHMuCisrCSAgICoKKysJICAgKiBAcGFyYW0gYXJncyBUaGUgb2JqZWN0IHdl
IGFyZSBleHRyYWN0aW5nIHZhbHVlcyBmcm9tCisrCSAgICogQHBhcmFtIG5hbWUgVGhlIG5hbWUg
b2YgdGhlIHByb3BlcnR5IHdlIGFyZSBnZXR0aW5nLgorKwkgICAqIEBwYXJhbSBkZWZhdWx0VmFs
dWUgQW4gb3B0aW9uYWwgdmFsdWUgdG8gcmV0dXJuIGlmIHRoZSBwcm9wZXJ0eSBpcyBtaXNzaW5n
CisrCSAgICogZnJvbSB0aGUgb2JqZWN0LiBJZiB0aGlzIGlzIG5vdCBzcGVjaWZpZWQgYW5kIHRo
ZSBwcm9wZXJ0eSBpcyBtaXNzaW5nLCBhbgorKwkgICAqIGVycm9yIHdpbGwgYmUgdGhyb3duLgor
KwkgICAqLworKwkgIGZ1bmN0aW9uIGdldEFyZyhhQXJncywgYU5hbWUsIGFEZWZhdWx0VmFsdWUp
IHsKKysJICAgIGlmIChhTmFtZSBpbiBhQXJncykgeworKwkgICAgICByZXR1cm4gYUFyZ3NbYU5h
bWVdOworKwkgICAgfSBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAzKSB7CisrCSAgICAg
IHJldHVybiBhRGVmYXVsdFZhbHVlOworKwkgICAgfSBlbHNlIHsKKysJICAgICAgdGhyb3cgbmV3
IEVycm9yKCciJyArIGFOYW1lICsgJyIgaXMgYSByZXF1aXJlZCBhcmd1bWVudC4nKTsKKysJICAg
IH0KKysJICB9CisrCSAgZXhwb3J0cy5nZXRBcmcgPSBnZXRBcmc7CisrCisrCSAgdmFyIHVybFJl
Z2V4cCA9IC9eKD86KFtcdytcLS5dKyk6KT9cL1wvKD86KFx3KzpcdyspQCk/KFtcdy5dKikoPzo6
KFxkKykpPyhcUyopJC87CisrCSAgdmFyIGRhdGFVcmxSZWdleHAgPSAvXmRhdGE6LitcLC4rJC87
CisrCisrCSAgZnVuY3Rpb24gdXJsUGFyc2UoYVVybCkgeworKwkgICAgdmFyIG1hdGNoID0gYVVy
bC5tYXRjaCh1cmxSZWdleHApOworKwkgICAgaWYgKCFtYXRjaCkgeworKwkgICAgICByZXR1cm4g
bnVsbDsKKysJICAgIH0KKysJICAgIHJldHVybiB7CisrCSAgICAgIHNjaGVtZTogbWF0Y2hbMV0s
CisrCSAgICAgIGF1dGg6IG1hdGNoWzJdLAorKwkgICAgICBob3N0OiBtYXRjaFszXSwKKysJICAg
ICAgcG9ydDogbWF0Y2hbNF0sCisrCSAgICAgIHBhdGg6IG1hdGNoWzVdCisrCSAgICB9OworKwkg
IH0KKysJICBleHBvcnRzLnVybFBhcnNlID0gdXJsUGFyc2U7CisrCisrCSAgZnVuY3Rpb24gdXJs
R2VuZXJhdGUoYVBhcnNlZFVybCkgeworKwkgICAgdmFyIHVybCA9ICcnOworKwkgICAgaWYgKGFQ
YXJzZWRVcmwuc2NoZW1lKSB7CisrCSAgICAgIHVybCArPSBhUGFyc2VkVXJsLnNjaGVtZSArICc6
JzsKKysJICAgIH0KKysJICAgIHVybCArPSAnLy8nOworKwkgICAgaWYgKGFQYXJzZWRVcmwuYXV0
aCkgeworKwkgICAgICB1cmwgKz0gYVBhcnNlZFVybC5hdXRoICsgJ0AnOworKwkgICAgfQorKwkg
ICAgaWYgKGFQYXJzZWRVcmwuaG9zdCkgeworKwkgICAgICB1cmwgKz0gYVBhcnNlZFVybC5ob3N0
OworKwkgICAgfQorKwkgICAgaWYgKGFQYXJzZWRVcmwucG9ydCkgeworKwkgICAgICB1cmwgKz0g
IjoiICsgYVBhcnNlZFVybC5wb3J0CisrCSAgICB9CisrCSAgICBpZiAoYVBhcnNlZFVybC5wYXRo
KSB7CisrCSAgICAgIHVybCArPSBhUGFyc2VkVXJsLnBhdGg7CisrCSAgICB9CisrCSAgICByZXR1
cm4gdXJsOworKwkgIH0KKysJICBleHBvcnRzLnVybEdlbmVyYXRlID0gdXJsR2VuZXJhdGU7Cisr
CisrCSAgLyoqCisrCSAgICogTm9ybWFsaXplcyBhIHBhdGgsIG9yIHRoZSBwYXRoIHBvcnRpb24g
b2YgYSBVUkw6CisrCSAgICoKKysJICAgKiAtIFJlcGxhY2VzIGNvbnNlcXV0aXZlIHNsYXNoZXMg
d2l0aCBvbmUgc2xhc2guCisrCSAgICogLSBSZW1vdmVzIHVubmVjZXNzYXJ5ICcuJyBwYXJ0cy4K
KysJICAgKiAtIFJlbW92ZXMgdW5uZWNlc3NhcnkgJzxkaXI+Ly4uJyBwYXJ0cy4KKysJICAgKgor
KwkgICAqIEJhc2VkIG9uIGNvZGUgaW4gdGhlIE5vZGUuanMgJ3BhdGgnIGNvcmUgbW9kdWxlLgor
KwkgICAqCisrCSAgICogQHBhcmFtIGFQYXRoIFRoZSBwYXRoIG9yIHVybCB0byBub3JtYWxpemUu
CisrCSAgICovCisrCSAgZnVuY3Rpb24gbm9ybWFsaXplKGFQYXRoKSB7CisrCSAgICB2YXIgcGF0
aCA9IGFQYXRoOworKwkgICAgdmFyIHVybCA9IHVybFBhcnNlKGFQYXRoKTsKKysJICAgIGlmICh1
cmwpIHsKKysJICAgICAgaWYgKCF1cmwucGF0aCkgeworKwkgICAgICAgIHJldHVybiBhUGF0aDsK
KysJICAgICAgfQorKwkgICAgICBwYXRoID0gdXJsLnBhdGg7CisrCSAgICB9CisrCSAgICB2YXIg
aXNBYnNvbHV0ZSA9IGV4cG9ydHMuaXNBYnNvbHV0ZShwYXRoKTsKKysKKysJICAgIHZhciBwYXJ0
cyA9IHBhdGguc3BsaXQoL1wvKy8pOworKwkgICAgZm9yICh2YXIgcGFydCwgdXAgPSAwLCBpID0g
cGFydHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKKysJICAgICAgcGFydCA9IHBhcnRzW2ld
OworKwkgICAgICBpZiAocGFydCA9PT0gJy4nKSB7CisrCSAgICAgICAgcGFydHMuc3BsaWNlKGks
IDEpOworKwkgICAgICB9IGVsc2UgaWYgKHBhcnQgPT09ICcuLicpIHsKKysJICAgICAgICB1cCsr
OworKwkgICAgICB9IGVsc2UgaWYgKHVwID4gMCkgeworKwkgICAgICAgIGlmIChwYXJ0ID09PSAn
JykgeworKwkgICAgICAgICAgLy8gVGhlIGZpcnN0IHBhcnQgaXMgYmxhbmsgaWYgdGhlIHBhdGgg
aXMgYWJzb2x1dGUuIFRyeWluZyB0byBnbworKwkgICAgICAgICAgLy8gYWJvdmUgdGhlIHJvb3Qg
aXMgYSBuby1vcC4gVGhlcmVmb3JlIHdlIGNhbiByZW1vdmUgYWxsICcuLicgcGFydHMKKysJICAg
ICAgICAgIC8vIGRpcmVjdGx5IGFmdGVyIHRoZSByb290LgorKwkgICAgICAgICAgcGFydHMuc3Bs
aWNlKGkgKyAxLCB1cCk7CisrCSAgICAgICAgICB1cCA9IDA7CisrCSAgICAgICAgfSBlbHNlIHsK
KysJICAgICAgICAgIHBhcnRzLnNwbGljZShpLCAyKTsKKysJICAgICAgICAgIHVwLS07CisrCSAg
ICAgICAgfQorKwkgICAgICB9CisrCSAgICB9CisrCSAgICBwYXRoID0gcGFydHMuam9pbignLycp
OworKworKwkgICAgaWYgKHBhdGggPT09ICcnKSB7CisrCSAgICAgIHBhdGggPSBpc0Fic29sdXRl
ID8gJy8nIDogJy4nOworKwkgICAgfQorKworKwkgICAgaWYgKHVybCkgeworKwkgICAgICB1cmwu
cGF0aCA9IHBhdGg7CisrCSAgICAgIHJldHVybiB1cmxHZW5lcmF0ZSh1cmwpOworKwkgICAgfQor
KwkgICAgcmV0dXJuIHBhdGg7CisrCSAgfQorKwkgIGV4cG9ydHMubm9ybWFsaXplID0gbm9ybWFs
aXplOworKworKwkgIC8qKgorKwkgICAqIEpvaW5zIHR3byBwYXRocy9VUkxzLgorKwkgICAqCisr
CSAgICogQHBhcmFtIGFSb290IFRoZSByb290IHBhdGggb3IgVVJMLgorKwkgICAqIEBwYXJhbSBh
UGF0aCBUaGUgcGF0aCBvciBVUkwgdG8gYmUgam9pbmVkIHdpdGggdGhlIHJvb3QuCisrCSAgICoK
KysJICAgKiAtIElmIGFQYXRoIGlzIGEgVVJMIG9yIGEgZGF0YSBVUkksIGFQYXRoIGlzIHJldHVy
bmVkLCB1bmxlc3MgYVBhdGggaXMgYQorKwkgICAqICAgc2NoZW1lLXJlbGF0aXZlIFVSTDogVGhl
biB0aGUgc2NoZW1lIG9mIGFSb290LCBpZiBhbnksIGlzIHByZXBlbmRlZAorKwkgICAqICAgZmly
c3QuCisrCSAgICogLSBPdGhlcndpc2UgYVBhdGggaXMgYSBwYXRoLiBJZiBhUm9vdCBpcyBhIFVS
TCwgdGhlbiBpdHMgcGF0aCBwb3J0aW9uCisrCSAgICogICBpcyB1cGRhdGVkIHdpdGggdGhlIHJl
c3VsdCBhbmQgYVJvb3QgaXMgcmV0dXJuZWQuIE90aGVyd2lzZSB0aGUgcmVzdWx0CisrCSAgICog
ICBpcyByZXR1cm5lZC4KKysJICAgKiAgIC0gSWYgYVBhdGggaXMgYWJzb2x1dGUsIHRoZSByZXN1
bHQgaXMgYVBhdGguCisrCSAgICogICAtIE90aGVyd2lzZSB0aGUgdHdvIHBhdGhzIGFyZSBqb2lu
ZWQgd2l0aCBhIHNsYXNoLgorKwkgICAqIC0gSm9pbmluZyBmb3IgZXhhbXBsZSAnaHR0cDovLycg
YW5kICd3d3cuZXhhbXBsZS5jb20nIGlzIGFsc28gc3VwcG9ydGVkLgorKwkgICAqLworKwkgIGZ1
bmN0aW9uIGpvaW4oYVJvb3QsIGFQYXRoKSB7CisrCSAgICBpZiAoYVJvb3QgPT09ICIiKSB7Cisr
CSAgICAgIGFSb290ID0gIi4iOworKwkgICAgfQorKwkgICAgaWYgKGFQYXRoID09PSAiIikgewor
KwkgICAgICBhUGF0aCA9ICIuIjsKKysJICAgIH0KKysJICAgIHZhciBhUGF0aFVybCA9IHVybFBh
cnNlKGFQYXRoKTsKKysJICAgIHZhciBhUm9vdFVybCA9IHVybFBhcnNlKGFSb290KTsKKysJICAg
IGlmIChhUm9vdFVybCkgeworKwkgICAgICBhUm9vdCA9IGFSb290VXJsLnBhdGggfHwgJy8nOwor
KwkgICAgfQorKworKwkgICAgLy8gYGpvaW4oZm9vLCAnLy93d3cuZXhhbXBsZS5vcmcnKWAKKysJ
ICAgIGlmIChhUGF0aFVybCAmJiAhYVBhdGhVcmwuc2NoZW1lKSB7CisrCSAgICAgIGlmIChhUm9v
dFVybCkgeworKwkgICAgICAgIGFQYXRoVXJsLnNjaGVtZSA9IGFSb290VXJsLnNjaGVtZTsKKysJ
ICAgICAgfQorKwkgICAgICByZXR1cm4gdXJsR2VuZXJhdGUoYVBhdGhVcmwpOworKwkgICAgfQor
KworKwkgICAgaWYgKGFQYXRoVXJsIHx8IGFQYXRoLm1hdGNoKGRhdGFVcmxSZWdleHApKSB7Cisr
CSAgICAgIHJldHVybiBhUGF0aDsKKysJICAgIH0KKysKKysJICAgIC8vIGBqb2luKCdodHRwOi8v
JywgJ3d3dy5leGFtcGxlLmNvbScpYAorKwkgICAgaWYgKGFSb290VXJsICYmICFhUm9vdFVybC5o
b3N0ICYmICFhUm9vdFVybC5wYXRoKSB7CisrCSAgICAgIGFSb290VXJsLmhvc3QgPSBhUGF0aDsK
KysJICAgICAgcmV0dXJuIHVybEdlbmVyYXRlKGFSb290VXJsKTsKKysJICAgIH0KKysKKysJICAg
IHZhciBqb2luZWQgPSBhUGF0aC5jaGFyQXQoMCkgPT09ICcvJworKwkgICAgICA/IGFQYXRoCisr
CSAgICAgIDogbm9ybWFsaXplKGFSb290LnJlcGxhY2UoL1wvKyQvLCAnJykgKyAnLycgKyBhUGF0
aCk7CisrCisrCSAgICBpZiAoYVJvb3RVcmwpIHsKKysJICAgICAgYVJvb3RVcmwucGF0aCA9IGpv
aW5lZDsKKysJICAgICAgcmV0dXJuIHVybEdlbmVyYXRlKGFSb290VXJsKTsKKysJICAgIH0KKysJ
ICAgIHJldHVybiBqb2luZWQ7CisrCSAgfQorKwkgIGV4cG9ydHMuam9pbiA9IGpvaW47CisrCisr
CSAgZXhwb3J0cy5pc0Fic29sdXRlID0gZnVuY3Rpb24gKGFQYXRoKSB7CisrCSAgICByZXR1cm4g
YVBhdGguY2hhckF0KDApID09PSAnLycgfHwgISFhUGF0aC5tYXRjaCh1cmxSZWdleHApOworKwkg
IH07CisrCisrCSAgLyoqCisrCSAgICogTWFrZSBhIHBhdGggcmVsYXRpdmUgdG8gYSBVUkwgb3Ig
YW5vdGhlciBwYXRoLgorKwkgICAqCisrCSAgICogQHBhcmFtIGFSb290IFRoZSByb290IHBhdGgg
b3IgVVJMLgorKwkgICAqIEBwYXJhbSBhUGF0aCBUaGUgcGF0aCBvciBVUkwgdG8gYmUgbWFkZSBy
ZWxhdGl2ZSB0byBhUm9vdC4KKysJICAgKi8KKysJICBmdW5jdGlvbiByZWxhdGl2ZShhUm9vdCwg
YVBhdGgpIHsKKysJICAgIGlmIChhUm9vdCA9PT0gIiIpIHsKKysJICAgICAgYVJvb3QgPSAiLiI7
CisrCSAgICB9CisrCisrCSAgICBhUm9vdCA9IGFSb290LnJlcGxhY2UoL1wvJC8sICcnKTsKKysK
KysJICAgIC8vIEl0IGlzIHBvc3NpYmxlIGZvciB0aGUgcGF0aCB0byBiZSBhYm92ZSB0aGUgcm9v
dC4gSW4gdGhpcyBjYXNlLCBzaW1wbHkKKysJICAgIC8vIGNoZWNraW5nIHdoZXRoZXIgdGhlIHJv
b3QgaXMgYSBwcmVmaXggb2YgdGhlIHBhdGggd29uJ3Qgd29yay4gSW5zdGVhZCwgd2UKKysJICAg
IC8vIG5lZWQgdG8gcmVtb3ZlIGNvbXBvbmVudHMgZnJvbSB0aGUgcm9vdCBvbmUgYnkgb25lLCB1
bnRpbCBlaXRoZXIgd2UgZmluZAorKwkgICAgLy8gYSBwcmVmaXggdGhhdCBmaXRzLCBvciB3ZSBy
dW4gb3V0IG9mIGNvbXBvbmVudHMgdG8gcmVtb3ZlLgorKwkgICAgdmFyIGxldmVsID0gMDsKKysJ
ICAgIHdoaWxlIChhUGF0aC5pbmRleE9mKGFSb290ICsgJy8nKSAhPT0gMCkgeworKwkgICAgICB2
YXIgaW5kZXggPSBhUm9vdC5sYXN0SW5kZXhPZigiLyIpOworKwkgICAgICBpZiAoaW5kZXggPCAw
KSB7CisrCSAgICAgICAgcmV0dXJuIGFQYXRoOworKwkgICAgICB9CisrCisrCSAgICAgIC8vIElm
IHRoZSBvbmx5IHBhcnQgb2YgdGhlIHJvb3QgdGhhdCBpcyBsZWZ0IGlzIHRoZSBzY2hlbWUgKGku
ZS4gaHR0cDovLywKKysJICAgICAgLy8gZmlsZTovLy8sIGV0Yy4pLCBvbmUgb3IgbW9yZSBzbGFz
aGVzICgvKSwgb3Igc2ltcGx5IG5vdGhpbmcgYXQgYWxsLCB3ZQorKwkgICAgICAvLyBoYXZlIGV4
aGF1c3RlZCBhbGwgY29tcG9uZW50cywgc28gdGhlIHBhdGggaXMgbm90IHJlbGF0aXZlIHRvIHRo
ZSByb290LgorKwkgICAgICBhUm9vdCA9IGFSb290LnNsaWNlKDAsIGluZGV4KTsKKysJICAgICAg
aWYgKGFSb290Lm1hdGNoKC9eKFteXC9dKzpcLyk/XC8qJC8pKSB7CisrCSAgICAgICAgcmV0dXJu
IGFQYXRoOworKwkgICAgICB9CisrCisrCSAgICAgICsrbGV2ZWw7CisrCSAgICB9CisrCisrCSAg
ICAvLyBNYWtlIHN1cmUgd2UgYWRkIGEgIi4uLyIgZm9yIGVhY2ggY29tcG9uZW50IHdlIHJlbW92
ZWQgZnJvbSB0aGUgcm9vdC4KKysJICAgIHJldHVybiBBcnJheShsZXZlbCArIDEpLmpvaW4oIi4u
LyIpICsgYVBhdGguc3Vic3RyKGFSb290Lmxlbmd0aCArIDEpOworKwkgIH0KKysJICBleHBvcnRz
LnJlbGF0aXZlID0gcmVsYXRpdmU7CisrCisrCSAgLyoqCisrCSAgICogQmVjYXVzZSBiZWhhdmlv
ciBnb2VzIHdhY2t5IHdoZW4geW91IHNldCBgX19wcm90b19fYCBvbiBvYmplY3RzLCB3ZQorKwkg
ICAqIGhhdmUgdG8gcHJlZml4IGFsbCB0aGUgc3RyaW5ncyBpbiBvdXIgc2V0IHdpdGggYW4gYXJi
aXRyYXJ5IGNoYXJhY3Rlci4KKysJICAgKgorKwkgICAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20v
bW96aWxsYS9zb3VyY2UtbWFwL3B1bGwvMzEgYW5kCisrCSAgICogaHR0cHM6Ly9naXRodWIuY29t
L21vemlsbGEvc291cmNlLW1hcC9pc3N1ZXMvMzAKKysJICAgKgorKwkgICAqIEBwYXJhbSBTdHJp
bmcgYVN0cgorKwkgICAqLworKwkgIGZ1bmN0aW9uIHRvU2V0U3RyaW5nKGFTdHIpIHsKKysJICAg
IHJldHVybiAnJCcgKyBhU3RyOworKwkgIH0KKysJICBleHBvcnRzLnRvU2V0U3RyaW5nID0gdG9T
ZXRTdHJpbmc7CisrCisrCSAgZnVuY3Rpb24gZnJvbVNldFN0cmluZyhhU3RyKSB7CisrCSAgICBy
ZXR1cm4gYVN0ci5zdWJzdHIoMSk7CisrCSAgfQorKwkgIGV4cG9ydHMuZnJvbVNldFN0cmluZyA9
IGZyb21TZXRTdHJpbmc7CisrCisrCSAgLyoqCisrCSAgICogQ29tcGFyYXRvciBiZXR3ZWVuIHR3
byBtYXBwaW5ncyB3aGVyZSB0aGUgb3JpZ2luYWwgcG9zaXRpb25zIGFyZSBjb21wYXJlZC4KKysJ
ICAgKgorKwkgICAqIE9wdGlvbmFsbHkgcGFzcyBpbiBgdHJ1ZWAgYXMgYG9ubHlDb21wYXJlR2Vu
ZXJhdGVkYCB0byBjb25zaWRlciB0d28KKysJICAgKiBtYXBwaW5ncyB3aXRoIHRoZSBzYW1lIG9y
aWdpbmFsIHNvdXJjZS9saW5lL2NvbHVtbiwgYnV0IGRpZmZlcmVudCBnZW5lcmF0ZWQKKysJICAg
KiBsaW5lIGFuZCBjb2x1bW4gdGhlIHNhbWUuIFVzZWZ1bCB3aGVuIHNlYXJjaGluZyBmb3IgYSBt
YXBwaW5nIHdpdGggYQorKwkgICAqIHN0dWJiZWQgb3V0IG1hcHBpbmcuCisrCSAgICovCisrCSAg
ZnVuY3Rpb24gY29tcGFyZUJ5T3JpZ2luYWxQb3NpdGlvbnMobWFwcGluZ0EsIG1hcHBpbmdCLCBv
bmx5Q29tcGFyZU9yaWdpbmFsKSB7CisrCSAgICB2YXIgY21wID0gbWFwcGluZ0Euc291cmNlIC0g
bWFwcGluZ0Iuc291cmNlOworKwkgICAgaWYgKGNtcCAhPT0gMCkgeworKwkgICAgICByZXR1cm4g
Y21wOworKwkgICAgfQorKworKwkgICAgY21wID0gbWFwcGluZ0Eub3JpZ2luYWxMaW5lIC0gbWFw
cGluZ0Iub3JpZ2luYWxMaW5lOworKwkgICAgaWYgKGNtcCAhPT0gMCkgeworKwkgICAgICByZXR1
cm4gY21wOworKwkgICAgfQorKworKwkgICAgY21wID0gbWFwcGluZ0Eub3JpZ2luYWxDb2x1bW4g
LSBtYXBwaW5nQi5vcmlnaW5hbENvbHVtbjsKKysJICAgIGlmIChjbXAgIT09IDAgfHwgb25seUNv
bXBhcmVPcmlnaW5hbCkgeworKwkgICAgICByZXR1cm4gY21wOworKwkgICAgfQorKworKwkgICAg
Y21wID0gbWFwcGluZ0EuZ2VuZXJhdGVkQ29sdW1uIC0gbWFwcGluZ0IuZ2VuZXJhdGVkQ29sdW1u
OworKwkgICAgaWYgKGNtcCAhPT0gMCkgeworKwkgICAgICByZXR1cm4gY21wOworKwkgICAgfQor
KworKwkgICAgY21wID0gbWFwcGluZ0EuZ2VuZXJhdGVkTGluZSAtIG1hcHBpbmdCLmdlbmVyYXRl
ZExpbmU7CisrCSAgICBpZiAoY21wICE9PSAwKSB7CisrCSAgICAgIHJldHVybiBjbXA7CisrCSAg
ICB9CisrCisrCSAgICByZXR1cm4gbWFwcGluZ0EubmFtZSAtIG1hcHBpbmdCLm5hbWU7CisrCSAg
fQorKwkgIGV4cG9ydHMuY29tcGFyZUJ5T3JpZ2luYWxQb3NpdGlvbnMgPSBjb21wYXJlQnlPcmln
aW5hbFBvc2l0aW9uczsKKysKKysJICAvKioKKysJICAgKiBDb21wYXJhdG9yIGJldHdlZW4gdHdv
IG1hcHBpbmdzIHdpdGggZGVmbGF0ZWQgc291cmNlIGFuZCBuYW1lIGluZGljZXMgd2hlcmUKKysJ
ICAgKiB0aGUgZ2VuZXJhdGVkIHBvc2l0aW9ucyBhcmUgY29tcGFyZWQuCisrCSAgICoKKysJICAg
KiBPcHRpb25hbGx5IHBhc3MgaW4gYHRydWVgIGFzIGBvbmx5Q29tcGFyZUdlbmVyYXRlZGAgdG8g
Y29uc2lkZXIgdHdvCisrCSAgICogbWFwcGluZ3Mgd2l0aCB0aGUgc2FtZSBnZW5lcmF0ZWQgbGlu
ZSBhbmQgY29sdW1uLCBidXQgZGlmZmVyZW50CisrCSAgICogc291cmNlL25hbWUvb3JpZ2luYWwg
bGluZSBhbmQgY29sdW1uIHRoZSBzYW1lLiBVc2VmdWwgd2hlbiBzZWFyY2hpbmcgZm9yIGEKKysJ
ICAgKiBtYXBwaW5nIHdpdGggYSBzdHViYmVkIG91dCBtYXBwaW5nLgorKwkgICAqLworKwkgIGZ1
bmN0aW9uIGNvbXBhcmVCeUdlbmVyYXRlZFBvc2l0aW9uc0RlZmxhdGVkKG1hcHBpbmdBLCBtYXBw
aW5nQiwgb25seUNvbXBhcmVHZW5lcmF0ZWQpIHsKKysJICAgIHZhciBjbXAgPSBtYXBwaW5nQS5n
ZW5lcmF0ZWRMaW5lIC0gbWFwcGluZ0IuZ2VuZXJhdGVkTGluZTsKKysJICAgIGlmIChjbXAgIT09
IDApIHsKKysJICAgICAgcmV0dXJuIGNtcDsKKysJICAgIH0KKysKKysJICAgIGNtcCA9IG1hcHBp
bmdBLmdlbmVyYXRlZENvbHVtbiAtIG1hcHBpbmdCLmdlbmVyYXRlZENvbHVtbjsKKysJICAgIGlm
IChjbXAgIT09IDAgfHwgb25seUNvbXBhcmVHZW5lcmF0ZWQpIHsKKysJICAgICAgcmV0dXJuIGNt
cDsKKysJICAgIH0KKysKKysJICAgIGNtcCA9IG1hcHBpbmdBLnNvdXJjZSAtIG1hcHBpbmdCLnNv
dXJjZTsKKysJICAgIGlmIChjbXAgIT09IDApIHsKKysJICAgICAgcmV0dXJuIGNtcDsKKysJICAg
IH0KKysKKysJICAgIGNtcCA9IG1hcHBpbmdBLm9yaWdpbmFsTGluZSAtIG1hcHBpbmdCLm9yaWdp
bmFsTGluZTsKKysJICAgIGlmIChjbXAgIT09IDApIHsKKysJICAgICAgcmV0dXJuIGNtcDsKKysJ
ICAgIH0KKysKKysJICAgIGNtcCA9IG1hcHBpbmdBLm9yaWdpbmFsQ29sdW1uIC0gbWFwcGluZ0Iu
b3JpZ2luYWxDb2x1bW47CisrCSAgICBpZiAoY21wICE9PSAwKSB7CisrCSAgICAgIHJldHVybiBj
bXA7CisrCSAgICB9CisrCisrCSAgICByZXR1cm4gbWFwcGluZ0EubmFtZSAtIG1hcHBpbmdCLm5h
bWU7CisrCSAgfQorKwkgIGV4cG9ydHMuY29tcGFyZUJ5R2VuZXJhdGVkUG9zaXRpb25zRGVmbGF0
ZWQgPSBjb21wYXJlQnlHZW5lcmF0ZWRQb3NpdGlvbnNEZWZsYXRlZDsKKysKKysJICBmdW5jdGlv
biBzdHJjbXAoYVN0cjEsIGFTdHIyKSB7CisrCSAgICBpZiAoYVN0cjEgPT09IGFTdHIyKSB7Cisr
CSAgICAgIHJldHVybiAwOworKwkgICAgfQorKworKwkgICAgaWYgKGFTdHIxID4gYVN0cjIpIHsK
KysJICAgICAgcmV0dXJuIDE7CisrCSAgICB9CisrCisrCSAgICByZXR1cm4gLTE7CisrCSAgfQor
KworKwkgIC8qKgorKwkgICAqIENvbXBhcmF0b3IgYmV0d2VlbiB0d28gbWFwcGluZ3Mgd2l0aCBp
bmZsYXRlZCBzb3VyY2UgYW5kIG5hbWUgc3RyaW5ncyB3aGVyZQorKwkgICAqIHRoZSBnZW5lcmF0
ZWQgcG9zaXRpb25zIGFyZSBjb21wYXJlZC4KKysJICAgKi8KKysJICBmdW5jdGlvbiBjb21wYXJl
QnlHZW5lcmF0ZWRQb3NpdGlvbnNJbmZsYXRlZChtYXBwaW5nQSwgbWFwcGluZ0IpIHsKKysJICAg
IHZhciBjbXAgPSBtYXBwaW5nQS5nZW5lcmF0ZWRMaW5lIC0gbWFwcGluZ0IuZ2VuZXJhdGVkTGlu
ZTsKKysJICAgIGlmIChjbXAgIT09IDApIHsKKysJICAgICAgcmV0dXJuIGNtcDsKKysJICAgIH0K
KysKKysJICAgIGNtcCA9IG1hcHBpbmdBLmdlbmVyYXRlZENvbHVtbiAtIG1hcHBpbmdCLmdlbmVy
YXRlZENvbHVtbjsKKysJICAgIGlmIChjbXAgIT09IDApIHsKKysJICAgICAgcmV0dXJuIGNtcDsK
KysJICAgIH0KKysKKysJICAgIGNtcCA9IHN0cmNtcChtYXBwaW5nQS5zb3VyY2UsIG1hcHBpbmdC
LnNvdXJjZSk7CisrCSAgICBpZiAoY21wICE9PSAwKSB7CisrCSAgICAgIHJldHVybiBjbXA7Cisr
CSAgICB9CisrCisrCSAgICBjbXAgPSBtYXBwaW5nQS5vcmlnaW5hbExpbmUgLSBtYXBwaW5nQi5v
cmlnaW5hbExpbmU7CisrCSAgICBpZiAoY21wICE9PSAwKSB7CisrCSAgICAgIHJldHVybiBjbXA7
CisrCSAgICB9CisrCisrCSAgICBjbXAgPSBtYXBwaW5nQS5vcmlnaW5hbENvbHVtbiAtIG1hcHBp
bmdCLm9yaWdpbmFsQ29sdW1uOworKwkgICAgaWYgKGNtcCAhPT0gMCkgeworKwkgICAgICByZXR1
cm4gY21wOworKwkgICAgfQorKworKwkgICAgcmV0dXJuIHN0cmNtcChtYXBwaW5nQS5uYW1lLCBt
YXBwaW5nQi5uYW1lKTsKKysJICB9CisrCSAgZXhwb3J0cy5jb21wYXJlQnlHZW5lcmF0ZWRQb3Np
dGlvbnNJbmZsYXRlZCA9IGNvbXBhcmVCeUdlbmVyYXRlZFBvc2l0aW9uc0luZmxhdGVkOworKwl9
CisrCisrCisrLyoqKi8gfSwKKysvKiA1ICovCisrLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBv
cnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CisrCisrCS8qIC0qLSBNb2RlOiBqczsganMtaW5k
ZW50LWxldmVsOiAyOyAtKi0gKi8KKysJLyoKKysJICogQ29weXJpZ2h0IDIwMTEgTW96aWxsYSBG
b3VuZGF0aW9uIGFuZCBjb250cmlidXRvcnMKKysJICogTGljZW5zZWQgdW5kZXIgdGhlIE5ldyBC
U0QgbGljZW5zZS4gU2VlIExJQ0VOU0Ugb3I6CisrCSAqIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9s
aWNlbnNlcy9CU0QtMy1DbGF1c2UKKysJICovCisrCXsKKysJICB2YXIgdXRpbCA9IF9fd2VicGFj
a19yZXF1aXJlX18oNCk7CisrCisrCSAgLyoqCisrCSAgICogQSBkYXRhIHN0cnVjdHVyZSB3aGlj
aCBpcyBhIGNvbWJpbmF0aW9uIG9mIGFuIGFycmF5IGFuZCBhIHNldC4gQWRkaW5nIGEgbmV3Cisr
CSAgICogbWVtYmVyIGlzIE8oMSksIHRlc3RpbmcgZm9yIG1lbWJlcnNoaXAgaXMgTygxKSwgYW5k
IGZpbmRpbmcgdGhlIGluZGV4IG9mIGFuCisrCSAgICogZWxlbWVudCBpcyBPKDEpLiBSZW1vdmlu
ZyBlbGVtZW50cyBmcm9tIHRoZSBzZXQgaXMgbm90IHN1cHBvcnRlZC4gT25seQorKwkgICAqIHN0
cmluZ3MgYXJlIHN1cHBvcnRlZCBmb3IgbWVtYmVyc2hpcC4KKysJICAgKi8KKysJICBmdW5jdGlv
biBBcnJheVNldCgpIHsKKysJICAgIHRoaXMuX2FycmF5ID0gW107CisrCSAgICB0aGlzLl9zZXQg
PSB7fTsKKysJICB9CisrCisrCSAgLyoqCisrCSAgICogU3RhdGljIG1ldGhvZCBmb3IgY3JlYXRp
bmcgQXJyYXlTZXQgaW5zdGFuY2VzIGZyb20gYW4gZXhpc3RpbmcgYXJyYXkuCisrCSAgICovCisr
CSAgQXJyYXlTZXQuZnJvbUFycmF5ID0gZnVuY3Rpb24gQXJyYXlTZXRfZnJvbUFycmF5KGFBcnJh
eSwgYUFsbG93RHVwbGljYXRlcykgeworKwkgICAgdmFyIHNldCA9IG5ldyBBcnJheVNldCgpOwor
KwkgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGFBcnJheS5sZW5ndGg7IGkgPCBsZW47IGkrKykg
eworKwkgICAgICBzZXQuYWRkKGFBcnJheVtpXSwgYUFsbG93RHVwbGljYXRlcyk7CisrCSAgICB9
CisrCSAgICByZXR1cm4gc2V0OworKwkgIH07CisrCisrCSAgLyoqCisrCSAgICogUmV0dXJuIGhv
dyBtYW55IHVuaXF1ZSBpdGVtcyBhcmUgaW4gdGhpcyBBcnJheVNldC4gSWYgZHVwbGljYXRlcyBo
YXZlIGJlZW4KKysJICAgKiBhZGRlZCwgdGhhbiB0aG9zZSBkbyBub3QgY291bnQgdG93YXJkcyB0
aGUgc2l6ZS4KKysJICAgKgorKwkgICAqIEByZXR1cm5zIE51bWJlcgorKwkgICAqLworKwkgIEFy
cmF5U2V0LnByb3RvdHlwZS5zaXplID0gZnVuY3Rpb24gQXJyYXlTZXRfc2l6ZSgpIHsKKysJICAg
IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzLl9zZXQpLmxlbmd0aDsKKysJ
ICB9OworKworKwkgIC8qKgorKwkgICAqIEFkZCB0aGUgZ2l2ZW4gc3RyaW5nIHRvIHRoaXMgc2V0
LgorKwkgICAqCisrCSAgICogQHBhcmFtIFN0cmluZyBhU3RyCisrCSAgICovCisrCSAgQXJyYXlT
ZXQucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIEFycmF5U2V0X2FkZChhU3RyLCBhQWxsb3dEdXBs
aWNhdGVzKSB7CisrCSAgICB2YXIgc1N0ciA9IHV0aWwudG9TZXRTdHJpbmcoYVN0cik7CisrCSAg
ICB2YXIgaXNEdXBsaWNhdGUgPSB0aGlzLl9zZXQuaGFzT3duUHJvcGVydHkoc1N0cik7CisrCSAg
ICB2YXIgaWR4ID0gdGhpcy5fYXJyYXkubGVuZ3RoOworKwkgICAgaWYgKCFpc0R1cGxpY2F0ZSB8
fCBhQWxsb3dEdXBsaWNhdGVzKSB7CisrCSAgICAgIHRoaXMuX2FycmF5LnB1c2goYVN0cik7Cisr
CSAgICB9CisrCSAgICBpZiAoIWlzRHVwbGljYXRlKSB7CisrCSAgICAgIHRoaXMuX3NldFtzU3Ry
XSA9IGlkeDsKKysJICAgIH0KKysJICB9OworKworKwkgIC8qKgorKwkgICAqIElzIHRoZSBnaXZl
biBzdHJpbmcgYSBtZW1iZXIgb2YgdGhpcyBzZXQ/CisrCSAgICoKKysJICAgKiBAcGFyYW0gU3Ry
aW5nIGFTdHIKKysJICAgKi8KKysJICBBcnJheVNldC5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24g
QXJyYXlTZXRfaGFzKGFTdHIpIHsKKysJICAgIHZhciBzU3RyID0gdXRpbC50b1NldFN0cmluZyhh
U3RyKTsKKysJICAgIHJldHVybiB0aGlzLl9zZXQuaGFzT3duUHJvcGVydHkoc1N0cik7CisrCSAg
fTsKKysKKysJICAvKioKKysJICAgKiBXaGF0IGlzIHRoZSBpbmRleCBvZiB0aGUgZ2l2ZW4gc3Ry
aW5nIGluIHRoZSBhcnJheT8KKysJICAgKgorKwkgICAqIEBwYXJhbSBTdHJpbmcgYVN0cgorKwkg
ICAqLworKwkgIEFycmF5U2V0LnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gQXJyYXlTZXRf
aW5kZXhPZihhU3RyKSB7CisrCSAgICB2YXIgc1N0ciA9IHV0aWwudG9TZXRTdHJpbmcoYVN0cik7
CisrCSAgICBpZiAodGhpcy5fc2V0Lmhhc093blByb3BlcnR5KHNTdHIpKSB7CisrCSAgICAgIHJl
dHVybiB0aGlzLl9zZXRbc1N0cl07CisrCSAgICB9CisrCSAgICB0aHJvdyBuZXcgRXJyb3IoJyIn
ICsgYVN0ciArICciIGlzIG5vdCBpbiB0aGUgc2V0LicpOworKwkgIH07CisrCisrCSAgLyoqCisr
CSAgICogV2hhdCBpcyB0aGUgZWxlbWVudCBhdCB0aGUgZ2l2ZW4gaW5kZXg/CisrCSAgICoKKysJ
ICAgKiBAcGFyYW0gTnVtYmVyIGFJZHgKKysJICAgKi8KKysJICBBcnJheVNldC5wcm90b3R5cGUu
YXQgPSBmdW5jdGlvbiBBcnJheVNldF9hdChhSWR4KSB7CisrCSAgICBpZiAoYUlkeCA+PSAwICYm
IGFJZHggPCB0aGlzLl9hcnJheS5sZW5ndGgpIHsKKysJICAgICAgcmV0dXJuIHRoaXMuX2FycmF5
W2FJZHhdOworKwkgICAgfQorKwkgICAgdGhyb3cgbmV3IEVycm9yKCdObyBlbGVtZW50IGluZGV4
ZWQgYnkgJyArIGFJZHgpOworKwkgIH07CisrCisrCSAgLyoqCisrCSAgICogUmV0dXJucyB0aGUg
YXJyYXkgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBzZXQgKHdoaWNoIGhhcyB0aGUgcHJvcGVyIGlu
ZGljZXMKKysJICAgKiBpbmRpY2F0ZWQgYnkgaW5kZXhPZikuIE5vdGUgdGhhdCB0aGlzIGlzIGEg
Y29weSBvZiB0aGUgaW50ZXJuYWwgYXJyYXkgdXNlZAorKwkgICAqIGZvciBzdG9yaW5nIHRoZSBt
ZW1iZXJzIHNvIHRoYXQgbm8gb25lIGNhbiBtZXNzIHdpdGggaW50ZXJuYWwgc3RhdGUuCisrCSAg
ICovCisrCSAgQXJyYXlTZXQucHJvdG90eXBlLnRvQXJyYXkgPSBmdW5jdGlvbiBBcnJheVNldF90
b0FycmF5KCkgeworKwkgICAgcmV0dXJuIHRoaXMuX2FycmF5LnNsaWNlKCk7CisrCSAgfTsKKysK
KysJICBleHBvcnRzLkFycmF5U2V0ID0gQXJyYXlTZXQ7CisrCX0KKysKKysKKysvKioqLyB9LAor
Ky8qIDYgKi8KKysvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1
aXJlX18pIHsKKysKKysJLyogLSotIE1vZGU6IGpzOyBqcy1pbmRlbnQtbGV2ZWw6IDI7IC0qLSAq
LworKwkvKgorKwkgKiBDb3B5cmlnaHQgMjAxNCBNb3ppbGxhIEZvdW5kYXRpb24gYW5kIGNvbnRy
aWJ1dG9ycworKwkgKiBMaWNlbnNlZCB1bmRlciB0aGUgTmV3IEJTRCBsaWNlbnNlLiBTZWUgTElD
RU5TRSBvcjoKKysJICogaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL0JTRC0zLUNsYXVz
ZQorKwkgKi8KKysJeworKwkgIHZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsKKysK
KysJICAvKioKKysJICAgKiBEZXRlcm1pbmUgd2hldGhlciBtYXBwaW5nQiBpcyBhZnRlciBtYXBw
aW5nQSB3aXRoIHJlc3BlY3QgdG8gZ2VuZXJhdGVkCisrCSAgICogcG9zaXRpb24uCisrCSAgICov
CisrCSAgZnVuY3Rpb24gZ2VuZXJhdGVkUG9zaXRpb25BZnRlcihtYXBwaW5nQSwgbWFwcGluZ0Ip
IHsKKysJICAgIC8vIE9wdGltaXplZCBmb3IgbW9zdCBjb21tb24gY2FzZQorKwkgICAgdmFyIGxp
bmVBID0gbWFwcGluZ0EuZ2VuZXJhdGVkTGluZTsKKysJICAgIHZhciBsaW5lQiA9IG1hcHBpbmdC
LmdlbmVyYXRlZExpbmU7CisrCSAgICB2YXIgY29sdW1uQSA9IG1hcHBpbmdBLmdlbmVyYXRlZENv
bHVtbjsKKysJICAgIHZhciBjb2x1bW5CID0gbWFwcGluZ0IuZ2VuZXJhdGVkQ29sdW1uOworKwkg
ICAgcmV0dXJuIGxpbmVCID4gbGluZUEgfHwgbGluZUIgPT0gbGluZUEgJiYgY29sdW1uQiA+PSBj
b2x1bW5BIHx8CisrCSAgICAgICAgICAgdXRpbC5jb21wYXJlQnlHZW5lcmF0ZWRQb3NpdGlvbnNJ
bmZsYXRlZChtYXBwaW5nQSwgbWFwcGluZ0IpIDw9IDA7CisrCSAgfQorKworKwkgIC8qKgorKwkg
ICAqIEEgZGF0YSBzdHJ1Y3R1cmUgdG8gcHJvdmlkZSBhIHNvcnRlZCB2aWV3IG9mIGFjY3VtdWxh
dGVkIG1hcHBpbmdzIGluIGEKKysJICAgKiBwZXJmb3JtYW5jZSBjb25zY2lvdXMgbWFubmVyLiBJ
dCB0cmFkZXMgYSBuZWdsaWJhYmxlIG92ZXJoZWFkIGluIGdlbmVyYWwKKysJICAgKiBjYXNlIGZv
ciBhIGxhcmdlIHNwZWVkdXAgaW4gY2FzZSBvZiBtYXBwaW5ncyBiZWluZyBhZGRlZCBpbiBvcmRl
ci4KKysJICAgKi8KKysJICBmdW5jdGlvbiBNYXBwaW5nTGlzdCgpIHsKKysJICAgIHRoaXMuX2Fy
cmF5ID0gW107CisrCSAgICB0aGlzLl9zb3J0ZWQgPSB0cnVlOworKwkgICAgLy8gU2VydmVzIGFz
IGluZmltdW0KKysJICAgIHRoaXMuX2xhc3QgPSB7Z2VuZXJhdGVkTGluZTogLTEsIGdlbmVyYXRl
ZENvbHVtbjogMH07CisrCSAgfQorKworKwkgIC8qKgorKwkgICAqIEl0ZXJhdGUgdGhyb3VnaCBp
bnRlcm5hbCBpdGVtcy4gVGhpcyBtZXRob2QgdGFrZXMgdGhlIHNhbWUgYXJndW1lbnRzIHRoYXQK
KysJICAgKiBgQXJyYXkucHJvdG90eXBlLmZvckVhY2hgIHRha2VzLgorKwkgICAqCisrCSAgICog
Tk9URTogVGhlIG9yZGVyIG9mIHRoZSBtYXBwaW5ncyBpcyBOT1QgZ3VhcmFudGVlZC4KKysJICAg
Ki8KKysJICBNYXBwaW5nTGlzdC5wcm90b3R5cGUudW5zb3J0ZWRGb3JFYWNoID0KKysJICAgIGZ1
bmN0aW9uIE1hcHBpbmdMaXN0X2ZvckVhY2goYUNhbGxiYWNrLCBhVGhpc0FyZykgeworKwkgICAg
ICB0aGlzLl9hcnJheS5mb3JFYWNoKGFDYWxsYmFjaywgYVRoaXNBcmcpOworKwkgICAgfTsKKysK
KysJICAvKioKKysJICAgKiBBZGQgdGhlIGdpdmVuIHNvdXJjZSBtYXBwaW5nLgorKwkgICAqCisr
CSAgICogQHBhcmFtIE9iamVjdCBhTWFwcGluZworKwkgICAqLworKwkgIE1hcHBpbmdMaXN0LnBy
b3RvdHlwZS5hZGQgPSBmdW5jdGlvbiBNYXBwaW5nTGlzdF9hZGQoYU1hcHBpbmcpIHsKKysJICAg
IGlmIChnZW5lcmF0ZWRQb3NpdGlvbkFmdGVyKHRoaXMuX2xhc3QsIGFNYXBwaW5nKSkgeworKwkg
ICAgICB0aGlzLl9sYXN0ID0gYU1hcHBpbmc7CisrCSAgICAgIHRoaXMuX2FycmF5LnB1c2goYU1h
cHBpbmcpOworKwkgICAgfSBlbHNlIHsKKysJICAgICAgdGhpcy5fc29ydGVkID0gZmFsc2U7Cisr
CSAgICAgIHRoaXMuX2FycmF5LnB1c2goYU1hcHBpbmcpOworKwkgICAgfQorKwkgIH07CisrCisr
CSAgLyoqCisrCSAgICogUmV0dXJucyB0aGUgZmxhdCwgc29ydGVkIGFycmF5IG9mIG1hcHBpbmdz
LiBUaGUgbWFwcGluZ3MgYXJlIHNvcnRlZCBieQorKwkgICAqIGdlbmVyYXRlZCBwb3NpdGlvbi4K
KysJICAgKgorKwkgICAqIFdBUk5JTkc6IFRoaXMgbWV0aG9kIHJldHVybnMgaW50ZXJuYWwgZGF0
YSB3aXRob3V0IGNvcHlpbmcsIGZvcgorKwkgICAqIHBlcmZvcm1hbmNlLiBUaGUgcmV0dXJuIHZh
bHVlIG11c3QgTk9UIGJlIG11dGF0ZWQsIGFuZCBzaG91bGQgYmUgdHJlYXRlZCBhcworKwkgICAq
IGFuIGltbXV0YWJsZSBib3Jyb3cuIElmIHlvdSB3YW50IHRvIHRha2Ugb3duZXJzaGlwLCB5b3Ug
bXVzdCBtYWtlIHlvdXIgb3duCisrCSAgICogY29weS4KKysJICAgKi8KKysJICBNYXBwaW5nTGlz
dC5wcm90b3R5cGUudG9BcnJheSA9IGZ1bmN0aW9uIE1hcHBpbmdMaXN0X3RvQXJyYXkoKSB7Cisr
CSAgICBpZiAoIXRoaXMuX3NvcnRlZCkgeworKwkgICAgICB0aGlzLl9hcnJheS5zb3J0KHV0aWwu
Y29tcGFyZUJ5R2VuZXJhdGVkUG9zaXRpb25zSW5mbGF0ZWQpOworKwkgICAgICB0aGlzLl9zb3J0
ZWQgPSB0cnVlOworKwkgICAgfQorKwkgICAgcmV0dXJuIHRoaXMuX2FycmF5OworKwkgIH07Cisr
CisrCSAgZXhwb3J0cy5NYXBwaW5nTGlzdCA9IE1hcHBpbmdMaXN0OworKwl9CisrCisrCisrLyoq
Ki8gfSwKKysvKiA3ICovCisrLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBh
Y2tfcmVxdWlyZV9fKSB7CisrCisrCS8qIC0qLSBNb2RlOiBqczsganMtaW5kZW50LWxldmVsOiAy
OyAtKi0gKi8KKysJLyoKKysJICogQ29weXJpZ2h0IDIwMTEgTW96aWxsYSBGb3VuZGF0aW9uIGFu
ZCBjb250cmlidXRvcnMKKysJICogTGljZW5zZWQgdW5kZXIgdGhlIE5ldyBCU0QgbGljZW5zZS4g
U2VlIExJQ0VOU0Ugb3I6CisrCSAqIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9CU0Qt
My1DbGF1c2UKKysJICovCisrCXsKKysJICB2YXIgdXRpbCA9IF9fd2VicGFja19yZXF1aXJlX18o
NCk7CisrCSAgdmFyIGJpbmFyeVNlYXJjaCA9IF9fd2VicGFja19yZXF1aXJlX18oOCk7CisrCSAg
dmFyIEFycmF5U2V0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg1KS5BcnJheVNldDsKKysJICB2YXIg
YmFzZTY0VkxRID0gX193ZWJwYWNrX3JlcXVpcmVfXygyKTsKKysJICB2YXIgcXVpY2tTb3J0ID0g
X193ZWJwYWNrX3JlcXVpcmVfXyg5KS5xdWlja1NvcnQ7CisrCisrCSAgZnVuY3Rpb24gU291cmNl
TWFwQ29uc3VtZXIoYVNvdXJjZU1hcCkgeworKwkgICAgdmFyIHNvdXJjZU1hcCA9IGFTb3VyY2VN
YXA7CisrCSAgICBpZiAodHlwZW9mIGFTb3VyY2VNYXAgPT09ICdzdHJpbmcnKSB7CisrCSAgICAg
IHNvdXJjZU1hcCA9IEpTT04ucGFyc2UoYVNvdXJjZU1hcC5yZXBsYWNlKC9eXClcXVx9Jy8sICcn
KSk7CisrCSAgICB9CisrCisrCSAgICByZXR1cm4gc291cmNlTWFwLnNlY3Rpb25zICE9IG51bGwK
KysJICAgICAgPyBuZXcgSW5kZXhlZFNvdXJjZU1hcENvbnN1bWVyKHNvdXJjZU1hcCkKKysJICAg
ICAgOiBuZXcgQmFzaWNTb3VyY2VNYXBDb25zdW1lcihzb3VyY2VNYXApOworKwkgIH0KKysKKysJ
ICBTb3VyY2VNYXBDb25zdW1lci5mcm9tU291cmNlTWFwID0gZnVuY3Rpb24oYVNvdXJjZU1hcCkg
eworKwkgICAgcmV0dXJuIEJhc2ljU291cmNlTWFwQ29uc3VtZXIuZnJvbVNvdXJjZU1hcChhU291
cmNlTWFwKTsKKysJICB9CisrCisrCSAgLyoqCisrCSAgICogVGhlIHZlcnNpb24gb2YgdGhlIHNv
dXJjZSBtYXBwaW5nIHNwZWMgdGhhdCB3ZSBhcmUgY29uc3VtaW5nLgorKwkgICAqLworKwkgIFNv
dXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZS5fdmVyc2lvbiA9IDM7CisrCisrCSAgLy8gYF9fZ2Vu
ZXJhdGVkTWFwcGluZ3NgIGFuZCBgX19vcmlnaW5hbE1hcHBpbmdzYCBhcmUgYXJyYXlzIHRoYXQg
aG9sZCB0aGUKKysJICAvLyBwYXJzZWQgbWFwcGluZyBjb29yZGluYXRlcyBmcm9tIHRoZSBzb3Vy
Y2UgbWFwJ3MgIm1hcHBpbmdzIiBhdHRyaWJ1dGUuIFRoZXkKKysJICAvLyBhcmUgbGF6aWx5IGlu
c3RhbnRpYXRlZCwgYWNjZXNzZWQgdmlhIHRoZSBgX2dlbmVyYXRlZE1hcHBpbmdzYCBhbmQKKysJ
ICAvLyBgX29yaWdpbmFsTWFwcGluZ3NgIGdldHRlcnMgcmVzcGVjdGl2ZWx5LCBhbmQgd2Ugb25s
eSBwYXJzZSB0aGUgbWFwcGluZ3MKKysJICAvLyBhbmQgY3JlYXRlIHRoZXNlIGFycmF5cyBvbmNl
IHF1ZXJpZWQgZm9yIGEgc291cmNlIGxvY2F0aW9uLiBXZSBqdW1wIHRocm91Z2gKKysJICAvLyB0
aGVzZSBob29wcyBiZWNhdXNlIHRoZXJlIGNhbiBiZSBtYW55IHRob3VzYW5kcyBvZiBtYXBwaW5n
cywgYW5kIHBhcnNpbmcKKysJICAvLyB0aGVtIGlzIGV4cGVuc2l2ZSwgc28gd2Ugb25seSB3YW50
IHRvIGRvIGl0IGlmIHdlIG11c3QuCisrCSAgLy8KKysJICAvLyBFYWNoIG9iamVjdCBpbiB0aGUg
YXJyYXlzIGlzIG9mIHRoZSBmb3JtOgorKwkgIC8vCisrCSAgLy8gICAgIHsKKysJICAvLyAgICAg
ICBnZW5lcmF0ZWRMaW5lOiBUaGUgbGluZSBudW1iZXIgaW4gdGhlIGdlbmVyYXRlZCBjb2RlLAor
KwkgIC8vICAgICAgIGdlbmVyYXRlZENvbHVtbjogVGhlIGNvbHVtbiBudW1iZXIgaW4gdGhlIGdl
bmVyYXRlZCBjb2RlLAorKwkgIC8vICAgICAgIHNvdXJjZTogVGhlIHBhdGggdG8gdGhlIG9yaWdp
bmFsIHNvdXJjZSBmaWxlIHRoYXQgZ2VuZXJhdGVkIHRoaXMKKysJICAvLyAgICAgICAgICAgICAg
IGNodW5rIG9mIGNvZGUsCisrCSAgLy8gICAgICAgb3JpZ2luYWxMaW5lOiBUaGUgbGluZSBudW1i
ZXIgaW4gdGhlIG9yaWdpbmFsIHNvdXJjZSB0aGF0CisrCSAgLy8gICAgICAgICAgICAgICAgICAg
ICBjb3JyZXNwb25kcyB0byB0aGlzIGNodW5rIG9mIGdlbmVyYXRlZCBjb2RlLAorKwkgIC8vICAg
ICAgIG9yaWdpbmFsQ29sdW1uOiBUaGUgY29sdW1uIG51bWJlciBpbiB0aGUgb3JpZ2luYWwgc291
cmNlIHRoYXQKKysJICAvLyAgICAgICAgICAgICAgICAgICAgICAgY29ycmVzcG9uZHMgdG8gdGhp
cyBjaHVuayBvZiBnZW5lcmF0ZWQgY29kZSwKKysJICAvLyAgICAgICBuYW1lOiBUaGUgbmFtZSBv
ZiB0aGUgb3JpZ2luYWwgc3ltYm9sIHdoaWNoIGdlbmVyYXRlZCB0aGlzIGNodW5rIG9mCisrCSAg
Ly8gICAgICAgICAgICAgY29kZS4KKysJICAvLyAgICAgfQorKwkgIC8vCisrCSAgLy8gQWxsIHBy
b3BlcnRpZXMgZXhjZXB0IGZvciBgZ2VuZXJhdGVkTGluZWAgYW5kIGBnZW5lcmF0ZWRDb2x1bW5g
IGNhbiBiZQorKwkgIC8vIGBudWxsYC4KKysJICAvLworKwkgIC8vIGBfZ2VuZXJhdGVkTWFwcGlu
Z3NgIGlzIG9yZGVyZWQgYnkgdGhlIGdlbmVyYXRlZCBwb3NpdGlvbnMuCisrCSAgLy8KKysJICAv
LyBgX29yaWdpbmFsTWFwcGluZ3NgIGlzIG9yZGVyZWQgYnkgdGhlIG9yaWdpbmFsIHBvc2l0aW9u
cy4KKysKKysJICBTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUuX19nZW5lcmF0ZWRNYXBwaW5n
cyA9IG51bGw7CisrCSAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFNvdXJjZU1hcENvbnN1bWVyLnBy
b3RvdHlwZSwgJ19nZW5lcmF0ZWRNYXBwaW5ncycsIHsKKysJICAgIGdldDogZnVuY3Rpb24gKCkg
eworKwkgICAgICBpZiAoIXRoaXMuX19nZW5lcmF0ZWRNYXBwaW5ncykgeworKwkgICAgICAgIHRo
aXMuX3BhcnNlTWFwcGluZ3ModGhpcy5fbWFwcGluZ3MsIHRoaXMuc291cmNlUm9vdCk7CisrCSAg
ICAgIH0KKysKKysJICAgICAgcmV0dXJuIHRoaXMuX19nZW5lcmF0ZWRNYXBwaW5nczsKKysJICAg
IH0KKysJICB9KTsKKysKKysJICBTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUuX19vcmlnaW5h
bE1hcHBpbmdzID0gbnVsbDsKKysJICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU291cmNlTWFwQ29u
c3VtZXIucHJvdG90eXBlLCAnX29yaWdpbmFsTWFwcGluZ3MnLCB7CisrCSAgICBnZXQ6IGZ1bmN0
aW9uICgpIHsKKysJICAgICAgaWYgKCF0aGlzLl9fb3JpZ2luYWxNYXBwaW5ncykgeworKwkgICAg
ICAgIHRoaXMuX3BhcnNlTWFwcGluZ3ModGhpcy5fbWFwcGluZ3MsIHRoaXMuc291cmNlUm9vdCk7
CisrCSAgICAgIH0KKysKKysJICAgICAgcmV0dXJuIHRoaXMuX19vcmlnaW5hbE1hcHBpbmdzOwor
KwkgICAgfQorKwkgIH0pOworKworKwkgIFNvdXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZS5fY2hh
cklzTWFwcGluZ1NlcGFyYXRvciA9CisrCSAgICBmdW5jdGlvbiBTb3VyY2VNYXBDb25zdW1lcl9j
aGFySXNNYXBwaW5nU2VwYXJhdG9yKGFTdHIsIGluZGV4KSB7CisrCSAgICAgIHZhciBjID0gYVN0
ci5jaGFyQXQoaW5kZXgpOworKwkgICAgICByZXR1cm4gYyA9PT0gIjsiIHx8IGMgPT09ICIsIjsK
KysJICAgIH07CisrCisrCSAgLyoqCisrCSAgICogUGFyc2UgdGhlIG1hcHBpbmdzIGluIGEgc3Ry
aW5nIGluIHRvIGEgZGF0YSBzdHJ1Y3R1cmUgd2hpY2ggd2UgY2FuIGVhc2lseQorKwkgICAqIHF1
ZXJ5ICh0aGUgb3JkZXJlZCBhcnJheXMgaW4gdGhlIGB0aGlzLl9fZ2VuZXJhdGVkTWFwcGluZ3Ng
IGFuZAorKwkgICAqIGB0aGlzLl9fb3JpZ2luYWxNYXBwaW5nc2AgcHJvcGVydGllcykuCisrCSAg
ICovCisrCSAgU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLl9wYXJzZU1hcHBpbmdzID0KKysJ
ICAgIGZ1bmN0aW9uIFNvdXJjZU1hcENvbnN1bWVyX3BhcnNlTWFwcGluZ3MoYVN0ciwgYVNvdXJj
ZVJvb3QpIHsKKysJICAgICAgdGhyb3cgbmV3IEVycm9yKCJTdWJjbGFzc2VzIG11c3QgaW1wbGVt
ZW50IF9wYXJzZU1hcHBpbmdzIik7CisrCSAgICB9OworKworKwkgIFNvdXJjZU1hcENvbnN1bWVy
LkdFTkVSQVRFRF9PUkRFUiA9IDE7CisrCSAgU291cmNlTWFwQ29uc3VtZXIuT1JJR0lOQUxfT1JE
RVIgPSAyOworKworKwkgIFNvdXJjZU1hcENvbnN1bWVyLkdSRUFURVNUX0xPV0VSX0JPVU5EID0g
MTsKKysJICBTb3VyY2VNYXBDb25zdW1lci5MRUFTVF9VUFBFUl9CT1VORCA9IDI7CisrCisrCSAg
LyoqCisrCSAgICogSXRlcmF0ZSBvdmVyIGVhY2ggbWFwcGluZyBiZXR3ZWVuIGFuIG9yaWdpbmFs
IHNvdXJjZS9saW5lL2NvbHVtbiBhbmQgYQorKwkgICAqIGdlbmVyYXRlZCBsaW5lL2NvbHVtbiBp
biB0aGlzIHNvdXJjZSBtYXAuCisrCSAgICoKKysJICAgKiBAcGFyYW0gRnVuY3Rpb24gYUNhbGxi
YWNrCisrCSAgICogICAgICAgIFRoZSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aXRoIGVhY2gg
bWFwcGluZy4KKysJICAgKiBAcGFyYW0gT2JqZWN0IGFDb250ZXh0CisrCSAgICogICAgICAgIE9w
dGlvbmFsLiBJZiBzcGVjaWZpZWQsIHRoaXMgb2JqZWN0IHdpbGwgYmUgdGhlIHZhbHVlIG9mIGB0
aGlzYCBldmVyeQorKwkgICAqICAgICAgICB0aW1lIHRoYXQgYGFDYWxsYmFja2AgaXMgY2FsbGVk
LgorKwkgICAqIEBwYXJhbSBhT3JkZXIKKysJICAgKiAgICAgICAgRWl0aGVyIGBTb3VyY2VNYXBD
b25zdW1lci5HRU5FUkFURURfT1JERVJgIG9yCisrCSAgICogICAgICAgIGBTb3VyY2VNYXBDb25z
dW1lci5PUklHSU5BTF9PUkRFUmAuIFNwZWNpZmllcyB3aGV0aGVyIHlvdSB3YW50IHRvCisrCSAg
ICogICAgICAgIGl0ZXJhdGUgb3ZlciB0aGUgbWFwcGluZ3Mgc29ydGVkIGJ5IHRoZSBnZW5lcmF0
ZWQgZmlsZSdzIGxpbmUvY29sdW1uCisrCSAgICogICAgICAgIG9yZGVyIG9yIHRoZSBvcmlnaW5h
bCdzIHNvdXJjZS9saW5lL2NvbHVtbiBvcmRlciwgcmVzcGVjdGl2ZWx5LiBEZWZhdWx0cyB0bwor
KwkgICAqICAgICAgICBgU291cmNlTWFwQ29uc3VtZXIuR0VORVJBVEVEX09SREVSYC4KKysJICAg
Ki8KKysJICBTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUuZWFjaE1hcHBpbmcgPQorKwkgICAg
ZnVuY3Rpb24gU291cmNlTWFwQ29uc3VtZXJfZWFjaE1hcHBpbmcoYUNhbGxiYWNrLCBhQ29udGV4
dCwgYU9yZGVyKSB7CisrCSAgICAgIHZhciBjb250ZXh0ID0gYUNvbnRleHQgfHwgbnVsbDsKKysJ
ICAgICAgdmFyIG9yZGVyID0gYU9yZGVyIHx8IFNvdXJjZU1hcENvbnN1bWVyLkdFTkVSQVRFRF9P
UkRFUjsKKysKKysJICAgICAgdmFyIG1hcHBpbmdzOworKwkgICAgICBzd2l0Y2ggKG9yZGVyKSB7
CisrCSAgICAgIGNhc2UgU291cmNlTWFwQ29uc3VtZXIuR0VORVJBVEVEX09SREVSOgorKwkgICAg
ICAgIG1hcHBpbmdzID0gdGhpcy5fZ2VuZXJhdGVkTWFwcGluZ3M7CisrCSAgICAgICAgYnJlYWs7
CisrCSAgICAgIGNhc2UgU291cmNlTWFwQ29uc3VtZXIuT1JJR0lOQUxfT1JERVI6CisrCSAgICAg
ICAgbWFwcGluZ3MgPSB0aGlzLl9vcmlnaW5hbE1hcHBpbmdzOworKwkgICAgICAgIGJyZWFrOwor
KwkgICAgICBkZWZhdWx0OgorKwkgICAgICAgIHRocm93IG5ldyBFcnJvcigiVW5rbm93biBvcmRl
ciBvZiBpdGVyYXRpb24uIik7CisrCSAgICAgIH0KKysKKysJICAgICAgdmFyIHNvdXJjZVJvb3Qg
PSB0aGlzLnNvdXJjZVJvb3Q7CisrCSAgICAgIG1hcHBpbmdzLm1hcChmdW5jdGlvbiAobWFwcGlu
ZykgeworKwkgICAgICAgIHZhciBzb3VyY2UgPSBtYXBwaW5nLnNvdXJjZSA9PT0gbnVsbCA/IG51
bGwgOiB0aGlzLl9zb3VyY2VzLmF0KG1hcHBpbmcuc291cmNlKTsKKysJICAgICAgICBpZiAoc291
cmNlICE9IG51bGwgJiYgc291cmNlUm9vdCAhPSBudWxsKSB7CisrCSAgICAgICAgICBzb3VyY2Ug
PSB1dGlsLmpvaW4oc291cmNlUm9vdCwgc291cmNlKTsKKysJICAgICAgICB9CisrCSAgICAgICAg
cmV0dXJuIHsKKysJICAgICAgICAgIHNvdXJjZTogc291cmNlLAorKwkgICAgICAgICAgZ2VuZXJh
dGVkTGluZTogbWFwcGluZy5nZW5lcmF0ZWRMaW5lLAorKwkgICAgICAgICAgZ2VuZXJhdGVkQ29s
dW1uOiBtYXBwaW5nLmdlbmVyYXRlZENvbHVtbiwKKysJICAgICAgICAgIG9yaWdpbmFsTGluZTog
bWFwcGluZy5vcmlnaW5hbExpbmUsCisrCSAgICAgICAgICBvcmlnaW5hbENvbHVtbjogbWFwcGlu
Zy5vcmlnaW5hbENvbHVtbiwKKysJICAgICAgICAgIG5hbWU6IG1hcHBpbmcubmFtZSA9PT0gbnVs
bCA/IG51bGwgOiB0aGlzLl9uYW1lcy5hdChtYXBwaW5nLm5hbWUpCisrCSAgICAgICAgfTsKKysJ
ICAgICAgfSwgdGhpcykuZm9yRWFjaChhQ2FsbGJhY2ssIGNvbnRleHQpOworKwkgICAgfTsKKysK
KysJICAvKioKKysJICAgKiBSZXR1cm5zIGFsbCBnZW5lcmF0ZWQgbGluZSBhbmQgY29sdW1uIGlu
Zm9ybWF0aW9uIGZvciB0aGUgb3JpZ2luYWwgc291cmNlLAorKwkgICAqIGxpbmUsIGFuZCBjb2x1
bW4gcHJvdmlkZWQuIElmIG5vIGNvbHVtbiBpcyBwcm92aWRlZCwgcmV0dXJucyBhbGwgbWFwcGlu
Z3MKKysJICAgKiBjb3JyZXNwb25kaW5nIHRvIGEgZWl0aGVyIHRoZSBsaW5lIHdlIGFyZSBzZWFy
Y2hpbmcgZm9yIG9yIHRoZSBuZXh0CisrCSAgICogY2xvc2VzdCBsaW5lIHRoYXQgaGFzIGFueSBt
YXBwaW5ncy4gT3RoZXJ3aXNlLCByZXR1cm5zIGFsbCBtYXBwaW5ncworKwkgICAqIGNvcnJlc3Bv
bmRpbmcgdG8gdGhlIGdpdmVuIGxpbmUgYW5kIGVpdGhlciB0aGUgY29sdW1uIHdlIGFyZSBzZWFy
Y2hpbmcgZm9yCisrCSAgICogb3IgdGhlIG5leHQgY2xvc2VzdCBjb2x1bW4gdGhhdCBoYXMgYW55
IG9mZnNldHMuCisrCSAgICoKKysJICAgKiBUaGUgb25seSBhcmd1bWVudCBpcyBhbiBvYmplY3Qg
d2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6CisrCSAgICoKKysJICAgKiAgIC0gc291cmNl
OiBUaGUgZmlsZW5hbWUgb2YgdGhlIG9yaWdpbmFsIHNvdXJjZS4KKysJICAgKiAgIC0gbGluZTog
VGhlIGxpbmUgbnVtYmVyIGluIHRoZSBvcmlnaW5hbCBzb3VyY2UuCisrCSAgICogICAtIGNvbHVt
bjogT3B0aW9uYWwuIHRoZSBjb2x1bW4gbnVtYmVyIGluIHRoZSBvcmlnaW5hbCBzb3VyY2UuCisr
CSAgICoKKysJICAgKiBhbmQgYW4gYXJyYXkgb2Ygb2JqZWN0cyBpcyByZXR1cm5lZCwgZWFjaCB3
aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczoKKysJICAgKgorKwkgICAqICAgLSBsaW5lOiBU
aGUgbGluZSBudW1iZXIgaW4gdGhlIGdlbmVyYXRlZCBzb3VyY2UsIG9yIG51bGwuCisrCSAgICog
ICAtIGNvbHVtbjogVGhlIGNvbHVtbiBudW1iZXIgaW4gdGhlIGdlbmVyYXRlZCBzb3VyY2UsIG9y
IG51bGwuCisrCSAgICovCisrCSAgU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLmFsbEdlbmVy
YXRlZFBvc2l0aW9uc0ZvciA9CisrCSAgICBmdW5jdGlvbiBTb3VyY2VNYXBDb25zdW1lcl9hbGxH
ZW5lcmF0ZWRQb3NpdGlvbnNGb3IoYUFyZ3MpIHsKKysJICAgICAgdmFyIGxpbmUgPSB1dGlsLmdl
dEFyZyhhQXJncywgJ2xpbmUnKTsKKysKKysJICAgICAgLy8gV2hlbiB0aGVyZSBpcyBubyBleGFj
dCBtYXRjaCwgQmFzaWNTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUuX2ZpbmRNYXBwaW5nCisr
CSAgICAgIC8vIHJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBjbG9zZXN0IG1hcHBpbmcgbGVzcyB0
aGFuIHRoZSBuZWVkbGUuIEJ5CisrCSAgICAgIC8vIHNldHRpbmcgbmVlZGxlLm9yaWdpbmFsQ29s
dW1uIHRvIDAsIHdlIHRodXMgZmluZCB0aGUgbGFzdCBtYXBwaW5nIGZvcgorKwkgICAgICAvLyB0
aGUgZ2l2ZW4gbGluZSwgcHJvdmlkZWQgc3VjaCBhIG1hcHBpbmcgZXhpc3RzLgorKwkgICAgICB2
YXIgbmVlZGxlID0geworKwkgICAgICAgIHNvdXJjZTogdXRpbC5nZXRBcmcoYUFyZ3MsICdzb3Vy
Y2UnKSwKKysJICAgICAgICBvcmlnaW5hbExpbmU6IGxpbmUsCisrCSAgICAgICAgb3JpZ2luYWxD
b2x1bW46IHV0aWwuZ2V0QXJnKGFBcmdzLCAnY29sdW1uJywgMCkKKysJICAgICAgfTsKKysKKysJ
ICAgICAgaWYgKHRoaXMuc291cmNlUm9vdCAhPSBudWxsKSB7CisrCSAgICAgICAgbmVlZGxlLnNv
dXJjZSA9IHV0aWwucmVsYXRpdmUodGhpcy5zb3VyY2VSb290LCBuZWVkbGUuc291cmNlKTsKKysJ
ICAgICAgfQorKwkgICAgICBpZiAoIXRoaXMuX3NvdXJjZXMuaGFzKG5lZWRsZS5zb3VyY2UpKSB7
CisrCSAgICAgICAgcmV0dXJuIFtdOworKwkgICAgICB9CisrCSAgICAgIG5lZWRsZS5zb3VyY2Ug
PSB0aGlzLl9zb3VyY2VzLmluZGV4T2YobmVlZGxlLnNvdXJjZSk7CisrCisrCSAgICAgIHZhciBt
YXBwaW5ncyA9IFtdOworKworKwkgICAgICB2YXIgaW5kZXggPSB0aGlzLl9maW5kTWFwcGluZyhu
ZWVkbGUsCisrCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29yaWdp
bmFsTWFwcGluZ3MsCisrCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJvcmln
aW5hbExpbmUiLAorKwkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAib3JpZ2lu
YWxDb2x1bW4iLAorKwkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGlsLmNv
bXBhcmVCeU9yaWdpbmFsUG9zaXRpb25zLAorKwkgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBiaW5hcnlTZWFyY2guTEVBU1RfVVBQRVJfQk9VTkQpOworKwkgICAgICBpZiAoaW5k
ZXggPj0gMCkgeworKwkgICAgICAgIHZhciBtYXBwaW5nID0gdGhpcy5fb3JpZ2luYWxNYXBwaW5n
c1tpbmRleF07CisrCisrCSAgICAgICAgaWYgKGFBcmdzLmNvbHVtbiA9PT0gdW5kZWZpbmVkKSB7
CisrCSAgICAgICAgICB2YXIgb3JpZ2luYWxMaW5lID0gbWFwcGluZy5vcmlnaW5hbExpbmU7Cisr
CisrCSAgICAgICAgICAvLyBJdGVyYXRlIHVudGlsIGVpdGhlciB3ZSBydW4gb3V0IG9mIG1hcHBp
bmdzLCBvciB3ZSBydW4gaW50bworKwkgICAgICAgICAgLy8gYSBtYXBwaW5nIGZvciBhIGRpZmZl
cmVudCBsaW5lIHRoYW4gdGhlIG9uZSB3ZSBmb3VuZC4gU2luY2UKKysJICAgICAgICAgIC8vIG1h
cHBpbmdzIGFyZSBzb3J0ZWQsIHRoaXMgaXMgZ3VhcmFudGVlZCB0byBmaW5kIGFsbCBtYXBwaW5n
cyBmb3IKKysJICAgICAgICAgIC8vIHRoZSBsaW5lIHdlIGZvdW5kLgorKwkgICAgICAgICAgd2hp
bGUgKG1hcHBpbmcgJiYgbWFwcGluZy5vcmlnaW5hbExpbmUgPT09IG9yaWdpbmFsTGluZSkgewor
KwkgICAgICAgICAgICBtYXBwaW5ncy5wdXNoKHsKKysJICAgICAgICAgICAgICBsaW5lOiB1dGls
LmdldEFyZyhtYXBwaW5nLCAnZ2VuZXJhdGVkTGluZScsIG51bGwpLAorKwkgICAgICAgICAgICAg
IGNvbHVtbjogdXRpbC5nZXRBcmcobWFwcGluZywgJ2dlbmVyYXRlZENvbHVtbicsIG51bGwpLAor
KwkgICAgICAgICAgICAgIGxhc3RDb2x1bW46IHV0aWwuZ2V0QXJnKG1hcHBpbmcsICdsYXN0R2Vu
ZXJhdGVkQ29sdW1uJywgbnVsbCkKKysJICAgICAgICAgICAgfSk7CisrCisrCSAgICAgICAgICAg
IG1hcHBpbmcgPSB0aGlzLl9vcmlnaW5hbE1hcHBpbmdzWysraW5kZXhdOworKwkgICAgICAgICAg
fQorKwkgICAgICAgIH0gZWxzZSB7CisrCSAgICAgICAgICB2YXIgb3JpZ2luYWxDb2x1bW4gPSBt
YXBwaW5nLm9yaWdpbmFsQ29sdW1uOworKworKwkgICAgICAgICAgLy8gSXRlcmF0ZSB1bnRpbCBl
aXRoZXIgd2UgcnVuIG91dCBvZiBtYXBwaW5ncywgb3Igd2UgcnVuIGludG8KKysJICAgICAgICAg
IC8vIGEgbWFwcGluZyBmb3IgYSBkaWZmZXJlbnQgbGluZSB0aGFuIHRoZSBvbmUgd2Ugd2VyZSBz
ZWFyY2hpbmcgZm9yLgorKwkgICAgICAgICAgLy8gU2luY2UgbWFwcGluZ3MgYXJlIHNvcnRlZCwg
dGhpcyBpcyBndWFyYW50ZWVkIHRvIGZpbmQgYWxsIG1hcHBpbmdzIGZvcgorKwkgICAgICAgICAg
Ly8gdGhlIGxpbmUgd2UgYXJlIHNlYXJjaGluZyBmb3IuCisrCSAgICAgICAgICB3aGlsZSAobWFw
cGluZyAmJgorKwkgICAgICAgICAgICAgICAgIG1hcHBpbmcub3JpZ2luYWxMaW5lID09PSBsaW5l
ICYmCisrCSAgICAgICAgICAgICAgICAgbWFwcGluZy5vcmlnaW5hbENvbHVtbiA9PSBvcmlnaW5h
bENvbHVtbikgeworKwkgICAgICAgICAgICBtYXBwaW5ncy5wdXNoKHsKKysJICAgICAgICAgICAg
ICBsaW5lOiB1dGlsLmdldEFyZyhtYXBwaW5nLCAnZ2VuZXJhdGVkTGluZScsIG51bGwpLAorKwkg
ICAgICAgICAgICAgIGNvbHVtbjogdXRpbC5nZXRBcmcobWFwcGluZywgJ2dlbmVyYXRlZENvbHVt
bicsIG51bGwpLAorKwkgICAgICAgICAgICAgIGxhc3RDb2x1bW46IHV0aWwuZ2V0QXJnKG1hcHBp
bmcsICdsYXN0R2VuZXJhdGVkQ29sdW1uJywgbnVsbCkKKysJICAgICAgICAgICAgfSk7CisrCisr
CSAgICAgICAgICAgIG1hcHBpbmcgPSB0aGlzLl9vcmlnaW5hbE1hcHBpbmdzWysraW5kZXhdOwor
KwkgICAgICAgICAgfQorKwkgICAgICAgIH0KKysJICAgICAgfQorKworKwkgICAgICByZXR1cm4g
bWFwcGluZ3M7CisrCSAgICB9OworKworKwkgIGV4cG9ydHMuU291cmNlTWFwQ29uc3VtZXIgPSBT
b3VyY2VNYXBDb25zdW1lcjsKKysKKysJICAvKioKKysJICAgKiBBIEJhc2ljU291cmNlTWFwQ29u
c3VtZXIgaW5zdGFuY2UgcmVwcmVzZW50cyBhIHBhcnNlZCBzb3VyY2UgbWFwIHdoaWNoIHdlIGNh
bgorKwkgICAqIHF1ZXJ5IGZvciBpbmZvcm1hdGlvbiBhYm91dCB0aGUgb3JpZ2luYWwgZmlsZSBw
b3NpdGlvbnMgYnkgZ2l2aW5nIGl0IGEgZmlsZQorKwkgICAqIHBvc2l0aW9uIGluIHRoZSBnZW5l
cmF0ZWQgc291cmNlLgorKwkgICAqCisrCSAgICogVGhlIG9ubHkgcGFyYW1ldGVyIGlzIHRoZSBy
YXcgc291cmNlIG1hcCAoZWl0aGVyIGFzIGEgSlNPTiBzdHJpbmcsIG9yCisrCSAgICogYWxyZWFk
eSBwYXJzZWQgdG8gYW4gb2JqZWN0KS4gQWNjb3JkaW5nIHRvIHRoZSBzcGVjLCBzb3VyY2UgbWFw
cyBoYXZlIHRoZQorKwkgICAqIGZvbGxvd2luZyBhdHRyaWJ1dGVzOgorKwkgICAqCisrCSAgICog
ICAtIHZlcnNpb246IFdoaWNoIHZlcnNpb24gb2YgdGhlIHNvdXJjZSBtYXAgc3BlYyB0aGlzIG1h
cCBpcyBmb2xsb3dpbmcuCisrCSAgICogICAtIHNvdXJjZXM6IEFuIGFycmF5IG9mIFVSTHMgdG8g
dGhlIG9yaWdpbmFsIHNvdXJjZSBmaWxlcy4KKysJICAgKiAgIC0gbmFtZXM6IEFuIGFycmF5IG9m
IGlkZW50aWZpZXJzIHdoaWNoIGNhbiBiZSByZWZlcnJlbmNlZCBieSBpbmRpdmlkdWFsIG1hcHBp
bmdzLgorKwkgICAqICAgLSBzb3VyY2VSb290OiBPcHRpb25hbC4gVGhlIFVSTCByb290IGZyb20g
d2hpY2ggYWxsIHNvdXJjZXMgYXJlIHJlbGF0aXZlLgorKwkgICAqICAgLSBzb3VyY2VzQ29udGVu
dDogT3B0aW9uYWwuIEFuIGFycmF5IG9mIGNvbnRlbnRzIG9mIHRoZSBvcmlnaW5hbCBzb3VyY2Ug
ZmlsZXMuCisrCSAgICogICAtIG1hcHBpbmdzOiBBIHN0cmluZyBvZiBiYXNlNjQgVkxRcyB3aGlj
aCBjb250YWluIHRoZSBhY3R1YWwgbWFwcGluZ3MuCisrCSAgICogICAtIGZpbGU6IE9wdGlvbmFs
LiBUaGUgZ2VuZXJhdGVkIGZpbGUgdGhpcyBzb3VyY2UgbWFwIGlzIGFzc29jaWF0ZWQgd2l0aC4K
KysJICAgKgorKwkgICAqIEhlcmUgaXMgYW4gZXhhbXBsZSBzb3VyY2UgbWFwLCB0YWtlbiBmcm9t
IHRoZSBzb3VyY2UgbWFwIHNwZWNbMF06CisrCSAgICoKKysJICAgKiAgICAgeworKwkgICAqICAg
ICAgIHZlcnNpb24gOiAzLAorKwkgICAqICAgICAgIGZpbGU6ICJvdXQuanMiLAorKwkgICAqICAg
ICAgIHNvdXJjZVJvb3QgOiAiIiwKKysJICAgKiAgICAgICBzb3VyY2VzOiBbImZvby5qcyIsICJi
YXIuanMiXSwKKysJICAgKiAgICAgICBuYW1lczogWyJzcmMiLCAibWFwcyIsICJhcmUiLCAiZnVu
Il0sCisrCSAgICogICAgICAgbWFwcGluZ3M6ICJBQSxBQjs7QUJDREU7IgorKwkgICAqICAgICB9
CisrCSAgICoKKysJICAgKiBbMF06IGh0dHBzOi8vZG9jcy5nb29nbGUuY29tL2RvY3VtZW50L2Qv
MVUxUkdBZWhRd1J5cFVUb3ZGMUtSbHBpT0Z6ZTBiLV8yZ2M2ZkFIMEtZMGsvZWRpdD9wbGk9MSMK
KysJICAgKi8KKysJICBmdW5jdGlvbiBCYXNpY1NvdXJjZU1hcENvbnN1bWVyKGFTb3VyY2VNYXAp
IHsKKysJICAgIHZhciBzb3VyY2VNYXAgPSBhU291cmNlTWFwOworKwkgICAgaWYgKHR5cGVvZiBh
U291cmNlTWFwID09PSAnc3RyaW5nJykgeworKwkgICAgICBzb3VyY2VNYXAgPSBKU09OLnBhcnNl
KGFTb3VyY2VNYXAucmVwbGFjZSgvXlwpXF1cfScvLCAnJykpOworKwkgICAgfQorKworKwkgICAg
dmFyIHZlcnNpb24gPSB1dGlsLmdldEFyZyhzb3VyY2VNYXAsICd2ZXJzaW9uJyk7CisrCSAgICB2
YXIgc291cmNlcyA9IHV0aWwuZ2V0QXJnKHNvdXJjZU1hcCwgJ3NvdXJjZXMnKTsKKysJICAgIC8v
IFNhc3MgMy4zIGxlYXZlcyBvdXQgdGhlICduYW1lcycgYXJyYXksIHNvIHdlIGRldmlhdGUgZnJv
bSB0aGUgc3BlYyAod2hpY2gKKysJICAgIC8vIHJlcXVpcmVzIHRoZSBhcnJheSkgdG8gcGxheSBu
aWNlIGhlcmUuCisrCSAgICB2YXIgbmFtZXMgPSB1dGlsLmdldEFyZyhzb3VyY2VNYXAsICduYW1l
cycsIFtdKTsKKysJICAgIHZhciBzb3VyY2VSb290ID0gdXRpbC5nZXRBcmcoc291cmNlTWFwLCAn
c291cmNlUm9vdCcsIG51bGwpOworKwkgICAgdmFyIHNvdXJjZXNDb250ZW50ID0gdXRpbC5nZXRB
cmcoc291cmNlTWFwLCAnc291cmNlc0NvbnRlbnQnLCBudWxsKTsKKysJICAgIHZhciBtYXBwaW5n
cyA9IHV0aWwuZ2V0QXJnKHNvdXJjZU1hcCwgJ21hcHBpbmdzJyk7CisrCSAgICB2YXIgZmlsZSA9
IHV0aWwuZ2V0QXJnKHNvdXJjZU1hcCwgJ2ZpbGUnLCBudWxsKTsKKysKKysJICAgIC8vIE9uY2Ug
YWdhaW4sIFNhc3MgZGV2aWF0ZXMgZnJvbSB0aGUgc3BlYyBhbmQgc3VwcGxpZXMgdGhlIHZlcnNp
b24gYXMgYQorKwkgICAgLy8gc3RyaW5nIHJhdGhlciB0aGFuIGEgbnVtYmVyLCBzbyB3ZSB1c2Ug
bG9vc2UgZXF1YWxpdHkgY2hlY2tpbmcgaGVyZS4KKysJICAgIGlmICh2ZXJzaW9uICE9IHRoaXMu
X3ZlcnNpb24pIHsKKysJICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbnN1cHBvcnRlZCB2ZXJzaW9u
OiAnICsgdmVyc2lvbik7CisrCSAgICB9CisrCisrCSAgICBzb3VyY2VzID0gc291cmNlcworKwkg
ICAgICAvLyBTb21lIHNvdXJjZSBtYXBzIHByb2R1Y2UgcmVsYXRpdmUgc291cmNlIHBhdGhzIGxp
a2UgIi4vZm9vLmpzIiBpbnN0ZWFkIG9mCisrCSAgICAgIC8vICJmb28uanMiLiAgTm9ybWFsaXpl
IHRoZXNlIGZpcnN0IHNvIHRoYXQgZnV0dXJlIGNvbXBhcmlzb25zIHdpbGwgc3VjY2VlZC4KKysJ
ICAgICAgLy8gU2VlIGJ1Z3ppbC5sYS8xMDkwNzY4LgorKwkgICAgICAubWFwKHV0aWwubm9ybWFs
aXplKQorKwkgICAgICAvLyBBbHdheXMgZW5zdXJlIHRoYXQgYWJzb2x1dGUgc291cmNlcyBhcmUg
aW50ZXJuYWxseSBzdG9yZWQgcmVsYXRpdmUgdG8KKysJICAgICAgLy8gdGhlIHNvdXJjZSByb290
LCBpZiB0aGUgc291cmNlIHJvb3QgaXMgYWJzb2x1dGUuIE5vdCBkb2luZyB0aGlzIHdvdWxkCisr
CSAgICAgIC8vIGJlIHBhcnRpY3VsYXJseSBwcm9ibGVtYXRpYyB3aGVuIHRoZSBzb3VyY2Ugcm9v
dCBpcyBhIHByZWZpeCBvZiB0aGUKKysJICAgICAgLy8gc291cmNlICh2YWxpZCwgYnV0IHdoeT8/
KS4gU2VlIGdpdGh1YiBpc3N1ZSAjMTk5IGFuZCBidWd6aWwubGEvMTE4ODk4Mi4KKysJICAgICAg
Lm1hcChmdW5jdGlvbiAoc291cmNlKSB7CisrCSAgICAgICAgcmV0dXJuIHNvdXJjZVJvb3QgJiYg
dXRpbC5pc0Fic29sdXRlKHNvdXJjZVJvb3QpICYmIHV0aWwuaXNBYnNvbHV0ZShzb3VyY2UpCisr
CSAgICAgICAgICA/IHV0aWwucmVsYXRpdmUoc291cmNlUm9vdCwgc291cmNlKQorKwkgICAgICAg
ICAgOiBzb3VyY2U7CisrCSAgICAgIH0pOworKworKwkgICAgLy8gUGFzcyBgdHJ1ZWAgYmVsb3cg
dG8gYWxsb3cgZHVwbGljYXRlIG5hbWVzIGFuZCBzb3VyY2VzLiBXaGlsZSBzb3VyY2UgbWFwcwor
KwkgICAgLy8gYXJlIGludGVuZGVkIHRvIGJlIGNvbXByZXNzZWQgYW5kIGRlZHVwbGljYXRlZCwg
dGhlIFR5cGVTY3JpcHQgY29tcGlsZXIKKysJICAgIC8vIHNvbWV0aW1lcyBnZW5lcmF0ZXMgc291
cmNlIG1hcHMgd2l0aCBkdXBsaWNhdGVzIGluIHRoZW0uIFNlZSBHaXRodWIgaXNzdWUKKysJICAg
IC8vICM3MiBhbmQgYnVnemlsLmxhLzg4OTQ5Mi4KKysJICAgIHRoaXMuX25hbWVzID0gQXJyYXlT
ZXQuZnJvbUFycmF5KG5hbWVzLCB0cnVlKTsKKysJICAgIHRoaXMuX3NvdXJjZXMgPSBBcnJheVNl
dC5mcm9tQXJyYXkoc291cmNlcywgdHJ1ZSk7CisrCisrCSAgICB0aGlzLnNvdXJjZVJvb3QgPSBz
b3VyY2VSb290OworKwkgICAgdGhpcy5zb3VyY2VzQ29udGVudCA9IHNvdXJjZXNDb250ZW50Owor
KwkgICAgdGhpcy5fbWFwcGluZ3MgPSBtYXBwaW5nczsKKysJICAgIHRoaXMuZmlsZSA9IGZpbGU7
CisrCSAgfQorKworKwkgIEJhc2ljU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlID0gT2JqZWN0
LmNyZWF0ZShTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUpOworKwkgIEJhc2ljU291cmNlTWFw
Q29uc3VtZXIucHJvdG90eXBlLmNvbnN1bWVyID0gU291cmNlTWFwQ29uc3VtZXI7CisrCisrCSAg
LyoqCisrCSAgICogQ3JlYXRlIGEgQmFzaWNTb3VyY2VNYXBDb25zdW1lciBmcm9tIGEgU291cmNl
TWFwR2VuZXJhdG9yLgorKwkgICAqCisrCSAgICogQHBhcmFtIFNvdXJjZU1hcEdlbmVyYXRvciBh
U291cmNlTWFwCisrCSAgICogICAgICAgIFRoZSBzb3VyY2UgbWFwIHRoYXQgd2lsbCBiZSBjb25z
dW1lZC4KKysJICAgKiBAcmV0dXJucyBCYXNpY1NvdXJjZU1hcENvbnN1bWVyCisrCSAgICovCisr
CSAgQmFzaWNTb3VyY2VNYXBDb25zdW1lci5mcm9tU291cmNlTWFwID0KKysJICAgIGZ1bmN0aW9u
IFNvdXJjZU1hcENvbnN1bWVyX2Zyb21Tb3VyY2VNYXAoYVNvdXJjZU1hcCkgeworKwkgICAgICB2
YXIgc21jID0gT2JqZWN0LmNyZWF0ZShCYXNpY1NvdXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZSk7
CisrCisrCSAgICAgIHZhciBuYW1lcyA9IHNtYy5fbmFtZXMgPSBBcnJheVNldC5mcm9tQXJyYXko
YVNvdXJjZU1hcC5fbmFtZXMudG9BcnJheSgpLCB0cnVlKTsKKysJICAgICAgdmFyIHNvdXJjZXMg
PSBzbWMuX3NvdXJjZXMgPSBBcnJheVNldC5mcm9tQXJyYXkoYVNvdXJjZU1hcC5fc291cmNlcy50
b0FycmF5KCksIHRydWUpOworKwkgICAgICBzbWMuc291cmNlUm9vdCA9IGFTb3VyY2VNYXAuX3Nv
dXJjZVJvb3Q7CisrCSAgICAgIHNtYy5zb3VyY2VzQ29udGVudCA9IGFTb3VyY2VNYXAuX2dlbmVy
YXRlU291cmNlc0NvbnRlbnQoc21jLl9zb3VyY2VzLnRvQXJyYXkoKSwKKysJICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbWMuc291
cmNlUm9vdCk7CisrCSAgICAgIHNtYy5maWxlID0gYVNvdXJjZU1hcC5fZmlsZTsKKysKKysJICAg
ICAgLy8gQmVjYXVzZSB3ZSBhcmUgbW9kaWZ5aW5nIHRoZSBlbnRyaWVzIChieSBjb252ZXJ0aW5n
IHN0cmluZyBzb3VyY2VzIGFuZAorKwkgICAgICAvLyBuYW1lcyB0byBpbmRpY2VzIGludG8gdGhl
IHNvdXJjZXMgYW5kIG5hbWVzIEFycmF5U2V0cyksIHdlIGhhdmUgdG8gbWFrZQorKwkgICAgICAv
LyBhIGNvcHkgb2YgdGhlIGVudHJ5IG9yIGVsc2UgYmFkIHRoaW5ncyBoYXBwZW4uIFNoYXJlZCBt
dXRhYmxlIHN0YXRlCisrCSAgICAgIC8vIHN0cmlrZXMgYWdhaW4hIFNlZSBnaXRodWIgaXNzdWUg
IzE5MS4KKysKKysJICAgICAgdmFyIGdlbmVyYXRlZE1hcHBpbmdzID0gYVNvdXJjZU1hcC5fbWFw
cGluZ3MudG9BcnJheSgpLnNsaWNlKCk7CisrCSAgICAgIHZhciBkZXN0R2VuZXJhdGVkTWFwcGlu
Z3MgPSBzbWMuX19nZW5lcmF0ZWRNYXBwaW5ncyA9IFtdOworKwkgICAgICB2YXIgZGVzdE9yaWdp
bmFsTWFwcGluZ3MgPSBzbWMuX19vcmlnaW5hbE1hcHBpbmdzID0gW107CisrCisrCSAgICAgIGZv
ciAodmFyIGkgPSAwLCBsZW5ndGggPSBnZW5lcmF0ZWRNYXBwaW5ncy5sZW5ndGg7IGkgPCBsZW5n
dGg7IGkrKykgeworKwkgICAgICAgIHZhciBzcmNNYXBwaW5nID0gZ2VuZXJhdGVkTWFwcGluZ3Nb
aV07CisrCSAgICAgICAgdmFyIGRlc3RNYXBwaW5nID0gbmV3IE1hcHBpbmc7CisrCSAgICAgICAg
ZGVzdE1hcHBpbmcuZ2VuZXJhdGVkTGluZSA9IHNyY01hcHBpbmcuZ2VuZXJhdGVkTGluZTsKKysJ
ICAgICAgICBkZXN0TWFwcGluZy5nZW5lcmF0ZWRDb2x1bW4gPSBzcmNNYXBwaW5nLmdlbmVyYXRl
ZENvbHVtbjsKKysKKysJICAgICAgICBpZiAoc3JjTWFwcGluZy5zb3VyY2UpIHsKKysJICAgICAg
ICAgIGRlc3RNYXBwaW5nLnNvdXJjZSA9IHNvdXJjZXMuaW5kZXhPZihzcmNNYXBwaW5nLnNvdXJj
ZSk7CisrCSAgICAgICAgICBkZXN0TWFwcGluZy5vcmlnaW5hbExpbmUgPSBzcmNNYXBwaW5nLm9y
aWdpbmFsTGluZTsKKysJICAgICAgICAgIGRlc3RNYXBwaW5nLm9yaWdpbmFsQ29sdW1uID0gc3Jj
TWFwcGluZy5vcmlnaW5hbENvbHVtbjsKKysKKysJICAgICAgICAgIGlmIChzcmNNYXBwaW5nLm5h
bWUpIHsKKysJICAgICAgICAgICAgZGVzdE1hcHBpbmcubmFtZSA9IG5hbWVzLmluZGV4T2Yoc3Jj
TWFwcGluZy5uYW1lKTsKKysJICAgICAgICAgIH0KKysKKysJICAgICAgICAgIGRlc3RPcmlnaW5h
bE1hcHBpbmdzLnB1c2goZGVzdE1hcHBpbmcpOworKwkgICAgICAgIH0KKysKKysJICAgICAgICBk
ZXN0R2VuZXJhdGVkTWFwcGluZ3MucHVzaChkZXN0TWFwcGluZyk7CisrCSAgICAgIH0KKysKKysJ
ICAgICAgcXVpY2tTb3J0KHNtYy5fX29yaWdpbmFsTWFwcGluZ3MsIHV0aWwuY29tcGFyZUJ5T3Jp
Z2luYWxQb3NpdGlvbnMpOworKworKwkgICAgICByZXR1cm4gc21jOworKwkgICAgfTsKKysKKysJ
ICAvKioKKysJICAgKiBUaGUgdmVyc2lvbiBvZiB0aGUgc291cmNlIG1hcHBpbmcgc3BlYyB0aGF0
IHdlIGFyZSBjb25zdW1pbmcuCisrCSAgICovCisrCSAgQmFzaWNTb3VyY2VNYXBDb25zdW1lci5w
cm90b3R5cGUuX3ZlcnNpb24gPSAzOworKworKwkgIC8qKgorKwkgICAqIFRoZSBsaXN0IG9mIG9y
aWdpbmFsIHNvdXJjZXMuCisrCSAgICovCisrCSAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJhc2lj
U291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLCAnc291cmNlcycsIHsKKysJICAgIGdldDogZnVu
Y3Rpb24gKCkgeworKwkgICAgICByZXR1cm4gdGhpcy5fc291cmNlcy50b0FycmF5KCkubWFwKGZ1
bmN0aW9uIChzKSB7CisrCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlUm9vdCAhPSBudWxsID8g
dXRpbC5qb2luKHRoaXMuc291cmNlUm9vdCwgcykgOiBzOworKwkgICAgICB9LCB0aGlzKTsKKysJ
ICAgIH0KKysJICB9KTsKKysKKysJICAvKioKKysJICAgKiBQcm92aWRlIHRoZSBKSVQgd2l0aCBh
IG5pY2Ugc2hhcGUgLyBoaWRkZW4gY2xhc3MuCisrCSAgICovCisrCSAgZnVuY3Rpb24gTWFwcGlu
ZygpIHsKKysJICAgIHRoaXMuZ2VuZXJhdGVkTGluZSA9IDA7CisrCSAgICB0aGlzLmdlbmVyYXRl
ZENvbHVtbiA9IDA7CisrCSAgICB0aGlzLnNvdXJjZSA9IG51bGw7CisrCSAgICB0aGlzLm9yaWdp
bmFsTGluZSA9IG51bGw7CisrCSAgICB0aGlzLm9yaWdpbmFsQ29sdW1uID0gbnVsbDsKKysJICAg
IHRoaXMubmFtZSA9IG51bGw7CisrCSAgfQorKworKwkgIC8qKgorKwkgICAqIFBhcnNlIHRoZSBt
YXBwaW5ncyBpbiBhIHN0cmluZyBpbiB0byBhIGRhdGEgc3RydWN0dXJlIHdoaWNoIHdlIGNhbiBl
YXNpbHkKKysJICAgKiBxdWVyeSAodGhlIG9yZGVyZWQgYXJyYXlzIGluIHRoZSBgdGhpcy5fX2dl
bmVyYXRlZE1hcHBpbmdzYCBhbmQKKysJICAgKiBgdGhpcy5fX29yaWdpbmFsTWFwcGluZ3NgIHBy
b3BlcnRpZXMpLgorKwkgICAqLworKwkgIEJhc2ljU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBl
Ll9wYXJzZU1hcHBpbmdzID0KKysJICAgIGZ1bmN0aW9uIFNvdXJjZU1hcENvbnN1bWVyX3BhcnNl
TWFwcGluZ3MoYVN0ciwgYVNvdXJjZVJvb3QpIHsKKysJICAgICAgdmFyIGdlbmVyYXRlZExpbmUg
PSAxOworKwkgICAgICB2YXIgcHJldmlvdXNHZW5lcmF0ZWRDb2x1bW4gPSAwOworKwkgICAgICB2
YXIgcHJldmlvdXNPcmlnaW5hbExpbmUgPSAwOworKwkgICAgICB2YXIgcHJldmlvdXNPcmlnaW5h
bENvbHVtbiA9IDA7CisrCSAgICAgIHZhciBwcmV2aW91c1NvdXJjZSA9IDA7CisrCSAgICAgIHZh
ciBwcmV2aW91c05hbWUgPSAwOworKwkgICAgICB2YXIgbGVuZ3RoID0gYVN0ci5sZW5ndGg7Cisr
CSAgICAgIHZhciBpbmRleCA9IDA7CisrCSAgICAgIHZhciBjYWNoZWRTZWdtZW50cyA9IHt9Owor
KwkgICAgICB2YXIgdGVtcCA9IHt9OworKwkgICAgICB2YXIgb3JpZ2luYWxNYXBwaW5ncyA9IFtd
OworKwkgICAgICB2YXIgZ2VuZXJhdGVkTWFwcGluZ3MgPSBbXTsKKysJICAgICAgdmFyIG1hcHBp
bmcsIHN0ciwgc2VnbWVudCwgZW5kLCB2YWx1ZTsKKysKKysJICAgICAgd2hpbGUgKGluZGV4IDwg
bGVuZ3RoKSB7CisrCSAgICAgICAgaWYgKGFTdHIuY2hhckF0KGluZGV4KSA9PT0gJzsnKSB7Cisr
CSAgICAgICAgICBnZW5lcmF0ZWRMaW5lKys7CisrCSAgICAgICAgICBpbmRleCsrOworKwkgICAg
ICAgICAgcHJldmlvdXNHZW5lcmF0ZWRDb2x1bW4gPSAwOworKwkgICAgICAgIH0KKysJICAgICAg
ICBlbHNlIGlmIChhU3RyLmNoYXJBdChpbmRleCkgPT09ICcsJykgeworKwkgICAgICAgICAgaW5k
ZXgrKzsKKysJICAgICAgICB9CisrCSAgICAgICAgZWxzZSB7CisrCSAgICAgICAgICBtYXBwaW5n
ID0gbmV3IE1hcHBpbmcoKTsKKysJICAgICAgICAgIG1hcHBpbmcuZ2VuZXJhdGVkTGluZSA9IGdl
bmVyYXRlZExpbmU7CisrCisrCSAgICAgICAgICAvLyBCZWNhdXNlIGVhY2ggb2Zmc2V0IGlzIGVu
Y29kZWQgcmVsYXRpdmUgdG8gdGhlIHByZXZpb3VzIG9uZSwKKysJICAgICAgICAgIC8vIG1hbnkg
c2VnbWVudHMgb2Z0ZW4gaGF2ZSB0aGUgc2FtZSBlbmNvZGluZy4gV2UgY2FuIGV4cGxvaXQgdGhp
cworKwkgICAgICAgICAgLy8gZmFjdCBieSBjYWNoaW5nIHRoZSBwYXJzZWQgdmFyaWFibGUgbGVu
Z3RoIGZpZWxkcyBvZiBlYWNoIHNlZ21lbnQsCisrCSAgICAgICAgICAvLyBhbGxvd2luZyB1cyB0
byBhdm9pZCBhIHNlY29uZCBwYXJzZSBpZiB3ZSBlbmNvdW50ZXIgdGhlIHNhbWUKKysJICAgICAg
ICAgIC8vIHNlZ21lbnQgYWdhaW4uCisrCSAgICAgICAgICBmb3IgKGVuZCA9IGluZGV4OyBlbmQg
PCBsZW5ndGg7IGVuZCsrKSB7CisrCSAgICAgICAgICAgIGlmICh0aGlzLl9jaGFySXNNYXBwaW5n
U2VwYXJhdG9yKGFTdHIsIGVuZCkpIHsKKysJICAgICAgICAgICAgICBicmVhazsKKysJICAgICAg
ICAgICAgfQorKwkgICAgICAgICAgfQorKwkgICAgICAgICAgc3RyID0gYVN0ci5zbGljZShpbmRl
eCwgZW5kKTsKKysKKysJICAgICAgICAgIHNlZ21lbnQgPSBjYWNoZWRTZWdtZW50c1tzdHJdOwor
KwkgICAgICAgICAgaWYgKHNlZ21lbnQpIHsKKysJICAgICAgICAgICAgaW5kZXggKz0gc3RyLmxl
bmd0aDsKKysJICAgICAgICAgIH0gZWxzZSB7CisrCSAgICAgICAgICAgIHNlZ21lbnQgPSBbXTsK
KysJICAgICAgICAgICAgd2hpbGUgKGluZGV4IDwgZW5kKSB7CisrCSAgICAgICAgICAgICAgYmFz
ZTY0VkxRLmRlY29kZShhU3RyLCBpbmRleCwgdGVtcCk7CisrCSAgICAgICAgICAgICAgdmFsdWUg
PSB0ZW1wLnZhbHVlOworKwkgICAgICAgICAgICAgIGluZGV4ID0gdGVtcC5yZXN0OworKwkgICAg
ICAgICAgICAgIHNlZ21lbnQucHVzaCh2YWx1ZSk7CisrCSAgICAgICAgICAgIH0KKysKKysJICAg
ICAgICAgICAgaWYgKHNlZ21lbnQubGVuZ3RoID09PSAyKSB7CisrCSAgICAgICAgICAgICAgdGhy
b3cgbmV3IEVycm9yKCdGb3VuZCBhIHNvdXJjZSwgYnV0IG5vIGxpbmUgYW5kIGNvbHVtbicpOwor
KwkgICAgICAgICAgICB9CisrCisrCSAgICAgICAgICAgIGlmIChzZWdtZW50Lmxlbmd0aCA9PT0g
MykgeworKwkgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRm91bmQgYSBzb3VyY2UgYW5k
IGxpbmUsIGJ1dCBubyBjb2x1bW4nKTsKKysJICAgICAgICAgICAgfQorKworKwkgICAgICAgICAg
ICBjYWNoZWRTZWdtZW50c1tzdHJdID0gc2VnbWVudDsKKysJICAgICAgICAgIH0KKysKKysJICAg
ICAgICAgIC8vIEdlbmVyYXRlZCBjb2x1bW4uCisrCSAgICAgICAgICBtYXBwaW5nLmdlbmVyYXRl
ZENvbHVtbiA9IHByZXZpb3VzR2VuZXJhdGVkQ29sdW1uICsgc2VnbWVudFswXTsKKysJICAgICAg
ICAgIHByZXZpb3VzR2VuZXJhdGVkQ29sdW1uID0gbWFwcGluZy5nZW5lcmF0ZWRDb2x1bW47Cisr
CisrCSAgICAgICAgICBpZiAoc2VnbWVudC5sZW5ndGggPiAxKSB7CisrCSAgICAgICAgICAgIC8v
IE9yaWdpbmFsIHNvdXJjZS4KKysJICAgICAgICAgICAgbWFwcGluZy5zb3VyY2UgPSBwcmV2aW91
c1NvdXJjZSArIHNlZ21lbnRbMV07CisrCSAgICAgICAgICAgIHByZXZpb3VzU291cmNlICs9IHNl
Z21lbnRbMV07CisrCisrCSAgICAgICAgICAgIC8vIE9yaWdpbmFsIGxpbmUuCisrCSAgICAgICAg
ICAgIG1hcHBpbmcub3JpZ2luYWxMaW5lID0gcHJldmlvdXNPcmlnaW5hbExpbmUgKyBzZWdtZW50
WzJdOworKwkgICAgICAgICAgICBwcmV2aW91c09yaWdpbmFsTGluZSA9IG1hcHBpbmcub3JpZ2lu
YWxMaW5lOworKwkgICAgICAgICAgICAvLyBMaW5lcyBhcmUgc3RvcmVkIDAtYmFzZWQKKysJICAg
ICAgICAgICAgbWFwcGluZy5vcmlnaW5hbExpbmUgKz0gMTsKKysKKysJICAgICAgICAgICAgLy8g
T3JpZ2luYWwgY29sdW1uLgorKwkgICAgICAgICAgICBtYXBwaW5nLm9yaWdpbmFsQ29sdW1uID0g
cHJldmlvdXNPcmlnaW5hbENvbHVtbiArIHNlZ21lbnRbM107CisrCSAgICAgICAgICAgIHByZXZp
b3VzT3JpZ2luYWxDb2x1bW4gPSBtYXBwaW5nLm9yaWdpbmFsQ29sdW1uOworKworKwkgICAgICAg
ICAgICBpZiAoc2VnbWVudC5sZW5ndGggPiA0KSB7CisrCSAgICAgICAgICAgICAgLy8gT3JpZ2lu
YWwgbmFtZS4KKysJICAgICAgICAgICAgICBtYXBwaW5nLm5hbWUgPSBwcmV2aW91c05hbWUgKyBz
ZWdtZW50WzRdOworKwkgICAgICAgICAgICAgIHByZXZpb3VzTmFtZSArPSBzZWdtZW50WzRdOwor
KwkgICAgICAgICAgICB9CisrCSAgICAgICAgICB9CisrCisrCSAgICAgICAgICBnZW5lcmF0ZWRN
YXBwaW5ncy5wdXNoKG1hcHBpbmcpOworKwkgICAgICAgICAgaWYgKHR5cGVvZiBtYXBwaW5nLm9y
aWdpbmFsTGluZSA9PT0gJ251bWJlcicpIHsKKysJICAgICAgICAgICAgb3JpZ2luYWxNYXBwaW5n
cy5wdXNoKG1hcHBpbmcpOworKwkgICAgICAgICAgfQorKwkgICAgICAgIH0KKysJICAgICAgfQor
KworKwkgICAgICBxdWlja1NvcnQoZ2VuZXJhdGVkTWFwcGluZ3MsIHV0aWwuY29tcGFyZUJ5R2Vu
ZXJhdGVkUG9zaXRpb25zRGVmbGF0ZWQpOworKwkgICAgICB0aGlzLl9fZ2VuZXJhdGVkTWFwcGlu
Z3MgPSBnZW5lcmF0ZWRNYXBwaW5nczsKKysKKysJICAgICAgcXVpY2tTb3J0KG9yaWdpbmFsTWFw
cGluZ3MsIHV0aWwuY29tcGFyZUJ5T3JpZ2luYWxQb3NpdGlvbnMpOworKwkgICAgICB0aGlzLl9f
b3JpZ2luYWxNYXBwaW5ncyA9IG9yaWdpbmFsTWFwcGluZ3M7CisrCSAgICB9OworKworKwkgIC8q
KgorKwkgICAqIEZpbmQgdGhlIG1hcHBpbmcgdGhhdCBiZXN0IG1hdGNoZXMgdGhlIGh5cG90aGV0
aWNhbCAibmVlZGxlIiBtYXBwaW5nIHRoYXQKKysJICAgKiB3ZSBhcmUgc2VhcmNoaW5nIGZvciBp
biB0aGUgZ2l2ZW4gImhheXN0YWNrIiBvZiBtYXBwaW5ncy4KKysJICAgKi8KKysJICBCYXNpY1Nv
dXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZS5fZmluZE1hcHBpbmcgPQorKwkgICAgZnVuY3Rpb24g
U291cmNlTWFwQ29uc3VtZXJfZmluZE1hcHBpbmcoYU5lZWRsZSwgYU1hcHBpbmdzLCBhTGluZU5h
bWUsCisrCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhQ29sdW1u
TmFtZSwgYUNvbXBhcmF0b3IsIGFCaWFzKSB7CisrCSAgICAgIC8vIFRvIHJldHVybiB0aGUgcG9z
aXRpb24gd2UgYXJlIHNlYXJjaGluZyBmb3IsIHdlIG11c3QgZmlyc3QgZmluZCB0aGUKKysJICAg
ICAgLy8gbWFwcGluZyBmb3IgdGhlIGdpdmVuIHBvc2l0aW9uIGFuZCB0aGVuIHJldHVybiB0aGUg
b3Bwb3NpdGUgcG9zaXRpb24gaXQKKysJICAgICAgLy8gcG9pbnRzIHRvLiBCZWNhdXNlIHRoZSBt
YXBwaW5ncyBhcmUgc29ydGVkLCB3ZSBjYW4gdXNlIGJpbmFyeSBzZWFyY2ggdG8KKysJICAgICAg
Ly8gZmluZCB0aGUgYmVzdCBtYXBwaW5nLgorKworKwkgICAgICBpZiAoYU5lZWRsZVthTGluZU5h
bWVdIDw9IDApIHsKKysJICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdMaW5lIG11c3QgYmUg
Z3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIDEsIGdvdCAnCisrCSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICArIGFOZWVkbGVbYUxpbmVOYW1lXSk7CisrCSAgICAgIH0KKysJICAgICAgaWYgKGFO
ZWVkbGVbYUNvbHVtbk5hbWVdIDwgMCkgeworKwkgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3Io
J0NvbHVtbiBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAwLCBnb3QgJworKwkgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgKyBhTmVlZGxlW2FDb2x1bW5OYW1lXSk7CisrCSAgICAg
IH0KKysKKysJICAgICAgcmV0dXJuIGJpbmFyeVNlYXJjaC5zZWFyY2goYU5lZWRsZSwgYU1hcHBp
bmdzLCBhQ29tcGFyYXRvciwgYUJpYXMpOworKwkgICAgfTsKKysKKysJICAvKioKKysJICAgKiBD
b21wdXRlIHRoZSBsYXN0IGNvbHVtbiBmb3IgZWFjaCBnZW5lcmF0ZWQgbWFwcGluZy4gVGhlIGxh
c3QgY29sdW1uIGlzCisrCSAgICogaW5jbHVzaXZlLgorKwkgICAqLworKwkgIEJhc2ljU291cmNl
TWFwQ29uc3VtZXIucHJvdG90eXBlLmNvbXB1dGVDb2x1bW5TcGFucyA9CisrCSAgICBmdW5jdGlv
biBTb3VyY2VNYXBDb25zdW1lcl9jb21wdXRlQ29sdW1uU3BhbnMoKSB7CisrCSAgICAgIGZvciAo
dmFyIGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLl9nZW5lcmF0ZWRNYXBwaW5ncy5sZW5ndGg7ICsr
aW5kZXgpIHsKKysJICAgICAgICB2YXIgbWFwcGluZyA9IHRoaXMuX2dlbmVyYXRlZE1hcHBpbmdz
W2luZGV4XTsKKysKKysJICAgICAgICAvLyBNYXBwaW5ncyBkbyBub3QgY29udGFpbiBhIGZpZWxk
IGZvciB0aGUgbGFzdCBnZW5lcmF0ZWQgY29sdW1udC4gV2UKKysJICAgICAgICAvLyBjYW4gY29t
ZSB1cCB3aXRoIGFuIG9wdGltaXN0aWMgZXN0aW1hdGUsIGhvd2V2ZXIsIGJ5IGFzc3VtaW5nIHRo
YXQKKysJICAgICAgICAvLyBtYXBwaW5ncyBhcmUgY29udGlndW91cyAoaS5lLiBnaXZlbiB0d28g
Y29uc2VjdXRpdmUgbWFwcGluZ3MsIHRoZQorKwkgICAgICAgIC8vIGZpcnN0IG1hcHBpbmcgZW5k
cyB3aGVyZSB0aGUgc2Vjb25kIG9uZSBzdGFydHMpLgorKwkgICAgICAgIGlmIChpbmRleCArIDEg
PCB0aGlzLl9nZW5lcmF0ZWRNYXBwaW5ncy5sZW5ndGgpIHsKKysJICAgICAgICAgIHZhciBuZXh0
TWFwcGluZyA9IHRoaXMuX2dlbmVyYXRlZE1hcHBpbmdzW2luZGV4ICsgMV07CisrCisrCSAgICAg
ICAgICBpZiAobWFwcGluZy5nZW5lcmF0ZWRMaW5lID09PSBuZXh0TWFwcGluZy5nZW5lcmF0ZWRM
aW5lKSB7CisrCSAgICAgICAgICAgIG1hcHBpbmcubGFzdEdlbmVyYXRlZENvbHVtbiA9IG5leHRN
YXBwaW5nLmdlbmVyYXRlZENvbHVtbiAtIDE7CisrCSAgICAgICAgICAgIGNvbnRpbnVlOworKwkg
ICAgICAgICAgfQorKwkgICAgICAgIH0KKysKKysJICAgICAgICAvLyBUaGUgbGFzdCBtYXBwaW5n
IGZvciBlYWNoIGxpbmUgc3BhbnMgdGhlIGVudGlyZSBsaW5lLgorKwkgICAgICAgIG1hcHBpbmcu
bGFzdEdlbmVyYXRlZENvbHVtbiA9IEluZmluaXR5OworKwkgICAgICB9CisrCSAgICB9OworKwor
KwkgIC8qKgorKwkgICAqIFJldHVybnMgdGhlIG9yaWdpbmFsIHNvdXJjZSwgbGluZSwgYW5kIGNv
bHVtbiBpbmZvcm1hdGlvbiBmb3IgdGhlIGdlbmVyYXRlZAorKwkgICAqIHNvdXJjZSdzIGxpbmUg
YW5kIGNvbHVtbiBwb3NpdGlvbnMgcHJvdmlkZWQuIFRoZSBvbmx5IGFyZ3VtZW50IGlzIGFuIG9i
amVjdAorKwkgICAqIHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOgorKwkgICAqCisrCSAg
ICogICAtIGxpbmU6IFRoZSBsaW5lIG51bWJlciBpbiB0aGUgZ2VuZXJhdGVkIHNvdXJjZS4KKysJ
ICAgKiAgIC0gY29sdW1uOiBUaGUgY29sdW1uIG51bWJlciBpbiB0aGUgZ2VuZXJhdGVkIHNvdXJj
ZS4KKysJICAgKiAgIC0gYmlhczogRWl0aGVyICdTb3VyY2VNYXBDb25zdW1lci5HUkVBVEVTVF9M
T1dFUl9CT1VORCcgb3IKKysJICAgKiAgICAgJ1NvdXJjZU1hcENvbnN1bWVyLkxFQVNUX1VQUEVS
X0JPVU5EJy4gU3BlY2lmaWVzIHdoZXRoZXIgdG8gcmV0dXJuIHRoZQorKwkgICAqICAgICBjbG9z
ZXN0IGVsZW1lbnQgdGhhdCBpcyBzbWFsbGVyIHRoYW4gb3IgZ3JlYXRlciB0aGFuIHRoZSBvbmUg
d2UgYXJlCisrCSAgICogICAgIHNlYXJjaGluZyBmb3IsIHJlc3BlY3RpdmVseSwgaWYgdGhlIGV4
YWN0IGVsZW1lbnQgY2Fubm90IGJlIGZvdW5kLgorKwkgICAqICAgICBEZWZhdWx0cyB0byAnU291
cmNlTWFwQ29uc3VtZXIuR1JFQVRFU1RfTE9XRVJfQk9VTkQnLgorKwkgICAqCisrCSAgICogYW5k
IGFuIG9iamVjdCBpcyByZXR1cm5lZCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczoKKysJ
ICAgKgorKwkgICAqICAgLSBzb3VyY2U6IFRoZSBvcmlnaW5hbCBzb3VyY2UgZmlsZSwgb3IgbnVs
bC4KKysJICAgKiAgIC0gbGluZTogVGhlIGxpbmUgbnVtYmVyIGluIHRoZSBvcmlnaW5hbCBzb3Vy
Y2UsIG9yIG51bGwuCisrCSAgICogICAtIGNvbHVtbjogVGhlIGNvbHVtbiBudW1iZXIgaW4gdGhl
IG9yaWdpbmFsIHNvdXJjZSwgb3IgbnVsbC4KKysJICAgKiAgIC0gbmFtZTogVGhlIG9yaWdpbmFs
IGlkZW50aWZpZXIsIG9yIG51bGwuCisrCSAgICovCisrCSAgQmFzaWNTb3VyY2VNYXBDb25zdW1l
ci5wcm90b3R5cGUub3JpZ2luYWxQb3NpdGlvbkZvciA9CisrCSAgICBmdW5jdGlvbiBTb3VyY2VN
YXBDb25zdW1lcl9vcmlnaW5hbFBvc2l0aW9uRm9yKGFBcmdzKSB7CisrCSAgICAgIHZhciBuZWVk
bGUgPSB7CisrCSAgICAgICAgZ2VuZXJhdGVkTGluZTogdXRpbC5nZXRBcmcoYUFyZ3MsICdsaW5l
JyksCisrCSAgICAgICAgZ2VuZXJhdGVkQ29sdW1uOiB1dGlsLmdldEFyZyhhQXJncywgJ2NvbHVt
bicpCisrCSAgICAgIH07CisrCisrCSAgICAgIHZhciBpbmRleCA9IHRoaXMuX2ZpbmRNYXBwaW5n
KAorKwkgICAgICAgIG5lZWRsZSwKKysJICAgICAgICB0aGlzLl9nZW5lcmF0ZWRNYXBwaW5ncywK
KysJICAgICAgICAiZ2VuZXJhdGVkTGluZSIsCisrCSAgICAgICAgImdlbmVyYXRlZENvbHVtbiIs
CisrCSAgICAgICAgdXRpbC5jb21wYXJlQnlHZW5lcmF0ZWRQb3NpdGlvbnNEZWZsYXRlZCwKKysJ
ICAgICAgICB1dGlsLmdldEFyZyhhQXJncywgJ2JpYXMnLCBTb3VyY2VNYXBDb25zdW1lci5HUkVB
VEVTVF9MT1dFUl9CT1VORCkKKysJICAgICAgKTsKKysKKysJICAgICAgaWYgKGluZGV4ID49IDAp
IHsKKysJICAgICAgICB2YXIgbWFwcGluZyA9IHRoaXMuX2dlbmVyYXRlZE1hcHBpbmdzW2luZGV4
XTsKKysKKysJICAgICAgICBpZiAobWFwcGluZy5nZW5lcmF0ZWRMaW5lID09PSBuZWVkbGUuZ2Vu
ZXJhdGVkTGluZSkgeworKwkgICAgICAgICAgdmFyIHNvdXJjZSA9IHV0aWwuZ2V0QXJnKG1hcHBp
bmcsICdzb3VyY2UnLCBudWxsKTsKKysJICAgICAgICAgIGlmIChzb3VyY2UgIT09IG51bGwpIHsK
KysJICAgICAgICAgICAgc291cmNlID0gdGhpcy5fc291cmNlcy5hdChzb3VyY2UpOworKwkgICAg
ICAgICAgICBpZiAodGhpcy5zb3VyY2VSb290ICE9IG51bGwpIHsKKysJICAgICAgICAgICAgICBz
b3VyY2UgPSB1dGlsLmpvaW4odGhpcy5zb3VyY2VSb290LCBzb3VyY2UpOworKwkgICAgICAgICAg
ICB9CisrCSAgICAgICAgICB9CisrCSAgICAgICAgICB2YXIgbmFtZSA9IHV0aWwuZ2V0QXJnKG1h
cHBpbmcsICduYW1lJywgbnVsbCk7CisrCSAgICAgICAgICBpZiAobmFtZSAhPT0gbnVsbCkgewor
KwkgICAgICAgICAgICBuYW1lID0gdGhpcy5fbmFtZXMuYXQobmFtZSk7CisrCSAgICAgICAgICB9
CisrCSAgICAgICAgICByZXR1cm4geworKwkgICAgICAgICAgICBzb3VyY2U6IHNvdXJjZSwKKysJ
ICAgICAgICAgICAgbGluZTogdXRpbC5nZXRBcmcobWFwcGluZywgJ29yaWdpbmFsTGluZScsIG51
bGwpLAorKwkgICAgICAgICAgICBjb2x1bW46IHV0aWwuZ2V0QXJnKG1hcHBpbmcsICdvcmlnaW5h
bENvbHVtbicsIG51bGwpLAorKwkgICAgICAgICAgICBuYW1lOiBuYW1lCisrCSAgICAgICAgICB9
OworKwkgICAgICAgIH0KKysJICAgICAgfQorKworKwkgICAgICByZXR1cm4geworKwkgICAgICAg
IHNvdXJjZTogbnVsbCwKKysJICAgICAgICBsaW5lOiBudWxsLAorKwkgICAgICAgIGNvbHVtbjog
bnVsbCwKKysJICAgICAgICBuYW1lOiBudWxsCisrCSAgICAgIH07CisrCSAgICB9OworKworKwkg
IC8qKgorKwkgICAqIFJldHVybiB0cnVlIGlmIHdlIGhhdmUgdGhlIHNvdXJjZSBjb250ZW50IGZv
ciBldmVyeSBzb3VyY2UgaW4gdGhlIHNvdXJjZQorKwkgICAqIG1hcCwgZmFsc2Ugb3RoZXJ3aXNl
LgorKwkgICAqLworKwkgIEJhc2ljU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLmhhc0NvbnRl
bnRzT2ZBbGxTb3VyY2VzID0KKysJICAgIGZ1bmN0aW9uIEJhc2ljU291cmNlTWFwQ29uc3VtZXJf
aGFzQ29udGVudHNPZkFsbFNvdXJjZXMoKSB7CisrCSAgICAgIGlmICghdGhpcy5zb3VyY2VzQ29u
dGVudCkgeworKwkgICAgICAgIHJldHVybiBmYWxzZTsKKysJICAgICAgfQorKwkgICAgICByZXR1
cm4gdGhpcy5zb3VyY2VzQ29udGVudC5sZW5ndGggPj0gdGhpcy5fc291cmNlcy5zaXplKCkgJiYK
KysJICAgICAgICAhdGhpcy5zb3VyY2VzQ29udGVudC5zb21lKGZ1bmN0aW9uIChzYykgeyByZXR1
cm4gc2MgPT0gbnVsbDsgfSk7CisrCSAgICB9OworKworKwkgIC8qKgorKwkgICAqIFJldHVybnMg
dGhlIG9yaWdpbmFsIHNvdXJjZSBjb250ZW50LiBUaGUgb25seSBhcmd1bWVudCBpcyB0aGUgdXJs
IG9mIHRoZQorKwkgICAqIG9yaWdpbmFsIHNvdXJjZSBmaWxlLiBSZXR1cm5zIG51bGwgaWYgbm8g
b3JpZ2luYWwgc291cmNlIGNvbnRlbnQgaXMKKysJICAgKiBhdmFpbGFibGUuCisrCSAgICovCisr
CSAgQmFzaWNTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUuc291cmNlQ29udGVudEZvciA9Cisr
CSAgICBmdW5jdGlvbiBTb3VyY2VNYXBDb25zdW1lcl9zb3VyY2VDb250ZW50Rm9yKGFTb3VyY2Us
IG51bGxPbk1pc3NpbmcpIHsKKysJICAgICAgaWYgKCF0aGlzLnNvdXJjZXNDb250ZW50KSB7Cisr
CSAgICAgICAgcmV0dXJuIG51bGw7CisrCSAgICAgIH0KKysKKysJICAgICAgaWYgKHRoaXMuc291
cmNlUm9vdCAhPSBudWxsKSB7CisrCSAgICAgICAgYVNvdXJjZSA9IHV0aWwucmVsYXRpdmUodGhp
cy5zb3VyY2VSb290LCBhU291cmNlKTsKKysJICAgICAgfQorKworKwkgICAgICBpZiAodGhpcy5f
c291cmNlcy5oYXMoYVNvdXJjZSkpIHsKKysJICAgICAgICByZXR1cm4gdGhpcy5zb3VyY2VzQ29u
dGVudFt0aGlzLl9zb3VyY2VzLmluZGV4T2YoYVNvdXJjZSldOworKwkgICAgICB9CisrCisrCSAg
ICAgIHZhciB1cmw7CisrCSAgICAgIGlmICh0aGlzLnNvdXJjZVJvb3QgIT0gbnVsbAorKwkgICAg
ICAgICAgJiYgKHVybCA9IHV0aWwudXJsUGFyc2UodGhpcy5zb3VyY2VSb290KSkpIHsKKysJICAg
ICAgICAvLyBYWFg6IGZpbGU6Ly8gVVJJcyBhbmQgYWJzb2x1dGUgcGF0aHMgbGVhZCB0byB1bmV4
cGVjdGVkIGJlaGF2aW9yIGZvcgorKwkgICAgICAgIC8vIG1hbnkgdXNlcnMuIFdlIGNhbiBoZWxw
IHRoZW0gb3V0IHdoZW4gdGhleSBleHBlY3QgZmlsZTovLyBVUklzIHRvCisrCSAgICAgICAgLy8g
YmVoYXZlIGxpa2UgaXQgd291bGQgaWYgdGhleSB3ZXJlIHJ1bm5pbmcgYSBsb2NhbCBIVFRQIHNl
cnZlci4gU2VlCisrCSAgICAgICAgLy8gaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93
X2J1Zy5jZ2k/aWQ9ODg1NTk3LgorKwkgICAgICAgIHZhciBmaWxlVXJpQWJzUGF0aCA9IGFTb3Vy
Y2UucmVwbGFjZSgvXmZpbGU6XC9cLy8sICIiKTsKKysJICAgICAgICBpZiAodXJsLnNjaGVtZSA9
PSAiZmlsZSIKKysJICAgICAgICAgICAgJiYgdGhpcy5fc291cmNlcy5oYXMoZmlsZVVyaUFic1Bh
dGgpKSB7CisrCSAgICAgICAgICByZXR1cm4gdGhpcy5zb3VyY2VzQ29udGVudFt0aGlzLl9zb3Vy
Y2VzLmluZGV4T2YoZmlsZVVyaUFic1BhdGgpXQorKwkgICAgICAgIH0KKysKKysJICAgICAgICBp
ZiAoKCF1cmwucGF0aCB8fCB1cmwucGF0aCA9PSAiLyIpCisrCSAgICAgICAgICAgICYmIHRoaXMu
X3NvdXJjZXMuaGFzKCIvIiArIGFTb3VyY2UpKSB7CisrCSAgICAgICAgICByZXR1cm4gdGhpcy5z
b3VyY2VzQ29udGVudFt0aGlzLl9zb3VyY2VzLmluZGV4T2YoIi8iICsgYVNvdXJjZSldOworKwkg
ICAgICAgIH0KKysJICAgICAgfQorKworKwkgICAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQg
cmVjdXJzaXZlbHkgZnJvbQorKwkgICAgICAvLyBJbmRleGVkU291cmNlTWFwQ29uc3VtZXIucHJv
dG90eXBlLnNvdXJjZUNvbnRlbnRGb3IuIEluIHRoYXQgY2FzZSwgd2UKKysJICAgICAgLy8gZG9u
J3Qgd2FudCB0byB0aHJvdyBpZiB3ZSBjYW4ndCBmaW5kIHRoZSBzb3VyY2UgLSB3ZSBqdXN0IHdh
bnQgdG8KKysJICAgICAgLy8gcmV0dXJuIG51bGwsIHNvIHdlIHByb3ZpZGUgYSBmbGFnIHRvIGV4
aXQgZ3JhY2VmdWxseS4KKysJICAgICAgaWYgKG51bGxPbk1pc3NpbmcpIHsKKysJICAgICAgICBy
ZXR1cm4gbnVsbDsKKysJICAgICAgfQorKwkgICAgICBlbHNlIHsKKysJICAgICAgICB0aHJvdyBu
ZXcgRXJyb3IoJyInICsgYVNvdXJjZSArICciIGlzIG5vdCBpbiB0aGUgU291cmNlTWFwLicpOwor
KwkgICAgICB9CisrCSAgICB9OworKworKwkgIC8qKgorKwkgICAqIFJldHVybnMgdGhlIGdlbmVy
YXRlZCBsaW5lIGFuZCBjb2x1bW4gaW5mb3JtYXRpb24gZm9yIHRoZSBvcmlnaW5hbCBzb3VyY2Us
CisrCSAgICogbGluZSwgYW5kIGNvbHVtbiBwb3NpdGlvbnMgcHJvdmlkZWQuIFRoZSBvbmx5IGFy
Z3VtZW50IGlzIGFuIG9iamVjdCB3aXRoCisrCSAgICogdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVz
OgorKwkgICAqCisrCSAgICogICAtIHNvdXJjZTogVGhlIGZpbGVuYW1lIG9mIHRoZSBvcmlnaW5h
bCBzb3VyY2UuCisrCSAgICogICAtIGxpbmU6IFRoZSBsaW5lIG51bWJlciBpbiB0aGUgb3JpZ2lu
YWwgc291cmNlLgorKwkgICAqICAgLSBjb2x1bW46IFRoZSBjb2x1bW4gbnVtYmVyIGluIHRoZSBv
cmlnaW5hbCBzb3VyY2UuCisrCSAgICogICAtIGJpYXM6IEVpdGhlciAnU291cmNlTWFwQ29uc3Vt
ZXIuR1JFQVRFU1RfTE9XRVJfQk9VTkQnIG9yCisrCSAgICogICAgICdTb3VyY2VNYXBDb25zdW1l
ci5MRUFTVF9VUFBFUl9CT1VORCcuIFNwZWNpZmllcyB3aGV0aGVyIHRvIHJldHVybiB0aGUKKysJ
ICAgKiAgICAgY2xvc2VzdCBlbGVtZW50IHRoYXQgaXMgc21hbGxlciB0aGFuIG9yIGdyZWF0ZXIg
dGhhbiB0aGUgb25lIHdlIGFyZQorKwkgICAqICAgICBzZWFyY2hpbmcgZm9yLCByZXNwZWN0aXZl
bHksIGlmIHRoZSBleGFjdCBlbGVtZW50IGNhbm5vdCBiZSBmb3VuZC4KKysJICAgKiAgICAgRGVm
YXVsdHMgdG8gJ1NvdXJjZU1hcENvbnN1bWVyLkdSRUFURVNUX0xPV0VSX0JPVU5EJy4KKysJICAg
KgorKwkgICAqIGFuZCBhbiBvYmplY3QgaXMgcmV0dXJuZWQgd2l0aCB0aGUgZm9sbG93aW5nIHBy
b3BlcnRpZXM6CisrCSAgICoKKysJICAgKiAgIC0gbGluZTogVGhlIGxpbmUgbnVtYmVyIGluIHRo
ZSBnZW5lcmF0ZWQgc291cmNlLCBvciBudWxsLgorKwkgICAqICAgLSBjb2x1bW46IFRoZSBjb2x1
bW4gbnVtYmVyIGluIHRoZSBnZW5lcmF0ZWQgc291cmNlLCBvciBudWxsLgorKwkgICAqLworKwkg
IEJhc2ljU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLmdlbmVyYXRlZFBvc2l0aW9uRm9yID0K
KysJICAgIGZ1bmN0aW9uIFNvdXJjZU1hcENvbnN1bWVyX2dlbmVyYXRlZFBvc2l0aW9uRm9yKGFB
cmdzKSB7CisrCSAgICAgIHZhciBzb3VyY2UgPSB1dGlsLmdldEFyZyhhQXJncywgJ3NvdXJjZScp
OworKwkgICAgICBpZiAodGhpcy5zb3VyY2VSb290ICE9IG51bGwpIHsKKysJICAgICAgICBzb3Vy
Y2UgPSB1dGlsLnJlbGF0aXZlKHRoaXMuc291cmNlUm9vdCwgc291cmNlKTsKKysJICAgICAgfQor
KwkgICAgICBpZiAoIXRoaXMuX3NvdXJjZXMuaGFzKHNvdXJjZSkpIHsKKysJICAgICAgICByZXR1
cm4geworKwkgICAgICAgICAgbGluZTogbnVsbCwKKysJICAgICAgICAgIGNvbHVtbjogbnVsbCwK
KysJICAgICAgICAgIGxhc3RDb2x1bW46IG51bGwKKysJICAgICAgICB9OworKwkgICAgICB9Cisr
CSAgICAgIHNvdXJjZSA9IHRoaXMuX3NvdXJjZXMuaW5kZXhPZihzb3VyY2UpOworKworKwkgICAg
ICB2YXIgbmVlZGxlID0geworKwkgICAgICAgIHNvdXJjZTogc291cmNlLAorKwkgICAgICAgIG9y
aWdpbmFsTGluZTogdXRpbC5nZXRBcmcoYUFyZ3MsICdsaW5lJyksCisrCSAgICAgICAgb3JpZ2lu
YWxDb2x1bW46IHV0aWwuZ2V0QXJnKGFBcmdzLCAnY29sdW1uJykKKysJICAgICAgfTsKKysKKysJ
ICAgICAgdmFyIGluZGV4ID0gdGhpcy5fZmluZE1hcHBpbmcoCisrCSAgICAgICAgbmVlZGxlLAor
KwkgICAgICAgIHRoaXMuX29yaWdpbmFsTWFwcGluZ3MsCisrCSAgICAgICAgIm9yaWdpbmFsTGlu
ZSIsCisrCSAgICAgICAgIm9yaWdpbmFsQ29sdW1uIiwKKysJICAgICAgICB1dGlsLmNvbXBhcmVC
eU9yaWdpbmFsUG9zaXRpb25zLAorKwkgICAgICAgIHV0aWwuZ2V0QXJnKGFBcmdzLCAnYmlhcycs
IFNvdXJjZU1hcENvbnN1bWVyLkdSRUFURVNUX0xPV0VSX0JPVU5EKQorKwkgICAgICApOworKwor
KwkgICAgICBpZiAoaW5kZXggPj0gMCkgeworKwkgICAgICAgIHZhciBtYXBwaW5nID0gdGhpcy5f
b3JpZ2luYWxNYXBwaW5nc1tpbmRleF07CisrCisrCSAgICAgICAgaWYgKG1hcHBpbmcuc291cmNl
ID09PSBuZWVkbGUuc291cmNlKSB7CisrCSAgICAgICAgICByZXR1cm4geworKwkgICAgICAgICAg
ICBsaW5lOiB1dGlsLmdldEFyZyhtYXBwaW5nLCAnZ2VuZXJhdGVkTGluZScsIG51bGwpLAorKwkg
ICAgICAgICAgICBjb2x1bW46IHV0aWwuZ2V0QXJnKG1hcHBpbmcsICdnZW5lcmF0ZWRDb2x1bW4n
LCBudWxsKSwKKysJICAgICAgICAgICAgbGFzdENvbHVtbjogdXRpbC5nZXRBcmcobWFwcGluZywg
J2xhc3RHZW5lcmF0ZWRDb2x1bW4nLCBudWxsKQorKwkgICAgICAgICAgfTsKKysJICAgICAgICB9
CisrCSAgICAgIH0KKysKKysJICAgICAgcmV0dXJuIHsKKysJICAgICAgICBsaW5lOiBudWxsLAor
KwkgICAgICAgIGNvbHVtbjogbnVsbCwKKysJICAgICAgICBsYXN0Q29sdW1uOiBudWxsCisrCSAg
ICAgIH07CisrCSAgICB9OworKworKwkgIGV4cG9ydHMuQmFzaWNTb3VyY2VNYXBDb25zdW1lciA9
IEJhc2ljU291cmNlTWFwQ29uc3VtZXI7CisrCisrCSAgLyoqCisrCSAgICogQW4gSW5kZXhlZFNv
dXJjZU1hcENvbnN1bWVyIGluc3RhbmNlIHJlcHJlc2VudHMgYSBwYXJzZWQgc291cmNlIG1hcCB3
aGljaAorKwkgICAqIHdlIGNhbiBxdWVyeSBmb3IgaW5mb3JtYXRpb24uIEl0IGRpZmZlcnMgZnJv
bSBCYXNpY1NvdXJjZU1hcENvbnN1bWVyIGluCisrCSAgICogdGhhdCBpdCB0YWtlcyAiaW5kZXhl
ZCIgc291cmNlIG1hcHMgKGkuZS4gb25lcyB3aXRoIGEgInNlY3Rpb25zIiBmaWVsZCkgYXMKKysJ
ICAgKiBpbnB1dC4KKysJICAgKgorKwkgICAqIFRoZSBvbmx5IHBhcmFtZXRlciBpcyBhIHJhdyBz
b3VyY2UgbWFwIChlaXRoZXIgYXMgYSBKU09OIHN0cmluZywgb3IgYWxyZWFkeQorKwkgICAqIHBh
cnNlZCB0byBhbiBvYmplY3QpLiBBY2NvcmRpbmcgdG8gdGhlIHNwZWMgZm9yIGluZGV4ZWQgc291
cmNlIG1hcHMsIHRoZXkKKysJICAgKiBoYXZlIHRoZSBmb2xsb3dpbmcgYXR0cmlidXRlczoKKysJ
ICAgKgorKwkgICAqICAgLSB2ZXJzaW9uOiBXaGljaCB2ZXJzaW9uIG9mIHRoZSBzb3VyY2UgbWFw
IHNwZWMgdGhpcyBtYXAgaXMgZm9sbG93aW5nLgorKwkgICAqICAgLSBmaWxlOiBPcHRpb25hbC4g
VGhlIGdlbmVyYXRlZCBmaWxlIHRoaXMgc291cmNlIG1hcCBpcyBhc3NvY2lhdGVkIHdpdGguCisr
CSAgICogICAtIHNlY3Rpb25zOiBBIGxpc3Qgb2Ygc2VjdGlvbiBkZWZpbml0aW9ucy4KKysJICAg
KgorKwkgICAqIEVhY2ggdmFsdWUgdW5kZXIgdGhlICJzZWN0aW9ucyIgZmllbGQgaGFzIHR3byBm
aWVsZHM6CisrCSAgICogICAtIG9mZnNldDogVGhlIG9mZnNldCBpbnRvIHRoZSBvcmlnaW5hbCBz
cGVjaWZpZWQgYXQgd2hpY2ggdGhpcyBzZWN0aW9uCisrCSAgICogICAgICAgYmVnaW5zIHRvIGFw
cGx5LCBkZWZpbmVkIGFzIGFuIG9iamVjdCB3aXRoIGEgImxpbmUiIGFuZCAiY29sdW1uIgorKwkg
ICAqICAgICAgIGZpZWxkLgorKwkgICAqICAgLSBtYXA6IEEgc291cmNlIG1hcCBkZWZpbml0aW9u
LiBUaGlzIHNvdXJjZSBtYXAgY291bGQgYWxzbyBiZSBpbmRleGVkLAorKwkgICAqICAgICAgIGJ1
dCBkb2Vzbid0IGhhdmUgdG8gYmUuCisrCSAgICoKKysJICAgKiBJbnN0ZWFkIG9mIHRoZSAibWFw
IiBmaWVsZCwgaXQncyBhbHNvIHBvc3NpYmxlIHRvIGhhdmUgYSAidXJsIiBmaWVsZAorKwkgICAq
IHNwZWNpZnlpbmcgYSBVUkwgdG8gcmV0cmlldmUgYSBzb3VyY2UgbWFwIGZyb20sIGJ1dCB0aGF0
J3MgY3VycmVudGx5CisrCSAgICogdW5zdXBwb3J0ZWQuCisrCSAgICoKKysJICAgKiBIZXJlJ3Mg
YW4gZXhhbXBsZSBzb3VyY2UgbWFwLCB0YWtlbiBmcm9tIHRoZSBzb3VyY2UgbWFwIHNwZWNbMF0s
IGJ1dAorKwkgICAqIG1vZGlmaWVkIHRvIG9taXQgYSBzZWN0aW9uIHdoaWNoIHVzZXMgdGhlICJ1
cmwiIGZpZWxkLgorKwkgICAqCisrCSAgICogIHsKKysJICAgKiAgICB2ZXJzaW9uIDogMywKKysJ
ICAgKiAgICBmaWxlOiAiYXBwLmpzIiwKKysJICAgKiAgICBzZWN0aW9uczogW3sKKysJICAgKiAg
ICAgIG9mZnNldDoge2xpbmU6MTAwLCBjb2x1bW46MTB9LAorKwkgICAqICAgICAgbWFwOiB7Cisr
CSAgICogICAgICAgIHZlcnNpb24gOiAzLAorKwkgICAqICAgICAgICBmaWxlOiAic2VjdGlvbi5q
cyIsCisrCSAgICogICAgICAgIHNvdXJjZXM6IFsiZm9vLmpzIiwgImJhci5qcyJdLAorKwkgICAq
ICAgICAgICBuYW1lczogWyJzcmMiLCAibWFwcyIsICJhcmUiLCAiZnVuIl0sCisrCSAgICogICAg
ICAgIG1hcHBpbmdzOiAiQUFBQSxFOztBQkNERTsiCisrCSAgICogICAgICB9CisrCSAgICogICAg
fV0sCisrCSAgICogIH0KKysJICAgKgorKwkgICAqIFswXTogaHR0cHM6Ly9kb2NzLmdvb2dsZS5j
b20vZG9jdW1lbnQvZC8xVTFSR0FlaFF3UnlwVVRvdkYxS1JscGlPRnplMGItXzJnYzZmQUgwS1kw
ay9lZGl0I2hlYWRpbmc9aC41MzVlczN4ZXByZ3QKKysJICAgKi8KKysJICBmdW5jdGlvbiBJbmRl
eGVkU291cmNlTWFwQ29uc3VtZXIoYVNvdXJjZU1hcCkgeworKwkgICAgdmFyIHNvdXJjZU1hcCA9
IGFTb3VyY2VNYXA7CisrCSAgICBpZiAodHlwZW9mIGFTb3VyY2VNYXAgPT09ICdzdHJpbmcnKSB7
CisrCSAgICAgIHNvdXJjZU1hcCA9IEpTT04ucGFyc2UoYVNvdXJjZU1hcC5yZXBsYWNlKC9eXClc
XVx9Jy8sICcnKSk7CisrCSAgICB9CisrCisrCSAgICB2YXIgdmVyc2lvbiA9IHV0aWwuZ2V0QXJn
KHNvdXJjZU1hcCwgJ3ZlcnNpb24nKTsKKysJICAgIHZhciBzZWN0aW9ucyA9IHV0aWwuZ2V0QXJn
KHNvdXJjZU1hcCwgJ3NlY3Rpb25zJyk7CisrCisrCSAgICBpZiAodmVyc2lvbiAhPSB0aGlzLl92
ZXJzaW9uKSB7CisrCSAgICAgIHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgdmVyc2lvbjog
JyArIHZlcnNpb24pOworKwkgICAgfQorKworKwkgICAgdGhpcy5fc291cmNlcyA9IG5ldyBBcnJh
eVNldCgpOworKwkgICAgdGhpcy5fbmFtZXMgPSBuZXcgQXJyYXlTZXQoKTsKKysKKysJICAgIHZh
ciBsYXN0T2Zmc2V0ID0geworKwkgICAgICBsaW5lOiAtMSwKKysJICAgICAgY29sdW1uOiAwCisr
CSAgICB9OworKwkgICAgdGhpcy5fc2VjdGlvbnMgPSBzZWN0aW9ucy5tYXAoZnVuY3Rpb24gKHMp
IHsKKysJICAgICAgaWYgKHMudXJsKSB7CisrCSAgICAgICAgLy8gVGhlIHVybCBmaWVsZCB3aWxs
IHJlcXVpcmUgc3VwcG9ydCBmb3IgYXN5bmNocm9uaWNpdHkuCisrCSAgICAgICAgLy8gU2VlIGh0
dHBzOi8vZ2l0aHViLmNvbS9tb3ppbGxhL3NvdXJjZS1tYXAvaXNzdWVzLzE2CisrCSAgICAgICAg
dGhyb3cgbmV3IEVycm9yKCdTdXBwb3J0IGZvciB1cmwgZmllbGQgaW4gc2VjdGlvbnMgbm90IGlt
cGxlbWVudGVkLicpOworKwkgICAgICB9CisrCSAgICAgIHZhciBvZmZzZXQgPSB1dGlsLmdldEFy
ZyhzLCAnb2Zmc2V0Jyk7CisrCSAgICAgIHZhciBvZmZzZXRMaW5lID0gdXRpbC5nZXRBcmcob2Zm
c2V0LCAnbGluZScpOworKwkgICAgICB2YXIgb2Zmc2V0Q29sdW1uID0gdXRpbC5nZXRBcmcob2Zm
c2V0LCAnY29sdW1uJyk7CisrCisrCSAgICAgIGlmIChvZmZzZXRMaW5lIDwgbGFzdE9mZnNldC5s
aW5lIHx8CisrCSAgICAgICAgICAob2Zmc2V0TGluZSA9PT0gbGFzdE9mZnNldC5saW5lICYmIG9m
ZnNldENvbHVtbiA8IGxhc3RPZmZzZXQuY29sdW1uKSkgeworKwkgICAgICAgIHRocm93IG5ldyBF
cnJvcignU2VjdGlvbiBvZmZzZXRzIG11c3QgYmUgb3JkZXJlZCBhbmQgbm9uLW92ZXJsYXBwaW5n
LicpOworKwkgICAgICB9CisrCSAgICAgIGxhc3RPZmZzZXQgPSBvZmZzZXQ7CisrCisrCSAgICAg
IHJldHVybiB7CisrCSAgICAgICAgZ2VuZXJhdGVkT2Zmc2V0OiB7CisrCSAgICAgICAgICAvLyBU
aGUgb2Zmc2V0IGZpZWxkcyBhcmUgMC1iYXNlZCwgYnV0IHdlIHVzZSAxLWJhc2VkIGluZGljZXMg
d2hlbgorKwkgICAgICAgICAgLy8gZW5jb2RpbmcvZGVjb2RpbmcgZnJvbSBWTFEuCisrCSAgICAg
ICAgICBnZW5lcmF0ZWRMaW5lOiBvZmZzZXRMaW5lICsgMSwKKysJICAgICAgICAgIGdlbmVyYXRl
ZENvbHVtbjogb2Zmc2V0Q29sdW1uICsgMQorKwkgICAgICAgIH0sCisrCSAgICAgICAgY29uc3Vt
ZXI6IG5ldyBTb3VyY2VNYXBDb25zdW1lcih1dGlsLmdldEFyZyhzLCAnbWFwJykpCisrCSAgICAg
IH0KKysJICAgIH0pOworKwkgIH0KKysKKysJICBJbmRleGVkU291cmNlTWFwQ29uc3VtZXIucHJv
dG90eXBlID0gT2JqZWN0LmNyZWF0ZShTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUpOworKwkg
IEluZGV4ZWRTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBTb3VyY2VN
YXBDb25zdW1lcjsKKysKKysJICAvKioKKysJICAgKiBUaGUgdmVyc2lvbiBvZiB0aGUgc291cmNl
IG1hcHBpbmcgc3BlYyB0aGF0IHdlIGFyZSBjb25zdW1pbmcuCisrCSAgICovCisrCSAgSW5kZXhl
ZFNvdXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZS5fdmVyc2lvbiA9IDM7CisrCisrCSAgLyoqCisr
CSAgICogVGhlIGxpc3Qgb2Ygb3JpZ2luYWwgc291cmNlcy4KKysJICAgKi8KKysJICBPYmplY3Qu
ZGVmaW5lUHJvcGVydHkoSW5kZXhlZFNvdXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZSwgJ3NvdXJj
ZXMnLCB7CisrCSAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKKysJICAgICAgdmFyIHNvdXJjZXMgPSBb
XTsKKysJICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9zZWN0aW9ucy5sZW5ndGg7IGkr
KykgeworKwkgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5fc2VjdGlvbnNbaV0uY29u
c3VtZXIuc291cmNlcy5sZW5ndGg7IGorKykgeworKwkgICAgICAgICAgc291cmNlcy5wdXNoKHRo
aXMuX3NlY3Rpb25zW2ldLmNvbnN1bWVyLnNvdXJjZXNbal0pOworKwkgICAgICAgIH0KKysJICAg
ICAgfQorKwkgICAgICByZXR1cm4gc291cmNlczsKKysJICAgIH0KKysJICB9KTsKKysKKysJICAv
KioKKysJICAgKiBSZXR1cm5zIHRoZSBvcmlnaW5hbCBzb3VyY2UsIGxpbmUsIGFuZCBjb2x1bW4g
aW5mb3JtYXRpb24gZm9yIHRoZSBnZW5lcmF0ZWQKKysJICAgKiBzb3VyY2UncyBsaW5lIGFuZCBj
b2x1bW4gcG9zaXRpb25zIHByb3ZpZGVkLiBUaGUgb25seSBhcmd1bWVudCBpcyBhbiBvYmplY3QK
KysJICAgKiB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczoKKysJICAgKgorKwkgICAqICAg
LSBsaW5lOiBUaGUgbGluZSBudW1iZXIgaW4gdGhlIGdlbmVyYXRlZCBzb3VyY2UuCisrCSAgICog
ICAtIGNvbHVtbjogVGhlIGNvbHVtbiBudW1iZXIgaW4gdGhlIGdlbmVyYXRlZCBzb3VyY2UuCisr
CSAgICoKKysJICAgKiBhbmQgYW4gb2JqZWN0IGlzIHJldHVybmVkIHdpdGggdGhlIGZvbGxvd2lu
ZyBwcm9wZXJ0aWVzOgorKwkgICAqCisrCSAgICogICAtIHNvdXJjZTogVGhlIG9yaWdpbmFsIHNv
dXJjZSBmaWxlLCBvciBudWxsLgorKwkgICAqICAgLSBsaW5lOiBUaGUgbGluZSBudW1iZXIgaW4g
dGhlIG9yaWdpbmFsIHNvdXJjZSwgb3IgbnVsbC4KKysJICAgKiAgIC0gY29sdW1uOiBUaGUgY29s
dW1uIG51bWJlciBpbiB0aGUgb3JpZ2luYWwgc291cmNlLCBvciBudWxsLgorKwkgICAqICAgLSBu
YW1lOiBUaGUgb3JpZ2luYWwgaWRlbnRpZmllciwgb3IgbnVsbC4KKysJICAgKi8KKysJICBJbmRl
eGVkU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLm9yaWdpbmFsUG9zaXRpb25Gb3IgPQorKwkg
ICAgZnVuY3Rpb24gSW5kZXhlZFNvdXJjZU1hcENvbnN1bWVyX29yaWdpbmFsUG9zaXRpb25Gb3Io
YUFyZ3MpIHsKKysJICAgICAgdmFyIG5lZWRsZSA9IHsKKysJICAgICAgICBnZW5lcmF0ZWRMaW5l
OiB1dGlsLmdldEFyZyhhQXJncywgJ2xpbmUnKSwKKysJICAgICAgICBnZW5lcmF0ZWRDb2x1bW46
IHV0aWwuZ2V0QXJnKGFBcmdzLCAnY29sdW1uJykKKysJICAgICAgfTsKKysKKysJICAgICAgLy8g
RmluZCB0aGUgc2VjdGlvbiBjb250YWluaW5nIHRoZSBnZW5lcmF0ZWQgcG9zaXRpb24gd2UncmUg
dHJ5aW5nIHRvIG1hcAorKwkgICAgICAvLyB0byBhbiBvcmlnaW5hbCBwb3NpdGlvbi4KKysJICAg
ICAgdmFyIHNlY3Rpb25JbmRleCA9IGJpbmFyeVNlYXJjaC5zZWFyY2gobmVlZGxlLCB0aGlzLl9z
ZWN0aW9ucywKKysJICAgICAgICBmdW5jdGlvbihuZWVkbGUsIHNlY3Rpb24pIHsKKysJICAgICAg
ICAgIHZhciBjbXAgPSBuZWVkbGUuZ2VuZXJhdGVkTGluZSAtIHNlY3Rpb24uZ2VuZXJhdGVkT2Zm
c2V0LmdlbmVyYXRlZExpbmU7CisrCSAgICAgICAgICBpZiAoY21wKSB7CisrCSAgICAgICAgICAg
IHJldHVybiBjbXA7CisrCSAgICAgICAgICB9CisrCisrCSAgICAgICAgICByZXR1cm4gKG5lZWRs
ZS5nZW5lcmF0ZWRDb2x1bW4gLQorKwkgICAgICAgICAgICAgICAgICBzZWN0aW9uLmdlbmVyYXRl
ZE9mZnNldC5nZW5lcmF0ZWRDb2x1bW4pOworKwkgICAgICAgIH0pOworKwkgICAgICB2YXIgc2Vj
dGlvbiA9IHRoaXMuX3NlY3Rpb25zW3NlY3Rpb25JbmRleF07CisrCisrCSAgICAgIGlmICghc2Vj
dGlvbikgeworKwkgICAgICAgIHJldHVybiB7CisrCSAgICAgICAgICBzb3VyY2U6IG51bGwsCisr
CSAgICAgICAgICBsaW5lOiBudWxsLAorKwkgICAgICAgICAgY29sdW1uOiBudWxsLAorKwkgICAg
ICAgICAgbmFtZTogbnVsbAorKwkgICAgICAgIH07CisrCSAgICAgIH0KKysKKysJICAgICAgcmV0
dXJuIHNlY3Rpb24uY29uc3VtZXIub3JpZ2luYWxQb3NpdGlvbkZvcih7CisrCSAgICAgICAgbGlu
ZTogbmVlZGxlLmdlbmVyYXRlZExpbmUgLQorKwkgICAgICAgICAgKHNlY3Rpb24uZ2VuZXJhdGVk
T2Zmc2V0LmdlbmVyYXRlZExpbmUgLSAxKSwKKysJICAgICAgICBjb2x1bW46IG5lZWRsZS5nZW5l
cmF0ZWRDb2x1bW4gLQorKwkgICAgICAgICAgKHNlY3Rpb24uZ2VuZXJhdGVkT2Zmc2V0LmdlbmVy
YXRlZExpbmUgPT09IG5lZWRsZS5nZW5lcmF0ZWRMaW5lCisrCSAgICAgICAgICAgPyBzZWN0aW9u
LmdlbmVyYXRlZE9mZnNldC5nZW5lcmF0ZWRDb2x1bW4gLSAxCisrCSAgICAgICAgICAgOiAwKSwK
KysJICAgICAgICBiaWFzOiBhQXJncy5iaWFzCisrCSAgICAgIH0pOworKwkgICAgfTsKKysKKysJ
ICAvKioKKysJICAgKiBSZXR1cm4gdHJ1ZSBpZiB3ZSBoYXZlIHRoZSBzb3VyY2UgY29udGVudCBm
b3IgZXZlcnkgc291cmNlIGluIHRoZSBzb3VyY2UKKysJICAgKiBtYXAsIGZhbHNlIG90aGVyd2lz
ZS4KKysJICAgKi8KKysJICBJbmRleGVkU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLmhhc0Nv
bnRlbnRzT2ZBbGxTb3VyY2VzID0KKysJICAgIGZ1bmN0aW9uIEluZGV4ZWRTb3VyY2VNYXBDb25z
dW1lcl9oYXNDb250ZW50c09mQWxsU291cmNlcygpIHsKKysJICAgICAgcmV0dXJuIHRoaXMuX3Nl
Y3Rpb25zLmV2ZXJ5KGZ1bmN0aW9uIChzKSB7CisrCSAgICAgICAgcmV0dXJuIHMuY29uc3VtZXIu
aGFzQ29udGVudHNPZkFsbFNvdXJjZXMoKTsKKysJICAgICAgfSk7CisrCSAgICB9OworKworKwkg
IC8qKgorKwkgICAqIFJldHVybnMgdGhlIG9yaWdpbmFsIHNvdXJjZSBjb250ZW50LiBUaGUgb25s
eSBhcmd1bWVudCBpcyB0aGUgdXJsIG9mIHRoZQorKwkgICAqIG9yaWdpbmFsIHNvdXJjZSBmaWxl
LiBSZXR1cm5zIG51bGwgaWYgbm8gb3JpZ2luYWwgc291cmNlIGNvbnRlbnQgaXMKKysJICAgKiBh
dmFpbGFibGUuCisrCSAgICovCisrCSAgSW5kZXhlZFNvdXJjZU1hcENvbnN1bWVyLnByb3RvdHlw
ZS5zb3VyY2VDb250ZW50Rm9yID0KKysJICAgIGZ1bmN0aW9uIEluZGV4ZWRTb3VyY2VNYXBDb25z
dW1lcl9zb3VyY2VDb250ZW50Rm9yKGFTb3VyY2UsIG51bGxPbk1pc3NpbmcpIHsKKysJICAgICAg
Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9zZWN0aW9ucy5sZW5ndGg7IGkrKykgeworKwkgICAg
ICAgIHZhciBzZWN0aW9uID0gdGhpcy5fc2VjdGlvbnNbaV07CisrCisrCSAgICAgICAgdmFyIGNv
bnRlbnQgPSBzZWN0aW9uLmNvbnN1bWVyLnNvdXJjZUNvbnRlbnRGb3IoYVNvdXJjZSwgdHJ1ZSk7
CisrCSAgICAgICAgaWYgKGNvbnRlbnQpIHsKKysJICAgICAgICAgIHJldHVybiBjb250ZW50Owor
KwkgICAgICAgIH0KKysJICAgICAgfQorKwkgICAgICBpZiAobnVsbE9uTWlzc2luZykgeworKwkg
ICAgICAgIHJldHVybiBudWxsOworKwkgICAgICB9CisrCSAgICAgIGVsc2UgeworKwkgICAgICAg
IHRocm93IG5ldyBFcnJvcignIicgKyBhU291cmNlICsgJyIgaXMgbm90IGluIHRoZSBTb3VyY2VN
YXAuJyk7CisrCSAgICAgIH0KKysJICAgIH07CisrCisrCSAgLyoqCisrCSAgICogUmV0dXJucyB0
aGUgZ2VuZXJhdGVkIGxpbmUgYW5kIGNvbHVtbiBpbmZvcm1hdGlvbiBmb3IgdGhlIG9yaWdpbmFs
IHNvdXJjZSwKKysJICAgKiBsaW5lLCBhbmQgY29sdW1uIHBvc2l0aW9ucyBwcm92aWRlZC4gVGhl
IG9ubHkgYXJndW1lbnQgaXMgYW4gb2JqZWN0IHdpdGgKKysJICAgKiB0aGUgZm9sbG93aW5nIHBy
b3BlcnRpZXM6CisrCSAgICoKKysJICAgKiAgIC0gc291cmNlOiBUaGUgZmlsZW5hbWUgb2YgdGhl
IG9yaWdpbmFsIHNvdXJjZS4KKysJICAgKiAgIC0gbGluZTogVGhlIGxpbmUgbnVtYmVyIGluIHRo
ZSBvcmlnaW5hbCBzb3VyY2UuCisrCSAgICogICAtIGNvbHVtbjogVGhlIGNvbHVtbiBudW1iZXIg
aW4gdGhlIG9yaWdpbmFsIHNvdXJjZS4KKysJICAgKgorKwkgICAqIGFuZCBhbiBvYmplY3QgaXMg
cmV0dXJuZWQgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6CisrCSAgICoKKysJICAgKiAg
IC0gbGluZTogVGhlIGxpbmUgbnVtYmVyIGluIHRoZSBnZW5lcmF0ZWQgc291cmNlLCBvciBudWxs
LgorKwkgICAqICAgLSBjb2x1bW46IFRoZSBjb2x1bW4gbnVtYmVyIGluIHRoZSBnZW5lcmF0ZWQg
c291cmNlLCBvciBudWxsLgorKwkgICAqLworKwkgIEluZGV4ZWRTb3VyY2VNYXBDb25zdW1lci5w
cm90b3R5cGUuZ2VuZXJhdGVkUG9zaXRpb25Gb3IgPQorKwkgICAgZnVuY3Rpb24gSW5kZXhlZFNv
dXJjZU1hcENvbnN1bWVyX2dlbmVyYXRlZFBvc2l0aW9uRm9yKGFBcmdzKSB7CisrCSAgICAgIGZv
ciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fc2VjdGlvbnMubGVuZ3RoOyBpKyspIHsKKysJICAgICAg
ICB2YXIgc2VjdGlvbiA9IHRoaXMuX3NlY3Rpb25zW2ldOworKworKwkgICAgICAgIC8vIE9ubHkg
Y29uc2lkZXIgdGhpcyBzZWN0aW9uIGlmIHRoZSByZXF1ZXN0ZWQgc291cmNlIGlzIGluIHRoZSBs
aXN0IG9mCisrCSAgICAgICAgLy8gc291cmNlcyBvZiB0aGUgY29uc3VtZXIuCisrCSAgICAgICAg
aWYgKHNlY3Rpb24uY29uc3VtZXIuc291cmNlcy5pbmRleE9mKHV0aWwuZ2V0QXJnKGFBcmdzLCAn
c291cmNlJykpID09PSAtMSkgeworKwkgICAgICAgICAgY29udGludWU7CisrCSAgICAgICAgfQor
KwkgICAgICAgIHZhciBnZW5lcmF0ZWRQb3NpdGlvbiA9IHNlY3Rpb24uY29uc3VtZXIuZ2VuZXJh
dGVkUG9zaXRpb25Gb3IoYUFyZ3MpOworKwkgICAgICAgIGlmIChnZW5lcmF0ZWRQb3NpdGlvbikg
eworKwkgICAgICAgICAgdmFyIHJldCA9IHsKKysJICAgICAgICAgICAgbGluZTogZ2VuZXJhdGVk
UG9zaXRpb24ubGluZSArCisrCSAgICAgICAgICAgICAgKHNlY3Rpb24uZ2VuZXJhdGVkT2Zmc2V0
LmdlbmVyYXRlZExpbmUgLSAxKSwKKysJICAgICAgICAgICAgY29sdW1uOiBnZW5lcmF0ZWRQb3Np
dGlvbi5jb2x1bW4gKworKwkgICAgICAgICAgICAgIChzZWN0aW9uLmdlbmVyYXRlZE9mZnNldC5n
ZW5lcmF0ZWRMaW5lID09PSBnZW5lcmF0ZWRQb3NpdGlvbi5saW5lCisrCSAgICAgICAgICAgICAg
ID8gc2VjdGlvbi5nZW5lcmF0ZWRPZmZzZXQuZ2VuZXJhdGVkQ29sdW1uIC0gMQorKwkgICAgICAg
ICAgICAgICA6IDApCisrCSAgICAgICAgICB9OworKwkgICAgICAgICAgcmV0dXJuIHJldDsKKysJ
ICAgICAgICB9CisrCSAgICAgIH0KKysKKysJICAgICAgcmV0dXJuIHsKKysJICAgICAgICBsaW5l
OiBudWxsLAorKwkgICAgICAgIGNvbHVtbjogbnVsbAorKwkgICAgICB9OworKwkgICAgfTsKKysK
KysJICAvKioKKysJICAgKiBQYXJzZSB0aGUgbWFwcGluZ3MgaW4gYSBzdHJpbmcgaW4gdG8gYSBk
YXRhIHN0cnVjdHVyZSB3aGljaCB3ZSBjYW4gZWFzaWx5CisrCSAgICogcXVlcnkgKHRoZSBvcmRl
cmVkIGFycmF5cyBpbiB0aGUgYHRoaXMuX19nZW5lcmF0ZWRNYXBwaW5nc2AgYW5kCisrCSAgICog
YHRoaXMuX19vcmlnaW5hbE1hcHBpbmdzYCBwcm9wZXJ0aWVzKS4KKysJICAgKi8KKysJICBJbmRl
eGVkU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLl9wYXJzZU1hcHBpbmdzID0KKysJICAgIGZ1
bmN0aW9uIEluZGV4ZWRTb3VyY2VNYXBDb25zdW1lcl9wYXJzZU1hcHBpbmdzKGFTdHIsIGFTb3Vy
Y2VSb290KSB7CisrCSAgICAgIHRoaXMuX19nZW5lcmF0ZWRNYXBwaW5ncyA9IFtdOworKwkgICAg
ICB0aGlzLl9fb3JpZ2luYWxNYXBwaW5ncyA9IFtdOworKwkgICAgICBmb3IgKHZhciBpID0gMDsg
aSA8IHRoaXMuX3NlY3Rpb25zLmxlbmd0aDsgaSsrKSB7CisrCSAgICAgICAgdmFyIHNlY3Rpb24g
PSB0aGlzLl9zZWN0aW9uc1tpXTsKKysJICAgICAgICB2YXIgc2VjdGlvbk1hcHBpbmdzID0gc2Vj
dGlvbi5jb25zdW1lci5fZ2VuZXJhdGVkTWFwcGluZ3M7CisrCSAgICAgICAgZm9yICh2YXIgaiA9
IDA7IGogPCBzZWN0aW9uTWFwcGluZ3MubGVuZ3RoOyBqKyspIHsKKysJICAgICAgICAgIHZhciBt
YXBwaW5nID0gc2VjdGlvbk1hcHBpbmdzW2pdOworKworKwkgICAgICAgICAgdmFyIHNvdXJjZSA9
IHNlY3Rpb24uY29uc3VtZXIuX3NvdXJjZXMuYXQobWFwcGluZy5zb3VyY2UpOworKwkgICAgICAg
ICAgaWYgKHNlY3Rpb24uY29uc3VtZXIuc291cmNlUm9vdCAhPT0gbnVsbCkgeworKwkgICAgICAg
ICAgICBzb3VyY2UgPSB1dGlsLmpvaW4oc2VjdGlvbi5jb25zdW1lci5zb3VyY2VSb290LCBzb3Vy
Y2UpOworKwkgICAgICAgICAgfQorKwkgICAgICAgICAgdGhpcy5fc291cmNlcy5hZGQoc291cmNl
KTsKKysJICAgICAgICAgIHNvdXJjZSA9IHRoaXMuX3NvdXJjZXMuaW5kZXhPZihzb3VyY2UpOwor
KworKwkgICAgICAgICAgdmFyIG5hbWUgPSBzZWN0aW9uLmNvbnN1bWVyLl9uYW1lcy5hdChtYXBw
aW5nLm5hbWUpOworKwkgICAgICAgICAgdGhpcy5fbmFtZXMuYWRkKG5hbWUpOworKwkgICAgICAg
ICAgbmFtZSA9IHRoaXMuX25hbWVzLmluZGV4T2YobmFtZSk7CisrCisrCSAgICAgICAgICAvLyBU
aGUgbWFwcGluZ3MgY29taW5nIGZyb20gdGhlIGNvbnN1bWVyIGZvciB0aGUgc2VjdGlvbiBoYXZl
CisrCSAgICAgICAgICAvLyBnZW5lcmF0ZWQgcG9zaXRpb25zIHJlbGF0aXZlIHRvIHRoZSBzdGFy
dCBvZiB0aGUgc2VjdGlvbiwgc28gd2UKKysJICAgICAgICAgIC8vIG5lZWQgdG8gb2Zmc2V0IHRo
ZW0gdG8gYmUgcmVsYXRpdmUgdG8gdGhlIHN0YXJ0IG9mIHRoZSBjb25jYXRlbmF0ZWQKKysJICAg
ICAgICAgIC8vIGdlbmVyYXRlZCBmaWxlLgorKwkgICAgICAgICAgdmFyIGFkanVzdGVkTWFwcGlu
ZyA9IHsKKysJICAgICAgICAgICAgc291cmNlOiBzb3VyY2UsCisrCSAgICAgICAgICAgIGdlbmVy
YXRlZExpbmU6IG1hcHBpbmcuZ2VuZXJhdGVkTGluZSArCisrCSAgICAgICAgICAgICAgKHNlY3Rp
b24uZ2VuZXJhdGVkT2Zmc2V0LmdlbmVyYXRlZExpbmUgLSAxKSwKKysJICAgICAgICAgICAgZ2Vu
ZXJhdGVkQ29sdW1uOiBtYXBwaW5nLmdlbmVyYXRlZENvbHVtbiArCisrCSAgICAgICAgICAgICAg
KHNlY3Rpb24uZ2VuZXJhdGVkT2Zmc2V0LmdlbmVyYXRlZExpbmUgPT09IG1hcHBpbmcuZ2VuZXJh
dGVkTGluZQorKwkgICAgICAgICAgICAgID8gc2VjdGlvbi5nZW5lcmF0ZWRPZmZzZXQuZ2VuZXJh
dGVkQ29sdW1uIC0gMQorKwkgICAgICAgICAgICAgIDogMCksCisrCSAgICAgICAgICAgIG9yaWdp
bmFsTGluZTogbWFwcGluZy5vcmlnaW5hbExpbmUsCisrCSAgICAgICAgICAgIG9yaWdpbmFsQ29s
dW1uOiBtYXBwaW5nLm9yaWdpbmFsQ29sdW1uLAorKwkgICAgICAgICAgICBuYW1lOiBuYW1lCisr
CSAgICAgICAgICB9OworKworKwkgICAgICAgICAgdGhpcy5fX2dlbmVyYXRlZE1hcHBpbmdzLnB1
c2goYWRqdXN0ZWRNYXBwaW5nKTsKKysJICAgICAgICAgIGlmICh0eXBlb2YgYWRqdXN0ZWRNYXBw
aW5nLm9yaWdpbmFsTGluZSA9PT0gJ251bWJlcicpIHsKKysJICAgICAgICAgICAgdGhpcy5fX29y
aWdpbmFsTWFwcGluZ3MucHVzaChhZGp1c3RlZE1hcHBpbmcpOworKwkgICAgICAgICAgfQorKwkg
ICAgICAgIH0KKysJICAgICAgfQorKworKwkgICAgICBxdWlja1NvcnQodGhpcy5fX2dlbmVyYXRl
ZE1hcHBpbmdzLCB1dGlsLmNvbXBhcmVCeUdlbmVyYXRlZFBvc2l0aW9uc0RlZmxhdGVkKTsKKysJ
ICAgICAgcXVpY2tTb3J0KHRoaXMuX19vcmlnaW5hbE1hcHBpbmdzLCB1dGlsLmNvbXBhcmVCeU9y
aWdpbmFsUG9zaXRpb25zKTsKKysJICAgIH07CisrCisrCSAgZXhwb3J0cy5JbmRleGVkU291cmNl
TWFwQ29uc3VtZXIgPSBJbmRleGVkU291cmNlTWFwQ29uc3VtZXI7CisrCX0KKysKKysKKysvKioq
LyB9LAorKy8qIDggKi8KKysvKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKKysKKysJ
LyogLSotIE1vZGU6IGpzOyBqcy1pbmRlbnQtbGV2ZWw6IDI7IC0qLSAqLworKwkvKgorKwkgKiBD
b3B5cmlnaHQgMjAxMSBNb3ppbGxhIEZvdW5kYXRpb24gYW5kIGNvbnRyaWJ1dG9ycworKwkgKiBM
aWNlbnNlZCB1bmRlciB0aGUgTmV3IEJTRCBsaWNlbnNlLiBTZWUgTElDRU5TRSBvcjoKKysJICog
aHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL0JTRC0zLUNsYXVzZQorKwkgKi8KKysJewor
KwkgIGV4cG9ydHMuR1JFQVRFU1RfTE9XRVJfQk9VTkQgPSAxOworKwkgIGV4cG9ydHMuTEVBU1Rf
VVBQRVJfQk9VTkQgPSAyOworKworKwkgIC8qKgorKwkgICAqIFJlY3Vyc2l2ZSBpbXBsZW1lbnRh
dGlvbiBvZiBiaW5hcnkgc2VhcmNoLgorKwkgICAqCisrCSAgICogQHBhcmFtIGFMb3cgSW5kaWNl
cyBoZXJlIGFuZCBsb3dlciBkbyBub3QgY29udGFpbiB0aGUgbmVlZGxlLgorKwkgICAqIEBwYXJh
bSBhSGlnaCBJbmRpY2VzIGhlcmUgYW5kIGhpZ2hlciBkbyBub3QgY29udGFpbiB0aGUgbmVlZGxl
LgorKwkgICAqIEBwYXJhbSBhTmVlZGxlIFRoZSBlbGVtZW50IGJlaW5nIHNlYXJjaGVkIGZvci4K
KysJICAgKiBAcGFyYW0gYUhheXN0YWNrIFRoZSBub24tZW1wdHkgYXJyYXkgYmVpbmcgc2VhcmNo
ZWQuCisrCSAgICogQHBhcmFtIGFDb21wYXJlIEZ1bmN0aW9uIHdoaWNoIHRha2VzIHR3byBlbGVt
ZW50cyBhbmQgcmV0dXJucyAtMSwgMCwgb3IgMS4KKysJICAgKiBAcGFyYW0gYUJpYXMgRWl0aGVy
ICdiaW5hcnlTZWFyY2guR1JFQVRFU1RfTE9XRVJfQk9VTkQnIG9yCisrCSAgICogICAgICdiaW5h
cnlTZWFyY2guTEVBU1RfVVBQRVJfQk9VTkQnLiBTcGVjaWZpZXMgd2hldGhlciB0byByZXR1cm4g
dGhlCisrCSAgICogICAgIGNsb3Nlc3QgZWxlbWVudCB0aGF0IGlzIHNtYWxsZXIgdGhhbiBvciBn
cmVhdGVyIHRoYW4gdGhlIG9uZSB3ZSBhcmUKKysJICAgKiAgICAgc2VhcmNoaW5nIGZvciwgcmVz
cGVjdGl2ZWx5LCBpZiB0aGUgZXhhY3QgZWxlbWVudCBjYW5ub3QgYmUgZm91bmQuCisrCSAgICov
CisrCSAgZnVuY3Rpb24gcmVjdXJzaXZlU2VhcmNoKGFMb3csIGFIaWdoLCBhTmVlZGxlLCBhSGF5
c3RhY2ssIGFDb21wYXJlLCBhQmlhcykgeworKwkgICAgLy8gVGhpcyBmdW5jdGlvbiB0ZXJtaW5h
dGVzIHdoZW4gb25lIG9mIHRoZSBmb2xsb3dpbmcgaXMgdHJ1ZToKKysJICAgIC8vCisrCSAgICAv
LyAgIDEuIFdlIGZpbmQgdGhlIGV4YWN0IGVsZW1lbnQgd2UgYXJlIGxvb2tpbmcgZm9yLgorKwkg
ICAgLy8KKysJICAgIC8vICAgMi4gV2UgZGlkIG5vdCBmaW5kIHRoZSBleGFjdCBlbGVtZW50LCBi
dXQgd2UgY2FuIHJldHVybiB0aGUgaW5kZXggb2YKKysJICAgIC8vICAgICAgdGhlIG5leHQtY2xv
c2VzdCBlbGVtZW50LgorKwkgICAgLy8KKysJICAgIC8vICAgMy4gV2UgZGlkIG5vdCBmaW5kIHRo
ZSBleGFjdCBlbGVtZW50LCBhbmQgdGhlcmUgaXMgbm8gbmV4dC1jbG9zZXN0CisrCSAgICAvLyAg
ICAgIGVsZW1lbnQgdGhhbiB0aGUgb25lIHdlIGFyZSBzZWFyY2hpbmcgZm9yLCBzbyB3ZSByZXR1
cm4gLTEuCisrCSAgICB2YXIgbWlkID0gTWF0aC5mbG9vcigoYUhpZ2ggLSBhTG93KSAvIDIpICsg
YUxvdzsKKysJICAgIHZhciBjbXAgPSBhQ29tcGFyZShhTmVlZGxlLCBhSGF5c3RhY2tbbWlkXSwg
dHJ1ZSk7CisrCSAgICBpZiAoY21wID09PSAwKSB7CisrCSAgICAgIC8vIEZvdW5kIHRoZSBlbGVt
ZW50IHdlIGFyZSBsb29raW5nIGZvci4KKysJICAgICAgcmV0dXJuIG1pZDsKKysJICAgIH0KKysJ
ICAgIGVsc2UgaWYgKGNtcCA+IDApIHsKKysJICAgICAgLy8gT3VyIG5lZWRsZSBpcyBncmVhdGVy
IHRoYW4gYUhheXN0YWNrW21pZF0uCisrCSAgICAgIGlmIChhSGlnaCAtIG1pZCA+IDEpIHsKKysJ
ICAgICAgICAvLyBUaGUgZWxlbWVudCBpcyBpbiB0aGUgdXBwZXIgaGFsZi4KKysJICAgICAgICBy
ZXR1cm4gcmVjdXJzaXZlU2VhcmNoKG1pZCwgYUhpZ2gsIGFOZWVkbGUsIGFIYXlzdGFjaywgYUNv
bXBhcmUsIGFCaWFzKTsKKysJICAgICAgfQorKworKwkgICAgICAvLyBUaGUgZXhhY3QgbmVlZGxl
IGVsZW1lbnQgd2FzIG5vdCBmb3VuZCBpbiB0aGlzIGhheXN0YWNrLiBEZXRlcm1pbmUgaWYKKysJ
ICAgICAgLy8gd2UgYXJlIGluIHRlcm1pbmF0aW9uIGNhc2UgKDMpIG9yICgyKSBhbmQgcmV0dXJu
IHRoZSBhcHByb3ByaWF0ZSB0aGluZy4KKysJICAgICAgaWYgKGFCaWFzID09IGV4cG9ydHMuTEVB
U1RfVVBQRVJfQk9VTkQpIHsKKysJICAgICAgICByZXR1cm4gYUhpZ2ggPCBhSGF5c3RhY2subGVu
Z3RoID8gYUhpZ2ggOiAtMTsKKysJICAgICAgfSBlbHNlIHsKKysJICAgICAgICByZXR1cm4gbWlk
OworKwkgICAgICB9CisrCSAgICB9CisrCSAgICBlbHNlIHsKKysJICAgICAgLy8gT3VyIG5lZWRs
ZSBpcyBsZXNzIHRoYW4gYUhheXN0YWNrW21pZF0uCisrCSAgICAgIGlmIChtaWQgLSBhTG93ID4g
MSkgeworKwkgICAgICAgIC8vIFRoZSBlbGVtZW50IGlzIGluIHRoZSBsb3dlciBoYWxmLgorKwkg
ICAgICAgIHJldHVybiByZWN1cnNpdmVTZWFyY2goYUxvdywgbWlkLCBhTmVlZGxlLCBhSGF5c3Rh
Y2ssIGFDb21wYXJlLCBhQmlhcyk7CisrCSAgICAgIH0KKysKKysJICAgICAgLy8gd2UgYXJlIGlu
IHRlcm1pbmF0aW9uIGNhc2UgKDMpIG9yICgyKSBhbmQgcmV0dXJuIHRoZSBhcHByb3ByaWF0ZSB0
aGluZy4KKysJICAgICAgaWYgKGFCaWFzID09IGV4cG9ydHMuTEVBU1RfVVBQRVJfQk9VTkQpIHsK
KysJICAgICAgICByZXR1cm4gbWlkOworKwkgICAgICB9IGVsc2UgeworKwkgICAgICAgIHJldHVy
biBhTG93IDwgMCA/IC0xIDogYUxvdzsKKysJICAgICAgfQorKwkgICAgfQorKwkgIH0KKysKKysJ
ICAvKioKKysJICAgKiBUaGlzIGlzIGFuIGltcGxlbWVudGF0aW9uIG9mIGJpbmFyeSBzZWFyY2gg
d2hpY2ggd2lsbCBhbHdheXMgdHJ5IGFuZCByZXR1cm4KKysJICAgKiB0aGUgaW5kZXggb2YgdGhl
IGNsb3Nlc3QgZWxlbWVudCBpZiB0aGVyZSBpcyBubyBleGFjdCBoaXQuIFRoaXMgaXMgYmVjYXVz
ZQorKwkgICAqIG1hcHBpbmdzIGJldHdlZW4gb3JpZ2luYWwgYW5kIGdlbmVyYXRlZCBsaW5lL2Nv
bCBwYWlycyBhcmUgc2luZ2xlIHBvaW50cywKKysJICAgKiBhbmQgdGhlcmUgaXMgYW4gaW1wbGlj
aXQgcmVnaW9uIGJldHdlZW4gZWFjaCBvZiB0aGVtLCBzbyBhIG1pc3MganVzdCBtZWFucworKwkg
ICAqIHRoYXQgeW91IGFyZW4ndCBvbiB0aGUgdmVyeSBzdGFydCBvZiBhIHJlZ2lvbi4KKysJICAg
KgorKwkgICAqIEBwYXJhbSBhTmVlZGxlIFRoZSBlbGVtZW50IHlvdSBhcmUgbG9va2luZyBmb3Iu
CisrCSAgICogQHBhcmFtIGFIYXlzdGFjayBUaGUgYXJyYXkgdGhhdCBpcyBiZWluZyBzZWFyY2hl
ZC4KKysJICAgKiBAcGFyYW0gYUNvbXBhcmUgQSBmdW5jdGlvbiB3aGljaCB0YWtlcyB0aGUgbmVl
ZGxlIGFuZCBhbiBlbGVtZW50IGluIHRoZQorKwkgICAqICAgICBhcnJheSBhbmQgcmV0dXJucyAt
MSwgMCwgb3IgMSBkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgbmVlZGxlIGlzIGxlc3MKKysJICAg
KiAgICAgdGhhbiwgZXF1YWwgdG8sIG9yIGdyZWF0ZXIgdGhhbiB0aGUgZWxlbWVudCwgcmVzcGVj
dGl2ZWx5LgorKwkgICAqIEBwYXJhbSBhQmlhcyBFaXRoZXIgJ2JpbmFyeVNlYXJjaC5HUkVBVEVT
VF9MT1dFUl9CT1VORCcgb3IKKysJICAgKiAgICAgJ2JpbmFyeVNlYXJjaC5MRUFTVF9VUFBFUl9C
T1VORCcuIFNwZWNpZmllcyB3aGV0aGVyIHRvIHJldHVybiB0aGUKKysJICAgKiAgICAgY2xvc2Vz
dCBlbGVtZW50IHRoYXQgaXMgc21hbGxlciB0aGFuIG9yIGdyZWF0ZXIgdGhhbiB0aGUgb25lIHdl
IGFyZQorKwkgICAqICAgICBzZWFyY2hpbmcgZm9yLCByZXNwZWN0aXZlbHksIGlmIHRoZSBleGFj
dCBlbGVtZW50IGNhbm5vdCBiZSBmb3VuZC4KKysJICAgKiAgICAgRGVmYXVsdHMgdG8gJ2JpbmFy
eVNlYXJjaC5HUkVBVEVTVF9MT1dFUl9CT1VORCcuCisrCSAgICovCisrCSAgZXhwb3J0cy5zZWFy
Y2ggPSBmdW5jdGlvbiBzZWFyY2goYU5lZWRsZSwgYUhheXN0YWNrLCBhQ29tcGFyZSwgYUJpYXMp
IHsKKysJICAgIGlmIChhSGF5c3RhY2subGVuZ3RoID09PSAwKSB7CisrCSAgICAgIHJldHVybiAt
MTsKKysJICAgIH0KKysKKysJICAgIHZhciBpbmRleCA9IHJlY3Vyc2l2ZVNlYXJjaCgtMSwgYUhh
eXN0YWNrLmxlbmd0aCwgYU5lZWRsZSwgYUhheXN0YWNrLAorKwkgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGFDb21wYXJlLCBhQmlhcyB8fCBleHBvcnRzLkdSRUFURVNUX0xPV0VSX0JP
VU5EKTsKKysJICAgIGlmIChpbmRleCA8IDApIHsKKysJICAgICAgcmV0dXJuIC0xOworKwkgICAg
fQorKworKwkgICAgLy8gV2UgaGF2ZSBmb3VuZCBlaXRoZXIgdGhlIGV4YWN0IGVsZW1lbnQsIG9y
IHRoZSBuZXh0LWNsb3Nlc3QgZWxlbWVudCB0aGFuCisrCSAgICAvLyB0aGUgb25lIHdlIGFyZSBz
ZWFyY2hpbmcgZm9yLiBIb3dldmVyLCB0aGVyZSBtYXkgYmUgbW9yZSB0aGFuIG9uZSBzdWNoCisr
CSAgICAvLyBlbGVtZW50LiBNYWtlIHN1cmUgd2UgYWx3YXlzIHJldHVybiB0aGUgc21hbGxlc3Qg
b2YgdGhlc2UuCisrCSAgICB3aGlsZSAoaW5kZXggLSAxID49IDApIHsKKysJICAgICAgaWYgKGFD
b21wYXJlKGFIYXlzdGFja1tpbmRleF0sIGFIYXlzdGFja1tpbmRleCAtIDFdLCB0cnVlKSAhPT0g
MCkgeworKwkgICAgICAgIGJyZWFrOworKwkgICAgICB9CisrCSAgICAgIC0taW5kZXg7CisrCSAg
ICB9CisrCisrCSAgICByZXR1cm4gaW5kZXg7CisrCSAgfTsKKysJfQorKworKworKy8qKiovIH0s
CisrLyogOSAqLworKy8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgeworKworKwkvKiAt
Ki0gTW9kZToganM7IGpzLWluZGVudC1sZXZlbDogMjsgLSotICovCisrCS8qCisrCSAqIENvcHly
aWdodCAyMDExIE1vemlsbGEgRm91bmRhdGlvbiBhbmQgY29udHJpYnV0b3JzCisrCSAqIExpY2Vu
c2VkIHVuZGVyIHRoZSBOZXcgQlNEIGxpY2Vuc2UuIFNlZSBMSUNFTlNFIG9yOgorKwkgKiBodHRw
Oi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvQlNELTMtQ2xhdXNlCisrCSAqLworKwl7CisrCSAg
Ly8gSXQgdHVybnMgb3V0IHRoYXQgc29tZSAobW9zdD8pIEphdmFTY3JpcHQgZW5naW5lcyBkb24n
dCBzZWxmLWhvc3QKKysJICAvLyBgQXJyYXkucHJvdG90eXBlLnNvcnRgLiBUaGlzIG1ha2VzIHNl
bnNlIGJlY2F1c2UgQysrIHdpbGwgbGlrZWx5IHJlbWFpbgorKwkgIC8vIGZhc3RlciB0aGFuIEpT
IHdoZW4gZG9pbmcgcmF3IENQVS1pbnRlbnNpdmUgc29ydGluZy4gSG93ZXZlciwgd2hlbiB1c2lu
ZyBhCisrCSAgLy8gY3VzdG9tIGNvbXBhcmF0b3IgZnVuY3Rpb24sIGNhbGxpbmcgYmFjayBhbmQg
Zm9ydGggYmV0d2VlbiB0aGUgVk0ncyBDKysgYW5kCisrCSAgLy8gSklUJ2QgSlMgaXMgcmF0aGVy
IHNsb3cgKmFuZCogbG9zZXMgSklUIHR5cGUgaW5mb3JtYXRpb24sIHJlc3VsdGluZyBpbgorKwkg
IC8vIHdvcnNlIGdlbmVyYXRlZCBjb2RlIGZvciB0aGUgY29tcGFyYXRvciBmdW5jdGlvbiB0aGFu
IHdvdWxkIGJlIG9wdGltYWwuIEluCisrCSAgLy8gZmFjdCwgd2hlbiBzb3J0aW5nIHdpdGggYSBj
b21wYXJhdG9yLCB0aGVzZSBjb3N0cyBvdXR3ZWlnaCB0aGUgYmVuZWZpdHMgb2YKKysJICAvLyBz
b3J0aW5nIGluIEMrKy4gQnkgdXNpbmcgb3VyIG93biBKUy1pbXBsZW1lbnRlZCBRdWljayBTb3J0
IChiZWxvdyksIHdlIGdldAorKwkgIC8vIGEgfjM1MDBtcyBtZWFuIHNwZWVkLXVwIGluIGBiZW5j
aC9iZW5jaC5odG1sYC4KKysKKysJICAvKioKKysJICAgKiBTd2FwIHRoZSBlbGVtZW50cyBpbmRl
eGVkIGJ5IGB4YCBhbmQgYHlgIGluIHRoZSBhcnJheSBgYXJ5YC4KKysJICAgKgorKwkgICAqIEBw
YXJhbSB7QXJyYXl9IGFyeQorKwkgICAqICAgICAgICBUaGUgYXJyYXkuCisrCSAgICogQHBhcmFt
IHtOdW1iZXJ9IHgKKysJICAgKiAgICAgICAgVGhlIGluZGV4IG9mIHRoZSBmaXJzdCBpdGVtLgor
KwkgICAqIEBwYXJhbSB7TnVtYmVyfSB5CisrCSAgICogICAgICAgIFRoZSBpbmRleCBvZiB0aGUg
c2Vjb25kIGl0ZW0uCisrCSAgICovCisrCSAgZnVuY3Rpb24gc3dhcChhcnksIHgsIHkpIHsKKysJ
ICAgIHZhciB0ZW1wID0gYXJ5W3hdOworKwkgICAgYXJ5W3hdID0gYXJ5W3ldOworKwkgICAgYXJ5
W3ldID0gdGVtcDsKKysJICB9CisrCisrCSAgLyoqCisrCSAgICogUmV0dXJucyBhIHJhbmRvbSBp
bnRlZ2VyIHdpdGhpbiB0aGUgcmFuZ2UgYGxvdyAuLiBoaWdoYCBpbmNsdXNpdmUuCisrCSAgICoK
KysJICAgKiBAcGFyYW0ge051bWJlcn0gbG93CisrCSAgICogICAgICAgIFRoZSBsb3dlciBib3Vu
ZCBvbiB0aGUgcmFuZ2UuCisrCSAgICogQHBhcmFtIHtOdW1iZXJ9IGhpZ2gKKysJICAgKiAgICAg
ICAgVGhlIHVwcGVyIGJvdW5kIG9uIHRoZSByYW5nZS4KKysJICAgKi8KKysJICBmdW5jdGlvbiBy
YW5kb21JbnRJblJhbmdlKGxvdywgaGlnaCkgeworKwkgICAgcmV0dXJuIE1hdGgucm91bmQobG93
ICsgKE1hdGgucmFuZG9tKCkgKiAoaGlnaCAtIGxvdykpKTsKKysJICB9CisrCisrCSAgLyoqCisr
CSAgICogVGhlIFF1aWNrIFNvcnQgYWxnb3JpdGhtLgorKwkgICAqCisrCSAgICogQHBhcmFtIHtB
cnJheX0gYXJ5CisrCSAgICogICAgICAgIEFuIGFycmF5IHRvIHNvcnQuCisrCSAgICogQHBhcmFt
IHtmdW5jdGlvbn0gY29tcGFyYXRvcgorKwkgICAqICAgICAgICBGdW5jdGlvbiB0byB1c2UgdG8g
Y29tcGFyZSB0d28gaXRlbXMuCisrCSAgICogQHBhcmFtIHtOdW1iZXJ9IHAKKysJICAgKiAgICAg
ICAgU3RhcnQgaW5kZXggb2YgdGhlIGFycmF5CisrCSAgICogQHBhcmFtIHtOdW1iZXJ9IHIKKysJ
ICAgKiAgICAgICAgRW5kIGluZGV4IG9mIHRoZSBhcnJheQorKwkgICAqLworKwkgIGZ1bmN0aW9u
IGRvUXVpY2tTb3J0KGFyeSwgY29tcGFyYXRvciwgcCwgcikgeworKwkgICAgLy8gSWYgb3VyIGxv
d2VyIGJvdW5kIGlzIGxlc3MgdGhhbiBvdXIgdXBwZXIgYm91bmQsIHdlICgxKSBwYXJ0aXRpb24g
dGhlCisrCSAgICAvLyBhcnJheSBpbnRvIHR3byBwaWVjZXMgYW5kICgyKSByZWN1cnNlIG9uIGVh
Y2ggaGFsZi4gSWYgaXQgaXMgbm90LCB0aGlzIGlzCisrCSAgICAvLyB0aGUgZW1wdHkgYXJyYXkg
YW5kIG91ciBiYXNlIGNhc2UuCisrCisrCSAgICBpZiAocCA8IHIpIHsKKysJICAgICAgLy8gKDEp
IFBhcnRpdGlvbmluZy4KKysJICAgICAgLy8KKysJICAgICAgLy8gVGhlIHBhcnRpdGlvbmluZyBj
aG9vc2VzIGEgcGl2b3QgYmV0d2VlbiBgcGAgYW5kIGByYCBhbmQgbW92ZXMgYWxsCisrCSAgICAg
IC8vIGVsZW1lbnRzIHRoYXQgYXJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byB0aGUgcGl2b3QgdG8g
dGhlIGJlZm9yZSBpdCwgYW5kCisrCSAgICAgIC8vIGFsbCB0aGUgZWxlbWVudHMgdGhhdCBhcmUg
Z3JlYXRlciB0aGFuIGl0IGFmdGVyIGl0LiBUaGUgZWZmZWN0IGlzIHRoYXQKKysJICAgICAgLy8g
b25jZSBwYXJ0aXRpb24gaXMgZG9uZSwgdGhlIHBpdm90IGlzIGluIHRoZSBleGFjdCBwbGFjZSBp
dCB3aWxsIGJlIHdoZW4KKysJICAgICAgLy8gdGhlIGFycmF5IGlzIHB1dCBpbiBzb3J0ZWQgb3Jk
ZXIsIGFuZCBpdCB3aWxsIG5vdCBuZWVkIHRvIGJlIG1vdmVkCisrCSAgICAgIC8vIGFnYWluLiBU
aGlzIHJ1bnMgaW4gTyhuKSB0aW1lLgorKworKwkgICAgICAvLyBBbHdheXMgY2hvb3NlIGEgcmFu
ZG9tIHBpdm90IHNvIHRoYXQgYW4gaW5wdXQgYXJyYXkgd2hpY2ggaXMgcmV2ZXJzZQorKwkgICAg
ICAvLyBzb3J0ZWQgZG9lcyBub3QgY2F1c2UgTyhuXjIpIHJ1bm5pbmcgdGltZS4KKysJICAgICAg
dmFyIHBpdm90SW5kZXggPSByYW5kb21JbnRJblJhbmdlKHAsIHIpOworKwkgICAgICB2YXIgaSA9
IHAgLSAxOworKworKwkgICAgICBzd2FwKGFyeSwgcGl2b3RJbmRleCwgcik7CisrCSAgICAgIHZh
ciBwaXZvdCA9IGFyeVtyXTsKKysKKysJICAgICAgLy8gSW1tZWRpYXRlbHkgYWZ0ZXIgYGpgIGlz
IGluY3JlbWVudGVkIGluIHRoaXMgbG9vcCwgdGhlIGZvbGxvd2luZyBob2xkCisrCSAgICAgIC8v
IHRydWU6CisrCSAgICAgIC8vCisrCSAgICAgIC8vICAgKiBFdmVyeSBlbGVtZW50IGluIGBhcnlb
cCAuLiBpXWAgaXMgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSBwaXZvdC4KKysJICAgICAgLy8K
KysJICAgICAgLy8gICAqIEV2ZXJ5IGVsZW1lbnQgaW4gYGFyeVtpKzEgLi4gai0xXWAgaXMgZ3Jl
YXRlciB0aGFuIHRoZSBwaXZvdC4KKysJICAgICAgZm9yICh2YXIgaiA9IHA7IGogPCByOyBqKysp
IHsKKysJICAgICAgICBpZiAoY29tcGFyYXRvcihhcnlbal0sIHBpdm90KSA8PSAwKSB7CisrCSAg
ICAgICAgICBpICs9IDE7CisrCSAgICAgICAgICBzd2FwKGFyeSwgaSwgaik7CisrCSAgICAgICAg
fQorKwkgICAgICB9CisrCisrCSAgICAgIHN3YXAoYXJ5LCBpICsgMSwgaik7CisrCSAgICAgIHZh
ciBxID0gaSArIDE7CisrCisrCSAgICAgIC8vICgyKSBSZWN1cnNlIG9uIGVhY2ggaGFsZi4KKysK
KysJICAgICAgZG9RdWlja1NvcnQoYXJ5LCBjb21wYXJhdG9yLCBwLCBxIC0gMSk7CisrCSAgICAg
IGRvUXVpY2tTb3J0KGFyeSwgY29tcGFyYXRvciwgcSArIDEsIHIpOworKwkgICAgfQorKwkgIH0K
KysKKysJICAvKioKKysJICAgKiBTb3J0IHRoZSBnaXZlbiBhcnJheSBpbi1wbGFjZSB3aXRoIHRo
ZSBnaXZlbiBjb21wYXJhdG9yIGZ1bmN0aW9uLgorKwkgICAqCisrCSAgICogQHBhcmFtIHtBcnJh
eX0gYXJ5CisrCSAgICogICAgICAgIEFuIGFycmF5IHRvIHNvcnQuCisrCSAgICogQHBhcmFtIHtm
dW5jdGlvbn0gY29tcGFyYXRvcgorKwkgICAqICAgICAgICBGdW5jdGlvbiB0byB1c2UgdG8gY29t
cGFyZSB0d28gaXRlbXMuCisrCSAgICovCisrCSAgZXhwb3J0cy5xdWlja1NvcnQgPSBmdW5jdGlv
biAoYXJ5LCBjb21wYXJhdG9yKSB7CisrCSAgICBkb1F1aWNrU29ydChhcnksIGNvbXBhcmF0b3Is
IDAsIGFyeS5sZW5ndGggLSAxKTsKKysJICB9OworKwl9CisrCisrCisrLyoqKi8gfSwKKysvKiAx
MCAqLworKy8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVf
XykgeworKworKwkvKiAtKi0gTW9kZToganM7IGpzLWluZGVudC1sZXZlbDogMjsgLSotICovCisr
CS8qCisrCSAqIENvcHlyaWdodCAyMDExIE1vemlsbGEgRm91bmRhdGlvbiBhbmQgY29udHJpYnV0
b3JzCisrCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBOZXcgQlNEIGxpY2Vuc2UuIFNlZSBMSUNFTlNF
IG9yOgorKwkgKiBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvQlNELTMtQ2xhdXNlCisr
CSAqLworKwl7CisrCSAgdmFyIFNvdXJjZU1hcEdlbmVyYXRvciA9IF9fd2VicGFja19yZXF1aXJl
X18oMSkuU291cmNlTWFwR2VuZXJhdG9yOworKwkgIHZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVp
cmVfXyg0KTsKKysKKysJICAvLyBNYXRjaGVzIGEgV2luZG93cy1zdHlsZSBgXHJcbmAgbmV3bGlu
ZSBvciBhIGBcbmAgbmV3bGluZSB1c2VkIGJ5IGFsbCBvdGhlcgorKwkgIC8vIG9wZXJhdGluZyBz
eXN0ZW1zIHRoZXNlIGRheXMgKGNhcHR1cmluZyB0aGUgcmVzdWx0KS4KKysJICB2YXIgUkVHRVhf
TkVXTElORSA9IC8oXHI/XG4pLzsKKysKKysJICAvLyBOZXdsaW5lIGNoYXJhY3RlciBjb2RlIGZv
ciBjaGFyQ29kZUF0KCkgY29tcGFyaXNvbnMKKysJICB2YXIgTkVXTElORV9DT0RFID0gMTA7Cisr
CisrCSAgLy8gUHJpdmF0ZSBzeW1ib2wgZm9yIGlkZW50aWZ5aW5nIGBTb3VyY2VOb2RlYHMgd2hl
biBtdWx0aXBsZSB2ZXJzaW9ucyBvZgorKwkgIC8vIHRoZSBzb3VyY2UtbWFwIGxpYnJhcnkgYXJl
IGxvYWRlZC4gVGhpcyBNVVNUIE5PVCBDSEFOR0UgYWNyb3NzCisrCSAgLy8gdmVyc2lvbnMhCisr
CSAgdmFyIGlzU291cmNlTm9kZSA9ICIkJCRpc1NvdXJjZU5vZGUkJCQiOworKworKwkgIC8qKgor
KwkgICAqIFNvdXJjZU5vZGVzIHByb3ZpZGUgYSB3YXkgdG8gYWJzdHJhY3Qgb3ZlciBpbnRlcnBv
bGF0aW5nL2NvbmNhdGVuYXRpbmcKKysJICAgKiBzbmlwcGV0cyBvZiBnZW5lcmF0ZWQgSmF2YVNj
cmlwdCBzb3VyY2UgY29kZSB3aGlsZSBtYWludGFpbmluZyB0aGUgbGluZSBhbmQKKysJICAgKiBj
b2x1bW4gaW5mb3JtYXRpb24gYXNzb2NpYXRlZCB3aXRoIHRoZSBvcmlnaW5hbCBzb3VyY2UgY29k
ZS4KKysJICAgKgorKwkgICAqIEBwYXJhbSBhTGluZSBUaGUgb3JpZ2luYWwgbGluZSBudW1iZXIu
CisrCSAgICogQHBhcmFtIGFDb2x1bW4gVGhlIG9yaWdpbmFsIGNvbHVtbiBudW1iZXIuCisrCSAg
ICogQHBhcmFtIGFTb3VyY2UgVGhlIG9yaWdpbmFsIHNvdXJjZSdzIGZpbGVuYW1lLgorKwkgICAq
IEBwYXJhbSBhQ2h1bmtzIE9wdGlvbmFsLiBBbiBhcnJheSBvZiBzdHJpbmdzIHdoaWNoIGFyZSBz
bmlwcGV0cyBvZgorKwkgICAqICAgICAgICBnZW5lcmF0ZWQgSlMsIG9yIG90aGVyIFNvdXJjZU5v
ZGVzLgorKwkgICAqIEBwYXJhbSBhTmFtZSBUaGUgb3JpZ2luYWwgaWRlbnRpZmllci4KKysJICAg
Ki8KKysJICBmdW5jdGlvbiBTb3VyY2VOb2RlKGFMaW5lLCBhQ29sdW1uLCBhU291cmNlLCBhQ2h1
bmtzLCBhTmFtZSkgeworKwkgICAgdGhpcy5jaGlsZHJlbiA9IFtdOworKwkgICAgdGhpcy5zb3Vy
Y2VDb250ZW50cyA9IHt9OworKwkgICAgdGhpcy5saW5lID0gYUxpbmUgPT0gbnVsbCA/IG51bGwg
OiBhTGluZTsKKysJICAgIHRoaXMuY29sdW1uID0gYUNvbHVtbiA9PSBudWxsID8gbnVsbCA6IGFD
b2x1bW47CisrCSAgICB0aGlzLnNvdXJjZSA9IGFTb3VyY2UgPT0gbnVsbCA/IG51bGwgOiBhU291
cmNlOworKwkgICAgdGhpcy5uYW1lID0gYU5hbWUgPT0gbnVsbCA/IG51bGwgOiBhTmFtZTsKKysJ
ICAgIHRoaXNbaXNTb3VyY2VOb2RlXSA9IHRydWU7CisrCSAgICBpZiAoYUNodW5rcyAhPSBudWxs
KSB0aGlzLmFkZChhQ2h1bmtzKTsKKysJICB9CisrCisrCSAgLyoqCisrCSAgICogQ3JlYXRlcyBh
IFNvdXJjZU5vZGUgZnJvbSBnZW5lcmF0ZWQgY29kZSBhbmQgYSBTb3VyY2VNYXBDb25zdW1lci4K
KysJICAgKgorKwkgICAqIEBwYXJhbSBhR2VuZXJhdGVkQ29kZSBUaGUgZ2VuZXJhdGVkIGNvZGUK
KysJICAgKiBAcGFyYW0gYVNvdXJjZU1hcENvbnN1bWVyIFRoZSBTb3VyY2VNYXAgZm9yIHRoZSBn
ZW5lcmF0ZWQgY29kZQorKwkgICAqIEBwYXJhbSBhUmVsYXRpdmVQYXRoIE9wdGlvbmFsLiBUaGUg
cGF0aCB0aGF0IHJlbGF0aXZlIHNvdXJjZXMgaW4gdGhlCisrCSAgICogICAgICAgIFNvdXJjZU1h
cENvbnN1bWVyIHNob3VsZCBiZSByZWxhdGl2ZSB0by4KKysJICAgKi8KKysJICBTb3VyY2VOb2Rl
LmZyb21TdHJpbmdXaXRoU291cmNlTWFwID0KKysJICAgIGZ1bmN0aW9uIFNvdXJjZU5vZGVfZnJv
bVN0cmluZ1dpdGhTb3VyY2VNYXAoYUdlbmVyYXRlZENvZGUsIGFTb3VyY2VNYXBDb25zdW1lciwg
YVJlbGF0aXZlUGF0aCkgeworKwkgICAgICAvLyBUaGUgU291cmNlTm9kZSB3ZSB3YW50IHRvIGZp
bGwgd2l0aCB0aGUgZ2VuZXJhdGVkIGNvZGUKKysJICAgICAgLy8gYW5kIHRoZSBTb3VyY2VNYXAK
KysJICAgICAgdmFyIG5vZGUgPSBuZXcgU291cmNlTm9kZSgpOworKworKwkgICAgICAvLyBBbGwg
ZXZlbiBpbmRpY2VzIG9mIHRoaXMgYXJyYXkgYXJlIG9uZSBsaW5lIG9mIHRoZSBnZW5lcmF0ZWQg
Y29kZSwKKysJICAgICAgLy8gd2hpbGUgYWxsIG9kZCBpbmRpY2VzIGFyZSB0aGUgbmV3bGluZXMg
YmV0d2VlbiB0d28gYWRqYWNlbnQgbGluZXMKKysJICAgICAgLy8gKHNpbmNlIGBSRUdFWF9ORVdM
SU5FYCBjYXB0dXJlcyBpdHMgbWF0Y2gpLgorKwkgICAgICAvLyBQcm9jZXNzZWQgZnJhZ21lbnRz
IGFyZSByZW1vdmVkIGZyb20gdGhpcyBhcnJheSwgYnkgY2FsbGluZyBgc2hpZnROZXh0TGluZWAu
CisrCSAgICAgIHZhciByZW1haW5pbmdMaW5lcyA9IGFHZW5lcmF0ZWRDb2RlLnNwbGl0KFJFR0VY
X05FV0xJTkUpOworKwkgICAgICB2YXIgc2hpZnROZXh0TGluZSA9IGZ1bmN0aW9uKCkgeworKwkg
ICAgICAgIHZhciBsaW5lQ29udGVudHMgPSByZW1haW5pbmdMaW5lcy5zaGlmdCgpOworKwkgICAg
ICAgIC8vIFRoZSBsYXN0IGxpbmUgb2YgYSBmaWxlIG1pZ2h0IG5vdCBoYXZlIGEgbmV3bGluZS4K
KysJICAgICAgICB2YXIgbmV3TGluZSA9IHJlbWFpbmluZ0xpbmVzLnNoaWZ0KCkgfHwgIiI7Cisr
CSAgICAgICAgcmV0dXJuIGxpbmVDb250ZW50cyArIG5ld0xpbmU7CisrCSAgICAgIH07CisrCisr
CSAgICAgIC8vIFdlIG5lZWQgdG8gcmVtZW1iZXIgdGhlIHBvc2l0aW9uIG9mICJyZW1haW5pbmdM
aW5lcyIKKysJICAgICAgdmFyIGxhc3RHZW5lcmF0ZWRMaW5lID0gMSwgbGFzdEdlbmVyYXRlZENv
bHVtbiA9IDA7CisrCisrCSAgICAgIC8vIFRoZSBnZW5lcmF0ZSBTb3VyY2VOb2RlcyB3ZSBuZWVk
IGEgY29kZSByYW5nZS4KKysJICAgICAgLy8gVG8gZXh0cmFjdCBpdCBjdXJyZW50IGFuZCBsYXN0
IG1hcHBpbmcgaXMgdXNlZC4KKysJICAgICAgLy8gSGVyZSB3ZSBzdG9yZSB0aGUgbGFzdCBtYXBw
aW5nLgorKwkgICAgICB2YXIgbGFzdE1hcHBpbmcgPSBudWxsOworKworKwkgICAgICBhU291cmNl
TWFwQ29uc3VtZXIuZWFjaE1hcHBpbmcoZnVuY3Rpb24gKG1hcHBpbmcpIHsKKysJICAgICAgICBp
ZiAobGFzdE1hcHBpbmcgIT09IG51bGwpIHsKKysJICAgICAgICAgIC8vIFdlIGFkZCB0aGUgY29k
ZSBmcm9tICJsYXN0TWFwcGluZyIgdG8gIm1hcHBpbmciOgorKwkgICAgICAgICAgLy8gRmlyc3Qg
Y2hlY2sgaWYgdGhlcmUgaXMgYSBuZXcgbGluZSBpbiBiZXR3ZWVuLgorKwkgICAgICAgICAgaWYg
KGxhc3RHZW5lcmF0ZWRMaW5lIDwgbWFwcGluZy5nZW5lcmF0ZWRMaW5lKSB7CisrCSAgICAgICAg
ICAgIC8vIEFzc29jaWF0ZSBmaXJzdCBsaW5lIHdpdGggImxhc3RNYXBwaW5nIgorKwkgICAgICAg
ICAgICBhZGRNYXBwaW5nV2l0aENvZGUobGFzdE1hcHBpbmcsIHNoaWZ0TmV4dExpbmUoKSk7Cisr
CSAgICAgICAgICAgIGxhc3RHZW5lcmF0ZWRMaW5lKys7CisrCSAgICAgICAgICAgIGxhc3RHZW5l
cmF0ZWRDb2x1bW4gPSAwOworKwkgICAgICAgICAgICAvLyBUaGUgcmVtYWluaW5nIGNvZGUgaXMg
YWRkZWQgd2l0aG91dCBtYXBwaW5nCisrCSAgICAgICAgICB9IGVsc2UgeworKwkgICAgICAgICAg
ICAvLyBUaGVyZSBpcyBubyBuZXcgbGluZSBpbiBiZXR3ZWVuLgorKwkgICAgICAgICAgICAvLyBB
c3NvY2lhdGUgdGhlIGNvZGUgYmV0d2VlbiAibGFzdEdlbmVyYXRlZENvbHVtbiIgYW5kCisrCSAg
ICAgICAgICAgIC8vICJtYXBwaW5nLmdlbmVyYXRlZENvbHVtbiIgd2l0aCAibGFzdE1hcHBpbmci
CisrCSAgICAgICAgICAgIHZhciBuZXh0TGluZSA9IHJlbWFpbmluZ0xpbmVzWzBdOworKwkgICAg
ICAgICAgICB2YXIgY29kZSA9IG5leHRMaW5lLnN1YnN0cigwLCBtYXBwaW5nLmdlbmVyYXRlZENv
bHVtbiAtCisrCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RH
ZW5lcmF0ZWRDb2x1bW4pOworKwkgICAgICAgICAgICByZW1haW5pbmdMaW5lc1swXSA9IG5leHRM
aW5lLnN1YnN0cihtYXBwaW5nLmdlbmVyYXRlZENvbHVtbiAtCisrCSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RHZW5lcmF0ZWRDb2x1bW4pOworKwkg
ICAgICAgICAgICBsYXN0R2VuZXJhdGVkQ29sdW1uID0gbWFwcGluZy5nZW5lcmF0ZWRDb2x1bW47
CisrCSAgICAgICAgICAgIGFkZE1hcHBpbmdXaXRoQ29kZShsYXN0TWFwcGluZywgY29kZSk7Cisr
CSAgICAgICAgICAgIC8vIE5vIG1vcmUgcmVtYWluaW5nIGNvZGUsIGNvbnRpbnVlCisrCSAgICAg
ICAgICAgIGxhc3RNYXBwaW5nID0gbWFwcGluZzsKKysJICAgICAgICAgICAgcmV0dXJuOworKwkg
ICAgICAgICAgfQorKwkgICAgICAgIH0KKysJICAgICAgICAvLyBXZSBhZGQgdGhlIGdlbmVyYXRl
ZCBjb2RlIHVudGlsIHRoZSBmaXJzdCBtYXBwaW5nCisrCSAgICAgICAgLy8gdG8gdGhlIFNvdXJj
ZU5vZGUgd2l0aG91dCBhbnkgbWFwcGluZy4KKysJICAgICAgICAvLyBFYWNoIGxpbmUgaXMgYWRk
ZWQgYXMgc2VwYXJhdGUgc3RyaW5nLgorKwkgICAgICAgIHdoaWxlIChsYXN0R2VuZXJhdGVkTGlu
ZSA8IG1hcHBpbmcuZ2VuZXJhdGVkTGluZSkgeworKwkgICAgICAgICAgbm9kZS5hZGQoc2hpZnRO
ZXh0TGluZSgpKTsKKysJICAgICAgICAgIGxhc3RHZW5lcmF0ZWRMaW5lKys7CisrCSAgICAgICAg
fQorKwkgICAgICAgIGlmIChsYXN0R2VuZXJhdGVkQ29sdW1uIDwgbWFwcGluZy5nZW5lcmF0ZWRD
b2x1bW4pIHsKKysJICAgICAgICAgIHZhciBuZXh0TGluZSA9IHJlbWFpbmluZ0xpbmVzWzBdOwor
KwkgICAgICAgICAgbm9kZS5hZGQobmV4dExpbmUuc3Vic3RyKDAsIG1hcHBpbmcuZ2VuZXJhdGVk
Q29sdW1uKSk7CisrCSAgICAgICAgICByZW1haW5pbmdMaW5lc1swXSA9IG5leHRMaW5lLnN1YnN0
cihtYXBwaW5nLmdlbmVyYXRlZENvbHVtbik7CisrCSAgICAgICAgICBsYXN0R2VuZXJhdGVkQ29s
dW1uID0gbWFwcGluZy5nZW5lcmF0ZWRDb2x1bW47CisrCSAgICAgICAgfQorKwkgICAgICAgIGxh
c3RNYXBwaW5nID0gbWFwcGluZzsKKysJICAgICAgfSwgdGhpcyk7CisrCSAgICAgIC8vIFdlIGhh
dmUgcHJvY2Vzc2VkIGFsbCBtYXBwaW5ncy4KKysJICAgICAgaWYgKHJlbWFpbmluZ0xpbmVzLmxl
bmd0aCA+IDApIHsKKysJICAgICAgICBpZiAobGFzdE1hcHBpbmcpIHsKKysJICAgICAgICAgIC8v
IEFzc29jaWF0ZSB0aGUgcmVtYWluaW5nIGNvZGUgaW4gdGhlIGN1cnJlbnQgbGluZSB3aXRoICJs
YXN0TWFwcGluZyIKKysJICAgICAgICAgIGFkZE1hcHBpbmdXaXRoQ29kZShsYXN0TWFwcGluZywg
c2hpZnROZXh0TGluZSgpKTsKKysJICAgICAgICB9CisrCSAgICAgICAgLy8gYW5kIGFkZCB0aGUg
cmVtYWluaW5nIGxpbmVzIHdpdGhvdXQgYW55IG1hcHBpbmcKKysJICAgICAgICBub2RlLmFkZChy
ZW1haW5pbmdMaW5lcy5qb2luKCIiKSk7CisrCSAgICAgIH0KKysKKysJICAgICAgLy8gQ29weSBz
b3VyY2VzQ29udGVudCBpbnRvIFNvdXJjZU5vZGUKKysJICAgICAgYVNvdXJjZU1hcENvbnN1bWVy
LnNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbiAoc291cmNlRmlsZSkgeworKwkgICAgICAgIHZhciBj
b250ZW50ID0gYVNvdXJjZU1hcENvbnN1bWVyLnNvdXJjZUNvbnRlbnRGb3Ioc291cmNlRmlsZSk7
CisrCSAgICAgICAgaWYgKGNvbnRlbnQgIT0gbnVsbCkgeworKwkgICAgICAgICAgaWYgKGFSZWxh
dGl2ZVBhdGggIT0gbnVsbCkgeworKwkgICAgICAgICAgICBzb3VyY2VGaWxlID0gdXRpbC5qb2lu
KGFSZWxhdGl2ZVBhdGgsIHNvdXJjZUZpbGUpOworKwkgICAgICAgICAgfQorKwkgICAgICAgICAg
bm9kZS5zZXRTb3VyY2VDb250ZW50KHNvdXJjZUZpbGUsIGNvbnRlbnQpOworKwkgICAgICAgIH0K
KysJICAgICAgfSk7CisrCisrCSAgICAgIHJldHVybiBub2RlOworKworKwkgICAgICBmdW5jdGlv
biBhZGRNYXBwaW5nV2l0aENvZGUobWFwcGluZywgY29kZSkgeworKwkgICAgICAgIGlmIChtYXBw
aW5nID09PSBudWxsIHx8IG1hcHBpbmcuc291cmNlID09PSB1bmRlZmluZWQpIHsKKysJICAgICAg
ICAgIG5vZGUuYWRkKGNvZGUpOworKwkgICAgICAgIH0gZWxzZSB7CisrCSAgICAgICAgICB2YXIg
c291cmNlID0gYVJlbGF0aXZlUGF0aAorKwkgICAgICAgICAgICA/IHV0aWwuam9pbihhUmVsYXRp
dmVQYXRoLCBtYXBwaW5nLnNvdXJjZSkKKysJICAgICAgICAgICAgOiBtYXBwaW5nLnNvdXJjZTsK
KysJICAgICAgICAgIG5vZGUuYWRkKG5ldyBTb3VyY2VOb2RlKG1hcHBpbmcub3JpZ2luYWxMaW5l
LAorKwkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwcGluZy5vcmlnaW5hbENv
bHVtbiwKKysJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZSwKKysJICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGUsCisrCSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBtYXBwaW5nLm5hbWUpKTsKKysJICAgICAgICB9CisrCSAgICAgIH0K
KysJICAgIH07CisrCisrCSAgLyoqCisrCSAgICogQWRkIGEgY2h1bmsgb2YgZ2VuZXJhdGVkIEpT
IHRvIHRoaXMgc291cmNlIG5vZGUuCisrCSAgICoKKysJICAgKiBAcGFyYW0gYUNodW5rIEEgc3Ry
aW5nIHNuaXBwZXQgb2YgZ2VuZXJhdGVkIEpTIGNvZGUsIGFub3RoZXIgaW5zdGFuY2Ugb2YKKysJ
ICAgKiAgICAgICAgU291cmNlTm9kZSwgb3IgYW4gYXJyYXkgd2hlcmUgZWFjaCBtZW1iZXIgaXMg
b25lIG9mIHRob3NlIHRoaW5ncy4KKysJICAgKi8KKysJICBTb3VyY2VOb2RlLnByb3RvdHlwZS5h
ZGQgPSBmdW5jdGlvbiBTb3VyY2VOb2RlX2FkZChhQ2h1bmspIHsKKysJICAgIGlmIChBcnJheS5p
c0FycmF5KGFDaHVuaykpIHsKKysJICAgICAgYUNodW5rLmZvckVhY2goZnVuY3Rpb24gKGNodW5r
KSB7CisrCSAgICAgICAgdGhpcy5hZGQoY2h1bmspOworKwkgICAgICB9LCB0aGlzKTsKKysJICAg
IH0KKysJICAgIGVsc2UgaWYgKGFDaHVua1tpc1NvdXJjZU5vZGVdIHx8IHR5cGVvZiBhQ2h1bmsg
PT09ICJzdHJpbmciKSB7CisrCSAgICAgIGlmIChhQ2h1bmspIHsKKysJICAgICAgICB0aGlzLmNo
aWxkcmVuLnB1c2goYUNodW5rKTsKKysJICAgICAgfQorKwkgICAgfQorKwkgICAgZWxzZSB7Cisr
CSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoCisrCSAgICAgICAgIkV4cGVjdGVkIGEgU291cmNl
Tm9kZSwgc3RyaW5nLCBvciBhbiBhcnJheSBvZiBTb3VyY2VOb2RlcyBhbmQgc3RyaW5ncy4gR290
ICIgKyBhQ2h1bmsKKysJICAgICAgKTsKKysJICAgIH0KKysJICAgIHJldHVybiB0aGlzOworKwkg
IH07CisrCisrCSAgLyoqCisrCSAgICogQWRkIGEgY2h1bmsgb2YgZ2VuZXJhdGVkIEpTIHRvIHRo
ZSBiZWdpbm5pbmcgb2YgdGhpcyBzb3VyY2Ugbm9kZS4KKysJICAgKgorKwkgICAqIEBwYXJhbSBh
Q2h1bmsgQSBzdHJpbmcgc25pcHBldCBvZiBnZW5lcmF0ZWQgSlMgY29kZSwgYW5vdGhlciBpbnN0
YW5jZSBvZgorKwkgICAqICAgICAgICBTb3VyY2VOb2RlLCBvciBhbiBhcnJheSB3aGVyZSBlYWNo
IG1lbWJlciBpcyBvbmUgb2YgdGhvc2UgdGhpbmdzLgorKwkgICAqLworKwkgIFNvdXJjZU5vZGUu
cHJvdG90eXBlLnByZXBlbmQgPSBmdW5jdGlvbiBTb3VyY2VOb2RlX3ByZXBlbmQoYUNodW5rKSB7
CisrCSAgICBpZiAoQXJyYXkuaXNBcnJheShhQ2h1bmspKSB7CisrCSAgICAgIGZvciAodmFyIGkg
PSBhQ2h1bmsubGVuZ3RoLTE7IGkgPj0gMDsgaS0tKSB7CisrCSAgICAgICAgdGhpcy5wcmVwZW5k
KGFDaHVua1tpXSk7CisrCSAgICAgIH0KKysJICAgIH0KKysJICAgIGVsc2UgaWYgKGFDaHVua1tp
c1NvdXJjZU5vZGVdIHx8IHR5cGVvZiBhQ2h1bmsgPT09ICJzdHJpbmciKSB7CisrCSAgICAgIHRo
aXMuY2hpbGRyZW4udW5zaGlmdChhQ2h1bmspOworKwkgICAgfQorKwkgICAgZWxzZSB7CisrCSAg
ICAgIHRocm93IG5ldyBUeXBlRXJyb3IoCisrCSAgICAgICAgIkV4cGVjdGVkIGEgU291cmNlTm9k
ZSwgc3RyaW5nLCBvciBhbiBhcnJheSBvZiBTb3VyY2VOb2RlcyBhbmQgc3RyaW5ncy4gR290ICIg
KyBhQ2h1bmsKKysJICAgICAgKTsKKysJICAgIH0KKysJICAgIHJldHVybiB0aGlzOworKwkgIH07
CisrCisrCSAgLyoqCisrCSAgICogV2FsayBvdmVyIHRoZSB0cmVlIG9mIEpTIHNuaXBwZXRzIGlu
IHRoaXMgbm9kZSBhbmQgaXRzIGNoaWxkcmVuLiBUaGUKKysJICAgKiB3YWxraW5nIGZ1bmN0aW9u
IGlzIGNhbGxlZCBvbmNlIGZvciBlYWNoIHNuaXBwZXQgb2YgSlMgYW5kIGlzIHBhc3NlZCB0aGF0
CisrCSAgICogc25pcHBldCBhbmQgdGhlIGl0cyBvcmlnaW5hbCBhc3NvY2lhdGVkIHNvdXJjZSdz
IGxpbmUvY29sdW1uIGxvY2F0aW9uLgorKwkgICAqCisrCSAgICogQHBhcmFtIGFGbiBUaGUgdHJh
dmVyc2FsIGZ1bmN0aW9uLgorKwkgICAqLworKwkgIFNvdXJjZU5vZGUucHJvdG90eXBlLndhbGsg
PSBmdW5jdGlvbiBTb3VyY2VOb2RlX3dhbGsoYUZuKSB7CisrCSAgICB2YXIgY2h1bms7CisrCSAg
ICBmb3IgKHZhciBpID0gMCwgbGVuID0gdGhpcy5jaGlsZHJlbi5sZW5ndGg7IGkgPCBsZW47IGkr
KykgeworKwkgICAgICBjaHVuayA9IHRoaXMuY2hpbGRyZW5baV07CisrCSAgICAgIGlmIChjaHVu
a1tpc1NvdXJjZU5vZGVdKSB7CisrCSAgICAgICAgY2h1bmsud2FsayhhRm4pOworKwkgICAgICB9
CisrCSAgICAgIGVsc2UgeworKwkgICAgICAgIGlmIChjaHVuayAhPT0gJycpIHsKKysJICAgICAg
ICAgIGFGbihjaHVuaywgeyBzb3VyY2U6IHRoaXMuc291cmNlLAorKwkgICAgICAgICAgICAgICAg
ICAgICAgIGxpbmU6IHRoaXMubGluZSwKKysJICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW46
IHRoaXMuY29sdW1uLAorKwkgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMubmFtZSB9
KTsKKysJICAgICAgICB9CisrCSAgICAgIH0KKysJICAgIH0KKysJICB9OworKworKwkgIC8qKgor
KwkgICAqIExpa2UgYFN0cmluZy5wcm90b3R5cGUuam9pbmAgZXhjZXB0IGZvciBTb3VyY2VOb2Rl
cy4gSW5zZXJ0cyBgYVN0cmAgYmV0d2VlbgorKwkgICAqIGVhY2ggb2YgYHRoaXMuY2hpbGRyZW5g
LgorKwkgICAqCisrCSAgICogQHBhcmFtIGFTZXAgVGhlIHNlcGFyYXRvci4KKysJICAgKi8KKysJ
ICBTb3VyY2VOb2RlLnByb3RvdHlwZS5qb2luID0gZnVuY3Rpb24gU291cmNlTm9kZV9qb2luKGFT
ZXApIHsKKysJICAgIHZhciBuZXdDaGlsZHJlbjsKKysJICAgIHZhciBpOworKwkgICAgdmFyIGxl
biA9IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOworKwkgICAgaWYgKGxlbiA+IDApIHsKKysJICAgICAg
bmV3Q2hpbGRyZW4gPSBbXTsKKysJICAgICAgZm9yIChpID0gMDsgaSA8IGxlbi0xOyBpKyspIHsK
KysJICAgICAgICBuZXdDaGlsZHJlbi5wdXNoKHRoaXMuY2hpbGRyZW5baV0pOworKwkgICAgICAg
IG5ld0NoaWxkcmVuLnB1c2goYVNlcCk7CisrCSAgICAgIH0KKysJICAgICAgbmV3Q2hpbGRyZW4u
cHVzaCh0aGlzLmNoaWxkcmVuW2ldKTsKKysJICAgICAgdGhpcy5jaGlsZHJlbiA9IG5ld0NoaWxk
cmVuOworKwkgICAgfQorKwkgICAgcmV0dXJuIHRoaXM7CisrCSAgfTsKKysKKysJICAvKioKKysJ
ICAgKiBDYWxsIFN0cmluZy5wcm90b3R5cGUucmVwbGFjZSBvbiB0aGUgdmVyeSByaWdodC1tb3N0
IHNvdXJjZSBzbmlwcGV0LiBVc2VmdWwKKysJICAgKiBmb3IgdHJpbW1pbmcgd2hpdGVzcGFjZSBm
cm9tIHRoZSBlbmQgb2YgYSBzb3VyY2Ugbm9kZSwgZXRjLgorKwkgICAqCisrCSAgICogQHBhcmFt
IGFQYXR0ZXJuIFRoZSBwYXR0ZXJuIHRvIHJlcGxhY2UuCisrCSAgICogQHBhcmFtIGFSZXBsYWNl
bWVudCBUaGUgdGhpbmcgdG8gcmVwbGFjZSB0aGUgcGF0dGVybiB3aXRoLgorKwkgICAqLworKwkg
IFNvdXJjZU5vZGUucHJvdG90eXBlLnJlcGxhY2VSaWdodCA9IGZ1bmN0aW9uIFNvdXJjZU5vZGVf
cmVwbGFjZVJpZ2h0KGFQYXR0ZXJuLCBhUmVwbGFjZW1lbnQpIHsKKysJICAgIHZhciBsYXN0Q2hp
bGQgPSB0aGlzLmNoaWxkcmVuW3RoaXMuY2hpbGRyZW4ubGVuZ3RoIC0gMV07CisrCSAgICBpZiAo
bGFzdENoaWxkW2lzU291cmNlTm9kZV0pIHsKKysJICAgICAgbGFzdENoaWxkLnJlcGxhY2VSaWdo
dChhUGF0dGVybiwgYVJlcGxhY2VtZW50KTsKKysJICAgIH0KKysJICAgIGVsc2UgaWYgKHR5cGVv
ZiBsYXN0Q2hpbGQgPT09ICdzdHJpbmcnKSB7CisrCSAgICAgIHRoaXMuY2hpbGRyZW5bdGhpcy5j
aGlsZHJlbi5sZW5ndGggLSAxXSA9IGxhc3RDaGlsZC5yZXBsYWNlKGFQYXR0ZXJuLCBhUmVwbGFj
ZW1lbnQpOworKwkgICAgfQorKwkgICAgZWxzZSB7CisrCSAgICAgIHRoaXMuY2hpbGRyZW4ucHVz
aCgnJy5yZXBsYWNlKGFQYXR0ZXJuLCBhUmVwbGFjZW1lbnQpKTsKKysJICAgIH0KKysJICAgIHJl
dHVybiB0aGlzOworKwkgIH07CisrCisrCSAgLyoqCisrCSAgICogU2V0IHRoZSBzb3VyY2UgY29u
dGVudCBmb3IgYSBzb3VyY2UgZmlsZS4gVGhpcyB3aWxsIGJlIGFkZGVkIHRvIHRoZSBTb3VyY2VN
YXBHZW5lcmF0b3IKKysJICAgKiBpbiB0aGUgc291cmNlc0NvbnRlbnQgZmllbGQuCisrCSAgICoK
KysJICAgKiBAcGFyYW0gYVNvdXJjZUZpbGUgVGhlIGZpbGVuYW1lIG9mIHRoZSBzb3VyY2UgZmls
ZQorKwkgICAqIEBwYXJhbSBhU291cmNlQ29udGVudCBUaGUgY29udGVudCBvZiB0aGUgc291cmNl
IGZpbGUKKysJICAgKi8KKysJICBTb3VyY2VOb2RlLnByb3RvdHlwZS5zZXRTb3VyY2VDb250ZW50
ID0KKysJICAgIGZ1bmN0aW9uIFNvdXJjZU5vZGVfc2V0U291cmNlQ29udGVudChhU291cmNlRmls
ZSwgYVNvdXJjZUNvbnRlbnQpIHsKKysJICAgICAgdGhpcy5zb3VyY2VDb250ZW50c1t1dGlsLnRv
U2V0U3RyaW5nKGFTb3VyY2VGaWxlKV0gPSBhU291cmNlQ29udGVudDsKKysJICAgIH07CisrCisr
CSAgLyoqCisrCSAgICogV2FsayBvdmVyIHRoZSB0cmVlIG9mIFNvdXJjZU5vZGVzLiBUaGUgd2Fs
a2luZyBmdW5jdGlvbiBpcyBjYWxsZWQgZm9yIGVhY2gKKysJICAgKiBzb3VyY2UgZmlsZSBjb250
ZW50IGFuZCBpcyBwYXNzZWQgdGhlIGZpbGVuYW1lIGFuZCBzb3VyY2UgY29udGVudC4KKysJICAg
KgorKwkgICAqIEBwYXJhbSBhRm4gVGhlIHRyYXZlcnNhbCBmdW5jdGlvbi4KKysJICAgKi8KKysJ
ICBTb3VyY2VOb2RlLnByb3RvdHlwZS53YWxrU291cmNlQ29udGVudHMgPQorKwkgICAgZnVuY3Rp
b24gU291cmNlTm9kZV93YWxrU291cmNlQ29udGVudHMoYUZuKSB7CisrCSAgICAgIGZvciAodmFy
IGkgPSAwLCBsZW4gPSB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CisrCSAg
ICAgICAgaWYgKHRoaXMuY2hpbGRyZW5baV1baXNTb3VyY2VOb2RlXSkgeworKwkgICAgICAgICAg
dGhpcy5jaGlsZHJlbltpXS53YWxrU291cmNlQ29udGVudHMoYUZuKTsKKysJICAgICAgICB9Cisr
CSAgICAgIH0KKysKKysJICAgICAgdmFyIHNvdXJjZXMgPSBPYmplY3Qua2V5cyh0aGlzLnNvdXJj
ZUNvbnRlbnRzKTsKKysJICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHNvdXJjZXMubGVuZ3Ro
OyBpIDwgbGVuOyBpKyspIHsKKysJICAgICAgICBhRm4odXRpbC5mcm9tU2V0U3RyaW5nKHNvdXJj
ZXNbaV0pLCB0aGlzLnNvdXJjZUNvbnRlbnRzW3NvdXJjZXNbaV1dKTsKKysJICAgICAgfQorKwkg
ICAgfTsKKysKKysJICAvKioKKysJICAgKiBSZXR1cm4gdGhlIHN0cmluZyByZXByZXNlbnRhdGlv
biBvZiB0aGlzIHNvdXJjZSBub2RlLiBXYWxrcyBvdmVyIHRoZSB0cmVlCisrCSAgICogYW5kIGNv
bmNhdGVuYXRlcyBhbGwgdGhlIHZhcmlvdXMgc25pcHBldHMgdG9nZXRoZXIgdG8gb25lIHN0cmlu
Zy4KKysJICAgKi8KKysJICBTb3VyY2VOb2RlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9u
IFNvdXJjZU5vZGVfdG9TdHJpbmcoKSB7CisrCSAgICB2YXIgc3RyID0gIiI7CisrCSAgICB0aGlz
LndhbGsoZnVuY3Rpb24gKGNodW5rKSB7CisrCSAgICAgIHN0ciArPSBjaHVuazsKKysJICAgIH0p
OworKwkgICAgcmV0dXJuIHN0cjsKKysJICB9OworKworKwkgIC8qKgorKwkgICAqIFJldHVybnMg
dGhlIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGlzIHNvdXJjZSBub2RlIGFsb25nIHdpdGgg
YSBzb3VyY2UKKysJICAgKiBtYXAuCisrCSAgICovCisrCSAgU291cmNlTm9kZS5wcm90b3R5cGUu
dG9TdHJpbmdXaXRoU291cmNlTWFwID0gZnVuY3Rpb24gU291cmNlTm9kZV90b1N0cmluZ1dpdGhT
b3VyY2VNYXAoYUFyZ3MpIHsKKysJICAgIHZhciBnZW5lcmF0ZWQgPSB7CisrCSAgICAgIGNvZGU6
ICIiLAorKwkgICAgICBsaW5lOiAxLAorKwkgICAgICBjb2x1bW46IDAKKysJICAgIH07CisrCSAg
ICB2YXIgbWFwID0gbmV3IFNvdXJjZU1hcEdlbmVyYXRvcihhQXJncyk7CisrCSAgICB2YXIgc291
cmNlTWFwcGluZ0FjdGl2ZSA9IGZhbHNlOworKwkgICAgdmFyIGxhc3RPcmlnaW5hbFNvdXJjZSA9
IG51bGw7CisrCSAgICB2YXIgbGFzdE9yaWdpbmFsTGluZSA9IG51bGw7CisrCSAgICB2YXIgbGFz
dE9yaWdpbmFsQ29sdW1uID0gbnVsbDsKKysJICAgIHZhciBsYXN0T3JpZ2luYWxOYW1lID0gbnVs
bDsKKysJICAgIHRoaXMud2FsayhmdW5jdGlvbiAoY2h1bmssIG9yaWdpbmFsKSB7CisrCSAgICAg
IGdlbmVyYXRlZC5jb2RlICs9IGNodW5rOworKwkgICAgICBpZiAob3JpZ2luYWwuc291cmNlICE9
PSBudWxsCisrCSAgICAgICAgICAmJiBvcmlnaW5hbC5saW5lICE9PSBudWxsCisrCSAgICAgICAg
ICAmJiBvcmlnaW5hbC5jb2x1bW4gIT09IG51bGwpIHsKKysJICAgICAgICBpZihsYXN0T3JpZ2lu
YWxTb3VyY2UgIT09IG9yaWdpbmFsLnNvdXJjZQorKwkgICAgICAgICAgIHx8IGxhc3RPcmlnaW5h
bExpbmUgIT09IG9yaWdpbmFsLmxpbmUKKysJICAgICAgICAgICB8fCBsYXN0T3JpZ2luYWxDb2x1
bW4gIT09IG9yaWdpbmFsLmNvbHVtbgorKwkgICAgICAgICAgIHx8IGxhc3RPcmlnaW5hbE5hbWUg
IT09IG9yaWdpbmFsLm5hbWUpIHsKKysJICAgICAgICAgIG1hcC5hZGRNYXBwaW5nKHsKKysJICAg
ICAgICAgICAgc291cmNlOiBvcmlnaW5hbC5zb3VyY2UsCisrCSAgICAgICAgICAgIG9yaWdpbmFs
OiB7CisrCSAgICAgICAgICAgICAgbGluZTogb3JpZ2luYWwubGluZSwKKysJICAgICAgICAgICAg
ICBjb2x1bW46IG9yaWdpbmFsLmNvbHVtbgorKwkgICAgICAgICAgICB9LAorKwkgICAgICAgICAg
ICBnZW5lcmF0ZWQ6IHsKKysJICAgICAgICAgICAgICBsaW5lOiBnZW5lcmF0ZWQubGluZSwKKysJ
ICAgICAgICAgICAgICBjb2x1bW46IGdlbmVyYXRlZC5jb2x1bW4KKysJICAgICAgICAgICAgfSwK
KysJICAgICAgICAgICAgbmFtZTogb3JpZ2luYWwubmFtZQorKwkgICAgICAgICAgfSk7CisrCSAg
ICAgICAgfQorKwkgICAgICAgIGxhc3RPcmlnaW5hbFNvdXJjZSA9IG9yaWdpbmFsLnNvdXJjZTsK
KysJICAgICAgICBsYXN0T3JpZ2luYWxMaW5lID0gb3JpZ2luYWwubGluZTsKKysJICAgICAgICBs
YXN0T3JpZ2luYWxDb2x1bW4gPSBvcmlnaW5hbC5jb2x1bW47CisrCSAgICAgICAgbGFzdE9yaWdp
bmFsTmFtZSA9IG9yaWdpbmFsLm5hbWU7CisrCSAgICAgICAgc291cmNlTWFwcGluZ0FjdGl2ZSA9
IHRydWU7CisrCSAgICAgIH0gZWxzZSBpZiAoc291cmNlTWFwcGluZ0FjdGl2ZSkgeworKwkgICAg
ICAgIG1hcC5hZGRNYXBwaW5nKHsKKysJICAgICAgICAgIGdlbmVyYXRlZDogeworKwkgICAgICAg
ICAgICBsaW5lOiBnZW5lcmF0ZWQubGluZSwKKysJICAgICAgICAgICAgY29sdW1uOiBnZW5lcmF0
ZWQuY29sdW1uCisrCSAgICAgICAgICB9CisrCSAgICAgICAgfSk7CisrCSAgICAgICAgbGFzdE9y
aWdpbmFsU291cmNlID0gbnVsbDsKKysJICAgICAgICBzb3VyY2VNYXBwaW5nQWN0aXZlID0gZmFs
c2U7CisrCSAgICAgIH0KKysJICAgICAgZm9yICh2YXIgaWR4ID0gMCwgbGVuZ3RoID0gY2h1bmsu
bGVuZ3RoOyBpZHggPCBsZW5ndGg7IGlkeCsrKSB7CisrCSAgICAgICAgaWYgKGNodW5rLmNoYXJD
b2RlQXQoaWR4KSA9PT0gTkVXTElORV9DT0RFKSB7CisrCSAgICAgICAgICBnZW5lcmF0ZWQubGlu
ZSsrOworKwkgICAgICAgICAgZ2VuZXJhdGVkLmNvbHVtbiA9IDA7CisrCSAgICAgICAgICAvLyBN
YXBwaW5ncyBlbmQgYXQgZW9sCisrCSAgICAgICAgICBpZiAoaWR4ICsgMSA9PT0gbGVuZ3RoKSB7
CisrCSAgICAgICAgICAgIGxhc3RPcmlnaW5hbFNvdXJjZSA9IG51bGw7CisrCSAgICAgICAgICAg
IHNvdXJjZU1hcHBpbmdBY3RpdmUgPSBmYWxzZTsKKysJICAgICAgICAgIH0gZWxzZSBpZiAoc291
cmNlTWFwcGluZ0FjdGl2ZSkgeworKwkgICAgICAgICAgICBtYXAuYWRkTWFwcGluZyh7CisrCSAg
ICAgICAgICAgICAgc291cmNlOiBvcmlnaW5hbC5zb3VyY2UsCisrCSAgICAgICAgICAgICAgb3Jp
Z2luYWw6IHsKKysJICAgICAgICAgICAgICAgIGxpbmU6IG9yaWdpbmFsLmxpbmUsCisrCSAgICAg
ICAgICAgICAgICBjb2x1bW46IG9yaWdpbmFsLmNvbHVtbgorKwkgICAgICAgICAgICAgIH0sCisr
CSAgICAgICAgICAgICAgZ2VuZXJhdGVkOiB7CisrCSAgICAgICAgICAgICAgICBsaW5lOiBnZW5l
cmF0ZWQubGluZSwKKysJICAgICAgICAgICAgICAgIGNvbHVtbjogZ2VuZXJhdGVkLmNvbHVtbgor
KwkgICAgICAgICAgICAgIH0sCisrCSAgICAgICAgICAgICAgbmFtZTogb3JpZ2luYWwubmFtZQor
KwkgICAgICAgICAgICB9KTsKKysJICAgICAgICAgIH0KKysJICAgICAgICB9IGVsc2UgeworKwkg
ICAgICAgICAgZ2VuZXJhdGVkLmNvbHVtbisrOworKwkgICAgICAgIH0KKysJICAgICAgfQorKwkg
ICAgfSk7CisrCSAgICB0aGlzLndhbGtTb3VyY2VDb250ZW50cyhmdW5jdGlvbiAoc291cmNlRmls
ZSwgc291cmNlQ29udGVudCkgeworKwkgICAgICBtYXAuc2V0U291cmNlQ29udGVudChzb3VyY2VG
aWxlLCBzb3VyY2VDb250ZW50KTsKKysJICAgIH0pOworKworKwkgICAgcmV0dXJuIHsgY29kZTog
Z2VuZXJhdGVkLmNvZGUsIG1hcDogbWFwIH07CisrCSAgfTsKKysKKysJICBleHBvcnRzLlNvdXJj
ZU5vZGUgPSBTb3VyY2VOb2RlOworKwl9CisrCisrCisrLyoqKi8gfQorKy8qKioqKiovIF0pCisr
fSk7CisrOworXCBObyBuZXdsaW5lIGF0IGVuZCBvZiBmaWxlCitkaWZmIC0tZ2l0IGEvbGliL3Vn
bGlmaWVyLmpzIGIvbGliL3VnbGlmaWVyLmpzCitpbmRleCBjNzUzMmYyLi4xNjliNzE2IDEwMDY0
NAorLS0tIGEvbGliL3VnbGlmaWVyLmpzCisrKysgYi9saWIvdWdsaWZpZXIuanMKK0BAIC0xLDMg
KzEsNiBAQAorKy8vIFNldCBzb3VyY2UtbWFwLmpzIHNvdXJjZU1hcCB0byB1Z2xpZnkuanMgTU9a
X1NvdXJjZU1hcAorK01PWl9Tb3VyY2VNYXAgPSBzb3VyY2VNYXA7CisrCisgZnVuY3Rpb24gY29t
bWVudHMob3B0aW9uKSB7CisgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9w
dGlvbikgPT09ICdbb2JqZWN0IEFycmF5XScpIHsKKyAgICAgcmV0dXJuIG5ldyBSZWdFeHAob3B0
aW9uWzBdLCBvcHRpb25bMV0pOworZGlmZiAtLWdpdCBhL2xpYi91Z2xpZmllci5yYiBiL2xpYi91
Z2xpZmllci5yYgoraW5kZXggMmI0Y2UwNS4uZGUyNGUyNiAxMDA2NDQKKy0tLSBhL2xpYi91Z2xp
Zmllci5yYgorKysrIGIvbGliL3VnbGlmaWVyLnJiCitAQCAtMTIsNiArMTIsOCBAQCBjbGFzcyBV
Z2xpZmllcgorIAorICAgIyBVZ2xpZnlKUyBzb3VyY2UgcGF0aAorICAgU291cmNlUGF0aCA9IEZp
bGUuZXhwYW5kX3BhdGgoIi4uL3VnbGlmeS5qcyIsIF9fRklMRV9fKQorKyAgIyBTb3VyY2UgTWFw
IHBhdGgKKysgIFNvdXJjZU1hcFBhdGggPSBGaWxlLmV4cGFuZF9wYXRoKCIuLi9zb3VyY2UtbWFw
LmpzIiwgX19GSUxFX18pCisgICAjIEVTNSBzaGltcyBzb3VyY2UgcGF0aAorICAgRVM1RmFsbGJh
Y2tQYXRoID0gRmlsZS5leHBhbmRfcGF0aCgiLi4vZXM1LmpzIiwgX19GSUxFX18pCisgICAjIFN0
cmluZy5zcGxpdCBzaGltIHNvdXJjZSBwYXRoCitAQCAtMTUyLDcgKzE1NCw4IEBAIGNsYXNzIFVn
bGlmaWVyCisgICBwcml2YXRlCisgCisgICBkZWYgdWdsaWZ5anNfc291cmNlCistICAgIFtFUzVG
YWxsYmFja1BhdGgsIFNwbGl0RmFsbGJhY2tQYXRoLCBTb3VyY2VQYXRoLCBVZ2xpZnlKU1dyYXBw
ZXJQYXRoXS5tYXAgZG8gfGZpbGV8CisrICAgIFtFUzVGYWxsYmFja1BhdGgsIFNwbGl0RmFsbGJh
Y2tQYXRoLCBTb3VyY2VNYXBQYXRoLCBTb3VyY2VQYXRoLAorKyAgICAgVWdsaWZ5SlNXcmFwcGVy
UGF0aF0ubWFwIGRvIHxmaWxlfAorICAgICAgIEZpbGUub3BlbihmaWxlLCAicjpVVEYtOCIsICY6
cmVhZCkKKyAgICAgZW5kLmpvaW4oIlxuIikKKyAgIGVuZAorZGlmZiAtLWdpdCBhL2xpYi91Z2xp
ZnkuanMgYi9saWIvdWdsaWZ5LmpzCitpbmRleCBjMmVkMDc1Li4xMmQwMjVkIDEwMDY0NAorLS0t
IGEvbGliL3VnbGlmeS5qcworKysrIGIvbGliL3VnbGlmeS5qcworQEAgLTEsMzAwOCArMSw0IEBA
Cistd2luZG93ID0gdGhpczsoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRp
b24ocm9vdCwgZmFjdG9yeSkgeworLQlpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYg
dHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpCistCQltb2R1bGUuZXhwb3J0cyA9IGZhY3Rvcnko
KTsKKy0JZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQp
CistCQlkZWZpbmUoW10sIGZhY3RvcnkpOworLQllbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAn
b2JqZWN0JykKKy0JCWV4cG9ydHNbInNvdXJjZU1hcCJdID0gZmFjdG9yeSgpOworLQllbHNlCist
CQlyb290WyJzb3VyY2VNYXAiXSA9IGZhY3RvcnkoKTsKKy19KSh0aGlzLCBmdW5jdGlvbigpIHsK
Ky1yZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJh
cAorLS8qKioqKiovIAkvLyBUaGUgbW9kdWxlIGNhY2hlCistLyoqKioqKi8gCXZhciBpbnN0YWxs
ZWRNb2R1bGVzID0ge307CistCistLyoqKioqKi8gCS8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uCist
LyoqKioqKi8gCWZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHsKKy0KKy0v
KioqKioqLyAJCS8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZQorLS8qKioqKiovIAkJaWYo
aW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pCistLyoqKioqKi8gCQkJcmV0dXJuIGluc3RhbGxl
ZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7CistCistLyoqKioqKi8gCQkvLyBDcmVhdGUgYSBu
ZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKQorLS8qKioqKiovIAkJdmFyIG1v
ZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0geworLS8qKioqKiovIAkJCWV4cG9y
dHM6IHt9LAorLS8qKioqKiovIAkJCWlkOiBtb2R1bGVJZCwKKy0vKioqKioqLyAJCQlsb2FkZWQ6
IGZhbHNlCistLyoqKioqKi8gCQl9OworLQorLS8qKioqKiovIAkJLy8gRXhlY3V0ZSB0aGUgbW9k
dWxlIGZ1bmN0aW9uCistLyoqKioqKi8gCQltb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5l
eHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTsKKy0K
Ky0vKioqKioqLyAJCS8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWQKKy0vKioqKioqLyAJCW1v
ZHVsZS5sb2FkZWQgPSB0cnVlOworLQorLS8qKioqKiovIAkJLy8gUmV0dXJuIHRoZSBleHBvcnRz
IG9mIHRoZSBtb2R1bGUKKy0vKioqKioqLyAJCXJldHVybiBtb2R1bGUuZXhwb3J0czsKKy0vKioq
KioqLyAJfQorLQorLQorLS8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChf
X3dlYnBhY2tfbW9kdWxlc19fKQorLS8qKioqKiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBt
b2R1bGVzOworLQorLS8qKioqKiovIAkvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZQorLS8qKioq
KiovIAlfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzOworLQorLS8qKioq
KiovIAkvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfXworLS8qKioqKiovIAlfX3dlYnBhY2tfcmVx
dWlyZV9fLnAgPSAiIjsKKy0KKy0vKioqKioqLyAJLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJl
dHVybiBleHBvcnRzCistLyoqKioqKi8gCXJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApOwor
LS8qKioqKiovIH0pCistLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KKy0vKioqKioqLyAoWworLS8qIDAgKi8K
Ky0vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsK
Ky0KKy0JLyoKKy0JICogQ29weXJpZ2h0IDIwMDktMjAxMSBNb3ppbGxhIEZvdW5kYXRpb24gYW5k
IGNvbnRyaWJ1dG9ycworLQkgKiBMaWNlbnNlZCB1bmRlciB0aGUgTmV3IEJTRCBsaWNlbnNlLiBT
ZWUgTElDRU5TRS50eHQgb3I6CistCSAqIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9C
U0QtMy1DbGF1c2UKKy0JICovCistCWV4cG9ydHMuU291cmNlTWFwR2VuZXJhdG9yID0gX193ZWJw
YWNrX3JlcXVpcmVfXygxKS5Tb3VyY2VNYXBHZW5lcmF0b3I7CistCWV4cG9ydHMuU291cmNlTWFw
Q29uc3VtZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpLlNvdXJjZU1hcENvbnN1bWVyOworLQll
eHBvcnRzLlNvdXJjZU5vZGUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEwKS5Tb3VyY2VOb2RlOwor
LQorLQorLS8qKiovIH0sCistLyogMSAqLworLS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0
cywgX193ZWJwYWNrX3JlcXVpcmVfXykgeworLQorLQkvKiAtKi0gTW9kZToganM7IGpzLWluZGVu
dC1sZXZlbDogMjsgLSotICovCistCS8qCistCSAqIENvcHlyaWdodCAyMDExIE1vemlsbGEgRm91
bmRhdGlvbiBhbmQgY29udHJpYnV0b3JzCistCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBOZXcgQlNE
IGxpY2Vuc2UuIFNlZSBMSUNFTlNFIG9yOgorLQkgKiBodHRwOi8vb3BlbnNvdXJjZS5vcmcvbGlj
ZW5zZXMvQlNELTMtQ2xhdXNlCistCSAqLworLQl7CistCSAgdmFyIGJhc2U2NFZMUSA9IF9fd2Vi
cGFja19yZXF1aXJlX18oMik7CistCSAgdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQp
OworLQkgIHZhciBBcnJheVNldCA9IF9fd2VicGFja19yZXF1aXJlX18oNSkuQXJyYXlTZXQ7Cist
CSAgdmFyIE1hcHBpbmdMaXN0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KS5NYXBwaW5nTGlzdDsK
Ky0KKy0JICAvKioKKy0JICAgKiBBbiBpbnN0YW5jZSBvZiB0aGUgU291cmNlTWFwR2VuZXJhdG9y
IHJlcHJlc2VudHMgYSBzb3VyY2UgbWFwIHdoaWNoIGlzCistCSAgICogYmVpbmcgYnVpbHQgaW5j
cmVtZW50YWxseS4gWW91IG1heSBwYXNzIGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcKKy0J
ICAgKiBwcm9wZXJ0aWVzOgorLQkgICAqCistCSAgICogICAtIGZpbGU6IFRoZSBmaWxlbmFtZSBv
ZiB0aGUgZ2VuZXJhdGVkIHNvdXJjZS4KKy0JICAgKiAgIC0gc291cmNlUm9vdDogQSByb290IGZv
ciBhbGwgcmVsYXRpdmUgVVJMcyBpbiB0aGlzIHNvdXJjZSBtYXAuCistCSAgICovCistCSAgZnVu
Y3Rpb24gU291cmNlTWFwR2VuZXJhdG9yKGFBcmdzKSB7CistCSAgICBpZiAoIWFBcmdzKSB7Cist
CSAgICAgIGFBcmdzID0ge307CistCSAgICB9CistCSAgICB0aGlzLl9maWxlID0gdXRpbC5nZXRB
cmcoYUFyZ3MsICdmaWxlJywgbnVsbCk7CistCSAgICB0aGlzLl9zb3VyY2VSb290ID0gdXRpbC5n
ZXRBcmcoYUFyZ3MsICdzb3VyY2VSb290JywgbnVsbCk7CistCSAgICB0aGlzLl9za2lwVmFsaWRh
dGlvbiA9IHV0aWwuZ2V0QXJnKGFBcmdzLCAnc2tpcFZhbGlkYXRpb24nLCBmYWxzZSk7CistCSAg
ICB0aGlzLl9zb3VyY2VzID0gbmV3IEFycmF5U2V0KCk7CistCSAgICB0aGlzLl9uYW1lcyA9IG5l
dyBBcnJheVNldCgpOworLQkgICAgdGhpcy5fbWFwcGluZ3MgPSBuZXcgTWFwcGluZ0xpc3QoKTsK
Ky0JICAgIHRoaXMuX3NvdXJjZXNDb250ZW50cyA9IG51bGw7CistCSAgfQorLQorLQkgIFNvdXJj
ZU1hcEdlbmVyYXRvci5wcm90b3R5cGUuX3ZlcnNpb24gPSAzOworLQorLQkgIC8qKgorLQkgICAq
IENyZWF0ZXMgYSBuZXcgU291cmNlTWFwR2VuZXJhdG9yIGJhc2VkIG9uIGEgU291cmNlTWFwQ29u
c3VtZXIKKy0JICAgKgorLQkgICAqIEBwYXJhbSBhU291cmNlTWFwQ29uc3VtZXIgVGhlIFNvdXJj
ZU1hcC4KKy0JICAgKi8KKy0JICBTb3VyY2VNYXBHZW5lcmF0b3IuZnJvbVNvdXJjZU1hcCA9Cist
CSAgICBmdW5jdGlvbiBTb3VyY2VNYXBHZW5lcmF0b3JfZnJvbVNvdXJjZU1hcChhU291cmNlTWFw
Q29uc3VtZXIpIHsKKy0JICAgICAgdmFyIHNvdXJjZVJvb3QgPSBhU291cmNlTWFwQ29uc3VtZXIu
c291cmNlUm9vdDsKKy0JICAgICAgdmFyIGdlbmVyYXRvciA9IG5ldyBTb3VyY2VNYXBHZW5lcmF0
b3IoeworLQkgICAgICAgIGZpbGU6IGFTb3VyY2VNYXBDb25zdW1lci5maWxlLAorLQkgICAgICAg
IHNvdXJjZVJvb3Q6IHNvdXJjZVJvb3QKKy0JICAgICAgfSk7CistCSAgICAgIGFTb3VyY2VNYXBD
b25zdW1lci5lYWNoTWFwcGluZyhmdW5jdGlvbiAobWFwcGluZykgeworLQkgICAgICAgIHZhciBu
ZXdNYXBwaW5nID0geworLQkgICAgICAgICAgZ2VuZXJhdGVkOiB7CistCSAgICAgICAgICAgIGxp
bmU6IG1hcHBpbmcuZ2VuZXJhdGVkTGluZSwKKy0JICAgICAgICAgICAgY29sdW1uOiBtYXBwaW5n
LmdlbmVyYXRlZENvbHVtbgorLQkgICAgICAgICAgfQorLQkgICAgICAgIH07CistCistCSAgICAg
ICAgaWYgKG1hcHBpbmcuc291cmNlICE9IG51bGwpIHsKKy0JICAgICAgICAgIG5ld01hcHBpbmcu
c291cmNlID0gbWFwcGluZy5zb3VyY2U7CistCSAgICAgICAgICBpZiAoc291cmNlUm9vdCAhPSBu
dWxsKSB7CistCSAgICAgICAgICAgIG5ld01hcHBpbmcuc291cmNlID0gdXRpbC5yZWxhdGl2ZShz
b3VyY2VSb290LCBuZXdNYXBwaW5nLnNvdXJjZSk7CistCSAgICAgICAgICB9CistCistCSAgICAg
ICAgICBuZXdNYXBwaW5nLm9yaWdpbmFsID0geworLQkgICAgICAgICAgICBsaW5lOiBtYXBwaW5n
Lm9yaWdpbmFsTGluZSwKKy0JICAgICAgICAgICAgY29sdW1uOiBtYXBwaW5nLm9yaWdpbmFsQ29s
dW1uCistCSAgICAgICAgICB9OworLQorLQkgICAgICAgICAgaWYgKG1hcHBpbmcubmFtZSAhPSBu
dWxsKSB7CistCSAgICAgICAgICAgIG5ld01hcHBpbmcubmFtZSA9IG1hcHBpbmcubmFtZTsKKy0J
ICAgICAgICAgIH0KKy0JICAgICAgICB9CistCistCSAgICAgICAgZ2VuZXJhdG9yLmFkZE1hcHBp
bmcobmV3TWFwcGluZyk7CistCSAgICAgIH0pOworLQkgICAgICBhU291cmNlTWFwQ29uc3VtZXIu
c291cmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VyY2VGaWxlKSB7CistCSAgICAgICAgdmFyIGNv
bnRlbnQgPSBhU291cmNlTWFwQ29uc3VtZXIuc291cmNlQ29udGVudEZvcihzb3VyY2VGaWxlKTsK
Ky0JICAgICAgICBpZiAoY29udGVudCAhPSBudWxsKSB7CistCSAgICAgICAgICBnZW5lcmF0b3Iu
c2V0U291cmNlQ29udGVudChzb3VyY2VGaWxlLCBjb250ZW50KTsKKy0JICAgICAgICB9CistCSAg
ICAgIH0pOworLQkgICAgICByZXR1cm4gZ2VuZXJhdG9yOworLQkgICAgfTsKKy0KKy0JICAvKioK
Ky0JICAgKiBBZGQgYSBzaW5nbGUgbWFwcGluZyBmcm9tIG9yaWdpbmFsIHNvdXJjZSBsaW5lIGFu
ZCBjb2x1bW4gdG8gdGhlIGdlbmVyYXRlZAorLQkgICAqIHNvdXJjZSdzIGxpbmUgYW5kIGNvbHVt
biBmb3IgdGhpcyBzb3VyY2UgbWFwIGJlaW5nIGNyZWF0ZWQuIFRoZSBtYXBwaW5nCistCSAgICog
b2JqZWN0IHNob3VsZCBoYXZlIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczoKKy0JICAgKgorLQkg
ICAqICAgLSBnZW5lcmF0ZWQ6IEFuIG9iamVjdCB3aXRoIHRoZSBnZW5lcmF0ZWQgbGluZSBhbmQg
Y29sdW1uIHBvc2l0aW9ucy4KKy0JICAgKiAgIC0gb3JpZ2luYWw6IEFuIG9iamVjdCB3aXRoIHRo
ZSBvcmlnaW5hbCBsaW5lIGFuZCBjb2x1bW4gcG9zaXRpb25zLgorLQkgICAqICAgLSBzb3VyY2U6
IFRoZSBvcmlnaW5hbCBzb3VyY2UgZmlsZSAocmVsYXRpdmUgdG8gdGhlIHNvdXJjZVJvb3QpLgor
LQkgICAqICAgLSBuYW1lOiBBbiBvcHRpb25hbCBvcmlnaW5hbCB0b2tlbiBuYW1lIGZvciB0aGlz
IG1hcHBpbmcuCistCSAgICovCistCSAgU291cmNlTWFwR2VuZXJhdG9yLnByb3RvdHlwZS5hZGRN
YXBwaW5nID0KKy0JICAgIGZ1bmN0aW9uIFNvdXJjZU1hcEdlbmVyYXRvcl9hZGRNYXBwaW5nKGFB
cmdzKSB7CistCSAgICAgIHZhciBnZW5lcmF0ZWQgPSB1dGlsLmdldEFyZyhhQXJncywgJ2dlbmVy
YXRlZCcpOworLQkgICAgICB2YXIgb3JpZ2luYWwgPSB1dGlsLmdldEFyZyhhQXJncywgJ29yaWdp
bmFsJywgbnVsbCk7CistCSAgICAgIHZhciBzb3VyY2UgPSB1dGlsLmdldEFyZyhhQXJncywgJ3Nv
dXJjZScsIG51bGwpOworLQkgICAgICB2YXIgbmFtZSA9IHV0aWwuZ2V0QXJnKGFBcmdzLCAnbmFt
ZScsIG51bGwpOworLQorLQkgICAgICBpZiAoIXRoaXMuX3NraXBWYWxpZGF0aW9uKSB7CistCSAg
ICAgICAgdGhpcy5fdmFsaWRhdGVNYXBwaW5nKGdlbmVyYXRlZCwgb3JpZ2luYWwsIHNvdXJjZSwg
bmFtZSk7CistCSAgICAgIH0KKy0KKy0JICAgICAgaWYgKHNvdXJjZSAhPSBudWxsICYmICF0aGlz
Ll9zb3VyY2VzLmhhcyhzb3VyY2UpKSB7CistCSAgICAgICAgdGhpcy5fc291cmNlcy5hZGQoc291
cmNlKTsKKy0JICAgICAgfQorLQorLQkgICAgICBpZiAobmFtZSAhPSBudWxsICYmICF0aGlzLl9u
YW1lcy5oYXMobmFtZSkpIHsKKy0JICAgICAgICB0aGlzLl9uYW1lcy5hZGQobmFtZSk7CistCSAg
ICAgIH0KKy0KKy0JICAgICAgdGhpcy5fbWFwcGluZ3MuYWRkKHsKKy0JICAgICAgICBnZW5lcmF0
ZWRMaW5lOiBnZW5lcmF0ZWQubGluZSwKKy0JICAgICAgICBnZW5lcmF0ZWRDb2x1bW46IGdlbmVy
YXRlZC5jb2x1bW4sCistCSAgICAgICAgb3JpZ2luYWxMaW5lOiBvcmlnaW5hbCAhPSBudWxsICYm
IG9yaWdpbmFsLmxpbmUsCistCSAgICAgICAgb3JpZ2luYWxDb2x1bW46IG9yaWdpbmFsICE9IG51
bGwgJiYgb3JpZ2luYWwuY29sdW1uLAorLQkgICAgICAgIHNvdXJjZTogc291cmNlLAorLQkgICAg
ICAgIG5hbWU6IG5hbWUKKy0JICAgICAgfSk7CistCSAgICB9OworLQorLQkgIC8qKgorLQkgICAq
IFNldCB0aGUgc291cmNlIGNvbnRlbnQgZm9yIGEgc291cmNlIGZpbGUuCistCSAgICovCistCSAg
U291cmNlTWFwR2VuZXJhdG9yLnByb3RvdHlwZS5zZXRTb3VyY2VDb250ZW50ID0KKy0JICAgIGZ1
bmN0aW9uIFNvdXJjZU1hcEdlbmVyYXRvcl9zZXRTb3VyY2VDb250ZW50KGFTb3VyY2VGaWxlLCBh
U291cmNlQ29udGVudCkgeworLQkgICAgICB2YXIgc291cmNlID0gYVNvdXJjZUZpbGU7CistCSAg
ICAgIGlmICh0aGlzLl9zb3VyY2VSb290ICE9IG51bGwpIHsKKy0JICAgICAgICBzb3VyY2UgPSB1
dGlsLnJlbGF0aXZlKHRoaXMuX3NvdXJjZVJvb3QsIHNvdXJjZSk7CistCSAgICAgIH0KKy0KKy0J
ICAgICAgaWYgKGFTb3VyY2VDb250ZW50ICE9IG51bGwpIHsKKy0JICAgICAgICAvLyBBZGQgdGhl
IHNvdXJjZSBjb250ZW50IHRvIHRoZSBfc291cmNlc0NvbnRlbnRzIG1hcC4KKy0JICAgICAgICAv
LyBDcmVhdGUgYSBuZXcgX3NvdXJjZXNDb250ZW50cyBtYXAgaWYgdGhlIHByb3BlcnR5IGlzIG51
bGwuCistCSAgICAgICAgaWYgKCF0aGlzLl9zb3VyY2VzQ29udGVudHMpIHsKKy0JICAgICAgICAg
IHRoaXMuX3NvdXJjZXNDb250ZW50cyA9IHt9OworLQkgICAgICAgIH0KKy0JICAgICAgICB0aGlz
Ll9zb3VyY2VzQ29udGVudHNbdXRpbC50b1NldFN0cmluZyhzb3VyY2UpXSA9IGFTb3VyY2VDb250
ZW50OworLQkgICAgICB9IGVsc2UgaWYgKHRoaXMuX3NvdXJjZXNDb250ZW50cykgeworLQkgICAg
ICAgIC8vIFJlbW92ZSB0aGUgc291cmNlIGZpbGUgZnJvbSB0aGUgX3NvdXJjZXNDb250ZW50cyBt
YXAuCistCSAgICAgICAgLy8gSWYgdGhlIF9zb3VyY2VzQ29udGVudHMgbWFwIGlzIGVtcHR5LCBz
ZXQgdGhlIHByb3BlcnR5IHRvIG51bGwuCistCSAgICAgICAgZGVsZXRlIHRoaXMuX3NvdXJjZXND
b250ZW50c1t1dGlsLnRvU2V0U3RyaW5nKHNvdXJjZSldOworLQkgICAgICAgIGlmIChPYmplY3Qu
a2V5cyh0aGlzLl9zb3VyY2VzQ29udGVudHMpLmxlbmd0aCA9PT0gMCkgeworLQkgICAgICAgICAg
dGhpcy5fc291cmNlc0NvbnRlbnRzID0gbnVsbDsKKy0JICAgICAgICB9CistCSAgICAgIH0KKy0J
ICAgIH07CistCistCSAgLyoqCistCSAgICogQXBwbGllcyB0aGUgbWFwcGluZ3Mgb2YgYSBzdWIt
c291cmNlLW1hcCBmb3IgYSBzcGVjaWZpYyBzb3VyY2UgZmlsZSB0byB0aGUKKy0JICAgKiBzb3Vy
Y2UgbWFwIGJlaW5nIGdlbmVyYXRlZC4gRWFjaCBtYXBwaW5nIHRvIHRoZSBzdXBwbGllZCBzb3Vy
Y2UgZmlsZSBpcworLQkgICAqIHJld3JpdHRlbiB1c2luZyB0aGUgc3VwcGxpZWQgc291cmNlIG1h
cC4gTm90ZTogVGhlIHJlc29sdXRpb24gZm9yIHRoZQorLQkgICAqIHJlc3VsdGluZyBtYXBwaW5n
cyBpcyB0aGUgbWluaW1pdW0gb2YgdGhpcyBtYXAgYW5kIHRoZSBzdXBwbGllZCBtYXAuCistCSAg
ICoKKy0JICAgKiBAcGFyYW0gYVNvdXJjZU1hcENvbnN1bWVyIFRoZSBzb3VyY2UgbWFwIHRvIGJl
IGFwcGxpZWQuCistCSAgICogQHBhcmFtIGFTb3VyY2VGaWxlIE9wdGlvbmFsLiBUaGUgZmlsZW5h
bWUgb2YgdGhlIHNvdXJjZSBmaWxlLgorLQkgICAqICAgICAgICBJZiBvbWl0dGVkLCBTb3VyY2VN
YXBDb25zdW1lcidzIGZpbGUgcHJvcGVydHkgd2lsbCBiZSB1c2VkLgorLQkgICAqIEBwYXJhbSBh
U291cmNlTWFwUGF0aCBPcHRpb25hbC4gVGhlIGRpcm5hbWUgb2YgdGhlIHBhdGggdG8gdGhlIHNv
dXJjZSBtYXAKKy0JICAgKiAgICAgICAgdG8gYmUgYXBwbGllZC4gSWYgcmVsYXRpdmUsIGl0IGlz
IHJlbGF0aXZlIHRvIHRoZSBTb3VyY2VNYXBDb25zdW1lci4KKy0JICAgKiAgICAgICAgVGhpcyBw
YXJhbWV0ZXIgaXMgbmVlZGVkIHdoZW4gdGhlIHR3byBzb3VyY2UgbWFwcyBhcmVuJ3QgaW4gdGhl
IHNhbWUKKy0JICAgKiAgICAgICAgZGlyZWN0b3J5LCBhbmQgdGhlIHNvdXJjZSBtYXAgdG8gYmUg
YXBwbGllZCBjb250YWlucyByZWxhdGl2ZSBzb3VyY2UKKy0JICAgKiAgICAgICAgcGF0aHMuIElm
IHNvLCB0aG9zZSByZWxhdGl2ZSBzb3VyY2UgcGF0aHMgbmVlZCB0byBiZSByZXdyaXR0ZW4KKy0J
ICAgKiAgICAgICAgcmVsYXRpdmUgdG8gdGhlIFNvdXJjZU1hcEdlbmVyYXRvci4KKy0JICAgKi8K
Ky0JICBTb3VyY2VNYXBHZW5lcmF0b3IucHJvdG90eXBlLmFwcGx5U291cmNlTWFwID0KKy0JICAg
IGZ1bmN0aW9uIFNvdXJjZU1hcEdlbmVyYXRvcl9hcHBseVNvdXJjZU1hcChhU291cmNlTWFwQ29u
c3VtZXIsIGFTb3VyY2VGaWxlLCBhU291cmNlTWFwUGF0aCkgeworLQkgICAgICB2YXIgc291cmNl
RmlsZSA9IGFTb3VyY2VGaWxlOworLQkgICAgICAvLyBJZiBhU291cmNlRmlsZSBpcyBvbWl0dGVk
LCB3ZSB3aWxsIHVzZSB0aGUgZmlsZSBwcm9wZXJ0eSBvZiB0aGUgU291cmNlTWFwCistCSAgICAg
IGlmIChhU291cmNlRmlsZSA9PSBudWxsKSB7CistCSAgICAgICAgaWYgKGFTb3VyY2VNYXBDb25z
dW1lci5maWxlID09IG51bGwpIHsKKy0JICAgICAgICAgIHRocm93IG5ldyBFcnJvcigKKy0JICAg
ICAgICAgICAgJ1NvdXJjZU1hcEdlbmVyYXRvci5wcm90b3R5cGUuYXBwbHlTb3VyY2VNYXAgcmVx
dWlyZXMgZWl0aGVyIGFuIGV4cGxpY2l0IHNvdXJjZSBmaWxlLCAnICsKKy0JICAgICAgICAgICAg
J29yIHRoZSBzb3VyY2UgbWFwXCdzICJmaWxlIiBwcm9wZXJ0eS4gQm90aCB3ZXJlIG9taXR0ZWQu
JworLQkgICAgICAgICAgKTsKKy0JICAgICAgICB9CistCSAgICAgICAgc291cmNlRmlsZSA9IGFT
b3VyY2VNYXBDb25zdW1lci5maWxlOworLQkgICAgICB9CistCSAgICAgIHZhciBzb3VyY2VSb290
ID0gdGhpcy5fc291cmNlUm9vdDsKKy0JICAgICAgLy8gTWFrZSAic291cmNlRmlsZSIgcmVsYXRp
dmUgaWYgYW4gYWJzb2x1dGUgVXJsIGlzIHBhc3NlZC4KKy0JICAgICAgaWYgKHNvdXJjZVJvb3Qg
IT0gbnVsbCkgeworLQkgICAgICAgIHNvdXJjZUZpbGUgPSB1dGlsLnJlbGF0aXZlKHNvdXJjZVJv
b3QsIHNvdXJjZUZpbGUpOworLQkgICAgICB9CistCSAgICAgIC8vIEFwcGx5aW5nIHRoZSBTb3Vy
Y2VNYXAgY2FuIGFkZCBhbmQgcmVtb3ZlIGl0ZW1zIGZyb20gdGhlIHNvdXJjZXMgYW5kCistCSAg
ICAgIC8vIHRoZSBuYW1lcyBhcnJheS4KKy0JICAgICAgdmFyIG5ld1NvdXJjZXMgPSBuZXcgQXJy
YXlTZXQoKTsKKy0JICAgICAgdmFyIG5ld05hbWVzID0gbmV3IEFycmF5U2V0KCk7CistCistCSAg
ICAgIC8vIEZpbmQgbWFwcGluZ3MgZm9yIHRoZSAic291cmNlRmlsZSIKKy0JICAgICAgdGhpcy5f
bWFwcGluZ3MudW5zb3J0ZWRGb3JFYWNoKGZ1bmN0aW9uIChtYXBwaW5nKSB7CistCSAgICAgICAg
aWYgKG1hcHBpbmcuc291cmNlID09PSBzb3VyY2VGaWxlICYmIG1hcHBpbmcub3JpZ2luYWxMaW5l
ICE9IG51bGwpIHsKKy0JICAgICAgICAgIC8vIENoZWNrIGlmIGl0IGNhbiBiZSBtYXBwZWQgYnkg
dGhlIHNvdXJjZSBtYXAsIHRoZW4gdXBkYXRlIHRoZSBtYXBwaW5nLgorLQkgICAgICAgICAgdmFy
IG9yaWdpbmFsID0gYVNvdXJjZU1hcENvbnN1bWVyLm9yaWdpbmFsUG9zaXRpb25Gb3IoeworLQkg
ICAgICAgICAgICBsaW5lOiBtYXBwaW5nLm9yaWdpbmFsTGluZSwKKy0JICAgICAgICAgICAgY29s
dW1uOiBtYXBwaW5nLm9yaWdpbmFsQ29sdW1uCistCSAgICAgICAgICB9KTsKKy0JICAgICAgICAg
IGlmIChvcmlnaW5hbC5zb3VyY2UgIT0gbnVsbCkgeworLQkgICAgICAgICAgICAvLyBDb3B5IG1h
cHBpbmcKKy0JICAgICAgICAgICAgbWFwcGluZy5zb3VyY2UgPSBvcmlnaW5hbC5zb3VyY2U7Cist
CSAgICAgICAgICAgIGlmIChhU291cmNlTWFwUGF0aCAhPSBudWxsKSB7CistCSAgICAgICAgICAg
ICAgbWFwcGluZy5zb3VyY2UgPSB1dGlsLmpvaW4oYVNvdXJjZU1hcFBhdGgsIG1hcHBpbmcuc291
cmNlKQorLQkgICAgICAgICAgICB9CistCSAgICAgICAgICAgIGlmIChzb3VyY2VSb290ICE9IG51
bGwpIHsKKy0JICAgICAgICAgICAgICBtYXBwaW5nLnNvdXJjZSA9IHV0aWwucmVsYXRpdmUoc291
cmNlUm9vdCwgbWFwcGluZy5zb3VyY2UpOworLQkgICAgICAgICAgICB9CistCSAgICAgICAgICAg
IG1hcHBpbmcub3JpZ2luYWxMaW5lID0gb3JpZ2luYWwubGluZTsKKy0JICAgICAgICAgICAgbWFw
cGluZy5vcmlnaW5hbENvbHVtbiA9IG9yaWdpbmFsLmNvbHVtbjsKKy0JICAgICAgICAgICAgaWYg
KG9yaWdpbmFsLm5hbWUgIT0gbnVsbCkgeworLQkgICAgICAgICAgICAgIG1hcHBpbmcubmFtZSA9
IG9yaWdpbmFsLm5hbWU7CistCSAgICAgICAgICAgIH0KKy0JICAgICAgICAgIH0KKy0JICAgICAg
ICB9CistCistCSAgICAgICAgdmFyIHNvdXJjZSA9IG1hcHBpbmcuc291cmNlOworLQkgICAgICAg
IGlmIChzb3VyY2UgIT0gbnVsbCAmJiAhbmV3U291cmNlcy5oYXMoc291cmNlKSkgeworLQkgICAg
ICAgICAgbmV3U291cmNlcy5hZGQoc291cmNlKTsKKy0JICAgICAgICB9CistCistCSAgICAgICAg
dmFyIG5hbWUgPSBtYXBwaW5nLm5hbWU7CistCSAgICAgICAgaWYgKG5hbWUgIT0gbnVsbCAmJiAh
bmV3TmFtZXMuaGFzKG5hbWUpKSB7CistCSAgICAgICAgICBuZXdOYW1lcy5hZGQobmFtZSk7Cist
CSAgICAgICAgfQorLQorLQkgICAgICB9LCB0aGlzKTsKKy0JICAgICAgdGhpcy5fc291cmNlcyA9
IG5ld1NvdXJjZXM7CistCSAgICAgIHRoaXMuX25hbWVzID0gbmV3TmFtZXM7CistCistCSAgICAg
IC8vIENvcHkgc291cmNlc0NvbnRlbnRzIG9mIGFwcGxpZWQgbWFwLgorLQkgICAgICBhU291cmNl
TWFwQ29uc3VtZXIuc291cmNlcy5mb3JFYWNoKGZ1bmN0aW9uIChzb3VyY2VGaWxlKSB7CistCSAg
ICAgICAgdmFyIGNvbnRlbnQgPSBhU291cmNlTWFwQ29uc3VtZXIuc291cmNlQ29udGVudEZvcihz
b3VyY2VGaWxlKTsKKy0JICAgICAgICBpZiAoY29udGVudCAhPSBudWxsKSB7CistCSAgICAgICAg
ICBpZiAoYVNvdXJjZU1hcFBhdGggIT0gbnVsbCkgeworLQkgICAgICAgICAgICBzb3VyY2VGaWxl
ID0gdXRpbC5qb2luKGFTb3VyY2VNYXBQYXRoLCBzb3VyY2VGaWxlKTsKKy0JICAgICAgICAgIH0K
Ky0JICAgICAgICAgIGlmIChzb3VyY2VSb290ICE9IG51bGwpIHsKKy0JICAgICAgICAgICAgc291
cmNlRmlsZSA9IHV0aWwucmVsYXRpdmUoc291cmNlUm9vdCwgc291cmNlRmlsZSk7CistCSAgICAg
ICAgICB9CistCSAgICAgICAgICB0aGlzLnNldFNvdXJjZUNvbnRlbnQoc291cmNlRmlsZSwgY29u
dGVudCk7CistCSAgICAgICAgfQorLQkgICAgICB9LCB0aGlzKTsKKy0JICAgIH07CistCistCSAg
LyoqCistCSAgICogQSBtYXBwaW5nIGNhbiBoYXZlIG9uZSBvZiB0aGUgdGhyZWUgbGV2ZWxzIG9m
IGRhdGE6CistCSAgICoKKy0JICAgKiAgIDEuIEp1c3QgdGhlIGdlbmVyYXRlZCBwb3NpdGlvbi4K
Ky0JICAgKiAgIDIuIFRoZSBHZW5lcmF0ZWQgcG9zaXRpb24sIG9yaWdpbmFsIHBvc2l0aW9uLCBh
bmQgb3JpZ2luYWwgc291cmNlLgorLQkgICAqICAgMy4gR2VuZXJhdGVkIGFuZCBvcmlnaW5hbCBw
b3NpdGlvbiwgb3JpZ2luYWwgc291cmNlLCBhcyB3ZWxsIGFzIGEgbmFtZQorLQkgICAqICAgICAg
dG9rZW4uCistCSAgICoKKy0JICAgKiBUbyBtYWludGFpbiBjb25zaXN0ZW5jeSwgd2UgdmFsaWRh
dGUgdGhhdCBhbnkgbmV3IG1hcHBpbmcgYmVpbmcgYWRkZWQgZmFsbHMKKy0JICAgKiBpbiB0byBv
bmUgb2YgdGhlc2UgY2F0ZWdvcmllcy4KKy0JICAgKi8KKy0JICBTb3VyY2VNYXBHZW5lcmF0b3Iu
cHJvdG90eXBlLl92YWxpZGF0ZU1hcHBpbmcgPQorLQkgICAgZnVuY3Rpb24gU291cmNlTWFwR2Vu
ZXJhdG9yX3ZhbGlkYXRlTWFwcGluZyhhR2VuZXJhdGVkLCBhT3JpZ2luYWwsIGFTb3VyY2UsCist
CSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFOYW1lKSB7
CistCSAgICAgIGlmIChhR2VuZXJhdGVkICYmICdsaW5lJyBpbiBhR2VuZXJhdGVkICYmICdjb2x1
bW4nIGluIGFHZW5lcmF0ZWQKKy0JICAgICAgICAgICYmIGFHZW5lcmF0ZWQubGluZSA+IDAgJiYg
YUdlbmVyYXRlZC5jb2x1bW4gPj0gMAorLQkgICAgICAgICAgJiYgIWFPcmlnaW5hbCAmJiAhYVNv
dXJjZSAmJiAhYU5hbWUpIHsKKy0JICAgICAgICAvLyBDYXNlIDEuCistCSAgICAgICAgcmV0dXJu
OworLQkgICAgICB9CistCSAgICAgIGVsc2UgaWYgKGFHZW5lcmF0ZWQgJiYgJ2xpbmUnIGluIGFH
ZW5lcmF0ZWQgJiYgJ2NvbHVtbicgaW4gYUdlbmVyYXRlZAorLQkgICAgICAgICAgICAgICAmJiBh
T3JpZ2luYWwgJiYgJ2xpbmUnIGluIGFPcmlnaW5hbCAmJiAnY29sdW1uJyBpbiBhT3JpZ2luYWwK
Ky0JICAgICAgICAgICAgICAgJiYgYUdlbmVyYXRlZC5saW5lID4gMCAmJiBhR2VuZXJhdGVkLmNv
bHVtbiA+PSAwCistCSAgICAgICAgICAgICAgICYmIGFPcmlnaW5hbC5saW5lID4gMCAmJiBhT3Jp
Z2luYWwuY29sdW1uID49IDAKKy0JICAgICAgICAgICAgICAgJiYgYVNvdXJjZSkgeworLQkgICAg
ICAgIC8vIENhc2VzIDIgYW5kIDMuCistCSAgICAgICAgcmV0dXJuOworLQkgICAgICB9CistCSAg
ICAgIGVsc2UgeworLQkgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBtYXBwaW5nOiAn
ICsgSlNPTi5zdHJpbmdpZnkoeworLQkgICAgICAgICAgZ2VuZXJhdGVkOiBhR2VuZXJhdGVkLAor
LQkgICAgICAgICAgc291cmNlOiBhU291cmNlLAorLQkgICAgICAgICAgb3JpZ2luYWw6IGFPcmln
aW5hbCwKKy0JICAgICAgICAgIG5hbWU6IGFOYW1lCistCSAgICAgICAgfSkpOworLQkgICAgICB9
CistCSAgICB9OworLQorLQkgIC8qKgorLQkgICAqIFNlcmlhbGl6ZSB0aGUgYWNjdW11bGF0ZWQg
bWFwcGluZ3MgaW4gdG8gdGhlIHN0cmVhbSBvZiBiYXNlIDY0IFZMUXMKKy0JICAgKiBzcGVjaWZp
ZWQgYnkgdGhlIHNvdXJjZSBtYXAgZm9ybWF0LgorLQkgICAqLworLQkgIFNvdXJjZU1hcEdlbmVy
YXRvci5wcm90b3R5cGUuX3NlcmlhbGl6ZU1hcHBpbmdzID0KKy0JICAgIGZ1bmN0aW9uIFNvdXJj
ZU1hcEdlbmVyYXRvcl9zZXJpYWxpemVNYXBwaW5ncygpIHsKKy0JICAgICAgdmFyIHByZXZpb3Vz
R2VuZXJhdGVkQ29sdW1uID0gMDsKKy0JICAgICAgdmFyIHByZXZpb3VzR2VuZXJhdGVkTGluZSA9
IDE7CistCSAgICAgIHZhciBwcmV2aW91c09yaWdpbmFsQ29sdW1uID0gMDsKKy0JICAgICAgdmFy
IHByZXZpb3VzT3JpZ2luYWxMaW5lID0gMDsKKy0JICAgICAgdmFyIHByZXZpb3VzTmFtZSA9IDA7
CistCSAgICAgIHZhciBwcmV2aW91c1NvdXJjZSA9IDA7CistCSAgICAgIHZhciByZXN1bHQgPSAn
JzsKKy0JICAgICAgdmFyIG1hcHBpbmc7CistCSAgICAgIHZhciBuYW1lSWR4OworLQkgICAgICB2
YXIgc291cmNlSWR4OworLQorLQkgICAgICB2YXIgbWFwcGluZ3MgPSB0aGlzLl9tYXBwaW5ncy50
b0FycmF5KCk7CistCSAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBtYXBwaW5ncy5sZW5ndGg7
IGkgPCBsZW47IGkrKykgeworLQkgICAgICAgIG1hcHBpbmcgPSBtYXBwaW5nc1tpXTsKKy0KKy0J
ICAgICAgICBpZiAobWFwcGluZy5nZW5lcmF0ZWRMaW5lICE9PSBwcmV2aW91c0dlbmVyYXRlZExp
bmUpIHsKKy0JICAgICAgICAgIHByZXZpb3VzR2VuZXJhdGVkQ29sdW1uID0gMDsKKy0JICAgICAg
ICAgIHdoaWxlIChtYXBwaW5nLmdlbmVyYXRlZExpbmUgIT09IHByZXZpb3VzR2VuZXJhdGVkTGlu
ZSkgeworLQkgICAgICAgICAgICByZXN1bHQgKz0gJzsnOworLQkgICAgICAgICAgICBwcmV2aW91
c0dlbmVyYXRlZExpbmUrKzsKKy0JICAgICAgICAgIH0KKy0JICAgICAgICB9CistCSAgICAgICAg
ZWxzZSB7CistCSAgICAgICAgICBpZiAoaSA+IDApIHsKKy0JICAgICAgICAgICAgaWYgKCF1dGls
LmNvbXBhcmVCeUdlbmVyYXRlZFBvc2l0aW9uc0luZmxhdGVkKG1hcHBpbmcsIG1hcHBpbmdzW2kg
LSAxXSkpIHsKKy0JICAgICAgICAgICAgICBjb250aW51ZTsKKy0JICAgICAgICAgICAgfQorLQkg
ICAgICAgICAgICByZXN1bHQgKz0gJywnOworLQkgICAgICAgICAgfQorLQkgICAgICAgIH0KKy0K
Ky0JICAgICAgICByZXN1bHQgKz0gYmFzZTY0VkxRLmVuY29kZShtYXBwaW5nLmdlbmVyYXRlZENv
bHVtbgorLQkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gcHJldmlvdXNHZW5l
cmF0ZWRDb2x1bW4pOworLQkgICAgICAgIHByZXZpb3VzR2VuZXJhdGVkQ29sdW1uID0gbWFwcGlu
Zy5nZW5lcmF0ZWRDb2x1bW47CistCistCSAgICAgICAgaWYgKG1hcHBpbmcuc291cmNlICE9IG51
bGwpIHsKKy0JICAgICAgICAgIHNvdXJjZUlkeCA9IHRoaXMuX3NvdXJjZXMuaW5kZXhPZihtYXBw
aW5nLnNvdXJjZSk7CistCSAgICAgICAgICByZXN1bHQgKz0gYmFzZTY0VkxRLmVuY29kZShzb3Vy
Y2VJZHggLSBwcmV2aW91c1NvdXJjZSk7CistCSAgICAgICAgICBwcmV2aW91c1NvdXJjZSA9IHNv
dXJjZUlkeDsKKy0KKy0JICAgICAgICAgIC8vIGxpbmVzIGFyZSBzdG9yZWQgMC1iYXNlZCBpbiBT
b3VyY2VNYXAgc3BlYyB2ZXJzaW9uIDMKKy0JICAgICAgICAgIHJlc3VsdCArPSBiYXNlNjRWTFEu
ZW5jb2RlKG1hcHBpbmcub3JpZ2luYWxMaW5lIC0gMQorLQkgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgLSBwcmV2aW91c09yaWdpbmFsTGluZSk7CistCSAgICAgICAgICBwcmV2
aW91c09yaWdpbmFsTGluZSA9IG1hcHBpbmcub3JpZ2luYWxMaW5lIC0gMTsKKy0KKy0JICAgICAg
ICAgIHJlc3VsdCArPSBiYXNlNjRWTFEuZW5jb2RlKG1hcHBpbmcub3JpZ2luYWxDb2x1bW4KKy0J
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0gcHJldmlvdXNPcmlnaW5hbENv
bHVtbik7CistCSAgICAgICAgICBwcmV2aW91c09yaWdpbmFsQ29sdW1uID0gbWFwcGluZy5vcmln
aW5hbENvbHVtbjsKKy0KKy0JICAgICAgICAgIGlmIChtYXBwaW5nLm5hbWUgIT0gbnVsbCkgewor
LQkgICAgICAgICAgICBuYW1lSWR4ID0gdGhpcy5fbmFtZXMuaW5kZXhPZihtYXBwaW5nLm5hbWUp
OworLQkgICAgICAgICAgICByZXN1bHQgKz0gYmFzZTY0VkxRLmVuY29kZShuYW1lSWR4IC0gcHJl
dmlvdXNOYW1lKTsKKy0JICAgICAgICAgICAgcHJldmlvdXNOYW1lID0gbmFtZUlkeDsKKy0JICAg
ICAgICAgIH0KKy0JICAgICAgICB9CistCSAgICAgIH0KKy0KKy0JICAgICAgcmV0dXJuIHJlc3Vs
dDsKKy0JICAgIH07CistCistCSAgU291cmNlTWFwR2VuZXJhdG9yLnByb3RvdHlwZS5fZ2VuZXJh
dGVTb3VyY2VzQ29udGVudCA9CistCSAgICBmdW5jdGlvbiBTb3VyY2VNYXBHZW5lcmF0b3JfZ2Vu
ZXJhdGVTb3VyY2VzQ29udGVudChhU291cmNlcywgYVNvdXJjZVJvb3QpIHsKKy0JICAgICAgcmV0
dXJuIGFTb3VyY2VzLm1hcChmdW5jdGlvbiAoc291cmNlKSB7CistCSAgICAgICAgaWYgKCF0aGlz
Ll9zb3VyY2VzQ29udGVudHMpIHsKKy0JICAgICAgICAgIHJldHVybiBudWxsOworLQkgICAgICAg
IH0KKy0JICAgICAgICBpZiAoYVNvdXJjZVJvb3QgIT0gbnVsbCkgeworLQkgICAgICAgICAgc291
cmNlID0gdXRpbC5yZWxhdGl2ZShhU291cmNlUm9vdCwgc291cmNlKTsKKy0JICAgICAgICB9Cist
CSAgICAgICAgdmFyIGtleSA9IHV0aWwudG9TZXRTdHJpbmcoc291cmNlKTsKKy0JICAgICAgICBy
ZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMuX3NvdXJjZXND
b250ZW50cywKKy0JICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGtleSkKKy0JICAgICAgICAgID8gdGhpcy5fc291cmNlc0NvbnRlbnRzW2tleV0KKy0J
ICAgICAgICAgIDogbnVsbDsKKy0JICAgICAgfSwgdGhpcyk7CistCSAgICB9OworLQorLQkgIC8q
KgorLQkgICAqIEV4dGVybmFsaXplIHRoZSBzb3VyY2UgbWFwLgorLQkgICAqLworLQkgIFNvdXJj
ZU1hcEdlbmVyYXRvci5wcm90b3R5cGUudG9KU09OID0KKy0JICAgIGZ1bmN0aW9uIFNvdXJjZU1h
cEdlbmVyYXRvcl90b0pTT04oKSB7CistCSAgICAgIHZhciBtYXAgPSB7CistCSAgICAgICAgdmVy
c2lvbjogdGhpcy5fdmVyc2lvbiwKKy0JICAgICAgICBzb3VyY2VzOiB0aGlzLl9zb3VyY2VzLnRv
QXJyYXkoKSwKKy0JICAgICAgICBuYW1lczogdGhpcy5fbmFtZXMudG9BcnJheSgpLAorLQkgICAg
ICAgIG1hcHBpbmdzOiB0aGlzLl9zZXJpYWxpemVNYXBwaW5ncygpCistCSAgICAgIH07CistCSAg
ICAgIGlmICh0aGlzLl9maWxlICE9IG51bGwpIHsKKy0JICAgICAgICBtYXAuZmlsZSA9IHRoaXMu
X2ZpbGU7CistCSAgICAgIH0KKy0JICAgICAgaWYgKHRoaXMuX3NvdXJjZVJvb3QgIT0gbnVsbCkg
eworLQkgICAgICAgIG1hcC5zb3VyY2VSb290ID0gdGhpcy5fc291cmNlUm9vdDsKKy0JICAgICAg
fQorLQkgICAgICBpZiAodGhpcy5fc291cmNlc0NvbnRlbnRzKSB7CistCSAgICAgICAgbWFwLnNv
dXJjZXNDb250ZW50ID0gdGhpcy5fZ2VuZXJhdGVTb3VyY2VzQ29udGVudChtYXAuc291cmNlcywg
bWFwLnNvdXJjZVJvb3QpOworLQkgICAgICB9CistCistCSAgICAgIHJldHVybiBtYXA7CistCSAg
ICB9OworLQorLQkgIC8qKgorLQkgICAqIFJlbmRlciB0aGUgc291cmNlIG1hcCBiZWluZyBnZW5l
cmF0ZWQgdG8gYSBzdHJpbmcuCistCSAgICovCistCSAgU291cmNlTWFwR2VuZXJhdG9yLnByb3Rv
dHlwZS50b1N0cmluZyA9CistCSAgICBmdW5jdGlvbiBTb3VyY2VNYXBHZW5lcmF0b3JfdG9TdHJp
bmcoKSB7CistCSAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzLnRvSlNPTigpKTsKKy0J
ICAgIH07CistCistCSAgZXhwb3J0cy5Tb3VyY2VNYXBHZW5lcmF0b3IgPSBTb3VyY2VNYXBHZW5l
cmF0b3I7CistCX0KKy0KKy0KKy0vKioqLyB9LAorLS8qIDIgKi8KKy0vKioqLyBmdW5jdGlvbiht
b2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsKKy0KKy0JLyogLSotIE1vZGU6
IGpzOyBqcy1pbmRlbnQtbGV2ZWw6IDI7IC0qLSAqLworLQkvKgorLQkgKiBDb3B5cmlnaHQgMjAx
MSBNb3ppbGxhIEZvdW5kYXRpb24gYW5kIGNvbnRyaWJ1dG9ycworLQkgKiBMaWNlbnNlZCB1bmRl
ciB0aGUgTmV3IEJTRCBsaWNlbnNlLiBTZWUgTElDRU5TRSBvcjoKKy0JICogaHR0cDovL29wZW5z
b3VyY2Uub3JnL2xpY2Vuc2VzL0JTRC0zLUNsYXVzZQorLQkgKgorLQkgKiBCYXNlZCBvbiB0aGUg
QmFzZSA2NCBWTFEgaW1wbGVtZW50YXRpb24gaW4gQ2xvc3VyZSBDb21waWxlcjoKKy0JICogaHR0
cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jbG9zdXJlLWNvbXBpbGVyL3NvdXJjZS9icm93c2UvdHJ1
bmsvc3JjL2NvbS9nb29nbGUvZGVidWdnaW5nL3NvdXJjZW1hcC9CYXNlNjRWTFEuamF2YQorLQkg
KgorLQkgKiBDb3B5cmlnaHQgMjAxMSBUaGUgQ2xvc3VyZSBDb21waWxlciBBdXRob3JzLiBBbGwg
cmlnaHRzIHJlc2VydmVkLgorLQkgKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBh
bmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQKKy0JICogbW9kaWZpY2F0aW9uLCBhcmUg
cGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zIGFyZQorLQkg
KiBtZXQ6CistCSAqCistCSAqICAqIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0
IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0CistCSAqICAgIG5vdGljZSwgdGhpcyBsaXN0IG9m
IGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4KKy0JICogICogUmVkaXN0
cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZQorLQkgKiAg
ICBjb3B5cmlnaHQgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxv
d2luZworLQkgKiAgICBkaXNjbGFpbWVyIGluIHRoZSBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhl
ciBtYXRlcmlhbHMgcHJvdmlkZWQKKy0JICogICAgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLgorLQkg
KiAgKiBOZWl0aGVyIHRoZSBuYW1lIG9mIEdvb2dsZSBJbmMuIG5vciB0aGUgbmFtZXMgb2YgaXRz
CistCSAqICAgIGNvbnRyaWJ1dG9ycyBtYXkgYmUgdXNlZCB0byBlbmRvcnNlIG9yIHByb21vdGUg
cHJvZHVjdHMgZGVyaXZlZAorLQkgKiAgICBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dCBzcGVj
aWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uCistCSAqCistCSAqIFRISVMgU09GVFdBUkUg
SVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMKKy0J
ICogIkFTIElTIiBBTkQgQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJ
TkcsIEJVVCBOT1QKKy0JICogTElNSVRFRCBUTywgVEhFIElNUExJRUQgV0FSUkFOVElFUyBPRiBN
RVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SCistCSAqIEEgUEFSVElDVUxBUiBQVVJQT1NF
IEFSRSBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQ09QWVJJR0hUCistCSAqIE9X
TkVSIE9SIENPTlRSSUJVVE9SUyBCRSBMSUFCTEUgRk9SIEFOWSBESVJFQ1QsIElORElSRUNULCBJ
TkNJREVOVEFMLAorLQkgKiBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFN
QUdFUyAoSU5DTFVESU5HLCBCVVQgTk9UCistCSAqIExJTUlURUQgVE8sIFBST0NVUkVNRU5UIE9G
IFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7IExPU1MgT0YgVVNFLAorLQkgKiBEQVRBLCBP
UiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORCBP
TiBBTlkKKy0JICogVEhFT1JZIE9GIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RS
SUNUIExJQUJJTElUWSwgT1IgVE9SVAorLQkgKiAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RI
RVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UKKy0JICogT0YgVEhJUyBT
T0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFH
RS4KKy0JICovCistCXsKKy0JICB2YXIgYmFzZTY0ID0gX193ZWJwYWNrX3JlcXVpcmVfXygzKTsK
Ky0KKy0JICAvLyBBIHNpbmdsZSBiYXNlIDY0IGRpZ2l0IGNhbiBjb250YWluIDYgYml0cyBvZiBk
YXRhLiBGb3IgdGhlIGJhc2UgNjQgdmFyaWFibGUKKy0JICAvLyBsZW5ndGggcXVhbnRpdGllcyB3
ZSB1c2UgaW4gdGhlIHNvdXJjZSBtYXAgc3BlYywgdGhlIGZpcnN0IGJpdCBpcyB0aGUgc2lnbiwK
Ky0JICAvLyB0aGUgbmV4dCBmb3VyIGJpdHMgYXJlIHRoZSBhY3R1YWwgdmFsdWUsIGFuZCB0aGUg
NnRoIGJpdCBpcyB0aGUKKy0JICAvLyBjb250aW51YXRpb24gYml0LiBUaGUgY29udGludWF0aW9u
IGJpdCB0ZWxscyB1cyB3aGV0aGVyIHRoZXJlIGFyZSBtb3JlCistCSAgLy8gZGlnaXRzIGluIHRo
aXMgdmFsdWUgZm9sbG93aW5nIHRoaXMgZGlnaXQuCistCSAgLy8KKy0JICAvLyAgIENvbnRpbnVh
dGlvbgorLQkgIC8vICAgfCAgICBTaWduCistCSAgLy8gICB8ICAgIHwKKy0JICAvLyAgIFYgICAg
VgorLQkgIC8vICAgMTAxMDExCistCistCSAgdmFyIFZMUV9CQVNFX1NISUZUID0gNTsKKy0KKy0J
ICAvLyBiaW5hcnk6IDEwMDAwMAorLQkgIHZhciBWTFFfQkFTRSA9IDEgPDwgVkxRX0JBU0VfU0hJ
RlQ7CistCistCSAgLy8gYmluYXJ5OiAwMTExMTEKKy0JICB2YXIgVkxRX0JBU0VfTUFTSyA9IFZM
UV9CQVNFIC0gMTsKKy0KKy0JICAvLyBiaW5hcnk6IDEwMDAwMAorLQkgIHZhciBWTFFfQ09OVElO
VUFUSU9OX0JJVCA9IFZMUV9CQVNFOworLQorLQkgIC8qKgorLQkgICAqIENvbnZlcnRzIGZyb20g
YSB0d28tY29tcGxlbWVudCB2YWx1ZSB0byBhIHZhbHVlIHdoZXJlIHRoZSBzaWduIGJpdCBpcwor
LQkgICAqIHBsYWNlZCBpbiB0aGUgbGVhc3Qgc2lnbmlmaWNhbnQgYml0LiAgRm9yIGV4YW1wbGUs
IGFzIGRlY2ltYWxzOgorLQkgICAqICAgMSBiZWNvbWVzIDIgKDEwIGJpbmFyeSksIC0xIGJlY29t
ZXMgMyAoMTEgYmluYXJ5KQorLQkgICAqICAgMiBiZWNvbWVzIDQgKDEwMCBiaW5hcnkpLCAtMiBi
ZWNvbWVzIDUgKDEwMSBiaW5hcnkpCistCSAgICovCistCSAgZnVuY3Rpb24gdG9WTFFTaWduZWQo
YVZhbHVlKSB7CistCSAgICByZXR1cm4gYVZhbHVlIDwgMAorLQkgICAgICA/ICgoLWFWYWx1ZSkg
PDwgMSkgKyAxCistCSAgICAgIDogKGFWYWx1ZSA8PCAxKSArIDA7CistCSAgfQorLQorLQkgIC8q
KgorLQkgICAqIENvbnZlcnRzIHRvIGEgdHdvLWNvbXBsZW1lbnQgdmFsdWUgZnJvbSBhIHZhbHVl
IHdoZXJlIHRoZSBzaWduIGJpdCBpcworLQkgICAqIHBsYWNlZCBpbiB0aGUgbGVhc3Qgc2lnbmlm
aWNhbnQgYml0LiAgRm9yIGV4YW1wbGUsIGFzIGRlY2ltYWxzOgorLQkgICAqICAgMiAoMTAgYmlu
YXJ5KSBiZWNvbWVzIDEsIDMgKDExIGJpbmFyeSkgYmVjb21lcyAtMQorLQkgICAqICAgNCAoMTAw
IGJpbmFyeSkgYmVjb21lcyAyLCA1ICgxMDEgYmluYXJ5KSBiZWNvbWVzIC0yCistCSAgICovCist
CSAgZnVuY3Rpb24gZnJvbVZMUVNpZ25lZChhVmFsdWUpIHsKKy0JICAgIHZhciBpc05lZ2F0aXZl
ID0gKGFWYWx1ZSAmIDEpID09PSAxOworLQkgICAgdmFyIHNoaWZ0ZWQgPSBhVmFsdWUgPj4gMTsK
Ky0JICAgIHJldHVybiBpc05lZ2F0aXZlCistCSAgICAgID8gLXNoaWZ0ZWQKKy0JICAgICAgOiBz
aGlmdGVkOworLQkgIH0KKy0KKy0JICAvKioKKy0JICAgKiBSZXR1cm5zIHRoZSBiYXNlIDY0IFZM
USBlbmNvZGVkIHZhbHVlLgorLQkgICAqLworLQkgIGV4cG9ydHMuZW5jb2RlID0gZnVuY3Rpb24g
YmFzZTY0VkxRX2VuY29kZShhVmFsdWUpIHsKKy0JICAgIHZhciBlbmNvZGVkID0gIiI7CistCSAg
ICB2YXIgZGlnaXQ7CistCistCSAgICB2YXIgdmxxID0gdG9WTFFTaWduZWQoYVZhbHVlKTsKKy0K
Ky0JICAgIGRvIHsKKy0JICAgICAgZGlnaXQgPSB2bHEgJiBWTFFfQkFTRV9NQVNLOworLQkgICAg
ICB2bHEgPj4+PSBWTFFfQkFTRV9TSElGVDsKKy0JICAgICAgaWYgKHZscSA+IDApIHsKKy0JICAg
ICAgICAvLyBUaGVyZSBhcmUgc3RpbGwgbW9yZSBkaWdpdHMgaW4gdGhpcyB2YWx1ZSwgc28gd2Ug
bXVzdCBtYWtlIHN1cmUgdGhlCistCSAgICAgICAgLy8gY29udGludWF0aW9uIGJpdCBpcyBtYXJr
ZWQuCistCSAgICAgICAgZGlnaXQgfD0gVkxRX0NPTlRJTlVBVElPTl9CSVQ7CistCSAgICAgIH0K
Ky0JICAgICAgZW5jb2RlZCArPSBiYXNlNjQuZW5jb2RlKGRpZ2l0KTsKKy0JICAgIH0gd2hpbGUg
KHZscSA+IDApOworLQorLQkgICAgcmV0dXJuIGVuY29kZWQ7CistCSAgfTsKKy0KKy0JICAvKioK
Ky0JICAgKiBEZWNvZGVzIHRoZSBuZXh0IGJhc2UgNjQgVkxRIHZhbHVlIGZyb20gdGhlIGdpdmVu
IHN0cmluZyBhbmQgcmV0dXJucyB0aGUKKy0JICAgKiB2YWx1ZSBhbmQgdGhlIHJlc3Qgb2YgdGhl
IHN0cmluZyB2aWEgdGhlIG91dCBwYXJhbWV0ZXIuCistCSAgICovCistCSAgZXhwb3J0cy5kZWNv
ZGUgPSBmdW5jdGlvbiBiYXNlNjRWTFFfZGVjb2RlKGFTdHIsIGFJbmRleCwgYU91dFBhcmFtKSB7
CistCSAgICB2YXIgc3RyTGVuID0gYVN0ci5sZW5ndGg7CistCSAgICB2YXIgcmVzdWx0ID0gMDsK
Ky0JICAgIHZhciBzaGlmdCA9IDA7CistCSAgICB2YXIgY29udGludWF0aW9uLCBkaWdpdDsKKy0K
Ky0JICAgIGRvIHsKKy0JICAgICAgaWYgKGFJbmRleCA+PSBzdHJMZW4pIHsKKy0JICAgICAgICB0
aHJvdyBuZXcgRXJyb3IoIkV4cGVjdGVkIG1vcmUgZGlnaXRzIGluIGJhc2UgNjQgVkxRIHZhbHVl
LiIpOworLQkgICAgICB9CistCistCSAgICAgIGRpZ2l0ID0gYmFzZTY0LmRlY29kZShhU3RyLmNo
YXJDb2RlQXQoYUluZGV4KyspKTsKKy0JICAgICAgaWYgKGRpZ2l0ID09PSAtMSkgeworLQkgICAg
ICAgIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBiYXNlNjQgZGlnaXQ6ICIgKyBhU3RyLmNoYXJB
dChhSW5kZXggLSAxKSk7CistCSAgICAgIH0KKy0KKy0JICAgICAgY29udGludWF0aW9uID0gISEo
ZGlnaXQgJiBWTFFfQ09OVElOVUFUSU9OX0JJVCk7CistCSAgICAgIGRpZ2l0ICY9IFZMUV9CQVNF
X01BU0s7CistCSAgICAgIHJlc3VsdCA9IHJlc3VsdCArIChkaWdpdCA8PCBzaGlmdCk7CistCSAg
ICAgIHNoaWZ0ICs9IFZMUV9CQVNFX1NISUZUOworLQkgICAgfSB3aGlsZSAoY29udGludWF0aW9u
KTsKKy0KKy0JICAgIGFPdXRQYXJhbS52YWx1ZSA9IGZyb21WTFFTaWduZWQocmVzdWx0KTsKKy0J
ICAgIGFPdXRQYXJhbS5yZXN0ID0gYUluZGV4OworLQkgIH07CistCX0KKy0KKy0KKy0vKioqLyB9
LAorLS8qIDMgKi8KKy0vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHsKKy0KKy0JLyog
LSotIE1vZGU6IGpzOyBqcy1pbmRlbnQtbGV2ZWw6IDI7IC0qLSAqLworLQkvKgorLQkgKiBDb3B5
cmlnaHQgMjAxMSBNb3ppbGxhIEZvdW5kYXRpb24gYW5kIGNvbnRyaWJ1dG9ycworLQkgKiBMaWNl
bnNlZCB1bmRlciB0aGUgTmV3IEJTRCBsaWNlbnNlLiBTZWUgTElDRU5TRSBvcjoKKy0JICogaHR0
cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL0JTRC0zLUNsYXVzZQorLQkgKi8KKy0JeworLQkg
IHZhciBpbnRUb0NoYXJNYXAgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlq
a2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLycuc3BsaXQoJycpOworLQorLQkgIC8qKgorLQkg
ICAqIEVuY29kZSBhbiBpbnRlZ2VyIGluIHRoZSByYW5nZSBvZiAwIHRvIDYzIHRvIGEgc2luZ2xl
IGJhc2UgNjQgZGlnaXQuCistCSAgICovCistCSAgZXhwb3J0cy5lbmNvZGUgPSBmdW5jdGlvbiAo
bnVtYmVyKSB7CistCSAgICBpZiAoMCA8PSBudW1iZXIgJiYgbnVtYmVyIDwgaW50VG9DaGFyTWFw
Lmxlbmd0aCkgeworLQkgICAgICByZXR1cm4gaW50VG9DaGFyTWFwW251bWJlcl07CistCSAgICB9
CistCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJNdXN0IGJlIGJldHdlZW4gMCBhbmQgNjM6ICIg
KyBudW1iZXIpOworLQkgIH07CistCistCSAgLyoqCistCSAgICogRGVjb2RlIGEgc2luZ2xlIGJh
c2UgNjQgY2hhcmFjdGVyIGNvZGUgZGlnaXQgdG8gYW4gaW50ZWdlci4gUmV0dXJucyAtMSBvbgor
LQkgICAqIGZhaWx1cmUuCistCSAgICovCistCSAgZXhwb3J0cy5kZWNvZGUgPSBmdW5jdGlvbiAo
Y2hhckNvZGUpIHsKKy0JICAgIHZhciBiaWdBID0gNjU7ICAgICAvLyAnQScKKy0JICAgIHZhciBi
aWdaID0gOTA7ICAgICAvLyAnWicKKy0KKy0JICAgIHZhciBsaXR0bGVBID0gOTc7ICAvLyAnYScK
Ky0JICAgIHZhciBsaXR0bGVaID0gMTIyOyAvLyAneicKKy0KKy0JICAgIHZhciB6ZXJvID0gNDg7
ICAgICAvLyAnMCcKKy0JICAgIHZhciBuaW5lID0gNTc7ICAgICAvLyAnOScKKy0KKy0JICAgIHZh
ciBwbHVzID0gNDM7ICAgICAvLyAnKycKKy0JICAgIHZhciBzbGFzaCA9IDQ3OyAgICAvLyAnLycK
Ky0KKy0JICAgIHZhciBsaXR0bGVPZmZzZXQgPSAyNjsKKy0JICAgIHZhciBudW1iZXJPZmZzZXQg
PSA1MjsKKy0KKy0JICAgIC8vIDAgLSAyNTogQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVoKKy0J
ICAgIGlmIChiaWdBIDw9IGNoYXJDb2RlICYmIGNoYXJDb2RlIDw9IGJpZ1opIHsKKy0JICAgICAg
cmV0dXJuIChjaGFyQ29kZSAtIGJpZ0EpOworLQkgICAgfQorLQorLQkgICAgLy8gMjYgLSA1MTog
YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXoKKy0JICAgIGlmIChsaXR0bGVBIDw9IGNoYXJDb2Rl
ICYmIGNoYXJDb2RlIDw9IGxpdHRsZVopIHsKKy0JICAgICAgcmV0dXJuIChjaGFyQ29kZSAtIGxp
dHRsZUEgKyBsaXR0bGVPZmZzZXQpOworLQkgICAgfQorLQorLQkgICAgLy8gNTIgLSA2MTogMDEy
MzQ1Njc4OQorLQkgICAgaWYgKHplcm8gPD0gY2hhckNvZGUgJiYgY2hhckNvZGUgPD0gbmluZSkg
eworLQkgICAgICByZXR1cm4gKGNoYXJDb2RlIC0gemVybyArIG51bWJlck9mZnNldCk7CistCSAg
ICB9CistCistCSAgICAvLyA2MjogKworLQkgICAgaWYgKGNoYXJDb2RlID09IHBsdXMpIHsKKy0J
ICAgICAgcmV0dXJuIDYyOworLQkgICAgfQorLQorLQkgICAgLy8gNjM6IC8KKy0JICAgIGlmIChj
aGFyQ29kZSA9PSBzbGFzaCkgeworLQkgICAgICByZXR1cm4gNjM7CistCSAgICB9CistCistCSAg
ICAvLyBJbnZhbGlkIGJhc2U2NCBkaWdpdC4KKy0JICAgIHJldHVybiAtMTsKKy0JICB9OworLQl9
CistCistCistLyoqKi8gfSwKKy0vKiA0ICovCistLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBv
cnRzKSB7CistCistCS8qIC0qLSBNb2RlOiBqczsganMtaW5kZW50LWxldmVsOiAyOyAtKi0gKi8K
Ky0JLyoKKy0JICogQ29weXJpZ2h0IDIwMTEgTW96aWxsYSBGb3VuZGF0aW9uIGFuZCBjb250cmli
dXRvcnMKKy0JICogTGljZW5zZWQgdW5kZXIgdGhlIE5ldyBCU0QgbGljZW5zZS4gU2VlIExJQ0VO
U0Ugb3I6CistCSAqIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9CU0QtMy1DbGF1c2UK
Ky0JICovCistCXsKKy0JICAvKioKKy0JICAgKiBUaGlzIGlzIGEgaGVscGVyIGZ1bmN0aW9uIGZv
ciBnZXR0aW5nIHZhbHVlcyBmcm9tIHBhcmFtZXRlci9vcHRpb25zCistCSAgICogb2JqZWN0cy4K
Ky0JICAgKgorLQkgICAqIEBwYXJhbSBhcmdzIFRoZSBvYmplY3Qgd2UgYXJlIGV4dHJhY3Rpbmcg
dmFsdWVzIGZyb20KKy0JICAgKiBAcGFyYW0gbmFtZSBUaGUgbmFtZSBvZiB0aGUgcHJvcGVydHkg
d2UgYXJlIGdldHRpbmcuCistCSAgICogQHBhcmFtIGRlZmF1bHRWYWx1ZSBBbiBvcHRpb25hbCB2
YWx1ZSB0byByZXR1cm4gaWYgdGhlIHByb3BlcnR5IGlzIG1pc3NpbmcKKy0JICAgKiBmcm9tIHRo
ZSBvYmplY3QuIElmIHRoaXMgaXMgbm90IHNwZWNpZmllZCBhbmQgdGhlIHByb3BlcnR5IGlzIG1p
c3NpbmcsIGFuCistCSAgICogZXJyb3Igd2lsbCBiZSB0aHJvd24uCistCSAgICovCistCSAgZnVu
Y3Rpb24gZ2V0QXJnKGFBcmdzLCBhTmFtZSwgYURlZmF1bHRWYWx1ZSkgeworLQkgICAgaWYgKGFO
YW1lIGluIGFBcmdzKSB7CistCSAgICAgIHJldHVybiBhQXJnc1thTmFtZV07CistCSAgICB9IGVs
c2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDMpIHsKKy0JICAgICAgcmV0dXJuIGFEZWZhdWx0
VmFsdWU7CistCSAgICB9IGVsc2UgeworLQkgICAgICB0aHJvdyBuZXcgRXJyb3IoJyInICsgYU5h
bWUgKyAnIiBpcyBhIHJlcXVpcmVkIGFyZ3VtZW50LicpOworLQkgICAgfQorLQkgIH0KKy0JICBl
eHBvcnRzLmdldEFyZyA9IGdldEFyZzsKKy0KKy0JICB2YXIgdXJsUmVnZXhwID0gL14oPzooW1x3
K1wtLl0rKTopP1wvXC8oPzooXHcrOlx3KylAKT8oW1x3Ll0qKSg/OjooXGQrKSk/KFxTKikkLzsK
Ky0JICB2YXIgZGF0YVVybFJlZ2V4cCA9IC9eZGF0YTouK1wsLiskLzsKKy0KKy0JICBmdW5jdGlv
biB1cmxQYXJzZShhVXJsKSB7CistCSAgICB2YXIgbWF0Y2ggPSBhVXJsLm1hdGNoKHVybFJlZ2V4
cCk7CistCSAgICBpZiAoIW1hdGNoKSB7CistCSAgICAgIHJldHVybiBudWxsOworLQkgICAgfQor
LQkgICAgcmV0dXJuIHsKKy0JICAgICAgc2NoZW1lOiBtYXRjaFsxXSwKKy0JICAgICAgYXV0aDog
bWF0Y2hbMl0sCistCSAgICAgIGhvc3Q6IG1hdGNoWzNdLAorLQkgICAgICBwb3J0OiBtYXRjaFs0
XSwKKy0JICAgICAgcGF0aDogbWF0Y2hbNV0KKy0JICAgIH07CistCSAgfQorLQkgIGV4cG9ydHMu
dXJsUGFyc2UgPSB1cmxQYXJzZTsKKy0KKy0JICBmdW5jdGlvbiB1cmxHZW5lcmF0ZShhUGFyc2Vk
VXJsKSB7CistCSAgICB2YXIgdXJsID0gJyc7CistCSAgICBpZiAoYVBhcnNlZFVybC5zY2hlbWUp
IHsKKy0JICAgICAgdXJsICs9IGFQYXJzZWRVcmwuc2NoZW1lICsgJzonOworLQkgICAgfQorLQkg
ICAgdXJsICs9ICcvLyc7CistCSAgICBpZiAoYVBhcnNlZFVybC5hdXRoKSB7CistCSAgICAgIHVy
bCArPSBhUGFyc2VkVXJsLmF1dGggKyAnQCc7CistCSAgICB9CistCSAgICBpZiAoYVBhcnNlZFVy
bC5ob3N0KSB7CistCSAgICAgIHVybCArPSBhUGFyc2VkVXJsLmhvc3Q7CistCSAgICB9CistCSAg
ICBpZiAoYVBhcnNlZFVybC5wb3J0KSB7CistCSAgICAgIHVybCArPSAiOiIgKyBhUGFyc2VkVXJs
LnBvcnQKKy0JICAgIH0KKy0JICAgIGlmIChhUGFyc2VkVXJsLnBhdGgpIHsKKy0JICAgICAgdXJs
ICs9IGFQYXJzZWRVcmwucGF0aDsKKy0JICAgIH0KKy0JICAgIHJldHVybiB1cmw7CistCSAgfQor
LQkgIGV4cG9ydHMudXJsR2VuZXJhdGUgPSB1cmxHZW5lcmF0ZTsKKy0KKy0JICAvKioKKy0JICAg
KiBOb3JtYWxpemVzIGEgcGF0aCwgb3IgdGhlIHBhdGggcG9ydGlvbiBvZiBhIFVSTDoKKy0JICAg
KgorLQkgICAqIC0gUmVwbGFjZXMgY29uc2VxdXRpdmUgc2xhc2hlcyB3aXRoIG9uZSBzbGFzaC4K
Ky0JICAgKiAtIFJlbW92ZXMgdW5uZWNlc3NhcnkgJy4nIHBhcnRzLgorLQkgICAqIC0gUmVtb3Zl
cyB1bm5lY2Vzc2FyeSAnPGRpcj4vLi4nIHBhcnRzLgorLQkgICAqCistCSAgICogQmFzZWQgb24g
Y29kZSBpbiB0aGUgTm9kZS5qcyAncGF0aCcgY29yZSBtb2R1bGUuCistCSAgICoKKy0JICAgKiBA
cGFyYW0gYVBhdGggVGhlIHBhdGggb3IgdXJsIHRvIG5vcm1hbGl6ZS4KKy0JICAgKi8KKy0JICBm
dW5jdGlvbiBub3JtYWxpemUoYVBhdGgpIHsKKy0JICAgIHZhciBwYXRoID0gYVBhdGg7CistCSAg
ICB2YXIgdXJsID0gdXJsUGFyc2UoYVBhdGgpOworLQkgICAgaWYgKHVybCkgeworLQkgICAgICBp
ZiAoIXVybC5wYXRoKSB7CistCSAgICAgICAgcmV0dXJuIGFQYXRoOworLQkgICAgICB9CistCSAg
ICAgIHBhdGggPSB1cmwucGF0aDsKKy0JICAgIH0KKy0JICAgIHZhciBpc0Fic29sdXRlID0gZXhw
b3J0cy5pc0Fic29sdXRlKHBhdGgpOworLQorLQkgICAgdmFyIHBhcnRzID0gcGF0aC5zcGxpdCgv
XC8rLyk7CistCSAgICBmb3IgKHZhciBwYXJ0LCB1cCA9IDAsIGkgPSBwYXJ0cy5sZW5ndGggLSAx
OyBpID49IDA7IGktLSkgeworLQkgICAgICBwYXJ0ID0gcGFydHNbaV07CistCSAgICAgIGlmIChw
YXJ0ID09PSAnLicpIHsKKy0JICAgICAgICBwYXJ0cy5zcGxpY2UoaSwgMSk7CistCSAgICAgIH0g
ZWxzZSBpZiAocGFydCA9PT0gJy4uJykgeworLQkgICAgICAgIHVwKys7CistCSAgICAgIH0gZWxz
ZSBpZiAodXAgPiAwKSB7CistCSAgICAgICAgaWYgKHBhcnQgPT09ICcnKSB7CistCSAgICAgICAg
ICAvLyBUaGUgZmlyc3QgcGFydCBpcyBibGFuayBpZiB0aGUgcGF0aCBpcyBhYnNvbHV0ZS4gVHJ5
aW5nIHRvIGdvCistCSAgICAgICAgICAvLyBhYm92ZSB0aGUgcm9vdCBpcyBhIG5vLW9wLiBUaGVy
ZWZvcmUgd2UgY2FuIHJlbW92ZSBhbGwgJy4uJyBwYXJ0cworLQkgICAgICAgICAgLy8gZGlyZWN0
bHkgYWZ0ZXIgdGhlIHJvb3QuCistCSAgICAgICAgICBwYXJ0cy5zcGxpY2UoaSArIDEsIHVwKTsK
Ky0JICAgICAgICAgIHVwID0gMDsKKy0JICAgICAgICB9IGVsc2UgeworLQkgICAgICAgICAgcGFy
dHMuc3BsaWNlKGksIDIpOworLQkgICAgICAgICAgdXAtLTsKKy0JICAgICAgICB9CistCSAgICAg
IH0KKy0JICAgIH0KKy0JICAgIHBhdGggPSBwYXJ0cy5qb2luKCcvJyk7CistCistCSAgICBpZiAo
cGF0aCA9PT0gJycpIHsKKy0JICAgICAgcGF0aCA9IGlzQWJzb2x1dGUgPyAnLycgOiAnLic7Cist
CSAgICB9CistCistCSAgICBpZiAodXJsKSB7CistCSAgICAgIHVybC5wYXRoID0gcGF0aDsKKy0J
ICAgICAgcmV0dXJuIHVybEdlbmVyYXRlKHVybCk7CistCSAgICB9CistCSAgICByZXR1cm4gcGF0
aDsKKy0JICB9CistCSAgZXhwb3J0cy5ub3JtYWxpemUgPSBub3JtYWxpemU7CistCistCSAgLyoq
CistCSAgICogSm9pbnMgdHdvIHBhdGhzL1VSTHMuCistCSAgICoKKy0JICAgKiBAcGFyYW0gYVJv
b3QgVGhlIHJvb3QgcGF0aCBvciBVUkwuCistCSAgICogQHBhcmFtIGFQYXRoIFRoZSBwYXRoIG9y
IFVSTCB0byBiZSBqb2luZWQgd2l0aCB0aGUgcm9vdC4KKy0JICAgKgorLQkgICAqIC0gSWYgYVBh
dGggaXMgYSBVUkwgb3IgYSBkYXRhIFVSSSwgYVBhdGggaXMgcmV0dXJuZWQsIHVubGVzcyBhUGF0
aCBpcyBhCistCSAgICogICBzY2hlbWUtcmVsYXRpdmUgVVJMOiBUaGVuIHRoZSBzY2hlbWUgb2Yg
YVJvb3QsIGlmIGFueSwgaXMgcHJlcGVuZGVkCistCSAgICogICBmaXJzdC4KKy0JICAgKiAtIE90
aGVyd2lzZSBhUGF0aCBpcyBhIHBhdGguIElmIGFSb290IGlzIGEgVVJMLCB0aGVuIGl0cyBwYXRo
IHBvcnRpb24KKy0JICAgKiAgIGlzIHVwZGF0ZWQgd2l0aCB0aGUgcmVzdWx0IGFuZCBhUm9vdCBp
cyByZXR1cm5lZC4gT3RoZXJ3aXNlIHRoZSByZXN1bHQKKy0JICAgKiAgIGlzIHJldHVybmVkLgor
LQkgICAqICAgLSBJZiBhUGF0aCBpcyBhYnNvbHV0ZSwgdGhlIHJlc3VsdCBpcyBhUGF0aC4KKy0J
ICAgKiAgIC0gT3RoZXJ3aXNlIHRoZSB0d28gcGF0aHMgYXJlIGpvaW5lZCB3aXRoIGEgc2xhc2gu
CistCSAgICogLSBKb2luaW5nIGZvciBleGFtcGxlICdodHRwOi8vJyBhbmQgJ3d3dy5leGFtcGxl
LmNvbScgaXMgYWxzbyBzdXBwb3J0ZWQuCistCSAgICovCistCSAgZnVuY3Rpb24gam9pbihhUm9v
dCwgYVBhdGgpIHsKKy0JICAgIGlmIChhUm9vdCA9PT0gIiIpIHsKKy0JICAgICAgYVJvb3QgPSAi
LiI7CistCSAgICB9CistCSAgICBpZiAoYVBhdGggPT09ICIiKSB7CistCSAgICAgIGFQYXRoID0g
Ii4iOworLQkgICAgfQorLQkgICAgdmFyIGFQYXRoVXJsID0gdXJsUGFyc2UoYVBhdGgpOworLQkg
ICAgdmFyIGFSb290VXJsID0gdXJsUGFyc2UoYVJvb3QpOworLQkgICAgaWYgKGFSb290VXJsKSB7
CistCSAgICAgIGFSb290ID0gYVJvb3RVcmwucGF0aCB8fCAnLyc7CistCSAgICB9CistCistCSAg
ICAvLyBgam9pbihmb28sICcvL3d3dy5leGFtcGxlLm9yZycpYAorLQkgICAgaWYgKGFQYXRoVXJs
ICYmICFhUGF0aFVybC5zY2hlbWUpIHsKKy0JICAgICAgaWYgKGFSb290VXJsKSB7CistCSAgICAg
ICAgYVBhdGhVcmwuc2NoZW1lID0gYVJvb3RVcmwuc2NoZW1lOworLQkgICAgICB9CistCSAgICAg
IHJldHVybiB1cmxHZW5lcmF0ZShhUGF0aFVybCk7CistCSAgICB9CistCistCSAgICBpZiAoYVBh
dGhVcmwgfHwgYVBhdGgubWF0Y2goZGF0YVVybFJlZ2V4cCkpIHsKKy0JICAgICAgcmV0dXJuIGFQ
YXRoOworLQkgICAgfQorLQorLQkgICAgLy8gYGpvaW4oJ2h0dHA6Ly8nLCAnd3d3LmV4YW1wbGUu
Y29tJylgCistCSAgICBpZiAoYVJvb3RVcmwgJiYgIWFSb290VXJsLmhvc3QgJiYgIWFSb290VXJs
LnBhdGgpIHsKKy0JICAgICAgYVJvb3RVcmwuaG9zdCA9IGFQYXRoOworLQkgICAgICByZXR1cm4g
dXJsR2VuZXJhdGUoYVJvb3RVcmwpOworLQkgICAgfQorLQorLQkgICAgdmFyIGpvaW5lZCA9IGFQ
YXRoLmNoYXJBdCgwKSA9PT0gJy8nCistCSAgICAgID8gYVBhdGgKKy0JICAgICAgOiBub3JtYWxp
emUoYVJvb3QucmVwbGFjZSgvXC8rJC8sICcnKSArICcvJyArIGFQYXRoKTsKKy0KKy0JICAgIGlm
IChhUm9vdFVybCkgeworLQkgICAgICBhUm9vdFVybC5wYXRoID0gam9pbmVkOworLQkgICAgICBy
ZXR1cm4gdXJsR2VuZXJhdGUoYVJvb3RVcmwpOworLQkgICAgfQorLQkgICAgcmV0dXJuIGpvaW5l
ZDsKKy0JICB9CistCSAgZXhwb3J0cy5qb2luID0gam9pbjsKKy0KKy0JICBleHBvcnRzLmlzQWJz
b2x1dGUgPSBmdW5jdGlvbiAoYVBhdGgpIHsKKy0JICAgIHJldHVybiBhUGF0aC5jaGFyQXQoMCkg
PT09ICcvJyB8fCAhIWFQYXRoLm1hdGNoKHVybFJlZ2V4cCk7CistCSAgfTsKKy0KKy0JICAvKioK
Ky0JICAgKiBNYWtlIGEgcGF0aCByZWxhdGl2ZSB0byBhIFVSTCBvciBhbm90aGVyIHBhdGguCist
CSAgICoKKy0JICAgKiBAcGFyYW0gYVJvb3QgVGhlIHJvb3QgcGF0aCBvciBVUkwuCistCSAgICog
QHBhcmFtIGFQYXRoIFRoZSBwYXRoIG9yIFVSTCB0byBiZSBtYWRlIHJlbGF0aXZlIHRvIGFSb290
LgorLQkgICAqLworLQkgIGZ1bmN0aW9uIHJlbGF0aXZlKGFSb290LCBhUGF0aCkgeworLQkgICAg
aWYgKGFSb290ID09PSAiIikgeworLQkgICAgICBhUm9vdCA9ICIuIjsKKy0JICAgIH0KKy0KKy0J
ICAgIGFSb290ID0gYVJvb3QucmVwbGFjZSgvXC8kLywgJycpOworLQorLQkgICAgLy8gSXQgaXMg
cG9zc2libGUgZm9yIHRoZSBwYXRoIHRvIGJlIGFib3ZlIHRoZSByb290LiBJbiB0aGlzIGNhc2Us
IHNpbXBseQorLQkgICAgLy8gY2hlY2tpbmcgd2hldGhlciB0aGUgcm9vdCBpcyBhIHByZWZpeCBv
ZiB0aGUgcGF0aCB3b24ndCB3b3JrLiBJbnN0ZWFkLCB3ZQorLQkgICAgLy8gbmVlZCB0byByZW1v
dmUgY29tcG9uZW50cyBmcm9tIHRoZSByb290IG9uZSBieSBvbmUsIHVudGlsIGVpdGhlciB3ZSBm
aW5kCistCSAgICAvLyBhIHByZWZpeCB0aGF0IGZpdHMsIG9yIHdlIHJ1biBvdXQgb2YgY29tcG9u
ZW50cyB0byByZW1vdmUuCistCSAgICB2YXIgbGV2ZWwgPSAwOworLQkgICAgd2hpbGUgKGFQYXRo
LmluZGV4T2YoYVJvb3QgKyAnLycpICE9PSAwKSB7CistCSAgICAgIHZhciBpbmRleCA9IGFSb290
Lmxhc3RJbmRleE9mKCIvIik7CistCSAgICAgIGlmIChpbmRleCA8IDApIHsKKy0JICAgICAgICBy
ZXR1cm4gYVBhdGg7CistCSAgICAgIH0KKy0KKy0JICAgICAgLy8gSWYgdGhlIG9ubHkgcGFydCBv
ZiB0aGUgcm9vdCB0aGF0IGlzIGxlZnQgaXMgdGhlIHNjaGVtZSAoaS5lLiBodHRwOi8vLAorLQkg
ICAgICAvLyBmaWxlOi8vLywgZXRjLiksIG9uZSBvciBtb3JlIHNsYXNoZXMgKC8pLCBvciBzaW1w
bHkgbm90aGluZyBhdCBhbGwsIHdlCistCSAgICAgIC8vIGhhdmUgZXhoYXVzdGVkIGFsbCBjb21w
b25lbnRzLCBzbyB0aGUgcGF0aCBpcyBub3QgcmVsYXRpdmUgdG8gdGhlIHJvb3QuCistCSAgICAg
IGFSb290ID0gYVJvb3Quc2xpY2UoMCwgaW5kZXgpOworLQkgICAgICBpZiAoYVJvb3QubWF0Y2go
L14oW15cL10rOlwvKT9cLyokLykpIHsKKy0JICAgICAgICByZXR1cm4gYVBhdGg7CistCSAgICAg
IH0KKy0KKy0JICAgICAgKytsZXZlbDsKKy0JICAgIH0KKy0KKy0JICAgIC8vIE1ha2Ugc3VyZSB3
ZSBhZGQgYSAiLi4vIiBmb3IgZWFjaCBjb21wb25lbnQgd2UgcmVtb3ZlZCBmcm9tIHRoZSByb290
LgorLQkgICAgcmV0dXJuIEFycmF5KGxldmVsICsgMSkuam9pbigiLi4vIikgKyBhUGF0aC5zdWJz
dHIoYVJvb3QubGVuZ3RoICsgMSk7CistCSAgfQorLQkgIGV4cG9ydHMucmVsYXRpdmUgPSByZWxh
dGl2ZTsKKy0KKy0JICAvKioKKy0JICAgKiBCZWNhdXNlIGJlaGF2aW9yIGdvZXMgd2Fja3kgd2hl
biB5b3Ugc2V0IGBfX3Byb3RvX19gIG9uIG9iamVjdHMsIHdlCistCSAgICogaGF2ZSB0byBwcmVm
aXggYWxsIHRoZSBzdHJpbmdzIGluIG91ciBzZXQgd2l0aCBhbiBhcmJpdHJhcnkgY2hhcmFjdGVy
LgorLQkgICAqCistCSAgICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9tb3ppbGxhL3NvdXJjZS1t
YXAvcHVsbC8zMSBhbmQKKy0JICAgKiBodHRwczovL2dpdGh1Yi5jb20vbW96aWxsYS9zb3VyY2Ut
bWFwL2lzc3Vlcy8zMAorLQkgICAqCistCSAgICogQHBhcmFtIFN0cmluZyBhU3RyCistCSAgICov
CistCSAgZnVuY3Rpb24gdG9TZXRTdHJpbmcoYVN0cikgeworLQkgICAgcmV0dXJuICckJyArIGFT
dHI7CistCSAgfQorLQkgIGV4cG9ydHMudG9TZXRTdHJpbmcgPSB0b1NldFN0cmluZzsKKy0KKy0J
ICBmdW5jdGlvbiBmcm9tU2V0U3RyaW5nKGFTdHIpIHsKKy0JICAgIHJldHVybiBhU3RyLnN1YnN0
cigxKTsKKy0JICB9CistCSAgZXhwb3J0cy5mcm9tU2V0U3RyaW5nID0gZnJvbVNldFN0cmluZzsK
Ky0KKy0JICAvKioKKy0JICAgKiBDb21wYXJhdG9yIGJldHdlZW4gdHdvIG1hcHBpbmdzIHdoZXJl
IHRoZSBvcmlnaW5hbCBwb3NpdGlvbnMgYXJlIGNvbXBhcmVkLgorLQkgICAqCistCSAgICogT3B0
aW9uYWxseSBwYXNzIGluIGB0cnVlYCBhcyBgb25seUNvbXBhcmVHZW5lcmF0ZWRgIHRvIGNvbnNp
ZGVyIHR3bworLQkgICAqIG1hcHBpbmdzIHdpdGggdGhlIHNhbWUgb3JpZ2luYWwgc291cmNlL2xp
bmUvY29sdW1uLCBidXQgZGlmZmVyZW50IGdlbmVyYXRlZAorLQkgICAqIGxpbmUgYW5kIGNvbHVt
biB0aGUgc2FtZS4gVXNlZnVsIHdoZW4gc2VhcmNoaW5nIGZvciBhIG1hcHBpbmcgd2l0aCBhCist
CSAgICogc3R1YmJlZCBvdXQgbWFwcGluZy4KKy0JICAgKi8KKy0JICBmdW5jdGlvbiBjb21wYXJl
QnlPcmlnaW5hbFBvc2l0aW9ucyhtYXBwaW5nQSwgbWFwcGluZ0IsIG9ubHlDb21wYXJlT3JpZ2lu
YWwpIHsKKy0JICAgIHZhciBjbXAgPSBtYXBwaW5nQS5zb3VyY2UgLSBtYXBwaW5nQi5zb3VyY2U7
CistCSAgICBpZiAoY21wICE9PSAwKSB7CistCSAgICAgIHJldHVybiBjbXA7CistCSAgICB9Cist
CistCSAgICBjbXAgPSBtYXBwaW5nQS5vcmlnaW5hbExpbmUgLSBtYXBwaW5nQi5vcmlnaW5hbExp
bmU7CistCSAgICBpZiAoY21wICE9PSAwKSB7CistCSAgICAgIHJldHVybiBjbXA7CistCSAgICB9
CistCistCSAgICBjbXAgPSBtYXBwaW5nQS5vcmlnaW5hbENvbHVtbiAtIG1hcHBpbmdCLm9yaWdp
bmFsQ29sdW1uOworLQkgICAgaWYgKGNtcCAhPT0gMCB8fCBvbmx5Q29tcGFyZU9yaWdpbmFsKSB7
CistCSAgICAgIHJldHVybiBjbXA7CistCSAgICB9CistCistCSAgICBjbXAgPSBtYXBwaW5nQS5n
ZW5lcmF0ZWRDb2x1bW4gLSBtYXBwaW5nQi5nZW5lcmF0ZWRDb2x1bW47CistCSAgICBpZiAoY21w
ICE9PSAwKSB7CistCSAgICAgIHJldHVybiBjbXA7CistCSAgICB9CistCistCSAgICBjbXAgPSBt
YXBwaW5nQS5nZW5lcmF0ZWRMaW5lIC0gbWFwcGluZ0IuZ2VuZXJhdGVkTGluZTsKKy0JICAgIGlm
IChjbXAgIT09IDApIHsKKy0JICAgICAgcmV0dXJuIGNtcDsKKy0JICAgIH0KKy0KKy0JICAgIHJl
dHVybiBtYXBwaW5nQS5uYW1lIC0gbWFwcGluZ0IubmFtZTsKKy0JICB9CistCSAgZXhwb3J0cy5j
b21wYXJlQnlPcmlnaW5hbFBvc2l0aW9ucyA9IGNvbXBhcmVCeU9yaWdpbmFsUG9zaXRpb25zOwor
LQorLQkgIC8qKgorLQkgICAqIENvbXBhcmF0b3IgYmV0d2VlbiB0d28gbWFwcGluZ3Mgd2l0aCBk
ZWZsYXRlZCBzb3VyY2UgYW5kIG5hbWUgaW5kaWNlcyB3aGVyZQorLQkgICAqIHRoZSBnZW5lcmF0
ZWQgcG9zaXRpb25zIGFyZSBjb21wYXJlZC4KKy0JICAgKgorLQkgICAqIE9wdGlvbmFsbHkgcGFz
cyBpbiBgdHJ1ZWAgYXMgYG9ubHlDb21wYXJlR2VuZXJhdGVkYCB0byBjb25zaWRlciB0d28KKy0J
ICAgKiBtYXBwaW5ncyB3aXRoIHRoZSBzYW1lIGdlbmVyYXRlZCBsaW5lIGFuZCBjb2x1bW4sIGJ1
dCBkaWZmZXJlbnQKKy0JICAgKiBzb3VyY2UvbmFtZS9vcmlnaW5hbCBsaW5lIGFuZCBjb2x1bW4g
dGhlIHNhbWUuIFVzZWZ1bCB3aGVuIHNlYXJjaGluZyBmb3IgYQorLQkgICAqIG1hcHBpbmcgd2l0
aCBhIHN0dWJiZWQgb3V0IG1hcHBpbmcuCistCSAgICovCistCSAgZnVuY3Rpb24gY29tcGFyZUJ5
R2VuZXJhdGVkUG9zaXRpb25zRGVmbGF0ZWQobWFwcGluZ0EsIG1hcHBpbmdCLCBvbmx5Q29tcGFy
ZUdlbmVyYXRlZCkgeworLQkgICAgdmFyIGNtcCA9IG1hcHBpbmdBLmdlbmVyYXRlZExpbmUgLSBt
YXBwaW5nQi5nZW5lcmF0ZWRMaW5lOworLQkgICAgaWYgKGNtcCAhPT0gMCkgeworLQkgICAgICBy
ZXR1cm4gY21wOworLQkgICAgfQorLQorLQkgICAgY21wID0gbWFwcGluZ0EuZ2VuZXJhdGVkQ29s
dW1uIC0gbWFwcGluZ0IuZ2VuZXJhdGVkQ29sdW1uOworLQkgICAgaWYgKGNtcCAhPT0gMCB8fCBv
bmx5Q29tcGFyZUdlbmVyYXRlZCkgeworLQkgICAgICByZXR1cm4gY21wOworLQkgICAgfQorLQor
LQkgICAgY21wID0gbWFwcGluZ0Euc291cmNlIC0gbWFwcGluZ0Iuc291cmNlOworLQkgICAgaWYg
KGNtcCAhPT0gMCkgeworLQkgICAgICByZXR1cm4gY21wOworLQkgICAgfQorLQorLQkgICAgY21w
ID0gbWFwcGluZ0Eub3JpZ2luYWxMaW5lIC0gbWFwcGluZ0Iub3JpZ2luYWxMaW5lOworLQkgICAg
aWYgKGNtcCAhPT0gMCkgeworLQkgICAgICByZXR1cm4gY21wOworLQkgICAgfQorLQorLQkgICAg
Y21wID0gbWFwcGluZ0Eub3JpZ2luYWxDb2x1bW4gLSBtYXBwaW5nQi5vcmlnaW5hbENvbHVtbjsK
Ky0JICAgIGlmIChjbXAgIT09IDApIHsKKy0JICAgICAgcmV0dXJuIGNtcDsKKy0JICAgIH0KKy0K
Ky0JICAgIHJldHVybiBtYXBwaW5nQS5uYW1lIC0gbWFwcGluZ0IubmFtZTsKKy0JICB9CistCSAg
ZXhwb3J0cy5jb21wYXJlQnlHZW5lcmF0ZWRQb3NpdGlvbnNEZWZsYXRlZCA9IGNvbXBhcmVCeUdl
bmVyYXRlZFBvc2l0aW9uc0RlZmxhdGVkOworLQorLQkgIGZ1bmN0aW9uIHN0cmNtcChhU3RyMSwg
YVN0cjIpIHsKKy0JICAgIGlmIChhU3RyMSA9PT0gYVN0cjIpIHsKKy0JICAgICAgcmV0dXJuIDA7
CistCSAgICB9CistCistCSAgICBpZiAoYVN0cjEgPiBhU3RyMikgeworLQkgICAgICByZXR1cm4g
MTsKKy0JICAgIH0KKy0KKy0JICAgIHJldHVybiAtMTsKKy0JICB9CistCistCSAgLyoqCistCSAg
ICogQ29tcGFyYXRvciBiZXR3ZWVuIHR3byBtYXBwaW5ncyB3aXRoIGluZmxhdGVkIHNvdXJjZSBh
bmQgbmFtZSBzdHJpbmdzIHdoZXJlCistCSAgICogdGhlIGdlbmVyYXRlZCBwb3NpdGlvbnMgYXJl
IGNvbXBhcmVkLgorLQkgICAqLworLQkgIGZ1bmN0aW9uIGNvbXBhcmVCeUdlbmVyYXRlZFBvc2l0
aW9uc0luZmxhdGVkKG1hcHBpbmdBLCBtYXBwaW5nQikgeworLQkgICAgdmFyIGNtcCA9IG1hcHBp
bmdBLmdlbmVyYXRlZExpbmUgLSBtYXBwaW5nQi5nZW5lcmF0ZWRMaW5lOworLQkgICAgaWYgKGNt
cCAhPT0gMCkgeworLQkgICAgICByZXR1cm4gY21wOworLQkgICAgfQorLQorLQkgICAgY21wID0g
bWFwcGluZ0EuZ2VuZXJhdGVkQ29sdW1uIC0gbWFwcGluZ0IuZ2VuZXJhdGVkQ29sdW1uOworLQkg
ICAgaWYgKGNtcCAhPT0gMCkgeworLQkgICAgICByZXR1cm4gY21wOworLQkgICAgfQorLQorLQkg
ICAgY21wID0gc3RyY21wKG1hcHBpbmdBLnNvdXJjZSwgbWFwcGluZ0Iuc291cmNlKTsKKy0JICAg
IGlmIChjbXAgIT09IDApIHsKKy0JICAgICAgcmV0dXJuIGNtcDsKKy0JICAgIH0KKy0KKy0JICAg
IGNtcCA9IG1hcHBpbmdBLm9yaWdpbmFsTGluZSAtIG1hcHBpbmdCLm9yaWdpbmFsTGluZTsKKy0J
ICAgIGlmIChjbXAgIT09IDApIHsKKy0JICAgICAgcmV0dXJuIGNtcDsKKy0JICAgIH0KKy0KKy0J
ICAgIGNtcCA9IG1hcHBpbmdBLm9yaWdpbmFsQ29sdW1uIC0gbWFwcGluZ0Iub3JpZ2luYWxDb2x1
bW47CistCSAgICBpZiAoY21wICE9PSAwKSB7CistCSAgICAgIHJldHVybiBjbXA7CistCSAgICB9
CistCistCSAgICByZXR1cm4gc3RyY21wKG1hcHBpbmdBLm5hbWUsIG1hcHBpbmdCLm5hbWUpOwor
LQkgIH0KKy0JICBleHBvcnRzLmNvbXBhcmVCeUdlbmVyYXRlZFBvc2l0aW9uc0luZmxhdGVkID0g
Y29tcGFyZUJ5R2VuZXJhdGVkUG9zaXRpb25zSW5mbGF0ZWQ7CistCX0KKy0KKy0KKy0vKioqLyB9
LAorLS8qIDUgKi8KKy0vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19y
ZXF1aXJlX18pIHsKKy0KKy0JLyogLSotIE1vZGU6IGpzOyBqcy1pbmRlbnQtbGV2ZWw6IDI7IC0q
LSAqLworLQkvKgorLQkgKiBDb3B5cmlnaHQgMjAxMSBNb3ppbGxhIEZvdW5kYXRpb24gYW5kIGNv
bnRyaWJ1dG9ycworLQkgKiBMaWNlbnNlZCB1bmRlciB0aGUgTmV3IEJTRCBsaWNlbnNlLiBTZWUg
TElDRU5TRSBvcjoKKy0JICogaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL0JTRC0zLUNs
YXVzZQorLQkgKi8KKy0JeworLQkgIHZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsK
Ky0KKy0JICAvKioKKy0JICAgKiBBIGRhdGEgc3RydWN0dXJlIHdoaWNoIGlzIGEgY29tYmluYXRp
b24gb2YgYW4gYXJyYXkgYW5kIGEgc2V0LiBBZGRpbmcgYSBuZXcKKy0JICAgKiBtZW1iZXIgaXMg
TygxKSwgdGVzdGluZyBmb3IgbWVtYmVyc2hpcCBpcyBPKDEpLCBhbmQgZmluZGluZyB0aGUgaW5k
ZXggb2YgYW4KKy0JICAgKiBlbGVtZW50IGlzIE8oMSkuIFJlbW92aW5nIGVsZW1lbnRzIGZyb20g
dGhlIHNldCBpcyBub3Qgc3VwcG9ydGVkLiBPbmx5CistCSAgICogc3RyaW5ncyBhcmUgc3VwcG9y
dGVkIGZvciBtZW1iZXJzaGlwLgorLQkgICAqLworLQkgIGZ1bmN0aW9uIEFycmF5U2V0KCkgewor
LQkgICAgdGhpcy5fYXJyYXkgPSBbXTsKKy0JICAgIHRoaXMuX3NldCA9IHt9OworLQkgIH0KKy0K
Ky0JICAvKioKKy0JICAgKiBTdGF0aWMgbWV0aG9kIGZvciBjcmVhdGluZyBBcnJheVNldCBpbnN0
YW5jZXMgZnJvbSBhbiBleGlzdGluZyBhcnJheS4KKy0JICAgKi8KKy0JICBBcnJheVNldC5mcm9t
QXJyYXkgPSBmdW5jdGlvbiBBcnJheVNldF9mcm9tQXJyYXkoYUFycmF5LCBhQWxsb3dEdXBsaWNh
dGVzKSB7CistCSAgICB2YXIgc2V0ID0gbmV3IEFycmF5U2V0KCk7CistCSAgICBmb3IgKHZhciBp
ID0gMCwgbGVuID0gYUFycmF5Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CistCSAgICAgIHNldC5h
ZGQoYUFycmF5W2ldLCBhQWxsb3dEdXBsaWNhdGVzKTsKKy0JICAgIH0KKy0JICAgIHJldHVybiBz
ZXQ7CistCSAgfTsKKy0KKy0JICAvKioKKy0JICAgKiBSZXR1cm4gaG93IG1hbnkgdW5pcXVlIGl0
ZW1zIGFyZSBpbiB0aGlzIEFycmF5U2V0LiBJZiBkdXBsaWNhdGVzIGhhdmUgYmVlbgorLQkgICAq
IGFkZGVkLCB0aGFuIHRob3NlIGRvIG5vdCBjb3VudCB0b3dhcmRzIHRoZSBzaXplLgorLQkgICAq
CistCSAgICogQHJldHVybnMgTnVtYmVyCistCSAgICovCistCSAgQXJyYXlTZXQucHJvdG90eXBl
LnNpemUgPSBmdW5jdGlvbiBBcnJheVNldF9zaXplKCkgeworLQkgICAgcmV0dXJuIE9iamVjdC5n
ZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMuX3NldCkubGVuZ3RoOworLQkgIH07CistCistCSAgLyoq
CistCSAgICogQWRkIHRoZSBnaXZlbiBzdHJpbmcgdG8gdGhpcyBzZXQuCistCSAgICoKKy0JICAg
KiBAcGFyYW0gU3RyaW5nIGFTdHIKKy0JICAgKi8KKy0JICBBcnJheVNldC5wcm90b3R5cGUuYWRk
ID0gZnVuY3Rpb24gQXJyYXlTZXRfYWRkKGFTdHIsIGFBbGxvd0R1cGxpY2F0ZXMpIHsKKy0JICAg
IHZhciBzU3RyID0gdXRpbC50b1NldFN0cmluZyhhU3RyKTsKKy0JICAgIHZhciBpc0R1cGxpY2F0
ZSA9IHRoaXMuX3NldC5oYXNPd25Qcm9wZXJ0eShzU3RyKTsKKy0JICAgIHZhciBpZHggPSB0aGlz
Ll9hcnJheS5sZW5ndGg7CistCSAgICBpZiAoIWlzRHVwbGljYXRlIHx8IGFBbGxvd0R1cGxpY2F0
ZXMpIHsKKy0JICAgICAgdGhpcy5fYXJyYXkucHVzaChhU3RyKTsKKy0JICAgIH0KKy0JICAgIGlm
ICghaXNEdXBsaWNhdGUpIHsKKy0JICAgICAgdGhpcy5fc2V0W3NTdHJdID0gaWR4OworLQkgICAg
fQorLQkgIH07CistCistCSAgLyoqCistCSAgICogSXMgdGhlIGdpdmVuIHN0cmluZyBhIG1lbWJl
ciBvZiB0aGlzIHNldD8KKy0JICAgKgorLQkgICAqIEBwYXJhbSBTdHJpbmcgYVN0cgorLQkgICAq
LworLQkgIEFycmF5U2V0LnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbiBBcnJheVNldF9oYXMoYVN0
cikgeworLQkgICAgdmFyIHNTdHIgPSB1dGlsLnRvU2V0U3RyaW5nKGFTdHIpOworLQkgICAgcmV0
dXJuIHRoaXMuX3NldC5oYXNPd25Qcm9wZXJ0eShzU3RyKTsKKy0JICB9OworLQorLQkgIC8qKgor
LQkgICAqIFdoYXQgaXMgdGhlIGluZGV4IG9mIHRoZSBnaXZlbiBzdHJpbmcgaW4gdGhlIGFycmF5
PworLQkgICAqCistCSAgICogQHBhcmFtIFN0cmluZyBhU3RyCistCSAgICovCistCSAgQXJyYXlT
ZXQucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiBBcnJheVNldF9pbmRleE9mKGFTdHIpIHsK
Ky0JICAgIHZhciBzU3RyID0gdXRpbC50b1NldFN0cmluZyhhU3RyKTsKKy0JICAgIGlmICh0aGlz
Ll9zZXQuaGFzT3duUHJvcGVydHkoc1N0cikpIHsKKy0JICAgICAgcmV0dXJuIHRoaXMuX3NldFtz
U3RyXTsKKy0JICAgIH0KKy0JICAgIHRocm93IG5ldyBFcnJvcignIicgKyBhU3RyICsgJyIgaXMg
bm90IGluIHRoZSBzZXQuJyk7CistCSAgfTsKKy0KKy0JICAvKioKKy0JICAgKiBXaGF0IGlzIHRo
ZSBlbGVtZW50IGF0IHRoZSBnaXZlbiBpbmRleD8KKy0JICAgKgorLQkgICAqIEBwYXJhbSBOdW1i
ZXIgYUlkeAorLQkgICAqLworLQkgIEFycmF5U2V0LnByb3RvdHlwZS5hdCA9IGZ1bmN0aW9uIEFy
cmF5U2V0X2F0KGFJZHgpIHsKKy0JICAgIGlmIChhSWR4ID49IDAgJiYgYUlkeCA8IHRoaXMuX2Fy
cmF5Lmxlbmd0aCkgeworLQkgICAgICByZXR1cm4gdGhpcy5fYXJyYXlbYUlkeF07CistCSAgICB9
CistCSAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGVsZW1lbnQgaW5kZXhlZCBieSAnICsgYUlkeCk7
CistCSAgfTsKKy0KKy0JICAvKioKKy0JICAgKiBSZXR1cm5zIHRoZSBhcnJheSByZXByZXNlbnRh
dGlvbiBvZiB0aGlzIHNldCAod2hpY2ggaGFzIHRoZSBwcm9wZXIgaW5kaWNlcworLQkgICAqIGlu
ZGljYXRlZCBieSBpbmRleE9mKS4gTm90ZSB0aGF0IHRoaXMgaXMgYSBjb3B5IG9mIHRoZSBpbnRl
cm5hbCBhcnJheSB1c2VkCistCSAgICogZm9yIHN0b3JpbmcgdGhlIG1lbWJlcnMgc28gdGhhdCBu
byBvbmUgY2FuIG1lc3Mgd2l0aCBpbnRlcm5hbCBzdGF0ZS4KKy0JICAgKi8KKy0JICBBcnJheVNl
dC5wcm90b3R5cGUudG9BcnJheSA9IGZ1bmN0aW9uIEFycmF5U2V0X3RvQXJyYXkoKSB7CistCSAg
ICByZXR1cm4gdGhpcy5fYXJyYXkuc2xpY2UoKTsKKy0JICB9OworLQorLQkgIGV4cG9ydHMuQXJy
YXlTZXQgPSBBcnJheVNldDsKKy0JfQorLQorLQorLS8qKiovIH0sCistLyogNiAqLworLS8qKiov
IGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykgeworLQorLQkv
KiAtKi0gTW9kZToganM7IGpzLWluZGVudC1sZXZlbDogMjsgLSotICovCistCS8qCistCSAqIENv
cHlyaWdodCAyMDE0IE1vemlsbGEgRm91bmRhdGlvbiBhbmQgY29udHJpYnV0b3JzCistCSAqIExp
Y2Vuc2VkIHVuZGVyIHRoZSBOZXcgQlNEIGxpY2Vuc2UuIFNlZSBMSUNFTlNFIG9yOgorLQkgKiBo
dHRwOi8vb3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvQlNELTMtQ2xhdXNlCistCSAqLworLQl7Cist
CSAgdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpOworLQorLQkgIC8qKgorLQkgICAq
IERldGVybWluZSB3aGV0aGVyIG1hcHBpbmdCIGlzIGFmdGVyIG1hcHBpbmdBIHdpdGggcmVzcGVj
dCB0byBnZW5lcmF0ZWQKKy0JICAgKiBwb3NpdGlvbi4KKy0JICAgKi8KKy0JICBmdW5jdGlvbiBn
ZW5lcmF0ZWRQb3NpdGlvbkFmdGVyKG1hcHBpbmdBLCBtYXBwaW5nQikgeworLQkgICAgLy8gT3B0
aW1pemVkIGZvciBtb3N0IGNvbW1vbiBjYXNlCistCSAgICB2YXIgbGluZUEgPSBtYXBwaW5nQS5n
ZW5lcmF0ZWRMaW5lOworLQkgICAgdmFyIGxpbmVCID0gbWFwcGluZ0IuZ2VuZXJhdGVkTGluZTsK
Ky0JICAgIHZhciBjb2x1bW5BID0gbWFwcGluZ0EuZ2VuZXJhdGVkQ29sdW1uOworLQkgICAgdmFy
IGNvbHVtbkIgPSBtYXBwaW5nQi5nZW5lcmF0ZWRDb2x1bW47CistCSAgICByZXR1cm4gbGluZUIg
PiBsaW5lQSB8fCBsaW5lQiA9PSBsaW5lQSAmJiBjb2x1bW5CID49IGNvbHVtbkEgfHwKKy0JICAg
ICAgICAgICB1dGlsLmNvbXBhcmVCeUdlbmVyYXRlZFBvc2l0aW9uc0luZmxhdGVkKG1hcHBpbmdB
LCBtYXBwaW5nQikgPD0gMDsKKy0JICB9CistCistCSAgLyoqCistCSAgICogQSBkYXRhIHN0cnVj
dHVyZSB0byBwcm92aWRlIGEgc29ydGVkIHZpZXcgb2YgYWNjdW11bGF0ZWQgbWFwcGluZ3MgaW4g
YQorLQkgICAqIHBlcmZvcm1hbmNlIGNvbnNjaW91cyBtYW5uZXIuIEl0IHRyYWRlcyBhIG5lZ2xp
YmFibGUgb3ZlcmhlYWQgaW4gZ2VuZXJhbAorLQkgICAqIGNhc2UgZm9yIGEgbGFyZ2Ugc3BlZWR1
cCBpbiBjYXNlIG9mIG1hcHBpbmdzIGJlaW5nIGFkZGVkIGluIG9yZGVyLgorLQkgICAqLworLQkg
IGZ1bmN0aW9uIE1hcHBpbmdMaXN0KCkgeworLQkgICAgdGhpcy5fYXJyYXkgPSBbXTsKKy0JICAg
IHRoaXMuX3NvcnRlZCA9IHRydWU7CistCSAgICAvLyBTZXJ2ZXMgYXMgaW5maW11bQorLQkgICAg
dGhpcy5fbGFzdCA9IHtnZW5lcmF0ZWRMaW5lOiAtMSwgZ2VuZXJhdGVkQ29sdW1uOiAwfTsKKy0J
ICB9CistCistCSAgLyoqCistCSAgICogSXRlcmF0ZSB0aHJvdWdoIGludGVybmFsIGl0ZW1zLiBU
aGlzIG1ldGhvZCB0YWtlcyB0aGUgc2FtZSBhcmd1bWVudHMgdGhhdAorLQkgICAqIGBBcnJheS5w
cm90b3R5cGUuZm9yRWFjaGAgdGFrZXMuCistCSAgICoKKy0JICAgKiBOT1RFOiBUaGUgb3JkZXIg
b2YgdGhlIG1hcHBpbmdzIGlzIE5PVCBndWFyYW50ZWVkLgorLQkgICAqLworLQkgIE1hcHBpbmdM
aXN0LnByb3RvdHlwZS51bnNvcnRlZEZvckVhY2ggPQorLQkgICAgZnVuY3Rpb24gTWFwcGluZ0xp
c3RfZm9yRWFjaChhQ2FsbGJhY2ssIGFUaGlzQXJnKSB7CistCSAgICAgIHRoaXMuX2FycmF5LmZv
ckVhY2goYUNhbGxiYWNrLCBhVGhpc0FyZyk7CistCSAgICB9OworLQorLQkgIC8qKgorLQkgICAq
IEFkZCB0aGUgZ2l2ZW4gc291cmNlIG1hcHBpbmcuCistCSAgICoKKy0JICAgKiBAcGFyYW0gT2Jq
ZWN0IGFNYXBwaW5nCistCSAgICovCistCSAgTWFwcGluZ0xpc3QucHJvdG90eXBlLmFkZCA9IGZ1
bmN0aW9uIE1hcHBpbmdMaXN0X2FkZChhTWFwcGluZykgeworLQkgICAgaWYgKGdlbmVyYXRlZFBv
c2l0aW9uQWZ0ZXIodGhpcy5fbGFzdCwgYU1hcHBpbmcpKSB7CistCSAgICAgIHRoaXMuX2xhc3Qg
PSBhTWFwcGluZzsKKy0JICAgICAgdGhpcy5fYXJyYXkucHVzaChhTWFwcGluZyk7CistCSAgICB9
IGVsc2UgeworLQkgICAgICB0aGlzLl9zb3J0ZWQgPSBmYWxzZTsKKy0JICAgICAgdGhpcy5fYXJy
YXkucHVzaChhTWFwcGluZyk7CistCSAgICB9CistCSAgfTsKKy0KKy0JICAvKioKKy0JICAgKiBS
ZXR1cm5zIHRoZSBmbGF0LCBzb3J0ZWQgYXJyYXkgb2YgbWFwcGluZ3MuIFRoZSBtYXBwaW5ncyBh
cmUgc29ydGVkIGJ5CistCSAgICogZ2VuZXJhdGVkIHBvc2l0aW9uLgorLQkgICAqCistCSAgICog
V0FSTklORzogVGhpcyBtZXRob2QgcmV0dXJucyBpbnRlcm5hbCBkYXRhIHdpdGhvdXQgY29weWlu
ZywgZm9yCistCSAgICogcGVyZm9ybWFuY2UuIFRoZSByZXR1cm4gdmFsdWUgbXVzdCBOT1QgYmUg
bXV0YXRlZCwgYW5kIHNob3VsZCBiZSB0cmVhdGVkIGFzCistCSAgICogYW4gaW1tdXRhYmxlIGJv
cnJvdy4gSWYgeW91IHdhbnQgdG8gdGFrZSBvd25lcnNoaXAsIHlvdSBtdXN0IG1ha2UgeW91ciBv
d24KKy0JICAgKiBjb3B5LgorLQkgICAqLworLQkgIE1hcHBpbmdMaXN0LnByb3RvdHlwZS50b0Fy
cmF5ID0gZnVuY3Rpb24gTWFwcGluZ0xpc3RfdG9BcnJheSgpIHsKKy0JICAgIGlmICghdGhpcy5f
c29ydGVkKSB7CistCSAgICAgIHRoaXMuX2FycmF5LnNvcnQodXRpbC5jb21wYXJlQnlHZW5lcmF0
ZWRQb3NpdGlvbnNJbmZsYXRlZCk7CistCSAgICAgIHRoaXMuX3NvcnRlZCA9IHRydWU7CistCSAg
ICB9CistCSAgICByZXR1cm4gdGhpcy5fYXJyYXk7CistCSAgfTsKKy0KKy0JICBleHBvcnRzLk1h
cHBpbmdMaXN0ID0gTWFwcGluZ0xpc3Q7CistCX0KKy0KKy0KKy0vKioqLyB9LAorLS8qIDcgKi8K
Ky0vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHsK
Ky0KKy0JLyogLSotIE1vZGU6IGpzOyBqcy1pbmRlbnQtbGV2ZWw6IDI7IC0qLSAqLworLQkvKgor
LQkgKiBDb3B5cmlnaHQgMjAxMSBNb3ppbGxhIEZvdW5kYXRpb24gYW5kIGNvbnRyaWJ1dG9ycwor
LQkgKiBMaWNlbnNlZCB1bmRlciB0aGUgTmV3IEJTRCBsaWNlbnNlLiBTZWUgTElDRU5TRSBvcjoK
Ky0JICogaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL0JTRC0zLUNsYXVzZQorLQkgKi8K
Ky0JeworLQkgIHZhciB1dGlsID0gX193ZWJwYWNrX3JlcXVpcmVfXyg0KTsKKy0JICB2YXIgYmlu
YXJ5U2VhcmNoID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4KTsKKy0JICB2YXIgQXJyYXlTZXQgPSBf
X3dlYnBhY2tfcmVxdWlyZV9fKDUpLkFycmF5U2V0OworLQkgIHZhciBiYXNlNjRWTFEgPSBfX3dl
YnBhY2tfcmVxdWlyZV9fKDIpOworLQkgIHZhciBxdWlja1NvcnQgPSBfX3dlYnBhY2tfcmVxdWly
ZV9fKDkpLnF1aWNrU29ydDsKKy0KKy0JICBmdW5jdGlvbiBTb3VyY2VNYXBDb25zdW1lcihhU291
cmNlTWFwKSB7CistCSAgICB2YXIgc291cmNlTWFwID0gYVNvdXJjZU1hcDsKKy0JICAgIGlmICh0
eXBlb2YgYVNvdXJjZU1hcCA9PT0gJ3N0cmluZycpIHsKKy0JICAgICAgc291cmNlTWFwID0gSlNP
Ti5wYXJzZShhU291cmNlTWFwLnJlcGxhY2UoL15cKVxdXH0nLywgJycpKTsKKy0JICAgIH0KKy0K
Ky0JICAgIHJldHVybiBzb3VyY2VNYXAuc2VjdGlvbnMgIT0gbnVsbAorLQkgICAgICA/IG5ldyBJ
bmRleGVkU291cmNlTWFwQ29uc3VtZXIoc291cmNlTWFwKQorLQkgICAgICA6IG5ldyBCYXNpY1Nv
dXJjZU1hcENvbnN1bWVyKHNvdXJjZU1hcCk7CistCSAgfQorLQorLQkgIFNvdXJjZU1hcENvbnN1
bWVyLmZyb21Tb3VyY2VNYXAgPSBmdW5jdGlvbihhU291cmNlTWFwKSB7CistCSAgICByZXR1cm4g
QmFzaWNTb3VyY2VNYXBDb25zdW1lci5mcm9tU291cmNlTWFwKGFTb3VyY2VNYXApOworLQkgIH0K
Ky0KKy0JICAvKioKKy0JICAgKiBUaGUgdmVyc2lvbiBvZiB0aGUgc291cmNlIG1hcHBpbmcgc3Bl
YyB0aGF0IHdlIGFyZSBjb25zdW1pbmcuCistCSAgICovCistCSAgU291cmNlTWFwQ29uc3VtZXIu
cHJvdG90eXBlLl92ZXJzaW9uID0gMzsKKy0KKy0JICAvLyBgX19nZW5lcmF0ZWRNYXBwaW5nc2Ag
YW5kIGBfX29yaWdpbmFsTWFwcGluZ3NgIGFyZSBhcnJheXMgdGhhdCBob2xkIHRoZQorLQkgIC8v
IHBhcnNlZCBtYXBwaW5nIGNvb3JkaW5hdGVzIGZyb20gdGhlIHNvdXJjZSBtYXAncyAibWFwcGlu
Z3MiIGF0dHJpYnV0ZS4gVGhleQorLQkgIC8vIGFyZSBsYXppbHkgaW5zdGFudGlhdGVkLCBhY2Nl
c3NlZCB2aWEgdGhlIGBfZ2VuZXJhdGVkTWFwcGluZ3NgIGFuZAorLQkgIC8vIGBfb3JpZ2luYWxN
YXBwaW5nc2AgZ2V0dGVycyByZXNwZWN0aXZlbHksIGFuZCB3ZSBvbmx5IHBhcnNlIHRoZSBtYXBw
aW5ncworLQkgIC8vIGFuZCBjcmVhdGUgdGhlc2UgYXJyYXlzIG9uY2UgcXVlcmllZCBmb3IgYSBz
b3VyY2UgbG9jYXRpb24uIFdlIGp1bXAgdGhyb3VnaAorLQkgIC8vIHRoZXNlIGhvb3BzIGJlY2F1
c2UgdGhlcmUgY2FuIGJlIG1hbnkgdGhvdXNhbmRzIG9mIG1hcHBpbmdzLCBhbmQgcGFyc2luZwor
LQkgIC8vIHRoZW0gaXMgZXhwZW5zaXZlLCBzbyB3ZSBvbmx5IHdhbnQgdG8gZG8gaXQgaWYgd2Ug
bXVzdC4KKy0JICAvLworLQkgIC8vIEVhY2ggb2JqZWN0IGluIHRoZSBhcnJheXMgaXMgb2YgdGhl
IGZvcm06CistCSAgLy8KKy0JICAvLyAgICAgeworLQkgIC8vICAgICAgIGdlbmVyYXRlZExpbmU6
IFRoZSBsaW5lIG51bWJlciBpbiB0aGUgZ2VuZXJhdGVkIGNvZGUsCistCSAgLy8gICAgICAgZ2Vu
ZXJhdGVkQ29sdW1uOiBUaGUgY29sdW1uIG51bWJlciBpbiB0aGUgZ2VuZXJhdGVkIGNvZGUsCist
CSAgLy8gICAgICAgc291cmNlOiBUaGUgcGF0aCB0byB0aGUgb3JpZ2luYWwgc291cmNlIGZpbGUg
dGhhdCBnZW5lcmF0ZWQgdGhpcworLQkgIC8vICAgICAgICAgICAgICAgY2h1bmsgb2YgY29kZSwK
Ky0JICAvLyAgICAgICBvcmlnaW5hbExpbmU6IFRoZSBsaW5lIG51bWJlciBpbiB0aGUgb3JpZ2lu
YWwgc291cmNlIHRoYXQKKy0JICAvLyAgICAgICAgICAgICAgICAgICAgIGNvcnJlc3BvbmRzIHRv
IHRoaXMgY2h1bmsgb2YgZ2VuZXJhdGVkIGNvZGUsCistCSAgLy8gICAgICAgb3JpZ2luYWxDb2x1
bW46IFRoZSBjb2x1bW4gbnVtYmVyIGluIHRoZSBvcmlnaW5hbCBzb3VyY2UgdGhhdAorLQkgIC8v
ICAgICAgICAgICAgICAgICAgICAgICBjb3JyZXNwb25kcyB0byB0aGlzIGNodW5rIG9mIGdlbmVy
YXRlZCBjb2RlLAorLQkgIC8vICAgICAgIG5hbWU6IFRoZSBuYW1lIG9mIHRoZSBvcmlnaW5hbCBz
eW1ib2wgd2hpY2ggZ2VuZXJhdGVkIHRoaXMgY2h1bmsgb2YKKy0JICAvLyAgICAgICAgICAgICBj
b2RlLgorLQkgIC8vICAgICB9CistCSAgLy8KKy0JICAvLyBBbGwgcHJvcGVydGllcyBleGNlcHQg
Zm9yIGBnZW5lcmF0ZWRMaW5lYCBhbmQgYGdlbmVyYXRlZENvbHVtbmAgY2FuIGJlCistCSAgLy8g
YG51bGxgLgorLQkgIC8vCistCSAgLy8gYF9nZW5lcmF0ZWRNYXBwaW5nc2AgaXMgb3JkZXJlZCBi
eSB0aGUgZ2VuZXJhdGVkIHBvc2l0aW9ucy4KKy0JICAvLworLQkgIC8vIGBfb3JpZ2luYWxNYXBw
aW5nc2AgaXMgb3JkZXJlZCBieSB0aGUgb3JpZ2luYWwgcG9zaXRpb25zLgorLQorLQkgIFNvdXJj
ZU1hcENvbnN1bWVyLnByb3RvdHlwZS5fX2dlbmVyYXRlZE1hcHBpbmdzID0gbnVsbDsKKy0JICBP
YmplY3QuZGVmaW5lUHJvcGVydHkoU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLCAnX2dlbmVy
YXRlZE1hcHBpbmdzJywgeworLQkgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CistCSAgICAgIGlmICgh
dGhpcy5fX2dlbmVyYXRlZE1hcHBpbmdzKSB7CistCSAgICAgICAgdGhpcy5fcGFyc2VNYXBwaW5n
cyh0aGlzLl9tYXBwaW5ncywgdGhpcy5zb3VyY2VSb290KTsKKy0JICAgICAgfQorLQorLQkgICAg
ICByZXR1cm4gdGhpcy5fX2dlbmVyYXRlZE1hcHBpbmdzOworLQkgICAgfQorLQkgIH0pOworLQor
LQkgIFNvdXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZS5fX29yaWdpbmFsTWFwcGluZ3MgPSBudWxs
OworLQkgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUs
ICdfb3JpZ2luYWxNYXBwaW5ncycsIHsKKy0JICAgIGdldDogZnVuY3Rpb24gKCkgeworLQkgICAg
ICBpZiAoIXRoaXMuX19vcmlnaW5hbE1hcHBpbmdzKSB7CistCSAgICAgICAgdGhpcy5fcGFyc2VN
YXBwaW5ncyh0aGlzLl9tYXBwaW5ncywgdGhpcy5zb3VyY2VSb290KTsKKy0JICAgICAgfQorLQor
LQkgICAgICByZXR1cm4gdGhpcy5fX29yaWdpbmFsTWFwcGluZ3M7CistCSAgICB9CistCSAgfSk7
CistCistCSAgU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLl9jaGFySXNNYXBwaW5nU2VwYXJh
dG9yID0KKy0JICAgIGZ1bmN0aW9uIFNvdXJjZU1hcENvbnN1bWVyX2NoYXJJc01hcHBpbmdTZXBh
cmF0b3IoYVN0ciwgaW5kZXgpIHsKKy0JICAgICAgdmFyIGMgPSBhU3RyLmNoYXJBdChpbmRleCk7
CistCSAgICAgIHJldHVybiBjID09PSAiOyIgfHwgYyA9PT0gIiwiOworLQkgICAgfTsKKy0KKy0J
ICAvKioKKy0JICAgKiBQYXJzZSB0aGUgbWFwcGluZ3MgaW4gYSBzdHJpbmcgaW4gdG8gYSBkYXRh
IHN0cnVjdHVyZSB3aGljaCB3ZSBjYW4gZWFzaWx5CistCSAgICogcXVlcnkgKHRoZSBvcmRlcmVk
IGFycmF5cyBpbiB0aGUgYHRoaXMuX19nZW5lcmF0ZWRNYXBwaW5nc2AgYW5kCistCSAgICogYHRo
aXMuX19vcmlnaW5hbE1hcHBpbmdzYCBwcm9wZXJ0aWVzKS4KKy0JICAgKi8KKy0JICBTb3VyY2VN
YXBDb25zdW1lci5wcm90b3R5cGUuX3BhcnNlTWFwcGluZ3MgPQorLQkgICAgZnVuY3Rpb24gU291
cmNlTWFwQ29uc3VtZXJfcGFyc2VNYXBwaW5ncyhhU3RyLCBhU291cmNlUm9vdCkgeworLQkgICAg
ICB0aHJvdyBuZXcgRXJyb3IoIlN1YmNsYXNzZXMgbXVzdCBpbXBsZW1lbnQgX3BhcnNlTWFwcGlu
Z3MiKTsKKy0JICAgIH07CistCistCSAgU291cmNlTWFwQ29uc3VtZXIuR0VORVJBVEVEX09SREVS
ID0gMTsKKy0JICBTb3VyY2VNYXBDb25zdW1lci5PUklHSU5BTF9PUkRFUiA9IDI7CistCistCSAg
U291cmNlTWFwQ29uc3VtZXIuR1JFQVRFU1RfTE9XRVJfQk9VTkQgPSAxOworLQkgIFNvdXJjZU1h
cENvbnN1bWVyLkxFQVNUX1VQUEVSX0JPVU5EID0gMjsKKy0KKy0JICAvKioKKy0JICAgKiBJdGVy
YXRlIG92ZXIgZWFjaCBtYXBwaW5nIGJldHdlZW4gYW4gb3JpZ2luYWwgc291cmNlL2xpbmUvY29s
dW1uIGFuZCBhCistCSAgICogZ2VuZXJhdGVkIGxpbmUvY29sdW1uIGluIHRoaXMgc291cmNlIG1h
cC4KKy0JICAgKgorLQkgICAqIEBwYXJhbSBGdW5jdGlvbiBhQ2FsbGJhY2sKKy0JICAgKiAgICAg
ICAgVGhlIGZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdpdGggZWFjaCBtYXBwaW5nLgorLQkgICAq
IEBwYXJhbSBPYmplY3QgYUNvbnRleHQKKy0JICAgKiAgICAgICAgT3B0aW9uYWwuIElmIHNwZWNp
ZmllZCwgdGhpcyBvYmplY3Qgd2lsbCBiZSB0aGUgdmFsdWUgb2YgYHRoaXNgIGV2ZXJ5CistCSAg
ICogICAgICAgIHRpbWUgdGhhdCBgYUNhbGxiYWNrYCBpcyBjYWxsZWQuCistCSAgICogQHBhcmFt
IGFPcmRlcgorLQkgICAqICAgICAgICBFaXRoZXIgYFNvdXJjZU1hcENvbnN1bWVyLkdFTkVSQVRF
RF9PUkRFUmAgb3IKKy0JICAgKiAgICAgICAgYFNvdXJjZU1hcENvbnN1bWVyLk9SSUdJTkFMX09S
REVSYC4gU3BlY2lmaWVzIHdoZXRoZXIgeW91IHdhbnQgdG8KKy0JICAgKiAgICAgICAgaXRlcmF0
ZSBvdmVyIHRoZSBtYXBwaW5ncyBzb3J0ZWQgYnkgdGhlIGdlbmVyYXRlZCBmaWxlJ3MgbGluZS9j
b2x1bW4KKy0JICAgKiAgICAgICAgb3JkZXIgb3IgdGhlIG9yaWdpbmFsJ3Mgc291cmNlL2xpbmUv
Y29sdW1uIG9yZGVyLCByZXNwZWN0aXZlbHkuIERlZmF1bHRzIHRvCistCSAgICogICAgICAgIGBT
b3VyY2VNYXBDb25zdW1lci5HRU5FUkFURURfT1JERVJgLgorLQkgICAqLworLQkgIFNvdXJjZU1h
cENvbnN1bWVyLnByb3RvdHlwZS5lYWNoTWFwcGluZyA9CistCSAgICBmdW5jdGlvbiBTb3VyY2VN
YXBDb25zdW1lcl9lYWNoTWFwcGluZyhhQ2FsbGJhY2ssIGFDb250ZXh0LCBhT3JkZXIpIHsKKy0J
ICAgICAgdmFyIGNvbnRleHQgPSBhQ29udGV4dCB8fCBudWxsOworLQkgICAgICB2YXIgb3JkZXIg
PSBhT3JkZXIgfHwgU291cmNlTWFwQ29uc3VtZXIuR0VORVJBVEVEX09SREVSOworLQorLQkgICAg
ICB2YXIgbWFwcGluZ3M7CistCSAgICAgIHN3aXRjaCAob3JkZXIpIHsKKy0JICAgICAgY2FzZSBT
b3VyY2VNYXBDb25zdW1lci5HRU5FUkFURURfT1JERVI6CistCSAgICAgICAgbWFwcGluZ3MgPSB0
aGlzLl9nZW5lcmF0ZWRNYXBwaW5nczsKKy0JICAgICAgICBicmVhazsKKy0JICAgICAgY2FzZSBT
b3VyY2VNYXBDb25zdW1lci5PUklHSU5BTF9PUkRFUjoKKy0JICAgICAgICBtYXBwaW5ncyA9IHRo
aXMuX29yaWdpbmFsTWFwcGluZ3M7CistCSAgICAgICAgYnJlYWs7CistCSAgICAgIGRlZmF1bHQ6
CistCSAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJVbmtub3duIG9yZGVyIG9mIGl0ZXJhdGlvbi4i
KTsKKy0JICAgICAgfQorLQorLQkgICAgICB2YXIgc291cmNlUm9vdCA9IHRoaXMuc291cmNlUm9v
dDsKKy0JICAgICAgbWFwcGluZ3MubWFwKGZ1bmN0aW9uIChtYXBwaW5nKSB7CistCSAgICAgICAg
dmFyIHNvdXJjZSA9IG1hcHBpbmcuc291cmNlID09PSBudWxsID8gbnVsbCA6IHRoaXMuX3NvdXJj
ZXMuYXQobWFwcGluZy5zb3VyY2UpOworLQkgICAgICAgIGlmIChzb3VyY2UgIT0gbnVsbCAmJiBz
b3VyY2VSb290ICE9IG51bGwpIHsKKy0JICAgICAgICAgIHNvdXJjZSA9IHV0aWwuam9pbihzb3Vy
Y2VSb290LCBzb3VyY2UpOworLQkgICAgICAgIH0KKy0JICAgICAgICByZXR1cm4geworLQkgICAg
ICAgICAgc291cmNlOiBzb3VyY2UsCistCSAgICAgICAgICBnZW5lcmF0ZWRMaW5lOiBtYXBwaW5n
LmdlbmVyYXRlZExpbmUsCistCSAgICAgICAgICBnZW5lcmF0ZWRDb2x1bW46IG1hcHBpbmcuZ2Vu
ZXJhdGVkQ29sdW1uLAorLQkgICAgICAgICAgb3JpZ2luYWxMaW5lOiBtYXBwaW5nLm9yaWdpbmFs
TGluZSwKKy0JICAgICAgICAgIG9yaWdpbmFsQ29sdW1uOiBtYXBwaW5nLm9yaWdpbmFsQ29sdW1u
LAorLQkgICAgICAgICAgbmFtZTogbWFwcGluZy5uYW1lID09PSBudWxsID8gbnVsbCA6IHRoaXMu
X25hbWVzLmF0KG1hcHBpbmcubmFtZSkKKy0JICAgICAgICB9OworLQkgICAgICB9LCB0aGlzKS5m
b3JFYWNoKGFDYWxsYmFjaywgY29udGV4dCk7CistCSAgICB9OworLQorLQkgIC8qKgorLQkgICAq
IFJldHVybnMgYWxsIGdlbmVyYXRlZCBsaW5lIGFuZCBjb2x1bW4gaW5mb3JtYXRpb24gZm9yIHRo
ZSBvcmlnaW5hbCBzb3VyY2UsCistCSAgICogbGluZSwgYW5kIGNvbHVtbiBwcm92aWRlZC4gSWYg
bm8gY29sdW1uIGlzIHByb3ZpZGVkLCByZXR1cm5zIGFsbCBtYXBwaW5ncworLQkgICAqIGNvcnJl
c3BvbmRpbmcgdG8gYSBlaXRoZXIgdGhlIGxpbmUgd2UgYXJlIHNlYXJjaGluZyBmb3Igb3IgdGhl
IG5leHQKKy0JICAgKiBjbG9zZXN0IGxpbmUgdGhhdCBoYXMgYW55IG1hcHBpbmdzLiBPdGhlcndp
c2UsIHJldHVybnMgYWxsIG1hcHBpbmdzCistCSAgICogY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2
ZW4gbGluZSBhbmQgZWl0aGVyIHRoZSBjb2x1bW4gd2UgYXJlIHNlYXJjaGluZyBmb3IKKy0JICAg
KiBvciB0aGUgbmV4dCBjbG9zZXN0IGNvbHVtbiB0aGF0IGhhcyBhbnkgb2Zmc2V0cy4KKy0JICAg
KgorLQkgICAqIFRoZSBvbmx5IGFyZ3VtZW50IGlzIGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dp
bmcgcHJvcGVydGllczoKKy0JICAgKgorLQkgICAqICAgLSBzb3VyY2U6IFRoZSBmaWxlbmFtZSBv
ZiB0aGUgb3JpZ2luYWwgc291cmNlLgorLQkgICAqICAgLSBsaW5lOiBUaGUgbGluZSBudW1iZXIg
aW4gdGhlIG9yaWdpbmFsIHNvdXJjZS4KKy0JICAgKiAgIC0gY29sdW1uOiBPcHRpb25hbC4gdGhl
IGNvbHVtbiBudW1iZXIgaW4gdGhlIG9yaWdpbmFsIHNvdXJjZS4KKy0JICAgKgorLQkgICAqIGFu
ZCBhbiBhcnJheSBvZiBvYmplY3RzIGlzIHJldHVybmVkLCBlYWNoIHdpdGggdGhlIGZvbGxvd2lu
ZyBwcm9wZXJ0aWVzOgorLQkgICAqCistCSAgICogICAtIGxpbmU6IFRoZSBsaW5lIG51bWJlciBp
biB0aGUgZ2VuZXJhdGVkIHNvdXJjZSwgb3IgbnVsbC4KKy0JICAgKiAgIC0gY29sdW1uOiBUaGUg
Y29sdW1uIG51bWJlciBpbiB0aGUgZ2VuZXJhdGVkIHNvdXJjZSwgb3IgbnVsbC4KKy0JICAgKi8K
Ky0JICBTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUuYWxsR2VuZXJhdGVkUG9zaXRpb25zRm9y
ID0KKy0JICAgIGZ1bmN0aW9uIFNvdXJjZU1hcENvbnN1bWVyX2FsbEdlbmVyYXRlZFBvc2l0aW9u
c0ZvcihhQXJncykgeworLQkgICAgICB2YXIgbGluZSA9IHV0aWwuZ2V0QXJnKGFBcmdzLCAnbGlu
ZScpOworLQorLQkgICAgICAvLyBXaGVuIHRoZXJlIGlzIG5vIGV4YWN0IG1hdGNoLCBCYXNpY1Nv
dXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZS5fZmluZE1hcHBpbmcKKy0JICAgICAgLy8gcmV0dXJu
cyB0aGUgaW5kZXggb2YgdGhlIGNsb3Nlc3QgbWFwcGluZyBsZXNzIHRoYW4gdGhlIG5lZWRsZS4g
QnkKKy0JICAgICAgLy8gc2V0dGluZyBuZWVkbGUub3JpZ2luYWxDb2x1bW4gdG8gMCwgd2UgdGh1
cyBmaW5kIHRoZSBsYXN0IG1hcHBpbmcgZm9yCistCSAgICAgIC8vIHRoZSBnaXZlbiBsaW5lLCBw
cm92aWRlZCBzdWNoIGEgbWFwcGluZyBleGlzdHMuCistCSAgICAgIHZhciBuZWVkbGUgPSB7Cist
CSAgICAgICAgc291cmNlOiB1dGlsLmdldEFyZyhhQXJncywgJ3NvdXJjZScpLAorLQkgICAgICAg
IG9yaWdpbmFsTGluZTogbGluZSwKKy0JICAgICAgICBvcmlnaW5hbENvbHVtbjogdXRpbC5nZXRB
cmcoYUFyZ3MsICdjb2x1bW4nLCAwKQorLQkgICAgICB9OworLQorLQkgICAgICBpZiAodGhpcy5z
b3VyY2VSb290ICE9IG51bGwpIHsKKy0JICAgICAgICBuZWVkbGUuc291cmNlID0gdXRpbC5yZWxh
dGl2ZSh0aGlzLnNvdXJjZVJvb3QsIG5lZWRsZS5zb3VyY2UpOworLQkgICAgICB9CistCSAgICAg
IGlmICghdGhpcy5fc291cmNlcy5oYXMobmVlZGxlLnNvdXJjZSkpIHsKKy0JICAgICAgICByZXR1
cm4gW107CistCSAgICAgIH0KKy0JICAgICAgbmVlZGxlLnNvdXJjZSA9IHRoaXMuX3NvdXJjZXMu
aW5kZXhPZihuZWVkbGUuc291cmNlKTsKKy0KKy0JICAgICAgdmFyIG1hcHBpbmdzID0gW107Cist
CistCSAgICAgIHZhciBpbmRleCA9IHRoaXMuX2ZpbmRNYXBwaW5nKG5lZWRsZSwKKy0JICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb3JpZ2luYWxNYXBwaW5ncywKKy0J
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm9yaWdpbmFsTGluZSIsCistCSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJvcmlnaW5hbENvbHVtbiIsCistCSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0aWwuY29tcGFyZUJ5T3JpZ2luYWxQ
b3NpdGlvbnMsCistCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpbmFyeVNl
YXJjaC5MRUFTVF9VUFBFUl9CT1VORCk7CistCSAgICAgIGlmIChpbmRleCA+PSAwKSB7CistCSAg
ICAgICAgdmFyIG1hcHBpbmcgPSB0aGlzLl9vcmlnaW5hbE1hcHBpbmdzW2luZGV4XTsKKy0KKy0J
ICAgICAgICBpZiAoYUFyZ3MuY29sdW1uID09PSB1bmRlZmluZWQpIHsKKy0JICAgICAgICAgIHZh
ciBvcmlnaW5hbExpbmUgPSBtYXBwaW5nLm9yaWdpbmFsTGluZTsKKy0KKy0JICAgICAgICAgIC8v
IEl0ZXJhdGUgdW50aWwgZWl0aGVyIHdlIHJ1biBvdXQgb2YgbWFwcGluZ3MsIG9yIHdlIHJ1biBp
bnRvCistCSAgICAgICAgICAvLyBhIG1hcHBpbmcgZm9yIGEgZGlmZmVyZW50IGxpbmUgdGhhbiB0
aGUgb25lIHdlIGZvdW5kLiBTaW5jZQorLQkgICAgICAgICAgLy8gbWFwcGluZ3MgYXJlIHNvcnRl
ZCwgdGhpcyBpcyBndWFyYW50ZWVkIHRvIGZpbmQgYWxsIG1hcHBpbmdzIGZvcgorLQkgICAgICAg
ICAgLy8gdGhlIGxpbmUgd2UgZm91bmQuCistCSAgICAgICAgICB3aGlsZSAobWFwcGluZyAmJiBt
YXBwaW5nLm9yaWdpbmFsTGluZSA9PT0gb3JpZ2luYWxMaW5lKSB7CistCSAgICAgICAgICAgIG1h
cHBpbmdzLnB1c2goeworLQkgICAgICAgICAgICAgIGxpbmU6IHV0aWwuZ2V0QXJnKG1hcHBpbmcs
ICdnZW5lcmF0ZWRMaW5lJywgbnVsbCksCistCSAgICAgICAgICAgICAgY29sdW1uOiB1dGlsLmdl
dEFyZyhtYXBwaW5nLCAnZ2VuZXJhdGVkQ29sdW1uJywgbnVsbCksCistCSAgICAgICAgICAgICAg
bGFzdENvbHVtbjogdXRpbC5nZXRBcmcobWFwcGluZywgJ2xhc3RHZW5lcmF0ZWRDb2x1bW4nLCBu
dWxsKQorLQkgICAgICAgICAgICB9KTsKKy0KKy0JICAgICAgICAgICAgbWFwcGluZyA9IHRoaXMu
X29yaWdpbmFsTWFwcGluZ3NbKytpbmRleF07CistCSAgICAgICAgICB9CistCSAgICAgICAgfSBl
bHNlIHsKKy0JICAgICAgICAgIHZhciBvcmlnaW5hbENvbHVtbiA9IG1hcHBpbmcub3JpZ2luYWxD
b2x1bW47CistCistCSAgICAgICAgICAvLyBJdGVyYXRlIHVudGlsIGVpdGhlciB3ZSBydW4gb3V0
IG9mIG1hcHBpbmdzLCBvciB3ZSBydW4gaW50bworLQkgICAgICAgICAgLy8gYSBtYXBwaW5nIGZv
ciBhIGRpZmZlcmVudCBsaW5lIHRoYW4gdGhlIG9uZSB3ZSB3ZXJlIHNlYXJjaGluZyBmb3IuCist
CSAgICAgICAgICAvLyBTaW5jZSBtYXBwaW5ncyBhcmUgc29ydGVkLCB0aGlzIGlzIGd1YXJhbnRl
ZWQgdG8gZmluZCBhbGwgbWFwcGluZ3MgZm9yCistCSAgICAgICAgICAvLyB0aGUgbGluZSB3ZSBh
cmUgc2VhcmNoaW5nIGZvci4KKy0JICAgICAgICAgIHdoaWxlIChtYXBwaW5nICYmCistCSAgICAg
ICAgICAgICAgICAgbWFwcGluZy5vcmlnaW5hbExpbmUgPT09IGxpbmUgJiYKKy0JICAgICAgICAg
ICAgICAgICBtYXBwaW5nLm9yaWdpbmFsQ29sdW1uID09IG9yaWdpbmFsQ29sdW1uKSB7CistCSAg
ICAgICAgICAgIG1hcHBpbmdzLnB1c2goeworLQkgICAgICAgICAgICAgIGxpbmU6IHV0aWwuZ2V0
QXJnKG1hcHBpbmcsICdnZW5lcmF0ZWRMaW5lJywgbnVsbCksCistCSAgICAgICAgICAgICAgY29s
dW1uOiB1dGlsLmdldEFyZyhtYXBwaW5nLCAnZ2VuZXJhdGVkQ29sdW1uJywgbnVsbCksCistCSAg
ICAgICAgICAgICAgbGFzdENvbHVtbjogdXRpbC5nZXRBcmcobWFwcGluZywgJ2xhc3RHZW5lcmF0
ZWRDb2x1bW4nLCBudWxsKQorLQkgICAgICAgICAgICB9KTsKKy0KKy0JICAgICAgICAgICAgbWFw
cGluZyA9IHRoaXMuX29yaWdpbmFsTWFwcGluZ3NbKytpbmRleF07CistCSAgICAgICAgICB9Cist
CSAgICAgICAgfQorLQkgICAgICB9CistCistCSAgICAgIHJldHVybiBtYXBwaW5nczsKKy0JICAg
IH07CistCistCSAgZXhwb3J0cy5Tb3VyY2VNYXBDb25zdW1lciA9IFNvdXJjZU1hcENvbnN1bWVy
OworLQorLQkgIC8qKgorLQkgICAqIEEgQmFzaWNTb3VyY2VNYXBDb25zdW1lciBpbnN0YW5jZSBy
ZXByZXNlbnRzIGEgcGFyc2VkIHNvdXJjZSBtYXAgd2hpY2ggd2UgY2FuCistCSAgICogcXVlcnkg
Zm9yIGluZm9ybWF0aW9uIGFib3V0IHRoZSBvcmlnaW5hbCBmaWxlIHBvc2l0aW9ucyBieSBnaXZp
bmcgaXQgYSBmaWxlCistCSAgICogcG9zaXRpb24gaW4gdGhlIGdlbmVyYXRlZCBzb3VyY2UuCist
CSAgICoKKy0JICAgKiBUaGUgb25seSBwYXJhbWV0ZXIgaXMgdGhlIHJhdyBzb3VyY2UgbWFwIChl
aXRoZXIgYXMgYSBKU09OIHN0cmluZywgb3IKKy0JICAgKiBhbHJlYWR5IHBhcnNlZCB0byBhbiBv
YmplY3QpLiBBY2NvcmRpbmcgdG8gdGhlIHNwZWMsIHNvdXJjZSBtYXBzIGhhdmUgdGhlCistCSAg
ICogZm9sbG93aW5nIGF0dHJpYnV0ZXM6CistCSAgICoKKy0JICAgKiAgIC0gdmVyc2lvbjogV2hp
Y2ggdmVyc2lvbiBvZiB0aGUgc291cmNlIG1hcCBzcGVjIHRoaXMgbWFwIGlzIGZvbGxvd2luZy4K
Ky0JICAgKiAgIC0gc291cmNlczogQW4gYXJyYXkgb2YgVVJMcyB0byB0aGUgb3JpZ2luYWwgc291
cmNlIGZpbGVzLgorLQkgICAqICAgLSBuYW1lczogQW4gYXJyYXkgb2YgaWRlbnRpZmllcnMgd2hp
Y2ggY2FuIGJlIHJlZmVycmVuY2VkIGJ5IGluZGl2aWR1YWwgbWFwcGluZ3MuCistCSAgICogICAt
IHNvdXJjZVJvb3Q6IE9wdGlvbmFsLiBUaGUgVVJMIHJvb3QgZnJvbSB3aGljaCBhbGwgc291cmNl
cyBhcmUgcmVsYXRpdmUuCistCSAgICogICAtIHNvdXJjZXNDb250ZW50OiBPcHRpb25hbC4gQW4g
YXJyYXkgb2YgY29udGVudHMgb2YgdGhlIG9yaWdpbmFsIHNvdXJjZSBmaWxlcy4KKy0JICAgKiAg
IC0gbWFwcGluZ3M6IEEgc3RyaW5nIG9mIGJhc2U2NCBWTFFzIHdoaWNoIGNvbnRhaW4gdGhlIGFj
dHVhbCBtYXBwaW5ncy4KKy0JICAgKiAgIC0gZmlsZTogT3B0aW9uYWwuIFRoZSBnZW5lcmF0ZWQg
ZmlsZSB0aGlzIHNvdXJjZSBtYXAgaXMgYXNzb2NpYXRlZCB3aXRoLgorLQkgICAqCistCSAgICog
SGVyZSBpcyBhbiBleGFtcGxlIHNvdXJjZSBtYXAsIHRha2VuIGZyb20gdGhlIHNvdXJjZSBtYXAg
c3BlY1swXToKKy0JICAgKgorLQkgICAqICAgICB7CistCSAgICogICAgICAgdmVyc2lvbiA6IDMs
CistCSAgICogICAgICAgZmlsZTogIm91dC5qcyIsCistCSAgICogICAgICAgc291cmNlUm9vdCA6
ICIiLAorLQkgICAqICAgICAgIHNvdXJjZXM6IFsiZm9vLmpzIiwgImJhci5qcyJdLAorLQkgICAq
ICAgICAgIG5hbWVzOiBbInNyYyIsICJtYXBzIiwgImFyZSIsICJmdW4iXSwKKy0JICAgKiAgICAg
ICBtYXBwaW5nczogIkFBLEFCOztBQkNERTsiCistCSAgICogICAgIH0KKy0JICAgKgorLQkgICAq
IFswXTogaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZG9jdW1lbnQvZC8xVTFSR0FlaFF3UnlwVVRv
dkYxS1JscGlPRnplMGItXzJnYzZmQUgwS1kway9lZGl0P3BsaT0xIworLQkgICAqLworLQkgIGZ1
bmN0aW9uIEJhc2ljU291cmNlTWFwQ29uc3VtZXIoYVNvdXJjZU1hcCkgeworLQkgICAgdmFyIHNv
dXJjZU1hcCA9IGFTb3VyY2VNYXA7CistCSAgICBpZiAodHlwZW9mIGFTb3VyY2VNYXAgPT09ICdz
dHJpbmcnKSB7CistCSAgICAgIHNvdXJjZU1hcCA9IEpTT04ucGFyc2UoYVNvdXJjZU1hcC5yZXBs
YWNlKC9eXClcXVx9Jy8sICcnKSk7CistCSAgICB9CistCistCSAgICB2YXIgdmVyc2lvbiA9IHV0
aWwuZ2V0QXJnKHNvdXJjZU1hcCwgJ3ZlcnNpb24nKTsKKy0JICAgIHZhciBzb3VyY2VzID0gdXRp
bC5nZXRBcmcoc291cmNlTWFwLCAnc291cmNlcycpOworLQkgICAgLy8gU2FzcyAzLjMgbGVhdmVz
IG91dCB0aGUgJ25hbWVzJyBhcnJheSwgc28gd2UgZGV2aWF0ZSBmcm9tIHRoZSBzcGVjICh3aGlj
aAorLQkgICAgLy8gcmVxdWlyZXMgdGhlIGFycmF5KSB0byBwbGF5IG5pY2UgaGVyZS4KKy0JICAg
IHZhciBuYW1lcyA9IHV0aWwuZ2V0QXJnKHNvdXJjZU1hcCwgJ25hbWVzJywgW10pOworLQkgICAg
dmFyIHNvdXJjZVJvb3QgPSB1dGlsLmdldEFyZyhzb3VyY2VNYXAsICdzb3VyY2VSb290JywgbnVs
bCk7CistCSAgICB2YXIgc291cmNlc0NvbnRlbnQgPSB1dGlsLmdldEFyZyhzb3VyY2VNYXAsICdz
b3VyY2VzQ29udGVudCcsIG51bGwpOworLQkgICAgdmFyIG1hcHBpbmdzID0gdXRpbC5nZXRBcmco
c291cmNlTWFwLCAnbWFwcGluZ3MnKTsKKy0JICAgIHZhciBmaWxlID0gdXRpbC5nZXRBcmcoc291
cmNlTWFwLCAnZmlsZScsIG51bGwpOworLQorLQkgICAgLy8gT25jZSBhZ2FpbiwgU2FzcyBkZXZp
YXRlcyBmcm9tIHRoZSBzcGVjIGFuZCBzdXBwbGllcyB0aGUgdmVyc2lvbiBhcyBhCistCSAgICAv
LyBzdHJpbmcgcmF0aGVyIHRoYW4gYSBudW1iZXIsIHNvIHdlIHVzZSBsb29zZSBlcXVhbGl0eSBj
aGVja2luZyBoZXJlLgorLQkgICAgaWYgKHZlcnNpb24gIT0gdGhpcy5fdmVyc2lvbikgeworLQkg
ICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vuc3VwcG9ydGVkIHZlcnNpb246ICcgKyB2ZXJzaW9uKTsK
Ky0JICAgIH0KKy0KKy0JICAgIHNvdXJjZXMgPSBzb3VyY2VzCistCSAgICAgIC8vIFNvbWUgc291
cmNlIG1hcHMgcHJvZHVjZSByZWxhdGl2ZSBzb3VyY2UgcGF0aHMgbGlrZSAiLi9mb28uanMiIGlu
c3RlYWQgb2YKKy0JICAgICAgLy8gImZvby5qcyIuICBOb3JtYWxpemUgdGhlc2UgZmlyc3Qgc28g
dGhhdCBmdXR1cmUgY29tcGFyaXNvbnMgd2lsbCBzdWNjZWVkLgorLQkgICAgICAvLyBTZWUgYnVn
emlsLmxhLzEwOTA3NjguCistCSAgICAgIC5tYXAodXRpbC5ub3JtYWxpemUpCistCSAgICAgIC8v
IEFsd2F5cyBlbnN1cmUgdGhhdCBhYnNvbHV0ZSBzb3VyY2VzIGFyZSBpbnRlcm5hbGx5IHN0b3Jl
ZCByZWxhdGl2ZSB0bworLQkgICAgICAvLyB0aGUgc291cmNlIHJvb3QsIGlmIHRoZSBzb3VyY2Ug
cm9vdCBpcyBhYnNvbHV0ZS4gTm90IGRvaW5nIHRoaXMgd291bGQKKy0JICAgICAgLy8gYmUgcGFy
dGljdWxhcmx5IHByb2JsZW1hdGljIHdoZW4gdGhlIHNvdXJjZSByb290IGlzIGEgcHJlZml4IG9m
IHRoZQorLQkgICAgICAvLyBzb3VyY2UgKHZhbGlkLCBidXQgd2h5Pz8pLiBTZWUgZ2l0aHViIGlz
c3VlICMxOTkgYW5kIGJ1Z3ppbC5sYS8xMTg4OTgyLgorLQkgICAgICAubWFwKGZ1bmN0aW9uIChz
b3VyY2UpIHsKKy0JICAgICAgICByZXR1cm4gc291cmNlUm9vdCAmJiB1dGlsLmlzQWJzb2x1dGUo
c291cmNlUm9vdCkgJiYgdXRpbC5pc0Fic29sdXRlKHNvdXJjZSkKKy0JICAgICAgICAgID8gdXRp
bC5yZWxhdGl2ZShzb3VyY2VSb290LCBzb3VyY2UpCistCSAgICAgICAgICA6IHNvdXJjZTsKKy0J
ICAgICAgfSk7CistCistCSAgICAvLyBQYXNzIGB0cnVlYCBiZWxvdyB0byBhbGxvdyBkdXBsaWNh
dGUgbmFtZXMgYW5kIHNvdXJjZXMuIFdoaWxlIHNvdXJjZSBtYXBzCistCSAgICAvLyBhcmUgaW50
ZW5kZWQgdG8gYmUgY29tcHJlc3NlZCBhbmQgZGVkdXBsaWNhdGVkLCB0aGUgVHlwZVNjcmlwdCBj
b21waWxlcgorLQkgICAgLy8gc29tZXRpbWVzIGdlbmVyYXRlcyBzb3VyY2UgbWFwcyB3aXRoIGR1
cGxpY2F0ZXMgaW4gdGhlbS4gU2VlIEdpdGh1YiBpc3N1ZQorLQkgICAgLy8gIzcyIGFuZCBidWd6
aWwubGEvODg5NDkyLgorLQkgICAgdGhpcy5fbmFtZXMgPSBBcnJheVNldC5mcm9tQXJyYXkobmFt
ZXMsIHRydWUpOworLQkgICAgdGhpcy5fc291cmNlcyA9IEFycmF5U2V0LmZyb21BcnJheShzb3Vy
Y2VzLCB0cnVlKTsKKy0KKy0JICAgIHRoaXMuc291cmNlUm9vdCA9IHNvdXJjZVJvb3Q7CistCSAg
ICB0aGlzLnNvdXJjZXNDb250ZW50ID0gc291cmNlc0NvbnRlbnQ7CistCSAgICB0aGlzLl9tYXBw
aW5ncyA9IG1hcHBpbmdzOworLQkgICAgdGhpcy5maWxlID0gZmlsZTsKKy0JICB9CistCistCSAg
QmFzaWNTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFNvdXJjZU1h
cENvbnN1bWVyLnByb3RvdHlwZSk7CistCSAgQmFzaWNTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5
cGUuY29uc3VtZXIgPSBTb3VyY2VNYXBDb25zdW1lcjsKKy0KKy0JICAvKioKKy0JICAgKiBDcmVh
dGUgYSBCYXNpY1NvdXJjZU1hcENvbnN1bWVyIGZyb20gYSBTb3VyY2VNYXBHZW5lcmF0b3IuCist
CSAgICoKKy0JICAgKiBAcGFyYW0gU291cmNlTWFwR2VuZXJhdG9yIGFTb3VyY2VNYXAKKy0JICAg
KiAgICAgICAgVGhlIHNvdXJjZSBtYXAgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLgorLQkgICAqIEBy
ZXR1cm5zIEJhc2ljU291cmNlTWFwQ29uc3VtZXIKKy0JICAgKi8KKy0JICBCYXNpY1NvdXJjZU1h
cENvbnN1bWVyLmZyb21Tb3VyY2VNYXAgPQorLQkgICAgZnVuY3Rpb24gU291cmNlTWFwQ29uc3Vt
ZXJfZnJvbVNvdXJjZU1hcChhU291cmNlTWFwKSB7CistCSAgICAgIHZhciBzbWMgPSBPYmplY3Qu
Y3JlYXRlKEJhc2ljU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlKTsKKy0KKy0JICAgICAgdmFy
IG5hbWVzID0gc21jLl9uYW1lcyA9IEFycmF5U2V0LmZyb21BcnJheShhU291cmNlTWFwLl9uYW1l
cy50b0FycmF5KCksIHRydWUpOworLQkgICAgICB2YXIgc291cmNlcyA9IHNtYy5fc291cmNlcyA9
IEFycmF5U2V0LmZyb21BcnJheShhU291cmNlTWFwLl9zb3VyY2VzLnRvQXJyYXkoKSwgdHJ1ZSk7
CistCSAgICAgIHNtYy5zb3VyY2VSb290ID0gYVNvdXJjZU1hcC5fc291cmNlUm9vdDsKKy0JICAg
ICAgc21jLnNvdXJjZXNDb250ZW50ID0gYVNvdXJjZU1hcC5fZ2VuZXJhdGVTb3VyY2VzQ29udGVu
dChzbWMuX3NvdXJjZXMudG9BcnJheSgpLAorLQkgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNtYy5zb3VyY2VSb290KTsKKy0JICAg
ICAgc21jLmZpbGUgPSBhU291cmNlTWFwLl9maWxlOworLQorLQkgICAgICAvLyBCZWNhdXNlIHdl
IGFyZSBtb2RpZnlpbmcgdGhlIGVudHJpZXMgKGJ5IGNvbnZlcnRpbmcgc3RyaW5nIHNvdXJjZXMg
YW5kCistCSAgICAgIC8vIG5hbWVzIHRvIGluZGljZXMgaW50byB0aGUgc291cmNlcyBhbmQgbmFt
ZXMgQXJyYXlTZXRzKSwgd2UgaGF2ZSB0byBtYWtlCistCSAgICAgIC8vIGEgY29weSBvZiB0aGUg
ZW50cnkgb3IgZWxzZSBiYWQgdGhpbmdzIGhhcHBlbi4gU2hhcmVkIG11dGFibGUgc3RhdGUKKy0J
ICAgICAgLy8gc3RyaWtlcyBhZ2FpbiEgU2VlIGdpdGh1YiBpc3N1ZSAjMTkxLgorLQorLQkgICAg
ICB2YXIgZ2VuZXJhdGVkTWFwcGluZ3MgPSBhU291cmNlTWFwLl9tYXBwaW5ncy50b0FycmF5KCku
c2xpY2UoKTsKKy0JICAgICAgdmFyIGRlc3RHZW5lcmF0ZWRNYXBwaW5ncyA9IHNtYy5fX2dlbmVy
YXRlZE1hcHBpbmdzID0gW107CistCSAgICAgIHZhciBkZXN0T3JpZ2luYWxNYXBwaW5ncyA9IHNt
Yy5fX29yaWdpbmFsTWFwcGluZ3MgPSBbXTsKKy0KKy0JICAgICAgZm9yICh2YXIgaSA9IDAsIGxl
bmd0aCA9IGdlbmVyYXRlZE1hcHBpbmdzLmxlbmd0aDsgaSA8IGxlbmd0aDsgaSsrKSB7CistCSAg
ICAgICAgdmFyIHNyY01hcHBpbmcgPSBnZW5lcmF0ZWRNYXBwaW5nc1tpXTsKKy0JICAgICAgICB2
YXIgZGVzdE1hcHBpbmcgPSBuZXcgTWFwcGluZzsKKy0JICAgICAgICBkZXN0TWFwcGluZy5nZW5l
cmF0ZWRMaW5lID0gc3JjTWFwcGluZy5nZW5lcmF0ZWRMaW5lOworLQkgICAgICAgIGRlc3RNYXBw
aW5nLmdlbmVyYXRlZENvbHVtbiA9IHNyY01hcHBpbmcuZ2VuZXJhdGVkQ29sdW1uOworLQorLQkg
ICAgICAgIGlmIChzcmNNYXBwaW5nLnNvdXJjZSkgeworLQkgICAgICAgICAgZGVzdE1hcHBpbmcu
c291cmNlID0gc291cmNlcy5pbmRleE9mKHNyY01hcHBpbmcuc291cmNlKTsKKy0JICAgICAgICAg
IGRlc3RNYXBwaW5nLm9yaWdpbmFsTGluZSA9IHNyY01hcHBpbmcub3JpZ2luYWxMaW5lOworLQkg
ICAgICAgICAgZGVzdE1hcHBpbmcub3JpZ2luYWxDb2x1bW4gPSBzcmNNYXBwaW5nLm9yaWdpbmFs
Q29sdW1uOworLQorLQkgICAgICAgICAgaWYgKHNyY01hcHBpbmcubmFtZSkgeworLQkgICAgICAg
ICAgICBkZXN0TWFwcGluZy5uYW1lID0gbmFtZXMuaW5kZXhPZihzcmNNYXBwaW5nLm5hbWUpOwor
LQkgICAgICAgICAgfQorLQorLQkgICAgICAgICAgZGVzdE9yaWdpbmFsTWFwcGluZ3MucHVzaChk
ZXN0TWFwcGluZyk7CistCSAgICAgICAgfQorLQorLQkgICAgICAgIGRlc3RHZW5lcmF0ZWRNYXBw
aW5ncy5wdXNoKGRlc3RNYXBwaW5nKTsKKy0JICAgICAgfQorLQorLQkgICAgICBxdWlja1NvcnQo
c21jLl9fb3JpZ2luYWxNYXBwaW5ncywgdXRpbC5jb21wYXJlQnlPcmlnaW5hbFBvc2l0aW9ucyk7
CistCistCSAgICAgIHJldHVybiBzbWM7CistCSAgICB9OworLQorLQkgIC8qKgorLQkgICAqIFRo
ZSB2ZXJzaW9uIG9mIHRoZSBzb3VyY2UgbWFwcGluZyBzcGVjIHRoYXQgd2UgYXJlIGNvbnN1bWlu
Zy4KKy0JICAgKi8KKy0JICBCYXNpY1NvdXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZS5fdmVyc2lv
biA9IDM7CistCistCSAgLyoqCistCSAgICogVGhlIGxpc3Qgb2Ygb3JpZ2luYWwgc291cmNlcy4K
Ky0JICAgKi8KKy0JICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFzaWNTb3VyY2VNYXBDb25zdW1l
ci5wcm90b3R5cGUsICdzb3VyY2VzJywgeworLQkgICAgZ2V0OiBmdW5jdGlvbiAoKSB7CistCSAg
ICAgIHJldHVybiB0aGlzLl9zb3VyY2VzLnRvQXJyYXkoKS5tYXAoZnVuY3Rpb24gKHMpIHsKKy0J
ICAgICAgICByZXR1cm4gdGhpcy5zb3VyY2VSb290ICE9IG51bGwgPyB1dGlsLmpvaW4odGhpcy5z
b3VyY2VSb290LCBzKSA6IHM7CistCSAgICAgIH0sIHRoaXMpOworLQkgICAgfQorLQkgIH0pOwor
LQorLQkgIC8qKgorLQkgICAqIFByb3ZpZGUgdGhlIEpJVCB3aXRoIGEgbmljZSBzaGFwZSAvIGhp
ZGRlbiBjbGFzcy4KKy0JICAgKi8KKy0JICBmdW5jdGlvbiBNYXBwaW5nKCkgeworLQkgICAgdGhp
cy5nZW5lcmF0ZWRMaW5lID0gMDsKKy0JICAgIHRoaXMuZ2VuZXJhdGVkQ29sdW1uID0gMDsKKy0J
ICAgIHRoaXMuc291cmNlID0gbnVsbDsKKy0JICAgIHRoaXMub3JpZ2luYWxMaW5lID0gbnVsbDsK
Ky0JICAgIHRoaXMub3JpZ2luYWxDb2x1bW4gPSBudWxsOworLQkgICAgdGhpcy5uYW1lID0gbnVs
bDsKKy0JICB9CistCistCSAgLyoqCistCSAgICogUGFyc2UgdGhlIG1hcHBpbmdzIGluIGEgc3Ry
aW5nIGluIHRvIGEgZGF0YSBzdHJ1Y3R1cmUgd2hpY2ggd2UgY2FuIGVhc2lseQorLQkgICAqIHF1
ZXJ5ICh0aGUgb3JkZXJlZCBhcnJheXMgaW4gdGhlIGB0aGlzLl9fZ2VuZXJhdGVkTWFwcGluZ3Ng
IGFuZAorLQkgICAqIGB0aGlzLl9fb3JpZ2luYWxNYXBwaW5nc2AgcHJvcGVydGllcykuCistCSAg
ICovCistCSAgQmFzaWNTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUuX3BhcnNlTWFwcGluZ3Mg
PQorLQkgICAgZnVuY3Rpb24gU291cmNlTWFwQ29uc3VtZXJfcGFyc2VNYXBwaW5ncyhhU3RyLCBh
U291cmNlUm9vdCkgeworLQkgICAgICB2YXIgZ2VuZXJhdGVkTGluZSA9IDE7CistCSAgICAgIHZh
ciBwcmV2aW91c0dlbmVyYXRlZENvbHVtbiA9IDA7CistCSAgICAgIHZhciBwcmV2aW91c09yaWdp
bmFsTGluZSA9IDA7CistCSAgICAgIHZhciBwcmV2aW91c09yaWdpbmFsQ29sdW1uID0gMDsKKy0J
ICAgICAgdmFyIHByZXZpb3VzU291cmNlID0gMDsKKy0JICAgICAgdmFyIHByZXZpb3VzTmFtZSA9
IDA7CistCSAgICAgIHZhciBsZW5ndGggPSBhU3RyLmxlbmd0aDsKKy0JICAgICAgdmFyIGluZGV4
ID0gMDsKKy0JICAgICAgdmFyIGNhY2hlZFNlZ21lbnRzID0ge307CistCSAgICAgIHZhciB0ZW1w
ID0ge307CistCSAgICAgIHZhciBvcmlnaW5hbE1hcHBpbmdzID0gW107CistCSAgICAgIHZhciBn
ZW5lcmF0ZWRNYXBwaW5ncyA9IFtdOworLQkgICAgICB2YXIgbWFwcGluZywgc3RyLCBzZWdtZW50
LCBlbmQsIHZhbHVlOworLQorLQkgICAgICB3aGlsZSAoaW5kZXggPCBsZW5ndGgpIHsKKy0JICAg
ICAgICBpZiAoYVN0ci5jaGFyQXQoaW5kZXgpID09PSAnOycpIHsKKy0JICAgICAgICAgIGdlbmVy
YXRlZExpbmUrKzsKKy0JICAgICAgICAgIGluZGV4Kys7CistCSAgICAgICAgICBwcmV2aW91c0dl
bmVyYXRlZENvbHVtbiA9IDA7CistCSAgICAgICAgfQorLQkgICAgICAgIGVsc2UgaWYgKGFTdHIu
Y2hhckF0KGluZGV4KSA9PT0gJywnKSB7CistCSAgICAgICAgICBpbmRleCsrOworLQkgICAgICAg
IH0KKy0JICAgICAgICBlbHNlIHsKKy0JICAgICAgICAgIG1hcHBpbmcgPSBuZXcgTWFwcGluZygp
OworLQkgICAgICAgICAgbWFwcGluZy5nZW5lcmF0ZWRMaW5lID0gZ2VuZXJhdGVkTGluZTsKKy0K
Ky0JICAgICAgICAgIC8vIEJlY2F1c2UgZWFjaCBvZmZzZXQgaXMgZW5jb2RlZCByZWxhdGl2ZSB0
byB0aGUgcHJldmlvdXMgb25lLAorLQkgICAgICAgICAgLy8gbWFueSBzZWdtZW50cyBvZnRlbiBo
YXZlIHRoZSBzYW1lIGVuY29kaW5nLiBXZSBjYW4gZXhwbG9pdCB0aGlzCistCSAgICAgICAgICAv
LyBmYWN0IGJ5IGNhY2hpbmcgdGhlIHBhcnNlZCB2YXJpYWJsZSBsZW5ndGggZmllbGRzIG9mIGVh
Y2ggc2VnbWVudCwKKy0JICAgICAgICAgIC8vIGFsbG93aW5nIHVzIHRvIGF2b2lkIGEgc2Vjb25k
IHBhcnNlIGlmIHdlIGVuY291bnRlciB0aGUgc2FtZQorLQkgICAgICAgICAgLy8gc2VnbWVudCBh
Z2Fpbi4KKy0JICAgICAgICAgIGZvciAoZW5kID0gaW5kZXg7IGVuZCA8IGxlbmd0aDsgZW5kKysp
IHsKKy0JICAgICAgICAgICAgaWYgKHRoaXMuX2NoYXJJc01hcHBpbmdTZXBhcmF0b3IoYVN0ciwg
ZW5kKSkgeworLQkgICAgICAgICAgICAgIGJyZWFrOworLQkgICAgICAgICAgICB9CistCSAgICAg
ICAgICB9CistCSAgICAgICAgICBzdHIgPSBhU3RyLnNsaWNlKGluZGV4LCBlbmQpOworLQorLQkg
ICAgICAgICAgc2VnbWVudCA9IGNhY2hlZFNlZ21lbnRzW3N0cl07CistCSAgICAgICAgICBpZiAo
c2VnbWVudCkgeworLQkgICAgICAgICAgICBpbmRleCArPSBzdHIubGVuZ3RoOworLQkgICAgICAg
ICAgfSBlbHNlIHsKKy0JICAgICAgICAgICAgc2VnbWVudCA9IFtdOworLQkgICAgICAgICAgICB3
aGlsZSAoaW5kZXggPCBlbmQpIHsKKy0JICAgICAgICAgICAgICBiYXNlNjRWTFEuZGVjb2RlKGFT
dHIsIGluZGV4LCB0ZW1wKTsKKy0JICAgICAgICAgICAgICB2YWx1ZSA9IHRlbXAudmFsdWU7Cist
CSAgICAgICAgICAgICAgaW5kZXggPSB0ZW1wLnJlc3Q7CistCSAgICAgICAgICAgICAgc2VnbWVu
dC5wdXNoKHZhbHVlKTsKKy0JICAgICAgICAgICAgfQorLQorLQkgICAgICAgICAgICBpZiAoc2Vn
bWVudC5sZW5ndGggPT09IDIpIHsKKy0JICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Zv
dW5kIGEgc291cmNlLCBidXQgbm8gbGluZSBhbmQgY29sdW1uJyk7CistCSAgICAgICAgICAgIH0K
Ky0KKy0JICAgICAgICAgICAgaWYgKHNlZ21lbnQubGVuZ3RoID09PSAzKSB7CistCSAgICAgICAg
ICAgICAgdGhyb3cgbmV3IEVycm9yKCdGb3VuZCBhIHNvdXJjZSBhbmQgbGluZSwgYnV0IG5vIGNv
bHVtbicpOworLQkgICAgICAgICAgICB9CistCistCSAgICAgICAgICAgIGNhY2hlZFNlZ21lbnRz
W3N0cl0gPSBzZWdtZW50OworLQkgICAgICAgICAgfQorLQorLQkgICAgICAgICAgLy8gR2VuZXJh
dGVkIGNvbHVtbi4KKy0JICAgICAgICAgIG1hcHBpbmcuZ2VuZXJhdGVkQ29sdW1uID0gcHJldmlv
dXNHZW5lcmF0ZWRDb2x1bW4gKyBzZWdtZW50WzBdOworLQkgICAgICAgICAgcHJldmlvdXNHZW5l
cmF0ZWRDb2x1bW4gPSBtYXBwaW5nLmdlbmVyYXRlZENvbHVtbjsKKy0KKy0JICAgICAgICAgIGlm
IChzZWdtZW50Lmxlbmd0aCA+IDEpIHsKKy0JICAgICAgICAgICAgLy8gT3JpZ2luYWwgc291cmNl
LgorLQkgICAgICAgICAgICBtYXBwaW5nLnNvdXJjZSA9IHByZXZpb3VzU291cmNlICsgc2VnbWVu
dFsxXTsKKy0JICAgICAgICAgICAgcHJldmlvdXNTb3VyY2UgKz0gc2VnbWVudFsxXTsKKy0KKy0J
ICAgICAgICAgICAgLy8gT3JpZ2luYWwgbGluZS4KKy0JICAgICAgICAgICAgbWFwcGluZy5vcmln
aW5hbExpbmUgPSBwcmV2aW91c09yaWdpbmFsTGluZSArIHNlZ21lbnRbMl07CistCSAgICAgICAg
ICAgIHByZXZpb3VzT3JpZ2luYWxMaW5lID0gbWFwcGluZy5vcmlnaW5hbExpbmU7CistCSAgICAg
ICAgICAgIC8vIExpbmVzIGFyZSBzdG9yZWQgMC1iYXNlZAorLQkgICAgICAgICAgICBtYXBwaW5n
Lm9yaWdpbmFsTGluZSArPSAxOworLQorLQkgICAgICAgICAgICAvLyBPcmlnaW5hbCBjb2x1bW4u
CistCSAgICAgICAgICAgIG1hcHBpbmcub3JpZ2luYWxDb2x1bW4gPSBwcmV2aW91c09yaWdpbmFs
Q29sdW1uICsgc2VnbWVudFszXTsKKy0JICAgICAgICAgICAgcHJldmlvdXNPcmlnaW5hbENvbHVt
biA9IG1hcHBpbmcub3JpZ2luYWxDb2x1bW47CistCistCSAgICAgICAgICAgIGlmIChzZWdtZW50
Lmxlbmd0aCA+IDQpIHsKKy0JICAgICAgICAgICAgICAvLyBPcmlnaW5hbCBuYW1lLgorLQkgICAg
ICAgICAgICAgIG1hcHBpbmcubmFtZSA9IHByZXZpb3VzTmFtZSArIHNlZ21lbnRbNF07CistCSAg
ICAgICAgICAgICAgcHJldmlvdXNOYW1lICs9IHNlZ21lbnRbNF07CistCSAgICAgICAgICAgIH0K
Ky0JICAgICAgICAgIH0KKy0KKy0JICAgICAgICAgIGdlbmVyYXRlZE1hcHBpbmdzLnB1c2gobWFw
cGluZyk7CistCSAgICAgICAgICBpZiAodHlwZW9mIG1hcHBpbmcub3JpZ2luYWxMaW5lID09PSAn
bnVtYmVyJykgeworLQkgICAgICAgICAgICBvcmlnaW5hbE1hcHBpbmdzLnB1c2gobWFwcGluZyk7
CistCSAgICAgICAgICB9CistCSAgICAgICAgfQorLQkgICAgICB9CistCistCSAgICAgIHF1aWNr
U29ydChnZW5lcmF0ZWRNYXBwaW5ncywgdXRpbC5jb21wYXJlQnlHZW5lcmF0ZWRQb3NpdGlvbnNE
ZWZsYXRlZCk7CistCSAgICAgIHRoaXMuX19nZW5lcmF0ZWRNYXBwaW5ncyA9IGdlbmVyYXRlZE1h
cHBpbmdzOworLQorLQkgICAgICBxdWlja1NvcnQob3JpZ2luYWxNYXBwaW5ncywgdXRpbC5jb21w
YXJlQnlPcmlnaW5hbFBvc2l0aW9ucyk7CistCSAgICAgIHRoaXMuX19vcmlnaW5hbE1hcHBpbmdz
ID0gb3JpZ2luYWxNYXBwaW5nczsKKy0JICAgIH07CistCistCSAgLyoqCistCSAgICogRmluZCB0
aGUgbWFwcGluZyB0aGF0IGJlc3QgbWF0Y2hlcyB0aGUgaHlwb3RoZXRpY2FsICJuZWVkbGUiIG1h
cHBpbmcgdGhhdAorLQkgICAqIHdlIGFyZSBzZWFyY2hpbmcgZm9yIGluIHRoZSBnaXZlbiAiaGF5
c3RhY2siIG9mIG1hcHBpbmdzLgorLQkgICAqLworLQkgIEJhc2ljU291cmNlTWFwQ29uc3VtZXIu
cHJvdG90eXBlLl9maW5kTWFwcGluZyA9CistCSAgICBmdW5jdGlvbiBTb3VyY2VNYXBDb25zdW1l
cl9maW5kTWFwcGluZyhhTmVlZGxlLCBhTWFwcGluZ3MsIGFMaW5lTmFtZSwKKy0JICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFDb2x1bW5OYW1lLCBhQ29tcGFyYXRv
ciwgYUJpYXMpIHsKKy0JICAgICAgLy8gVG8gcmV0dXJuIHRoZSBwb3NpdGlvbiB3ZSBhcmUgc2Vh
cmNoaW5nIGZvciwgd2UgbXVzdCBmaXJzdCBmaW5kIHRoZQorLQkgICAgICAvLyBtYXBwaW5nIGZv
ciB0aGUgZ2l2ZW4gcG9zaXRpb24gYW5kIHRoZW4gcmV0dXJuIHRoZSBvcHBvc2l0ZSBwb3NpdGlv
biBpdAorLQkgICAgICAvLyBwb2ludHMgdG8uIEJlY2F1c2UgdGhlIG1hcHBpbmdzIGFyZSBzb3J0
ZWQsIHdlIGNhbiB1c2UgYmluYXJ5IHNlYXJjaCB0bworLQkgICAgICAvLyBmaW5kIHRoZSBiZXN0
IG1hcHBpbmcuCistCistCSAgICAgIGlmIChhTmVlZGxlW2FMaW5lTmFtZV0gPD0gMCkgeworLQkg
ICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0xpbmUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3Ig
ZXF1YWwgdG8gMSwgZ290ICcKKy0JICAgICAgICAgICAgICAgICAgICAgICAgICAgICsgYU5lZWRs
ZVthTGluZU5hbWVdKTsKKy0JICAgICAgfQorLQkgICAgICBpZiAoYU5lZWRsZVthQ29sdW1uTmFt
ZV0gPCAwKSB7CistCSAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ29sdW1uIG11c3QgYmUg
Z3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIDAsIGdvdCAnCistCSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICArIGFOZWVkbGVbYUNvbHVtbk5hbWVdKTsKKy0JICAgICAgfQorLQorLQkgICAgICBy
ZXR1cm4gYmluYXJ5U2VhcmNoLnNlYXJjaChhTmVlZGxlLCBhTWFwcGluZ3MsIGFDb21wYXJhdG9y
LCBhQmlhcyk7CistCSAgICB9OworLQorLQkgIC8qKgorLQkgICAqIENvbXB1dGUgdGhlIGxhc3Qg
Y29sdW1uIGZvciBlYWNoIGdlbmVyYXRlZCBtYXBwaW5nLiBUaGUgbGFzdCBjb2x1bW4gaXMKKy0J
ICAgKiBpbmNsdXNpdmUuCistCSAgICovCistCSAgQmFzaWNTb3VyY2VNYXBDb25zdW1lci5wcm90
b3R5cGUuY29tcHV0ZUNvbHVtblNwYW5zID0KKy0JICAgIGZ1bmN0aW9uIFNvdXJjZU1hcENvbnN1
bWVyX2NvbXB1dGVDb2x1bW5TcGFucygpIHsKKy0JICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBp
bmRleCA8IHRoaXMuX2dlbmVyYXRlZE1hcHBpbmdzLmxlbmd0aDsgKytpbmRleCkgeworLQkgICAg
ICAgIHZhciBtYXBwaW5nID0gdGhpcy5fZ2VuZXJhdGVkTWFwcGluZ3NbaW5kZXhdOworLQorLQkg
ICAgICAgIC8vIE1hcHBpbmdzIGRvIG5vdCBjb250YWluIGEgZmllbGQgZm9yIHRoZSBsYXN0IGdl
bmVyYXRlZCBjb2x1bW50LiBXZQorLQkgICAgICAgIC8vIGNhbiBjb21lIHVwIHdpdGggYW4gb3B0
aW1pc3RpYyBlc3RpbWF0ZSwgaG93ZXZlciwgYnkgYXNzdW1pbmcgdGhhdAorLQkgICAgICAgIC8v
IG1hcHBpbmdzIGFyZSBjb250aWd1b3VzIChpLmUuIGdpdmVuIHR3byBjb25zZWN1dGl2ZSBtYXBw
aW5ncywgdGhlCistCSAgICAgICAgLy8gZmlyc3QgbWFwcGluZyBlbmRzIHdoZXJlIHRoZSBzZWNv
bmQgb25lIHN0YXJ0cykuCistCSAgICAgICAgaWYgKGluZGV4ICsgMSA8IHRoaXMuX2dlbmVyYXRl
ZE1hcHBpbmdzLmxlbmd0aCkgeworLQkgICAgICAgICAgdmFyIG5leHRNYXBwaW5nID0gdGhpcy5f
Z2VuZXJhdGVkTWFwcGluZ3NbaW5kZXggKyAxXTsKKy0KKy0JICAgICAgICAgIGlmIChtYXBwaW5n
LmdlbmVyYXRlZExpbmUgPT09IG5leHRNYXBwaW5nLmdlbmVyYXRlZExpbmUpIHsKKy0JICAgICAg
ICAgICAgbWFwcGluZy5sYXN0R2VuZXJhdGVkQ29sdW1uID0gbmV4dE1hcHBpbmcuZ2VuZXJhdGVk
Q29sdW1uIC0gMTsKKy0JICAgICAgICAgICAgY29udGludWU7CistCSAgICAgICAgICB9CistCSAg
ICAgICAgfQorLQorLQkgICAgICAgIC8vIFRoZSBsYXN0IG1hcHBpbmcgZm9yIGVhY2ggbGluZSBz
cGFucyB0aGUgZW50aXJlIGxpbmUuCistCSAgICAgICAgbWFwcGluZy5sYXN0R2VuZXJhdGVkQ29s
dW1uID0gSW5maW5pdHk7CistCSAgICAgIH0KKy0JICAgIH07CistCistCSAgLyoqCistCSAgICog
UmV0dXJucyB0aGUgb3JpZ2luYWwgc291cmNlLCBsaW5lLCBhbmQgY29sdW1uIGluZm9ybWF0aW9u
IGZvciB0aGUgZ2VuZXJhdGVkCistCSAgICogc291cmNlJ3MgbGluZSBhbmQgY29sdW1uIHBvc2l0
aW9ucyBwcm92aWRlZC4gVGhlIG9ubHkgYXJndW1lbnQgaXMgYW4gb2JqZWN0CistCSAgICogd2l0
aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6CistCSAgICoKKy0JICAgKiAgIC0gbGluZTogVGhl
IGxpbmUgbnVtYmVyIGluIHRoZSBnZW5lcmF0ZWQgc291cmNlLgorLQkgICAqICAgLSBjb2x1bW46
IFRoZSBjb2x1bW4gbnVtYmVyIGluIHRoZSBnZW5lcmF0ZWQgc291cmNlLgorLQkgICAqICAgLSBi
aWFzOiBFaXRoZXIgJ1NvdXJjZU1hcENvbnN1bWVyLkdSRUFURVNUX0xPV0VSX0JPVU5EJyBvcgor
LQkgICAqICAgICAnU291cmNlTWFwQ29uc3VtZXIuTEVBU1RfVVBQRVJfQk9VTkQnLiBTcGVjaWZp
ZXMgd2hldGhlciB0byByZXR1cm4gdGhlCistCSAgICogICAgIGNsb3Nlc3QgZWxlbWVudCB0aGF0
IGlzIHNtYWxsZXIgdGhhbiBvciBncmVhdGVyIHRoYW4gdGhlIG9uZSB3ZSBhcmUKKy0JICAgKiAg
ICAgc2VhcmNoaW5nIGZvciwgcmVzcGVjdGl2ZWx5LCBpZiB0aGUgZXhhY3QgZWxlbWVudCBjYW5u
b3QgYmUgZm91bmQuCistCSAgICogICAgIERlZmF1bHRzIHRvICdTb3VyY2VNYXBDb25zdW1lci5H
UkVBVEVTVF9MT1dFUl9CT1VORCcuCistCSAgICoKKy0JICAgKiBhbmQgYW4gb2JqZWN0IGlzIHJl
dHVybmVkIHdpdGggdGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzOgorLQkgICAqCistCSAgICogICAt
IHNvdXJjZTogVGhlIG9yaWdpbmFsIHNvdXJjZSBmaWxlLCBvciBudWxsLgorLQkgICAqICAgLSBs
aW5lOiBUaGUgbGluZSBudW1iZXIgaW4gdGhlIG9yaWdpbmFsIHNvdXJjZSwgb3IgbnVsbC4KKy0J
ICAgKiAgIC0gY29sdW1uOiBUaGUgY29sdW1uIG51bWJlciBpbiB0aGUgb3JpZ2luYWwgc291cmNl
LCBvciBudWxsLgorLQkgICAqICAgLSBuYW1lOiBUaGUgb3JpZ2luYWwgaWRlbnRpZmllciwgb3Ig
bnVsbC4KKy0JICAgKi8KKy0JICBCYXNpY1NvdXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZS5vcmln
aW5hbFBvc2l0aW9uRm9yID0KKy0JICAgIGZ1bmN0aW9uIFNvdXJjZU1hcENvbnN1bWVyX29yaWdp
bmFsUG9zaXRpb25Gb3IoYUFyZ3MpIHsKKy0JICAgICAgdmFyIG5lZWRsZSA9IHsKKy0JICAgICAg
ICBnZW5lcmF0ZWRMaW5lOiB1dGlsLmdldEFyZyhhQXJncywgJ2xpbmUnKSwKKy0JICAgICAgICBn
ZW5lcmF0ZWRDb2x1bW46IHV0aWwuZ2V0QXJnKGFBcmdzLCAnY29sdW1uJykKKy0JICAgICAgfTsK
Ky0KKy0JICAgICAgdmFyIGluZGV4ID0gdGhpcy5fZmluZE1hcHBpbmcoCistCSAgICAgICAgbmVl
ZGxlLAorLQkgICAgICAgIHRoaXMuX2dlbmVyYXRlZE1hcHBpbmdzLAorLQkgICAgICAgICJnZW5l
cmF0ZWRMaW5lIiwKKy0JICAgICAgICAiZ2VuZXJhdGVkQ29sdW1uIiwKKy0JICAgICAgICB1dGls
LmNvbXBhcmVCeUdlbmVyYXRlZFBvc2l0aW9uc0RlZmxhdGVkLAorLQkgICAgICAgIHV0aWwuZ2V0
QXJnKGFBcmdzLCAnYmlhcycsIFNvdXJjZU1hcENvbnN1bWVyLkdSRUFURVNUX0xPV0VSX0JPVU5E
KQorLQkgICAgICApOworLQorLQkgICAgICBpZiAoaW5kZXggPj0gMCkgeworLQkgICAgICAgIHZh
ciBtYXBwaW5nID0gdGhpcy5fZ2VuZXJhdGVkTWFwcGluZ3NbaW5kZXhdOworLQorLQkgICAgICAg
IGlmIChtYXBwaW5nLmdlbmVyYXRlZExpbmUgPT09IG5lZWRsZS5nZW5lcmF0ZWRMaW5lKSB7Cist
CSAgICAgICAgICB2YXIgc291cmNlID0gdXRpbC5nZXRBcmcobWFwcGluZywgJ3NvdXJjZScsIG51
bGwpOworLQkgICAgICAgICAgaWYgKHNvdXJjZSAhPT0gbnVsbCkgeworLQkgICAgICAgICAgICBz
b3VyY2UgPSB0aGlzLl9zb3VyY2VzLmF0KHNvdXJjZSk7CistCSAgICAgICAgICAgIGlmICh0aGlz
LnNvdXJjZVJvb3QgIT0gbnVsbCkgeworLQkgICAgICAgICAgICAgIHNvdXJjZSA9IHV0aWwuam9p
bih0aGlzLnNvdXJjZVJvb3QsIHNvdXJjZSk7CistCSAgICAgICAgICAgIH0KKy0JICAgICAgICAg
IH0KKy0JICAgICAgICAgIHZhciBuYW1lID0gdXRpbC5nZXRBcmcobWFwcGluZywgJ25hbWUnLCBu
dWxsKTsKKy0JICAgICAgICAgIGlmIChuYW1lICE9PSBudWxsKSB7CistCSAgICAgICAgICAgIG5h
bWUgPSB0aGlzLl9uYW1lcy5hdChuYW1lKTsKKy0JICAgICAgICAgIH0KKy0JICAgICAgICAgIHJl
dHVybiB7CistCSAgICAgICAgICAgIHNvdXJjZTogc291cmNlLAorLQkgICAgICAgICAgICBsaW5l
OiB1dGlsLmdldEFyZyhtYXBwaW5nLCAnb3JpZ2luYWxMaW5lJywgbnVsbCksCistCSAgICAgICAg
ICAgIGNvbHVtbjogdXRpbC5nZXRBcmcobWFwcGluZywgJ29yaWdpbmFsQ29sdW1uJywgbnVsbCks
CistCSAgICAgICAgICAgIG5hbWU6IG5hbWUKKy0JICAgICAgICAgIH07CistCSAgICAgICAgfQor
LQkgICAgICB9CistCistCSAgICAgIHJldHVybiB7CistCSAgICAgICAgc291cmNlOiBudWxsLAor
LQkgICAgICAgIGxpbmU6IG51bGwsCistCSAgICAgICAgY29sdW1uOiBudWxsLAorLQkgICAgICAg
IG5hbWU6IG51bGwKKy0JICAgICAgfTsKKy0JICAgIH07CistCistCSAgLyoqCistCSAgICogUmV0
dXJuIHRydWUgaWYgd2UgaGF2ZSB0aGUgc291cmNlIGNvbnRlbnQgZm9yIGV2ZXJ5IHNvdXJjZSBp
biB0aGUgc291cmNlCistCSAgICogbWFwLCBmYWxzZSBvdGhlcndpc2UuCistCSAgICovCistCSAg
QmFzaWNTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUuaGFzQ29udGVudHNPZkFsbFNvdXJjZXMg
PQorLQkgICAgZnVuY3Rpb24gQmFzaWNTb3VyY2VNYXBDb25zdW1lcl9oYXNDb250ZW50c09mQWxs
U291cmNlcygpIHsKKy0JICAgICAgaWYgKCF0aGlzLnNvdXJjZXNDb250ZW50KSB7CistCSAgICAg
ICAgcmV0dXJuIGZhbHNlOworLQkgICAgICB9CistCSAgICAgIHJldHVybiB0aGlzLnNvdXJjZXND
b250ZW50Lmxlbmd0aCA+PSB0aGlzLl9zb3VyY2VzLnNpemUoKSAmJgorLQkgICAgICAgICF0aGlz
LnNvdXJjZXNDb250ZW50LnNvbWUoZnVuY3Rpb24gKHNjKSB7IHJldHVybiBzYyA9PSBudWxsOyB9
KTsKKy0JICAgIH07CistCistCSAgLyoqCistCSAgICogUmV0dXJucyB0aGUgb3JpZ2luYWwgc291
cmNlIGNvbnRlbnQuIFRoZSBvbmx5IGFyZ3VtZW50IGlzIHRoZSB1cmwgb2YgdGhlCistCSAgICog
b3JpZ2luYWwgc291cmNlIGZpbGUuIFJldHVybnMgbnVsbCBpZiBubyBvcmlnaW5hbCBzb3VyY2Ug
Y29udGVudCBpcworLQkgICAqIGF2YWlsYWJsZS4KKy0JICAgKi8KKy0JICBCYXNpY1NvdXJjZU1h
cENvbnN1bWVyLnByb3RvdHlwZS5zb3VyY2VDb250ZW50Rm9yID0KKy0JICAgIGZ1bmN0aW9uIFNv
dXJjZU1hcENvbnN1bWVyX3NvdXJjZUNvbnRlbnRGb3IoYVNvdXJjZSwgbnVsbE9uTWlzc2luZykg
eworLQkgICAgICBpZiAoIXRoaXMuc291cmNlc0NvbnRlbnQpIHsKKy0JICAgICAgICByZXR1cm4g
bnVsbDsKKy0JICAgICAgfQorLQorLQkgICAgICBpZiAodGhpcy5zb3VyY2VSb290ICE9IG51bGwp
IHsKKy0JICAgICAgICBhU291cmNlID0gdXRpbC5yZWxhdGl2ZSh0aGlzLnNvdXJjZVJvb3QsIGFT
b3VyY2UpOworLQkgICAgICB9CistCistCSAgICAgIGlmICh0aGlzLl9zb3VyY2VzLmhhcyhhU291
cmNlKSkgeworLQkgICAgICAgIHJldHVybiB0aGlzLnNvdXJjZXNDb250ZW50W3RoaXMuX3NvdXJj
ZXMuaW5kZXhPZihhU291cmNlKV07CistCSAgICAgIH0KKy0KKy0JICAgICAgdmFyIHVybDsKKy0J
ICAgICAgaWYgKHRoaXMuc291cmNlUm9vdCAhPSBudWxsCistCSAgICAgICAgICAmJiAodXJsID0g
dXRpbC51cmxQYXJzZSh0aGlzLnNvdXJjZVJvb3QpKSkgeworLQkgICAgICAgIC8vIFhYWDogZmls
ZTovLyBVUklzIGFuZCBhYnNvbHV0ZSBwYXRocyBsZWFkIHRvIHVuZXhwZWN0ZWQgYmVoYXZpb3Ig
Zm9yCistCSAgICAgICAgLy8gbWFueSB1c2Vycy4gV2UgY2FuIGhlbHAgdGhlbSBvdXQgd2hlbiB0
aGV5IGV4cGVjdCBmaWxlOi8vIFVSSXMgdG8KKy0JICAgICAgICAvLyBiZWhhdmUgbGlrZSBpdCB3
b3VsZCBpZiB0aGV5IHdlcmUgcnVubmluZyBhIGxvY2FsIEhUVFAgc2VydmVyLiBTZWUKKy0JICAg
ICAgICAvLyBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD04ODU1
OTcuCistCSAgICAgICAgdmFyIGZpbGVVcmlBYnNQYXRoID0gYVNvdXJjZS5yZXBsYWNlKC9eZmls
ZTpcL1wvLywgIiIpOworLQkgICAgICAgIGlmICh1cmwuc2NoZW1lID09ICJmaWxlIgorLQkgICAg
ICAgICAgICAmJiB0aGlzLl9zb3VyY2VzLmhhcyhmaWxlVXJpQWJzUGF0aCkpIHsKKy0JICAgICAg
ICAgIHJldHVybiB0aGlzLnNvdXJjZXNDb250ZW50W3RoaXMuX3NvdXJjZXMuaW5kZXhPZihmaWxl
VXJpQWJzUGF0aCldCistCSAgICAgICAgfQorLQorLQkgICAgICAgIGlmICgoIXVybC5wYXRoIHx8
IHVybC5wYXRoID09ICIvIikKKy0JICAgICAgICAgICAgJiYgdGhpcy5fc291cmNlcy5oYXMoIi8i
ICsgYVNvdXJjZSkpIHsKKy0JICAgICAgICAgIHJldHVybiB0aGlzLnNvdXJjZXNDb250ZW50W3Ro
aXMuX3NvdXJjZXMuaW5kZXhPZigiLyIgKyBhU291cmNlKV07CistCSAgICAgICAgfQorLQkgICAg
ICB9CistCistCSAgICAgIC8vIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCByZWN1cnNpdmVseSBmcm9t
CistCSAgICAgIC8vIEluZGV4ZWRTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUuc291cmNlQ29u
dGVudEZvci4gSW4gdGhhdCBjYXNlLCB3ZQorLQkgICAgICAvLyBkb24ndCB3YW50IHRvIHRocm93
IGlmIHdlIGNhbid0IGZpbmQgdGhlIHNvdXJjZSAtIHdlIGp1c3Qgd2FudCB0bworLQkgICAgICAv
LyByZXR1cm4gbnVsbCwgc28gd2UgcHJvdmlkZSBhIGZsYWcgdG8gZXhpdCBncmFjZWZ1bGx5Lgor
LQkgICAgICBpZiAobnVsbE9uTWlzc2luZykgeworLQkgICAgICAgIHJldHVybiBudWxsOworLQkg
ICAgICB9CistCSAgICAgIGVsc2UgeworLQkgICAgICAgIHRocm93IG5ldyBFcnJvcignIicgKyBh
U291cmNlICsgJyIgaXMgbm90IGluIHRoZSBTb3VyY2VNYXAuJyk7CistCSAgICAgIH0KKy0JICAg
IH07CistCistCSAgLyoqCistCSAgICogUmV0dXJucyB0aGUgZ2VuZXJhdGVkIGxpbmUgYW5kIGNv
bHVtbiBpbmZvcm1hdGlvbiBmb3IgdGhlIG9yaWdpbmFsIHNvdXJjZSwKKy0JICAgKiBsaW5lLCBh
bmQgY29sdW1uIHBvc2l0aW9ucyBwcm92aWRlZC4gVGhlIG9ubHkgYXJndW1lbnQgaXMgYW4gb2Jq
ZWN0IHdpdGgKKy0JICAgKiB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6CistCSAgICoKKy0JICAg
KiAgIC0gc291cmNlOiBUaGUgZmlsZW5hbWUgb2YgdGhlIG9yaWdpbmFsIHNvdXJjZS4KKy0JICAg
KiAgIC0gbGluZTogVGhlIGxpbmUgbnVtYmVyIGluIHRoZSBvcmlnaW5hbCBzb3VyY2UuCistCSAg
ICogICAtIGNvbHVtbjogVGhlIGNvbHVtbiBudW1iZXIgaW4gdGhlIG9yaWdpbmFsIHNvdXJjZS4K
Ky0JICAgKiAgIC0gYmlhczogRWl0aGVyICdTb3VyY2VNYXBDb25zdW1lci5HUkVBVEVTVF9MT1dF
Ul9CT1VORCcgb3IKKy0JICAgKiAgICAgJ1NvdXJjZU1hcENvbnN1bWVyLkxFQVNUX1VQUEVSX0JP
VU5EJy4gU3BlY2lmaWVzIHdoZXRoZXIgdG8gcmV0dXJuIHRoZQorLQkgICAqICAgICBjbG9zZXN0
IGVsZW1lbnQgdGhhdCBpcyBzbWFsbGVyIHRoYW4gb3IgZ3JlYXRlciB0aGFuIHRoZSBvbmUgd2Ug
YXJlCistCSAgICogICAgIHNlYXJjaGluZyBmb3IsIHJlc3BlY3RpdmVseSwgaWYgdGhlIGV4YWN0
IGVsZW1lbnQgY2Fubm90IGJlIGZvdW5kLgorLQkgICAqICAgICBEZWZhdWx0cyB0byAnU291cmNl
TWFwQ29uc3VtZXIuR1JFQVRFU1RfTE9XRVJfQk9VTkQnLgorLQkgICAqCistCSAgICogYW5kIGFu
IG9iamVjdCBpcyByZXR1cm5lZCB3aXRoIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczoKKy0JICAg
KgorLQkgICAqICAgLSBsaW5lOiBUaGUgbGluZSBudW1iZXIgaW4gdGhlIGdlbmVyYXRlZCBzb3Vy
Y2UsIG9yIG51bGwuCistCSAgICogICAtIGNvbHVtbjogVGhlIGNvbHVtbiBudW1iZXIgaW4gdGhl
IGdlbmVyYXRlZCBzb3VyY2UsIG9yIG51bGwuCistCSAgICovCistCSAgQmFzaWNTb3VyY2VNYXBD
b25zdW1lci5wcm90b3R5cGUuZ2VuZXJhdGVkUG9zaXRpb25Gb3IgPQorLQkgICAgZnVuY3Rpb24g
U291cmNlTWFwQ29uc3VtZXJfZ2VuZXJhdGVkUG9zaXRpb25Gb3IoYUFyZ3MpIHsKKy0JICAgICAg
dmFyIHNvdXJjZSA9IHV0aWwuZ2V0QXJnKGFBcmdzLCAnc291cmNlJyk7CistCSAgICAgIGlmICh0
aGlzLnNvdXJjZVJvb3QgIT0gbnVsbCkgeworLQkgICAgICAgIHNvdXJjZSA9IHV0aWwucmVsYXRp
dmUodGhpcy5zb3VyY2VSb290LCBzb3VyY2UpOworLQkgICAgICB9CistCSAgICAgIGlmICghdGhp
cy5fc291cmNlcy5oYXMoc291cmNlKSkgeworLQkgICAgICAgIHJldHVybiB7CistCSAgICAgICAg
ICBsaW5lOiBudWxsLAorLQkgICAgICAgICAgY29sdW1uOiBudWxsLAorLQkgICAgICAgICAgbGFz
dENvbHVtbjogbnVsbAorLQkgICAgICAgIH07CistCSAgICAgIH0KKy0JICAgICAgc291cmNlID0g
dGhpcy5fc291cmNlcy5pbmRleE9mKHNvdXJjZSk7CistCistCSAgICAgIHZhciBuZWVkbGUgPSB7
CistCSAgICAgICAgc291cmNlOiBzb3VyY2UsCistCSAgICAgICAgb3JpZ2luYWxMaW5lOiB1dGls
LmdldEFyZyhhQXJncywgJ2xpbmUnKSwKKy0JICAgICAgICBvcmlnaW5hbENvbHVtbjogdXRpbC5n
ZXRBcmcoYUFyZ3MsICdjb2x1bW4nKQorLQkgICAgICB9OworLQorLQkgICAgICB2YXIgaW5kZXgg
PSB0aGlzLl9maW5kTWFwcGluZygKKy0JICAgICAgICBuZWVkbGUsCistCSAgICAgICAgdGhpcy5f
b3JpZ2luYWxNYXBwaW5ncywKKy0JICAgICAgICAib3JpZ2luYWxMaW5lIiwKKy0JICAgICAgICAi
b3JpZ2luYWxDb2x1bW4iLAorLQkgICAgICAgIHV0aWwuY29tcGFyZUJ5T3JpZ2luYWxQb3NpdGlv
bnMsCistCSAgICAgICAgdXRpbC5nZXRBcmcoYUFyZ3MsICdiaWFzJywgU291cmNlTWFwQ29uc3Vt
ZXIuR1JFQVRFU1RfTE9XRVJfQk9VTkQpCistCSAgICAgICk7CistCistCSAgICAgIGlmIChpbmRl
eCA+PSAwKSB7CistCSAgICAgICAgdmFyIG1hcHBpbmcgPSB0aGlzLl9vcmlnaW5hbE1hcHBpbmdz
W2luZGV4XTsKKy0KKy0JICAgICAgICBpZiAobWFwcGluZy5zb3VyY2UgPT09IG5lZWRsZS5zb3Vy
Y2UpIHsKKy0JICAgICAgICAgIHJldHVybiB7CistCSAgICAgICAgICAgIGxpbmU6IHV0aWwuZ2V0
QXJnKG1hcHBpbmcsICdnZW5lcmF0ZWRMaW5lJywgbnVsbCksCistCSAgICAgICAgICAgIGNvbHVt
bjogdXRpbC5nZXRBcmcobWFwcGluZywgJ2dlbmVyYXRlZENvbHVtbicsIG51bGwpLAorLQkgICAg
ICAgICAgICBsYXN0Q29sdW1uOiB1dGlsLmdldEFyZyhtYXBwaW5nLCAnbGFzdEdlbmVyYXRlZENv
bHVtbicsIG51bGwpCistCSAgICAgICAgICB9OworLQkgICAgICAgIH0KKy0JICAgICAgfQorLQor
LQkgICAgICByZXR1cm4geworLQkgICAgICAgIGxpbmU6IG51bGwsCistCSAgICAgICAgY29sdW1u
OiBudWxsLAorLQkgICAgICAgIGxhc3RDb2x1bW46IG51bGwKKy0JICAgICAgfTsKKy0JICAgIH07
CistCistCSAgZXhwb3J0cy5CYXNpY1NvdXJjZU1hcENvbnN1bWVyID0gQmFzaWNTb3VyY2VNYXBD
b25zdW1lcjsKKy0KKy0JICAvKioKKy0JICAgKiBBbiBJbmRleGVkU291cmNlTWFwQ29uc3VtZXIg
aW5zdGFuY2UgcmVwcmVzZW50cyBhIHBhcnNlZCBzb3VyY2UgbWFwIHdoaWNoCistCSAgICogd2Ug
Y2FuIHF1ZXJ5IGZvciBpbmZvcm1hdGlvbi4gSXQgZGlmZmVycyBmcm9tIEJhc2ljU291cmNlTWFw
Q29uc3VtZXIgaW4KKy0JICAgKiB0aGF0IGl0IHRha2VzICJpbmRleGVkIiBzb3VyY2UgbWFwcyAo
aS5lLiBvbmVzIHdpdGggYSAic2VjdGlvbnMiIGZpZWxkKSBhcworLQkgICAqIGlucHV0LgorLQkg
ICAqCistCSAgICogVGhlIG9ubHkgcGFyYW1ldGVyIGlzIGEgcmF3IHNvdXJjZSBtYXAgKGVpdGhl
ciBhcyBhIEpTT04gc3RyaW5nLCBvciBhbHJlYWR5CistCSAgICogcGFyc2VkIHRvIGFuIG9iamVj
dCkuIEFjY29yZGluZyB0byB0aGUgc3BlYyBmb3IgaW5kZXhlZCBzb3VyY2UgbWFwcywgdGhleQor
LQkgICAqIGhhdmUgdGhlIGZvbGxvd2luZyBhdHRyaWJ1dGVzOgorLQkgICAqCistCSAgICogICAt
IHZlcnNpb246IFdoaWNoIHZlcnNpb24gb2YgdGhlIHNvdXJjZSBtYXAgc3BlYyB0aGlzIG1hcCBp
cyBmb2xsb3dpbmcuCistCSAgICogICAtIGZpbGU6IE9wdGlvbmFsLiBUaGUgZ2VuZXJhdGVkIGZp
bGUgdGhpcyBzb3VyY2UgbWFwIGlzIGFzc29jaWF0ZWQgd2l0aC4KKy0JICAgKiAgIC0gc2VjdGlv
bnM6IEEgbGlzdCBvZiBzZWN0aW9uIGRlZmluaXRpb25zLgorLQkgICAqCistCSAgICogRWFjaCB2
YWx1ZSB1bmRlciB0aGUgInNlY3Rpb25zIiBmaWVsZCBoYXMgdHdvIGZpZWxkczoKKy0JICAgKiAg
IC0gb2Zmc2V0OiBUaGUgb2Zmc2V0IGludG8gdGhlIG9yaWdpbmFsIHNwZWNpZmllZCBhdCB3aGlj
aCB0aGlzIHNlY3Rpb24KKy0JICAgKiAgICAgICBiZWdpbnMgdG8gYXBwbHksIGRlZmluZWQgYXMg
YW4gb2JqZWN0IHdpdGggYSAibGluZSIgYW5kICJjb2x1bW4iCistCSAgICogICAgICAgZmllbGQu
CistCSAgICogICAtIG1hcDogQSBzb3VyY2UgbWFwIGRlZmluaXRpb24uIFRoaXMgc291cmNlIG1h
cCBjb3VsZCBhbHNvIGJlIGluZGV4ZWQsCistCSAgICogICAgICAgYnV0IGRvZXNuJ3QgaGF2ZSB0
byBiZS4KKy0JICAgKgorLQkgICAqIEluc3RlYWQgb2YgdGhlICJtYXAiIGZpZWxkLCBpdCdzIGFs
c28gcG9zc2libGUgdG8gaGF2ZSBhICJ1cmwiIGZpZWxkCistCSAgICogc3BlY2lmeWluZyBhIFVS
TCB0byByZXRyaWV2ZSBhIHNvdXJjZSBtYXAgZnJvbSwgYnV0IHRoYXQncyBjdXJyZW50bHkKKy0J
ICAgKiB1bnN1cHBvcnRlZC4KKy0JICAgKgorLQkgICAqIEhlcmUncyBhbiBleGFtcGxlIHNvdXJj
ZSBtYXAsIHRha2VuIGZyb20gdGhlIHNvdXJjZSBtYXAgc3BlY1swXSwgYnV0CistCSAgICogbW9k
aWZpZWQgdG8gb21pdCBhIHNlY3Rpb24gd2hpY2ggdXNlcyB0aGUgInVybCIgZmllbGQuCistCSAg
ICoKKy0JICAgKiAgeworLQkgICAqICAgIHZlcnNpb24gOiAzLAorLQkgICAqICAgIGZpbGU6ICJh
cHAuanMiLAorLQkgICAqICAgIHNlY3Rpb25zOiBbeworLQkgICAqICAgICAgb2Zmc2V0OiB7bGlu
ZToxMDAsIGNvbHVtbjoxMH0sCistCSAgICogICAgICBtYXA6IHsKKy0JICAgKiAgICAgICAgdmVy
c2lvbiA6IDMsCistCSAgICogICAgICAgIGZpbGU6ICJzZWN0aW9uLmpzIiwKKy0JICAgKiAgICAg
ICAgc291cmNlczogWyJmb28uanMiLCAiYmFyLmpzIl0sCistCSAgICogICAgICAgIG5hbWVzOiBb
InNyYyIsICJtYXBzIiwgImFyZSIsICJmdW4iXSwKKy0JICAgKiAgICAgICAgbWFwcGluZ3M6ICJB
QUFBLEU7O0FCQ0RFOyIKKy0JICAgKiAgICAgIH0KKy0JICAgKiAgICB9XSwKKy0JICAgKiAgfQor
LQkgICAqCistCSAgICogWzBdOiBodHRwczovL2RvY3MuZ29vZ2xlLmNvbS9kb2N1bWVudC9kLzFV
MVJHQWVoUXdSeXBVVG92RjFLUmxwaU9GemUwYi1fMmdjNmZBSDBLWTBrL2VkaXQjaGVhZGluZz1o
LjUzNWVzM3hlcHJndAorLQkgICAqLworLQkgIGZ1bmN0aW9uIEluZGV4ZWRTb3VyY2VNYXBDb25z
dW1lcihhU291cmNlTWFwKSB7CistCSAgICB2YXIgc291cmNlTWFwID0gYVNvdXJjZU1hcDsKKy0J
ICAgIGlmICh0eXBlb2YgYVNvdXJjZU1hcCA9PT0gJ3N0cmluZycpIHsKKy0JICAgICAgc291cmNl
TWFwID0gSlNPTi5wYXJzZShhU291cmNlTWFwLnJlcGxhY2UoL15cKVxdXH0nLywgJycpKTsKKy0J
ICAgIH0KKy0KKy0JICAgIHZhciB2ZXJzaW9uID0gdXRpbC5nZXRBcmcoc291cmNlTWFwLCAndmVy
c2lvbicpOworLQkgICAgdmFyIHNlY3Rpb25zID0gdXRpbC5nZXRBcmcoc291cmNlTWFwLCAnc2Vj
dGlvbnMnKTsKKy0KKy0JICAgIGlmICh2ZXJzaW9uICE9IHRoaXMuX3ZlcnNpb24pIHsKKy0JICAg
ICAgdGhyb3cgbmV3IEVycm9yKCdVbnN1cHBvcnRlZCB2ZXJzaW9uOiAnICsgdmVyc2lvbik7Cist
CSAgICB9CistCistCSAgICB0aGlzLl9zb3VyY2VzID0gbmV3IEFycmF5U2V0KCk7CistCSAgICB0
aGlzLl9uYW1lcyA9IG5ldyBBcnJheVNldCgpOworLQorLQkgICAgdmFyIGxhc3RPZmZzZXQgPSB7
CistCSAgICAgIGxpbmU6IC0xLAorLQkgICAgICBjb2x1bW46IDAKKy0JICAgIH07CistCSAgICB0
aGlzLl9zZWN0aW9ucyA9IHNlY3Rpb25zLm1hcChmdW5jdGlvbiAocykgeworLQkgICAgICBpZiAo
cy51cmwpIHsKKy0JICAgICAgICAvLyBUaGUgdXJsIGZpZWxkIHdpbGwgcmVxdWlyZSBzdXBwb3J0
IGZvciBhc3luY2hyb25pY2l0eS4KKy0JICAgICAgICAvLyBTZWUgaHR0cHM6Ly9naXRodWIuY29t
L21vemlsbGEvc291cmNlLW1hcC9pc3N1ZXMvMTYKKy0JICAgICAgICB0aHJvdyBuZXcgRXJyb3Io
J1N1cHBvcnQgZm9yIHVybCBmaWVsZCBpbiBzZWN0aW9ucyBub3QgaW1wbGVtZW50ZWQuJyk7Cist
CSAgICAgIH0KKy0JICAgICAgdmFyIG9mZnNldCA9IHV0aWwuZ2V0QXJnKHMsICdvZmZzZXQnKTsK
Ky0JICAgICAgdmFyIG9mZnNldExpbmUgPSB1dGlsLmdldEFyZyhvZmZzZXQsICdsaW5lJyk7Cist
CSAgICAgIHZhciBvZmZzZXRDb2x1bW4gPSB1dGlsLmdldEFyZyhvZmZzZXQsICdjb2x1bW4nKTsK
Ky0KKy0JICAgICAgaWYgKG9mZnNldExpbmUgPCBsYXN0T2Zmc2V0LmxpbmUgfHwKKy0JICAgICAg
ICAgIChvZmZzZXRMaW5lID09PSBsYXN0T2Zmc2V0LmxpbmUgJiYgb2Zmc2V0Q29sdW1uIDwgbGFz
dE9mZnNldC5jb2x1bW4pKSB7CistCSAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTZWN0aW9uIG9m
ZnNldHMgbXVzdCBiZSBvcmRlcmVkIGFuZCBub24tb3ZlcmxhcHBpbmcuJyk7CistCSAgICAgIH0K
Ky0JICAgICAgbGFzdE9mZnNldCA9IG9mZnNldDsKKy0KKy0JICAgICAgcmV0dXJuIHsKKy0JICAg
ICAgICBnZW5lcmF0ZWRPZmZzZXQ6IHsKKy0JICAgICAgICAgIC8vIFRoZSBvZmZzZXQgZmllbGRz
IGFyZSAwLWJhc2VkLCBidXQgd2UgdXNlIDEtYmFzZWQgaW5kaWNlcyB3aGVuCistCSAgICAgICAg
ICAvLyBlbmNvZGluZy9kZWNvZGluZyBmcm9tIFZMUS4KKy0JICAgICAgICAgIGdlbmVyYXRlZExp
bmU6IG9mZnNldExpbmUgKyAxLAorLQkgICAgICAgICAgZ2VuZXJhdGVkQ29sdW1uOiBvZmZzZXRD
b2x1bW4gKyAxCistCSAgICAgICAgfSwKKy0JICAgICAgICBjb25zdW1lcjogbmV3IFNvdXJjZU1h
cENvbnN1bWVyKHV0aWwuZ2V0QXJnKHMsICdtYXAnKSkKKy0JICAgICAgfQorLQkgICAgfSk7Cist
CSAgfQorLQorLQkgIEluZGV4ZWRTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUgPSBPYmplY3Qu
Y3JlYXRlKFNvdXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZSk7CistCSAgSW5kZXhlZFNvdXJjZU1h
cENvbnN1bWVyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFNvdXJjZU1hcENvbnN1bWVyOworLQor
LQkgIC8qKgorLQkgICAqIFRoZSB2ZXJzaW9uIG9mIHRoZSBzb3VyY2UgbWFwcGluZyBzcGVjIHRo
YXQgd2UgYXJlIGNvbnN1bWluZy4KKy0JICAgKi8KKy0JICBJbmRleGVkU291cmNlTWFwQ29uc3Vt
ZXIucHJvdG90eXBlLl92ZXJzaW9uID0gMzsKKy0KKy0JICAvKioKKy0JICAgKiBUaGUgbGlzdCBv
ZiBvcmlnaW5hbCBzb3VyY2VzLgorLQkgICAqLworLQkgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJ
bmRleGVkU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLCAnc291cmNlcycsIHsKKy0JICAgIGdl
dDogZnVuY3Rpb24gKCkgeworLQkgICAgICB2YXIgc291cmNlcyA9IFtdOworLQkgICAgICBmb3Ig
KHZhciBpID0gMDsgaSA8IHRoaXMuX3NlY3Rpb25zLmxlbmd0aDsgaSsrKSB7CistCSAgICAgICAg
Zm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLl9zZWN0aW9uc1tpXS5jb25zdW1lci5zb3VyY2VzLmxl
bmd0aDsgaisrKSB7CistCSAgICAgICAgICBzb3VyY2VzLnB1c2godGhpcy5fc2VjdGlvbnNbaV0u
Y29uc3VtZXIuc291cmNlc1tqXSk7CistCSAgICAgICAgfQorLQkgICAgICB9CistCSAgICAgIHJl
dHVybiBzb3VyY2VzOworLQkgICAgfQorLQkgIH0pOworLQorLQkgIC8qKgorLQkgICAqIFJldHVy
bnMgdGhlIG9yaWdpbmFsIHNvdXJjZSwgbGluZSwgYW5kIGNvbHVtbiBpbmZvcm1hdGlvbiBmb3Ig
dGhlIGdlbmVyYXRlZAorLQkgICAqIHNvdXJjZSdzIGxpbmUgYW5kIGNvbHVtbiBwb3NpdGlvbnMg
cHJvdmlkZWQuIFRoZSBvbmx5IGFyZ3VtZW50IGlzIGFuIG9iamVjdAorLQkgICAqIHdpdGggdGhl
IGZvbGxvd2luZyBwcm9wZXJ0aWVzOgorLQkgICAqCistCSAgICogICAtIGxpbmU6IFRoZSBsaW5l
IG51bWJlciBpbiB0aGUgZ2VuZXJhdGVkIHNvdXJjZS4KKy0JICAgKiAgIC0gY29sdW1uOiBUaGUg
Y29sdW1uIG51bWJlciBpbiB0aGUgZ2VuZXJhdGVkIHNvdXJjZS4KKy0JICAgKgorLQkgICAqIGFu
ZCBhbiBvYmplY3QgaXMgcmV0dXJuZWQgd2l0aCB0aGUgZm9sbG93aW5nIHByb3BlcnRpZXM6Cist
CSAgICoKKy0JICAgKiAgIC0gc291cmNlOiBUaGUgb3JpZ2luYWwgc291cmNlIGZpbGUsIG9yIG51
bGwuCistCSAgICogICAtIGxpbmU6IFRoZSBsaW5lIG51bWJlciBpbiB0aGUgb3JpZ2luYWwgc291
cmNlLCBvciBudWxsLgorLQkgICAqICAgLSBjb2x1bW46IFRoZSBjb2x1bW4gbnVtYmVyIGluIHRo
ZSBvcmlnaW5hbCBzb3VyY2UsIG9yIG51bGwuCistCSAgICogICAtIG5hbWU6IFRoZSBvcmlnaW5h
bCBpZGVudGlmaWVyLCBvciBudWxsLgorLQkgICAqLworLQkgIEluZGV4ZWRTb3VyY2VNYXBDb25z
dW1lci5wcm90b3R5cGUub3JpZ2luYWxQb3NpdGlvbkZvciA9CistCSAgICBmdW5jdGlvbiBJbmRl
eGVkU291cmNlTWFwQ29uc3VtZXJfb3JpZ2luYWxQb3NpdGlvbkZvcihhQXJncykgeworLQkgICAg
ICB2YXIgbmVlZGxlID0geworLQkgICAgICAgIGdlbmVyYXRlZExpbmU6IHV0aWwuZ2V0QXJnKGFB
cmdzLCAnbGluZScpLAorLQkgICAgICAgIGdlbmVyYXRlZENvbHVtbjogdXRpbC5nZXRBcmcoYUFy
Z3MsICdjb2x1bW4nKQorLQkgICAgICB9OworLQorLQkgICAgICAvLyBGaW5kIHRoZSBzZWN0aW9u
IGNvbnRhaW5pbmcgdGhlIGdlbmVyYXRlZCBwb3NpdGlvbiB3ZSdyZSB0cnlpbmcgdG8gbWFwCist
CSAgICAgIC8vIHRvIGFuIG9yaWdpbmFsIHBvc2l0aW9uLgorLQkgICAgICB2YXIgc2VjdGlvbklu
ZGV4ID0gYmluYXJ5U2VhcmNoLnNlYXJjaChuZWVkbGUsIHRoaXMuX3NlY3Rpb25zLAorLQkgICAg
ICAgIGZ1bmN0aW9uKG5lZWRsZSwgc2VjdGlvbikgeworLQkgICAgICAgICAgdmFyIGNtcCA9IG5l
ZWRsZS5nZW5lcmF0ZWRMaW5lIC0gc2VjdGlvbi5nZW5lcmF0ZWRPZmZzZXQuZ2VuZXJhdGVkTGlu
ZTsKKy0JICAgICAgICAgIGlmIChjbXApIHsKKy0JICAgICAgICAgICAgcmV0dXJuIGNtcDsKKy0J
ICAgICAgICAgIH0KKy0KKy0JICAgICAgICAgIHJldHVybiAobmVlZGxlLmdlbmVyYXRlZENvbHVt
biAtCistCSAgICAgICAgICAgICAgICAgIHNlY3Rpb24uZ2VuZXJhdGVkT2Zmc2V0LmdlbmVyYXRl
ZENvbHVtbik7CistCSAgICAgICAgfSk7CistCSAgICAgIHZhciBzZWN0aW9uID0gdGhpcy5fc2Vj
dGlvbnNbc2VjdGlvbkluZGV4XTsKKy0KKy0JICAgICAgaWYgKCFzZWN0aW9uKSB7CistCSAgICAg
ICAgcmV0dXJuIHsKKy0JICAgICAgICAgIHNvdXJjZTogbnVsbCwKKy0JICAgICAgICAgIGxpbmU6
IG51bGwsCistCSAgICAgICAgICBjb2x1bW46IG51bGwsCistCSAgICAgICAgICBuYW1lOiBudWxs
CistCSAgICAgICAgfTsKKy0JICAgICAgfQorLQorLQkgICAgICByZXR1cm4gc2VjdGlvbi5jb25z
dW1lci5vcmlnaW5hbFBvc2l0aW9uRm9yKHsKKy0JICAgICAgICBsaW5lOiBuZWVkbGUuZ2VuZXJh
dGVkTGluZSAtCistCSAgICAgICAgICAoc2VjdGlvbi5nZW5lcmF0ZWRPZmZzZXQuZ2VuZXJhdGVk
TGluZSAtIDEpLAorLQkgICAgICAgIGNvbHVtbjogbmVlZGxlLmdlbmVyYXRlZENvbHVtbiAtCist
CSAgICAgICAgICAoc2VjdGlvbi5nZW5lcmF0ZWRPZmZzZXQuZ2VuZXJhdGVkTGluZSA9PT0gbmVl
ZGxlLmdlbmVyYXRlZExpbmUKKy0JICAgICAgICAgICA/IHNlY3Rpb24uZ2VuZXJhdGVkT2Zmc2V0
LmdlbmVyYXRlZENvbHVtbiAtIDEKKy0JICAgICAgICAgICA6IDApLAorLQkgICAgICAgIGJpYXM6
IGFBcmdzLmJpYXMKKy0JICAgICAgfSk7CistCSAgICB9OworLQorLQkgIC8qKgorLQkgICAqIFJl
dHVybiB0cnVlIGlmIHdlIGhhdmUgdGhlIHNvdXJjZSBjb250ZW50IGZvciBldmVyeSBzb3VyY2Ug
aW4gdGhlIHNvdXJjZQorLQkgICAqIG1hcCwgZmFsc2Ugb3RoZXJ3aXNlLgorLQkgICAqLworLQkg
IEluZGV4ZWRTb3VyY2VNYXBDb25zdW1lci5wcm90b3R5cGUuaGFzQ29udGVudHNPZkFsbFNvdXJj
ZXMgPQorLQkgICAgZnVuY3Rpb24gSW5kZXhlZFNvdXJjZU1hcENvbnN1bWVyX2hhc0NvbnRlbnRz
T2ZBbGxTb3VyY2VzKCkgeworLQkgICAgICByZXR1cm4gdGhpcy5fc2VjdGlvbnMuZXZlcnkoZnVu
Y3Rpb24gKHMpIHsKKy0JICAgICAgICByZXR1cm4gcy5jb25zdW1lci5oYXNDb250ZW50c09mQWxs
U291cmNlcygpOworLQkgICAgICB9KTsKKy0JICAgIH07CistCistCSAgLyoqCistCSAgICogUmV0
dXJucyB0aGUgb3JpZ2luYWwgc291cmNlIGNvbnRlbnQuIFRoZSBvbmx5IGFyZ3VtZW50IGlzIHRo
ZSB1cmwgb2YgdGhlCistCSAgICogb3JpZ2luYWwgc291cmNlIGZpbGUuIFJldHVybnMgbnVsbCBp
ZiBubyBvcmlnaW5hbCBzb3VyY2UgY29udGVudCBpcworLQkgICAqIGF2YWlsYWJsZS4KKy0JICAg
Ki8KKy0JICBJbmRleGVkU291cmNlTWFwQ29uc3VtZXIucHJvdG90eXBlLnNvdXJjZUNvbnRlbnRG
b3IgPQorLQkgICAgZnVuY3Rpb24gSW5kZXhlZFNvdXJjZU1hcENvbnN1bWVyX3NvdXJjZUNvbnRl
bnRGb3IoYVNvdXJjZSwgbnVsbE9uTWlzc2luZykgeworLQkgICAgICBmb3IgKHZhciBpID0gMDsg
aSA8IHRoaXMuX3NlY3Rpb25zLmxlbmd0aDsgaSsrKSB7CistCSAgICAgICAgdmFyIHNlY3Rpb24g
PSB0aGlzLl9zZWN0aW9uc1tpXTsKKy0KKy0JICAgICAgICB2YXIgY29udGVudCA9IHNlY3Rpb24u
Y29uc3VtZXIuc291cmNlQ29udGVudEZvcihhU291cmNlLCB0cnVlKTsKKy0JICAgICAgICBpZiAo
Y29udGVudCkgeworLQkgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7CistCSAgICAgICAgfQorLQkg
ICAgICB9CistCSAgICAgIGlmIChudWxsT25NaXNzaW5nKSB7CistCSAgICAgICAgcmV0dXJuIG51
bGw7CistCSAgICAgIH0KKy0JICAgICAgZWxzZSB7CistCSAgICAgICAgdGhyb3cgbmV3IEVycm9y
KCciJyArIGFTb3VyY2UgKyAnIiBpcyBub3QgaW4gdGhlIFNvdXJjZU1hcC4nKTsKKy0JICAgICAg
fQorLQkgICAgfTsKKy0KKy0JICAvKioKKy0JICAgKiBSZXR1cm5zIHRoZSBnZW5lcmF0ZWQgbGlu
ZSBhbmQgY29sdW1uIGluZm9ybWF0aW9uIGZvciB0aGUgb3JpZ2luYWwgc291cmNlLAorLQkgICAq
IGxpbmUsIGFuZCBjb2x1bW4gcG9zaXRpb25zIHByb3ZpZGVkLiBUaGUgb25seSBhcmd1bWVudCBp
cyBhbiBvYmplY3Qgd2l0aAorLQkgICAqIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllczoKKy0JICAg
KgorLQkgICAqICAgLSBzb3VyY2U6IFRoZSBmaWxlbmFtZSBvZiB0aGUgb3JpZ2luYWwgc291cmNl
LgorLQkgICAqICAgLSBsaW5lOiBUaGUgbGluZSBudW1iZXIgaW4gdGhlIG9yaWdpbmFsIHNvdXJj
ZS4KKy0JICAgKiAgIC0gY29sdW1uOiBUaGUgY29sdW1uIG51bWJlciBpbiB0aGUgb3JpZ2luYWwg
c291cmNlLgorLQkgICAqCistCSAgICogYW5kIGFuIG9iamVjdCBpcyByZXR1cm5lZCB3aXRoIHRo
ZSBmb2xsb3dpbmcgcHJvcGVydGllczoKKy0JICAgKgorLQkgICAqICAgLSBsaW5lOiBUaGUgbGlu
ZSBudW1iZXIgaW4gdGhlIGdlbmVyYXRlZCBzb3VyY2UsIG9yIG51bGwuCistCSAgICogICAtIGNv
bHVtbjogVGhlIGNvbHVtbiBudW1iZXIgaW4gdGhlIGdlbmVyYXRlZCBzb3VyY2UsIG9yIG51bGwu
CistCSAgICovCistCSAgSW5kZXhlZFNvdXJjZU1hcENvbnN1bWVyLnByb3RvdHlwZS5nZW5lcmF0
ZWRQb3NpdGlvbkZvciA9CistCSAgICBmdW5jdGlvbiBJbmRleGVkU291cmNlTWFwQ29uc3VtZXJf
Z2VuZXJhdGVkUG9zaXRpb25Gb3IoYUFyZ3MpIHsKKy0JICAgICAgZm9yICh2YXIgaSA9IDA7IGkg
PCB0aGlzLl9zZWN0aW9ucy5sZW5ndGg7IGkrKykgeworLQkgICAgICAgIHZhciBzZWN0aW9uID0g
dGhpcy5fc2VjdGlvbnNbaV07CistCistCSAgICAgICAgLy8gT25seSBjb25zaWRlciB0aGlzIHNl
Y3Rpb24gaWYgdGhlIHJlcXVlc3RlZCBzb3VyY2UgaXMgaW4gdGhlIGxpc3Qgb2YKKy0JICAgICAg
ICAvLyBzb3VyY2VzIG9mIHRoZSBjb25zdW1lci4KKy0JICAgICAgICBpZiAoc2VjdGlvbi5jb25z
dW1lci5zb3VyY2VzLmluZGV4T2YodXRpbC5nZXRBcmcoYUFyZ3MsICdzb3VyY2UnKSkgPT09IC0x
KSB7CistCSAgICAgICAgICBjb250aW51ZTsKKy0JICAgICAgICB9CistCSAgICAgICAgdmFyIGdl
bmVyYXRlZFBvc2l0aW9uID0gc2VjdGlvbi5jb25zdW1lci5nZW5lcmF0ZWRQb3NpdGlvbkZvcihh
QXJncyk7CistCSAgICAgICAgaWYgKGdlbmVyYXRlZFBvc2l0aW9uKSB7CistCSAgICAgICAgICB2
YXIgcmV0ID0geworLQkgICAgICAgICAgICBsaW5lOiBnZW5lcmF0ZWRQb3NpdGlvbi5saW5lICsK
Ky0JICAgICAgICAgICAgICAoc2VjdGlvbi5nZW5lcmF0ZWRPZmZzZXQuZ2VuZXJhdGVkTGluZSAt
IDEpLAorLQkgICAgICAgICAgICBjb2x1bW46IGdlbmVyYXRlZFBvc2l0aW9uLmNvbHVtbiArCist
CSAgICAgICAgICAgICAgKHNlY3Rpb24uZ2VuZXJhdGVkT2Zmc2V0LmdlbmVyYXRlZExpbmUgPT09
IGdlbmVyYXRlZFBvc2l0aW9uLmxpbmUKKy0JICAgICAgICAgICAgICAgPyBzZWN0aW9uLmdlbmVy
YXRlZE9mZnNldC5nZW5lcmF0ZWRDb2x1bW4gLSAxCistCSAgICAgICAgICAgICAgIDogMCkKKy0J
ICAgICAgICAgIH07CistCSAgICAgICAgICByZXR1cm4gcmV0OworLQkgICAgICAgIH0KKy0JICAg
ICAgfQorLQorLQkgICAgICByZXR1cm4geworLQkgICAgICAgIGxpbmU6IG51bGwsCistCSAgICAg
ICAgY29sdW1uOiBudWxsCistCSAgICAgIH07CistCSAgICB9OworLQorLQkgIC8qKgorLQkgICAq
IFBhcnNlIHRoZSBtYXBwaW5ncyBpbiBhIHN0cmluZyBpbiB0byBhIGRhdGEgc3RydWN0dXJlIHdo
aWNoIHdlIGNhbiBlYXNpbHkKKy0JICAgKiBxdWVyeSAodGhlIG9yZGVyZWQgYXJyYXlzIGluIHRo
ZSBgdGhpcy5fX2dlbmVyYXRlZE1hcHBpbmdzYCBhbmQKKy0JICAgKiBgdGhpcy5fX29yaWdpbmFs
TWFwcGluZ3NgIHByb3BlcnRpZXMpLgorLQkgICAqLworLQkgIEluZGV4ZWRTb3VyY2VNYXBDb25z
dW1lci5wcm90b3R5cGUuX3BhcnNlTWFwcGluZ3MgPQorLQkgICAgZnVuY3Rpb24gSW5kZXhlZFNv
dXJjZU1hcENvbnN1bWVyX3BhcnNlTWFwcGluZ3MoYVN0ciwgYVNvdXJjZVJvb3QpIHsKKy0JICAg
ICAgdGhpcy5fX2dlbmVyYXRlZE1hcHBpbmdzID0gW107CistCSAgICAgIHRoaXMuX19vcmlnaW5h
bE1hcHBpbmdzID0gW107CistCSAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fc2VjdGlv
bnMubGVuZ3RoOyBpKyspIHsKKy0JICAgICAgICB2YXIgc2VjdGlvbiA9IHRoaXMuX3NlY3Rpb25z
W2ldOworLQkgICAgICAgIHZhciBzZWN0aW9uTWFwcGluZ3MgPSBzZWN0aW9uLmNvbnN1bWVyLl9n
ZW5lcmF0ZWRNYXBwaW5nczsKKy0JICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHNlY3Rpb25N
YXBwaW5ncy5sZW5ndGg7IGorKykgeworLQkgICAgICAgICAgdmFyIG1hcHBpbmcgPSBzZWN0aW9u
TWFwcGluZ3Nbal07CistCistCSAgICAgICAgICB2YXIgc291cmNlID0gc2VjdGlvbi5jb25zdW1l
ci5fc291cmNlcy5hdChtYXBwaW5nLnNvdXJjZSk7CistCSAgICAgICAgICBpZiAoc2VjdGlvbi5j
b25zdW1lci5zb3VyY2VSb290ICE9PSBudWxsKSB7CistCSAgICAgICAgICAgIHNvdXJjZSA9IHV0
aWwuam9pbihzZWN0aW9uLmNvbnN1bWVyLnNvdXJjZVJvb3QsIHNvdXJjZSk7CistCSAgICAgICAg
ICB9CistCSAgICAgICAgICB0aGlzLl9zb3VyY2VzLmFkZChzb3VyY2UpOworLQkgICAgICAgICAg
c291cmNlID0gdGhpcy5fc291cmNlcy5pbmRleE9mKHNvdXJjZSk7CistCistCSAgICAgICAgICB2
YXIgbmFtZSA9IHNlY3Rpb24uY29uc3VtZXIuX25hbWVzLmF0KG1hcHBpbmcubmFtZSk7CistCSAg
ICAgICAgICB0aGlzLl9uYW1lcy5hZGQobmFtZSk7CistCSAgICAgICAgICBuYW1lID0gdGhpcy5f
bmFtZXMuaW5kZXhPZihuYW1lKTsKKy0KKy0JICAgICAgICAgIC8vIFRoZSBtYXBwaW5ncyBjb21p
bmcgZnJvbSB0aGUgY29uc3VtZXIgZm9yIHRoZSBzZWN0aW9uIGhhdmUKKy0JICAgICAgICAgIC8v
IGdlbmVyYXRlZCBwb3NpdGlvbnMgcmVsYXRpdmUgdG8gdGhlIHN0YXJ0IG9mIHRoZSBzZWN0aW9u
LCBzbyB3ZQorLQkgICAgICAgICAgLy8gbmVlZCB0byBvZmZzZXQgdGhlbSB0byBiZSByZWxhdGl2
ZSB0byB0aGUgc3RhcnQgb2YgdGhlIGNvbmNhdGVuYXRlZAorLQkgICAgICAgICAgLy8gZ2VuZXJh
dGVkIGZpbGUuCistCSAgICAgICAgICB2YXIgYWRqdXN0ZWRNYXBwaW5nID0geworLQkgICAgICAg
ICAgICBzb3VyY2U6IHNvdXJjZSwKKy0JICAgICAgICAgICAgZ2VuZXJhdGVkTGluZTogbWFwcGlu
Zy5nZW5lcmF0ZWRMaW5lICsKKy0JICAgICAgICAgICAgICAoc2VjdGlvbi5nZW5lcmF0ZWRPZmZz
ZXQuZ2VuZXJhdGVkTGluZSAtIDEpLAorLQkgICAgICAgICAgICBnZW5lcmF0ZWRDb2x1bW46IG1h
cHBpbmcuZ2VuZXJhdGVkQ29sdW1uICsKKy0JICAgICAgICAgICAgICAoc2VjdGlvbi5nZW5lcmF0
ZWRPZmZzZXQuZ2VuZXJhdGVkTGluZSA9PT0gbWFwcGluZy5nZW5lcmF0ZWRMaW5lCistCSAgICAg
ICAgICAgICAgPyBzZWN0aW9uLmdlbmVyYXRlZE9mZnNldC5nZW5lcmF0ZWRDb2x1bW4gLSAxCist
CSAgICAgICAgICAgICAgOiAwKSwKKy0JICAgICAgICAgICAgb3JpZ2luYWxMaW5lOiBtYXBwaW5n
Lm9yaWdpbmFsTGluZSwKKy0JICAgICAgICAgICAgb3JpZ2luYWxDb2x1bW46IG1hcHBpbmcub3Jp
Z2luYWxDb2x1bW4sCistCSAgICAgICAgICAgIG5hbWU6IG5hbWUKKy0JICAgICAgICAgIH07Cist
CistCSAgICAgICAgICB0aGlzLl9fZ2VuZXJhdGVkTWFwcGluZ3MucHVzaChhZGp1c3RlZE1hcHBp
bmcpOworLQkgICAgICAgICAgaWYgKHR5cGVvZiBhZGp1c3RlZE1hcHBpbmcub3JpZ2luYWxMaW5l
ID09PSAnbnVtYmVyJykgeworLQkgICAgICAgICAgICB0aGlzLl9fb3JpZ2luYWxNYXBwaW5ncy5w
dXNoKGFkanVzdGVkTWFwcGluZyk7CistCSAgICAgICAgICB9CistCSAgICAgICAgfQorLQkgICAg
ICB9CistCistCSAgICAgIHF1aWNrU29ydCh0aGlzLl9fZ2VuZXJhdGVkTWFwcGluZ3MsIHV0aWwu
Y29tcGFyZUJ5R2VuZXJhdGVkUG9zaXRpb25zRGVmbGF0ZWQpOworLQkgICAgICBxdWlja1NvcnQo
dGhpcy5fX29yaWdpbmFsTWFwcGluZ3MsIHV0aWwuY29tcGFyZUJ5T3JpZ2luYWxQb3NpdGlvbnMp
OworLQkgICAgfTsKKy0KKy0JICBleHBvcnRzLkluZGV4ZWRTb3VyY2VNYXBDb25zdW1lciA9IElu
ZGV4ZWRTb3VyY2VNYXBDb25zdW1lcjsKKy0JfQorLQorLQorLS8qKiovIH0sCistLyogOCAqLwor
LS8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykgeworLQorLQkvKiAtKi0gTW9kZToganM7
IGpzLWluZGVudC1sZXZlbDogMjsgLSotICovCistCS8qCistCSAqIENvcHlyaWdodCAyMDExIE1v
emlsbGEgRm91bmRhdGlvbiBhbmQgY29udHJpYnV0b3JzCistCSAqIExpY2Vuc2VkIHVuZGVyIHRo
ZSBOZXcgQlNEIGxpY2Vuc2UuIFNlZSBMSUNFTlNFIG9yOgorLQkgKiBodHRwOi8vb3BlbnNvdXJj
ZS5vcmcvbGljZW5zZXMvQlNELTMtQ2xhdXNlCistCSAqLworLQl7CistCSAgZXhwb3J0cy5HUkVB
VEVTVF9MT1dFUl9CT1VORCA9IDE7CistCSAgZXhwb3J0cy5MRUFTVF9VUFBFUl9CT1VORCA9IDI7
CistCistCSAgLyoqCistCSAgICogUmVjdXJzaXZlIGltcGxlbWVudGF0aW9uIG9mIGJpbmFyeSBz
ZWFyY2guCistCSAgICoKKy0JICAgKiBAcGFyYW0gYUxvdyBJbmRpY2VzIGhlcmUgYW5kIGxvd2Vy
IGRvIG5vdCBjb250YWluIHRoZSBuZWVkbGUuCistCSAgICogQHBhcmFtIGFIaWdoIEluZGljZXMg
aGVyZSBhbmQgaGlnaGVyIGRvIG5vdCBjb250YWluIHRoZSBuZWVkbGUuCistCSAgICogQHBhcmFt
IGFOZWVkbGUgVGhlIGVsZW1lbnQgYmVpbmcgc2VhcmNoZWQgZm9yLgorLQkgICAqIEBwYXJhbSBh
SGF5c3RhY2sgVGhlIG5vbi1lbXB0eSBhcnJheSBiZWluZyBzZWFyY2hlZC4KKy0JICAgKiBAcGFy
YW0gYUNvbXBhcmUgRnVuY3Rpb24gd2hpY2ggdGFrZXMgdHdvIGVsZW1lbnRzIGFuZCByZXR1cm5z
IC0xLCAwLCBvciAxLgorLQkgICAqIEBwYXJhbSBhQmlhcyBFaXRoZXIgJ2JpbmFyeVNlYXJjaC5H
UkVBVEVTVF9MT1dFUl9CT1VORCcgb3IKKy0JICAgKiAgICAgJ2JpbmFyeVNlYXJjaC5MRUFTVF9V
UFBFUl9CT1VORCcuIFNwZWNpZmllcyB3aGV0aGVyIHRvIHJldHVybiB0aGUKKy0JICAgKiAgICAg
Y2xvc2VzdCBlbGVtZW50IHRoYXQgaXMgc21hbGxlciB0aGFuIG9yIGdyZWF0ZXIgdGhhbiB0aGUg
b25lIHdlIGFyZQorLQkgICAqICAgICBzZWFyY2hpbmcgZm9yLCByZXNwZWN0aXZlbHksIGlmIHRo
ZSBleGFjdCBlbGVtZW50IGNhbm5vdCBiZSBmb3VuZC4KKy0JICAgKi8KKy0JICBmdW5jdGlvbiBy
ZWN1cnNpdmVTZWFyY2goYUxvdywgYUhpZ2gsIGFOZWVkbGUsIGFIYXlzdGFjaywgYUNvbXBhcmUs
IGFCaWFzKSB7CistCSAgICAvLyBUaGlzIGZ1bmN0aW9uIHRlcm1pbmF0ZXMgd2hlbiBvbmUgb2Yg
dGhlIGZvbGxvd2luZyBpcyB0cnVlOgorLQkgICAgLy8KKy0JICAgIC8vICAgMS4gV2UgZmluZCB0
aGUgZXhhY3QgZWxlbWVudCB3ZSBhcmUgbG9va2luZyBmb3IuCistCSAgICAvLworLQkgICAgLy8g
ICAyLiBXZSBkaWQgbm90IGZpbmQgdGhlIGV4YWN0IGVsZW1lbnQsIGJ1dCB3ZSBjYW4gcmV0dXJu
IHRoZSBpbmRleCBvZgorLQkgICAgLy8gICAgICB0aGUgbmV4dC1jbG9zZXN0IGVsZW1lbnQuCist
CSAgICAvLworLQkgICAgLy8gICAzLiBXZSBkaWQgbm90IGZpbmQgdGhlIGV4YWN0IGVsZW1lbnQs
IGFuZCB0aGVyZSBpcyBubyBuZXh0LWNsb3Nlc3QKKy0JICAgIC8vICAgICAgZWxlbWVudCB0aGFu
IHRoZSBvbmUgd2UgYXJlIHNlYXJjaGluZyBmb3IsIHNvIHdlIHJldHVybiAtMS4KKy0JICAgIHZh
ciBtaWQgPSBNYXRoLmZsb29yKChhSGlnaCAtIGFMb3cpIC8gMikgKyBhTG93OworLQkgICAgdmFy
IGNtcCA9IGFDb21wYXJlKGFOZWVkbGUsIGFIYXlzdGFja1ttaWRdLCB0cnVlKTsKKy0JICAgIGlm
IChjbXAgPT09IDApIHsKKy0JICAgICAgLy8gRm91bmQgdGhlIGVsZW1lbnQgd2UgYXJlIGxvb2tp
bmcgZm9yLgorLQkgICAgICByZXR1cm4gbWlkOworLQkgICAgfQorLQkgICAgZWxzZSBpZiAoY21w
ID4gMCkgeworLQkgICAgICAvLyBPdXIgbmVlZGxlIGlzIGdyZWF0ZXIgdGhhbiBhSGF5c3RhY2tb
bWlkXS4KKy0JICAgICAgaWYgKGFIaWdoIC0gbWlkID4gMSkgeworLQkgICAgICAgIC8vIFRoZSBl
bGVtZW50IGlzIGluIHRoZSB1cHBlciBoYWxmLgorLQkgICAgICAgIHJldHVybiByZWN1cnNpdmVT
ZWFyY2gobWlkLCBhSGlnaCwgYU5lZWRsZSwgYUhheXN0YWNrLCBhQ29tcGFyZSwgYUJpYXMpOwor
LQkgICAgICB9CistCistCSAgICAgIC8vIFRoZSBleGFjdCBuZWVkbGUgZWxlbWVudCB3YXMgbm90
IGZvdW5kIGluIHRoaXMgaGF5c3RhY2suIERldGVybWluZSBpZgorLQkgICAgICAvLyB3ZSBhcmUg
aW4gdGVybWluYXRpb24gY2FzZSAoMykgb3IgKDIpIGFuZCByZXR1cm4gdGhlIGFwcHJvcHJpYXRl
IHRoaW5nLgorLQkgICAgICBpZiAoYUJpYXMgPT0gZXhwb3J0cy5MRUFTVF9VUFBFUl9CT1VORCkg
eworLQkgICAgICAgIHJldHVybiBhSGlnaCA8IGFIYXlzdGFjay5sZW5ndGggPyBhSGlnaCA6IC0x
OworLQkgICAgICB9IGVsc2UgeworLQkgICAgICAgIHJldHVybiBtaWQ7CistCSAgICAgIH0KKy0J
ICAgIH0KKy0JICAgIGVsc2UgeworLQkgICAgICAvLyBPdXIgbmVlZGxlIGlzIGxlc3MgdGhhbiBh
SGF5c3RhY2tbbWlkXS4KKy0JICAgICAgaWYgKG1pZCAtIGFMb3cgPiAxKSB7CistCSAgICAgICAg
Ly8gVGhlIGVsZW1lbnQgaXMgaW4gdGhlIGxvd2VyIGhhbGYuCistCSAgICAgICAgcmV0dXJuIHJl
Y3Vyc2l2ZVNlYXJjaChhTG93LCBtaWQsIGFOZWVkbGUsIGFIYXlzdGFjaywgYUNvbXBhcmUsIGFC
aWFzKTsKKy0JICAgICAgfQorLQorLQkgICAgICAvLyB3ZSBhcmUgaW4gdGVybWluYXRpb24gY2Fz
ZSAoMykgb3IgKDIpIGFuZCByZXR1cm4gdGhlIGFwcHJvcHJpYXRlIHRoaW5nLgorLQkgICAgICBp
ZiAoYUJpYXMgPT0gZXhwb3J0cy5MRUFTVF9VUFBFUl9CT1VORCkgeworLQkgICAgICAgIHJldHVy
biBtaWQ7CistCSAgICAgIH0gZWxzZSB7CistCSAgICAgICAgcmV0dXJuIGFMb3cgPCAwID8gLTEg
OiBhTG93OworLQkgICAgICB9CistCSAgICB9CistCSAgfQorLQorLQkgIC8qKgorLQkgICAqIFRo
aXMgaXMgYW4gaW1wbGVtZW50YXRpb24gb2YgYmluYXJ5IHNlYXJjaCB3aGljaCB3aWxsIGFsd2F5
cyB0cnkgYW5kIHJldHVybgorLQkgICAqIHRoZSBpbmRleCBvZiB0aGUgY2xvc2VzdCBlbGVtZW50
IGlmIHRoZXJlIGlzIG5vIGV4YWN0IGhpdC4gVGhpcyBpcyBiZWNhdXNlCistCSAgICogbWFwcGlu
Z3MgYmV0d2VlbiBvcmlnaW5hbCBhbmQgZ2VuZXJhdGVkIGxpbmUvY29sIHBhaXJzIGFyZSBzaW5n
bGUgcG9pbnRzLAorLQkgICAqIGFuZCB0aGVyZSBpcyBhbiBpbXBsaWNpdCByZWdpb24gYmV0d2Vl
biBlYWNoIG9mIHRoZW0sIHNvIGEgbWlzcyBqdXN0IG1lYW5zCistCSAgICogdGhhdCB5b3UgYXJl
bid0IG9uIHRoZSB2ZXJ5IHN0YXJ0IG9mIGEgcmVnaW9uLgorLQkgICAqCistCSAgICogQHBhcmFt
IGFOZWVkbGUgVGhlIGVsZW1lbnQgeW91IGFyZSBsb29raW5nIGZvci4KKy0JICAgKiBAcGFyYW0g
YUhheXN0YWNrIFRoZSBhcnJheSB0aGF0IGlzIGJlaW5nIHNlYXJjaGVkLgorLQkgICAqIEBwYXJh
bSBhQ29tcGFyZSBBIGZ1bmN0aW9uIHdoaWNoIHRha2VzIHRoZSBuZWVkbGUgYW5kIGFuIGVsZW1l
bnQgaW4gdGhlCistCSAgICogICAgIGFycmF5IGFuZCByZXR1cm5zIC0xLCAwLCBvciAxIGRlcGVu
ZGluZyBvbiB3aGV0aGVyIHRoZSBuZWVkbGUgaXMgbGVzcworLQkgICAqICAgICB0aGFuLCBlcXVh
bCB0bywgb3IgZ3JlYXRlciB0aGFuIHRoZSBlbGVtZW50LCByZXNwZWN0aXZlbHkuCistCSAgICog
QHBhcmFtIGFCaWFzIEVpdGhlciAnYmluYXJ5U2VhcmNoLkdSRUFURVNUX0xPV0VSX0JPVU5EJyBv
cgorLQkgICAqICAgICAnYmluYXJ5U2VhcmNoLkxFQVNUX1VQUEVSX0JPVU5EJy4gU3BlY2lmaWVz
IHdoZXRoZXIgdG8gcmV0dXJuIHRoZQorLQkgICAqICAgICBjbG9zZXN0IGVsZW1lbnQgdGhhdCBp
cyBzbWFsbGVyIHRoYW4gb3IgZ3JlYXRlciB0aGFuIHRoZSBvbmUgd2UgYXJlCistCSAgICogICAg
IHNlYXJjaGluZyBmb3IsIHJlc3BlY3RpdmVseSwgaWYgdGhlIGV4YWN0IGVsZW1lbnQgY2Fubm90
IGJlIGZvdW5kLgorLQkgICAqICAgICBEZWZhdWx0cyB0byAnYmluYXJ5U2VhcmNoLkdSRUFURVNU
X0xPV0VSX0JPVU5EJy4KKy0JICAgKi8KKy0JICBleHBvcnRzLnNlYXJjaCA9IGZ1bmN0aW9uIHNl
YXJjaChhTmVlZGxlLCBhSGF5c3RhY2ssIGFDb21wYXJlLCBhQmlhcykgeworLQkgICAgaWYgKGFI
YXlzdGFjay5sZW5ndGggPT09IDApIHsKKy0JICAgICAgcmV0dXJuIC0xOworLQkgICAgfQorLQor
LQkgICAgdmFyIGluZGV4ID0gcmVjdXJzaXZlU2VhcmNoKC0xLCBhSGF5c3RhY2subGVuZ3RoLCBh
TmVlZGxlLCBhSGF5c3RhY2ssCistCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYUNv
bXBhcmUsIGFCaWFzIHx8IGV4cG9ydHMuR1JFQVRFU1RfTE9XRVJfQk9VTkQpOworLQkgICAgaWYg
KGluZGV4IDwgMCkgeworLQkgICAgICByZXR1cm4gLTE7CistCSAgICB9CistCistCSAgICAvLyBX
ZSBoYXZlIGZvdW5kIGVpdGhlciB0aGUgZXhhY3QgZWxlbWVudCwgb3IgdGhlIG5leHQtY2xvc2Vz
dCBlbGVtZW50IHRoYW4KKy0JICAgIC8vIHRoZSBvbmUgd2UgYXJlIHNlYXJjaGluZyBmb3IuIEhv
d2V2ZXIsIHRoZXJlIG1heSBiZSBtb3JlIHRoYW4gb25lIHN1Y2gKKy0JICAgIC8vIGVsZW1lbnQu
IE1ha2Ugc3VyZSB3ZSBhbHdheXMgcmV0dXJuIHRoZSBzbWFsbGVzdCBvZiB0aGVzZS4KKy0JICAg
IHdoaWxlIChpbmRleCAtIDEgPj0gMCkgeworLQkgICAgICBpZiAoYUNvbXBhcmUoYUhheXN0YWNr
W2luZGV4XSwgYUhheXN0YWNrW2luZGV4IC0gMV0sIHRydWUpICE9PSAwKSB7CistCSAgICAgICAg
YnJlYWs7CistCSAgICAgIH0KKy0JICAgICAgLS1pbmRleDsKKy0JICAgIH0KKy0KKy0JICAgIHJl
dHVybiBpbmRleDsKKy0JICB9OworLQl9CistCistCistLyoqKi8gfSwKKy0vKiA5ICovCistLyoq
Ki8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7CistCistCS8qIC0qLSBNb2RlOiBqczsganMt
aW5kZW50LWxldmVsOiAyOyAtKi0gKi8KKy0JLyoKKy0JICogQ29weXJpZ2h0IDIwMTEgTW96aWxs
YSBGb3VuZGF0aW9uIGFuZCBjb250cmlidXRvcnMKKy0JICogTGljZW5zZWQgdW5kZXIgdGhlIE5l
dyBCU0QgbGljZW5zZS4gU2VlIExJQ0VOU0Ugb3I6CistCSAqIGh0dHA6Ly9vcGVuc291cmNlLm9y
Zy9saWNlbnNlcy9CU0QtMy1DbGF1c2UKKy0JICovCistCXsKKy0JICAvLyBJdCB0dXJucyBvdXQg
dGhhdCBzb21lIChtb3N0PykgSmF2YVNjcmlwdCBlbmdpbmVzIGRvbid0IHNlbGYtaG9zdAorLQkg
IC8vIGBBcnJheS5wcm90b3R5cGUuc29ydGAuIFRoaXMgbWFrZXMgc2Vuc2UgYmVjYXVzZSBDKysg
d2lsbCBsaWtlbHkgcmVtYWluCistCSAgLy8gZmFzdGVyIHRoYW4gSlMgd2hlbiBkb2luZyByYXcg
Q1BVLWludGVuc2l2ZSBzb3J0aW5nLiBIb3dldmVyLCB3aGVuIHVzaW5nIGEKKy0JICAvLyBjdXN0
b20gY29tcGFyYXRvciBmdW5jdGlvbiwgY2FsbGluZyBiYWNrIGFuZCBmb3J0aCBiZXR3ZWVuIHRo
ZSBWTSdzIEMrKyBhbmQKKy0JICAvLyBKSVQnZCBKUyBpcyByYXRoZXIgc2xvdyAqYW5kKiBsb3Nl
cyBKSVQgdHlwZSBpbmZvcm1hdGlvbiwgcmVzdWx0aW5nIGluCistCSAgLy8gd29yc2UgZ2VuZXJh
dGVkIGNvZGUgZm9yIHRoZSBjb21wYXJhdG9yIGZ1bmN0aW9uIHRoYW4gd291bGQgYmUgb3B0aW1h
bC4gSW4KKy0JICAvLyBmYWN0LCB3aGVuIHNvcnRpbmcgd2l0aCBhIGNvbXBhcmF0b3IsIHRoZXNl
IGNvc3RzIG91dHdlaWdoIHRoZSBiZW5lZml0cyBvZgorLQkgIC8vIHNvcnRpbmcgaW4gQysrLiBC
eSB1c2luZyBvdXIgb3duIEpTLWltcGxlbWVudGVkIFF1aWNrIFNvcnQgKGJlbG93KSwgd2UgZ2V0
CistCSAgLy8gYSB+MzUwMG1zIG1lYW4gc3BlZWQtdXAgaW4gYGJlbmNoL2JlbmNoLmh0bWxgLgor
LQorLQkgIC8qKgorLQkgICAqIFN3YXAgdGhlIGVsZW1lbnRzIGluZGV4ZWQgYnkgYHhgIGFuZCBg
eWAgaW4gdGhlIGFycmF5IGBhcnlgLgorLQkgICAqCistCSAgICogQHBhcmFtIHtBcnJheX0gYXJ5
CistCSAgICogICAgICAgIFRoZSBhcnJheS4KKy0JICAgKiBAcGFyYW0ge051bWJlcn0geAorLQkg
ICAqICAgICAgICBUaGUgaW5kZXggb2YgdGhlIGZpcnN0IGl0ZW0uCistCSAgICogQHBhcmFtIHtO
dW1iZXJ9IHkKKy0JICAgKiAgICAgICAgVGhlIGluZGV4IG9mIHRoZSBzZWNvbmQgaXRlbS4KKy0J
ICAgKi8KKy0JICBmdW5jdGlvbiBzd2FwKGFyeSwgeCwgeSkgeworLQkgICAgdmFyIHRlbXAgPSBh
cnlbeF07CistCSAgICBhcnlbeF0gPSBhcnlbeV07CistCSAgICBhcnlbeV0gPSB0ZW1wOworLQkg
IH0KKy0KKy0JICAvKioKKy0JICAgKiBSZXR1cm5zIGEgcmFuZG9tIGludGVnZXIgd2l0aGluIHRo
ZSByYW5nZSBgbG93IC4uIGhpZ2hgIGluY2x1c2l2ZS4KKy0JICAgKgorLQkgICAqIEBwYXJhbSB7
TnVtYmVyfSBsb3cKKy0JICAgKiAgICAgICAgVGhlIGxvd2VyIGJvdW5kIG9uIHRoZSByYW5nZS4K
Ky0JICAgKiBAcGFyYW0ge051bWJlcn0gaGlnaAorLQkgICAqICAgICAgICBUaGUgdXBwZXIgYm91
bmQgb24gdGhlIHJhbmdlLgorLQkgICAqLworLQkgIGZ1bmN0aW9uIHJhbmRvbUludEluUmFuZ2Uo
bG93LCBoaWdoKSB7CistCSAgICByZXR1cm4gTWF0aC5yb3VuZChsb3cgKyAoTWF0aC5yYW5kb20o
KSAqIChoaWdoIC0gbG93KSkpOworLQkgIH0KKy0KKy0JICAvKioKKy0JICAgKiBUaGUgUXVpY2sg
U29ydCBhbGdvcml0aG0uCistCSAgICoKKy0JICAgKiBAcGFyYW0ge0FycmF5fSBhcnkKKy0JICAg
KiAgICAgICAgQW4gYXJyYXkgdG8gc29ydC4KKy0JICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjb21w
YXJhdG9yCistCSAgICogICAgICAgIEZ1bmN0aW9uIHRvIHVzZSB0byBjb21wYXJlIHR3byBpdGVt
cy4KKy0JICAgKiBAcGFyYW0ge051bWJlcn0gcAorLQkgICAqICAgICAgICBTdGFydCBpbmRleCBv
ZiB0aGUgYXJyYXkKKy0JICAgKiBAcGFyYW0ge051bWJlcn0gcgorLQkgICAqICAgICAgICBFbmQg
aW5kZXggb2YgdGhlIGFycmF5CistCSAgICovCistCSAgZnVuY3Rpb24gZG9RdWlja1NvcnQoYXJ5
LCBjb21wYXJhdG9yLCBwLCByKSB7CistCSAgICAvLyBJZiBvdXIgbG93ZXIgYm91bmQgaXMgbGVz
cyB0aGFuIG91ciB1cHBlciBib3VuZCwgd2UgKDEpIHBhcnRpdGlvbiB0aGUKKy0JICAgIC8vIGFy
cmF5IGludG8gdHdvIHBpZWNlcyBhbmQgKDIpIHJlY3Vyc2Ugb24gZWFjaCBoYWxmLiBJZiBpdCBp
cyBub3QsIHRoaXMgaXMKKy0JICAgIC8vIHRoZSBlbXB0eSBhcnJheSBhbmQgb3VyIGJhc2UgY2Fz
ZS4KKy0KKy0JICAgIGlmIChwIDwgcikgeworLQkgICAgICAvLyAoMSkgUGFydGl0aW9uaW5nLgor
LQkgICAgICAvLworLQkgICAgICAvLyBUaGUgcGFydGl0aW9uaW5nIGNob29zZXMgYSBwaXZvdCBi
ZXR3ZWVuIGBwYCBhbmQgYHJgIGFuZCBtb3ZlcyBhbGwKKy0JICAgICAgLy8gZWxlbWVudHMgdGhh
dCBhcmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSBwaXZvdCB0byB0aGUgYmVmb3JlIGl0LCBh
bmQKKy0JICAgICAgLy8gYWxsIHRoZSBlbGVtZW50cyB0aGF0IGFyZSBncmVhdGVyIHRoYW4gaXQg
YWZ0ZXIgaXQuIFRoZSBlZmZlY3QgaXMgdGhhdAorLQkgICAgICAvLyBvbmNlIHBhcnRpdGlvbiBp
cyBkb25lLCB0aGUgcGl2b3QgaXMgaW4gdGhlIGV4YWN0IHBsYWNlIGl0IHdpbGwgYmUgd2hlbgor
LQkgICAgICAvLyB0aGUgYXJyYXkgaXMgcHV0IGluIHNvcnRlZCBvcmRlciwgYW5kIGl0IHdpbGwg
bm90IG5lZWQgdG8gYmUgbW92ZWQKKy0JICAgICAgLy8gYWdhaW4uIFRoaXMgcnVucyBpbiBPKG4p
IHRpbWUuCistCistCSAgICAgIC8vIEFsd2F5cyBjaG9vc2UgYSByYW5kb20gcGl2b3Qgc28gdGhh
dCBhbiBpbnB1dCBhcnJheSB3aGljaCBpcyByZXZlcnNlCistCSAgICAgIC8vIHNvcnRlZCBkb2Vz
IG5vdCBjYXVzZSBPKG5eMikgcnVubmluZyB0aW1lLgorLQkgICAgICB2YXIgcGl2b3RJbmRleCA9
IHJhbmRvbUludEluUmFuZ2UocCwgcik7CistCSAgICAgIHZhciBpID0gcCAtIDE7CistCistCSAg
ICAgIHN3YXAoYXJ5LCBwaXZvdEluZGV4LCByKTsKKy0JICAgICAgdmFyIHBpdm90ID0gYXJ5W3Jd
OworLQorLQkgICAgICAvLyBJbW1lZGlhdGVseSBhZnRlciBgamAgaXMgaW5jcmVtZW50ZWQgaW4g
dGhpcyBsb29wLCB0aGUgZm9sbG93aW5nIGhvbGQKKy0JICAgICAgLy8gdHJ1ZToKKy0JICAgICAg
Ly8KKy0JICAgICAgLy8gICAqIEV2ZXJ5IGVsZW1lbnQgaW4gYGFyeVtwIC4uIGldYCBpcyBsZXNz
IHRoYW4gb3IgZXF1YWwgdG8gdGhlIHBpdm90LgorLQkgICAgICAvLworLQkgICAgICAvLyAgICog
RXZlcnkgZWxlbWVudCBpbiBgYXJ5W2krMSAuLiBqLTFdYCBpcyBncmVhdGVyIHRoYW4gdGhlIHBp
dm90LgorLQkgICAgICBmb3IgKHZhciBqID0gcDsgaiA8IHI7IGorKykgeworLQkgICAgICAgIGlm
IChjb21wYXJhdG9yKGFyeVtqXSwgcGl2b3QpIDw9IDApIHsKKy0JICAgICAgICAgIGkgKz0gMTsK
Ky0JICAgICAgICAgIHN3YXAoYXJ5LCBpLCBqKTsKKy0JICAgICAgICB9CistCSAgICAgIH0KKy0K
Ky0JICAgICAgc3dhcChhcnksIGkgKyAxLCBqKTsKKy0JICAgICAgdmFyIHEgPSBpICsgMTsKKy0K
Ky0JICAgICAgLy8gKDIpIFJlY3Vyc2Ugb24gZWFjaCBoYWxmLgorLQorLQkgICAgICBkb1F1aWNr
U29ydChhcnksIGNvbXBhcmF0b3IsIHAsIHEgLSAxKTsKKy0JICAgICAgZG9RdWlja1NvcnQoYXJ5
LCBjb21wYXJhdG9yLCBxICsgMSwgcik7CistCSAgICB9CistCSAgfQorLQorLQkgIC8qKgorLQkg
ICAqIFNvcnQgdGhlIGdpdmVuIGFycmF5IGluLXBsYWNlIHdpdGggdGhlIGdpdmVuIGNvbXBhcmF0
b3IgZnVuY3Rpb24uCistCSAgICoKKy0JICAgKiBAcGFyYW0ge0FycmF5fSBhcnkKKy0JICAgKiAg
ICAgICAgQW4gYXJyYXkgdG8gc29ydC4KKy0JICAgKiBAcGFyYW0ge2Z1bmN0aW9ufSBjb21wYXJh
dG9yCistCSAgICogICAgICAgIEZ1bmN0aW9uIHRvIHVzZSB0byBjb21wYXJlIHR3byBpdGVtcy4K
Ky0JICAgKi8KKy0JICBleHBvcnRzLnF1aWNrU29ydCA9IGZ1bmN0aW9uIChhcnksIGNvbXBhcmF0
b3IpIHsKKy0JICAgIGRvUXVpY2tTb3J0KGFyeSwgY29tcGFyYXRvciwgMCwgYXJ5Lmxlbmd0aCAt
IDEpOworLQkgIH07CistCX0KKy0KKy0KKy0vKioqLyB9LAorLS8qIDEwICovCistLyoqKi8gZnVu
Y3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7CistCistCS8qIC0q
LSBNb2RlOiBqczsganMtaW5kZW50LWxldmVsOiAyOyAtKi0gKi8KKy0JLyoKKy0JICogQ29weXJp
Z2h0IDIwMTEgTW96aWxsYSBGb3VuZGF0aW9uIGFuZCBjb250cmlidXRvcnMKKy0JICogTGljZW5z
ZWQgdW5kZXIgdGhlIE5ldyBCU0QgbGljZW5zZS4gU2VlIExJQ0VOU0Ugb3I6CistCSAqIGh0dHA6
Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9CU0QtMy1DbGF1c2UKKy0JICovCistCXsKKy0JICB2
YXIgU291cmNlTWFwR2VuZXJhdG9yID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKS5Tb3VyY2VNYXBH
ZW5lcmF0b3I7CistCSAgdmFyIHV0aWwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDQpOworLQorLQkg
IC8vIE1hdGNoZXMgYSBXaW5kb3dzLXN0eWxlIGBcclxuYCBuZXdsaW5lIG9yIGEgYFxuYCBuZXds
aW5lIHVzZWQgYnkgYWxsIG90aGVyCistCSAgLy8gb3BlcmF0aW5nIHN5c3RlbXMgdGhlc2UgZGF5
cyAoY2FwdHVyaW5nIHRoZSByZXN1bHQpLgorLQkgIHZhciBSRUdFWF9ORVdMSU5FID0gLyhccj9c
bikvOworLQorLQkgIC8vIE5ld2xpbmUgY2hhcmFjdGVyIGNvZGUgZm9yIGNoYXJDb2RlQXQoKSBj
b21wYXJpc29ucworLQkgIHZhciBORVdMSU5FX0NPREUgPSAxMDsKKy0KKy0JICAvLyBQcml2YXRl
IHN5bWJvbCBmb3IgaWRlbnRpZnlpbmcgYFNvdXJjZU5vZGVgcyB3aGVuIG11bHRpcGxlIHZlcnNp
b25zIG9mCistCSAgLy8gdGhlIHNvdXJjZS1tYXAgbGlicmFyeSBhcmUgbG9hZGVkLiBUaGlzIE1V
U1QgTk9UIENIQU5HRSBhY3Jvc3MKKy0JICAvLyB2ZXJzaW9ucyEKKy0JICB2YXIgaXNTb3VyY2VO
b2RlID0gIiQkJGlzU291cmNlTm9kZSQkJCI7CistCistCSAgLyoqCistCSAgICogU291cmNlTm9k
ZXMgcHJvdmlkZSBhIHdheSB0byBhYnN0cmFjdCBvdmVyIGludGVycG9sYXRpbmcvY29uY2F0ZW5h
dGluZworLQkgICAqIHNuaXBwZXRzIG9mIGdlbmVyYXRlZCBKYXZhU2NyaXB0IHNvdXJjZSBjb2Rl
IHdoaWxlIG1haW50YWluaW5nIHRoZSBsaW5lIGFuZAorLQkgICAqIGNvbHVtbiBpbmZvcm1hdGlv
biBhc3NvY2lhdGVkIHdpdGggdGhlIG9yaWdpbmFsIHNvdXJjZSBjb2RlLgorLQkgICAqCistCSAg
ICogQHBhcmFtIGFMaW5lIFRoZSBvcmlnaW5hbCBsaW5lIG51bWJlci4KKy0JICAgKiBAcGFyYW0g
YUNvbHVtbiBUaGUgb3JpZ2luYWwgY29sdW1uIG51bWJlci4KKy0JICAgKiBAcGFyYW0gYVNvdXJj
ZSBUaGUgb3JpZ2luYWwgc291cmNlJ3MgZmlsZW5hbWUuCistCSAgICogQHBhcmFtIGFDaHVua3Mg
T3B0aW9uYWwuIEFuIGFycmF5IG9mIHN0cmluZ3Mgd2hpY2ggYXJlIHNuaXBwZXRzIG9mCistCSAg
ICogICAgICAgIGdlbmVyYXRlZCBKUywgb3Igb3RoZXIgU291cmNlTm9kZXMuCistCSAgICogQHBh
cmFtIGFOYW1lIFRoZSBvcmlnaW5hbCBpZGVudGlmaWVyLgorLQkgICAqLworLQkgIGZ1bmN0aW9u
IFNvdXJjZU5vZGUoYUxpbmUsIGFDb2x1bW4sIGFTb3VyY2UsIGFDaHVua3MsIGFOYW1lKSB7Cist
CSAgICB0aGlzLmNoaWxkcmVuID0gW107CistCSAgICB0aGlzLnNvdXJjZUNvbnRlbnRzID0ge307
CistCSAgICB0aGlzLmxpbmUgPSBhTGluZSA9PSBudWxsID8gbnVsbCA6IGFMaW5lOworLQkgICAg
dGhpcy5jb2x1bW4gPSBhQ29sdW1uID09IG51bGwgPyBudWxsIDogYUNvbHVtbjsKKy0JICAgIHRo
aXMuc291cmNlID0gYVNvdXJjZSA9PSBudWxsID8gbnVsbCA6IGFTb3VyY2U7CistCSAgICB0aGlz
Lm5hbWUgPSBhTmFtZSA9PSBudWxsID8gbnVsbCA6IGFOYW1lOworLQkgICAgdGhpc1tpc1NvdXJj
ZU5vZGVdID0gdHJ1ZTsKKy0JICAgIGlmIChhQ2h1bmtzICE9IG51bGwpIHRoaXMuYWRkKGFDaHVu
a3MpOworLQkgIH0KKy0KKy0JICAvKioKKy0JICAgKiBDcmVhdGVzIGEgU291cmNlTm9kZSBmcm9t
IGdlbmVyYXRlZCBjb2RlIGFuZCBhIFNvdXJjZU1hcENvbnN1bWVyLgorLQkgICAqCistCSAgICog
QHBhcmFtIGFHZW5lcmF0ZWRDb2RlIFRoZSBnZW5lcmF0ZWQgY29kZQorLQkgICAqIEBwYXJhbSBh
U291cmNlTWFwQ29uc3VtZXIgVGhlIFNvdXJjZU1hcCBmb3IgdGhlIGdlbmVyYXRlZCBjb2RlCist
CSAgICogQHBhcmFtIGFSZWxhdGl2ZVBhdGggT3B0aW9uYWwuIFRoZSBwYXRoIHRoYXQgcmVsYXRp
dmUgc291cmNlcyBpbiB0aGUKKy0JICAgKiAgICAgICAgU291cmNlTWFwQ29uc3VtZXIgc2hvdWxk
IGJlIHJlbGF0aXZlIHRvLgorLQkgICAqLworLQkgIFNvdXJjZU5vZGUuZnJvbVN0cmluZ1dpdGhT
b3VyY2VNYXAgPQorLQkgICAgZnVuY3Rpb24gU291cmNlTm9kZV9mcm9tU3RyaW5nV2l0aFNvdXJj
ZU1hcChhR2VuZXJhdGVkQ29kZSwgYVNvdXJjZU1hcENvbnN1bWVyLCBhUmVsYXRpdmVQYXRoKSB7
CistCSAgICAgIC8vIFRoZSBTb3VyY2VOb2RlIHdlIHdhbnQgdG8gZmlsbCB3aXRoIHRoZSBnZW5l
cmF0ZWQgY29kZQorLQkgICAgICAvLyBhbmQgdGhlIFNvdXJjZU1hcAorLQkgICAgICB2YXIgbm9k
ZSA9IG5ldyBTb3VyY2VOb2RlKCk7CistCistCSAgICAgIC8vIEFsbCBldmVuIGluZGljZXMgb2Yg
dGhpcyBhcnJheSBhcmUgb25lIGxpbmUgb2YgdGhlIGdlbmVyYXRlZCBjb2RlLAorLQkgICAgICAv
LyB3aGlsZSBhbGwgb2RkIGluZGljZXMgYXJlIHRoZSBuZXdsaW5lcyBiZXR3ZWVuIHR3byBhZGph
Y2VudCBsaW5lcworLQkgICAgICAvLyAoc2luY2UgYFJFR0VYX05FV0xJTkVgIGNhcHR1cmVzIGl0
cyBtYXRjaCkuCistCSAgICAgIC8vIFByb2Nlc3NlZCBmcmFnbWVudHMgYXJlIHJlbW92ZWQgZnJv
bSB0aGlzIGFycmF5LCBieSBjYWxsaW5nIGBzaGlmdE5leHRMaW5lYC4KKy0JICAgICAgdmFyIHJl
bWFpbmluZ0xpbmVzID0gYUdlbmVyYXRlZENvZGUuc3BsaXQoUkVHRVhfTkVXTElORSk7CistCSAg
ICAgIHZhciBzaGlmdE5leHRMaW5lID0gZnVuY3Rpb24oKSB7CistCSAgICAgICAgdmFyIGxpbmVD
b250ZW50cyA9IHJlbWFpbmluZ0xpbmVzLnNoaWZ0KCk7CistCSAgICAgICAgLy8gVGhlIGxhc3Qg
bGluZSBvZiBhIGZpbGUgbWlnaHQgbm90IGhhdmUgYSBuZXdsaW5lLgorLQkgICAgICAgIHZhciBu
ZXdMaW5lID0gcmVtYWluaW5nTGluZXMuc2hpZnQoKSB8fCAiIjsKKy0JICAgICAgICByZXR1cm4g
bGluZUNvbnRlbnRzICsgbmV3TGluZTsKKy0JICAgICAgfTsKKy0KKy0JICAgICAgLy8gV2UgbmVl
ZCB0byByZW1lbWJlciB0aGUgcG9zaXRpb24gb2YgInJlbWFpbmluZ0xpbmVzIgorLQkgICAgICB2
YXIgbGFzdEdlbmVyYXRlZExpbmUgPSAxLCBsYXN0R2VuZXJhdGVkQ29sdW1uID0gMDsKKy0KKy0J
ICAgICAgLy8gVGhlIGdlbmVyYXRlIFNvdXJjZU5vZGVzIHdlIG5lZWQgYSBjb2RlIHJhbmdlLgor
LQkgICAgICAvLyBUbyBleHRyYWN0IGl0IGN1cnJlbnQgYW5kIGxhc3QgbWFwcGluZyBpcyB1c2Vk
LgorLQkgICAgICAvLyBIZXJlIHdlIHN0b3JlIHRoZSBsYXN0IG1hcHBpbmcuCistCSAgICAgIHZh
ciBsYXN0TWFwcGluZyA9IG51bGw7CistCistCSAgICAgIGFTb3VyY2VNYXBDb25zdW1lci5lYWNo
TWFwcGluZyhmdW5jdGlvbiAobWFwcGluZykgeworLQkgICAgICAgIGlmIChsYXN0TWFwcGluZyAh
PT0gbnVsbCkgeworLQkgICAgICAgICAgLy8gV2UgYWRkIHRoZSBjb2RlIGZyb20gImxhc3RNYXBw
aW5nIiB0byAibWFwcGluZyI6CistCSAgICAgICAgICAvLyBGaXJzdCBjaGVjayBpZiB0aGVyZSBp
cyBhIG5ldyBsaW5lIGluIGJldHdlZW4uCistCSAgICAgICAgICBpZiAobGFzdEdlbmVyYXRlZExp
bmUgPCBtYXBwaW5nLmdlbmVyYXRlZExpbmUpIHsKKy0JICAgICAgICAgICAgLy8gQXNzb2NpYXRl
IGZpcnN0IGxpbmUgd2l0aCAibGFzdE1hcHBpbmciCistCSAgICAgICAgICAgIGFkZE1hcHBpbmdX
aXRoQ29kZShsYXN0TWFwcGluZywgc2hpZnROZXh0TGluZSgpKTsKKy0JICAgICAgICAgICAgbGFz
dEdlbmVyYXRlZExpbmUrKzsKKy0JICAgICAgICAgICAgbGFzdEdlbmVyYXRlZENvbHVtbiA9IDA7
CistCSAgICAgICAgICAgIC8vIFRoZSByZW1haW5pbmcgY29kZSBpcyBhZGRlZCB3aXRob3V0IG1h
cHBpbmcKKy0JICAgICAgICAgIH0gZWxzZSB7CistCSAgICAgICAgICAgIC8vIFRoZXJlIGlzIG5v
IG5ldyBsaW5lIGluIGJldHdlZW4uCistCSAgICAgICAgICAgIC8vIEFzc29jaWF0ZSB0aGUgY29k
ZSBiZXR3ZWVuICJsYXN0R2VuZXJhdGVkQ29sdW1uIiBhbmQKKy0JICAgICAgICAgICAgLy8gIm1h
cHBpbmcuZ2VuZXJhdGVkQ29sdW1uIiB3aXRoICJsYXN0TWFwcGluZyIKKy0JICAgICAgICAgICAg
dmFyIG5leHRMaW5lID0gcmVtYWluaW5nTGluZXNbMF07CistCSAgICAgICAgICAgIHZhciBjb2Rl
ID0gbmV4dExpbmUuc3Vic3RyKDAsIG1hcHBpbmcuZ2VuZXJhdGVkQ29sdW1uIC0KKy0JICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdEdlbmVyYXRlZENvbHVtbik7
CistCSAgICAgICAgICAgIHJlbWFpbmluZ0xpbmVzWzBdID0gbmV4dExpbmUuc3Vic3RyKG1hcHBp
bmcuZ2VuZXJhdGVkQ29sdW1uIC0KKy0JICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbGFzdEdlbmVyYXRlZENvbHVtbik7CistCSAgICAgICAgICAgIGxhc3RH
ZW5lcmF0ZWRDb2x1bW4gPSBtYXBwaW5nLmdlbmVyYXRlZENvbHVtbjsKKy0JICAgICAgICAgICAg
YWRkTWFwcGluZ1dpdGhDb2RlKGxhc3RNYXBwaW5nLCBjb2RlKTsKKy0JICAgICAgICAgICAgLy8g
Tm8gbW9yZSByZW1haW5pbmcgY29kZSwgY29udGludWUKKy0JICAgICAgICAgICAgbGFzdE1hcHBp
bmcgPSBtYXBwaW5nOworLQkgICAgICAgICAgICByZXR1cm47CistCSAgICAgICAgICB9CistCSAg
ICAgICAgfQorLQkgICAgICAgIC8vIFdlIGFkZCB0aGUgZ2VuZXJhdGVkIGNvZGUgdW50aWwgdGhl
IGZpcnN0IG1hcHBpbmcKKy0JICAgICAgICAvLyB0byB0aGUgU291cmNlTm9kZSB3aXRob3V0IGFu
eSBtYXBwaW5nLgorLQkgICAgICAgIC8vIEVhY2ggbGluZSBpcyBhZGRlZCBhcyBzZXBhcmF0ZSBz
dHJpbmcuCistCSAgICAgICAgd2hpbGUgKGxhc3RHZW5lcmF0ZWRMaW5lIDwgbWFwcGluZy5nZW5l
cmF0ZWRMaW5lKSB7CistCSAgICAgICAgICBub2RlLmFkZChzaGlmdE5leHRMaW5lKCkpOworLQkg
ICAgICAgICAgbGFzdEdlbmVyYXRlZExpbmUrKzsKKy0JICAgICAgICB9CistCSAgICAgICAgaWYg
KGxhc3RHZW5lcmF0ZWRDb2x1bW4gPCBtYXBwaW5nLmdlbmVyYXRlZENvbHVtbikgeworLQkgICAg
ICAgICAgdmFyIG5leHRMaW5lID0gcmVtYWluaW5nTGluZXNbMF07CistCSAgICAgICAgICBub2Rl
LmFkZChuZXh0TGluZS5zdWJzdHIoMCwgbWFwcGluZy5nZW5lcmF0ZWRDb2x1bW4pKTsKKy0JICAg
ICAgICAgIHJlbWFpbmluZ0xpbmVzWzBdID0gbmV4dExpbmUuc3Vic3RyKG1hcHBpbmcuZ2VuZXJh
dGVkQ29sdW1uKTsKKy0JICAgICAgICAgIGxhc3RHZW5lcmF0ZWRDb2x1bW4gPSBtYXBwaW5nLmdl
bmVyYXRlZENvbHVtbjsKKy0JICAgICAgICB9CistCSAgICAgICAgbGFzdE1hcHBpbmcgPSBtYXBw
aW5nOworLQkgICAgICB9LCB0aGlzKTsKKy0JICAgICAgLy8gV2UgaGF2ZSBwcm9jZXNzZWQgYWxs
IG1hcHBpbmdzLgorLQkgICAgICBpZiAocmVtYWluaW5nTGluZXMubGVuZ3RoID4gMCkgeworLQkg
ICAgICAgIGlmIChsYXN0TWFwcGluZykgeworLQkgICAgICAgICAgLy8gQXNzb2NpYXRlIHRoZSBy
ZW1haW5pbmcgY29kZSBpbiB0aGUgY3VycmVudCBsaW5lIHdpdGggImxhc3RNYXBwaW5nIgorLQkg
ICAgICAgICAgYWRkTWFwcGluZ1dpdGhDb2RlKGxhc3RNYXBwaW5nLCBzaGlmdE5leHRMaW5lKCkp
OworLQkgICAgICAgIH0KKy0JICAgICAgICAvLyBhbmQgYWRkIHRoZSByZW1haW5pbmcgbGluZXMg
d2l0aG91dCBhbnkgbWFwcGluZworLQkgICAgICAgIG5vZGUuYWRkKHJlbWFpbmluZ0xpbmVzLmpv
aW4oIiIpKTsKKy0JICAgICAgfQorLQorLQkgICAgICAvLyBDb3B5IHNvdXJjZXNDb250ZW50IGlu
dG8gU291cmNlTm9kZQorLQkgICAgICBhU291cmNlTWFwQ29uc3VtZXIuc291cmNlcy5mb3JFYWNo
KGZ1bmN0aW9uIChzb3VyY2VGaWxlKSB7CistCSAgICAgICAgdmFyIGNvbnRlbnQgPSBhU291cmNl
TWFwQ29uc3VtZXIuc291cmNlQ29udGVudEZvcihzb3VyY2VGaWxlKTsKKy0JICAgICAgICBpZiAo
Y29udGVudCAhPSBudWxsKSB7CistCSAgICAgICAgICBpZiAoYVJlbGF0aXZlUGF0aCAhPSBudWxs
KSB7CistCSAgICAgICAgICAgIHNvdXJjZUZpbGUgPSB1dGlsLmpvaW4oYVJlbGF0aXZlUGF0aCwg
c291cmNlRmlsZSk7CistCSAgICAgICAgICB9CistCSAgICAgICAgICBub2RlLnNldFNvdXJjZUNv
bnRlbnQoc291cmNlRmlsZSwgY29udGVudCk7CistCSAgICAgICAgfQorLQkgICAgICB9KTsKKy0K
Ky0JICAgICAgcmV0dXJuIG5vZGU7CistCistCSAgICAgIGZ1bmN0aW9uIGFkZE1hcHBpbmdXaXRo
Q29kZShtYXBwaW5nLCBjb2RlKSB7CistCSAgICAgICAgaWYgKG1hcHBpbmcgPT09IG51bGwgfHwg
bWFwcGluZy5zb3VyY2UgPT09IHVuZGVmaW5lZCkgeworLQkgICAgICAgICAgbm9kZS5hZGQoY29k
ZSk7CistCSAgICAgICAgfSBlbHNlIHsKKy0JICAgICAgICAgIHZhciBzb3VyY2UgPSBhUmVsYXRp
dmVQYXRoCistCSAgICAgICAgICAgID8gdXRpbC5qb2luKGFSZWxhdGl2ZVBhdGgsIG1hcHBpbmcu
c291cmNlKQorLQkgICAgICAgICAgICA6IG1hcHBpbmcuc291cmNlOworLQkgICAgICAgICAgbm9k
ZS5hZGQobmV3IFNvdXJjZU5vZGUobWFwcGluZy5vcmlnaW5hbExpbmUsCistCSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBtYXBwaW5nLm9yaWdpbmFsQ29sdW1uLAorLQkgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlLAorLQkgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29kZSwKKy0JICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IG1hcHBpbmcubmFtZSkpOworLQkgICAgICAgIH0KKy0JICAgICAgfQorLQkgICAgfTsKKy0KKy0J
ICAvKioKKy0JICAgKiBBZGQgYSBjaHVuayBvZiBnZW5lcmF0ZWQgSlMgdG8gdGhpcyBzb3VyY2Ug
bm9kZS4KKy0JICAgKgorLQkgICAqIEBwYXJhbSBhQ2h1bmsgQSBzdHJpbmcgc25pcHBldCBvZiBn
ZW5lcmF0ZWQgSlMgY29kZSwgYW5vdGhlciBpbnN0YW5jZSBvZgorLQkgICAqICAgICAgICBTb3Vy
Y2VOb2RlLCBvciBhbiBhcnJheSB3aGVyZSBlYWNoIG1lbWJlciBpcyBvbmUgb2YgdGhvc2UgdGhp
bmdzLgorLQkgICAqLworLQkgIFNvdXJjZU5vZGUucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uIFNv
dXJjZU5vZGVfYWRkKGFDaHVuaykgeworLQkgICAgaWYgKEFycmF5LmlzQXJyYXkoYUNodW5rKSkg
eworLQkgICAgICBhQ2h1bmsuZm9yRWFjaChmdW5jdGlvbiAoY2h1bmspIHsKKy0JICAgICAgICB0
aGlzLmFkZChjaHVuayk7CistCSAgICAgIH0sIHRoaXMpOworLQkgICAgfQorLQkgICAgZWxzZSBp
ZiAoYUNodW5rW2lzU291cmNlTm9kZV0gfHwgdHlwZW9mIGFDaHVuayA9PT0gInN0cmluZyIpIHsK
Ky0JICAgICAgaWYgKGFDaHVuaykgeworLQkgICAgICAgIHRoaXMuY2hpbGRyZW4ucHVzaChhQ2h1
bmspOworLQkgICAgICB9CistCSAgICB9CistCSAgICBlbHNlIHsKKy0JICAgICAgdGhyb3cgbmV3
IFR5cGVFcnJvcigKKy0JICAgICAgICAiRXhwZWN0ZWQgYSBTb3VyY2VOb2RlLCBzdHJpbmcsIG9y
IGFuIGFycmF5IG9mIFNvdXJjZU5vZGVzIGFuZCBzdHJpbmdzLiBHb3QgIiArIGFDaHVuaworLQkg
ICAgICApOworLQkgICAgfQorLQkgICAgcmV0dXJuIHRoaXM7CistCSAgfTsKKy0KKy0JICAvKioK
Ky0JICAgKiBBZGQgYSBjaHVuayBvZiBnZW5lcmF0ZWQgSlMgdG8gdGhlIGJlZ2lubmluZyBvZiB0
aGlzIHNvdXJjZSBub2RlLgorLQkgICAqCistCSAgICogQHBhcmFtIGFDaHVuayBBIHN0cmluZyBz
bmlwcGV0IG9mIGdlbmVyYXRlZCBKUyBjb2RlLCBhbm90aGVyIGluc3RhbmNlIG9mCistCSAgICog
ICAgICAgIFNvdXJjZU5vZGUsIG9yIGFuIGFycmF5IHdoZXJlIGVhY2ggbWVtYmVyIGlzIG9uZSBv
ZiB0aG9zZSB0aGluZ3MuCistCSAgICovCistCSAgU291cmNlTm9kZS5wcm90b3R5cGUucHJlcGVu
ZCA9IGZ1bmN0aW9uIFNvdXJjZU5vZGVfcHJlcGVuZChhQ2h1bmspIHsKKy0JICAgIGlmIChBcnJh
eS5pc0FycmF5KGFDaHVuaykpIHsKKy0JICAgICAgZm9yICh2YXIgaSA9IGFDaHVuay5sZW5ndGgt
MTsgaSA+PSAwOyBpLS0pIHsKKy0JICAgICAgICB0aGlzLnByZXBlbmQoYUNodW5rW2ldKTsKKy0J
ICAgICAgfQorLQkgICAgfQorLQkgICAgZWxzZSBpZiAoYUNodW5rW2lzU291cmNlTm9kZV0gfHwg
dHlwZW9mIGFDaHVuayA9PT0gInN0cmluZyIpIHsKKy0JICAgICAgdGhpcy5jaGlsZHJlbi51bnNo
aWZ0KGFDaHVuayk7CistCSAgICB9CistCSAgICBlbHNlIHsKKy0JICAgICAgdGhyb3cgbmV3IFR5
cGVFcnJvcigKKy0JICAgICAgICAiRXhwZWN0ZWQgYSBTb3VyY2VOb2RlLCBzdHJpbmcsIG9yIGFu
IGFycmF5IG9mIFNvdXJjZU5vZGVzIGFuZCBzdHJpbmdzLiBHb3QgIiArIGFDaHVuaworLQkgICAg
ICApOworLQkgICAgfQorLQkgICAgcmV0dXJuIHRoaXM7CistCSAgfTsKKy0KKy0JICAvKioKKy0J
ICAgKiBXYWxrIG92ZXIgdGhlIHRyZWUgb2YgSlMgc25pcHBldHMgaW4gdGhpcyBub2RlIGFuZCBp
dHMgY2hpbGRyZW4uIFRoZQorLQkgICAqIHdhbGtpbmcgZnVuY3Rpb24gaXMgY2FsbGVkIG9uY2Ug
Zm9yIGVhY2ggc25pcHBldCBvZiBKUyBhbmQgaXMgcGFzc2VkIHRoYXQKKy0JICAgKiBzbmlwcGV0
IGFuZCB0aGUgaXRzIG9yaWdpbmFsIGFzc29jaWF0ZWQgc291cmNlJ3MgbGluZS9jb2x1bW4gbG9j
YXRpb24uCistCSAgICoKKy0JICAgKiBAcGFyYW0gYUZuIFRoZSB0cmF2ZXJzYWwgZnVuY3Rpb24u
CistCSAgICovCistCSAgU291cmNlTm9kZS5wcm90b3R5cGUud2FsayA9IGZ1bmN0aW9uIFNvdXJj
ZU5vZGVfd2FsayhhRm4pIHsKKy0JICAgIHZhciBjaHVuazsKKy0JICAgIGZvciAodmFyIGkgPSAw
LCBsZW4gPSB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7CistCSAgICAgIGNo
dW5rID0gdGhpcy5jaGlsZHJlbltpXTsKKy0JICAgICAgaWYgKGNodW5rW2lzU291cmNlTm9kZV0p
IHsKKy0JICAgICAgICBjaHVuay53YWxrKGFGbik7CistCSAgICAgIH0KKy0JICAgICAgZWxzZSB7
CistCSAgICAgICAgaWYgKGNodW5rICE9PSAnJykgeworLQkgICAgICAgICAgYUZuKGNodW5rLCB7
IHNvdXJjZTogdGhpcy5zb3VyY2UsCistCSAgICAgICAgICAgICAgICAgICAgICAgbGluZTogdGhp
cy5saW5lLAorLQkgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbjogdGhpcy5jb2x1bW4sCist
CSAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lIH0pOworLQkgICAgICAgIH0K
Ky0JICAgICAgfQorLQkgICAgfQorLQkgIH07CistCistCSAgLyoqCistCSAgICogTGlrZSBgU3Ry
aW5nLnByb3RvdHlwZS5qb2luYCBleGNlcHQgZm9yIFNvdXJjZU5vZGVzLiBJbnNlcnRzIGBhU3Ry
YCBiZXR3ZWVuCistCSAgICogZWFjaCBvZiBgdGhpcy5jaGlsZHJlbmAuCistCSAgICoKKy0JICAg
KiBAcGFyYW0gYVNlcCBUaGUgc2VwYXJhdG9yLgorLQkgICAqLworLQkgIFNvdXJjZU5vZGUucHJv
dG90eXBlLmpvaW4gPSBmdW5jdGlvbiBTb3VyY2VOb2RlX2pvaW4oYVNlcCkgeworLQkgICAgdmFy
IG5ld0NoaWxkcmVuOworLQkgICAgdmFyIGk7CistCSAgICB2YXIgbGVuID0gdGhpcy5jaGlsZHJl
bi5sZW5ndGg7CistCSAgICBpZiAobGVuID4gMCkgeworLQkgICAgICBuZXdDaGlsZHJlbiA9IFtd
OworLQkgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuLTE7IGkrKykgeworLQkgICAgICAgIG5ld0No
aWxkcmVuLnB1c2godGhpcy5jaGlsZHJlbltpXSk7CistCSAgICAgICAgbmV3Q2hpbGRyZW4ucHVz
aChhU2VwKTsKKy0JICAgICAgfQorLQkgICAgICBuZXdDaGlsZHJlbi5wdXNoKHRoaXMuY2hpbGRy
ZW5baV0pOworLQkgICAgICB0aGlzLmNoaWxkcmVuID0gbmV3Q2hpbGRyZW47CistCSAgICB9Cist
CSAgICByZXR1cm4gdGhpczsKKy0JICB9OworLQorLQkgIC8qKgorLQkgICAqIENhbGwgU3RyaW5n
LnByb3RvdHlwZS5yZXBsYWNlIG9uIHRoZSB2ZXJ5IHJpZ2h0LW1vc3Qgc291cmNlIHNuaXBwZXQu
IFVzZWZ1bAorLQkgICAqIGZvciB0cmltbWluZyB3aGl0ZXNwYWNlIGZyb20gdGhlIGVuZCBvZiBh
IHNvdXJjZSBub2RlLCBldGMuCistCSAgICoKKy0JICAgKiBAcGFyYW0gYVBhdHRlcm4gVGhlIHBh
dHRlcm4gdG8gcmVwbGFjZS4KKy0JICAgKiBAcGFyYW0gYVJlcGxhY2VtZW50IFRoZSB0aGluZyB0
byByZXBsYWNlIHRoZSBwYXR0ZXJuIHdpdGguCistCSAgICovCistCSAgU291cmNlTm9kZS5wcm90
b3R5cGUucmVwbGFjZVJpZ2h0ID0gZnVuY3Rpb24gU291cmNlTm9kZV9yZXBsYWNlUmlnaHQoYVBh
dHRlcm4sIGFSZXBsYWNlbWVudCkgeworLQkgICAgdmFyIGxhc3RDaGlsZCA9IHRoaXMuY2hpbGRy
ZW5bdGhpcy5jaGlsZHJlbi5sZW5ndGggLSAxXTsKKy0JICAgIGlmIChsYXN0Q2hpbGRbaXNTb3Vy
Y2VOb2RlXSkgeworLQkgICAgICBsYXN0Q2hpbGQucmVwbGFjZVJpZ2h0KGFQYXR0ZXJuLCBhUmVw
bGFjZW1lbnQpOworLQkgICAgfQorLQkgICAgZWxzZSBpZiAodHlwZW9mIGxhc3RDaGlsZCA9PT0g
J3N0cmluZycpIHsKKy0JICAgICAgdGhpcy5jaGlsZHJlblt0aGlzLmNoaWxkcmVuLmxlbmd0aCAt
IDFdID0gbGFzdENoaWxkLnJlcGxhY2UoYVBhdHRlcm4sIGFSZXBsYWNlbWVudCk7CistCSAgICB9
CistCSAgICBlbHNlIHsKKy0JICAgICAgdGhpcy5jaGlsZHJlbi5wdXNoKCcnLnJlcGxhY2UoYVBh
dHRlcm4sIGFSZXBsYWNlbWVudCkpOworLQkgICAgfQorLQkgICAgcmV0dXJuIHRoaXM7CistCSAg
fTsKKy0KKy0JICAvKioKKy0JICAgKiBTZXQgdGhlIHNvdXJjZSBjb250ZW50IGZvciBhIHNvdXJj
ZSBmaWxlLiBUaGlzIHdpbGwgYmUgYWRkZWQgdG8gdGhlIFNvdXJjZU1hcEdlbmVyYXRvcgorLQkg
ICAqIGluIHRoZSBzb3VyY2VzQ29udGVudCBmaWVsZC4KKy0JICAgKgorLQkgICAqIEBwYXJhbSBh
U291cmNlRmlsZSBUaGUgZmlsZW5hbWUgb2YgdGhlIHNvdXJjZSBmaWxlCistCSAgICogQHBhcmFt
IGFTb3VyY2VDb250ZW50IFRoZSBjb250ZW50IG9mIHRoZSBzb3VyY2UgZmlsZQorLQkgICAqLwor
LQkgIFNvdXJjZU5vZGUucHJvdG90eXBlLnNldFNvdXJjZUNvbnRlbnQgPQorLQkgICAgZnVuY3Rp
b24gU291cmNlTm9kZV9zZXRTb3VyY2VDb250ZW50KGFTb3VyY2VGaWxlLCBhU291cmNlQ29udGVu
dCkgeworLQkgICAgICB0aGlzLnNvdXJjZUNvbnRlbnRzW3V0aWwudG9TZXRTdHJpbmcoYVNvdXJj
ZUZpbGUpXSA9IGFTb3VyY2VDb250ZW50OworLQkgICAgfTsKKy0KKy0JICAvKioKKy0JICAgKiBX
YWxrIG92ZXIgdGhlIHRyZWUgb2YgU291cmNlTm9kZXMuIFRoZSB3YWxraW5nIGZ1bmN0aW9uIGlz
IGNhbGxlZCBmb3IgZWFjaAorLQkgICAqIHNvdXJjZSBmaWxlIGNvbnRlbnQgYW5kIGlzIHBhc3Nl
ZCB0aGUgZmlsZW5hbWUgYW5kIHNvdXJjZSBjb250ZW50LgorLQkgICAqCistCSAgICogQHBhcmFt
IGFGbiBUaGUgdHJhdmVyc2FsIGZ1bmN0aW9uLgorLQkgICAqLworLQkgIFNvdXJjZU5vZGUucHJv
dG90eXBlLndhbGtTb3VyY2VDb250ZW50cyA9CistCSAgICBmdW5jdGlvbiBTb3VyY2VOb2RlX3dh
bGtTb3VyY2VDb250ZW50cyhhRm4pIHsKKy0JICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRo
aXMuY2hpbGRyZW4ubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHsKKy0JICAgICAgICBpZiAodGhpcy5j
aGlsZHJlbltpXVtpc1NvdXJjZU5vZGVdKSB7CistCSAgICAgICAgICB0aGlzLmNoaWxkcmVuW2ld
LndhbGtTb3VyY2VDb250ZW50cyhhRm4pOworLQkgICAgICAgIH0KKy0JICAgICAgfQorLQorLQkg
ICAgICB2YXIgc291cmNlcyA9IE9iamVjdC5rZXlzKHRoaXMuc291cmNlQ29udGVudHMpOworLQkg
ICAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gc291cmNlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykg
eworLQkgICAgICAgIGFGbih1dGlsLmZyb21TZXRTdHJpbmcoc291cmNlc1tpXSksIHRoaXMuc291
cmNlQ29udGVudHNbc291cmNlc1tpXV0pOworLQkgICAgICB9CistCSAgICB9OworLQorLQkgIC8q
KgorLQkgICAqIFJldHVybiB0aGUgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgc291cmNl
IG5vZGUuIFdhbGtzIG92ZXIgdGhlIHRyZWUKKy0JICAgKiBhbmQgY29uY2F0ZW5hdGVzIGFsbCB0
aGUgdmFyaW91cyBzbmlwcGV0cyB0b2dldGhlciB0byBvbmUgc3RyaW5nLgorLQkgICAqLworLQkg
IFNvdXJjZU5vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gU291cmNlTm9kZV90b1N0
cmluZygpIHsKKy0JICAgIHZhciBzdHIgPSAiIjsKKy0JICAgIHRoaXMud2FsayhmdW5jdGlvbiAo
Y2h1bmspIHsKKy0JICAgICAgc3RyICs9IGNodW5rOworLQkgICAgfSk7CistCSAgICByZXR1cm4g
c3RyOworLQkgIH07CistCistCSAgLyoqCistCSAgICogUmV0dXJucyB0aGUgc3RyaW5nIHJlcHJl
c2VudGF0aW9uIG9mIHRoaXMgc291cmNlIG5vZGUgYWxvbmcgd2l0aCBhIHNvdXJjZQorLQkgICAq
IG1hcC4KKy0JICAgKi8KKy0JICBTb3VyY2VOb2RlLnByb3RvdHlwZS50b1N0cmluZ1dpdGhTb3Vy
Y2VNYXAgPSBmdW5jdGlvbiBTb3VyY2VOb2RlX3RvU3RyaW5nV2l0aFNvdXJjZU1hcChhQXJncykg
eworLQkgICAgdmFyIGdlbmVyYXRlZCA9IHsKKy0JICAgICAgY29kZTogIiIsCistCSAgICAgIGxp
bmU6IDEsCistCSAgICAgIGNvbHVtbjogMAorLQkgICAgfTsKKy0JICAgIHZhciBtYXAgPSBuZXcg
U291cmNlTWFwR2VuZXJhdG9yKGFBcmdzKTsKKy0JICAgIHZhciBzb3VyY2VNYXBwaW5nQWN0aXZl
ID0gZmFsc2U7CistCSAgICB2YXIgbGFzdE9yaWdpbmFsU291cmNlID0gbnVsbDsKKy0JICAgIHZh
ciBsYXN0T3JpZ2luYWxMaW5lID0gbnVsbDsKKy0JICAgIHZhciBsYXN0T3JpZ2luYWxDb2x1bW4g
PSBudWxsOworLQkgICAgdmFyIGxhc3RPcmlnaW5hbE5hbWUgPSBudWxsOworLQkgICAgdGhpcy53
YWxrKGZ1bmN0aW9uIChjaHVuaywgb3JpZ2luYWwpIHsKKy0JICAgICAgZ2VuZXJhdGVkLmNvZGUg
Kz0gY2h1bms7CistCSAgICAgIGlmIChvcmlnaW5hbC5zb3VyY2UgIT09IG51bGwKKy0JICAgICAg
ICAgICYmIG9yaWdpbmFsLmxpbmUgIT09IG51bGwKKy0JICAgICAgICAgICYmIG9yaWdpbmFsLmNv
bHVtbiAhPT0gbnVsbCkgeworLQkgICAgICAgIGlmKGxhc3RPcmlnaW5hbFNvdXJjZSAhPT0gb3Jp
Z2luYWwuc291cmNlCistCSAgICAgICAgICAgfHwgbGFzdE9yaWdpbmFsTGluZSAhPT0gb3JpZ2lu
YWwubGluZQorLQkgICAgICAgICAgIHx8IGxhc3RPcmlnaW5hbENvbHVtbiAhPT0gb3JpZ2luYWwu
Y29sdW1uCistCSAgICAgICAgICAgfHwgbGFzdE9yaWdpbmFsTmFtZSAhPT0gb3JpZ2luYWwubmFt
ZSkgeworLQkgICAgICAgICAgbWFwLmFkZE1hcHBpbmcoeworLQkgICAgICAgICAgICBzb3VyY2U6
IG9yaWdpbmFsLnNvdXJjZSwKKy0JICAgICAgICAgICAgb3JpZ2luYWw6IHsKKy0JICAgICAgICAg
ICAgICBsaW5lOiBvcmlnaW5hbC5saW5lLAorLQkgICAgICAgICAgICAgIGNvbHVtbjogb3JpZ2lu
YWwuY29sdW1uCistCSAgICAgICAgICAgIH0sCistCSAgICAgICAgICAgIGdlbmVyYXRlZDogewor
LQkgICAgICAgICAgICAgIGxpbmU6IGdlbmVyYXRlZC5saW5lLAorLQkgICAgICAgICAgICAgIGNv
bHVtbjogZ2VuZXJhdGVkLmNvbHVtbgorLQkgICAgICAgICAgICB9LAorLQkgICAgICAgICAgICBu
YW1lOiBvcmlnaW5hbC5uYW1lCistCSAgICAgICAgICB9KTsKKy0JICAgICAgICB9CistCSAgICAg
ICAgbGFzdE9yaWdpbmFsU291cmNlID0gb3JpZ2luYWwuc291cmNlOworLQkgICAgICAgIGxhc3RP
cmlnaW5hbExpbmUgPSBvcmlnaW5hbC5saW5lOworLQkgICAgICAgIGxhc3RPcmlnaW5hbENvbHVt
biA9IG9yaWdpbmFsLmNvbHVtbjsKKy0JICAgICAgICBsYXN0T3JpZ2luYWxOYW1lID0gb3JpZ2lu
YWwubmFtZTsKKy0JICAgICAgICBzb3VyY2VNYXBwaW5nQWN0aXZlID0gdHJ1ZTsKKy0JICAgICAg
fSBlbHNlIGlmIChzb3VyY2VNYXBwaW5nQWN0aXZlKSB7CistCSAgICAgICAgbWFwLmFkZE1hcHBp
bmcoeworLQkgICAgICAgICAgZ2VuZXJhdGVkOiB7CistCSAgICAgICAgICAgIGxpbmU6IGdlbmVy
YXRlZC5saW5lLAorLQkgICAgICAgICAgICBjb2x1bW46IGdlbmVyYXRlZC5jb2x1bW4KKy0JICAg
ICAgICAgIH0KKy0JICAgICAgICB9KTsKKy0JICAgICAgICBsYXN0T3JpZ2luYWxTb3VyY2UgPSBu
dWxsOworLQkgICAgICAgIHNvdXJjZU1hcHBpbmdBY3RpdmUgPSBmYWxzZTsKKy0JICAgICAgfQor
LQkgICAgICBmb3IgKHZhciBpZHggPSAwLCBsZW5ndGggPSBjaHVuay5sZW5ndGg7IGlkeCA8IGxl
bmd0aDsgaWR4KyspIHsKKy0JICAgICAgICBpZiAoY2h1bmsuY2hhckNvZGVBdChpZHgpID09PSBO
RVdMSU5FX0NPREUpIHsKKy0JICAgICAgICAgIGdlbmVyYXRlZC5saW5lKys7CistCSAgICAgICAg
ICBnZW5lcmF0ZWQuY29sdW1uID0gMDsKKy0JICAgICAgICAgIC8vIE1hcHBpbmdzIGVuZCBhdCBl
b2wKKy0JICAgICAgICAgIGlmIChpZHggKyAxID09PSBsZW5ndGgpIHsKKy0JICAgICAgICAgICAg
bGFzdE9yaWdpbmFsU291cmNlID0gbnVsbDsKKy0JICAgICAgICAgICAgc291cmNlTWFwcGluZ0Fj
dGl2ZSA9IGZhbHNlOworLQkgICAgICAgICAgfSBlbHNlIGlmIChzb3VyY2VNYXBwaW5nQWN0aXZl
KSB7CistCSAgICAgICAgICAgIG1hcC5hZGRNYXBwaW5nKHsKKy0JICAgICAgICAgICAgICBzb3Vy
Y2U6IG9yaWdpbmFsLnNvdXJjZSwKKy0JICAgICAgICAgICAgICBvcmlnaW5hbDogeworLQkgICAg
ICAgICAgICAgICAgbGluZTogb3JpZ2luYWwubGluZSwKKy0JICAgICAgICAgICAgICAgIGNvbHVt
bjogb3JpZ2luYWwuY29sdW1uCistCSAgICAgICAgICAgICAgfSwKKy0JICAgICAgICAgICAgICBn
ZW5lcmF0ZWQ6IHsKKy0JICAgICAgICAgICAgICAgIGxpbmU6IGdlbmVyYXRlZC5saW5lLAorLQkg
ICAgICAgICAgICAgICAgY29sdW1uOiBnZW5lcmF0ZWQuY29sdW1uCistCSAgICAgICAgICAgICAg
fSwKKy0JICAgICAgICAgICAgICBuYW1lOiBvcmlnaW5hbC5uYW1lCistCSAgICAgICAgICAgIH0p
OworLQkgICAgICAgICAgfQorLQkgICAgICAgIH0gZWxzZSB7CistCSAgICAgICAgICBnZW5lcmF0
ZWQuY29sdW1uKys7CistCSAgICAgICAgfQorLQkgICAgICB9CistCSAgICB9KTsKKy0JICAgIHRo
aXMud2Fsa1NvdXJjZUNvbnRlbnRzKGZ1bmN0aW9uIChzb3VyY2VGaWxlLCBzb3VyY2VDb250ZW50
KSB7CistCSAgICAgIG1hcC5zZXRTb3VyY2VDb250ZW50KHNvdXJjZUZpbGUsIHNvdXJjZUNvbnRl
bnQpOworLQkgICAgfSk7CistCistCSAgICByZXR1cm4geyBjb2RlOiBnZW5lcmF0ZWQuY29kZSwg
bWFwOiBtYXAgfTsKKy0JICB9OworLQorLQkgIGV4cG9ydHMuU291cmNlTm9kZSA9IFNvdXJjZU5v
ZGU7CistCX0KKy0KKy0KKy0vKioqLyB9CistLyoqKioqKi8gXSkKKy19KTsKKy07TU9aX1NvdXJj
ZU1hcCA9IHNvdXJjZU1hcDsoZnVuY3Rpb24oZXhwb3J0cyxnbG9iYWwpey8qKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KgorKyhmdW5jdGlvbihleHBvcnRzLGdsb2JhbCl7LyoqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCisgCisgICBBIEph
dmFTY3JpcHQgdG9rZW5pemVyIC8gcGFyc2VyIC8gYmVhdXRpZmllciAvIGNvbXByZXNzb3IuCisg
ICBodHRwczovL2dpdGh1Yi5jb20vbWlzaG9vL1VnbGlmeUpTMgorLS0gCisyLjUuNQorCmRpZmYg
LS1naXQgYS9ydWJ5Z2VtLXVnbGlmaWVyLTMuMC4wLXVuYnVuZGxlLWpzLWZpbGVzLWZvci1qc2Ny
aXB0LnBhdGNoIGIvcnVieWdlbS11Z2xpZmllci0zLjAuMC11bmJ1bmRsZS1qcy1maWxlcy1mb3It
anNjcmlwdC5wYXRjaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwLi4yYmE4YTdj
Ci0tLSAvZGV2L251bGwKKysrIGIvcnVieWdlbS11Z2xpZmllci0zLjAuMC11bmJ1bmRsZS1qcy1m
aWxlcy1mb3ItanNjcmlwdC5wYXRjaApAQCAtMCwwICsxLDQ5MCBAQAorRnJvbSBiMDIzY2M4MTY2
NzA1ZjhhMmM4YjhkMzQ4ZWY1ZDlhNjYzYWZiYjVmIE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQor
RnJvbTogSnVuIEFydWdhIDxqYXJ1Z2FAcmVkaGF0LmNvbT4KK0RhdGU6IFdlZCwgMjcgSnVsIDIw
MTYgMTQ6MzA6MDIgKzAyMDAKK1N1YmplY3Q6IFtQQVRDSF0gUmVtb3ZlIEpTIGZpbGVzIGZvciBK
UyBFbmdpbmUgbm90IHN1cHBvcnRpbmcgRUNNQVNjcmlwdCA1LgorCistLS0KKyBsaWIvZXM1Lmpz
ICAgICAgfCAzMjEgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0KKyBsaWIvc3BsaXQuanMgICAgfCAxMTcgLS0tLS0tLS0tLS0tLS0tLS0tLS0t
CisgbGliL3VnbGlmaWVyLnJiIHwgICA2ICstCisgMyBmaWxlcyBjaGFuZ2VkLCAxIGluc2VydGlv
bigrKSwgNDQzIGRlbGV0aW9ucygtKQorIGRlbGV0ZSBtb2RlIDEwMDY0NCBsaWIvZXM1LmpzCisg
ZGVsZXRlIG1vZGUgMTAwNjQ0IGxpYi9zcGxpdC5qcworCitkaWZmIC0tZ2l0IGEvbGliL2VzNS5q
cyBiL2xpYi9lczUuanMKK2RlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAoraW5kZXggYjU3MTJiOC4u
MDAwMDAwMAorLS0tIGEvbGliL2VzNS5qcworKysrIC9kZXYvbnVsbAorQEAgLTEsMzIxICswLDAg
QEAKKy0vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9KYXZhU2NyaXB0L1JlZmVy
ZW5jZS9nbG9iYWxfb2JqZWN0cy9hcnJheS9mb3JlYWNoCistCistaWYgKCFBcnJheS5wcm90b3R5
cGUuZm9yRWFjaCkKKy17CistICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uKGZ1
biAvKiwgdGhpc3AgKi8pCistICB7CistICAgICJ1c2Ugc3RyaWN0IjsKKy0KKy0gICAgaWYgKHRo
aXMgPT09IHZvaWQgMCB8fCB0aGlzID09PSBudWxsKQorLSAgICAgIHRocm93IG5ldyBUeXBlRXJy
b3IoKTsKKy0KKy0gICAgdmFyIHQgPSBPYmplY3QodGhpcyk7CistICAgIHZhciBsZW4gPSB0Lmxl
bmd0aCA+Pj4gMDsKKy0gICAgaWYgKHR5cGVvZiBmdW4gIT09ICJmdW5jdGlvbiIpCistICAgICAg
dGhyb3cgbmV3IFR5cGVFcnJvcigpOworLQorLSAgICB2YXIgdGhpc3AgPSBhcmd1bWVudHNbMV07
CistICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspCistICAgIHsKKy0gICAgICBpZiAo
aSBpbiB0KQorLSAgICAgICAgZnVuLmNhbGwodGhpc3AsIHRbaV0sIGksIHQpOworLSAgICB9Cist
ICB9OworLX0KKy0KKy0vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9Db3JlX0ph
dmFTY3JpcHRfMS41X1JlZmVyZW5jZS9PYmplY3RzL0FycmF5L21hcAorLS8vIFByb2R1Y3Rpb24g
c3RlcHMgb2YgRUNNQS0yNjIsIEVkaXRpb24gNSwgMTUuNC40LjE5CistLy8gUmVmZXJlbmNlOiBo
dHRwOi8vZXM1LmdpdGh1Yi5jb20vI3gxNS40LjQuMTkKKy1pZiAoIUFycmF5LnByb3RvdHlwZS5t
YXApIHsKKy0gIEFycmF5LnByb3RvdHlwZS5tYXAgPSBmdW5jdGlvbihjYWxsYmFjaywgdGhpc0Fy
ZykgeworLQorLSAgICB2YXIgVCwgQSwgazsKKy0KKy0gICAgaWYgKHRoaXMgPT0gbnVsbCkgewor
LSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIiB0aGlzIGlzIG51bGwgb3Igbm90IGRlZmluZWQi
KTsKKy0gICAgfQorLQorLSAgICAvLyAxLiBMZXQgTyBiZSB0aGUgcmVzdWx0IG9mIGNhbGxpbmcg
VG9PYmplY3QgcGFzc2luZyB0aGUgfHRoaXN8IHZhbHVlIGFzIHRoZSBhcmd1bWVudC4KKy0gICAg
dmFyIE8gPSBPYmplY3QodGhpcyk7CistCistICAgIC8vIDIuIExldCBsZW5WYWx1ZSBiZSB0aGUg
cmVzdWx0IG9mIGNhbGxpbmcgdGhlIEdldCBpbnRlcm5hbCBtZXRob2Qgb2YgTyB3aXRoIHRoZSBh
cmd1bWVudCAibGVuZ3RoIi4KKy0gICAgLy8gMy4gTGV0IGxlbiBiZSBUb1VpbnQzMihsZW5WYWx1
ZSkuCistICAgIHZhciBsZW4gPSBPLmxlbmd0aCA+Pj4gMDsKKy0KKy0gICAgLy8gNC4gSWYgSXND
YWxsYWJsZShjYWxsYmFjaykgaXMgZmFsc2UsIHRocm93IGEgVHlwZUVycm9yIGV4Y2VwdGlvbi4K
Ky0gICAgLy8gU2VlOiBodHRwOi8vZXM1LmdpdGh1Yi5jb20vI3g5LjExCistICAgIGlmICh7fS50
b1N0cmluZy5jYWxsKGNhbGxiYWNrKSAhPSAiW29iamVjdCBGdW5jdGlvbl0iKSB7CistICAgICAg
dGhyb3cgbmV3IFR5cGVFcnJvcihjYWxsYmFjayArICIgaXMgbm90IGEgZnVuY3Rpb24iKTsKKy0g
ICAgfQorLQorLSAgICAvLyA1LiBJZiB0aGlzQXJnIHdhcyBzdXBwbGllZCwgbGV0IFQgYmUgdGhp
c0FyZzsgZWxzZSBsZXQgVCBiZSB1bmRlZmluZWQuCistICAgIGlmICh0aGlzQXJnKSB7CistICAg
ICAgVCA9IHRoaXNBcmc7CistICAgIH0KKy0KKy0gICAgLy8gNi4gTGV0IEEgYmUgYSBuZXcgYXJy
YXkgY3JlYXRlZCBhcyBpZiBieSB0aGUgZXhwcmVzc2lvbiBuZXcgQXJyYXkobGVuKSB3aGVyZSBB
cnJheSBpcworLSAgICAvLyB0aGUgc3RhbmRhcmQgYnVpbHQtaW4gY29uc3RydWN0b3Igd2l0aCB0
aGF0IG5hbWUgYW5kIGxlbiBpcyB0aGUgdmFsdWUgb2YgbGVuLgorLSAgICBBID0gbmV3IEFycmF5
KGxlbik7CistCistICAgIC8vIDcuIExldCBrIGJlIDAKKy0gICAgayA9IDA7CistCistICAgIC8v
IDguIFJlcGVhdCwgd2hpbGUgayA8IGxlbgorLSAgICB3aGlsZShrIDwgbGVuKSB7CistCistICAg
ICAgdmFyIGtWYWx1ZSwgbWFwcGVkVmFsdWU7CistCistICAgICAgLy8gYS4gTGV0IFBrIGJlIFRv
U3RyaW5nKGspLgorLSAgICAgIC8vICAgVGhpcyBpcyBpbXBsaWNpdCBmb3IgTEhTIG9wZXJhbmRz
IG9mIHRoZSBpbiBvcGVyYXRvcgorLSAgICAgIC8vIGIuIExldCBrUHJlc2VudCBiZSB0aGUgcmVz
dWx0IG9mIGNhbGxpbmcgdGhlIEhhc1Byb3BlcnR5IGludGVybmFsIG1ldGhvZCBvZiBPIHdpdGgg
YXJndW1lbnQgUGsuCistICAgICAgLy8gICBUaGlzIHN0ZXAgY2FuIGJlIGNvbWJpbmVkIHdpdGgg
YworLSAgICAgIC8vIGMuIElmIGtQcmVzZW50IGlzIHRydWUsIHRoZW4KKy0gICAgICBpZiAoayBp
biBPKSB7CistCistICAgICAgICAvLyBpLiBMZXQga1ZhbHVlIGJlIHRoZSByZXN1bHQgb2YgY2Fs
bGluZyB0aGUgR2V0IGludGVybmFsIG1ldGhvZCBvZiBPIHdpdGggYXJndW1lbnQgUGsuCistICAg
ICAgICBrVmFsdWUgPSBPWyBrIF07CistCistICAgICAgICAvLyBpaS4gTGV0IG1hcHBlZFZhbHVl
IGJlIHRoZSByZXN1bHQgb2YgY2FsbGluZyB0aGUgQ2FsbCBpbnRlcm5hbCBtZXRob2Qgb2YgY2Fs
bGJhY2sKKy0gICAgICAgIC8vIHdpdGggVCBhcyB0aGUgdGhpcyB2YWx1ZSBhbmQgYXJndW1lbnQg
bGlzdCBjb250YWluaW5nIGtWYWx1ZSwgaywgYW5kIE8uCistICAgICAgICBtYXBwZWRWYWx1ZSA9
IGNhbGxiYWNrLmNhbGwoVCwga1ZhbHVlLCBrLCBPKTsKKy0KKy0gICAgICAgIC8vIGlpaS4gQ2Fs
bCB0aGUgRGVmaW5lT3duUHJvcGVydHkgaW50ZXJuYWwgbWV0aG9kIG9mIEEgd2l0aCBhcmd1bWVu
dHMKKy0gICAgICAgIC8vIFBrLCBQcm9wZXJ0eSBEZXNjcmlwdG9yIHtWYWx1ZTogbWFwcGVkVmFs
dWUsIFdyaXRhYmxlOiB0cnVlLCBFbnVtZXJhYmxlOiB0cnVlLCBDb25maWd1cmFibGU6IHRydWV9
LAorLSAgICAgICAgLy8gYW5kIGZhbHNlLgorLQorLSAgICAgICAgLy8gSW4gYnJvd3NlcnMgdGhh
dCBzdXBwb3J0IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSwgdXNlIHRoZSBmb2xsb3dpbmc6CistICAg
ICAgICAvLyBPYmplY3QuZGVmaW5lUHJvcGVydHkoQSwgUGssIHsgdmFsdWU6IG1hcHBlZFZhbHVl
LCB3cml0YWJsZTogdHJ1ZSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0p
OworLQorLSAgICAgICAgLy8gRm9yIGJlc3QgYnJvd3NlciBzdXBwb3J0LCB1c2UgdGhlIGZvbGxv
d2luZzoKKy0gICAgICAgIEFbIGsgXSA9IG1hcHBlZFZhbHVlOworLSAgICAgIH0KKy0gICAgICAv
LyBkLiBJbmNyZWFzZSBrIGJ5IDEuCistICAgICAgaysrOworLSAgICB9CistCistICAgIC8vIDku
IHJldHVybiBBCistICAgIHJldHVybiBBOworLSAgfTsKKy19CistCistLy8gaHR0cHM6Ly9kZXZl
bG9wZXIubW96aWxsYS5vcmcvZW4vSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMv
QXJyYXkvUmVkdWNlCistCistaWYgKCFBcnJheS5wcm90b3R5cGUucmVkdWNlKQorLXsKKy0gIEFy
cmF5LnByb3RvdHlwZS5yZWR1Y2UgPSBmdW5jdGlvbihmdW4gLyosIGluaXRpYWxWYWx1ZSAqLykK
Ky0gIHsKKy0gICAgInVzZSBzdHJpY3QiOworLQorLSAgICBpZiAodGhpcyA9PT0gdm9pZCAwIHx8
IHRoaXMgPT09IG51bGwpCistICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigpOworLQorLSAgICB2
YXIgdCA9IE9iamVjdCh0aGlzKTsKKy0gICAgdmFyIGxlbiA9IHQubGVuZ3RoID4+PiAwOworLSAg
ICBpZiAodHlwZW9mIGZ1biAhPT0gImZ1bmN0aW9uIikKKy0gICAgICB0aHJvdyBuZXcgVHlwZUVy
cm9yKCk7CistCistICAgIC8vIG5vIHZhbHVlIHRvIHJldHVybiBpZiBubyBpbml0aWFsIHZhbHVl
IGFuZCBhbiBlbXB0eSBhcnJheQorLSAgICBpZiAobGVuID09IDAgJiYgYXJndW1lbnRzLmxlbmd0
aCA9PSAxKQorLSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoKTsKKy0KKy0gICAgdmFyIGsgPSAw
OworLSAgICB2YXIgYWNjdW11bGF0b3I7CistICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID49IDIp
CistICAgIHsKKy0gICAgICBhY2N1bXVsYXRvciA9IGFyZ3VtZW50c1sxXTsKKy0gICAgfQorLSAg
ICBlbHNlCistICAgIHsKKy0gICAgICBkbworLSAgICAgIHsKKy0gICAgICAgIGlmIChrIGluIHQp
CistICAgICAgICB7CistICAgICAgICAgIGFjY3VtdWxhdG9yID0gdFtrKytdOworLSAgICAgICAg
ICBicmVhazsKKy0gICAgICAgIH0KKy0KKy0gICAgICAgIC8vIGlmIGFycmF5IGNvbnRhaW5zIG5v
IHZhbHVlcywgbm8gaW5pdGlhbCB2YWx1ZSB0byByZXR1cm4KKy0gICAgICAgIGlmICgrK2sgPj0g
bGVuKQorLSAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7CistICAgICAgfQorLSAgICAg
IHdoaWxlICh0cnVlKTsKKy0gICAgfQorLQorLSAgICB3aGlsZSAoayA8IGxlbikKKy0gICAgewor
LSAgICAgIGlmIChrIGluIHQpCistICAgICAgICBhY2N1bXVsYXRvciA9IGZ1bi5jYWxsKHVuZGVm
aW5lZCwgYWNjdW11bGF0b3IsIHRba10sIGssIHQpOworLSAgICAgIGsrKzsKKy0gICAgfQorLQor
LSAgICByZXR1cm4gYWNjdW11bGF0b3I7CistICB9OworLX0KKy0KKy0vLyBodHRwczovL2RldmVs
b3Blci5tb3ppbGxhLm9yZy9lbi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9B
cnJheS9pbmRleE9mCistaWYgKCFBcnJheS5wcm90b3R5cGUuaW5kZXhPZikgeworLSAgICBBcnJh
eS5wcm90b3R5cGUuaW5kZXhPZiA9IGZ1bmN0aW9uIChzZWFyY2hFbGVtZW50IC8qLCBmcm9tSW5k
ZXggKi8gKSB7CistICAgICAgICAidXNlIHN0cmljdCI7CistICAgICAgICBpZiAodGhpcyA9PT0g
dm9pZCAwIHx8IHRoaXMgPT09IG51bGwpIHsKKy0gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVy
cm9yKCk7CistICAgICAgICB9CistICAgICAgICB2YXIgdCA9IE9iamVjdCh0aGlzKTsKKy0gICAg
ICAgIHZhciBsZW4gPSB0Lmxlbmd0aCA+Pj4gMDsKKy0gICAgICAgIGlmIChsZW4gPT09IDApIHsK
Ky0gICAgICAgICAgICByZXR1cm4gLTE7CistICAgICAgICB9CistICAgICAgICB2YXIgbiA9IDA7
CistICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDApIHsKKy0gICAgICAgICAgICBuID0g
TnVtYmVyKGFyZ3VtZW50c1sxXSk7CistICAgICAgICAgICAgaWYgKG4gIT09IG4pIHsgLy8gc2hv
cnRjdXQgZm9yIHZlcmlmeWluZyBpZiBpdCdzIE5hTgorLSAgICAgICAgICAgICAgICBuID0gMDsK
Ky0gICAgICAgICAgICB9IGVsc2UgaWYgKG4gIT09IDAgJiYgbiAhPT0gSW5maW5pdHkgJiYgbiAh
PT0gLUluZmluaXR5KSB7CistICAgICAgICAgICAgICAgIG4gPSAobiA+IDAgfHwgLTEpICogTWF0
aC5mbG9vcihNYXRoLmFicyhuKSk7CistICAgICAgICAgICAgfQorLSAgICAgICAgfQorLSAgICAg
ICAgaWYgKG4gPj0gbGVuKSB7CistICAgICAgICAgICAgcmV0dXJuIC0xOworLSAgICAgICAgfQor
LSAgICAgICAgdmFyIGsgPSBuID49IDAgPyBuIDogTWF0aC5tYXgobGVuIC0gTWF0aC5hYnMobiks
IDApOworLSAgICAgICAgZm9yICg7IGsgPCBsZW47IGsrKykgeworLSAgICAgICAgICAgIGlmIChr
IGluIHQgJiYgdFtrXSA9PT0gc2VhcmNoRWxlbWVudCkgeworLSAgICAgICAgICAgICAgICByZXR1
cm4gazsKKy0gICAgICAgICAgICB9CistICAgICAgICB9CistICAgICAgICByZXR1cm4gLTE7Cist
ICAgIH0KKy19CistCistLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vZG9jcy9K
YXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9PYmplY3Qva2V5cworLWlmICghT2Jq
ZWN0LmtleXMpIHsKKy0gIE9iamVjdC5rZXlzID0gKGZ1bmN0aW9uICgpIHsKKy0gICAgdmFyIGhh
c093blByb3BlcnR5ID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSwKKy0gICAgICAg
IGhhc0RvbnRFbnVtQnVnID0gISh7dG9TdHJpbmc6IG51bGx9KS5wcm9wZXJ0eUlzRW51bWVyYWJs
ZSgndG9TdHJpbmcnKSwKKy0gICAgICAgIGRvbnRFbnVtcyA9IFsKKy0gICAgICAgICAgJ3RvU3Ry
aW5nJywKKy0gICAgICAgICAgJ3RvTG9jYWxlU3RyaW5nJywKKy0gICAgICAgICAgJ3ZhbHVlT2Yn
LAorLSAgICAgICAgICAnaGFzT3duUHJvcGVydHknLAorLSAgICAgICAgICAnaXNQcm90b3R5cGVP
ZicsCistICAgICAgICAgICdwcm9wZXJ0eUlzRW51bWVyYWJsZScsCistICAgICAgICAgICdjb25z
dHJ1Y3RvcicKKy0gICAgICAgIF0sCistICAgICAgICBkb250RW51bXNMZW5ndGggPSBkb250RW51
bXMubGVuZ3RoOworLQorLSAgICByZXR1cm4gZnVuY3Rpb24gKG9iaikgeworLSAgICAgIGlmICh0
eXBlb2Ygb2JqICE9PSAnb2JqZWN0JyAmJiB0eXBlb2Ygb2JqICE9PSAnZnVuY3Rpb24nIHx8IG9i
aiA9PT0gbnVsbCkgdGhyb3cgbmV3IFR5cGVFcnJvcignT2JqZWN0LmtleXMgY2FsbGVkIG9uIG5v
bi1vYmplY3QnKTsKKy0KKy0gICAgICB2YXIgcmVzdWx0ID0gW107CistCistICAgICAgZm9yICh2
YXIgcHJvcCBpbiBvYmopIHsKKy0gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwg
cHJvcCkpIHJlc3VsdC5wdXNoKHByb3ApOworLSAgICAgIH0KKy0KKy0gICAgICBpZiAoaGFzRG9u
dEVudW1CdWcpIHsKKy0gICAgICAgIGZvciAodmFyIGk9MDsgaSA8IGRvbnRFbnVtc0xlbmd0aDsg
aSsrKSB7CistICAgICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgZG9udEVudW1z
W2ldKSkgcmVzdWx0LnB1c2goZG9udEVudW1zW2ldKTsKKy0gICAgICAgIH0KKy0gICAgICB9Cist
ICAgICAgcmV0dXJuIHJlc3VsdDsKKy0gICAgfQorLSAgfSkoKQorLX07CistCistLy8gaHR0cHM6
Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vZG9jcy9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9i
YWxfT2JqZWN0cy9PYmplY3QvY3JlYXRlCistaWYgKCFPYmplY3QuY3JlYXRlKSB7CistICAgIE9i
amVjdC5jcmVhdGUgPSBmdW5jdGlvbiAobykgeworLSAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5n
dGggPiAxKSB7CistICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdPYmplY3QuY3JlYXRlIGlt
cGxlbWVudGF0aW9uIG9ubHkgYWNjZXB0cyB0aGUgZmlyc3QgcGFyYW1ldGVyLicpOworLSAgICAg
ICAgfQorLSAgICAgICAgZnVuY3Rpb24gRigpIHt9CistICAgICAgICBGLnByb3RvdHlwZSA9IG87
CistICAgICAgICByZXR1cm4gbmV3IEYoKTsKKy0gICAgfTsKKy19CistCistLy8gaHR0cHM6Ly9k
ZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vZG9jcy9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxf
T2JqZWN0cy9BcnJheS9maWx0ZXIKKy1pZiAoIUFycmF5LnByb3RvdHlwZS5maWx0ZXIpCistewor
LSAgQXJyYXkucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uKGZ1biAvKiwgdGhpc3AqLykKKy0g
IHsKKy0gICAgInVzZSBzdHJpY3QiOworLQorLSAgICBpZiAodGhpcyA9PSBudWxsKQorLSAgICAg
IHRocm93IG5ldyBUeXBlRXJyb3IoKTsKKy0KKy0gICAgdmFyIHQgPSBPYmplY3QodGhpcyk7Cist
ICAgIHZhciBsZW4gPSB0Lmxlbmd0aCA+Pj4gMDsKKy0gICAgaWYgKHR5cGVvZiBmdW4gIT0gImZ1
bmN0aW9uIikKKy0gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCk7CistCistICAgIHZhciByZXMg
PSBbXTsKKy0gICAgdmFyIHRoaXNwID0gYXJndW1lbnRzWzFdOworLSAgICBmb3IgKHZhciBpID0g
MDsgaSA8IGxlbjsgaSsrKQorLSAgICB7CistICAgICAgaWYgKGkgaW4gdCkKKy0gICAgICB7Cist
ICAgICAgICB2YXIgdmFsID0gdFtpXTsgLy8gaW4gY2FzZSBmdW4gbXV0YXRlcyB0aGlzCistICAg
ICAgICBpZiAoZnVuLmNhbGwodGhpc3AsIHZhbCwgaSwgdCkpCistICAgICAgICAgIHJlcy5wdXNo
KHZhbCk7CistICAgICAgfQorLSAgICB9CistCistICAgIHJldHVybiByZXM7CistICB9OworLX0K
Ky0KKy0vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9kb2NzL0phdmFTY3JpcHQv
UmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0Z1bmN0aW9uL2JpbmQKKy1pZiAoIUZ1bmN0aW9uLnBy
b3RvdHlwZS5iaW5kKSB7CistICBGdW5jdGlvbi5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChv
VGhpcykgeworLSAgICBpZiAodHlwZW9mIHRoaXMgIT09ICJmdW5jdGlvbiIpIHsKKy0gICAgICAv
LyBjbG9zZXN0IHRoaW5nIHBvc3NpYmxlIHRvIHRoZSBFQ01BU2NyaXB0IDUgaW50ZXJuYWwgSXND
YWxsYWJsZSBmdW5jdGlvbgorLSAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoIkZ1bmN0aW9uLnBy
b3RvdHlwZS5iaW5kIC0gd2hhdCBpcyB0cnlpbmcgdG8gYmUgYm91bmQgaXMgbm90IGNhbGxhYmxl
Iik7CistICAgIH0KKy0KKy0gICAgdmFyIGFBcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNh
bGwoYXJndW1lbnRzLCAxKSwKKy0gICAgICAgIGZUb0JpbmQgPSB0aGlzLAorLSAgICAgICAgZk5P
UCA9IGZ1bmN0aW9uICgpIHt9LAorLSAgICAgICAgZkJvdW5kID0gZnVuY3Rpb24gKCkgeworLSAg
ICAgICAgICByZXR1cm4gZlRvQmluZC5hcHBseSh0aGlzIGluc3RhbmNlb2YgZk5PUCAmJiBvVGhp
cworLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gdGhpcworLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIDogb1RoaXMsCistICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGFBcmdzLmNvbmNhdChBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMp
KSk7CistICAgICAgICB9OworLQorLSAgICBmTk9QLnByb3RvdHlwZSA9IHRoaXMucHJvdG90eXBl
OworLSAgICBmQm91bmQucHJvdG90eXBlID0gbmV3IGZOT1AoKTsKKy0KKy0gICAgcmV0dXJuIGZC
b3VuZDsKKy0gIH07CistfQorLQorLS8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2Vu
L2RvY3MvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvaXNBcnJheQor
LWlmKCFBcnJheS5pc0FycmF5KSB7CistICBBcnJheS5pc0FycmF5ID0gZnVuY3Rpb24gKHZBcmcp
IHsKKy0gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh2QXJnKSA9PT0g
IltvYmplY3QgQXJyYXldIjsKKy0gIH07CistfQorLQorLS8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1v
emlsbGEub3JnL2VuL2RvY3MvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvU3Ry
aW5nL3RyaW0KKy1pZighU3RyaW5nLnByb3RvdHlwZS50cmltKSB7CistICBTdHJpbmcucHJvdG90
eXBlLnRyaW0gPSBmdW5jdGlvbiAoKSB7CistICAgIHJldHVybiB0aGlzLnJlcGxhY2UoL15ccyt8
XHMrJC9nLCcnKTsKKy0gIH07CistfQorLQorLQorLWZ1bmN0aW9uIGRlZmluZVByb3BlcnR5V29y
a3MoKSB7CistICB0cnkgeworLSAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICJwcm9wZXJ0
eSIsIHt9KTsKKy0gICAgcmV0dXJuIHRydWU7CistICB9IGNhdGNoIChleGNlcHRpb24pIHsKKy0g
ICAgcmV0dXJuIGZhbHNlOworLSAgfQorLX0KKy0KKy1pZiAoIWRlZmluZVByb3BlcnR5V29ya3Mo
KSkgeworLSAgT2JqZWN0LmRlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24gZGVmaW5lUHJvcGVydHko
b2JqZWN0KSB7CistICAgIC8vIGZhaWwgc2lsZW50bHkKKy0gICAgcmV0dXJuIG9iamVjdDsKKy0g
IH0KKy19CitkaWZmIC0tZ2l0IGEvbGliL3NwbGl0LmpzIGIvbGliL3NwbGl0LmpzCitkZWxldGVk
IGZpbGUgbW9kZSAxMDA2NDQKK2luZGV4IDhjYzI5MjQuLjAwMDAwMDAKKy0tLSBhL2xpYi9zcGxp
dC5qcworKysrIC9kZXYvbnVsbAorQEAgLTEsMTE3ICswLDAgQEAKKy0vKiEKKy0gKiBDcm9zcy1C
cm93c2VyIFNwbGl0IDEuMS4xCistICogQ29weXJpZ2h0IDIwMDctMjAxMiBTdGV2ZW4gTGV2aXRo
YW4gPHN0ZXZlbmxldml0aGFuLmNvbT4KKy0gKiBBdmFpbGFibGUgdW5kZXIgdGhlIE1JVCBMaWNl
bnNlCistICogRUNNQVNjcmlwdCBjb21wbGlhbnQsIHVuaWZvcm0gY3Jvc3MtYnJvd3NlciBzcGxp
dCBtZXRob2QKKy0gKi8KKy0KKy0vKioKKy0gKiBTcGxpdHMgYSBzdHJpbmcgaW50byBhbiBhcnJh
eSBvZiBzdHJpbmdzIHVzaW5nIGEgcmVnZXggb3Igc3RyaW5nIHNlcGFyYXRvci4gTWF0Y2hlcyBv
ZiB0aGUKKy0gKiBzZXBhcmF0b3IgYXJlIG5vdCBpbmNsdWRlZCBpbiB0aGUgcmVzdWx0IGFycmF5
LiBIb3dldmVyLCBpZiBgc2VwYXJhdG9yYCBpcyBhIHJlZ2V4IHRoYXQgY29udGFpbnMKKy0gKiBj
YXB0dXJpbmcgZ3JvdXBzLCBiYWNrcmVmZXJlbmNlcyBhcmUgc3BsaWNlZCBpbnRvIHRoZSByZXN1
bHQgZWFjaCB0aW1lIGBzZXBhcmF0b3JgIGlzIG1hdGNoZWQuCistICogRml4ZXMgYnJvd3NlciBi
dWdzIGNvbXBhcmVkIHRvIHRoZSBuYXRpdmUgYFN0cmluZy5wcm90b3R5cGUuc3BsaXRgIGFuZCBj
YW4gYmUgdXNlZCByZWxpYWJseQorLSAqIGNyb3NzLWJyb3dzZXIuCistICogQHBhcmFtIHtTdHJp
bmd9IHN0ciBTdHJpbmcgdG8gc3BsaXQuCistICogQHBhcmFtIHtSZWdFeHB8U3RyaW5nfSBzZXBh
cmF0b3IgUmVnZXggb3Igc3RyaW5nIHRvIHVzZSBmb3Igc2VwYXJhdGluZyB0aGUgc3RyaW5nLgor
LSAqIEBwYXJhbSB7TnVtYmVyfSBbbGltaXRdIE1heGltdW0gbnVtYmVyIG9mIGl0ZW1zIHRvIGlu
Y2x1ZGUgaW4gdGhlIHJlc3VsdCBhcnJheS4KKy0gKiBAcmV0dXJucyB7QXJyYXl9IEFycmF5IG9m
IHN1YnN0cmluZ3MuCistICogQGV4YW1wbGUKKy0gKgorLSAqIC8vIEJhc2ljIHVzZQorLSAqIHNw
bGl0KCdhIGIgYyBkJywgJyAnKTsKKy0gKiAvLyAtPiBbJ2EnLCAnYicsICdjJywgJ2QnXQorLSAq
CistICogLy8gV2l0aCBsaW1pdAorLSAqIHNwbGl0KCdhIGIgYyBkJywgJyAnLCAyKTsKKy0gKiAv
LyAtPiBbJ2EnLCAnYiddCistICoKKy0gKiAvLyBCYWNrcmVmZXJlbmNlcyBpbiByZXN1bHQgYXJy
YXkKKy0gKiBzcGxpdCgnLi53b3JkMSB3b3JkMi4uJywgLyhbYS16XSspKFxkKykvaSk7CistICog
Ly8gLT4gWycuLicsICd3b3JkJywgJzEnLCAnICcsICd3b3JkJywgJzInLCAnLi4nXQorLSAqLwor
LXZhciBzcGxpdDsKKy0KKy0vLyBBdm9pZCBydW5uaW5nIHR3aWNlOyB0aGF0IHdvdWxkIGJyZWFr
IHRoZSBgbmF0aXZlU3BsaXRgIHJlZmVyZW5jZQorLXNwbGl0ID0gc3BsaXQgfHwgZnVuY3Rpb24g
KHVuZGVmKSB7CistCistICAgIHZhciBuYXRpdmVTcGxpdCA9IFN0cmluZy5wcm90b3R5cGUuc3Bs
aXQsCistICAgICAgICBjb21wbGlhbnRFeGVjTnBjZyA9IC8oKT8/Ly5leGVjKCIiKVsxXSA9PT0g
dW5kZWYsIC8vIE5QQ0c6IG5vbnBhcnRpY2lwYXRpbmcgY2FwdHVyaW5nIGdyb3VwCistICAgICAg
ICBzZWxmOworLQorLSAgICBzZWxmID0gZnVuY3Rpb24gKHN0ciwgc2VwYXJhdG9yLCBsaW1pdCkg
eworLSAgICAgICAgLy8gSWYgYHNlcGFyYXRvcmAgaXMgbm90IGEgcmVnZXgsIHVzZSBgbmF0aXZl
U3BsaXRgCistICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHNlcGFy
YXRvcikgIT09ICJbb2JqZWN0IFJlZ0V4cF0iKSB7CistICAgICAgICAgICAgcmV0dXJuIG5hdGl2
ZVNwbGl0LmNhbGwoc3RyLCBzZXBhcmF0b3IsIGxpbWl0KTsKKy0gICAgICAgIH0KKy0gICAgICAg
IHZhciBvdXRwdXQgPSBbXSwKKy0gICAgICAgICAgICBmbGFncyA9IChzZXBhcmF0b3IuaWdub3Jl
Q2FzZSA/ICJpIiA6ICIiKSArCistICAgICAgICAgICAgICAgICAgICAoc2VwYXJhdG9yLm11bHRp
bGluZSAgPyAibSIgOiAiIikgKworLSAgICAgICAgICAgICAgICAgICAgKHNlcGFyYXRvci5leHRl
bmRlZCAgID8gIngiIDogIiIpICsgLy8gUHJvcG9zZWQgZm9yIEVTNgorLSAgICAgICAgICAgICAg
ICAgICAgKHNlcGFyYXRvci5zdGlja3kgICAgID8gInkiIDogIiIpLCAvLyBGaXJlZm94IDMrCist
ICAgICAgICAgICAgbGFzdExhc3RJbmRleCA9IDAsCistICAgICAgICAgICAgLy8gTWFrZSBgZ2xv
YmFsYCBhbmQgYXZvaWQgYGxhc3RJbmRleGAgaXNzdWVzIGJ5IHdvcmtpbmcgd2l0aCBhIGNvcHkK
Ky0gICAgICAgICAgICBzZXBhcmF0b3IgPSBuZXcgUmVnRXhwKHNlcGFyYXRvci5zb3VyY2UsIGZs
YWdzICsgImciKSwKKy0gICAgICAgICAgICBzZXBhcmF0b3IyLCBtYXRjaCwgbGFzdEluZGV4LCBs
YXN0TGVuZ3RoOworLSAgICAgICAgc3RyICs9ICIiOyAvLyBUeXBlLWNvbnZlcnQKKy0gICAgICAg
IGlmICghY29tcGxpYW50RXhlY05wY2cpIHsKKy0gICAgICAgICAgICAvLyBEb2Vzbid0IG5lZWQg
ZmxhZ3MgZ3ksIGJ1dCB0aGV5IGRvbid0IGh1cnQKKy0gICAgICAgICAgICBzZXBhcmF0b3IyID0g
bmV3IFJlZ0V4cCgiXiIgKyBzZXBhcmF0b3Iuc291cmNlICsgIiQoPyFcXHMpIiwgZmxhZ3MpOwor
LSAgICAgICAgfQorLSAgICAgICAgLyogVmFsdWVzIGZvciBgbGltaXRgLCBwZXIgdGhlIHNwZWM6
CistICAgICAgICAgKiBJZiB1bmRlZmluZWQ6IDQyOTQ5NjcyOTUgLy8gTWF0aC5wb3coMiwgMzIp
IC0gMQorLSAgICAgICAgICogSWYgMCwgSW5maW5pdHksIG9yIE5hTjogMAorLSAgICAgICAgICog
SWYgcG9zaXRpdmUgbnVtYmVyOiBsaW1pdCA9IE1hdGguZmxvb3IobGltaXQpOyBpZiAobGltaXQg
PiA0Mjk0OTY3Mjk1KSBsaW1pdCAtPSA0Mjk0OTY3Mjk2OworLSAgICAgICAgICogSWYgbmVnYXRp
dmUgbnVtYmVyOiA0Mjk0OTY3Mjk2IC0gTWF0aC5mbG9vcihNYXRoLmFicyhsaW1pdCkpCistICAg
ICAgICAgKiBJZiBvdGhlcjogVHlwZS1jb252ZXJ0LCB0aGVuIHVzZSB0aGUgYWJvdmUgcnVsZXMK
Ky0gICAgICAgICAqLworLSAgICAgICAgbGltaXQgPSBsaW1pdCA9PT0gdW5kZWYgPworLSAgICAg
ICAgICAgIC0xID4+PiAwIDogLy8gTWF0aC5wb3coMiwgMzIpIC0gMQorLSAgICAgICAgICAgIGxp
bWl0ID4+PiAwOyAvLyBUb1VpbnQzMihsaW1pdCkKKy0gICAgICAgIHdoaWxlIChtYXRjaCA9IHNl
cGFyYXRvci5leGVjKHN0cikpIHsKKy0gICAgICAgICAgICAvLyBgc2VwYXJhdG9yLmxhc3RJbmRl
eGAgaXMgbm90IHJlbGlhYmxlIGNyb3NzLWJyb3dzZXIKKy0gICAgICAgICAgICBsYXN0SW5kZXgg
PSBtYXRjaC5pbmRleCArIG1hdGNoWzBdLmxlbmd0aDsKKy0gICAgICAgICAgICBpZiAobGFzdElu
ZGV4ID4gbGFzdExhc3RJbmRleCkgeworLSAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChzdHIu
c2xpY2UobGFzdExhc3RJbmRleCwgbWF0Y2guaW5kZXgpKTsKKy0gICAgICAgICAgICAgICAgLy8g
Rml4IGJyb3dzZXJzIHdob3NlIGBleGVjYCBtZXRob2RzIGRvbid0IGNvbnNpc3RlbnRseSByZXR1
cm4gYHVuZGVmaW5lZGAgZm9yCistICAgICAgICAgICAgICAgIC8vIG5vbnBhcnRpY2lwYXRpbmcg
Y2FwdHVyaW5nIGdyb3VwcworLSAgICAgICAgICAgICAgICBpZiAoIWNvbXBsaWFudEV4ZWNOcGNn
ICYmIG1hdGNoLmxlbmd0aCA+IDEpIHsKKy0gICAgICAgICAgICAgICAgICAgIG1hdGNoWzBdLnJl
cGxhY2Uoc2VwYXJhdG9yMiwgZnVuY3Rpb24gKCkgeworLSAgICAgICAgICAgICAgICAgICAgICAg
IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aCAtIDI7IGkrKykgeworLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXJndW1lbnRzW2ldID09PSB1bmRlZikgeworLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hbaV0gPSB1bmRlZjsKKy0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgfQorLSAgICAgICAgICAgICAgICAgICAgICAgIH0KKy0gICAg
ICAgICAgICAgICAgICAgIH0pOworLSAgICAgICAgICAgICAgICB9CistICAgICAgICAgICAgICAg
IGlmIChtYXRjaC5sZW5ndGggPiAxICYmIG1hdGNoLmluZGV4IDwgc3RyLmxlbmd0aCkgeworLSAg
ICAgICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkob3V0cHV0LCBtYXRj
aC5zbGljZSgxKSk7CistICAgICAgICAgICAgICAgIH0KKy0gICAgICAgICAgICAgICAgbGFzdExl
bmd0aCA9IG1hdGNoWzBdLmxlbmd0aDsKKy0gICAgICAgICAgICAgICAgbGFzdExhc3RJbmRleCA9
IGxhc3RJbmRleDsKKy0gICAgICAgICAgICAgICAgaWYgKG91dHB1dC5sZW5ndGggPj0gbGltaXQp
IHsKKy0gICAgICAgICAgICAgICAgICAgIGJyZWFrOworLSAgICAgICAgICAgICAgICB9CistICAg
ICAgICAgICAgfQorLSAgICAgICAgICAgIGlmIChzZXBhcmF0b3IubGFzdEluZGV4ID09PSBtYXRj
aC5pbmRleCkgeworLSAgICAgICAgICAgICAgICBzZXBhcmF0b3IubGFzdEluZGV4Kys7IC8vIEF2
b2lkIGFuIGluZmluaXRlIGxvb3AKKy0gICAgICAgICAgICB9CistICAgICAgICB9CistICAgICAg
ICBpZiAobGFzdExhc3RJbmRleCA9PT0gc3RyLmxlbmd0aCkgeworLSAgICAgICAgICAgIGlmIChs
YXN0TGVuZ3RoIHx8ICFzZXBhcmF0b3IudGVzdCgiIikpIHsKKy0gICAgICAgICAgICAgICAgb3V0
cHV0LnB1c2goIiIpOworLSAgICAgICAgICAgIH0KKy0gICAgICAgIH0gZWxzZSB7CistICAgICAg
ICAgICAgb3V0cHV0LnB1c2goc3RyLnNsaWNlKGxhc3RMYXN0SW5kZXgpKTsKKy0gICAgICAgIH0K
Ky0gICAgICAgIHJldHVybiBvdXRwdXQubGVuZ3RoID4gbGltaXQgPyBvdXRwdXQuc2xpY2UoMCwg
bGltaXQpIDogb3V0cHV0OworLSAgICB9OworLQorLSAgICBpZiAoIlxuIi5zcGxpdCgvXG4vKS5s
ZW5ndGggPT0gMCkgeworLSAgICAgICAgU3RyaW5nLnByb3RvdHlwZS5zcGxpdCA9IGZ1bmN0aW9u
IChzZXBhcmF0b3IsIGxpbWl0KSB7CistICAgICAgICAgICAgcmV0dXJuIHNlbGYodGhpcywgc2Vw
YXJhdG9yLCBsaW1pdCk7CistICAgICAgICB9OworLSAgICB9CistCistICAgIHJldHVybiBzZWxm
OworLQorLX0oKTsKK2RpZmYgLS1naXQgYS9saWIvdWdsaWZpZXIucmIgYi9saWIvdWdsaWZpZXIu
cmIKK2luZGV4IGRlMjRlMjYuLjQzMWM0YjMgMTAwNjQ0CistLS0gYS9saWIvdWdsaWZpZXIucmIK
KysrKyBiL2xpYi91Z2xpZmllci5yYgorQEAgLTE0LDEwICsxNCw2IEBAIGNsYXNzIFVnbGlmaWVy
CisgICBTb3VyY2VQYXRoID0gRmlsZS5leHBhbmRfcGF0aCgiLi4vdWdsaWZ5LmpzIiwgX19GSUxF
X18pCisgICAjIFNvdXJjZSBNYXAgcGF0aAorICAgU291cmNlTWFwUGF0aCA9IEZpbGUuZXhwYW5k
X3BhdGgoIi4uL3NvdXJjZS1tYXAuanMiLCBfX0ZJTEVfXykKKy0gICMgRVM1IHNoaW1zIHNvdXJj
ZSBwYXRoCistICBFUzVGYWxsYmFja1BhdGggPSBGaWxlLmV4cGFuZF9wYXRoKCIuLi9lczUuanMi
LCBfX0ZJTEVfXykKKy0gICMgU3RyaW5nLnNwbGl0IHNoaW0gc291cmNlIHBhdGgKKy0gIFNwbGl0
RmFsbGJhY2tQYXRoID0gRmlsZS5leHBhbmRfcGF0aCgiLi4vc3BsaXQuanMiLCBfX0ZJTEVfXykK
KyAgICMgVWdsaWZ5SlMgd3JhcHBlciBwYXRoCisgICBVZ2xpZnlKU1dyYXBwZXJQYXRoID0gRmls
ZS5leHBhbmRfcGF0aCgiLi4vdWdsaWZpZXIuanMiLCBfX0ZJTEVfXykKKyAKK0BAIC0xNTQsNyAr
MTUwLDcgQEAgY2xhc3MgVWdsaWZpZXIKKyAgIHByaXZhdGUKKyAKKyAgIGRlZiB1Z2xpZnlqc19z
b3VyY2UKKy0gICAgW0VTNUZhbGxiYWNrUGF0aCwgU3BsaXRGYWxsYmFja1BhdGgsIFNvdXJjZU1h
cFBhdGgsIFNvdXJjZVBhdGgsCisrICAgIFtTb3VyY2VNYXBQYXRoLCBTb3VyY2VQYXRoLAorICAg
ICAgVWdsaWZ5SlNXcmFwcGVyUGF0aF0ubWFwIGRvIHxmaWxlfAorICAgICAgIEZpbGUub3Blbihm
aWxlLCAicjpVVEYtOCIsICY6cmVhZCkKKyAgICAgZW5kLmpvaW4oIlxuIikKKy0tIAorMi41LjUK
KwpkaWZmIC0tZ2l0IGEvcnVieWdlbS11Z2xpZmllci5zcGVjIGIvcnVieWdlbS11Z2xpZmllci5z
cGVjCmluZGV4IDNlNzZkZjUuLjNhMzYwMWEgMTAwNjQ0Ci0tLSBhL3J1YnlnZW0tdWdsaWZpZXIu
c3BlYworKysgYi9ydWJ5Z2VtLXVnbGlmaWVyLnNwZWMKQEAgLTMsMzIgKzMsNDIgQEAKIAogU3Vt
bWFyeTogUnVieSB3cmFwcGVyIGZvciBVZ2xpZnlKUyBKYXZhU2NyaXB0IGNvbXByZXNzb3IKIE5h
bWU6IHJ1YnlnZW0tJXtnZW1fbmFtZX0KLVZlcnNpb246IDIuNC4wCi1SZWxlYXNlOiA0JXs/ZGlz
dH0KK1ZlcnNpb246IDMuMC4wCitSZWxlYXNlOiAxJXs/ZGlzdH0KIEdyb3VwOiBEZXZlbG9wbWVu
dC9MYW5ndWFnZXMKICMgVWdsaWZpZXIgaXRzZWxmIGlzIE1JVAotIyB0aGUgYnVuZGxlZCBKYXZh
U2NyaXB0IGZyb20gVWdsaWZ5SlMgaXMgQlNECisjIEJ1bmRsZWQgbGliL3NvdXJjZS1tYXAuanMg
aXMgQlNELgorIyBXZSBoYXZlIG5vZGVqcy1zb3VyY2UtbWFwLgorIyBCdXQgaXQgaGFzIG5vdCBp
bmNsdWRlZCBuZWVkZWQgZGlzdC9zb3VyY2UtbWFwLmpzIHlldC4KKyMgaHR0cHM6Ly9idWd6aWxs
YS5yZWRoYXQuY29tL3Nob3dfYnVnLmNnaT9pZD0xMzU4OTE1CiBMaWNlbnNlOiBNSVQgYW5kIEJT
RAogVVJMOiBodHRwOi8vZ2l0aHViLmNvbS9sYXV0aXMvdWdsaWZpZXIKLVNvdXJjZTA6IGh0dHA6
Ly9ydWJ5Z2Vtcy5vcmcvZ2Vtcy8le2dlbV9uYW1lfS0le3ZlcnNpb259LmdlbQotUmVxdWlyZXM6
IHJ1YnkocmVsZWFzZSkKLVJlcXVpcmVzOiBydWJ5KHJ1YnlnZW1zKSAKLVJlcXVpcmVzOiBydWJ5
Z2VtKGV4ZWNqcykgPj0gMC4zLjAKLVJlcXVpcmVzOiBydWJ5Z2VtKG11bHRpX2pzb24pID0+IDEu
MwotUmVxdWlyZXM6IHJ1YnlnZW0obXVsdGlfanNvbikgPCAyCitTb3VyY2UwOiBodHRwczovL3J1
YnlnZW1zLm9yZy9nZW1zLyV7Z2VtX25hbWV9LSV7dmVyc2lvbn0uZ2VtCisjIFNlcGFyYXRlIGxp
Yi91Z2xpZnkuanMgYW5kIGxpYi9zb3VyY2UtbWFwLmpzCisjIGh0dHBzOi8vZ2l0aHViLmNvbS9s
YXV0aXMvdWdsaWZpZXIvcHVsbC85OC5wYXRjaAorUGF0Y2gwOiBydWJ5Z2VtLXVnbGlmaWVyLTMu
MC4wLXNlcGFyYXRlLXNvdXJjZS1tYXAucGF0Y2gKKyMgUmVtb3ZlIGpzIGZpbGVzIGZvciBFQ01B
U2NyaXB0IDUgdW5zdXBwb3J0aW5nIEpTIEVuZ2luZSAoSlNjcmlwdCkKKyMgdG8gcHJldmVudCBi
dW5kbGVkIEpTIGZpbGVzIGFzIG11Y2ggYXMgcG9zc2libGUuCisjIGh0dHBzOi8vZ2l0aHViLmNv
bS9sYXV0aXMvdWdsaWZpZXIvaXNzdWVzLzk5CitQYXRjaDE6IHJ1YnlnZW0tdWdsaWZpZXItMy4w
LjAtdW5idW5kbGUtanMtZmlsZXMtZm9yLWpzY3JpcHQucGF0Y2gKKyMgRml4IHRlc3QgdG8gdXNl
IFVnbGlmeUpzIDIuNy4wCisjIGh0dHBzOi8vZ2l0aHViLmNvbS9sYXV0aXMvdWdsaWZpZXIvY29t
bWl0L2Y2NzZiNjYucGF0Y2gKK1BhdGNoMjogcnVieWdlbS11Z2xpZmllci0zLjAuMC1maXgtdGVz
dC1mb3ItdWdsaWZ5anMtMi43LjAucGF0Y2gKKwogQnVpbGRSZXF1aXJlczogcnVieShyZWxlYXNl
KQogQnVpbGRSZXF1aXJlczogcnVieWdlbXMtZGV2ZWwKIEJ1aWxkUmVxdWlyZXM6IHJ1YnkKIEJ1
aWxkUmVxdWlyZXM6IHJ1YnlnZW0oZXhlY2pzKSA+PSAwLjMuMAotQnVpbGRSZXF1aXJlczogcnVi
eWdlbShtdWx0aV9qc29uKSA9PiAxLjMKLUJ1aWxkUmVxdWlyZXM6IHJ1YnlnZW0obXVsdGlfanNv
bikgPCAyCiBCdWlsZFJlcXVpcmVzOiBydWJ5Z2VtKHJzcGVjKQotQnVpbGRSZXF1aXJlczogcnVi
eWdlbSh0aGVydWJ5cmFjZXIpCitCdWlsZFJlcXVpcmVzOiAle19iaW5kaXJ9L25vZGUKK0J1aWxk
UmVxdWlyZXM6IG5vZGVqcy1wYWNrYWdpbmcKK0J1aWxkUmVxdWlyZXM6IG5wbShzb3VyY2UtbWFw
KQorQnVpbGRSZXF1aXJlczogdWdsaWZ5LWpzID49IDIuNy4wCiBCdWlsZEFyY2g6IG5vYXJjaAot
UHJvdmlkZXM6IHJ1YnlnZW0oJXtnZW1fbmFtZX0pID0gJXt2ZXJzaW9ufQogCiAlZGVzY3JpcHRp
b24KLVJ1Ynkgd3JhcHBlciBmb3IgVWdsaWZ5SlMgSmF2YVNjcmlwdCBjb21wcmVzc29yLgorVWds
aWZpZXIgbWluaWZpZXMgSmF2YVNjcmlwdCBmaWxlcyBieSB3cmFwcGluZyBVZ2xpZnlKUyB0byBi
ZSBhY2Nlc3NpYmxlIGluCitSdWJ5LgogCiAKICVwYWNrYWdlIGRvYwpAQCAtNDEsMTAgKzUxLDI3
IEBAIEJ1aWxkQXJjaDogbm9hcmNoCiBEb2N1bWVudGF0aW9uIGZvciAle25hbWV9CiAKICVwcmVw
Ci0lc2V0dXAgLXEgLWMgLVQKLSVnZW1faW5zdGFsbCAtbiAle1NPVVJDRTB9CitnZW0gdW5wYWNr
ICV7U09VUkNFMH0KKworJXNldHVwIC1xIC1EIC1UIC1uICAle2dlbV9uYW1lfS0le3ZlcnNpb259
CisKK2dlbSBzcGVjICV7U09VUkNFMH0gLWwgLS1ydWJ5ID4gJXtnZW1fbmFtZX0uZ2Vtc3BlYwor
JXBhdGNoMCAtcDEKK3NlZCAtaSAnL2ZpbGVzLyBzfCJcXXwiLCAibGliL3NvdXJjZS1tYXAuanMi
XF18JyAle2dlbV9uYW1lfS5nZW1zcGVjCislcGF0Y2gxIC1wMQorc2VkIC1pICcvZmlsZXMvIHN8
ImxpYi9lczUuanMiLCB8fCcgJXtnZW1fbmFtZX0uZ2Vtc3BlYworc2VkIC1pICcvZmlsZXMvIHN8
ImxpYi9zcGxpdC5qcyIsIHx8JyAle2dlbV9uYW1lfS5nZW1zcGVjCisKKyMgVXNlIHN5c210ZW0g
dWdsaWZ5LmpzCit1Z2xpZnlqcyAtLXNlbGYgLS1jb21tZW50cyAvQ29weXJpZ2h0LyA+IGxpYi91
Z2xpZnkuanMKIAogJWJ1aWxkCisjIENyZWF0ZSB0aGUgZ2VtIGFzIGdlbSBpbnN0YWxsIG9ubHkg
d29ya3Mgb24gYSBnZW0gZmlsZQorZ2VtIGJ1aWxkICV7Z2VtX25hbWV9LmdlbXNwZWMKKworIyAl
JWdlbV9pbnN0YWxsIGNvbXBpbGVzIGFueSBDIGV4dGVuc2lvbnMgYW5kIGluc3RhbGxzIHRoZSBn
ZW0gaW50byAuLyUlZ2VtX2RpcgorIyBieSBkZWZhdWx0LCBzbyB0aGF0IHdlIGNhbiBtb3ZlIGl0
IGludG8gdGhlIGJ1aWxkcm9vdCBpbiAlJWluc3RhbGwKKyVnZW1faW5zdGFsbAogCiAlaW5zdGFs
bAogbWtkaXIgLXAgJXtidWlsZHJvb3R9JXtnZW1fZGlyfQpAQCAtNTMsMTAgKzgwLDExIEBAIGNw
IC1hIC4le2dlbV9kaXJ9LyogXAogCiAlY2hlY2sKIHB1c2hkIC4le2dlbV9pbnN0ZGlyfQorcGF0
Y2ggLXAxIDwgJXtQQVRDSDJ9CiAKLSMgc291cmNlX21hcCBpcyBub3QgcGFydCBvZiBmZWRvcmEg
eWV0LCBnZWQgcmlkIG9mIHNvdXJjZV9tYXAgaW4gc3BlY3MKLXNlZCAtaSAicy9yZXF1aXJlICdz
b3VyY2VfbWFwJy8vIiAgc3BlYy9zcGVjX2hlbHBlci5yYgotcm0gc3BlYy9zb3VyY2VfbWFwX3Nw
ZWMucmIKKyMgRGlzYWJsZSBydWJ5Z2VtLXNvdXJjZW1hcCBiZWNhdXNlIGl0IGlzIG5vdCBwYXJ0
IG9mIGZlZG9yYSB5ZXQuCitzZWQgLWkgInMvcmVxdWlyZSAnc291cmNlbWFwJy8vIiAgc3BlYy9z
cGVjX2hlbHBlci5yYgorc2VkIC1pICcvU291cmNlTWFwOjpNYXAvIGkgXCAgICBwZW5kaW5nJyBz
cGVjL3NvdXJjZV9tYXBfc3BlYy5yYgogCiByc3BlYyBzcGVjCiBwb3BkCkBAIC02NCwyNCArOTIs
MjggQEAgcG9wZAogCiAlZmlsZXMKICVkaXIgJXtnZW1faW5zdGRpcn0KLSVkb2MgJXtnZW1faW5z
dGRpcn0vTElDRU5TRS50eHQKKyVsaWNlbnNlICV7Z2VtX2luc3RkaXJ9L0xJQ0VOU0UudHh0CiAl
e2dlbV9saWJkaXJ9CiAlZXhjbHVkZSAle2dlbV9pbnN0ZGlyfS8uKgogJWV4Y2x1ZGUgJXtnZW1f
Y2FjaGV9Ci0lZXhjbHVkZSAle2dlbV9pbnN0ZGlyfS9nZW1maWxlcwogJXtnZW1fc3BlY30KIAog
JWZpbGVzIGRvYwogJWRvYyAle2dlbV9kb2NkaXJ9CislZG9jICV7Z2VtX2luc3RkaXJ9L0NIQU5H
RUxPRy5tZAorJWRvYyAle2dlbV9pbnN0ZGlyfS9DT05UUklCVVRJTkcubWQKICV7Z2VtX2luc3Rk
aXJ9L0dlbWZpbGUKICV7Z2VtX2luc3RkaXJ9L1Jha2VmaWxlCiAlZG9jICV7Z2VtX2luc3RkaXJ9
L1JFQURNRS5tZAorJXtnZW1faW5zdGRpcn0vZ2VtZmlsZXMKICV7Z2VtX2luc3RkaXJ9L3NwZWMK
ICV7Z2VtX2luc3RkaXJ9LyV7Z2VtX25hbWV9LmdlbXNwZWMKLSVkb2MgJXtnZW1faW5zdGRpcn0v
Q0hBTkdFTE9HLm1kCi0lZG9jICV7Z2VtX2luc3RkaXJ9L0NPTlRSSUJVVElORy5tZAogCiAlY2hh
bmdlbG9nCisqIFdlZCBKdWwgMjcgMjAxNiBKdW4gQXJ1Z2EgPGphcnVnYUByZWRoYXQuY29tPiAt
IDMuMC4wLTEKKy0gRml4IGZvciBGVEJGUy4gKHJoYnojMTM1Nzg3OSkKKy0gVXBkYXRlIHRvIHVn
bGlmaWVyIDMuMC4wCisKICogVGh1IEZlYiAwNCAyMDE2IEZlZG9yYSBSZWxlYXNlIEVuZ2luZWVy
aW5nIDxyZWxlbmdAZmVkb3JhcHJvamVjdC5vcmc+IC0gMi40LjAtNAogLSBSZWJ1aWx0IGZvciBo
dHRwczovL2ZlZG9yYXByb2plY3Qub3JnL3dpa2kvRmVkb3JhXzI0X01hc3NfUmVidWlsZAogCi0t
IAoyLjUuNQoK
</data>

          </attachment>
      

    </bug>

</bugzilla>