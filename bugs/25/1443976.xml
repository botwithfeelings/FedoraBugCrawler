<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1443976</bug_id>
          
          <creation_ts>2017-04-20 07:19:00 -0400</creation_ts>
          <short_desc>glibc: Remove the PID cache</short_desc>
          <delta_ts>2017-07-11 16:19:31 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>glibc</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          <see_also>https://bugzilla.redhat.com/show_bug.cgi?id=1469670</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Patch</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1443973</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Florian Weimer">fweimer</reporter>
          <assigned_to name="Arjun Shankar">ashankar</assigned_to>
          <cc>arjun.is</cc>
    
    
    <cc>ashankar</cc>
    
    
    <cc>codonell</cc>
    
    
    <cc>dj</cc>
    
    
    <cc>fweimer</cc>
    
    
    <cc>law</cc>
    
    
    <cc>mfabian</cc>
    
    
    <cc>pfrankli</cc>
    
    
    <cc>sid</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>glibc-2.25-1.fc26 glibc-2.24-6.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          <cf_clone_of>1443973</cf_clone_of>
          <cf_environment></cf_environment>
          <cf_last_closed>2017-07-11 15:14:17</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          <external_bugs name="Sourceware">15392</external_bugs>
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10349231</commentid>
    <comment_count>0</comment_count>
    <who name="Florian Weimer">fweimer</who>
    <bug_when>2017-04-20 07:19:46 -0400</bug_when>
    <thetext>+++ This bug was initially created as a clone of Bug #1443973 +++

The glibc PID cache negatively interacts with setting up containers and namespaces.

Upstream commit:

commit c579f48edba88380635ab98cb612030e3ed8691e
Author: Adhemerval Zanella &lt;adhemerval.zanella@linaro.org&gt;
Date:   Mon Oct 10 15:08:39 2016 -0300

    Remove cached PID/TID in clone</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10349237</commentid>
    <comment_count>1</comment_count>
    <who name="Florian Weimer">fweimer</who>
    <bug_when>2017-04-20 07:21:50 -0400</bug_when>
    <thetext>Already fixed in Fedora 26.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10486396</commentid>
    <comment_count>2</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-07 13:00:31 -0400</bug_when>
    <thetext>glibc-2.24-6.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-32940dd50d</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10490174</commentid>
    <comment_count>3</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-08 12:11:05 -0400</bug_when>
    <thetext>glibc-2.24-6.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-32940dd50d</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10496122</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-11 19:32:48 -0400</bug_when>
    <thetext>glibc-2.24-6.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10583331</commentid>
    <comment_count>5</comment_count>
    <who name="Lennart Poettering">lpoetter</who>
    <bug_when>2017-07-11 11:18:55 -0400</bug_when>
    <thetext>Umm, this change causes major slowdowns in various bits of systemd code, which assumes that getpid() is fast. libsystemd uses getpid() to detect when processes fork, to then politely return an error from all calls that operate on objects that cannot be reused after fork(). This used to be dead cheap on all glibc versions, but suddenly becomes excessively expensive, see this thread:

https://lists.freedesktop.org/archives/systemd-devel/2017-July/039195.html

I find the explanation &quot;The glibc PID cache negatively interacts with setting up containers and namespaces.&quot; quite weak... What is &quot;negatively interacts&quot; supposed to mean?

Is this regression going to stay? I am kinda surprised by this change I must say, as it causes real problems, and there&apos;s no clear benefit of the change...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10583356</commentid>
    <comment_count>6</comment_count>
    <who name="Lennart Poettering">lpoetter</who>
    <bug_when>2017-07-11 11:24:46 -0400</bug_when>
    <thetext>I opened a new bug 1469670 for tracking the regression introduced here.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>