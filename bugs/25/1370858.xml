<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1370858</bug_id>
          
          <creation_ts>2016-08-27 10:29:00 -0400</creation_ts>
          <short_desc>NetworkManager doesn&apos;t prompt for password</short_desc>
          <delta_ts>2016-08-27 18:43:29 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>NetworkManager-openconnect</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>CURRENTRELEASE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Alex">alex.vizor</reporter>
          <assigned_to name="David Woodhouse">dwmw2</assigned_to>
          <cc>dcbw</cc>
    
    
    <cc>dwmw2</cc>
    
    
    <cc>psimerda</cc>
    
    
    <cc>thaller</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-08-27 18:43:29</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9656205</commentid>
    <comment_count>0</comment_count>
    <who name="Alex">alex.vizor</who>
    <bug_when>2016-08-27 10:29:10 -0400</bug_when>
    <thetext>Description of problem:
I configured openconnect VPN and wanted to use NetworkManager to connecto the corporate network. But every time I try to turn on the VPN and fails immediately. I found in the log of NetworkManager that it can&apos;t find application to prompt for password.

From the log:
NetworkManager[1091]: &lt;error&gt; [1472306950.6997] vpn-connection[0x557864ac61d0,8086690f-f62e-47d7-a316-724782cb035d,&quot;VPN&quot;,0]: Failed to request VPN secrets #3: No agents were available for this request.


Version-Release number of selected component (if applicable):
NetworkManager-config-connectivity-fedora-1.4.0-0.5.git20160621.072358da.fc25.x86_64
NetworkManager-openvpn-1.2.4-2.fc25.x86_64
NetworkManager-vpnc-1.2.2-1.fc25.x86_64
NetworkManager-glib-1.4.0-0.5.git20160621.072358da.fc25.x86_64
NetworkManager-wwan-1.4.0-0.5.git20160621.072358da.fc25.x86_64
NetworkManager-openconnect-gnome-1.2.3-0.20160606git5009f9.fc25.x86_64
NetworkManager-openconnect-1.2.3-0.20160606git5009f9.fc25.x86_64
NetworkManager-libnm-1.4.0-0.5.git20160621.072358da.fc25.x86_64
NetworkManager-vpnc-gnome-1.2.2-1.fc25.x86_64
NetworkManager-team-1.4.0-0.5.git20160621.072358da.fc25.x86_64
NetworkManager-bluetooth-1.4.0-0.5.git20160621.072358da.fc25.x86_64
NetworkManager-wifi-1.4.0-0.5.git20160621.072358da.fc25.x86_64
NetworkManager-pptp-1.2.2-1.fc25.x86_64
NetworkManager-openvpn-gnome-1.2.4-2.fc25.x86_64
NetworkManager-adsl-1.4.0-0.5.git20160621.072358da.fc25.x86_64
NetworkManager-1.4.0-0.5.git20160621.072358da.fc25.x86_64
NetworkManager-pptp-gnome-1.2.2-1.fc25.x86_64
gnome-keyring-3.20.0-1.fc25.x86_64
gnome-keyring-pam-3.20.0-1.fc25.x86_64

How reproducible:
Create openconnect VPN connection in Fedora 25 and try to connect. I used VPN connection with encrypted cert and secure token authentication. So before upgrading to Fedora 25 NetworkManager would ask for cert password and secure token password. Now it just silently fails to connect with only indication in the log.


Steps to Reproduce:
1. Configure openconnect VPN
2. Try to turn on the VPN

Actual results:
Connection setup silently fails without asking password.

Expected results:
NetworkManager should ask for password for certificate and for secure token.

Additional info:
I suspect that this may happen because Fedora 25 has gnome-3.21.* for most of the packages and gnome-keyring is 3.20.0</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9656239</commentid>
    <comment_count>1</comment_count>
    <who name="Thomas Haller">thaller</who>
    <bug_when>2016-08-27 10:49:22 -0400</bug_when>
    <thetext>to request a password/secret, NetworkManager calls out to a &quot;secret-agent&quot;. That is a program that obtains the password somehow, for example by asking the user or looking into the keyring.

Such secret agents are for example nmcli, nmtui, plasma-nm, nm-applet, gnome-shell.

To handle secrets for VPN (and especially for openconnect which is more complicated) the secret agent also needs help from the VPN plugin. Certainly nm-applet is able to do all of that, not sure about the others.


Can you first try with having nm-applet running?


(I see, you have the relevant plugin installed: NetworkManager-openconnect-gnome)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9656588</commentid>
    <comment_count>2</comment_count>
    <who name="Alex">alex.vizor</who>
    <bug_when>2016-08-27 18:43:29 -0400</bug_when>
    <thetext>With latest update new NetworkManager came in fc25 and now everything works as expected. Thank you!</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>