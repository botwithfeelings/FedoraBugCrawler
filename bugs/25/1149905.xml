<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1149905</bug_id>
          
          <creation_ts>2014-10-06 17:15:00 -0400</creation_ts>
          <short_desc>[Wayland][Regression] environment is incomplete, missing some entries from PATH, GPG_AGENT_INFO, SSH_AUTH_SOCK, ...</short_desc>
          <delta_ts>2017-04-10 12:51:19 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>gnome-session</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1277927</blocked>
    
    
    <blocked>1372055</blocked>
    
    
    <blocked>1416531</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Christian Stadelmann">rhbz2</reporter>
          <assigned_to name="Ray Strode [halfline]">rstrode</assigned_to>
          <cc>aquarichy</cc>
    
    
    <cc>berend.de.schouwer</cc>
    
    
    <cc>biltong</cc>
    
    
    <cc>bjwyman</cc>
    
    
    <cc>cegolf</cc>
    
    
    <cc>christianklomp</cc>
    
    
    <cc>crobinso</cc>
    
    
    <cc>cschalle</cc>
    
    
    <cc>debarshir</cc>
    
    
    <cc>dhgutteridge</cc>
    
    
    <cc>dimitris</cc>
    
    
    <cc>dopey</cc>
    
    
    <cc>edgar.hoch</cc>
    
    
    <cc>eggert</cc>
    
    
    <cc>elreydetodo</cc>
    
    
    <cc>emmanuel.touzery</cc>
    
    
    <cc>erik.bartos</cc>
    
    
    <cc>ferdnyc</cc>
    
    
    <cc>gdt</cc>
    
    
    <cc>goeran</cc>
    
    
    <cc>grawity</cc>
    
    
    <cc>guidomureddu</cc>
    
    
    <cc>hugh</cc>
    
    
    <cc>ihrachys</cc>
    
    
    <cc>iseeglass</cc>
    
    
    <cc>james.hogarth</cc>
    
    
    <cc>jfrieben</cc>
    
    
    <cc>ji.cerny</cc>
    
    
    <cc>jonha87</cc>
    
    
    <cc>j.orti.alcaine</cc>
    
    
    <cc>kmcalpine</cc>
    
    
    <cc>kparal</cc>
    
    
    <cc>lars.seipel</cc>
    
    
    <cc>liblit</cc>
    
    
    <cc>mark</cc>
    
    
    <cc>mathieu-acct</cc>
    
    
    <cc>mcepl</cc>
    
    
    <cc>mihai</cc>
    
    
    <cc>ncjeffgus</cc>
    
    
    <cc>nuno.dias</cc>
    
    
    <cc>nyh</cc>
    
    
    <cc>petersen</cc>
    
    
    <cc>rafael.espindola</cc>
    
    
    <cc>ricardo.arguello</cc>
    
    
    <cc>rick</cc>
    
    
    <cc>rmy</cc>
    
    
    <cc>rolandh</cc>
    
    
    <cc>rstrode</cc>
    
    
    <cc>samuel.rakitnican</cc>
    
    
    <cc>tiwoc</cc>
    
    
    <cc>tspiteri</cc>
    
    
    <cc>yulinux</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>gnome-session-3.22.2-3.fc25</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-01-17 14:53:07</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          <external_bugs name="GNOME Desktop">736660</external_bugs>
    
    
    
    <external_bugs name="Github">https://github.com/systemd/systemd/pull/3904</external_bugs>
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>7548719</commentid>
    <comment_count>0</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2014-10-06 17:15:51 -0400</bug_when>
    <thetext>Description of problem:
environment differs too much between xsession and wayland-session

Version-Release number of selected component (if applicable):
F21 Alpha, gnome-session, gnome-terminal, gnome-shell 3.14.0

How reproducible:
always

Steps to Reproduce:
1. log in from GDM
2. open gnome-terminal
3. run `$ env`

Actual results:
Too many environment variables differ between wayland-session and xsession. 
Missing under wayland:
HOSTNAME, HISTSIZE, SSH_AUTH_SOCK, MAIL, HISTCONTROL,
(additionally missing: QT_IM_MODULE, XMODIFIERS, but they might be X/Wayland-related)
PATH is present in wayland, but missing ~/.local/bin and ~/bin.

Expected results:
Everything not related to X/Wayland should stay exactly the same for both xsession and wayland-session

Additional info:


This is the diff:

$ diff env-gnome-wayland.log env-xserver-gnome.log 
1,3c1,4
&lt; XDG_VTNR=2
&lt; XDG_SESSION_ID=3
&lt; WAYLAND_DISPLAY=wayland-0
---
&gt; XDG_VTNR=1
&gt; XDG_SESSION_ID=23
&gt; HOSTNAME=chstpc-2
&gt; GPG_AGENT_INFO=/run/user/1000/keyring/gpg:0:1
7a9
&gt; HISTSIZE=1000
9c11
&lt; WINDOWID=31457287
---
&gt; WINDOWID=37748743
13a16
&gt; SSH_AUTH_SOCK=/run/user/1000/keyring/ssh
15,17c18,22
&lt; SESSION_MANAGER=local/unix:@/tmp/.ICE-unix/3081,unix/unix:/tmp/.ICE-unix/3081
&lt; PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin
&lt; DESKTOP_SESSION=gnome-wayland
---
&gt; SESSION_MANAGER=local/unix:@/tmp/.ICE-unix/29000,unix/unix:/tmp/.ICE-unix/29000
&gt; PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin:/home/christian/.local/bin:/home/christian/bin
&gt; MAIL=/var/spool/mail/christian
&gt; DESKTOP_SESSION=gnome
&gt; QT_IM_MODULE=ibus
18a24
&gt; XMODIFIERS=@im=ibus
22c28
&lt; GDMSESSION=gnome-wayland
---
&gt; GDMSESSION=gnome
24c30
&lt; SHLVL=1
---
&gt; HISTCONTROL=ignoredups
26a33
&gt; SHLVL=2
27a35
&gt; XDG_SESSION_DESKTOP=gnome
29,30c37
&lt; XDG_SESSION_DESKTOP=gnome-wayland
&lt; DBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-sxzA4wPn0F,guid=6e9edf7cd24da893dc7ff3ee54330131
---
&gt; DBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-41xhxDHvk9,guid=fb9365cf53a86fb60b3b039d5432fe59
32,33c39
&lt; WINDOWPATH=1:1
&lt; DISPLAY=:1
---
&gt; WINDOWPATH=1:1:1:1:1:1:1:1:1:1:1:1:1
34a41
&gt; DISPLAY=:0
35a43
&gt; XAUTHORITY=/run/gdm/auth-for-christian-HBTLf3/database</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7548776</commentid>
    <comment_count>1</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2014-10-06 18:22:38 -0400</bug_when>
    <thetext>It seems like /etc/profile is not run on login.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7585460</commentid>
    <comment_count>2</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2014-10-17 05:06:43 -0400</bug_when>
    <thetext>There are similar bugs reported upstream:
https://bugzilla.gnome.org/show_bug.cgi?id=736660
https://bugzilla.gnome.org/show_bug.cgi?id=738336</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7798197</commentid>
    <comment_count>3</comment_count>
    <who name="Martin Meyer">elreydetodo</who>
    <bug_when>2015-01-02 09:34:45 -0500</bug_when>
    <thetext>I also filed a bug against gnome-terminal[1], thinking this was an issue a problem with not being considered a login shell consistently between the sessions. Since the &quot;GNOME on Wayland&quot; session entry simply executes `gnome-session --session=gnome-wayland`, this means we skip all the xinitrc stuff that goes on with X sessions starting.

This can probably be fixed either by making gnome-session aware of the startup procedure, or by making Wayland have its own init of procedure similar to X&apos;s. I think the latter is probably a better idea, so that other desktop environments don&apos;t also have to implement this same logic.

[1] https://bugzilla.gnome.org/show_bug.cgi?id=741874</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8127829</commentid>
    <comment_count>4</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2015-04-09 11:20:08 -0400</bug_when>
    <thetext>Still present on F22 alpha. Note that this may trigger many more problems when applications rely on environment variables.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8820328</commentid>
    <comment_count>5</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2015-11-14 06:40:25 -0500</bug_when>
    <thetext>Still partially present on F23. Most importantly HOSTNAME is missing which breaks gdb attaching to valgrind using vgdb as described in http://valgrind.10908.n7.nabble.com/vgdb-gdbserver-FIFO-name-mismatch-td39607.html

PATH, XMODIFIERS and SSH_AUTH_SOCK have been fixed.

HOSTNAME, HISTSIZE, HISTCONTROL, QT_IM_MODULE, MAIL, GPG_AGENT_INFO: don&apos;t exist on wayland sessions</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8859584</commentid>
    <comment_count>6</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2015-11-25 07:24:34 -0500</bug_when>
    <thetext>Specifying environment in ~/.bashrc won&apos;t work on Gnome+Wayland sessions, it is not being read/run before starting wayland applications.

Users might e.g. add local folders to PATH, LD_LIBRARY_PATH, etc. or set GDK_BACKEND=wayland or GDK_BACKEND=x11. Adding those to ~/.bashrc won&apos;t work for applications running in a gnome+Wayland session. Running them from XWayland doesn&apos;t change that. This only works fine in a true gnome+X11 session.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9124374</commentid>
    <comment_count>7</comment_count>
    <who name="Mantas M. (grawity)">grawity</who>
    <bug_when>2016-03-07 01:03:31 -0500</bug_when>
    <thetext>(In reply to Christian Stadelmann from comment #5)
&gt; Still partially present on F23. Most importantly HOSTNAME is missing which
&gt; breaks gdb attaching to valgrind using vgdb as described in
&gt; http://valgrind.10908.n7.nabble.com/vgdb-gdbserver-FIFO-name-mismatch-
&gt; td39607.html
&gt; 
&gt; PATH, XMODIFIERS and SSH_AUTH_SOCK have been fixed.
&gt; 
&gt; HOSTNAME, HISTSIZE, HISTCONTROL, QT_IM_MODULE, MAIL, GPG_AGENT_INFO: don&apos;t
&gt; exist on wayland sessions

HOSTNAME: not sure why this would exist?

HISTSIZE, HISTCONTROL: are shell-specific and don&apos;t need to be environment variables, can be just set within .bashrc

MAIL: can (should?) be set by pam_mail

GPG_AGENT_INFO: gnupg 2.1 doesn&apos;t use it anymore</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9124987</commentid>
    <comment_count>8</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2016-03-07 05:04:25 -0500</bug_when>
    <thetext>(In reply to Mantas M. (grawity) from comment #7)
&gt; HOSTNAME: not sure why this would exist?

See comment #5: attaching gdb to valgrind breaks without specifying HOSTNAME. This could of course also be fixed in valgrind/gdb, no reason to ship unnecessary environment variables when one could just read /etc/hostname.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9125107</commentid>
    <comment_count>9</comment_count>
    <who name="Mantas M. (grawity)">grawity</who>
    <bug_when>2016-03-07 05:59:23 -0500</bug_when>
    <thetext>(In reply to Christian Stadelmann from comment #8)
&gt; (In reply to Mantas M. (grawity) from comment #7)
&gt; &gt; HOSTNAME: not sure why this would exist?
&gt; 
&gt; See comment #5: attaching gdb to valgrind breaks without specifying
&gt; HOSTNAME. This could of course also be fixed in valgrind/gdb, no reason to
&gt; ship unnecessary environment variables when one could just read
&gt; /etc/hostname.

Yes, exactly – programs should use gethostname(3) or at least uname(3) to get the current system&apos;s hostname, unless it needs to be overridden for some reason. (Note that the *current* system hostname might be different from what&apos;s in /etc/hostname, so the latter is not a good source.)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9126255</commentid>
    <comment_count>10</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2016-03-07 10:55:22 -0500</bug_when>
    <thetext>(In reply to Mantas M. (grawity) from comment #9)
&gt; (In reply to Christian Stadelmann from comment #8)
&gt; &gt; (In reply to Mantas M. (grawity) from comment #7)
&gt; &gt; &gt; HOSTNAME: not sure why this would exist?
&gt; &gt; 
&gt; &gt; See comment #5: attaching gdb to valgrind breaks without specifying
&gt; &gt; HOSTNAME. This could of course also be fixed in valgrind/gdb, no reason to
&gt; &gt; ship unnecessary environment variables when one could just read
&gt; &gt; /etc/hostname.
&gt; 
&gt; Yes, exactly – programs should use gethostname(3) or at least uname(3) to
&gt; get the current system&apos;s hostname, unless it needs to be overridden for some
&gt; reason. (Note that the *current* system hostname might be different from
&gt; what&apos;s in /etc/hostname, so the latter is not a good source.)

I tried to reproduce this issue in gdb/valgrind to report it but it has gone already.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9691348</commentid>
    <comment_count>11</comment_count>
    <who name="Paul Eggert">eggert</who>
    <bug_when>2016-09-08 11:46:56 -0400</bug_when>
    <thetext>I independently ran into this problem, and would like to emphasize that this is a serious shortcoming of Wayland on Fedora 24. I need to have a way to set environment variables all throughout my desktop session; not just standard environment variables like &apos;PATH&apos; and &apos;TZ&apos;, but also my own variables (like &apos;j&apos;) that I use all the time for my own purposes. These are not systemwide variables; they&apos;re just personal settings. I use this capability all the time in my software development environment.

I have worked around the problem by not using Wayland for now.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9691503</commentid>
    <comment_count>12</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2016-09-08 12:34:18 -0400</bug_when>
    <thetext>(In reply to Paul Eggert from comment #11)
&gt; I independently ran into this problem, and would like to emphasize that this
&gt; is a serious shortcoming of Wayland on Fedora 24. I need to have a way to
&gt; set environment variables all throughout my desktop session; not just
&gt; standard environment variables like &apos;PATH&apos; and &apos;TZ&apos;, but also my own
&gt; variables (like &apos;j&apos;) that I use all the time for my own purposes. These are
&gt; not systemwide variables; they&apos;re just personal settings. I use this
&gt; capability all the time in my software development environment.
&gt; 
&gt; I have worked around the problem by not using Wayland for now.

Please have a look at https://www.freedesktop.org/software/systemd/man/systemd-system.conf.html#DefaultEnvironment= , you can put your ENV settings into ~/.config/systemd/user.conf

See also: https://wiki.archlinux.org/index.php/Systemd/User#Environment_variables

@Someone with wiki write access: This information might be useful to be documented somewhere unless fixed until F25 is released. With a powerful tool like systemd to the hands I don&apos;t think there is any need for having ~/.bashrc and others run at login.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9692314</commentid>
    <comment_count>13</comment_count>
    <who name="Paul Eggert">eggert</who>
    <bug_when>2016-09-08 18:45:45 -0400</bug_when>
    <thetext>(In reply to Christian Stadelmann from comment #12)

&gt; https://www.freedesktop.org/software/systemd/man/systemd-system.conf.
&gt; html#DefaultEnvironment= , you can put your ENV settings into
&gt; ~/.config/systemd/user.conf

Thanks, but unfortunately that does not work for me. I created a file .config/systemd/user.conf with the contents:

[Manager]
DefaultEnvironment=j=junk k=&quot;e f&quot;

and logged out and logged back in again. The environment variables j and k were not set.

I see that others are reporting this problem in Arch Linux, with no solution known:

https://bbs.archlinux.org/viewtopic.php?id=208650

PS. Is there any way for a user to debug problems with a bad user.conf file? I don&apos;t see any diagnostics or log file.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9696172</commentid>
    <comment_count>14</comment_count>
    <who name="Roger Odle">fedora-bugs</who>
    <bug_when>2016-09-10 10:19:58 -0400</bug_when>
    <thetext>Why wouldn&apos;t putting your variables into .bash_profile work? .bash_rc can cause recursion problems in that it gets processed every time a shell script is executed but .bash_profile only gets processed at logon.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9696296</commentid>
    <comment_count>15</comment_count>
    <who name="Paul Eggert">eggert</who>
    <bug_when>2016-09-10 15:21:23 -0400</bug_when>
    <thetext>(In reply to Roger Odle from comment #14)
&gt; Why wouldn&apos;t putting your variables into .bash_profile work?

Because Wayland-based logins don&apos;t use use Bash as a login shell and therefore ignore .bash_profile. As far as I know they do not use Bash at all, unless the user decides to run Bash by running a terminal or something.

I need environment variable settings to be visible to every process in my Wayland session. For example, if I start up Emacs from the desktop, that Emacs should see the environment variable setting even though Bash was never run.

The Wayland design purposely bypasses .bash_profile, I assume because it wants to protect users from the complexity of programming and scripts. This means Wayland needs to provides the essential feature of environment-setting. Currently it lacks this feature under Fedora 24, which is a show-stopper.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9699285</commentid>
    <comment_count>16</comment_count>
    <who name="Ray Strode [halfline]">rstrode</who>
    <bug_when>2016-09-12 10:15:11 -0400</bug_when>
    <thetext>&gt; &gt; https://www.freedesktop.org/software/systemd/man/systemd-system.conf.
&gt; &gt; html#DefaultEnvironment= , you can put your ENV settings into
&gt; &gt; ~/.config/systemd/user.conf
&gt; 
&gt; Thanks, but unfortunately that does not work for me. I created a file
&gt; .config/systemd/user.conf with the contents:
&gt; 
&gt; [Manager]
&gt; DefaultEnvironment=j=junk k=&quot;e f&quot;
&gt; 
&gt; and logged out and logged back in again. The environment variables j and k
&gt; were not set.

The reason this doesn&apos;t work, is you need a GDM with this commit:

https://git.gnome.org/browse/gdm/commit/?id=448134d3cdbc54e5359ea33d387993b0defdaefa

but that&apos;s only in F25.  Without that commit, only things started by systemd --user (so dbus activated things, and service files written in /lib/systemd/user) would pick up you configuration.  Try /etc/environment for now, but we&apos;re working on a better solution in upstream systemd here:

https://github.com/systemd/systemd/pull/3904</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9759346</commentid>
    <comment_count>17</comment_count>
    <who name="srakitnican">samuel.rakitnican</who>
    <bug_when>2016-10-02 02:16:25 -0400</bug_when>
    <thetext>Setting http_proxy environment variable in /etc/profile.d works for Firefox in X session, but not for Wayland session. But variable gets set in gnome-terminal. Firefox is set to use system settings for proxy.

Xwayland does not read /etc/profile.d?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9884252</commentid>
    <comment_count>18</comment_count>
    <who name="Andy Wang">dopey</who>
    <bug_when>2016-11-11 14:14:25 -0500</bug_when>
    <thetext>So with fedora 25 on the cusp of being released, what is the appropriate soluton here?  I see comment 16 saying to use /etc/environment but that seems a little unfortunate.  A regular user shouldn&apos;t be using /etc/environment to configure their own environment.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9901820</commentid>
    <comment_count>19</comment_count>
    <who name="Glen Turner">gdt</who>
    <bug_when>2016-11-17 19:41:20 -0500</bug_when>
    <thetext>Note that .~/bash_profile can do more than set environment variables. Perhaps more worrying is ~/.bash_logout, which commonly runs &quot;sudo -k&quot;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9907481</commentid>
    <comment_count>20</comment_count>
    <who name="J. Haas">jonha87</who>
    <bug_when>2016-11-21 03:47:22 -0500</bug_when>
    <thetext>So according to comment 5 PATH is fixed, but I&apos;m still missing ~/bin/ from path from gnome-terminal inside a F25 Workstation wayland session.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9930226</commentid>
    <comment_count>21</comment_count>
    <who name="Emmanuel Touzery">emmanuel.touzery</who>
    <bug_when>2016-11-25 09:54:08 -0500</bug_when>
    <thetext>so ~/.config/systemd/user.conf seems interesting on fedora 25+, but I can&apos;t use it to add for instance ~/bin to $PATH, because I would be overwriting the system PATH, right?

I&apos;d like
export PATH=$PATH:~/bin</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9930269</commentid>
    <comment_count>22</comment_count>
    <who name="Christian Stadelmann">rhbz2</who>
    <bug_when>2016-11-25 10:21:31 -0500</bug_when>
    <thetext>(In reply to Emmanuel Touzery from comment #21)
&gt; so ~/.config/systemd/user.conf seems interesting on fedora 25+, but I can&apos;t
&gt; use it to add for instance ~/bin to $PATH, because I would be overwriting
&gt; the system PATH, right?
&gt; 
&gt; I&apos;d like
&gt; export PATH=$PATH:~/bin

According to man systemd.exec this is not possible.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9930705</commentid>
    <comment_count>23</comment_count>
    <who name="Emmanuel Touzery">emmanuel.touzery</who>
    <bug_when>2016-11-25 15:02:42 -0500</bug_when>
    <thetext>Yes so ~/.config/systemd/user.conf does not fully replace the previous mechanism which allowed the user to add custom folders to the PATH. as far as I can tell this is currently impossible with wayland :-(</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9931613</commentid>
    <comment_count>24</comment_count>
    <who name="D. Hugh Redelmeier">hugh</who>
    <bug_when>2016-11-26 22:15:53 -0500</bug_when>
    <thetext>This is clearly a bug in the default Fedora 25 configuration.

Simple observation:

With gnome terminal session, ~/bin is not in $PATH
With a console it is included.

The lack of ~/bin in PATH is an undocumented change.  Not good.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9939542</commentid>
    <comment_count>25</comment_count>
    <who name="Debarshi Ray">debarshir</who>
    <bug_when>2016-11-29 10:31:50 -0500</bug_when>
    <thetext>*** Bug 1397573 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9946316</commentid>
    <comment_count>26</comment_count>
    <who name="Erik Bartoš">erik.bartos</who>
    <bug_when>2016-12-01 03:45:24 -0500</bug_when>
    <thetext>I can confirm on Fedora 25 Workstation.

$HOME/bin accessible only from $bash command line, not through Alt+F2 in Wayland.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9946815</commentid>
    <comment_count>27</comment_count>
    <who name="Kamil Páral">kparal</who>
    <bug_when>2016-12-01 06:26:20 -0500</bug_when>
    <thetext>We know it doesn&apos;t work, we don&apos;t need any more confirmations. You can subscribe to this ticket even without adding a comment, just add yourself to the CC list. Thank you.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9954787</commentid>
    <comment_count>28</comment_count>
    <who name="Jens Petersen">petersen</who>
    <bug_when>2016-12-04 22:50:38 -0500</bug_when>
    <thetext>Any good reason not to patch Fedora (or upstream) to use a login shell again when starting gnome-session until a better solution is available (in 3.24 say)?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9954853</commentid>
    <comment_count>29</comment_count>
    <who name="Jens Petersen">petersen</who>
    <bug_when>2016-12-05 00:10:31 -0500</bug_when>
    <thetext>~/.config/systemd/user.conf does not seem to support setting DefaultEnvironment in F25 at least.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9956249</commentid>
    <comment_count>30</comment_count>
    <who name="Debarshi Ray">debarshir</who>
    <bug_when>2016-12-05 09:13:05 -0500</bug_when>
    <thetext>*** Bug 1398269 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9964527</commentid>
    <comment_count>31</comment_count>
    <who name="Nadav Har&apos;El">nyh</who>
    <bug_when>2016-12-07 08:11:50 -0500</bug_when>
    <thetext>Jen, no, no good reason, except apparently the upstream only cares about Gnome and not the shell and its non-gnome utilities, so Fedora should fix it directly.

I outlined a possible easy solution in the upstream bug tracker: in the script /usr/bin/gnome-session, where we currently have the line:

exec /usr/libexec/gnome-session-binary &quot;$@&quot;

we could replace replace it by something like:

exec -l $SHELL -c &quot;exec /usr/libexec/gnome-session-binary $*&quot;

Or more safely (checking $SHELL for sanity),

$SHELL -c &quot;exec /usr/bin/true&quot; &amp;&amp; exec -l $SHELL -c exec &quot;/usr/libexec/gnome-session-binary $*&quot; || exec /usr/libexec/gnome-session-binary &quot;$@&quot;

(I&apos;m not sure what this &quot;$@&quot; was supposed to contain so I&apos;m not exactly sure about that part).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9964671</commentid>
    <comment_count>32</comment_count>
    <who name="Berend De Schouwer">berend.de.schouwer</who>
    <bug_when>2016-12-07 08:52:06 -0500</bug_when>
    <thetext>(In reply to Nadav Har&apos;El from comment #31)
&gt; I outlined a possible easy solution in the upstream bug tracker: in the
&gt; script /usr/bin/gnome-session, where we currently have the line:
&gt; 
&gt; exec /usr/libexec/gnome-session-binary &quot;$@&quot;
&gt; 
&gt; we could replace replace it by something like:
&gt; 
&gt; exec -l $SHELL -c &quot;exec /usr/libexec/gnome-session-binary $*&quot;
&gt; 
&gt; Or more safely (checking $SHELL for sanity),
&gt; 
&gt; $SHELL -c &quot;exec /usr/bin/true&quot; &amp;&amp; exec -l $SHELL -c exec
&gt; &quot;/usr/libexec/gnome-session-binary $*&quot; || exec
&gt; /usr/libexec/gnome-session-binary &quot;$@&quot;
&gt; 
&gt; (I&apos;m not sure what this &quot;$@&quot; was supposed to contain so I&apos;m not exactly sure
&gt; about that part).

&quot;$@&quot; is $* with spaces preserved.

If your script is called with &apos;apple &quot;pear fruit&quot;&apos;, and you call another script or binary with $*, that binary gets three arguments: &apos;apple&apos;, &apos;pear&apos; and &apos;fruit&apos;.

If your script calls that binary with &quot;$@&quot;, it gets two arguments: &apos;apple&apos; and &apos;pear fruit&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10039013</commentid>
    <comment_count>33</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-01-05 16:32:33 -0500</bug_when>
    <thetext>gnome-session-3.22.2-2.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-44bc42c388</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10041991</commentid>
    <comment_count>34</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-01-06 18:20:22 -0500</bug_when>
    <thetext>gnome-session-3.22.2-2.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-44bc42c388</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10042218</commentid>
    <comment_count>35</comment_count>
    <who name="Richard Schwarting">aquarichy</who>
    <bug_when>2017-01-06 21:15:19 -0500</bug_when>
    <thetext>Tried gnome-session-3.22.2-2.fc25 with the packages from Koji (--enablerepo=updates-testing wasn&apos;t showing -2.fc25 for me).  Afterwards, ~/.bash_profile still isn&apos;t sourced, and now if I do gnome-session --version, I get

$ LANG=C gnome-session --version
/usr/bin/gnome-session: line 17: [: missing `]&apos;
/usr/bin/gnome-session: line 18: : command not found
/usr/bin/gnome-session: line 19: -n: command not found</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10042267</commentid>
    <comment_count>36</comment_count>
    <who name="srakitnican">samuel.rakitnican</who>
    <bug_when>2017-01-07 01:36:47 -0500</bug_when>
    <thetext>(In reply to Richard Schwarting from comment #35)
&gt; Tried gnome-session-3.22.2-2.fc25 with the packages from Koji
&gt; (--enablerepo=updates-testing wasn&apos;t showing -2.fc25 for me).  Afterwards,
&gt; ~/.bash_profile still isn&apos;t sourced, and now if I do gnome-session
&gt; --version, I get
&gt; 
&gt; $ LANG=C gnome-session --version
&gt; /usr/bin/gnome-session: line 17: [: missing `]&apos;
&gt; /usr/bin/gnome-session: line 18: : command not found
&gt; /usr/bin/gnome-session: line 19: -n: command not found

There is a missing &quot;\&quot; at the end of the &quot;if&quot; line split. Should be:

if [ &quot;$XDG_SESSION_TYPE&quot; = &quot;wayland&quot; -a \
     &quot;$XDG_SESSION_CLASS&quot; != &quot;greeter&quot; -a \
     -n &quot;$SHELL&quot; ]; then</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10050538</commentid>
    <comment_count>37</comment_count>
    <who name="Christian Klomp">christianklomp</who>
    <bug_when>2017-01-10 15:16:43 -0500</bug_when>
    <thetext>Using the stable gnome-session release on F25: when gnome autologin is enabled (which defaults to Wayland) variables from /etc/environment do not end up in the session. I need to log out and log back in, then they are respected.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10056901</commentid>
    <comment_count>38</comment_count>
    <who name="Christian Klomp">christianklomp</who>
    <bug_when>2017-01-12 07:35:04 -0500</bug_when>
    <thetext>The /etc/environment with gdm autologin problem doesn&apos;t seem to be related to Wayland since the same thing happens when Wayland is disabled.
Opened a separate bug for it: https://bugzilla.redhat.com/show_bug.cgi?id=1412608</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10066619</commentid>
    <comment_count>39</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-01-16 10:19:28 -0500</bug_when>
    <thetext>gnome-session-3.22.2-3.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-84b0233854</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10068168</commentid>
    <comment_count>40</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-01-16 17:24:38 -0500</bug_when>
    <thetext>gnome-session-3.22.2-3.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-84b0233854</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10068934</commentid>
    <comment_count>41</comment_count>
    <who name="David H. Gutteridge">dhgutteridge</who>
    <bug_when>2017-01-16 21:58:15 -0500</bug_when>
    <thetext>gnome-session-3.22.2-3.fc25 addresses the issue for me. Thanks for this. (Previously, I had to define certain debugging environment variables in the systemd user@.service file, which was not optimal.)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10069452</commentid>
    <comment_count>42</comment_count>
    <who name="Kamil Páral">kparal</who>
    <bug_when>2017-01-17 03:13:30 -0500</bug_when>
    <thetext>(In reply to Fedora Update System from comment #40)
&gt; gnome-session-3.22.2-3.fc25 has been pushed to the Fedora 25 testing

Works for me.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10073327</commentid>
    <comment_count>43</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-01-17 14:53:07 -0500</bug_when>
    <thetext>gnome-session-3.22.2-3.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10076255</commentid>
    <comment_count>44</comment_count>
    <who name="&quot;FeRD&quot; (Frank Dana)">ferdnyc</who>
    <bug_when>2017-01-18 07:54:21 -0500</bug_when>
    <thetext>
I updated https://fedoraproject.org/wiki/Common_F25_bugs#gnome-login-shell to indicate that the fix has been released to stable.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10077634</commentid>
    <comment_count>45</comment_count>
    <who name="Joachim Frieben">jfrieben</who>
    <bug_when>2017-01-18 14:04:37 -0500</bug_when>
    <thetext>*** Bug 1314964 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10321301</commentid>
    <comment_count>46</comment_count>
    <who name="Ihar Hrachyshka">ihrachys</who>
    <bug_when>2017-04-10 12:51:19 -0400</bug_when>
    <thetext>&gt; gnome-session-3.22.2-3.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.

Here I am, with my note.

[ihrachys@laptop ~]$ rpm -q gnome-session
gnome-session-3.22.3-1.fc25.x86_64

My .bash_profile at: https://github.com/booxter/homedir/blob/cc59ac1296358f492258ada37d1c5976849d8b72/.bash_profile

This didn&apos;t initialize e.g. goto or haven&apos;t included ~/bin into PATH when I open a new gnome-terminal session in Wayland.

This &quot;fixed&quot; the issue for me: https://github.com/booxter/homedir/commit/469019cafbbd8763653a79025d089debee95e58f

Seems like .bash_profile is still ignored by gnome-session.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>