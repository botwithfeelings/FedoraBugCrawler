<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1441601</bug_id>
          
          <creation_ts>2017-04-12 06:20:00 -0400</creation_ts>
          <short_desc>thunderbird: No longer accepts TLS server certificate</short_desc>
          <delta_ts>2017-04-27 01:51:09 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>thunderbird</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          <see_also>https://bugzilla.redhat.com/show_bug.cgi?id=1400293</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>high</priority>
          <bug_severity>high</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Florian Weimer">fweimer</reporter>
          <assigned_to name="Gecko Maintainer">gecko-bugs-nobody</assigned_to>
          <cc>eblake</cc>
    
    
    <cc>gecko-bugs-nobody</cc>
    
    
    <cc>jhorak</cc>
    
    
    <cc>kengert</cc>
    
    
    <cc>mschmidt</cc>
    
    
    <cc>pjasicek</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>thunderbird-52.0-2.fc26 thunderbird-52.0-2.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-04-20 08:02:05</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10328151</commentid>
    <comment_count>0</comment_count>
    <who name="Florian Weimer">fweimer</who>
    <bug_when>2017-04-12 06:20:06 -0400</bug_when>
    <thetext>Description of problem:

Thunderbird no longer accepts a certificate from an IMAP server.

Version-Release number of selected component (if applicable):

thunderbird-52.0-1.fc25.x86_64
nss-3.29.3-1.1.fc25.x86_64
crypto-policies-20160921-4.gitf3018dd.fc25.noarch

How reproducible:

Always.


Steps to Reproduce:
1. Start Thunderbird, which is configured to connect to a certain IMAP server.  The server presents a SHA-1 certificate and uses DH (not ECDH) for forward security.

Actual results:

Certificate confirmation dialog appears.

Expected results:

Connection is successful.

Additional info:

The server uses a certificate from the system certification store.  I do not know if this is the cause for the certification validation failure, or the SHA-1 signature.  The dialog does not say.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10328695</commentid>
    <comment_count>3</comment_count>
    <who name="Kai Engert (:kaie)">kengert</who>
    <bug_when>2017-04-12 08:32:31 -0400</bug_when>
    <thetext>What&apos;s the ca-certificates package version you have installed?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10328733</commentid>
    <comment_count>5</comment_count>
    <who name="Florian Weimer">fweimer</who>
    <bug_when>2017-04-12 08:36:10 -0400</bug_when>
    <thetext>(In reply to Kai Engert (:kaie) from comment #3)
&gt; What&apos;s the ca-certificates package version you have installed?

ca-certificates-2017.2.11-1.0.fc25.noarch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10328763</commentid>
    <comment_count>8</comment_count>
    <who name="Kai Engert (:kaie)">kengert</who>
    <bug_when>2017-04-12 08:39:55 -0400</bug_when>
    <thetext>Florian, I assume you were previously using Thunderbird 45?

Mozilla 52 introduces new constraints for public CAs.

We need patches for p11-kit + nss + ca-certificates + thunderbird to allow thunderbird to correctly distinguish private CAs from public CAs, to make it possible that the stricter requirements aren&apos;t enforced for private CAs, like in your situation.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10328772</commentid>
    <comment_count>9</comment_count>
    <who name="Kai Engert (:kaie)">kengert</who>
    <bug_when>2017-04-12 08:41:47 -0400</bug_when>
    <thetext>So far, we had intended to deliver the fix to Fedora stable with the upcoming Firefox 54.

I had not considered Thunderbird. Because Thunderbird will probably remain at the version 52.x, Thunderbird requires the backported patch that we already have added to Firefox in Fedora 26.

Note that we&apos;re still working on required base dependencies, they aren&apos;t stable yet. I&apos;ll doublecheck how close we are already.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10328811</commentid>
    <comment_count>10</comment_count>
    <who name="Florian Weimer">fweimer</who>
    <bug_when>2017-04-12 08:44:49 -0400</bug_when>
    <thetext>(In reply to Kai Engert (:kaie) from comment #8)
&gt; Florian, I assume you were previously using Thunderbird 45?

Yes, I upgraded from Thunderbird 45:

Apr 12 12:10:12 DEBUG ---&gt; Package thunderbird.x86_64 45.8.0-1.fc25 will be upgraded
Apr 12 12:10:12 DEBUG ---&gt; Package thunderbird.x86_64 52.0-1.fc25 will be an upgrade

&gt; Mozilla 52 introduces new constraints for public CAs.
&gt; 
&gt; We need patches for p11-kit + nss + ca-certificates + thunderbird to allow
&gt; thunderbird to correctly distinguish private CAs from public CAs, to make it
&gt; possible that the stricter requirements aren&apos;t enforced for private CAs,
&gt; like in your situation.

Thanks for the explanation.

Note that the upstream approach is quite bizarre because it turns impossible-to-attack SHA-1 certificates into trivial MITM opportunities.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10328828</commentid>
    <comment_count>11</comment_count>
    <who name="Kai Engert (:kaie)">kengert</who>
    <bug_when>2017-04-12 08:49:42 -0400</bug_when>
    <thetext>Daiki has already backported the fix required for NSS,
stable in F25 (F25 still testing):
https://bodhi.fedoraproject.org/updates/FEDORA-2017-83de9e1c7c

Daiki has already backported the fix required for p11-kit,
stable in F25 (F25 still testing):
https://bodhi.fedoraproject.org/updates/FEDORA-2017-0dc6f0c054

I have already prepared the fixes for ca-certificates,
still in testing:
https://bodhi.fedoraproject.org/updates/FEDORA-2017-a11057f70e

Thunderbird could add the backported patch from firefox 26, filename:
  rhbz-1400293-fix-mozilla-1324096.patch

Thunderbird requires version dependencies on the above packages builds.
(please include the &quot;build&quot; number in the requirement, because for nss/p11-kit, there were earlier &quot;versions&quot; that didn&apos;t include the required fixes.)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10328835</commentid>
    <comment_count>12</comment_count>
    <who name="Kai Engert (:kaie)">kengert</who>
    <bug_when>2017-04-12 08:51:59 -0400</bug_when>
    <thetext>(In my previous comment, for nss and p11-kit, I intended to say that the *F24* packages are still in testing.)

Regarding ca-certificates, it seems we have gotten sufficient test feedback. I&apos;m fine to push them to stable soon.


Thunderbird team: You could go ahead, pick up the patch I mentioned, and build for all Fedora branches. But please disable auto-stable. Please wait until after all base packages have been pushed to stable, prior to pushing thunderbird to stable.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10332629</commentid>
    <comment_count>13</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-13 06:53:55 -0400</bug_when>
    <thetext>thunderbird-52.0-2.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-4efaae68fe</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10332630</commentid>
    <comment_count>14</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-13 06:54:04 -0400</bug_when>
    <thetext>thunderbird-52.0-2.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-525d9c8af2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10333531</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-13 11:20:32 -0400</bug_when>
    <thetext>thunderbird-52.0-2.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-4efaae68fe</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10333925</commentid>
    <comment_count>16</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-13 13:22:31 -0400</bug_when>
    <thetext>thunderbird-52.0-2.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-525d9c8af2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10349396</commentid>
    <comment_count>17</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-20 08:02:05 -0400</bug_when>
    <thetext>thunderbird-52.0-2.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10367143</commentid>
    <comment_count>18</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-27 01:51:09 -0400</bug_when>
    <thetext>thunderbird-52.0-2.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>