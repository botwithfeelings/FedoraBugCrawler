<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1391728</bug_id>
          
          <creation_ts>2016-11-03 16:46:00 -0400</creation_ts>
          <short_desc>%post enumerates groups many times, refers to undefined macros</short_desc>
          <delta_ts>2017-04-29 20:20:07 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>389-ds-base</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Nalin Dahyabhai">nalin</reporter>
          <assigned_to>mreynolds</assigned_to>
          <cc>edewata</cc>
    
    
    <cc>mreynolds</cc>
    
    
    <cc>nhosoi</cc>
    
    
    <cc>nkinder</cc>
    
    
    <cc>rmeggins</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>389-ds-base-1.3.5.17-2.f25 389-ds-base-1.3.5.17-3.fc25 389-ds-base-1.3.6.5-1.fc26</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-04-29 20:20:07</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9855394</commentid>
    <comment_count>0</comment_count>
    <who name="Nalin Dahyabhai">nalin</who>
    <bug_when>2016-11-03 16:46:25 -0400</bug_when>
    <thetext>Description of problem:
The %post script checks if a UID is unused by running &apos;getent passwd&apos;, extracting the UID fields, and checking if a candidate UID is in the output list.  It does this for every candidate UID.  Then it does this for groups, but without isolating the GID field, so any entry which contains the candidate GID as a substring will cause that GID to appear to be used.  Our densely populated group list here is causing this loop for many more iterations than it should.

Version-Release number of selected component (if applicable):
389-ds-base-1.3.5.14-1.fc25

How reproducible:
Always

Steps to Reproduce:
1. Upgrade the package on a system with many groups, where &apos;getent group&apos; is takes a non-trivial amount of time to run.

Actual results:
This %post has been running for three hours on my workstation.

Expected results:
Shorter execution time, by using awk to extract just the GID field, as is done for passwd entries, and possibly by only asking getent for one passwd or group entry at a time, or by caching the enumeration output and then examining that.

Additional info:
Suppressed output attempts to refer to &quot;%dirsrv_uid&quot; and &quot;%dirsrv_gid&quot;, which are not defined macros, which will interact badly with the shell that&apos;s executing the script.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10281814</commentid>
    <comment_count>1</comment_count>
    <who name="wibrown@redhat.com">wibrown</who>
    <bug_when>2017-03-28 00:30:28 -0400</bug_when>
    <thetext>Upstream ticket:
https://pagure.io/389-ds-base/issue/49195</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10356655</commentid>
    <comment_count>2</comment_count>
    <who name="">mreynolds</who>
    <bug_when>2017-04-24 09:33:29 -0400</bug_when>
    <thetext>Fixed upstream</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10356746</commentid>
    <comment_count>3</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-24 09:54:03 -0400</bug_when>
    <thetext>389-ds-base-1.3.5.17-2.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-8bb5a83e04</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10358771</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-24 23:54:07 -0400</bug_when>
    <thetext>389-ds-base-1.3.5.17-2.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-8bb5a83e04</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10367269</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-27 02:49:20 -0400</bug_when>
    <thetext>389-ds-base-1.3.5.17-3.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-a77e1b55ea</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10369255</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-27 11:26:33 -0400</bug_when>
    <thetext>389-ds-base-1.3.6.5-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-15e2a038b2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10370074</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-27 15:54:09 -0400</bug_when>
    <thetext>389-ds-base-1.3.5.17-3.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10373468</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-28 13:50:55 -0400</bug_when>
    <thetext>389-ds-base-1.3.6.5-1.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-15e2a038b2</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10374653</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-29 20:20:07 -0400</bug_when>
    <thetext>389-ds-base-1.3.6.5-1.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>