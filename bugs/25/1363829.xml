<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1363829</bug_id>
          
          <creation_ts>2016-08-03 12:36:00 -0400</creation_ts>
          <short_desc>SELinux is preventing hp from &apos;wake_alarm&apos; accesses on the capability2 Unknown.</short_desc>
          <delta_ts>2016-11-18 10:16:44 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>selinux-policy</component>
          <version>25</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard>abrt_hash:5b72b441e4bc965a1c66f3039c9c3f08ea6f5105754002e48aff1383cece62cc;VARIANT_ID=workstation;</status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Joachim Frieben">jfrieben</reporter>
          <assigned_to name="Miroslav Grepl">mgrepl</assigned_to>
          <cc>berend.de.schouwer</cc>
    
    
    <cc>bonsaihorn</cc>
    
    
    <cc>chmelarz</cc>
    
    
    <cc>dominick.grift</cc>
    
    
    <cc>dwalsh</cc>
    
    
    <cc>goeran</cc>
    
    
    <cc>lvrabec</cc>
    
    
    <cc>mgrepl</cc>
    
    
    <cc>mikhail.v.gavrilov</cc>
    
    
    <cc>ortizsantini</cc>
    
    
    <cc>plautrba</cc>
    
    
    <cc>samtygier</cc>
    
    
    <cc>sgallagh</cc>
    
    
    <cc>tom.tdw</cc>
    
    
    <cc>tstoeckler</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>selinux-policy-3.13.1-224.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-11-18 10:16:44</cf_last_closed>
          <cf_type>---</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9582308</commentid>
    <comment_count>0</comment_count>
    <who name="Joachim Frieben">jfrieben</who>
    <bug_when>2016-08-03 12:36:31 -0400</bug_when>
    <thetext>Description of problem:
SELinux is preventing hp from &apos;wake_alarm&apos; accesses on the capability2 Unknown.

*****  Plugin catchall (100. confidence) suggests   **************************

If you believe that hp should be allowed wake_alarm access on the Unknown capability2 by default.
Then you should report this as a bug.
You can generate a local policy module to allow this access.
Do
allow this access for now by executing:
# ausearch -c &apos;hp&apos; --raw | audit2allow -M my-hp
# semodule -X 300 -i my-hp.pp

Additional Information:
Source Context                system_u:system_r:cupsd_t:s0-s0:c0.c1023
Target Context                system_u:system_r:cupsd_t:s0-s0:c0.c1023
Target Objects                Unknown [ capability2 ]
Source                        hp
Source Path                   hp
Port                          &lt;Unknown&gt;
Host                          (removed)
Source RPM Packages           
Target RPM Packages           
Policy RPM                    selinux-policy-3.13.1-206.fc25.noarch
Selinux Enabled               True
Policy Type                   targeted
Enforcing Mode                Enforcing
Host Name                     (removed)
Platform                      Linux (removed) 4.8.0-0.rc0.git3.1.fc25.x86_64 #1
                              SMP Fri Jul 29 15:09:59 UTC 2016 x86_64 x86_64
Alert Count                   4
First Seen                    2016-08-03 18:24:17 CEST
Last Seen                     2016-08-03 18:24:26 CEST
Local ID                      db9f12ae-e6f8-463d-8fcb-eea10d4c5551

Raw Audit Messages
type=AVC msg=audit(1470241466.118:265): avc:  denied  { wake_alarm } for  pid=2515 comm=&quot;gutenprint52+us&quot; capability=35  scontext=system_u:system_r:cupsd_t:s0-s0:c0.c1023 tcontext=system_u:system_r:cupsd_t:s0-s0:c0.c1023 tclass=capability2 permissive=0


Hash: hp,cupsd_t,cupsd_t,capability2,wake_alarm

Version-Release number of selected component:
selinux-policy-3.13.1-206.fc25.noarch

Additional info:
reporter:       libreport-2.7.2
hashmarkername: setroubleshoot
kernel:         4.8.0-0.rc0.git3.1.fc25.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9740910</commentid>
    <comment_count>1</comment_count>
    <who name="Mikhail">mikhail.v.gavrilov</who>
    <bug_when>2016-09-25 12:25:37 -0400</bug_when>
    <thetext>Description of problem:
switch on HP printer

Version-Release number of selected component:
selinux-policy-3.13.1-215.fc25.noarch

Additional info:
reporter:       libreport-2.8.0
hashmarkername: setroubleshoot
kernel:         4.8.0-0.rc7.git0.1.fc25.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9775148</commentid>
    <comment_count>2</comment_count>
    <who name="Göran Uddeborg">goeran</who>
    <bug_when>2016-10-08 09:43:50 -0400</bug_when>
    <thetext>In which errata was this supposed to be fixed?  I updated to 3.13.1-215.fc25 which is the most recent in the F25 channels.  But I still get the same AVC.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9775323</commentid>
    <comment_count>3</comment_count>
    <who name="Joachim Frieben">jfrieben</who>
    <bug_when>2016-10-08 14:01:20 -0400</bug_when>
    <thetext>(In reply to Göran Uddeborg from comment #2)
The latest available version is selinux-policy-3.13.1-218.fc25 which was released two days ago and which you should have had already unless you forgot to update or use an outdated mirror.
As of selinux-policy-3.13.1-218.fc25, I do not see any alert of type &quot;SELinux is preventing hp from &apos;wake_alarm&apos; accesses on the capability2 Unknown.&quot;.
I do actually still see &quot;SELinux is preventing hpfax from using the &apos;wake_alarm&apos; capabilities.&quot; but that relates to bug 1374990, thus, it is &quot;hpfax&quot; and -not- &quot;hp&quot;.
It is a bad idea to reopen other people&apos;s closed bugs without having a clear idea of the present situation. Please recheck for selinux-policy-3.13.1-218.fc25, make sure that the alert was triggered by &quot;hp&quot; and not by &quot;hpfax&quot;; otherwise close the bug, thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9775329</commentid>
    <comment_count>4</comment_count>
    <who name="Göran Uddeborg">goeran</who>
    <bug_when>2016-10-08 14:23:05 -0400</bug_when>
    <thetext>I tried an update once more now, and this time dnf did indeed find a -218 release.  I don&apos;t quite understand why it wasn&apos;t found when I checked earlier today.  Some kind of caching could be a reason, but if it was released two days ago it seems a bit strange to me.  My issue was with &quot;hp&quot;, not &quot;hpfax&quot; or any other binary.  So I did actually think I had the latest update and the same error, why I ventured a reopen.

Since I obviously was wrong, I&apos;m closing again.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9775380</commentid>
    <comment_count>5</comment_count>
    <who name="Joachim Frieben">jfrieben</who>
    <bug_when>2016-10-08 15:30:46 -0400</bug_when>
    <thetext>(In reply to Göran Uddeborg from comment #4)
A good place to check for the latest updates is the Fedora Update System at https://bodhi.fedoraproject.org. This allows you to verify whether an update to the package in question is already in the testing stage or scheduled for being released to updates-testing.
Unfortunately, you do not mention whether selinux-policy-3.13.1-218.fc25 -does- resolve the issue successfully for you. Testing the latter with a positive result would have been the prerequisite for closing this bug report again as you have done.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9775477</commentid>
    <comment_count>6</comment_count>
    <who name="Göran Uddeborg">goeran</who>
    <bug_when>2016-10-08 17:04:25 -0400</bug_when>
    <thetext>I know about Bodhi, but when I&apos;m only interested in released packages it should not be any point in going there.  A simple dnf command should give the same information.  Besides, normally there is a mention in a bugzilla which release is supposed to fix the issue I found missing here.

But since you seemed unhappy I reopened your bug, I wanted to leave it the way I found it.  If I can reproduce the problem with the new policy, I can open a separate case.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9776632</commentid>
    <comment_count>7</comment_count>
    <who name="Joachim Frieben">jfrieben</who>
    <bug_when>2016-10-09 14:50:21 -0400</bug_when>
    <thetext>SELinux is preventing hp from using the &apos;wake_alarm&apos; capabilities.

*****  Plugin catchall (100. confidence) suggests   **************************

If you believe that hp should have the wake_alarm capability by default.
Then you should report this as a bug.
You can generate a local policy module to allow this access.
Do
allow this access for now by executing:
# ausearch -c &apos;hp&apos; --raw | audit2allow -M my-hp
# semodule -X 300 -i my-hp.pp

Additional Information:
Source Context                system_u:system_r:cupsd_t:s0-s0:c0.c1023
Target Context                system_u:system_r:cupsd_t:s0-s0:c0.c1023
Target Objects                Unknown [ capability2 ]
Source                        hp
Source Path                   hp
Port                          &lt;Unknown&gt;
Host                          (removed)
Source RPM Packages           
Target RPM Packages           
Policy RPM                    selinux-policy-3.13.1-218.fc25.noarch
Selinux Enabled               True
Policy Type                   targeted
Enforcing Mode                Permissive
Host Name                     (removed)
Platform                      Linux (removed) 4.8.1-1.fc25.x86_64 #1 SMP Fri Oct
                              7 14:38:22 UTC 2016 x86_64 x86_64
Alert Count                   2
First Seen                    2016-10-09 20:38:40 CEST
Last Seen                     2016-10-09 20:38:46 CEST
Local ID                      d225dc9f-0669-472c-95e5-312c1a51c6db

Raw Audit Messages
type=AVC msg=audit(1476038326.139:212): avc:  denied  { wake_alarm } for  pid=1938 comm=&quot;hpfax&quot; capability=35  scontext=system_u:system_r:cupsd_t:s0-s0:c0.c1023 tcontext=system_u:system_r:cupsd_t:s0-s0:c0.c1023 tclass=capability2 permissive=1


Hash: hp,cupsd_t,cupsd_t,capability2,wake_alarm</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9821192</commentid>
    <comment_count>8</comment_count>
    <who name="Thomas Wright">tom.tdw</who>
    <bug_when>2016-10-25 18:39:46 -0400</bug_when>
    <thetext>Description of problem:
Error encountered when adding network printer whilst testing Fedora 25.

Version-Release number of selected component:
selinux-policy-3.13.1-220.fc25.noarch

Additional info:
reporter:       libreport-2.8.0
hashmarkername: setroubleshoot
kernel:         4.8.3-300.fc25.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9821193</commentid>
    <comment_count>9</comment_count>
    <who name="Thomas Wright">tom.tdw</who>
    <bug_when>2016-10-25 18:43:05 -0400</bug_when>
    <thetext>This bug definitely occurs on uptodate Fedora 25, with the latest version of selinux-policy:
Installed Packages
Name        : selinux-policy
Arch        : noarch
Epoch       : 0
Version     : 3.13.1
Release     : 220.fc25
Size        : 20 k
Repo        : @System
Summary     : SELinux policy configuration
URL         : http://github.com/TresysTechnology/refpolicy/wiki
License     : GPLv2+
Description : SELinux Base package for SELinux Reference Policy - modular.
            : Based off of reference policy: Checked out revision  2.20091117</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9822509</commentid>
    <comment_count>10</comment_count>
    <who name="">tstoeckler</who>
    <bug_when>2016-10-26 06:45:30 -0400</bug_when>
    <thetext>Description of problem:
Added a Canon MX 340 printer attached to a Synology DiskStation that was autodiscovered by the Gnome-Settings Printer section.

The printer was added and the screen said &quot;Installing printer&quot; (or similar) and then the SELinux violation came up

Version-Release number of selected component:
selinux-policy-3.13.1-220.fc25.noarch

Additional info:
reporter:       libreport-2.8.0
hashmarkername: setroubleshoot
kernel:         4.8.3-300.fc25.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9846753</commentid>
    <comment_count>11</comment_count>
    <who name="Boricua">ortizsantini</who>
    <bug_when>2016-11-02 11:44:50 -0400</bug_when>
    <thetext>Description of problem:
I tried to print from LibreOffice to my HP LaserJet p2055dn. Apparently SELinux prevented it.

Version-Release number of selected component:
selinux-policy-3.13.1-220.fc25.noarch

Additional info:
reporter:       libreport-2.8.0
hashmarkername: setroubleshoot
kernel:         4.8.5-300.fc25.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9879337</commentid>
    <comment_count>12</comment_count>
    <who name="Berend De Schouwer">berend.de.schouwer</who>
    <bug_when>2016-11-10 06:00:45 -0500</bug_when>
    <thetext>Description of problem:
Scan for printers

Gnome Settings -&gt; Printers -&gt; Unlock -&gt; &apos;+&apos; / Add a New Printer

The system scans for printers, and somewhere wakes an hp process (probably part of hplip or hpijs)

Version-Release number of selected component:
selinux-policy-3.13.1-220.fc25.noarch

Additional info:
reporter:       libreport-2.8.0
hashmarkername: setroubleshoot
kernel:         4.8.6-300.fc25.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9883671</commentid>
    <comment_count>13</comment_count>
    <who name="Stephen Gallagher">sgallagh</who>
    <bug_when>2016-11-11 10:11:37 -0500</bug_when>
    <thetext>Description of problem:
I attempted to scan for available printers


Additional info:
reporter:       libreport-2.8.0
hashmarkername: setroubleshoot
kernel:         4.8.6-300.fc25.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9885985</commentid>
    <comment_count>14</comment_count>
    <who name="Matthew Horn">bonsaihorn</who>
    <bug_when>2016-11-13 12:43:54 -0500</bug_when>
    <thetext>Description of problem:
Trying to wake my Surface Pro 3 by pressing the power button

Version-Release number of selected component:
selinux-policy-3.13.1-220.fc25.noarch

Additional info:
reporter:       libreport-2.8.0
hashmarkername: setroubleshoot
kernel:         4.8.4-301.fc25.x86_64
type:           libreport</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9898607</commentid>
    <comment_count>15</comment_count>
    <who name="Zdenek Chmelar">chmelarz</who>
    <bug_when>2016-11-16 19:17:18 -0500</bug_when>
    <thetext>Description of problem:
Appeared when I opened Printers Settings and clicked on &quot;Add a Printer&quot; button. I typed some letters to search field.

Version-Release number of selected component:
selinux-policy-3.13.1-222.fc25.noarch

Additional info:
reporter:       libreport-2.8.0
hashmarkername: setroubleshoot
kernel:         4.8.6-300.fc25.x86_64
type:           libreport</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>