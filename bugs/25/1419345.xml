<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1419345</bug_id>
          
          <creation_ts>2017-02-05 11:48:00 -0500</creation_ts>
          <short_desc>kernel 4.9 fails to complete hardware shutdown or reboot</short_desc>
          <delta_ts>2017-02-15 13:34:20 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>kernel</component>
          <version>25</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>CURRENTRELEASE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>bernard.godard</reporter>
          <assigned_to name="Kernel Maintainer List">kernel-maint</assigned_to>
          <cc>gansalmon</cc>
    
    
    <cc>ichavero</cc>
    
    
    <cc>itamar</cc>
    
    
    <cc>jkastner</cc>
    
    
    <cc>jonathan</cc>
    
    
    <cc>kernel-maint</cc>
    
    
    <cc>labbott</cc>
    
    
    <cc>madhu.chinakonda</cc>
    
    
    <cc>mchehab</cc>
    
    
    <cc>sbobber</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-02-15 13:34:20</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10121917</commentid>
    <comment_count>0</comment_count>
    <who name="">bernard.godard</who>
    <bug_when>2017-02-05 11:48:57 -0500</bug_when>
    <thetext>Description of problem:

Since upgrading from kernel 4.8.16-300 to 4.9.5-200, the shutdown or reboot sequences do not complete. It seems like the shutdown sequence is performed, the screens lose the signal from the PC, but the hardware stays powered (I have to use the reboot button to perform a reboot or to press for a long time on the power button to shutdown the hardware.

The last lines of the system log are:

Feb 05 14:55:19 saturn systemd[1]: Reached target Unmount All Filesystems.
Feb 05 14:55:19 saturn systemd[1]: Reached target Final Step.
Feb 05 14:55:19 saturn systemd[1]: Starting Power-Off...
Feb 05 14:55:19 saturn systemd[1]: Shutting down.
Feb 05 14:55:21 saturn systemd-shutdown[1]: Sending SIGTERM to remaining processes...
Feb 05 14:55:21 saturn systemd-journald[614]: Journal stopped


Some hardware information from taken from lshw output (without classes: storage, volume and disk):
H/W path                   Device      Class       Description
==============================================================
                                       system      To be filled by O.E.M. (SKU)
/0                                     bus         M5A97 R2.0
/0/0                                   memory      64KiB BIOS
/0/4                                   processor   AMD FX(tm)-8350 Eight-Core Processor
/0/4/5                                 memory      384KiB L1 cache
/0/4/6                                 memory      8MiB L2 cache
/0/4/7                                 memory      8MiB L3 cache
/0/2c                                  memory      8GiB System Memory
/0/2c/0                                memory      DIMM Synchronous [empty]
/0/2c/1                                memory      4GiB DIMM DDR3 Synchronous Unbuffered (Unregistered) 1333 MHz (0.8 ns)
/0/2c/2                                memory      DIMM Synchronous [empty]
/0/2c/3                                memory      4GiB DIMM DDR3 Synchronous Unbuffered (Unregistered) 1333 MHz (0.8 ns)
/0/100                                 bridge      RD9x0/RX980 Host Bridge
/0/100/2                               bridge      RD890/RD9x0/RX980 PCI to PCI bridge (PCI Express GFX port 0)
/0/100/2/0                             display     Juniper XT [Radeon HD 6770]
/0/100/2/0.1                           multimedia  Juniper HDMI Audio [Radeon HD 5700 Series]
/0/100/4                               bridge      RD890/RD9x0/RX980 PCI to PCI bridge (PCI Express GPP Port 0)
/0/100/4/0                 enp2s0      network     RTL8111/8168/8411 PCI Express Gigabit Ethernet Controller
/0/100/5                               bridge      RD890/RD9x0/RX980 PCI to PCI bridge (PCI Express GPP Port 1)
/0/100/5/0                             bus         ASM1042 SuperSpeed USB Host Controller
/0/100/5/0/0               usb8        bus         xHCI Host Controller
/0/100/5/0/1               usb9        bus         xHCI Host Controller
/0/100/7                               bridge      RD890/RD9x0/RX980 PCI to PCI bridge (PCI Express GPP Port 3)
/0/100/7/0                             bus         ASM1042 SuperSpeed USB Host Controller
/0/100/7/0/0               usb10       bus         xHCI Host Controller
/0/100/7/0/0/2                         bus         USB2.0 Hub
/0/100/7/0/1               usb11       bus         xHCI Host Controller
/0/100/7/0/1/2                         bus         USB3.0 Hub

/0/100/12                              bus         SB7x0/SB8x0/SB9x0 USB OHCI0 Controller
/0/100/12/1                usb4        bus         OHCI PCI host controller
/0/100/12.2                            bus         SB7x0/SB8x0/SB9x0 USB EHCI Controller
/0/100/12.2/1              usb1        bus         EHCI Host Controller
/0/100/13                              bus         SB7x0/SB8x0/SB9x0 USB OHCI0 Controller
/0/100/13/1                usb5        bus         OHCI PCI host controller
/0/100/13/1/1                          generic     eHome Infrared Transceiver
/0/100/13/1/4                          input       USB Receiver
/0/100/13.2                            bus         SB7x0/SB8x0/SB9x0 USB EHCI Controller
/0/100/13.2/1              usb2        bus         EHCI Host Controller

/0/100/14                              bus         SBx00 SMBus Controller
/0/100/14.2                            multimedia  SBx00 Azalia (Intel HDA)
/0/100/14.3                            bridge      SB7x0/SB8x0/SB9x0 LPC host controller
/0/100/14.4                            bridge      SBx00 PCI to PCI Bridge
/0/100/14.4/6                          multimedia  CX23880/1/2/3 PCI Video and Audio Decoder
/0/100/14.4/6.1                        multimedia  CX23880/1/2/3 PCI Video and Audio Decoder [Audio Port]
/0/100/14.4/6.2                        multimedia  CX23880/1/2/3 PCI Video and Audio Decoder [MPEG Port]
/0/100/14.5                            bus         SB7x0/SB8x0/SB9x0 USB OHCI2 Controller
/0/100/14.5/1              usb6        bus         OHCI PCI host controller
/0/100/16                              bus         SB7x0/SB8x0/SB9x0 USB OHCI0 Controller
/0/100/16/1                usb7        bus         OHCI PCI host controller
/0/100/16.2                            bus         SB7x0/SB8x0/SB9x0 USB EHCI Controller
/0/100/16.2/1              usb3        bus         EHCI Host Controller
/0/101                                 bridge      Family 15h Processor Function 0
/0/102                                 bridge      Family 15h Processor Function 1
/0/103                                 bridge      Family 15h Processor Function 2
/0/104                                 bridge      Family 15h Processor Function 3
/0/105                                 bridge      Family 15h Processor Function 4
/0/106                                 bridge      Family 15h Processor Function 5

/1                         virbr0      network     Ethernet interface
/2                         virbr0-nic  network     Ethernet interface

Version-Release number of selected component (if applicable):
problem appears with kernel 4.9.5-200 and kernel 4.9.6-200
if I boot with 4.8.16-300, I don&apos;t see this problem.

How reproducible:
always with this hardware and kernels.


Steps to Reproduce:
Click on shutdown or reboot icon.

Actual results:
Shutdown/reboot sequence starts.
Screens go black and report no signal.
Hardware stays powered (LED on, noise from fans...) and then nothing happens.

Expected results:
Hardware shutdown or reboot.

Additional info:
I have used this particular hardware with many Linux distributions and I don&apos;t remember having encountered that particular problem except maybe with some Live distributions.
If I boot Fedora with previous kernel 4.8.16-300, I don&apos;t see this problem.
Thus this does not look like a hardware failure but likely a kernel regression.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10123226</commentid>
    <comment_count>1</comment_count>
    <who name="">bernard.godard</who>
    <bug_when>2017-02-06 06:14:08 -0500</bug_when>
    <thetext>After I had accidentally put my computer to sleep (accidental press on keyboard multimedia power button), I find that I can shutdown the computer properly.

This is also reproducible:
1 press keyboard multimedia power button
-&gt; computer hibernates, fans are off (no noise) but power LED keeps blinking.
2 press any keyboard button:
-&gt; computer wakes up
3 click on shutdown
-&gt; complete shutdown, fans off, power LED off

The shutdown only completes if the computer has been hibernated since boot.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10146922</commentid>
    <comment_count>2</comment_count>
    <who name="">bernard.godard</who>
    <bug_when>2017-02-14 10:17:31 -0500</bug_when>
    <thetext>It seems to be fixed in kernels 
- 4.9.7-201
- 4.9.8-201</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10146924</commentid>
    <comment_count>3</comment_count>
    <who name="">bernard.godard</who>
    <bug_when>2017-02-14 10:18:07 -0500</bug_when>
    <thetext>It seems to be fixed in kernels 
- 4.9.7-201
- 4.9.8-201</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10151115</commentid>
    <comment_count>4</comment_count>
    <who name="Laura Abbott">labbott</who>
    <bug_when>2017-02-15 13:34:20 -0500</bug_when>
    <thetext>Thank you for letting us know.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>