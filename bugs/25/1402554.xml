<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1402554</bug_id>
          
          <creation_ts>2016-12-07 14:45:00 -0500</creation_ts>
          <short_desc>file /usr/share/man/man1/gcore.1.gz from install of gdb-7.12-29.fc25.x86_64 conflicts with file from package gdb-headless-7.12-24.fc25.x86_64</short_desc>
          <delta_ts>2017-01-04 04:59:38 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>gdb</component>
          <version>25</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>medium</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Zdenek Sedlak">dev</reporter>
          <assigned_to name="Rex Dieter">rdieter</assigned_to>
          <cc>gbenson</cc>
    
    
    <cc>jan.kratochvil</cc>
    
    
    <cc>packaging-team-maint</cc>
    
    
    <cc>palves</cc>
    
    
    <cc>pmuldoon</cc>
    
    
    <cc>rdieter</cc>
    
    
    <cc>redhat-bugzilla</cc>
    
    
    <cc>rpm-software-management</cc>
    
    
    <cc>sergiodj</cc>
    
    
    <cc>tom</cc>
    
    
    <cc>vmukhame</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-01-04 04:59:38</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9965869</commentid>
    <comment_count>0</comment_count>
    <who name="Zdenek Sedlak">dev</who>
    <bug_when>2016-12-07 14:45:47 -0500</bug_when>
    <thetext>Description of problem:
.
.
.
[SKIPPED] xorg-x11-drv-wacom-0.33.99.1-1.fc25.x86_64.rpm: Already downloaded                                                                                                                                                                                                             
Running transaction check
Transaction check succeeded.
Running transaction test
The downloaded packages were saved in cache until the next successful transaction.
You can remove cached packages by executing &apos;dnf clean packages&apos;.
Error: Transaction check error:
  file /usr/share/man/man1/gcore.1.gz from install of gdb-7.12-29.fc25.x86_64 conflicts with file from package gdb-headless-7.12-24.fc25.x86_64

Error Summary
-------------



Version-Release number of selected component (if applicable):
gdb-7.12-29.fc25.x86_64
gdb-headless-7.12-24.fc25.x86_64

How reproducible:
dnf update on freshly installed Fedora 25

Steps to Reproduce:
1. Install Fedora 25 from Fedora 25 Workstation Live ISO
2. sudo dnf update
3.

Actual results:
Error: Transaction check error:
  file /usr/share/man/man1/gcore.1.gz from install of gdb-7.12-29.fc25.x86_64 conflicts with file from package gdb-headless-7.12-24.fc25.x86_64

Expected results:
No conflict

Additional info:</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9974427</commentid>
    <comment_count>1</comment_count>
    <who name="Jan Kratochvil">jan.kratochvil</who>
    <bug_when>2016-12-11 03:35:27 -0500</bug_when>
    <thetext>After installing Fedora-Workstation-Live-x86_64-25-1.3.iso I had:
gdb-7.12-24.fc25.x86_64
gdb-headless-7.12-24.fc25.x86_64

After &apos;dnf update&apos; I had:
gdb-7.12-29.fc25.x86_64
gdb-headless-7.12-29.fc25.x86_64

I have the problem unreproducible.  Also I do not see any packaging mistake myself.

Please reopen it with more specific reproducibility instructions.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10026760</commentid>
    <comment_count>2</comment_count>
    <who name="Fermulator">redhat-bugzilla</who>
    <bug_when>2017-01-01 16:12:09 -0500</bug_when>
    <thetext>I have run into the exact same error.
{{{
Transaction check error: file /usr/share/man/man1/gcore.1.gz from install of gdb-7.12-29.fc25.x86_64 conflicts with file from package gdb-headless-7.12-24.fc25.x86_64
}}}

Details
{{{
$ rpm -qa | egrep &quot;gdb-7.12|gdb-headless&quot;
gdb-7.12-24.fc25.x86_64
gdb-headless-7.12-24.fc25.x86_64
gdb-headless-7.12-29.fc25.x86_64

$ cat /etc/fedora-release 
Fedora release 25 (Twenty Five)

$ uname -a
Linux (snip)-lnx-f25 4.8.6-300.fc25.x86_64 #1 SMP Tue Nov 1 12:36:38 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
}}}

This was immediately reproducible after a base installation of Fedora-Workstation-Live-x86_64-25-1.3.iso.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10026763</commentid>
    <comment_count>3</comment_count>
    <who name="Fermulator">redhat-bugzilla</who>
    <bug_when>2017-01-01 16:13:24 -0500</bug_when>
    <thetext>How to re-open the bug? (I see no mechanism in the status workflow...)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10026766</commentid>
    <comment_count>4</comment_count>
    <who name="Fermulator">redhat-bugzilla</who>
    <bug_when>2017-01-01 16:14:43 -0500</bug_when>
    <thetext>Oh, btw, repos enabled are:
{{{
$ sudo dnf repolist
Last metadata expiration check: 1:29:57 ago on Sun Jan  1 13:44:00 2017.
repo id                                                                            repo name                                                                                      status
*fedora                                                                            Fedora 25 - x86_64                                                                             51,669
spacewalk-client                                                                   Spacewalk Client Tools                                                                             27
*updates                                                                           Fedora 25 - x86_64 - Updates                                                                   13,349


$ pwd
/etc/yum.repos.d
$ ll
total 24
-rw-r--r--. 1 root root  689 Nov  3 11:13 fedora-cisco-openh264.repo
-rw-r--r--. 1 root root 1251 Nov  3 11:13 fedora.repo
-rw-r--r--. 1 root root 1270 Nov  3 11:13 fedora-updates.repo
-rw-r--r--. 1 root root 1328 Nov  3 11:13 fedora-updates-testing.repo
}}}</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10026769</commentid>
    <comment_count>5</comment_count>
    <who name="Jan Kratochvil">jan.kratochvil</who>
    <bug_when>2017-01-01 16:21:27 -0500</bug_when>
    <thetext>(In reply to Fermulator from comment #2)
&gt; gdb-headless-7.12-24.fc25.x86_64
&gt; gdb-headless-7.12-29.fc25.x86_64

This must not happen - the rpm database is inconsistent in such case.
But that is a problem of dnf, not gdb.  I do not know how that can happen.
Repair of rpm database should be:
  dnf remove --duplicates</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10028619</commentid>
    <comment_count>6</comment_count>
    <who name="Fermulator">redhat-bugzilla</who>
    <bug_when>2017-01-02 10:44:46 -0500</bug_when>
    <thetext>@Igore why &quot;NOTABUG&quot;?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10028651</commentid>
    <comment_count>7</comment_count>
    <who name="Fermulator">redhat-bugzilla</who>
    <bug_when>2017-01-02 10:55:41 -0500</bug_when>
    <thetext>The only &quot;duplicate&quot; keyword in the dnf man page is:
{{{
$ dnf --help | grep dup
  --showduplicates      show duplicates, in repos, in list/search commands
}}}

So the recommended &quot;dnf remove --duplicates&quot; is not available.

Let&apos;s try to remove the OLDER package manually...
{{{
$ rpm -qa | grep gdb-headless
gdb-headless-7.12-24.fc25.x86_64
gdb-headless-7.12-29.fc25.x86_64

$ sudo dnf remove gdb-headless-7.12-24.fc25.x86_64
This system is receiving updates from Spacewalk server.
Dependencies resolved.
========================================================================================================================================================================================
 Package                                                  Arch                                Version                                      Repository                              Size
========================================================================================================================================================================================
Removing:
 abrt-addon-ccpp                                          x86_64                              2.9.0-1.fc25                                 @anaconda                              308 k
 abrt-addon-coredump-helper                               x86_64                              2.9.0-1.fc25                                 @anaconda                               34 k
 abrt-addon-kerneloops                                    x86_64                              2.9.0-1.fc25                                 @anaconda                               72 k
 abrt-addon-pstoreoops                                    x86_64                              2.9.0-1.fc25                                 @anaconda                               14 k
 abrt-addon-python3                                       x86_64                              2.9.0-1.fc25                                 @anaconda                               18 k
 abrt-addon-vmcore                                        x86_64                              2.9.0-1.fc25                                 @anaconda                               43 k
 abrt-addon-xorg                                          x86_64                              2.9.0-1.fc25                                 @anaconda                               50 k
 abrt-cli                                                 x86_64                              2.9.0-1.fc25                                 @anaconda                                0  
 abrt-desktop                                             x86_64                              2.9.0-1.fc25                                 @anaconda                                0  
 abrt-gui                                                 x86_64                              2.9.0-1.fc25                                 @anaconda                              226 k
 abrt-gui-libs                                            x86_64                              2.9.0-1.fc25                                 @anaconda                               27 k
 abrt-plugin-bodhi                                        x86_64                              2.9.0-1.fc25                                 @anaconda                               26 k
 abrt-retrace-client                                      x86_64                              2.9.0-1.fc25                                 @anaconda                              108 k
 abrt-tui                                                 x86_64                              2.9.0-1.fc25                                 @anaconda                               24 k
 elfutils                                                 x86_64                              0.167-2.fc25                                 @anaconda                              815 k
 gcc-gdb-plugin                                           x86_64                              6.3.1-1.fc25                                 @updates                               147 k
 gdb                                                      x86_64                              7.12-24.fc25                                 @anaconda                                0  
 gdb-headless                                             x86_64                              7.12-24.fc25                                 @anaconda                               10 M
 gnome-abrt                                               x86_64                              1.2.4-3.fc25                                 @anaconda                              904 k
 libreport-fedora                                         x86_64                              2.8.0-1.fc25                                 @anaconda                               41 k
 libreport-plugin-kerneloops                              x86_64                              2.8.0-1.fc25                                 @anaconda                               38 k
 libreport-plugin-logger                                  x86_64                              2.8.0-1.fc25                                 @anaconda                               39 k
 python3-humanize                                         noarch                              0.5.1-5.fc25                                 @anaconda                               56 k
 python3-inotify                                          noarch                              0.9.6-6.fc25                                 @anaconda                              251 k

Transaction Summary
========================================================================================================================================================================================
Remove  24 Packages

Installed size: 13 M
Is this ok [y/N]: y

(snip)

}}}

Anyway went ahead with that,  and after, at least only the one is installed now.
{{{
$ rpm -qa | grep gdb-headless
gdb-headless-7.12-29.fc25.x86_64
}}}

Then proceeded with the full &quot;dnf update&quot;, success!

---
So why the gdb-headless conflict in the first place? This was stumbled over via a fresh installation of Fedora 25. There must be some package dependency link broken, or what else?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10028716</commentid>
    <comment_count>8</comment_count>
    <who name="Jan Kratochvil">jan.kratochvil</who>
    <bug_when>2017-01-02 11:12:51 -0500</bug_when>
    <thetext>(In reply to Fermulator from comment #6)
&gt; @Igore why &quot;NOTABUG&quot;?

(1) It may be a bug of Component rpm, not dnf.  One never knows.
(2) rpm database with multiple versions of a package is a well known state but it is not a correct state.  One needs to figure out why that happened which you did not provide information for.  Apparently a previous update has aborted in the middle but we do not know why.


(In reply to Fermulator from comment #7)
&gt; Anyway went ahead with that,

You should not, there should be a way to remove duplicit rpm database entry without affecting other packages.  But that is offtopic here.


&gt; So why the gdb-headless conflict in the first place?

Because the rpm database contains two versions of one package.  The problem is why did that happen.  Not what happens with two versions of one package installed.


&gt; This was stumbled over via a fresh installation of Fedora 25.

Obviously the fresh installation has not finished correctly.  We do not know why.


&gt; There must be some package dependency link broken, or what else?

No.  Explained above.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10029164</commentid>
    <comment_count>9</comment_count>
    <who name="Rex Dieter">rdieter</who>
    <bug_when>2017-01-02 19:06:47 -0500</bug_when>
    <thetext>gdb moved manpages in a recent update, a carefully placed
Conflicts: 
tag should resolve this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10029251</commentid>
    <comment_count>10</comment_count>
    <who name="Rex Dieter">rdieter</who>
    <bug_when>2017-01-02 20:02:13 -0500</bug_when>
    <thetext>My bad, gdb.spec already included:

Requires: gdb-headless%{?_isa} = %{version}-%{release}

which should enforce that gdb and gdb-headless install matching version-release

I went ahead and added an explicit Conflicts too, which should catch any possible errors before rpm/dnf transactions start.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10032724</commentid>
    <comment_count>11</comment_count>
    <who name="Fermulator">redhat-bugzilla</who>
    <bug_when>2017-01-03 23:44:49 -0500</bug_when>
    <thetext>Nice Rex, that sounds great.
(can I see the patch/diff out of curiosity?)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10033227</commentid>
    <comment_count>12</comment_count>
    <who name="Jan Kratochvil">jan.kratochvil</who>
    <bug_when>2017-01-04 04:59:38 -0500</bug_when>
    <thetext>(In reply to Fermulator from comment #11)
&gt; (can I see the patch/diff out of curiosity?)

https://src.fedoraproject.org/cgit/rpms/gdb.git/

Although I do not understand why there should be Conflicts when there is already Requires.  If it behaves better that way then it is a bug in dnf.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>