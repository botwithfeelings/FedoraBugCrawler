<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1" urlbase="https://bugzilla.redhat.com/" maintainer="bugzilla-error-list@redhat.com">

  <bug>
    <bug_id>1438773</bug_id>

    <creation_ts>2017-04-04 07:47:00 -0400</creation_ts>
    <short_desc>vagrant plugin install not working due missing dependencies</short_desc>
    <delta_ts>2017-06-19 07:14:51 -0400</delta_ts>
    <reporter_accessible>1</reporter_accessible>
    <cclist_accessible>1</cclist_accessible>
    <classification_id>2</classification_id>
    <classification>Fedora</classification>
    <product>Fedora</product>
    <component>vagrant</component>
    <version>25</version>
    <rep_platform>Unspecified</rep_platform>
    <op_sys>Unspecified</op_sys>
    <bug_status>CLOSED</bug_status>
    <resolution>ERRATA</resolution>

    <bug_file_loc></bug_file_loc>
    <status_whiteboard></status_whiteboard>
    <keywords></keywords>
    <priority>unspecified</priority>
    <bug_severity>unspecified</bug_severity>
    <target_milestone>---</target_milestone>

    <everconfirmed>1</everconfirmed>
    <reporter name="Woi">woiling</reporter>
    <assigned_to name="Pavel Valena">pvalena</assigned_to>
    <cc>lmohanty</cc>

    <cc>madam</cc>

    <cc>pvalena</cc>

    <cc>strzibny</cc>

    <cc>thrcka</cc>

    <cc>timosha</cc>

    <cc>vondruch</cc>

    <cc>woiling</cc>
    <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>

    <cf_fixed_in>vagrant-1.8.1-6.fc24 vagrant-1.8.5-3.fc25</cf_fixed_in>
  <cf_doc_type>If docs needed, set a value</cf_doc_type>
<cf_release_notes></cf_release_notes>
<cf_story_points>---</cf_story_points>

<cf_environment></cf_environment>
<cf_last_closed>2017-05-24 00:55:15</cf_last_closed>
<cf_type>Bug</cf_type>
<cf_regression_status>---</cf_regression_status>
<cf_mount_type>---</cf_mount_type>
<cf_documentation_action>---</cf_documentation_action>
<cf_crm></cf_crm>
<cf_verified_branch></cf_verified_branch>
<cf_category>---</cf_category>
<cf_ovirt_team>---</cf_ovirt_team>

<cf_cloudforms_team>---</cf_cloudforms_team>

<target_release>---</target_release>

<votes>0</votes>

<comment_sort_order>oldest_to_newest</comment_sort_order>
<long_desc isprivate="0">
<commentid>10302100</commentid>
<comment_count>0</comment_count>
<who name="Woi">woiling</who>
<bug_when>2017-04-04 07:47:14 -0400</bug_when>
<thetext>Description of problem: vagrant-mutate is not available in Fedora. Neither from the repositories nor by running &lt;vagrant plugin install mutate&gt; How reproducible: Install vagrant from Fedora repositories and try to install
vagrant-mutate plugin by running vagrant plugin install mutate. Steps to Reproduce: Follow the advice of https://fedoramagazine.org/running-vagrant-fedora-22/ and https://developer.fedoraproject.org/tools/vagrant/vagrant-plugins.html 1. dnf install
vagrant-libvirt 2. vagrant plugin install mutate Actual results: Installation fails because of missing headers and dependencies Expected results: &lt;vagrant mutate&gt; command is available Additional info: &lt;dnf install vagrant-libvirt
zlib-devel&gt; fixes this issue Possible solutions that come to my mind: Either package vagrant-mutant to the Fedora repos or add the missing dependencies to vagrant or vagrant-libvirt</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10302128</commentid>
<comment_count>1</comment_count>
<who name="Vít Ondruch">vondruch</who>
<bug_when>2017-04-04 07:56:38 -0400</bug_when>
<thetext>Isn&apos;t the name of the plugin &quot;vagrant-mutate&quot;? I.e. you should use &quot;vagrant plugin install vagrant-mutate&quot; to install the plugin.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10318750</commentid>
<comment_count>2</comment_count>
<who name="Woi">woiling</who>
<bug_when>2017-04-10 05:35:57 -0400</bug_when>
<thetext>Hey Vit, thanks for the quick replay. Your right it&apos;s &quot;vagrant plugin install vagrant-mutate&quot;. But it&apos;s was a typo during creation of this bug report, not during installation of vagrant-mutate. However I&apos;ll take the
chance to add some more details, because vagrant-libvirt and zlib-devel are not sufficient for building vagrant-mutate: 1. dnf group install with-optional virtualiation 2. dnf install vagrant 3. vagrant plugin install vagrant-mutate : Error message
[1] 4. dnf install libvirt-devel rubygem-ruby-libvirt ruby-devel redhat-rpm-config 5. vagrant plugin install vagrant-mutate : Error message [2] 6. dnf install zlib-devel 7. vagrant plugin install vagrant-mutate -&gt; working [1] $ vagrant plugin
install vagrant-mutate Installing the &apos;vagrant-mutate&apos; plugin. This can take a few minutes... Bundler, the underlying system Vagrant uses to install plugins, reported an error. The error is shown below. These errors are usually caused by
misconfigured plugin installations or transient network issues. The error from Bundler is: An error occurred while installing ffi (1.9.18), and Bundler cannot continue. Make sure that `gem install ffi -v &apos;1.9.18&apos;` succeeds before bundling.
Warning: this Gemfile contains multiple primary sources. Using `source` more than once without a block is a security risk, and may result in installing unexpected gems. To resolve this warning, use a block to indicate which gems should come from the
secondary source. To upgrade this warning to an error, run `bundle config disable_multisource true`.Gem::Ext::BuildError: ERROR: Failed to build gem native extension. current directory: /home/XXX/.vagrant.d/gems/gems/ffi-1.9.18/ext/ffi_c
/usr/bin/ruby -r ./siteconf20170410-4483-1jx1f8e.rb extconf.rb mkmf.rb can&apos;t find header files for ruby at /usr/share/include/ruby.h extconf failed, exit code 1 Gem files will remain installed in /home/XXX/.vagrant.d/gems/gems/ffi-1.9.18 for
inspection. Results logged to /home/XXX/.vagrant.d/gems/extensions/x86_64-linux/2.3.0/ffi-1.9.18/gem_make.out Gem::Ext::BuildError: ERROR: Failed to build gem native extension. current directory:
/home/XXX/.vagrant.d/gems/gems/json-2.0.3/ext/json/ext/generator /usr/bin/ruby -r ./siteconf20170410-4483-1m37p4f.rb extconf.rb mkmf.rb can&apos;t find header files for ruby at /usr/share/include/ruby.h extconf failed, exit code 1 Gem files will
remain installed in /home/XXX/.vagrant.d/gems/gems/json-2.0.3 for inspection. Results logged to /home/XXX/.vagrant.d/gems/extensions/x86_64-linux/2.3.0/json-2.0.3/gem_make.out $ [2] $ vagrant plugin install vagrant-mutate Installing the
&apos;vagrant-mutate&apos; plugin. This can take a few minutes... Bundler, the underlying system Vagrant uses to install plugins, reported an error. The error is shown below. These errors are usually caused by misconfigured plugin installations or
transient network issues. The error from Bundler is: An error occurred while installing nokogiri (1.6.8.1), and Bundler cannot continue. Make sure that `gem install nokogiri -v &apos;1.6.8.1&apos;` succeeds before bundling. Warning: this Gemfile
contains multiple primary sources. Using `source` more than once without a block is a security risk, and may result in installing unexpected gems. To resolve this warning, use a block to indicate which gems should come from the secondary source. To
upgrade this warning to an error, run `bundle config disable_multisource true`.Gem::Ext::BuildError: ERROR: Failed to build gem native extension. current directory: /home/XXX/.vagrant.d/gems/gems/nokogiri-1.6.8.1/ext/nokogiri /usr/bin/ruby -r
./siteconf20170410-6236-rzzbjh.rb extconf.rb checking if the C compiler accepts ... yes Building nokogiri using packaged libraries. Using mini_portile version 2.1.0 checking for gzdopen() in -lz... no zlib is missing; necessary for building libxml2
*** extconf.rb failed *** Could not create Makefile due to some reason, probably lack of necessary libraries and/or headers. Check the mkmf.log file for more details. You may need configuration options. Provided configuration options: --with-opt-dir
--without-opt-dir --with-opt-include --without-opt-include=${opt-dir}/include --with-opt-lib --without-opt-lib=${opt-dir}/lib64 --with-make-prog --without-make-prog --srcdir=. --curdir --ruby=/usr/bin/$(RUBY_BASE_NAME) --help --clean
--use-system-libraries --enable-static --disable-static --with-zlib-dir --without-zlib-dir --with-zlib-include --without-zlib-include=${zlib-dir}/include --with-zlib-lib --without-zlib-lib=${zlib-dir}/lib64 --enable-cross-build --disable-cross-build
To see why this extension failed to compile, please check the mkmf.log which can be found here: /home/XXX/.vagrant.d/gems/extensions/x86_64-linux/2.3.0/nokogiri-1.6.8.1/mkmf.log extconf failed, exit code 1 Gem files will remain installed in
/home/marco/.vagrant.d/gems/gems/nokogiri-1.6.8.1 for inspection. Results logged to /home/XXX/.vagrant.d/gems/extensions/x86_64-linux/2.3.0/nokogiri-1.6.8.1/gem_make.out [marco@phoenix ~]$</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10319807</commentid>
<comment_count>3</comment_count>
<who name="Vít Ondruch">vondruch</who>
<bug_when>2017-04-10 08:38:13 -0400</bug_when>
<thetext>Could you please check if you have rubygem-nokogiri and rubygem-ffi installed on your system? This should be better then installing and building them.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10321993</commentid>
<comment_count>4</comment_count>
<who name="Woi">woiling</who>
<bug_when>2017-04-10 17:38:08 -0400</bug_when>
<thetext>Indeed, they are: $ sudo dnf list installed rubygem-nokogiri rubygem-ffi [...] Installed Packages rubygem-ffi.x86_64 1.9.10-3.fc24 @fedora rubygem-nokogiri.x86_64 1.7.1-1.fc25.1 @updates $</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10322759</commentid>
<comment_count>5</comment_count>
<who name="Vít Ondruch">vondruch</who>
<bug_when>2017-04-11 01:25:38 -0400</bug_when>
<thetext>Ok, so there is something on your system which forces the dependency on older Nokogiri and FFI. You have to discover what it is. What gems do you have on your system? $ gem list What other Vagrant plugins do you have on your system? $
vagrant plugin list My guess is that the fastest remedy would be to start with the clean ~/.vagrant.d directory ...</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10324322</commentid>
<comment_count>6</comment_count>
<who name="Pavel Valena">pvalena</who>
<bug_when>2017-04-11 09:42:33 -0400</bug_when>
<thetext>Reproduced on F24 with `rubygem-ruby-libvirt-0.6.0-3.fc24`. Updating to `rubygem-ruby-libvirt-0.7.0-1.fc24` fixed the issue for me. What is your `rubygem-ruby-libvirt` version?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10324332</commentid>
<comment_count>7</comment_count>
<who name="Pavel Valena">pvalena</who>
<bug_when>2017-04-11 09:44:03 -0400</bug_when>
<thetext>The above is probably unrelated though. I will try to reproduce on F25.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10328427</commentid>
<comment_count>8</comment_count>
<who name="Vít Ondruch">vondruch</who>
<bug_when>2017-04-12 07:26:59 -0400</bug_when>
<thetext>It seems that one of the other Vagrant maintainers dropped this patch [1], which used to avoid this issues ... [1]
http://pkgs.fedoraproject.org/cgit/rpms/vagrant.git/diff/vagrant-1.7.4-install-plugins-in-isolation.patch?id=4b0b66a3ad4c08f6081c6a255b6892bf1379c209</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10332169</commentid>
<comment_count>9</comment_count>
<who name="Woi">woiling</who>
<bug_when>2017-04-13 04:14:21 -0400</bug_when>
<thetext>$ vagrant plugin list vagrant-libvirt (0.0.37, system) vagrant-mutate (1.2.0) $ $ gem list|grep -ie nokogiri -ie ffi -ie ruby-libvirt ffi (1.9.10) nokogiri (1.7.1) ruby-libvirt (0.7.0) $ $ gem list *** LOCAL GEMS *** bigdecimal (1.2.8)
builder (3.2.2) bundler (1.12.5) childprocess (0.5.3) did_you_mean (1.0.0) domain_name (0.5.20170223) erubis (2.7.0) excon (0.45.4) ffi (1.9.10) fog-core (1.34.0) fog-json (1.0.2) fog-libvirt (0.3.0) fog-xml (0.1.2) formatador (0.2.5)
hashicorp-checkpoint (0.1.4) http-cookie (1.0.3) i18n (0.7.0) io-console (0.4.5) json (1.8.3) listen (3.1.5) log4r (1.1.10) mime-types (3.1) mime-types-data (3.2016.0521) mini_portile2 (2.1.0) multi_json (1.10.1) net-scp (1.2.1) net-sftp (2.1.2)
net-ssh (3.2.0) netrc (0.10.3) nokogiri (1.7.1) psych (2.1.0) rb-inotify (0.9.7) rdoc (4.2.2) rest-client (2.0.0) ruby-libvirt (0.7.0) unf (0.1.4) unf_ext (0.0.7.2) $ I&apos;m testing with two systems, both with Fedora 25, both with freshly installed
KVM, libvirt and vargrant. One System was installed as Fedora 24 the other already made a few more upgrades.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10349985</commentid>
<comment_count>10</comment_count>
<who name="Pavel Valena">pvalena</who>
<bug_when>2017-04-20 10:05:55 -0400</bug_when>
<thetext>Could you please test this build? https://koji.fedoraproject.org/koji/taskinfo?taskID=19102567 Thanks!</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10377155</commentid>
<comment_count>11</comment_count>
<who name="Woi">woiling</who>
<bug_when>2017-05-01 17:48:08 -0400</bug_when>
<thetext>Looks good :) What I did in detail: $ rm -rf ~/.vagrant.d $ vagrant plugin list vagrant-libvirt (0.0.35, system) $ sudo dnf remove libvirt-devel rubygem-ruby-libvirt ruby-devel redhat-rpm-config zlib-devel (Sorry missed to set LANG=C for
this one) $ sudo dnf install https://kojipkgs.fedoraproject.org//work/tasks/2567/19102567/vagrant-1.8.5-3.fc25.noarch.rpm Letzte Prüfung auf abgelaufene Metadaten: vor 0:27:05 am Mon May 1 22:57:17 2017. Abhängigkeiten sind aufgelöst.
================================================================================ Package Arch Version Paketquelle Größe ================================================================================ Installieren: rubygem-builder noarch 3.2.2-5.fc24
fedora 21 k rubygem-excon noarch 0.45.4-2.fc24 fedora 32 k rubygem-fog-core noarch 1.34.0-2.fc24 fedora 44 k rubygem-fog-json noarch 1.0.2-2.fc24 fedora 11 k rubygem-fog-libvirt noarch 0.3.0-1.fc25 fedora 31 k rubygem-fog-xml noarch 0.1.2-2.fc24
fedora 13 k rubygem-formatador noarch 0.2.5-2.fc24 fedora 14 k rubygem-multi_json noarch 1.10.1-3.fc24 fedora 22 k rubygem-ruby-libvirt x86_64 0.7.0-1.fc25 fedora 86 k vagrant-libvirt noarch 0.0.35-3.fc25 updates 61 k Aktualisieren: vagrant noarch
1.8.5-3.fc25 @commandline 488 k Transaktionsübersicht ================================================================================ Installieren 10 Pakete Aktualisieren 1 Paket Gesamtgröße: 824 k ... $ $ vagrant plugin install vagrant-mutate
Installing the &apos;vagrant-mutate&apos; plugin. This can take a few minutes... Installed the plugin &apos;vagrant-mutate (1.2.0)&apos;! $ vagrant plugin list vagrant-libvirt (0.0.35, system) vagrant-mutate (1.2.0)</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10378248</commentid>
<comment_count>12</comment_count>
<who name="Pavel Valena">pvalena</who>
<bug_when>2017-05-02 04:59:46 -0400</bug_when>
<thetext>Great, thanks! Submitting updates to Fedora.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10378640</commentid>
<comment_count>13</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-02 07:29:36 -0400</bug_when>
<thetext>vagrant-1.8.5-3.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-8a85d7a22d</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10378641</commentid>
<comment_count>14</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-02 07:29:43 -0400</bug_when>
<thetext>vagrant-1.8.1-6.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-b3acfe7d80</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10380550</commentid>
<comment_count>15</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-02 21:02:30 -0400</bug_when>
<thetext>vagrant-1.8.1-6.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report. See https://fedoraproject.org/wiki/QA:Updates_Testing for instructions on how to install test
updates. You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-b3acfe7d80</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10386612</commentid>
<comment_count>16</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-04 11:21:43 -0400</bug_when>
<thetext>vagrant-1.8.5-3.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-8a85d7a22d</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10390283</commentid>
<comment_count>17</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-05 17:00:59 -0400</bug_when>
<thetext>vagrant-1.8.5-3.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report. See https://fedoraproject.org/wiki/QA:Updates_Testing for instructions on how to install test
updates. You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-8a85d7a22d</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10440370</commentid>
<comment_count>18</comment_count>
<who name="Timon">timosha</who>
<bug_when>2017-05-23 10:31:35 -0400</bug_when>
<thetext>$ vagrant Vagrant experienced a version conflict with some installed plugins! This usually happens if you recently upgraded Vagrant. As part of the upgrade process, some existing plugins are no longer compatible with this version of Vagrant.
The recommended way to fix this is to remove your existing plugins and reinstall them one-by-one. To remove all plugins: rm -r ~/.vagrant.d/plugins.json ~/.vagrant.d/gems Note if you have an alternate VAGRANT_HOME environmental variable set, the
folders above will be in that directory rather than your user&apos;s home directory. The error message is shown below: Bundler could not find compatible versions for gem &quot;net-ssh&quot;: In snapshot (Gemfile.lock): net-ssh (= 2.9.2) In Gemfile:
vagrant-libvirt was resolved to 0.0.32, which depends on fog-libvirt (~&gt; 0.0.1) was resolved to 0.0.3, which depends on fog-core (&gt;= 1.27.4, ~&gt; 1.27) was resolved to 1.32.0, which depends on net-ssh (&gt;= 2.1.3) vagrant was resolved to
1.8.5, which depends on net-sftp (~&gt; 2.1) was resolved to 2.1.2, which depends on net-ssh (&gt;= 2.6.5) vagrant was resolved to 1.8.5, which depends on net-sftp (~&gt; 2.1) was resolved to 2.1.2, which depends on net-ssh (&gt;= 2.6.5) vagrant was
resolved to 1.8.5, which depends on net-ssh (~&gt; 3.0) Running `bundle update` will rebuild your snapshot from scratch, using only the gems in your Gemfile, which may resolve the conflict. $ rpm -q vagrant vagrant-1.8.5-3.fc25.noarch</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10441668</commentid>
<comment_count>19</comment_count>
<who name="Pavel Valena">pvalena</who>
<bug_when>2017-05-23 19:01:55 -0400</bug_when>
<thetext>Hello Timon, please provide us with an output the of `vagrant up --debug` and `vagrant plugin list` and `rpm -q ruby-devel` -- My guess is that you have some gems already installed(under vagrant), that conflict with the system ones. Does `rm
-r ~/.vagrant.d/plugins.json ~/.vagrant.d/gems` solve your issue? Thanks!</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10442113</commentid>
<comment_count>20</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-24 00:55:15 -0400</bug_when>
<thetext>vagrant-1.8.1-6.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10442128</commentid>
<comment_count>21</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-24 01:01:05 -0400</bug_when>
<thetext>vagrant-1.8.5-3.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10455578</commentid>
<comment_count>22</comment_count>
<who name="Woi">woiling</who>
<bug_when>2017-05-29 07:56:23 -0400</bug_when>
<thetext>Thanks for your support :)</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10517847</commentid>
<comment_count>23</comment_count>
<who name="Timon">timosha</who>
<bug_when>2017-06-19 07:14:51 -0400</bug_when>
<thetext>`rm -r ~/.vagrant.d/plugins.json ~/.vagrant.d/gems` solves, thanks</thetext>
</long_desc>

</bug>

</bugzilla>
