<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1" urlbase="https://bugzilla.redhat.com/" maintainer="bugzilla-error-list@redhat.com">

  <bug>
    <bug_id>1063278</bug_id>

    <creation_ts>2014-02-10 06:56:00 -0500</creation_ts>
    <short_desc>sss_ssh_knownhostsproxy doesn&apos;t fall back to ipv4</short_desc>
    <delta_ts>2017-05-12 15:23:19 -0400</delta_ts>
    <reporter_accessible>1</reporter_accessible>
    <cclist_accessible>1</cclist_accessible>
    <classification_id>2</classification_id>
    <classification>Fedora</classification>
    <product>Fedora</product>
    <component>sssd</component>
    <version>25</version>
    <rep_platform>All</rep_platform>
    <op_sys>Linux</op_sys>
    <bug_status>CLOSED</bug_status>
    <resolution>ERRATA</resolution>

    <bug_file_loc></bug_file_loc>
    <status_whiteboard></status_whiteboard>
    <keywords>Reopened</keywords>
    <priority>unspecified</priority>
    <bug_severity>unspecified</bug_severity>
    <target_milestone>---</target_milestone>

    <everconfirmed>1</everconfirmed>
    <reporter name="Dennis Gilmore">dennis</reporter>
    <assigned_to name="Jakub Hrozek">jhrozek</assigned_to>
    <cc>abokovoy</cc>

    <cc>awilliam</cc>

    <cc>dennis</cc>

    <cc>jcholast</cc>

    <cc>jhrozek</cc>

    <cc>lslebodn</cc>

    <cc>nalin</cc>

    <cc>pbrezina</cc>

    <cc>sbose</cc>

    <cc>sgallagh</cc>

    <cc>ssorce</cc>
    <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>

    <cf_fixed_in>sssd-1.15.2-3.fc26 sssd-1.15.2-3.fc25 sssd-1.15.2-3.fc24</cf_fixed_in>
  <cf_doc_type>Bug Fix</cf_doc_type>
<cf_release_notes></cf_release_notes>
<cf_story_points>---</cf_story_points>

<cf_environment></cf_environment>
<cf_last_closed>2017-05-04 09:32:02</cf_last_closed>
<cf_type>Bug</cf_type>
<cf_regression_status>---</cf_regression_status>
<cf_mount_type>---</cf_mount_type>
<cf_documentation_action>---</cf_documentation_action>
<cf_crm></cf_crm>
<cf_verified_branch></cf_verified_branch>
<cf_category>---</cf_category>
<cf_ovirt_team>---</cf_ovirt_team>

<cf_cloudforms_team>---</cf_cloudforms_team>

<target_release>---</target_release>

<votes>0</votes>

<comment_sort_order>oldest_to_newest</comment_sort_order>
<long_desc isprivate="0">
<commentid>6801329</commentid>
<comment_count>0</comment_count>
<who name="Dennis Gilmore">dennis</who>
<bug_when>2014-02-10 06:56:48 -0500</bug_when>
<thetext>Description of problem: When sshing to a box with dual stack networking from a box with a broken network setup, fallback to ipv4 fails to occur. -4 command line option on ssh is also ignored Version-Release number of selected component (if
applicable): sssd-common-1.11.3-1.fc21.x86_64 How reproducible: always Steps to Reproduce: 1. ssh to host with ipv6 from network that cant route to host via ipv6 2. 3. Actual results: ssh -4 -vvvvv fedorapeople.org OpenSSH_6.4, OpenSSL 1.0.1e-fips 11
Feb 2013 debug1: Reading configuration data /home/dennis/.ssh/config debug1: /home/dennis/.ssh/config line 30: Applying options for fedorapeople.org debug1: Reading configuration data /etc/ssh/ssh_config debug1: /etc/ssh/ssh_config line 54: Applying
options for * debug2: ssh_connect: needpriv 0 debug1: Executing proxy command: exec /usr/bin/sss_ssh_knownhostsproxy -p 22 fedorapeople.org debug1: permanently_drop_suid: 217600001 debug3: Incorrect RSA1 identifier debug3: Could not load
&quot;/home/dennis/.ssh/id_rsa&quot; as a RSA1 public key debug1: identity file /home/dennis/.ssh/id_rsa type 1 debug1: identity file /home/dennis/.ssh/id_rsa-cert type -1 debug1: identity file /home/dennis/.ssh/id_dsa type -1 debug1: identity file
/home/dennis/.ssh/id_dsa-cert type -1 debug3: Incorrect RSA1 identifier debug3: Could not load &quot;/home/dennis/.ssh/id_ecdsa&quot; as a RSA1 public key debug1: identity file /home/dennis/.ssh/id_ecdsa type 3 debug1: identity file
/home/dennis/.ssh/id_ecdsa-cert type -1 debug1: Enabling compatibility mode for protocol 2.0 debug1: Local version string SSH-2.0-OpenSSH_6.4 ssh_exchange_identification: Connection closed by remote host Expected results: ssh to work Additional info:
adding -4 to ssh command line to force ipv4 fails also</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>6801378</commentid>
<comment_count>1</comment_count>
<who name="Jakub Hrozek">jhrozek</who>
<bug_when>2014-02-10 07:12:44 -0500</bug_when>
<thetext>Can you include the logs produced by sssd when you put debug_level=7 to the [ssh] and [domain] sections?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>6801398</commentid>
<comment_count>2</comment_count>
<who name="Pavel BÅ™ezina">pbrezina</who>
<bug_when>2014-02-10 07:19:24 -0500</bug_when>
<thetext>This is probably the same problem as described in deferred ticket: https://fedorahosted.org/sssd/ticket/1498</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>6807179</commentid>
<comment_count>3</comment_count>
<who name="openshift-github-bot">openshift-github-bot</who>
<bug_when>2014-02-11 13:28:18 -0500</bug_when>
<thetext>Commit pushed to master at https://github.com/openshift/origin-server https://github.com/openshift/origin-server/commit/e893f1d1b6a6658275ade55a75a1a330124ee792 Bug 1063278 - kill user processes before user modified: node-util/sbin/oo-admin-gear</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>6811519</commentid>
<comment_count>4</comment_count>
<who name="Jakub Hrozek">jhrozek</who>
<bug_when>2014-02-12 11:12:59 -0500</bug_when>
<thetext>Upstream ticket: https://fedorahosted.org/sssd/ticket/1498</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>7556930</commentid>
<comment_count>5</comment_count>
<who name="Adam Williamson">awilliam</who>
<bug_when>2014-10-08 23:43:09 -0400</bug_when>
<thetext>I just ran into this on F21 today. Rather annoying in the case where IPv6 routing fails but IPv4 works.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>7994499</commentid>
<comment_count>6</comment_count>
<who name="Jaroslav Reznik">jreznik</who>
<bug_when>2015-03-03 10:28:16 -0500</bug_when>
<thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 22 development cycle. Changing version to &apos;22&apos;. More information and reason for this action is here:
https://fedoraproject.org/wiki/Fedora_Program_Management/HouseKeeping/Fedora22</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9521668</commentid>
<comment_count>7</comment_count>
<who name="Fedora End Of Life">jkurik</who>
<bug_when>2016-07-19 06:59:10 -0400</bug_when>
<thetext>Fedora 22 changed to end-of-life (EOL) status on 2016-07-19. Fedora 22 is no longer maintained, which means that it will not receive any further security or bug fix updates. As a result we are closing this bug. If you can reproduce this bug
against a currently maintained version of Fedora please feel free to reopen this bug against that version. If you are unable to reopen this bug, please file a new report against the current release. If you experience problems, please add a comment to
this bug. Thank you for reporting this bug and we are sorry it could not be fixed.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9549202</commentid>
<comment_count>8</comment_count>
<who name="Jan Kurik">jkurik</who>
<bug_when>2016-07-26 00:24:28 -0400</bug_when>
<thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 25 development cycle. Changing version to &apos;25&apos;.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9628011</commentid>
<comment_count>9</comment_count>
<attachid>1191974</attachid>
<who name="Nalin Dahyabhai">nalin</who>
<bug_when>2016-08-18 14:50:32 -0400</bug_when>
<thetext>Created attachment 1191974 proposed fix</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9630313</commentid>
<comment_count>10</comment_count>
<who name="Jakub Hrozek">jhrozek</who>
<bug_when>2016-08-19 08:03:18 -0400</bug_when>
<thetext>(In reply to Nalin Dahyabhai from comment #9) &gt; Created attachment 1191974 [details] &gt; proposed fix Thank you, I sent the patch to sssd-devel.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9630314</commentid>
<comment_count>11</comment_count>
<who name="Jakub Hrozek">jhrozek</who>
<bug_when>2016-08-19 08:03:49 -0400</bug_when>
<thetext>Dennis, are you interested in testing the patch?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9642959</commentid>
<comment_count>12</comment_count>
<who name="Dennis Gilmore">dennis</who>
<bug_when>2016-08-23 19:06:36 -0400</bug_when>
<thetext>Jakub, happy to help test the patch</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9644726</commentid>
<comment_count>13</comment_count>
<who name="Jakub Hrozek">jhrozek</who>
<bug_when>2016-08-24 04:00:07 -0400</bug_when>
<thetext>(In reply to Dennis Gilmore from comment #12) &gt; Jakub, happy to help test the patch OK, which version should I base the test package on (rpm -q sssd output is sufficient) ?</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9659365</commentid>
<comment_count>14</comment_count>
<who name="Dennis Gilmore">dennis</who>
<bug_when>2016-08-29 09:06:49 -0400</bug_when>
<thetext>fedora 24 or fedora 25 builds would be good</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9659664</commentid>
<comment_count>15</comment_count>
<who name="Jakub Hrozek">jhrozek</who>
<bug_when>2016-08-29 10:19:16 -0400</bug_when>
<thetext>OK, I prepared a F-24 repo here (COPR didn&apos;t offer me F-25..) https://copr.fedorainfracloud.org/coprs/jhrozek/sssd-addrfamily-fallback/</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9664187</commentid>
<comment_count>16</comment_count>
<who name="Dennis Gilmore">dennis</who>
<bug_when>2016-08-30 11:39:52 -0400</bug_when>
<thetext>in quick testing it works. fall back is very slow, but it does appear to do so.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9665447</commentid>
<comment_count>17</comment_count>
<who name="Dennis Gilmore">dennis</who>
<bug_when>2016-08-30 21:46:35 -0400</bug_when>
<thetext>actually it seems something is really broken. I have a bunch of ipv6 only hosts ssh to them fails with packet_write_wait: Connection to UNKNOWN port 65535: Broken pipe if i ssh to root@host it works okay</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9666437</commentid>
<comment_count>18</comment_count>
<who name="Jakub Hrozek">jhrozek</who>
<bug_when>2016-08-31 04:36:14 -0400</bug_when>
<thetext>(In reply to Dennis Gilmore from comment #17) &gt; actually it seems something is really broken. I have a bunch of ipv6 only &gt; hosts ssh to them fails with &gt; packet_write_wait: Connection to UNKNOWN port 65535: Broken pipe &gt; &gt; if
i ssh to root@host it works okay Does this only happen with the sssd ssh responder? If yes, we should look at the debug logs, Broken Pipe would suggest the connection between sss_ssh and sshd was terminated abruptly for some reason.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10373307</commentid>
<comment_count>19</comment_count>
<who name="Lukas Slebodnik">lslebodn</who>
<bug_when>2017-04-28 13:19:12 -0400</bug_when>
<thetext>master: * 244adc327f7e29ba2c7ef60bc9f732d8fe3e68c9 * 5f6232c7e6d9635c1d6b6b09f799309b6094b143 * 08084b1179bb9fc38bc22b464b3d44907107bfd3</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10375800</commentid>
<comment_count>20</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-01 04:13:21 -0400</bug_when>
<thetext>sssd-1.15.2-3.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-8addfc0188</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10375804</commentid>
<comment_count>21</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-01 04:15:20 -0400</bug_when>
<thetext>sssd-1.15.2-3.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-ac43ea8522</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10375809</commentid>
<comment_count>22</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-01 04:21:26 -0400</bug_when>
<thetext>sssd-1.15.2-3.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-2b18f89e47</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10377554</commentid>
<comment_count>23</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-01 23:30:41 -0400</bug_when>
<thetext>sssd-1.15.2-3.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report. See https://fedoraproject.org/wiki/QA:Updates_Testing for instructions on how to install test
updates. You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-ac43ea8522</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10377664</commentid>
<comment_count>24</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-02 01:04:57 -0400</bug_when>
<thetext>sssd-1.15.2-3.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report. See https://fedoraproject.org/wiki/QA:Updates_Testing for instructions on how to install test
updates. You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-2b18f89e47</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10377819</commentid>
<comment_count>25</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-02 02:37:21 -0400</bug_when>
<thetext>sssd-1.15.2-3.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report. See https://fedoraproject.org/wiki/QA:Updates_Testing for instructions on how to install test
updates. You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-8addfc0188</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10386096</commentid>
<comment_count>26</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-04 09:32:02 -0400</bug_when>
<thetext>sssd-1.15.2-3.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10407380</commentid>
<comment_count>27</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-12 08:03:58 -0400</bug_when>
<thetext>sssd-1.15.2-3.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>10408843</commentid>
<comment_count>28</comment_count>
<who name="Fedora Update System">updates</who>
<bug_when>2017-05-12 15:23:19 -0400</bug_when>
<thetext>sssd-1.15.2-3.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
</long_desc>

<attachment isobsolete="0" ispatch="1" isprivate="0">
<attachid>1191974</attachid>
<date>2016-08-18 14:50:00 -0400</date>
<delta_ts>2016-08-18 14:50:32 -0400</delta_ts>
<desc>proposed fix</desc>
<filename>0001-knownhostsproxy-use-all-of-the-getaddrinfo.patch</filename>
<type>text/plain</type>
<size>1917</size>
<attacher name="Nalin Dahyabhai">nalin</attacher>

<data encoding="base64">RnJvbSBlYzFhZjhiNThmZmIzYmEyYmM1NzYxNjA5NDViMzJhMzNjNDA2MTE3IE1vbiBTZXAgMTcg MDA6MDA6MDAgMjAwMQpGcm9tOiBOYWxpbiBEYWh5YWJoYWkgPG5hbGluQHJlZGhhdC5jb20+CkRh
dGU6IFRodSwgMTggQXVnIDIwMTYgMTQ6MjM6MTkgLTA0MDAKU3ViamVjdDogW1BBVENIXSBrbm93 bmhvc3RzcHJveHk6IHVzZSBhbGwgb2YgdGhlIGdldGFkZHJpbmZvKCkKCkluIHNzc19zc2hfa25v d25ob3N0c3Byb3h5LCB1c2UgYWxsIG9mIHRoZSBkYXRhIHJldHVybmVkIGJ5CmdldGFkZHJpbmZv
KCkgd2hlbiB3ZSdyZSBjb25uZWN0aW5nIHRvIHRoZSByZW1vdGUgaG9zdC4gIFNob3VsZCBmaXgK dGlja2V0ICMxNDk4LgoKU2lnbmVkLW9mZi1ieTogTmFsaW4gRGFoeWFiaGFpIDxuYWxpbkByZWRo YXQuY29tPgotLS0KIHNyYy9zc3NfY2xpZW50L3NzaC9zc3Nfc3NoX2tub3duaG9zdHNwcm94eS5j
IHwgMTIgKysrKysrKysrLS0tCiAxIGZpbGUgY2hhbmdlZCwgOSBpbnNlcnRpb25zKCspLCAzIGRl bGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL3NyYy9zc3NfY2xpZW50L3NzaC9zc3Nfc3NoX2tub3du aG9zdHNwcm94eS5jIGIvc3JjL3Nzc19jbGllbnQvc3NoL3Nzc19zc2hfa25vd25ob3N0c3Byb3h5
LmMKaW5kZXggYWRiODIyOC4uMjZkZThjNyAxMDA2NDQKLS0tIGEvc3JjL3Nzc19jbGllbnQvc3No L3Nzc19zc2hfa25vd25ob3N0c3Byb3h5LmMKKysrIGIvc3JjL3Nzc19jbGllbnQvc3NoL3Nzc19z c2hfa25vd25ob3N0c3Byb3h5LmMKQEAgLTQwLDcgKzQwLDcgQEAKIAogLyogY29ubmVjdCB0byBz
ZXJ2ZXIgdXNpbmcgc29ja2V0ICovCiBzdGF0aWMgaW50Ci1jb25uZWN0X3NvY2tldChpbnQgZmFt aWx5LCBzdHJ1Y3Qgc29ja2FkZHIgKmFkZHIsIHNpemVfdCBhZGRyX2xlbikKK2Nvbm5lY3Rfc29j a2V0KGludCBmYW1pbHksIGludCBzb2NrdHlwZSwgaW50IHByb3RvY29sLCBzdHJ1Y3Qgc29ja2Fk
ZHIgKmFkZHIsIHNpemVfdCBhZGRyX2xlbikKIHsKICAgICBpbnQgZmxhZ3M7CiAgICAgaW50IHNv Y2sgPSAtMTsKQEAgLTY4LDcgKzY4LDcgQEAgY29ubmVjdF9zb2NrZXQoaW50IGZhbWlseSwgc3Ry dWN0IHNvY2thZGRyICphZGRyLCBzaXplX3QgYWRkcl9sZW4pCiAgICAgfQogCiAgICAgLyogY3Jl
YXRlIHNvY2tldCAqLwotICAgIHNvY2sgPSBzb2NrZXQoZmFtaWx5LCBTT0NLX1NUUkVBTSwgSVBQ Uk9UT19UQ1ApOworICAgIHNvY2sgPSBzb2NrZXQoZmFtaWx5LCBzb2NrdHlwZSwgcHJvdG9jb2wp OwogICAgIGlmIChzb2NrID09IC0xKSB7CiAgICAgICAgIHJldCA9IGVycm5vOwogICAgICAgICBE
RUJVRyhTU1NEQkdfT1BfRkFJTFVSRSwgInNvY2tldCgpIGZhaWxlZCAoJWQpOiAlc1xuIiwKQEAg LTI5NSw3ICsyOTUsMTMgQEAgaW50IG1haW4oaW50IGFyZ2MsIGNvbnN0IGNoYXIgKiphcmd2KQog ICAgIGlmIChwY19hcmdzKSB7CiAgICAgICAgIHJldCA9IGNvbm5lY3RfcHJveHlfY29tbWFuZChk
aXNjYXJkX2NvbnN0KHBjX2FyZ3MpKTsKICAgICB9IGVsc2UgaWYgKGFpKSB7Ci0gICAgICAgIHJl dCA9IGNvbm5lY3Rfc29ja2V0KGFpWzBdLmFpX2ZhbWlseSwgYWlbMF0uYWlfYWRkciwgYWlbMF0u YWlfYWRkcmxlbik7CisgICAgICAgIHdoaWxlIChhaSAhPSBOVUxMKSB7CisgICAgICAgICAgICBy
ZXQgPSBjb25uZWN0X3NvY2tldChhaS0+YWlfZmFtaWx5LCBhaS0+YWlfc29ja3R5cGUsIGFpLT5h aV9wcm90b2NvbCwgYWktPmFpX2FkZHIsIGFpLT5haV9hZGRybGVuKTsKKyAgICAgICAgICAgIGlm IChyZXQgPT0gMCkgeworICAgICAgICAgICAgICAgIGJyZWFrOworICAgICAgICAgICAgfQorICAg
ICAgICAgICAgYWkgPSBhaS0+YWlfbmV4dDsKKyAgICAgICAgfQogICAgIH0gZWxzZSB7CiAgICAg ICAgIHJldCA9IEVGQVVMVDsKICAgICB9Ci0tIAoyLjcuNAoK
</data>

</attachment>

</bug>

</bugzilla>
