<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1431403</bug_id>
          
          <creation_ts>2017-03-11 22:04:00 -0500</creation_ts>
          <short_desc>qemu-system-ppc64  has the wrong path to vgabios-stdvga.bin</short_desc>
          <delta_ts>2017-04-29 21:52:29 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>qemu</component>
          <version>25</version>
          <rep_platform>All</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>245418</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Daniel Black">daniel.subs</reporter>
          <assigned_to name="Fedora Virtualization Maintainers">virt-maint</assigned_to>
          <cc>amitshah</cc>
    
    
    <cc>berrange</cc>
    
    
    <cc>cfergeau</cc>
    
    
    <cc>crobinso</cc>
    
    
    <cc>daniel.subs</cc>
    
    
    <cc>dwmw2</cc>
    
    
    <cc>itamar</cc>
    
    
    <cc>pbonzini</cc>
    
    
    <cc>pwhalen</cc>
    
    
    <cc>rjones</cc>
    
    
    <cc>virt-maint</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>qemu-2.7.1-6.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-04-19 05:25:00</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10230773</commentid>
    <comment_count>0</comment_count>
    <who name="Daniel Black">daniel.subs</who>
    <bug_when>2017-03-11 22:04:23 -0500</bug_when>
    <thetext>Description of problem:

qemu-system-ppc64 has incorrect information about where vgabios-stdvga.bin is installed on Fedora.

Version-Release number of selected component (if applicable):

dnf info qemu-system-ppc
Last metadata expiration check: 19:37:18 ago on Sat Mar 11 18:13:19 2017.
Installed Packages
Name        : qemu-system-ppc
Arch        : x86_64
Epoch       : 2
Version     : 2.7.1
Release     : 2.fc25


How reproducible:

Always

Steps to Reproduce:

1.emu-system-ppc64 -kernel   output/images/vmlinux  -initrd  output/images/rootfs.cpio 

Actual results:

qemu-system-ppc64: Initialization of device VGA failed: failed to find romfile &quot;vgabios-stdvga.bin&quot;


Expected results:

vga screen of kernel starting

Additional info:

locate vgabios-stdvga.bin
/usr/share/seavgabios/vgabios-stdvga.bin

strace -fe trace=file qemu-system-ppc64 -kernel   output/images/vmlinux  -initrd  output/images/rootfs.cpio 

[pid 32236] access(&quot;vgabios-stdvga.bin&quot;, R_OK) = -1 ENOENT (No such file or directory)
[pid 32236] access(&quot;/usr/share/qemu/vgabios-stdvga.bin&quot;, R_OK) = -1 ENOENT (No such file or directory)
[pid 32236] access(&quot;/usr/share/qemu/vgabios-stdvga.bin&quot;, R_OK) = -1 ENOENT (No such file or directory)
[pid 32236] open(&quot;vgabios-stdvga.bin&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)
qemu-system-ppc64: Initialization of device VGA failed: failed to find romfile &quot;vgabios-stdvga.bin&quot;
qemu-system-ppc64: Initialization of device VGA failed: failed to find romfile &quot;vgabios-stdvga.bin&quot;
[pid 32238] +++ exited with 1 +++
[pid 32237] +++ exited with 1 +++
+++ exited with 1 +++

Workaround:

Changing to the /usr/share/seavgabios does load as the cwd is checked</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10233323</commentid>
    <comment_count>1</comment_count>
    <who name="Cole Robinson">crobinso</who>
    <bug_when>2017-03-13 10:31:12 -0400</bug_when>
    <thetext>Thanks for the report. If you install qemu-system-x86, do things start working?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10247291</commentid>
    <comment_count>2</comment_count>
    <who name="Cole Robinson">crobinso</who>
    <bug_when>2017-03-16 15:33:30 -0400</bug_when>
    <thetext>ppc64 emulation tries to load the x86 roms, so we need to move them from qemu-system-x86 to qemu-common. Moving to POST since this is just a packaging change</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10251971</commentid>
    <comment_count>3</comment_count>
    <who name="Daniel Black">daniel.subs</who>
    <bug_when>2017-03-18 22:27:43 -0400</bug_when>
    <thetext>yes, installing qemu-system-x86 got past the errors associated with missing bios.

Seems as though this just installs a symlink.

$ ls -la  /usr/share/seavgabios/vgabios-stdvga.bin /usr/share/qemu/vgabios-stdvga.bin
lrwxrwxrwx 1 root root    32 Jan 17 08:17 /usr/share/qemu/vgabios-stdvga.bin -&gt; ../seavgabios/vgabios-stdvga.bin
-rw-r--r-- 1 root root 39424 Aug  4  2016 /usr/share/seavgabios/vgabios-stdvga.bin</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10307909</commentid>
    <comment_count>4</comment_count>
    <who name="Paul Whalen">pwhalen</who>
    <bug_when>2017-04-05 14:34:38 -0400</bug_when>
    <thetext>This also affects guests on aarch64.

virt-install          --name Fedora_25_AArch64 --ram 4096 --arch aarch64       --disk size=8 --os-variant fedora22         --location https://dl.fedoraproject.org/pub/fedora-secondary/releases/25/Everything/aarch64/os/

Starting install...
Retrieving file vmlinuz...                                                                                                                                                                                            |  14 MB  00:00:07 !!! 
Retrieving file initrd.img...                                                                                                                                                                                         |  39 MB  00:00:04     
Allocating &apos;Fedora_25_AArch64.qcow2&apos;                                                                                                                                                                                  | 8.0 GB  00:00:00     
ERROR    internal error: process exited while connecting to monitor: 2017-04-05T18:12:38.106682Z qemu-system-aarch64: -serial pty: char device redirected to /dev/pts/1 (label serial0)
2017-04-05T18:12:38.235242Z qemu-system-aarch64: -device virtio-net-pci,host_mtu=1500,netdev=hostnet0,id=net0,mac=52:54:00:7e:98:8d,bus=pci.1,addr=0x0: failed to find romfile &quot;efi-virtio.rom&quot;
Domain installation does not appear to have been successful.

After installing qemu-system-x86, the guest booted as expected.

Version:
qemu-system-aarch64-2.9.0-0.1.rc2.fc26.aarch64</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10336742</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-15 14:24:18 -0400</bug_when>
    <thetext>qemu-2.7.1-6.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-01925dba3c</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10337219</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-16 17:23:42 -0400</bug_when>
    <thetext>qemu-2.7.1-6.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-01925dba3c</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10344923</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-19 05:25:00 -0400</bug_when>
    <thetext>qemu-2.7.1-6.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10374688</commentid>
    <comment_count>8</comment_count>
    <who name="Daniel Black">daniel.subs</who>
    <bug_when>2017-04-29 21:52:29 -0400</bug_when>
    <thetext>Thank you Paul and Cole.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>