<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1403908</bug_id>
          
          <creation_ts>2016-12-12 10:41:00 -0500</creation_ts>
          <short_desc>docker pull cannot use registries with authentication</short_desc>
          <delta_ts>2017-01-17 08:52:27 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>docker</component>
          <version>25</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Stefano Cavallari">stefano.cavallari</reporter>
          <assigned_to name="Antonio Murdaca">amurdaca</assigned_to>
          <cc>adimania</cc>
    
    
    <cc>admiller</cc>
    
    
    <cc>amurdaca</cc>
    
    
    <cc>dwalsh</cc>
    
    
    <cc>ichavero</cc>
    
    
    <cc>jcajka</cc>
    
    
    <cc>jchaloup</cc>
    
    
    <cc>lsm5</cc>
    
    
    <cc>marianne</cc>
    
    
    <cc>mark</cc>
    
    
    <cc>matt</cc>
    
    
    <cc>miminar</cc>
    
    
    <cc>nalin</cc>
    
    
    <cc>riek</cc>
    
    
    <cc>scot</cc>
    
    
    <cc>vbatts</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>docker-1.12.5-3.git079fbe3.fc25</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2016-12-31 01:49:51</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9977375</commentid>
    <comment_count>0</comment_count>
    <who name="Stefano Cavallari">stefano.cavallari</who>
    <bug_when>2016-12-12 10:41:43 -0500</bug_when>
    <thetext>Description of problem:

&quot;docker pull&quot; cannot use registries with authentication, it always fails.

Version-Release number of selected component (if applicable):
docker-2:1.12.3-12.git97974ae.fc25

How reproducible:
always

Steps to Reproduce:
1. docker login [some registry which requires authentication] 
this succeeds (Login successful)
2. docker pull [some image in the registry]

Actual results:
unauthorized: The client does not have permission for manifest

Expected results:
docker fetches images successfully

Additional info:
Both a hosted registry (using Artifactory) and Google Container Registry did not work with Fedora docker package, but worked when using testing packages from 
http://yum.dockerproject.org/repo/testing/fedora/25/
(see https://docs.docker.com/engine/installation/linux/fedora/ )</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9977513</commentid>
    <comment_count>1</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2016-12-12 11:13:45 -0500</bug_when>
    <thetext>Do you have a registry on GCR or an Artifactory already an up and running I can test Docker against? I need a registry I can reproduce this against and so far I&apos;m not able to reproduce it. 
Also, please update your Docker package from Fedora official updates-testing and re-test this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9977776</commentid>
    <comment_count>2</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2016-12-12 12:16:21 -0500</bug_when>
    <thetext>Another thing to test would be to test if GCR and Artifactory work w/o authentication. I fear it&apos;s not fully related to authentication.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9989117</commentid>
    <comment_count>3</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2016-12-15 05:12:29 -0500</bug_when>
    <thetext>GCR works fine:

$ docker push gcr.io/oceanic-granite-152609/busyboxtestThe push refers to a repository [gcr.io/oceanic-granite-152609/busyboxtest]
e88b3f82283b: Pushed
latest: digest: sha256:1ded4559e2aab2ab3464aae5170ef64afc15bea324a0861b543e2c56a3f29711 size: 527

$ docker push gcr.io/oceanic-granite-152609/alpine  
The push refers to a repository [gcr.io/oceanic-granite-152609/alpine]
011b303988d2: Pushed
latest: digest: sha256:1b6c543cc889c8f5f8d7061ddd3941b04568f725960e95896a2fbc06311fa4c0 size: 528


did you login correctly to GCR? `gcloud auth login` and `docker login -e 1234@5678.com -u oauth2accesstoken -p &quot;$(gcloud auth print-access-token)&quot; https://gcr.io`? Are you sure you&apos;re not using the wrong project-id to push the image?

Can&apos;t say anything about Artifactory though. I don&apos;t have any test registry to try with, if you can provide one I&apos;ll test it out.

For now, this issue is either fixed in latest docker-1.12.x in F25 or you did something wrong.

Closing, feel free to comment if you have a test registry for Artifactory, I would be happy to test.

$ rpm -qa | grep docker
docker-1.12.4-2.git1b5971a.fc25.x86_64
docker-novolume-plugin-1.12.4-2.git1b5971a.fc25.x86_64
docker-common-1.12.4-2.git1b5971a.fc25.x86_64
python3-docker-py-1.10.6-1.fc25.noarch
python2-dockerfile-parse-0.0.5-7.fc25.noarch
python-docker-py-1.10.6-1.fc25.noarch
python2-docker-pycreds-0.2.1-2.fc25.noarch
python3-docker-pycreds-0.2.1-2.fc25.noarch
docker-v1.10-migrator-1.12.4-2.git1b5971a.fc25.x86_64</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10012977</commentid>
    <comment_count>4</comment_count>
    <who name="Scot Loach">scot</who>
    <bug_when>2016-12-21 22:25:20 -0500</bug_when>
    <thetext>I am having a similar problem pulling images from a google cloud registry after upgrading to Fedora 25.

I get the following result:
Trying to pull repository gcr.io/&lt;repo&gt;/&lt;image&gt; ... 
unauthorized: Permission denied for &quot;latest&quot; from request &quot;/v2/&lt;repo&gt;/&lt;image&gt;/manifests/latest&quot;. 


Versions:

Client:
 Version:         1.12.5
 API version:     1.24
 Package version: docker-common-1.12.5-1.git6009905.fc25.x86_64
 Go version:      go1.7.4
 Git commit:      6009905/1.12.5
 Built:           Fri Dec 16 09:26:10 2016
 OS/Arch:         linux/amd64

Server:
 Version:         1.12.5
 API version:     1.24
 Package version: docker-common-1.12.5-1.git6009905.fc25.x86_64
 Go version:      go1.7.4
 Git commit:      6009905/1.12.5
 Built:           Fri Dec 16 09:26:10 2016
 OS/Arch:         linux/amd64



This worked fine before the upgrade.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10016034</commentid>
    <comment_count>5</comment_count>
    <who name="matt@cobe.io">matt</who>
    <bug_when>2016-12-22 08:15:00 -0500</bug_when>
    <thetext>I&apos;d just like to add my experience to this.

As above, but I wanted to emphasize that only PULLING fails; I can push images fine to GCR. I&apos;ve been through and set up gcloud and docker on a new Ubuntu and Fedora VM; and Ubuntu works fine, Fedora fails.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10016047</commentid>
    <comment_count>6</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2016-12-22 08:21:08 -0500</bug_when>
    <thetext>can you all please describe step by step how to reproduce this? Otherwise, none of us can be able to understand and reproduce your issue.

I&apos;ve been testing this with a GCR registry and everything worked fine for me with the latest docker release. So, either you made some mistakes setting up GCR authentication or there&apos;s a bug. But I can&apos;t find it if I cannot reproduce and stating that &quot;it&apos;s not working&quot; doesn&apos;t help either :)

So please, post a step by step repdoducer</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10016115</commentid>
    <comment_count>7</comment_count>
    <who name="matt@cobe.io">matt</who>
    <bug_when>2016-12-22 08:42:53 -0500</bug_when>
    <thetext>Sorry, I&apos;m afraid there&apos;s nothing more to reproduce than as you&apos;ve said (except pulling, not pushing).

The `gcloud auth login` and `docker login -u ...` steps work fine for me; and pushing images works fine.

If I do figure anything more out I&apos;ll update you.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10016133</commentid>
    <comment_count>8</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2016-12-22 08:48:26 -0500</bug_when>
    <thetext>(In reply to matt@cobe.io from comment #7)
&gt; Sorry, I&apos;m afraid there&apos;s nothing more to reproduce than as you&apos;ve said
&gt; (except pulling, not pushing).
&gt; 
&gt; The `gcloud auth login` and `docker login -u ...` steps work fine for me;
&gt; and pushing images works fine.
&gt; 
&gt; If I do figure anything more out I&apos;ll update you.

Does it happen for you _all the time_? can you check if it&apos;s a V1 docker images on GCR? or it&apos;s a V2.

Last thing, if you can _consistently_ reproduce this against your GCR repo, please add &quot;--signature-verification=false&quot; to $OPTIONS in /etc/sysconfig/docker, restart the daemon, try again to pull, and let me know what happens.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10016158</commentid>
    <comment_count>9</comment_count>
    <who name="Scot Loach">scot</who>
    <bug_when>2016-12-22 08:52:31 -0500</bug_when>
    <thetext>Happens all the time for me and for a colleague who also upgraded to 25.
Pushing works fine, pulling never works.

Make sure you are using a private gcr repo.

I believe it&apos;s a v2 but not exactly sure how to tell.

I tried your new option and that seems to have worked around the problem for me, I am now able to pull from the repo.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10016170</commentid>
    <comment_count>10</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2016-12-22 08:55:57 -0500</bug_when>
    <thetext>(In reply to Scot Loach from comment #9)
&gt; Happens all the time for me and for a colleague who also upgraded to 25.
&gt; Pushing works fine, pulling never works.
&gt; 
&gt; Make sure you are using a private gcr repo.
&gt; 
&gt; I believe it&apos;s a v2 but not exactly sure how to tell.
&gt; 
&gt; I tried your new option and that seems to have worked around the problem for
&gt; me, I am now able to pull from the repo.

Great, now, I need to know more about your registries on GCR because if I setup a brand new GCR registry, I cannot reproduce and understand the issue. I _may_ know what is causing this (hence that option to the docker daemon) but to fully fix it I need to know more about the GCR setup. Could either of you provide a shell on a system I can test this?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10016293</commentid>
    <comment_count>11</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2016-12-22 09:51:47 -0500</bug_when>
    <thetext>Found the bug, going to rebuild docker in F25, stay tuned.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10016298</commentid>
    <comment_count>12</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2016-12-22 09:54:38 -0500</bug_when>
    <thetext>For the record, the fix is here https://github.com/containers/image/pull/191</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10016405</commentid>
    <comment_count>13</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-22 10:33:45 -0500</bug_when>
    <thetext>docker-1.12.5-2.gite330732.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2016-d2249ce42f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10016580</commentid>
    <comment_count>14</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-22 11:43:42 -0500</bug_when>
    <thetext>docker-1.12.5-3.git079fbe3.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2016-2f28826f76</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10018578</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-23 09:52:53 -0500</bug_when>
    <thetext>docker-1.12.5-3.git079fbe3.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2016-2f28826f76</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10025489</commentid>
    <comment_count>16</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2016-12-31 01:49:51 -0500</bug_when>
    <thetext>docker-1.12.5-3.git079fbe3.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10071062</commentid>
    <comment_count>17</comment_count>
    <who name="Mark Mielke">mark</who>
    <bug_when>2017-01-17 07:31:57 -0500</bug_when>
    <thetext>I hit this problem with Fedora 25 as well. It did not happen in Fedora 24, and it does not happen on any of our RHEL 7 machines. I came to the conclusion that it was related to Docker 1.12 as I have seen it work on many versions of Docker include 1.8, 1.9, 1.10, and I believe 1.11. The Fedora 24 is using 1.10.3-55 and working. The RHEL 7 machines are mostly 1.10.3, or 1.9.1.

The machine that is giving me trouble is the Fedora 25 clients running 1.12.5 and now 1.12.6-4.gitf499e8b.fc25.x86_64. The symptom is that a &quot;docker pull&quot; against a private Artifactory repository results in this output:

unauthorized: The client does not have permission for manifest

On the server-side (Nginx as transparent reverse proxy), the problem scenario looks like this:

10.179.128.15 - - [17/Jan/2017:07:12:52 -0500] &quot;GET /v2/ HTTP/1.1&quot; 401 77 &quot;-&quot; &quot;docker/1.12.6 go/go1.7.4 kernel/4.9.3-200.fc25.x86_64 os/linux arch/amd64 UpstreamClient(Docker-Client/1.12.6 \x5C(linux\x5C))&quot;
10.179.128.15 - - [17/Jan/2017:07:12:52 -0500] &quot;GET /v2/ HTTP/1.1&quot; 401 77 &quot;-&quot; &quot;docker/1.12.6 go/go1.7.4 kernel/4.9.3-200.fc25.x86_64 os/linux arch/amd64 UpstreamClient(Docker-Client/1.12.6 \x5C(linux\x5C))&quot;
10.179.128.15 - - [17/Jan/2017:07:12:52 -0500] &quot;GET /v2/nginx/manifests/nginx-1.11.8-20161229 HTTP/1.1&quot; 403 169 &quot;-&quot; &quot;docker/1.12.6 go/go1.7.4 kernel/4.9.3-200.fc25.x86_64 os/linux arch/amd64 UpstreamClient(Docker-Client/1.12.6 \x5C(linux\x5C))&quot;
10.179.128.15 - - [17/Jan/2017:07:12:52 -0500] &quot;GET /v2/nginx/manifests/nginx-1.11.8-20161229 HTTP/1.1&quot; 403 169 &quot;-&quot; &quot;docker/1.12.6 go/go1.7.4 kernel/4.9.3-200.fc25.x86_64 os/linux arch/amd64 UpstreamClient(Docker-Client/1.12.6 \x5C(linux\x5C))&quot;


The server-side for a working scenario, with Fedora 24 in this cas,e looks like:

10.179.128.11 - - [17/Jan/2017:07:20:35 -0500] &quot;GET /v2/ HTTP/1.1&quot; 401 77 &quot;-&quot; &quot;docker/1.10.3 go/go1.6.3 kernel/4.8.16-200.fc24.x86_64 os/linux arch/amd64&quot;
10.179.128.11 - mmielke [17/Jan/2017:07:20:36 -0500] &quot;GET /v2/token?account=&lt;snip&gt;&amp;scope=&lt;snip&gt; HTTP/1.1&quot; 200 102 &quot;-&quot; &quot;docker/1.10.3 go/go1.6.3 kernel/4.8.16-200.fc24.x86_64 os/linux arch/amd64&quot;
10.179.128.11 - - [17/Jan/2017:07:20:36 -0500] &quot;GET /v2/nginx/manifests/nginx-1.11.8-20161229 HTTP/1.1&quot; 200 1138 &quot;-&quot; &quot;docker/1.10.3 go/go1.6.3 kernel/4.8.16-200.fc24.x86_64 os/linux arch/amd64&quot;
10.179.128.11 - - [17/Jan/2017:07:20:36 -0500] &quot;GET /v2/nginx/blobs/sha256:bfff7d7419abb257acbe1971a4614c8ea6a0103e328570c2ed0ca460c0346861 HTTP/1.1&quot; 200 7544 &quot;-&quot; &quot;docker/1.10.3 go/go1.6.3 kernel/4.8.16-200.fc24.x86_64 os/linux arch/amd64&quot;
10.179.128.11 - - [17/Jan/2017:07:20:36 -0500] &quot;GET /v2/nginx/blobs/sha256:21b0401f7da7f362458bf1c30d6096d49c9c11bf267a8dce9266e2e24aa0baec HTTP/1.1&quot; 200 41174332 &quot;-&quot; &quot;docker/1.10.3 go/go1.6.3 kernel/4.8.16-200.fc24.x86_64 os/linux arch/amd64&quot;

The main difference appears to be that in the &quot;working&quot; case, it handles the first /v2/ ping result of HTTP 401 with an attempt to fetch a token and login as me (= mmielke). Once it has this token, it must present it for future requests and these then succeed with HTTP 200 and all is well.

In the problem case, it seems to retrying the /v2/ without basic auth credentials and getting the same HTTP 401 result. It then proceeds to fetch the manifests file and failures with HTTP 403 because without credentials, Artifactory is not going to share the manifests file or the image layers.

I remember it briefly working for a window - but I believe the window may be related to &quot;docker login&quot;, and it may be timing related. I remember coming to the conclusion that the Docker daemon might persist the connection after &quot;docker login&quot; and pass the same cookies through again which might have allowed it to work briefly but not stay working.

I presumed this must be a wider problem affecting other people, so I moved onto another problem hoping it would be gone when I came back to this. Unfortunately, it is not gone, and this lead me to this issue.

I think the problem is not fixed. Does anybody else have results for or against here?

Is there anything particular I can check to help diagnose the issue? Unfortunately, our Artifactory Enterprise instance is behind a firewall, so I cannot just let you try it out yourself...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10071484</commentid>
    <comment_count>18</comment_count>
    <who name="Mark Mielke">mark</who>
    <bug_when>2017-01-17 08:14:12 -0500</bug_when>
    <thetext>Some more detailed logging, showing &quot;Authorization:&quot; and &quot;WWW-Authenticate:&quot;...

Fedora 25 / Docker 1.12.6-4:

10.179.128.4 - - [17/Jan/2017:08:06:20 -0500] TLSv1.2/ECDHE-RSA-AES128-GCM-SHA256 &quot;Authorization: -&quot; &quot;WWW-Authenticate: Bearer realm=\x22https://prism.ciena.com/v2/token\x22,service=\x22prism.ciena.com\x22,scope=\x22repository:docker-prism.ciena.com-v2-local:pull,push\x22&quot; 0.001s &quot;GET /v2/ HTTP/1.1&quot; 401 512 &quot;-&quot; &quot;docker/1.12.6 go/go1.7.4 kernel/4.9.3-200.fc25.x86_64 os/linux arch/amd64 UpstreamClient(Docker-Client/1.12.6 \x5C(linux\x5C))&quot;
10.179.128.4 - - [17/Jan/2017:08:06:20 -0500] TLSv1.2/ECDHE-RSA-AES128-GCM-SHA256 &quot;Authorization: -&quot; &quot;WWW-Authenticate: Bearer realm=\x22https://prism.ciena.com/v2/token\x22,service=\x22prism.ciena.com\x22,scope=\x22repository:docker-prism.ciena.com-v2-local:pull,push\x22&quot; 0.001s &quot;GET /v2/ HTTP/1.1&quot; 401 512 &quot;-&quot; &quot;docker/1.12.6 go/go1.7.4 kernel/4.9.3-200.fc25.x86_64 os/linux arch/amd64 UpstreamClient(Docker-Client/1.12.6 \x5C(linux\x5C))&quot;
10.179.128.4 - - [17/Jan/2017:08:06:20 -0500] TLSv1.2/ECDHE-RSA-AES128-GCM-SHA256 &quot;Authorization: -&quot; &quot;WWW-Authenticate: -&quot; 0.003s &quot;GET /v2/nginx/manifests/nginx-1.11.8-20161229 HTTP/1.1&quot; 403 483 &quot;-&quot; &quot;docker/1.12.6 go/go1.7.4 kernel/4.9.3-200.fc25.x86_64 os/linux arch/amd64 UpstreamClient(Docker-Client/1.12.6 \x5C(linux\x5C))&quot;
10.179.128.4 - - [17/Jan/2017:08:06:20 -0500] TLSv1.2/ECDHE-RSA-AES128-GCM-SHA256 &quot;Authorization: -&quot; &quot;WWW-Authenticate: -&quot; 0.001s &quot;GET /v2/nginx/manifests/nginx-1.11.8-20161229 HTTP/1.1&quot; 403 483 &quot;-&quot; &quot;docker/1.12.6 go/go1.7.4 kernel/4.9.3-200.fc25.x86_64 os/linux arch/amd64 UpstreamClient(Docker-Client/1.12.6 \x5C(linux\x5C))&quot;

Fedora 24 / Docker 1.10.3-55:

10.179.128.11 - - [17/Jan/2017:08:06:57 -0500] TLSv1.2/ECDHE-RSA-AES128-GCM-SHA256 &quot;Authorization: -&quot; &quot;WWW-Authenticate: Bearer realm=\x22https://prism.ciena.com/v2/token\x22,service=\x22prism.ciena.com\x22,scope=\x22repository:docker-prism.ciena.com-v2-local:pull,push\x22&quot; 0.001s &quot;GET /v2/ HTTP/1.1&quot; 401 512 &quot;-&quot; &quot;docker/1.10.3 go/go1.6.3 kernel/4.8.16-200.fc24.x86_64 os/linux arch/amd64&quot;
10.179.128.11 - mmielke [17/Jan/2017:08:06:59 -0500] TLSv1.2/ECDHE-RSA-AES128-GCM-SHA256 &quot;Authorization: Basic ...base 64 encoded password...&quot; &quot;WWW-Authenticate: -&quot; 1.636s &quot;GET /v2/token?account=mmielke&amp;scope=repository%3Anginx%3Apull&amp;service=prism.ciena.com HTTP/1.1&quot; 200 409 &quot;-&quot; &quot;docker/1.10.3 go/go1.6.3 kernel/4.8.16-200.fc24.x86_64 os/linux arch/amd64&quot;
10.179.128.11 - - [17/Jan/2017:08:06:59 -0500] TLSv1.2/ECDHE-RSA-AES128-GCM-SHA256 &quot;Authorization: Bearer ... base 64 encoded bearer token ...&quot; &quot;WWW-Authenticate: -&quot; 0.012s &quot;GET /v2/nginx/manifests/nginx-1.11.8-20161229 HTTP/1.1&quot; 200 1894 &quot;-&quot; &quot;docker/1.10.3 go/go1.6.3 kernel/4.8.16-200.fc24.x86_64 os/linux arch/amd64&quot;

This clearly shows that Docker 1.10.3-55 is using Basic auth when obtaining the bearer token, while Docker 1.12.6-4 apparently couldn&apos;t be bothered? :-)

Could it be the format of the &quot;WWW-Authenticate&quot; response that is causing Docker to ignore it? Or is this something to do with private repositories that don&apos;t end in &quot;docker.com&quot;?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10071554</commentid>
    <comment_count>19</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2017-01-17 08:21:09 -0500</bug_when>
    <thetext>Mike could you open another BZ with your debug and assign it to me? (amurdaca@redhat.com)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10071580</commentid>
    <comment_count>20</comment_count>
    <who name="Antonio Murdaca">amurdaca</who>
    <bug_when>2017-01-17 08:27:16 -0500</bug_when>
    <thetext>Also, any chance you can test this (now-old) update in your F25 box and tell me if that works? https://bodhi.fedoraproject.org/updates/FEDORA-2016-2f28826f76</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10071686</commentid>
    <comment_count>21</comment_count>
    <who name="Mark Mielke">mark</who>
    <bug_when>2017-01-17 08:52:27 -0500</bug_when>
    <thetext>Ok, Antonio. I opened: 1413987 . I don&apos;t think I have &quot;assign&quot; privileges, so you will have to do this yourself.

I will see if I can check the update and report results on the new issue.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>