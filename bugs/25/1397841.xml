<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1397841</bug_id>
          
          <creation_ts>2016-11-23 07:49:00 -0500</creation_ts>
          <short_desc>System experiences disk errors and doesn&apos;t boot only on 4.8 kernels</short_desc>
          <delta_ts>2017-01-17 10:14:34 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>kernel</component>
          <version>25</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>CURRENTRELEASE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>medium</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1392850</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Kieran Gillibrand">Kieran.Gillibrand6</reporter>
          <assigned_to name="Kernel Maintainer List">kernel-maint</assigned_to>
          <cc>akohlmey</cc>
    
    
    <cc>gansalmon</cc>
    
    
    <cc>ichavero</cc>
    
    
    <cc>itamar</cc>
    
    
    <cc>jkastner</cc>
    
    
    <cc>jonathan</cc>
    
    
    <cc>kernel-maint</cc>
    
    
    <cc>Kieran.Gillibrand6</cc>
    
    
    <cc>labbott</cc>
    
    
    <cc>madhu.chinakonda</cc>
    
    
    <cc>mchehab</cc>
    
    
    <cc>ricardoalonsos</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>4.9.0-0.rc7.git3.2.fc26.x86_64</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-01-17 10:14:34</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9916083</commentid>
    <comment_count>0</comment_count>
    <who name="Kieran Gillibrand">Kieran.Gillibrand6</who>
    <bug_when>2016-11-23 07:49:43 -0500</bug_when>
    <thetext>Description of problem:

My system experiences disk errors and fails to boot only with 4.8 kernels.

Earlier kernels (4.7.9 and 4.7.10) work normally.

My disk is encrypted with LUKS (it was encrypted by the Fedora installer and has been working for months).

I&apos;ve run smartctl and the gnome-disks health check, they both report nothing wrong with my disk.

I have an Ask Fedora post here with pictures of error messages that may help: https://ask.fedoraproject.org/en/question/96616/systemd-disk-errors-booting-fails-with-certain-kernels/

Version-Release number of selected component (if applicable):

4.8.8-300.fc25.x86_64
4.8.6-201.fc24.x86_64
4.8.4-200.fc24.x86_64

How reproducible:

Might depend on specific circumstances so I&apos;m not sure. 
Probably fairly obscure though

Steps to Reproduce:
1. Boot a system with an encrypted LUKS disk, enter your passkey
2. Let the boot process continue
3. It will freeze when Journald tries to flush it&apos;s logfiles to the disk.
Start jobs on the disk partitions will begin and never finish.

Actual results:

The boot process freezes with start jobs that never finish after showing Ext4 errors.

Expected results:

The system boots normally

Additional info:

The system begins to boot fine and stops when it tries to write logfiles so it seems like the filesystem is read only.
As I mentioned this only happens with 4.8 kernels so I&apos;m guessing that&apos;s where the issue lies.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9918404</commentid>
    <comment_count>1</comment_count>
    <who name="Kieran Gillibrand">Kieran.Gillibrand6</who>
    <bug_when>2016-11-24 00:04:27 -0500</bug_when>
    <thetext>Just to add booting a Fedora 25 x86_64 Live USB doesn&apos;t work on this system either, if it&apos;s the same problem I don&apos;t think it&apos;s disk related at this point.

Booting in regular or basic graphics mode doesn&apos;t work and the USB passes the disk test.

In both basic and regular graphics mode the boot process passes the Systemd boot screen with no errors then hits a blank screen. At this point it freezes for 10-20 seconds and some errors show up. After the errors it freezes for good.

The error messages I get: http://imgur.com/a/EgrIk

Both modes have the same 3 messages before the boot freezes. The regular graphics mode just shows 3 more beforehand.

This might be some sort of issue between the kernel and my hardware but I&apos;m not sure. I&apos;ll just list what this laptop is running, I&apos;ve never required any extra drivers for it, just what&apos;s included in the kernel. I&apos;ll see about tracking down an F24 live ISO so that I can narrow it down to a kernel version.

Sony Vaio Pro 13
I7-4500u
Samsung PCI-E SSD
8 GB DDR3
Intel HD Graphics 4400
Intel Wireless and Bluetooth</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9918411</commentid>
    <comment_count>2</comment_count>
    <who name="Kieran Gillibrand">Kieran.Gillibrand6</who>
    <bug_when>2016-11-24 00:21:07 -0500</bug_when>
    <thetext>Just confirmed that an F24 USB boots normally. I don&apos;t know exactly which kernel version the F25 USB is running since it&apos;s not listed in the Grub parameters but I&apos;d expect it to be a 4.8 kernel.

4.5.5-300.fc24.x86_64 is running on the F24 USB and it runs fine so this still seems to be a 4.8 kernel issue for me.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9953443</commentid>
    <comment_count>3</comment_count>
    <who name="Axel Kohlmeyer">akohlmey</who>
    <bug_when>2016-12-03 09:28:53 -0500</bug_when>
    <thetext>I am seeing the exact same behavior on my laptop, too. The laptop is also a Sony Vaio Pro 13 with the exact same specs. Any 4.8.x kernels have failed to boot. Since i don&apos;t have an encrypted file system, some of the error output is different, but the very first indication of a problem is the exact same as shown at https://i.imgur.com/8FBHtPN.jpg

Kernel 4.7.9-200.fc24.x86_64 boots fine and the SSD passes the SMART test as shown below:

[root@zero ~]# smartctl --all /dev/sda
smartctl 6.5 2016-05-07 r4318 [x86_64-linux-4.7.9-200.fc24.x86_64] (local build)
Copyright (C) 2002-16, Bruce Allen, Christian Franke, www.smartmontools.org

=== START OF INFORMATION SECTION ===
Device Model:     SAMSUNG MZHPU256HCGL-00000
Serial Number:    S1ADNYAD701029
LU WWN Device Id: 5 002538 600012438
Firmware Version: UXM6401Q
User Capacity:    256,060,514,304 bytes [256 GB]
Sector Size:      512 bytes logical/physical
Rotation Rate:    Solid State Device
Device is:        Not in smartctl database [for details use: -P showall]
ATA Version is:   ACS-2, ATA8-ACS T13/1699-D revision 4c
SATA Version is:  SATA 3.0, 6.0 Gb/s (current: 6.0 Gb/s)
Local Time is:    Sat Dec  3 09:27:56 2016 EST
SMART support is: Available - device has SMART capability.
SMART support is: Enabled

=== START OF READ SMART DATA SECTION ===
SMART overall-health self-assessment test result: PASSED

General SMART Values:
Offline data collection status:  (0x00)	Offline data collection activity
					was never started.
					Auto Offline Data Collection: Disabled.
Self-test execution status:      (   0)	The previous self-test routine completed
					without error or no self-test has ever 
					been run.
Total time to complete Offline 
data collection: 		(    0) seconds.
Offline data collection
capabilities: 			 (0x5f) SMART execute Offline immediate.
					Auto Offline data collection on/off support.
					Abort Offline collection upon new
					command.
					Offline surface scan supported.
					Self-test supported.
					No Conveyance Self-test supported.
					Selective Self-test supported.
SMART capabilities:            (0x0003)	Saves SMART data before entering
					power-saving mode.
					Supports SMART auto save timer.
Error logging capability:        (0x01)	Error logging supported.
					General Purpose Logging supported.
Short self-test routine 
recommended polling time: 	 (   2) minutes.
Extended self-test routine
recommended polling time: 	 (  10) minutes.
SCT capabilities: 	       (0x003d)	SCT Status supported.
					SCT Error Recovery Control supported.
					SCT Feature Control supported.
					SCT Data Table supported.

SMART Attributes Data Structure revision number: 1
Vendor Specific SMART Attributes with Thresholds:
ID# ATTRIBUTE_NAME          FLAG     VALUE WORST THRESH TYPE      UPDATED  WHEN_FAILED RAW_VALUE
  9 Power_On_Hours          0x0032   098   098   000    Old_age   Always       -       9575
 12 Power_Cycle_Count       0x0032   094   094   000    Old_age   Always       -       5375
177 Wear_Leveling_Count     0x0013   096   096   017    Pre-fail  Always       -       312
178 Used_Rsvd_Blk_Cnt_Chip  0x0013   090   090   010    Pre-fail  Always       -       251
179 Used_Rsvd_Blk_Cnt_Tot   0x0013   091   091   010    Pre-fail  Always       -       471
180 Unused_Rsvd_Blk_Cnt_Tot 0x0013   091   091   010    Pre-fail  Always       -       4777
183 Runtime_Bad_Block       0x0013   100   100   010    Pre-fail  Always       -       0

SMART Error Log Version: 1
No Errors Logged

SMART Self-test log structure revision number 1
Num  Test_Description    Status                  Remaining  LifeTime(hours)  LBA_of_first_error
# 1  Extended offline    Completed without error       00%         0         -
# 2  Short offline       Completed without error       00%         0         -

SMART Selective self-test log data structure revision number 1
 SPAN  MIN_LBA  MAX_LBA  CURRENT_TEST_STATUS
    1        0        0  Not_testing
    2        0        0  Not_testing
    3        0        0  Not_testing
    4        0        0  Not_testing
    5        0        0  Not_testing
Selective self-test flags (0x0):
  After scanning selected spans, do NOT read-scan remainder of disk.
If Selective self-test is pending on power-up, resume after 0 minute delay.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9953838</commentid>
    <comment_count>4</comment_count>
    <who name="Axel Kohlmeyer">akohlmey</who>
    <bug_when>2016-12-03 20:14:20 -0500</bug_when>
    <thetext>The issue seems to be resolved in the rawhide kernel 4.9.0-0.rc7.git3.2.fc26.x86_64 which boots again without giving disk problems.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9953984</commentid>
    <comment_count>5</comment_count>
    <who name="Kieran Gillibrand">Kieran.Gillibrand6</who>
    <bug_when>2016-12-04 00:15:57 -0500</bug_when>
    <thetext>That kernel fixes it for me as well, thanks for the tip</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10068742</commentid>
    <comment_count>6</comment_count>
    <who name="Laura Abbott">labbott</who>
    <bug_when>2017-01-16 20:19:38 -0500</bug_when>
    <thetext>*********** MASS BUG UPDATE **************
We apologize for the inconvenience.  There is a large number of bugs to go through and several of them have gone stale.  Due to this, we are doing a mass bug update across all of the Fedora 25 kernel bugs.
 
Fedora 25 has now been rebased to 4.9.3-200.fc25.  Please test this kernel update (or newer) and let us know if you issue has been resolved or if it is still present with the newer kernel.
 
If you have moved on to Fedora 26, and are still experiencing this issue, please change the version to Fedora 26.
 
If you experience different issues, please open a new bug report for those.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10068927</commentid>
    <comment_count>7</comment_count>
    <who name="Kieran Gillibrand">Kieran.Gillibrand6</who>
    <bug_when>2017-01-16 21:48:37 -0500</bug_when>
    <thetext>I can confirm that the problem is fixed on my system. I&apos;m actually on 4.9.2-200.fc25 which was the point where things started working without using the rawhide kernel.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10072144</commentid>
    <comment_count>8</comment_count>
    <who name="Laura Abbott">labbott</who>
    <bug_when>2017-01-17 10:14:34 -0500</bug_when>
    <thetext>Thank you for letting us know.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>