<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1110780</bug_id>
          
          <creation_ts>2014-06-18 08:40:00 -0400</creation_ts>
          <short_desc>dnf swap not supported</short_desc>
          <delta_ts>2017-02-10 11:04:30 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>dnf</component>
          <version>25</version>
          <rep_platform>All</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened, Triaged</keywords>
          <priority>low</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Heiko Adams">bugzilla</reporter>
          <assigned_to name="Jaroslav Mracek">jmracek</assigned_to>
          <cc>aliakc</cc>
    
    
    <cc>bugzilla</cc>
    
    
    <cc>hhorak</cc>
    
    
    <cc>jzeleny</cc>
    
    
    <cc>kdudka</cc>
    
    
    <cc>mattdm</cc>
    
    
    <cc>metherid</cc>
    
    
    <cc>mkolman</cc>
    
    
    <cc>mluscon</cc>
    
    
    <cc>packaging-team-maint</cc>
    
    
    <cc>pbrobinson</cc>
    
    
    <cc>pnemade</cc>
    
    
    <cc>praiskup</cc>
    
    
    <cc>rholy</cc>
    
    
    <cc>robatino</cc>
    
    
    <cc>samuel-rhbugs</cc>
    
    
    <cc>tla</cc>
    
    
    <cc>vondruch</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>dnf-0.6.3-2.fc21</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-02-10 11:04:30</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>7214654</commentid>
    <comment_count>0</comment_count>
    <who name="Heiko Adams">bugzilla</who>
    <bug_when>2014-06-18 08:40:18 -0400</bug_when>
    <thetext>yum has a very usefull swap command which allowes replacing a package by another package with one single command. This command is currently not supported by yum.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7215335</commentid>
    <comment_count>1</comment_count>
    <who name="Radek Holy">rholy</who>
    <bug_when>2014-06-18 11:04:35 -0400</bug_when>
    <thetext>Hello, thank you for the report. See this blog post: http://dnf.baseurl.org/2014/06/06/vote-for-yum-features-that-you-miss-in-dnf/

Please also note that there is an &apos;--allowerasing&apos; switch (see http://dnf.readthedocs.org/en/latest/cli_vs_yum.html#packages-replacement-without-yum-shell). The more (real) (detailed) use cases not covered by this switch you provide the better for you.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7216090</commentid>
    <comment_count>2</comment_count>
    <who name="Heiko Adams">bugzilla</who>
    <bug_when>2014-06-18 14:47:35 -0400</bug_when>
    <thetext>No, I&apos;m afraid you missunderstood me. The swap command allows to remove a package and install another package in one transaction. You could say its a shortcut for
  yum remove x &amp;&amp; yum install y</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7217568</commentid>
    <comment_count>3</comment_count>
    <who name="Radek Holy">rholy</who>
    <bug_when>2014-06-19 02:37:13 -0400</bug_when>
    <thetext>Oh, yes, sure, sorry. OK, we&apos;ll see.

I kind of don&apos;t like that you can just remove something and install something in one transaction. What about other operations? But then it would be more like &apos;yum shell&apos; (but in the form like &apos;python -c &quot;cmd1;cmd2&quot;&apos;). So personally I don&apos;t like this command as I can&apos;t see the reason/use-case why this pair of operations has the privilege to be a standalone command. But that&apos;s just my opinion.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7217676</commentid>
    <comment_count>4</comment_count>
    <who name="Jan Zeleny">jzeleny</who>
    <bug_when>2014-06-19 03:27:39 -0400</bug_when>
    <thetext>There are some situations where this is used. Most recently this command has been used to switch between fake and real systemd in Docker base images. However I was assured by Ales that the same thing is doable by dnf as it is, even though it&apos;s not called swap.

Heiko, could you please specify concrete reproducible situation where the --allowerasing switch doesn&apos;t work as you would expect? That&apos;s what the team needs to see. The point is not to implement something we thing users want but rather to address concrete problems. I&apos;m afraid this will eventually get closed if there is no concrete and reproducible use case. Thanks</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7217687</commentid>
    <comment_count>5</comment_count>
    <who name="Radek Holy">rholy</who>
    <bug_when>2014-06-19 03:31:28 -0400</bug_when>
    <thetext>The swap command can be used also for two non-conflicting packages. That&apos;s the point I missed too.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7373264</commentid>
    <comment_count>6</comment_count>
    <who name="Jan Zeleny">jzeleny</who>
    <bug_when>2014-08-11 06:59:06 -0400</bug_when>
    <thetext>*** Bug 1128358 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7373447</commentid>
    <comment_count>7</comment_count>
    <who name="Ales Kozumplik">akozumpl</who>
    <bug_when>2014-08-11 07:39:29 -0400</bug_when>
    <thetext>Putting into needinfo per comment 4.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7383988</commentid>
    <comment_count>8</comment_count>
    <who name="Ales Kozumplik">akozumpl</who>
    <bug_when>2014-08-14 03:16:09 -0400</bug_when>
    <thetext>Possibly a dupe of bug 963137.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7432479</commentid>
    <comment_count>9</comment_count>
    <who name="Vít Ondruch">vondruch</who>
    <bug_when>2014-08-29 19:16:36 -0400</bug_when>
    <thetext>I am afraid that without this functionality, there is not possible to replace YUM by dnf-yum package:

$ sudo dnf install dnf-yum
Chyba: package dnf-yum-0.6.1-1.fc22.noarch conflicts with yum provided by yum-3.4.3-153.fc22.noarch


There is neither not supported &quot;dnf shell&quot;, which would probably allow that.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7432480</commentid>
    <comment_count>10</comment_count>
    <who name="Vít Ondruch">vondruch</who>
    <bug_when>2014-08-29 19:19:34 -0400</bug_when>
    <thetext>Actually, the --allowerasing could probably achieve that, but it seems that prior that, mock and other packages should replace dependency on yum package by dependency on yum executable (if that is enough).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7440900</commentid>
    <comment_count>11</comment_count>
    <who name="Heiko Adams">bugzilla</who>
    <bug_when>2014-09-02 16:22:21 -0400</bug_when>
    <thetext>Jan, the last situation I can remember I used yum&apos;s swap command was replacing hexachat by polari. 

Or in general: the swap command is useful if you want to replace a package with another package providing a similar function but with no dependencies to package to be replaced.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7498588</commentid>
    <comment_count>12</comment_count>
    <who name="Ales Kozumplik">akozumpl</who>
    <bug_when>2014-09-19 05:33:35 -0400</bug_when>
    <thetext>I still don&apos;t see it:

If we want to swap package A for package B where the two don&apos;t conflict:

dnf install B &amp;&amp; dnf erase A

That&apos;s what I believe exactly matches case described in comment 11.

If we want to swap package A for package B where B conflicts with A:

dnf --allowerasing install B

Reporter, can you provide a valid case, preferably with solver debug data [1], where one of the above operations don&apos;t suffice? Thanks!

[1] http://dnf.baseurl.org/2013/11/25/reporting-depsolving-bugs/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7513530</commentid>
    <comment_count>13</comment_count>
    <who name="Honza Horak">hhorak</who>
    <bug_when>2014-09-24 04:06:44 -0400</bug_when>
    <thetext>(In reply to Ales Kozumplik from comment #12)
&gt; If we want to swap package A for package B where B conflicts with A:
&gt; 
&gt; dnf --allowerasing install B

Well, this works for my use case, thanks. Would it be possible to add a comment into dnf(8) man page that `swap`-like action is able to be done this way?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7538519</commentid>
    <comment_count>14</comment_count>
    <who name="Rahul Sundaram">metherid</who>
    <bug_when>2014-10-02 01:36:58 -0400</bug_when>
    <thetext>It might be better to have swap be an alias for --allow-erasing for compatibility.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7538749</commentid>
    <comment_count>15</comment_count>
    <who name="Tim Lauridsen">tla</who>
    <bug_when>2014-10-02 03:50:56 -0400</bug_when>
    <thetext>(In reply to Rahul Sundaram from comment #14)
&gt; It might be better to have swap be an alias for --allow-erasing for
&gt; compatibility.

Dont do the same thing, --allow-erasing tells the solver it must remove installed packages to solve issues. So it is a more general purpose than just replaceing 1 package with another with the same provides.

yum swap is a shotcut for

yum shell
remove x 
install y
run</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7538754</commentid>
    <comment_count>16</comment_count>
    <who name="Rahul Sundaram">metherid</who>
    <bug_when>2014-10-02 03:55:10 -0400</bug_when>
    <thetext>
I know it doesn&apos;t do the same thing.  To avoid confusion, the end result I am looking for is that dnf swap foo bar actually be made to work preserving command line compatibility.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7543983</commentid>
    <comment_count>17</comment_count>
    <who name="Honza Silhan">jsilhan</who>
    <bug_when>2014-10-03 11:45:44 -0400</bug_when>
    <thetext>*** Bug 1149014 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7576450</commentid>
    <comment_count>18</comment_count>
    <who name="Honza Horak">hhorak</who>
    <bug_when>2014-10-14 11:50:33 -0400</bug_when>
    <thetext>Another idea how to make things a bit better would be changing the help/man of dnf so it gives a clue to users searching for swap (include this word in the description), e.g.:

        --allowerasing
              Allow erasing of installed packages to resolve dependencies.
              In order to swap two packages run dnf install with --allowerasing.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7582709</commentid>
    <comment_count>19</comment_count>
    <who name="Honza Silhan">jsilhan</who>
    <bug_when>2014-10-16 08:52:16 -0400</bug_when>
    <thetext>I can mention it in man and cli vs yum differences and manual.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7582831</commentid>
    <comment_count>20</comment_count>
    <who name="Rahul Sundaram">metherid</who>
    <bug_when>2014-10-16 09:27:23 -0400</bug_when>
    <thetext>Is there any strong reasons NOT to support it in dnf?  It is widely used in yum in many scripts as well and having to change it all again to support dnf is a hassle.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7582861</commentid>
    <comment_count>21</comment_count>
    <who name="Radek Holy">rholy</who>
    <bug_when>2014-10-16 09:33:45 -0400</bug_when>
    <thetext>Rahul, we don&apos;t need/want two commands for the same use case.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7582920</commentid>
    <comment_count>22</comment_count>
    <who name="Rahul Sundaram">metherid</who>
    <bug_when>2014-10-16 09:49:29 -0400</bug_when>
    <thetext>Well, that is a bit of circular logic.  You added something new and want to break compatibility with an existing command because you added something new.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7583027</commentid>
    <comment_count>23</comment_count>
    <who name="Radek Holy">rholy</who>
    <bug_when>2014-10-16 10:08:06 -0400</bug_when>
    <thetext>The switch was introduced (as you might remember the bug 963137) with the hope that we can get rid of the &quot;shell&quot; command. Since the switch is already supported and it supports your use case, we don&apos;t need to add yet another command.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7583039</commentid>
    <comment_count>24</comment_count>
    <who name="Rahul Sundaram">metherid</who>
    <bug_when>2014-10-16 10:11:20 -0400</bug_when>
    <thetext>Before the new switch was introduced, I noted in that bug report that yum already supports a swap command and it would have been better to support it instead of introducing a new command.  This is what I am reiterating here.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7583108</commentid>
    <comment_count>25</comment_count>
    <who name="Rahul Sundaram">metherid</who>
    <bug_when>2014-10-16 10:25:10 -0400</bug_when>
    <thetext>
To expand on that,  it doesn&apos;t particularly matter whether a new switch is being introduced to handle more use cases but yum swap is widely used.  This is not some edge corner case or undocumented option.  

https://www.google.com/search?q=yum+swap&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:en-US:official&amp;client=firefox-a&amp;channel=sb

It is also not merely command line users but also configuration management systems and scripts that need to be changed.  For example, I am working on a patch to support dnf in a newly introduced script which uses yum swap and I have to add special conditions just because dnf doesn&apos;t support the same option. 

https://github.com/fedora-cloud/cloudtoserver/issues/4

Docker files use yum swap on a regular basis.  We have it being used in our Fedora wiki itself in many places.  Please don&apos;t break compatibility without very strong reasons to do so.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7583554</commentid>
    <comment_count>26</comment_count>
    <who name="Tim Lauridsen">tla</who>
    <bug_when>2014-10-16 12:47:59 -0400</bug_when>
    <thetext>(In reply to Rahul Sundaram from comment #25)
&gt; To expand on that,  it doesn&apos;t particularly matter whether a new switch is
&gt; being introduced to handle more use cases but yum swap is widely used.  This
&gt; is not some edge corner case or undocumented option.  

yum shell is also used a lot of places, but dnf dont support that
dnf != yum, one of idea by dnf was to clean things up and have more maintainable code base, all features is build about strong and sane usecases, an it was there in yum is not a strong usecase.
as the dnf developers already said, they dont add an extra cmd, when the feature to swap 2 packages allready exist.

Fedora is changing a lot of stuff all the time, so we have to learn new ways all the time.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7583707</commentid>
    <comment_count>27</comment_count>
    <who name="Rahul Sundaram">metherid</who>
    <bug_when>2014-10-16 13:28:26 -0400</bug_when>
    <thetext>Thank you bringing up yum shell.  That is a good example to compare and contrast.  yum shell is not used in scripts or configuration management or anywhere else other than interactively and is also a much more complex feature.

dnf may not be yum but calls itself yum4 in 

https://fedoraproject.org/wiki/Changes/ReplaceYumWithDNF
 
Every change in the command line of a heavily used tool like yum or any successor to it adds a *substantial* burden to users and administrators.  I have already highlighted the very important &quot;use case&quot;.  It is called compatibility.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7585062</commentid>
    <comment_count>28</comment_count>
    <who name="Tim Lauridsen">tla</who>
    <bug_when>2014-10-17 03:27:22 -0400</bug_when>
    <thetext>From: https://fedoraproject.org/wiki/Changes/ReplaceYumWithDNF

For anybody using the command line directly there will be some differences, but all the important operations are available with DNF, using the same CLI syntax.

there can of course different views on what important operations are

Fedora has a long history of introducing new stuff there is not compatibility
with the old ones.

Ex. python2 -&gt; python3, udisks -&gt; udisk2, rules in PolycyKit (ini files to JS) etc.

If you are looking at the dnf python api it is totally different from yum, but dnf has a well documented public api, an yum has no api docs at all. All api consumers will have to rewrite there code, in this view the change from
using &apos;yum swap&apos; to &apos;dnf install --allowerasing&apos; seems like minor thing.

I have never used &apos;yum swap&apos; and I dont see myself as a novice yum user, so I think that normal user dont use it very often or even know it exists.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7585605</commentid>
    <comment_count>29</comment_count>
    <who name="Rahul Sundaram">metherid</who>
    <bug_when>2014-10-17 05:55:16 -0400</bug_when>
    <thetext>You are setting up straw man arguments.  I never said Fedora cannot change.  I am saying, don&apos;t break compatibility in the command line without a strong justification for doing so.

As far the claim that yum swap is not popular, I welcome you to look at google search results and Fedora wiki.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7592854</commentid>
    <comment_count>30</comment_count>
    <who name="Heiko Adams">bugzilla</who>
    <bug_when>2014-10-20 15:58:39 -0400</bug_when>
    <thetext>Sorry, but I don&apos;t see any advantage in now doing 2 command line calls for a job yum does with 1 command line call.

So if you think you don&apos;t need/want a swap command, its okay to me because ATM I&apos;m using Xfce which currently doesn&apos;t depend on dnf or hawkeye and which allows me to continue using yum.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7593897</commentid>
    <comment_count>31</comment_count>
    <who name="Tim Lauridsen">tla</who>
    <bug_when>2014-10-21 00:54:52 -0400</bug_when>
    <thetext>(In reply to Heiko Adams from comment #30)
&gt; Sorry, but I don&apos;t see any advantage in now doing 2 command line calls for a
&gt; job yum does with 1 command line call.
&gt; 

&apos;dnf --allowerasing install foobar&apos; is only one command</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7639249</commentid>
    <comment_count>32</comment_count>
    <who name="Honza Silhan">jsilhan</who>
    <bug_when>2014-11-04 08:11:41 -0500</bug_when>
    <thetext>Reference of swap command from yum mentioned in &quot;cli vs yum&quot; and in dnf man page.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7746753</commentid>
    <comment_count>33</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2014-12-09 09:06:47 -0500</bug_when>
    <thetext>dnf-0.6.3-2.fc21,dnf-plugins-core-0.1.4-1.fc21,hawkey-0.5.2-1.fc21 has been submitted as an update for Fedora 21.
https://admin.fedoraproject.org/updates/dnf-0.6.3-2.fc21,dnf-plugins-core-0.1.4-1.fc21,hawkey-0.5.2-1.fc21</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7757632</commentid>
    <comment_count>34</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2014-12-11 23:32:53 -0500</bug_when>
    <thetext>Package dnf-0.6.3-2.fc21, hawkey-0.5.2-1.fc21, dnf-plugins-core-0.1.4-1.fc21:
* should fix your issue,
* was pushed to the Fedora 21 testing repository,
* should be available at your local mirror within two days.
Update it with:
# su -c &apos;yum update --enablerepo=updates-testing dnf-0.6.3-2.fc21 hawkey-0.5.2-1.fc21 dnf-plugins-core-0.1.4-1.fc21&apos;
as soon as you are able to.
Please go to the following url:
https://admin.fedoraproject.org/updates/FEDORA-2014-16760/dnf-0.6.3-2.fc21,dnf-plugins-core-0.1.4-1.fc21,hawkey-0.5.2-1.fc21
then log in and leave karma (feedback).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7761130</commentid>
    <comment_count>35</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2014-12-13 04:53:55 -0500</bug_when>
    <thetext>dnf-0.6.3-2.fc21, hawkey-0.5.2-1.fc21, dnf-plugins-core-0.1.4-1.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8122429</commentid>
    <comment_count>36</comment_count>
    <who name="Ali Akcaagac">aliakc</who>
    <bug_when>2015-04-08 04:53:55 -0400</bug_when>
    <thetext>I was just pointed at this *closed* bugreport from a maintainer ? developer ? ... Not really sure what his intentions was by doing so but reading through some comments here I am willing to back up the reasons brought up by Heiko Adams.

https://bugzilla.redhat.com/show_bug.cgi?id=963137#c17</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9168657</commentid>
    <comment_count>37</comment_count>
    <who name="Matthew Miller">mattdm</who>
    <bug_when>2016-03-22 08:15:25 -0400</bug_when>
    <thetext>Is there any reason to _not_ support dnf swap / yum swap with DNF?

See http://lists.fedoraproject.org/archives/list/devel@lists.fedoraproject.org/mess
age/5VBZ45TRTWNB7NAXW5HPYKZIUFMAW6HZ/ for a case where the --allowerasing workaround does not help.

Additionally

a) &quot;install --allowerasing&quot; is not particularly easy to find or even remember; I can&apos;t really think of anyone finding it any way _other_ than finding in the FAQ for &quot;how do I do `yum swap` with dnf?&quot;, or reading a &quot;secrets of DNF&quot; article.

b) It worked fine in yum; why change the interface?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9168875</commentid>
    <comment_count>38</comment_count>
    <who name="Kamil Dudka">kdudka</who>
    <bug_when>2016-03-22 08:58:23 -0400</bug_when>
    <thetext>Could --allowerasing be extended to accept an operand?

Something like a wildcard and/or a list of packages allowed to be erased would work for me.  Allowing dnf to erase everything may result in unexpected decision to be made by dnf.

For inspiration, you can have a look at the option --remove-if-dependent which is offered by Paludis:

http://paludis.exherbo.org/clients/cave-resolve.html

Some other options (such as --permit-downgrade, --permit-old-version, --purge, or --uninstalls-may-break) may be also worth adding to dnf, but that is another story :-)

Otherwise, it is IMO good that it is implemented as a switch (instead of dnf command) because the switch could also be used for other commands than install.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9172053</commentid>
    <comment_count>39</comment_count>
    <who name="Honza Silhan">jsilhan</who>
    <bug_when>2016-03-23 05:57:37 -0400</bug_when>
    <thetext>(In reply to Matthew Miller from comment #37)
&gt; Is there any reason to _not_ support dnf swap / yum swap with DNF?
&gt; 
&gt; See
&gt; http://lists.fedoraproject.org/archives/list/devel@lists.fedoraproject.org/
&gt; mess
&gt; age/5VBZ45TRTWNB7NAXW5HPYKZIUFMAW6HZ/ for a case where the --allowerasing
&gt; workaround does not help.

Proper way to upgrade to new Fedora version is by using system-upgrade or distro-sync alternatively. In this case excluding (-x) broken packages is the easiest option.

&gt; Additionally
&gt; 
&gt; a) &quot;install --allowerasing&quot; is not particularly easy to find or even
&gt; remember; I can&apos;t really think of anyone finding it any way _other_ than
&gt; finding in the FAQ for &quot;how do I do `yum swap` with dnf?&quot;, or reading a
&gt; &quot;secrets of DNF&quot; article.

In case there are some conflicts, DNF shows a hint about `--allowerasing` usage.

&gt; b) It worked fine in yum; why change the interface?

Maybe we can support it in yum compatible layer or DNF itself.

(In reply to Kamil Dudka from comment #38)
&gt; Could --allowerasing be extended to accept an operand?
&gt; 
&gt; Something like a wildcard and/or a list of packages allowed to be erased
&gt; would work for me.  Allowing dnf to erase everything may result in
&gt; unexpected decision to be made by dnf.

That&apos;s a good idea, Kamil. Libsolv already supports specifying concrete packages for removal. Protected packages should use this interface too to exclude protected packages from transaction removal beforehand not report just error afterwards.

&gt; Some other options (such as --permit-downgrade, --permit-old-version,
&gt; --purge, or --uninstalls-may-break) may be also worth adding to dnf, but
&gt; that is another story :-)

downgrade is permitted when --allowerasing is set.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9549268</commentid>
    <comment_count>40</comment_count>
    <who name="Jan Kurik">jkurik</who>
    <bug_when>2016-07-26 00:28:12 -0400</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 25 development cycle.
Changing version to &apos;25&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9991629</commentid>
    <comment_count>41</comment_count>
    <who name="Pavel Raiskup">praiskup</who>
    <bug_when>2016-12-15 18:19:40 -0500</bug_when>
    <thetext>I know this is result of several poor packaging issues, but I faced this
recently and solved with `yum-deprecated shell` only..  even the `yum swap`
was not enough because I needed to swap two pairs of packages.

The issue (for the story, consider I&apos;ve done this on production server,
but I still plan doing this in production):
I planned to switch from package &apos;foo-modified&apos; to package &apos;foo&apos;, where
the package foo-modified is really  _poorly_ downstream-modified version
of &apos;foo&apos; (no Obsoletes nor Collides tags), that means -&gt; only *implicit*
file collisions between those two packages.  The &apos;foo-modified&apos; is not
needed because Fedora&apos;s default &apos;foo&apos; is already suitable for me, yay!

Steps I tried:
The `dnf install --allowerasing foo` calculated transaction (no issue
reported) and once I hit the &apos;Y&apos; button, the execution of transaction
failed reporting file collisions (on RPM level).

Is there a way to replace *non-explicitly* colliding packages in dnf in
one transaction?  The --allowerasing doesn&apos;t help because there&apos;s nothing
obvious in the install transaction which _would make dnf think_ the
removal of `foo-modified` is needed.

I don&apos;t want to `dnf remove foo-modified &amp;&amp; dnf install foo` because
remove might succeed and install *could* fail -&gt; and that would cause
additional downtime... because system might be in inconsistent state (even
after re-installation of foo-modified).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9991637</commentid>
    <comment_count>42</comment_count>
    <who name="Pavel Raiskup">praiskup</who>
    <bug_when>2016-12-15 18:24:54 -0500</bug_when>
    <thetext>(In reply to Pavel Raiskup from comment #41)
&gt; (no Obsoletes nor Collides tags)

Sorry, s/Collides/Conflicts/.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9991700</commentid>
    <comment_count>43</comment_count>
    <who name="Pavel Raiskup">praiskup</who>
    <bug_when>2016-12-15 18:54:40 -0500</bug_when>
    <thetext>Example:

    $ sudo dnf -y copr enable praiskup/bug-1110780-dnf-swap
    $ sudo dnf -y install foo-modified
    ...
    Complete!
    $ sudo dnf -y --allowerasing foo
    ...
    file /collides_here from install of foo-20161216_0044-0.fc25.x86_64 conflicts with file from package foo-modified-20161216_0044-0.fc25.x86_64
    ...

HOWTO &apos;s/foo-modified/foo/&apos; with dnf then?  This works (for now):

    $ sudo yum-deprecated -y swap foo-modified foo
    ...
    Complete!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9993709</commentid>
    <comment_count>44</comment_count>
    <who name="Jaroslav Mracek">jmracek</who>
    <bug_when>2016-12-16 10:36:41 -0500</bug_when>
    <thetext>Here is pull-request that add support of swap command: https://github.com/rpm-software-management/dnf/pull/679</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9997143</commentid>
    <comment_count>45</comment_count>
    <who name="Pavel Raiskup">praiskup</who>
    <bug_when>2016-12-19 00:27:41 -0500</bug_when>
    <thetext>Thanks for working on it.  FWIW, `dnf swap` is not enough, I actually
needed to have two `dnf swap` calls in once transaction (so I used `yum
shell` to resolve my issues).  Let me know if you want me to prepare
example (or if this deserves new ticket).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9997565</commentid>
    <comment_count>46</comment_count>
    <who name="Michal Luscon">mluscon</who>
    <bug_when>2016-12-19 04:31:45 -0500</bug_when>
    <thetext>Hi Pavel,

DNF shell is also on the way - https://github.com/rpm-software-management/dnf/pull/658 .</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10053694</commentid>
    <comment_count>47</comment_count>
    <who name="Honza Silhan">jsilhan</who>
    <bug_when>2017-01-11 12:03:23 -0500</bug_when>
    <thetext>Merged into the upstream: https://github.com/rpm-software-management/dnf/commit/7497d310df8390192e7bc1ccea9dc104ee3fc988</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10138662</commentid>
    <comment_count>48</comment_count>
    <who name="Jaroslav Mracek">jmracek</who>
    <bug_when>2017-02-10 11:04:30 -0500</bug_when>
    <thetext>Bug fixed in version of dnf-2.0.1-1.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>