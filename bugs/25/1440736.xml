<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1440736</bug_id>
          
          <creation_ts>2017-04-10 07:56:00 -0400</creation_ts>
          <short_desc>unable to handle kernel NULL pointer dereference null pointer dereference dma_fence_wait_timeout from nouveau_drm_ioctl</short_desc>
          <delta_ts>2017-05-04 14:24:45 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>kernel</component>
          <version>25</version>
          <rep_platform>x86_64</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>high</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Peter Bieringer">pb</reporter>
          <assigned_to name="Kernel Maintainer List">kernel-maint</assigned_to>
          <cc>eugenemah</cc>
    
    
    <cc>gansalmon</cc>
    
    
    <cc>ichavero</cc>
    
    
    <cc>itamar</cc>
    
    
    <cc>jforbes</cc>
    
    
    <cc>jonathan</cc>
    
    
    <cc>kernel-maint</cc>
    
    
    <cc>madhu.chinakonda</cc>
    
    
    <cc>mchehab</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>kernel-4.10.12-200.fc25 kernel-4.10.13-100.fc24</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-05-04 14:24:45</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10319154</commentid>
    <comment_count>0</comment_count>
    <who name="Peter Bieringer">pb</who>
    <bug_when>2017-04-10 07:56:29 -0400</bug_when>
    <thetext>Description of problem:


Version-Release number of selected component (if applicable):
kernel-4.10.8-200.fc25.x86_64

How reproducible:
mostly after wakeup from suspend

Steps to Reproduce:
1. suspend
2. wakeup
3. wait some minutes

Actual results:
X-Windows crashes

[20795.814388] BUG: unable to handle kernel NULL pointer dereference at 0000000000000020
[20795.814974] IP: dma_fence_wait_timeout+0x36/0xf0
[20795.815217] PGD b99f4067
[20795.815217] PUD b99f5067
[20795.815217] PMD 0
[20795.815217] Oops: 0000 [#1] SMP
...
[20795.815217] Call Trace:
[20795.815217]  drm_atomic_helper_wait_for_fences+0x48/0x120 [drm_kms_helper]
[20795.815217]  nv50_disp_atomic_commit+0x19c/0x2a0 [nouveau]
[20795.815217]  drm_atomic_commit+0x4b/0x50 [drm]
[20795.815217]  drm_atomic_helper_update_plane+0xec/0x150 [drm_kms_helper]
[20795.815217]  __setplane_internal+0x1b4/0x280 [drm]
[20795.815217]  ? check_preempt_wakeup+0x10d/0x220
[20795.815217]  drm_mode_cursor_universal+0x126/0x210 [drm]
[20795.815217]  drm_mode_cursor_common+0x86/0x180 [drm]
[20795.815217]  drm_mode_cursor_ioctl+0x50/0x70 [drm]
[20795.815217]  drm_ioctl+0x21b/0x4c0 [drm]
[20795.815217]  ? _copy_to_user+0x54/0x60
[20795.815217]  ? drm_mode_setplane+0x1a0/0x1a0 [drm]
[20795.815217]  nouveau_drm_ioctl+0x74/0xc0 [nouveau]
[20795.815217]  do_vfs_ioctl+0xa3/0x5f0
[20795.815217]  ? security_file_permission+0x6b/0xc0
[20795.815217]  SyS_ioctl+0x79/0x90
[20795.815217]  entry_SYSCALL_64_fastpath+0x1a/0xa9



Expected results:
no crash (can&apos;t remember seen it before 4.10)


Additional info:

Looks like issue is already known:
https://bugs.freedesktop.org/show_bug.cgi?id=100545
https://bugs.freedesktop.org/show_bug.cgi?id=100431

As kernel 4.11 is planned to be released end of April would it be possible to get at least in Fedora testing or via Koji an intermediate built of 4.10 containing the patch described here?

https://github.com/skeggsb/nouveau/commit/23da66b47d9a7ca6a7c4a7f574a8842d8356fec5</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10352327</commentid>
    <comment_count>1</comment_count>
    <who name="Peter Bieringer">pb</who>
    <bug_when>2017-04-21 02:36:22 -0400</bug_when>
    <thetext>just to be informed that a local rebuilded kernel (4.10.8 and 4.10.10) containing the mentioned patch will fix the issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10353216</commentid>
    <comment_count>2</comment_count>
    <who name="Justin M. Forbes">jforbes</who>
    <bug_when>2017-04-21 08:24:46 -0400</bug_when>
    <thetext>That patch is in the 4.10.12 stable update that I will be building today.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10357067</commentid>
    <comment_count>3</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-24 10:56:35 -0400</bug_when>
    <thetext>kernel-4.10.12-200.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-7462231059</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10357080</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-24 10:58:41 -0400</bug_when>
    <thetext>kernel-4.10.12-100.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-11938627fa</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10358774</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-24 23:54:25 -0400</bug_when>
    <thetext>kernel-4.10.12-200.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-7462231059</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10359920</commentid>
    <comment_count>6</comment_count>
    <who name="Eugene Mah">eugenemah</who>
    <bug_when>2017-04-25 08:09:36 -0400</bug_when>
    <thetext>Just installed kernel-4.10.12-200.fc25 from updates-testing on my system. Looks like it fixes the problem here. I can at least log in and not see a black screen like I was getting before.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10361804</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-25 15:25:37 -0400</bug_when>
    <thetext>kernel-4.10.12-100.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-11938627fa</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10370069</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-27 15:53:46 -0400</bug_when>
    <thetext>kernel-4.10.12-200.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10372106</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-28 08:48:53 -0400</bug_when>
    <thetext>kernel-4.10.13-100.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-0aa0f69e0c</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10374697</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-29 22:22:49 -0400</bug_when>
    <thetext>kernel-4.10.13-100.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-0aa0f69e0c</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10387101</commentid>
    <comment_count>11</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-04 14:24:45 -0400</bug_when>
    <thetext>kernel-4.10.13-100.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>