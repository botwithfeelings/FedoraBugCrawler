<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1160011</bug_id>
          
          <creation_ts>2014-11-03 16:22:00 -0500</creation_ts>
          <short_desc>removal in install transaction</short_desc>
          <delta_ts>2017-06-16 09:19:24 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>dnf</component>
          <version>26</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened, Triaged</keywords>
          <priority>low</priority>
          <bug_severity>low</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Matthew Miller">mattdm</reporter>
          <assigned_to>rpm-software-management</assigned_to>
          <cc>akozumpl</cc>
    
    
    <cc>jmracek</cc>
    
    
    <cc>mluscon</cc>
    
    
    <cc>mmraka</cc>
    
    
    <cc>packaging-team-maint</cc>
    
    
    <cc>pnemade</cc>
    
    
    <cc>tla</cc>
    
    
    <cc>vondruch</cc>
    
    
    <cc>yaneti</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>dnf-2.5.1-1.fc26</cf_fixed_in>
          <cf_doc_type>Bug Fix</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-06-16 09:19:24</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>7636915</commentid>
    <comment_count>0</comment_count>
    <who name="Matthew Miller">mattdm</who>
    <bug_when>2014-11-03 16:22:58 -0500</bug_when>
    <thetext>So, this happened:

$ sudo dnf install inkscape
Package inkscape-0.48.5-2.fc21.x86_64 is already installed, skipping.
Dependencies resolved.
================================================================================
 Package                   Arch        Version               Repository    Size
================================================================================
Removing:
 kernel                    x86_64      3.16.4-200.fc20       @System      138 M
 kernel-modules-extra      x86_64      3.16.4-200.fc20       @System      8.2 M

Transaction Summary
================================================================================
Remove  2 Packages

Installed size: 146 M
Is this ok [y/N]: n
Operation aborted.


------

It turns out that after doing fedup, I had 4 kernels installed, and installonly_limit=3. DNF apparently wants to bring that into compliance, but it&apos;s quite surprising for it to do that in an otherwise unrelated transaction.


Shouldn&apos;t this only happen when adding a new kernel (or other installonly package where the limit is exceeded)?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7638065</commentid>
    <comment_count>1</comment_count>
    <who name="Jan Zeleny">jzeleny</who>
    <bug_when>2014-11-04 02:29:47 -0500</bug_when>
    <thetext>&gt; Shouldn&apos;t this only happen when adding a new kernel (or other installonly
&gt; package where the limit is exceeded)?

It depends. While I see this behavior can be confusing, it makes a perfect sense from dnf&apos;s perspective. It&apos;s important to realize that this situation would not have happened if fedup was using dnf as installer. If that was the case, dnf would have erased the old kernels right away. Installing them &quot;manually&quot; (which is pretty much what fedup does IIRC) technically breaks consistency of the system from libsolv&apos;s perspective. It is therefore fixed in the first transaction possible.

I leave the decision up to dnf developers but I recommend this bug to be closed as notabug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7639967</commentid>
    <comment_count>2</comment_count>
    <who name="Honza Silhan">jsilhan</who>
    <bug_when>2014-11-04 10:35:47 -0500</bug_when>
    <thetext>Thanks for input, Jan, closing.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7640021</commentid>
    <comment_count>3</comment_count>
    <who name="Matthew Miller">mattdm</who>
    <bug_when>2014-11-04 10:41:48 -0500</bug_when>
    <thetext>I see the consistency argument, and there are pros and cons. With experience from apt4rpm in the olden days, which did a similar thing, it&apos;s easy for some error in the repository to cause the entire system to reform itself into a self-consistent state that the user very much did not want. Yum&apos;s more conservative approach is nicer for sysadmins — tell me there&apos;s a problem but let me choose when to solve it.

Even if this behavior stays the default, could DNF

a) Provide text explaining why the unrelated removal is happening

and

b) Provide some option for doing just what was asked and delaying the fix for later?

?

Thanks!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7640843</commentid>
    <comment_count>4</comment_count>
    <who name="Jan Zeleny">jzeleny</who>
    <bug_when>2014-11-04 14:03:14 -0500</bug_when>
    <thetext>Setting low prio. The issue is not exactly critical and the dnf team has more important things to work on.

Also, one of the key aspects of dnf design is to have clean and maintainable code base. If addressing corner case like this would add more than a few lines of code, I would strongly advise against it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7716894</commentid>
    <comment_count>5</comment_count>
    <who name="Vít Ondruch">vondruch</who>
    <bug_when>2014-11-28 09:00:12 -0500</bug_when>
    <thetext>*** Bug 1168949 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>7716926</commentid>
    <comment_count>6</comment_count>
    <who name="Vít Ondruch">vondruch</who>
    <bug_when>2014-11-28 09:06:21 -0500</bug_when>
    <thetext>From my POV, DNF should execute the operations atomically. When I want to install something, it should touch only related packages. If nothing else, it helps when searching history when some change happened.

I tried to use &apos;-x kernel*&apos; to exclude the kernel from transaction, but unfortunately, it seems to be ignored :/</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8456938</commentid>
    <comment_count>7</comment_count>
    <who name="Honza Silhan">jsilhan</who>
    <bug_when>2015-07-20 07:42:49 -0400</bug_when>
    <thetext>we should either document why DNF wants to remove something or apply the installonly limit when installonly package is involved  only.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8462630</commentid>
    <comment_count>8</comment_count>
    <who name="Honza Silhan">jsilhan</who>
    <bug_when>2015-07-21 07:33:56 -0400</bug_when>
    <thetext>*** Bug 1203699 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8783121</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2015-11-04 05:19:36 -0500</bug_when>
    <thetext>This message is a reminder that Fedora 21 is nearing its end of life.
Approximately 4 (four) weeks from now Fedora will stop maintaining
and issuing updates for Fedora 21. It is Fedora&apos;s policy to close all
bug reports from releases that are no longer maintained. At that time
this bug will be closed as EOL if it remains open with a Fedora  &apos;version&apos;
of &apos;21&apos;.

Package Maintainer: If you wish for this bug to remain open because you
plan to fix it in a currently maintained version, simply change the &apos;version&apos; 
to a later Fedora version.

Thank you for reporting this issue and we are sorry that we were not 
able to fix it before Fedora 21 is end of life. If you would still like 
to see this bug fixed and are able to reproduce it against a later version 
of Fedora, you are encouraged  change the &apos;version&apos; to a later Fedora 
version prior this bug is closed as described in the policy above.

Although we aim to fix as many bugs as possible during every release&apos;s 
lifetime, sometimes those efforts are overtaken by events. Often a 
more recent Fedora release includes newer upstream software that fixes 
bugs or makes them obsolete.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8877012</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2015-12-01 23:40:28 -0500</bug_when>
    <thetext>Fedora 21 changed to end-of-life (EOL) status on 2015-12-01. Fedora 21 is
no longer maintained, which means that it will not receive any further
security or bug fix updates. As a result we are closing this bug.

If you can reproduce this bug against a currently maintained version of
Fedora please feel free to reopen this bug against that version. If you
are unable to reopen this bug, please file a new report against the
current release. If you experience problems, please add a comment to this
bug.

Thank you for reporting this bug and we are sorry it could not be fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>8877782</commentid>
    <comment_count>11</comment_count>
    <who name="Yanko Kaneti">yaneti</who>
    <bug_when>2015-12-02 01:05:17 -0500</bug_when>
    <thetext>This bug is still there. Reopening.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9490378</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Admin XMLRPC Client">fedora-admin-xmlrpc</who>
    <bug_when>2016-07-08 05:34:17 -0400</bug_when>
    <thetext>This package has changed ownership in the Fedora Package Database.  Reassigning to the new owner of this component.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9920309</commentid>
    <comment_count>13</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2016-11-24 06:16:15 -0500</bug_when>
    <thetext>This message is a reminder that Fedora 23 is nearing its end of life.
Approximately 4 (four) weeks from now Fedora will stop maintaining
and issuing updates for Fedora 23. It is Fedora&apos;s policy to close all
bug reports from releases that are no longer maintained. At that time
this bug will be closed as EOL if it remains open with a Fedora  &apos;version&apos;
of &apos;23&apos;.

Package Maintainer: If you wish for this bug to remain open because you
plan to fix it in a currently maintained version, simply change the &apos;version&apos; 
to a later Fedora version.

Thank you for reporting this issue and we are sorry that we were not 
able to fix it before Fedora 23 is end of life. If you would still like 
to see this bug fixed and are able to reproduce it against a later version 
of Fedora, you are encouraged  change the &apos;version&apos; to a later Fedora 
version prior this bug is closed as described in the policy above.

Although we aim to fix as many bugs as possible during every release&apos;s 
lifetime, sometimes those efforts are overtaken by events. Often a 
more recent Fedora release includes newer upstream software that fixes 
bugs or makes them obsolete.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9941841</commentid>
    <comment_count>14</comment_count>
    <who name="Jaroslav Mracek">jmracek</who>
    <bug_when>2016-11-30 03:18:14 -0500</bug_when>
    <thetext>Still valid:
Problem is when number of installonlypkg is decreased.
sudo dnf install gedit
Last metadata expiration check: 0:22:05 ago on Wed Nov 30 08:52:21 2016 CET.
Package gedit-2:3.22.0-2.fc25.x86_64 is already installed, skipping.
Dependencies resolved.
===================================================================================================================================================================================================================
 Package                                                  Arch                                         Version                                                Repository                                      Size
===================================================================================================================================================================================================================
Removing:
 kernel                                                   x86_64                                       4.8.6-201.fc24                                         @updates                                         0  
 kernel-core                                              x86_64                                       4.8.6-201.fc24                                         @updates                                        52 M
 kernel-debug-devel                                       x86_64                                       4.8.6-201.fc24                                         @updates                                        41 M
 kernel-modules                                           x86_64                                       4.8.6-201.fc24                                         @updates                                        22 M

Transaction Summary
===================================================================================================================================================================================================================
Remove  4 Packages

Installed size: 114 M
Is this ok [y/N]: 
Operation aborted.
[test@dhcp-0-213 ~]$ rpm -q dnf
dnf-2.0.0-0.rc1.1.git.0.1d82616.fc25.noarch</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10190517</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2017-02-28 04:38:22 -0500</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 26 development cycle.
Changing version to &apos;26&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10424257</commentid>
    <comment_count>16</comment_count>
    <who name="Jaroslav Mracek">jmracek</who>
    <bug_when>2017-05-18 04:29:12 -0400</bug_when>
    <thetext>I created pull-request (https://github.com/rpm-software-management/libdnf/pull/288) that should solve the problem</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10498400</commentid>
    <comment_count>17</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-12 11:31:13 -0400</bug_when>
    <thetext>dnf-plugins-core-2.1.1-1.fc26 libdnf-0.9.1-1.fc26 dnf-2.5.1-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-c87c47dccb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10503196</commentid>
    <comment_count>18</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-13 21:36:27 -0400</bug_when>
    <thetext>dnf-2.5.1-1.fc26, dnf-plugins-core-2.1.1-1.fc26, libdnf-0.9.1-1.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-c87c47dccb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10503676</commentid>
    <comment_count>19</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-14 01:35:12 -0400</bug_when>
    <thetext>dnf-2.5.1-1.fc26 dnf-plugins-core-2.1.1-1.fc26 dnfdaemon-0.3.18-3.fc26 libdnf-0.9.1-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-c87c47dccb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10509752</commentid>
    <comment_count>20</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-15 09:56:32 -0400</bug_when>
    <thetext>dnf-2.5.1-1.fc26, dnf-plugins-core-2.1.1-1.fc26, dnfdaemon-0.3.18-3.fc26, libdnf-0.9.1-1.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-c87c47dccb</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10513088</commentid>
    <comment_count>21</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-16 09:19:24 -0400</bug_when>
    <thetext>dnf-2.5.1-1.fc26, dnf-plugins-core-2.1.1-1.fc26, dnfdaemon-0.3.18-3.fc26, libdnf-0.9.1-1.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>