<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1426850</bug_id>
          
          <creation_ts>2017-02-25 12:56:00 -0500</creation_ts>
          <short_desc>Re-enable ARMv7 builds on all releases</short_desc>
          <delta_ts>2017-03-06 12:20:00 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>firefox</component>
          <version>26</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>CURRENTRELEASE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>high</priority>
          <bug_severity>high</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>245418</blocked>
    
    
    <blocked>1349184</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Peter Robinson">pbrobinson</reporter>
          <assigned_to name="Martin Stransky">stransky</assigned_to>
          <cc>gecko-bugs-nobody</cc>
    
    
    <cc>jhorak</cc>
    
    
    <cc>kengert</cc>
    
    
    <cc>mtasaka</cc>
    
    
    <cc>pjasicek</cc>
    
    
    <cc>pwhalen</cc>
    
    
    <cc>robatino</cc>
    
    
    <cc>stransky</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-03-06 12:20:00</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10183810</commentid>
    <comment_count>0</comment_count>
    <who name="Peter Robinson">pbrobinson</who>
    <bug_when>2017-02-25 12:56:31 -0500</bug_when>
    <thetext>There doesn&apos;t seem to be a bug to track why the ARMv7 builds of firefox have been disabled, nor has there been any engagement with the ARM team and now it&apos;s blocking nss upgrades in stable releases and bug reports to IRC etc.

Please re-enable firefox on ARMv7</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10185863</commentid>
    <comment_count>1</comment_count>
    <who name="Martin Stransky">stransky</who>
    <bug_when>2017-02-27 05:14:15 -0500</bug_when>
    <thetext>Added to firefox-51.0.1-8.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10185865</commentid>
    <comment_count>2</comment_count>
    <who name="Martin Stransky">stransky</who>
    <bug_when>2017-02-27 05:14:58 -0500</bug_when>
    <thetext>Builds:
https://koji.fedoraproject.org/koji/taskinfo?taskID=18091421
https://koji.fedoraproject.org/koji/taskinfo?taskID=18091427
https://koji.fedoraproject.org/koji/taskinfo?taskID=18091430</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10192489</commentid>
    <comment_count>3</comment_count>
    <who name="Martin Stransky">stransky</who>
    <bug_when>2017-02-28 06:32:14 -0500</bug_when>
    <thetext>All ARMv7 builds fail in JS with:

Assertion failure: !joinable(), at /builddir/build/BUILD/firefox-51.0.1/firefox-51.0.1/js/src/threading/Thread.h:122

https://kojipkgs.fedoraproject.org//work/tasks/1502/18091502/build.log
https://kojipkgs.fedoraproject.org//work/tasks/1503/18091503/build.log
https://kojipkgs.fedoraproject.org//work/tasks/1461/18091461/build.log</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10193435</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2017-02-28 07:26:41 -0500</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 26 development cycle.
Changing version to &apos;26&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10194640</commentid>
    <comment_count>5</comment_count>
    <who name="Paul Whalen">pwhalen</who>
    <bug_when>2017-02-28 12:03:21 -0500</bug_when>
    <thetext>Proposing as an alpha blocker, firefox is the default browser on XFCE which is a release blocking desktop image on arm.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10196211</commentid>
    <comment_count>6</comment_count>
    <who name="Martin Stransky">stransky</who>
    <bug_when>2017-03-01 02:45:19 -0500</bug_when>
    <thetext>We don&apos;t have a fix for that and I don&apos;t expect we can fix that in some reasonable time frame.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10196244</commentid>
    <comment_count>7</comment_count>
    <who name="Peter Robinson">pbrobinson</who>
    <bug_when>2017-03-01 02:59:12 -0500</bug_when>
    <thetext>(In reply to Martin Stransky from comment #6)
&gt; We don&apos;t have a fix for that and I don&apos;t expect we can fix that in some
&gt; reasonable time frame.

Why has it regressed, it&apos;s been fine until v50, it&apos;s causing the ARM team quite an increase in support requests too due to the issue that it blocks nss* updates. What are the upstream BZs?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10196269</commentid>
    <comment_count>8</comment_count>
    <who name="Martin Stransky">stransky</who>
    <bug_when>2017-03-01 03:07:08 -0500</bug_when>
    <thetext>There&apos;s no upstream BZ for that AFAIK. Feel free to file one or I can do so.
Do you say that this FF failure blocks NSS update? I don&apos;t understand how, nss can be updated without FF.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10196836</commentid>
    <comment_count>9</comment_count>
    <who name="Peter Robinson">pbrobinson</who>
    <bug_when>2017-03-01 06:01:32 -0500</bug_when>
    <thetext>(In reply to Martin Stransky from comment #8)
&gt; There&apos;s no upstream BZ for that AFAIK. Feel free to file one or I can do so.
&gt; Do you say that this FF failure blocks NSS update? I don&apos;t understand how,
&gt; nss can be updated without FF.

It does. I&apos;ll need to go and find a host to test the dnf side of things on but because firefox on ARM is now stuck at 50 dnf excludes the nss* updates unless you remove firefox.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10196859</commentid>
    <comment_count>10</comment_count>
    <who name="Martin Stransky">stransky</who>
    <bug_when>2017-03-01 06:09:04 -0500</bug_when>
    <thetext>(In reply to Peter Robinson from comment #9)
&gt; (In reply to Martin Stransky from comment #8)
&gt; &gt; There&apos;s no upstream BZ for that AFAIK. Feel free to file one or I can do so.
&gt; &gt; Do you say that this FF failure blocks NSS update? I don&apos;t understand how,
&gt; &gt; nss can be updated without FF.
&gt; 
&gt; It does. I&apos;ll need to go and find a host to test the dnf side of things on
&gt; but because firefox on ARM is now stuck at 50 dnf excludes the nss* updates
&gt; unless you remove firefox.

Yes, I understand now. There&apos;s an incompatible nss update (IIRC 3.28.1). Firefox 51 got a special patches for it which Firefox 50 does not have.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10196909</commentid>
    <comment_count>11</comment_count>
    <who name="Peter Robinson">pbrobinson</who>
    <bug_when>2017-03-01 06:18:14 -0500</bug_when>
    <thetext>Yep so I get:

Error: package nss-3.28.1-1.3.fc25.armv7hl conflicts with firefox &lt; 50.1.0-3 provided by firefox-49.0-2.fc25.armv7hl</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10197044</commentid>
    <comment_count>12</comment_count>
    <who name="Kai Engert (:kaie)">kengert</who>
    <bug_when>2017-03-01 07:06:01 -0500</bug_when>
    <thetext>If you upgrade NSS, but keep old Firefox, then Firefox fails to connect to many services, including many google servers.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10197177</commentid>
    <comment_count>13</comment_count>
      <attachid>1258671</attachid>
    <who name="Mamoru TASAKA">mtasaka</who>
    <bug_when>2017-03-01 07:38:48 -0500</bug_when>
    <thetext>Created attachment 1258671
diff for firefox.spec with workaround for arm

Using

echo &apos;ac_add_options --enable-optimize=&quot;-g -O2 -fno-schedule-insns&quot;&apos; &gt;&gt; .mozconfig

seems to make compilation pass for armv7hl.
The above flag is written on:
https://bugzilla.mozilla.org/show_bug.cgi?id=1337263
(note that the title of above bug says &quot;arm64&quot;, comment 3 says the above is &quot;armhf chroot on a arm64 host&quot;)
Although there may be performance regression...

Scratch build here:
https://koji.fedoraproject.org/koji/taskinfo?taskID=18117365
Note that build takes 8 hours...</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10197262</commentid>
    <comment_count>14</comment_count>
    <who name="Mamoru TASAKA">mtasaka</who>
    <bug_when>2017-03-01 07:56:11 -0500</bug_when>
    <thetext>(In reply to Mamoru TASAKA from comment #13)
&gt; Created attachment 1258671 [details]
&gt; diff for firefox.spec with workaround for arm
&gt; 

Changes for s390 s390x is just a mistake.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10197791</commentid>
    <comment_count>15</comment_count>
    <who name="Paul Whalen">pwhalen</who>
    <bug_when>2017-03-01 10:00:14 -0500</bug_when>
    <thetext>The scratch build works as expected on armhfp, passing Alpha browser tests.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10201317</commentid>
    <comment_count>16</comment_count>
    <who name="Martin Stransky">stransky</who>
    <bug_when>2017-03-02 05:34:09 -0500</bug_when>
    <thetext>Okay, let&apos;s raise priority of this one as it blocks nss update. I&apos;ll look into it when I finish recent ppc64 crashes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10201407</commentid>
    <comment_count>17</comment_count>
    <who name="Martin Stransky">stransky</who>
    <bug_when>2017-03-02 06:08:32 -0500</bug_when>
    <thetext>I added the -g -O2 -fno-schedule-insns build flags to firefox-51.0.1-10.fc26 build let&apos;s see how it goes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10201451</commentid>
    <comment_count>18</comment_count>
    <who name="Mamoru TASAKA">mtasaka</who>
    <bug_when>2017-03-02 06:26:48 -0500</bug_when>
    <thetext>(In reply to Martin Stransky from comment #17)
&gt; I added the -g -O2 -fno-schedule-insns build flags to firefox-51.0.1-10.fc26
&gt; build let&apos;s see how it goes.

Please try building for F-26 actually (now F-27 and F-26 is branched : rawhide is now .fc27).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10201513</commentid>
    <comment_count>19</comment_count>
    <who name="Martin Stransky">stransky</who>
    <bug_when>2017-03-02 06:52:08 -0500</bug_when>
    <thetext>(In reply to Mamoru TASAKA from comment #18)
&gt; (In reply to Martin Stransky from comment #17)
&gt; &gt; I added the -g -O2 -fno-schedule-insns build flags to firefox-51.0.1-10.fc26
&gt; &gt; build let&apos;s see how it goes.
&gt; 
&gt; Please try building for F-26 actually (now F-27 and F-26 is branched :
&gt; rawhide is now .fc27).

Done.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10204352</commentid>
    <comment_count>20</comment_count>
    <who name="Mamoru TASAKA">mtasaka</who>
    <bug_when>2017-03-02 20:32:51 -0500</bug_when>
    <thetext>F-27 F-25 F-24 build completed.
F-26&apos;s build failure seems to be due to some koji database error. Resubmitted myself (and again it takes 8 hours...)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10205276</commentid>
    <comment_count>21</comment_count>
    <who name="Mamoru TASAKA">mtasaka</who>
    <bug_when>2017-03-03 04:46:03 -0500</bug_when>
    <thetext>F-26 also finished successfully.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10213046</commentid>
    <comment_count>22</comment_count>
    <who name="Paul Whalen">pwhalen</who>
    <bug_when>2017-03-06 12:20:00 -0500</bug_when>
    <thetext>Closing, this is fixed in firefox-51.0.1-11. Thanks Mamoru!</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1258671</attachid>
            <date>2017-03-01 07:38:00 -0500</date>
            <delta_ts>2017-03-01 07:38:48 -0500</delta_ts>
            <desc>diff for firefox.spec with workaround for arm</desc>
            <filename>firefox.spec.diff</filename>
            <type>text/plain</type>
            <size>1307</size>
            <attacher name="Mamoru TASAKA">mtasaka</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL2ZpcmVmb3guc3BlYyBiL2ZpcmVmb3guc3BlYwppbmRleCA2ZjUyYTA5Li5m
MDE2M2MzIDEwMDY0NAotLS0gYS9maXJlZm94LnNwZWMKKysrIGIvZmlyZWZveC5zcGVjCkBAIC0x
LDUgKzEsNSBAQAogIyBUZW1wb3JhcnkgZGlzYWJsZWQgZHVlIHRvIGpzIGNyYXNoCi1FeGNsdWRl
QXJjaDogYXJtdjdobAorI0V4Y2x1ZGVBcmNoOiBhcm12N2hsCiAKICMgVXNlIHN5c3RlbSBuc3By
L25zcz8KICVkZWZpbmUgc3lzdGVtX25zcyAgICAgICAgMQpAQCAtOTcsNyArOTcsNyBAQCBFeGNs
dWRlQXJjaDogYXJtdjdobAogU3VtbWFyeTogICAgICAgIE1vemlsbGEgRmlyZWZveCBXZWIgYnJv
d3NlcgogTmFtZTogICAgICAgICAgIGZpcmVmb3gKIFZlcnNpb246ICAgICAgICA1MS4wLjEKLVJl
bGVhc2U6ICAgICAgICA5JXs/cHJlX3RhZ30lez9kaXN0fQorUmVsZWFzZTogICAgICAgIDklez9w
cmVfdGFnfSV7P2Rpc3R9LmJ6MTQyNjg1MAogVVJMOiAgICAgICAgICAgIGh0dHBzOi8vd3d3Lm1v
emlsbGEub3JnL2ZpcmVmb3gvCiBMaWNlbnNlOiAgICAgICAgTVBMdjEuMSBvciBHUEx2Misgb3Ig
TEdQTHYyKwogR3JvdXA6ICAgICAgICAgIEFwcGxpY2F0aW9ucy9JbnRlcm5ldApAQCAtMzQ2LDE4
ICszNDYsMTcgQEAgZWNobyAiYWNfYWRkX29wdGlvbnMgLS1kaXNhYmxlLWRlYnVnIiA+PiAubW96
Y29uZmlnCiAlaWZhcmNoIHBwYzY0bGUgYWFyY2g2NAogZWNobyAnYWNfYWRkX29wdGlvbnMgLS1l
bmFibGUtb3B0aW1pemU9Ii1nIC1PMiInID4+IC5tb3pjb25maWcKICVlbHNlCi0laWYgMCV7P2Zl
ZG9yYX0gPiAyNQotJWlmYXJjaCBzMzkwIHMzOTB4Ci0jIGNyYXNoZXMgaW4geHBjc2hlbGwgd2l0
aCAiLWcgLU8yIiwgcG90ZW50aWFsIGdjYyBpc3N1ZQotZWNobyAiYWNfYWRkX29wdGlvbnMgLS1l
bmFibGUtb3B0aW1pemUiID4+IC5tb3pjb25maWcKKyVpZmFyY2ggJXthcm19CitlY2hvICdhY19h
ZGRfb3B0aW9ucyAtLWVuYWJsZS1vcHRpbWl6ZT0iLWcgLU8yIC1mbm8tc2NoZWR1bGUtaW5zbnMi
JyA+PiAubW96Y29uZmlnCiAlZWxzZQorJWlmIDAlez9mZWRvcmF9ID4gMjUKIGVjaG8gJ2FjX2Fk
ZF9vcHRpb25zIC0tZW5hYmxlLW9wdGltaXplPSItZyAtTzIiJyA+PiAubW96Y29uZmlnCi0lZW5k
aWYKICVlbHNlCiBlY2hvICJhY19hZGRfb3B0aW9ucyAtLWVuYWJsZS1vcHRpbWl6ZSIgPj4gLm1v
emNvbmZpZwogJWVuZGlmCiAlZW5kaWYKICVlbmRpZgorJWVuZGlmCiAKICMgczM5MCh4KSBmYWls
cyB0byBzdGFydCB3aXRoIGplbWFsbG9jIGVuYWJsZWQKICVpZmFyY2ggczM5MCBzMzkweAo=
</data>

          </attachment>
      

    </bug>

</bugzilla>