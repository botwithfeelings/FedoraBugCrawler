<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1460276</bug_id>
          
          <creation_ts>2017-06-09 10:34:00 -0400</creation_ts>
          <short_desc>gt fails to build on fast, multi-processor, huge memory machines</short_desc>
          <delta_ts>2017-06-16 12:00:49 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>gt</component>
          <version>26</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Troy Dawson">tdawson</reporter>
          <assigned_to name="Hans de Goede">hdegoede</assigned_to>
          <cc>hdegoede</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-06-16 12:00:49</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10493248</commentid>
    <comment_count>0</comment_count>
    <who name="Troy Dawson">tdawson</who>
    <bug_when>2017-06-09 10:34:30 -0400</bug_when>
    <thetext>Description of problem:
When building gt on a very fast, lots of cpu and memory machine, the builds fail.

Version-Release number of selected component (if applicable):
gt-0.4-23.fc26

How reproducible:
On a very fast, lots of memory, lots of cpu machine, 100%
On a normal desktop or virtual machine, 0%

Steps to Reproduce:
1.
2.
3.

Actual results:
...
gcc -DHAVE_CONFIG_H -I. -I. -I.    -DDEFAULT_PATH=\&quot;/usr/share/timidity\&quot;  -Wall -W -Wshadow -Wpointer-arith -Wcast-align  -I/usr/include -O2 -g -pipe -Wall -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1 -m64 -mtune=generic -fsigned-char -c `test -f &apos;sfz2pat.c&apos; || echo &apos;./&apos;`sfz2pat.c
sfz.c:2:0: error: expected &apos;}&apos; at end of input
 #include &quot;sfz2pat.c&quot;
...
In file included from /usr/include/stdio.h:889:0,
                 from readmidi.c:23:
In function &apos;fread&apos;,
    inlined from &apos;read_midi_file&apos; at readmidi.c:2386:2:
/usr/include/bits/stdio2.h:292:9: warning: call to &apos;__fread_chk_warn&apos; declared with attribute warning: fread called with bigger size * nmemb than length of destination buffer
  return __fread_chk_warn (__ptr, __bos0 (__ptr), __size, __n, __stream);
         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
make[2]: Leaving directory &apos;/builddir/build/BUILD/gt-0.4/src&apos;
make[1]: *** [Makefile:232: all] Error 2
make[1]: Leaving directory &apos;/builddir/build/BUILD/gt-0.4/src&apos;
make: *** [Makefile:167: all-recursive] Error 1
error: Bad exit status from /var/tmp/rpm-tmp.ZfQJKh (%build)
    Bad exit status from /var/tmp/rpm-tmp.ZfQJKh (%build)


Expected results:
Package should build successfully

Additional info:
Specs of machine this is failing on.
CPU&apos;s: 144 cores - Intel(R) Xeon(R) CPU E7-8860 v4 @ 2.20GHz
Memory: 26 Gig</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10493250</commentid>
    <comment_count>1</comment_count>
    <who name="Troy Dawson">tdawson</who>
    <bug_when>2017-06-09 10:35:49 -0400</bug_when>
    <thetext>We found that making this a single threaded build fixes the problem.
It also doesn&apos;t slow the build on normal machines.  (Not enough to notice)</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10493262</commentid>
    <comment_count>2</comment_count>
      <attachid>1286426</attachid>
    <who name="Troy Dawson">tdawson</who>
    <bug_when>2017-06-09 10:40:12 -0400</bug_when>
    <thetext>Created attachment 1286426
Patch to spec file to fix race condition

Proposed patch to fix the problem.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10513590</commentid>
    <comment_count>3</comment_count>
    <who name="Troy Dawson">tdawson</who>
    <bug_when>2017-06-16 11:40:55 -0400</bug_when>
    <thetext>This is a blocker for some projects.  We understand some people have limited time to fix packages.  If you do not have the time to fix this, or merge the patch, within two weeks, we will have a proven packager merge the suggested patch in and build it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10513656</commentid>
    <comment_count>4</comment_count>
    <who name="Hans de Goede">hdegoede</who>
    <bug_when>2017-06-16 12:00:49 -0400</bug_when>
    <thetext>Thank you for the bug-report and the patch.

A fixed package is building for rawhide now, closing.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1286426</attachid>
            <date>2017-06-09 10:40:00 -0400</date>
            <delta_ts>2017-06-09 10:40:12 -0400</delta_ts>
            <desc>Patch to spec file to fix race condition</desc>
            <filename>0001-Add-j1-to-make-to-fix-a-race-condition.patch</filename>
            <type>text/plain</type>
            <size>1417</size>
            <attacher name="Troy Dawson">tdawson</attacher>
            
              <data encoding="base64">RnJvbSBkM2RhOTk2OGMzYTQxMTQ0YjU5NTA4ZDQxMTBkMTlmZjA5MDM2NTEwIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBUcm95IERhd3NvbiA8dGRhd3NvbkByZWRoYXQuY29tPgpEYXRl
OiBGcmksIDkgSnVuIDIwMTcgMDc6Mzc6MzYgLTA3MDAKU3ViamVjdDogW1BBVENIXSBBZGQgLWox
IHRvIG1ha2UgdG8gZml4IGEgcmFjZSBjb25kaXRpb24uCgotLS0KIGd0LnNwZWMgfCA5ICsrKysr
Ky0tLQogMSBmaWxlIGNoYW5nZWQsIDYgaW5zZXJ0aW9ucygrKSwgMyBkZWxldGlvbnMoLSkKCmRp
ZmYgLS1naXQgYS9ndC5zcGVjIGIvZ3Quc3BlYwppbmRleCA1NGZhOTliLi40ZmQ0ZTVkIDEwMDY0
NAotLS0gYS9ndC5zcGVjCisrKyBiL2d0LnNwZWMKQEAgLTEsNiArMSw2IEBACiBOYW1lOiAgICAg
ICAgICAgZ3QKIFZlcnNpb246ICAgICAgICAwLjQKLVJlbGVhc2U6ICAgICAgICAyMyV7P2Rpc3R9
CitSZWxlYXNlOiAgICAgICAgMjQlez9kaXN0fQogU3VtbWFyeTogICAgICAgIE1vZGlmaWVkIFRp
bWlkaXR5IHdoaWNoIHN1cHBvcnRlcyBlbmhhbmNlZCBndXMgZm9ybWF0IHBhdGNoZXMKIEdyb3Vw
OiAgICAgICAgICBBcHBsaWNhdGlvbnMvTXVsdGltZWRpYQogTGljZW5zZTogICAgICAgIEdQTHYy
KwpAQCAtNTAsMTIgKzUwLDEyIEBAIGNwIC1wIHNyYy9SRUFETUUgUkVBRE1FLnRpbWlkaXR5CiAl
YnVpbGQKIGV4cG9ydCBDRkxBR1M9IiRSUE1fT1BUX0ZMQUdTIC1mc2lnbmVkLWNoYXIiCiAlY29u
ZmlndXJlCi1tYWtlICV7P19zbXBfbWZsYWdzfQorbWFrZSAtajEgJXs/X3NtcF9tZmxhZ3N9CiAK
IAogJWluc3RhbGwKIHJtIC1yZiAkUlBNX0JVSUxEX1JPT1QKLW1ha2UgaW5zdGFsbCBERVNURElS
PSRSUE1fQlVJTERfUk9PVAorbWFrZSAtajEgaW5zdGFsbCBERVNURElSPSRSUE1fQlVJTERfUk9P
VAogIyByZW5hbWUgc29tZXdoYXQgZ2VuZXJpY2x5IG5hbWVkIGRpbSB0byBtaWRpLWRpc2FzbQog
bXYgJFJQTV9CVUlMRF9ST09UJXtfYmluZGlyfS9kaW0gJFJQTV9CVUlMRF9ST09UJXtfYmluZGly
fS9taWRpLWRpc2FzbQogbXYgJFJQTV9CVUlMRF9ST09UJXtfbWFuZGlyfS9tYW4xL2RpbS4xIFwK
QEAgLTgzLDYgKzgzLDkgQEAgcm0gLXJmICRSUE1fQlVJTERfUk9PVAogCiAKICVjaGFuZ2Vsb2cK
KyogRnJpIEp1biAwOSAyMDE3IFRyb3kgRGF3c29uIDx0ZGF3c29uQHJlZGhhdC5jb20+IC0gMC40
LTI0CistIEFkZCAtajEgdG8gbWFrZSB0byBhZGRyZXNzIGEgcmFjZSBjb25kaXRpb24uCisKICog
RnJpIEZlYiAxMCAyMDE3IEZlZG9yYSBSZWxlYXNlIEVuZ2luZWVyaW5nIDxyZWxlbmdAZmVkb3Jh
cHJvamVjdC5vcmc+IC0gMC40LTIzCiAtIFJlYnVpbHQgZm9yIGh0dHBzOi8vZmVkb3JhcHJvamVj
dC5vcmcvd2lraS9GZWRvcmFfMjZfTWFzc19SZWJ1aWxkCiAKLS0gCjEuOC4zLjEKCg==
</data>

          </attachment>
      

    </bug>

</bugzilla>