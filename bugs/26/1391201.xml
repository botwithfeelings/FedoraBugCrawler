<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1391201</bug_id>
          
          <creation_ts>2016-11-02 15:03:00 -0400</creation_ts>
          <short_desc>Unable to start when MAXCONN configured for &gt; 1024</short_desc>
          <delta_ts>2017-03-22 05:57:09 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>memcached</component>
          <version>26</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter>hguemar</reporter>
          <assigned_to name="Paul Lindner">lindner</assigned_to>
          <cc>jorton</cc>
    
    
    <cc>lindner</cc>
    
    
    <cc>matthias</cc>
    
    
    <cc>mlichvar</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>memcached-1.4.34-1.fc26</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-03-22 05:57:09</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9849183</commentid>
    <comment_count>0</comment_count>
      <attachid>1216710</attachid>
    <who name="">hguemar</who>
    <bug_when>2016-11-02 15:03:32 -0400</bug_when>
    <thetext>Created attachment 1216710
Patch to spec file

Description of problem:

While rebuilding memcached for RDO, we found out this issue in upstream CI.
Upstream ticket has been created: https://github.com/memcached/memcached/issues/218

Version-Release number of selected component (if applicable):
memcached-1.4.33-2.fc26

How reproducible:
Always

Steps to Reproduce:
1.  https://gist.github.com/dmsimard/174971182870d03394f3f2223cf59412
Alternatively
1. change limits in /etc/sysconfig/memcached
2. systemctl restart memcached

Actual results:
crashes

Expected results:
shoyuld run

Additional info:
We fixed it in RDO package, distgit patch is attached</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9850806</commentid>
    <comment_count>1</comment_count>
    <who name="Matthias Saou">matthias</who>
    <bug_when>2016-11-03 06:05:59 -0400</bug_when>
    <thetext>Note that in these systemd times, it would probably be best to use &quot;User=memcached&quot; from the unit file, as with the increased LimitNOFILE the process doesn&apos;t need to be started as root to be able to increase that system value itself.

The upside is that the CapabilityBoundingSet change is no longer relevant.

The downside is for people editing the sysconfig file to run memcached as a user different from &quot;memcached&quot;... I honestly think no one does that, and even then, it would be as easy to add a User=foo than it is to modify the sysconfig file.

I have been using User=memcached myself for a while, because I also add RuntimeDirectory=memcached in order to use UNIX sockets created inside /run/memcached/ instead of TCP. And I had needed to increase LimitNOFILE too.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10191507</commentid>
    <comment_count>2</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2017-02-28 05:32:56 -0500</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 26 development cycle.
Changing version to &apos;26&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10264232</commentid>
    <comment_count>3</comment_count>
    <who name="Miroslav Lichvar">mlichvar</who>
    <bug_when>2017-03-22 05:57:09 -0400</bug_when>
    <thetext>It seems this was addressed in 1.4.34 by adding the CAP_SYS_RESOURCE capatibility. Thanks!</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1216710</attachid>
            <date>2016-11-02 15:03:00 -0400</date>
            <delta_ts>2016-11-02 15:03:32 -0400</delta_ts>
            <desc>Patch to spec file</desc>
            <filename>0001-Fix-systemd-service-when-setting-limits.patch</filename>
            <type>application/mbox</type>
            <size>2911</size>
            <attacher>hguemar</attacher>
            
              <data encoding="base64">RnJvbSBjMjY4MDI1ZDUxZDY4OTJkZWQyYjNkNzE3OGQ4YWI3ZmNmNmI0OTg1IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBIYWlrZWwgR3VlbWFyIDxoZ3VlbWFyQGZlZG9yYXByb2plY3Qu
b3JnPgpEYXRlOiBXZWQsIDIgTm92IDIwMTYgMTk6NTE6MDggKzAxMDAKU3ViamVjdDogW1BBVENI
XSBGaXggc3lzdGVtZCBzZXJ2aWNlIHdoZW4gc2V0dGluZyBsaW1pdHMKCi0tLQogMDAwMS1zeXN0
ZW1kLWZpeC11cHN0cmVhbS1wcm92aWRlZC1zZXJ2aWNlLnBhdGNoIHwgMzYgKysrKysrKysrKysr
KysrKysrKysrKysrCiBtZW1jYWNoZWQuc3BlYyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgfCAgOCArKysrLS0KIDIgZmlsZXMgY2hhbmdlZCwgNDIgaW5zZXJ0aW9ucygrKSwgMiBk
ZWxldGlvbnMoLSkKIGNyZWF0ZSBtb2RlIDEwMDY0NCAwMDAxLXN5c3RlbWQtZml4LXVwc3RyZWFt
LXByb3ZpZGVkLXNlcnZpY2UucGF0Y2gKCmRpZmYgLS1naXQgYS8wMDAxLXN5c3RlbWQtZml4LXVw
c3RyZWFtLXByb3ZpZGVkLXNlcnZpY2UucGF0Y2ggYi8wMDAxLXN5c3RlbWQtZml4LXVwc3RyZWFt
LXByb3ZpZGVkLXNlcnZpY2UucGF0Y2gKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MC4uZGNjZDRiYwotLS0gL2Rldi9udWxsCisrKyBiLzAwMDEtc3lzdGVtZC1maXgtdXBzdHJlYW0t
cHJvdmlkZWQtc2VydmljZS5wYXRjaApAQCAtMCwwICsxLDM2IEBACitGcm9tIDRiZDAwNmY3ODJi
ZmMwNTkwMWQ4ZDk2NjM2NjZmYWM5MjM2YWY2NGUgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCitG
cm9tOiBIYWlrZWwgR3VlbWFyIDxoZ3VlbWFyQGZlZG9yYXByb2plY3Qub3JnPgorRGF0ZTogV2Vk
LCAyIE5vdiAyMDE2IDE5OjQ0OjM4ICswMTAwCitTdWJqZWN0OiBbUEFUQ0hdIHN5c3RlbWQ6IGZp
eCB1cHN0cmVhbSBwcm92aWRlZCBzZXJ2aWNlCisKK21lbWNhY2hlZCBmYWlscyBpZiB5b3UgdHJ5
IHRvIGNoYW5nZSBjb25uZWN0aW9uIGxpbWl0cyB3aGVuIGRyb3BwaW5nCitjYXBhYmlsaXRpZXMu
CisKK0lzc3VlIHJlcG9ydGVkIHVwc3RyZWFtOiBodHRwczovL2dpdGh1Yi5jb20vbWVtY2FjaGVk
L21lbWNhY2hlZC9pc3N1ZXMvMjE4CistLS0KKyBzY3JpcHRzL21lbWNhY2hlZC5zZXJ2aWNlIHwg
MiArKworIDEgZmlsZSBjaGFuZ2VkLCAyIGluc2VydGlvbnMoKykKKworZGlmZiAtLWdpdCBhL3Nj
cmlwdHMvbWVtY2FjaGVkLnNlcnZpY2UgYi9zY3JpcHRzL21lbWNhY2hlZC5zZXJ2aWNlCitpbmRl
eCBhOTY0NDViLi5kYTA4YmYzIDEwMDY0NAorLS0tIGEvc2NyaXB0cy9tZW1jYWNoZWQuc2Vydmlj
ZQorKysrIGIvc2NyaXB0cy9tZW1jYWNoZWQuc2VydmljZQorQEAgLTExLDYgKzExLDcgQEAKKyAK
KyBbVW5pdF0KKyBEZXNjcmlwdGlvbj1tZW1jYWNoZWQgZGFlbW9uCisrQmVmb3JlPWh0dHBkLnNl
cnZpY2UKKyBBZnRlcj1uZXR3b3JrLnRhcmdldAorIAorIFtTZXJ2aWNlXQorQEAgLTM1LDYgKzM2
LDcgQEAgUHJpdmF0ZURldmljZXM9dHJ1ZQorIAorICMgUmVxdWlyZWQgZm9yIGRyb3BwaW5nIHBy
aXZpbGVnZXMgYW5kIHJ1bm5pbmcgYXMgYSBkaWZmZXJlbnQgdXNlcgorIENhcGFiaWxpdHlCb3Vu
ZGluZ1NldD1DQVBfU0VUR0lEIENBUF9TRVRVSUQKKytMaW1pdE5PRklMRT0xNjM4NAorIAorICMg
QXR0ZW1wdHMgdG8gY3JlYXRlIG1lbW9yeSBtYXBwaW5ncyB0aGF0IGFyZSB3cml0YWJsZSBhbmQg
ZXhlY3V0YWJsZSBhdCB0aGUgc2FtZSB0aW1lLAorICMgb3IgdG8gY2hhbmdlIGV4aXN0aW5nIG1l
bW9yeSBtYXBwaW5ncyB0byBiZWNvbWUgZXhlY3V0YWJsZSBhcmUgcHJvaGliaXRlZC4KKy0tIAor
Mi45LjMKKwpkaWZmIC0tZ2l0IGEvbWVtY2FjaGVkLnNwZWMgYi9tZW1jYWNoZWQuc3BlYwppbmRl
eCBhZjJhNGI2Li45ZmZjMjZiIDEwMDY0NAotLS0gYS9tZW1jYWNoZWQuc3BlYworKysgYi9tZW1j
YWNoZWQuc3BlYwpAQCAtNCw3ICs0LDcgQEAKIAogTmFtZTogICAgICAgICAgIG1lbWNhY2hlZAog
VmVyc2lvbjogICAgICAgIDEuNC4zMwotUmVsZWFzZTogICAgICAgIDElez9kaXN0fQorUmVsZWFz
ZTogICAgICAgIDIlez9kaXN0fQogRXBvY2g6ICAgICAgICAgIDAKIFN1bW1hcnk6ICAgICAgICBI
aWdoIFBlcmZvcm1hbmNlLCBEaXN0cmlidXRlZCBNZW1vcnkgT2JqZWN0IENhY2hlCiAKQEAgLTE0
LDcgKzE0LDggQEAgVVJMOiAgICAgICAgICAgIGh0dHA6Ly93d3cubWVtY2FjaGVkLm9yZy8KIFNv
dXJjZTA6ICAgICAgICBodHRwOi8vd3d3Lm1lbWNhY2hlZC5vcmcvZmlsZXMvJXtuYW1lfS0le3Zl
cnNpb259LnRhci5negogU291cmNlMTogICAgICAgIG1lbWNhY2hlZC5zeXNjb25maWcKIAotUGF0
Y2gxOiAgICAgICAgIG1lbWNhY2hlZC11bml0LnBhdGNoCisjIGh0dHBzOi8vZ2l0aHViLmNvbS9t
ZW1jYWNoZWQvbWVtY2FjaGVkL2lzc3Vlcy8yMTgKK1BhdGNoMTogICAgICAgICAwMDAxLXN5c3Rl
bWQtZml4LXVwc3RyZWFtLXByb3ZpZGVkLXNlcnZpY2UucGF0Y2gKIAogQnVpbGRSZXF1aXJlczog
IGxpYmV2ZW50LWRldmVsIHN5c3RlbWQtdW5pdHMKIEJ1aWxkUmVxdWlyZXM6ICBwZXJsLWdlbmVy
YXRvcnMKQEAgLTEyMSw2ICsxMjIsOSBAQCBleGl0IDAKICV7X2luY2x1ZGVkaXJ9L21lbWNhY2hl
ZC8qCiAKICVjaGFuZ2Vsb2cKKyogV2VkIE5vdiAgMiAyMDE2IEhhw69rZWwgR3XDqW1hciA8aGd1
ZW1hckBmZWRvcmFwcm9qZWN0Lm9yZz4gLSAwOjEuNC4zMy0yCistIEZpeCBzeXN0ZW1kIHNlcnZp
Y2Ugd2hlbiBzZXR0aW5nIGxpbWl0cworCiAqIFR1ZSBOb3YgMDEgMjAxNiBNaXJvc2xhdiBMaWNo
dmFyIDxtbGljaHZhckByZWRoYXQuY29tPiAtIDA6MS40LjMzLTEKIC0gdXBkYXRlIHRvIDEuNC4z
MyAoQ1ZFLTIwMTYtODcwNCwgQ1ZFLTIwMTYtODcwNSwgQ1ZFLTIwMTYtODcwNikKIAotLSAKMi45
LjMKCg==
</data>

          </attachment>
      

    </bug>

</bugzilla>