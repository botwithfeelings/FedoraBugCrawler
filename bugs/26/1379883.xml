<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1379883</bug_id>
          
          <creation_ts>2016-09-27 21:11:00 -0400</creation_ts>
          <short_desc>File conflict file /usr/share/themes/Numix/gtk-3.0/assets with latest update</short_desc>
          <delta_ts>2017-05-04 10:52:32 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>numix-gtk-theme</component>
          <version>26</version>
          <rep_platform>All</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          <see_also>https://bugzilla.redhat.com/show_bug.cgi?id=1352499</see_also>
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords>Reopened</keywords>
          <priority>unspecified</priority>
          <bug_severity>medium</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Eric Griffith">EGriffith92</reporter>
          <assigned_to name="Sascha Spreitzer">sspreitz</assigned_to>
          <cc>EGriffith92</cc>
    
    
    <cc>sspreitz</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>2.6.6-2 numix-gtk-theme-2.6.6-2.fc24 numix-gtk-theme-2.6.6-2.fc25 numix-gtk-theme-2.6.6-2.el7</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-04-26 14:21:04</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9748772</commentid>
    <comment_count>0</comment_count>
    <who name="Eric Griffith">EGriffith92</who>
    <bug_when>2016-09-27 21:11:59 -0400</bug_when>
    <thetext>Error: Transaction check error:
  file /usr/share/themes/Numix/gtk-3.0/assets from install of numix-gtk-theme-2.6.4-1.fc26.noarch conflicts with file from package numix-gtk-theme-2.6.0-1.fc25.noarch

Can work around by uninstall numix-gtk-theme and re-installing the new version, but errors like this are bad for the user experience.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9749302</commentid>
    <comment_count>1</comment_count>
    <who name="Sascha Spreitzer">sspreitz</who>
    <bug_when>2016-09-28 03:06:11 -0400</bug_when>
    <thetext>Hi Eric

Thanks for bringing this up! 
Actually I am working on this issue. You shouldn&apos;t have seen this as the update packages where unpushed by me in bodhi.

Did you manually download and install the package?

It looks like that the RPM update fails as rpm is unpacking the new files over a symlink which is then dereferenced.
These symlinked asset directories have changed with the new version and it looks like it can not be handled with the ordinare RPM scriptlets. 

It might need to be solved via a lua %pretrans scriptlet, removing the symlink before installing the update.

Kind regards
Sascha</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9753767</commentid>
    <comment_count>2</comment_count>
    <who name="Sascha Spreitzer">sspreitz</who>
    <bug_when>2016-09-29 09:26:02 -0400</bug_when>
    <thetext>Hi Eric

Did you manually download and install the package?

Kind regards
Sascha</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9754802</commentid>
    <comment_count>3</comment_count>
    <who name="Eric Griffith">EGriffith92</who>
    <bug_when>2016-09-29 13:28:27 -0400</bug_when>
    <thetext>Nope, just a standard &apos;dnf update.&apos; It errored out originally sometime in the afternoon. I eventually said &apos;screw it&apos; and removed the package around 9 EST, made the bug report soon thereafter. 

Even when I did &apos;dnf update --refresh&apos; around 20:30, it still wanted to install the bad update. So I&apos;m not sure why Bodhi didnt actually yank it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>9756267</commentid>
    <comment_count>4</comment_count>
    <who name="Sascha Spreitzer">sspreitz</who>
    <bug_when>2016-09-30 03:33:50 -0400</bug_when>
    <thetext>Apparently this is not good news. I will investigate this further. Thanks for your input!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10191319</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2017-02-28 05:21:55 -0500</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 26 development cycle.
Changing version to &apos;26&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10342901</commentid>
    <comment_count>6</comment_count>
    <who name="Sascha Spreitzer">sspreitz</who>
    <bug_when>2017-04-18 14:41:30 -0400</bug_when>
    <thetext>Hi there

So this one was quite challenging. They way it is solved will print some unpretty warnings from RPM update that some files have gone missing, but that is still better then failing.

The directories will be changed into symlinks, which RPM can not do.

----
# This is to clean up directories before links created
# See https://bugzilla.redhat.com/show_bug.cgi?id=1379883
# See https://fedoraproject.org/wiki/Packaging:Directory_Replacement
%pretrans -p &lt;lua&gt;
directories = {
  &quot;/usr/share/themes/Numix/gtk-3.0/assets&quot;,
  &quot;/usr/share/themes/Numix/gtk-3.2/assets&quot;
}
for i,path in ipairs(directories) do
  st = posix.stat(path)
  if st and st.type == &quot;directory&quot; then
    status = os.rename(path, path .. &quot;.rpmmoved&quot;)
    if not status then
      suffix = 0
      while not status do
        suffix = suffix + 1
        status = os.rename(path .. &quot;.rpmmoved&quot;, path .. &quot;.rpmmoved.&quot; .. suffix)
      end
      os.rename(path, path .. &quot;.rpmmoved&quot;)
    end
  end
end
----

The update package is currently pending version 2.6.6-2

Kind regards
Sascha</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10342904</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-18 14:46:57 -0400</bug_when>
    <thetext>numix-gtk-theme-2.6.6-2.fc24 has been submitted as an update to Fedora 24. https://bodhi.fedoraproject.org/updates/FEDORA-2017-ca8e3b178c</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10342910</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-18 14:47:31 -0400</bug_when>
    <thetext>numix-gtk-theme-2.6.6-2.fc25 has been submitted as an update to Fedora 25. https://bodhi.fedoraproject.org/updates/FEDORA-2017-685dde844d</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10342913</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-18 14:48:11 -0400</bug_when>
    <thetext>numix-gtk-theme-2.6.6-2.el7 has been submitted as an update to Fedora EPEL 7. https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2017-cee0159755</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10345055</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-19 05:49:50 -0400</bug_when>
    <thetext>numix-gtk-theme-2.6.6-2.el7 has been pushed to the Fedora EPEL 7 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-EPEL-2017-cee0159755</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10345236</commentid>
    <comment_count>11</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-19 06:55:32 -0400</bug_when>
    <thetext>numix-gtk-theme-2.6.6-2.fc24 has been pushed to the Fedora 24 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-ca8e3b178c</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10345256</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-19 06:56:51 -0400</bug_when>
    <thetext>numix-gtk-theme-2.6.6-2.fc25 has been pushed to the Fedora 25 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-685dde844d</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10365857</commentid>
    <comment_count>13</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-26 14:21:04 -0400</bug_when>
    <thetext>numix-gtk-theme-2.6.6-2.fc24 has been pushed to the Fedora 24 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10367161</commentid>
    <comment_count>14</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-27 01:52:04 -0400</bug_when>
    <thetext>numix-gtk-theme-2.6.6-2.fc25 has been pushed to the Fedora 25 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10386477</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-04 10:52:32 -0400</bug_when>
    <thetext>numix-gtk-theme-2.6.6-2.el7 has been pushed to the Fedora EPEL 7 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>