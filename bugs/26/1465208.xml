<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1465208</bug_id>
          
          <creation_ts>2017-06-26 20:48:00 -0400</creation_ts>
          <short_desc>Unlocking disk from dracut is broken</short_desc>
          <delta_ts>2017-07-06 18:50:09 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>clevis</component>
          <version>26</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard>AcceptedFreezeException</status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>high</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1349189</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Nathaniel McCallum">npmccallum</reporter>
          <assigned_to name="Nathaniel McCallum">npmccallum</assigned_to>
          <cc>awilliam</cc>
    
    
    <cc>mattdm</cc>
    
    
    <cc>npmccallum</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>clevis-6-1.fc26</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-07-06 18:50:09</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10542152</commentid>
    <comment_count>0</comment_count>
    <who name="Nathaniel McCallum">npmccallum</who>
    <bug_when>2017-06-26 20:48:48 -0400</bug_when>
    <thetext>This is fixes in clevis v5. We need to rebase.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10542183</commentid>
    <comment_count>1</comment_count>
    <who name="Fedora Blocker Bugs Application">blockerbugs</who>
    <bug_when>2017-06-26 20:54:52 -0400</bug_when>
    <thetext>Proposed as a Freeze Exception for 26-final by Fedora user npmccallum using the blocker tracking app because:

 Currently, F26 will ship with Clevis v4. Clevis provides unlocking during early boot. However, we discovered an issue where Clevis doesn&apos;t work in dracut. This was fixed in v5. Additionally, in v5 we offload processing of untrusted data to an unprivileged user. These are the only two changes in this release.

Normally, I would be fine with being in the first batch of updates. However, if clevis-dracut is installed during initial installation an initramfs will be generated with the broken code and users will have to follow a manual process to fix this. However, if we land Clevis v5 in the initial release, the installer will generate a working initramfs.

An update already exists which fixes this problem (we just missed the cut off): https://bodhi.fedoraproject.org/updates/FEDORA-2017-eba47499b6</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10543798</commentid>
    <comment_count>2</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-27 08:03:05 -0400</bug_when>
    <thetext>clevis-6-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-eba47499b6</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10543799</commentid>
    <comment_count>3</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-27 08:03:13 -0400</bug_when>
    <thetext>clevis-6-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-eba47499b6</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10543808</commentid>
    <comment_count>4</comment_count>
    <who name="Nathaniel McCallum">npmccallum</who>
    <bug_when>2017-06-27 08:04:27 -0400</bug_when>
    <thetext>We discovered an unrelated security issue upstream and released v6. Everything else still applies.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10545640</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-27 16:24:34 -0400</bug_when>
    <thetext>clevis-6-1.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-eba47499b6</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10554722</commentid>
    <comment_count>6</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2017-06-29 15:29:26 -0400</bug_when>
    <thetext>Discussed at 2017-06-29 freeze exception review meeting: https://meetbot-raw.fedoraproject.org/fedora-blocker-review/2017-06-29/f26-blocker-review.2017-06-29-16.00.html . We accepted this as a freeze exception; usually installs will include the stable &apos;updates&apos; repository so just shipping this as a regular update would be OK, but it&apos;s possible someone might use a kickstart without the updates repo enabled, and clevis isn&apos;t on any install media so far as we know so pushing it stable should be quite safe.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10554723</commentid>
    <comment_count>7</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2017-06-29 15:30:17 -0400</bug_when>
    <thetext>Note, the update still won&apos;t get into the final compose unless it is submitted for stable.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10559652</commentid>
    <comment_count>8</comment_count>
    <who name="Matthew Miller">mattdm</who>
    <bug_when>2017-07-02 11:00:37 -0400</bug_when>
    <thetext>&gt; Normally, I would be fine with being in the first batch of updates. However,
&gt; if clevis-dracut is installed during initial installation an initramfs will
&gt; be generated with the broken code and users will have to follow a manual
&gt; process to fix this. However, if we land Clevis v5 in the initial release,

Is this manual process documented somewhere? I don&apos;t see it in Common Bugs. I know the release notes are in non-ideal state, but if this doesn&apos;t get in we should document it there. Or, actually, we should document it for anyone who installed during the beta period.

How does this affect people who are upgrading from older releases?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10559814</commentid>
    <comment_count>9</comment_count>
    <who name="Nathaniel McCallum">npmccallum</who>
    <bug_when>2017-07-02 14:58:24 -0400</bug_when>
    <thetext>The manual step is dracut -f.

However, this should only be required if no new kernel or dracut was shipped after beta. Otherwise, the initramfs will be rebuilt anyway.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10559817</commentid>
    <comment_count>10</comment_count>
    <who name="Nathaniel McCallum">npmccallum</who>
    <bug_when>2017-07-02 15:01:39 -0400</bug_when>
    <thetext>Beta shipped with kernel-4.11.0-2.fc26 and it appears the final release will ship with kernel-4.11.7-300.fc26. So the initramfs will be regenerated automatically during updates to the latest packages.

In short, no problem.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10571927</commentid>
    <comment_count>11</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-07-06 18:50:09 -0400</bug_when>
    <thetext>clevis-6-1.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>