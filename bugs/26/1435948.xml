<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1435948</bug_id>
          
          <creation_ts>2017-03-26 00:16:00 -0400</creation_ts>
          <short_desc>FTBFS: Cassandra fails to (re)build generated thrift files from source</short_desc>
          <delta_ts>2017-04-18 15:57:32 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>cassandra</component>
          <version>26</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Christopher Tubbs">ctubbsii</reporter>
          <assigned_to name="Tomas Repik">trepik</assigned_to>
          <cc>trepik</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>cassandra-3.9-8.fc26</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-04-18 15:57:32</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10277255</commentid>
    <comment_count>0</comment_count>
      <attachid>1266494</attachid>
    <who name="Christopher Tubbs">ctubbsii</who>
    <bug_when>2017-03-26 00:16:49 -0400</bug_when>
    <thetext>Created attachment 1266494
Force thrift files to be generated during the build

Description of problem:

After updating thrift to version 0.10.0, Cassandra fails to build from source in F26 and rawhide, due to an API change in libthrift.jar affecting compatibility with  thrift generated java files from previous versions.

The cassandra upstream appears to version-control the thrift generated source files, and the corresponding Fedora package does not rebuild them during packaging like it should.

I&apos;ve attached a patch which I believe correctly triggers a rebuild of the generated thrift files by deleting the old ones and including the `gen-thrift-java` ant target.

However, when I was testing this, I noticed that ant produced messages indicating it was downloading files from Maven Central during the build. This might be a misleading message, and it may or may not be related to adding the gen-thrift-java target to the ant build. This should be verified and corrected by the package maintainers, since Fedora builds should work offline.

I&apos;m not proficient with ant, but have begun learning it, and am willing to provide assistance getting things working with the latest thrift.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10278050</commentid>
    <comment_count>1</comment_count>
    <who name="Tomas Repik">trepik</who>
    <bug_when>2017-03-27 01:47:33 -0400</bug_when>
    <thetext>Thanks for your initiative, I&apos;m currently working on back-porting a patch from upstream that completely removes thrift as a dependency. I think this is the way to go, as the thrift interface is deprecated for a long time and will be gone in the next major version release. I want to make this change before cassandra becomes supported in a stable release of fedora.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10286205</commentid>
    <comment_count>2</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-29 04:09:29 -0400</bug_when>
    <thetext>cassandra-3.9-7.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-c33dfdc0a7</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10288039</commentid>
    <comment_count>3</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-03-29 13:50:12 -0400</bug_when>
    <thetext>cassandra-3.9-7.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-c33dfdc0a7</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10305595</commentid>
    <comment_count>4</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-05 02:57:02 -0400</bug_when>
    <thetext>cassandra-3.9-8.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-c33dfdc0a7</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10308390</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-05 17:53:41 -0400</bug_when>
    <thetext>cassandra-3.9-8.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-c33dfdc0a7</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10343084</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-04-18 15:57:32 -0400</bug_when>
    <thetext>cassandra-3.9-8.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1266494</attachid>
            <date>2017-03-26 00:16:00 -0400</date>
            <delta_ts>2017-03-26 00:16:49 -0400</delta_ts>
            <desc>Force thrift files to be generated during the build</desc>
            <filename>update-thrift-to-0.10.0.patch</filename>
            <type>text/plain</type>
            <size>1538</size>
            <attacher name="Christopher Tubbs">ctubbsii</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL2Nhc3NhbmRyYS10aHJpZnQtMy45LnBvbSBiL2Nhc3NhbmRyYS10aHJpZnQt
My45LnBvbQppbmRleCAxYzYxZjgzLi5mNjNjOWJlIDEwMDY0NAotLS0gYS9jYXNzYW5kcmEtdGhy
aWZ0LTMuOS5wb20KKysrIGIvY2Fzc2FuZHJhLXRocmlmdC0zLjkucG9tCkBAIC0xNjMsNyArMTYz
LDcgQEAKICAgICA8ZGVwZW5kZW5jeT4KICAgICAgIDxncm91cElkPm9yZy5hcGFjaGUudGhyaWZ0
PC9ncm91cElkPgogICAgICAgPGFydGlmYWN0SWQ+bGlidGhyaWZ0PC9hcnRpZmFjdElkPgotICAg
ICAgPHZlcnNpb24+MC45LjI8L3ZlcnNpb24+CisgICAgICA8dmVyc2lvbj4wLjEwLjA8L3ZlcnNp
b24+CiAgICAgICA8ZXhjbHVzaW9ucz4KICAgICAgICAgPGV4Y2x1c2lvbj4KICAgICAgICAgICA8
YXJ0aWZhY3RJZD5jb21tb25zLWxvZ2dpbmc8L2FydGlmYWN0SWQ+CmRpZmYgLS1naXQgYS9jYXNz
YW5kcmEuc3BlYyBiL2Nhc3NhbmRyYS5zcGVjCmluZGV4IDY2ODYyN2EuLjk5ODNiOTggMTAwNjQ0
Ci0tLSBhL2Nhc3NhbmRyYS5zcGVjCisrKyBiL2Nhc3NhbmRyYS5zcGVjCkBAIC0xMjQsNiArMTI0
LDggQEAgQnVpbGRSZXF1aXJlczoJJXs/c2NsX3ByZWZpeH1vaGMtY29yZS1qOAogI0J1aWxkUmVx
dWlyZXM6CWhhZG9vcC1jb21tb24KICNCdWlsZFJlcXVpcmVzOgloYWRvb3AtbWFwcmVkdWNlCiAK
K0J1aWxkUmVxdWlyZXM6ICAlez9zY2xfcHJlZml4fXRocmlmdAorCiAlZGVzY3JpcHRpb24gamF2
YS1saWJzCiBBbGwgdGhlIGNsYXNzZXMgcmVxdWlyZWQgYnkgY2Fzc2FuZHJhIHNlcnZlciwgbm9k
ZXRvb2wsIHNzdGFibGUgdG9vbHMKIGFuZCBzdHJlc3MgdG9vbHMuCkBAIC0yMDAsNiArMjAyLDEw
IEBAIFRoaXMgcGFja2FnZSBjb250YWlucyB0aGUgQVBJIGRvY3VtZW50YXRpb24gZm9yICV7cGtn
X25hbWV9LgogY3AgLXByICV7cGtnX25hbWV9LSV7cGtnX25hbWV9LSV7dmVyc2lvbn0vKiAuCiBy
bSAtciAle3BrZ19uYW1lfS0le3BrZ19uYW1lfS0le3ZlcnNpb259CiAKKyMgZm9yY2UgcmVnZW5l
cmF0aW5nIHRocmlmdCBjb2RlIGZyb20gc291cmNlCitzZWQgLWkgLWUgJ3MvLS1nZW4gamF2YTpo
YXNoY29kZS8tLWdlbiBqYXZhOmdlbmVyYXRlZF9hbm5vdGF0aW9ucz11bmRhdGVkLycgYnVpbGQu
eG1sCitybSAtciBpbnRlcmZhY2UvdGhyaWZ0L2dlbi1qYXZhLworCiAjIHJlbW92ZSBiaW5hcnkg
YW5kIGxpYnJhcnkgZmlsZXMKIGZpbmQgLW5hbWUgIiouY2xhc3MiIC1wcmludCAtZGVsZXRlCiBm
aW5kIC1uYW1lICIqLmphciIgLXByaW50IC1kZWxldGUKQEAgLTM1MCw3ICszNTYsNyBAQCBidWls
ZC1qYXItcmVwb3NpdG9yeSBsaWIgamF2YXguaW5qZWN0CiAKICVidWlsZAogJXs/c2NsOnNjbCBl
bmFibGUgJXtzY2xfbWF2ZW59ICV7c2NsfSAtIDw8ICJFT0YifQotYW50IGphciBqYXZhZG9jIC1E
cmVsZWFzZT10cnVlIAorYW50IGdlbi10aHJpZnQtamF2YSBqYXIgamF2YWRvYyAtRHJlbGVhc2U9
dHJ1ZQogJXs/c2NsOkVPRn0KIAogIyBCdWlsZCB0aGUgY3Fsc2hsaWIgUHl0aG9uIG1vZHVsZQo=
</data>

          </attachment>
      

    </bug>

</bugzilla>