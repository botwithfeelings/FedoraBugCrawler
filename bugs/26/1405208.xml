<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1405208</bug_id>
          
          <creation_ts>2016-12-15 16:12:00 -0500</creation_ts>
          <short_desc>AArch64 systems fail to display the grub menu when PXE booted and instead drop to a grub prompt</short_desc>
          <delta_ts>2017-06-29 19:28:12 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>grub2</component>
          <version>26</version>
          <rep_platform>aarch64</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard></status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>245418</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Paul Whalen">pwhalen</reporter>
          <assigned_to name="Peter Jones">pjones</assigned_to>
          <cc>jcm</cc>
    
    
    <cc>jeremy.linton</cc>
    
    
    <cc>lkundrak</cc>
    
    
    <cc>msalter</cc>
    
    
    <cc>pbrobinson</cc>
    
    
    <cc>pjones</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>grub-2.02-0.40.fc26 grub2-2.02-0.40.fc26</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-06-29 19:28:12</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>9991348</commentid>
    <comment_count>0</comment_count>
    <who name="Paul Whalen">pwhalen</who>
    <bug_when>2016-12-15 16:12:04 -0500</bug_when>
    <thetext>Description of problem:
AArch64 systems fail to display the grub menu when PXE booted and instead drop to a grub prompt. 

Version-Release number of selected component (if applicable):
grub2-efi-2.02-0.38.fc26.aarch64.rpm

How reproducible:
Everytime, tested on both mustang and seattle systems. 

Steps to Reproduce:
1. Use the latest from Rawhide compose - Fedora-Rawhide-20161214.n.1
2. Attempt to pxe boot the system using BOOTAA64.EFI 


Actual results:
grub prompt displayed

Expected results:
grub.cfg loaded, menu displayed.

Additional info:
Booting from USB using either BOOTAA64.EFI or grubaa64.efi works on the mustang.
Last known working with PXE - grub2-efi-2.02-0.34.fc26.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10191749</commentid>
    <comment_count>1</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2017-02-28 05:48:04 -0500</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 26 development cycle.
Changing version to &apos;26&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10206994</commentid>
    <comment_count>2</comment_count>
    <who name="Mark Salter">msalter</who>
    <bug_when>2017-03-03 12:35:54 -0500</bug_when>
    <thetext>I&apos;m unable to reproduce this with latest (Fedora-Rawhide-20170303.n.0). It pxe boots fine on a AMD Seattle system using firmware ROD1002C</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10207009</commentid>
    <comment_count>3</comment_count>
    <who name="Peter Robinson">pbrobinson</who>
    <bug_when>2017-03-03 12:41:04 -0500</bug_when>
    <thetext>(In reply to Mark Salter from comment #2)
&gt; I&apos;m unable to reproduce this with latest (Fedora-Rawhide-20170303.n.0). It
&gt; pxe boots fine on a AMD Seattle system using firmware ROD1002C

Are you using the grub that ships with the latest image in the PXE config?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10207411</commentid>
    <comment_count>4</comment_count>
    <who name="Mark Salter">msalter</who>
    <bug_when>2017-03-03 14:39:30 -0500</bug_when>
    <thetext>I used grubaa64.efi from grub2-efi-2.02-0.38.fc26.aarch64.rpm. But you got me to thinking, so I grabbed the BOOTAA64.EFI and grubaa64.efi from the os/EFI directory and used those successfully also.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10221549</commentid>
    <comment_count>5</comment_count>
      <attachid>1261314</attachid>
    <who name="Mark Salter">msalter</who>
    <bug_when>2017-03-08 09:51:32 -0500</bug_when>
    <thetext>Created attachment 1261314
fix malformed tftp packets

After chatting with pwhalen about this, I was able to reproduce by moving the grub file to the top level tftp dir. I did a packet capture and saw corrupted tftp read requests. There appeared to be an extra byte between the filename and type fields in the read request. This turned out to be caused by a downstream patch:

0088-Normalize-slashes-in-tftp-paths.patch

This patch collapses contiguous slashes in a filename to a single slash in the tftp packet. But it still advanced the packet buffer pointer and len based on length of original name. Anyway, an easy fix. Patch atteched.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10541830</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-26 17:27:38 -0400</bug_when>
    <thetext>grub2-2.02-0.40.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-01b07bc086</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10545646</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-27 16:24:50 -0400</bug_when>
    <thetext>grub2-2.02-0.40.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-01b07bc086</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10555078</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-29 19:28:12 -0400</bug_when>
    <thetext>grub2-2.02-0.40.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1261314</attachid>
            <date>2017-03-08 09:51:00 -0500</date>
            <delta_ts>2017-03-08 09:51:32 -0500</delta_ts>
            <desc>fix malformed tftp packets</desc>
            <filename>0001-Fix-malformed-tftp-packets.patch</filename>
            <type>text/plain</type>
            <size>1324</size>
            <attacher name="Mark Salter">msalter</attacher>
            
              <data encoding="base64">RnJvbSBjY2UwYWE1Nzk1MWJiMDU5YWU3YTFhYzJhNzJmNzM4MDYyYTg3MWFmIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBNYXJrIFNhbHRlciA8bXNhbHRlckByZWRoYXQuY29tPgpEYXRl
OiBUdWUsIDcgTWFyIDIwMTcgMTg6MjY6MTcgLTA1MDAKU3ViamVjdDogW1BBVENIXSBGaXggbWFs
Zm9ybWVkIHRmdHAgcGFja2V0cwoKMDA4OC1Ob3JtYWxpemUtc2xhc2hlcy1pbi10ZnRwLXBhdGhz
LnBhdGNoIGNvbGxhcHNlcyBtdWx0aXBsZSBjb250aWd1b3VzCnNsYXNoZXMgaW4gYSBmaWxlbmFt
ZSBpbnRvIG9uZSBzbGFzaCBpbiB0aGUgdGZ0cCBwYWNrZXQgZmlsZW5hbWUgZmllbGQuCkhvd2V2
ZXIsIHRoZSBwYWNrZXQgYnVmZmVyIHBvaW50ZXIgaXMgYWR2YW5jZWQgdXNpbmcgdGhlIG9yaWdp
bmFsIG5hbWUuClRoaXMgbGVhdmVzIHVuaXRpYWxpemVkIGRhdGEgYmV0d2VlbiB0aGUgbmFtZSBm
aWVsZCBhbmQgdGhlIHR5cGUgZmllbGQKbGVhZGluZyB0byB0ZnRwIGVycm9ycy4gVXNlIHRoZSBs
ZW5ndGggb2YgdGhlIG5vcm1hbGl6ZWQgbmFtZSB0byBhdm9pZAp0aGlzLgoKU2lnbmVkLW9mZi1i
eTogTWFyayBTYWx0ZXIgPG1zYWx0ZXJAcmVkaGF0LmNvbT4KLS0tCiBncnViLWNvcmUvbmV0L3Rm
dHAuYyB8IDQgKystLQogMSBmaWxlIGNoYW5nZWQsIDIgaW5zZXJ0aW9ucygrKSwgMiBkZWxldGlv
bnMoLSkKCmRpZmYgLS1naXQgYS9ncnViLWNvcmUvbmV0L3RmdHAuYyBiL2dydWItY29yZS9uZXQv
dGZ0cC5jCmluZGV4IDYzYmJjMjguLmM0YjUyMDUgMTAwNjQ0Ci0tLSBhL2dydWItY29yZS9uZXQv
dGZ0cC5jCisrKyBiL2dydWItY29yZS9uZXQvdGZ0cC5jCkBAIC0zNjAsOCArMzYwLDggQEAgdGZ0
cF9vcGVuIChzdHJ1Y3QgZ3J1Yl9maWxlICpmaWxlLCBjb25zdCBjaGFyICpmaWxlbmFtZSkKICAg
LyogQ29weSBhbmQgbm9ybWFsaXplIHRoZSBmaWxlbmFtZSB0byB3b3JrLWFyb3VuZCBpc3N1ZXMg
b24gc29tZSB0ZnRwCiAgICAgIHNlcnZlcnMgd2hlbiBmaWxlIG5hbWVzIGFyZSBiZWluZyBtYXRj
aGVkIGZvciByZW1hcHBpbmcuICovCiAgIGdydWJfbm9ybWFsaXplX2ZpbGVuYW1lIChycnEsIGZp
bGVuYW1lKTsKLSAgcnJxbGVuICs9IGdydWJfc3RybGVuIChmaWxlbmFtZSkgKyAxOwotICBycnEg
Kz0gZ3J1Yl9zdHJsZW4gKGZpbGVuYW1lKSArIDE7CisgIHJycWxlbiArPSBncnViX3N0cmxlbiAo
cnJxKSArIDE7CisgIHJycSArPSBncnViX3N0cmxlbiAocnJxKSArIDE7CiAKICAgZ3J1Yl9zdHJj
cHkgKHJycSwgIm9jdGV0Iik7CiAgIHJycWxlbiArPSBncnViX3N0cmxlbiAoIm9jdGV0IikgKyAx
OwotLSAKMi45LjMKCg==
</data>

          </attachment>
      

    </bug>

</bugzilla>