<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1454854</bug_id>
          
          <creation_ts>2017-05-23 11:05:00 -0400</creation_ts>
          <short_desc>DNF progress.start() broken with 2.5.0, breaking dnfdaemon (and dnfdragora)</short_desc>
          <delta_ts>2017-06-12 12:48:52 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>dnfdaemon</component>
          <version>26</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard>AcceptedBlocker</status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>high</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1349188</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Jerry Amundson">jamundso</reporter>
          <assigned_to name="Björn &quot;besser82&quot; Esser">besser82</assigned_to>
          <cc>awilliam</cc>
    
    
    <cc>besser82</cc>
    
    
    <cc>jmracek</cc>
    
    
    <cc>leigh123linux</cc>
    
    
    <cc>lupinix</cc>
    
    
    <cc>ngompa13</cc>
    
    
    <cc>packaging-team-maint</cc>
    
    
    <cc>robatino</cc>
    
    
    <cc>rpm-software-management</cc>
    
    
    <cc>tla</cc>
    
    
    <cc>vmukhame</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>dnfdaemon-0.3.18-2.fc26</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-06-09 15:07:02</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          <external_bugs name="Github">manatools/dnfdragora/issues/51</external_bugs>
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10440519</commentid>
    <comment_count>0</comment_count>
    <who name="Jerry Amundson">jamundso</who>
    <bug_when>2017-05-23 11:05:41 -0400</bug_when>
    <thetext>Description of problem:
Crashed after selecting package to install (ImageMagick)

Version-Release number of selected component (if applicable):


How reproducible:
Always

Steps to Reproduce:
1. Select package. Apply.
2. Enter password
3.

Actual results:
Crash

Expected results:
Installed package

Additional info:

on_TransactionEvent download
dnfdaemon client error: g-io-error-quark: GDBus.Error:org.freedesktop.DBus.Python.TypeError: Traceback (most recent call last):
  File &quot;/usr/lib64/python3.6/site-packages/dbus/service.py&quot;, line 707, in _message_cb
    retval = candidate_method(self, *args, **keywords)
  File &quot;/usr/lib/python3.6/site-packages/dnfdaemon/server/__init__.py&quot;, line 83, in newFunc
    rc = func(*args, **kwargs)
  File &quot;/usr/share/dnfdaemon/dnfdaemon-system&quot;, line 537, in RunTransaction
    result = self.run_transaction()
  File &quot;/usr/lib/python3.6/site-packages/dnfdaemon/server/__init__.py&quot;, line 555, in run_transaction
    self.base.download_packages(to_dnl, self.base.progress)
  File &quot;/usr/lib/python3.6/site-packages/dnf/base.py&quot;, line 1011, in download_packages
    progress.start(len(payloads), est_remote_size, total_drpms=total_drpm)
TypeError: start() got an unexpected keyword argument &apos;total_drpms&apos;
 (36) 
&lt;_M_&gt; [ui] YUILoader.cc:163 deleteUI(): Shutting down UI
Closing dnfdragora
&lt;_M_&gt; [ew] YExternalWidgets.cc:116 ~YExternalWidgetsTerminator(): Shutting down mga External Widgets
&lt;_M_&gt; [ew] YMGAWidgetExtensionFactory.cc:49 ~YMGAWidgetFactory(): Factory removed</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10441864</commentid>
    <comment_count>1</comment_count>
    <who name="Neal Gompa">ngompa13</who>
    <bug_when>2017-05-23 21:20:08 -0400</bug_when>
    <thetext>From what I can tell, there are no changes that need to be made to either dnfdaemon or dnfdragora. The breakage occurred in DNF itself.

Reassigning to DNF.

Since this bug breaks dnfdaemon and dnfdragora (which are on the KDE Plasma live media), this is pretty bad.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10442264</commentid>
    <comment_count>2</comment_count>
    <who name="Fedora Blocker Bugs Application">blockerbugs</who>
    <bug_when>2017-05-24 02:09:37 -0400</bug_when>
    <thetext>Proposed as a Blocker for 26-final by Fedora user lupinix using the blocker tracking app because:

 dnfdragora is the default package manager on KDE Plasma spin, the update to dnf 2.5.0 breaks it.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10442515</commentid>
    <comment_count>3</comment_count>
    <who name="Jaroslav Mracek">jmracek</who>
    <bug_when>2017-05-24 03:13:07 -0400</bug_when>
    <thetext>I guess it should help:

diff --git a/python/dnfdaemon/server/backend.py b/python/dnfdaemon/server/backend.py
index 7c1c150..997a466 100644
--- a/python/dnfdaemon/server/backend.py
+++ b/python/dnfdaemon/server/backend.py
@@ -433,7 +433,7 @@ class Progress(dnf.callback.DownloadProgress):
         self.dnl = {}
         self.last_frac = 0
 
-    def start(self, total_files, total_size):
+    def start(self, total_files, total_size, total_drpms=0):
         self.total_files = total_files
         self.total_size = float(total_size)
         self.download_files = 0

It is part of pull-request https://github.com/manatools/dnfdaemon/pull/18</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10442768</commentid>
    <comment_count>4</comment_count>
    <who name="Björn &quot;besser82&quot; Esser">besser82</who>
    <bug_when>2017-05-24 04:24:42 -0400</bug_when>
    <thetext>Patch fixes this issue.  Builds for dnfdaemon with patch applied are running.  Reassigning to dnfdaemon.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10442791</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-24 04:30:51 -0400</bug_when>
    <thetext>dnf-2.5.0-1.fc26 dnf-plugins-core-2.1.0-1.fc26 dnf-plugins-extras-2.0.1-1.fc26 dnfdaemon-0.3.17-3.fc26 libdnf-0.9.0-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-92e5a01da8</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10442816</commentid>
    <comment_count>6</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-24 04:33:35 -0400</bug_when>
    <thetext>dnf-2.5.0-1.fc26 dnf-plugins-core-2.1.0-1.fc26 dnf-plugins-extras-2.0.1-1.fc26 dnfdaemon-0.3.17-3.fc26 libdnf-0.9.0-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-92e5a01da8</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10444048</commentid>
    <comment_count>7</comment_count>
    <who name="Jerry Amundson">jamundso</who>
    <bug_when>2017-05-24 09:39:39 -0400</bug_when>
    <thetext>dnfdaemon-0.3.17-3.fc26 fixed this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10444137</commentid>
    <comment_count>8</comment_count>
    <who name="Neal Gompa">ngompa13</who>
    <bug_when>2017-05-24 09:57:45 -0400</bug_when>
    <thetext>dnfdaemon-0.3.18 has been released with the fixes.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10444368</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-24 10:34:06 -0400</bug_when>
    <thetext>dnf-2.5.0-2.fc26 dnf-plugins-core-2.1.0-1.fc26 dnf-plugins-extras-2.0.1-1.fc26 dnfdaemon-0.3.18-1.fc26 libdnf-0.9.0-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-92e5a01da8</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10448796</commentid>
    <comment_count>10</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-25 15:18:24 -0400</bug_when>
    <thetext>dnf-2.5.0-2.fc26, dnf-plugins-core-2.1.0-1.fc26, dnf-plugins-extras-2.0.1-1.fc26, dnfdaemon-0.3.18-2.fc26, libdnf-0.9.0-1.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-92e5a01da8</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10478400</commentid>
    <comment_count>11</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2017-06-05 14:43:44 -0400</bug_when>
    <thetext>Discussed at 2017-06-05 blocker review meeting: https://meetbot-raw.fedoraproject.org/fedora-blocker-review/2017-06-05/f26-blocker-review.2017-06-05-16.01.html . Accepted as a blocker due to violation of Final criterion &quot;All applications that can be launched using the standard graphical mechanism of a release-blocking desktop after a default installation of that desktop must start successfully and withstand a basic functionality test.&quot; Note issue was discussed twice during the meeting.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10494137</commentid>
    <comment_count>12</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-09 15:07:02 -0400</bug_when>
    <thetext>dnf-2.5.0-2.fc26, dnf-plugins-core-2.1.0-1.fc26, dnf-plugins-extras-2.0.1-1.fc26, dnfdaemon-0.3.18-2.fc26, libdnf-0.9.0-1.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10498654</commentid>
    <comment_count>13</comment_count>
    <who name="Jaroslav Mracek">jmracek</who>
    <bug_when>2017-06-12 12:48:52 -0400</bug_when>
    <thetext>The problem was completely solved by dnf-2.5.1-1 where we provide a compatibility patch. Therefore there should be no problem for any packages with or without support of new callbacks. Hope that not any new issue appears.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>