<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1425827</bug_id>
          
          <creation_ts>2017-02-22 09:30:00 -0500</creation_ts>
          <short_desc>anaconda crashes early with RuntimeError: Unable to find an install class to use!!!</short_desc>
          <delta_ts>2017-02-28 11:52:17 -0500</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>anaconda</component>
          <version>26</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>RAWHIDE</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard>AcceptedBlocker</status_whiteboard>
          <keywords></keywords>
          <priority>urgent</priority>
          <bug_severity>urgent</bug_severity>
          <target_milestone>---</target_milestone>
          <dependson>1426435</dependson>
          <blocked>1349184</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Kevin Fenzi">kevin</reporter>
          <assigned_to name="Anaconda Maintenance Team">anaconda-maint-list</assigned_to>
          <cc>anaconda-maint-list</cc>
    
    
    <cc>atu</cc>
    
    
    <cc>awilliam</cc>
    
    
    <cc>bcl</cc>
    
    
    <cc>g.kaviyarasu</cc>
    
    
    <cc>jonathan</cc>
    
    
    <cc>mazeinp</cc>
    
    
    <cc>mkolman</cc>
    
    
    <cc>pbrobinson</cc>
    
    
    <cc>pwhalen</cc>
    
    
    <cc>robatino</cc>
    
    
    <cc>vanmeeuwen+fedora</cc>
    
    
    <cc>vponcova</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in></cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-02-28 11:52:17</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10174724</commentid>
    <comment_count>0</comment_count>
    <who name="Kevin Fenzi">kevin</who>
    <bug_when>2017-02-22 09:30:04 -0500</bug_when>
    <thetext>All the rawhide livemedia composes are currently failing. 

For example, the Xfce live for 2017-02-22: 

https://koji.fedoraproject.org/koji/taskinfo?taskID=17990346

livemedia-out.log contains: 

2017-02-22 11:23:39,277 DEBUG livemedia-creator: Namespace(anaconda_args=None, app_file=&apos;appliance.xml&apos;, app_name=None, app_template=None, arch=None, armplatform=None, compress_args=[], compression=&apos;xz&apos;, disk_image=None, domacboot=True, dracut_args=None, fs_image=None, fs_label=&apos;Anaconda&apos;, image_name=None, image_only=False, image_type=None, iso=None, iso_name=&apos;Fedora-Xfce-Live-i386-Rawhide-20170222.n.0.iso&apos;, iso_only=True, keep_image=False, kernel_args=None, ks=[&apos;/tmp/koji-image-f26-build-17990346.ks&apos;], live_rootfs_keep_size=False, live_rootfs_size=0, location=None, logfile=&apos;/tmp/lmc-logs/livemedia-out.log&apos;, lorax_templates=None, make_ami=False, make_appliance=False, make_disk=False, make_fsimage=False, make_iso=True, make_oci=False, make_ostree_live=False, make_pxe_live=False, make_tar=False, make_vagrant=False, no_kvm=False, no_virt=True, oci_config=None, oci_runtime=None, ovmf_path=&apos;/usr/share/edk2/ovmf/&apos;, project=&apos;Fedora-Xfce-Live&apos;, proxy=None, qcow2=False, qemu_args=[], ram=1024, releasever=&apos;Rawhide&apos;, result_dir=&apos;/tmp/lmc&apos;, squashfs_args=None, timeout=None, title=&apos;Fedora-Xfce-Live&apos;, tmp=&apos;/var/tmp&apos;, vagrant_metadata=None, vagrantfile=None, vcpus=None, virt_uefi=False, vnc=None, volid=&apos;Fedora-Xfce-Live-Rawhide-2017022&apos;)
2017-02-22 11:23:39,341 INFO livemedia-creator: disk_img = /tmp/lmc/lmc-disk-a47xmr_9.img
2017-02-22 11:23:39,342 INFO livemedia-creator: Using disk size of 5122MiB
2017-02-22 11:23:39,940 DEBUG pylorax.imgutils: make tmp mountdir /var/tmp/lorax.imgutils.1ah1wfp1
2017-02-22 11:23:39,991 DEBUG pylorax.imgutils: remove tmp mountdir /var/tmp/lorax.imgutils.1ah1wfp1
2017-02-22 11:23:44,424 INFO livemedia-creator: Running anaconda.
2017-02-22 11:23:46,241 INFO livemedia-creator: Starting installer, one moment...
2017-02-22 11:23:46,242 INFO livemedia-creator: terminal size detection failed, using default width
2017-02-22 11:23:46,242 INFO livemedia-creator: anaconda 26.20-1 for Fedora-Xfce-Live Rawhide (pre-release) started.
2017-02-22 11:23:46,242 INFO livemedia-creator: 11:23:46 Not asking for VNC because of an automated install
2017-02-22 11:23:46,242 INFO livemedia-creator: 11:23:46 Not asking for VNC because we don&apos;t have Xvnc
2017-02-22 11:23:46,322 INFO livemedia-creator: Traceback (most recent call last):
2017-02-22 11:23:46,322 INFO livemedia-creator: File &quot;/usr/sbin/anaconda&quot;, line 594, in &lt;module&gt;
2017-02-22 11:23:46,322 INFO livemedia-creator: display.setup_display(anaconda, opts, addon_paths=addon_paths)
2017-02-22 11:23:46,322 INFO livemedia-creator: File &quot;/usr/lib/python3.6/site-packages/pyanaconda/display.py&quot;, line 324, in setup_display
2017-02-22 11:23:46,323 INFO livemedia-creator: anaconda.initInterface(addon_paths=addon_paths)
2017-02-22 11:23:46,323 INFO livemedia-creator: File &quot;/usr/lib/python3.6/site-packages/pyanaconda/anaconda.py&quot;, line 286, in initInterface
2017-02-22 11:23:46,323 INFO livemedia-creator: self._intf = TextUserInterface(self.storage, self.payload,
2017-02-22 11:23:46,324 INFO livemedia-creator: File &quot;/usr/lib/python3.6/site-packages/pyanaconda/anaconda.py&quot;, line 168, in storage
2017-02-22 11:23:46,324 INFO livemedia-creator: if self.instClass.defaultFS:
2017-02-22 11:23:46,324 INFO livemedia-creator: File &quot;/usr/lib/python3.6/site-packages/pyanaconda/anaconda.py&quot;, line 91, in instClass
2017-02-22 11:23:46,324 INFO livemedia-creator: from pyanaconda.installclass import DefaultInstall
2017-02-22 11:23:46,324 INFO livemedia-creator: File &quot;/usr/lib/python3.6/site-packages/pyanaconda/installclass.py&quot;, line 246, in &lt;module&gt;
2017-02-22 11:23:46,324 INFO livemedia-creator: baseclass = getBaseInstallClass()
2017-02-22 11:23:46,324 INFO livemedia-creator: File &quot;/usr/lib/python3.6/site-packages/pyanaconda/installclass.py&quot;, line 242, in getBaseInstallClass
2017-02-22 11:23:46,325 INFO livemedia-creator: raise RuntimeError(&quot;Unable to find an install class to use!!!&quot;)
2017-02-22 11:23:46,325 INFO livemedia-creator: RuntimeError: Unable to find an install class to use!!!
2017-02-22 11:23:46,387 ERROR livemedia-creator: Running anaconda failed: process &apos;[&apos;anaconda&apos;, &apos;--kickstart&apos;, &apos;/tmp/koji-image-f26-build-17990346.ks&apos;, &apos;--cmdline&apos;, &apos;--dirinstall&apos;, &apos;--remotelog&apos;, &apos;127.0.0.1:52549&apos;]&apos; exited with status 1
2017-02-22 11:24:44,519 ERROR livemedia-creator: Install failed: novirt_install failed
2017-02-22 11:24:44,520 INFO livemedia-creator: Removing bad disk image
2017-02-22 11:24:44,541 ERROR livemedia-creator: ERROR: Image creation failed: novirt_install failed</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10174891</commentid>
    <comment_count>1</comment_count>
    <who name="Paul Whalen">pwhalen</who>
    <bug_when>2017-02-22 10:07:56 -0500</bug_when>
    <thetext>Moving this to anaconda, seeing the same error when attempting an installation on arm using compose from Fedora-Rawhide-20170222.n.0.

Starting installer, one moment...
anaconda 26.20-1 for Fedora Rawhide (pre-release) started.
 * installation log files are stored in /tmp during the installation
 * shell is available on TTY2
 * if the graphical installation interface fails to start, try again with the
   inst.text bootoption to start text installation
 * when reporting a bug add logs from /tmp as separate text/plain attachments
  File &quot;/sbin/anaconda&quot;, line 594, in &lt;module&gt;
    display.setup_display(anaconda, opts, addon_paths=addon_paths)
  File &quot;/usr/lib/python3.6/site-packages/pyanaconda/display.py&quot;, line 324, in setup_display
    anaconda.initInterface(addon_paths=addon_paths)
  File &quot;/usr/lib/python3.6/site-packages/pyanaconda/anaconda.py&quot;, line 286, in initInterface
    self._intf = TextUserInterface(self.storage, self.payload,
  File &quot;/usr/lib/python3.6/site-packages/pyanaconda/anaconda.py&quot;, line 168, in storage
    if self.instClass.defaultFS:
  File &quot;/usr/lib/python3.6/site-packages/pyanaconda/anaconda.py&quot;, line 91, in instClass
    from pyanaconda.installclass import DefaultInstall
  File &quot;/usr/lib/python3.6/site-packages/pyanaconda/installclass.py&quot;, line 246,
in &lt;module&gt;
    baseclass = getBaseInstallClass()
  File &quot;/usr/lib/python3.6/site-packages/pyanaconda/installclass.py&quot;, line 242,
in getBaseInstallClass
    raise RuntimeError(&quot;Unable to find an install class to use!!!&quot;)
RuntimeError: Unable to find an install class to use!!!

Pane is dead
  File &quot;/usr/lib/python3.6/site-packages/pyanaconda/installclass.py&quot;, line 242, in getBaseInstallClass
    raise RuntimeError(&quot;Unable to find an install class to use!!!&quot;)
RuntimeError: Unable to find an install class to use!!!
Pane is dead</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10175229</commentid>
    <comment_count>2</comment_count>
    <who name="Paul Whalen">pwhalen</who>
    <bug_when>2017-02-22 11:17:13 -0500</bug_when>
    <thetext>Initial-setup also fails on arm disk images. 

Traceback (most recent call last):
  File &quot;/usr/libexec/initial-setup/initial-setup-text&quot;, line 3, in &lt;module&gt;
    from initial_setup import InitialSetup, InitialSetupError
  File &quot;/usr/lib/python3.6/site-packages/initial_setup/__init__.py&quot;, line 11, in &lt;module&gt;
    from initial_setup.post_installclass import PostInstallClass
  File &quot;/usr/lib/python3.6/site-packages/initial_setup/post_installclass.py&quot;, line 20, in &lt;module&gt;
    from pyanaconda.installclass import BaseInstallClass
  File &quot;/usr/lib/python3.6/site-packages/pyanaconda/installclass.py&quot;, line 246, in &lt;module&gt;
    baseclass = getBaseInstallClass()
  File &quot;/usr/lib/python3.6/site-packages/pyanaconda/installclass.py&quot;, line 242, in getBaseInstallClass
    raise RuntimeError(&quot;Unable to find an install class to use!!!&quot;)
RuntimeError: Unable to find an install class to use!!!</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10176769</commentid>
    <comment_count>3</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2017-02-22 20:19:44 -0500</bug_when>
    <thetext>Odd thing is, if you boot an installer image and do this:

python3 -c &apos;from pyanaconda.installclass import getBaseInstallClass; getBaseInstallClass()&apos;

it works fine (doesn&apos;t raise an exception). Not sure what&apos;s going on there. Some kind of timing problem?

This is an automatic blocker, as it prevents the compose of multiple release blocking images. Setting AcceptedBlocker.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10181565</commentid>
    <comment_count>4</comment_count>
    <who name="lesnake">mazeinp</who>
    <bug_when>2017-02-24 08:06:54 -0500</bug_when>
    <thetext>I reproduced the problem on a F25 host runninng a rawhide mock

The problem is that in this file : /usr/lib64/python3.6/site-packages/pyanaconda/installclass.py
the line :
https://github.com/rhinstaller/anaconda/blob/master/pyanaconda/installclass.py#L165
generates :
/usr/local/lib64/python3.6/site-packages/pyanaconda/installclasses
which does not exist

However this path exist:
/usr/lib64/python3.6/site-packages/pyanaconda/installclasses

Adding this path to the path list allows classes to be found

ignatenkobrain pointed (on IRC) to this other bug : https://bugzilla.redhat.com/show_bug.cgi?id=1426435

Replacing line 165 by 
&quot;%s/installclasses&quot; % os.path.dirname(os.path.realpath(__file__))]:

Fixes the issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10187535</commentid>
    <comment_count>5</comment_count>
    <who name="Martin Kolman">mkolman</who>
    <bug_when>2017-02-27 12:09:10 -0500</bug_when>
    <thetext>So for now this has been &quot;fixed&quot; by the Python-side change being reverted (see bug 1426435 comment 7), but that is only temporary. 

Eventually a proper solution will have to be discussed with Fedora Python maintainers &amp; implemented.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10190663</commentid>
    <comment_count>6</comment_count>
    <who name="lesnake">mazeinp</who>
    <bug_when>2017-02-28 04:47:01 -0500</bug_when>
    <thetext>I checked that now, in the same context as comment 4, in a fresh new rawhide mock that

get_python_lib(plat_specific=1)

returns 

/usr/lib64/python3.6/site-packages/

as expected.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10193401</commentid>
    <comment_count>7</comment_count>
    <who name="Fedora End Of Life">jkurik</who>
    <bug_when>2017-02-28 07:24:33 -0500</bug_when>
    <thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 26 development cycle.
Changing version to &apos;26&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10194587</commentid>
    <comment_count>8</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2017-02-28 11:52:17 -0500</bug_when>
    <thetext>yeah, and recent Rawhide nightlies work OK, so we can close this. Please don&apos;t re-apply the change until we have a fix for the problem...</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>