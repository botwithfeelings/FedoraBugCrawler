<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1438046</bug_id>
          
          <creation_ts>2017-03-31 13:52:00 -0400</creation_ts>
          <short_desc>initial-setup.service: Failed to set up stdin: Inappropriate ioctl for device</short_desc>
          <delta_ts>2017-06-03 13:38:05 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>initial-setup</component>
          <version>26</version>
          <rep_platform>armhfp</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard>AcceptedBlocker</status_whiteboard>
          <keywords></keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>245418</blocked>
    
    
    <blocked>1349186</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Paul Whalen">pwhalen</reporter>
          <assigned_to name="Martin Kolman">mkolman</assigned_to>
          <cc>alciregi</cc>
    
    
    <cc>awilliam</cc>
    
    
    <cc>gmarr</cc>
    
    
    <cc>lbrabec</cc>
    
    
    <cc>mkolman</cc>
    
    
    <cc>pbrobinson</cc>
    
    
    <cc>robatino</cc>
    
    
    <cc>vpodzime</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>initial-setup-0.3.44-1 initial-setup-0.3.46-2.fc26</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-06-03 13:38:05</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10295260</commentid>
    <comment_count>0</comment_count>
    <who name="Paul Whalen">pwhalen</who>
    <bug_when>2017-03-31 13:52:39 -0400</bug_when>
    <thetext>Description of problem:
On some hardware, initial-setup fails to run as expected. 

Version-Release number of selected component (if applicable):
initial-setup-gui-0.3.43-3.fc26.armv7hl

How reproducible:
On affected hardware, always. 

Steps to Reproduce:
1. Boot desktop images on Allwinner (Banana Pi, Cubietruck, etc)

Actual results:
Boots to log in screen. 

 systemctl status initial-setup
● initial-setup.service - Initial Setup configuration program
   Loaded: loaded (/usr/lib/systemd/system/initial-setup.service; enabled; vendor preset: disabled)
   Active: failed (Result: exit-code) since Wed 2017-03-01 16:43:32 EST; 4 weeks 1 days ago
  Process: 732 ExecStart=/usr/libexec/initial-setup/run-initial-setup (code=exited, status=208/STDIN)
  Process: 731 ExecStartPre=/bin/plymouth quit (code=exited, status=208/STDIN)
  Process: 712 ExecStartPre=/bin/kill -55 1 (code=exited, status=0/SUCCESS)
 Main PID: 732 (code=exited, status=208/STDIN)

Mar 01 16:43:32 localhost systemd[1]: Starting Initial Setup configuration program...
Mar 01 16:43:32 localhost systemd[731]: initial-setup.service: Failed to set up stdin: Inappropriate ioctl for device
Mar 01 16:43:32 localhost systemd[732]: initial-setup.service: Failed to set up stdin: Inappropriate ioctl for device
Mar 01 16:43:32 localhost systemd[1]: initial-setup.service: Main process exited, code=exited, status=208/STDIN
Mar 01 16:43:32 localhost systemd[1]: Failed to start Initial Setup configuration program.
Mar 01 16:43:32 localhost systemd[1]: initial-setup.service: Unit entered failed state.
Mar 01 16:43:32 localhost systemd[1]: initial-setup.service: Failed with result &apos;exit-code&apos;.

Additional info:

Adding &apos;console=tty1&apos; to the kernel args boots to initial-setup as expected. Unaffected hardware includes Raspberry Pi 2/3, Wandboard Quad(imx.6).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10320857</commentid>
    <comment_count>1</comment_count>
    <who name="Paul Whalen">pwhalen</who>
    <bug_when>2017-04-10 11:12:58 -0400</bug_when>
    <thetext>Nominating as a blocker for Beta, criteria - &quot;Release-blocking ARM disk images must boot to the initial-setup utility.&quot;. This affects at least some of the supported Allwinner boards.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10321861</commentid>
    <comment_count>2</comment_count>
    <who name="Geoffrey Marr">gmarr</who>
    <bug_when>2017-04-10 16:22:39 -0400</bug_when>
    <thetext>Discussed during the 2017-04-10 blocker review meeting: [1]

The decision to classify this bug as an AcceptedBlocker was made as it violates the following criteria:

&quot;Release-blocking ARM disk images must boot to the initial-setup utility.&quot;

[1] https://meetbot.fedoraproject.org/fedora-blocker-review/2017-04-10/f26-blocker-review.2017-04-10-16.01.txt</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10377245</commentid>
    <comment_count>3</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2017-05-01 19:06:56 -0400</bug_when>
    <thetext>Ping? where are we with this?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10407543</commentid>
    <comment_count>4</comment_count>
    <who name="Alessio">alciregi</who>
    <bug_when>2017-05-12 08:43:20 -0400</bug_when>
    <thetext>*** Bug 1449391 has been marked as a duplicate of this bug. ***</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10408131</commentid>
    <comment_count>5</comment_count>
    <who name="Martin Kolman">mkolman</who>
    <bug_when>2017-05-12 11:00:19 -0400</bug_when>
    <thetext>A pull request with a fix for this bug has been submitted for review:
https://github.com/rhinstaller/initial-setup/pull/27

Implementation of the fix is described in the the commit message.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10408338</commentid>
    <comment_count>6</comment_count>
    <who name="Martin Kolman">mkolman</who>
    <bug_when>2017-05-12 11:43:47 -0400</bug_when>
    <thetext>An scratch build for easy testing:

https://koji.fedoraproject.org/koji/taskinfo?taskID=19509426

Note: Due to an unrelated Anaconda bug you need to run Initial Setup in reconfig mode:

touch /.unconfigured
then reboot

Otherwise only a single spoke will be displayed on the Initial Setup TUI hub, triggering the Aanconda side bug.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10409036</commentid>
    <comment_count>7</comment_count>
    <who name="Alessio">alciregi</who>
    <bug_when>2017-05-12 16:49:11 -0400</bug_when>
    <thetext>(In reply to Martin Kolman from comment #5)
&gt; https://github.com/rhinstaller/initial-setup/pull/27

I&apos;m using a Raspberry Pi 3.
I created an SD card using arm-image-installer with Fedora-Minimal-armhfp-26-20170504.n.1-sda.raw.xz. 
After that I mounted the SD on my PC. Then downloaded the 4 files from github, and copied them in the related paths:

sudo cp common.py /run/media/alessio/__/usr/lib/python3.6/site-packages/initial_setup/common.py 
sudo cp initial-setup.service /run/media/alessio/__/usr/lib/systemd/system/initial-setup.service
sudo cp __init__.py /run/media/alessio/__/usr/lib/python3.6/site-packages/initial_setup/__init__.py
sudo cp tui.py /run/media/alessio/__/usr/lib/python3.6/site-packages/initial_setup/tui/tui.py

Booted the Rasperry with such SD card I can confirm that the initial-setup process starts and it works.

Thanks.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10414172</commentid>
    <comment_count>8</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-15 14:54:40 -0400</bug_when>
    <thetext>initial-setup-0.3.44-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-4d45e5287f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10415419</commentid>
    <comment_count>9</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-16 02:10:05 -0400</bug_when>
    <thetext>initial-setup-0.3.44-1.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-4d45e5287f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10416895</commentid>
    <comment_count>10</comment_count>
    <who name="Paul Whalen">pwhalen</who>
    <bug_when>2017-05-16 09:31:59 -0400</bug_when>
    <thetext>Same error on the XFCE image(Banana Pi):

rpm -q initial-setup initial-setup-gui
initial-setup-0.3.44-1.fc26.armv7hl
initial-setup-gui-0.3.44-1.fc26.armv7hl

[root@localhost ~]# systemctl status initial-setup
● initial-setup.service - Initial Setup configuration program
   Loaded: loaded (/usr/lib/systemd/system/initial-setup.service; enabled; vendor preset: disabled)
   Active: failed (Result: exit-code) since Wed 2017-03-01 16:43:34 EST; 2 months 14 days ago
  Process: 599 ExecStart=/usr/libexec/initial-setup/run-initial-setup (code=exited, status=208/STDIN)
  Process: 596 ExecStartPre=/bin/plymouth quit (code=exited, status=208/STDIN)
  Process: 562 ExecStartPre=/bin/kill -55 1 (code=exited, status=0/SUCCESS)
 Main PID: 599 (code=exited, status=208/STDIN)

Mar 01 16:43:30 localhost systemd[1]: Starting Initial Setup configuration program...
Mar 01 16:43:34 localhost systemd[596]: initial-setup.service: Failed to set up stdin: Inappropriate ioctl for device
Mar 01 16:43:34 localhost systemd[1]: initial-setup.service: Main process exited, code=exited, status=208/STDIN
Mar 01 16:43:34 localhost systemd[1]: Failed to start Initial Setup configuration program.
Mar 01 16:43:34 localhost systemd[1]: initial-setup.service: Unit entered failed state.
Mar 01 16:43:34 localhost systemd[1]: initial-setup.service: Failed with result &apos;exit-code&apos;.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10418240</commentid>
    <comment_count>11</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2017-05-16 15:27:38 -0400</bug_when>
    <thetext>mkolman: what&apos;s the deal with the &apos;unrelated anaconda bug&apos; you mention when only one spoke would be displayed in i-s? Is there a bug report for that?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10420229</commentid>
    <comment_count>12</comment_count>
    <who name="Martin Kolman">mkolman</who>
    <bug_when>2017-05-17 05:57:34 -0400</bug_when>
    <thetext>(In reply to Adam Williamson from comment #11)
&gt; mkolman: what&apos;s the deal with the &apos;unrelated anaconda bug&apos; you mention when
&gt; only one spoke would be displayed in i-s? Is there a bug report for that?
As no one reported anything my theory is that it&apos;s something that has been introduced since the latest F26 Anaconda build. But I&apos;m afraid it could also be that no one just hit it yet, as you need to:

- run the Initial Setup TUI
- there needs to be just a single spoke present (usually the user creation spoke)

This means people on ARM won&apos;t hit it as they have more than one spoke on the hub due to the reconfig mode. And most of regular installations also won&apos;t hit it as tehy are using the Initial Setup GUI, Gnome Initial Setup or nothing at all (if user is created during the installation).

In any case this is the PR that should fix it:
https://github.com/rhinstaller/anaconda/pull/1060

I&apos;ve just merged it, which means that Rawhide &amp; F26 should be fine once a new build is done. I can also cherry pick it to a F26 build during freeze if it *does* happen on current F26 &amp; gets a FE/blocker.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10421923</commentid>
    <comment_count>13</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-17 12:19:14 -0400</bug_when>
    <thetext>initial-setup-0.3.45-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-4d45e5287f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10426798</commentid>
    <comment_count>14</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-18 15:03:28 -0400</bug_when>
    <thetext>initial-setup-0.3.45-1.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-4d45e5287f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10446870</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-25 05:44:12 -0400</bug_when>
    <thetext>anaconda-26.21.7-1.fc26 initial-setup-0.3.46-2.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-4d45e5287f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10448775</commentid>
    <comment_count>16</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-25 15:16:54 -0400</bug_when>
    <thetext>anaconda-26.21.7-1.fc26, initial-setup-0.3.46-2.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-4d45e5287f</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10460168</commentid>
    <comment_count>17</comment_count>
    <who name="Paul Whalen">pwhalen</who>
    <bug_when>2017-05-30 15:56:27 -0400</bug_when>
    <thetext>initial-setup-0.3.46-2.fc26 tui working on beaglebone black, password issues are now fixed.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10462751</commentid>
    <comment_count>18</comment_count>
    <who name="Lukas Brabec">lbrabec</who>
    <bug_when>2017-05-31 06:16:55 -0400</bug_when>
    <thetext>Tested F26 Beta 1.3 (with initial-setup-0.3.45-1.fc26) on Raspberry Pi 3 (serial) and Banana Pi (serial and hdmi), works for me with the exception of the password issue.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10474428</commentid>
    <comment_count>19</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-06-03 13:38:05 -0400</bug_when>
    <thetext>anaconda-26.21.7-1.fc26, initial-setup-0.3.46-2.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>