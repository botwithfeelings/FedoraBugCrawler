<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1"
          urlbase="https://bugzilla.redhat.com/"
          
          maintainer="bugzilla-error-list@redhat.com"
>

    <bug>
          <bug_id>1446432</bug_id>
          
          <creation_ts>2017-04-27 21:11:00 -0400</creation_ts>
          <short_desc>Minimal install option install full gnome desktop</short_desc>
          <delta_ts>2017-05-15 19:18:11 -0400</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>2</classification_id>
          <classification>Fedora</classification>
          <product>Fedora</product>
          <component>dnf</component>
          <version>26</version>
          <rep_platform>Unspecified</rep_platform>
          <op_sys>Unspecified</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>ERRATA</resolution>
          
          
          <bug_file_loc></bug_file_loc>
          <status_whiteboard>AcceptedBlocker</status_whiteboard>
          <keywords>Triaged</keywords>
          <priority>unspecified</priority>
          <bug_severity>unspecified</bug_severity>
          <target_milestone>---</target_milestone>
          
          <blocked>1349186</blocked>
          <everconfirmed>1</everconfirmed>
          <reporter name="Germán Ríos González">german.rios.gonzalez</reporter>
          <assigned_to name="Jaroslav Mracek">jmracek</assigned_to>
          <cc>anaconda-maint-list</cc>
    
    
    <cc>awilliam</cc>
    
    
    <cc>german.rios.gonzalez</cc>
    
    
    <cc>g.kaviyarasu</cc>
    
    
    <cc>gmarr</cc>
    
    
    <cc>jkonecny</cc>
    
    
    <cc>jmracek</cc>
    
    
    <cc>jonathan</cc>
    
    
    <cc>kevin</cc>
    
    
    <cc>mkolman</cc>
    
    
    <cc>packaging-team-maint</cc>
    
    
    <cc>robatino</cc>
    
    
    <cc>rpm-software-management</cc>
    
    
    <cc>sgallagh</cc>
    
    
    <cc>vanmeeuwen+fedora</cc>
    
    
    <cc>vmukhame</cc>
    
    
    <cc>vpavlin</cc>
    
    
    <cc>vponcova</cc>
          <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>
          
          <cf_fixed_in>dnf-2.4.1-1.fc26</cf_fixed_in>
          <cf_doc_type>If docs needed, set a value</cf_doc_type>
          <cf_release_notes></cf_release_notes>
          <cf_story_points>---</cf_story_points>
          
          <cf_environment></cf_environment>
          <cf_last_closed>2017-05-14 16:19:45</cf_last_closed>
          <cf_type>Bug</cf_type>
          <cf_regression_status>---</cf_regression_status>
          <cf_mount_type>---</cf_mount_type>
          <cf_documentation_action>---</cf_documentation_action>
          <cf_crm></cf_crm>
          <cf_verified_branch></cf_verified_branch>
          <cf_category>---</cf_category>
          <cf_ovirt_team>---</cf_ovirt_team>
          
          <cf_cloudforms_team>---</cf_cloudforms_team>
          
          
          
          
          <target_release>---</target_release>
          
          <votes>0</votes>

      

      

      

          <comment_sort_order>oldest_to_newest</comment_sort_order>  
          <long_desc isprivate="0" >
    <commentid>10370574</commentid>
    <comment_count>0</comment_count>
    <who name="Germán Ríos González">german.rios.gonzalez</who>
    <bug_when>2017-04-27 21:11:10 -0400</bug_when>
    <thetext>Description of problem:
When you install F26 alpha with de minimal install option anaconda install full gnome desktop

Version-Release number of selected component (if applicable):
Fedora 26 Alpha

How reproducible:


Steps to Reproduce:
1.Install Fedora 26 Alpha
2.Select the minimal install option
3.Continue and finalize the installer

Actual results:
Install full gnome desktop

Expected results:
Install the minimal package

Additional info:</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10371426</commentid>
    <comment_count>1</comment_count>
    <who name="Martin Kolman">mkolman</who>
    <bug_when>2017-04-28 05:45:17 -0400</bug_when>
    <thetext>This is most likely an issue with the Fedora comps, so reassigning.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10371893</commentid>
    <comment_count>2</comment_count>
    <who name="Stephen Gallagher">sgallagh</who>
    <bug_when>2017-04-28 08:13:10 -0400</bug_when>
    <thetext>Where did you get the install media? Which version was it? The Workstation Edition netinstall? The Server Edition installer?

We need more information on exactly what you did. For example, what does &quot;Select the minimal install option&quot; mean?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10372370</commentid>
    <comment_count>3</comment_count>
    <who name="Germán Ríos González">german.rios.gonzalez</who>
    <bug_when>2017-04-28 09:58:40 -0400</bug_when>
    <thetext>(In reply to Stephen Gallagher from comment #2)
&gt; Where did you get the install media? Which version was it? The Workstation
&gt; Edition netinstall? The Server Edition installer?
&gt; 
&gt; We need more information on exactly what you did. For example, what does
&gt; &quot;Select the minimal install option&quot; mean?

Hi Mr. Gallagher, I took the media from the fedora page https://getfedora.org/workstation/prerelease/ and download the 64bit version of the workstation net install.

With minimal installation I mean when you are in the installer and selects &quot;SOFTWARE SELECTION&quot; then in the section &quot;Base Environment&quot; select the radio button &quot;Minimal Install&quot; or &quot;Fedora Custom Operating System&quot;, from Fedora 15 to 25 when you select the minimal install only gets the basic stuff and you can from there install a desktop or whatever you want.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10373425</commentid>
    <comment_count>4</comment_count>
    <who name="Stephen Gallagher">sgallagh</who>
    <bug_when>2017-04-28 13:34:59 -0400</bug_when>
    <thetext>Reassigning to Anaconda. Looks to me like what is happening is that when you select a different environment group under &quot;SOFTWARE SELECTION&quot;, it&apos;s actually adding the packages for that environment group to the list, rather than replacing the list that&apos;s already enqueued for installation.

In my test just now, I intentionally tried installing on a VM with too little disk space to install Workstation. I set the selection to &quot;Fedora Custom Operating System&quot; and it told me that I needed 1.1GiB more space to install. I then switched to &quot;Fedora Server&quot; and it suddenly needed 1.5GiB more space. Back to &quot;Fedora Custom&quot; and it again needs 1.5GiB.

I tried with &quot;Development and Creative Workstation&quot; and it needs 5.96GiB. Back to &quot;Fedora Custom&quot; and it still needs 5.96GiB.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10373430</commentid>
    <comment_count>5</comment_count>
    <who name="Fedora Blocker Bugs Application">blockerbugs</who>
    <bug_when>2017-04-28 13:38:03 -0400</bug_when>
    <thetext>Proposed as a Blocker for 26-beta by Fedora user sgallagh using the blocker tracking app because:

 &quot;When installing with the generic network install image, interactively selecting a package set other than the default must work... &quot;Work&quot; means that the mechanism for selecting different package sets must work: the packages in the set chosen must actually be correctly selected for installation.&quot;</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10373621</commentid>
    <comment_count>6</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2017-04-28 15:26:28 -0400</bug_when>
    <thetext>Can confirm this - in fact openQA hits it, just doesn&apos;t notice there&apos;s a problem:

https://openqa.fedoraproject.org/tests/88501

that&apos;s the &apos;minimal package set&apos; test, run from the Server DVD (so the default selected package set was Server, but the test changes it to &quot;Fedora Custom Operating System&quot;, i.e. minimal). It completes and boots fine so openQA thinks it&apos;s fine, but if you look at the installed packages log file:

https://openqa.fedoraproject.org/tests/88501/file/_collect_data-rpms.log

it&apos;s got lots of stuff that&apos;s clearly from Server, not minimal, like abrt and cockpit. You can compare to the list from a *real* minimal install (from the Everything netinst):

https://openqa.fedoraproject.org/tests/88462/file/_collect_data-rpms.log

I guess I&apos;ll file an issue for openQA to make the &apos;minimal package set&apos; test somehow try and check it was *really* the &apos;minimal package set&apos; that got installed...

+1 blocker per the criterion sgallagh cited. Thanks for catching this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10376872</commentid>
    <comment_count>7</comment_count>
    <who name="Geoffrey Marr">gmarr</who>
    <bug_when>2017-05-01 14:26:00 -0400</bug_when>
    <thetext>Discussed during the 2017-05-01 blocker review meeting: [1]

The decision to classify this bug as an AcceptedBlocker was made as it violates the following blocker criteria:

&quot;When installing with the generic network install image, interactively selecting a package set other than the default must work...&quot;

[1] https://meetbot.fedoraproject.org/fedora-blocker-review/2017-05-01/f26-blocker-review.2017-05-01-16.02.txt</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10377230</commentid>
    <comment_count>8</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2017-05-01 18:50:27 -0400</bug_when>
    <thetext>I&apos;m wondering if the fix for https://bugzilla.redhat.com/show_bug.cgi?id=1404158 - &quot;Fix partial kickstart software selection in GUI (#1404158)&quot;, commit 012fe32eff1d3291a1f36a24f5a906f12ba01141 on f26-devel, 59bf385a9250c883f4acb81140fefe6d4f62e82b on master - could be related here? jkonecny?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10379160</commentid>
    <comment_count>9</comment_count>
    <who name="Jiri Konecny">jkonecny</who>
    <bug_when>2017-05-02 10:09:16 -0400</bug_when>
    <thetext>No this is not related. That code is not even present on F26 alpha.

I&apos;m not aware of any change in Anaconda which can cause this. I&apos;ll try to dig deeply and find what is causing this.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10383137</commentid>
    <comment_count>10</comment_count>
    <who name="Jiri Konecny">jkonecny</who>
    <bug_when>2017-05-03 12:16:29 -0400</bug_when>
    <thetext>It looks to me like a bug in the DNF API, more precisely the &apos;reset()&apos; method.

When an environment is changed we are calling &apos;Base.reset(goal=True)&apos; and it should remove the selected packages, if I understand it correctly. However, from pdb it looks like Base.transaction.install_set is still full of packages after this call.

I&apos;m switching this to DNF. Could you please look on that and verify if this is really an issue of DNF 2.3.0?</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10387075</commentid>
    <comment_count>11</comment_count>
    <who name="Jaroslav Mracek">jmracek</who>
    <bug_when>2017-05-04 14:21:59 -0400</bug_when>
    <thetext>Please can you confirm that the problem appears with dnf-2.x? According my first look, the base.transaction object is filled after resolve() and it is not empty  after Base.reset(), because it deletes goal but the goal was already transformed into transaction therefore it doesn&apos;t change already filled transaction (two in depend objects).</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10388741</commentid>
    <comment_count>12</comment_count>
    <who name="Jaroslav Mracek">jmracek</who>
    <bug_when>2017-05-05 07:06:40 -0400</bug_when>
    <thetext>Here is the PR that should solve a problem: https://github.com/rpm-software-management/dnf/pull/803</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10388767</commentid>
    <comment_count>13</comment_count>
    <who name="Jiri Konecny">jkonecny</who>
    <bug_when>2017-05-05 07:21:02 -0400</bug_when>
    <thetext>Tested, the patch should work properly.

Nice co-operation Jaroslav, good work.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10403212</commentid>
    <comment_count>14</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-11 04:59:17 -0400</bug_when>
    <thetext>dnf-2.4.1-1.fc26 has been submitted as an update to Fedora 26. https://bodhi.fedoraproject.org/updates/FEDORA-2017-e0fa49ff81</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10409402</commentid>
    <comment_count>15</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-12 21:10:50 -0400</bug_when>
    <thetext>dnf-2.4.1-1.fc26 has been pushed to the Fedora 26 testing repository. If problems still persist, please make note of it in this bug report.
See https://fedoraproject.org/wiki/QA:Updates_Testing for
instructions on how to install test updates.
You can provide feedback for this update here: https://bodhi.fedoraproject.org/updates/FEDORA-2017-e0fa49ff81</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10410658</commentid>
    <comment_count>16</comment_count>
    <who name="Fedora Update System">updates</who>
    <bug_when>2017-05-14 16:19:45 -0400</bug_when>
    <thetext>dnf-2.4.1-1.fc26 has been pushed to the Fedora 26 stable repository. If problems still persist, please make note of it in this bug report.</thetext>
  </long_desc><long_desc isprivate="0" >
    <commentid>10414767</commentid>
    <comment_count>17</comment_count>
    <who name="Adam Williamson">awilliam</who>
    <bug_when>2017-05-15 19:18:11 -0400</bug_when>
    <thetext>Looks like we can confirm the fix for this from openQA testing: the post-install package list for the openQA &apos;minimal package set install&apos; test now *does* look like the minimal package set (and not the Server package set, as it was before due to this bug).</thetext>
  </long_desc>
      
      

    </bug>

</bugzilla>