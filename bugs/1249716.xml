<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.redhat.com/page.cgi?id=bugzilla.dtd">

<bugzilla version="4.4.12068.1" urlbase="https://bugzilla.redhat.com/" maintainer="bugzilla-error-list@redhat.com">

  <bug>
    <bug_id>1249716</bug_id>

    <creation_ts>2015-08-03 11:43:00 -0400</creation_ts>
    <short_desc>rt-4.2.11-1.fc24 FTBFS: Installed (but unpackaged) file(s) found with rpm-4.13</short_desc>
    <delta_ts>2016-06-23 12:20:00 -0400</delta_ts>
    <reporter_accessible>1</reporter_accessible>
    <cclist_accessible>1</cclist_accessible>
    <classification_id>2</classification_id>
    <classification>Fedora</classification>
    <product>Fedora</product>
    <component>rt</component>
    <version>24</version>
    <rep_platform>Unspecified</rep_platform>
    <op_sys>Unspecified</op_sys>
    <bug_status>CLOSED</bug_status>
    <resolution>CURRENTRELEASE</resolution>

    <bug_file_loc>http://koji.fedoraproject.org/koji/taskinfo?taskID=10588207</bug_file_loc>
    <status_whiteboard></status_whiteboard>
    <keywords></keywords>
    <priority>unspecified</priority>
    <bug_severity>unspecified</bug_severity>
    <target_milestone>---</target_milestone>

    <everconfirmed>1</everconfirmed>
    <reporter name="Petr Pisar">ppisar</reporter>
    <assigned_to name="Ralf Corsepius">rc040203</assigned_to>
    <cc>ffesti</cc>

    <cc>jzeleny</cc>

    <cc>lkardos</cc>

    <cc>novyjindrich</cc>

    <cc>packaging-team-maint</cc>

    <cc>perl-devel</cc>

    <cc>pknirsch</cc>

    <cc>rc040203</cc>

    <cc>tibbs</cc>
    <qa_contact name="Fedora Extras Quality Assurance">extras-qa</qa_contact>

    <cf_fixed_in></cf_fixed_in>
  <cf_doc_type>Bug Fix</cf_doc_type>
<cf_release_notes></cf_release_notes>
<cf_story_points>---</cf_story_points>

<cf_environment></cf_environment>
<cf_last_closed>2016-06-23 12:20:00</cf_last_closed>
<cf_type>Bug</cf_type>
<cf_regression_status>---</cf_regression_status>
<cf_mount_type>---</cf_mount_type>
<cf_documentation_action>---</cf_documentation_action>
<cf_crm></cf_crm>
<cf_verified_branch></cf_verified_branch>
<cf_category>---</cf_category>
<cf_ovirt_team>---</cf_ovirt_team>

<cf_cloudforms_team>---</cf_cloudforms_team>

<target_release>---</target_release>

<votes>0</votes>

<comment_sort_order>oldest_to_newest</comment_sort_order>
<long_desc isprivate="0">
<commentid>8506050</commentid>
<comment_count>0</comment_count>
<who name="Petr Pisar">ppisar</who>
<bug_when>2015-08-03 11:43:35 -0400</bug_when>
<thetext>rt-4.2.11-1.fc24 fails to build in F24: Checking for unpackaged file(s): /usr/lib/rpm/check-files /builddir/build/BUILDROOT/rt-4.2.11-2.fc24.x86_64 error: Installed (but unpackaged) file(s) found: /usr/share/doc/rt/docs/README
/usr/share/doc/rt/docs/UPGRADING-2.0 /usr/share/doc/rt/docs/UPGRADING-3.0 /usr/share/doc/rt/docs/UPGRADING-3.2 /usr/share/doc/rt/docs/UPGRADING-3.4 /usr/share/doc/rt/docs/UPGRADING-3.6 /usr/share/doc/rt/docs/UPGRADING-3.8
/usr/share/doc/rt/docs/UPGRADING-4.0 /usr/share/doc/rt/docs/UPGRADING-4.2 /usr/share/doc/rt/docs/UPGRADING.mysql /usr/share/doc/rt/docs/authentication.pod /usr/share/doc/rt/docs/automating_rt.pod /usr/share/doc/rt/docs/backups.pod
/usr/share/doc/rt/docs/charts.pod /usr/share/doc/rt/docs/customizing/approvals.pod /usr/share/doc/rt/docs/customizing/articles_introduction.pod /usr/share/doc/rt/docs/customizing/lifecycles.pod
/usr/share/doc/rt/docs/customizing/search_result_columns.pod /usr/share/doc/rt/docs/customizing/styling_rt.pod /usr/share/doc/rt/docs/customizing/templates.pod /usr/share/doc/rt/docs/customizing/timezones_in_charts.pod
/usr/share/doc/rt/docs/dashboards.pod /usr/share/doc/rt/docs/extending/clickable_links.pod /usr/share/doc/rt/docs/extending/external_custom_fields.pod /usr/share/doc/rt/docs/extending/using_forms_widgets.pod /usr/share/doc/rt/docs/extensions.pod
/usr/share/doc/rt/docs/full_text_indexing.pod /usr/share/doc/rt/docs/glossary.pod /usr/share/doc/rt/docs/hacking.pod /usr/share/doc/rt/docs/images/action-decline.png /usr/share/doc/rt/docs/images/customize-dashboards-menu.png
/usr/share/doc/rt/docs/images/dashboard-chart.png /usr/share/doc/rt/docs/images/dashboard-content-invoices.png /usr/share/doc/rt/docs/images/dashboard-search-sorting.png /usr/share/doc/rt/docs/images/dashboard-subscription.png
/usr/share/doc/rt/docs/images/general-owner-chart.png /usr/share/doc/rt/docs/images/general-owner-lastupdated-chart.png /usr/share/doc/rt/docs/images/general-status-chart.png /usr/share/doc/rt/docs/images/global-lifecycle-group-rights.png
/usr/share/doc/rt/docs/images/lifecycle-choices.png /usr/share/doc/rt/docs/images/order-history-example.png /usr/share/doc/rt/docs/images/queue-created-started-chart.png /usr/share/doc/rt/docs/images/theme_editor_defaults.png
/usr/share/doc/rt/docs/incremental-export/README /usr/share/doc/rt/docs/incremental-export/Record_Local.pm /usr/share/doc/rt/docs/incremental-export/schema.mysql /usr/share/doc/rt/docs/initialdata.pod /usr/share/doc/rt/docs/network-diagram.svg
/usr/share/doc/rt/docs/reminders.pod /usr/share/doc/rt/docs/reporting/feeds.pod /usr/share/doc/rt/docs/rt_perl.pod /usr/share/doc/rt/docs/schema.dot /usr/share/doc/rt/docs/security.pod /usr/share/doc/rt/docs/web_deployment.pod
/usr/share/doc/rt/docs/writing_extensions.pod /usr/share/doc/rt/docs/writing_portlets.pod Installed (but unpackaged) file(s) found: /usr/share/doc/rt/docs/README /usr/share/doc/rt/docs/UPGRADING-2.0 /usr/share/doc/rt/docs/UPGRADING-3.0
/usr/share/doc/rt/docs/UPGRADING-3.2 /usr/share/doc/rt/docs/UPGRADING-3.4 /usr/share/doc/rt/docs/UPGRADING-3.6 /usr/share/doc/rt/docs/UPGRADING-3.8 /usr/share/doc/rt/docs/UPGRADING-4.0 /usr/share/doc/rt/docs/UPGRADING-4.2
/usr/share/doc/rt/docs/UPGRADING.mysql /usr/share/doc/rt/docs/authentication.pod /usr/share/doc/rt/docs/automating_rt.pod /usr/share/doc/rt/docs/backups.pod /usr/share/doc/rt/docs/charts.pod /usr/share/doc/rt/docs/customizing/approvals.pod
/usr/share/doc/rt/docs/customizing/articles_introduction.pod /usr/share/doc/rt/docs/customizing/lifecycles.pod /usr/share/doc/rt/docs/customizing/search_result_columns.pod /usr/share/doc/rt/docs/customizing/styling_rt.pod
/usr/share/doc/rt/docs/customizing/templates.pod /usr/share/doc/rt/docs/customizing/timezones_in_charts.pod /usr/share/doc/rt/docs/dashboards.pod /usr/share/doc/rt/docs/extending/clickable_links.pod
/usr/share/doc/rt/docs/extending/external_custom_fields.pod /usr/share/doc/rt/docs/extending/using_forms_widgets.pod /usr/share/doc/rt/docs/extensions.pod /usr/share/doc/rt/docs/full_text_indexing.pod /usr/share/doc/rt/docs/glossary.pod
/usr/share/doc/rt/docs/hacking.pod /usr/share/doc/rt/docs/images/action-decline.png /usr/share/doc/rt/docs/images/customize-dashboards-menu.png /usr/share/doc/rt/docs/images/dashboard-chart.png
/usr/share/doc/rt/docs/images/dashboard-content-invoices.png /usr/share/doc/rt/docs/images/dashboard-search-sorting.png /usr/share/doc/rt/docs/images/dashboard-subscription.png /usr/share/doc/rt/docs/images/general-owner-chart.png
/usr/share/doc/rt/docs/images/general-owner-lastupdated-chart.png /usr/share/doc/rt/docs/images/general-status-chart.png /usr/share/doc/rt/docs/images/global-lifecycle-group-rights.png /usr/share/doc/rt/docs/images/lifecycle-choices.png
/usr/share/doc/rt/docs/images/order-history-example.png /usr/share/doc/rt/docs/images/queue-created-started-chart.png /usr/share/doc/rt/docs/images/theme_editor_defaults.png /usr/share/doc/rt/docs/incremental-export/README
/usr/share/doc/rt/docs/incremental-export/Record_Local.pm /usr/share/doc/rt/docs/incremental-export/schema.mysql /usr/share/doc/rt/docs/initialdata.pod /usr/share/doc/rt/docs/network-diagram.svg /usr/share/doc/rt/docs/reminders.pod
/usr/share/doc/rt/docs/reporting/feeds.pod /usr/share/doc/rt/docs/rt_perl.pod /usr/share/doc/rt/docs/schema.dot /usr/share/doc/rt/docs/security.pod /usr/share/doc/rt/docs/web_deployment.pod /usr/share/doc/rt/docs/writing_extensions.pod
/usr/share/doc/rt/docs/writing_portlets.pod This is probably caused by upgrading rpm to 4.12.90.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>8506168</commentid>
<comment_count>1</comment_count>
<who name="Ralf Corsepius">rc040203</who>
<bug_when>2015-08-03 12:29:01 -0400</bug_when>
<thetext>Ageed, this likely is caused by current rpm&apos;s brokeneness. I am not going to address this, but consider this to be caused by a severe bug in rpm.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>8508611</commentid>
<comment_count>2</comment_count>
<who name="Ľuboš Kardoš">lkardos</who>
<bug_when>2015-08-04 06:58:10 -0400</bug_when>
<thetext>The problem is that in a previous version of rpm was bug causing that all files in %{_pkgdocdir} became part of a package despite the fact that they wasn&apos;t explicitly listed in file list (#728959). We fixed that bug and changed that
behaviour intentionally. I understand that this change of behaviour is unpleasant for you because it causes FTBS but former behaviour was broken and we don&apos;t plan to revert back to that behaviour. Please fix your package. Your install script
(during &quot;make install&quot;) installs some files in /usr/share/doc/rt/docs. To fix this problem it will be enough to list all those files in file list section of your spec. BTW %doc followed by relative paths of files copies these files from
BUILD to BUILDROOT/%{_pkgdocdir}. And you don&apos;t need to do that because this is already done by your install script (by &quot;make install&quot;). You don&apos;t need to use %doc for absolute paths in %{_pkgdocdir} either because all files in
%{_pkgdocdir} are automatically marked as doc files. So this: %files %doc %{_pkgdocdir}/docs/README ... is the same as: %files %{_pkgdocdir}/docs/README ...</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>8517189</commentid>
<comment_count>3</comment_count>
<who name="Ralf Corsepius">rc040203</who>
<bug_when>2015-08-06 07:17:08 -0400</bug_when>
<thetext>(In reply to Ľuboš Kardoš from comment #2) &gt; The problem is that in a previous version of rpm was bug causing that all &gt; files in %{_pkgdocdir} became part of a package despite the fact that they &gt; wasn&apos;t explicitly listed in
file list (#728959). We fixed that bug and &gt; changed that behaviour intentionally. I understand that this change of &gt; behaviour is unpleasant for you Please understand that I do not agree with you. IMO, you FUBARed rpm&apos;s %doc handling.
&gt; because it causes FTBS but former behaviour &gt; was broken and we don&apos;t plan to revert back to that behaviour. There was nothing wrong with this package. It was installing some files into %_pkgdocdir directly and was adding others using
%doc. This was one way, recommended by the former rpm-maintainer - You broke that! &gt; BTW %doc followed by relative paths of files copies these files from BUILD &gt; to BUILDROOT/%{_pkgdocdir}. And you don&apos;t need to do that because this is
&gt; already done by your install script (by &quot;make install&quot;). You are wrong again. rt&apos;s &quot;make install&quot; installs a lot of files into %_pkgdocdir. %doc was used to add some files. &gt; You don&apos;t need to use %doc for
absolute paths in %{_pkgdocdir} either &gt; because all files in %{_pkgdocdir} are automatically marked as doc files. For now, I resorted to manually install those files, which used to be %doc and to use %files %{_pkgdocdir} Also, let me emphasize
that I furthon will not step in to fix FTBS in future mass rebuild because I consider these FTBSes your responsibility, which is why I am expecting you to fix each and every package yourselves. Alos, IMO, your change does not fix anything in rpms. To
the contrary. You broke rpm.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>8552307</commentid>
<comment_count>4</comment_count>
<who name="Florian Festi">ffesti</who>
<bug_when>2015-08-18 11:53:46 -0400</bug_when>
<thetext>You are right that using rt&apos;s &quot;make install&quot; in combination with %doc is a legitimate (and recommended) way of handling this situation and you are right in your expectation that both can be used together. But if you do install
files with &quot;make install&quot; (or any other command than %doc) you must add the files to a (sub) package by adding it to a %files section - either directly or as part of a glob or directory. The error you see is caused by not adding those
files. So one way to solve this for the rt package is to add %pkgdocdir/* to the %files section. Unfortunately this packaging error has been hidden by a bug until now that adds all files in %{_pkgdocdir} to the (sub) package if %doc is used in the
%files section. This is clearly wrong for a number of reasons: 1) It creates an error about unrelated files if you remove the %doc directives 2) It adds files to a package it may not belong into if the files should actually go into a different sub
package. 3) It hides the error message for files erroneously copied into the %{_pkgdocdir} For the case that there are too many other packages with this problem this need obviously handled in a proper way. We already have some code to keep the
packages building and just issue a warning. But I am not sure if this is really the way to go. If there is just a small number packages affected fixing those and getting rid of the whole issue seems like a better and easier way.</thetext>
</long_desc>
<long_desc isprivate="0">
<commentid>9091985</commentid>
<comment_count>5</comment_count>
<who name="Jan Kurik">jkurik</who>
<bug_when>2016-02-24 08:31:21 -0500</bug_when>
<thetext>This bug appears to have been reported against &apos;rawhide&apos; during the Fedora 24 development cycle. Changing version to &apos;24&apos;. More information and reason for this action is here:
https://fedoraproject.org/wiki/Fedora_Program_Management/HouseKeeping/Fedora24#Rawhide_Rebase</thetext>
</long_desc>

</bug>

</bugzilla>
